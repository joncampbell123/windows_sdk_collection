

<HTML>
<HEAD>
<TITLE>PRB: Changing Properties of AddressEntry object of a Recipient </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171671">
<META NAME="KBModify" CONTENT="1997/11/21">
<META NAME="KBCreate" CONTENT="1997/07/21">
<META NAME="Keywords" CONTENT="kbcode ActMsg">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  When attempting to change properties or fields of the AddressEntry object of a Recipient of a message, the property/field changes are not saved.  For example, using the following code, the change to the PR_SEND_RICH_INFO is not saved, as seen in th...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAH4,QAW6,QBXS,QAR2,QABA,QAL7,QANF,QAEV,QAYC,QBWC,QAY5,QAYY,QAXB,QABG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Changing Properties of AddressEntry object of a Recipient</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171671</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Collaboration Data Objects (CDO), version 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to change properties or fields of the AddressEntry object
of a Recipient of a message, the property/field changes are not saved.
<P>
For example, using the following code, the change to the PR_SEND_RICH_INFO
is not saved, as seen in the Details page that is displayed. (See the MORE
INFORMATION section below for how the variables are defined.)
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Follow these steps to make changes to the AddressEntry object of a
recipient of a message. This code may be used to correct the complete code
example provided in the MORE INFORMATION section below.

<OL><P><LI>After resolving the recipient, create a new AddressEntry object based on
   the AddressEntry property of the Recipient:
<P>
<P><PRE>      Dim objAddress As Mapi.AddressEntry
      Set objAddress = objRecip.AddressEntry
</PRE>
<P><LI>Change the properties or fields on the new AddressEntry object:
<P>
<P><PRE>      objAddress.Fields(ActMsgPR_SEND_RICH_INFO) = False
</PRE>
<P><LI>Call the Update method of the new AddressEntry object:
<P>
<P><PRE>      objAddress.Update
</PRE>
<P><LI>Set the AddressEntry property of the Recipient object to the
   AddressEntry object created in step 1 above:
<P>
<P><PRE>      objRecip.AddressEntry = objAddress
</PRE><P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following code placed in a Visual Basic module will reproduce the
problem described in the Symptoms section above. Note that the property
change used here for illustration purposes assumes that the default setting
of the PR_SEND_RICH_INFO property is True. If the default setting on your
system is False, you will want to modify the code below to see the
behavior.
<P>
<PRE>' Note that you should have "Microsoft Active Messaging 1.1 Object
    ' Library" marked as a reference for your project in order for this
    ' code to function.
    Dim objSession As Session
    Dim objMessage As Mapi.Message
    Dim objRecip As Mapi.Recipient
    Dim objAddress As Mapi.AddressEntry

    ' Create and logon to a MAPI Session
    Set objSession = CreateObject("Mapi.Session")
    objSession.Logon ShowDialog:=True

    ' Create a new message
    Set objMessage = objSession.Outbox.Messages.Add

    ' Create a new recipient on our message
    Set objRecip = objMessage.Recipients.Add
    ' Set the properties of our recipient and resolve to a single address
    objRecip.Name = "myemail@mycompany.com"
    objRecip.Type = ActMsgTo
    objRecip.Resolve

    ' *** To make this code function as needed, replace this section
    ' *** of code with the corrected code provided in the Resolution
    ' *** section above.
    ' Attempt to set the PR_SEND_RICH_INFO property.
    ' This is the line of code that may need to change, depending on the
    ' default setting on your system.
    objRecip.AddressEntry.Fields(ActMsgPR_SEND_RICH_INFO) = False
    ' Update the AddressEntry object
    objRecip.AddressEntry.Update

    ' View the details of the Recipient to confirm changes
    objRecip.AddressEntry.Details

    ' Delete the message and Logoff the Session
    objMessage.Delete
    objSession.Logoff

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For additional information about Collaboration Data Objects versus Active
Messaging, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../mapi/q176916.htm">Q176916</A></B>
   TITLE     : INFO: Active Messaging and Collaboration Data Objects (CDO)

</PRE> 
<PRE>Keywords          : kbcode ActMsg
Version           : WINDOWS:1.1
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
