

<HTML>
<HEAD>
<TITLE>HOWTO: Write a VB MessageFilter for Your Appointment Collection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178508">
<META NAME="KBModify" CONTENT="1998/01/06">
<META NAME="KBCreate" CONTENT="1997/12/23">
<META NAME="Keywords" CONTENT="kbcode cdo">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  You can use a Collaboration Data Objects (CDO) message filter in Microsoft Visual Basic to filter your appointment calendar. This article contains sample code that demonstrates how to use Visual Basic as a filter.  MORE INFORMATION  WARNING: ANY US...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXS,QANF,QBDP,QAPN,QAH4,QAW6,QAH6,QBCF,QA7O,QA7N,QAVX,QACJ,QACE,QBV0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Write a VB MessageFilter for Your Appointment Collection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178508</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Collaboration Data Objects (CDO), version 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use a Collaboration Data Objects (CDO) message filter in Microsoft
Visual Basic to filter your appointment calendar. This article contains
sample code that demonstrates how to use Visual Basic as a filter.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this code "as is" without warranty of any kind,
either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.

<OL><P><LI>Open a new Visual Basic standard executable project.

<P><LI>Create a reference to the Microsoft Collaboration Data Objects (CDO) 1.2
   library (Cdo.dll).

<P><LI>Create a command button named "Command1" on the form.

<P><LI>Copy and paste the following code into the form:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Const strServer As String = "MyExchangeServer"
      Const strMailbox As String = "MyMailbox"
      Private Sub Command1_Click()
<PRE></PRE>        Dim objSession As MAPI.Session
        Dim objCalendarFolder As Folder
        Dim objAppointments As Messages
        Dim objAppointmentFilter As MessageFilter
        Dim objOneAppointment As AppointmentItem
        Dim strProfileInfo As String
        Dim StartTime As Date
        Dim EndTime As Date
        Dim objAppointmentFilterField1 As Field
        Dim objAppointmentFilterField2 As Field

        Screen.MousePointer = vbHourglass
        StrProfileInfo = strServer &amp; vbLf &amp; strMailbox
        Set objSession = New MAPI.Session
        objSession.Logon , , False, False, 0, True, strProfileInfo

       'Fill in a date/time using the vbDate format.
       'For example StartTime = #1/1/98 9:30 AM#.  This vbDate
       'filters appointments that started AFTER 9:30 AM on
       'January 1, 1998.  Use StartTime and EndTime in combination
       'to filter a specific date.  For example, if you wanted to filter
       'for all your appointments on January 1, 1998, use
       'StartTime = #1/1/98#
       'EndTime = #1/2/98#
       'This combination filters for all appointments starting
       'AFTER Janury 1, 1998 at midnight, and all appointments ending
       'BEFORE January 2, 1998 at midnight.
       'You can further refine your filter by adding times to the
       'StartTime and EndTime.
       StartTime = #m/d/yy hh:mm XX#
       EndTime = #m/d/yy hh:mm XX#
        Set objCalendarFolder = _
          objSession.GetDefaultFolder(CdoDefaultFolderCalendar)
        Set objAppointments = objCalendarFolder.Messages
       Set objAppointmentFilter = objAppointments.Filter
      'NOTE: Pass the EndTime parameter to the START_DATE field and the
      '      StartTime parameter to the END_DATE field.
       Set objAppointmentFilterField1 = _
         objAppointmentFilter.Fields.Add(ActMsgPR_START_DATE, EndTime)
       Set objAppointmentFilterField2 = _
         objAppointmentFilter.Fields.Add(ActMsgPR_END_DATE, StartTime)

       For Each objOneAppointment In objAppointments
         Debug.Print "objOneAppointment.Subject = " &amp; _
               objOneAppointment.Subject
         Debug.Print "objOneAppointment.StartTime = " &amp; _
               objOneAppointment.StartTime
         Debug.Print "objOneAppointment.EndTime = " &amp; _
               objOneAppointment.EndTime
         Debug.Print
       Next

       objSession.Logoff
       Set objOneAppointment = Nothing
       Set objAppointments = Nothing
       Set objCalendarFolder = Nothing
       Set objSession = Nothing
       Screen.MousePointer = vbNormal
      End Sub

</PRE><P><LI>Run the project and click Command1. Your immediate window displays all
   appointments for the selected date.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
See the "MessageFilter Object" and "AddressEntryFilter Object" topics in
the Microsoft Developer Network Library.
<P>
 
<PRE>Keywords          : kbcode cdo
Version           : WINDOWS:1.2
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
