

<HTML>
<HEAD>
<TITLE>FILE: Profsamp.exe: How to Manipulate MAPI Profiles Sample </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176337">
<META NAME="KBModify" CONTENT="1997/11/19">
<META NAME="KBCreate" CONTENT="1997/11/05">
<META NAME="Keywords" CONTENT="EMAPI">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  This sample demonstrates how to accomplish some of the most common profile -related operations.  The sample was written with Microsoft Visual C++ and Microsoft Foundation Classes (MFC).  The following file is available for download from the Microso...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWB,QACK,QAH4,QDJ2,QA01,QA2Q,QAA1,QAGU,QDI2,QANE,QAPF,QBBS,QAG2,QAY2,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Profsamp.exe: How to Manipulate MAPI Profiles Sample</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176337</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Extended Messaging Application Programming Interface (MAPI), version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This sample demonstrates how to accomplish some of the most common profile
-related operations.
<P>
The sample was written with Microsoft Visual C++ and Microsoft Foundation
Classes (MFC).
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/profsamp.exe">Profsamp.exe</A> <I>(size: 112897 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The sample, Profman, was created to demonstrate how to use the MAPI
interfaces and methods that pertain to the manipulation and creation of
MAPI profile. Here is a list of the functionality:

<UL><LI>Create a new blank profile.

<LI>Add services to a profile.

<LI>Delete services from a profile.

<LI>List the services in a profile.

<LI>Add providers to a service.

<LI>Delete providers from a service.

<LI>List the providers in a service.

<LI>Set the default store provider of a service.

<LI>List the available properties of a provider.
<P>
</UL><h3>Source Files</h3>
 

<UL><LI>ServiceDlg.cpp: Contains the code for the user interface of the dialog
   box that displays the services installed in a particular profile.

<LI>ServiceObj.cpp: Contains the code that manages the data used
   by ServiceDlg.cpp.

<LI>ProviderDlg.cpp: Contains the code for the user interface of the dialog
   box that displays the providers of a particular service.

<LI>ProviderObj.cpp: Contains the code that manages the data used
   by ProviderDlg.cpp.

<LI>ProvPropsDlg.cpp: Contains the code for the user interface of the dialog
   box that displays the properties of a particular provider.

<LI>ProvPropsObj.cpp: contains the code that manages the data used
   by ProvPropsObj.cpp.

<LI>SelectService.cpp: Contains the code for the user interface and data
   that displays all available services installed on the system and
   allows the user to select one to be installed.

<LI>SelectProvider.cpp: Contains the code for the user interface and data
   that displays all available providers for the selected service and
   allows the user to select one to be installed.

<LI>ProfileNameDlg.cpp: Contains the code for the user interface and data
   that displays a simple dialog box to allow the user to enter the name of
   a profile to be created.

<LI>StdAfx.cpp: Source file that contains just the standard includes.

<LI>ProfMan.cpp: Defines the class behaviors for the application.
<P>
</UL><h3>Header Files</h3>
 

<UL><LI>ServiceDlg.h
<LI>ServiceObj.h
<LI>ProviderDlg.h
<LI>ProviderObj.h
<LI>ProvPropsDlg.h
<LI>ProvPropsObj.h
<LI>SelectService.h
<LI>SelectProvider.h
<LI>ProfileNameDlg.h
<LI>ProfManDlg.h
<LI>StdAfx.h
<LI>ProfMan.h
<LI>Resource.h
<P>
</UL><h3>Resource Files</h3>
 

<UL><LI>ProfMan.ico
<LI>ProfMan.rc
<P>
</UL><h3>Project Files</h3>
 

<UL><LI>Profman.dsw: Microsoft Developer Studio Workspace
<LI>Profman.dsp: Microsoft VC++ Project file
<P>
</UL><h3>SETUP</h3>
 
<P>
Follow these steps to build the sample:

<OL><P><LI>Extract the files from the self-extracting executable file,
   Profsamp.exe.

<P><LI>Open a command prompt in the folder where you extracted the files.

<P><LI>To create the sample type the following command:
<P>
<P><PRE>       nmake profman.mak
</PRE><P>
   This creates a .\Debug directory and places the built executable
   into the directory.
<P>
</OL><h3>Running the Sample</h3>
 
<P>
There are two main dialog boxes that you see when you run this sample
application:

<OL><P><LI>Main Dialog Box (titled Profile Manager):
<P>
<P><PRE>    - The New button allows you to create a new profile. This newly
      created profile will be blank (no service providers installed). You
      will be prompted to enter a name for the new profile.
</PRE><P>
<P><PRE>    - The Open button allows you to open a different profile. This
      closes your currently loaded profile.
</PRE><P>
<P><PRE>    - The Get Providers button brings up a dialog box titled
      Providers. This dialog box displays all of the providers
      installed for the currently selected service. For instructions on how
      to use this dialog, see step 2 below.
</PRE><P>
<P><PRE>    - The Add Service button brings up a dialog box titled Add Service.
      This dialog box presents you with a list of available MAPI Service
      providers on your system. You can select one of them to install. When
      you select a service to be installed, the service may prompt you for
      more information.
</PRE><P>
<P><PRE>    - The Delete Service button will delete the currently selected
      service from your profile.
</PRE>
<P><LI>Provider Dialog Box (titled Providers):
<P>
   This dialog box lists all of the providers of the service that were
   selected on the mail dialog box:
<P>
<P><PRE>    - The Get Properties button displays some of the properties of
      the selected provider. Many of the providers properties are not
      exposed to MAPI clients so ProfMan is unable to display them.
</PRE><P>
<P><PRE>    - The Add Provider button brings up a dialog box that lists all
      of the providers of the current service. The user can now select one
      of the providers to install.
</PRE><P>
<P><PRE>    - The Delete Provider button removes the currently selected provider.
</PRE><P>
<P><PRE>    - The SetDefaultStore button attempts to set the currently
      selected provider as the default store for the provider. If this call
      fails, the selected provider can not be made the default store.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MAPI Profile Service Provider<BR>
Keywords          : EMAPI<BR>
Version           : WINDOWS:1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
