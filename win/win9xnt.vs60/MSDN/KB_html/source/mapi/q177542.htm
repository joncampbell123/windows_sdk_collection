

<HTML>
<HEAD>
<TITLE>FILE: Mapiasst.exe: MAPI ASSERT Debug Routines </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177542">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/12/03">
<META NAME="Keywords" CONTENT="kbcode EDKAPI EMAPI MAPIForm MAPIIAB MAPIIMS MAPIIXP SMapiCMC">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  This sample consists of a header file that provides debugging routines to assist developers of messaging applications.  MORE INFORMATION  The following file is available for download from the Microsoft Software Library:   ~ Mapiasst.exe  For more i...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH6,QAL7,QAPF,QAMA,QAY2,QBW9,QBC9,QBC8,QAV5,QANO,QAH7,QAAP,QAD7,QAB4,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Mapiasst.exe: MAPI ASSERT Debug Routines</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177542</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Simple Messaging Application Programming Interface (MAPI), version 1.0
<LI>Extended Messaging Application Programming Interface (MAPI), version 1.0
<LI>Exchange Development Kit (EDK), versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This sample consists of a header file that provides debugging routines to
assist developers of messaging applications.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/mapiasst.exe">Mapiasst.exe</A> <I>(size: 29184 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>The Mapiasst.exe sample, contains the following two files:

<UL><LI>Mapiasst.h
<LI>Readme.txt
<P>
</UL>The header file, Mapiasst.h, was written to assist messaging developers in
writing and debugging their applications.
<P>
Mapiasst.h includes the following three debug macros:
<P>
<P><h3>MAPI_ASSERT(HRESULT)</h3>
 
<P>
Pass MAPI_ASSERT a HRESULT and MAPI_ASSERT gives you basic error output and
returns you to the debugger at the point where the error occurred.
<P>
Sample Output:
<P>
<PRE>   **ASSERT! File : C:\Srccode\MsgStores\Main.Cpp
        Line : 29
        Value : 0x80040111

</PRE><h3>MAPI_ASSERT_EX(HRESULT)</h3>
 
<P>
MAPI_ASSERT_EX works similar to MAPI_ASSERT and gives you the same
information along with the meaning of the HRESULT error code. Again, you
will be returned back to the debugger at the point of error.
<P>
Sample Output:
<P>
<PRE>   **ASSERT! File : C:\Srccode\MsgStores\Main.Cpp
        Line : 29
        Value : 0x80040111
      Meaning : MAPI_E_LOGON_FAILED

</PRE><h3>SHOWTABLE(LPMAPITABLE)</h3>
 
<P>
SHOWTABLE uses the Tblvu32.dll function ViewMapiTable() to display the
passed in MAPITable (LPMAPITABLE) in a GUI dialog box. This is a good tool
for debugging your MAPITables.
<P>
NOTE: Tblvu32.dll is available from the Microsoft FTP site at
ftp.microsoft.com\Developr\Mapi\Samples\Mfcapps.zip)
<P>
Here is a short sample of how these debugging routines may be used:
<P>
<PRE>   /////// MAIN.CPP ////////
   void main()
   {
     HRESULT         hr            = S_OK;
     LPMAPISESSION   lpSession      = NULL;
     LPMAPITABLE      lptMsgStores   = NULL;

     // Init MAPI
     hr = MAPIInitialize(0);

     MAPI_ASSERT_EX(hr);

     // Logon to Extended MAPI session
     hr = MAPILogonEx((ULONG)GetActiveWindow(),
               //"OFFLINE"
               NULL,
               NULL,
               NULL,
               &amp;lpSession);

     MAPI_ASSERT_EX(hr);

     // Get a table of Message Stores from the Session.
     hr = lpSession-&gt;GetMsgStoresTable(NULL, &amp;lptMsgStores);

     SHOWTABLE(lptMsgStores);

     MAPI_ASSERT_EX(hr);
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ASSERT MAPI SHOWTABLE MAPI_ASSERT MAPI_ASSERT_EX<BR>
debug Table Tables<BR>
Keywords          : kbcode EDKAPI EMAPI MAPIForm MAPIIAB MAPIIMS MAPIIXP SMapiCMC<BR>
Version           : WINDOWS:1.0,4.0,5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
