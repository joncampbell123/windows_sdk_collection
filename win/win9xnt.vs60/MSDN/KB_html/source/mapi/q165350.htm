

<HTML>
<HEAD>
<TITLE>HOWTO: Customizing the Reply To Property for a Message </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165350">
<META NAME="KBModify" CONTENT="1997/03/19">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="EMAPI kbprg">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  There may be times when you want to force the reply of a message to a particular person or distribution list. You can accomplish this by using the PR_REPLY_RECIPIENT_NAMES property of the message.  MORE INFORMATION  You can set the PR_REPLY_RECIPIE...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAYC,QAI4,QAUJ,QAEV,QAH4,QAAY,QBXS,QAVX,QAVW,QAGB,QAC2,QBWC,QAAZ,QBWD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Customizing the Reply To Property for a Message</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165350</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Extended Messaging Application Programming Interface (MAPI),
   version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There may be times when you want to force the reply of a message to a
particular person or distribution list. You can accomplish this by using
the PR_REPLY_RECIPIENT_NAMES property of the message.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can set the PR_REPLY_RECIPIENT_NAMES property by using code. It should
be noted that the code sample below is not a complete working program and
it assumes that you have a handle to a MAPI session.

<OL><P><LI>Add the PR_REPLY_RECIPIENT_NAMES to the SPropValue array.
<P>
<P><PRE>     pspvOut[OBSENTREP].ulPropTag = PR_REPLY_RECIPIENT_NAMES;
</PRE>
<P><LI>Set the value of the PR_REPLY_RECIPIENT_NAMES property. This property
   will contain the Display Name of the recipients.
<P>
<P><PRE>     pspvOut[OBSENTREP].Value.lpszA = "[SMTP:testing@Microsoft.com]";
</PRE>
<P><LI>Create an ADRLIST structure containing the address or addresses to
   reply to.
<P>
   NAME, ADDR, EMAIL, RECIP are part of an enum of the recipient
   properties.
<P>
<P><PRE>      LPADRLIST  pAdrList = NULL;
      if (FAILED(hRes = MAPIAllocateBuffer(CbNewSRowSet(1),
<PRE></PRE>                                          (LPVOID*) &amp;pAdrList)))
          goto Quit;

      if (FAILED(hRes = MAPIAllocateBuffer(
               NUM_RECIP_PROPS * sizeof(SPropValue),
              (LPVOID*) &amp;(pAdrList-&gt;aEntries[0].rgPropVals) )))
          goto Quit;

      pAdrList-&gt;cEntries = 1;
      pAdrList-&gt;aEntries[0].cValues = 4;
      pAdrList-&gt;aEntries[0].rgPropVals[NAME].ulPropTag = PR_DISPLAY_NAME;
      pAdrList-&gt;aEntries[0].rgPropVals[NAME].Value.lpszA="Test User";
      pAdrList-&gt;aEntries[0].rgPropVals[ADDR].ulPropTag = PR_ADDRTYPE;
      pAdrList-&gt;aEntries[0].rgPropVals[ADDR].Value.lpszA = "SMTP";
      pAdrList-&gt;aEntries[0].rgPropVals[EMAIL].ulPropTag = PR_EMAIL_ADDRESS;
      pAdrList-&gt;aEntries[0].rgPropVals[EMAIL].Value.lpszA = "";
      pAdrList-&gt;aEntries[0].rgPropVals[RECIP].ulPropTag =
             PR_RECIPIENT_TYPE;
      pAdrList-&gt;aEntries[0].rgPropVals[RECIP].Value.l = MAPI_TO;

</PRE><P><LI>Call ResolveName to get ENTRYIDs for the addresses.
<P>
<P><PRE>      hRes = m_pAddrBook-&gt;ResolveName(NULL,MAPI_DIALOG,
<PRE></PRE>                                      "Resolve Names",pAdrList);

</PRE><P><LI>Set the properties of the outbound message.
<P>
<P><PRE>      if (FAILED(hRes = pMsg -&gt;
<PRE></PRE>          SetProps(NUM_OUTBOUND_PROPS,pspvOut,&amp;pPropProblemArray)))
        goto Quit;

      hRes = pMsg -&gt; ModifyRecipients(0,pAdrList);

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Developer Network, WIN32 SDK
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : EMAPI kbprg<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
