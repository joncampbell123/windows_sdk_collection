

<HTML>
<HEAD>
<TITLE>HOWTO: Read Address Book Properties from ASP Page with VBScript </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179082">
<META NAME="KBModify" CONTENT="1998/01/14">
<META NAME="KBCreate" CONTENT="1998/01/08">
<META NAME="Keywords" CONTENT="cdo kbInetDev">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  This article provides an example of how to use VBScript to retrieve some of the more common fields available in the address book to an Active Server Pages (ASP) page. This article also shows how to use a filter on the address book.  MORE INFORMATIO...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAD2,QAAZ,QBXB,QAUJ,QDNQ,QBWA,QBXS,QAMB,QARM,QAS6,QANF,QBXD,QA6A,QAVU,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Read Address Book Properties from ASP Page with VBScript</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 14, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179082</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Collaboration Data Objects (CDO), version 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides an example of how to use VBScript to retrieve some of
the more common fields available in the address book to an Active Server
Pages (ASP) page. This article also shows how to use a filter on the
address book.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Copy and paste the following code to an ASP file:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html;charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;

   &lt;%
    CONST strServer                             = "MyServer"
    CONST strMailbox                            = "MyMailbox"
    CONST CdoPR_GIVEN_NAME                      = &amp;H3A06001E  'First Name
    CONST CdoPR_INITIALS                        = &amp;H3A0A001E  'Initials
    CONST CdoPR_SURNAME                         = &amp;H3A11001E  'Last Name
    CONST CdoPR_DISPLAY_NAME                    = &amp;H3001001E  'Display Name
    CONST CdoPR_ACCOUNT                         = &amp;H3A00001E  'Alias
    CONST CdoPR_TITLE                           = &amp;H3A17001E  'Title
    CONST CdoPR_COMPANY_NAME                    = &amp;H3A16001E  'Company
    CONST CdoPR_OFFICE_LOCATION                 = &amp;H3A19001E  'Office
    CONST CdoPR_HOME_TELEPHONE_NUMBER           = &amp;H3A09001E  'Phone
    CONST CdoPR_HOME2_TELEPHONE_NUMBER          = &amp;H3A2F001E  'Home Phone 2
    CONST CdoPR_HOME_FAX_NUMBER                 = &amp;H3A25001E  'Home Fax
    CONST CdoPR_HOME_ADDRESS_STREET             = &amp;H3A5D001E  'Address
    CONST CdoPR_HOME_ADDRESS_CITY               = &amp;H3A59001E  'City
    CONST CdoPR_HOME_ADDRESS_STATE_OR_PROVINCE  = &amp;H3A5C001E  'State
    CONST CdoPR_HOME_ADDRESS_POSTAL_CODE        = &amp;H3A5B001E  'Zip
    CONST CdoPR_HOME_ADDRESS_COUNTRY            = &amp;H3A5A001E  'Country
    CONST CdoPR_MANAGER_NAME                    = &amp;H3A4E001E  'Manager
    CONST CdoPR_OFFICE_TELEPHONE_NUMBER         = &amp;H3A08001E  'Business
                                                              'Phone
    CONST CdoPR_OFFICE2_TELEPHONE_NUMBER        = &amp;H3A1B001E  'Business
                                                              'Phone 2
    CONST CdoPR_BUSINESS_FAX_NUMBER             = &amp;H3A24001E  'Fax
    CONST CdoPR_ASSISTANT                       = &amp;H3A30001E  'Assistant
    CONST CdoPR_ASSISTANT_TELEPHONE_NUMBER      = &amp;H3A2E001E  'Asistant
                                                              'Phone Number
    CONST CdoPR_MOBILE_TELEPHONE_NUMBER         = &amp;H3A1C001E  'Mobile
    CONST CdoPR_PAGER_TELEPHONE_NUMBER          = &amp;H3A21001E  'Pager

    Dim objSession
    Dim objAddrEntries
    Dim objAddressEntry
    Dim objFilter
    Dim strProfileInfo

    strProfileInfo = strServer &amp; vbLf &amp; strMailbox

    Set objSession = CreateObject("MAPI.Session")
    objSession.Logon , , False, False, , True, strProfileInfo
    Set objAddrEntries = objSession.AddressLists _
                        ("Global Address List").AddressEntries

    'Create a filter for a user.
    Set objFilter = objAddrEntries.Filter
    objFilter.Fields.Add cdoPR_SURNAME, "LastName"
    objFilter.Fields.Add CdoPR_GIVEN_NAME, "FirstName"

    On Error Resume Next 'Required, because, if an item is missing, an
                         'error returns that stops the process.
    For Each objAddressEntry In objAddrEntries
       Response.Write(objAddressEntry.Name &amp; "&lt;br&gt;")
       Response.Write("E-address: " &amp; objAddressEntry.Address &amp; "&lt;br&gt;")
       Response.Write("Given Name: " &amp; _
                objAddressEntry.Fields(CdoPR_GIVEN_NAME).Value  &amp; "&lt;br&gt;")
       Response.Write("Initials: " &amp; _
                objAddressEntry.Fields(CdoPR_INITIA).Value  &amp; "&lt;br&gt;")
       Response.Write("Surname: " &amp; _
                objAddressEntry.Fields(cdoPR_SURNAME).Value  &amp; "&lt;br&gt;")
       Response.Write("Display Name: " &amp; _
                objAddressEntry.Fields(CdoPR_DISPLAY_NAME).Value  &amp; "&lt;br&gt;")
       Response.Write("Alias: " &amp; _
                objAddressEntry.Fields(CdoPR_ACCOUNT).Value  &amp; "&lt;br&gt;")
       Response.Write("Title: " &amp; _
                objAddressEntry.Fields(CdoPR_TITLE).Value  &amp; "&lt;br&gt;")
       Response.Write("Company Name: " &amp; _
                objAddressEntry.Fields(cdoPR_COMPANY_NAME).Value &amp; "&lt;br&gt;")
       Response.Write("Office Location: " &amp; _
                objAddressEntry.Fields(CdoPR_OFFICE_LOCATION).Value &amp; _
                "&lt;br&gt;")
       Response.Write("Office Phone 1: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_OFFICE_TELEPHONE_NUMBER).Value &amp; "&lt;br&gt;")
       Response.Write("Office Phone 2: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_OFFICE2_TELEPHONE_NUMBER).Value &amp; "&lt;br&gt;")
       Response.Write("Business Fax: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_BUSINESS_FAX_NUMBER).Value  &amp; "&lt;br&gt;")
       Response.Write("Mobile Phone: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_MOBILE_TELEPHONE_NUMBER).Value  &amp; "&lt;br&gt;")
       Response.Write("Pager: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_PAGER_TELEPHONE_NUMBER).Value  &amp; "&lt;br&gt;")
       Response.Write("Assistant: " &amp; _
                objAddressEntry.Fields(CdoPR_ASSISTANT).Value  &amp; "&lt;br&gt;")
       Response.Write("Assistant Phone: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_ASSISTANT_TELEPHONE_NUMBER).Value  &amp; "&lt;br&gt;")
       Response.Write("Home Phone 1: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME_TELEPHONE_NUMBER).Value  &amp; "&lt;br&gt;")
       Response.Write("Home Phone 2: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME2_TELEPHONE_NUMBER).Value  &amp; "&lt;br&gt;")
       Response.Write("Home Fax: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME_FAX_NUMBER).Value  &amp; "&lt;br&gt;")
       Response.Write("Home Street: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME_ADDRESS_STREET).Value  &amp; "&lt;br&gt;")
       Response.Write("Home City: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME_ADDRESS_CITY).Value  &amp; "&lt;br&gt;")
       Response.Write("Home State: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME_ADDRESS_STATE_OR_PROVINCE).Value  &amp; "&lt;br&gt;")
       Response.Write("Home Postal Code: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME_ADDRESS_POSTAL_CODE).Value  &amp; "&lt;br&gt;")
       Response.Write("Home Country: " &amp; _
                objAddressEntry.Fields _
                (CdoPR_HOME_ADDRESS_COUNTRY).Value  &amp; "&lt;br&gt;")
       Response.Write("Manager Name: " &amp; _
                objAddressEntry.Fields(CdoPR_MANAGER_NAME).Value  &amp; "&lt;br&gt;")
       Response.Write("Manager Name: " &amp; _
                objAddressEntry.Manager &amp; "&lt;br&gt;&lt;br&gt;")
    Next

    objSession.Logoff
    Set objFilter = Nothing
    Set objAddrEntries= Nothing
    Set objSession = Nothing

    %&gt;

    &lt;/BODY&gt;
    &lt;/HTML&gt;
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ActMsg<BR>
Keywords          : cdo kbInetDev<BR>
Version           : WINDOWS:1.2<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 14, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
