

<HTML>
<HEAD>
<TITLE>FILE: Mfccdo.exe: Collaboration Data Objects with Visual C++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178480">
<META NAME="KBModify" CONTENT="1998/03/06">
<META NAME="KBCreate" CONTENT="1997/12/23">
<META NAME="Keywords" CONTENT="kbcode cdo">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  Collaboration Data Objects (formerly known as Active Messaging) provides a means for sending, receiving, and processing messages programmatically. While most of the documentation provides sample code for Visual Basic, some people prefer to create C...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBBI,QAPN,QAJH,QAPF,QAEV,QAH6,QAMA,QAH4,QBFY,QAYC,QANE,QAW6,QAUD,QA5F,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Mfccdo.exe: Collaboration Data Objects with Visual C++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178480</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Collaboration Data Objects (CDO), versions 1.1, 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Collaboration Data Objects (formerly known as Active Messaging) provides a
means for sending, receiving, and processing messages programmatically.
While most of the documentation provides sample code for Visual Basic, some
people prefer to create C/C++ applications to perform the same tasks.
<P>
This article contains two code samples. The samples are an illustration and
give developers a starting point in writing Collaboration Data Objects
(CDO) applications in C/C++.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following files are available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/mfccdo.exe">Mfccdo.exe</A> <I>(size: 3755397 bytes)</I> 
 ~ <A href="http://support.microsoft.com/download/support/mslfiles/sampcdo.exe">Sampcdo.exe</A> <I>(size: 2288408 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>README.1ST (for Mfccdo.exe)</h2>
 
<P>
<P><h3>CDOMFC Sample Application</h3>
 
<P>
This project was generated and built on the use of Collaboration Data
Objects (CDO) (formerly known as Active Messaging) version 1.1. However,
the functionality that is illustrated in this application is backwards-
compatible with 1.0 (except for creating of MAPI.Session) and forward-
compatible with version 1.2 that is now available with Microsoft Exchange
Server 5.5.
<P>
<P><h3>Purpose</h3>
 
<P>
This application provides a working sample for troubleshooting problems
when calling the CDO library with the Microsoft Foundation Classes (MFC)
COleDispatchDriver class.
<P>
<P><h3>Application Files</h3>
 
<P>
The following files are included with this sample:

<UL><LI>Cdomfc.dsw: Microsoft Visual C++ 5.0 Workspace.
<LI>Cdomfc.dsp: Microsoft Visual C++ 5.0 Project File.
<LI>Cdomfc.cpp: Defines the class behaviors for the application.
<LI>Cdomfc.rc: Dialog, icon, and version resources for the application.
<LI>Cdomfcdlg.cpp: Implementation for the dialog class of the application.
<LI>Olemsg32.cpp: Originally generated by the ClassWizard; modified by
   the author for easier use of methods and classes and provides
   implementation for classes defined in Olemsg32.h.
<LI>Stdafx.cpp: Standard includes for the application.
<LI>Cdomfc.h: Main header file for the application.
<LI>Cdomfcdlg.h: Header file for the dialog class of the application.
<LI>Olemsg32.h: Originally generated by ClassWizard; modified by the
   author for easier use of methods and classes.
<LI>Resource.h: Automatically generated by DevStudio; used by Cdomfc.rc.
<LI>Stdafx.h: Include file for standard system files.
<LI>Res\cdomfc.ico: Generic icon for the application.
<LI>Res\cdomfc.rc2: Manually edited resources for the application.
<LI>Readme.txt: Automatically generated by MFC AppWizard.
<LI>Readme2.txt: This file contains general information about the sample.
<LI>Debug\cdomfc.exe: Debug build of the application.
<LI>Release\cdomfc.exe: Release build of the application.
<P>
</UL><h3>CDO Functionality Illustrated</h3>
 
<P>
The following tasks are illustrated by this application:

<UL><LI>Create MAPI.Session.
<LI>Logon with prompt for profile.
<LI>Logon with specified profile.
<LI>Create a new message.
<LI>Add and resolve recipients selected from the AddressBook.
<LI>Add and resolve specified recipients.
<LI>Attach a specified file to the message.
<LI>Send the message without displaying the message form.
<LI>Send the message by displaying the message form first.
<LI>Logoff the session.
<P>
</UL>Although there is a tremendous amount of functionality that is not
illustrated in this basic sample, the basics for calling any of the
methods, modifying the generated classes, and getting/setting properties
can be applied to all other areas of the CDO library.
<P>
<P><h3>Modification of ClassWizard-Generated Files</h3>
 
<P>
The Olemsg32.h and Olemsg32.cpp files were generated by the ClassWizard
from the Olemsg32.dll library. These files were then modified in the
following ways:

<UL><LI>Allows for calling methods with fewer or no parameters. For example,
   Session-&gt;Logon() was overridden to allow for no or one parameter rather
   than requiring all seven of the possible parameters.

<LI>Allows for a specific return value type, rather than the generic VARIANT
   data type. For example, the Message-&gt;GetAttachments() method was
   modified to return an Attachments collection rather than a VARIANT.
<P>
</UL>Some classes not used by this sample were also modified and methods
overridden to provide a starting point for re-use.
<P>
<P><h2>Readme.txt (for Sampcdo.exe)</h2>
 
<P>
<P><h3>CDOSAMP Sample Application</h3>
 
<P>
This project was created and built on the use of Collaboration Data Objects
(CDO) (formerly known as Active Messaging) version 1.1. However, the
functionality that is illustrated in this application is backwards-
compatible with 1.0 (except for creating of MAPI.Session) and forward-
compatible with version 1.2 that is now available with Microsoft Exchange
Server 5.5.
<P>
<P><h3>Purpose</h3>
 
<P>
This application provides a working sample for troubleshooting problems
when calling the CDO library directly with InvokeHelper, GetProperty, and
SetProperty. This sample is implemented as a Console application in order
to keep it as simple as possible.
<P>
<P><h3>Application Files</h3>
 
<P>
The following files are included with this sample:

<UL><LI>Cdosamp.dsw: Microsoft Visual C++ 5.0 Workspace.
<LI>Cdosamp.dsp: Microsoft Visual C++ 5.0 Project File.
<LI>Main.cpp: Main code file containing the menu and related functions.
<LI>Utility.cpp: File containing the custom Invoke and Get/SetProperty
   helper functions.
<LI>Cdosamp.h: Main header file for the application.
<LI>Readme.txt: Automatically generated by MFC AppWizard.
<LI>Debug\Cdosamp.exe: Debug build of the application.
<LI>Release\Cdosamp.exe: Release build of the application.
<P>
</UL><h3>CDO Functionality Illustrated</h3>
 
<P>
The following tasks are illustrated by this application:

<UL><LI>Create MAPI.Session.
<LI>Logon with prompt for profile.
<LI>Logon with specified profile; the code could be modified to
   change the specified profile or to allow the user to enter a
   profile name.
<LI>Create a new message.
<LI>Add, resolve, and list recipients selected from the AddressBook
<LI>Add, resolve specified recipients; the code could be modified to
   change the specified recipients or to allow the user to enter a
   list of recipients.
<LI>Attach a specified file to the message; the code could be
   modified to change the specified file or to allow the user to
   enter a file name.
<LI>Send the message without displaying the message form.
<LI>Send the message by displaying the message form first.
<LI>Logoff the session.
<LI>Delete the session.
<P>
</UL>Although there is a tremendous amount of functionality that is not
illustrated in this basic sample, the basics for calling any of the methods
and getting/setting properties can be applied to all other areas of the CDO
library.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ActMsg OleMsg vc50<BR>
Keywords          : kbcode cdo<BR>
Version           : WINDOWS:1.1,1.2<BR>
Platform          : WINDOWS<BR>
Issue type        : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
