

<HTML>
<HEAD>
<TITLE>FILE: Simple MAPI Console Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171096">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1997/07/08">
<META NAME="Keywords" CONTENT="kbsample SMapiCMC">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  This is a Simple MAPI console application that demonstrates how to use most of the Simple MAPI functions available. It is written in Microsoft Visual C++ 5.0 but any previous version of the compiler works just as well.  The following file is availa...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAGU,QAR2,QAEV,QAD2,QAV1,QAV0,QAC2,QAV5,QAH6,QAJH,QBXB,QAUD,QANE,QAL7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Simple MAPI Console Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171096</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Simple Messaging Application Programming Interface (MAPI), version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This is a Simple MAPI console application that demonstrates how to use most
of the Simple MAPI functions available. It is written in Microsoft Visual
C++ 5.0 but any previous version of the compiler works just as well.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/smplmapi.exe">Smplmapi.exe</A> <I>(size: 57431 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This self-extracting executable file contains the following files:
<P>
SwapMain.cpp
SwapMain.h
Swap.cpp
Swap.h
Swap.exe
<P>
SwapMain.cpp is the main controlling program file. It is responsible for
displaying a menu to the user and interpreting the commands given by the
user. The code in this file is written specifically for a console
application, but because it makes calls into a separate module that
implements functionality using a user-defined class, a windows style
application could be easily substituted as the main controller of the
application.
<P>
Swap.cpp is the implementation of an application class that provides the
basic functionality required by the menu presented in the main control
module.
<P>
This messaging application is a Simple MAPI client. It implements the
following features:

<UL><LI>Present the user with a menu
<LI>Logon to messaging system
<LI>Select a recipient/Get e-mail address
<LI>Enter e-mail address/Get recipient
<LI>Get details of recipient
<LI>Send mail message to recipient using default UI
<LI>Send mail message to recipient with no user interface
<LI>Send mail message with an attachment
<LI>Create a new message
<LI>List messages in the Inbox
<LI>Read next unread message
<LI>Log off of the messaging system
<LI>Exit the client
<LI>Refresh the menu
<P>
</UL>The following features are not discussed in this document because the code
to implement them is trivial and not related to MAPI at all:

<UL><LI>Present the user with a menu
<LI>Exit the client
<LI>Refresh the menu
<P>
</UL><h3>Logon to Messaging System</h3>
 
<P>
The user is prompted for a profile name. If it can find the profile name in
the list of profiles, it will log the user on to the messaging system. If
it cannot find the profile entered by the user in the list of profiles, the
user is to cancel the operation or choose from an existing list.
<P>
<P><h3>Select a Recipient/Get E-Mail Address</h3>
 
<P>
The user is prompted with an address book list. When an entry is chosen
from this list, the method allocates a buffer and stuffs the buffer with
the e-mail address of the recipient chosen in the list. The buffer must be
released by the caller of this method.
<P>
<P><h3>Enter E-Mail Address/Get Recipient</h3>
 
<P>
The user is prompted to type an e-mail address. When a valid e-mail name is
entered and found in the address book, the method allocates storage for a
buffer and stuffs the buffer with the display name of the e-mail alias. The
buffer allocated in this method must be released by the caller.
<P>
<P><h3>Get Details of Recipient</h3>
 
<P>
The user is prompted to type an e-mail address. When a valid e-mail address
is entered and found in the address book, the user is presented a "details"
page filled with information specific to the e-mail address entered by the
user.
<P>
<P><h3>Send Mail Message to Recipient Using Default UI</h3>
 
<P>
The user is prompted with the default "Compose Note" form. When the message
has been given a recipient to send to and the send button is pressed, the
intended recipient gets the message.
<P>
<P><h3>Send Mail Message to Recipient with No User Interface</h3>
 
<P>
The user is prompted for the intended recipient. After a valid recipient is
entered, a hard-coded message is sent to the intended recipient.
<P>
<P><h3>Send Mail Message with an Attachment</h3>
 
<P>
The user is prompted for the intended recipient. After a valid recipient is
entered, the user is prompted for the file and path of a file to attach.
The file name must be the 8.3 representation of the file to attach. The
path name must be in the following format: "c:\windows\" (Note: the
trailing backspace is mandatory). A message is then sent to the intended
recipient.
<P>
<P><h3>Create a New Message</h3>
 
<P>
A new message is automatically created in the Inbox of the user's default
message store.
<P>
<P><h3>List Messages in the Inbox</h3>
 
<P>
The user is presented with a list of the messages in the user's default
message store Inbox.
<P>
<P><h3>Read Next Unread Message</h3>
 
<P>
The user is presented with the contents of the next unread message in the
default message store Inbox.
<P>
<P><h3>Log Off of the Messaging System</h3>
 
<P>
The session handle is released and the user is logged off of the messaging
system. No MAPI specific menu options are available until the user requests
to be logged back on to the messaging system. The application remains
running until the user chooses to exit the application. If the user elects
to exit the application without first logging off, the session is
terminated in an orderly fashion and then the application closes.
<P>
 
<PRE>Keywords          : kbsample SMapiCMC
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbhowto
Solution Type     : kbfile</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
