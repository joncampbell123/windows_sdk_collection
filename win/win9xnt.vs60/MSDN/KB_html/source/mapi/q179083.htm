

<HTML>
<HEAD>
<TITLE>HOWTO: Read Address Book Properties in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179083">
<META NAME="KBModify" CONTENT="1998/01/14">
<META NAME="KBCreate" CONTENT="1998/01/08">
<META NAME="Keywords" CONTENT="cdo">
<META NAME="KBArea" CONTENT="Support; KB; mapi">
<META NAME="Description" CONTENT="  This article provides an example of how to use Visual Basic to retrieve some of the more common fields available in the address book. This article also shows how to use a filter on the address book.  MORE INFORMATION  Create a reference to the Micr...">
<META NAME="Product" CONTENT="mapi">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVX,QBS0,QAD2,QBXB,QBXS,QAUJ,QANF,QBXD,QAPN,QBQX,QA5F,QAMA,QAS6,QARM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Read Address Book Properties in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 14, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179083</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Collaboration Data Objects (CDO), version 1.2
<LI>Microsoft Visual Basic Standard and Enterprise Editions for Windows,
   versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides an example of how to use Visual Basic to retrieve
some of the more common fields available in the address book. This article
also shows how to use a filter on the address book.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Create a reference to the Microsoft Collaboration Data Objects (CDO) 1.2
Library and copy the following code to a Visual Basic form:
<P>
<PRE>   Option Explicit

    Private Sub Command1_Click()

       Const strServer = "MyServer"
       Const strMailbox = "MyMailbox"

       Dim objSession As MAPI.Session
       Dim objAddrEntries As AddressEntries
       Dim objAddressEntry As AddressEntry
       Dim objFilter As AddressEntryFilter
       Dim strProfileInfo As String

       strProfileInfo = strServer &amp; vbLf &amp; strMailbox

       Set objSession = CreateObject("MAPI.Session")
       objSession.Logon , , False, False, , True, strProfileInfo
       Set objAddrEntries = objSession.AddressLists _
                           ("Global Address List").AddressEntries
       Set objFilter = objAddrEntries.Filter
       objFilter.Fields.Add CdoPR_SURNAME, "LastName"
       objFilter.Fields.Add CdoPR_GIVEN_NAME, "FirstName"
       On Error Resume Next
       For Each objAddressEntry In objAddrEntries
          Debug.Print objAddressEntry.Name
          Debug.Print "E-address: " &amp; objAddressEntry.Address
          Debug.Print "Given Name: " &amp; _
                      objAddressEntry.Fields(CdoPR_GIVEN_NAME).Value
          Debug.Print "Initials: " &amp; objAddressEntry.Fields _
                      (CdoPR_INITIALS).Value
          Debug.Print "Surname: " &amp; objAddressEntry.Fields _
                      (CdoPR_SURNAME).Value
          Debug.Print "Display Name: " &amp; objAddressEntry.Fields _
                      (CdoPR_DISPLAY_NAME).Value
          Debug.Print "Alias: " &amp; _
                      objAddressEntry.Fields(CdoPR_ACCOUNT).Value
          Debug.Print "Title: " &amp; _
                      objAddressEntry.Fields(CdoPR_TITLE).Value
          Debug.Print "Company Name: " &amp; objAddressEntry.Fields _
                      (CdoPR_COMPANY_NAME).Value
          Debug.Print "Office Location: " &amp; objAddressEntry.Fields _
                      (CdoPR_OFFICE_LOCATION).Value
          Debug.Print "Office Phone 1: " &amp;  objAddressEntry.Fields _
                      (CdoPR_OFFICE_TELEPHONE_NUMBER).Value
          Debug.Print "Office Phone 2: " &amp; objAddressEntry.Fields _
                      (CdoPR_OFFICE2_TELEPHONE_NUMBER).Value
          Debug.Print "Business Fax: " &amp; objAddressEntry.Fields _
                      (CdoPR_BUSINESS_FAX_NUMBER).Value
          Debug.Print "Mobile Phone: " &amp; objAddressEntry.Fields _
                      (CdoPR_MOBILE_TELEPHONE_NUMBER).Value
          Debug.Print "Pager: " &amp; objAddressEntry.Fields _
                      (CdoPR_PAGER_TELEPHONE_NUMBER).Value
          Debug.Print "Assistant: " &amp; objAddressEntry.Fields _
                      (CdoPR_ASSISTANT).Value
          Debug.Print "Assistant Phone: " &amp; objAddressEntry.Fields _
                      (CdoPR_ASSISTANT_TELEPHONE_NUMBER).Value
          Debug.Print "Home Phone 1: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME_TELEPHONE_NUMBER).Value
          Debug.Print "Home Phone 2: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME2_TELEPHONE_NUMBER).Value
          Debug.Print "Home Fax: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME_FAX_NUMBER).Value
          Debug.Print "Home Street: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME_ADDRESS_STREET).Value
          Debug.Print "Home City: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME_ADDRESS_CITY).Value
          Debug.Print "Home State: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME_ADDRESS_STATE_OR_PROVINCE).Value
          Debug.Print "Home Postal Code: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME_ADDRESS_POSTAL_CODE).Value
          Debug.Print "Home Country: " &amp; objAddressEntry.Fields _
                      (CdoPR_HOME_ADDRESS_COUNTRY).Value
          Debug.Print "Manager Name: " &amp; objAddressEntry.Fields _
                      (CdoPR_MANAGER_NAME).Value
          Debug.Print "Manager Name: " &amp; objAddressEntry.Manager
       Next
       objSession.Logoff
       Set objFilter = Nothing
       Set objAddrEntries = Nothing
       Set objSession = Nothing
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ActMsg<BR>
Keywords          : cdo<BR>
Version           : WINDOWS:1.2,4.0,5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 14, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
