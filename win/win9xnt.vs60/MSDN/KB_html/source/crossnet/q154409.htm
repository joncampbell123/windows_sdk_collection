

<HTML>
<HEAD>
<TITLE>Setting WINS Clients Refresh Intervals to Occur Infrequently </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154409">
<META NAME="KBModify" CONTENT="1997/09/04">
<META NAME="KBCreate" CONTENT="1996/08/05">
<META NAME="Keywords" CONTENT="nttcp wfw wfwg kbnetwork kbhowto kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  If you want to set a WINS client to refresh its names with the WINS server infrequently, you must make a change in the registry (or System.ini file if you are using Windows for Workgroups 3.11).  MORE INFORMATION  In environments with Dial-on-Deman...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAXB,QBWP,QAGI,QDL9,QBWN,QARL,QADN,QBWQ,QALB,QABA,QAUJ,QAKD,QBXS,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Setting WINS Clients Refresh Intervals to Occur Infrequently</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154409</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.11 3.50 3.51 4.00 95
WINDOWS
kbnetwork kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation, versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server, versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows for Workgroups, version 3.11
<LI>Microsoft TCP/IP-32 for Windows for Workgroups, versions 3.11, 3.11a,
   and 3.11b
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you want to set a WINS client to refresh its names with the WINS server
infrequently, you must make a change in the registry (or System.ini file if
you are using Windows for Workgroups 3.11).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In environments with Dial-on-Demand routers, frequent name refreshes may
create undesirable router traffic that can be limited by adding a static
entry for the client in WINS.
<P>
When a WINS client is started, it sends its name registrations to the WINS
server. If the WINS server is across a Dial-on-Demand router, the router
dials.
<P>
The WINS client then sends a refresh request of its name to the WINS
server. The first attempt to send the refresh request occurs when one-
eighth of its InitialRefreshTimeout interval expires. By default, the value
for the InitialRefreshTimeout is 960,000 ms (or 16 minutes), and one-eighth
of that value is two minutes.
<P>
The minimum value for this registry entry is 960,000 ms, so it is
impossible to prevent the refresh request from occurring. Setting the value
in the registry to 0xffffffff defines the interval for the refresh request,
or one-eighth of the IntitialRefreshTimeout, to approximately 50 days.
<P>
Once a WINS server receives the refresh request from the WINS client across
the router, the WINS server returns a refresh response. The server's
refresh response includes the client's renewal interval, which the client
uses to determine the wait time before its next refresh request. This is
determined by one-eighth of the renewal interval (which by default is 96
hours, so the next refresh will occur in 12 hours).
<P>
You can change the value if the InitialRefreshTimeout setting according to
your needs. For more information on where you can change this parameter,
see the section below for your version of Windows.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from the
use of Registry Editor can be solved. Use this tool at your own risk.
<P>
<P><h3>Windows NT</h3>
 
<P>
For computers running Windows NT Server or Windows NT Workstation, you can
change the registry entry for InitialRefreshTimeout. It is located in the
following registry key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NetBt\Parameters

      InitialRefreshTimeout     REG_DWORD

      Range  :  960,000 to 0xFFFFFFF milliseconds
      Default:  960,000 (16 minutes)

</PRE>This parameter specifies the initial refresh timeout used by NetBIOS over
TCP/IP (NBT) during name registration. NBT tries to contact the WINS
servers at one-eighth of this time interval when it first registers names.
When it receives a successful registration response, that response contains
the new refresh interval to use.
<P>
<P><h3>Windows for Workgroups 3.11</h3>
 
<P>
For computers running Windows for Workgroups 3.11, you can add the
following line to the [NBT] section of the System.ini file:
<P>
<PRE>   InitialRefreshT.O.=&lt;value in milliseconds&gt;

</PRE><h3>Windows 95</h3>
 
<P>
For computers running Windows 95, you can change the registry entry for
InitialRefreshTimeout. It is located in the following registry key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\MSTCP

      InitialRefreshTimeout:  REG_DWORD:     milliseconds
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: networking<BR>
Keywords          : nttcp wfw wfwg kbnetwork kbhowto kbnetwork<BR>
Version           : 3.11 3.50 3.51 4.00 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
