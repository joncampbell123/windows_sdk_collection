

<HTML>
<HEAD>
<TITLE>How to Change Name Resolution Order on Windows 95 and Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139270">
<META NAME="KBModify" CONTENT="1997/10/23">
<META NAME="KBCreate" CONTENT="1995/11/08">
<META NAME="Keywords" CONTENT="nttcp kbhowto kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  The following registry entries control name resolution order for Windows NT version 3.5x and Windows 95:     DnsPriority    LocalPriority    HostsPriority    NetbtPriority  Each value is a DWORD between -32768 and 32767, specified in hexadecimal no...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDL9,QBWN,QBWO,QAKD,QAUJ,QBWQ,QAOY,QACK,QAKC,QBXS,QABA,QARM,QDNF,QAB6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Change Name Resolution Order on Windows 95 and Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139270</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following registry entries control name resolution order for Windows NT
version 3.5x and Windows 95:
<P>
<PRE>   DnsPriority
   LocalPriority
   HostsPriority
   NetbtPriority

</PRE>Each value is a DWORD between -32768 and 32767, specified in hexadecimal
notation. The lower the value, the higher the priority in the search order.
You can use existing values by rearranging them in a needed order. (Use
scientific calculator, for example, to compare hexadecimal numbers).
Deleting an entry disables the corresponding resolution method.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q170619.htm">Q170619</A></B>
   TITLE     : Windows 95 ServiceProvider Priority Values Not Applied

</PRE>The following registry entry controls name resolution order for Windows NT
version 4.0:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services
   \Tcpip\Parameters\DnsNbtLookupOrder

</PRE>A value of 0 (default) indicates that DNS name resolution has priority over
NetBIOS over TCPIP (NetBT). A value of 1 indicates that NetBT name
resolution has priority over DNS.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q171567.htm">Q171567</A></B>
   TITLE     : NT 4.0 ServiceProvider Priority Values Not Applied

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The above entries are found in the following registry locations:
<P>
<P><h3>Windows NT</h3>
 
<P>
<PRE>   \HKEY_LOCAL_MACHINE
    \System
     \CurrentControlSet
      \Services
       \TCPIP
        \ServiceProvider

</PRE><h3>Windows 95</h3>
 
<P>
In order to set priorities in Windows 95, you must create new keys and
values with the following steps:

<OL><P><LI>Use regedit to open the following location:
<P>
<P><PRE>      \HKEY_LOCAL_MACHINE
       \System
<PRE></PRE>        \CurrentControlSet
         \Services

</PRE><P><LI>Click on Edit, New, then Key to create a new key under Services and name
   it MSTCP.

<P><LI>Move to the new MSTCP key, and click on Edit, New, then Key to create a
   new key under MSTCP and name it ServiceProvider.
<P>
   The registry path should now look like this:
<P>
<P><PRE>      \HKEY_LOCAL_MACHINE
       \System
<PRE></PRE>        \CurrentControlSet
         \Services
          \MSTCP
           \ServiceProvider

</PRE><P><LI>Move to the new ServiceProvider key, and click on Edit, New, then Binary
   Value to add the priority values noted above (DnsPriority,
   LocalPriority, HostsPriority, and NetbtPriority).

<P><LI>Set the priority values as needed.
<P>
</OL>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../crossnet/q119372.htm">Q119372</A></B>
   TITLE     : Setting the Name Resolution Search Order for TCP/IP-32
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 3.50 3.51 4.00<BR>
Keywords          : nttcp kbhowto kbnetwork<BR>
Version           : 95 3.50 3.51 4.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
