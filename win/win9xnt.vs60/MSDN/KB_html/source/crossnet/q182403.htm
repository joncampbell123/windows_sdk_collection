

<HTML>
<HEAD>
<TITLE>XADM: Store Causes Access Violation in NdrServerUnmarshall </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182403">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1998/03/12">
<META NAME="Keywords" CONTENT="XADM">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  The Microsoft Exchange Server information store may unexpectedly terminate with an access violation. If Windows NT Server and Microsoft Exchange Server symbols are installed and correct, the Drwtsn32.log may look similar to the following:     Appli...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI4,QAR4,QA1S,QBW7,QAI5,QBWP,QBWG,QDN9,QDIK,QAKP,QA5E,QAY0,QAYZ,QAM1,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Store Causes Access Violation in NdrServerUnmarshall</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182403</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Server information store may unexpectedly terminate
with an access violation. If Windows NT Server and Microsoft Exchange
Server symbols are installed and correct, the Drwtsn32.log may look similar
to the following:
<P>
<PRE>   Application exceptionoccurred:
   App: store.DBG (pid=166)
   When: 11/10/1997 @ 16:17:26.516
   Exception number: c0000005 (access violation)

</PRE>The call stack will look like following:
<P>
<PRE>   kb
   FramePtr  RetAddr   Param1   Param2   Param3       Function Name
   0ba9fb38  77e8e9cb  00000000 0ba9ff10 0ba9fc64
   RPCRT4!NdrServerUnmarshall+0x1d3
   0ba9fe28  77e8e876  00000000 00000000 0ba9ff10  RPCRT4!NdrStubCall+0x14f
   0ba9fe40  77e61438  0ba9ff10 0ba9fec8 00000000
   RPCRT4!NdrServerCall+0x15
   0ba9fe7c  77e61374  02002b34 0ba9ff10 0ba9ff3c
   RPCRT4!DispatchToStubInC+0x34
   0ba9fed0  77e6162d  0ba9ff10 00000000 0ba9ff3c
   RPCRT4!?DispatchToStubWorker@RPC_INTERFACE@@AAEJPAU_RPC_MESSAGE@@IPAJ@Z+
   0xd6
   0ba9fef0  77e6c005  0ba9ff10 00000000 0ba9ff3c
   RPCRT4!?DispatchToStub@RPC_INTERFACE@@QAEJPAU_RPC_MESSAGE@@IPAJ@Z+0x5f
   0ba9ff40  77e68657  0aa14608 00000054 77e91180
   RPCRT4!?ReceiveOriginalCall@OSF_SCONNECTION@@QAEHPAUrpcconn_common@@I@Z+
   0xdb
   0ba9ff60  77e6acb1  0aa14608 00000054 00166c10
   RPCRT4!?spatchPacket@OSF_SCONNECTION@@QAEHPAUrpcconn_common@@IPAVOSF_ADD
   RESS@
   @@@Z+0x1f8
   0ba9ff8c  77e6aa73  77e649cc 00166c10 0019cff8
   RPCRT4!?ReceiveLotsaCalls@OSF_ADDRESS@@QAEXXZ+0x7f
   0ba9ff90  77e649cc  00166c10 0019cff8 001e82c0
   RPCRT4!?ReceiveLotsaCallsWrapper@@YGXPAVOSF_ADDRESS@@@Z+0x9
   0ba9ffac  77e64a03  0aa06cf8 00000024 77f46c2e
   RPCRT4!?BaseCachedThreadRoutine@@YGXPAVCACHED_THREAD@@@Z+0xae
   0ba9ffb8  77f46c2e  001e82c0 0019cff8 00000024
   RPCRT4!?ThreadStartRoutine@@YGJPAVTHREAD@@@Z+0x16
   0ba9ffec  00000000  77e649ed 001e82c0 00000000
   KERNEL32!BaseThreadStart+0x61


</PRE><h2>CAUSE</h2>
 
<P>
An exception was thrown during the unmarshalling process because of a
corrupted buffer. During the exception handling, an attempt was made to try
and free the memory block, which was invalid and therefore resulted in an
access violation.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0 and 5.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: store rpcrt4<BR>
Keywords          : XADM<BR>
Version           : WINDOWS:4.0,5.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
