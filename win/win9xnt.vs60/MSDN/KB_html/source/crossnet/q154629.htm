

<HTML>
<HEAD>
<TITLE>Automating Remote RAS Logons Using PAD.INF Scripts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154629">
<META NAME="KBModify" CONTENT="1996/12/10">
<META NAME="KBCreate" CONTENT="1996/12/09">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  You can use the PAD.INF file for X.25 networks to automate the logon process to X.25 providers, instead of using the manual RAS Terminal screen.  Most of the information pertaining to PAD.INF scripting also applies to SWITCH.INF scripting. However,...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWO,QBWP,QAEB,QAHE,QAKR,QAB5,QDL9,QBWQ,QBWN,QBVV,QAB9,QBE7,QBE6,QANN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automating Remote RAS Logons Using PAD.INF Scripts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 10, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154629</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Remote Access Service versions 1.0, 1.1, and 1.1a
<LI>Microsoft LAN Manager versions 2.1, 2.1a, 2.2, 2.2a, 2.2b, and 2.2c
<LI>Microsoft Windows for Workgroups version 3.11
<LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use the PAD.INF file for X.25 networks to automate the logon
process to X.25 providers, instead of using the manual RAS Terminal screen.
<P>
Most of the information pertaining to PAD.INF scripting also applies to
SWITCH.INF scripting. However, PAD.INF supports a few more features and has
a few more requirements.
<P>
None of the information in this article applies to Windows 95, because it
does not support the script language used in the PAD.INF and SWITCH.INF
files. Therefore, the PAD.INF and SWITCH.INF files do not exist on Windows
95. Windows 95 was not tested with X.25 dial-up and therefore is not
supported as an X.25 client, however, it may work with the Dial-Up client
After Dialing Terminal screen.
<P>
To get support for scripting under Windows 95, obtain Windows 95 Service
Pack 1 (SP1). In the Admin directory of SP1 you can find the scripting tool
Script.exe. The Admin directory also contains the Script.doc file that
describes the commands and syntax of that new script language which is
incompatible with the PAD.INF and SWITCH.INF script language.
<P>
Note: Windows NT 4.0 supports the script language used in PAD.INF and
SWITCH.INF as well as the new Windows 95 script language.
<P>
LIMITATIONS OF RAS 1.x VERSIONS
 
<P>
Microsoft RAS version 1.0 does not have the capability to invoke RAS
Terminal or use scripts in .INF files. RAS 1.1 is the first RAS version to
support X.25 with a PAD.INF file, however, SWITCH.INF and a RAS Terminal
screen are not supported. (Upgrades to RAS 1.1 and RAS 1.1a are free.) All
of the information in this article applies to all RAS versions that
have PAD.INF file support. However, the syntax is different for the RAS
version 1.1x. See your RAS version 1.1x PAD.INF, RAS manual, and release
notes for more information.
<P>
RAS for Windows for Workgroups 3.11 and Windows NT 3.1, 3.5, 3.51, and 4.0
support RAS Terminal screens as well as Windows 95, however, Windows 95 is
not supported with X.25 networks.
<P>
<P><h3>Potential PAD.INF Problem in Windows for Workgroups</h3>
 
<P>
RAS for Windows for Workgroups 3.11 may under certain circumstances not
execute PAD.INF scripts completely even though no error was encountered in
the script. If that problem occurs you can try copying your PAD.INF script
to the SWITCH.INF file and replace the special PAD.INF macros X25address,
Userdata, and Facilities (if applicable) with the actual values because
SWITCH.INF does not support these macros. See the section "Activating an
X.25 Script in SWITCH.INF in Windows for Workgroups 3.11 RAS."
<P>
<P><h3>Using PAD.INF with Non-X.25 Networks</h3>
 
<P>
PAD.INF was designed for X.25 connectivity. Although using PAD.INF with non-
X.25 networks may work, it has not been tested by, and is not supported by
Microsoft. PAD.INF has the advantage over SWITCH.INF that it has support
for three macros mentioned in the previous paragraph that are loaded from
the user interface. However, in Windows NT 3.51 and 4.0, SWITCH.INF
supports two variables: Username and Password which are conveniently loaded
through the familiar Windows NT logon dialog box. The Username and Password
variables are not available in Windows for Workgroups 3.11 RAS. Also, see
your RAS manual and Online Help for X.25 topic.
<P>
<P>
<P><h2>CREATING SCRIPTS FOR THE RAS PAD.INF FILE</h2>
 
<P>
Note: If you have Windows NT version 4.0, Microsoft recommends using the
new and improved script language described in Script.doc in the
%SystemRoot%\System32\RAS directory. However, if you are planning to run
your script on a previous version of RAS as well, you must use the PAD.INF
script language described in the following paragraphs:
<P>
The PAD.INF file is like a set of small batch files or scripts, all
contained in one file. A PAD.INF script can contain six elements: a section
header, comments, commands, responses, response keywords, and reserved
macro keywords.
<P>
In addition to dividing the PAD.INF file into individual scripts, section
headers start the scripts. Comment lines are used to document the script.
Any other line in a script is either a command or a response. A command is
issued from the local RAS client. A response is received from the remote
device or computer.
<P>
To write an automatic script for your RAS client you must know the required
commands and corresponding responses for the intermediary device. The
commands and responses must be in the exact order that the device expects
to encounter them. Branching statements, such as GOTO or IF command, are
not supported by the PAD.INF and SWITCH.INF script language. The required
sequence of commands and responses from the PAD device should be in the
device documentation. If you are connecting to a commercial service, the
required sequence of commands and responses should also be available from
the service support staff.
<P>
The PAD.INF file contains scripts for different X.25 providers or different
PADs that the RAS user calls. The scripts are activated by configuring
Remote Access Phonebook entries as described under "Configuring a Windows
NT 3.x or WFW 3.11 RAS Client for a PAD.INF X.25 Script" and "Configuring a
Windows NT 4.0 RAS Client for a PAD.INF X.25 Script"
<P>
<P><h2>SECTION HEADERS</h2>
 
<P>
A section header marks the beginning of a script, is enclosed in square
brackets, and cannot exceed 31 characters. For example:
<P>
<PRE>   [Route 66 Login]

</PRE>Each script requires one section header. The section header appears in the
RAS Phonebook field allowing you to select RAS Terminal or any other
PAD.INF script. For more information, see the "Activating PAD.INF
Scripts" section below.
<P>
<P><h2>COMMENTS</h2>
 
<P>
Comment lines are preceded by semicolons (;) in the left most margin
(column one), are optional, and can be placed anywhere in the file. For
example:
<P>
<PRE>   ; This script was created by Patrick on September 29, 1995

</PRE><h2>COMMANDS</h2>
 
<P>
A command comes from the local computer. A response comes from the remote
device or computer. The COMMAND= statement, which can be used in three
different ways, is used to send commands to the intermediary device.
<P>
NOTE: Use upper case for all PAD.INF commands.
<P>
<P><h3>COMMAND=</h3>
 
<P>
COMMAND= by itself causes an approximate two second delay, depending on CPU
speed and the presence of caching software (for example, SMARTDRV.EXE).
If the intermediary device cannot process all of the characters on a
COMMAND=&lt;CustomString&gt;&lt;cr&gt; line (because they are sent at once), use
multiple COMMAND= statements.
<P>
<P><h3>COMMAND=&lt;CUSTOM STRING&gt;</h3>
 
<P>
COMMAND=&lt;custom string&gt; sends the custom string and causes a slight delay
of several hundred milliseconds (depending on CPU speed and installed
caching software). The delay gives the intermediary device time to process
the custom string and prepare for the next command.
<P>
<P><h3>COMMAND=CUSTOM STRING &lt;cr&gt;</h3>
 
<P>
COMMAND=&lt;custom string&gt;&lt;cr&gt; sends the custom string immediately.
<P>
Consult the remote device documentation to determine which strings are
required.
<P>
<P><h2>RESPONSES</h2>
 
<P>
Each command line is followed by one or more response lines. Consult the
remote device documentation to determine which response strings and dialogs
are expected by the remote device. RAS compares responses received with
what you put on the response lines. If it matches, RAS uses the response
related keyword and macro.
<P>
<P><h2>RESPONSE KEYWORDS</h2>
 
<P>
The keyword in a response line specifies what your RAS client does with the
responses it receives from the remote computer.
<P>
The response strings your RAS client receives from the remote device or
online service can be used with one of the following keywords in response
lines:
<P>
<P><h3>OK= remote_device_response &lt;macro&gt;</h3>
 
<P>
The OK keyword indicates that RAS can execute the next script line if the
condition on the right side of the equal sign is met.
<P>
<P><h3>LOOP= remote_device_response &lt;macro&gt;</h3>
 
<P>
The LOOP keyword indicates to RAS to wait for a response that matches the
condition to the right of the equal sign and if that condition is met to
wait for the same response again. If a response does not meet the condition
on the right side of the equal sign RAS executes the next line.
<P>
<P><h3>CONNECT= remote_device_response &lt;macro&gt;</h3>
 
<P>
This keyword is used near the end of the script to indicate the end of the
script.
<P>
<P><h3>ERROR_NO_CARRIER= remote_device_response &lt;macro&gt;</h3>
 
<P>
This keyword is used to test for the presence of a carrier. Intermediary
devices report their presence in different ways.
<P>
<P><h3>ERROR_DIAGNOSTICS= remote_device_response &lt;macro&gt;</h3>
 
<P>
This keyword can be used in conjunction with the &lt;Diagnostics&gt; macro to
allow RAS to display a message box containing a problem cause and
diagnostic information.
<P>
These response related keywords are usually clustered, but do not have to
be. CONNECT= is usually the last line, unless it is followed by an ERROR_
line. For example:
<P>
<PRE>   CONNECT=&lt;match&gt;" CONNECT"
   ERROR_NO_CARRIER=&lt;match&gt;"NO CARRIER"
   ERROR_DIAGNOSTICS=&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;
   ERROR_DIAGNOSTICS=&lt;lf&gt;&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;

</PRE><h3>NORESPONSE</h3>
 
<P>
The RAS client always expects a response from the remote device. The client
waits until a response is received unless a NoResponse statement follows
the COMMAND= line. If there is no statement for a response following a
COMMAND= line, the COMMAND= line still executes, but the script does not
execute any further.
<P>
<P><h3>RESERVED MACRO KEYWORDS</h3>
 
<P>
The macros in the following list are reserved words, which you cannot
define in PAD.INF to create a new entry. Reserved words are case
insensitive.
<P>
<PRE>   Macro           Function
   -----------------------------------------------------------------------
   &lt;x25address&gt;   Inserts the value you type in the "X.121 Address" field
                  (Windows NT 3.x, WFWG 3.11) or "Address" field (Windows
                  NT 4.0) of the RAS application (Dial-Up client).

   &lt;userdata&gt;     Inserts the value you type in the User Data field in the
                  RAS application (Dial-Up client).

   &lt;facilities&gt;   Inserts the value you type in the Facilities field in the
                  RAS application (Dial-Up client).

   &lt;cr&gt;            Inserts a carriage return.

   &lt;lf&gt;            Inserts a line feed.

   &lt;match&gt;         Reports a match if the string enclosed in quotation
                   marks is found in the device response. For example,
                   &lt;match&gt;"Smith" matches Jane Smith and John Smith III.

   &lt;?&gt;             Inserts a wildcard character. For example, CO&lt;?&gt;&lt;?&gt;2
                   matches COOL2 or COAT2, but not COOL3.

   &lt;hXX&gt;           Allows any hexadecimal character to appear in a string
                   including the zero byte, &lt;h00&gt;.
                   NOTE: XX represents hexadecimal digits.

   &lt;ignore&gt;        Ignores the rest of a response from the macro. For
                   example, &lt;cr&gt;&lt;lf&gt;CONNECTV-&lt;ignore&gt; reads the following
                   responses as the same: "crlfCONNECTV-1.1" and
                   "crlfCONNECTV-2.3."

                   If a lot of information is ignored, like a large welcome
                   banner, RAS might time out and move on to the next
                   script line. This usually causes problems. To avoid this
                   problem, use multiple pairs of COMMAND= followed by
                   OK=&lt;ignore&gt; to force RAS to wait longer and ignore
                   additional response stings. For example:

                      COMMAND=
                      OK=&lt;ignore&gt;

                      COMMAND=
                      OK=&lt;ignore&gt;

   &lt;diagnostics&gt;   This macro function can be used in conjunction with the
                   ERROR_DIAGNOSITICS= keyword macro to allow RAS to
                   display a message box containing a problem cause and
                   diagnostic information.



</PRE><h2>ACTIVATING PAD.INF SCRIPTS</h2>
 
<P>
You can configure a RAS entry to run a PAD.INF script after dialing. For
example, to automate the task of logging onto a remote host, create the
script in the PAD.INF file and then configure the RAS entry to use the
created script after dialing.
<P>
To activate a script in Windows NT and Windows for Workgroups version 3.11:

<OL><P><LI>Run Remote Access and select an entry.

<P><LI>Choose the Edit button.

<P><LI>If the Security button is not available, choose the Advanced button.

<P><LI>Choose the Security button. (In Windows NT 3.1 and Windows for
   Workgroups 3.11 the button is labeled Switch).

<P><LI>In the After Dialing box, select the name of the script. The section
   header in the PAD.INF file is what appears as the name of the script.
   (In Windows NT 3.1 and Windows for Workgroups 3.11 this box is labeled
   Post-Connect).

<P><LI>Choose the OK button until you return to the main Remote Access Screen.
<P>
</OL>When you dial this entry, the selected script runs after RAS dials
and connects to the remote host.
<P>
<P>
<PRE>          Troubleshooting Scripts using DEVICE.LOG and RAS Terminal
          =========================================================

</PRE></OL>Before writing scripts to automate the process of logging onto a PAD, use
the RAS Terminal feature to familiarize yourself with the logon sequence of
events. For more information on activating the RAS Terminal feature, refer
to the "Configuring Windows RAS to Use RAS Terminal After Dialing" section
below.
<P>
To find errors that prevent your scripts from working, log all information
passed between RAS, the modem, and the PAD (including errors reported by
the intermediary device) by turning on RAS logging.
<P>
After you enable logging, the DEVICE.LOG file is created (when you start
RAS) in the Windows NT %systemroot%\SYSTEM32\RAS subdirectory or the
Windows for Workgroups \WINDOWS directory.
<P>
If an error is encountered during script execution, execution halts.
Determine the problem by looking at any RAS error messages you receive and
by looking at the DEVICE.LOG file. Make necessary corrections to the
script and then restart RAS.
<P>
The DEVICE.LOG file appends any communication as long as RAS is not
restarted. If you restart RAS, the DEVICE.LOG file is erased and re-
created. Therefore, if you make changes to PAD.INF during your script
development that require you to restart RAS, and you wish to save the
current traces contained in the DEVICE.LOG file, rename the DEVICE.LOG file
before starting RAS again.
<P>
<P>
<P><h2>ENABLING LOGGING AND CREATING A DEVICE.LOG FILE</h2>
 
<P>
To enabling logging and creating a DEVICE.LOG file under Windows NT:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Hang up any connections, and exit from Remote Access.

<P><LI>Run Registry Editor (REGEDT32.EXE).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      SYSTEM\CurrentControlSet\Services\RasMan\Parameters
</PRE>
<P><LI>Change the value of the Logging parameter to 1. For example:
<P>
<P><PRE>      Logging:REG_DWORD:0x1
</PRE><P>
</OL>Logging begins when you restart Remote Access or start the Remote Access
Server service (if your computer is receiving calls). You do not need
to shutdown and restart Windows NT.
<P>
To enabling logging and creating a DEVICE.LOG file under Windows for
Workgroups:

<OL><P><LI>Using a text editor such as Windows Notepad, edit the SYSTEM.INI file.

<P><LI>In the [Remote Access] section, add the following line:
<P>
<P><PRE>      LOGGING=1.
</PRE>
<P><LI>Save the file.
<P>
</OL>The DEVICE.LOG text file is created in the Windows directory when you
restart Windows and RAS.
<P>
<P>
<P><h2>CONFIGURING WINDOWS RAS VERSIONS TO USE RAS TERMINAL AFTER DIALING</h2>
 
<P>
To configure a Windows NT RAS 3.1, 3.5, or 3.51 entry to use Terminal after
dialing:

<OL><P><LI>In Remote Access, select an entry.

<P><LI>Choose the Edit button.

<P><LI>If the Security button is not available, choose the Advanced button.

<P><LI>Choose the Security button. (In Windows NT 3.1 and Windows for
   Workgroups 3.11 this button is labeled Switch).

<P><LI>In the After Dialing field, select Terminal. (In Windows NT 3.1 and
   Windows for Workgroups 3.11 this is labeled Post-Connect).

<P><LI>Choose the OK button until you return to the main Remote Access Screen.
<P>
<P>
</OL>To configure a Windows NT RAS 4.0 entry to use Terminal after dialing:

<OL><P><LI>In Dial-Up Networking, select a phonebook entry and then click More and
   choose Edit entry and modem properties.

<P><LI>In the Script tab under After Dialing (Login), click on Pop Up A
   Terminal Window.
<P>
<P>
</OL><h2>CREATING ONE SCRIPT FOR MULTIPLE SITUATIONS</h2>
 
<P>
RAS for Windows NT 4.0 supports a new script language that supports
subroutines, IF, WHILE, and GOTO command, etc. which allows for complex
scripts. Windows 95 supports the same script language, but was not tested
with X.25 and therefore is not supported in that environment, however, it
may work.
<P>
A company with employees working at different locations may need to provide
employees with the ability to log on to an X.25 service from various
locations requiring different scripts. Not all employees may have the same
RAS versions and the RAS script language on pre-Windows NT 4.0 RAS does not
provide any IF, or GOTO statements or support for subroutines. Therefore,
you cannot test for logical responses or errors received from a PAD and
then branch off to a different execution path. However, the script language
does allow you to catch errors and display them on the screen using:
<P>
<PRE>   ERROR_DIAGNOSTICS=&lt;cr&gt;&lt;lf&gt;&lt;Diagnostics&gt;

</PRE></OL>To provide a variety of RAS clients with a PAD.INF or SWITCH.INF script you
need to write several scripts in the PAD.INF file to manage all local logon
dialog variations. For example:
<P>
<PRE>   If you have a Windows for Workgroups 3.11 RAS client or Microsoft RAS
   1.1a client, set an environment variable to a value representing the
   local X.25 carrier. Then run a batch file that copies the correct script
   to the file name PAD.INF or SWITCH.INF (depending on the value of the
   environment variable) and then start Windows.

   If you have a Windows NT RAS client, create an icon that runs a similar
   batch file that tests the environment variable and then runs RAS. All
   scripts can be provided on one disk and all the user has to do is copy
   the files to a directory on their hard drive and set the environment
   variable. This can be automated as well to minimize user interaction.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kb3rdparty kbnetwork<BR>
KBSubcategory: ntras ntprotocol<BR>
Additional reference words: prodnt 3.10 3.11 3.50 1.10 1.10a 1.1x 1.x phone<BR>
book<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 10, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
