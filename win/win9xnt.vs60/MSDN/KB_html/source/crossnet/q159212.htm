

<HTML>
<HEAD>
<TITLE>Office 95 Used on Windows NT or Windows 95 with Profiles </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159212">
<META NAME="KBModify" CONTENT="1997/12/05">
<META NAME="KBCreate" CONTENT="1996/11/11">
<META NAME="Keywords" CONTENT="nt32ap ntregistry NTSrvWkst kbhowto kbinterop kbsetup kbusage">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  The use of the registry for application information (instead of INI files) is new to Microsoft Office in version 7.0. Between user profiles and Registry Security under Windows NT, several issues have been encountered. The scope of this article is t...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBWP,QDIZ,QBVQ,QAGU,QA1S,QDL9,QBWO,QBWN,QDNQ,QBWS,QA9N,QBWG,QBT9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Office 95 Used on Windows NT or Windows 95 with Profiles</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159212</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.51 4.00
WINDOWS
kbsetup kbusage kbinterop kbhowto
<P>
 
The information in this article applies to:
<UL><LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Windows NT Workstation versions 3.51, 4.0
<LI>Microsoft Windows NT Server versions 3.51, 4.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The use of the registry for application information (instead of INI files)
is new to Microsoft Office in version 7.0. Between user profiles and
Registry Security under Windows NT, several issues have been encountered.
The scope of this article is to identify and propose a resolution or
workaround for each issue.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Two Categories of Issues</h3>
 
<P>
The problems occur when Office 95 is not installed under the user's login
ID. With Windows NT 3.51, there are two primary categories of issues that
will affect all such users; with Windows 95 with profiles, there is one.
The category shared by both is that of missing registry entries.
<P>
<P><h3>Missing Registry Entries</h3>
 
<P>
The applications rely on information stored in Current User and Local
Machine registry entries. Currently, Setup configures approximately 158
keys in the Current User section. Microsoft Word and Microsoft Excel
migrate some of these keys, but for users who have not run Setup, about
100 keys or so will be missing. Most of the missing keys for Microsoft
Word or Microsoft Excel are for more advanced functionality, but, for
Microsoft PowerPoint, the loss of functionality is more noticeable.
<P>
Solution:  Setup /y /r
<P>
Because more than just a few registry keys are involved, modifying the
registry directly is not recommended. Therefore, the only solution is to
have each user run some form of setup. When Setup is combined with
specific command-line switches, the user is inconvenienced only once for
about 3 to 5 minutes. The command-line switches used are /y, which
specifies a setup without file copying, and /r, which bypasses the
maintenance mode dialog box and goes directly into a [Reinstall]. This
presents the user with no dialog boxes, but writes all the necessary
entries into the Current User section of the registry.
<P>
Because a maintenance mode [Reinstall] will be performed and will install
without copying files, it is essential that a normal installation
(including the copying of all necessary files) have been done on the
workstation.
<P>
<P><h3>Adding Office Setup to a Login Script</h3>
 
<P>
The least obtrusive way to have all users run Setup is to place it in
their login script. In order to prevent multiple executions of Setup, you
can use a procedure that uses two BAT files in addition to the login
script modification. Add the following to the login script (see your
network documentation for information on creating login scripts). This
modification does not need to be, but can be, removed later.
<P>
(The items %homeshare% and %username% are environment variables available
to a Windows NT login script.)
<P>
<PRE>   REM ******** Office 95 Setup routine ********
   IF NOT EXIST %homeshare%\%username%\OFFICE95.BAT COPY

   \\&lt;ServerA&gt;\&lt;ShareA&gt;\OFFICE95.BAT %homeshare%\%username%\OFFICE95.BAT
   %homeshare%\%username%\OFFICE95.BAT
   REM ********

</PRE>This procedure copies the batch file, if it does not exist, and then runs
it. The first time Office95.bat runs, it will start Setup with the
preferred switches and then replace itself with a harmless, non-action
batch file.
<P>
<PRE>   OFFICE95.BAT
   REM ******** Office 95 Setup Batch file ********
   \\&lt;Server&gt;\&lt;Share&gt;\&lt;Path to Office 95&gt;\SETUP.EXE /y /r
   COPY \\&lt;ServerA&gt;\&lt;ShareA&gt;\POSTOFF.BAT
   %homeshare%\%username%\OFFICE95.BAT
   REM ********

</PRE>Note that the path &lt;Server&gt;\&lt;Share&gt;\&lt;Path to Office 95&gt; is replaced with
the location where you installed the administration copy of Office 95 and
that &lt;ServerA&gt;\&lt;ShareA&gt; can be any common share point that contains these
two original BAT files.
<P>
<PRE>   POSTOFF.BAT
   REM ******** Post Office 95 Setup Batch file ********
   REM    Office95 has been installed for this user
   REM ********

</PRE><h3>Caveats of Using Re-Install</h3>
 

<UL><LI>Users will have their own personal group under Windows NT, even if a
   common group already exists.

<LI>Under obscure circumstances, Microsoft Word and Microsoft PowerPoint
   are removed instead of installed. (Microsoft is still trying to isolate
   the cause, as the problem is very difficult to reproduce.)

<LI>In a RunFromServer (RFS) installation that includes Microsoft Access,
   paths to System.mdw and bitmaps for the Wizards are redirected to an
   invalid location.
<P>
</UL><h3>Inappropriate Permission Requests of Registry Entries</h3>
 
<P>
There are four known scenarios where Office 95 applications try to access
information in the Registry, requesting Full Control when Read/Write is
all that is needed. This causes the request to fail and the function may
seem to not be installed.

<OL><P><LI>The original release of Microsoft PowerPoint requests Full Control to
   the Shared Tools keys \\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared
   Tools and all subkeys. This was corrected with Microsoft PowerPoint
   7.0b, as noted in Knowledge Base article <B><A href="../zmiscellaneous/q139150.htm">Q139150</A></B>, in the Microsoft
   PowerPoint section. A copy of the maintenance release can be obtained
   from Microsoft Technical Support or Microsoft Customer Service.

<P><LI>The original release of ClipArt Gallery has the problem with
   \\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ClipArt Gallery and all
   subkeys.
<P>
   This problem is corrected with the updated ClipArt Gallery downloadable
   from the following Microsoft FTP Site.
<P>
   <B><A href="ftp://ftp.microsoft.com/softlib/mslfiles/cag20a.exe">ftp://ftp.microsoft.com/softlib/mslfiles/cag20a.exe</A></B>
<P>
   Cag20a contains an updated Artgalry.exe with an accompanying ReadMe
   document explaining the installation procedure. If a RunFromServer
   installation is being used, a modification to the INF will also be
   necessary. The name of the appropriate INF file will depend on the
   application involved but will be found in the directory with Setup.exe.
   For example, Office 95 Professional for Windows 95 will use
   Off95pro.inf. The following changes are necessary:
<P>
   a. Make a backup copy of your INF file.
<P>
   b. Open the INF using WordPad or Write.
<P>
   c. Find artgalry_exe. This should bring you to the line to be
<P><PRE>      modified.
</PRE><P>
   d. Exit the Find dialog.
<P>
   e. The version number 2.0.0.556 should be near the end of the line.
<P><PRE>      Carefully edit it to read 2.0.1.625, taking care not to remove any
      commas.
</PRE><P>
   f. Save the file and exit the editor.

<P><LI>All versions of Microsoft Access 7.0 have the problem with
   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Access\7.0\Wizards and all
   subkeys. The following steps explain how to work around this issue:
<P>
   a. Log on to the computer running Windows NT 3.51, as an administrator.
<P>
   b. Run the Registry Editor (Regedt32.exe).
<P>
   c. From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<PRE>        SOFTWARE\Microsoft\Access\7.0\Wizards

   d. On the Security menu, click Permissions.

   e. Change Everyone in the permissions list from the permissions of
      Special Access to Full Control.

   f. Select the Replace Permission on Existing Subkeys check box.

   g. Click OK to save the changes made to the permissions.

   h. Click Yes when prompted, "Do you want to replace the permission on
      all existing subkeys within Wizards?"

   i. Exit Registry Editor.

</PRE><P><LI>This last known scenario is minor in comparison to the other three.
   Although System Info can be used from all other Office 95 applications
   via Help About, it fails in Microsoft Excel because it tries to access
   the registry, requesting greater permissions than needed. The affected
   key is HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\MSInfo. The
   steps to work around this issue are:
<P>
   a. Log on to the computer running Windows NT 3.51, as an administrator.
<P>
   b. Run the Registry Editor (Regedt32.exe).
<P>
   c. From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<PRE>        SOFTWARE\Microsoft\Shared Tools\MSInfo

   d. On the Security menu, click Permissions.

   e. Change Everyone in the permissions list from the permissions of
      Special Access to Full Control.

   f. Click OK to save the changes made to the permissions.

   g. Exit Registry Editor.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbusage kbinterop kbhowto<BR>
KBSubcategory: nt32ap NTSrvWkst ntregistry<BR>
Additional reference words: 3.51 4.0 prodnt winnt win95 OFF7<BR>
Keywords          : nt32ap ntregistry NTSrvWkst kbhowto kbinterop kbsetup kbusage<BR>
Version           : 3.51 4.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
