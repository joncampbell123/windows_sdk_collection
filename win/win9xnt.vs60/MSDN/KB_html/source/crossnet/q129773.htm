

<HTML>
<HEAD>
<TITLE>Error Message: LPT&lt;n&gt;: Windows Cannot Write to This File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129773">
<META NAME="KBModify" CONTENT="1996/09/10">
<META NAME="KBCreate" CONTENT="1995/05/03">
<META NAME="Keywords" CONTENT="kbinterop kbprint kbnetwork kbprb">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT=" This article contains information about using Windows for Workgroups version 3.11 with third-party products or configurations that have not been tested and are not supported by Microsoft.  If the steps in this article do not function properly, use a...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QAB4,QDL9,QBWQ,QBWN,QBXS,QAOX,QDNT,QABA,QBVV,QBAO,QAG9,QAEV,QABX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Message: LPT&lt;n&gt;: Windows Cannot Write to This File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 10, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129773</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.11
<LI>Microsoft TCP/IP for Windows for Workgroups version 3.11
<LI>Microsoft Windows NT Workstation version 3.5
<LI>Microsoft Windows NT Server version 3.5
</UL> 
<P>
This article contains information about using Windows for Workgroups
version 3.11 with third-party products or configurations that have not
been tested and are not supported by Microsoft.
<P>
If the steps in this article do not function properly, use a supported
configuration or contact the manufacturer of your third-party product for
more information.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to print to a shared printer from a Windows-based program
such as Microsoft Word for Windows or Microsoft Excel, you receive the
following error message:
<P>
<PRE>   LPT&lt;n&gt;: Windows cannot write to this file. The disk may be full.
   Delete any unwanted files and try again.

</PRE><h2>CAUSE</h2>
 
<P>
This problem can occur when you print from a computer running Windows for
Workgroups 3.11 using Microsoft TCP/IP-32 3.11a to a shared printer on a
Windows NT Server or Workstation 3.5 computer using Microsoft TCP/IP, and
the print job goes through a "black hole" router before reaching the
printer.
<P>
A black hole router does not return an Internet Control Message Protocol
(ICMP) "destination unreachable" message when it needs to fragment a packet
that has the Don't Fragment bit enabled.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, follow these steps:

<OL><P><LI>Add the following parameter to the Windows NT registry:
<P>
<P><PRE>      ENABLEPMTUBHDETECT=1
</PRE><P>
   WARNING: Using the Windows NT Registry Editor incorrectly can cause
   serious, system-wide problems that may require you to reinstall Windows
   NT. Microsoft cannot guarantee that any problems resulting from the use
   of Registry Editor can be solved. Use this tool at your own risk.

<P><LI>Use any text editor (such as Notepad) to edit the SYSTEM.INI file
   on the Windows for Workgroups computer. Add the following line to
   the [MSTCP] section of the SYSTEM.INI file:
<P>
<P><PRE>      PMTUBLACKHOLEDETECT=1
</PRE><P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The PMTUBLACKHOLEDETECT setting is the Microsoft TCP/IP-32 equivalent to
the EnablePMTUBHDetect setting. Setting the EnablePMTUBHDetect setting to 1
(true) causes TCP to try to detect black hole routers while performing MTU
discovery. A black hole router does not return an ICMP "destination
unreachable" message when it needs to fragment a TCP packet with the Don't
Fragment bit set. TCP depends on receiving these message to perform MTU
discovery. With this setting enabled, TCP tries to send segments without
the Don't Fragment bit set if several retransmissions of a segment go
unacknowledged. If the segment is acknowledged as a result, the MSS is
decreased and the Don't Fragment bit is set in future packets on the
connection. Enabling black hole router detection increases the maximum
number of retransmissions performed for a given segment.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information about adding registry values in Windows NT, see
the online Help file for Registry Editor, or see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q120642.htm">Q120642</A></B>
   TITLE     : TCP/IP &amp; NBT Configuration Parameters for Windows NT 3.5
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbinterop kbprint kbnetwork kbprb<BR>
KBSubcategory: wfwg msnets nethw<BR>
Additional reference words: prodnt 3.11
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 10, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
