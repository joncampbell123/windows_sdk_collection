

<HTML>
<HEAD>
<TITLE>Microsoft TCP/IP Host Name Resolution Order </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172218">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/07/31">
<META NAME="Keywords" CONTENT="ntnetserv NTSrvWkst nttcp win3x win95 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  This article discusses the different methods of host name to IP address resolutions used by Microsoft Windows clients. The sequence of methods is different than the sequence used to resolve NetBIOS names to IP addresses.  MORE INFORMATION  On a net...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QBWO,QARL,QAUJ,QBWN,QDL9,QBWP,QBWQ,QDNT,QARM,QDIZ,QAVZ,QAIM,QDN1,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Microsoft TCP/IP Host Name Resolution Order</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172218</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows 95
<LI>Microsoft TCP/IP-32 for Windows for Workgroups, versions 3.11, 3.11a,
   and 3.11b
<LI>Microsoft LAN Manager version 2.2c
<LI>Microsoft Network Client version 3.0 for MS-DOS
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses the different methods of host name to IP address
resolutions used by Microsoft Windows clients. The sequence of methods
is different than the sequence used to resolve NetBIOS names to IP
addresses.
<P>
MORE INFORMATION
 
<P>
On a network using the TCP/IP protocol, it is necessary to convert names
of resources to IP addresses to connect to these resources. Microsoft
Windows clients will follow a sequence of methods in attempting to resolve
a name to an address, stopping the search when it successfully matches a
name to an IP address.
<P>
There are two main sequences used in almost all cases: NetBIOS resolution
and Host name resolution. Clients connecting to resources on Microsoft
servers, typically through Windows File Manager or Network Neighborhood,
most often use NetBIOS name resolution.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../crossnet/q119493.htm">Q119493</A></B>
   TITLE     : NetBIOS over TCP/IP Name Resolution and WINS

</PRE>Host name resolution resolves the names of TCP/IP resources that do not
connect through the NetBIOS interface. The most common example of this is
a Web browser such as Microsoft Internet Explorer. Other examples include
Internet applications such as Ping, FTP, and Telnet. Many modern database
and mail applications that connect using Winsock, the Microsoft Windows
implementation of TCP/IP sockets, also use host name resolution.
<P>
When troubleshooting name resolution issues, it is important to narrow
down whether the application is resolving a NetBIOS name or a host name.
<P>
NOTE: In the context of this article, the term "client" does not
necessarily refer to a workstation. A Windows NT server will take the role
of client when it requires access to resources that require host name
resolution.
<P>
Host name resolution generally uses the following sequence:

<OL><P><LI>The client checks to see if the name queried is its own.

<P><LI>The client then searches a local Hosts file, a list of IP address and
   names stored on the local computer.
<P>
   NOTE: The Hosts file location depends on the operating system:
<P>
<PRE>   Windows NT                  %Systemroot%\System32\Drivers\Etc
   Windows 95                  &lt;drive&gt;\&lt;Windows folder&gt;
   Windows for Workgroups      &lt;drive&gt;\&lt;Windows folder&gt;
   Windows 3.1                 &lt;drive&gt;\&lt;Windows folder&gt;
   MS-Client 3.0               &lt;Boot volume&gt;\Net
   Lan Manager 2.2c Client     &lt;Boot volume&gt;\Net

   Where %Systemroot% is the folder in which Windows NT is installed,
   &lt;drive&gt; is the drive on which the OS is installed, and &lt;boot volume&gt;
   refers to a boot floppy disk or drive C.

   A sample hosts file, Hosts.sam, is installed with the TCP/IP protocol
   showing the proper format.

</PRE><P><LI>Domain Name System (DNS) servers are queried.

<P><LI>If the name is still not resolved, NetBIOS name resolution sequence is
   used as a backup. This order can be changed by configuring the NetBIOS
   node type of the client.
<P>
</OL>The Windows client will try each of these methods until it either
successfully resolves the name or exhausts these methods. Windows NT,
Windows 95, and Windows for Workgroups clients using Microsoft TCP/IP
3.11b follow this sequence. Lan Manager 2.2c or Microsoft Client 3.0
clients will not use NetBIOS name resolution as a backup.
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q169141.htm">Q169141</A></B>
   TITLE     : NetBIOS and hostname resolution for MS-Client and LM 2.2c

</PRE></OL>When resolving names the client will skip methods for which it is not
configured. For example, if there is no hosts file on the system, then it
will skip step #2 above and try a query to a DNS server. If no DNS server
IP addresses are entered in the client TCP/IP configuration, then the
client will skip to the next step in the sequence after DNS.
<P>
The method for changing host name resolution order differs among operating
systems and versions. These are documented in the Resource Kits for the
specific operating systems, as well as in the Microsoft Knowledge Base.
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q171567.htm">Q171567</A></B>
   TITLE     : Windows NT 4.0 ServiceProvider Priority Values Not Applied

   ARTICLE-ID: <B><A href="../crossnet/q139270.htm">Q139270</A></B>
   TITLE     : How to Change Name Resolution Order on Windows 95 and
               Windows NT

   ARTICLE-ID: <B><A href="../crossnet/q119372.htm">Q119372</A></B>
   TITLE     : Setting the Name Resolution Search Order for TCP/IP-32

</PRE><h3>Troubleshooting</h3>
 
<P>
Problem: Client is unable to resolve a host name.
<P>
Troubleshooting steps:
<P>
If a client cannot resolve a host name, then it is best to verify the Host
name resolution sequence listed above that the client should be using. If
the name does not exist in any of the resources that the client uses, then
you must decide to which resource to add it. If the name exists in one of
the resources, such as a DNS server or a Windows Internet Name Service
(WINS) server and the client is not resolving the name correctly, focus
your attention on troubleshooting that specific resource.
<P>
Also, confirm that the client is trying to resolve a host name and not a
NetBIOS name. Many applications have multiple methods that they can
utilize to resolve names, this is especially true of mail and database
applications. The application may be configured to connect to resources
using NetBIOS. Depending on the client configuration the client may bypass
host name resolution. From there it will be necessary to either change the
connection type to TCP/IP sockets or to troubleshoot the problem as a
NetBIOS issue.
<P>
Problem: Client resolves a name very slowly, or fails to resolve a name
<PRE>         and takes a long time to report a failure.

</PRE>Troubleshooting steps:
<P>
Having DNS servers configured in a client's TCP/IP configuration, but the
server is not available to the client usually causes this. Because the
TCP/IP protocol assumes an unreliable network, a client will repeatedly
attempt to connect to a DNS server before abandoning the attempted query.
The client will then attempt to query a second DNS server if one is
configured and take the same time to fail. Only then will the client step
through to NetBIOS name resolution as described above.
<P>
There are three ways to approach this issue.

<UL><LI>If the host name is correctly entered in a host file, it will be
   resolved before the client attempts to query DNS. This solution works
   well if DNS servers are temporarily unreachable and there is a small
   number of host names that need to be resolved . Manually configuring
   Hosts files for numerous clients may be prohibitive.
<P>
   -or-

<LI>If DNS servers are available, but the DNS Server addresses in the
   clients TCP/IP configuration are incorrect, then correcting these
   addresses will allow the clients to contact the DNS servers
   immediately. Even if a DNS server reports that it cannot resolve a
   name, this will happen much faster than if the client cannot reach a
   DNS server at all.
<P>
   -or-

<LI>If DNS servers are configured on the client, but these servers are
   permanently unavailable, then remove the IP addresses of the DNS
   servers from the client configuration. The client will then bypass the
   DNS lookup without delay.
<P>
   -or-

<LI>If records in the DNS database are missing or incorrect, then there
   will be a delay as DNS servers query other DNS servers before reporting
   that they cannot resolve the name. This will usually cause a delay of
   just a few seconds.
<P>
</UL>For additional information on TCP/IP and name resolution, please see the
following white paper available on the Microsoft anonymous ftp server:
<P>
<PRE>   File Name: Tcpipimp.doc
   Location : <B><A href="ftp://ftp.microsoft.com/bussys/winnt/winnt-docs/papers/">ftp://ftp.microsoft.com/bussys/winnt/winnt-docs/papers/</A></B>
   Title    : "Microsoft Windows NT 3.5/3.51/4.0: TCP/IP Implementation
              Details TCP/IP Protocol Stack and Services, Version 2.0. "
</PRE> 
<PRE>Keywords          : ntnetserv NTSrvWkst nttcp win3x win95 kbnetwork
Version           : WinNT:3.5,3.51,4.0;Windows:3.1,3.11,95
Platform          : WINDOWS
Issue type        : kbinfo
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
