

<HTML>
<HEAD>
<TITLE>Invalid Operand with Locked CMPXCHG8B Instruction </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163852">
<META NAME="KBModify" CONTENT="1998/02/23">
<META NAME="KBCreate" CONTENT="1997/02/19">
<META NAME="Keywords" CONTENT="nthw NTSrvWkst kbhw">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  When an Intel processor receives a specific invalid instruction, your computer may stop responding (hang). Your computer must be turned off and restarted to return to normal operation.  NOTE: Although there is no known operating system or applicati...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAR4,QDNE,QAM1,QAKP,QDNN,QDL9,QBWO,QBWN,QDIR,QDIO,QATS,QASR,QBWQ,QDO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Invalid Operand with Locked CMPXCHG8B Instruction</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163852</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When an Intel processor receives a specific invalid instruction, your
computer may stop responding (hang). Your computer must be turned off and
restarted to return to normal operation.
<P>
NOTE: Although there is no known operating system or application that
issues such an invalid instruction, you should be aware that a program can
be written maliciously to contain such an instruction. The operating system
would not trap this error, as it should, which results in the processor
hang.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem can occur due to an error in the following Intel processors:

<UL><LI>Pentium processor
<LI>Pentium processor with MMX technology
<LI>Pentium OverDrive processor
<LI>Pentium OverDrive processors with MMX technology
<P>
</UL>NOTE: This problem cannot occur on the following Intel processors:

<UL><LI>Pentium Pro processor
<LI>Pentium II processor
<LI>i486 and earlier processors
<P>
</UL>This problem is known as "Invalid Operand with Locked CMPXCHG8B
Instruction" and is erratum 81 on the Pentium processor errata list. For
more information, please contact Intel or go to the following Intel web
site:
<P>
<PRE>   <B>http://support.intel.com/sites/support/</B>

</PRE><h2>RESOLUTION</h2>
 
<P>
Intel has identified a workaround to this problem that allows the operating
system to trap the invalid instruction and not pass it to the processor.
Microsoft has worked closely with Intel to provide the following hotfixes:
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
To resolve this problem for Windows NT 4.0, obtain the following fix or
wait for the next Windows NT service pack.
<P>
This fix should have the following time stamp:
<P>
<PRE>   11/24/97  12:24p                51,968 Hal.dll
   11/24/97  12:24p                48,384 Hal486c.dll
   11/24/97  12:25p                66,400 Halapic.dll
   11/24/97  12:24p                46,112 Halast.dll
   11/24/97  12:25p                82,208 Halcbus.dll
   11/24/97  12:25p                80,320 Halcbusm.dll
   11/24/97  12:24p                46,400 Halmca.dll
   11/24/97  12:25p                68,544 Halmps.dll
   11/24/97  12:25p                67,552 Halmpsm.dll
   11/24/97  12:26p                79,008 Halncr.dll
   11/24/97  12:25p                40,192 Haloli.dll
   11/24/97  12:25p                56,608 Halsp.dll
   11/24/97  12:25p                40,768 Halwyse7.dll
   11/20/97  06:23p               938,816 Ntkrnlmp.exe
   11/20/97  06:22p               918,848 Ntoskrnl.exe

</PRE>This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/</A></B>
   hotfixes-postSP3/pent-fix/

</PRE>NOTE: The above link is one path; it has been wrapped for readability.
<P>
<P><h3>Windows NT 3.51</h3>
 
<P>
To resolve this problem for Windows NT 3.51, obtain the following fix.
<P>
This fix should have the following time stamp:
<P>
<PRE>   11/24/97  12:42p                49,840 Hal.dll
   11/24/97  12:42p                48,768 Hal486c.dll
   11/24/97  12:42p                65,648 Halapic.dll
   11/24/97  12:42p                46,704 Halast.dll
   11/24/97  12:42p                81,056 Halcbus.dll
   11/24/97  12:42p                79,200 Halcbusm.dll
   11/24/97  12:42p                46,912 Halmca.dll
   11/24/97  12:42p                67,696 Halmps.dll
   11/24/97  12:42p                40,480 Haloli.dll
   11/24/97  12:42p                53,744 Halsp.dll
   11/24/97  12:42p                49,840 Halws3.dll
   11/24/97  12:42p                41,072 Halwyse7.dll
   11/21/97  01:35p               821,904 Ntkrnlmp.exe
   11/21/97  01:34p               810,016 Ntoskrnl.exe

</PRE>This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt351/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT351/</A></B>
   hotfixes-postSP5/pent-fix/

</PRE>NOTE: The above link is one path; it has been wrapped for readability.
<P>
<P><h3>Windows 95</h3>
 
<P>
A fix for Windows 95 is not yet available.
<P>
<P><h2>STATUS</h2>
 
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
Intel has confirmed this to be a problem in the Intel processors listed
above.
A supported fix is now available from Microsoft, but has not been fully
regression-tested and should be applied only to systems experiencing this
specific problem. Unless you are severely impacted by this specific
problem, Microsoft recommends that you wait for the next Service Pack that
contains this fix. Contact Microsoft Technical Support for more
information.
<P>
<P><h3>Windows NT 3.51</h3>
 
<P>
Intel has confirmed this to be a problem in the Intel processors listed
above. A supported fix is now available from Microsoft, but has not been
fully regression-tested and should be applied only to systems experiencing
this specific problem. Unless you are severely impacted by this specific
problem, Microsoft recommends that you wait for the next Service Pack that
contains this fix. Contact Microsoft Technical Support for more
information.
<P>
<P><h3>Windows 95</h3>
 
<P>
Intel has confirmed this to be a problem in the Intel processors listed
above. Microsoft is researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 3.50 3.51 4.00 i386 malicious hangs freeze<BR>
freezes erratum cmpxchg8b compare and exchange 8 bytes cold boot hard boot<BR>
Keywords          : nthw NTSrvWkst kbhw<BR>
Version           : WinNT:3.5,3.51,4.0;Windows:95<BR>
Platform          : WINDOWS winnt<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
