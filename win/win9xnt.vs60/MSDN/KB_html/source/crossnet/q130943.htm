

<HTML>
<HEAD>
<TITLE>Cannot Connect to NCP Server Without SAP Advertising Enabled </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130943">
<META NAME="KBModify" CONTENT="1997/11/20">
<META NAME="KBCreate" CONTENT="1995/05/30">
<META NAME="Keywords" CONTENT="msnets ntwkst win95 kbenv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  Windows 95 includes the ability to act as a Novell NetWare server when you install the Microsoft  File and printer sharing for NetWare Networks  service. With this service installed, a Windows 95-based computer advertises itself on the network in o...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAI5,QARL,QABA,QAVZ,QACK,QBWS,QA8Y,QA2O,QBVX,QBWP,QDNF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cannot Connect to NCP Server Without SAP Advertising Enabled</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows NT Workstation versions 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows 95 includes the ability to act as a Novell NetWare server when you
install the Microsoft "File and printer sharing for NetWare Networks"
service. With this service installed, a Windows 95-based computer
advertises itself on the network in one of two ways:

<UL><LI>SAP Advertising (Service Advertising Protocol)

<LI>Workgroup Advertising
<P>
</UL>By default, SAP advertising is disabled. Computers running Windows 95 with
the Microsoft Client for NetWare Networks can connect to a Windows 95-
based computer acting as a Novell NetWare server. However, Microsoft
Windows NT and real-mode NETX or VLM clients require you to enable SAP
advertising to connect to this server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
SAP advertising is how Novell NetWare servers advertise their services
(such as file server and print server services). If SAP advertising is
enabled, the Microsoft "File and printer sharing for NetWare Networks"
service advertises like a Novell NetWare server by sending a broadcast
every 60 seconds.
<P>
When a Novell NetWare client boots without a preferred NetWare server
specified, it sends a request for the nearest NetWare server
(GetNearestServer). The quickest NetWare server to respond is the one the
client connects to. If SAP advertising is enabled on the Windows 95-based
computer acting as a NetWare server, it may respond to this request before
an actual NetWare server responds. While the Windows 95 server is designed
to respond slowly, it may respond quicker than an actual NetWare server.
<P>
When the "File and printer sharing for NetWare Networks" service is
enabled, two new folders are created in the Windows folder: Nwsysvol and
Login. The Login folder contains Login.exe. If a computer starts without
specifying a preferred server and connects to a Windows 95 server, the
Windows 95 server:

<OL><P><LI>Makes an implicit connection to the NETX/VLM client and maps the first
   drive to sys:\login.

<P><LI>Connects to a true Novell NetWare server and sets this server as the
   primary and preferred server for the NETX/VLM client. The server it
   uses is based on the following (in order of preference):
<P>
<P><PRE>    - Preferred server specified by the client with the "/ps=" or
      "Preferred server" setting in the Net.cfg file.
</PRE><P>
<P><PRE>    - The pass-through server used by the Windows 95-based computer.
</PRE>
<P><LI>Login.exe performs a global logout, remaps, and starts the login
   process with the true NetWare server. There is a chain execution with
   Login.exe from the true NetWare server using identical parameters to
   finish the connection for the NETX/VLM client.
<P>
   If the pass-through server used by the "File and printer sharing for
   NetWare Networks" service does not have an account for you, enter
<P>
<P><PRE>      login &lt;ServerName&gt;
</PRE><P>
   where &lt;ServerName&gt; is the name of a NetWare server on which you have
   an account. In normal circumstances, NETX/VLM clients should
   always specify a preferred server. The real-mode client does not detect
   any of these events, it just receives the login connection it wanted
   with a NetWare server, even though a Windows 95 server first answered
   its "GetNearestServer" broadcast.
<P>
</OL><h3>Windows NT</h3>
 
<P>
In order for Windows NT computers with Client Service for NetWare to be
able to connect to Windows 95-based computers acting as Novell NetWare
servers, you must enable SAP advertising.
<P>
<P><h3>To Enable SAP Advertising</h3>
 
<P>
To enable SAP advertising on a Windows 95-based computer, follow these
steps:

<OL><P><LI>Click Start, point to Settings, click Control Panel, and then double-
   click Network.

<P><LI>On the Configuration tab, click "File and printer sharing for NetWare
   Networks", and then click Properties.

<P><LI>In the Property box, click SAP Advertising.

<P><LI>In the Value box, click Enabled, click OK and then click OK again.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 4.00<BR>
Keywords          : msnets ntwkst win95 kbenv kbnetwork<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
