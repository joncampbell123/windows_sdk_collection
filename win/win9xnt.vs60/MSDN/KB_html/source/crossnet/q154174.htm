

<HTML>
<HEAD>
<TITLE>Invalid ICMP Datagram Fragments Hang Windows NT, Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154174">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1996/07/31">
<META NAME="Keywords" CONTENT="ntsecurity NTSrvWkst kbbug4.00 kbfix4.00 kbbug3.51 kbfix3.51 kbfile kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; crossnet">
<META NAME="Description" CONTENT="  Computers running Windows NT or Windows 95 may stop responding (hang) when they receive corrupted Internet Control Message Protocol (ICMP) datagram fragments from a client.  RESOLUTION  Microsoft has updated the TCP/IP protocol stack to correct thi...">
<META NAME="Product" CONTENT="Networking Issues">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAR4,QDL9,QBWO,QBWN,QDO3,QBWQ,QAM1,QAXB,QAY2,QAKP,QAC1,QDIX,QBD2,QA59 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Invalid ICMP Datagram Fragments Hang Windows NT, Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154174</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51 and 4.0
<LI>Microsoft Windows NT Server version 3.51 and 4.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Computers running Windows NT or Windows 95 may stop responding (hang) when
they receive corrupted Internet Control Message Protocol (ICMP) datagram
fragments from a client.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has updated the TCP/IP protocol stack to correct this problem.
Instructions for installing it are available from Microsoft support
channels or directly from the Internet locations below.
<P>
NOTE: This hotfix was originally posted on July 7, 1997. A subsequent fix
was completed on January 9, 1998 to address another nearly identical attack
and this hotfix has replaced the original one. The original hotfix is
included in Windows NT 4.0 Service Pack 3. The most recent hotfix is not;
however, it is available from the following Internet locations:
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
NOTE: Service Pack 3 must be applied to Windows NT 4.0 prior to applying
this fix.
<P>
This fix should have the following time stamp:
<P>
<PRE>   01/09/98  08:16a               143,664 Tcpip.sys   (Intel)
   01/09/98  08:13a               263,536 Tcpip.sys   (Alpha)

</PRE>This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/</A></B>
   hotfixes-postSP3/teardrop2-fix

</PRE><h3>Windows NT 3.51</h3>
 
<P>
NOTE: Service Pack 5 must be applied to Windows NT 3.51 prior to applying
this fix.
<P>
This fix should have the following time stamp:
<P>
<PRE>   01/14/98  12:04p               123,824 Tcpip.sys   (Intel)
   01/14/98  12:00p               216,848 Tcpip.sys   (Alpha)

</PRE>This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt351/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT351/</A></B>
   hotfixes-postSP5/teardrop2-fix

</PRE><h3>Windows 95</h3>
 
<P>
This issue is resolved by the following updated file for Windows 95 and
OSR2:
<P>
<PRE>   Vip.386 version 4.0.956 (dated 6/30/97) or later

</PRE>This file is included in the self-extracting Vipup11.exe file.
<P>
To install this update, follow these steps:

<OL><P><LI>Download the Vipup11.exe file from the Microsoft Software Library to
   an empty folder.

<P><LI>In My Computer or Windows Explorer, double-click the Vipup11.exe file
   you downloaded in step 1.

<P><LI>Follow the instructions on the screen.
<P>
</OL>The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/vipup11.exe">Vipup11.exe</A> <I>(size: 166072 bytes)</I> 

</PRE></OL>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>The following files are installed by Vipup11.exe:
<P>
<PRE>   File name  Version    Date/Time        Size     Destination folder
   ----------------------------------------------------------------------
   Vip.386    4.00.956   6/30/97 9:54am   171,672  Windows\System

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51. A
supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95 and
OEM Service Release 2 (OSR2). An update to address this problem is now
available, but is not fully regression tested and should be applied only to
computers experiencing this specific problem. Unless you are severely
impacted by this specific problem, Microsoft does not recommend
implementing this update at this time. Contact Microsoft Technical Support
for additional information about the availability of this update.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: win95 ssping spingnuke denial of service attack<BR>
hangs<BR>
Keywords          : ntsecurity NTSrvWkst kbbug4.00 kbfix4.00 kbbug3.51 kbfix3.51 kbfile kbnetwork<BR>
Version           : WinNT:3.51,4.0;Windows:95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
