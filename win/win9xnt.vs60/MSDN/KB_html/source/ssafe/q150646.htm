

<HTML>
<HEAD>
<TITLE>PRB: "Incompatible Database Version"  Error Running Analyze </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150646">
<META NAME="KBModify" CONTENT="1997/03/10">
<META NAME="KBCreate" CONTENT="1996/05/07">
<META NAME="Keywords" CONTENT="SourceSafe kbusage">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When running Analyze Build 1309 or higher, you receive the error message:     Incompatible Database Version  This error usually happens when users upgrade from a 3.x version and have sufficient corruption in their 3.x database so DDCONV cannot conv...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QDML,QAB4,QAAP,QADK,QAC1,QAR4,QABH,QBWS,QBVV,QA6A,QA56,QA55,QAKP,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Incompatible Database Version"  Error Running Analyze</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150646</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe for Windows, versions 4.0, 5.0
<LI>Microsoft Visual SourceSafe for Windows NT, versions 4.0, 5.0
<LI>Microsoft Visual SourceSafe for Windows 95, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When running Analyze Build 1309 or higher, you receive the error message:
<P>
<PRE>   Incompatible Database Version

</PRE>This error usually happens when users upgrade from a 3.x version and have
sufficient corruption in their 3.x database so DDCONV cannot convert one
or more files. See DDCERR.LOG for clues to the identify of the file that
is corrupted.
<P>
Analyze uses the VERSION.DAT file in the SourceSafe data directory to
determine if the conversion and creation process was successful. The
DDCONV.EXE file changes the contents of the VERSION.DAT file as one of the
last operations before it completes. If there is a problem with the
database conversion or some question as to the status of some of the files
in the database, DDCONV does not change the contents of VERSION.DAT.
<P>
The Visual SourceSafe Explorer does not use VERSION.DAT. Rather, it relies
on the contents of the UM.DAT file to determine the status of the
database.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>WORKAROUND</h2>
 

<UL><LI>Try to correct errors reported by the 3.1 Version of Analyze. The 3.1
   version should be run on the database before it is converted. For more
   information on utilities that can be run on the 3.1 database to correct
   problems, please see the following article in the Microsoft Knowledge
   Base:
<P>
   ARTICLE-ID: <B><A href="../ssafe/q133054.htm">Q133054</A></B>
<PRE>   TITLE     : Detecting and Fixing Database Corruption Errors in
               SourceSafe

</PRE><LI>Try to Purge/Destroy Permanently any files/projects that are not
   needed.

<LI>Remove bad files from SourceSafe. Purge the files. Upgrade. Add files
   back to the converted database. All of the above are done though
   SourceSafe operations, not directly to the database. All history is
   Lost on files that are added manually.

<LI>If all else fails, contact Microsoft Technical Support SourceSafe
   Support.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : SourceSafe kbusage<BR>
Version             : 4.0 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
