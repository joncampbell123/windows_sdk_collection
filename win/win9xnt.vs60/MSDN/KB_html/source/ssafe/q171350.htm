

<HTML>
<HEAD>
<TITLE>BUG: Analyze Always Updates aaaaaaaa.cnt </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171350">
<META NAME="KBModify" CONTENT="1997/12/09">
<META NAME="KBCreate" CONTENT="1997/07/14">
<META NAME="Keywords" CONTENT="ssdb kbtool kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  Analyze will always update the value of the file aaaaaaaa.cnt, even if you run it without -f. Visual SourceSafe uses this file to determine the next physical file to be created in the database. If a file is accidentally copied into one of the datab...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QADK,QAKC,QAZV,QAKD,QAFI,QBC6,QAXB,QAUD,QABI,QAG8,QDML,QBXS,QBXB,QAYL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Analyze Always Updates aaaaaaaa.cnt</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171350</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0a, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Analyze will always update the value of the file aaaaaaaa.cnt, even if you
run it without -f. Visual SourceSafe uses this file to determine the next
physical file to be created in the database. If a file is accidentally
copied into one of the database subdirectories and Analyze is run on the
database, aaaaaaaa.cnt may be set to an abnormally large value. If Analyze
returns an "unable to create filemapping for database" error, you should
check aaaaaaaa.cnt and you may need to reset it. You should also check the
subdirectories of the data directory for a file that does not belong there.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
SourceSafe database files follow an order that allows every log file in the
data directory to be associated with a number. The number can be derived
using the following algorithm:
<P>
<PRE>   __int64 PhyToNum(char *szFile)
   {
   __int64 lFileNum = 0;   /* Counter for file Number */
   int  i;              /* Loop Variable */

   for( i=7; i &gt;= 0; i-- ) /* Start from the right of the filename */
    {
     lFileNum *= 26;  /* Multiply by the appropriate power of 26 */
     lFileNum += (__int64)(toupper(szFile[i]) - 'A');
                      /* Convert the value */
    }
   return (lFileNum);
   }

</PRE>Please note that the __int64 is a Microsoft-specific variable type for a 64-
bit integer. This code snippet may not work with all compilers.
<P>
If Analyze detects a filename that was put into one of the subdirectories
of the data directory by mistake, it can evaluate to a number higher than
any other file in the database. Analyze allocates memory for every file
from the first to the highest number it finds, even if some of those files
do not physically exist in the data directory. This can cause Analyze to
ask for more memory than the operating system can make available. As a
result, the "unable to create filemapping" message appears.
<P>
If the aaaaaaaa.cnt is set to an incorrectly large value and files and
projects are then added to SourceSafe, it might be impossible to return the
database to a usable state without deleting and purging the files that
represent the large values in their physical names. This can be very
difficult if a large number of files and projects have been added since the
aaaaaaaa.cnt file was set to a large value.
 
<PRE>Keywords          : ssdb kbtool kbtshoot
Version           : 4.0a 5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
