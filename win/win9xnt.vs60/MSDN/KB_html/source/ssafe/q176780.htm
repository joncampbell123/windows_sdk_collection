

<HTML>
<HEAD>
<TITLE>FILE: Use Guidscan.exe to View or Change GUID in a VSS Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176780">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1997/11/14">
<META NAME="Keywords" CONTENT="ssconv ssdb ssother">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  The GuidScan.exe utility allows you to see the value of the GUID within a Visual SourceSafe database by reading the um.dat file. You can also generate a new GUID and replace the contents within the Visual SourceSafe database. The Visual SourceSafe ...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAJQ,QDML,QA56,QA55,QAUR,QA2X,QAY2,QBCU,QALW,QAGU,QA6A,QA5V,QA5E,QAHD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Use Guidscan.exe to View or Change GUID in a VSS Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176780</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0, 4.0a,
   5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The GuidScan.exe utility allows you to see the value of the GUID within a
Visual SourceSafe database by reading the um.dat file. You can also
generate a new GUID and replace the contents within the Visual SourceSafe
database. The Visual SourceSafe utilities Ssarc.exe and Ssrestor.exe use
the GUID stored in the um.dat file to determine if an archive is being
restored to the same database or a different one. Some administrators have
built new Visual SourceSafe databases by copying the contents of the data
directory to a new location and then deleting all the files and projects. A
problem can occur if other projects and files are added to the new
database, and then you attempt to restore an archive from the original
database to the new one. Since the GUIDs are the same in both databases,
SSRESTOR does not attempt to rename the file and project logs it is
restoring, and it can overwrite existing files and projects in the new
database.
<P>
This utility can be used to compare the GUIDs in different databases and
create a new GUID if needed without having to recreate the um.dat and
rights.dat, which would force the administrator to re-add users and project
rights.
<P>
The following self-extracting file is available for download from the
Microsoft Software Library:
<P>
~ GuidScan.exe
<P>
For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Contents of ReadMe.txt</h3>
 
<P>
ReadUm.exe is a 32-bit, Console application that can read the structure of
the um.dat file in a Visual SourceSafe database. This file contains user
information such as User names and passwords in tokenized form. While most
of the information in the FORMAT, RECORD HEADER and UM HEADER sections of
the um.dat file are of no interest to users, the presence of a GUID within
the um.dat indicates the database is in 5.0 format. It could also indicate
that files have been archived or restored from a database that was
originally in 4.0 format using the 5.0 utilities Ssarc.exe or Ssrestor.exe.
<P>
ReadUm will return the following entries from these sections of the um.dat
file:
<P>
<PRE>   FORMAT: Signature:[ ] Version:[ ]
   RECORD HEADER: Size:[ ] Type:[ ] Checksum:[ ]
   UM HEADER: Entries:[ ] Users:[ ] GUID Set:[ ]

</PRE>If GUID Set is a non-zero value, a GUID Value will also be displayed.
You will then be asked if you want to create and replace the existing GUID
with a new one. Clicking Yes will generate a new GUID and replace the
existing GUID in um.dat.
<P>
Be very careful if you replace the GUID. The archive and restore utilities
SSARC and SSRESTOR that come with Visual SourceSafe 5.0 depend on the GUID
to determine whether an archive file is being restored to the same or a
different database. Replacing the GUID after archiving files may cause the
files not to be able to be restored correctly to the same database. For
this reason, please backup the existing um.dat and rights.dat before
replacing the GUID.
 
<PRE>Keywords          : ssconv ssdb ssother
Version           : WINDOWS:4.0,4.0a,5.0
Platform          : WINDOWS
Issue type        : kbfile</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
