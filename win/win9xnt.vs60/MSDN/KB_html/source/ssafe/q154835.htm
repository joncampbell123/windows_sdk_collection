

<HTML>
<HEAD>
<TITLE>BUG: "Project History Options" Won't Search for Labels in File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154835">
<META NAME="KBModify" CONTENT="1997/02/25">
<META NAME="KBCreate" CONTENT="1996/08/15">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  According to the Online Documentation, in the  Project History Options  dialog box there is a  Labels Only  check box that can be used to search the current project for any files for a given label.  Specifically, the Online Documentation describes ...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAC2,QA01,QAJN,QDML,QAVS,QA2X,QAL3,QBWS,QABI,QBV8,QAG0,QBXS,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: "Project History Options" Won't Search for Labels in File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154835</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   version, 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
According to the Online Documentation, in the "Project History Options"
dialog box there is a "Labels Only" check box that can be used to search
the current project for any files for a given label.
<P>
Specifically, the Online Documentation describes this functionality as
follows:
<P>
<PRE>      "Type a time, date, version, or label. Use the prefix D to indicate a
      date or time, and the prefix L to indicate a label..."

</PRE>Attempting to use this dialog box to get a listing of files with a given
label results in a SourceSafe message box that displays:
<P>
<PRE>      "There are no items in the list."

</PRE>After clicking OK on this message box, an empty "Results" window is
displayed.
<P>
<P><h2>CAUSE</h2>
 
<P>
This function was designed for project searches only.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The following SourceSafe command can be used to achieve the desired result:
<P>
<PRE>      ss get $/*.* -r -g- -vlmylabel -oresults.txt

</PRE>The breakdown of the command is as follows:
<P>
<PRE>      &lt;ss get&gt;: SourceSafe command to retrieve a read-only output &lt;$/*.*&gt; -
      start at project $/, and get all files (hence *.*)

      &lt;-r&gt;: recursive - search through all files and sub-projects of
      starting project

      &lt;-g-&gt;: don't actually place read-only files in the working directory

      &lt;-vlmylabel&gt;: search for the label "mylabel"

      &lt;-oresults.txt&gt;: pipe the results of the search to the named file

</PRE>At this point, you can look at the results.txt file to see the list of
files that had the label in question assigned to it.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a project in Visual SourceSafe. Add two or more test files to the
   project.

<P><LI>In the Visual SourceSafe Explorer, highlight the first file in the right
   pane of the Explorer window and click the mouse again. From the pop-up
   menu, choose "Show History."

<P><LI>Double-click on any version of the file. Then click the "Details"
   button and type "mylabel" (without the quotes) in the text box provided
   for the Label. Close this dialog box by choosing "Close."

<P><LI>Repeat steps 1 through 3 for the second file added to the same project.

<P><LI>Click the left pane of the Visual SourceSafe Explorer window (project
   side) and highlight the project that contains the files labeled
   "mylabel."

<P><LI>Right-click the mouse and choose "Show History" from the pop-up menu.
   In the "Project History Options" dialog box, check "Include Files,"
   "Recursive," and "Labels Only."

<P><LI>In the "From" box, enter "Lmylabel" (without the quotes), and then
   choose OK.
<P>
</OL>Note that the message box will display "There are no items in the list"
followed by the empty "Results" window.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: ssafe vss<BR>
Additional reference words: 4.00 5.00
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
