

<HTML>
<HEAD>
<TITLE>PRB: "File or Project not Found" Adding Files via Integration </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164684">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1997/03/06">
<META NAME="Keywords" CONTENT="ssfox ssint ssvb ssvc vcbuglist500">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When you add a project or a file to SourceSafe from one of the applications that SourceSafe integrates with, you receive the following error message:     File or Project not Found  CAUSE =====  The SourceSafe project structure does not match the di...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJN,QDML,QAJH,QAFI,QAB4,QBS0,QAG0,QBXB,QA5E,QATJ,QBVV,QADZ,QAM2,QAAD,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "File or Project not Found" Adding Files via Integration</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164684</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
<LI>Microsoft Visual Basic Control Creation, Professional, and Enterprise
   Editions for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions,
   16-bit and 32-bit, for Windows, version 4.0
<LI>Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.0a, 4.1, 4.2, 5.0
<LI>Microsoft Visual FoxPro for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you add a project or a file to SourceSafe from one of the
applications that SourceSafe integrates with, you receive the following
error message:
<P>
<PRE>   File or Project not Found

</PRE><h2>CAUSE</h2>
 
<P>
The SourceSafe project structure does not match the directory structure on
the drive that contains the application project.
<P>
<P><h2>RESOLUTION</h2>
 

<OL><P><LI>Create a SourceSafe project structure that mirrors your application
</OL>project structure.
<P>
-or-

<OL><P><LI>If the error occurs while adding an application project to SourceSafe,
   turn off project security by unchecking the "Enable Project Security"
   check box in the Admin program.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To distinguish between the SourceSafe project (for example,
$/develop/newproj) and the "project" concept in an integrated application
(.PJX in FoxPro, .MDP in Visual C, .VBP in Visual Basic), the latter will
be referred to as the "application project." The directory that contains
the application project file (PJX, MDP, VBP etc.) is the "home" directory.
<P>
When you add an application project to SourceSafe, you are prompted to
specify the SourceSafe project that will store your files. We'll call this
the "parent" project. The working folder of the parent project is set to
the home directory. When you add a file from the application project to
SourceSafe, the integration looks at the relative path of that file to the
home directory and attempts to add it to a SourceSafe project that has the
same relative path to the parent project.
<P>
To illustrate this, assume that you have the following directory
structure:
<P>
<PRE>   C:
      \develop
          \greatapp
               greatproj.vbp (file)
               \forms
                  greatform.frm

           \badapp
                module3.bas  (file)

</PRE></OL>The application project greatproj contains the files greatform.frm and
module3.bas, and you add greatproj to SourceSafe, in a project named
$/apps/greatapp.
<P>
In this example, the home directory is c:\develop\greatapp and the parent
project is $/apps/greatapp.
<P>
Consider how the SourceSafe integration attempts to store the three files.
<P>
Greatproj.vbp will be stored in $/apps/greatapp.
<P>
Greatform.frm will be stored in $/apps/greatapp/forms.
<P>
Note that if the /forms subproject does not exist it should be created
on the fly by the integration when you first add greatproj.vbp to
SourceSafe. However, if project security is enabled, you will receive the
"File or Project not Found" error due to a bug in the integration.
Either disable project security prior to adding the application project
under SourceSafe, or create the subproject manually and add the missing
files.
<P>
Module3.bas - The integration will look for a sibling project to
$/apps/greatapp named $/apps/badapp. The relative path from greatproj.vbp
to module3.bas in the directory structure is "up one level then down one
level into badapp". The integration attempts to map this relative path
accordingly. If $/apps/badapps does not exist, you will receive the error
message. This is correct behavior, the integration only creates
subprojects of the parent project.
<P>
Take into account that subprojects of the parent are only created by the
integration when the application project is first added to SourceSafe. For
example, after adding greatproj to SourceSafe you create a new
subdirectory:
<P>
C:\develop\greatapp\modules, save module4.bas in that subdirectory, and
add module4.bas to the application project. When you attempt to add
module4.bas to SourceSafe, you will receive the error message because the
integration is looking for a subproject:
<P>
<PRE>   $/apps/greatapp/modules.

</PRE>Again the relative path from greatproj.vbp to module4.bas is "down one
<P><h2>level into modules", and will fail if there is no matching subproject.</h2>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : ssfox ssint ssvb ssvc vcbuglist500<BR>
Version             : 4.0 4.0a 4.1 5.0 5.0a<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
