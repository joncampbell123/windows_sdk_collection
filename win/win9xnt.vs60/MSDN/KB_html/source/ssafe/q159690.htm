

<HTML>
<HEAD>
<TITLE>PRB: Problem Adding Objects Created in VBA to SourceSafe </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159690">
<META NAME="KBModify" CONTENT="1997/03/28">
<META NAME="KBCreate" CONTENT="1996/11/19">
<META NAME="Keywords" CONTENT="kbinterop ssacc ssint">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you are developing a database application that is under Source Code Control (SCC) using Microsoft Visual SourceSafe integration, and you create a database object programmatica...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAW6,QAPN,QDML,QAZV,QAB5,QA7O,QAOE,QAMN,QBQU,QBJZ,QA1S,QAY5,QA5F,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Problem Adding Objects Created in VBA to SourceSafe</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159690</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you are developing a database application that is under Source Code
Control (SCC) using Microsoft Visual SourceSafe integration, and you create
a database object programmatically using Visual Basic for Applications
code, you are not prompted to add the new object to SCC control. When you
try to add the new object manually, you receive a message that there are no
objects to add to Visual SourceSafe.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you create the new object programmatically, Microsoft Access 97 fails
to notify the SCC integration that a new object exists. This causes a
situation where you cannot add the new object to SCC control until you
close and reopen the database.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Close and reopen the database after you create new objects programmatically
under Source Code Control (SCC). This allows the new objects to be added to
SCC correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
To demonstrate the issue and how it affects a form that you create
programmatically, follow these steps.
<P>
NOTE: The steps in this example require you to install Microsoft Visual
SourceSafe.

<OL><P><LI>Create a new database.

<P><LI>Create a module and type the following procedure to create a new form
   with a class module:
<P>
<P><PRE>      Function ClickEventProcForm()
<PRE></PRE>         Dim frm As Form, ctl As Control, mdl As Module
         Dim lngReturn As Long
         On Error GoTo Error_ClickEventProcForm
         Set frm = CreateForm
         Set ctl = CreateControl(frm.Name, acCommandButton, , , , 1000, _
            1000)
         ctl.Caption = "Click here"
         Set mdl = frm.Module
         lngReturn = mdl.CreateEventProc("Click", ctl.Name)
         mdl.InsertLines lngReturn + 1, vbTab &amp; "MsgBox ""Way cool!"""
         DoCmd.Close acForm, frm.Name, acSaveYes
         ClickEventProcForm = True
      Exit_ClickEventProcForm:
         Exit Function
      Error_ClickEventProcForm:
         MsgBox Err &amp; " :" &amp; Err.Description
         ClickEventProcForm = False
         Resume Exit_ClickEventProcForm
      End Function

</PRE><P><LI>Add the database to SourceSafe Source Code Control.

<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ?ClickEventProcForm()
</PRE>
<P><LI>On the Tools menu, point to SourceSafe and then click Add Objects to
   SourceSafe. Note that you receive a message that there are no objects to
   add to the VSS database.

<P><LI>Close the database, and then reopen it.

<P><LI>On the Tools menu, point to SourceSafe and then click Add Objects to
   SourceSafe. Note that you can add Form1 to Source Code Control.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SCC ACCSCC<BR>
Keywords            : kbinterop ssacc ssint<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
