

<HTML>
<HEAD>
<TITLE>PRB: Unable to Add Project Error in Visual Basic Integration </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155390">
<META NAME="KBModify" CONTENT="1997/06/02">
<META NAME="KBCreate" CONTENT="1996/08/28">
<META NAME="Keywords" CONTENT="ssafe ssvb kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When you add a new project to Visual SourceSafe using the Visual Basic 4.0 integration, you may receive the error message:      Unable to add the project to source code control   When you add an existing project, the error will read:      Add faile...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDML,QA55,QA56,QAB4,QAJN,QAEF,QAH4,QABH,QABI,QBJZ,QAAP,QA9N,QAM4,QADZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Unable to Add Project Error in Visual Basic Integration</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155390</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you add a new project to Visual SourceSafe using the Visual Basic 4.0
integration, you may receive the error message:
<P>
<PRE>   "Unable to add the project to source code control"

</PRE>When you add an existing project, the error will read:
<P>
<PRE>   "Add failed - Files were not added to source code control"

</PRE><h2>WORKAROUND</h2>
 
<P>
Clear the "Remove local copy after Add or Check In" checkbox as described
below when adding projects to Visual SourceSafe.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The above error will occur when the "Remove local copy after Add or Check
In" checkbox is checked in the Advanced settings dialog box for Visual
Basic/Visual SourceSafe integration. With Visual SourceSafe versions 4.x,
this checkbox may be found by clicking Visual SourceSafe on the Add Ins
menu and clicking the Options sub-menu. Next, click Advanced Command to
bring up the Advanced dialog box and click the Local Files tab. In version
5.0, this checkbox is disabled. The setting is inherited from the current
Visual SourceSafe setting that is located on the Local Files tab on the
Tools menu under Options in the Visual SourceSafe Explorer.
<P>
In both cases, although the working directory may be incorrect, the project
is actually added to Visual SourceSafe.
<P>
The underlying problem is that Visual SourceSafe has deleted the files from
the hard drive but Visual Basic is still trying to use them. The error
messages are misleading.
<P>
<P><h3>Steps To Reproduce Behavior</h3>
 
<P>
Assuming that "Remove local copy after Add or Check In" is checked:

<OL><P><LI>Create a new project in Visual Basic. From the File menu, choose Save
   Project, and then save the project as "TestProj.vbp."

<P><LI>When prompted to "Add this project to Source Code Control," click Yes.

<P><LI>Select a project in the "Add SourceSafe Project" dialog box and click
   OK.

<P><LI>When prompted to create a new Visual SourceSafe project, click Yes.

<P><LI>In the "Add to SourceSafe dialog," select all the files in the project
   and click OK.
<P>
</OL>You will then receive the error:
<P>
<PRE>   "Unable to add the project to source code control"

</PRE></OL>However, when you run Visual SourceSafe, you will see that the project has
been created.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist<BR>
Keywords            : ssafe ssvb kbprb kbprg<BR>
Version             : 4.00 5.00<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
