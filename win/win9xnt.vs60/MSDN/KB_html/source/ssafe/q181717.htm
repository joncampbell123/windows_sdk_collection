

<HTML>
<HEAD>
<TITLE>BUG: Analyze Problems with Open Log Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181717">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1998/02/24">
<META NAME="Keywords" CONTENT="ssdb">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  Analyze reports returns the error listed below and if you are running Analyze with either the -f or the -d switch, or both, files are deleted either from the data\      directory, or destroyed in the SourceSafe database.  Here is the error:     Una...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAKR,QAHE,QABH,QAHH,QBWS,QDML,QAFI,QA5E,QAGB,QAEF,QBCT,QAZV,QAGC,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Analyze Problems with Open Log Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181717</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Analyze reports returns the error listed below and if you are running
Analyze with either the -f or the -d switch, or both, files are deleted
either from the data\&lt;a-z&gt; directory, or destroyed in the SourceSafe
database.
<P>
Here is the error:
<P>
<PRE>   Unable to open file &lt;physical filename&gt;
   File &lt;physical filename&gt; is already open.

</PRE><h2>CAUSE</h2>
 
<P>
If a log file (a file with no extension in one of the data\&lt;a-z&gt; folders)
is opened and locked by a different process, such as a backup utility
running simultaneously with Analyze, Analyze treats the file as an orphan.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The best cure is prevention. You should run Analyze without any switches
before running it with either the -d switch or the –f switch. If Analyze
reports that a file is already open, take whatever steps necessary to close
that file before using the additional switches. Once the problem has
occurred, the resolution will be determined by a number of factors, such as
which files have been deleted, how important it is to maintain their
history, and whether a file or project was affected. If you are not sure
what action to take, contact Microsoft Technical Support.
<P>
<P>
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An orphan file is one that has been destroyed from the SourceSafe database
via the SourceSafe Explorer or the command line, and is not branched to or
from a file that still exists in the database. In the scenario described in
the CAUSE section, Analyze sees this file as an orphan, but its physical
file pair still exists in the data\&lt;a-z&gt; folder. Analyze -d attempts to
delete the file pair. It might delete either or both of the files,
depending on which file is locked at the time it attempts the deletion. A
locked file is not deleted. This may result in "File &lt;physical data file
name&gt; not found" errors.
<P>
Analyze -f behaves differently on projects and files as described below:

<UL><LI>If the file pair represents a file, Analyze destroys the file in the
   SourceSafe database. When this happens, the history of the parent
   project shows that the file was destroyed by user "REBUILD". The
   physical file pair of the file's parent project is copied to the Backup
   folder, in their pre-analyzed state.

<LI>If the file pair represents a project, Analyze copies the corresponding
   file pair to the backup directory, and attempts to delete the file pair.
<P>
</UL>Analyze -d -f results in both situations described above.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
NOTE: Reproducing this behavior causes problems with the SourceSafe
database. Do not attempt to reproduce this on a live database. Use this on
a database that is set up for testing purposes only.
<P>
Using an application that locks files that it opens, such as Microsoft
Word, opens a log file in the SourceSafe data directory. Run Analyze with
any combination of the -f and -d switches, for full information, use the
-v4 switch.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../ssafe/q139566.htm">Q139566</A></B>
   TITLE     : SAMPLE: Analyze5.Exe Utility for Visual SourceSafe

   ARTICLE-ID: <B><A href="../ssafe/q168634.htm">Q168634</A></B>
   TITLE     : INFO: When -d Switch of Analyze Deletes Files

   ARTICLE-ID: <B><A href="../ssafe/q157984.htm">Q157984</A></B>
   TITLE     : How SourceSafe Uses the DATA Directory

   ARTICLE-ID: <B><A href="../ssafe/q167263.htm">Q167263</A></B>
   TITLE     : PRB: &lt;filename&gt; is Already Open

</PRE> 
<PRE>Keywords          : ssdb
Version           : WINDOWS:5.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
