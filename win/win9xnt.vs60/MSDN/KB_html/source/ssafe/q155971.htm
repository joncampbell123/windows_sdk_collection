

<HTML>
<HEAD>
<TITLE>PRB: 32-bit SSEXP.EXE Doesn't Work but 16-bit SSEXP.EXE Does </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155971">
<META NAME="KBModify" CONTENT="1997/02/03">
<META NAME="KBCreate" CONTENT="1996/09/12">
<META NAME="Keywords" CONTENT="kbprg kbprb kbfile">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When the 32-bit version of Visual SourceSafe 4.0 is launched, an error message is displayed.  In Windows NT 3.51, the dialog box says,  The procedure entry point ?VS_FileGetHdr@@YAHPADPAUFILEHDR@@@Z could not be located in the dynamic link library ...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QDNN,QBWS,QDIR,QAO0,QAFI,QATF,QAD7,QDIY,QBVV,QA01,QAY2,QAJ4,QAC1,QDML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 32-bit SSEXP.EXE Doesn't Work but 16-bit SSEXP.EXE Does</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155971</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the 32-bit version of Visual SourceSafe 4.0 is launched, an error
message is displayed.
<P>
In Windows NT 3.51, the dialog box says, "The procedure entry point
?VS_FileGetHdr@@YAHPADPAUFILEHDR@@@Z could not be located in the dynamic
link library ssapi.dll." When the OK button is clicked, another dialog box
appears that says, "The application failed to initialize properly
(0xc0000139). Click on OK to terminate the application." When the OK button
is clicked, the user is returned to the operating system.
<P>
In Windows 95, the dialog box says, "The SSGUI.DLL file is linked to
missing export SSAPI.DLL:?VS_FileGetHdr@@YAHPADPAUFILEHDR@@@Z." When the OK
button is clicked, another dialog box appears that displays the path to the
SSEXP.EXE file and says, "A device attached to the system is not
functioning." When the OK button is clicked, the user is returned to the
operating system.
<P>
However, if the 16-bit version is launched, it starts without a problem.
<P>
<P><h2>CAUSE</h2>
 
<P>
There is a newer version of Ssapi.dll and Ssus.dll in the WIN32
subdirectory which is not compatible with Win32\Ssexp.exe.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Download Vssdll4.exe, a self-extracting executable, to the VSS\WIN32 sub-
directory. Run the file and overwrite the existing DLLs. Remember to
update both the local and server installations of Visual SourceSafe with
the correct version of the DLLs.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/vssdll4.exe">Vssdll4.exe</A> <I>(size: 230748 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>WORKAROUND</h2>
 
<P>
One workaround to downloading the file is as follows:
<P>
If you don't have access to the Internet, you can sometimes get the two
needed files off the CD-ROM. The SSAFE1.CAB file on the CD-ROM must have a
time/date stamp of 1/16/96 or this won't work. The two files needed are:
SSAPI.DLL and SSUS.DLL. In order to get the files off the CD-ROM, you will
need to run the following command twice, once for each file.
<P>
<PRE>   SYNTAX

   extract /L &lt;subdirectory to extract the file to&gt; ssafe1.cab &lt;file to
   extract&gt;

   Example:

   extract /L F:\VSS\WIN32 ssafe1.cab ssapi.dll

   and then run:

   extract /L F:\VSS\WIN32 ssafe1.cab ssus.dll

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are newer versions of SSAPI.DLL and SSUS.DLL that are needed to work
with newer versions of DDConv.EXE and Analyze.EXE. The newer versions of
DDConv.EXE and Analyze.EXE are available to users for free from Microsoft
download sites. These new utilities should be put in their own sub-
directory and not in the WIN32 sub-directory
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Download DDConv4.EXE as mentioned in Microsoft Knowledge Base article
   <B><A href="../ssafe/q150647.htm">Q150647</A></B>.

<P><LI>Copy DDConv4.EXE into the WIN32 directory.

<P><LI>Run DDConv4.EXE to self-extract the files. Answer YES when prompted
   to overwrite files.

<P><LI>Run WIN32\SSEXP.EXE.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbprb kbfile<BR>
KBSubcategory: ssafe<BR>
Additional reference words: 4.00 error message cannot launch start<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
