

<HTML>
<HEAD>
<TITLE>FIX: How to Install When Setup Fails on Novell </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153871">
<META NAME="KBModify" CONTENT="1997/08/25">
<META NAME="KBCreate" CONTENT="1996/07/22">
<META NAME="Keywords" CONTENT="ssafe kb3rdparty kbsetup fixlist5.00 kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When installing Visual SourceSafe 4.0 from a Windows 95 computer, the following message is displayed:      The specified volume does not support long file names. You must select    a destination that supports long file names, or force the use of sh...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBWO,QDML,QAFI,QA56,QA55,QDL9,QBWQ,QBWN,QAY2,QBXB,QATJ,QDIZ,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: How to Install When Setup Fails on Novell</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153871</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   versions 4.0, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When installing Visual SourceSafe 4.0 from a Windows 95 computer, the
following message is displayed:
<P>
<PRE>   "The specified volume does not support long file names. You must select
   a destination that supports long file names, or force the use of short
   file names. To force short file names, exit now and restart Setup using
   the /F command line option."

</PRE>When Setup /F is run from a Windows 95 computer, the following message is
displayed:
<P>
<PRE>   "Setup Error 997"
   "Object 90"

   "Your Setup files may be damaged. Try restarting the Setup program."

</PRE>When the OK button is pressed, a similar dialog box with another Object
number is displayed.
<P>
After clicking the OK box a number of times, the following message
will display:
<P>
<PRE>   "Microsoft Visual SourceSafe 4.0 Setup was not completed successfully."

</PRE><h2>CAUSE</h2>
 
<P>
By default, Novell NetWare servers can't handle long file names. The Visual
SourceSafe setup routine, when run on a Windows 95 computer, assumes that
the location of the install will be able to handle long file names. This
same behavior will happen if you attempt to install to a location that is
not Novell NetWare but can't handle long file name either.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two workarounds to this problem:

<OL><P><LI>Install from a non-Windows 95 computer, such as Windows 3.1, Windows for
   Workgroups 3.11, or Win NT 3.51.

<P><LI>If Windows 95 computers are the only ones available, you can install
   the server copy locally and then copy those files to the Novell NetWare
   server. See detailed instructions in the More Information section of
   this article.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article.
<P>
This problem has been fixed in Visual SourceSafe 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can install Visual SourceSafe to a Novell NetWare server from a Windows
95 computer by following the steps outlined below. This procedure consists
of installing to a local machine, copying the local installation to the
server, and then deleting the local installation.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Run Setup.exe, without the "/F" switch, from the compact disc or floppy
   disks, and choose the Server button to install a server copy of Visual
   SourceSafe. When prompted for a location to install, point to a location
   on the local computer.

<P><LI>Xcopy the local installation to a new location on the server.
<P>
</OL>NOTE: If there is an existing SourceSafe 3.x or earlier installation, do
not copy the new installation to the old directory because the copy
procedure overwrites the old data directory: this would result in a loss of
all information in SourceSafe. The copy procedure should be to a new
directory and the directions in the section below entitled Extra Steps if
an Older Version of SourceSafe Exists should be followed.

<OL><P><LI>Check this installation by running the appropriate SSEXP.exe file. If
   you are on Windows 3.1 or Windows For Workgroups 3.11, run
   VSS\WIN\SSEXP.exe. If you are on Windows 95 or Windows NT 3.51, run
   VSS\WIN32\SSEXP.exe.

<P><LI>If you would like a client installation of Visual SourceSafe, run
   Netsetup from the server. This will also register it with Visual Basic
   4.0, Visual C++ 4.x or other products that integrated with Visual
   SourceSafe. Even though a server copy of Visual SourceSafe has been
   installed to the Windows 95 computer, a client installation will still
   have to be performed to integrate with Visual Basic 4.0, Visual C++ 4.x
   or other products that integrated with Visual SourceSafe.
<P>
</OL><h3>Extra Steps if an Older Version of SourceSafe Exists</h3>
 
<P>
If you have an older version of SourceSafe on your server, and are
installing from a Windows 95 computer, perform the directions above and
then do the following:

<OL><P><LI>Xcopy the DATA directory from the 3.x installation to the 4.0
   installation. This will overwrite the 4.0 DATA directory. Doing this
   will bring your source code from the 3.x installation to the 4.0 file
   structure.

<P><LI>Xcopy the USERS directory from the 3.x installation to the 4.0
   installation. This will overwrite the 4.0 USERS directory.

<P><LI>Copy the 'users.txt' and the 'srcsafe.ini' files from the SS directory
   to the VSS directory, overwriting the 4.0 copies.

<P><LI>Run ddconv on the DATA directory. If you are on Windows 3.1 or Windows
   for Workgroups 3.11, use VSS\WIN\ddconv.exe. If you are on Windows 95 or
   Windows NT 3.51, use VSS\WIN32\ddconv.exe. Run this from a Command
   prompt with the following syntax:
<P>
<P><PRE>      ddconv &lt;Path to DATA directory&gt;
</PRE>
<P><LI>If possible, run the ddconv that is in the analyze4.exe. This is
   available for free from download sites. For more information, please see
   the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE ID: <B><A href="../ssafe/q139566.htm">Q139566</A></B>
<PRE></PRE>      TITLE     : SAMPLE: ANALYZE5.EXE Utility for Visual SourceSafe

</PRE></OL><h3>Notes About Upgrading</h3>
 
<P>
Back up your SourceSafe database before upgrading. The installation process
converts your existing database to a new format. If there are problems
during conversion, you will need a backup to return to your previous
database.
<P>
Make sure all users exit SourceSafe before installing a new version.
However, users can have files checked out.
<P>
If users have copies of the SourceSafe 3.x executables on their computer
hard disks, they need to run the netsetup.exe from the server installation
of Visual SourceSafe.
<P>
The SourceSafe directory structure and file names have changed for Visual
SourceSafe 4.0, so the icons in your Windows Program Manager for SourceSafe
3.X will not work with Visual SourceSafe 4.0. New icons are installed
during the client setup process using netsetup.exe. These icons will point
to the correct new program locations.
 
<PRE>Keywords          : ssafe kb3rdparty kbsetup fixlist5.00 kbbuglist kbfixlist
Version           : 4.0 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
