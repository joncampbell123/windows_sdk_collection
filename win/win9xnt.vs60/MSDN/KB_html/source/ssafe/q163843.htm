

<HTML>
<HEAD>
<TITLE>INFO: Managing Linked Tables When You Create a New DB from VSS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163843">
<META NAME="KBModify" CONTENT="1997/03/28">
<META NAME="KBCreate" CONTENT="1997/02/18">
<META NAME="Keywords" CONTENT="kbusage ssacc ssint">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Visual SourceSafe integration with Microsoft Access enables you to create a database from the SourceSafe server. This feature enables users to create additional co...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAZV,QABI,QDML,QAE2,QABH,QA56,QA55,QAB4,QA9E,QBXR,QAY2,QDN9,QAAP,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Managing Linked Tables When You Create a New DB from VSS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163843</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0, 4.0a,
   5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Visual SourceSafe integration with Microsoft Access enables
you to create a database from the SourceSafe server. This feature enables
users to create additional copies of a shared project on different
workstations or folders.
<P>
This article discusses methods for maintaining linked tables when you
create a new database from a Visual SourceSafe project.
<P>
This article assumes that you are familiar with using the client and
server side capabilities of Visual SourceSafe. For more information about
Visual SourceSafe, please refer to the "Visual SourceSafe User's Guide" or
the Help topics available from the Visual SourceSafe Help menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you create a new database from a project on a Visual SourceSafe
server, any linked tables in the database are refreshed as the table
definitions are created. Microsoft Access expects to find the exact
configuration on the target workstation with respect to the location
of the linked tables or in the case of linked ODBC tables, the exact
DSN and configuration to connect to the ODBC data source successfully.
<P>
If the required folder, database file, or ODBC data source is not found as
the linked table is being created, the following error occurs:
<P>
<PRE>   An error occurred while trying to create the linked table '&lt;Table Name&gt;'

</PRE>The error indicates that the table definition could not be created and will
not exist in the new database. It is important to note that the table still
exists in the SourceSafe project on the server and that the new database is
not a true reflection of the project; this situation must be corrected.
<P>
The following sections discuss techniques you can use to relink the tables
in your database.
<P>
<P><h3>Links to ODBC Data Sources</h3>
 
<P>
You can create a procedure that uses the RegisterDatabase method to create
an ODBC data source for a linked table. Create the code module in your
database and check it in to the Visual SourceSafe project; then when you
create a new database from that project on another workstation, the
database will contain the necessary code to refresh its linked ODBC tables.
<P>
NOTE: If ODBC is not installed on the target workstation when you create a
new database from a Visual SourceSafe project, you must install ODBC and
the ODBC drivers your database uses before you can refresh linked ODBC
tables.
<P>
For an example of a procedure that programmatically creates ODBC
data sources and refreshes linked tables, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q159691.htm">Q159691</A></B>
   TITLE     : INF: Procedure to Create Data Sources and Relink ODBC Tables

</PRE>Follow these steps to recreate ODBC links and resolve conflicts with the
SourceSafe project when you create a new database:

<OL><P><LI>Create your custom procedure for creating ODBC data sources and
   refreshing your linked tables, and check it in to the Visual
   SourceSafe project.

<P><LI>On another workstation, start Microsoft Access and create a new
   database from the Visual SourceSafe project by pointing to SourceSafe
   on the Tools menu, and then clicking Create Database from SourceSafe
   Project.

<P><LI>As the database is created, you receive the following error for any
   linked ODBC tables that Microsoft Access cannot refresh:
<P>
<P><PRE>      An error occurred while trying to create the linked table '&lt;Table
      Name&gt;'.
</PRE><P>
   Respond to all error messages and finish creating the database.

<P><LI>Execute your custom procedure to create ODBC data sources and refresh
   the linked tables.

<P><LI>Check out Data and Misc. Objects. If the object checks out successfully,
   your database is synchronized with the files on the Visual SourceSafe
   server. You can check in Data and Misc. Objects, or leave it checked out
   and work on the project.
<P>
</OL><h3>Links That Use the Microsoft Jet Database Engine</h3>
 
<P>
When you create a database from a Visual SourceSafe project that contains
links to Microsoft Access, Microsoft FoxPro, dBASE or any of the other file
formats supported by the Jet database engine, you receive one of the
following error messages if Microsoft Access cannot locate the linked
table:
<P>
<PRE>   Couldn't find file '&lt;File Name&gt;'.

   -or-

   The Microsoft Jet database engine could not find the object '&lt;File
   Name&gt;'. Make sure the object exists and that you spell its name and the
   path name correctly.

</PRE></OL>This is followed by:
<P>
<PRE>   An error occurred while trying to create the linked table '&lt;Table
   Name&gt;'.

</PRE>This happens if the path to the linked table file is different on the
workstation than it is on the computer where the table links were created,
or if the linked file has been moved.
<P>
For example, the following steps cause an error when you create a new
database from a Visual SourceSafe project:

<OL><P><LI>Create a new database with a link to a dBASE file called
   C:\MyFolder\MyFile.dbf.

<P><LI>Place the database under source code control.

<P><LI>On another workstation, create a new database from the VSS project. When
   Microsoft Access tries to create the linked dBASE table, it looks for a
   file called C:\MyFolder\MyFile.dbf. If that file does not exist on the
   workstation, an error occurs.
<P>
</OL>To avoid this problem, place the dBASE file in a shared network location
before you create the linked table. When you link to the file, use the UNC
name (such as \\MyServer\MyFolder\MyFile.dbf), or use a mapped drive letter
that will be the same on all workstations (such as G:\MyFile.dbf). Then
when you place the database under source code control and create a new
database from the Visual SourceSafe project on another workstation,
Microsoft Access will find the file and successfully create the linked
table. If you use this method, and you still receive error messages when
you create a new database:

<UL><LI>Check that the workstation has installed the correct drivers in
   Microsoft Access to link to the table. If not, run Setup to install the
   necessary drivers.

<LI>Verify that the workstation can access the network server via the UNC
   name or mapped drive letter (\\MyServer\MyFolder or G:), and that the
   correct permissions exist on that share to allow the workstation to
   read the file.
<P>
</UL>Once you resolve the connection issues to the linked file, check out Data
and Misc. Objects in the new database. If all the linked tables check out
successfully, your database is synchronized with the files on the Visual
SourceSafe server. You can check in Data and Misc. Objects, or leave it
checked out and work on the project.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: VSS SS ACCSCC attach<BR>
Keywords            : kbusage ssacc ssint<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
