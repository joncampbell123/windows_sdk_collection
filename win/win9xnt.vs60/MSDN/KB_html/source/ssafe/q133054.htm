

<HTML>
<HEAD>
<TITLE>HOWTO: Detect and Fix Database Corruption Errors in SSafe </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133054">
<META NAME="KBModify" CONTENT="1997/11/10">
<META NAME="KBCreate" CONTENT="1995/07/24">
<META NAME="Keywords" CONTENT="SourceSafe ss3 vbwin kbtool kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  The SourceSafe Data directory includes a database that contains all of your files and projects. Although every precaution has been taken to ensure the integrity of all SourceSafe files, there are certain events that can cause the data in this datab...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAB4,QAZV,QDML,QAR4,QADK,QABH,QAH4,QAKP,QA2S,QBWS,QAM1,QAA1,QAC1,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Detect and Fix Database Corruption Errors in SSafe</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133054</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SourceSafe for Windows, versions 3.04, 3.1
<LI>Microsoft SourceSafe for Windows NT, versions 3.04, 3.1
<LI>Microsoft SourceSafe for MS-DOS, versions 3.04, 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The SourceSafe Data directory includes a database that contains all
of your files and projects. Although every precaution has been taken to
ensure the integrity of all SourceSafe files, there are certain events
that can cause the data in this database to become corrupted.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Errors relating to the Data directory, to filenames such as
aacpaaaa, or to missing files such as abaaaaaa.b occur.
<P>
SourceSafe database corruption can be caused by a variety of factors.
Listed below are a few events that can cause database corruption:

<UL><LI>Power loss
<LI>System hangs (stops responding)
<LI>User terminates a long process
<LI>Bad network connections
<LI>Running out of disk space
<LI>Network problems
<LI>Operating system problems
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to analyze and resolve the database problems
SourceSafe is having:

<OL><P><LI>The Analyze program allows you to search for database corruption
   or database errors. Use the following command to execute the Analyze
   program:
<P>
<P><PRE>      Analyze &lt;SourceSafe Data directory&gt;
</PRE><P>
   To run the Analyze program in unattended mode, use the -i- option. For
   example, if you want to run Analyze overnight and output the results to
   a text file, use the following syntax:
<P>
<P><PRE>       Analyze -i- &lt;path to data&gt; &gt; c:\output.txt
</PRE><P>
   Analyze.exe goes through your database, reporting possible problems. If
   database errors or corrupted database files are discovered, continue
   through the following steps.
<P>
   The primary use of this program is to scan a SourceSafe database for
   integrity and/or errors. We recommend that administrators run it
   every one to three months to verify that there are no problems in
   their SourceSafe database.

<P><LI>If there are access rights problems, "unable to checkout files" errors,
   "losing checkout status" errors, or any other errors that refer to the
   Status.dat or Rights.dat file, run the Ddconv.exe or Ddconvw.exe
   program. These programs update a SourceSafe database from an older
   format to the current format. By default, these programs are installed
   in the \admin subdirectory.
<P>
   These programs are used primarily by installation scripts to verify
   that the format of an installed SourceSafe database is correct after an
   update has occurred. Ddconv.exe is also used to create a new SourceSafe
   database (see the Mkss utility for more information). During
   installation, if SourceSafe cannot find all of the installed databases,
   the administrator may have to run this utility manually. Ddconv.exe
   (with the -s option) can also be used by the administrator to rebuild
   files in the database.
<P>
   For additional information, please see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q132930.htm">Q132930</A></B>
<PRE></PRE>      TITLE     : How to Run DDCONV

</PRE><P><LI>If the errors returned by the Analyze program refer to "FREE CHAIN"
   and you are using Microsoft SourceSafe versions 3.x, run the Fixfree
   program. Fixfree.exe fixes a variety of database errors reported when
   running Analyze.exe, such as the following:
<P>
<P><PRE>    - Invalid extended header structure.
    - Error in extended header.
    - Error processing checkout free chain.
    - Checkout free chain contains a loop.
    - Checkout chain contains a loop.
</PRE><P>
   For additional information, please see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q123466.htm">Q123466</A></B>
<PRE></PRE>      TITLE     : FIXFREE.EXE Fixes Database Errors Reported by ANALYZE.EXE

</PRE><P><LI>If the errors returned by the Analyze program refer to "PROJECT FILE"
   and you are using Microsoft SourceSafe versions 3.x, run the Fixprj
   program. You can use Fixprj.exe to fix a variety of project errors,
   such as the following:
<P>
<P><PRE>    - File Not Found: &lt;filename.a or b&gt;.
    - Error reading PRJ INT entry: &lt;num&gt; of 38 bytes read.
    - Error in project file.
</PRE><P>
   For additional information, please see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q123427.htm">Q123427</A></B>
<PRE></PRE>      TITLE     : SourceSafe: Use FIXPRJ.EXE to Fix Project Errors

</PRE><P><LI>If the errors returned by the Analyze program refer to "PARENT CHAIN",
   and you are using Microsoft SourceSafe versions 3.x, run the Fixpar
   program. Fixpar.exe repairs various database errors reported by
   Analyze.exe such as the following:
<P>
<P><PRE>    - Error in Parent Chain.
    - Parent not found.
</PRE><P>
   Fixpar.exe removes references to projects that no longer exist.
<P>
   For additional information, please see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q130178.htm">Q130178</A></B>
<PRE></PRE>      TITLE     : FIXPAR Fixes Database Errors Reported by ANALYZE.EXE

</PRE><P><LI>If the error returned by Analyze.exe refers to "Cannot find file
   &lt;filename&gt;.b" or "Cannot find file &lt;filename&gt;.a," the best
   workaround is to save a copy of the correct current file. Recover both
   files (&lt;filename&gt; and &lt;filename&gt;.a or &lt;filename&gt;.b) as they existed on
   the backup. Then update the file in SourceSafe to the current version.
<P>
   If the &lt;filename&gt;.a or &lt;filename&gt;.b refers to a project, use Fixprj.exe
   to rebuild the project file.

<P><LI>If the errors returned by Analyze.exe refer to any other type of
   problem, call Microsoft Technical Support for further assistance. You
   can reach Microsoft Technical Support at the following phone numbers:
<P>
<P><PRE>    - In the United States, call (425) 635-7014.
    - In Canada, call (905) 568-3503.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
Refer to the Administrator's help file in SourceSafe for command
information.
 
<PRE>Keywords          : SourceSafe ss3 vbwin kbtool kbtshoot
Version           : 3.04 3.1
Platform          : MS-DOS NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
