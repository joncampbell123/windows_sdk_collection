

<HTML>
<HEAD>
<TITLE>PRB: Word 97 Document Added to SourceSafe as Text File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165237">
<META NAME="KBModify" CONTENT="1997/04/07">
<META NAME="KBCreate" CONTENT="1997/03/14">
<META NAME="Keywords" CONTENT="ssui kbinterop kbprb">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  SourceSafe may interpret Word Documents as Text format when you add them to your database, potentially corrupting the files. The conversion process of Word 97 to Word 6.0/95 format apparently converts the file into text format.  NOTE: To verify the...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QDML,QAMB,QBRZ,QDO7,QDNG,QATX,QAUR,QDNE,QABI,QAU7,QABH,QBTI,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Word 97 Document Added to SourceSafe as Text File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165237</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0, 5.0
<LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SourceSafe may interpret Word Documents as Text format when you add them to
your database, potentially corrupting the files. The conversion process of
Word 97 to Word 6.0/95 format apparently converts the file into text
format.
<P>
NOTE: To verify the format type SourceSafe stored, highlight the file, then
from the File menu in the SourceSafe Explorer, choose Properties. The file
type is displayed on the General tab.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you save a file in Word 6.0/95 format, it generates a file in Rich
Text Format (RTF), which is text representation of a Binary file.
SourceSafe detects this and stores the file as Text. The corruption occurs
when the format of the file is converted back to Word 97 Binary format
while SourceSafe has the file registered as Text.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Any of the following three methods can be used to avoid this problem:

<UL><LI>Don't save files created in Word 97 as Word 6.0/95 format. Instead, have
   users of Word 6.0 or Word 95 get the Microsoft Word 97 Converter.
<P>
   For additional information about the Microsoft Word 97 Converter,
   please see the following article in the Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A href="../word/q162602.htm">Q162602</A></B>
   TITLE  : WORD 97: Questions About Saving in the Word 6.0/95 File Format
<P>
 -or-

<LI>When adding a file, you see a Comment dialog box with an Advanced&gt;&gt;
   button at the bottom. Click this button and change the File Type drop-
   down box to Binary.
<P>
 -or-

<LI>Add the following to your Srcsafe.ini file before any section headers.
<P>
<P><PRE>      Binary_Masks = *.doc
</PRE><P>
</UL>If you find a .doc file (that it is not damaged) stored incorrectly as Text
type, you can store it correctly without damaging the file, but you will
lose the History. Perform a Get Latest Version, destroy (delete
permanently) the file in SourceSafe, then add back the local file using one
of the three methods described above.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. SourceSafe correctly identifies the .rtf file
as being a text file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Steps to Reproduce Problem
 

<OL><P><LI>Open a new document in Word 97, save it as "Word 6.0/95" and close.

<P><LI>Add the file to SourceSafe.

<P><LI>Check out the file and edit it in Word 97.

<P><LI>Choose File, and Save As a "Word Document(*.doc)" file type.

<P><LI>Close the file.

<P><LI>Check the file back into SourceSafe.

<P><LI>Now highlight the file, choose Edit, View File, and you will see
   corrupted characters.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: trash ssafe garbage<BR>
Keywords            : ssui kbinterop kbprb<BR>
Version             : 3.0b 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
