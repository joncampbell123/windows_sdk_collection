

<HTML>
<HEAD>
<TITLE>BUG: SssccSP2.exe: "The Database is Unavailable..." When Opening </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178398">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1997/12/19">
<META NAME="Keywords" CONTENT="ssvc">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  After installing the Visual Studio 97 SP3 and opening a project under source control, you may get the following error:     Microsoft Visual SourceSafe    The database is unavailable. Would you like to disable source control    integration?  CAUSE =...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QBJZ,QDML,QAA1,QAUJ,QABI,QAJQ,QAIJ,QDI2,QBWS,QBS0,QANE,QBXS,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SssccSP2.exe: "The Database is Unavailable..." When Opening</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178398</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
<LI>The development environment included with:
   - Microsoft Visual Studio 97sp3
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After installing the Visual Studio 97 SP3 and opening a project under
source control, you may get the following error:
<P>
<PRE>   Microsoft Visual SourceSafe
   The database is unavailable. Would you like to disable source control
   integration?

</PRE><h2>CAUSE</h2>
 
<P>
There are two possible causes:

<OL><P><LI>You have set up a user name using the Visual SourceSafe administrator
   that is not the same as the user name you use to log into your
   workstation and the SourceSafe user name has a password.

<P><LI>You have the same user name in Visual SourceSafe as you use to log into
   your workstation, but you have deselected "Use network name for
   automatic user log in" in the Visual SourceSafe Administrator, Tools
   menu, Options menu item, General tab.
<P>
</OL><h2>RESOLUTION</h2>
 
<P>
Use one of the following resolutions as a workaround:

<OL><P><LI>After you start your developer application, but before you open a
   project that is under source control, start the Visual SourceSafe
   Explorer from the Project menu, Source Control submenu in Visual C++ or
   Tools menu, Visual SourceSafe submenu in Visual Basic. This will present
   you with a login dialog. After a successful login, you will be able to
   open the project under source control in Visual Studio.

<P><LI>Using the Visual SourceSafe Administrator, check "Use network name for
   automatic user log in" in the Tools menu, Options menu item, General
   tab. Then make sure that all user names match the login names used to
   log into Windows NT and/or Windows 95. The Visual SourceSafe passwords
   are ignored during login in this case.

<P><LI>If you are using a Visual SourceSafe login name that is different than
   your login name for Windows, then don't use a password.

<P><LI>Roll back to the Service Pack 2 (05.00.2220) version of Ssscc.dll that
   is in SssccSP2.exe.
<P>
   Please see the MORE INFORMATION section for instructions on obtaining
   this file.
<P>
   The following file is the only file included in SssccSP2.exe:
<P>
   - Ssscc.dll, version 05.00.2220

<P><LI>"set" the SSUSER and SSPWD environment variables using the following
   procedure:
<P>
   Method 1
   --------
<P>
   Setting a command prompt shell environment. You need to do this each
   time you open the application.
<P>
   a. Open a command prompt and type something, such as set ssuser=guest.
<P><PRE>      If this user has a password, you must also set the SSPWD variable,
      such as set sspwd=password.
</PRE><P>
   b. While still in the command prompt, use "cd" to change to the install
<P><PRE>      location of your development application and start it up.
</PRE><P>
   Method 2
   --------
<P>
   Setting the Windows shell environment.
<P>
   In Windows NT:
<P>
   a. Right-click My Computer and click the Environment tab.
<P>
   b. Put the cursor in the Variable: text box and type SSUSER.
<P>
   c. Hit tab to the Value: text box and type in a valid Visual SourceSafe
<P><PRE>      login name, such as guest. If this user has a password, you must also
      set the SSPWD variable in the same manner.
</PRE><P>
   d. Click OK.
<P>
   e. Restart Windows NT.
<P>
   In Windows 95:
<P>
   a. Add the following two line to the Autoexec.bat:
<P>
<PRE>         set ssuser=&lt;username&gt;
         set sspwd=&lt;password&gt;

   b. Save and restart Windows 95.

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
~ SssccSP2.exe (size: 572928 bytes)
<P>
For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
In Visual C++:

<OL><P><LI>Set up a user using the Visual SourceSafe Administrator that isn't the
   same name as your Windows account name. Make sure you enter a password.

<P><LI>Start Visual Studio. On the Tools menu, select Options, click the
   SourceSafe tab, and type in the Visual SourceSafe login name you will be
   using.

<P><LI>Open a project that is under source control.
<P>
   -or-

<P><LI>Set up a user using SourceSafe Administrator that is the same name as
   your Windows account. On the Tools menu, select Options, and deselect
   the "Use network name for automatic user log in" check box.

<P><LI>Start Visual Studio. On the Tools menu, select Options, click the
   SourceSafe tab, and type in the Visual SourceSafe login name you will be
   using.

<P><LI>Open a project that is under source control.
<P>
</OL>In Visual Basic:

<OL><P><LI>Set up a user using the Visual SourceSafe Administrator that isn't the
   same name as your Windows account name. Make sure you enter a password.

<P><LI>Start Visual Basic.

<P><LI>Open a project that is under source control.
<P>
   -or-

<P><LI>Set up a user using Visual SourceSafe Administrator that is the same
   name as your Windows account. On the Tools menu, select Options, and
   deselect the "Use network name for automatic user log in" check box.

<P><LI>Start Visual Basic.

<P><LI>Open a project that is under source control.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: service pack servicepack ssscc.dll<BR>
Keywords          : ssvc<BR>
Version           : WINDOWS:5.0,97sp3; WINNT:<BR>
Platform          : WINDOWS winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
