

<HTML>
<HEAD>
<TITLE>BUG: SourceSafe File Not Found Error When VB Deletes .FRX File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148892">
<META NAME="KBModify" CONTENT="1997/05/13">
<META NAME="KBCreate" CONTENT="1996/03/25">
<META NAME="Keywords" CONTENT="SourceSafe kbbuglist kbusage">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  In a Visual Basic project, if a form at one time contained graphical information and that graphical information is removed, then the .frx file may be deleted by automatically Visual Basic, or deleted manually by the user. This causes the following ...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAEF,QABI,QABH,QDML,QA56,QA55,QBVV,QBCT,QA5F,QAMA,QAGC,QAGB,QDKD,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SourceSafe File Not Found Error When VB Deletes .FRX File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148892</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe for Windows, versions 4.0, 5.0
<LI>Standard, Professional, and Enterprise Editions of Microsoft Visual
   Basic for Windows, 16-bit and 32-bit, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a Visual Basic project, if a form at one time contained graphical
information and that graphical information is removed, then the .frx file
may be deleted by automatically Visual Basic, or deleted manually by the
user. This causes the following error message to appear in the Source Code
Control Results window when you check the Visual Basic project back into
SourceSafe:
<P>
<PRE>   File "&lt;path to .frx&gt;.FRX" not found

</PRE><h2>CAUSE</h2>
 
<P>
Visual Basic stores text information for a form in the .frm file and binary
information for a form in the .frx file. Every time it saves a form, Visual
Basic determines whether or not the .frx file is needed. If it is not
needed, the .frx file is deleted.
<P>
The problem is Visual SourceSafe stores the current and historical copies
of the Visual Basic form (.frm and .frx) files. Visual SourceSafe does not
detect that Visual Basic has determined that the .frx file is no longer
needed. Visual SourceSafe sees the missing .frx as an error.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Here are two possible workarounds:

<UL><LI>Set an icon for the form. This will force Visual Basic to always keep
   the .frx file without increasing the amount of resources used or the
   size of the form.
<P>
   -or-

<LI>Start the Visual SourceSafe Explorer, and delete (do not destroy) the
   .frx file when it is no longer needed. This will remove the .frx file
   from SourceSafe without destroying the history.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start a new project in Visual Basic 4.0.

<P><LI>Add the Visual Basic project to Source Code Control.

<P><LI>Check out the entire project (including the .vbp file).

<P><LI>Add a new form (Form2).

<P><LI>Add a bitmap to the Form2 picture property to create the .frx for Form2.

<P><LI>Save and check in the entire project.

<P><LI>Check out the project.

<P><LI>Delete the bitmap from the Form2 picture property.

<P><LI>Save the project. (The .frx for Form2 should be automatically deleted by
   Visual Basic.

<P><LI>Check in the entire project. In the Source Code Control Results window,
<P><PRE>    the following message appears:
</PRE><P>
<P><PRE>    File "&lt;path to .frx&gt;.FRX" not found
 </BLOCKQUOTE>


	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : SourceSafe kbbuglist kbusage<BR>
Version             : 4.00 5.00 | 4.00 5.00<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
