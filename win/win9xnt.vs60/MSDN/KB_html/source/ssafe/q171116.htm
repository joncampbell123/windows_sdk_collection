

<HTML>
<HEAD>
<TITLE>HOWTO: Enable VSS Integration with FrontPage and Visual InterDev </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171116">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1997/07/08">
<META NAME="Keywords" CONTENT="fpvss ssfp ssidev">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  If you are using either FrontPage or Visual InterDev with Visual SourceSafe integration, you can use one of two configurations.  You can either store your Visual SourceSafe database on the same machine that is running IIS, or on a machine other tha...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QAGU,QABI,QDML,QBWP,QAI5,QBG2,QAAP,QAB4,QAWK,QBWS,QBVV,QBWF,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Enable VSS Integration with FrontPage and Visual InterDev</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171116</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 32-bit, for Windows, versions 4.0, 4.0a,
   5.0
<LI>Microsoft FrontPage 97 for Windows
<LI>Microsoft Visual Studio 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you are using either FrontPage or Visual InterDev with Visual SourceSafe
integration, you can use one of two configurations.
<P>
You can either store your Visual SourceSafe database on the same machine
that is running IIS, or on a machine other than the one running IIS.
<P>
This article presents the required actions to ensure that Visual SourceSafe
integration is working with FrontPage or Visual InterDev for both
configurations.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article assumes that the Web server is IIS running on Windows NT 4.0,
that the Visual SourceSafe database is also on a Windows NT 4.0 computer,
and that both are on NTFS partitions. This article covers the steps
necessary to integrate Visual SourceSafe with FrontPage or Visual InterDev.
<P>
Section 1 lists the necessary steps to enable integration in either of the
two configurations, and Section 2 lists additional steps you must take if
the IIS service and Visual SourceSafe database are on different machines.
Section 3 contains troubleshooting information.
<P>
<P><h3>SECTION 1: Steps Necessary in all Configurations</h3>
 
<P>
On the machine running IIS:

<OL><P><LI>Ensure that the anonymous account has Log On Locally privileges. To do
   this:
<P>
   A. Run the User Manager For Domains.
<P>
   B. Select the IIS-SERV machine, and select Policies ... User Rights from
<P><PRE>      the menu.
</PRE><P>
   C. From the right drop-down list, select "Log on locally". Make sure
<P><PRE>      that the anonymous account is listed either individually or as a
      member of one of the groups.
</PRE>
<P><LI>Check that that the anonymous account has the same password in both IIS
   Service Manager and User Manager For Domains. It may be necessary to
   have the user re-enter the password in both these places. Two potential
   pitfalls are:
<P>
   A. In User Manager For Domains the password always appears padded out to
<P><PRE>      14 characters. This can be confusing if you have entered a shorter
      password.
</PRE><P>
   B. After changing the password in IIS you should stop and restart the
<P><PRE>      service to clear out any password caching.
</PRE>
<P><LI>Make sure that the anonymous account can log on automatically. In User
   Manager For Domains make sure that the "User Must Change Password at
   Next Logon" and "Account Disabled" check boxes are not selected.
<P>
   NOTE: If you're uncertain about what your machine's anonymous user
   should be, go to the IIS configuration utility, and look in the
   properties for the WWW service.

<P><LI>Check that the correct components of Visual SourceSafe have been
   installed. Do this by either running Netsetup from a server installation
   of Visual SourceSafe, or if you are installing from CD, either choose
   Client Setup, or under Custom click "Enable Visual SourceSafe
   Integration."
<P>
</OL>On the machine with the Visual SourceSafe Database:
<P>
To view Directory permissions, right-click the Directory in the Windows NT
Explorer, click Properties, click the Security tab, and then click
Permissions. To view Share permissions, right-click the shared Directory in
the Windows NT Explorer, click Properties, click the Sharing tab, and then
click Permissions.

<OL><P><LI>Assign CHANGE permissions to all Visual SourceSafe logon accounts for
   all files under the Visual SourceSafe installation directory (including
   the Visual SourceSafe data directory if it is in a different location).
<P>
   NOTE: It is assumed that the Administrators and System accounts will be
   granted full control to the entire VSS directory hierarchy.

<P><LI>Grant at least read permissions to all Visual SourceSafe logon accounts
   for the following additional files:
<P>
<P><PRE>      srcsafe.ini
      um.dat
      users.txt
</PRE><P>
</OL>Grant at least read\write permissions to all Visual SourceSafe logon
accounts for the following additional files or directories:
<P>
<PRE>   vss\users\&lt;logon account directory&gt;\
   vss\data\
   vss\temp\
   rights.dat
   status.dat

</PRE></OL>In the Visual SourceSafe Administrator:

<OL><P><LI>Add the anonymous account as a user, with no password.

<P><LI>Add the actual FrontPage or Visual InterDev user(s) (password optional).

<P><LI>Under Tools menu, click Options, click the General tab, and make sure
   that "Use network name for automatic user log in" is selected.
<P>
<P>
</OL><h3>SECTION 2: Additional Steps Necessary When IIS and the Visual SourceSafe</h3>
 
<P>
Database are on Different Machines:

<UL><LI>On the machine with the Visual SourceSafe Database:
   In User Manager For Domains, add the anonymous account from the machine
   running IIS as a user, and give it the same password as on the IIS
   machine and make sure it has logon locally permissions.

<LI>On the machine running IIS:
   Set the correct properties for the WWW service in IIS. In the Service
   Properties for the WWW service, the three check boxes for "Password
   Authentication" should appear as follows:
<P>
<P><PRE>      Allow Anonymous - selected.
      Basic (Clear Text) - selected.
      Windows NT Challenge/Response - not selected.
</PRE><P>
</UL>Windows NT Challenge/Response is also referred to as NTLM. Because this
setting is not selected, users have to enter their user name and domain
password when they open a Web. Use the format "domainname\username" for the
user's name when working with multiple domains.
<P>
<P><h3>SECTION 3: Troubleshooting</h3>
 
<P>
NOTE: If the server machine is a Windows 95 computer, make sure that
someone remains logged into Window 95. Often users will leave their servers
at the login prompt, and the integration between Visual SourceSafe and
Visual InterDev will not work when there is no one logged onto the server.
<P>
The Windows NT Event Viewer on the IIS server often contains information
that can help locate the cause of a problem if integration is not working.
These log errors usually come in pairs, the later (topmost) of which
usually contains an error number and the one below it a short description
of the error. Double-click a log entry to view its details.
<P>
The errors might differ depending on exactly how the components are
configured, below is a sample of errors encountered and their cause:
<P>
Errors that appear in the Application Log:

<UL><LI>Error: Source Control System failure:  File "srcsaf.ini" not found.
   Cause: Visual SourceSafe integration is not enabled.

<LI>Error: Source Control System failure: User &lt;username&gt; not found.
   Cause: The user  &lt;username&gt; has not been added to the Visual SourceSafe
<PRE>          database.

</PRE><LI>Error: Source Control System failure: Could not find VSS resource DLL
   Cause: The anonymous or user accounts do not have the correct NTFS file
<PRE>          permissions.

</PRE><LI>Error: Source Control System failure: Access to file "&lt;path&gt;
<PRE>          \srcsafe.ini" denied

   -or-

   Error: Source Control System failure: Access to file "&lt;path&gt; \um.dat "
          denied
   Cause: IIS and the Visual SourceSafe database are on different machines
          and NTLM is enabled.

</PRE><LI>Error: Source Control System failure: Invalid handle
   Cause: IIS and the Visual SourceSafe database are on different machines
<PRE>          and the anonymous account has a different password on the two
          machines, or does not have Log on locally permissions on the
          Visual SourceSafe machine.

</PRE></OL>Errors that appear in the System Log:

<UL><LI>Error: The server was unable to logon the Windows NT account &lt;anonymous
<PRE>          user account&gt; due to the following error: unknown user name or
          bad password.
   Cause: On the IIS machine, the anonymous account either does not have
          Log on locally permissions, or the account's password in IIS and
          User Manager differ.

</PRE><LI>Error: The server was unable to logon the Windows NT account &lt;anonymous
<PRE>          user account&gt; due to the following error: unknown user name or
          bad password.
   Cause: The anonymous user account has been disabled in User Manager.

</PRE></UL><h2>REFERENCES</h2>
 
<P>
General Integration Information:
<P>
For general information on FrontPage integration, see
<B><A href="http://microsoft.com/ssafe/techmat/frontpage.htm">http://microsoft.com/ssafe/techmat/Frontpage.htm</A></B>
<P>
For general information on Visual InterDev integration, see the online
documentation in the User's Guide, Authoring Web Content, Using Visual
Visual SourceSafe With your Web.
<P>
Basic Troubleshooting:
<P>
For more information on troubleshooting FrontPage or Visual InterDev
integration, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../frontpg/q160766.htm">Q160766</A></B>
   TITLE     : VSS Source Control Project Box Does Not Appear in FrontPage

</PRE>IIS Security and the Anonymous Account:
<P>
For general information on IIS security and the anonymous account, see
Chapter 5 of the online documentation for IIS (inetdocs.htm).
<P>
For information on IIS security as it relates to FrontPage/InterDev see
<B><A href="http://www.microsoft.com/frontpage/wpp/serk">http://www.microsoft.com/FrontPage/wpp/serk</A></B> (FrontPage Server Extensions
Resource Kit)
and
<B><A href="http://www.microsoft.com/workshop/server/feature/security.asp">http://www.microsoft.com/workshop/server/feature/security.asp</A></B>
<P>
Necessary Permissions for Visual SourceSafe Directories:
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../ssafe/q131022.htm">Q131022</A></B>
   TITLE     : INFO: Required Network Rights for the Visual SourceSafe
               Directories
</PRE> 
<PRE>Keywords          : fpvss ssfp ssidev
Technology        : kbInetDev
Version           : WINNT:4.0,4.0a,5.0;
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
