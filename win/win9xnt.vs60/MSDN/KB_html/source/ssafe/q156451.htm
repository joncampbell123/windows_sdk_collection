

<HTML>
<HEAD>
<TITLE>FIX: DDCONV Causes GP Fault During Database Conversion </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156451">
<META NAME="KBModify" CONTENT="1997/08/25">
<META NAME="KBCreate" CONTENT="1996/09/24">
<META NAME="Keywords" CONTENT="ssafe ssconv kbprg fixlist5.00 kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  When you use DDCONV.EXE in an attempt to convert your SourceSafe 3.x database to the Visual SourceSafe 4.0 format, a General Protection Fault may occur.  When DDCONV.EXE is run against the database, it generates a file called DDCERR.LOG. This file ...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDML,QAZV,QAFI,QBXB,QA56,QA55,QATJ,QAJ6,QAY2,QAGB,QAEF,QDIU,QAR4,QAA1,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: DDCONV Causes GP Fault During Database Conversion</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156451</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   versions 4.0, 4.0a, 5.0
<LI>Microsoft SourceSafe for Windows, versions 3.04, 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use DDCONV.EXE in an attempt to convert your SourceSafe 3.x
database to the Visual SourceSafe 4.0 format, a General Protection Fault
may occur.
<P>
When DDCONV.EXE is run against the database, it generates a file called
DDCERR.LOG. This file contains an informational list of the actions
performed by DDCONV.EXE and includes references to any problems encountered
during the upgrade.
<P>
This article contains information on the following problem:

<UL><LI>You are receiving a General Protection Fault when running DDCONV.EXE.

<LI>The last entry in the DDCERR.LOG file reads:
<P>
   File &lt;filename&gt;.&lt;a or b&gt; not found
<P>
</UL>where &lt;filename&gt; is any 8-character filename with an extension of .a or .b.
<P>
<P><h2>CAUSE</h2>
 
<P>
Each file or project in a SourceSafe database is represented as a "file
pair" within the database itself. For example, information on the root
project ($/) of a SourceSafe database is stored in the file AAAAAAAA,
called the log file, and AAAAAAAA.A (or .B), called the data file. If you
were to add a new file to an empty SourceSafe database, it would be stored
internally as BAAAAAAA and BAAAAAAA.A (or .B).
<P>
NOTE: The file extension will alternate between .A and .B each time the
file is modified or labeled.
<P>
If the data file for a Project is moved or deleted and you attempt to run
DDCONV.EXE against the database, a General Protection Fault will occur.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You may use the DDCERR.LOG file to identify the physical file name that is
generating the error. From this point, any of three approaches may be used
to fix the problem:

<OL><P><LI>Delete the offending log file for which no data file exists. This may
   cause data loss, but, if the data file is missing, it is already
   inaccessible from SourceSafe.

<P><LI>Recover the file pair (both the data and the log file) from a backup
   copy of the database.

<P><LI>Microsoft has provided a new version of DDCONV.EXE that prevents the
   General Protection Fault from occurring. To download this version,
   please see the following article in the Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A href="../ssafe/q150647.htm">Q150647</A></B>
<PRE>   TITLE     : Updated Visual SourceSafe 4.0 DDCONV.EXE

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article.
<P>
This problem has been fixed in Visual SourceSafe 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following procedure describes how to upgrade your SourceSafe database
when using this new version of DDCONV:

<OL><P><LI> Copy your SourceSafe 3.1 database, including the Data directory and all
<P><PRE>    of its subdirectories, to a new directory. Or, you can make a backup
    copy to a tape drive.
</PRE>
<P><LI> Make a backup copy of the \USERS directory, the SS\SRCSAFE.INI file,
<P><PRE>    and the SS\USERS.TXT file.
</PRE>
<P><LI> Run DDCONV.EXE against the database using the following syntax:
<P>
<P><PRE>    DDCONV &lt;path to database&gt;
</PRE>
<P><LI> Install the server version of Visual SourceSafe 4.0a to a new, empty
<P><PRE>    directory. Do not point to your SourceSafe 3.x location.
</PRE>
<P><LI> After the Visual SourceSafe installation is complete, verify that it is
<P><PRE>    version 4.0a by choosing About from the Help menu. Version 4.0a is
    required for this procedure.
</PRE>
<P><LI> Copy the VSS\DATA\VERSION.DAT file from the Visual SourceSafe 4.0a
<P><PRE>    installation to a temporary location outside of the SourceSafe
    directory structure.
</PRE>
<P><LI> Delete the VSS\DATA directory and all of its subdirectories from the
<P><PRE>    Visual SourceSafe installation.
</PRE>
<P><LI> Copy the converted SourceSafe Data directory, from step 3 above, to the
<P><PRE>    Visual SourceSafe installation.
</PRE>
<P><LI> Copy the backed-up VERSION.DAT file, from step 4 above, to the new
<P><PRE>    VSS\DATA directory, overwriting the existing file.
</PRE>
<P><LI>Delete the VSS\USERS directory, the VSS\USERS.TXT file, and the
<P><PRE>    VSS\SRCSAFE.INI file from the new Visual SourceSafe installation.
</PRE>
<P><LI>Copy the SS\USERS directory, the SS\USERS.TXT file, and the
<P><PRE>    SS\SRCSAFE.INI file, from step 2 above, to the new Visual SourceSafe
    directory.
</PRE>
<P><LI>Run ANALYZE.EXE against the database to correct any remaining problems
<P><PRE>    in the database files using the following syntax:
</PRE><P>
<P><PRE>    ANALYZE &lt;path to data directory&gt; -f
</PRE><P>
</OL>NOTE: It may be necessary to run ANALYZE against the database more than
once. Each time ANALYZE is run, it will create an output file called
ANALYZE.LOG that contains a description of the errors it encountered.
ANALYZE should be run until two successive LOG files are identical. For
additional information on ANALYZE, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../ssafe/q139566.htm">Q139566</A></B>
   TITLE     : SAMPLE: ANALYZE5.EXE Utility for Visual SourceSafe

</PRE></OL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new, empty SourceSafe 3.x database.

<P><LI>Switch to or start SourceSafe 3.x Explorer, and add a new project.

<P><LI>Close SourceSafe.

<P><LI>Switch to File Manager or the Windows Explorer and delete the following
   file:
<P>
   &lt;path to SourceSafe Database&gt;\SS\DATA\BAAAAAAA.A

<P><LI>Run DDCONV.EXE against the database. Note that a General Protection
   Fault occurs and that the last entry in DDCERR.LOG is:
<P>
   File BAAAAAAA.A not found

<P><LI>Delete the file BAAAAAAA and rerun DDCONV.EXE. Note that the process
   completes successfully.
</OL> 
<PRE>Keywords          : ssafe ssconv kbprg fixlist5.00 kbbuglist kbfixlist
Version           : 3.04 3.1 4.0 4.0a 5.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
