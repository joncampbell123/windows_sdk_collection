

<HTML>
<HEAD>
<TITLE>HOWTO: Upgrade from SourceSafe 3.x to Visual SourceSafe 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153873">
<META NAME="KBModify" CONTENT="1997/10/21">
<META NAME="KBCreate" CONTENT="1996/07/22">
<META NAME="Keywords" CONTENT="ssafe vss kb3rdparty kbsetup kbusage">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  Due to the change in structure of the database from SourceSafe 3.x to Visual SourceSafe 4.0, there are several steps that would be beneficial to take when upgrading.  MORE INFORMATION  1. Purge\Destroy all unneeded files and projects from the 3.1 d...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDML,QAA1,QAFI,QABH,QDI2,QBWS,QA56,QA55,QAEF,QA9N,QADK,QAJN,QBWO,QAY2,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Upgrade from SourceSafe 3.x to Visual SourceSafe 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153873</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows,
   versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Due to the change in structure of the database from SourceSafe 3.x to
Visual SourceSafe 4.0, there are several steps that would be beneficial
to take when upgrading.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Purge\Destroy all unneeded files and projects from the 3.1 database.
   First, understand the difference between a deleted and a destroyed
   file/project: A deleted file/project is recoverable, destroyed files are
   not. If a deleted file existed in an earlier version of a project, it
   will reappear when a Get is done on that earlier version of the project.
   If the file is destroyed, it will not reappear.
<P>
   To destroy a file or project that is active, highlight the file, hit the
   delete key, make sure the "Destroy permanently" checkbox is checked, and
   click the OK button.
<P>
   To destroy a file or project that has been deleted, highlight the parent
   project, access the Info menu, chose the Removed... option. You will be
   presented with a list of files and projects that used to exist in the
   parent project but have been deleted. This is a multiselect listbox.
   Select the files/projects you want to destroy, and click the Purge
   button.
<P>
   If you have a deleted file or project with the same name as an active
   file and want to keep both versions, it is recommended that you
   temporarily rename the active file/project. To rename a file, highlight
   the file, access the File menu, and choose the Rename... option.

<P><LI>Tell all users to exit any SourceSafe executables. Users can have files
   checked out, but they cannot be running any of the executables.

<P><LI>Check to make sure there is no detectable corruption in the 3.1
   database. This can be done by running the 3.x version of Analyze.exe on
   the 3.1 data. Analyze.exe can be found in the ADMIN and the WINNT
   subdirectories of the SourceSafe 3.x installation. This process can take
   anywhere from 5 seconds to 7 hours depending on the complexity of the
   database and the size of the SS\DATA subdirectory. Given operating
   system permissions and correct login information, Analyze.exe can be run
   in an overnight process.
<P>
   To run Analyze.exe, type the following in a Command box:
<P>
<P><PRE>      analyze -I- &lt;path to data directory&gt; &gt;analyze.log
</PRE><P>
   This command runs the Analyze executable on your data without prompting
   you for input, and then outputs the results to the Analyze.log file.
<P>
   Look at the Analyze.log file. If it says: "Analysis Complete No Errors
   Found" move on to the next step. If it says anything else, correct those
   error messages before trying the upgrade.
<P>
   For more information, please see the following articles in the Microsoft
   Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q133054.htm">Q133054</A></B>
<PRE></PRE>      TITLE     : HOWTO: Detecting and Fixing Database Corruption Errors in
                  SourceSafe

      ARTICLE-ID: <B><A href="../ssafe/q131447.htm">Q131447</A></B>
      TITLE     : HOWTO: Use PHYSICAL Command to Find SourceSafe Database
                  File

</PRE><P><LI>Make a full backup of your 3.1 SS\DATA subdirectory and all its
   subdirectories.

<P><LI>Create an empty subdirectory on a 32-bit operating system (Windows 95
   or Windows NT). Download Analyze5.exe from one of the Microsoft download
   sites into this subdirectory. Run the file to extract its contents. For
   more details on how to obtain this self-extracting executable, please
   refer to the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q139566.htm">Q139566</A></B>
<PRE></PRE>      TITLE     : SAMPLE: ANALYZE5.EXE Utility for Visual SourceSafe

</PRE><P><LI>At that 32-bit operating system, unload anything that might be in
   memory, especially virus protectants. Then open a Command prompt, change
   to the newly created subdirectory, and run the following:
<P>
<P><PRE>      ddconv &lt;path to data directory&gt;
</PRE>
<P><LI>When the process completes, open the ddcerr.log file that was created in
   the SS\DATA subdirectory. If the process doesn't complete, contact
   Visual SourceSafe product support. In the United States and Canada, the
   phone number is 425-635-7014.

<P><LI>If any messages except the following appear, there was corruption in
   the 3.1 database that caused a problem in the conversion:
<P>
<P><PRE>      DDCONV initializing
      Creating subfolders
      Moving files
      Creating rights DB
      Building project list
      Creating names DB
      Converting log files
      &lt;Logfile&gt; Parent count in old DB #, correcting to actual count #.
      &lt;Logfile&gt; parent project &lt;Project path&gt; not found, skipping parent
      record.
      &lt;Logfile&gt; Project entry count in old DB #, correcting to actual count
      #.
      &lt;Logfile&gt; Format record, invalid, correcting.
      Adding project rights
      Converting users
      DDCONV finished
</PRE><P>
   If a problem occurs, refer to the following article in the Microsoft
   Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q153872.htm">Q153872</A></B>
<PRE></PRE>      TITLE     : DDConv Messages of Visual SourceSafe 4.0

</PRE><P><LI>Insert the Visual SourceSafe CD-ROM, and run Setup.exe. Choose the
   server install, and point to the 3.1 installation. If SourceSafe is on
   a Novell Netware server, install won't work from a Windows 95 computer.
   See the following KB article:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q153873.htm">Q153873</A></B>
<PRE></PRE>      TITLE     : How to Install When Setup Fails on Novell

   As a workaround, you can run the install from a Windows 3.1, Windows for
   Workgroups 3.11, or Windows NT 3.51 workstation. If you only have
   Windows 95 workstations, install the server copy locally, drag and drop
   it to the Novell Netware server, and then copy the following from the
   SourceSafe 3.1 installation to the 4.0 installation:

      SS\USERS and all subdirectories
      SS\DATA and all subdirectories
      SS\srcsafe.ini
      SS\users.txt

</PRE><P><LI>Test the installation. While connected to the server copy of Visual
   SourceSafe, go to the appropriate subdirectory for the platform of your
   local operating system and run SSEXP. If it comes up, your installation
   and conversion was successful. If it doesn't come up or looks wrong,
   call Microsoft Visual SourceSafe technical support.

<P><LI>Rename any active files or projects that you renamed before the
   conversion (see Step 1) back to their original names.

<P><LI>After the server copy is installed, you will want to have users connect
   to the server copy of Visual SourceSafe and run Netsetup.exe to install
   the client copy of Visual SourceSafe. Your users can now use Visual
   SourceSafe.

<P><LI>Although not required, it is recommended that you run the analyze that
   was downloaded in step 5 on the 4.0 database. See the readme.txt file
   that came from the analyze4.exe self-extracting executable. See the
   following Microsoft Knowledge Base article for information about
   analyze messages:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../ssafe/q152807.htm">Q152807</A></B>
<PRE></PRE>      TITLE     : Error Messages from the Analyze Tool of Visual SourceSafe
</PRE></OL> 
<PRE>Keywords          : ssafe vss kb3rdparty kbsetup kbusage
Version           : 4.0 5.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
