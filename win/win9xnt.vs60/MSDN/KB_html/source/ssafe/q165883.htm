

<HTML>
<HEAD>
<TITLE>FILE: Errors with Large Recursive Branch and Share Operations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165883">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1997/03/26">
<META NAME="Keywords" CONTENT="kbfile kbusage ssusage">
<META NAME="KBArea" CONTENT="Support; KB; ssafe">
<META NAME="Description" CONTENT="  While executing a recursive Share and Branch operation on a SourceSafe project that contains a large number of files and 4 or more nested subprojects, the operation fails with a General Protection Fault, Out of Memory message or other memory relate...">
<META NAME="Product" CONTENT="Visual SourceSafe">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QAJH,QAJN,QDML,QA3A,QAK6,QA9N,QAY5,QAH6,QBCU,QAHT,QAG0,QBVV,QAX6,QA0K V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Errors with Large Recursive Branch and Share Operations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165883</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual SourceSafe, 16-bit and 32-bit, for Windows, versions
   4.0, 4.0a
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
While executing a recursive Share and Branch operation on a SourceSafe
project that contains a large number of files and 4 or more nested
subprojects, the operation fails with a General Protection Fault, Out of
Memory message or other memory related problems.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Sharing and Branching is an expensive operation in SourceSafe. Because the
operation itself involves intensive memory usage and file I/O, any problems
at the operating system or network level could cause it to fail. Once
completed, the Branch causes the SourceSafe database to grow in size as a
second copy of each branched file is created. For these reasons, large
Sharing and Branching should be used sparingly.
<P>
The dobranch.exe utility provides an alternative method of Sharing and
Branching that avoids the potential memory problems mentioned in the
SUMMARY section.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/dbrnch.exe">Dbrnch.exe</A> <I>(size: 46995 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>Below is the content of the readme.txt files that are included with the
utility.
<P>
 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as a Microsoft   |
| Software Library [MSL] file) IS PROVIDED "AS IS" WITHOUT WARRANTY  |
| OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT        |
| LIMITED TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR        |
| FITNESS FOR A PARTICULAR PURPOSE. The user assumes the entire risk |
| as to the accuracy and the use of this MSL file. This MSL file     |
| may be copied and distributed subject to the following conditions: |
| 1) All text must be copied without modification and all pages must |
| be included; 2) If software is included, all files must be copied  |
| without modification; 3) All components of this MSL file must be   |
| distributed together; and 4) This MSL file may not be distributed  |
| for profit.                                                        |
|                                                                    |
| Copyright 1997 Microsoft Corporation. All Rights Reserved.         |
| Microsoft is a registered trademark of Microsoft Corporation.      |
 --------------------------------------------------------------------

</PRE>This download consists of the following three files:

<OL><P><LI>This file (readme.txt)
</OL>2. dobranch.exe
3. dobranch.cpp
<P>
This utility can be used as an alternative method of performing a recursive
share and branch of a SourceSafe project.
<P>
<P><h3>Dobranch.exe</h3>
 
<P>
The file dobranch.exe is the utility itself, and should be saved in the
WIN32 directory under the SourceSafe installation.
<P>
Its usage is:
<P>
<PRE>   dobranch  &lt;target project&gt; &lt;source project&gt; [new project name]

</PRE></OL>The operation is analogous to a right mouse drag and drop in the SourceSafe
explorer. If your project tree looks like this:
<P>
<PRE>   $/
      Applications
              Develop
                      source
                      include
                      lib
      Bugfix
      Other Stuff

</PRE>and you right-click the $/Applications/Develop project, drag it over the
$/Bugfix project, choose Share and branch from the popup menu, then check
the "Recursive" checkbox, the equivalent command for this utility would be:
<P>
<PRE>   dobranch  $/Bugfix   $Applications/Develop

</PRE>Note that you should provide the full path to the target and source
projects.
<P>
Just like the drag and drop operation, this would create a new subproject:
<P>
<PRE>   $/Bugfix/Develop

</PRE>that would have the three nested subprojects.
<P>
To share and branch to a sibling subproject of Develop, use the following
command:
<P>
<PRE>   dobranch  $/Applications   $/Applications/Develop    NewDev.

</PRE>The project tree would then be:
<P>
<PRE>   $/
      Applications
              Develop
                      source
                      include
                      lib
              NewDev
                      source
                      include
                      lib
      Bugfix
      Other Stuff

</PRE>If your project names contain spaces, wrap the project name in quotes. For
example:
<P>
<PRE>   dobranch  "$/Other Stuff" $/Applications/Develop "More Stuff"

</PRE>to create the following project tree:
<P>
<PRE>   $/
      Applications
              Develop
                      source
                      include
                      lib
      Bugfix
      Other Stuff
              More Stuff
                      source
                      include
                      lib

</PRE>The utility creates two text files in the Win32 subdirectory, dirfile.out
and errfile.log. The first is the output from a recursive ss dir command of
the source project, the second is a log file of errors encountered by the
various Visual SourceSafe operations.
<P>
If the program is executed successfully, these files are deleted (you'll
never know they were there).
<P>
If the utility fails, you can check errfile.log for clues about what caused
the failure, and dirfile.out can be deleted manually (however, this is not
necessary).
<P>
<P><h3>Dobranch.cpp</h3>
 
<P>
The file dobranch.cpp is the source code for dobranch.exe and can be
examined to understand how the program works, and for those interested, can
be modified to provide more functionality (for example, providing an extra
parameter to specify a project version, or specifying the path to any
SourceSafe database). It was compiled with Microsoft Visual C++ version 4.0
Most users, however, will not need to look at this file.
<P>
<P><h3>Additional Notes</h3>
 

<OL><P><LI>Branching a specific version.
<P>
   There is no switch for this in dobranch.exe, but it can easily be
   accomplished by PINning the project before executing dobranch.exe. For
   example, if the $/Applications/Develop project has a label 'beta1',
   type the following command-line command before executing dobranch.exe
<P>
<P><PRE>      SS Pin $/Applications/Develop/*.* -Vbeta1
</PRE>
<P><LI>Limitations of the utility.
<P>
   Internal links within the source project are not be retained in the
   target project. For example, if a file in $/Apllications/Develop/lib is
   shared or branched to a file in $/Apllications/Develop/include, and you
   execute:
<P>
<P><PRE>      dobranch $/Applications $/Applications/Develop NewDev
</PRE><P>
   the file in $/Applications/NewDev/lib will not have links to the file in
   $/Applications/NewDev/include.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbfile kbusage ssusage<BR>
Version             : 4.0 4.0a 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
