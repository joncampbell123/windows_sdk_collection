

<HTML>
<HEAD>
<TITLE>Web Proxy Access Control Fails When Set Up on IIS 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178173">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/12/16">
<META NAME="Keywords" CONTENT="kberrmsg kbsetup pxssetup kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; proxysvr, axsf, winnt, iis, mcis">
<META NAME="Description" CONTENT="  If you set up Proxy Server 2.0 on Internet Information Server (IIS) 4.0 (either as an upgrade or new setup), and you select (enable) access control with a valid user account, the Web Proxy clients may fail to connect and display one of the followin...">
<META NAME="Product" CONTENT="Proxy Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVX,QBWD,QAVZ,QDKF,QAA1,QBRJ,QBVW,QAPP,QAI5,QA1S,QDI2,QBV9,QAPN,QAB4,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Web Proxy Access Control Fails When Set Up on IIS 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178173</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Proxy Server version 2.0
<LI>Microsoft Internet Information Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you set up Proxy Server 2.0 on Internet Information Server (IIS) 4.0
(either as an upgrade or new setup), and you select (enable) access control
with a valid user account, the Web Proxy clients may fail to connect and
display one of the following error messages:
<P>
NOTE: The error message depends on the browser you use.
<P>
Microsoft Internet Explorer version 4.0 and 4.01:
<P>
<PRE>   Nothing returned to browser (no error or blank page)

</PRE>Microsoft Internet Explorer version 3.02:
<P>
<PRE>   The requested header not found.

</PRE>Netscape Navigator version 3.02:
<P>
<PRE>   Document contains no data.

</PRE><h2>CAUSE</h2>
 
<P>
This is caused by a problem with the authentication settings with IIS 4.0
and the Web Proxy ISAPI filter.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use one of the following methods:
<P>
<P><h3>Method 1</h3>
 
<P>
Disable Access Control in Web Proxy Service by opening the Web Proxy
Properties within the MMC and go to the Permissions tab. Clear the Enable
Access Control check box.
<P>
<P><h3>Method 2</h3>
 
<P>
Disable Anonymous access for the default web site in IIS 4.0.
<P>
NOTE: This will enable Proxy clients to connect to the Internet; however,
it does not allow anonymous users to connect to the default web site if the
server is also used for Internet publishing.
<P>
<P><h3>Method 3</h3>
 
<P>
Do Method 2 and make the following IIS configuration changes to allow
anonymous users access to your web site.
<P>
a. Bind a second valid IP address to the external interface of the
<PRE>   Proxy/IIS computer.

</PRE>b. Create a new web site.
<P>
c. Assign the new IP address to the new web site.
<P>
d. Select the Anonymous access box during web site creation.
<P>
NOTE: This configuration will allow Anonymous Internet users to view web
pages on the server and allow proxy users to authenticate before connecting
to the Internet. In addition, it requires that an additional valid Internet
IP address is obtained from the Internet Service Provider.
<P>
Once these steps are completed, the second web site can be created.
Please see the IIS 4.0 online documentation for additional information.
<P>
To add multiple IP addresses in Microsoft Windows NT Server version4.0:

<OL><P><LI>Obtain a valid second Internet IP address.

<P><LI>Right click Network Neighborhood.

<P><LI>Click Properties.

<P><LI>Click Protocols.

<P><LI>Double-click TCP/IP Protocol.

<P><LI>With external adapter active in the dropdown list, click the
   Advanced button.

<P><LI>In the Addresses box, click the Add button and then add the second
   IP address you got from the ISP and provide the correct subnet mask.

<P><LI>Click OK four times.

<P><LI>Reboot the computer.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Proxy Server
version 2.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prx2faq ie faq frequently asked questions<BR>
Keywords          : kberrmsg kbsetup pxssetup kbfaq<BR>
Version           : WINNT:2.0,4.0<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
