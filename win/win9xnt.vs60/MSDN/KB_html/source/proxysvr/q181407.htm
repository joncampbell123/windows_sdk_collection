

<HTML>
<HEAD>
<TITLE>Troubleshooting Proxy 2.0 RAS Autodial and Autodisconnect </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181407">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1998/02/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; proxysvr, axsf, winnt, iis, mcis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Proxy Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKF,QAVZ,QBWS,QBXS,QBTX,QACK,QAJ4,QA1S,QAI5,QA6A,QBWB,QBVW,QAPP,QA4P,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Proxy 2.0 RAS Autodial and Autodisconnect</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181407</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Proxy Server, versions 1.0, 2.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a
Registry Key" Help topic in Regedt32.exe.
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Proxy Server has the ability to autodial a RAS phonebook entry to
connect to the Internet when a proxy request is made.
<P>
This article describes troubleshooting steps required for RAS autodial and
autodisconnect to function correctly with Microsoft Proxy Server 1.0 and
2.0.
<P>
Please see "Setting Server Parameters" in the Microsoft Proxy Server
documentation for complete Setup instructions before consulting this
article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>AUTODIAL</h3>
 
<P>
To Disable RAS Autodial Manager:

<OL><P><LI>In Control Panel, double-click Services.
</OL>2. In the Services dialog box, select Remote Access Autodial Manager, and
<PRE>   click Startup.
</PRE></OL>3. In the Service dialog box, under Startup Type, click Disabled, and then
<PRE>   click OK.

</PRE>To Enable Connection Manager:

<OL><P><LI>In Control Panel, double-click Services.
</OL>2. In the Services dialog box, select Remote Access Connection Manager, and
<PRE>   then click Startup.
</PRE></OL>3. In the Service dialog box, under Startup Type, click Automatic, click
<PRE>   OK, and then click Close.

</PRE>Telephony:
<P>
If a prefix is required to reach an outside line, it must be manually pre-
pended to the phone number in the RAS phonebook. The telephony settings
are not imported when using the RAS API.
<P>
Dialing Behavior:
<P>
Proxy Server 2.0 has changed the dialing behavior slightly. You can modify
the registry to revert to Proxy Server 1.0 dialing behavior by doing the
following:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.

<OL><P><LI>Start the registry editor.
</OL>2. Create the following registry value:
<P>
<PRE>   HKEY_LOCAL_MACHINE/System/CurrentControlSet/Services/W3Proxy/Parameters

   Value Name: DialFailFailsConnect
   Data Type:  REG_DWORD
   Data:       0 (Decimal)

</PRE></OL>A value of zero (0) reverts to Proxy Server 1.0 behavior. A value of one
(1) specifies the new behavior in Proxy Server 2.0.
<P>
<P><h3>AUTODISCONNECT</h3>
 
<P>
RAS will fail to disconnect under any of the following conditions:
<P>
- A Winsock application on a client is open and connected to the Internet.
<P>
- A Web Proxy client (Web Browser) is left open and connected to a Web Page
<PRE>   that contains a refresh tag.

</PRE>- The active caching feature of the Web Proxy service is updating the
<PRE>   cache.

</PRE>- Other TCP/IP traffic is present on the modem connection from the
<PRE>   Internet. For example, some Internet service providers may send router
   messages (such as ICMP or IGMP messages) to your server while it is
   connected to the Internet. A network trace utility such as network
   monitor can be used to verify that this is the cause of the problem. It
   may be necessary to contact your Internet service provider to correct
   this problem.

</PRE>Other Settings That May Affect Autodisconnect:
<P>
PPP LCP extensions should be disabled to prevent LCP packets from resetting
the autodisconnect timer. To disable, edit the phonebook entry for your
connection. On the Server tab, clear the check box for Enable PPP LCP
Extensions.
<P>
To Unbind the WINS Client from External Network Adapters:

<OL><P><LI>In Control Panel, double-click Network.
</OL>2. In the Network dialog box, click the Bindings tab.
3. Next to Show Bindings for, click the down arrow, and then select all
<PRE>   adapters.
</PRE></OL>4. In the adapter list, click the plus sign next to Remote Access WAN
<PRE>   Wrapper to expand the view.
</PRE>5. Under Remote Access WAN Wrapper, select WINS client (TCP/IP), and then
<PRE>   click Disable.
</PRE>6. When finished, click OK.
<P>
To Set Idle TimeOut:
<P>
The Idle TimeOut option in Dial Up Networking must be set for the
connection to hang up after being idle.

<OL><P><LI>Open the Dial Up Networking dialog box, and select User Preferences
   from the More button.

<P><LI>Disable AutoDial by Location, and set Idle Seconds Before Hanging Up
   to the desired amount of time. This value should be greater than 60.

<P><LI>Choose Logon Preferences from the More button, and set Idle Seconds
   Before Hanging Up to the same value as User Preferences.

<P><LI>Open Control Panel/Services and disable the Remote Access AutoDial
   Manager service. (See top of this article.)
<P>
</OL>For more information, see the Microsoft Knowledge Base article <B><A href="../proxysvr/q177122.htm">Q177122</A></B>:
"Error Message 12207 - Proxy Dialout Connection Failed."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: autohangup auto-dial auto-hangup auto-disconnect<BR>
DUP dial up networking prx2faq<BR>
Version           : WINNT:1.0,2.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
