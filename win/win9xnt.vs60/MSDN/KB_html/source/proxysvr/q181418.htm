

<HTML>
<HEAD>
<TITLE>Co-locating DNS Server and Proxy Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181418">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1998/02/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; proxysvr, axsf, winnt, iis, mcis">
<META NAME="Description" CONTENT="  After you install Microsoft Domain Name Service (DNS) Server or any third party DNS server on a computer running Microsoft Proxy Server, DNS requests from Internet hosts will fail.  CAUSE =====  This problem occurs if packet filtering is enabled. T...">
<META NAME="Product" CONTENT="Proxy Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKF,QBWS,QAGI,QBXS,QACK,QBVW,QAPP,QA01,QAPN,QAD7,QDN1,QDJP,QAUD,QAKG,QAAD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Co-locating DNS Server and Proxy Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181418</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Proxy Server, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you install Microsoft Domain Name Service (DNS) Server or any third
party DNS server on a computer running Microsoft Proxy Server, DNS requests
from Internet hosts will fail.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if packet filtering is enabled. The predefined packet
filter for DNS lookup in Microsoft Proxy Server is for outbound DNS
requests only.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In order for internal and external hosts to use a DNS server that is
installed on a Microsoft Proxy Server 2.0 computer with packet filtering
enabled, you need to create a packet filter for incoming requests. To do
this, perform the following steps:

<OL><P><LI>Open Internet Service Manager and double click the Winsock Proxy
   Server to display its properties.

<P><LI>Click the Security button to display the Security Properties
   dialog box.

<P><LI>Click the Add button to add a new filter.

<P><LI>From the Packet Filter Properties dialog box, choose the Radio button
   labeled "custom."

<P><LI>Set the Protocol ID to "UDP."

<P><LI>Set Direction to "Both" (this will allow both incoming and outgoing
   requests).

<P><LI>Set Local Port to "fixed port [ASCII 148]” and specify port 53.

<P><LI>Set Remote Port to "Any."

<P><LI>Set Local Host to "Default Proxy external address."

<P><LI>Set Remote Host to allow "Any host."

<P><LI>Click OK to return to the Security dialog box.

<P><LI>Click OK again to return to the Properties for the Winsock Proxy
</OL>Service, and then click OK once more.
<P>
A dialog will display informing you that the Proxy services will need to be
restarted for the changes to take effect. Click OK to confirm. After the
services have restarted you can click OK to close the Winsock Proxy Service
Properties dialog box.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Proxy Server
version 2.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
 
<PRE>Version           : WINNT:2.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbpending kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
