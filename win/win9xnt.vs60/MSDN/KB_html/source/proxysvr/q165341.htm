

<HTML>
<HEAD>
<TITLE>Configuring Proxy Server 1.0 with the IPX Protocol </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165341">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; proxysvr, axsf, winnt, iis, mcis">
<META NAME="Description" CONTENT="           CONFIGURING PROXY SERVER 1.0 WITH THE IPX PROTOCOL           ==================================================  Section 1: Configuring Proxy on a Network With Novell NetWare Servers  Section 2: Configuring Proxy on an Ethernet Network wit...">
<META NAME="Product" CONTENT="Proxy Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKF,QAVZ,QARL,QBTX,QBWS,QBXS,QBWP,QAI5,QAVX,QAVW,QDIZ,QBVW,QAPP,QAOE,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Configuring Proxy Server 1.0 with the IPX Protocol</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165341</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
<P>
The information in this article applies to:

<UL><LI>Microsoft Proxy Server, version 1.0
</UL> 
<P>
<PRE>          CONFIGURING PROXY SERVER 1.0 WITH THE IPX PROTOCOL
          ==================================================

</PRE>Section 1: Configuring Proxy on a Network With Novell NetWare Servers
<P>
Section 2: Configuring Proxy on an Ethernet Network with No NetWare Servers
<P>
Section 3: Configuring Proxy on a Token Ring Network with No NetWare
<PRE>           Servers

</PRE>Section 4: Troubleshooting IPX Proxy Clients
<P>
NOTE: For best results, please follow all instructions carefully and do not
omit any steps unless specifically advised to do so.
<P>
<P><h2>SECTION 1: CONFIGURING PROXY ON A NETWORK WITH NOVELL NETWARE SERVERS</h2>
 
<P>
<P>
If your network contains Novell NetWare servers or IPX routers that seed
the network with the correct IPX frame type and network address, both the
client and server IPX configuration can be set to Auto. This will force the
proxy server and client to obtain their IPX settings automatically.
<P>
<P><h3>Proxy Server Settings</h3>
 

<OL><P><LI>Disable the IPX binding for the external adapter:
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Bindings.
</PRE>   b. Click "Show bindings for all Protocols."
   c. Choose IPX/SPX compatible transport.
   d. Select the Internet network card listed here and click Disable.
   e. Reboot the server.

<P><LI>Set the IPX protocol for auto configuration:
<P>
   a. In Control Panel, double-click the Network icon.
   b. Under Protocols, click "NWLink IPX/SPX compatible transport."
   c. Use the Internal Network Number: 00000000.
   d. Choose Auto Frame Type Detection.
   e. Reinstall Proxy Server so that the new settings are added to the
<P><PRE>      Mspclnt.ini file.
</PRE>   f. Open the Mspclnt.ini file (located in the \Msp\Clients folder on the
<P><PRE>      server). Verify that the section called [Servers IPX Addresses]
      section exists. This section should contain one IPX address
</PRE><P>
<PRE>         Addr1=-&lt;address&gt;

      where &lt;address&gt; is a number like 00034567-1232fa34bb20.

</PRE><P><LI>Move the Internet binding on the proxy server. NOTE: If the Internet
   connection is being made through a Dial up connection, this section can
   be ignored).
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Bindings.
</PRE>   b. Click "Show Bindings for all protocols."
   c. Under NWLink IPX/SPX Compatible Transport, you should see your
<P><PRE>      network adapters listed.
</PRE>   d. Select the network adapter that you have connected to the Internet
<P><PRE>      and move it to the top of the list so that it is the first binding.
      This must be done even though IPX is disabled on this card.
</PRE><P>
</OL><h3>Proxy Client Settings for Windows NT Server Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Protocols, and
   then click NWLink IPX/SPX Compatible Transport.
</OL>2. Use the Internal Network Number: 00000000.
3. Choose Auto Frame Type Detection.
4. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.

</PRE></OL><h3>Proxy Client Settings for Windows NT Workstation Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Protocols, and
   then click NWLink IPX/SPX Compatible Transport.
</OL>2. Choose Auto Frame Type Detection.
3. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.

</PRE></OL><h3>Proxy Client Settings for Windows 95 Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Configuration,
   and then click NWLink IPX/SPX-Compatible Protocol.
</OL>2. On the NetBIOS tab click to select "I want to enable NetBIOS over
<PRE>   IPX/SPX."
</PRE></OL>3. On the Advanced tab, enter Frame Type = Auto and Network Address = 0.
4. Reboot the client and install the Winsock Proxy client.
5. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.


</PRE><h2>SECTION 2: CONFIGURING PROXY ON AN ETHERNET NETWORK WITH NO NETWARE SERVERS</h2>
 
<P>
If you do not have a Novell NetWare server on the network (or a computer
running Windows NT server with an internal network number configured), IPX
clients will not autoconfigure their IPX settings correctly. Windows NT
will not respond to the client's routing information protocol (RIP)
broadcasts for the external network number. This occurs even if an external
network number and frame type are defined on the Windows NT Server
computer.
<P>
NOTE: If your connection to the Internet is through a modem or ISDN adapter
with RAS, skip step 1.
<P>
If you have many IPX clients, the following client and server setting
should allow you to autoconfigure your IPX clients:
<P>
<P><h3>Proxy Server Settings</h3>
 

<OL><P><LI>Disable the IPX binding for the external adapter.
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Bindings.
</PRE>   b. Click "Show bindings for all protocols."
   c. Choose IPX/SPX Compatible Transport.
   d. Select the Internet network card listed here and click Disable.

<P><LI>Manually set the server IPX settings:
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Protocols.
</PRE>   b. Click "Show Properties for IPX/SPX protocol."
   c. Set the Frame Type to 802.3.
   d. Set the External Network Number to 44444444.
   e. Set the Internal Network Number to 55555555.
   f. Apply the changes and reboot the server.

<P><LI>Edit the Mspclnt.ini file on the Proxy server and add the following
   section. If this section already exists, replace it with the one below.
<P>
<P><PRE>      [Servers Ipx Addresses]
      Addr1=55555555-000000000001
</PRE><P>
<P><PRE>      NOTE: Be sure to use the 000000000001 as the MAC address regardless
      of your netcard's true MAC address.
</PRE>
<P><LI>Move the Internet binding on the proxy server:
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Bindings.
</PRE>   b. Click "Show Bindings for all protocols."
   c. Under NWLink IPX/SPX Compatible Transport, you should see your
<P><PRE>      network adapters listed.
</PRE>   d. Select the network adapter that you have connected to the Internet
<P><PRE>      and move it to the top of the list so that it is the first binding.
      This must be done even though IPX is disabled on this card.
</PRE>
<P><LI>Reboot your Proxy server.
<P>
</OL><h3>Proxy Client Settings for Windows NT Server Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:
1. In Control Panel, double-click the Network icon, click Protocols, and
<PRE>   then click NWLink IPX/SPX Compatible Transport.
</PRE></OL>2. Use the Internal Network Number: 00000000.
3. Choose Auto Frame Type Detection.
4. Install the WinSock Proxy client
5. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.

</PRE><h3>Proxy Client Settings for Windows NT Workstation Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Protocols, and
   then click NWLink IPX/SPX Compatible Transport.
</OL>2. Choose Auto Frame Type Detection.
3. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client machine. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.

</PRE></OL><h3>Proxy Client Settings for Windows 95 Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Configuration,
   and then click NWLink IPX/SPX-Compatible Protocol.
</OL>2. On the NetBIOS tab click to select "I want to enable NetBIOS over
<PRE>   IPX/SPX."
</PRE></OL>3. On the Advanced tab, enter Frame Type = AUTO and Network Address = 0.
4. Reboot the client and install the Winsock Proxy client.
5. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.


</PRE>SECTION 3: CONFIGURING PROXY ON A
<P><h2>TOKEN RING NETWORK WITH NO NETWARE SERVERS</h2>
 
<P>
If you do not have a Novell NetWare server on the network and are using
Token Ring cards on the internal side of the proxy server (or on a computer
running Windows NT server with an internal network number configured), IPX
clients will not autoconfigure their IPX settings correctly. Windows NT
will not respond to the clients RIP broadcasts for the external network
number. This occurs even if an external network number and frame type are
defined on the Windows NT Server computer.
<P>
NOTE: If your connection to the Internet is through a modem or ISDN adapter
with RAS, skip step 1.
<P>
If you have many IPX clients, the following client and server settings
should allow you to autoconfigure your IPX clients:
<P>
<P><h3>Proxy Server Settings</h3>
 

<OL><P><LI>Disable the IPX binding for the external adapter:
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Bindings.
</PRE>   b. Click "Show bindings for all protocols."
   c. Choose IPX/SPX Compatible Transport.
   d. Select the Internet network card listed here and click Disable.

<P><LI>Manually set the server IPX settings:
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Protocols.
</PRE>   b. Click "Show Properties for IPX/SPX protocol."
   c. The Frame Type will be TOKEN_RING.  Leave these as they are.
   d. Set the Internal Network Number to 55555555.
   e. Set the External Network Number to 44444444.
   e. Apply the changes and reboot the server.

<P><LI>Set the IP address for the Internal Token Ring card to 10.0.0.2 (or
   if you want to use IP on this card, and then use the IP number assigned
   to the card).

<P><LI>Install Proxy Server on the system. Choose to have the LAT contain
   10.0.0.0 to 10.255.255.255 as the range. (If you are also using IP on
   the internal card, and then also include that IP number in the LAT, if
   it is not already in this range).

<P><LI>Edit the Mspclnt.ini file on the Proxy server and add the following
   section. If this section already exists, replace it with the one below:
<P>
<P><PRE>      [Servers Ipx Addresses]
      Addr1=55555555-000000000001
</PRE><P>
<P><PRE>      NOTE: Be sure to use the 000000000001 as the MAC address regardless
      of your netcard's true MAC address.
</PRE><P>
   Remove the following section completely:
<P>
<P><PRE>      [Servers IP Addresses]
</PRE>
<P><LI>Move the Internet binding on the proxy server:
<P>
   a. In Control Panel, double-click the Network icon, and then click
<P><PRE>      Bindings.
</PRE>   b. Click "Show Bindings for all protocols."
   c. Under NWLink IPX/SPX Compatible Transport, you should see your
<P><PRE>      network adapters listed.
</PRE>   d. Select the network adapter that you have connected to the Internet
<P><PRE>      and move it up to the top of the list so it is the first binding.
      This must be done even though IPX is disabled on this card.
</PRE>
<P><LI>Reboot your Proxy server.
<P>
</OL><h3>Proxy Client Settings for Windows NT Server Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Protocols, and
   then click NWLink IPX/SPX Compatible Transport.
</OL>2. Use the Internal Network Number: 00000000.
3. Choose Auto Frame Type Detection.
4. Install the WinSock Proxy client.
5. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

     Client Control Protocol matches the server control protocol.

  Test further by using FTP or Telnet to connect to a site on the Internet.

</PRE></OL><h3>Proxy Client Settings for Windows NT Workstation Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Protocols, and
   then click NWLink IPX/SPX Compatible Transport.
</OL>2. Choose Auto Frame Type Detection.
3. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.

</PRE></OL><h3>Proxy Client Settings for Windows 95 Clients</h3>
 
<P>
Set the IPX protocol for auto configuration:

<OL><P><LI>In Control Panel, double-click the Network icon, click Configuration,
   and then click NWLink IPX/SPX-Compatible Protocol.
</OL>2. On the NetBIOS tab click to select "I want to enable NetBIOS over
<PRE>   IPX/SPX."
</PRE></OL>3. On the Advanced tab, enter Frame Type = AUTO, Network Address = 0.
4. Reboot the client and install the Winsock Proxy client.
5. Test for connectivity by running Chkwsp32 /F from the Mspclnt folder on
<PRE>   the client computer. If the connection succeeds, you will see the
   message:

      Client Control Protocol matches the server control protocol.

   Test further by using FTP or Telnet to connect to a site on the
   Internet.

</PRE><h3>Troubleshooting IPX Proxy Clients</h3>
 
<P>
If you follow the preceding steps, your IPX clients may still experience
connectivity problems. See the following troubleshooting guide for more
information:
<P>
When you use the command Chkwsp32 /F, you receive one of the following
error messages:
<P>
<PRE>   Server Is Down!

   -or-

   Unable to refresh configuration files

</PRE>If the TCP/IP protocol is installed on the client computer but TCP/IP is
not enabled on the proxy server's internal network card, this error will
occur. Some clients on the network may require TCP/IP to be installed for
certain applications or some clients may have Remote Access Services
installed for modem connections with TCP/IP bound to the RAS adapter.
<P>
There are two workarounds for this type of problem:
<P>
Method 1: Remove TCP/IP from the clients.
<P>
Method 2: Force the clients to use only IPX.
<P>
<PRE>   You can force the clients to use only IPX for all Winsock Proxy
   connections. To do this, edit the Mspclnt.ini file on the Proxy server.
   Simply remove the [Servers Ip Addresses] section. The Proxy clients will
   refresh their configuration automatically every six hours, so it is not
   necessary to refresh all of the clients manually.

</PRE>If the Mspclnt share on the proxy server is not accessible, these errors
may also occur. Make sure the client has access to the Mspclnt share on the
proxy server.
<P>
Verify that the client has permissions to this share on the server. If the
client is not a member of the same domain or does not belong to any trusted
domain, do one of the following:
<P>
<PRE>   Move the client configuration files to a share on a server that the
   clients have access to.

   -or-

   Enable the guest account on the Proxy server so that any client will
   have access to the share.

</PRE>NOTE: Click to clear the Enable Access Control check box in the Winsock
Proxy service properties if the clients are not part of the domain that the
proxy server belongs to.
<P>
To move the configuration files, create a share on a server the client has
access to. The server can be a NetWare Server or Windows NT Server. Edit
the Mspclnt.ini file on the proxy server and change the [Master Config]
path to reflect the new location. Copy the Msplat.txt and Mspclnt.ini files
to the new share. Any new clients installed will contain the new location
settings. Click to clear the Enable Access Control check box in the Winsock
Proxy service properties if the clients are not part of the domain that the
proxy server belongs to.
<P>
You receive the error message:
<P>
<PRE>   Failed to determine protocol family for Control Channel

</PRE>This error message can occur if the Mspclnt.ini file is missing the
[Servers IPX Addresses] section, or the name of the section is mistyped
(for example, singular instead of plural). Confirm that the section is
present and typed correctly. If it is incorrect, the Mspclnt.ini file on
the server must also be corrected, because the clients periodically update
themselves from the server.
<P>
You find that images or pages are broken or incomplete on the Winsock Proxy
client.
<P>
Try setting the Maximum Connections and Maximum Sockets for the Windows 95
IPX client above the default values. For additional information on this
topic, please see the following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q142489.htm">Q142489</A></B>
   TITLE     : Problems After Modifying Maximum Connections or Sockets
               Value
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbenv<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
