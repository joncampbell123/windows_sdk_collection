

<HTML>
<HEAD>
<TITLE>INFO: Changes in ADO 1.5 That Affect Visual C++/J++ Programmers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177939">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1997/12/10">
<META NAME="Keywords" CONTENT="adovc adovj">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  With the release of ActiveX Data Objects (ADO) version 1.5, several minor changes have been made that may affect code when recompiled to use ADO 1.5 for Visual C++ or Visual J++. This article outlines the changes and the steps you need to take to c...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA56,QA55,QAEF,QBFY,QAHE,QAH4,QAL3,QAAP,QA9Q,QAHT,QAB4,QAA1,QBVV,QAE2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Changes in ADO 1.5 That Affect Visual C++/J++ Programmers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177939</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), version 1.5
<LI>Microsoft Visual C++, 32-bit Editions, versions 4.2b, 5.0
<LI>Microsoft Visual J++, versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With the release of ActiveX Data Objects (ADO) version 1.5, several minor
changes have been made that may affect code when recompiled to use ADO 1.5
for Visual C++ or Visual J++. This article outlines the changes and the
steps you need to take to compensate for the changes. Not all of the
changes affect both Visual C++ and Visual J++; this article indicates which
issues are language specific.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Adoid.lib No Longer Exists (Visual C++ - Only)</h3>
 
<P>
With the release of the OLE DB 1.5 Software Development Kit (SDK),
Microsoft no longer provides the Adoid.lib file. Instead, to link to ADO
1.5, use the code snippet below. This code snippet assumes you are not
using #import or Microsoft Foundation Classes (MFC) OLE to link to ADO. If
you are using #import or MFC-OLE the #include to &lt;initguid.h&gt; is not
necessary.
<P>
<PRE>   #include &lt;initguid.h&gt;    // Newly Required for ADO 1.5.
   #include &lt;adoid.h&gt;
   #include &lt;adoint.h&gt;

</PRE>You must also remove linking to Adoid.lib in your Project's Settings dialog
box or you will continue to link to ADO 1.0. If you get the following error
after you remove Adoid.lib, you must define INITGUID (via #define INITGUID)
on the first line of your .cpp file:
<P>
<PRE>   LNK2001: unresolved external symbol _CLSID_CADORecordset

</PRE>NOTE: You must install the OLE DB 1.5 Software Development Kit (SDK) to
obtain the latest versions of Adoid.h and Adoint.h.
<P>
The OLE DB SDK version 1.5 released in January 1998 and is available at
<B><A href="http://www.microsoft.com/data/oledb">http://www.microsoft.com/data/oledb</A></B>
<P>
You may also receive the following error if you build a project linking to
the 1.0 Adoid.lib and including the 1.5 Headers:
<P>
<PRE>   LNK2005: "xxx" already defined in "yyy" errors


</PRE><P><LI>Go to Projects/Settings, select the Link tab, and remove the reference
   to Adoid.lib.

<P><LI>Create a new file in the project called Oleguids.cpp and add these
   lines:
<P>
<P><PRE>      #include &lt;initguid.h&gt;
      #include &lt;adoid.h&gt;
      #include &lt;adoint.h&gt;
</PRE>
<P><LI>Compile and  Link.
<P>
</OL>The OLE DB 1.5 SDK does not remove Adoid.lib from the oledbsdk\lib
directory.  You may want to physically delete it after installing the 1.5
SDK to ensure that no conflicts occur in the future.
<P>
<P><h3>Extra Argument in Connection.Open() Method (Visual C++ and Visual J++)</h3>
 
<P>
A new, reserved Options parameter was added to the Connection.Open()
method. You must use a value of -1 for this argument as shown in the code
snippets below. Unlike other arguments for ActiveX Data Objects (ADO), the
new Options argument does not have an enumerated type within the typelib to
indicate valid values.
<P>
<PRE>   // VC using #import
   Conn1-&gt;Open( bstrEmpty, bstrEmpty, bstrEmpty, -1 );

   // VC using MFC OLE
   Conn1.Open( strEmpty, strEmpty, strEmpty, -1 );

   // VC Using OLE SDK
   if( SUCCEEDED( hr ) )
   hr = Conn1-&gt;Open( bstrEmpty, bstrEmpty, bstrEmpty, -1 );

   // Java Code
   conn1.Open("", "", "", -1);

</PRE></OL>If you use the incorrect value for this argument, the following error
occurs:
<P>
<PRE>   800A0BB9  or (adErrInvalidArgument = 3001)

</PRE>The application is using arguments that are of the wrong type, are out of
acceptable range, or are in conflict with one another.
<P>
<P><h3>Extra Argument in Recordset.Requery() Method (Visual C++ and Visual J++)</h3>
 
<P>
As with the Connection.Open() method, the Recordset.Requery method now also
has a reserved parameter, whose value must be set to -1. Failure to do so
generates the same error listed above (0x800A0BB9).
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../adobj/q174565.htm">Q174565</A></B>
   TITLE     : FILE: Adovc.exe Demonstrates How to Use ADO with Visual C++

   ARTICLE-ID: <B><A href="../visualc/q130869.htm">Q130869</A></B>
   TITLE     : HOWTO: Avoid Error LNK2001 Unresolved External Using
               DEFINE_GUID

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Parameter Arguments Differences<BR>
Keywords          : adovc adovj<BR>
Technology        : kbInetDev<BR>
Version           : WINDOWS:1.0,1.1,1.5; WINNT:4.2b,5.0<BR>
Platform          : WINDOWS winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
