

<HTML>
<HEAD>
<TITLE>HOWTO: Lifetime of a COM Component Under IIS, ASP, and RDS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166279">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1997/04/02">
<META NAME="Keywords" CONTENT="iisMisc">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  When you create your own ActiveX Server components running under Internet Information Server (Inetinfo.exe) for Active Server Pages (ASP) or Remote Data Service (RDS), you may get the following error message when you try to recompile or overwrite y...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QACK,QANE,QBVX,QDNQ,QAIJ,QBWP,QAYY,QAHV,QAJQ,QAQW,QBWS,QBSO,QDNN,QAJG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Lifetime of a COM Component Under IIS, ASP, and RDS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166279</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Information Server version 3.0
<LI>Microsoft Active Server Pages version 1.0b
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you create your own ActiveX Server components running under Internet
Information Server (Inetinfo.exe) for Active Server Pages (ASP) or Remote
Data Service (RDS), you may get the following error message when you try to
recompile or overwrite your DLL:
<P>
<PRE>   Permission Denied

</PRE>What you are encountering is a caching feature of Internet Information
Server (IIS) that improves performance by keeping the DLL in memory for
subsequent calls. IIS loads the DLLs, such as your ActiveX DLL, and holds
onto them--even long after you have navigated to another page. Though your
ActiveX DLL instance is released after the method returns, the DLL with the
class factory for the object is still loaded in memory, making it
impossible to overwrite or recompile.
<P>
With version 1.5, the RDS has been renamed and merged with ActiveX Data
Objects (ADO) to provide data remoting within the same programming model
as ADO. Formerly, the Remote Data Service was known as the Advanced Data
Conenctor (ADC). To clarify the relationship of ADC to ADO, ADC
is now known as the Remote Data Service (RDS), a feature of ADO.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The best way to flush this DLL cache is by stopping your WWW service
by going into the Internet Service Manager, right-click
the WWW service, and select Stop. This can also be done by typing
the following command at the Windows NT Command Prompt:
<P>
<PRE>   Net Stop W3SVC

</PRE>Then you can recompile or overwrite your DLL and restart your service by
right-clicking on the WWW service, and selecting Start, or by typing
the following command at the NT Command Prompt:
<P>
<PRE>   Net Start W3SVC

</PRE>To completely unload Inetinfo.exe you need to stop MSFTPSVC and GOPHERSVC,
but you do not have to do this if you just want to unload your ActiveX DLL
component.
<P>
If you want to make restarting the WWW service considerably faster on a
development IIS server, create the following value in the registry, of type
REG_DWORD, and set it to zero:
<P>
<PRE>   HKEY_LOCAL_MACHINE
    \SYSTEM
     \CurrentControlSet
      \Services
       \W3SVC
        \Parameters
         \EnableSvcLoc

</PRE>Do the same for MSFTPSVC and GOPHERSVC if you are running them.
<P>
NOTE: On a production server the service locater should be enabled by
setting the value to one.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Web site for RDS: <B><A href="http://www.microsoft.com/rds">http://www.microsoft.com/rds</A></B>
<P>
Web site for IIS: <B><A href="http://www.microsoft.com/iis">http://www.microsoft.com/iis</A></B>
<P>
RDS newsgroup: microsoft.public.rds
<P>
IIS newsgroup: microsoft.public.inetserver.iis
<P>
ASP newsgroup: microsoft.public.inetserver.iis.activeserverpages
<P>
ASP Roadmap: <B>http://LocalServer/iasdocs/aspdocs/roadmap.asp</B>
<P>
(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Jon
Fowler, Microsoft Corporation
 
<PRE>Keywords          : iisMisc
Version           : 1.0b 1.5 3.0
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
