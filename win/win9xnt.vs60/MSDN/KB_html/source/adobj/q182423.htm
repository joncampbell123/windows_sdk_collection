

<HTML>
<HEAD>
<TITLE>BUG: "Not Enough Storage is Available..." Error with ADO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182423">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1998/03/12">
<META NAME="Keywords" CONTENT="adoall ado15bug">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  When using the AppendChunk method of the ADO.Recordset object, the following error occurs:     Not enough storage is available to complete this operation.  The error number returned is -2147024882 (0x8007000E).  RESOLUTION  To work around this prob...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAB4,QAPN,QABM,QAKP,QA59,QANF,QAGI,QBVV,QA6Z,QAW6,QALZ,QADX,QDKW,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: "Not Enough Storage is Available..." Error with ADO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182423</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), version 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the AppendChunk method of the ADO.Recordset object, the
following error occurs:
<P>
<PRE>   Not enough storage is available to complete this operation.

</PRE>The error number returned is -2147024882 (0x8007000E).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem use one of the following two methods:

<UL><LI>Open an ADO.Connection object and set the CursorLocation property to
   adUseClient and use this connection with the ADO.Recordset.
<P>
   -or-

<LI>Use only one AppendChunk call and append all of the data with only one
   call to AppendChunk. Note that this restricts you to a maximum chunk
   size of 511818 bytes.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following sample code demonstrates the error when using Microsoft SQL
Server as the database. If you uncomment the line indicated, the error no
longer occurs.
<P>
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   Sub ADOBlobFail()
     Dim conn As New ADODB.Connection
     Dim rs As New ADODB.recordset
     Dim bytBlock(256) As Byte
     Dim i As Long

     conn.Open "LocalServer", "sa", ""
     ' Uncomment the next line to avoid the error.
     ' conn.CursorLocation = adUseClient
     On Error Resume Next
     conn.Execute "drop table IMAGE1234"
     On Error GoTo 0
     conn.Execute "create table IMAGE1234 " &amp; _
                  "( ID int primary key, DATA IMAGE )"
     rs.ActiveConnection = conn
     rs.Open "select * from IMAGE1234", , adOpenDynamic, _
             adLockOptimistic, adCmdText

     rs.AddNew
     rs.Fields(0).Value = 1
     For i = 1 To 1000
        rs.Fields(1).AppendChunk bytBlock
     Next i
     rs.Update

   End Sub

</PRE> 
<PRE>Keywords          : adoall ado15bug
Version           : WINDOWS:1.5
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
