

<HTML>
<HEAD>
<TITLE>PRB: Oracle Numeric Fields Must be Converted for Logical Tests </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178043">
<META NAME="KBModify" CONTENT="1997/12/17">
<META NAME="KBCreate" CONTENT="1997/12/12">
<META NAME="Keywords" CONTENT="kb3rdparty VIADO VIODBC">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  When you use an Oracle numeric field a  Type Mismatch  error occurs.  The error occurs in the following two scenarios:   - When you conduct a logical test comparing an Oracle numeric field with    an integer value. The following is an example:     ...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA94,QA4Q,QAP2,QA7O,QA7N,QAUD,QAYY,QAVX,QAVW,QAKD,QBC9,QBC8,QAPF,QANO,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Oracle Numeric Fields Must be Converted for Logical Tests</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), versions 1.0, 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use an Oracle numeric field a "Type Mismatch" error occurs.
<P>
The error occurs in the following two scenarios:

<UL><LI>When you conduct a logical test comparing an Oracle numeric field with
   an integer value. The following is an example:
<P>
<P><PRE>      If Oracle_Recordset("my_numeric_field")=1 then ...
</PRE><P>
 -or-

<LI>When you perform integer arithmetic with an Oracle numeric field.
   The following is an example:
<P>
<P><PRE>      x=Oracle_Recordset("my_numeric_field")+ 1
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
The following two conditions cause this behavior:

<UL><LI>Storing Integer data in an Oracle Numeric data type field.

<LI>Using the value of the Oracle Numeric field in computations with
   Integer data types.
<P>
</UL>Oracle does not have an Integer data type, only Numeric. The problem is
that numeric types are data with exact precision and scale and must be
converted to another data type comparable to integers. Floating point
numbers are approximate values and can be compared to integers without
exception. For numerics (or the older and equivalent decimal data type) if
this conversion does not take place a type mismatch error occurs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following conversion functions return values that are comparable to
integers:

<UL><LI>CInt()
<LI>CLng()
<LI>CDbl()
<LI>CSng()
<P>
</UL>For maximum efficiency and flexibility, the CLng() function is recommended.
<P>
In the scenarios listed in the SYMPTOMS section above, making the following
changes would correct the problem:

<OL><P><LI>If CLng(Oracle_Recordset("my_numeric_field"))=1 then ...

<P><LI>x=CLng(Oracle_Recordset("my_numeric_field"))+ 1
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Oracle uses a numeric data type. If an integer value is stored in a numeric
field, some ODBC drivers (for example, Intersolv version 3.01) returns a
data type of double-precision floating point (that is, VBScript VarType of
5); other drivers (for example, Microsoft ODBC for Oracle version
2.73.7269) more accurately returns numeric data type (that is, VBScript
VarType 14). In all cases, the ADO Type property returns type 131 (that is,
numeric).
<P>
 
<PRE>Keywords          : kb3rdparty VIADO VIODBC
Technology        : kbInetDev
Version           : WINDOWS:1.0,1.5
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
