

<HTML>
<HEAD>
<TITLE>PRB: MSFT Data Access Components 1.5 May Disable MTS 1.X </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174519">
<META NAME="KBModify" CONTENT="1997/11/19">
<META NAME="KBCreate" CONTENT="1997/09/30">
<META NAME="Keywords" CONTENT="adogenis">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  Preliminary and beta releases of ODBC 3.5 included a version of the connection pooling component (Mtxdm.dll) that disables Microsoft Transaction Server (MTS) 1.X. If you have this version of Mtxdm.dll, you may see one or all of the following sympto...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QA47,QBXS,QA4P,QA1S,QBVV,QAC1,QDNN,QAJG,QAA1,QA9E,QDN9,QAYY,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: MSFT Data Access Components 1.5 May Disable MTS 1.X</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174519</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO), version 1.5
<LI>Microsoft Transaction Server 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Preliminary and beta releases of ODBC 3.5 included a version of the
connection pooling component (Mtxdm.dll) that disables Microsoft
Transaction Server (MTS) 1.X. If you have this version of Mtxdm.dll, you
may see one or all of the following symptoms:

<UL><LI>When starting the MTS Explorer, the startup graphic appears, and
   then nothing happens for two to three minutes. If the Explorer
   window appears (and it may not), you will not be able to access any of
   the MTS functions.

<LI>After attempting to use MTS, within the Windows NT Event Viewer, you
   will find the following Transaction Server Application log:
<P>
<P><PRE>      The run-time environment has detected the absence of a critical
      resource and has caused the process that hosted it to fail fast
</PRE>
<LI>You will also be unable to create MTS objects.
<P>
</UL>ODBC 3.5 now ships as a part of the Microsoft Data Access Components (MDAC)
version 1.5. MDAC 1.5 includes ODBC 3.5, OLE-DB 1.5, ActiveX Data Objects
(ADO) 1.5, and Remote Data Service (RDS) 1.5. If any MDAC 1.5 component is
installed on a machine, it will require the presence of ODBC 3.5, and
therefore, install the version of Mtxdm.dll that will disable MTS 1.X.
<P>
<P><h2>CAUSE</h2>
 
<P>
The calling convention used internally within Mtxdm.dll was changed for MTS
2.0 beta 2 / beta 3 and is incompatible with previous versions of MTS. When
distributed with MTS 2.0 beta 2 /beta 3, no problem occurs. But when
Mtxdm.dll is distributed to systems with MTS 1.X without upgrading to MTS
2.0, it will disable MTS 1.X.
<P>
Mtxdm.dll provides support for connection pooling and is an integral
component of both Microsoft Transaction Server as well as ODBC. Any MTS 1.X
system where ODBC 3.5 (or related MDAC components) has been installed
without MTS 2.0 will encounter the symptoms described above.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The solution is to use version 1997.06.394.0 of Mtxdm.dll. This DLL is
available either with the MDAC 1.5a components (available 10/6/97 from
Microsoft's Web site), or to contact Product Support to obtain a copy.
<P>
MTS 1.X shipped with version 1997.03.14.222 of Mtxdm.dll; however, you will
need the newer version to work correctly with MDAC 1.5/1.5a components.
<P>
Installing MDAC 1.5a, though, will not be sufficient to repair a disabled
MTS 1.X system.  Please contact Microsoft Technical Support for
instructions.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The remaining text describes what versions of Mtxdm.dll, beta and release,
contribute or resolve the symptoms described above.
<P>
<P><h3>The Version of Mtxdm.dll That Disables MTS 1.X</h3>
 
<P>
Several versions of Mtxdm.dll have shipped that can disable MTX 1.X.
Versions 1997.06.395.0 through 1997.09.484.0 will create this problem.
Mtxdm.dll in this version range has been released with the following
products.

<UL><LI>Internet Explorer 4.0 Client SDK
<LI>Internet Information Server 4.0 Beta 2 (including MTS 2.0 Beta 2)
<LI>Internet Information Server 4.0 Beta 3 (including MTS 2.0 Beta 3)
<LI>Microsoft Data Access Components Version 1.5.
<P>
</UL><h3>The version of Mtxdm.dll That Will Not Disable MTS 1.X</h3>
 
<P>
Version 1997.06.394.0 of Mtxdm.dll uses the same calling convention as MTS
1.X, and ships with the following product:

<UL><LI>Microsoft Data Access Components Version 1.5a (available 10/6/97)
<P>
</UL>Using version 1997.06.394.0 will allow both ODBC 3.5 and MTS 1.X to coexist
on the same machine. However, because the version of Mtxdm.dll that ships
with MDAC 1.5a is less than the version number for any customer using the
MTS 2.0 beta, it will not replace the version required by MTS 2.0 beta.
This should not be an issue, assuming that if you have MTS 2.0 on a given
machine, you are not using MTS 1.X on that same machine.
<P>
Distributing MDAC 1.5a components to machines with MTS 1.X should not
disable MTS 1.X.
<P>
Installing MDAC 1.5a will not be sufficient to repair a disabled MTS 1.X
installation.  Please contact Microsoft Technical Support for instructions.
<P>
<P><h3>The Final Version of Mtxdm.dll That Ships with MTS 2.0</h3>
 
<P>
With the release version of MTS 2.0, there will be a new version of
Mtxdm.dll, which uses the original calling convention required by MTS 1.X,
and which has a higher file version than anything that has yet shipped.
This version of Mtxdm.dll will be shipping with the following products:

<UL><LI>Internet Information Server 4.0   (available Q4 1997)
<LI>Microsoft Transaction Server 2.0  (available Q4 1997)
<P>
<P>
</UL><h2>REFERENCES</h2>
 
<P>
MDAC 1.5(a) will be available from:
<P>
<PRE>   <B><A href="http://www.microsoft.com/data/">http://www.microsoft.com/data/</A></B>

</PRE> 
<PRE>Keywords          : adogenis
Version           : WINDOWS:1.5; WINNT:1.0
Platform          : WINDOWS winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
