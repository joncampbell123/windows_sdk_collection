

<HTML>
<HEAD>
<TITLE>INFO: Using ActiveX Data Objects (ADO) via Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168335">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/05/09">
<META NAME="Keywords" CONTENT="adoall adoengall adoengdb">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  This article discusses what is necessary to take advantage of ActiveX Data Objects (ADO) with Visual Basic.  MORE INFORMATION  What is ADO?  ActiveX Data Objects is a programming model, which means that it is not dependent upon any given back-end e...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QAW6,QAAP,QAB4,QAYY,QAA1,QDI2,QA9E,QAHV,QAJQ,QBWB,QAY2,QAPF,QAKJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Using ActiveX Data Objects (ADO) via Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168335</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO) used with:
   - Microsoft Visual Basic Learning, Professional, and Enterprise
<P><PRE>     Editions for Windows, version 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses what is necessary to take advantage of ActiveX Data
Objects (ADO) with Visual Basic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>What is ADO?</h3>
 
<P>
ActiveX Data Objects is a programming model, which means that it is not
dependent upon any given back-end engine. Currently, however, the only
engine supporting the ADO model is OLE-DB. OLE-DB is currently dependent on
ODBC Version 3.0 Administrator and ODBC Drivers. This is accomplished
through the OLE-DB Provider for ODBC, often referred to as Kagera. At
present Kagera is the only released provider for OLE-DB, but like ODBC
Drivers, other OLE-DB providers can be used seamlessly from ADO.
<P>
The ADO object model consists of six objects:

<UL><LI>Connection: Represents an open connection, in this case to an OLE-DB
   datasource that can be an ODBC data source via Kagera.

<LI>Error: Contains details about data access errors, refreshed for each
   time an error occurs in a single operation involving ADO.

<LI>Command: Defines a specific command you wish to execute against data.

<LI>Parameters: Optional collection off the command object for any
   parameters you wish to provide to the command.

<LI>Recordset: Represents a set of records from a table, command object, or
   SQL Syntax. Can be created without any underlying Connection object.

<LI>Field: Represents a single column of data in a recordset.

<LI>Property: A collection of values raised by the provider for ADO.
<P>
</UL>ADO/R is a subset of this ADO object model used with the Advanced Data
Connector that provides only the Recordset and Field objects.
<P>
<P><h3>Installing ADO on your Machine</h3>
 
<P>
To properly install ADO on your machine, you will need to install the OLE-
DB SDK version 1.1+, Internet Information Server 3.0+, or Visual InterDev
1.0+. This will install both ADO and necessary underlying ADO components.
OLE-DB also requires ODBC version 3.0 Components, which are normally
installed from Visual C++.
<P>
The OLE-DB SDK is available free for download off the Web from
<B><A href="http://www.microsoft.com/data/oledb/">http://www.microsoft.com/data/oledb/.</A></B>
<P>
After ADO is installed on your machine, simply create a new project inside
Visual Basic, go to the PROJECTS^REFERENCES menu and select the following:
<P>
<PRE>   Microsoft OLE-DB ActiveX Data Objects (1.0) Library


</PRE><h3>Error Handling</h3>
 
<P>
The documentation for the ADO Error object indicates that the Errors
Collection will be populated if any error occurs within ADO or its
underlying provider. This is somewhat incorrect. Depending on the source of
the error, ADO's errors collection may not be populated. You need to check
both the VB Error object as well as the ADO Errors collection.
<P>
For more information see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../adobj/q167957.htm">Q167957</A></B>
   TITLE     : INFO: Extracting Error Information from ADO in VB

</PRE><h3>ADO vs. DAO</h3>
 
<P>
If you include references to both ADO and DAO in the same project, you will
have some difficulty.  Both use the same object named Recordset, so the
following code is ambiguous:
<P>
<PRE>   Dim r as recordset

</PRE>To specify which object model you want to use, include a qualifier in
front:
<P>
<PRE>   Dim s As ADODB.Recordset
   Dim t As DAO.Recordset

</PRE><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../adobj/q168342.htm">Q168342</A></B>
   TITLE:      INFO: Choosing the Right VB5 Data Access Interface
               (ADO/DAO/RDO)

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Don Willits, Microsoft Corporation
 
<PRE>Keywords          : adoall adoengall adoengdb
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
