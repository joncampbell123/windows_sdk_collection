

<HTML>
<HEAD>
<TITLE>FILE: Adoreg.exe License Key Registration DLL and ADO Use Tips </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172394">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1997/08/05">
<META NAME="Keywords" CONTENT="adoall adoengdb adoiis adovb adovc adovi adovj">
<META NAME="KBArea" CONTENT="Support; KB; adobj">
<META NAME="Description" CONTENT="  This article attempts to provide a definitive solution to the ADO 1.0 Redistribution/License Key issue. It references a file you can download that contains a DLL that adds the ADO License Key. This License Key may, or may not, be necessary, dependi...">
<META NAME="Product" CONTENT="adobj">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXO,QAH6,QAA1,QBS0,QAW6,QAPN,QDNQ,QAH7,QAD7,QA6A,QARL,QDI2,QBVV,QBAB,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Adoreg.exe License Key Registration DLL and ADO Use Tips</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172394</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>ActiveX Data Objects (ADO)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article attempts to provide a definitive solution to the ADO 1.0
Redistribution/License Key issue. It references a file you can download
that contains a DLL that adds the ADO License Key. This License Key may, or
may not, be necessary, depending on the language you use to manipulate ADO
objects.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/adoreg.exe">Adoreg.exe</A> <I>(size: 32891 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h3>What is Adoreg.dll?</h3>
 
<P>
Adoreg.dll simply adds the ADO registry key when registered by regsvr32 or
when the DLL's DllRegisterServer() function is called.
<P>
This DLL will not be sufficient to allow VB developers to redistribute ADO-
based applications; however, an expanded version designed to work with the
VB Setup Wizard (AdoRegEx.DLL) is available separately and described in a
separate KB (described further below).
<P>
Where and When is the ADO License Key Needed?
 
<P>
The license key is needed in the registry on any development machine (as
well as OLE-DB and ADO). The best way to get this is installing the OLE-DB
SDK, Active Server Pages 1.0 or Visual InterDev 1.0.
<P>
When considering if you need to install the license key on your client
machine, keep the following points in mind:

<UL><LI>The License Key is needed in the registry at compile time if your
   application performs early binding to ADODB 1.0 objects:
<P>
<PRE>      dim rs as new ADODB.Recordset                 // VBA
      -or-
      set rs = new ADODB.Recordset                  // VBA

</PRE><LI>The License Key is needed in the registry at run time if your
   application performs late binding to ADODB 1.0 objects:
<P>
<PRE>      set rs = CreateObject( "ADODB.Recordset" )   // VBA, VBScript
      -or-
      CoCreateInstance(...);                       // C/C++ w/Win32
      -or-
      _ConnectionPtr   Conn1 = NULL;               // C++ w/#import
      hr = Conn1.CreateInstance( __uuidof( Connection ) );

</PRE><LI>The License Key needs to be provided via IClassFactory2 for the first
   ADODB object created if the license key does not exist in the registry.
   For additional information, please see the following article in the
   Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A href="../adobj/q169496.htm">Q169496</A></B>
<PRE>   TITLE     : INFO: Using ActiveX Data Objects (ADO) via #import in VC++

</PRE></UL><h3>When is Early or Late Binding Used?</h3>
 
<P>
The following discussion lists various development products, and how to
handle license keys, early and late binding. All of these discussions
assume both ADO and OLE-DB DLLs are installed correctly on your machine.
<P>
Visual Basic:
<P>
You will not need a License key on the client machine if you use early
binding to create your ADO objects. This, and techniques for redistributing
ADO successfully with the Visual Basic Setup Wizard are documented in the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q172406.htm">Q172406</A></B>
   TITLE     : FILE: Redistributing ADO 1.0 with Visual Basic 5.0

</PRE>Visual C++:
<P>
You will need to either pass the ADO License Key to the first object you
create, or you will need to add the ADO License Key to each client machine.
Adoreg.dll will let you do the latter, and the following KB discusses how
to build ADO objects and pass the license key.
<P>
<PRE>   ARTICLE-ID: <B><A href="../adobj/q169496.htm">Q169496</A></B>
   TITLE     : HOWTO: Passing a License Key to Classes Generated by
               #import

</PRE>While this article is specific to #import, the technique provided can be
used when invoking ADO using the OLE SDK or with MFC OLE without #import.
<P>
Visual J++:
<P>
Visual J++ 1.X encapsulates typelibs with a set of classes, providing early
binding at compile time. Therefore you shouldn't need a license key on your
client machines.
<P>
Active Server Pages 1.0 and VBScript:
<P>
As Active Server Pages (ASP) are interpreted, not compiled, you will need
to have the license key on any server where the ASP page resides. This is
typically done when you install ASP automatically. However, if you
distribute your VBScript based application independent of ASP, you will
need to have the license key available on any client machine.
<P>
<P><h3>How Do I Install ADO and OLE-DB DLLs on the Client Machine?</h3>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../adobj/q168122.htm">Q168122</A></B>
   TITLE     : HOWTO: Redistributing ADO 1.0 or ADO/R 1.0 with OLE/DB 1.1

</PRE><h3>Will We Have a License Key in the Future?</h3>
 
<P>
No.  While ADO 1.0 is freely redistributable (even with the license key),
future releases of ADO will be freely redistributable without a license
key.
<P>
 
<PRE>Keywords          : adoall adoengdb adoiis adovb adovc adovi adovj
Version           : WINDOWS:
Platform          : WINDOWS
Issue type        : kbfile</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
