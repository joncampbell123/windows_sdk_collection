

<HTML>
<HEAD>
<TITLE>SNA Server Access Violation in Function S1practs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178254">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1997/12/18">
<META NAME="Keywords" CONTENT="kbbug3.00 kbbug3.00.sp1 prodsna snaserverservice kbbug3.00.sp2">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  SNA Server (Snaservr.exe) may fail unexpectedly with an access violation, causing the following symptoms:  - The following event will be logged into the Windows NT application event    log:     Event ID: 624    Source:   SNA Server    Description: ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAR4,QAI5,QAO4,QAM1,QA1S,QBW7,QA7R,QAY5,QAKP,QAI4,QBWP,QBWG,QA4H,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server Access Violation in Function S1practs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178254</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 3.0, 3.0 SP1, and 3.0 SP2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SNA Server (Snaservr.exe) may fail unexpectedly with an access violation,
causing the following symptoms:
<P>
- The following event will be logged into the Windows NT application event
<PRE>   log:

   Event ID: 624
   Source:   SNA Server
   Description: Creating dump file &lt;snaroot&gt;\traces\snadump.log for
   snaservr.exe.

</PRE>- The following log entry will be created in the &lt;ntroot&gt;\drwtsn32.log
<PRE>   file:

   Application exception occurred:
           App: exe\snaservr.dbg (&lt;process id&gt;)
           Exception number: c0000005 (access violation)

   [...]

   State Dump for Thread Id 0x110

   eax=00000000 ebx=00000000 ecx=00000014 edx=011cff27 esi=0025c4f0
   edi=015641dc
   eip=0101b62a esp=011cff08 ebp=011840c0 iopl=0
   nv up ei pl zr na po nc
   cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000 efl=00000246

   function: s1practs
        0101b60d 6a11             push    0x11
        0101b60f 51               push    ecx
        0101b610 e88b60feff       call    sapugetc (010016a0)
        0101b615 84c0             test    al,al
        0101b617 7543             jnz     s1practs+0x30c (0101b65c)
        0101b619 0fbf5608         movsx   edx,word ptr [esi+0x8]
                    ds:0116aef7=0000
        0101b61d 53               push    ebx
        0101b61e 8b0495a0190f01
                    ds:011cff27=00000101
                      mov     eax,[s1scb+0x4e20 (010f19a0)+edx*4]
        0101b625 8d54241b         lea     edx,[esp+0x1b]
                    ss:020de90f=????????
        0101b629 52               push    edx
   FAULT -&gt;0101b62a 8b4838           mov     ecx,[eax+0x38]
                    ds:00f0ea06=????????

   *----&gt; Stack Back Trace &lt;----*

   FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
   011840c0 001e0011 000e0000 00000000 001f0011 b1f80008 snaservr!s1practs

</PRE><h2>CAUSE</h2>
 
<P>
This problem can occur if an SNA Server connection is configured to
"Support Dynamic Remote APPC LU Definition". The SNA Server service assumes
that the TP (transaction program) did not end following a session
activation failure. However, if the TP does end, the SNA Server fails with
an access violation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Obtain the following fix or wait for the next SNA Server 3.0 service pack.
<P>
This fix should have the following timestamp:
<P>
<PRE>   11/21/97  10:58a       437,440  &lt;snaroot&gt;\system\snaservr.exe
   11/21/97  10:58a       412,692  &lt;ntroot&gt;\symbols\exe\snaservr.dbg
   11/21/97  10:58a       825,072  &lt;snaroot&gt;\system\trcservr.exe
   11/21/97  10:58a       751,608  &lt;ntroot&gt;\symbols\exe\trcservr.exe

</PRE>NOTE: SNA Server 3.0 Service Pack 2 should be applied prior to applying
this fix.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 3.0,
version 3.0 Service Pack 1, and version 3.0 Service Pack 2.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
 
<PRE>Keywords          : kbbug3.00 kbbug3.00.sp1 prodsna snaserverservice kbbug3.00.sp2
Version           : WINDOWS:3.0,3.0SP1,3.0SP2
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
