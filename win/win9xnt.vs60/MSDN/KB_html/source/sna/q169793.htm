

<HTML>
<HEAD>
<TITLE>RUI Libraries Don't Return All Negative Responses to RUI App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169793">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/06/09">
<META NAME="Keywords" CONTENT="kbbug2.00 kbbug2.10 kbbug2.11 kbbug3.00 snalua kbfix3.00.sp2 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  An RUI application that is written to capture all negative responses is only notified by the RUI libraries of the first -RSP generated at the host by a series of bad messages. SNA Server traces indicate that host negative responses for each  bad  m...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QAIJ,QAD7,QAR5,QDO3,QBWP,QBWD,QBW4,QAHE,QABA,QAYY,QDIV,QAN1,QAH7,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>RUI Libraries Don't Return All Negative Responses to RUI App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169793</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.11, 2.11 SP1, 2.11 SP2,
   3.0, 3.0 SP1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An RUI application that is written to capture all negative responses is
only notified by the RUI libraries of the first -RSP generated at the host
by a series of bad messages. SNA Server traces indicate that host negative
responses for each "bad" message sent by the RUI application are received
by SNA Server, but only the first negative response is passed to the RUI
application.
<P>
<P><h2>CAUSE</h2>
 
<P>
To improve efficiency, SNA Server treats sequences of RQE chains received
from an RUI application as if they were a single RQE chain. This causes SNA
Server to pass only the first host negative response to the first RU as if
it was a response to all "bad" RU's.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Snaservr.exe has been changed to allow the behavior of the SNA Server to be
altered so that all -RSP messages that have the RQE bit set are passed to
the RUI libraries if the following registry parameter is added:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\
      SnaServr\Parameters\

   DONTCOALESCE :  REG_SZ   [value is not important]

</PRE>WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
Use the following steps to edit the registry:

<OL><P><LI>Run Registry Editor (Regedt32.exe).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Services\SnaServr\Parameters
</PRE>
<P><LI>On the Edit menu, click Add Value.

<P><LI>Add the following values:
<P>
<P><PRE>      Value Name: DONTCOALESCE
      Data Type: REG_SZ
      String: YES
</PRE>
<P><LI>Click OK and then quit Registry Editor.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server for Windows NT
version 2.11, 2.11 SP1, 2.11 SP2, 3.0, and 3.0 SP1.
<P>
If you are using SNA Server version 2.11, 2.11 SP1, or 2.11 SP2, contact
Microsoft Technical Support to request that a 2.11 hotfix be generated for
this issue.
<P>
This problem was corrected in the latest SNA Server version 3.0 U.S. 
Service Pack. For information on obtaining this Service Pack, query on the 
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
The following is an excerpt from an SNA trace:
<P>
<PRE>   LINKMSG.AFT
   DLC   ------------------------------------------------------------------
   ---
   -----------
   DLC   03020101-&gt;01160001 DLC DATA
   DLC                      DAF:09 OAF:09 ODAI:off Normal
   DLC                      RQE FMD BC EC DR1
   DLC
   DLC   ---- Header  at address 012C45EC, 1 elements ----
   DLC   00000000 00032C00 09090001 01002701     &lt;......,.......'.&gt;
   DLC
   DLC   ---- Element at address 017BCB60, start 10, end 21 ----
   DLC   03900061 61616161 6161610A              &lt;...aaaaaaaa.    &gt;
   DLC   ------------------------------------------------------------------
   ---
   -----------
               data "bbbbbbbb" and "cccccccc" deleted for brevity
   DLC   ------------------------------------------------------------------
   ---
   -----------
   DLC   03020101-&gt;01160001 DLC DATA
   DLC                      DAF:09 OAF:09 ODAI:off Normal
   DLC                      RQE FMD BC EC DR1
   DLC
   DLC   ---- Header  at address 012C41DC, 1 elements ----
   DLC   00050000 60032C00 09090004 01002701     &lt;....`.,.......'.&gt;
   DLC
   DLC   ---- Element at address 017BB5B4, start 10, end 21 ----
   DLC   03900064 64646464 6464640A              &lt;...dddddddd.    &gt;
   DLC   ------------------------------------------------------------------
   ---
   -----------
   DLC   01160001-&gt;03020101 DLC DATA
   DLC                      DAF:09 OAF:09 ODAI:off Normal
   DLC                      -RSP FMD SD BC EC DR1
   DLC
   DLC   ---- Header  at address 012C41DC, 1 elements ----
   DLC   00050000 60032C00 09090001 01002701     &lt;....`.,.......'.&gt;
   DLC
   DLC   ---- Element at address 017BB5B4, start 10, end 16 ----
   DLC   87900010 010001                         &lt;g......         &gt;
   DLC   ------------------------------------------------------------------
   ---
   -----------
   DLC   03020101-&gt;01160001 DLCST RSRC
   DLC                      Credit:4
   DLC
   DLC   ---- Header  at address 012C45B8, 0 elements ----
   DLC   04050004 60032C00 09090003 01002701     &lt;....`.,.......'.&gt;
   DLC   ------------------------------------------------------------------
   ---
   -----------
            sense codes 10010002 and 10010003 deleted for brevity
   DLC   ------------------------------------------------------------------
   ---
   -----------
   DLC   01160001-&gt;03020101 DLC DATA
   DLC                      DAF:09 OAF:09 ODAI:off Normal
   DLC                      -RSP FMD SD BC EC DR1
   DLC
   DLC   ---- Header  at address 012C45B8, 1 elements ----
   DLC   04050004 60032C00 09090004 01007F00     &lt;....`.,........&gt;
   DLC
   DLC   ---- Element at address 017BB5B4, start 10, end 16 ----
   DLC   87900010 010004                         &lt;g......         &gt;
   DLC   ------------------------------------------------------------------
   ---
   -----------
   DLC   01160001-&gt;03020101 DLC DATA
   DLC                      DAF:09 OAF:09 ODAI:off Normal
   DLC                      RQE FMD BC EC DR1
   DLC
   DLC   ---- Header  at address 012C45B8, 1 elements ----
   DLC   04050004 60032C00 09090001 01007F00     &lt;....`.,........&gt;
   DLC
   DLC   ---- Element at address 017BB5B4, start 10, end 112 ----
   DLC   03900058 58585858 58585858 58585858     &lt;...XXXXXXXXXXXXX&gt;
   DLC   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   DLC   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   DLC   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   DLC   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   DLC   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   DLC   58585858 585858                         &lt;XXXXXXX         &gt;
   DLC   ------------------------------------------------------------------
   ---
   -----------

   CLIINT.AFT
   RUI   ------------------------------------------------------------------
   ---
   -----------
   RUI   RUI_READ response
   RUI   OK - OK
   RUI   ---- Verb Parameter Block at address 0193ED6C ----
   RUI   5200CC00 00000000 00000000 03800000     &lt;R...............&gt;
   RUI   00000000 00000000 00000000 00000000     &lt;................&gt;
   RUI   03000000 00010400 ACE69301 F0010000     &lt;.........Wl.0...&gt;
   RUI   2C000909 00018790 000F0241 00000000     &lt;,.....g....A....&gt;
   RUI   00000000                                &lt;....            &gt;
   RUI   ---- Data at address 0193E6AC ----
   RUI   10010001                                &lt;....            &gt;
   RUI   ------------------------------------------------------------------
   ---
   -----------
   RUI   RUI_READ request
   RUI   ---- Verb Parameter Block at address 0193ED6C ----
   RUI   5200CC00 00000000 00000000 03800000     &lt;R...............&gt;
   RUI   00000000 00000000 00000000 00000000     &lt;................&gt;
   RUI   03000000 00010000 ACE69301 F0010000     &lt;.........Wl.0...&gt;
   RUI   00000000 00000000 000F0000 00000000     &lt;................&gt;
   RUI   00000000                                &lt;....            &gt;
   RUI   ------------------------------------------------------------------
   ---
   -----------
   RUI   RUI_READ response
   RUI   OK - OK
   RUI   ---- Verb Parameter Block at address 0193ED6C ----
   RUI   5200CC00 00000000 00000000 03800000     &lt;R...............&gt;
   RUI   00000000 00000000 00000000 00000000     &lt;................&gt;
   RUI   03000000 00016400 ACE69301 F0010000     &lt;......d..Wl.0...&gt;
   RUI   2C000909 00010390 000F0141 00000000     &lt;,..........A....&gt;
   RUI   00000000                                &lt;....            &gt;
   RUI   ---- Data at address 0193E6AC ----
   RUI   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   RUI   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   RUI   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   RUI   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   RUI   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   RUI   58585858 58585858 58585858 58585858     &lt;XXXXXXXXXXXXXXXX&gt;
   RUI   58585858                                &lt;XXXX            &gt;
   RUI   ------------------------------------------------------------------
   ---
   -----------
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: rui rqe<BR>
Keywords          : kbbug2.00 kbbug2.10 kbbug2.11 kbbug3.00 snalua kbfix3.00.sp2 kbnetwork<BR>
Version           : 2.0,2.1,2.11,3.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
