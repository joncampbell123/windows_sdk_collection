

<HTML>
<HEAD>
<TITLE>Debugging SNA Server Application Exceptions on WinNT 3.5 &amp; 3.51 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139378">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1995/11/08">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork kbsetup snaprog">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  This article gives you the following information for debugging SNA Server application exceptions on your computer running Windows NT 3.5 and 3.51:   - Entries in SNA Dump File, Application Event Log, and DRWATSON.LOG  - DRWTSN32.EXE Specified as De...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDNL,QBWS,QAO4,QDO3,QAJH,QDL9,QBWQ,QBWO,QBWN,QBVV,QA9N,QASB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Debugging SNA Server Application Exceptions on WinNT 3.5 &amp; 3.51</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139378</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.10,  2.11, and 3.0
<LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article gives you the following information for debugging SNA Server
application exceptions on your computer running Windows NT 3.5 and 3.51:

<UL><LI>Entries in SNA Dump File, Application Event Log, and DRWATSON.LOG
<LI>DRWTSN32.EXE Specified as Default Debugger in Registry
<LI>DRWTSN32.EXE Can Fail
<LI>How to Configure SNA Server for Debugging
<LI>Information to Provide to SNA Server Support Team
<LI>SNA Server 2.11 README.WRI File Excerpt
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Entries in Dump File, Application Event Log, and DRWATSON.LOG</h3>
 
<P>
If an application exception or unexpected internal error occurs in an SNA
Server component, SNA Server automatically generates an application dump
file containing the memory contents of the failing process. Also, SNA
Server logs the following event in the Windows NT Application event log:
<P>
<PRE>   Event: 624
   Creating dump file &lt;filename&gt; for &lt;process&gt;

</PRE>If the dump file is due to an unexpected internal error in SNA Server, this
error is logged at the same time as Event 624. In such cases, the
DRWTSN32.LOG indicates a hardcoded breakpoint. For example:
<P>
<PRE>   Application exception occurred in module &lt;modulename&gt;
   Exception number: 80000003 (hardcoded breakpoint)

</PRE>The DRWTSN32.LOG is important to diagnose the cause of the failure.
<P>
<P><h3>DRWATSN32.EXE Specified as Default Debugger in Registry</h3>
 
<P>
On Windows NT 3.5 and 3.51, DRWTSN32.EXE is the default debugger that gets
invoked if an application exception occurs. This is set in the Windows NT
registry under the HKEY_LOCAL_MACHINE subtree under the following key:
<P>
<PRE>   \SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug\

</PRE>The following parameters appear in the right window of the Registry Editor:
<P>
<PRE>   Auto: REG_SZ: 1

   Debugger:REG_SZ: drwtsn32 -p %ld -e %ld -g

</PRE>NOTE: If Auto is set to 1 (one), the debugger runs immediately. If Auto
is set to 0 (zero), then you must choose Cancel at the Windows NT
application exception screen to invoke the debugger.
<P>
NOTE: "l" in "%ld" is the letter "l" and not the number one (1).
<P>
<P><h3>DRWATSN32.EXE Can Fail</h3>
 
<P>
When you run Windows NT 3.5, the following problems can cause DRWTSN32.EXE
to fail to generate a useful DRWTSN32.LOG file:

<UL><LI>The Windows NT 3.5 symbols have not already been copied to the
   &lt;ntroot&gt;\symbols tree.

<LI>You use SNA Server 2.1 or 2.11, and the failure has occurred in a
   component that was built using full compiler optimizations.
<P>
   NOTE: SNA Server 2.11 ships non-optimized versions of the SNA binaries
   to support reliable DRWTSN32.LOG generation on computers running Windows
   NT 3.5. However, a useful DRWTSN32.LOG may still be generated without
   applying these non-optimized binaries.
<P>
</UL><h3>How to Configure SNA Server for Debugging</h3>
 
<P>
When you run SNA Server 2.1 on Windows NT 3.5:

<UL><LI>Apply Windows NT symbols.
<P>
</UL>When you run SNA Server 2.11 on Windows NT 3.5:

<UL><LI>Apply Windows NT symbols.

<LI>Run SETUPDBG/MAKEDBG as documented in the 2.11 README.TXT file.
<P>
</UL>When you run SNA Server 2.1 or 2.11 on Windows NT 3.51:
<P>
<PRE>  - It is not necessary to run SETUPDBG/MAKEDBG, as documented in
    the 2.11 Readme.txt file and Readdbg.txt file. Also, when running
    on Windows NT 3.51, it is not necessary to copy Windows NT 3.51
    symbols, due to an enhancement in the Windows NT 3.51 version of
    Drwtsn32.exe.

</PRE>When you run SNA Server 3.0 on Windows NT 3.51:

<UL><LI>Verify that the symbols from the 3.0 CD were applied. Default
   installations should copy the symbols over to the &lt;winntroot&gt;\SYMBOLS
   tree.
<P>
</UL>When you run SNA Server 2.11 with Service Pack 1 (SP1) installed:

<UL><LI>The SNA Server 2.11 Service Pack 1 symbols are included in the
   self-extracting SP1 server update file (for each platform), though
   the symbols are not automatically installed when the Service
   Pack 1 update program is run. Matching symbols must be present
   in the server computer &lt;ntroot&gt;\SYMBOLS directory tree or the
   DRWTSN32.LOG entry does not show valid stack information.

<LI>To manually install the symbols, run XCOPY to copy the \SYMBOLS
   directory from the SNA Server 2.11 SP1 self-extracting file to the
   Windows NT root directory. For example:
<P>
<P><PRE>      xcopy &lt;sp1root&gt;\SYMBOLS\*.*  &lt;winntroot&gt;\SYMBOLS /s /e /v
</PRE><P>
</UL><h3>Information to Provide to SNA Server Support Team</h3>
 
<P>
If an application exception occurs in an SNA Server component, provide the
following information to the SNA Server support team:

<UL><LI>&lt;ntroot&gt;\DRWTSN32.LOG.
<LI>&lt;snaroot&gt;\TRACES\SNADUMP.LOG.
<LI>Windows NT System and Application event logs.
<LI>SNA Server configuration file (&lt;snaroot&gt;\SYSTEM\CONFIG\COM.CFG).
<P>
</UL><h3>SNA Server 2.11 README.WRI File Excerpt</h3>
 
<P>
The following is an excerpt from the SNA Server 2.11 README.WRI file that
is installed in the SNA Server group icon:
<P>
A.5. Notes on obtaining useful DRWTSN32.LOG files
<P>
By default, the log files generated by the Dr. Watson utility do not
contain symbol information necessary for interpreting those files.
This is because SNA Server components contain optimized instructions
that prevent the Dr. Watson utility from being able to provide a full
trace. In addition, the default configuration of Windows NT version
3.5 does not include symbol information required by the Dr. Watson
utility.
<P>
If you are experiencing a Windows NT trap, and if Microsoft Product
Support Services requests a copy of your DRWTSN32.LOG file, you must
modify your system setup before the Dr. Watson utility can produce a
useful log file the next time a trap occurs.
<P>
For a computer running Windows NT Server version 3.5, you must
perform the following steps to make symbol information available to
the Dr. Watson utility:

<OL><P><LI>Place the Windows NT installation CD-ROM in the CD-ROM drive.

<P><LI>At the Windows NT command prompt, execute the following command:
<P>
   xcopy &lt;cd_drive&gt;:\support\debug\&lt;cpu_type&gt;\symbols\*.*
</OL>%systemroot%\symbols\*.* /s /e /v
<P>
If any Windows NT service packs have been applied, copy the symbols
supplied with the service pack in the same manner.
<P>
On all versions of Windows NT, you must replace all SNA Server system
files with debug versions using this procedure:

<OL><P><LI>Place the SNA Server CD-ROM in the CD-ROM drive.

<P><LI>At the Windows NT command prompt, execute the following commands:
<P>
   cd_drive:
   cd \
   setupdbg
   snaroot_drive:
   cd %snaroot%
   makedbg cd_drive:
<P>
</OL>Cd_drive is the drive letter or UNC path of the drive containing the
SNA Server CD-ROM.snaroot_drive is the drive letter of the drive on
the server that contains the SNA Server system directory.
<P>
This step creates two subdirectories in the SNA Server system
directory: DEBUG contains nonoptimized, debug versions of the SNA
Server system files, while NODEBUG contains copies of the original,
optimized SNA Server system files.

<OL><P><LI>To prepare the system for troubleshooting with the Dr. Watson
</OL>utility, execute the following commands:
<P>
<PRE>   net stop snaserver
   net stop snabase
   copy %snaroot%\debug %snaroot%

</PRE><P><LI>Restart the system.
<P>
</OL>When you no longer need to run the debug versions of the SNA Server
system files, execute the following commands and then restart the
system:
<P>
<PRE>  net stop snaserver
  net stop snabase
  copy %snaroot%\nodebug %snaroot%
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbinterop kbnetwork kbsetup snaprog<BR>
Version             : 2.0 2.1 2.11 3.0 3.5 3.51<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
