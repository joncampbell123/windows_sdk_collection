

<HTML>
<HEAD>
<TITLE>Invokable TP Written as an Application to Run as a Service </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151239">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/05/20">
<META NAME="Keywords" CONTENT="kbnetwork ntnetserv snaprog">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  An autostarted Invokable Transaction Program (TP) written as a Microsoft Windows NT application can be configured to run as a Windows NT service using the Windows NT Resource Kit utility Srvany.exe. This TP can then be configured to be autostarted ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QACK,QBWS,QAIJ,QBKX,QAJH,QBTX,QBBI,QAH4,QAB5,QAI5,QDJ3,QDIZ,QAPF,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Invokable TP Written as an Application to Run as a Service</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151239</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, 2.11, and
   3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An autostarted Invokable Transaction Program (TP) written as a Microsoft
Windows NT application can be configured to run as a Windows NT service
using the Windows NT Resource Kit utility Srvany.exe. This TP can then be
configured to be autostarted by SNA Server when invoked by the remote
system. When you configure an application to run as a service, the
application can be automatically started without a user being logged onto
Windows NT. Also, the user context under which the application is run can
be configured in the Services Control Panel.
<P>
NOTE: Some applications may assume that there is a logged on user in order
to run properly. See the documentation for SRVANY included in the Windows
NT Resource Kit for details. Some applications may not operate properly
when run in this mode.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For a program to run as a service, the program must include a service
control handler to communicate with the Windows NT Service Control Manager,
so that it can respond to startup and shutdown requests.
<P>
Programs written specifically as a Windows NT service have these call in
their code, whereas an application does not. The utility SRVANY acts as an
intermediary between the application and Service Control Manager to allow
an application to be run as a service.
<P>
<P><h3>Installation Instructions (adapted from Resource Kit Help file)</h3>
 

<OL><P><LI>Copy SRVANY.EXE to your system and install it as a Windows NT service,
   for example, INSTSRV MyService c:\tools\srvany.exe
<P>
   INSTSRV.EXE can be found in the Resource Kit. The service name
   "MyService" should be the TPName.

<P><LI>Configure the service (for example, "MyService") using the Services
   applet of the Control Panel as manual or automatic. If you wish SNA
   Server to automatically start the TP when an attach request is received,
   configure the service for manual startup.

<P><LI>Set via the Services applet of the Control Panel the account for the
   service. If you need access to the screen and keyboard, you must choose
   the LocalSystem account and click the Allow Service to Interact with
   Desktop, otherwise choose any account and specify the correct logon
   password.
<P>
   NOTE: The LocalSystem account does not have network access. Make sure
   that the account specified has rights to logon as a service.
<P>
</OL><h3>Specify the Application to Start and its Parameters</h3>
 
<P>
Run the Registry Editor (Regedt32.exe):
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MyService:
   create a Parameters key.

<P><LI>Under the above key, create an Application value of type REG_SZ and
   specify there the full path of your app executable (including the
   extension). For example, Application: REG_SZ: D:\Tools\Vi.exe

<P><LI>OPTIONAL: under the above key, create an AppParameters value of type
   REG_SZ and specify the parameters for your app. For example,
   AppParameters: REG_SZ: C:\Tmp\Temp

<P><LI>OPTIONAL: under the above key, create an AppDirectory value of type
   REG_SZ and specify the current directory to use for the application. For
   example, AppDirectory: REG_SZ: C:\Tmp
<P>
</OL><h3>Add Registry Values to Have the Service Act as an Autostarted TP</h3>
 

<OL><P><LI>Under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MyService:
   create a Linkage key

<P><LI>Under the above key, create an OtherDependencies value of type
   REG_MULTI_SZ and specify SnaBase. For example, OtherDependencies:
   REG_MULTI_SZ: SnaBase

<P><LI>Under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MyService
   \Parameters, create the following values:
<P>
<P><PRE>      AlreadyVerified:REG_SZ:no
      ConversationSecurity:REG_SZ:no
      LocalLU:REG_SZ:'LUAlias'  (optional)
      Parameters:REG_SZ:
<PRE></PRE>      SNAServiceType:REG_DWORD:0x5   (type 5 is autostarted)
      Timeout:REG_DWORD:0xffffffff  (infinite timeout)

   NOTE: The above Invokable TP parameters are described in Chapter 2 of
   the SNA Server APPC and CPIC “Programmer's Guides.”

</PRE></OL>These settings correspond to the fields in TPSETUP, the utility included
with SNA Server for installing Invokable TPs. The SnaBase service must be
stopped and started to recognize the new transaction program.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbnetwork ntnetserv snaprog<BR>
Version             : 2.0 2.1 2.11 3.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
