

<HTML>
<HEAD>
<TITLE>Auto-Recovery of APPC Sessions when Partner is Restarted </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107866">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1993/11/30">
<META NAME="Keywords" CONTENT="kbnetwork ntnetserv">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  By default, SNA Server automatically recovers APPC sessions under most circumstances if the remote end (such as CICS or an AS/400) is stopped and restarted. However, if APPC sessions are still not being recovered, SNA Server supports more aggressiv...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABN,QABA,QBXS,QBWP,QAYL,QAIJ,QBAO,QAJB,QAJH,QAGI,QBVV,QBG2,QA5C,QAI5,QA5E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Auto-Recovery of APPC Sessions when Partner is Restarted</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107866</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default, SNA Server automatically recovers APPC sessions under most
circumstances if the remote end (such as CICS or an AS/400) is stopped and
restarted. However, if APPC sessions are still not being recovered, SNA
Server supports more aggressive session recovery when the RENEGLIMITS
parameter is added to the Windows NT Registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To configure SNA Server 2.0 to support more aggressive APPC session
recovery, do the following:

<OL><P><LI>Run Registry Editor (REGEDT32.EXE).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      SYSTEM\CurrentControlSet\Services\SnaServr\Parameters
</PRE>
<P><LI>Add the following new parameter:
<P>
<P><PRE>      RENEGLIMITS:REG_SZ:YES
</PRE>
<P><LI>Restart SNA Server.
<P>
</OL>This causes SNA Server to re-negotiate CNOS session limits following any
negative response to an APPC application bind request.
<P>
<P><h2>BACKGROUND</h2>
 
<P>
RENEGLIMITS and RETRYCNOS:
<P>
These variables only affect APPC LUs that support parallel sessions and
determine SNA Server's behavior when an application BIND (non-CNOS BIND)
fails.
<P>
By default, SNA Server performs CNOS negotiation:

<UL><LI>At start of day (when the session limits are initially zero).
<LI>In response to an application issuing a CNOS verb.
<P>
</UL>Even after a connection outage, SNA Server does not reset session limits,
so re-negotiation does not occur when the connection is reactivated.
<P>
The most likely reason for an application BIND to fail after a previously
successful CNOS negotiation is that the partner LU has reset its session
limits (perhaps because of a connection failure or being stopped and
restarted) without SNA Server being informed by a request to re-negotiate
the session limits.
<P>
If the remote application is now active, and there are no active sessions
on the connection, performing CNOS re-negotiation solves this problem. If
the CNOS re-negotiation fails, no further attempts are made to activate the
session until the connection is restarted or the SNA Server application
retries.
<P>
The default settings for SNA Server are: RENEGLIMITS=NO and RETRYCNOS=YES.
These settings attempt to detect the conditions where the remote
application requires re-negotiation of session limits, and to avoid
unnecessary re-negotiation.
<P>
Setting RENEGLIMITS=YES causes re-negotiation in all circumstances
(provided there are no active sessions).
<P>
Setting RENEGLIMITS=NO and RETRYCNOS=NO provides backward compatibility
with the default behavior of Comm Server 1.x.
<P>
RENEGLIMITS:REG_SZ:NO:
<P>
When this variable is set to YES, SNA Server performs CNOS re-negotiation
whenever an application BIND fails, regardless of the sense code.
Otherwise, SNA Server performs CNOS re-negotiation according to the setting
of RETRYCNOS.
<P>
Note that when RENEGLIMITS is set to YES, it overrides any setting of
RETRYCNOS.
<P>
RETRYCNOS:REG_SZ:YES:
<P>
When this variable is set to NO, SNA Server does not automatically re-
negotiate LU 6.2 session limits when an application BIND fails. Otherwise,
SNA Server performs CNOS re-negotiation whenever an application BIND is
rejected by an UNBIND request or with a BIND negative response containing
one of the following sense codes:
<P>
<PRE>   Sense 1    Sense 2
   -------------------------------------------
   0x0806      0x3426 (Resource Unknown)
   0x0805      xxxxxx (Session Limit Exceeded)
   0x0801      xxxxxx (Resource Not Available)

</PRE></OL>If the variable RENEGLIMITS is set to YES, it overrides any setting of
RETRYCNOS.
<P>
Note that the default value for this variable was NO in Comm Server 1.x.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna SNA CNOS APPC LU6.2 recovery reneglimits<BR>
retrycnos<BR>
Keywords            : kbnetwork ntnetserv<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
