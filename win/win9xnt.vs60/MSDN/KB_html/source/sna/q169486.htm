

<HTML>
<HEAD>
<TITLE>SnaBase and SNA Server Don't Accept New Client Connections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169486">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/06/02">
<META NAME="Keywords" CONTENT="snabaseservice snaserverservice kbfix3.00.sp2 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  SnaBase and SNA Server may unexpectedly stop accepting new client connections after changes to the SNA Server configuration are saved using SNA Server Manager. Clients who are already connected through the SnaBase or server continue to function cor...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QARL,QDO3,QBG2,QAB4,QAR4,QAO4,QAAP,QBVX,QAGI,QAKJ,QAKP,QBWP,QBVV,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SnaBase and SNA Server Don't Accept New Client Connections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169486</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 3.0 and 3.0 Service Pack 1 (SP1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SnaBase and SNA Server may unexpectedly stop accepting new client
connections after changes to the SNA Server configuration are saved
using SNA Server Manager. Clients who are already connected through the
SnaBase or server continue to function correctly. New clients may fail
to get a sponsor connection, and will display one of the following error
messages:
<P>
Windows NT client:
<P>
<PRE>   SNA Server - ERROR # 1003
   SnaBase could not open a sponsor connection to server &lt;server&gt;

</PRE>Windows 95 client:
<P>
<PRE>   SnaBase
   ERROR: Could not open sponsor connection to &lt;server&gt;

</PRE>Windows 3.x client:
<P>
<PRE>   SNA Server Error: 546 Cannot establish connection with SNA Server
   &lt;servername&gt;.

</PRE>If SNA Server or SnaBase full internal tracing is enabled while this
is occurring, no internal trace files are generated.
<P>
<P><h2>CAUSE</h2>
 
<P>
Under SNA Server 3.0, every time a 3.0 client opens the sponsor connection,
the SnaBase makes a local remote procedure call (RPC) to check if the
encryption flag is enabled for the user record. If this occurs while
another thread of the SnaBase is notified of a configuration file change,
an SnaBase deadlock can occur.
<P>
When the deadlock occurs, the DMOD critical section is held, preventing new
users from connecting to either SnaBase or SNA Server.
<P>
NOTE: For information on other potential causes of client connection
problems to SNA Server 3.0 servers, see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   Article ID: <B><A href="../sna/q168546.htm">Q168546</A></B>
   Title     : Access Violation May Occur After Upgrading to 3.0 SP1

   Article ID: <B><A href="../sna/q167196.htm">Q167196</A></B>
   Title     : SNA Server 3.0 SP1 Update May Break Named Pipe Clients

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 3.0 and
3.0 Service Pack 1 (SP1). This problem was corrected in the latest SNA 
Server version 3.0 U.S. Service Pack. For information on obtaining this 
Service Pack, query on the following word in the Microsoft Knowledge Base 
(without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
With the fix applied, the asynchronous RPC requests done from the SnaBase
DMOD are really asynchronous; without the fix, they are synchronous, which
can cause a deadlock in certain situations.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hang crash<BR>
Keywords          : snabaseservice snaserverservice kbfix3.00.sp2 kbnetwork<BR>
Version           : 3.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
