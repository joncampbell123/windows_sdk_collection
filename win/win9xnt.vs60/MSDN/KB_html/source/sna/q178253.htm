

<HTML>
<HEAD>
<TITLE>SNA Server Access Violation in function s1pcsgm. </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178253">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1997/12/18">
<META NAME="Keywords" CONTENT="kbbug3.00 kbbug3.00.sp1 prodsna snaserverservice kbbug3.00.sp2">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  If one or more SNA Server connections are configured with  Supports Dynamic  Remote APPC LU Definition , the SNA Server may encounter an unexpected  access violation. This will cause the following symptoms:  - The SNA Server service will end, coinc...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAR4,QAI5,QBW7,QA1S,QAY5,QAM1,QBWG,QAO4,QBWP,QBV8,QA4H,QAPN,QAB9,QDN9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server Access Violation in function s1pcsgm.</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178253</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 3.0, 3.0SP1, 3.0SP2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If one or more SNA Server connections are configured with "Supports Dynamic 
Remote APPC LU Definition", the SNA Server may encounter an unexpected 
access violation. This will cause the following symptoms:
<P>
- The SNA Server service will end, coinciding with the following event
<PRE>  logged to the Windows NT application event log:

     Event ID: 624
     Source:   SNA Server
     Description: Creating dump file SNADUMP.LOG for SNASERVR.EXE.

</PRE>- The following log entry will be created in the &lt;ntroot&gt;\drwtsn32.log
<PRE>  file, indicating an access violation in snaservr.exe, in function s1pcsgm:

   Application exception occurred:
        App: snaservr.DBG (&lt;process ID&gt;)
        Exception number: c0000005 (access violation)

</PRE>State Dump for Thread Id 0x8d
<P>
<PRE>   eax=00f50000 ebx=00000207 ecx=00000000 edx=00000009 esi=00e40000 edi=00000000
   eip=002b7879 esp=00e4fe98 ebp=001d0008 iopl=0 nv up ei pl nz na po nc
   cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000 efl=00000206

</PRE>function: s1pcsgm
<PRE>        002b7860 668b4c2404       mov     cx,[esp+0x4]  ss:0149e7bc=????
        002b7865 56               push    esi
        002b7866 6633f6           xor     si,si
        002b7869 57               push    edi
        002b786a 0fbfc1           movsx   eax,cx
        002b786d 8d0440           lea     eax,[eax+eax*2] 
                    ds:00f50000=01110100
        002b7870 c1e003           shl     eax,0x3
        002b7873 0305a8043400     add     eax,[sct (003404a8)]
                    ds:003404a8=00f50000
FAULT -&gt;002b7879 8a50ea           mov     dl,[eax-0x16] ds:0159e922=??

</PRE>*----&gt; Stack Back Trace &lt;----*
<P>
<PRE>   FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
   00e4fe9c 002b232a 00000000 00e4feca 001defe0 001dbbb0 snaservr!s1pcsgm  
   00e4ff04 002b9ff1 00000000 00000000 00010018 00000000 snaservr!s1pcprlu  
   00e4ff54 002ba58f 000000ff 00000004 0000003d 00000000 snaservr!s1practs  
   00e4ff68 002d8bcc 0030d042 0000001e 00e4ffec 00143248 snaservr!s1prmrcv  
   00e4ff6c 0030d042 0000001e 00e4ffec 00143248 00000002 snaservr!s1pgdisp  
   00e4ff88 0030d7f5 009811c0 00000002 00143248 77fac8a0 snaservr!sbpsched  
   00e4ff8c 009811c0 00000002 00143248 77fac8a0 00143240 snaservr!sbpgmain  
   00e4ffa8 77e3167a 00000002 00143248 77e50000 77f46c2e snasvc!ServiceMainFunction

</PRE><h2>CAUSE</h2>
 
<P>
The SNA Server was attempting to access an invalid array element which 
caused the access violation.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Obtain the hotfix described below, or reconfigure the connection so that 
it no longer supports dynamic definition of Remote APPC LU's.
<P>
<P><h2>STATUS</h2>
 
<P>
Obtain the following fix or wait for the next SNA Server service pack.
<P>
This fix should have the following timestamp:
<PRE>   11/14/97  07:30a       437,440 &lt;snaroot&gt;\system\snaservr.exe
   11/14/97  07:30a       412,676 &lt;ntroot&gt;\symbols\exe\snaservr.dbg
   11/14/97  07:31a       824,560 &lt;snaroot&gt;\system\trcservr.exe
   11/14/97  07:31a       751,456 &lt;ntroot&gt;\symbols\exe\trcservr.dbg

</PRE>NOTE: SNA Server 3.0 Service Pack 2 should be applied prior to applying
this fix.
<P>
Microsoft has confirmed this to be a problem in SNA Server version 3.0 
(including SP1 and SP2). 
A supported fix is now available, but has not been fully regression-tested 
and should be applied only to systems experiencing this specific problem. 
Unless you are severely impacted by this specific problem, Microsoft 
recommends that you wait for the next Service Pack that contains this fix. 
Contact Microsoft Technical Support for more information. 
 
<PRE>Keywords          : kbbug3.00 kbbug3.00.sp1 prodsna snaserverservice kbbug3.00.sp2
Version           : WINDOWS:3.0,3.0SP1,3.0SP2
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbpatch</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
