

<HTML>
<HEAD>
<TITLE>Print Server Application Exception in S3POHPOP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169132">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/05/28">
<META NAME="Keywords" CONTENT="prodsna snaprintservice kbfix3.00.sp2 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  The SNA Server Host Print service may generate an application exception that creates a Drwtsn32.log in the Windows NT directory when configured for 3270 host printing. The Windows NT Application Event Log will contain a message similar to the follo...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI4,QDO3,QAOX,QAYA,QBWP,QAO4,QAJH,QA7R,QAAP,QACK,QBFY,QBII,QAR4,QAKP,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Print Server Application Exception in S3POHPOP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169132</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server versions 3.0 and 3.0 Service Pack 1 (SP1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SNA Server Host Print service may generate an application exception
that creates a Drwtsn32.log in the Windows NT directory when configured
for 3270 host printing. The Windows NT Application Event Log will contain
a message similar to the following when this occurs:
<P>
<PRE>   Event ID: 4097
   Source: DrWatson
   Description: The application, exe\snaprint.DBG, generated an application
   error.
   The error occurred on  &lt;date&gt; @  &lt;time&gt;. The exception generated was
   c0000005 at address 60d8c72b (s3pohpop).

</PRE><h2>CAUSE</h2>
 
<P>
The application exception can be caused if the Host Print service accesses
a buffer after sending it to the SNA Server service.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 3.0 and
3.0 Service Pack 1 (SP1). This problem was corrected in the latest SNA 
Server version 3.0 U.S. Service Pack. For information on obtaining this 
Service Pack, query on the following word in the Microsoft Knowledge Base 
(without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When this error occurs, the Drwtsn32.log will contain information similar
to the following:
<P>
<PRE>   Application exception occurred:
      App: exe\snaprint.DBG (pid=&lt;process id&gt;)
      When: &lt;date&gt; @ &lt;time&gt;
      Exception number: c0000005 (access violation)

   function: s3pohpop
      60d8c706 66894d58         mov     [ebp+0x58],cx      ss:01539eb7=????
      60d8c70a 6a03             push    0x3
      60d8c70c 668b4e0c         mov     cx,[esi+0xc]
         ds:0c0a6fcb=????
      60d8c710 68b007da60       push    0x60da07b0
      60d8c715 66890d0074da60   mov     [tracevar (60da7400)],cx
         ds:60da7400=0000
      60d8c71c 6a04             push    0x4
      60d8c71e 6a5f             push    0x5f
      60d8c720 6a12             push    0x12
      60d8c722 e8994cffff       call    gw_trace (60d813c0)
      60d8c727 8b542410         mov     edx,[esp+0x10]
         ss:0df9e92f=????????
   FAULT -&gt;60d8c72b 0fbf4a04         movsx   ecx,word ptr [edx+0x4]
   ds:0b743d43=????
      60d8c72f 8a441112         mov     al,[ecx+edx+0x12]
   ds:0b743d43=??
      60d8c733 8b4c2428         mov     ecx,[esp+0x28]
   ss:0df9e92f=????????
      60d8c737 88410c           mov     [ecx+0xc],al
   ds:0144f807=??
      60d8c73a 0fbf4204         movsx   eax,word ptr [edx+0x4]
   ds:0b743d43=????
      60d8c73e 03c2             add     eax,edx
      60d8c740 660fb65020       movzx   dx,byte ptr [eax+0x20]
   ds:0121ea3c=??
      60d8c745 66c1e208         shl     dx,0x8
      60d8c749 660fb64021       movzx   ax,byte ptr [eax+0x21]
   ds:0121ea3c=??
      60d8c74e 6603d0           add     dx,ax
      60d8c751 66895108         mov     [ecx+0x8],dx
   ds:0144f808=????
      60d8c755 8b542410         mov     edx,[esp+0x10]
   ss:0df9e92f=????????

   *----&gt; Stack Back Trace &lt;----*

   FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
   0cd7ff54 60d8babb 0cd7ff73 60da2e28 0ae885c4 001696a0 ppd3270!s3pohpop
   0cd7ff70 60d8ef23 77f67570 001696a0 60d9a9dc 0001000b ppd3270!s3pohp
   0cd7ff7c 60d9a9dc 0001000b 00000020 0ae885c4 001696a0 ppd3270!s3poproc
   0cd7ffa4 60d86efd 0cd7ffec 1000fb84 01b5fb84 60da2e28 ppd3270!s3psproc
   0cd7ffb8 77f04f32 60da2e28 1000fb84 01b5fb84 60da2e28 ppd3270!s3pmain
   0cd7ffec 00000000 60d86df0 60da2e28 00000000 00000007 kernel32!lstrcmpiW
   00000000 00000000 00000000 00000000 00000000 00000000
   snaprint!&lt;nosymbols&gt;

</PRE>The 3270 print provider for SNA Server 3.0 has been updated to correct this
problem.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: trap<BR>
Keywords          : prodsna snaprintservice kbfix3.00.sp2 kbnetwork<BR>
Version           : 3.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
