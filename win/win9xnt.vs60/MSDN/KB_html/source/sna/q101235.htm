

<HTML>
<HEAD>
<TITLE>TN3270 Server Now Supports Client-Side Hot Backup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101235">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/07/08">
<META NAME="Keywords" CONTENT="kbbug2.11 kbinterop kbnetwork ntnetserv ntprotocol">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  If all the resources are in use on the SNA Server 2.11 TN3270 server the Hot-Backup feature of some TN3270 emulators does not work.  The Hot-Backup feature, implemented in some TN3270 emulators, allows you to specify the IP addresses of several TN3...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAI5,QDO3,QBWP,QBVV,QBBI,QDIZ,QBXS,QA5E,QAYZ,QAC2,QDIV,QBVX,QDJ3,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>TN3270 Server Now Supports Client-Side Hot Backup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101235</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, version 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If all the resources are in use on the SNA Server 2.11 TN3270 server the
Hot-Backup feature of some TN3270 emulators does not work.
<P>
The Hot-Backup feature, implemented in some TN3270 emulators, allows you to
specify the IP addresses of several TN3270 Servers for the emulator to
attempt to connect to. If access is denied it attempts to connect to the
next IP address specified.
<P>
<P><h2>CAUSE</h2>
 
<P>
The SNA Server TN3270 Server always listens on a socket, allowing an
emulator to connect (that is, it fails to deny the socket connection), even
if all of the configured resources on the server are in use causing it not
be able to service that connection. When the emulator successfully opens a
socket connection to one of the addresses, in this case the address of the
SNA Server TN3270 Server, the emulator is locked into that address and
cannot try another IP address specified with the Hot-Backup feature.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has enhanced the SNA Server 2.11 files, TN3SERVR.EXE and
TN3NTMSG.DLL, to fully support the Hot-Backup feature of TN3270 emulators.
<P>
This update supports the option to stop listening once all of the
configured SNA resources are in use, and to start listening again once some
become available. This feature is turned on by setting the following
registry entry under the HKEY_LOCAL_MACHINE subtree under the following
subkey:
<P>
<PRE>   \CurrentControlSet\Services\TN3270\Parameters\CloseListenSocket

</PRE>Type:  RG_EXPAND_SZ
Value: YES
<P>
In SNA Server 3.0 (and future SNA Server 2.11 service packs beyond SP1),
the CloseListenSocket option must be set to “ON”. The administration tool
has been updated to support configuration of this parameter, so manual
adjustment of the registry is not necessary. If this setting is not
configured or is set to any other value, then the TN3270 Server does not
stop listening.
<P>
<P><h2>STATUS</h2>
 
<P>
This feature is included in the latest U.S. Service Pack for SNA Server for
Windows NT, version 2.11. For information on obtaining the Service Pack,
query on the following word in the Microsoft Knowledge Base (without the
spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbbug2.11 kbinterop kbnetwork ntnetserv ntprotocol<BR>
Version             : 2.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
