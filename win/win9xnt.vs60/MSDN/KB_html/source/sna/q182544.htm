

<HTML>
<HEAD>
<TITLE>Host Security: Memory Leaks, Database Corruption, Event Logging </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182544">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/16">
<META NAME="Keywords" CONTENT="kbbug3.00 kbbug3.00.sp1 snahostsec kbbug3.00.sp2 kbbug4.00 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  This article describes six issues related to the Host Security Integration feature included of SNA Server.  Issue 1 -------  The following services use an excessive amount of non-paged pool memory:   - Host Account Cache service (Snaudb.exe)  - SNA...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBG2,QAI5,QACK,QDN1,QAZV,QAO4,QAAD,QAPN,QAGI,QDO3,QAR4,QAKP,QBWP,QBVV,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Host Security: Memory Leaks, Database Corruption, Event Logging</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182544</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server versions 3.0, 3.0 Service Pack 1 (SP1),
   3.0SP2, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
This article describes six issues related to the Host Security Integration
feature included of SNA Server.
<P>
<P><h3>Issue 1</h3>
 
<P>
The following services use an excessive amount of non-paged pool memory:

<UL><LI>Host Account Cache service (Snaudb.exe)
<LI>SNA Host Account Synchronization service (Hostproc.exe)
<LI>SNA WinNT Account Synchronization service (Snapmp.exe)
<P>
</UL><h3>Issue 2</h3>
 
<P>
The SNA WinNT Account Synchronization service generates two access
violations for each password change request that it processes. The
exception handler catches and ignores each of these access violations.
There are no noticeable signs that these access violations occur and they
do not result in any problems with the password change request. The access
violations are only noticeable when you use a debugger to step through the
application code.
<P>
<P><h3>Issue 3</h3>
 
<P>
The SNA WinNT Account Synchronization service leaks one handle and
approximately 12 KB of memory each time a user account is added to the host
account database with the SNACFG command-line configuration utility.
<P>
<P><h3>Issue 4</h3>
 
<P>
Event ID 3000 is incorrectly logged in the Windows NT Application Event Log
by the AS/400 security provider when you are using the SNA Server Host
Security features for AS/400 connections. Event 3000 should indicate the
AS/400 security provider DLL (sec400.dll) has been loaded.
<P>
The following is an example of the incorrect event that is logged:
<P>
<PRE>   Event ID: 3000
   Source: AS400 MDSI
   Description: Has been loaded by:

</PRE><h3>Issue 5</h3>
 
<P>
The Host Account Database service may corrupt its account database when an
existing user record is modified or deleted and the user's host account
name hash is not unique (that is, there is another user whose host account
name hash has the same value). The database can also get corrupted when a
new user is added to the database using a dummy host account and then
modified with the correct host account info.
<P>
This problem can manifest itself in a number of ways. The following are
some of the symptoms that can occur if the database becomes corrupted:

<UL><LI>Host Account Database service hangs or it stops responding to RPC
   requests.

<LI>Single Signon requests fail randomly.

<LI>SNACFG Host Security operations fail randomly.

<LI>The Host Account Database service logs Events 1283 through 1305 in the
   Application Event Log when the database is corrupt. The exact event
   number depends on how the database is corrupted.
<P>
</UL><h3>Issue 6</h3>
 
<P>
Single Sign-on does not work if the Host Account Cache service is not
running when the SNA Server service starts. If the SNA Server service
cannot contact the host security database when it is started, all single
sign-on requests will hang and no errors will be reported to the
application. The only recovery is to restart the SNA Server service.
Starting the Host Account Cache service after the SNA Server service is
started will not correct the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 3.0,
3.0 SP1, and 3.0 SP2. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
Microsoft has confirmed this to be a problem in SNA Server version 4.0.
A supported fix is now available for SNA Server version 4.0, but it has not
been fully regression tested and should be applied only to systems
experiencing this specific problem. Unless you are severely impacted by
this specific problem, Microsoft recommends that you wait for the next
Service Pack that contains this fix. Contact Microsoft Technical Support
for more information.
 
<PRE>Keywords          : kbbug3.00 kbbug3.00.sp1 snahostsec kbbug3.00.sp2 kbbug4.00 kbnetwork
Version           : WINDOWS:3.0,3.0SP1,3.0SP2,4.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
