

<HTML>
<HEAD>
<TITLE>Enabling SNA Server Windows 3.x Client Traces </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123256">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1994/11/28">
<META NAME="Keywords" CONTENT="kbnetwork nthowto">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT=" Microsoft SNA Server provides extensive tracing capabilities at both the server and client side to help diagnose problems. On the server side, you can use the SNATRACE tool to trace SNA Server and Win32 application activity. You can enable Windows 3...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARL,QBWN,QDIT,QAB5,QA7O,QAOE,QAMN,QA7Y,QAJ9,QBBI,QAEV,QAKP,QAU5,QBVX,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Enabling SNA Server Windows 3.x Client Traces</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123256</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, 2.11, 2.11sp1,
   and 3.0
</UL> 
<P>
Microsoft SNA Server provides extensive tracing capabilities at both the
server and client side to help diagnose problems. On the server side, you
can use the SNATRACE tool to trace SNA Server and Win32 application
activity. You can enable Windows 3.x client tracing by following the steps
in the Enabling SNA Server Client Tracing section below. Client tracing is
useful in diagnosing client-to-server connection problems or Windows 3.x
SNA Server application problems. Note that client tracing cannot be used to
capture server-to-host SNA Server or link level traffic; these types of
traces must be captured at the server.
<P>
<P><h2>SNA SERVER CLIENT TRACING TYPES</h2>
 
<P>
Following are descriptions of the types of client tracing provided by SNA
Server, along with a descriptions of each associated WIN.INI entry:
<P>
<P><h3>Internal Tracing</h3>
 
<P>
Internal tracing traces code execution of SNA Server components and is
intended for SNA Server development. This type of tracing is useful to
diagnose:

<UL><LI>Client connection failures in communication (546 errors for example)
   over any client-server transport supported by SNA Server. If the SNA
   Server client software encounters an underlying network or operating
   system error, the error code is logged in the internal trace file.

<LI>Problems automatically loading a invokable transaction program (auto-
   started APPC or CPIC invokable TP).

<LI>Abnormal terminations of clients (general protection (GP) faults or
   application exceptions).
<P>
</UL>WIN.INI Entries Used To Control Internal Tracing:
<P>
<PRE>   InternalTraceLevel: [0-8] Level of detail. The most detailed level is 0.

   InternalTraceFile1, InternalTraceFile2: ASCII files that store internal
   trace information. If only InternalTraceFile1 is specified, the trace
   file will grow indefinitely. If both trace files are listed, each file
   will grow to the FlipLength (see below) before wrapping to the next
   file.

   TraceFlushing: [OFF/ON] Controls whether or not trace information is
   immediately flushed to the trace file. When debugging a problem
   involving a hang condition, this entry should be set to ON to ensure
   that the most recent trace event is logged to the trace file.

   FlipLength: [size in bytes] Controls how large each SNA Server trace
   file can grow (default: 250,000). If two trace file names are specified,
   SNA Server traces wrap between two trace files so the hard disk doesn't
   fill up.

</PRE><h3>API Tracing</h3>
 
<P>
API tracing traces application program interfaces (APIs) supported by SNA
Server, in call/return format. You can analyze these traces using the
appropriate SNA Server API programmer's guide. This type of tracing is
useful in diagnosing:

<UL><LI>User-written applications which use the SNA Server APIs.

<LI>5250 emulation problems (which use APPC).
<P>
</UL>SNA Server Trace Entries Used To Control API Tracing:
<P>
APPCTraceState: [OFF/ON] Enables APPC API tracing.
<P>
CPICTraceState: [OFF/ON] Enables CPIC API tracing.
<P>
CSVTraceState: [OFF/ON] Enables Common Service Verb API tracing.
<P>
RUITraceState: [OFF/ON] Enables LUA/RUI API tracing.
<P>
SLITraceState: [OFF/ON] Enables LUA/SLI API tracing.
<P>
APITraceFile1, APITraceFile2: ASCII files that store API trace information.
If only APITraceFile1 is specified, the trace file will grow indefinitely.
If both trace files are listed, each file will grow to the FlipLength (see
Internal Tracing section above) before wrapping to the next file.
<P>
<P><h3>Message Tracing</h3>
 
<P>
Message tracing traces the internal message flow between the SNA Server
client and the server. This type of trace is used by SNA Server development
to diagnose:

<UL><LI>3270 emulator problems communicating with the server.

<LI>APPC or CPIC application problems communicating with the server.
<P>
</UL>SNA Server Trace Entries Used To Control Message Tracing:
<P>
FMITraceState: [OFF/ON] Controls 3270 Emulator Interface (EIS) message
tracing, used by 3270 emulators.
<P>
PVITraceState: [OFF/ON] Controls LU6.2 message tracing which flows between
the client and server.
<P>
MessageTraceFile1, MessageTraceFile2: ASCII files to store message trace
information. If only MessageTraceFile1 is specified, the trace file will
grow indefinitely. If both trace files are listed, each file will grow to
the FlipLength (see Internal Tracing section above) before wrapping to the
next file.
<P>
<P><h2>ENABLING SNA SERVER CLIENT TRACING</h2>
 
<P>
To enable SNA Server client tracing on a Windows 3.x client computer:

<OL><P><LI>Stop the SNA Server for Windows client software.

<P><LI>Make backup copies of the following files on your client workstation:
<P>
<P><PRE>      &lt;snaroot&gt;\WNAP.EXE -&gt; WNAP.ORG
      &lt;winroot&gt;\SYSTEM\WDMOD.DLL -&gt; WDMOD.ORG
      &lt;winroot&gt;\SYSTEM\LMCLI.DLL -&gt; LMCLI.ORG (MS network/named pipes)
      &lt;winroot&gt;\SYSTEM\NWCLI.DLL -&gt; NWCLI.ORG (Netware ipx/spx)
      &lt;winroot&gt;\SYSTEM\BVCLI.DLL -&gt; BVCLI.ORG (Banyan IP)
      &lt;winroot&gt;\SYSTEM\IPCLI.DLL -&gt; IPCLI.ORG (TCP/IP sockets)
</PRE>
<P><LI>Copy the following traced versions of the client components from your
   SNA Server CD-ROM to your client workstation:
<P>
<P><PRE>      \clients\win3x\trace\WNAP.EXE  -&gt; &lt;snaroot&gt;\WNAP.EXE
      \clients\win3x\trace\WDMOD.DLL -&gt; &lt;winroot&gt;\SYSTEM\WDMOD.DLL
      \clients\win3x\trace\LMCLI.DLL -&gt; &lt;winroot&gt;\SYSTEM\LMCLI.DLL
      \clients\win3x\trace\NWCLI.DLL -&gt; &lt;winroot&gt;\SYSTEM\NWCLI.DLL
      \clients\win3x\trace\BVCLI.DLL -&gt; &lt;winroot&gt;\SYSTEM\BVCLI.DLL
      \clients\win3x\trace\IPCLI.DLL -&gt; &lt;winroot&gt;\SYSTEM\IPCLI.DLL
</PRE>
<P><LI>Add the following entries to your &lt;winroot&gt;\WIN.INI file, under the
   [WNAP] section. Any combination of tracing is supported. Not all entries
   need to be present in WIN.INI, only those necessary to capture the
   desired traces.
<P>
<P><PRE>      [WNAP]
      ; Entries which control Internal tracing:
      InternalMessageTraceState=ON
      InternalTraceFile1=C:\NAPINT1.TRC
      InternalTraceFile2=C:\NAPINT2.TRC
      InternalTraceLevel=2
      ; Entries that control API tracing:
      APPCTraceState=ON
      CPICTraceState=ON
      CSVTraceState=ON
      RUITraceState=ON
      SLITraceState=ON
      APITraceFile1=C:\API1.TRC
      APITraceFile2=C:\API2.TRC
      ; Entries that control message tracing:
      FMITraceState=ON
      PVITraceState=ON
      MessageTraceFile1=C:\NAPMSG1.TRC
      MessageTraceFile2=C:\NAPMSG2.TRC
      ; Other general tracing entries:
      FlipLength=250000
      TraceFlushing=ON
</PRE>
<P><LI>Restart WNAP.EXE by choosing Run from the File menu of Program Manager.

<P><LI>Once the problem occurs, stop the SNA application and close the SNA
   Server client icon (WNAP.EXE).
<P>
</OL>Be sure to rename the client files to the original versions to disable
tracing. There is no need to remove the WIN.INI entries if you use the
original client files; they will be ignored.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbnetwork nthowto<BR>
Version             : 2.0 2.1 2.11 3.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
