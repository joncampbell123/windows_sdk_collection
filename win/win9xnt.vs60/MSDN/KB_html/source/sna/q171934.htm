

<HTML>
<HEAD>
<TITLE>Cancelling SNA Windows 95 Logon Causes Sbpuinit() rc = 563 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171934">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/07/24">
<META NAME="Keywords" CONTENT="snaeis snaprog snawin95 kbfix3.00.sp2 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When an SNA Server 3270 EIS application calls sbpuinit() on a Windows 95 client configured to use a non-named pipe transport (for example, TCP/IP sockets, IPX/SPX, or Banyan IP), the SNA client software displays a user logon dialog box. If the user...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAAP,QDL9,QBWQ,QBWO,QBWN,QAGC,QAGB,QARL,QAI5,QAB4,QACK,QDNF,QA01,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cancelling SNA Windows 95 Logon Causes Sbpuinit() rc = 563</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171934</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 2.11, 2.11 Service Pack 1 (SP1), 2.11
   SP2, 3.0, and 3.0 SP1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When an SNA Server 3270 EIS application calls sbpuinit() on a Windows 95
client configured to use a non-named pipe transport (for example, TCP/IP
sockets, IPX/SPX, or Banyan IP), the SNA client software displays a user
logon dialog box. If the user cancels this logon dialog box, the sbpuinit()
function returns incorrectly with error 563 (DMDSTFL, or "service table
full"), instead of error 625 (DMNONAP, or "NAP not up when starting
service").
<P>
These error codes are documented in the SNA Server Emulator Interface
Guide and \SDK\INC\FMI.H include file, which ships on the SNA Server
compact disc.
<P>
<P><h2>CAUSE</h2>
 
<P>
The SNA Server Windows 95 Snadmod.dll does not retrieve the correct error
to the sbpuinit() function when the logon dialog box is cancelled.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the SNA Server Windows 
95 client version 3.0 and 3.0 Service Pack 1 (SP1). This problem was 
corrected in the latest SNA Server version 3.0 U.S. Service Pack. For
information on obtaining this Service Pack, query on the following 
word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h2>The updated Windows 95 client modules are snakrnl.dll and snadmod.dll.</h2>
 
<PRE>Keywords          : snaeis snaprog snawin95 kbfix3.00.sp2 kbnetwork
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
