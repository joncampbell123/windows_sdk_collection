

<HTML>
<HEAD>
<TITLE>Automating the SNA Server Win 3.x Client Login Process </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130854">
<META NAME="KBModify" CONTENT="1997/12/17">
<META NAME="KBCreate" CONTENT="1995/05/30">
<META NAME="Keywords" CONTENT="ntprotocol kbinterop kbnetwork kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When the SNA Server Windows 3.x client software is configured to use TCP/IP sockets, Netware IPX/SPX, or Banyan IP (any client-server transport except named pipes), the SNA client software (WNAP) uses a separate user login to the Windows NT servers...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QAGU,QAIJ,QAWK,QAGB,QDL9,QBWQ,QBWN,QA9A,QARL,QAM2,QBWS,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automating the SNA Server Win 3.x Client Login Process</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130854</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.1, 2.11, and 3.x.
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When the SNA Server Windows 3.x client software is configured to use
TCP/IP sockets, Netware IPX/SPX, or Banyan IP (any client-server transport
except named pipes), the SNA client software (WNAP) uses a separate user
login to the Windows NT servers running SNA Server to ensure security is
maintained. This article describes ways to automate this client login
process using SNA Server versions 2.1 and 2.11.
<P>
<P><h3>SNA Server 2.1</h3>
 
<P>
When you log into Windows NT Server using TCP/IP, Netware IPX/SPX or Banyan
IP from Windows 3.x clients, the two WNAP command lines noted below can be
used to remove the Domain Login dialog box when starting WNAP manually.
<P>
Add an icon in the Windows Startup group for WNAP.EXE (the SNA
Windows 3.x client process) that has the following command line option.
This causes WNAP to start automatically when Windows is started:
<P>
<PRE>   WNAP /USER: /PWD:

</PRE>NOTE: There must be no space after the semi-colon (:).
<P>
This command lets the user login to the Windows NT Server using the guest
account (provided that the guest account is enabled and has no password).
<P>
The next command requires that the user have a valid account in the
Windows NT/SNA Server domain:
<P>
<PRE>   WNAP /USER:&lt;userid&gt; /PWD:&lt;password&gt;

</PRE><h3>SNA Server 2.11/3.x</h3>
 
<P>
The following additional options are available under SNA 2.11 and 3.x:
<P>
1) The following two new options can be added to the [WNAP] section of
<PRE>   the WIN.INI file:

      LogonUserName=&lt;USERID&gt;
      LogonPassword=&lt;PASSWORD&gt;

   WNAP will parse these entries and use them when a  application is first
   started, reducing the need for starting WNAP manually with command
   line parameters.

   Also, to use the guest account using the parameters in WIN.INI, add the
   entries as such:

      LogonUserName=guest
      LogonPassword=

</PRE>NOTE: There must be no space after the equals sigh (=).
<P>
2) Automated use of Windows for Workgroups 3.11 cached domain password.
<P>
If the above WIN.INI entries are not present on a Windows for Workgroups
3.11 client, and if the user is using the cached domain password feature of
Windows for Workgroups (enabled in the network Control Panel Startup dialog
box by selecting "Log On to Windows NT or LAN Manager Domain"), the user
password is automatically retrieved from Windows for Workgroups.
<P>
WNAP will start automatically when an SNA Server application (3270, 5250,
or an application written to the SNA Server APIs is started), or when
Windows is started (if a WNAP icon is added to the Startup group). If the
cached domain password method is used, WNAP retrieves the username when
WNAP is started. If the Windows for Workgroups user logs off and on, WNAP
is still running under the previous user context.
<P>
To resolve this problem, WNAP can be configured to terminate automatically
when the last SNA application ends by adding AutoTerminate=Yes  to the
[WNAP] section of the WIN.INI file. By default, WNAP remains running even
if the Windows for Workgroups user logs off and then logs back on. The user
should quite all SNA applications before logging off in Windows for
Workgroups. This ensures that WNAP will quit so that it will be restarted
again when the new Windows for Workgroups user logs in and starts an SNA
application.
<P>
To enable the AutoTerminate feature:

<OL><P><LI>Add AutoTerminate=Yes to the [WNAP] section of the WIN.INI file.

<P><LI>Start WNAP automatically by starting an SNA application. If WNAP is
   started manually, WNAP will not unload, even if AutoTerminate is set to
   Yes.
<P>
</OL>With some emulators the WNAP will quit when the last connection is
disconnected. With other emulators you need to exit from the emulator. This
behavior depends on how the emulator is implemented. With the SNA Server
applets the WNAP won't unload before you exit from the applet.
<P>
<P><h3>Windows for Workgroups Domain Password Expiration</h3>
 
<P>
If the Windows for Workgroups user's domain password expires, or if user is
required to change their domain password on the next domain login attempt,
the SNA client login dialog will fail with Error 546. To solve this
problem, the Windows for Workgroups user must login and change their domain
password first. The user may then need to update their SNA client
configuration to reflect their new password. There is no additional user
interaction required when using the Windows for Workgroups cached domain
password.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords          : ntprotocol kbinterop kbnetwork kbsetup<BR>
Version           : 2.1 2.11 3.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
