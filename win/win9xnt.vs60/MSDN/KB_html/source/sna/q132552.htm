

<HTML>
<HEAD>
<TITLE>SNA: Separate Logon Prompt If Non-MS Network Protocol Installed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132552">
<META NAME="KBModify" CONTENT="1995/11/01">
<META NAME="KBCreate" CONTENT="1995/07/17">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  A separate logon screen appears each time the SNA client software (WNAP) is started. (WNAP is an abbreviation for Windows Network Access Process.)  This problem occurs when an SNA Server Windows 3.1 or 3.11 client is installed with a protocol other...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QAI5,QAIJ,QDL9,QBWQ,QBWN,QAWK,QARL,QAGB,QBW7,QDIV,QBVV,QDIK,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA: Separate Logon Prompt If Non-MS Network Protocol Installed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132552</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.1 and 2.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A separate logon screen appears each time the SNA client software (WNAP) is
started. (WNAP is an abbreviation for Windows Network Access Process.)
<P>
This problem occurs when an SNA Server Windows 3.1 or 3.11 client is
installed with a protocol other than Microsoft Networking (named pipes),
even if the user is logged on to the same Windows NT Server.
<P>
<P><h2>CAUSE</h2>
 
<P>
You do not have a secure communication channel established yet.
<P>
When your SNA Server Windows 3.1 or 3.11 client software uses the TCP/IP
sockets, NetWare IPX/SPX, AppleTalk, or Banyan Vines IP (or any client-
server transport, except named pipes) protocol to communicate with the
Windows NT server, a secure communication channel is not established with
the server, because the Windows Socket interface these protocols rely on
does not include guaranteed security. Therefore, to ensure a secure
communication channel, SNA client software (WNAP) requires you to log on
separately to the Windows NT servers running SNA Server.
<P>
When you log on to WNAP, your user name, password, and domain name
credentials are combined and encrypted and then stored locally so debug
programs cannot determine your password. These encrypted credentials are
validated by the server when the client connects to the server. If the
validation fails, you are prompted to reenter the password.
<P>
When the client tries to connect to other servers, you are not prompted
again for your credentials, because your previously encrypted credentials
are used for validation automatically.
<P>
NOTE: SNA Server Windows NT clients take advantage of a single-user logon
process that does not require a special SNA Server logon, regardless of the
protocol used to connect to the servers.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Depending on which version of SNA Server you are running one of the
following solutions applies.
<P>
<P><h3>SNA Server 2.1</h3>
 
<P>
When you log on to Windows NT Server using TCP/IP, NetWare IPX/SPX, or
Banyan IP from Windows 3.1 or Windows for Workgroups 3.11 clients, you can
use one of the two WNAP command lines noted below to cache your credentials
and prevent the Domain Login dialog box from appearing when you start WNAP
manually.
<P>
Add an icon in the Windows Startup group for WNAP.EXE (the SNA Windows 3.1
and Windows for Workgroups 3.11 client program) that has the following
command line. This causes WNAP to start automatically when Windows for
Workgroups is started:
<P>
<PRE>   wnap /user: /pwd:

</PRE>NOTE: Do not type a user name and password after /user: and /pwd:,
respectively! There must be no space after the colon in /pwd:; however, a
space after /user: is allowed.
<P>
This command lets you log on to the Windows NT Server using the guest
account (provided that the guest account is enabled and has no password).
<P>
The next command requires that you have a valid account in the Windows NT
SNA Server domain:
<P>
<PRE>   wnap /user:&lt;user_name&gt; /pwd:&lt;password&gt;

</PRE><h3>SNA Server 2.11</h3>
 
<P>
The following additional options are available under SNA 2.11:

<OL><P><LI>You can add the following two new entries to the [WNAP] section of
   the WIN.INI file:
<P>
<P><PRE>      LogonUserName=&lt;user_name&gt;
      LogonPassword=&lt;password&gt;
</PRE><P>
   WNAP parses these entries and uses them when an application is first
   started, reducing the need for starting WNAP manually with command-
   line parameters.
<P>
   Also, to use the guest account using the parameters in WIN.INI, add
   these entries:
<P>
<P><PRE>      LogonUserName=guest
      LogonPassword=
</PRE><P>
   NOTE: Do not include a space after the equal sign (=).

<P><LI>Automate the use of Windows for Workgroups 3.11 cached domain passwords.
<P>
</OL>If the above WIN.INI entries are not present on a Windows for Workgroups
3.11 client, and if you are using the cached domain password feature of
Windows for Workgroups (enabled in the network Control Panel Startup dialog
box by selecting Log On To Windows NT Or LAN Manager Domain), WNAP
automatically retrieves your credentials from Windows for Workgroups when
WNAP starts.
<P>
WNAP starts automatically when an SNA Server application (3270, 5250,
or an application written to the SNA Server APIs) is started, or when
Windows for Workgroups is started (if a WNAP icon is added to the Startup
group).
<P>
NOTE: Your data on SNA Server resources may not be safe if you log off from
Windows for Workgroups without terminating WNAP.
<P>
This is because, by default, WNAP remains running even if you log off from
Windows for Workgroups and then log back on. Therefore, if you log off from
Windows for Workgroups without terminating WNAP and a new user logs on,
then WNAP still has your credentials cached because WNAP only checks the
Windows for Workgroups credentials during WNAP startup. This can become a
security problem because the new user now has access to all your SNA Server
resources.
<P>
To solve this problem, configure WNAP as follows so that it terminates
automatically when you quit the last SNA application:

<OL><P><LI>Add AutoTerminate=Yes to the [WNAP] section of the WIN.INI file.

<P><LI>Start WNAP automatically by starting an SNA application.
<P>
</OL>NOTE: If you start WNAP manually, WNAP does not terminate automatically
when the last SNA application quits, even if AutoTerminate is set to
Yes.
<P>
With some emulators, WNAP terminates when the last connection is
disconnected; with other emulators, you need to quit the emulator. This
behavior depends on how the emulator is implemented. With the SNA Server
applets, the WNAP terminates when you quit the applet.
<P>
NOTE: If your Windows for Workgroups domain password expires, or if you are
required to change your domain password during the next domain logon
attempt, the SNA client logon fails with Error 546.
<P>
To solve this problem, you must log on and change your domain password
first. You may then have to update your SNA client configuration to use
your new password. There is no additional user interaction required when
you use the Windows for Workgroups cached domain password.
<P>
<P><h3>SNA Server MS-DOS Client</h3>
 
<P>
When you use the SNA Server MS-DOS client, you can start the SNABASE.EXE
program as follows:
<P>
<PRE>   snabase /user:&lt;user_name&gt;  /pwd:&lt;password&gt;
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbsetup kbinterop<BR>
KBSubcategory: ntprotocol<BR>
Additional reference words: prodsna 2.00 2.10 2.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 1, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
