

<HTML>
<HEAD>
<TITLE>Server Displays Offline When Link Drops and Recovers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164647">
<META NAME="KBModify" CONTENT="1997/04/14">
<META NAME="KBCreate" CONTENT="1997/03/05">
<META NAME="Keywords" CONTENT="kbbug3.00 kbfix3.00.sp1 snabaseservice snamanager">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  If the network connection between SNA Server Manager and a remote SNA Server service is lost, the SNA Server service shows a status of  Offline.  If the network connection is reestablished within a few minutes, it stays offline until the administra...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACK,QAI5,QBG2,QAYV,QAXB,QAKD,QAH5,QABA,QBVX,QAVZ,QAGU,QAGR,QDO3,QAC1,QACE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Server Displays Offline When Link Drops and Recovers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164647</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the network connection between SNA Server Manager and a remote SNA
Server service is lost, the SNA Server service shows a status of
"Offline." If the network connection is reestablished within a few
minutes, it stays offline until the administrator reopens the SNA
subdomain in the SNA Server Manager.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the network connection between the Manage Client to the Manage Agent
fails, the SnaBase service (which relies upon broadcasts) still considers
the services to be active. If the connection is reconnected before the
SnaBase service frees the services from the services table, the SnaBase
service never sends a service table update to indicate the services have
recovered. Therefore, the network connection is never reestablished. This
may cause the SNA Server Manager to display the SNA Server status as
"Offline."
<P>
<P><h2>RESOLUTION</h2>
 
<P>
An update to SNA Server 3.0 is available to correct this problem. With the
new Manage files, Mngcli.exe will now retry a dropped connection to
Mngagent.exe three times with a two-minute delay between each retry. If
the outage is longer than four minutes (the default setting), SnaBase
detects the recovery and signals Mngagent.exe to try again. If the server
broadcast times are changed to be longer, these times may need to be
adjusted. The value of the retry delay multiplied by the number of retries
should be slightly longer than the server broadcast value multiplied by
four. The server broadcast value, which has a default of 60 seconds, is
configured in the Server Broadcasts folder in the SNA Server Manager, in
the SNA Server properties. The registry entries for adjusting these
settings are:
<P>
<PRE>   HKEY_Local_Machine\Software\Microsoft\SNA Server\Parameters\Manage\
      ConnectRetryLimit: REG_DWORD: &lt;value&gt;

   HKEY_Local_Machine\Software\Microsoft\SNA Server\Parameters\Manage\
      ConnectRetryDelay: REG_DWORD: &lt;value&gt;

</PRE>The updated modules are:
<P>
<PRE>   &lt;Snaroot&gt;\System\Mngagent.exe
   &lt;Snaroot&gt;\System\Mngcli.exe
   &lt;Snaroot&gt;\System\Snamanag.dll

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 3.0.
This problem was corrected in the latest Microsoft SNA Server 3.0 U.S.
Service Pack. For information on obtaining the service pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna sna30<BR>
Keywords            : kbbug3.00 kbfix3.00.sp1 snabaseservice snamanager<BR>
Version             : 3.0<BR>
Platform            : WINNT<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
