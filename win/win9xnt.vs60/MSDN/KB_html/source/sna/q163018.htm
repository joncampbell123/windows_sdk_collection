

<HTML>
<HEAD>
<TITLE>Distributed Link Service Does Not Reactivate Dropped Connection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163018">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="kbbug2.11.sp1 kbfix2.11.sp2 kbnetwork snadls kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  If a connection between a remote SNA Server with a Distributed Link service and a central SNA Server that has the appropriate link service distributed is dropped, the Distributed Link Service does not attempt to reactivate the connection even if th...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACK,QAE2,QBG2,QAI5,QBXA,QBVV,QDO3,QAKP,QAH6,QAXB,QACM,QAH4,QBBI,QAR4,QANN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Distributed Link Service Does Not Reactivate Dropped Connection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163018</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, version 2.11 Service Pack 1 (SP1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a connection between a remote SNA Server with a Distributed Link service
and a central SNA Server that has the appropriate link service distributed
is dropped, the Distributed Link Service does not attempt to reactivate the
connection even if the "Maximum number of attempts" is set to "No Limit" on
the "Connection Activation Limits" tab for that particular connection. In
the SNA Administrator program, you will see the connection dropping to a
status of "Inactive."
<P>
<P><h2>CAUSE</h2>
 
<P>
The SNA Server service was changed in SNA Server 2.11 to stop retrying
connection activations if a link service reports an Open(LINK) failure. The
SNA Server service only tries to reactivate the connection once after this
outage occurs.
<P>
If the Distributed Link service, or the network, is not available at this
time, the SNA Server service stops trying to establish the connection.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<UL><LI>In the SNA Server link service configuration, point to the same remote
   link service twice. For example: \\server\snadlc1; \\server\snadlc1.
   This causes the Distributed Link Service to automatically retry between
   these two remote links if one fails.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem:

<UL><LI>Apply the update to SNA Server 2.11 Service Pack 1 that corrects this
   problem. The updated module is Snaremls.dll. See the Status section
   below for information on how to obtain the update.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 2.11
Service Pack 1 (SP1).
A supported fix is now available for 2.11 SP1 , but has not been fully
regression-tested and should be applied only to systems experiencing this
specific problem. Unless you are severely impacted by this specific
problem, Microsoft recommends that you wait for the next Service Pack that
contains this fix. Contact Microsoft Technical Support for more
information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In the update to SNA Server 2.11 SP1, a new registry value has been added
to cope with Leased Links, which do not make use of the retry parameters.
The new registry value specifies the delay in seconds (with a granularity
of five-second intervals), before the outage message is generated. The
default setting is 20 seconds.
<P>
The registry value is:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Sevices\
   &lt;link_service&gt;\Parameters\ExtraParameters\RetryPeriod (REG_DWORD).

</PRE>With regard to the symptom, here is an example of what you may see with the
SNA Server Data Link Control message trace enabled:
<P>
<PRE>|000000a1.000000a7 DLC    ----------------------------------------------
</PRE>10:45:15.54
<PRE>|000000a1.000000a7 DLC    08160000-&gt;01020300 OPEN  LINK RSP ERROR
|000000a1.000000a7 DLC                       Err:0D0A
</PRE>|000000a1.000000a7 DLC
<PRE>|000000a1.000000a7 DLC    ---- Header  at address 00CC44B4, 2 elements ----
|000000a1.000000a7 DLC    03102700 00890D0A 010004DC 0100A400
</PRE>&lt;..'..i........u.&gt;
|000000a1.000000a7 DLC
<PRE>|000000a1.000000a7 DLC    ---- Element at address 011BD910, start 1, end 92
----
|000000a1.000000a7 DLC    53444C43 31202020 2020534E 41534552     &lt;SDLC1
</PRE>SNASER&gt;
<PRE>|000000a1.000000a7 DLC    56522020 00010101 01C1FF01 7530000A     &lt;VR
</PRE>.....A..u0..&gt;
<PRE>|000000a1.000000a7 DLC    03E80003 03E8FFFF 03E8FFFF 03E8001E
</PRE>&lt;.Y...Y...Y...Y..&gt;
<PRE>|000000a1.000000a7 DLC    7530000A 03E8003C 03E8000F 03E8012C
</PRE>&lt;u0...Y.&lt;.Y...Y.,&gt;
<PRE>|000000a1.000000a7 DLC    00004402 00000000 00000000 00000000
</PRE>&lt;..D.............&gt;
<PRE>|000000a1.000000a7 DLC    00000000 00000000 00000000
&lt;............    &gt;
</PRE>|000000a1.000000a7 DLC
<PRE>|000000a1.000000a7 DLC    ---- Element at address 011BA5BC, start 1, end 1
----
|000000a1.000000a7 DLC    03                                      &lt;.
&gt;

</PRE>In the Application Event Log, this problem is logged as an Information
event with Message ID 77 and is decoded as follows:
<P>
<PRE>   Connection &lt;connection name&gt;   failed to activate due to failure at link
   service.

   Error Code = 0D0A

   EXPLANATION
   The node failed to activate a link service to establish the specified
   connection.

</PRE>The reason for the failure is given by the error code, as follows:
<P>
<PRE>   X'0001' - Hardware initialization failure

   X'0008' - Invalid XID length specified

   X'000A' - Fatal LCC hardware error

   X'000B' - Invalid link index

   X'000C' - Open(Link) has insufficient data

   X'000D' - Link connection timeout

   X'000E' - Maximum connection count reached or internal resources
             exhausted

   X'0011' - Close(Link) received while Open(Link) pending

   X'0012' - Duplicate request

   X'0A11' - X.25 PVC already in use

   X'0AFF' - Duplicate destination MAC/SAP for link service

   X'0D01' - Insufficient memory to locate link service

   X'0D02' - Invalid SNA Server Domain

   X'0D04' - Link Service not found

   X'0D07' - Link Service not found

   X'0D0A' - Unable to open pipe to link service

   X'0D0B' - No room in service table for link service

   X'0D0C' - Remote Server not found or inactive

   X'0D0D' - Link Service not active at remote Server

   X'0D0E' - Link service not available to Distributed Link Service

   X'0D0A' - Unable to open pipe to link service
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna SP1 DLS Outage<BR>
Keywords            : kbbug2.11.sp1 kbfix2.11.sp2 kbnetwork snadls kbbuglist<BR>
Version             : 2.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
