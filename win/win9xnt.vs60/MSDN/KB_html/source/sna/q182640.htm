

<HTML>
<HEAD>
<TITLE>Application Exception in Snaservr.exe in Function SNPUPUTI </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182640">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1998/03/17">
<META NAME="Keywords" CONTENT="prodsna snaserverservice kbbug4.00 snapassthru">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  An SNA Server 4.0 system may experience an application exception in the Snaservr.exe file in function SNPUPUTI when a PU PassThrough connection is configured to use Format 0 XIDs.  When this occurs, a Drwtsn32.log file is generated in the Windows N...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAI5,QAI4,QBG2,QDJ3,QDIZ,QAY5,QAO4,QAJH,QDNG,QAVX,QAVW,QAR4,QDKW,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Application Exception in Snaservr.exe in Function SNPUPUTI</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182640</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An SNA Server 4.0 system may experience an application exception in the
Snaservr.exe file in function SNPUPUTI when a PU PassThrough connection is
configured to use Format 0 XIDs.
<P>
When this occurs, a Drwtsn32.log file is generated in the Windows NT
directory. The Drwtsn32.log file will contain an entry similar to the
following:
<P>
<PRE> Application exception occurred:
    App: snaservr.exe (pid=&lt;process id&gt;)
    When: &lt;date&gt; @ &lt;time&gt;
    Exception number: c0000005 (access violation)

 function: snpuputi
    0100a65a 8d4e06       lea     ecx,[esi+0x6] ds:014aea06=????????
    0100a65d 2bd3         sub     edx,ebx
    0100a65f 0fbfdf       movsx   ebx,di
    0100a662 3bda         cmp     ebx,edx
    0100a664 7e27         jle     snpuputi+0x4d (0100a68d)
    0100a666 85f6         test    esi,esi
    0100a668 7427         jz      snpuputi+0x51 (0100a691)
    0100a66a 668b00       mov     ax,[eax] ds:01d0fff7=0000
    0100a66d 8b36         mov     esi,[esi] ds:00000000=????????
    0100a66f 662b01       sub     ax,[ecx]  ds:01d09d76=0013
fault -&gt;0100a672 0fbf5604 movsx   edx,word ptr [esi+0x4] ds:014aea07=????
    0100a676 0fbf5e06     movsx   ebx,word ptr [esi+0x6] ds:014aea07=????
    0100a67a 8d7c07ff     lea     edi,[edi+eax-0x1] ds:031be9fe=????????
    0100a67e 8d4604       lea     eax,[esi+0x4] ds:014aea06=????????
    0100a681 8d4e06       lea     ecx,[esi+0x6] ds:014aea06=????????
    0100a684 2bda         sub     ebx,edx
    0100a686 0fbfd7       movsx   edx,di
    0100a689 3bd3         cmp     edx,ebx
    0100a68b 7fd9         jg      snpuputi+0x26 (0100a666)
    0100a68d 85f6         test    esi,esi
    0100a68f 750f         jnz     snpuputi+0x60 (0100a6a0)
    0100a691 55           push    ebp

</PRE>*----&gt; Stack Back Trace &lt;----*
<P>
FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4 Function Name
<PRE> 00dafeec 01041647 01d09d70 0000001a 00000901 01180013 snaservr!snpuputi
    (FPO: [EBP 0x01d09d70] [3,0,4])

</PRE>In addition, SNA Server logs an Event 624 in the Windows NT Application
Event log similar to the following:
<P>
<PRE>   Creating dump file C:\SNA\traces\snadump.log for Snaservr.exe

   EXPLANATION
   A process (Snaservr.exe) ended abnormally due to a protection
   violation or similar condition and a dump file Snadump.log has been
   created that contains information about the state of the process at
   the time of the exception. Register information is contained in your
   Windows NT root directory in the file Drwtsn32.log.

</PRE>NOTE: This can only occur when SNA Server is configured to use PU
PassThrough connections and one of these connections is configured to use
Format 0 XIDs in the connection properties under the System Identification
tab.
<P>
<P><h2>CAUSE</h2>
 
<P>
The application exception is caused when SNA Server attempts to forward a
Format 3 XID received on one PU PassThrough connection to its partner PU
PassThrough connection that is configured to use Format 0 XIDs.
<P>
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, configure all PU PassThrough connections to
use Format 3 XIDs.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 4.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
 
<PRE>Keywords          : prodsna snaserverservice kbbug4.00 snapassthru
Version           : WINDOWS:4.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
