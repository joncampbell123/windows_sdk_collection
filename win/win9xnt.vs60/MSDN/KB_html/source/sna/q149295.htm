

<HTML>
<HEAD>
<TITLE>Win 95 SNA Client May Hang on Startup with Anti-cmos Virus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149295">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1996/03/29">
<META NAME="Keywords" CONTENT="ntnetserv snawin95 kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  Infection by the anti-cmos virus can cause the Microsoft Windows 95 SNA client to hang or return the following error message:     No SNA server found in domain.  CAUSE =====  You will get the above error when you start the SNA Server Windows 95 cli...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARL,QAI4,QBFY,QBQ9,QBHJ,QBVX,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Win 95 SNA Client May Hang on Startup with Anti-cmos Virus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149295</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.1, 2.11, and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Infection by the anti-cmos virus can cause the Microsoft Windows 95 SNA
client to hang or return the following error message:
<P>
<PRE>   No SNA server found in domain.

</PRE><h2>CAUSE</h2>
 
<P>
You will get the above error when you start the SNA Server Windows 95
client SNABASE process when it is configured for named pipes over the
NetBEUI transport only, though may occur over other named pipes transports.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Remove the virus from the client computer to resolve this problem.
<P>
<P><h2>More information</h2>
 
<P>
The SNA Server client internal traces and network captures show two
behaviors when you use named pipes over NetBEUI.

<UL><LI>The client makes an IPC$ connection to the SNA Server; it posts a 
   Server Message Block (SMB) Read Request, and then hangs.
<P>
</UL><h3>Sample Network Capture</h3>
 
<P>
<PRE>Frame   Time    Src MAC Addr Dst MAC Addr   Protocol  Description

1       6.010   CLIENT       SERVER         NETBIOS   Session Alive (0x1F)
2       6.210   SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x25
<PRE>3       19.440  CLIENT       *NETBIOS Multi  BROWSER   Host Announcement
</PRE>[0x01] CLIENT
<PRE>4       23.794  SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF0 C N(R) = 0x25 POLL
<PRE>5       23.794  CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x1C FINAL
<PRE>6       48.279  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>7       48.280  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>8       48.500  CLIENT       SERVER          SMB       C tree connect &amp; X,
</PRE>Share = \\SERVER\IPC$
<PRE>9       48.501  SERVER       CLIENT          SMB       R tree connect &amp; X,
</PRE>Type = IPC
<PRE>10      48.502  CLIENT       SERVER          SMB       C open &amp; X, File =
</PRE>\PIPE\COMNAP (RW -Share Deny None)
<PRE>11      48.504  SERVER       CLIENT          SMB       R open &amp; X, FID =
</PRE>0x1812
<PRE>12      48.504  CLIENT       SERVER          SMB       C transact
</PRE>SetNmPHandState, FID = 0x1812
<PRE>13      48.506  SERVER       CLIENT          SMB       R transact
14      48.510  CLIENT       SERVER          SMB       C write &amp; X, FID =
</PRE>0x1812, Write 0xb4 at 0x00000000
<PRE>15      48.511  SERVER       CLIENT          SMB       R write &amp; X, Wrote
0xb4
16      48.512  CLIENT       SERVER          SMB       C read &amp; X, FID =
</PRE>0x1812, Read 0x800 at 0x00000000
<PRE>17      48.547  SERVER       CLIENT          NETBIOS   Data Ack (0x14): LSN
</PRE>= 0x17, RSN = 0x09
<PRE>18      48.896  CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x21
<PRE>19      56.504  CLIENT       SERVER          NETBIOS   Session Alive (0x1F)
20      56.668  SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x2B
<PRE>21      79.869  SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF0 C N(R) = 0x2B POLL
<PRE>22      79.870  CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x21 FINAL
<PRE>23      108.001 CLIENT       SERVER          NETBIOS   Session Alive (0x1F)
24      108.197 SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x2C
<PRE>25      111.912 SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF0 C N(R) = 0x2C POLL
<PRE>26      111.912 CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x21 FINAL
<PRE>27      143.956 SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF0 C N(R) = 0x2C POLL
<PRE>28      143.956 CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x21 FINAL
<PRE>29      159.484 CLIENT       SERVER          NETBIOS   Session Alive (0x1F)

</PRE><LI>If the Local Domain option is selected, the SNA client repeats the
   mailslot broadcast, but does not appear to see the SNA Server's
   response.
<P>
</UL><h3>Sample Network Capture</h3>
 
<P>
<PRE>Frame   Time    Src MAC Addr   Dst MAC Addr   Protocol  Description

1       2.750   CLIENT       SERVER          NETBIOS   Session Alive (0x1F)
2       2.943   SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x33
<PRE>3       24.311  SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF0 C N(R) = 0x33 POLL
<PRE>4       24.311  CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x27 FINAL
<PRE>5       53.876  CLIENT       SERVER          NETBIOS   Session Alive (0x1F)
6       54.071  SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x34
<PRE>7       56.354  SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF0 C N(R) = 0x34 POLL
<PRE>8       56.355  CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x27 FINAL
<PRE>9       63.122  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>10      63.123  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>11      68.392  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>12      68.393  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>13      73.666  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>14      73.667  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>15      78.939  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>16      78.940  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>17      84.212  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>18      84.213  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>19      88.397  SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF0 C N(R) = 0x34 POLL
<PRE>20      88.397  CLIENT       SERVER          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x27 FINAL
<PRE>21      89.485  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>22      89.486  CLIENT       *NETBIOS Multi  SMB       C transact, File =
</PRE>\MAILSLOT\SNADMOD
<PRE>23      105.331 CLIENT       SERVER          NETBIOS   Session Alive (0x1F)
24      105.530 SERVER       CLIENT          LLC       RR DSAP=0xF0
</PRE>SSAP=0xF1 R N(R) = 0x35
<P>
The client's other network connections are unaffected. The anti-cmos virus
is a boot sector virus. Because of the nature of viruses, it is not
possible to know with any accuracy what part of the system this virus
affects or the true identity of the virus.
<P>
It has also been reported that the FORM_A virus
may cause the same results as listed above.  In each case,
running a virus program will resolve the problem.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna win95<BR>
Keywords          : ntnetserv snawin95 kbusage<BR>
Version           : 2.1 2.11 3.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
