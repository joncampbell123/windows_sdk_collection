

<HTML>
<HEAD>
<TITLE>Windows 95 Hangs at Hourglass Starting SNA Server Win 3.x App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135237">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1995/08/17">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork ntnetserv ntprotocol snawin3x snawin95">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  The SNA Server Windows 3.x client software is supported on Windows 95. However, if the SNA Server client software is configured to use the  Microsoft Networking (named pipes)  interface and Windows 95 is configured with Microsoft IPX/SPX-compatible...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QBWS,QARL,QBXS,QAUJ,QBTX,QAIJ,QBE7,QBE6,QBBS,QAGI,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 95 Hangs at Hourglass Starting SNA Server Win 3.x App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135237</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, 2.11, and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The SNA Server Windows 3.x client software is supported on Windows 95.
However, if the SNA Server client software is configured to use the
"Microsoft Networking (named pipes)" interface and Windows 95 is configured
with Microsoft IPX/SPX-compatible protocol (the default), starting an SNA
Server Windows 3.x client application will cause Windows 95 to hang with an
hourglass.
<P>
At that point, you must enter CTRL+ALT+DEL to bring up the Windows 95 Close
Program dialog, highlight the task named "SNA Server (Not responding)",
choose "End Task", and confirm the selection by choosing "End Task" again.
<P>
This causes the Windows 95 hourglass to disappear and the SNA Server
Windows 3.x client process, WNAP.EXE, is stopped  After that, the SNA
Server Windows 3.x application can be stopped using the "End Task" option.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the SNA Server Windows 3.x client software is configured to use the
named pipes interface, the SNA Server client software always posts a
DosReadAsyncNmPipe API call on the named pipe. This causes a Read request
to always be posted to the server. While the Read request is outstanding,
the SNA client software also may write data down the named pipe as well, so
the SNA client makes use of the full-duplex nature of the named pipe API,
supported over any LAN protocol provided by Windows 95 (that is, NetBEUI,
IPX/SPX, TCP/IP, RAS, etc).
<P>
However, if the Microsoft IPX/SPX-compatible transport is installed and the
"direct-host" feature is enabled on Windows 95, this network interface only
allows a single command to be outstanding on the client-server LAN session
(that is, this only provides a half-duplex communication channel to the
server). So, the SNA Server client named pipe interface does not work
properly.
<P>
To contrast, Windows 95 file and print redirection and SQL Server named
pipe clients do work over "direct-host" IPX/SPX connections because only a
single command is outstanding at a time (that is, the DosReadAsyncNmPipe
call is not used).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Any of the following three workarounds can be used to resolve this problem:

<UL><LI>If you wish to keep the Microsoft IPX/SPX Compatible protocol installed,
   the IPX/SPX NetBIOS interface must be enabled and the directhost feature
   must be disabled (see below for instructions),
<P>
   To enable the NWLINK NetBIOS interface:
<P>
   1. Click the Start button, point to Settings, and click Control Panel.
<P><PRE>      The Control Panel folder opens.
</PRE><P>
   2. Double-click Network.
<P><PRE>      The Network dialog box appears.
</PRE><P>
   3. Select IPX/SPX-Compatible Protocol Properties, then choose the
<P><PRE>      Properties button. The IPX/SPX-Compatible Protocol Properties dialog
      box appears.
</PRE><P>
   4. Choose (check) the I Want To Enable NetBIOS Over IPX/SPX check box.
<P><PRE>      and choose OK.
</PRE><P>
   This change will take effect when you next start Windows 95.
<P>
   To disable the IPX/SPX DirectHost feature:
<P>
   1. Click the Start button, then click on Run.
<P><PRE>      The Run dialog box appears.
</PRE><P>
   2. Type "regedit" and choose OK.
<P><PRE>      Registry Editor starts.
</PRE><P>
   3. Open (click on the + next to) HKEY_LOCAL_MACHINE, then open System,
<P><PRE>      CurrentControlSet, Services, and then finally open VxD.
</PRE><P>
   4. Select VNETSUP.
<P>
   5. From the Edit menu, select New, then choose String Value.
<P><PRE>      A new value appears in the right pane.
</PRE><P>
   6. If necessary, right click on the new item and choose Rename from
<P><PRE>      the context menu. Type DirectHost and press ENTER.
</PRE><P>
   7. Right click on DirectHost and choose Modify.
<P><PRE>      The Edit String dialog appears.
</PRE><P>
   8. Type 0 (zero) and choose OK.
<P>
   9. Click on Registry then Exit to end the Registry Editor.
<P>
   This change will take effect when you next start Windows 95
<P>
   -or-

<LI>Keep the SNA Server named pipes interface enabled, remove the Microsoft
   IPX/SPX-compatible transport and install a different Microsoft transport
   (such as NetBEUI or TCP/IP) using the Windows 95 network control panel.
<P>
   -or-

<LI>Configure the SNA Server Windows 3.x client software to use an interface
   other than named pipes, by running the SNA Server client setup program
   installed in the SNA Server client program group.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna Win95 directhost<BR>
hang<BR>
Keywords            : kbinterop kbnetwork ntnetserv ntprotocol snawin3x snawin95<BR>
Version             : 2.0 2.1 2.11 3.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
