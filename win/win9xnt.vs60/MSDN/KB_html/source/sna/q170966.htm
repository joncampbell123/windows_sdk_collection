

<HTML>
<HEAD>
<TITLE>TEST/XID Retries not Configurable for DLC Connections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170966">
<META NAME="KBModify" CONTENT="1997/12/03">
<META NAME="KBCreate" CONTENT="1997/07/02">
<META NAME="Keywords" CONTENT="prodsna snadlc kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When SNA Server tries to activate an 802.2 DLC connection, LLC TEST frames  are sent to the remote network address to initiate the link level connection.  If the remote station is not replying to the TEST frames, a network trace  will show that SNA...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAGI,QAIB,QAIA,QACK,QAKC,QAE2,QBVV,QBC6,QAVZ,QBV8,QAB9,QBG2,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>TEST/XID Retries not Configurable for DLC Connections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170966</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, version 2.0, 2.1, 2.11, 3.0, and 3.0 SP1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When SNA Server tries to activate an 802.2 DLC connection, LLC TEST frames 
are sent to the remote network address to initiate the link level connection. 
If the remote station is not replying to the TEST frames, a network trace 
will show that SNA Server continues to send additional TEST frames. Each time 
the SNA Server service submits an Open(Link) Request to the 802.2 DLC Link 
Service, it generates TEST frames to test the connection.
<P>
For additional information on how SNA Server initiates 802.2 DLC connections, 
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sna/q123791.htm">Q123791</A></B>
   TITLE     : SNA Server Remote Station Discovery Process

</PRE>SNA Server does not provide a way to control the number of TEST frames that 
are sent for each Open(Link) Request sent to the link service. There is also 
no way to control the retry interval between each TEST command.
<P>
SNA Server uses the same algorithm for XID retries, so the number of XID 
retries equals the number of TEST frame retries per Open(Link) Request. 
<P>
<P><h2>CAUSE</h2>
 
<P>
The number of TEST and XID command retries per Open(Link) Request is 
hardcoded for the 802.2 DLC link service. The retry interval is also 
hardcoded. When an Open(Link) Request is submitted to the link service, a 
local TEST command is sent out on the local network segment. If SNA Server 
does not receive a reply to the local TEST command within 0.5 seconds, it 
sends an all-routes broadcast TEST command. The link service will send a 
total of three all-routes broadcast TEST commands if the remote station it 
not responding. The retry interval between the all-routes broadcast TEST 
commands is 15 seconds. This sequence is repeated for each Open(Link) 
Request that the 802.2 DLC Link Service receives from the SNA Server 
service.
<P>
The following is network trace captured using Microsoft's Network Monitor 
that shows the sequence of TEST commands for one Open(Link) Request:
<P>
<PRE>   Frame  Time    Source  Dest  Protocol  Description   

   1      0.000   Server  Host  LLC       TEST DSAP=0x00 SSAP=0x04 C POLL                                                                    
   2      0.001   Server  Host  SNA       SNA Packet: Req:(FMD)(SD)                                                                          
   3      0.731   Server  Host  LLC       TEST DSAP=0x00 SSAP=0x04 C POLL                                                                    
   4      0.000   Server  Host  SNA       SNA Packet: Req:(FMD)(SD)                                                                          
   5      18.893  Server  Host  LLC       TEST DSAP=0x00 SSAP=0x04 C POLL                                                                    
   6      0.000   Server  Host  SNA       SNA Packet: Req:(FMD)(SD)                                                                          
   7      18.892  Server  Host  LLC       TEST DSAP=0x00 SSAP=0x04 C POLL                                                                    
   8      0.000   Server  Host  SNA       SNA Packet: Req:(FMD)(SD)   

</PRE>Note: This trace was taken on an Ethernet network. By default, SNA Server 
sends TEST and XID frames to both the configured remote network address 
and the bit-flipped address (for Ethernet 802.2 connections only), in both 
DIX and 802.3 formats. This is discussed in greater details in the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sna/q123791.htm">Q123791</A></B>
   TITLE: SNA Server Remote Station Discovery Process

</PRE>Frames 2, 4, 6, and 8 in the sample trace are the TEST commands sent in the 
Ethernet DIX format. The other frames are sent using the 802.3 frame format. 
<P>
If this sample trace had been taken on a Token Ring network, it would have the 
"all-routes broadcast" setting specified for the TEST commands in frames 3, 5, 
and 7. Ethernet does not contain any source-routing information, therefore the 
"all-routes broadcast" setting does not exist. 
<P>
A trace that captures the XID frames sent by the SNA Server will show the same 
number of retries and retry intervals as it does for TEST frames.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The 802.2 DLC Link Service for SNA Server has been updated to allow the number 
of retries and the retry interval to be configured for TEST and XID commands. 
In addition, the following registry entries have to be added to change the 
number of retries and the retry interval for the TEST and XID commands:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\&lt;SNADLCx&gt;\Parameters
   \ExtraParameters

   Value Name: TestTimeout 
      &lt;- Used to specify the local TEST/XID timeout in seconds.
   Data Type: REG_DWORD
   Data: &lt;1 - 127 (decimal)&gt;  

   Value Name: XidTimeout
      &lt;- Used to specify the all-routes broadcast TEST/XID timeout in seconds.
   Data Type: REG_DWORD
   Data: &lt;1 - 127 (decimal)&gt;   

   Value Name: TestRetries
      &lt;- Used to specify the number of TEST/XID retries.
   Data Type: REG_DWORD
   Data: &lt;0 - 254 (decimal)&gt;     

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 2.0,
2.1, 2.11 (all SPs), 3.0, and 3.0 SP1. A supported fix is now available, but 
has not been fully regression-tested and should be applied only to systems 
experiencing this specific problem. Unless you are severely impacted by this 
specific problem, Microsoft recommends that you wait for the next Service 
Pack that contains this fix. Contact Microsoft Product Support Services for 
more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : prodsna snadlc kbbuglist<BR>
Version           : 2.0 2.1 2.11 3.0 3.0sp1<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
