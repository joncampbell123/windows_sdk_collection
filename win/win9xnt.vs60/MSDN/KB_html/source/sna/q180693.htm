

<HTML>
<HEAD>
<TITLE>IPX Clients Fail to Obtain A Sponsor Connection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180693">
<META NAME="KBModify" CONTENT="1998/02/09">
<META NAME="KBCreate" CONTENT="1998/02/06">
<META NAME="Keywords" CONTENT="kbbug3.00 kbbug3.00.sp1 prodsna snabaseservice snawin95 snawinnt kbbug3.00.sp2 kbbuglis">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  After upgrading an SNA Server 2.11 Windows NT or Windows 95 client  workstation (attached via Netware IPX/SPX) to SNA Server 3.0, 3.0 Service  Pack 1 (SP1) or SP2, the workstation may fail to obtain a sponsor  connection to an SNA Server.  CAUSE ==...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARL,QDO3,QBWP,QA5E,QDL9,QBWQ,QBWO,QBWN,QBG2,QAR4,QAI5,QBVX,QA63,QAM1,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>IPX Clients Fail to Obtain A Sponsor Connection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180693</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 3.0, 3.0SP1, 3.0SP2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After upgrading an SNA Server 2.11 Windows NT or Windows 95 client 
workstation (attached via Netware IPX/SPX) to SNA Server 3.0, 3.0 Service 
Pack 1 (SP1) or SP2, the workstation may fail to obtain a sponsor 
connection to an SNA Server.
<P>
<P><h2>CAUSE</h2>
 
<P>
An SNA Server 3.0 Windows NT or Windows 95 client may issue a Get General 
Server query in an attempt to locate a sponsor SNA server. When the client 
workstation receives the query reply, it will attempt to contact the first 
server in the list that is provided. The client will then create an IPX 
connection to the remote server and query the bindery for the address of 
the sponsor server. In certain situations, possibly due to SAP filtering 
strategies, the remote bindery based server will not have the IPX address 
and SAP type (0x444) registered for the intended SNA Server and the 
connection attempt will fail.
<P>
<P><h2>STATUS</h2>
 
<P>
A correction has been made to the SNA Server client IPX interface 
(SNANCP.DLL) which forces the SNA IPX client to query with a Get Nearest 
Server request first before attempting to use a Get General Server query. 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 3.0, 
3.0 SP1, and 3.0 SP2. 
<P>
A supported fix is now available for SNA 3.0, but has not been fully 
regression tested and should be applied only to systems experiencing this 
specific problem. Unless you are severely impacted by this specific 
problem, Microsoft recommends that you wait for the next Service Pack 
that contains this fix. Contact Microsoft Product Support Services for 
more information.
<P>
This problem is fixed in the original retail release of SNA Server 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With this SNA Server client update applied, the following registry entry 
can be used to force the client to use only Get General Server queries if 
required. It also works with SNA Server version 4.0.
<P>
For Windows NT Clients
 
<P>
<PRE> Subtree:   HKEY_LOCAL_MACHINE
 Key:       \SYSTEM\CurrentControlSet\Services\SnaBase\Parameters\SnaSpx
 Type:      REG_SZ
 Value:     UseGeneralQuery=YES

</PRE>For Windows 95 Clients
 
<P>
<PRE> Subtree:   HKEY_LOCAL_MACHINE
 Key:       \SOFTWARE\Microsoft\SnaBase\Parameters\SnaSpx
 Type:      REG_SZ
 Value:     UseGeneralQuery=YES
</PRE> 
<PRE>Keywords          : kbbug3.00 kbbug3.00.sp1 prodsna snabaseservice snawin95 snawinnt kbbug3.00.sp2 kbbuglist
Version           : WINDOWS:3.0,3.0SP1,3.0SP2
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
