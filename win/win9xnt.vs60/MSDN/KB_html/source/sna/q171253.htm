

<HTML>
<HEAD>
<TITLE>Twinax Connections Fail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171253">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/07/10">
<META NAME="Keywords" CONTENT="snatwinax kbfix3.00.sp2 kbnetwork kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  A twinaxial connection goes to an Active state in SNA Server Manager after the connection is started, but users are unable to get active APPC sessions on an AS/400 through the twinaxial connection.  The System Operator Log (QSYSOPR) on the AS/400 m...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QAUR,QDO3,QAGU,QAU7,QAPN,QAGI,QBWS,QDIZ,QAKP,QAAP,QAEV,QAC1,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Twinax Connections Fail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171253</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 3.0 and 3.0 Service Pack 1 (SP1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A twinaxial connection goes to an Active state in SNA Server Manager after
the connection is started, but users are unable to get active APPC sessions
on an AS/400 through the twinaxial connection.
<P>
The System Operator Log (QSYSOPR) on the AS/400 may contain a message
similar to the following after the twinaxial connection on the SNA Server
is activated:
<P>
<PRE>   Message ID: CPI6002
   Message: Error detected during TDLC automatic configuration.
   Cause: Your session has ended because of an error found during the
   automatic configuration by twinaxial data link control (TDLC) for device
   &lt;device name&gt;. The device has been varied off.

</PRE>NOTE: The System Operator Log on the AS/400 can be accessed by entering the
following command on an AS/400 command prompt:
<P>
<PRE>   DSPMSG QSYSOPR

</PRE>The following event may also be logged in the Windows NT Application Event
Log on the SNA Server computer:
<P>
<PRE>   Event ID: 96
   Description: Local APPC TP start failed:

      Primary_rc = F004
      Secondary_rc = 010000F0
      TP name = &lt;name of TP&gt;

</PRE>This problem does not occur when you upgrade SNA Server 2.11 to SNA Server
3.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem is caused by the way SNA Server 3.0 saves the twinaxial
connection properties in the SNA Server configuration. The twinaxial
connection is saved as a Peer connection, as are all other connections to
AS/400s. The problem is that twinaxial connections are not saved with all
of the connection properties that other Peer connections include, such as
Peer DLC Role and XID Type.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<UL><LI>Install SNA Server 2.11 and then upgrade to SNA Server 3.0 after getting
   the twinaxial connection to work under SNA Server 2.11.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 3.0 and
3.0 Service Pack 1 (SP1). This problem was corrected in the latest SNA 
Server version 3.0 U.S. Service Pack. For information on obtaining this 
Service Pack, query on the following word in the Microsoft Knowledge Base 
(without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE>After you apply the updated binary file, do the following so the twinaxial
connection will successfully connect to the AS/400:

<OL><P><LI>Stop and restart the SnaBase service.

<P><LI>Save the SNA Server configuration. If the Save option is greyed out in
   SNA Server Manager, some kind of change will need to be made in the
   configuration before the configuration can be saved.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The problem is that twinaxial connections are not saved with all
of the connection properties that other Peer connections include, such as
Peer DLC Role and XID Type. This results in an incorrect sequence when
activating a twinaxial connection, as shown below:
<P>
<PRE>   SNA Server                Twinax Link Service
   ----------                -------------------
   Open Link Request   --&gt;
                      &lt;--    Open Link RSP OK
   Open Stat Request   --&gt;
                      &lt;--    Open Stat RSP OK
                      &lt;--    DLCST STCD
                      &lt;--    DLCST RQOS
   DLCST SXID          --&gt;
                      &lt;--    DLCST RQOS

</PRE></OL>In this sequence, the XID negotiation, shown as SXID and RQOS messages, is
done after the Station Contacted (DLCST STCD) message.
<P>
The correct sequence when activating a Peer connection is shown below:
<P>
<PRE>   SNA Server                Twinax Link Service
   ----------                -------------------
   Open Link Request   --&gt;
                      &lt;--    Open Link RSP OK
                      &lt;--    DLCST RQOS
   DLCST SXID          --&gt;
                      &lt;--    DLCST RQOS
   DLCST SXID          --&gt;
                      &lt;--    DLCST RQOS
  Open Stat Request    --&gt;
                      &lt;--    Open Stat RSP OK
                      &lt;--    DLCST STCD

</PRE>In the correct sequence, the XID negotiation occurs before the Open Station
(Open Stat) and Station Contacted messages.
<P>
SNA Server has been updated to correctly save the twinaxial connection with
all of the Peer connection properties and to do the XID negotiation before
it does the Open Station sequence.
<P>
In addition, the Twinaxial connection properties page will be updated to
include a System Identification page. This page will include configuration
options for the Local Node Name, Remote Node Name, XID Type, and Peer DLC
Role.
 
<PRE>Keywords          : snatwinax kbfix3.00.sp2 kbnetwork kbbuglist
Version           : 3.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
