

<HTML>
<HEAD>
<TITLE>No Load Balancing When You Invoke Many APPC Conversations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148618">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/03/15">
<META NAME="Keywords" CONTENT="kbbug2.11 kbfix2.11.sp2 kbnetwork ntnetserv">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  LU6.2 load balancing problems have been observed under two conditions:  1) When a single program allocates multiple conversations:  If an APPC or CPIC program allocates multiple conversations at the same time on an SNA Server client or server and S...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJZ,QBGP,QAIJ,QAKU,QAH4,QDO3,QAR4,QBVX,QAI8,QDIZ,QDIV,QBWP,QACJ,QDJ3,QA4F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>No Load Balancing When You Invoke Many APPC Conversations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148618</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, 2.11 and
   2.11 Service Pack 1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
LU6.2 load balancing problems have been observed under two conditions:
<P>
1) When a single program allocates multiple conversations:
<P>
If an APPC or CPIC program allocates multiple conversations at the same
time on an SNA Server client or server and SNA Server is configured to
support LU6.2 load balancing, the conversations may not load evenly
across more than one SNA Server.
<P>
For example, if a program tries to allocate 16 concurrent conversations
across two SNA Servers, which are configured to support 10 sessions each,
the program may allocate 10 conversations through the first server and two
conversations through the second server. The remaining four conversations
are queued against the first server.
<P>
2) When multiple APPC or CPIC programs allocate conversations at once:
<P>
For example, if multiple programs are started and each tries to allocate
one conversation, where two SNA Servers are available, sessions tend to
be allocated from only one SNA Server.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the LU6.2 sessions are not activated before the
application attempts to allocate the conversations.
<P>
When an APPC or CPIC application allocates a conversation, the SNA Server
APPC interface attempts to locate an appropriate, available LU6.2 session
on any SNA Server running in the domain or subdomain. It selects a server
that has an active LU6.2 session before it tries to select a server that
has an inactive LU6.2 session.
<P>
If multiple conversations are allocated at the same time by a program, the
APPC interface does not randomly select between servers if they all start
LU6.2 sessions. This can cause multiple conversation startup requests to be
queued against a single SNA Server rather than load balancing across
multiple SNA Servers.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem:

<OL><P><LI>Configure the SNA Server and the APPC or CPIC program to support LU6.2
   load balancing. Ensure that the configuration is correct. For additional
   information, please see the following article in the Microsoft Knowledge
   Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../sna/q128244.htm">Q128244</A></B>
<PRE></PRE>      TITLE     : SNA Server Load Balancing and Hot Backup

</PRE><P><LI>Start the LU6.2 session before the application starts. LU6.2 sessions
   can start automatically by setting the "autoactivation limit" in the
   SNA Server APPC Mode entry (on SNA Server Admin) to the number of
   sessions.
<P>
   If automatic LU6.2 session startup is not acceptable, an update to the
   SNA Server APPC interface is available to improve load balancing
   (WAPPC32.DLL for Windows NT and Windows 95 clients, and WINAPPC.DLL for
   Windows 3.x clients).

<P><LI>Configure extra LU6.2 sessions on each SNA Server so that the SNA Server
   APPC random server selection locates a server with an available LU6.2
   session.
<P>
   For example, if an application allocates 16 concurrent conversations
   against two SNA Servers, each SNA Server should support at least 10
   sessions each. If you configure each server to support only eight
   sessions, some conversations may still be queued against a server that
   has all LU6.2 sessions in use.
<P>
</OL>To correct this problem, apply the fix mentioned below.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server 2.11 and SNA
Server 2.11 Service Pack 1.
This problem was corrected in the latest Microsoft SNA Server 2.11 U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbbug2.11 kbfix2.11.sp2 kbnetwork ntnetserv<BR>
Version             : 2.0 2.1 2.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
