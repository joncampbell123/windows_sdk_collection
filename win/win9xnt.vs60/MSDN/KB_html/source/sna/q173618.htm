

<HTML>
<HEAD>
<TITLE>Windows 95 Client Trap in SnaBase Using IPX on Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173618">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/09/09">
<META NAME="Keywords" CONTENT="snaipx snawin95 kbfix3.00.sp2 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  The SNA Windows 95 client gets an application exception in SnaBase when all of the following conditions are met:   - The SNA Windows 95 client is installed on a Windows NT system.   - The SNA Windows 95 client is configured to use IPX/SPX as the   ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWQ,QDO3,QARL,QDL9,QBWO,QBWN,QAO4,QDNF,QAGI,QAJH,QAKP,QDJ3,QDIZ,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 95 Client Trap in SnaBase Using IPX on Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173618</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, version 3.0 Service Pack 1 (SP1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SNA Windows 95 client gets an application exception in SnaBase when all
of the following conditions are met:

<UL><LI>The SNA Windows 95 client is installed on a Windows NT system.

<LI>The SNA Windows 95 client is configured to use IPX/SPX as the
<P><PRE>    transport protocol.
</PRE>
<LI>The SNA Windows 95 client is configured with a client mode of Remote
   and the sponsor servers are listed by server name.

<LI>The SNA Windows 95 client is configured to use bindery emulation
   to locate the SNA Server computers.
<P>
</UL>The application exception in Snabase.exe will generate a Drwtsn32.log file
in the Windows NT root directory that will be similar to the following:
<P>
<PRE>   Application exception occurred:
      App: exe\snabase.DBG (pid=&lt;process id #&gt;)
      When: &lt;date&gt; @ &lt;time&gt;
      Exception number: c0000005 (access violation)

</PRE>In addition, the Windows NT Application Event Log will contain an event
similar to the following when this problem occurs:
<P>
<PRE>   Event ID: 4097
   Source: DrWatson
   Description: The application, exe\snabase.DBG, generated an application
   exception error.
   The error occurred on &lt;date&gt; @ &lt;time&gt;. The exception generated was
   c0000005 at
   address 00000000 (&lt;no symbols&gt;).

</PRE><h2>CAUSE</h2>
 
<P>
Service Pack 1 for SNA Server 3.0 added a new feature that allows the
integration of SNA Server with Novell's NDS (NetWare Directory Service).
This problem was introduced as a result of the NDS changes that were made
to the SNA Windows 95 client for SP1. Specifically, the InitNDS() function
does not clear the SNANDS32 module handle after the GetNdsTreeAndContext()
call failed causing the NdsFindSnaServer() function to call a NULL pointer.
The application exception in snabase.exe occurs when the NULL pointer is
called.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<UL><LI>Configure the SNA Windows 95 client with a client mode of Local and use
   the SNA Subdomain name to locate the SNA Server computers.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the SNA Windows 95 client
version 3.0 Service Pack 1 (SP1). This problem was corrected in the 
latest SNA Server version 3.0 U.S. Service Pack. For information on 
obtaining this Service Pack, query on the following word in the Microsoft 
Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE> 
<PRE>Keywords          : snaipx snawin95 kbfix3.00.sp2 kbnetwork
Version           : win95:3.0
Platform          : Win95
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
