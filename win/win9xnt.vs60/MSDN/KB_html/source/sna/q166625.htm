

<HTML>
<HEAD>
<TITLE>Host Print Service Stops Responding After Invalid SCS Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166625">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/04/08">
<META NAME="Keywords" CONTENT="snaprintservice kbfix3.00.sp2 kbnetwork kbprint">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  A 3270 print session gets stuck in a spooling state when an invalid SCS control code is sent to the host print service. SNA Server Manager is slow to respond to requests when this problem occurs.  The Windows NT Application Event Log logs an Event ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAH4,QACK,QDO3,QA7O,QAGB,QDN1,QAO4,QAOE,QAMN,QAB5,QAKP,QBWP,QBVV,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Host Print Service Stops Responding After Invalid SCS Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166625</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 3.0 and 3.0 Service Pack 1 (SP1)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A 3270 print session gets stuck in a spooling state when an invalid
SCS control code is sent to the host print service. SNA Server Manager
is slow to respond to requests when this problem occurs.
<P>
The Windows NT Application Event Log logs an Event 21, similar to
the following:
<P>
<PRE>   Event ID: 21
   Source: SNA Server
   Description: (1124) Negative Response Sent on Connection &lt;connection
   name&gt;
                        (SENSE = 1005)

</PRE>When you stop the SNA Server host print service, the system returns to its
normal responsiveness.
<P>
<P><h2>CAUSE</h2>
 
<P>
The SNA Server host print service does not correctly reset an error field
after an invalid SCS control code is received from the host. This causes
the print service to get into a loop that prevents print jobs from
completing and may cause the system's responsiveness to slow, especially in
SNA Server Manager.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 3.0 and
3.0 Service Pack 1 (SP1). This problem was corrected in the latest SNA 
Server version 3.0 U.S. Service Pack. For information on obtaining this 
Service Pack, query on the following word in the Microsoft Knowledge Base 
(without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Print service internal traces that are captured when this problem occurs
may include data similar to the following:
<P>
<PRE>   INTRN SNAP-3270   S3PR1DAT            HPBYTE                  43
   INTRN SNAP-3270   S3PR1DAT            START OF SHF/SVF/SLD
   INTRN SNAP-3270   S3PR1DAT            CONTINUE
   INTRN SNAP-3270   S3PR1DAT            HPORDER                 2
   INTRN SNAP-3270   S3PR1DAT            PRTDSTRT                2872
   INTRN SNAP-3270   S3PR1DAT            HPBYTE                  131
   INTRN SNAP-3270   S3PR1DAT            SHF/SVF/SLD 2ND BYTE    83
   INTRN SNAP-3270   S3PR1DAT            EXIT
   INTRN SNAP-3270   S3PRDSCS           SCS DATASTREAM ERROR
   INTRN SNAP-3270   S3PRDSCS           EXIT
   INTRN SNAP-3270   S3PRRSCS           ENTRY

</PRE>With the fix applied, the SNA Server host print service correctly handles
invalid SCS control codes; the print service does not get into the loop
that causes it to stop responding. The updated print service prints
everything contained in the print job up to the invalid SCS control code.
After the invalid SCS control code, the print service notifies the printer
that the print job is finished.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: LU1 3287<BR>
Keywords          : snaprintservice kbfix3.00.sp2 kbnetwork kbprint<BR>
Version           : winnt:3.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
