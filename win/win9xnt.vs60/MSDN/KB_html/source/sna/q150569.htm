

<HTML>
<HEAD>
<TITLE>Stardata TSR on Win3.x Client Causes SNABase Service to Loop </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150569">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/05/02">
<META NAME="Keywords" CONTENT="kbbug2.00 kbbug2.10 kbbug2.11 kbnetwork sna3rdparty snatp snawin3x">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  SNABase service will reach approximately 100% CPU utilization in Performance Monitor and all SNA Server clients connected to this SNA Server will be disconnected.  CAUSE =====  A badly written application running on a Windows 3.x computer overwrite...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QACK,QAC1,QBD2,QARL,QDO3,QBWP,QBE7,QBE6,QAA5,QDIX,QBVV,QAH7,QAHE,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Stardata TSR on Win3.x Client Causes SNABase Service to Loop</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150569</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, and
   2.11 Service Pack 1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SNABase service will reach approximately 100% CPU utilization in
Performance Monitor and all SNA Server clients connected to this SNA Server
will be disconnected.
<P>
<P><h2>CAUSE</h2>
 
<P>
A badly written application running on a Windows 3.x computer overwrites
the memory address occupied by the SNA Server Win3.x client-server
interface DLL files. If the bad application hits a particular code segment
(owned by the SNA Server components), it will cause SNA Server Win3.x
client-server interface to send a bogus service table update to the SNA
Server with the bad application's data. This causes the SNABase service
running on the SNA Server to reach approximately 100% CPU utilization.
<P>
NOTE: Service table updates will normally flow from an SNA Server Win3.x
client only when the client is configured to support the registration of an
APPC invokable TP.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
A fix was made to SNA Server:

<UL><LI>To cause verbose validity checking on any incoming service table update
</UL>(msgtype 07); only the expected service table updates will be processed.
<P>
<PRE>   In addition, the following application event will be logged when SNA
   Server receives a bad service table update from a client:

      631 - Invalid message received across the LAN.

</PRE><LI>To ignore any incoming service table update.
<P>
</UL>To cause SNA Server to ignore all incoming service table updates, set the
following parameter:
<P>
\hkey_local_machine
<PRE>  \system
    \current_control_set
          \Services
            \SNABase\
              \parameters: IgnoreClientUpdates:REG_DWORD:1

</PRE>If this parameter has any non-zero value, the SNABase will ignore all
client updates.
<P>
It will also log event 709 when it receives one.
<P>
NOTE: If this parameter is set up to ignore all incoming service table
updates, a SNA Server Windows NT client running SNA Admin will not be able
to administer the domain. Therefore, it is recommended that you not set
this for IgnoreClientUpdates unless it is determined that verbose validity
checking is not preventing the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SNA Server
versions 2.0, 2.10, 2.11, and 2.11.sp1.
This problem was corrected in the latest Microsoft SNA Server 2.11 U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbbug2.00 kbbug2.10 kbbug2.11 kbnetwork sna3rdparty snatp snawin3x<BR>
Version             : 2.0 2.1 2.11 2.11.sp1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
