

<HTML>
<HEAD>
<TITLE>SNA Server Event 686 When Using MS-DOS Client with ODI Stack </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155555">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/08/30">
<META NAME="Keywords" CONTENT="kbbug2.11.sp1 kbfix2.11.sp2 kbnetwork snados">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  If you use the SNA Server MS-DOS Client using Novell's ODI IPX/SPX protocol stack and the SNA Server DOS router to communicate with an AS/400, then SNA Server will log the following event prior to creating an SNA Server Dump file and Dr. Watson log...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO4,QDO3,QBCF,QARL,QAPN,QDMH,QBWP,QBAD,QATO,QAR4,QAAP,QAIB,QAIA,QBVX,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server Event 686 When Using MS-DOS Client with ODI Stack</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155555</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, 2.11, and
   2.11 Service Pack 1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the SNA Server MS-DOS Client using Novell's ODI IPX/SPX protocol
stack and the SNA Server DOS router to communicate with an AS/400, then SNA
Server will log the following event prior to creating an SNA Server Dump
file and Dr. Watson log:
<P>
Event 686 SNA server Internal Buffer pool error.
<PRE>   Reason = invalid owner id
   Mdule = snabase. exe
   Process = 132
   Pool = trustedelts
   details = current 9Eh expected 15EAh

</PRE>When you view the Dr. Watson log, there are faults logged against two
services.
<P>
Application exception occurred:
<PRE>   App: snaservr.DBG (pid=150)
   When: 3/18/1996 @ 19:10:9.145
   Exception number: c0000005 (access violation)

</PRE>Application exception occurred:
<PRE>   App: snabase.DBG (pid=132)
   When: 4/13/1996 @ 12:43:53.762
   Exception number: 80000003 (hardcoded breakpoint)

</PRE><h2>CAUSE</h2>
 
<P>
The trap in SNASERVR.EXE occurs when the SNA Server buffer pool becomes
corrupted. In this case, the corruption occurs because the client is
sending a 10-byte frame to the SNA Server when it was expecting a 47-byte
frame. Because the incoming frame was smaller than expected, SNA Server
fills it in with zeroes or EBCDIC spaces that cause the buffer pool to
become corrupted. The trap in SNABASE.EXE results because of the preceding
trap in SNASERVR.EXE.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The IPX/SPX transport now verifies that the incoming message length is
valid. If the length is invalid, the message is ignored and an event 631 is
logged. Microsoft has updated the &lt;snaroot&gt;\snanw.dll file on both the SNA
Server and the client to correct this problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SNA Server
version 2.11.sp1.
This problem was corrected in the latest Microsoft SNA Server 2.11 U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sp1 prodsna<BR>
Keywords            : kbbug2.11.sp1 kbfix2.11.sp2 kbnetwork snados<BR>
Version             : 2.0 2.1 2.11 2.11.sp1<BR>
Platform            : NT WINDOWS<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
