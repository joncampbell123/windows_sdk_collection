

<HTML>
<HEAD>
<TITLE>TPs Can't Be Invoked On Windows 95/NT Clients if One TP Ends </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180537">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1998/02/04">
<META NAME="Keywords" CONTENT="kbbug2.00 kbbug2.10 kbbug2.11 kbbug2.11.sp1 kbbug2.11.sp2 kbbug3.00 kbbug3.00.sp1 snaap">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  If multiple instances of the same invokable APPC/CPI-C TP are running on a SNA Server Client for Windows 95 or Windows NT, the active TPs cannot be invoked if one instance of the TP ends for any reason.  SNA Server will log the following event in t...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDO3,QARL,QDL9,QBWQ,QBWO,QBWN,QAXB,QAR4,QADX,QAEF,QACK,QAO4,QAEV,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>TPs Can't Be Invoked On Windows 95/NT Clients if One TP Ends</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180537</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server, versions 2.0, 2.1, 2.11, 2.11SP1, 2.11SP2, 3.0,
   3.0SP1, 3.0SP2, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If multiple instances of the same invokable APPC/CPI-C TP are running on a
SNA Server Client for Windows 95 or Windows NT, the active TPs cannot be
invoked if one instance of the TP ends for any reason.
<P>
SNA Server will log the following event in the Windows NT Application
Event Log when attempting to invoke one of the remaining active TPs on the
Windows 95 or Windows NT client:
<P>
<PRE>   Event ID: 60
   Source: SNA Server
   Description: Failed to invoke APPC TP &lt;TP Name&gt;, sense data = 084C0000

</PRE>The 084C0000 refers to AP_TRANS_PGM_NOT_AVAIL_NO_RETRY.
<P>
<P><h2>CAUSE</h2>
 
<P>
When an invokable APPC TP is started on a client, SnaBase sends an update
message to the client's sponsor SNA Server. The SNA Server adds the TP to
its local service table; this entry is used for routing incoming DLOAD
messages to the client. When the TP ends, the client SnaBase sends another
update message to the sponsor server asking the SNA Server to remove the TP
from its service table. These messages, both add and remove, are sent for
each instance of the TP running on the client. The SNA Server only keeps
one instance of the TP in its service table no matter how many instances
are running on the client. When one instance of the TPs ends, the SNA
Server marks the TP listed in the service table as inactive, which means
none of the other TPs on the client can be invoked by the partner TP.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server version 2.0,
2.1, 2.11, 2.11 SP1, 3.0, 3.0 SP1, and 4.0.
<P>
Microsoft has also confirmed this to be a problem in SNA Server version
2.11 SP2 and 3.0 SP2.
A supported fix is now available for SNA Server 2.11 SP2 and 3.0 post-SP2,
but has not been fully regression tested and should be applied only to
systems experiencing this specific problem. Unless you are severely
impacted by this specific problem, Microsoft recommends that you wait for
the next Service Pack that contains this fix. Contact Microsoft Technical
Support for more information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With the fix applied, the SNA Server Clients for Windows 95 and Windows NT
are updated so that the update message to remove a TP from the service
table on the SNA Server is only sent after the last instance of the TP
ends.
<P>
NOTE: There are other possible causes for this event, which are not related
to this particular issue. For additional information, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../sna/q166623.htm">Q166623</A></B>
   Title     : SNA Server Rejects FMH-5 Attach Intended for TP on NT Client

   Article-ID: <B><A href="../sna/q170071.htm">Q170071</A></B>
   Title     : Invokable TP Timeout May Occur with Non-queued Operation
</PRE> 
<PRE>Keywords          : kbbug2.00 kbbug2.10 kbbug2.11 kbbug2.11.sp1 kbbug2.11.sp2 kbbug3.00 kbbug3.00.sp1 snaappc snacpic snaprog snatp snawin95 snawinnt kbbug3.00.sp2 kbbug4.00 kbnetwork
Version           : WINDOWS:2.0,2.1,2.11,2.11SP1,2.11SP2,3.0,3.0SP1,3.0SP2,4.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
