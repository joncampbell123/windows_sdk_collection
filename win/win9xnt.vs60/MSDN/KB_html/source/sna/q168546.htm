

<HTML>
<HEAD>
<TITLE>Access Violation May Occur After Upgrading to 3.0 SP1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168546">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="snabaseservice kbfix3.00.sp2 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  After upgrading SNA Server 3.0 with Service Pack 1, the SnaBase or SNA Server service may fail unexpectedly with an access violation or SNA Server may unexpectedly stop accepting new client connections. This problem can occur if SNA clients are con...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QBWP,QAI5,QARL,QAO4,QA1S,QAKP,QAJ4,QAR4,QAAP,QDN9,QAAD,QBGA,QACK,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Access Violation May Occur After Upgrading to 3.0 SP1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168546</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, version 3.0 Service Pack 1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After upgrading SNA Server 3.0 with Service Pack 1, the SnaBase or
SNA Server service may fail unexpectedly with an access violation
or SNA Server may unexpectedly stop accepting new client connections.
This problem can occur if SNA clients are connecting to the server
over MS Networking (named pipes) or Netware IPX/SPX. A Drwtsn32.log
entry may be generated when this failure occurs, indicating a FAULT
in the top-level routine along with the following stack-back trace
(which may vary):
<P>
<PRE>   - snalm!QueueBuffer

</PRE>or
<P>
<PRE>   - ntdll!RtlAllocateHeap
    snalm!GetReadBuffer
    snalm!AceptConnection
    snadmod!AcceptClientConnection
    snadmod!DMODServiceThread

</PRE>or
<P>
<PRE>  - ntdll!RtlDestroyHeap
    ntdll!RtlFreeHeap
    snalm!CleanupConnection
    snalm!CloseConnection
    snadmod!CloseLtab
    snadmod!IoThread

  or

   - security!NtLmSspControl
    security!DeleteSecurityContext
    snalm!CleanupSecurityContext
    snalm!CloseConnection
    snadmod!sepdnhpe

</PRE>If new clients cannot connect, the SNA Server or SnaBase internal trace
may indicate the following error after accepting a new client connection:
<P>
<PRE>   ACCPT HeapAlloc failed, rc 0

</PRE><h2>CAUSE</h2>
 
<P>
SnaBase or SNA Server memory local heap corruption is occurring within
the IO completion port handling of named pipe or IPX/SPX clients.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The SNA Server has been updated to correct this problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT SNA Server
version 3.0 Server Pack 1. This problem was corrected in the latest SNA 
Server version 3.0 U.S. Service Pack. For information on obtaining this 
Service Pack, query on the following word in the Microsoft Knowledge Base 
(without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbbug<BR>
KBSubcategory: prodsna snabaseservice<BR>
Keywords          : snabaseservice kbfix3.00.sp2 kbnetwork<BR>
Version           : 3.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
