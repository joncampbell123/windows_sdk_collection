

<HTML>
<HEAD>
<TITLE>SNA Server and 802.2 Connection Timers (t1, t2, ti) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129786">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1995/05/04">
<META NAME="Keywords" CONTENT="kbnetwork kbusage ntconfig nthowto ntprotocol snadlc">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  By default, the SNA Server Admin program sets the t1, t2 and ti timers on all 802.2 connections to a value of  Default . This article describes the actual timer values used by SNA Server when this default setting is configured, as well the various ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATK,QACE,QBWP,QAKD,QABA,QAKC,QAVE,QAI5,QBG2,QAH6,QANN,QAE2,QBXS,QBC6,QBAO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server and 802.2 Connection Timers (t1, t2, ti)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129786</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.0, 2.1, 2.11 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default, the SNA Server Admin program sets the t1, t2 and ti timers on
all 802.2 connections to a value of "Default". This article describes the
actual timer values used by SNA Server when this default setting is
configured, as well the various DLC timers and default settings.
<P>
Tuning the SNA Server 802.2 connection and/or DLC timers may be necessary
if 802.2 connections are dropping due to timeout problems. A timeout may
be occurring if SNA Server logs Event 23, Qualifier = AE or AF within the
Windows NT application event log. However, a network monitor or sniffer
trace would be necessary to confirm if a timeout problem is occurring (as
opposed to an underlying network or bridge/router problem).
<P>
If an SNA Server 802.2 connection timer is changed, the change will take
effect when the SNA Server service is stopped and restarted.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>DLC Timer Parameters</h3>
 
<P>
The following information describes various DLC timer parameters and how
DLC timer values are calculated.
<P>
The DLC class II protocol uses three timers:
<P>
<PRE>   t1 - Response timer
   t2 - Acknowledgment timer
   ti - Inactivity timer

</PRE>The timer values are specified in timer ticks. Each timer requires a short
timer tick (xxTickOne, where xx is t1, t2, or ti) and long timer tick
(xxTickTwo, where xx is t1, t2 or ti). The length of these timer ticks are
specified within the Windows NT DLC Transport driver (in the registry) in
40 millisecond increments.
<P>
The actual length of each timer (t1, t2, ti) is selected with parameters
provided by the DLC application (SNA Server in this case) when the
DLC_OPEN_SAP, DLC_OPEN_STATION, or DLC_MODIFY commands are issued. In these
commands, the timer value is selected with a number between 1 and 10. If
the number is between 1 and 5, the short timer tick (xxTickOne) is used.
The timer value is equal to the selected number multiplied by the short
timer tick value:
<P>
<PRE>   timer value = selected number * xxTickOne * 40ms

</PRE>If the selected number is between 6 and 10, the long timer tick (xxTickTwo)
is used. In this case the timer value is equal to the selected number minus
5 multiplied by the long timer tick value.
<P>
<PRE>   timer value = (selected number - 5) * xxTickTwo * 40ms

</PRE>The response timer (t1) is used to detect a failure to receive an
acknowledgment or a response from the remote link station.
<P>
The link station starts t1 when it transmits either an Information
(I-frame) or Supervisory (S-frame, such as a RR/RNR/REJ) with the poll bit
set. The t1 will be reset when the station receives a response frame with
the final bit set. If t1 expires, the link station sends an S-frame with
the poll bit set in order to query the status of the remote link station.
The link station then restarts t1. If there is no recovery after the
specified number of retries, the link station assumes that the link is
inoperative and disconnects the link.
<P>
The duration of t1 must take into account any delays introduced by the
source routing bridges or routers separating SNA Server and the remote
system.
<P>
The link station uses the acknowledgment timer (t2) to delay the sending of
an acknowledgment for a received I-frame. The t2 timer is started when a
link station receives an I-frame. The t2 timer is reset when a link station
sends an acknowledgment in an I-frame or in an S-frame. If the t2 expires,
the link station must send an acknowledgment as soon as possible.
<P>
The value of t2 must be less than the value of t1 of the remote station.
This ensures that the remote link station will receive the acknowledgment
before its response timer expires.
<P>
The inactivity timer (ti) is used to detect an inoperative condition in the
remote link station or in the transmission medium. If a station does not
receive any S- or I-frames before its ti expires, it must query the status
of the remote link station with an S-frame with the poll bit set. If it
does not get a response after specified number of retries, it disconnects
the link.
<P>
<P><h3>SNA Server and 802.2 Connection Timers</h3>
 
<P>
When an SNA Server 802.2 connection is activated, SNA Server sends a TEST
frame to the remote network address configured for the connection.
<P>
On Token Ring, the local ring is tried first. If there is no response to
the TEST frame, SNA Server resends the TEST frame with the "all routes
broadcast" setting enabled which is then forwarded by source routing
bridges. If there is source routing data present in the TEST frame response
from the remote system, then long tick timers are used on the connection.
Otherwise, short tick timers are used.
<P>
On Ethernet, since there is no source routing data, the short tick timers
are always used.
<P>
Here are the short tick and long tick timers used by SNA Server:
<P>
<PRE>   Parameter   Short Tick Timer   Long Tick Timer
   ---------   ----------------   ---------------
   t1          2                  7
   t2          2                  6
   ti          5                  10

</PRE>These multiplier values are used in conjunction with Windows NT Data Link
Control transport settings to calculate the actual timer value used on the
connection. The Windows NT DLC transport is configured with the following
default timer values:
<P>
<PRE>   t1TickOne = 5
   t1TickTwo = 25   (hex = 0x19)
   t2TickOne = 1
   tT2TickTwo = 10   (hex = 0xa)
   tiTickOne = 25   (hex = 0x19)
   tiTickTwo = 125  (hex = 0x7d)

   NOTE: These values are defined in the HKEY_LOCAL_MACHINE subtree of the
   registry in the  \SYSTEM
                      \CurrentControlSet
                        \Services
                          \DLC
                            \Parameters
                              \&lt;network_adapter&gt; directory.

   WARNING: Using the Registry Editor incorrectly can cause serious,
   system-wide problems that may require you to reinstall Windows NT to
   correct them. Microsoft cannot guarantee that any problems resulting
   from the use of the Registry Editor can be solved. Use this tool at your
   own risk.

</PRE>These default settings yield the following timeout periods:
<P>
If SNA Server is connecting to the remote system over Ethernet or Token
Ring where no source routing bridges are involved, then short tick timers
are used, giving the following default timer settings:
<P>
<PRE>  t1 timer = 2 * 5  * 40ms = 400ms  (.4 seconds)
  t2 timer = 2 * 1  * 40ms = 80ms   (.08 seconds)
  ti timer = 5 * 25 * 40ms = 5000ms (5 seconds)

</PRE>If SNA Server is connecting to the remote system over Token Ring across
source routing bridges, then long tick timers are used, giving the
following default timer settings:
<P>
<PRE>  t1 timer = (7-5)  *  25 * 40ms = 2000ms  (2 seconds)
  t2 timer = (6-5)  *  10 * 40ms = 400ms   (.4 seconds)
  ti timer = (10-5) * 125 * 40ms = 25000ms (25 seconds)

</PRE>The SNA Server ti, t2 and ti timers can be manually set for each
connection. The maximum value of each timer is 10, which yields the
following timeout periods:
<P>
<PRE>  t1 timer = (10-5) *  25 * 40ms = 5000ms  (5 seconds)
  t2 timer = (10-5) *  10 * 40ms = 2000ms  (2 seconds)
  ti timer = (10-5) * 125 * 40ms = 25000ms (25 seconds)

</PRE>To increase these timers further, the DLC transport timer settings must be
increased within the registry. However, caution should be taken before
changing these settings.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbnetwork kbusage ntconfig nthowto ntprotocol snadlc<BR>
Version             : 2.0 2.1 2.11 3.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
