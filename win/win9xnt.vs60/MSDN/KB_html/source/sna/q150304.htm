

<HTML>
<HEAD>
<TITLE>SNA Server Admin Application Exception When Use Banyan Vines </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150304">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/04/25">
<META NAME="Keywords" CONTENT="kbbug2.00 kbbug2.10 kbbug2.11 kbbug2.11.sp1 kbnetserv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  When you exit the SNA Server Admin, you may get an application exception if the SNA Server is installed on a Microsoft Windows NT Server running the Banyan Vines version 5.56(30) redirector. The application exception is similar to the following:   ...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAGB,QAO4,QAJH,QBC9,QBC8,QANO,QBWP,QAPN,QAAP,QAKP,QAC1,QA2O,QABA,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Server Admin Application Exception When Use Banyan Vines</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150304</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
- Microsoft SNA Server for Windows NT, versions 2.1, 2.11, and
<PRE>  2.11 Service Pack
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you exit the SNA Server Admin, you may get an application exception if
the SNA Server is installed on a Microsoft Windows NT Server running the
Banyan Vines version 5.56(30) redirector. The application exception is
similar to the following:
<P>
<PRE>   snaadmin.exe - application error

   The instruction at "0x77f8d637" referenced memory at "0x00000010".
   The memory could not be "written".

   Click OK to terminate the application.

</PRE>In addition, SNA Server logs the following message in the Application
Event log:
<P>
<PRE>   Event ID: 560
   Source: SNA Base Service
   Description: Read from mailslot failed, rc = 165

</PRE><h2>CAUSE</h2>
 
<P>
The application exception occurs when SNA Server Admin tries to close a
Vines socket from the Client/Server interface's detach entry point.
<P>
The Event 560 message is caused because the 5.56(30) version of the Banyan
Vines redirector returns a different error code on the VnsSocketReceive()
API than earlier versions when the socket is closed.
<P>
These two problems did not occur with previous versions of the Banyan Vines
redirector.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Snadmod.dll and Snabv.dll have been updated so that the Vines socket is
closed before the Client/Server interface's detach entry point is called.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 2.1,
2.11, and 2.11.sp1.
This problem was corrected in the latest Microsoft SNA Server 2.11 U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna trap drwtsn32<BR>
Keywords            : kbbug2.00 kbbug2.10 kbbug2.11 kbbug2.11.sp1 kbnetserv kbnetwork<BR>
Version             : 2.1 2.11 2.11.sp1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
