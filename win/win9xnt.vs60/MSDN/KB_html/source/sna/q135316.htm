

<HTML>
<HEAD>
<TITLE>Support for Sending User ID on Attach when AP_SAME Specified </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135316">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1995/08/20">
<META NAME="Keywords" CONTENT="kbbug2.11 ntnetserv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  In response to customer requests, Microsoft created an update for SNA Server that allows APPC applications to automatically send the logged on user ID in the LU6.2 attach message, when setting the security parameter to AP_SAME. Prior to this enhanc...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAGU,QA4H,QDL9,QBWQ,QBWO,QBWN,QDO3,QBXS,QAAD,QABA,QAGI,QBBI,QBAO,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Support for Sending User ID on Attach when AP_SAME Specified</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135316</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 2.11 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In response to customer requests, Microsoft created an update for SNA
Server that allows APPC applications to automatically send the logged on
user ID in the LU6.2 attach message, when setting the security parameter to
AP_SAME. Prior to this enhancement to SNA Server, setting the AP_SAME
option would only transmit the USER_ID field when the program had been
previously invoked with conversation security by another APPC program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This enhancement to the APPC API allows an invoking transaction program to
use the current logged-on Windows NT user ID as the user ID for APPC
Conversation Level security. To enable this feature:

<OL><P><LI>The invoking TP must set the security parameter in the [MC_]ALLOCATE
   verb control block to AP_SAME.

<P><LI> The following registry setting, or WIN.INI [WNAP] setting for Windows
<P><PRE>     3.x must be enabled:
</PRE><P>
<P><PRE>    If SNA Server 2.11 SP2 or SNA Server 3.0 (any service pack) is being used:
</PRE><P>
<P><PRE>    Windows NT or Windows 95:
</PRE><P>
<P><PRE>    HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services/SnaBase
<PRE></PRE>                      /Parameters/Client/

          AP_SAMENosUser: REG_SZ: YES

    Windows 3.x:

          AP_SAMENosUser = YES

    If SNA Server 2.11 SP1 is being used, the following registry key is 
    used instead (in the same registry key above):

          UnverifiedAP_SAME: REG_DWORD: 0x1

    or, for Windows 3.x, UnverifiedAP_SAME = YES

</PRE></OL>When this enhancement is used, the [MC_]Allocate causes an Attach request
to be transmitted containing the logged-on user ID and the Already Verified
indicator. No password is transmitted in this case. If the invoking
transaction program was itself invoked with an APPC user ID, that user ID,
not the Windows NT one, is used.
<P>
NOTE: For a CPIC application to take advantage of this new feature, the
"UnverifiedAP_SAME" setting in WIN.INI or Windows NT registry must be
configured as documented above. The CPIC application must specify the
CM_SECURITY_SAME option in the Set_Conversation_Security_Type (cmscst)
call.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has updated the Windows NT client file WAPPC32.DLL, and the
Windows 3.x client files, WINAPPC.DLL and WNAP.EXE, to correct this
problem. Make sure that "UnverifiedAP_SAME" (or UnverifiedAP_SAME) is 
set as mentioned above.
<P>
<P><h2>STATUS</h2>
 
<P>
This feature is included in the latest U.S. Service Pack for SNA Server
for Windows NT, version 2.11. For information on obtaining the Service 
Pack, query on the following word in the Microsoft Knowledge Base 
(without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>REFERENCE</h2>
 
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sna/q163015.htm">Q163015</A></B>
   TITLE     : Use of "Already Verified" APPC Security from Invoking TPs
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords          : kbbug2.11 ntnetserv kbnetwork<BR>
Version           : 2.0 2.1 2.11<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
