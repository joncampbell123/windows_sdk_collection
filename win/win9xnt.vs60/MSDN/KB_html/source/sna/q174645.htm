

<HTML>
<HEAD>
<TITLE>SNA Manager Fails With Access Violation in MFC40!Ordinal1375 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174645">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/10/02">
<META NAME="Keywords" CONTENT="kbbug3.00 kbbug3.00.sp1 prodsna snabanyan snamanager snatn3270 kbfix3.00.sp2">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  The SNA Server Manager program (SNAEXP.EXE) fails with an access  violation after it's started.  This failure may start occurring after  a preceding failure in the TN3270 service, and may continue to occur  until the SNA Server being administered i...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBFY,QAKP,QDO3,QAO4,QAGU,QAH5,QA1S,QBW7,QAXB,QAI5,QAIJ,QAJ6,QAC1,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SNA Manager Fails With Access Violation in MFC40!Ordinal1375</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174645</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, versions 3.0 and 3.0 SP1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SNA Server Manager program (SNAEXP.EXE) fails with an access 
violation after it's started.  This failure may start occurring after 
a preceding failure in the TN3270 service, and may continue to occur 
until the SNA Server being administered is restarted.
<P>
When the failure occurs, the following entry may be logged in the
&lt;ntroot&gt;\DRWTSN32.LOG file:
<P>
<PRE>   Application exception occurred:
        App: exe\snaexp.DBG &lt;process ID&gt;
        Exception number: c0000005 (access violation)

   [...]

</PRE>State Dump for Thread Id 0x11b
<P>
eax=0000000a ebx=00327880 ecx=0000004c edx=ffffffff esi=0000004c edi=0000004c
<PRE>eip=762b32db esp=0012fdb4 ebp=0012fdb8 iopl=0         nv up ei pl zr na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246

</PRE>function: Ordinal1375
<PRE>        762b32d5 55               push    ebp
        762b32d6 8bec             mov     ebp,esp
        762b32d8 56               push    esi
        762b32d9 8bf1             mov     esi,ecx
FAULT -&gt;762b32db 8b09             mov     ecx,[ecx]    ds:0000004c=????????

</PRE>*----&gt; Stack Back Trace &lt;----*
<P>
FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
0012fdb8 762b328e 0000000a 0000004c 04860160 762b32ce mfc40!Ordinal1375
0012fe10 6098b207 0012fe20 ffffffff 00325274 0000002b mfc40!Ordinal1421
0012fe2c 6098b0e9 00311600 003155d0 00000000 6108ff7d mngbase!CNotifyQueue::Dispatch
0012fe3c 6108ff7d ffffffff 65026bef 6502f9d7 00000000 mngbase!CNotifyQueue::ProcessWait
0012fe44 65026bef 6502f9d7 00000000 00000000 762b9d2f snaadmin!CRootItem::ProcessQueue 
0012fe48 6502f9d7 00000000 00000000 762b9d2f 000f006c snaole!CSnaApplication::DoVerb  
0012fe70 01014173 00315600 00000000 00000000 01015c20 snaole!CSnaObject::XSnaObject::DoVerb 
0012fe80 01015c20 00000000 00000000 762b304e 00000000 snaexp!CSnaOleObj::DoVerb 
0012fe8c 762b304e 00000000 010250f8 00000000 0012feb8 snaexp!CSnaDoc::OnIdle
0012fea0 762b2bd0 00000001 010250f8 00000001 003116e0 mfc40!Ordinal4162
0012feb8 01007dbd 00000000 010250f8 762be30d 00000000 mfc40!Ordinal4165
0012fec4 762be30d 00000000 0012fefc 010250f8 010250f8 snaexp!CExporerApp::OnIdle  
0012fedc 0100779c 762be2ca ffffffff 762bd2b1 77f7e3ac mfc40!Ordinal5054
01001f0c 01006e80 01006980 01006990 010069a0 0101ebcc snaexp!CExporerApp::InitInstance 
<P>
If the MFC40.DBG symbol file is installed on the Windows NT computer, the 
failing routine is reported to be MFC40!CString__AllocBeforeWrite.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem can occur when the SNA Server Manager program receives 
TN3270 status information for an LU name that is invalid or does 
not exist in the configuration file. The exact reproduction scenario
for this problem is not known.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
An update to SNAADMIN.DLL is available to correct this problem. With
this update applied, the SNA Server Manager now checks for this 
condition and avoids using a bad pointer which can lead to an access 
violation.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SNA Server versions 3.0 and 
3.0 SP1. This problem was corrected in the latest SNA Server for Windows NT 
version 3.0 U.S. Service Pack. For information on obtaining the Service Pack, 
query on the following word in the Microsoft Knowledge Base (without the 
spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : kbbug3.00 kbbug3.00.sp1 prodsna snabanyan snamanager snatn3270 kbfix3.00.sp2<BR>
Version           : 3.0 3.0.SP1<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
