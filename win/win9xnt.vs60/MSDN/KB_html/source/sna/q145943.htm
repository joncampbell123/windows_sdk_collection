

<HTML>
<HEAD>
<TITLE>How To Set Up ODBC Connectivity To An AS/400 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145943">
<META NAME="KBModify" CONTENT="1997/04/17">
<META NAME="KBCreate" CONTENT="1996/02/12">
<META NAME="Keywords" CONTENT="kbnetwork ntnetserv">
<META NAME="KBArea" CONTENT="Support; KB; sna">
<META NAME="Description" CONTENT="  Microsoft SNA Server 2.11 includes the StarSQL ODBC/DRDA drivers for Windows 3.x and Windows NT client computers. The drivers allow applications that are designed to use the ODBC interface and SQL access to databases on IBM host computers and AS/40...">
<META NAME="Product" CONTENT="SNA Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QA9E,QBWP,QAZV,QAUJ,QDI2,QAI5,QBWD,QAPN,QAU9,QASR,QAK6,QBW7,QAGU,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Set Up ODBC Connectivity To An AS/400</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT versions 2.11 and
   2.11 Service Pack 1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft SNA Server 2.11 includes the StarSQL ODBC/DRDA drivers for
Windows 3.x and Windows NT client computers. The drivers allow applications
that are designed to use the ODBC interface and SQL access to databases on
IBM host computers and AS/400 without a host-based database gateway.
<P>
NOTE: SNA Server 2.11 and SNA Server 2.11 Service Pack 1 include a single
license of the StarSQL ODBC/DRDA driver. Therefore, the driver can only be
used on a single client computer. If you want to install the driver on
multiple client computers, make sure you have a valid SNA Server Client
Access License (CAL). You can purchase additional licenses for the
ODBC/DRDA driver from StarWare at (510) 704-2000.
<P>
The SNA Server 2.11 includes the following informational ODBC files:
<P>
<PRE>   ADVOPTS.TXT
   APPLICS.TXT
   DBSMVS.TXT
   HINTS.TXT
   README.TXT

</PRE>SNA Server 2.11 Service Pack 1 includes the following ODBC files:
<P>
<PRE>   ADVOPTS.TXT
   APPLICS.TXT
   AS400.TXT
   CMNSRVR.TXT
   HINTS.TXT
   JAPANESE.TXT
   README.TXT

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The configuration procedure of ODBC connection to an AS/400 varies. It
depends on the StarSQL driver and OS/400 version on the AS/400. The
following information is in AS400.TXT:
<P>
<P><h3>One Time Setup for StarSQL to AS/400</h3>
 
<P>
The following instructions detail the latest setup procedure for StarSQL on
an IBM AS/400. On v3r05 &amp; earlier all steps must be carried out by a user
with QSECOFR authority or the equivalent. Please read all instructions
carefully and take special note of Isolation Level considerations and of
differences between installation procedures for OS/400 v3r1 and OS/400
v3r05 &amp; earlier.
<P>
StarSQL v1.05 and later:
<P>
Upon successful completion the user should be able to access all physical
files (journaled and non-journaled) on an AS/400 running any version of
OS/400.
<P>
StarSQL pre-v1.05:
<P>
Upon successful completion the user should be able to access all physical
files (journaled and non-journaled) on an AS/400 running OS/400 v3r1.
<P>
NOTE: For access to journaled physical files on OS/400 v3r05 and earlier,
follow StarSQL instructions for creating a datasource which uses
collections (see "CREATING COLLECTION ON THE AS/400" IN "HINTS.TXT").
<P>
Begin Installation:

<OL><P><LI>Create a new library (using a 5250 terminal session) where the SQL
   packages used by StarSQL will be created. This library does not need to
   be a SQL collection, but it should be accessible to all StarSQL users.
<P>
   Example:
<P>
   Create a new library STARSQL:
<P>
<P><PRE>      CRTLIB STARSQL
</PRE>
<P><LI>Determine the RDB (Relational Database) name of the AS/400, creating an
   entry if one does not already exist. This name will be used in Step 2
   for the "Database Server Name" in StarSQL data source setup.
<P>
   From the AS/400 command line, work with Relational Database Directory
   Entries by typing:
<P>
<P><PRE>      WRKRDBDIRE
</PRE><P>
   Look for an entry with the value of Remote Location set to *LOCAL. If
   such an entry does not exist, create it with the 1=Add option. A
   suggested convention is to use the same name as the AS/400 system name.

<P><LI>Create a new StarSQL data source through Control Panel | ODBC
   Administrator and specify:
<P>
   Database Server Name= &lt;Database Server Name&gt; (specified in Step 2)
   Catalog Qualifier = QSYS (v3r01 and earlier) or QSYS2 (v3r1)
   Package Collection = &lt;library&gt; (created in Step 1)
<P>
   Example:
   Create a StarSQL data source:
<P>
   (v3r05 &amp; earlier)
   Catalog Qualifier = QSYS
   Package Collection = STARSQL
<P>
   (v3r1)
   Catalog Qualifier=QSYS2
   Package Collection=STARSQL
<P>
   IMPORTANT NOTE:
<P>
   Using QSYS or QSYS2 in the Catalog Qualifier field will cause the
   StarSQL driver to return a list of all physical files on the AS/400. If
   there are a large number of tables on the AS/400 you may want to use the
   filtering capability available in StarSQL version 1.04.19.19 or later.
   This will allow users to filter the table and view names returned when
   you retrieve a list of available tables (views and physical files) to
   what is available in a single AS/400 collection or library.
<P>
   To filter table and view names returned from the list, change the
   Catalog Qualifier to QSYS.library_name (v3r05 &amp; before) or
   QSYS2.library_name (v3r1).
<P>
   MSSNA 2.11 RELEASE CUSTOMERS:
<P>
   The above filtering option is not available with the version of StarSQL
   that is included in the Microsoft SNA 2.11 Release.

<P><LI>Connect to the AS/400 using the data source specified in Step 2. When
   you connect to the AS/400, SQL packages are created in the library
   specified in the data source. These packages are named QSYS and either
   SWRC0000, SWRU0000 or SWNC0000 (depending on the isolation level used).
   Creation of the packages may take several minutes.

<P><LI>Grant *USE authority to PUBLIC on the packages that were created Step 4
   using one of the following methods:
<P>
   a) From the AS/400 command line:
<P>
<P><PRE>      WRKLIB STARSQL
      12  (work with objects)
      2  (edit authority on each object one at a time)
      change PUBLIC *EXCLUDE to PUBLIC *USE
</PRE><P>
   b) Use the GRTOBJAUT command (using a 5250 terminal session) to grant
<P><PRE>      *USE authority for the library and execute authority for the packages
      to all StarSQL users.
</PRE><P>
<P><PRE>      Example:
</PRE><P>
<P><PRE>      GRTOBJAUT OBJ(STARSQL) OBJTYPE(*LIB) USER(*PUBLIC) AUT(*USE)
      GRTOBJAUT OBJ(STARSQL/*ALL) OBJTYPE(*ALL) USER(*PUBLIC)
      AUT(*USE)
</PRE><P>
   c) Use SQL/400 or SQL commands sent from an ODBC-enabled application:
<P>
<P><PRE>      GRANT EXECUTE ON PACKAGE STARSQL/QSYS, STARSQL/SWRC0000 TO
      PUBLIC
</PRE><P>
</OL>ACCESSING NON-JOURNALED PHYSICAL FILES ON OS/400 V3R1 (PRE-STARSQL V1.05):
<P>
To access non-journaled physical files on OS/400 v3r1, edit
WINDOWS\ODBC.INI (16 bit) or NT Registry (32 bit). Add the following to the
StarSQL data source description:
<P>
<PRE>   IsolationLevel=0

</PRE></OL>Example:
<P>
For WINDOWS or WFW (16bit):
<P>
[STARSQL]
Driver=C:\WINDOWS\SYSTEM\swodbc16.dll
Description=example for v3r1
Server=RDBELLE
CatQual=QSYS2
PkgColId=STARSQL
Netlib=SWWAPPC.DLL
ReadOnly=No
LocalLU=SISYPHUS
RemoteLU=ELLE
ModeName=QPCSUPP
AutoTypDefNam=QTDSQL400
AutoTypDefOvr=37,0,0
UID=PETER
IsolationLevel=0
<P>
For Windows NT (32 bit):
<P>
The NT registry is found in WINNT35\SYSTEM32\REGEDT32.EXE. To edit data
sources go to HKEY_CURRENT_USER on Local Machine Go to SOFTWARE | ODBC |
ODBC.INI | &lt;data source name&gt;. Highlight the appropriate StarSQL data
source name. To add IsolationLevel:
<P>
Go to EDIT | Add Value. Enter  "IsolationLevel" with a Data Type of REG_SZ
Select OK then enter and add the appropriate number (0) for the Value.
<P>
The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsna<BR>
Keywords            : kbnetwork ntnetserv<BR>
Version             : 2.0 2.1 2.11 2.11SP1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
