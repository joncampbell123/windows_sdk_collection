

<HTML>
<HEAD>
<TITLE>HOWTO: Creating a Dynamically Growing Form Using ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163499">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/02/11">
<META NAME="Keywords" CONTENT="AXSFHTML kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  This article provides an example of how to simulate a dynamically growing form using Active Server Pages. This example allows the user to enter items one at a time, and add them to a list. Once the list has been created, it can be submitted as a wh...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAGE,QBT6,QBV4,QAUJ,QAMB,QAPN,QAHP,QDNQ,QAUD,QATX,QAKD,QAP2,QAAZ,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Creating a Dynamically Growing Form Using ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163499</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS NT
kbprg kbcode kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides an example of how to simulate a dynamically growing
form using Active Server Pages. This example allows the user to enter items
one at a time, and add them to a list. Once the list has been created, it
can be submitted as a whole.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In the following example, a basic form is drawn with one text box. The user
can enter information in that text box, and press the 'Add Item to List'
button. This button submits the form to the same file. As each item is
entered, it is added to the form as a new text box with the name ITEMS.
Ultimately when the whole list is submitted, there are several items in the
list that can be looped through as a collection of ITEMS.
<P>
To test this technique, save the text below to a file named Dynaform.asp.
Be sure that this file is located in an IIS Virtual Root.
<P>
<P><h3>File: DYNAFORM.ASP</h3>
 
<P>
<PRE>   &lt;%@ language = vbscript%&gt;
   &lt;% Response.Expires = 0 %&gt;
   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;TITLE&gt;Dynamically Growing Form&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;
   &lt;%
   If Request("Action") = "Submit the List" Then
     ' Show what was entered.
     Response.Write "&lt;B&gt;Here are the Items submitted:&lt;/B&gt;&lt;BR&gt;"
       nItems = Request.Form("Items").Count
       For i = 1 To nItems
         ' Show submitted Items
         Response.Write Request.Form("Items")(i) &amp; "&lt;BR&gt;"
         Next
         Response.Write Request("Item") &amp; "&lt;BR&gt;"
   Else
     ' Create the form from all items. %&gt;
     &lt;FORM Action=dynaform.asp Method=Post&gt;
     &lt;B&gt;Items:&lt;/B&gt;&lt;BR&gt;
     &lt;%
     nItems = Request.Form("Items").Count
     For i = 1 To nItems
       ' Show previously submitted Items
       Response.Write "&lt;INPUT Type=Text Name=Items Value=""" &amp; _
         Trim(Request.Form("Items")(i)) &amp; """&gt;&lt;BR&gt;"
     Next

     If Request.Form("Item") &lt;&gt; "" Then
       ' paint a new input box, and store the old Item in Items collection
       Response.Write "&lt;INPUT Type=Text Name=Items Value=""" &amp; _
         Trim(Request.Form("Item")) &amp; """&gt;&lt;BR&gt;"

       Response.Write "&lt;P&gt;Please enter an Item,&lt;BR&gt;"
       Response.Write "and submit them one at a time&lt;BR&gt;"
       Response.Write "by pressing the Add Item button.&lt;BR&gt;"
       Response.Write "&lt;INPUT Type=Text Size=50 Name=Item Value=""""""&gt;"
     Else
       ' No Item was submitted, don't show an error
       Response.Write "&lt;P&gt;Please enter an Item,&lt;BR&gt;"
       Response.Write "and submit them one at a time&lt;BR&gt;"
       Response.Write "by pressing the Add Item button.&lt;BR&gt;"
       Response.Write "&lt;INPUT Type=Text Size=40 Name=Item Value=""""""&gt;
       &lt;BR&gt;"
     End If
   %&gt;
     &lt;P&gt;
     &lt;INPUT Type="Submit" Name="Action" Value="Add Item to List"&gt;
     &lt;INPUT Type="Submit" Name="Action" Value="Submit the List"&gt;
     &lt;BR&gt;
   &lt;% End If %&gt;

   &lt;/FORM&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: AXSFHTML<BR>
Additional reference words: 1.00<BR>
Keywords          : AXSFHTML kbcode kbhowto kbprg<BR>
Version           : 1.00<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
