

<HTML>
<HEAD>
<TITLE>HOWTO: Modifying .alx File Objects from Active Server Pages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157748">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1996/10/17">
<META NAME="Keywords" CONTENT="AXSFHTML AXSFVBS">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  Internet Information Server (IIS) Active Server Pages (ASP) can be used to modify information in an ActiveX Layout file (.alx). To do this, server side scripting should be placed in the .alx file.  MORE INFORMATION  Active Server Pages are run when...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBT6,QBV4,QBWA,QAHP,QAMB,QAHV,QA7O,QAOE,QAMN,QAKD,QAB5,QAUR,QAUJ,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Modifying .alx File Objects from Active Server Pages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157748</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Internet Information Server (IIS) Active Server Pages (ASP) can be used to
modify information in an ActiveX Layout file (.alx). To do this, server
side scripting should be placed in the .alx file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Active Server Pages are run when the URL is processed by IIS. At this time,
the controls in an .alx file have not been created in Internet Explorer
(IE). Because of this, it is impossible to change a control in an .alx file
from the HTTP document hosting the .alx file using server-side scripting.
<P>
To do this, place the server-side scripting code in the .alx file itself.
When IE calls for the .alx file, IIS processes the server-side script
before handing the .alx file back to IE. The key to making this all happen
is to rename the .alx file with an ASP extension.
<P>
NOTE: The following example assumes that the Adventure Works sample site is
installed and working. It draws data from the AdvWorks data source.
<P>
To see an example of how this all works, use the following steps:

<OL><P><LI>Using the ActiveX Control Pad, create a new HTML Layout (.alx).

<P><LI>Add a label (Label1) and a text box (TextBox1) control to the layout
   file.

<P><LI>Click on the text box, and type "test" in the text box without the
   quotes.

<P><LI>On the File click Save As.

<P><LI>Save the file as "layout1.asp" without the quotes. Note that this is NOT
   the default extension of .alx. Make sure you save all files in this
   example in the same directory. This directory should be a directory
   published by IIS, such as wwwroot. Make sure that IIS has execute
   privileges on this directory so that it can run the script. The root of
   the wwwroot directory does not have execute permissions setup by
   default.

<P><LI>Using the ActiveX Control Pad, create a new HTML document.

<P><LI>On the Edit menu, click Insert HTML Layout.

<P><LI>Type in the name "layout1.asp" in the file name text box.
<P>
   NOTE: This file does not show up in the list of files.

<P><LI>An object tag similar to the following appears in your HTML document:
<P>
<P><PRE>      &lt;OBJECT CLASSID="CLSID:812AE312-8B8E-11CF-93C8-00AA00C08FDF"
      ID="layout1_alx" STYLE="LEFT:0;TOP:0"&gt;
      &lt;PARAM NAME="ALXPATH" REF VALUE="layout1.asp"&gt;
      &lt;/OBJECT&gt;
</PRE><P>
</OL>If the VALUE= contains a full path to the layout1.asp file, remove it so it
reads as above.

<OL><P><LI>Save this file as "page1.htm".

<P><LI>Open the file layout1.asp in a text editor such as Notepad. You cannot
<P><PRE>    open this in the ActiveX Control Pad because it brings up the layout
    editor.
</PRE>
<P><LI>Add the following lines at the beginning of the file:
<P>
<P><PRE>      &lt;%
      Set Con = Server.CreateObject("ADODB.Connection")
      Conn.Open "AdvWorks"
      rs = Conn.Execute("SELECT * FROM products")
      %&gt;
</PRE>
<P><LI>Replace the line for the label object that reads as follows:
<P>
<P><PRE>       &lt;PARAM NAME="Caption" VALUE="label1"&gt;
</PRE><P>
<P><PRE>    With the following line:
</PRE><P>
<P><PRE>       &lt;PARAM NAME="Caption" VALUE="&lt;% Response.Write rs(1).Name %&gt;"&gt;
</PRE>
<P><LI>Replace the line for the text box object that reads as follows:
<P>
<P><PRE>       &lt;PARAM NAME="Value" VALUE="test"&gt;
</PRE><P>
<P><PRE>    With the following line:
</PRE><P>
<P><PRE>       &lt;PARAM NAME="Value" VALUE="&lt;% Response.Write rs(1) %&gt;"&gt;
</PRE>
<P><LI>Save "layout.asp."

<P><LI>Open Internet Explorer and view page1.htm.
<P>
</OL>WARNING: After adding server-side script to your .alx file, be careful
about editing the file in the ActiveX Control Pad. If you open the file in
the ActiveX Control Pad, it converts all &lt;% and %&gt; markers to &amp;lt;% and
%&amp;gt, respectively. This breaks the server-side script. You need to reverse
all of these changes manually. Therefore, it is best to have your .alx file
completely designed before adding server-side script to the file.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : AXSFHTML AXSFVBS
Technology        : kbInetDev
Version           : 1.0
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
