

<HTML>
<HEAD>
<TITLE>HOWTO: Declaring an Array at Application Level Scope </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165293">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="AXSFVBS kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  In developing a Web Application, you may want to declare a table of data for use by one or more pages at application level scope. This article demonstrates how to declare, populate, and reference an array that has been declared at application level...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QAJH,QAPN,QDNQ,QBWA,QAYL,QAM1,QA6A,QAW6,QABC,QA62,QA9N,QANF,QAH4,QABX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Declaring an Array at Application Level Scope</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165293</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In developing a Web Application, you may want to declare a table of data
for use by one or more pages at application level scope. This article
demonstrates how to declare, populate, and reference an array that has been
declared at application level scope.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Repeat the following steps for a demonstration on referencing arrays with
application scope.

<OL><P><LI>On a computer running Active Server Pages, create a folder named ATEST
   and configure Internet Information Server (IIS) to recognize this
   directory as a virtual root with execute permissions.

<P><LI>Create a file in this directory named Global.asa. Copy and paste the
   following code into this file:
<P>
<P><PRE>      &lt;SCRIPT LANGUAGE=VBSCRIPT RUNAT=SERVER&gt;
      SUB Application_OnStart
      ' This script executes when the first user comes to the site.
      ' or the global.asa is modified
</PRE><P>
<P><PRE>      ' A simple fixed size array
      Dim aFixed(3)
      aFixed(1) = "Fixed"
      aFixed(2) = "Size"
      aFixed(3) = "Array"
</PRE><P>
<P><PRE>      ' Cache the array as a member of the Application variables collection
      Application("aFixed") = aFixed
</PRE><P>
<P><PRE>      ' Declare a dynamic (resizable) array
      Dim aColors()
</PRE><P>
<P><PRE>      ' Allocate storage for the array
      Redim aColors(16)
</PRE><P>
<P><PRE>      ' Store values representing a simple color table
      ' to each of the elements
      aColors(1) = "RED" ' [#FF0000]
      aColors(2) = "GREEN" ' [#008000]
      aColors(3) = "BLUE" ' [#0000FF]
      aColors(4) = "AQUA" ' [#00FFFF]
      aColors(5) = "BLACK" ' [#000000]
      aColors(6) = "FUCHSIA" ' [#FF00FF]
      aColors(7) = "GRAY" ' [#808080]
      aColors(8) = "LIME" ' [#00FF00]
      aColors(9) = "MAROON" ' [#800000]
      aColors(10) = "NAVY" ' [#000080]
      aColors(11) = "OLIVE" ' [#808000]
      aColors(12) = "PURPLE" ' [#800080]
      aColors(13) = "SILVER" ' [#C0C0C0]
      aColors(14) = "TEAL" ' [#008080]
      aColors(15) = "YELLOW" ' [#FFFF00]
      aColors(16) = "WHITE" ' [#FFFFFF]
</PRE><P>
<P><PRE>      ' Cache the array as a member of the Application variables collection
      Application("aColors") = aColors
</PRE><P>
<P><PRE>      END SUB
      &lt;/SCRIPT&gt;
</PRE>
<P><LI>Create a file in the same directory named Color.asp. Copy and paste the
   following code into the file:
<P>
<P><PRE>      &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
      &lt;HTML&gt;
      &lt;BODY&gt;
      &lt;H2&gt;Arrays as Members of the Application variables collection.&lt;/H2&gt;
      &lt;%
      if IsArray(Application("aColors")) then
      %&gt;
<PRE></PRE>         &lt;H3&gt;A Resizable Array&lt;/H3&gt;
      &lt;%
         ' Put a reference to the array in a temporary variable
         ' for easy access
         aColors = Application("aColors")
         nColors = UBound(aColors)
      %&gt;
         &lt;TABLE BGCOLOR=BLACK&gt;
      &lt;%
            for i = 1 to nColors
               cColor = aColors(i)
             if cColor = "BLACK" then
                cBGColor = "WHITE"
             else
           cBGColor = "BLACK"
             end if
      %&gt;
               &lt;TR&gt;
                  &lt;TD BGCOLOR=&lt;% =cBGColor %&gt;&gt;
                     &lt;FONT COLOR=&lt;% =cColor %&gt;&gt;&lt;% =cColor %&gt;&lt;/FONT&gt;
          &lt;/TR&gt;
      &lt;%    next %&gt;
         &lt;/TABLE&gt;
      &lt;%
      else
         Response.Write("Application('aColors') is not an array! &lt;BR&gt;")
      end if

      if IsArray(Application("aFixed")) then
      %&gt;
         &lt;H3&gt;A Fixed Size Array&lt;/H3&gt;
      &lt;%
         aFixed = Application("aFixed")
         for i = 1 to UBound(aFixed)
             Response.Write(aFixed(i) &amp; "&lt;BR&gt;")
         next
      else
         Response.Write("Application('aFixed') is not an array! &lt;BR&gt;")
      end if
      %&gt;

      &lt;/BODY&gt;
      &lt;/HTML&gt;

</PRE><P><LI>Save the files, launch a client browser such as Internet Explorer, and
   load the Active Server Page using a path similar to the following:
<P>
<P><PRE>      <B>http://&lt;server&gt;/Atest/Color.asp</B>
</PRE><P>
</OL>The browser should display the contents of the arrays, which were stored at
the application level.
<P>
Observe that in the above sample it is only during application startup that
the contents of the variables collection of the Application object is
altered. For that reason, there is no need to lock the Application object.
As with any other element of the variables collection of the application
object, if the contents of the array were modified by another Active Server
Page or via a session-level event, the Application object would need to be
locked. For more information on the Lock and Unlock methods of the
Application object, see the Active Server Pages Roadmap.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Active Server Pages Online documentation
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : AXSFVBS kbprg kbhowto
Version           : 1.0
Platform          : NT WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
