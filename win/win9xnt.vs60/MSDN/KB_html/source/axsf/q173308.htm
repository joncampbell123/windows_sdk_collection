

<HTML>
<HEAD>
<TITLE>HOWTO: Displaying Images Stored in a BLOB Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173308">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/08/29">
<META NAME="Keywords" CONTENT="VIASP">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  Using Active Server Pages (ASP), you can view images stored in BLOB (Binary Large Object) fields in your Internet browser. This article provides information on how to display a GIF image stored in the Microsoft SQL Server sample database table pub_...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWA,QABM,QA7O,QA7N,QAB2,QA3N,QAH2,QBR4,QAYY,QAH6,QAFR,QAY2,QAPF,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Displaying Images Stored in a BLOB Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173308</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, version 1.0b
<LI>Microsoft Visual Studio, versions 97, 97sp1, 97sp2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using Active Server Pages (ASP), you can view images stored in BLOB (Binary
Large Object) fields in your Internet browser. This article provides
information on how to display a GIF image stored in the Microsoft SQL
Server sample database table pub_info.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Most Internet browsers support the displaying of GIF and JPEG images. To
display an image, the browser requests the image from a Web server. The
server passes the image to the browser as an HTTP transaction with an HTTP
header containing an MIME type of IMAGE/GIF or IMAGE/JPEG. You can simulate
this behavior with Active Server Pages.
<P>
The following example constructs an HTTP header for an image and then uses
the binary information from an image field in SQL Server to provide a GIF
to the browser.
<P>
<PRE>   FILE: SHOWIMG.ASP
   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
   &lt;%
   ' Clear out the existing HTTP header information
   Response.Expires = 0
   Response.Buffer = TRUE
   Response.Clear

   ' Change the HTTP header to reflect that an image is being passed.
   Response.ContentType = "image/gif"

   Set cn = Server.CreateObject("ADODB.Connection")
   ' The following open line assumes you have set up a System DataSource
   ' by the name of myDSN.
   cn.Open "DSN=myDSN;UID=sa;PWD=;DATABASE=pubs"
   Set rs = cn.Execute("SELECT logo FROM pub_info WHERE pub_id='0736'")
   Response.BinaryWrite rs("logo")
   Response.End
   %&gt;

</PRE>This script only displays an image on the screen. If you wish to display an
image from an HTML or ASP document you must refer to this script in an
image tag. For example, if you wished to display this image with a caption
describing it, you might use the following HTML page:
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;&lt;TITLE&gt;Display Image&lt;/TITLE&gt;&lt;/HEAD&gt;
   &lt;BODY&gt;
   This page will display the image New Moon Books from a SQL Server 6.5
   image field.&lt;BR&gt;
   &lt;IMG src="showimg.asp"&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>NOTE: The ASP script assumes that the image field (BLOB Data) in the SQL
Server table contains a raw GIF image. Internet browsers assume that raw
GIF or JPEG data follow the HTTP header. If any extraneous information is
contained in the BLOB data, this will be passed by this script, and the
image will not display properly. This becomes important when you realize
that most methods of placing images into BLOB fields place extra
information in the form of headers with the image. Examples of this are
Microsoft Access and Microsoft Visual FoxPro. Both of these applications
save OLE headers in the BLOB field along with the actual binary data.
<P>
This technique can also be applied to other types of binary data, not just
graphics. The browser needs to know what type of content is being
presented. Do this by specifying the proper mime type in the
Response.ContentType variable. For example, if you wanted to view a word
document, you would set the ContentType = "application/msword".
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base artices and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Paul Enfield, Microsoft Corporation
 
<PRE>Keywords          : VIASP
Technology        : kbInetDev
Version           : WINDOWS NT:1.0b,97,97sp1,97sp2
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
