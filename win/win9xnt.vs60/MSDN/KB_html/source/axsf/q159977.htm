

<HTML>
<HEAD>
<TITLE>How To Stop Users from Displaying a Frame Outside its Frameset </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159977">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1996/11/25">
<META NAME="Keywords" CONTENT="AXSFHTML kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  Microsoft Active Server Pages can be used to prevent Web browsers from calling a document that is supposed to be displayed as a part of a frameset.  MORE INFORMATION  Web documents that are part of a frameset are often not designed for individual d...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QAGI,QDNQ,QAH4,QAVZ,QA3N,QAIB,QAMB,QAIA,QAQW,QBVV,QAY2,QABC,QBLL,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Stop Users from Displaying a Frame Outside its Frameset</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159977</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS NT
kbprg kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Active Server Pages can be used to prevent Web browsers from
calling a document that is supposed to be displayed as a part of a
frameset.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Web documents that are part of a frameset are often not designed for
individual display. To prevent users from viewing these documents outside
of their appropriate frameset, you can use the Internet Information Server
(IIS) Active Server Pages (ASP) "Response.Redirect" and
"Request.ServerVariables" methods to redirect Hypertext Transfer Protocol
(HTTP) requests to the frameset page.
<P>
Assuming the following document structure:
<P>
<PRE>   Frameset Page (mainfrm.htm)
      Frame 1 (frame1.asp)
      Frame 2 (frame2.asp)

</PRE>place the following code in frame1.asp or frame2.asp before the opening
&lt;HTML&gt; tag:
<P>
<PRE>   &lt;%
   If (Request.ServerVariables("HTTP_REFERER") = "") Or _
      (Left(Request.ServerVariables("HTTP_REFERER"),42) &lt;&gt; _
      "<B>http://www.myserver.com/AppDir/mainfrm.htm</B>") Then
      Response.Redirect "<B>http://www.myserver.com/AppDir/mainfrm.htm</B>"
   End If
   %&gt;

</PRE>NOTE: You must put this code at the beginning of your document because
"Response.Redirect" does not work if any HTML code occurs before it. For
more information on this, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../axsf/q159402.htm">Q159402</A></B>
   TITLE     : How To Use Response.Redirect in a Server Script

</PRE>In this code, the first part of the If statement
(Request.ServerVariables("HTTP_REFERER")= "") checks to see if you
connected to the page directly by typing the URL into the browser. If you
connect to the page this way, a "referer" is not found in the header and
the browser is redirected to the main page that contains the frameset.
<P>
The second half of the If statement is
(Left(Request.ServerVariables("HTTP_REFERER"),42) &lt;&gt;
"<B>http://www.myserver.com/AppDir/mainfrm.htm</B>"). This line checks to see that
you connected to frame1.asp from the frameset page(mainfrm.htm). If not,
the browser is redirected to the main page containing the frameset.
<P>
The line:
<P>
<PRE>   Response.Redirect "<B>http://www.myserver.com/AppDir/mainfrm.htm</B>"

</PRE>redirects the browser to the following page:
<P>
<PRE>   <B>http://www.myserver.com/AppDir/mainfrm.htm.</B>

</PRE>You can use the following code to demonstrate this. Save each in a separate
file and use the names indicated below. Also, you need to make the
following modifications to the code in the frame1.asp file:

<OL><P><LI>Change the two instances of <B>http://www.myserver.com/AppDir/mainfrm.htm</B>
   in the If statement to point to the correct virtual root and directory
   on your server.

<P><LI>Change the value in the Left() function from 42, to the number of
   characters in the path you just modified in step 1.
<P>
</OL><h3>File: Mainfrm.htm</h3>
 
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;&lt;TITLE&gt;MAINFRM&lt;/TITLE&gt;&lt;/HEAD&gt;
   &lt;BODY&gt;
   &lt;FRAMESET ROWS="400,*"&gt;
      &lt;FRAME SCROLLING="no" NORESIZE src="frame1.asp"&gt;
      &lt;FRAME SCROLLING="no" NORESIZE src="frame2.asp"&gt;
   &lt;/FRAMESET&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE></OL><h3>File: Frame1.asp</h3>
 
<P>
<PRE>   &lt;%
   If (Request.ServerVariables("HTTP_REFERER") = "") Or
   (Left(Request.ServerVariables("HTTP_REFERER"),42) &lt;&gt;
   "<B>http://www.myserver.com/AppDir/mainfrm.htm</B>") Then
      Response.Redirect "<B>http://www.myserver.com/AppDir/mainfrm.htm</B>"
   End If
   %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;&lt;TITLE&gt;FRAME1&lt;/TITLE&gt;&lt;/HEAD&gt;
   &lt;BODY&gt;
   In Frame 1.
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE><h3>File: Frame2.asp</h3>
 
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;&lt;TITLE&gt;FRAME2&lt;/TITLE&gt;&lt;/HEAD&gt;
   &lt;BODY&gt;
   In Frame 2.
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbhowto<BR>
KBSubcategory: AXSFHTML<BR>
Additional reference words: 1.00 kbdsi<BR>
Keywords          : AXSFHTML kbhowto kbprg<BR>
Version           : 1.00<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
