

<HTML>
<HEAD>
<TITLE>FIX: ASP Incorrectly Delivers SSL Data in 32K Segments </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170985">
<META NAME="KBModify" CONTENT="1998/01/12">
<META NAME="KBCreate" CONTENT="1997/07/02">
<META NAME="Keywords" CONTENT="AXSFMisc kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  When accessing Active Server Pages (ASP) pages using SSL, Netscape Navigator may encounter I/O Errors. Internet Explorer does not display an obvious error; however, other problems may occur in your application as a result of this problem.  CAUSE ==...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QDNQ,QABG,QANY,QAAP,QAKP,QAB4,QAR4,QAYY,QA6A,QAH4,QA62,QAY4,QAH6,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ASP Incorrectly Delivers SSL Data in 32K Segments</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170985</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, versions 1.0, 1.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When accessing Active Server Pages (ASP) pages using SSL, Netscape
Navigator may encounter I/O Errors. Internet Explorer does not display an
obvious error; however, other problems may occur in your application as a
result of this problem.
<P>
<P><h2>CAUSE</h2>
 
<P>
Internet Information Server 3.0 incorrectly segments SSL data into 32 K
segments. This is in violation of the SSL 3.0 specification, which calls
for a maximum SSL segment size of 16 K. Browsers that assume a 16 K maximum
segment size may have problems accepting 32 K chunks. This problem has been
addressed in Internet Information Server 4.0. If you are using Active
Server Pages, you may use the below information to workaround this issue.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The only workaround for this problem is to prevent ASP from sending
segments of data greater than 16K. The following tips may be helpful in
reducing the SSL segment size sent by ASP:

<OL><P><LI>Try turning off ASP buffering (this may be difficult for pages using
   Response.Redirect). This may work, depending on the length of the ASP
   page.

<P><LI>If your ASP page has very large sections of HTML code, try the
   following:
<P>
   - Turn on buffering by adding the following line before the &lt;HTML&gt; tag
<P><PRE>     at the top of the ASP file.
</PRE><P>
<PRE>        &lt;% Response.Buffer = True %&gt;

   - Next, insert the following line of code periodically in the file to
     break the HTML into chunks of less than 16K.

        &lt;% Response.Flush %&gt;

</PRE></OL>This breaks up the HTML into multiple writes to the browser.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem has been corrected in a
recent HotFix to Active Server Pages. For more information on obtaining
this HotFix to ASP, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE: <B><A href="../iis/q172217.htm">Q172217</A></B>
   TITLE  : ASP Returns Invalid Application Name Error Message

</PRE>NOTE: <B><A href="../iis/q172217.htm">Q172217</A></B> describes a different problem that is also resolved by this
HotFix.
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : AXSFMisc kb3rdparty
Technology        : kbInetDev
Version           : 1.0 1.0b
Platform          : NT WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
