

<HTML>
<HEAD>
<TITLE>HOWTO: Populating a Combobox from Active Server Pages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175426">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/20">
<META NAME="Keywords" CONTENT="AXSFHTML AXSFMisc kbcode">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  This article demonstrates how to load a ComboBox with records retrieved from a database. In this example we will create an Active Server Pages (ASPP page that connects to the Adventure Works database.  MORE INFORMATION  The code below demonstrates ...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QBV3,QAHP,QDNQ,QAH4,QBVR,QAHV,QA7O,QAY2,QAVT,QAOE,QAMN,QAB5,QBXS,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Populating a Combobox from Active Server Pages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175426</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Active Server Pages
<LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how to load a ComboBox with records retrieved
from a database. In this example we will create an Active Server Pages
(ASPP page that connects to the Adventure Works database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code below demonstrates how to load values into an HTML list box:
<P>
<PRE>   &lt;HTML&gt;
   &lt;BODY&gt;
   &lt;BR&gt;This is an HTML ListBox&lt;BR&gt;
   &lt;SELECT NAME="ListBox" SIZE=1&gt;
   &lt;% Set conn = Server.CreateObject("ADODB.Connection") %&gt;
   &lt;% conn.Open "DSN=AdvWorks"  ' connect to the database %&gt;
   &lt;% Set rs = conn.Execute("SELECT City FROM Customers") %&gt;
   &lt;% Do While Not rs.EOF  ' define the ListBox OPTIONs %&gt;
      &lt;OPTION VALUE="&lt;%= rs("City") %&gt;"&gt; &lt;%= rs("City") %&gt;
      &lt;% rs.MoveNext %&gt;
   &lt;% Loop %&gt;
   &lt;% rs.Close %&gt;
   &lt;% conn.Close %&gt;
   &lt;/SELECT&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>The code below demonstrates how to load values into an ActiveX ComboBox
control. Be aware that this control must be installed and registered on
your system in order for this sample to work correctly:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
   &lt;HTML&gt;
   &lt;BODY&gt;
   &lt;BR&gt;This is an ActiveX ComboBox control&lt;BR&gt;
   &lt;!-- insert the ActiveX control into the HTML page --&gt;
   &lt;OBJECT ID="ComboBox" WIDTH=96 HEIGHT=24
      CLASSID="CLSID:8BD21D30-EC42-11CE-9E0D-00AA006002F3"&gt;
   &lt;/OBJECT&gt;
   &lt;SCRIPT LANGUAGE="VBScript"&gt;
   &lt;!--
   ' load the ActiveX control after the window has been loaded
   Sub Window_OnLoad()
      &lt;% Set conn = Server.CreateObject("ADODB.Connection") %&gt;
      &lt;% conn.Open "DSN=AdvWorks"  ' connect to the database %&gt;
      &lt;% Set rs = conn.Execute("SELECT City FROM Customers") %&gt;
      &lt;% Do While Not rs.EOF %&gt;
         ComboBox.AddItem("&lt;%= rs("City") %&gt;") ' Do an AddItem for
                                               ' each record
         &lt;% rs.MoveNext %&gt;
      &lt;% Loop %&gt;
      &lt;% rs.Close %&gt;
      &lt;% conn.Close %&gt;
   End Sub
   --&gt;
   &lt;/SCRIPT&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>NOTE: Use your browser to view these pages and the view the HTML source.
This will give you a better understanding of what code was produced by ASP.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base artices and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : AXSFHTML AXSFMisc kbcode
Technology        : kbinetdev
Version           : WINDOWS:1.0; WINNT:
Platform          : WINDOWS winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
