

<HTML>
<HEAD>
<TITLE>Access Denied Msg. Returned When You Access ASP Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172954">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/08/20">
<META NAME="Keywords" CONTENT="AXSFConfig kberrmsg kbusage kbbug1.00b">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  When you try to load secure Active Server Pages (ASP files) on Microsoft Internet Information Server (IIS) servers with more than sixty virtual Roots, you may get the following error even if the user account has been Granted explicit rights to the ...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDH9,QA1S,QDNQ,QAML,QDN9,QBJQ,QANY,QBWG,QBVV,QAI5,QAKP,QAR4,QAK7,QBWA,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Access Denied Msg. Returned When You Access ASP Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172954</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages version 1.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to load secure Active Server Pages (ASP files) on Microsoft
Internet Information Server (IIS) servers with more than sixty virtual
Roots, you may get the following error even if the user account has been
Granted explicit rights to the file:
<P>
<PRE>   HTTP Error 401 Access Denied

</PRE>NOTE: This only occurs if the file permissions have been changed to grant
the user account rights to the file after it has been accessed at least
once.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because ASP caches template files after they have
been executed; therefore, they will not need to be continually recompiled.
The files are cached with a copy of the full Discretionary Access Control
List (DACL) as well as the file date attributes.
<P>
ASP uses the cached version of the DACL to determine if a user has
sufficient privilege to execute the ASP file.
<P>
On IIS with more than sixty virtual roots, cached template files are
reloaded when the files last modified date changes. Because changes in
file permissions do not change a file's last modified attribute, cached
versions of files are not reloaded after permission changes. Therefore,
the accounts recently given rights to a cached ASP file may get access
denied until the file is reloaded by a file size change, etc.
<P>
NOTE: ASP uses notification handles on IIS servers with less than sixty
virtual roots. Because notification handles trigger on security changes
this is not a problem for IIS servers with less than sixty virtual roots.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The Asp.dll file was modified to check for cached file reload based on
the files DACL as well as the last modified date.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Active Server
Pages version 1.0b. A supported fix is now available, but is not fully
regression-tested and should be applied only to systems experiencing this
specific problem. Unless you are severely impacted by this specific
problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Product Support Services for more information.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base artices and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords          : AXSFConfig kberrmsg kbusage kbbug1.00b<BR>
Version           : 1.00 1.00b<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
