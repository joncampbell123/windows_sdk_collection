

<HTML>
<HEAD>
<TITLE>INFO: ODBC Connection Pooling and ADO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166886">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/04/14">
<META NAME="Keywords" CONTENT="AXSFDataBase AXSFSQL kbprg">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  This article answers the following connection pooling questions:   - What is connection pooling?   - When would I use connection pooling?   - What are the advantages of using connection pooling?   - How do I enable connection pooling in ActiveX Dat...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QA9E,QAU9,QAVZ,QA1S,QAAW,QBWS,QABM,QAYY,QBWA,QAJH,QDNQ,QAYZ,QASS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: ODBC Connection Pooling and ADO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166886</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, versions 1.0, 1.0b
<LI>ActiveX Data Objects (ADO)
<LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article answers the following connection pooling questions:

<UL><LI>What is connection pooling?

<LI>When would I use connection pooling?

<LI>What are the advantages of using connection pooling?

<LI>How do I enable connection pooling in ActiveX Data Objects (ADO)?
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>What is Connection Pooling?</h3>
 
<P>
The following excerpt is from the Odbc.hlp file in the Microsoft ODBC 3.0
SDK:
<P>
<PRE>   Connection pooling enables an application to use a connection from a
   pool of connections that do not need to be reestablished for each use.
   Once a connection has been created and placed in a pool, an application
   can reuse that connection without performing the complete connection
   process.

</PRE><h3>What Are The Advantages Of Using Connection Pooling?</h3>
 
<P>
Here is an excerpt is from the Odbc.hlp file in the Microsoft ODBC 3.0 SDK:
<P>
"Using a pooled connection can result in significant performance gains,
because applications can save the overhead involved in making a connection.
This can be particularly significant for middle-tier applications that
connect over a network, or for applications that repeatedly connect and
disconnect, such as Internet applications.
<P>
"In addition to performance gains, the connection pooling architecture
enables an environment and its associated connections to be used by
multiple components in a single process. This means that standalone
components in the same process can interact with each other without being
aware of each other. A connection in a connection pool can be used
repeatedly by multiple applications."
<P>
<P>
<P><h3>When Would I Use Connection Pooling in ADO?</h3>
 
<P>
Connection pooling is recommended when using ODBC drivers that support
multiple threads. For example, the Microsoft ODBC Driver for Oracle, and
the Microsoft SQL Server ODBC driver.
<P>
The Microsoft Access ODBC driver (Jet driver) is one driver that requires
that connection pooling be turned off. The Jet driver does not support
multiple threads using it concurrently. Because a connection may end up
being dropped by a different thread than the thread that created it, it is
recommended that connection pooling be turned off for this driver.
<P>
<P><h3>How do I Enable/Disable Connection Pooling in ADO?</h3>
 
<P>
To enable/disable connection pooling in ActiveX Data Objects (ADO), you
need to change a registry entry on your Internet Information Server that
has Active Server Pages installed on it.
<P>
CAUTION: Using the Registry Editor incorrectly can cause serious problems,
including corruption that may make it necessary to reinstall Windows or
Active Server Pages. Using the Registry Editor to edit entries in the
registry is equivalent to editing raw sectors on a hard disk. If you make
mistakes, your computer’s configuration could be damaged. You should edit
registry entries only for settings that you cannot adjust through the user
interface, and be very careful whenever you edit the registry directly.
<P>
To make the change, follow these steps:

<OL><P><LI>Use the Start menu to run Regedit.exe.

<P><LI>Navigate to the following key:
<P>
   HKEY_LOCAL_MACHINE
<P><PRE>     \SYSTEM
       \CurrentControlSet
<PRE></PRE>         \Services
           \W3SVC
             \ASP
               \Parameters

</PRE><P><LI>Double-click the StartConnectionPool item.

<P><LI>Change the "Value Data" item to 1 to enable connection pooling or 0 to
   disable connection pooling.

<P><LI>Click OK.

<P><LI>Close REGEDIT.
<P>
</OL>For this change to take effect, you must now stop and restart the Web
Publishing Service. This is most easily done by stopping and restarting the
server's "WWW" service through the Microsoft Internet Service Manager.
<P>
More details on connection pooling can be found in the documentation
provided with Active Server Pages (ASP). After installing ASP, you will
find a group in your Windows Start menu named "Microsoft Internet Server."
This group has a link to the ASP documentation called "Active Server Pages
Roadmap." Open this link, and follow the following links:

<UL><LI>In the left frame, in the tree view, click on the plus next to
   "Component Reference."

<LI>Open the "Database Access Component" by clicking on the plus sign next
   to it.
<P>
</UL>- Select the "Connection Pooling" document now listed in this tree view.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : AXSFDataBase AXSFSQL kbprg
Version           : 1.0 1.0b
Platform          : NT WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
