

<HTML>
<HEAD>
<TITLE>PRB: Session variables lost when ASP is located in frameset </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178037">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1997/12/12">
<META NAME="Keywords" CONTENT="VIASP">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  Values of session variables defined in an Active Server Pages (ASP) page are empty when you attempt to access the values from other ASP pages within the frameset.  CAUSE =====  The following conditions cause this error to occur:   - Session variabl...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWA,QAMB,QAYL,QABC,QAUJ,QAKD,QA6A,QAK9,QAIV,QASR,QARM,QAMA,QAIB,QBWI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Session variables lost when ASP is located in frameset</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178037</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, versions 1.0, 1.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Values of session variables defined in an Active Server Pages (ASP) page
are empty when you attempt to access the values from other ASP pages within
the frameset.
<P>
<P><h2>CAUSE</h2>
 
<P>
The following conditions cause this error to occur:

<UL><LI>Session variables initialized within the ASP file, as opposed to being
   initialized in the Global.asa (see the NOTE below).

<LI>The ASP files in condition 1 above are loaded into a frameset.
<P>
<P>
</UL>When displaying ASP files within a frameset, a new session is started for
each ASP file contained within the frameset. Likewise, the Session_OnStart
subroutine is called once for each ASP file.
<P>
Active Server Pages keeps track of sessions through the use of cookies.
When using a frameset that contains ASP files, the cookies are not returned
to the browser until the entire frameset is loaded. For this reason, if a
session has not already been established (that is, a SessionID cookie has
not been passed to the browser), Active Server Pages creates a new session
for each ASP file within the frameset.
<P>
NOTE: If the session variable is initialized within the Session_OnStart of
the Global.asa and the variable increments (for example, a variable that
holds a value indicating how many people have hit your site), the value
will increment by an amount equal to the number of frames containing ASP
pages you have in your frameset. This behavior is due to the
Session_OnStart executing for each ASP file in your frameset.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Active Server Pages maintains a session only when necessary (for example,
if a session variable is created). To avoid this behavior you must
establish a session before the frameset is processed. In most cases, the
easiest way to do this is by changing the file which defines the frameset
from an HTML file to an ASP file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create the following files:
<P>
Main.htm:
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Developer Studio"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;
   &lt;FRAMESET FRAMEBORDER=0 SCROLLING=YES ROWS="15%, 70%, *"&gt;
       &lt;FRAME NAME="Top" SCROLLING="NO" src="top.asp"&gt;
       &lt;FRAME NAME="Middle" SCROLLING="AUTO" src="middle.asp"&gt;
       &lt;FRAME NAME="Bottom" SCROLLING="NO" src="bottom.asp"&gt;
   &lt;/FRAMESET&gt;

   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>Top.asp:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;

   &lt;BODY&gt;
   &lt;% Response.Write( "Top.asp: " &amp; Session.SessionID ) %&gt;
   &lt;%'set a session variable I want to be global to all asp files in the
      frameset session("GlobalVar")="Top"%&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>Middle.asp:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;

   &lt;BODY&gt;
   &lt;% Response.Write( "Middle.asp: " &amp; Session.SessionID ) %&gt;

   &lt;SCRIPT LANGUAGE="VBScript"&gt;
      Sub CommandButton1_Click()
         'display the global variable set in top.asp
         msgbox "&lt;%=session("GlobalVar")%&gt;"
         'if GlobalVar is blank, it means the variable is scoped to a
         'different session.
      end sub
   &lt;/SCRIPT&gt;

   &lt;OBJECT ID="CommandButton1" WIDTH=96 HEIGHT=32
     CLASSID="CLSID:D7053240-CE69-11CD-A777-00DD01143C57"&gt;
        &lt;PARAM NAME="Caption" VALUE="display gvar"&gt;
        &lt;PARAM NAME="Size" VALUE="2540;846"&gt;
        &lt;PARAM NAME="FontCharSet" VALUE="0"&gt;
        &lt;PARAM NAME="FontPitchAndFamily" VALUE="2"&gt;
        &lt;PARAM NAME="ParagraphAlign" VALUE="3"&gt;
   &lt;/OBJECT&gt;

   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>Bottom.asp:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;

   &lt;BODY&gt;
   &lt;% Response.Write( "Bottom.asp: " &amp; Session.SessionID ) %&gt;
   &lt;% Session("MyVar") = "Bottom" %&gt;
   &lt;/BODY&gt;

   &lt;/HTML&gt;

</PRE>Browse Main.htm and you will see that the session IDs are all different.
<P>
Rename Main.htm to Main.asp and add the following line of code after the
&lt;/FRAMESET&gt; tag:
<P>
<PRE>   &lt;% Session("MyVar") = "Main" %&gt;

</PRE>Now only one session is created and is maintained until the session ends.
<P>
 
<PRE>Keywords          : VIASP
Technology        : kbInetDev
Version           : WINNT:1.0,1.0b
Platform          : winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
