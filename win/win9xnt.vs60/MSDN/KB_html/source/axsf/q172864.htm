

<HTML>
<HEAD>
<TITLE>ASP Pages Fail on Access to Session and Application Objects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172864">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/08/18">
<META NAME="Keywords" CONTENT="AXSFConfig kberrmsg kbbug1.00b">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  When you try to load secure Active Server Pages (ASP files) that use Session or Application objects defined in a secure ASP Application file (Global.asa), it may fail. For example, when you try to load a page that uses a DSN string stored in the Se...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANG,QDNQ,QA7H,QA1S,QAB4,QAGI,QAK7,QAAD,QAI5,QAW6,QAPN,QABT,QDH9,QAKP,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ASP Pages Fail on Access to Session and Application Objects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172864</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages version 1.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to load secure Active Server Pages (ASP files) that use
Session
or Application objects defined in a secure ASP Application file
(Global.asa),
it may fail. For example, when you try to load a page that uses a DSN
string
stored in the Session object to open an ADO connection, it may fail with
the
following error message:
<P>
<PRE>   Microsoft OLE DB Provider for ODBC Drivers error '80004005'

   [Microsoft][ODBC Driver Manager] Data source name not found and no
</PRE>default
<PRE>   driver specified

   /vroot/query.asp, line xx

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs because the Global.asa file requires anonymous access
to
be correctly detected and compiled on the first access by a client.
<P>
The first access by a client is always anonymous. When an anonymous request
for a secure ASP file occurs, ASP fails the attempt to load the requested
file; however, it tries to detect and compile the Global.asa file anyway.
<P>
ASP uses GetFileAttributes to detect the Global.asa file in a given mapped
Virtual directory. Because an anonymous user does not have sufficient
privilege to access a secure Global.asa file, the call to GetFileAttributes
fails with an Access Denied error message. Because the call to
GetFileAttributes failed, ASP assumes no Global.asa file exists in the
mapped virtual root and does not attempt to load and compile the global.asa
file.
<P>
ASP files that use Session and Application objects defined in a secure
Global.asa file fail because the Global.asa file never gets compiled. All
values and objects that would have been created in the Global.asa file
are not available.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The Asp.dll file was modified to load and compile the Global.asa file
after client authentication has been granted.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Active Server
Pages version 1.0b. A supported fix is now available, but is not fully
regression-tested and should be applied only to systems experiencing this
specific problem. Unless you are severely impacted by this specific
problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Product Support Services for more information.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base artices and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords          : AXSFConfig kberrmsg kbbug1.00b<BR>
Version           : 1.00b<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
