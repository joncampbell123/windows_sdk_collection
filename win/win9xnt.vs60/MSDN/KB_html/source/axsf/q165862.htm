

<HTML>
<HEAD>
<TITLE>PRB: document.lastModified Property is Unreadable with ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165862">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/03/26">
<META NAME="Keywords" CONTENT="kbprb">
<META NAME="KBArea" CONTENT="Support; KB; axsf">
<META NAME="Description" CONTENT="  The lastModified property exposed by the Internet Explorer (IE) HTML scripting object model indicates the date and time at which the sender believes the resource was last modified. When this property is referenced in a page generated by the Active ...">
<META NAME="Product" CONTENT="Active Server Pages">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWA,QAML,QBLL,QBV9,QDH9,QA3N,QAPN,QACE,QBRJ,QAUD,QAQW,QABC,QA62,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: document.lastModified Property is Unreadable with ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165862</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, version 1.0
<LI>Microsoft Internet Explorer (Programming), version 3.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The lastModified property exposed by the Internet Explorer (IE) HTML
scripting object model indicates the date and time at which the sender
believes the resource was last modified. When this property is referenced
in a page generated by the Active Server Page framework, an unreadable
value is displayed by the client browser.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Active Server Page framework does not include the Last-Modified
response header in its response to the client.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
According to RFC 1945, Hypertext Transfer Protocol 1.0 -- HTTP/1.0,
Last-Modified is an entity header field, and entity header fields are
optional. Internet Explorer 3.0 does not handle the absence of this header
gracefully.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Internet Explorer versions
3.0 and 3.01.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a file containing the following HTML code. Save it as baddate.asp
   into a directory that corresponds to a Virtual Root in IIS. Make sure
   that the Virtual Root has been granted Execute permissions in IIS:
<P>
<P><PRE>      &lt;HTML&gt;
      &lt;BODY&gt;
      &lt;SCRIPT LANGUAGE=VBSCRIPT&gt;
      document.write "Last Modified on " &amp; document.lastModified
      &lt;/SCRIPT&gt;
      &lt;/BODY&gt;
      &lt;/HTML&gt;
</PRE>
<P><LI>Launch Internet Explorer, and enter the URL that points to this page in
   the address box as shown below:
<P>
   <B>http://&lt;server&gt;/&lt;vroot_name&gt;/baddate.asp</B>

<P><LI>Observe that the date appears to be corrupted.
<P>
</OL><h2>RESOLUTION</h2>
 
<P>
Active Server Pages provides the Response Intrinsic object. Use the
Response.AddHeader method to add the Last-Modified header to the HTTP
response.
<P>
According to the RFC, the user agent, IE, expects times to be expressed in
Greenwich Mean Time (GMT). While VBSCRIPT does provide many date and time
manipulation functions, it does not provide a function to return GMT or a
function to return the current time zone offset from which GMT could be
derived. The following example uses JSCRIPT on the server to append the
Last-Modified response header to those provided by IIS and the Active
Server Page Framework. Replace the contents of the page above with the
following text:
<P>
<PRE>      &lt;%@ LANGUAGE=JSCRIPT %&gt;

      &lt;%
         // JSCRIPT automatically formats the string as specified
         // in RFC 1945, HTTP/1.0
         // e.g. Last-Modified: Tue, 15 Nov 1994 12:45:26 GMT
         theCurrentTime = new Date()

         // convert the date to GMT
         theUTCLastModifiedTime = theCurrentTime.toGMTString()

         // Inject the header into the HTTP response
         Response.AddHeader("Last-modified", theUTCLastModifiedTime)
      %&gt;

      &lt;HTML&gt;
      &lt;BODY&gt;
      &lt;SCRIPT LANGUAGE=VBSCRIPT&gt;
      document.write "Last Modified on " &amp; document.lastModified
      &lt;/SCRIPT&gt;
      &lt;/BODY&gt;
      &lt;/HTML&gt;

</PRE></OL>Save the ASP file on the server, and refresh the page in the client
browser. The last modified date should now be displayed correctly.
<P>
<P><h2>REFERENCES</h2>
 
<P>
RFC 1945. Hypertext Transfer Protocol 1.0 -- HTTP/1.0.
<P>
On-line Active Server Pages documentation.
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : kbprb
Version           : 1.0 3.01
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
