

<HTML>
<HEAD>
<TITLE>FIX: Advanced Options for SDI Application in Appwizard </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139422">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1995/11/09">
<META NAME="Keywords" CONTENT="MfcMisc vcbuglist400 vcfixlist500 WizardIss kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Some of the Advance Options in Step 4 of AppWizard have no effect on an AppWizard-generated SDI applications. The Maximized and Minimized options for the Main Frame Window in the Window Styles tab have no effect when selected for an SDI application...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJH,QAH4,QBFY,QA56,QA55,QAYL,QAUD,QBW1,QAR4,QAIB,QBXT,QA5V,QAM4,QAMA,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Advanced Options for SDI Application in Appwizard</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139422</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with Microsoft
   Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0, 4.1, 4.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Some of the Advance Options in Step 4 of AppWizard have no effect on an
AppWizard-generated SDI applications. The Maximized and Minimized options
for the Main Frame Window in the Window Styles tab have no effect when
selected for an SDI application.
<P>
The message generated in Visual C++ version 4.0, 4.1, or 4.2 that says
these styles have no effect on Windows 95 is also wrong. The problem isn't
specific to Windows 95.
<P>
<P><h2>CAUSE</h2>
 
<P>
The AppWizard-generated code does not have code to show the main window
maximized or minimized. MFC code shows the main window with value passed
into the program through the nCmdShow argument to WinMain. This value is
normally SW_NORMAL and hence the window will not be maximized or minimized.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
MFC stores the value passed through the nCmdShow argument to WinMain in
CWinApp::m_nCmdShow. This variable can be modified to get the behavior you
want. To have an SDI application initially maximized or minimized, set
this variable to the appropriate value. Set m_nCmdShow to SW_SHOWMAXIMIZED
to maximize or SW_SHOWMINIMIZED to minimize the main frame window
initially. This variable has to be modified in the InitInstance() function
of the CWinApp-derived class before the main window is made visible.
<P>
In the Visual C++ 4.0 or 4.1 AppWizard-generated application, set this
variable before this line:
<P>
<PRE>   if (!ProcessShellCommand(cmdInfo))
      return FALSE;

</PRE>If the application was generated with an earlier version of Visual C++,
set m_nCmdShow to the appropriate value before this line:
<P>
<PRE>   OnFileNew();

</PRE>In the Visual C++ 4.2 AppWizard-generated application do the following:
<P>
<PRE>    if  (!ProcessShellCommand(cmdInfo))
        return FALSE;

    m_pMainWnd-&gt;ShowWindow(SW_SHOWMAXIMIZED);

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. The problem was corrected in Visual C++
version 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample code shows the correct context in which m_nCmdShow has
to be modified and demonstrates how to show an sdi application initially
maximized.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   // Visual C++ 4.0, 4.1, or 4.2 AppWizard-generated SDI application
   BOOL CMyApp::InitInstance()
   {
   ...
      ParseCommandLine(cmdInfo);

           // Add the following line to initially maximize the Application.
           m_nCmdShow = SW_SHOWMAXIMIZED;

      // Dispatch commands specified on the command line.
      if (!ProcessShellCommand(cmdInfo))
         return FALSE;

      return TRUE;
   }

   // Visual C++ 2.0 AppWizard-generated SDI application.
   BOOL CMyApp::InitInstance()
   {
   ...
      AddDocTemplate(pDocTemplate);

           // Add the following line to initially maximize the Application.
           m_nCmdShow = SW_SHOWMAXIMIZED;

      // Create a new (empty) document
      OnFileNew();
   ...
   }

</PRE> 
<PRE>Keywords          : MfcMisc vcbuglist400 vcfixlist500 WizardIss kbprg kbbuglist kbfixlist
Technology        : kbMfc
Version           : 2.0 2.1 2.2 4.0 4.1 4.2
Platform          : NT WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
