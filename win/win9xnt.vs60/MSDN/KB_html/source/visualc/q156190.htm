

<HTML>
<HEAD>
<TITLE>FIX: LNK1170 Building Project's Makefile from Command Line </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156190">
<META NAME="KBModify" CONTENT="1997/09/19">
<META NAME="KBCreate" CONTENT="1996/09/18">
<META NAME="Keywords" CONTENT="LinkIss NmakeIss vcbuglist400 vcfixlist500 kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When using the NMAKE utility to build a large project created in Visual C++, you may encounter the following error:     fatal error LNK1170: line in command file contains 16383 or more    characters  CAUSE =====  Visual C++ generates the project ma...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QBFY,QA56,QAH4,QAJN,QBXT,QDKW,QA6E,QAB7,QAGU,QA5V,QAIB,QAPN,QAG0,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: LNK1170 Building Project's Makefile from Command Line</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156190</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Program Maintenance Utility (Nmake.exe) included with:
   - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using the NMAKE utility to build a large project created in Visual
C++, you may encounter the following error:
<P>
<PRE>   fatal error LNK1170: line in command file contains 16383 or more
   characters

</PRE><h2>CAUSE</h2>
 
<P>
Visual C++ generates the project makefile such that all of the object
modules are placed on one line in an inline response file for LINK. LINK
cannot accept more than 16383 characters on one line.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two workarounds:
<P>
<P><h3>Workaround 1: A New Makefile</h3>
 
<P>
Copy the project makefile and edit the copy. The object modules are listed
in the LINK32_OBJS macro. To work around the problem, use macro
substitution to insert newline charaters after each object module so that
each object module is specified on a separate line. You need to use the
following macro substitution in your project makefile:
<P>
<PRE>   $(LINK32_OBJS:"  "="^
   ")

</PRE>For example, a typical link line in a makefile looks similar to the
following:
<P>
<PRE>   "$(OUTDIR)\anapp.exe" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
       $(LINK32) @&lt;&lt;
    $(LINK32_FLAGS) $(LINK32_OBJS)
   &lt;&lt;

</PRE>Change the third line of the above sample to the following:
<P>
<PRE>   "$(OUTDIR)\anapp.exe" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
       $(LINK32) @&lt;&lt;
    $(LINK32_FLAGS) $(LINK32_OBJS:"  "="^
   ")
   &lt;&lt;

</PRE>Notice the two white spaces between the initial set of quotes.
<P>
You need to use the workaround for both the debug build and the release
build of your project. If you have any other project configurations, you
need to apply the workaround to those as well.
<P>
Then use NMAKE on the new makefile to build your project.
<P>
<P><h3>Workaround 2: Static Libraries</h3>
 
<P>
Break up your project into a main top-level project and several static
libraries as sub-projects. Static libraries are simply a collection of
object modules. You can organize your project into several such
collections, but you must have at least one module in your top-level
project--the one containing the entry point of your program.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in the Microsoft products
listed at the beginning of this article. This bug was corrected in Visual
C++ version 5.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Visual C++ version 4.2, Visual C++ Books Online; click Visual C++ Books,
User's Guides, Visual C++ User's Guide, Working with Projects, Using
Projects, and then click the "Inserting and Deleting Projects" topic.
<P>
Visual C++ version 4.2, Visual C++ Books Online; click Visual C++ Books,
User's Guides, Visual C++ User's Guide, NMAKE Reference, and then the
"NMAKE Reference" topic.
<P>
Visual C++ version 4.2, Visual C++ Books Online; click Visual C++ Books,
User's Guides, Visual C++ User's Guide, Working with Projects, Managing
Project Workspaces, Creating a Project Workspace, and the "Project Types"
topic.
<P>
Visual C++ version 4.2, Visual C++ Books Online; click Visual C++ Books,
User's Guides, Visual C++ User's Guide, NMAKE Reference, Macros and NMAKE,
Using an NMAKE Macro, and then click the "Macro Substitution" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.61.6038<BR>
Keywords          : LinkIss NmakeIss vcbuglist400 vcfixlist500 kbtool<BR>
Version           : 4.0 4.1 4.2<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
