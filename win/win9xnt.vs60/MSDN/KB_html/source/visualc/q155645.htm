

<HTML>
<HEAD>
<TITLE>ActiveX Control Fails in Visual Basic but Works Fine in MFC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155645">
<META NAME="KBModify" CONTENT="1997/10/15">
<META NAME="KBCreate" CONTENT="1996/09/04">
<META NAME="Keywords" CONTENT="MfcOLE">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article documents known problems that can cause an ActiveX control to fail to work in Visual Basic for Windows while still allowing the control to work successfully in an MFC control container.  MORE INFORMATION  Occasionally an ActiveX contro...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QAPN,QA7O,QAMN,QAOE,QAHV,QAGI,QA5F,QAMA,QBBI,QAO4,QAKP,QAP2,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ActiveX Control Fails in Visual Basic but Works Fine in MFC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155645</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2
<LI>Microsoft Visual Basic for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article documents known problems that can cause an ActiveX control to
fail to work in Visual Basic for Windows while still allowing the control
to work successfully in an MFC control container.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Occasionally an ActiveX control works successfully in an MFC control
container but fails when used in Visual Basic. The failure in Visual Basic
is usually caused by a problem with the control. The following are known
problems that can cause this type of behavior.

<UL><LI>The control has been created with the simple frame option specified in
   ControlWizard but there is no call to the COleControl::EnableSimpleFrame
   method.
<P>
   By default, if the simple frame option is specified, ControlWizard
   adds a call to EnableSimpleFrame to the COleControl-derived class's
   constructor. ControlWizard also adds the OLEMISC_SIMPLEFRAME
   MiscStatus bit to the status bits for the control. If the call to
   EnableSimpleFrame is removed but the OLEMISC_SIMPLEFRAME MiscStatus
   bit is still specified, Visual Basic crashes with an Access Violation
   when the control is added to a form.
<P>
   If the OLEMISC_SIMPLEFRAME MiscStatus bit is turned on for a
   control, the COleControl::EnableSimpleFrame method must be called.

<LI>The control has been given a property that is declared as type BSTR in
   the control's .odl file, but which is really of some other type, such as
   long, short, or double. Typically this kind of type mismatch happens
   when the .odl file for the control has been manually edited rather than
   letting ClassWizard handle the adding and removing of properties.
<P>
   In order for the problem to occur, the property must have been
   added via ClassWizard as a non-BSTR type and have been implemented
   as a member variable, not as Get/Set methods. If the control's .odl
   file is manually edited and the type of the property is then changed to
   BSTR but the corresponding control member variable type and dispatch map
   entry are not changed to reflect the new type, Visual Basic can crash
   with an Access Violation when the control is added to a form.

<LI>A control implements a property, event, or method that has the
   same name as one of Visual Basic's extended properties, events, or
   methods.
<P>
   For example, if the control implements properties named DragIcon or
   DragMode, the problem might occur.
<P>
   To avoid the problem, rename the conflicting property, event, or
   method.
<P>
</UL>NOTE: For information on all of Visual Basic's extended properties,
methods, and events, please refer to the online topic "Object Property" in
Visual Basic 5.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: VB OCX<BR>
Keywords          : MfcOLE<BR>
Technology        : kbMfc<BR>
Version           : Windows NT:4.0,4.1,4.2<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
