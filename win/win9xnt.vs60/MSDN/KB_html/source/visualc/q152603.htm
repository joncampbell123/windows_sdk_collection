

<HTML>
<HEAD>
<TITLE>FIX: Masked Edit Tab Order Incorrect If Visible Property FALSE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152603">
<META NAME="KBModify" CONTENT="1997/09/19">
<META NAME="KBCreate" CONTENT="1996/06/18">
<META NAME="Keywords" CONTENT="AppStudioIss MfcOLE vcbuglist400 vcfixlist500 kbusage kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Multiple Masked Edit OLE Controls that are not visible will not retain their original tab order after they are made visible.  If you insert more than one Microsoft Masked Edit Ole Control into a dialog resource wrapped by a MFC Class (CDialog, CFor...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAHP,QBXS,QA9Q,QAPN,QAHV,QAR4,QACI,QARP,QA01,QAM1,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Masked Edit Tab Order Incorrect If Visible Property FALSE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152603</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Multiple Masked Edit OLE Controls that are not visible will not retain
their original tab order after they are made visible.
<P>
If you insert more than one Microsoft Masked Edit Ole Control into a dialog
resource wrapped by a MFC Class (CDialog, CFormView, CRecordView, or
CDaoRecordView), set the Visible Properties of the Controls to FALSE in the
Resource Editor at design time, and then call the ShowWindow on the
controls, the focus is set to the wrong control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If possible, leave the Visible property of the Microsoft Masked Edit OLE
Control set to TRUE.
<P>
If you call SetFocus on the first masked edit control, the focus is set
properly to that control, but if there are any other non-static controls
on the form, they will be inserted before the second masked edit control in
the tab order at run time.
<P>
SetWindowPos() can be used to set the z-order of a control. The tab order
in a dialog is synonymous with the Z-order, meaning that a control that is
first in the tab order will have a higher Z-order than a control that
follows it in the-Z order. A control with the WS_CLIPSIBLINGS window style
set that is overlapped by another control will not be painted in the area
that is overlapped. OLE controls have the WS_CLIPSIBLINGS window style set
by default.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual C++
version 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to reproduce a dialog-based MFC application. These
steps also apply if you choose either an SDI or MDI application with a
CFormView, CRecordView, or CDaoRecordView:

<OL><P><LI>Create an AppWizard dialog-based application with OLE Controls support.

<P><LI>Using the Component Gallery, insert a Microsoft Masked Edit OLE Control.

<P><LI>Place two masked edit controls on the dialog resource. Verify the tab
   order: the first control you placed on the dialog should be first in
   the tab order.

<P><LI>Set the Visible properties of both edit controls to FALSE.

<P><LI>Using the Class Wizard, create member variables of type "control" for
   both of the masked edit controls. For example:
<P>
<P><PRE>      CMsmask  m_Mask1;
      CMsmask  m_Mask2;
</PRE><P>
   where CMsmask is the class that the Component Gallery created to wrap
   the Microsoft Masked Edit OLE Control.

<P><LI>For the dialog's OnInitDialog method, run the following code:
<P>
<P><PRE>      m_Mask1.ShowWindow( SW_SHOW );
      m_Mask2.ShowWindow( SW_SHOW );
</PRE>
<P><LI>Build and run the program. The m_Mask2 object will be first in the tab
   order -- before m_Mask2.
<P>
</OL> 
<PRE>Keywords          : AppStudioIss MfcOLE vcbuglist400 vcfixlist500 kbusage kbbuglist kbfixlist
Technology        : kbMfc kbole
Version           : 4.0 4.1 4.2
Platform          : NT WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
