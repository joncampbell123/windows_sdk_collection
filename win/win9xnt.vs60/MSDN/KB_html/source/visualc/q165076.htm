

<HTML>
<HEAD>
<TITLE>INFO: LNK2001 Error ATL Release Build </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165076">
<META NAME="KBModify" CONTENT="1997/06/25">
<META NAME="KBCreate" CONTENT="1997/03/12">
<META NAME="Keywords" CONTENT="AtlControl AtlServer kbprg kbusage kbinfo">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Microsoft Active Template Library COM AppWizard generates a release build of your project using macro _ATL_MIN_CRT. Selecting this configuration causes the C-Runtime (CRT) library startup code to not be linked into your project. If you use function...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDIV,QABY,QALM,QBHQ,QABG,QAA5,QAY5,QAEF,QAB4,QAAP,QBV4,QBV8,QAY2,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: LNK2001 Error ATL Release Build</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165076</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Template Library, versions 2.0, 2.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Active Template Library COM AppWizard generates a release build
of your project using macro _ATL_MIN_CRT. Selecting this configuration
causes the C-Runtime (CRT) library startup code to not be linked into your
project. If you use functions or code in your project that require the use
of the C-Runtime library startup code, you may experience LNK2001 -
unresolved external errors when you try to build the release version of
your project.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use some C-Runtime functions without requiring the CRT startup
code. Examples include the mem* functions. Other functions require the CRT
startup code. CRT string comparisons for example require the startup code
as the CRT initializes some tables used for comparing. Global objects that
have constructors also require the startup code. In Visual C++ 5.0,
statically linking the startup code adds about 25K to your image(In Visual
C++ 4.2 it is about 20K).
<P>
Following are some suggestions for finding the cause of the LNK2001
errors:

<UL><LI>In the linker options there is an "ignore libraries" edit box. Enter
   Libcmt.lib into it, and build. You get several unresolved externals.
   This list is everything that you are using from the CRT. Look for
   things that you think may be pulling in the startup code and remove
   them if you can.

<LI>Don't ignore Libcmt.lib, but turn on the verbose flag for the linker.
   From this, you can see what is triggering CRT startup code to get
   pulled in.
<P>
</UL>If you decide that you really need the startup code, then remove the
_ATL_MIN_CRT define from the project settings. You can also dynamically
link to the CRT, which reduces your image size but requires the CRT's DLL.
If you turn on exception handling you have to pull in the startup code.
Even when building minsize the default is to statically link to the CRT
and use _ATL_MIN_CRT.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : AtlControl AtlServer kbprg kbusage kbinfo<BR>
Technology          : kbAtl kbole kbInetDev<BR>
Version             : 2.00 2.10<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
