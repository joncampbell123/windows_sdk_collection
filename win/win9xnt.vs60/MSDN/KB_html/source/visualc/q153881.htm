

<HTML>
<HEAD>
<TITLE>How To Assign the ActiveX Control LPDispatch Property in VB 4 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153881">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1996/07/22">
<META NAME="Keywords" CONTENT="CDKIss MfcOLE kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  It is often useful for one ActiveX (OLE) Control to hold an LPDispatch pointer to another control on the same Visual Basic form. The first control can use this pointer to call methods and/or access properties on the second control using OLE Automat...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAMN,QBS0,QAPN,QAOE,QAHV,QBXS,QAO3,QAO2,QA9Q,QAGI,QBWC,QBCF,QAYL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Assign the ActiveX Control LPDispatch Property in VB 4</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153881</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.10 4.20
WINDOWS NT
kbole kbprg
<P>
 
The information in this article applies to:
<P>
- The Microsoft Foundation Classes (MFC), included with:
<PRE>  Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
It is often useful for one ActiveX (OLE) Control to hold an LPDispatch
pointer to another control on the same Visual Basic form. The first control
can use this pointer to call methods and/or access properties on the second
control using OLE Automation. This article demonstrates how to create a
property of type LPDispatch on an MFC ActiveX Control, and how to properly
set this property to another control's IDispatch pointer in Visual Basic.
<P>
NOTE: Although this article discusses properties of type LPDispatch, this
information also applies to properties of type LPUnknown.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Follow these steps to add a property to a custom ActiveX control that
is to hold another control's IDispatch pointer:

<OL><P><LI>Using ClassWizard, add a property of type LPDispatch to the control.
   Fill in a name for the property, and select the "Member Variable"
   button for this property.

<P><LI>Next, you must initialize this member variable to NULL in the
   control's constructor. If you do not, Visual Basic will cause a General
   Protection Fault when you try to assign a value to it. This occurs
   because MFC tries to call Release() on the uninitialized pointer.
   If the pointer is set to NULL, Release() will not be called by MFC.

<P><LI>Build the control, and place it on a form in Visual Basic.
<P>
</OL>The following lines of Visual Basic code demonstrate how to set the
property to another control's IDispatch pointer:
<P>
<PRE>   'Set the control's DispatchProp property to the DBCombo OLE control on
   'this form.
   Set MyOcx1.DispatchProp = DBCombo1

     . . .
     . . .

   'Don't forget to set this property to Nothing when finished
   Set MyOcx1.DispatchProp = Nothing

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
ARTICLE_ID: <B><A href="../visualc/q141414.htm">Q141414</A></B>
<PRE>TITLE     : How to Enumerate OLE and VB Controls from an OLE Control

</PRE>Visual C++ Books Online, Programming with MFC Encyclopedia.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.10 4.20 kbinf<BR>
KBCategory: kbole kbprg<BR>
KBSubcategory: MfcOle CDKIss<BR>
Keywords          : CDKIss MfcOLE kbole kbprg<BR>
Technology        : kbMfc<BR>
Version           : 4.00 4.10 4.20<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
