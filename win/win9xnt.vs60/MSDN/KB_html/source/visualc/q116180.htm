

<HTML>
<HEAD>
<TITLE>BUG: Escape Key Deactivation of In-Place Item in OLE Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116180">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/06/13">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Unless an Object Linking and Embedding (OLE) Visual Editing container processes the ESC key itself to deactivate the active item, the only way to deactivate an item embedded from Visual Editing server (created with AppWizard) is to click with the m...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9Q,QA55,QA56,QBMR,QAB5,QAGH,QAGB,QBXS,QBVV,QAW6,QAM2,QAH6,QBSO,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Escape Key Deactivation of In-Place Item in OLE Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116180</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 1.51 1.52
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++ for Windows, versions 1.5, 1.51, and 1.52
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Unless an Object Linking and Embedding (OLE) Visual Editing container
processes the ESC key itself to deactivate the active item, the only way to
deactivate an item embedded from Visual Editing server (created with
AppWizard) is to click with the mouse outside of the server window that is
in place.
<P>
<P><h2>CAUSE</h2>
 
<P>
By default, OLE Visual Editing servers created with AppWizard do not
provide this functionality.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information is from the README.WRI file provided with
Visual C++ for Windows, version 1.5:
<P>
<PRE>    The OLE 2.0 specification states that both servers and containers
    should process the ESC key to end in-place activation. Any OLE
    Visual Editing container application created with AppWizard will
    automatically provide an accelerator key and a handler to do this.
    OLE Visual Editing servers created with AppWizard, however, will
    not provide this functionality automatically. If either the
    container or the server does not process the ESC key to deactivate
    the active item, the only way the application user can deactivate
    such a server is to click with the mouse outside of the in-place
    server window. Because AppWizard does not automatically implement
    the ESC key handler in the server application, you should
    implement one by doing the following:

    1) Add an accelerator for VK_ESCAPE to your in-place server's
       accelerator table. This accelerator table should have the same
       ID as your server's in-place menu resource. The default ID
       generated from AppWizard is IDR_&lt;&lt;PROJNAME&gt;&gt;TYPE_SRVR_IP.

    2) Using ClassWizard, add a handler for the VK_ESCAPE accelerator.
       In a typical application, you will want to implement the
       handler in the COleServerDoc-derived class. The handler should
       attempt to deactivate the in-place item only if the document is
       in-place active. For example:

             void CMyServerDoc::OnCancelInplace()
             {
                 if (IsInPlaceActive())
                     OnDeactivateUI();
             }

</PRE>This problem does not occur with Visual C++ 32-bit Edition. AppWizard
generates the accelerator and the code to handle this situation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.50 2.5 2.50 2.51 2.52<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: MfcOLE<BR>
Keywords            : kb16bitonly<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
