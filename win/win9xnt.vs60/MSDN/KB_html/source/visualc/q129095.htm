

<HTML>
<HEAD>
<TITLE>INFO: Format of the Document Template String </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129095">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1995/04/18">
<META NAME="Keywords" CONTENT="kbprg kbusage MfcDocView kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article explains the format of the document template string.  MORE INFORMATION  The document template string is a string resource consisting of up to nine Sub-strings separated by the \n character. Each sub-string contains information specific...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QAGU,QATX,QAP2,QBVV,QA36,QBBI,QAPF,QABA,QDO9,QARM,QBWA,QBVP,QAML,QAG4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Format of the Document Template String</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129095</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
<P>
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
    - Microsoft Visual C++ 32-bit Edition, versions 1.0, 2.0, 2.1, 4.0
      4.1, 4.2, 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains the format of the document template string.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The document template string is a string resource consisting of up to nine
Sub-strings separated by the \n character. Each sub-string contains
information specific to the document template. The document template string
is contained in the document template and can be edited by the Resource
Editor (AppStudio).
<P>
<P><h3>Format of the Document Template String</h3>
 
<P>
NOTE: If a sub-string is not wanted and therefore not included in the
complete document template string, you must still use the \n character as a
delimiter. However, trailing \n characters are not necessary.
<P>
<PRE>      IDR_MAINFRAME &lt;windowTitle&gt;\n&lt;docName&gt;\n&lt;fileNewName&gt;\n
                    &lt;filterName&gt;\n &lt;filterExt&gt;\n&lt;regFileTypeID&gt;\n
                    &lt;regFileTypeName&gt;\n &lt;filterMacExt(filterWinExt)&gt;\n
                    &lt;filterMacName(filterWinName)&gt;

</PRE>The following table defines each of the substrings:
<P>
<PRE>Substring          Definition
</PRE> 
<PRE>&lt;windowTitle&gt;      Name that appears in the application window's title bar
                   (for example, "Microsoft Excel"). Present only in the
                   document template for SDI applications.

&lt;docName&gt;          Root for the default document name (for example,
                   "Sheet"). This root plus a number is used for
                   the default name of a new document of this type
                   whenever the user chooses the New command from the
                   File menu (for example, "Sheet1" or "Sheet2"). If not
                   specified, "Untitled" is used as the default.

&lt;fileNewName&gt;      Name of this document type. If the application supports
                   more than one type of document, this string is
                   displayed in the File New dialog box (for example,
                   "Worksheet"). If not specified, the document type is
                   inaccessible using the File New command.

&lt;filterName&gt;       Description of the document type and a wildcard filter
                   matching documents of this type. This string is
                   displayed in the List Files Of Type drop-down list in
                   the File Open dialog box (for example, "Worksheets
                   (*.XLS)"). If not specified, the document type is
                   inaccessible using the File Open command.

&lt;filterExt&gt;        Extension for documents of this type (for example,
                   ".XLS"). If not specified, the document type is
                   inaccessible using the File Open command.

&lt;regFileTypeId&gt;    Identifier for the document type to be stored in the
                   registration database maintained by Windows. This
                   string is for internal use only (for example,
                   "ExcelWorksheet").If not specified, the document type
                   cannot be registered with the Windows File Manager.

</PRE>&lt;regFileTypeName&gt;  Name of the document type to be stored in the
<PRE>                   registration database. This string may be
                   displayed in dialog boxes of applications that
                   access the registration database (for example,
                   "Microsoft Excel Worksheet").

</PRE>The final two sub-strings are defined conditionally. When _MAC is defined,
the sub-strings are assigned to &lt;filterName&gt; and &lt;filterExt&gt;, while the two
sub-strings that normally have these names are defined as &lt;filterWinName&gt;
and &lt;filterWinExt&gt;. When _MAC is not defined, the two new sub-strings are
assigned the names &lt;filterMacName&gt; and &lt;filterMacExt&gt;.
<P>
These last two sub-strings allow references to filename extensions to be
removed from filterName and allow the four-character Macintosh file type
for your application to be specified in filterExt.
<P>
<P><h3>Example</h3>
 
<P>
This example is the document template string used in the Scribble step 4
example provided with Visual C++ version 2.1.
<P>
NOTE: _MAC is not defined. Also, the first sub-string is not used in MDI
applications. Therefore, a document template string for an MDI application
begins with the \n character.
<P>
<PRE>      IDR_SCRIBTYPE \nScrib\nScrib\nScrib Files (*.scr)\n.SCR
                    \nScribble.Document.1\nScrib Document
                    \nSCRI\nscri Files

      &lt;windowTitle&gt;      Not used due to MDI application.
      &lt;docName&gt;          Scrib
      &lt;fileNewName&gt;      Scrib
      &lt;filterName&gt;       Scrib Files (*.scr)
      &lt;filterExt&gt;        .SCR
      &lt;regFileTypeId&gt;    Scribble.Document.1
      &lt;regFileTypeName&gt;  Scrib Document
      &lt;filterMacExt&gt;     SCRI
      &lt;filterMacName&gt;    scri Files

</PRE><h3>Platform Differences</h3>
 
<P>
The string resource is parsed into the following sub-strings based on the
platform:
<P>
Win16
<PRE>   windowTitle      - default window title
   docName          - user visible name for default document
   fileNewName      - user visible name for FileNew
   filterName       - user visible name for FileOpen
   filterExt        - user visible extension for FileOpen
   regFileTypeId    - REGEDIT visible registered file type identifier
   regFileTypeName  - Shell visible registered file type name

</PRE>Win32
<PRE>   windowTitle      - default window title
   docName          - user visible name for default document
   fileNewName      - user visible name for FileNew
   filterName       - user visible name for FileOpen
   filterExt        - user visible extension for FileOpen
   regFileTypeId    - REGEDIT visible registered file type identifier
   regFileTypeName  - Shell visible registered file type name
   filterMacExt     - Macintosh file type for FileOpen
   filterMacName    - user visible name for Macintosh FileOpen
</PRE>NOTE: The last two are not documented in Visual C++ 5.0.
<P>
Win32 Mac
<PRE>   windowTitle      - default window title
   docName          - user visible name for default document
   fileNewName      - user visible name for FileNew
   filterWinName    - user visible name for FileOpen
   filterWinExt     - user visible extension for FileOpen
   regFileTypeId    - REGEDIT visible registered file type identifier
   regFileTypeName  - Shell visible registered file type name
   filterExt        - Macintosh file type for FileOpen
   filterName       - user visible name for Macintosh FileOpen

</PRE><h2>REFERENCES</h2>
 
<P>
Search in Books Online for the following topics:

<UL><LI>Doc Template Files
<LI>Resource Editors
<LI>CDocTemplate::GetDocString
<LI>CSingleDocTemplate::CsingleDocTemplate
<LI>CMultiDocTemplate::CmultiDocTemplate
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: appstudio resource<BR>
Keywords            : kbprg kbusage MfcDocView kbprg<BR>
Technology          : kbMfc<BR>
Version             : 1.0 1.5 1.52 2.0 4.1 4.2 5.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
