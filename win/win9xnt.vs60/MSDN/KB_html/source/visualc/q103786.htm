

<HTML>
<HEAD>
<TITLE>HOWTO: Change Window Background Color with Foundation Classes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103786">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/08/30">
<META NAME="Keywords" CONTENT="MfcUI kbfasttip kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  To change the background color for a CView, CFrameWnd, or CWnd object, process the WM_ERASEBKGND message. The sample code below demonstrates how to do this.  MORE INFORMATION  Sample Code     BOOL CSampleView::OnEraseBkgnd(CDC* pDC)    {       // S...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QABO,QARL,QBSO,QAUD,QAEV,QAH4,QDL9,QBWQ,QBWO,QBWN,QAGQ,QBFY,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Change Window Background Color with Foundation Classes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103786</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
    - Microsoft Visual C++, 32-bit Edition, version 1.0, 2.0, 2.1, 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To change the background color for a CView, CFrameWnd, or CWnd object,
process the WM_ERASEBKGND message. The sample code below demonstrates
how to do this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   BOOL CSampleView::OnEraseBkgnd(CDC* pDC)
   {
      // Set brush to desired background color
      CBrush backBrush(RGB(255, 128, 128));

      // Save old brush
      CBrush* pOldBrush = pDC-&gt;SelectObject(&amp;backBrush);

      CRect rect;
      pDC-&gt;GetClipBox(&amp;rect);     // Erase the area needed

      pDC-&gt;PatBlt(rect.left, rect.top, rect.Width(), rect.Height(),
          PATCOPY);
      pDC-&gt;SelectObject(pOldBrush);
      return TRUE;
   }

</PRE>To change the background color for a CMDIFrameWnd, you must subclass the
multiple document interface (MDI) client window (window in the client area
of CMDIFrameWnd) and process the WM_ERASEBKGND message. For more
information about the MDI client window in an MDI application, see chapter
18 in "Programming Windows 3.1 - Third Edition" by Charles Petzold. For an
example that shows how to subclass the MDICLIENT window, please see the
article in the Microsoft Knowledge Base:
<P>
<PRE>    ARTICLE-ID: <B><A href="../visualc/q129471.htm">Q129471</A></B>
    TITLE     : HOWTO: Subclass the MDICLIENT by Using MFC

</PRE>To change the background color of an MDI client window (client area of a
CMDIFrameWnd), perform the following steps using an AppWizard-generated
application:

<OL><P><LI>Create a generic CWnd class with ClassWizard.

<P><LI>Add a member variable, using the type of the CWnd class from step
   1, to the CMainFrame class.

<P><LI>In the CMainFrame's OnCreate member function, after the call to the
   base class CMDIFrameWnd::OnCreate(), add a call to SubclassWindow().
   For example:
<P>
<P><PRE>      if (!m_wndNewClient.SubclassWindow(m_hWndMDIClient))
      {
<PRE></PRE>        TRACE("Failed to subclass MDI client window\n");
        return -1;      // fail to create
      }

   m_hWndMDIClient is the member variable of CMDIFrameWnd that
   contains the handle to the MDI client window. Also, replace
   "m_wndNewClient" with the data member that you created in step 2.

</PRE><P><LI>Whenever a window is subclassed, the GetSuperWndProcAddr() member
   function for the CWnd needs to be overridden to provide storage for
   the old window procedure's address. To do that, add the following
   function to the implementation of the CWnd class created in step 1:
<P>
<P><PRE>      WNDPROC* CNewClientWnd::GetSuperWndProcAddr()
      {
<PRE></PRE>         static WNDPROC NEAR pfnSuper = NULL;
         return &amp;pfnSuper;
      }

   NOTE: Replace "CNewClientWnd" above with the name of your class.

   For more information on subclassing windows using the Microsoft
   Foundation Classes, please see the following materials:

   - "Class Library Reference" for functions CWnd::SubclassWindow(),
     CWnd::GetSuperWndProcAddr(), and CWnd::SubclassDlgItem()

   - Query on the following words in the Microsoft Knowledge Base:

     subclass and sample and mfc

   - See the CTRLTEST MFC sample application that is provided with
     Visual C++ for Windows and Visual C++ 32-bit Edition.

   - See the article titled "Subclassing Windows with the Microsoft
     Foundation Class Library" on the Microsoft Developer Network
     (MSDN) CD.

</PRE><P><LI>Override the WM_ERASEBKGND message for the generic CWnd class,
   using the code listed above.
<P>
</OL>To change the background color of a CFormView object, either process
the WM_ERASEBKGND message and use the code above or process the
WM_CTLCOLOR message to change the background color.
<P>
For more information on changing the background color of a dialog box
by processing the WM_CTLCOLOR message, please query on the following
words in the Microsoft Knowledge Base:
<P>
<PRE>   changing and background and color and MFC
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : MfcUI kbfasttip kbhowto<BR>
Technology          : kbmfc<BR>
Version             : 1.0 1.5 1.51 1.52 2.0 2.1 4.0<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
