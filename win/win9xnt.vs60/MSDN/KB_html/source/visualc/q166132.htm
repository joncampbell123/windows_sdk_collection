

<HTML>
<HEAD>
<TITLE>PRB: Dialog With RichEdit May Fail During Creation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166132">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1997/03/31">
<META NAME="Keywords" CONTENT="MfcUI kberrmsg kbui kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Dialog creation may fail if the dialog template has a Rich edit control in it. This template may be used in a dialog, CformView, or property page.  The following error messages may appear in the IDE output window when you execute the program in the...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QAB4,QAHP,QAY5,QBXR,QBVV,QAIB,QAIA,QAGI,QA36,QADK,QA7O,QAOE,QAMN,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Dialog With RichEdit May Fail During Creation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166132</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Dialog creation may fail if the dialog template has a Rich edit control in
it. This template may be used in a dialog, CformView, or property page.
<P>
The following error messages may appear in the IDE output window when you
execute the program in the debugger with the debug build. No error message
or warning is given if you execute the program outside the debugger or with
the release build.
<P>
Dialog or Property Page:
<P>
<PRE>   Warning: Dialog creation failed!

</PRE>CFormView:
<P>
<PRE>   Warning: Dialog creation failed!
   Warning: could not create view for frame.
   Failed to create client pane/view for frame.
   Warning: CDocTemplate couldn't create a frame.

</PRE>In the case of a CformView, the following message also appears:
<P>
<PRE>   Failed to create empty document.

</PRE><h2>CAUSE</h2>
 
<P>
The Rich Edit control is not initialized.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Call the MFC global function AfxInitRichEdit before you create the dialog
to initialize the Rich Edit Control. A good place to initialize the Rich
Edit control is in the application's InitInstance function before you
create the dialog.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With the new dialog editor in Visual C++ 5.0, it is possible to add a Rich
Edit control into a dialog template by dragging the control from the
control palette. However, doing this in the dialog editor does not ensure
that the required Riched32.dll library will be loaded before the Rich Edit
control is created. In Win32 SDK, it is necessary to call the LoadLibrary
function to load Riched32.dll before the dialog creation. In MFC, the
global function AfxInitRichEdit does this for you. All you need to do is
call this function before you create the dialog.
<P>
Please use the online help to get more information on AfxInitRichEdit
function.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Dialog Scenario:
<P>
The follow scenario reproduces the problem described above with a dialog.

<OL><P><LI>Create a new project as follows: File\New\Projects\MFC AppWizard(exe).

<P><LI>Create a Dialog based application, and then click Finish.

<P><LI>Add a Rich Edit control to the main dialog template in the dialog
   editor.

<P><LI>Build the application.

<P><LI>Press the F5 key to start the debugger. Notice that the application does
   not display the dialog.

<P><LI>Observe the following in the Output window in IDE:
<P>
<P><PRE>      ...
      Warning: Dialog creation failed!
      ...
</PRE><P>
</OL>CformView Scenario:
<P>
The follow scenario reproduces the problem described above with a
CFormView.

<OL><P><LI>Create a new project as follows: File\New\Projects\MFC AppWizard(exe).

<P><LI>Create a SDI or MDI application and in step 6 of Appwizard select
   CFormview as the Base class for the view.

<P><LI>Add a Rich Edit control to the main dialog template for the formview
   in the dialog editor.

<P><LI>Build the application.

<P><LI>Press the F5 key to start the debugger. Notice that a message box
   appears indicating that the empty document could not be created.

<P><LI>Observe the following in the Output window in IDE:
<P>
<PRE>        ...
      Warning: Dialog creation failed!
      Warning: could not create view for frame.
      Failed to create client pane/view for frame.
      Warning: CDocTemplate couldn't create a frame.
        ...
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: CreatDialogIndirect DoModal RichEdit CFormView<BR>
Keywords          : MfcUI kberrmsg kbui kbfasttip<BR>
Technology        : kbmfc<BR>
Version           : 5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
