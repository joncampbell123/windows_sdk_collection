

<HTML>
<HEAD>
<TITLE>BUG: ClassWizard Does Not Display Messages for VBX Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102668">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1993/08/08">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Even though the object ID of a VBX control is highlighted in Class Wizard, the Messages list box does not show any messages. The VBX control may appear to be installed in App Studio and it may even appear on the control palette when this occurs.  Y...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAA1,QDI2,QBVV,QAEV,QAPN,QAHV,QAYC,QAL2,QBWS,QAG2,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ClassWizard Does Not Display Messages for VBX Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102668</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbtool kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The ClassWizard included with:
   Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Even though the object ID of a VBX control is highlighted in Class Wizard,
the Messages list box does not show any messages. The VBX control may
appear to be installed in App Studio and it may even appear on the control
palette when this occurs.
<P>
You can demonstrate this with IDC_CIRCLE in the CCircleDialog class in the
VBCIRCLE example.
<P>
<P><h2>CAUSE</h2>
 
<P>
There are two causes of this behavior, as follows:

<UL><LI>If you do not explicitly install a VBX control using the App Studio
   Install Controls option, message information is not available to
   Class Wizard. If you open, in App Studio, a dialog box that
   contains a VBX control, App Studio marks the VBX as installed and
   adds the control to the control palette, but event information is
   not available until you explicitly install the control.

<LI>If you manually modify the resource file for the VBX control, Class
   Wizard may not recognize the special format CONTROL statement a VBX
   requires. When you install a VBX control, it is queried for
   messaging and name information. The name information is case
   sensitive. If the case of either of the first two parameters of the
   CONTROL statement does not match the parameters stored in
   APSTUDIO.INI that App Studio uses to query the information, Class
   Wizard does not show information about the events.
<P>
</UL>With regard to the VBCircle example, the CCircleDialog class encapsulates a
dialog box that contains a CIRC3.VBX control. The CONTROL statement in the
RC file for CIRC3.VBX does not specify the required information with the
correct case. Therefore, you cannot see messages for IDC_CIRCLE even if you
correctly install CIRC3.VBX.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If Class Wizard does not display messages for a particular VBX
control, perform the following four steps:

<OL><P><LI>Choose Install Controls from the App Studio File menu.

<P><LI>If the VBX is not installed, select it on the search path and
   choose Install.

<P><LI>If the VBX is already installed, select it and choose Remove. Then
   select it on the search path and choose Install.

<P><LI>Choose Close to save the control installation changes.
<P>
</OL>To monitor messages for the VBCircle control, edit the VBCIRCLE.RC file
with a text editor. Change the CONTROL statement to read as follows:
<P>
CONTROL "CIRC3.VBX;CIRC3;",...
<P>
Then load the IDD_CIRCLE_DLG dialog box into AppStudio and select
File.Save. This will re-set the ClassWizard information and you will then
be able to see the notification messages. Note that CIRC3.VBX needs to have
been properly installed in ApStudio as listed above.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in App Studio versions 1.0 and
1.5 for Windows. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 notification message handlers threed<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: WizardIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
