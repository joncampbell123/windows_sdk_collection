

<HTML>
<HEAD>
<TITLE>FIX: Using CEditView and _AFXDLL Fails on Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113423">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1994/04/04">
<META NAME="Keywords" CONTENT="kb16bitonly MfcUI kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Running an application that uses the CEditView class from the Microsoft Foundation Class (MFC) Libraries in conjunction with an _AFXDLL dynamic- link library (DLL) causes the following error to be generated when the application is run on Windows NT...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDL9,QBWQ,QBWN,QBWO,QBWS,QAKP,QAR4,QAC1,QBHQ,QBFY,QA56,QA55,QAH7,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Using CEditView and _AFXDLL Fails on Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113423</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++ for Windows, version 1.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Running an application that uses the CEditView class from the Microsoft
Foundation Class (MFC) Libraries in conjunction with an _AFXDLL dynamic-
link library (DLL) causes the following error to be generated when the
application is run on Windows NT version 3.1:
<P>
<PRE>   &lt;Application Name&gt; caused an exception in the Win16 Subsystem

   Click on CLOSE to terminate the application
   Click on CANCEL to debug the application
   Click on IGNORE to continue, you should save your work in a new file

</PRE>If the user chooses IGNORE, the program will continue safely.
<P>
<P><h2>CAUSE</h2>
 
<P>
The exception is caused by a bug in the Windows NT Win16 subsystem.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
As mentioned above the problem can safely be ignored by
selecting IGNORE when the exception occurs. However you may
wish to permanently prevent the exception from occurring.
<P>
The problem can be avoided by rebuilding the shared version of the MFC
library (MFC200.DLL or MFC200D.DLL) by changing line 44 of VIEWEDIT.CPP
from
<P>
<PRE>   static const UINT NEAR nMsgFindReplace =
       ::RegisterWindowMessage(FINDMSGSTRING);

</PRE>to the following:
<P>
<PRE>   static char BASED_CODE szFINDMSGSTRING[] = FINDMSGSTRING;
   static const UINT NEAR nMsgFindReplace =
       ::RegisterWindowMessage(szFINDMSGSTRING);

</PRE>Once the changes are made, the DLL (MFC250.DLL or MFC250D.DLL) must be
rebuilt. For further information on how to do this, see Appendix B of the
"Class Libraries User's Guide" or the file README.TXT in the MFC\SRC
directory (by default, \MSVC\MFC\SRC\README.TXT).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.1.
This problem has been corrected in MFC version 2.5 supplied with Visual
C++ version 1.5.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DLLHUSK MFC sample can be used to illustrate this problem. Running
DLLHUSK version 1.0 on Windows NT version 3.1 generates the exception
error. DLLHUSK version 1.0 is supplied with Visual C++ for Windows, version
1.0, and uses MFC version 2.0. Running DLLHUSK version 2.0 on Windows NT
version 3.1 does not generate the exception error. DLLHUSK version 2.0 is
supplied with Visual C++ for Windows, version 1.5, and uses MFC version
2.5.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: wow afxdll__afxdll 1.00 2.00<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: MfcUI<BR>
Keywords          : kb16bitonly MfcUI kbbuglist kbfixlist kbprg<BR>
Technology        : kbMfc<BR>
Version           : 1.00<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
