

<HTML>
<HEAD>
<TITLE>PRB: ATL EXE Server Built On Windows 95 Errors While Registering </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166217">
<META NAME="KBModify" CONTENT="1997/06/25">
<META NAME="KBCreate" CONTENT="1997/04/01">
<META NAME="Keywords" CONTENT="AtlControl AtlServer kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When building an Active Template Library (ATL) COM EXE server on a machine running Windows 95, you might get the message box that your server is linked to missing export from OLE32.DLL : CoSuspendClassObjects.  CAUSE =====  _WIN32_WINNT is defined ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QA01,QBWP,QDNF,QA3P,QDK6,QDH6,QAEF,QAH4,QAGQ,QBVV,QBHQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ATL EXE Server Built On Windows 95 Errors While Registering</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166217</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Active Template Library, version 2.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When building an Active Template Library (ATL) COM EXE server on a machine
running Windows 95, you might get the message box that your server is
linked to missing export from OLE32.DLL : CoSuspendClassObjects.
<P>
<P><h2>CAUSE</h2>
 
<P>
_WIN32_WINNT is defined in the Stdafx.h file and the problem is caused by
the following code in the generated project source file:
<P>
<PRE>   #if _WIN32_WINNT &gt;= 0x0400
      if (CoSuspendClassObjects() == S_OK)
         PostThreadMessage(dwThreadID, WM_QUIT, 0, 0);
   #else
      PostThreadMessage(dwThreadID, WM_QUIT, 0, 0);
   #endif

</PRE>It is caused by the definition of _WIN32_WINNT in Stdafx.h. In ATL 1.1 for
Visual C++ 4.2, this was not defined automatically, so users had to define
it themselves if they were using Windows NT 4.0 or Windows 95 with DCOM.
The majority of people will be targeting Windows NT 4.0 or Windows 95 with
DCOM, so it is automatically defined.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want to develop under Windows 95, you can simply remove the macro
from the generated Stdafx.h file. The problem also goes away when DCOM is
installed on Windows 95.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open a new ATL COM Project on Windows 95.

<P><LI>Choose EXE + Finish.

<P><LI>Build the project.
<P>
</OL>The output window contains the following text:
<P>
<PRE>   Linking....
   Performing registration
   A device attached to the system is not functioning.
   Server registration done!

</PRE></OL>Then the message box pops up informing you that the server EXE is linked to
missing export OLE32.DLL : CoSuspendClassObjects.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.10 CoSuspendClassObjects ATL<BR>
Keywords            : AtlControl AtlServer kbfasttip<BR>
Technology          : kbAtl kbInetDev<BR>
Version             : 2.1<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
