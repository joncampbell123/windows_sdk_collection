

<HTML>
<HEAD>
<TITLE>DOCERR: Mixed-Language Examples for Calling Pascal Are Incorrect </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q48251 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1989/08/22">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  In the  Microsoft C Advanced Programming Techniques  manual (APT) that shipped with Microsoft C versions 6.0, 6.0a, and 6.0ax, the  Microsoft C/C++ Programming Techniques  manual that shipped with version 7.0, the  Microsoft Mixed-Language Programm...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBFY,QAH4,QAAP,QAY5,QAB4,QAY2,QAD2,QAIF,QAB9,QAEF,QBV8,QBWA,QA4Q,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: Mixed-Language Examples for Calling Pascal Are Incorrect</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q48251 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a 6.00ax 7.00 | 6.00 6.00a | 1.00 1.50
<PRE>MS-DOS                 | OS/2       | WINDOWS
</PRE>kbprg kbdocerr
<P>
 
The information in this article applies to:

<UL><LI>Microsoft C for MS-DOS, versions 6.0, 6.0a, and 6.0ax
<LI>Microsoft C for OS/2, versions 6.0 and 6.0a
<LI>Microsoft C/C++ for MS-DOS, version 7.0
<LI>Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the "Microsoft C Advanced Programming Techniques" manual (APT) that
shipped with Microsoft C versions 6.0, 6.0a, and 6.0ax, the "Microsoft
C/C++ Programming Techniques" manual that shipped with version 7.0,
the "Microsoft Mixed-Language Programming Guide" provided with C
versions 5.0 and 5.1, MASM versions 5.0 and 5.1, and Pascal version
4.0, there is a sample Pascal module, Pfun, that is incorrect. Pfun
can be found in the following locations:
<P>
<P><h3>In the APT</h3>
 

<UL><LI>Page 295, Section 12.7.2 "Calling a Pascal Function from C"
<P>
</UL><h3>In the Programming Techniques manual</h3>
 

<UL><LI>Page 248, Section 11.7 "Calling a Pascal Function from C" (7.0)

<LI>Page 173, Section 8.7 "Calling a Pascal Function from C" (8.0)
<P>
</UL><h3>In the Mixed-Language Guide</h3>
 

<UL><LI>Page 30, Section 2.5.2 "Calling Pascal from Basic -- Function Call"

<LI>Page 44, Section 3.5.2 "Calling Pascal from C -- Function Call"

<LI>Page 57, Section 4.5.2 "Calling Pascal from FORTRAN -- Function
</UL>Call"
<P>
If the Pascal source code shown on these pages is compiled, the
following errors occur:
<P>
<PRE>  21  7   begin
= 22  8     Fact := Fact * n;
      8  --------------^Warning 171 Insert (
      8  ----------------^268 Cannot Begin Expression  Skipped
      8  -------------------^Warning 155 ; Assumed ,
      8  -------------------^257 Parameter List Size Wrong Begin Ski

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To obtain correctly compiled code, all of the incorrect references to
Fact must be removed and replaced by a temporary variable. The
following source code contains the necessary changes to the Pfun
module so that it will compile and run without any errors:
<P>
module Pfun;
<PRE>  function Fact (n : integer) : integer;

</PRE>{Integer parameters received by value, the Pascal default. }
<P>
<PRE>  var   temp : integer;

  begin
     temp := 1;
     while n &gt; 0 do
        begin
            temp := temp * n;
            n := n - 1;
        end;
     Fact := temp;
  end;
</PRE>end.
<P>
Note: There is an incorrect reference to the errors in the Fact
function in the Pascal version 4.0 README.DOC file. This correction
does not work properly.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 6.00 6.00a 6.00ax 7.00 1.00 1.50<BR>
KBCategory: kbprg kbdocerr<BR>
KBSubcategory: CLngIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
