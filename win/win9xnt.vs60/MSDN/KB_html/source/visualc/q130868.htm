

<HTML>
<HEAD>
<TITLE>How to Avoid Error L2029 Unresolved External Using DEFINE_GUID </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130868">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1995/05/30">
<META NAME="Keywords" CONTENT="kb16bitonly VCGenIss kberrmsg kbole">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  A GUID must be initialized exactly once. For this reason, there are two different versions of the DEFINE_GUID macro. One version just declares an external reference to the symbol name. The other version actually initializes the symbol name to the v...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QABI,QAH4,QAWM,QAB4,QAAP,QBJQ,QARM,QBVV,QBAC,QAHT,QA4F,QDMW,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Avoid Error L2029 Unresolved External Using DEFINE_GUID</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130868</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 1.51 1.52
WINDOWS
kbole kberrmsg
<P>
 
The information in this article applies to:
<P>
<PRE>   - Microsoft Visual C++ for Windows, versions 1.5, 1.51, and 1.52
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A GUID must be initialized exactly once. For this reason, there are two
different versions of the DEFINE_GUID macro. One version just declares an
external reference to the symbol name. The other version actually
initializes the symbol name to the value of the GUID. If you receive an
L2029 error for the symbol name of the GUID, the GUID was not initialized.
<P>
You can make sure your GUID gets initialized in one of two ways:

<UL><LI>If you are using precompiled header files, include the INITGUID.H header
   file before defining the GUID in the implementation file where it should
   be initialized. (AppWizard-generated MFC projects use precompiled
   headers by default.)

<LI>If you are not using precompiled headers, define INITGUID before
   including COMPOBJ.H. (COMPOBJ.H is included by OLE2.H.)
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Here is the definition of DEFINE_GUID as it appears in COMPOBJ.H:
<P>
<PRE>   #define DEFINE_GUID(name, l, w1, w2, b1, b2, b3, b4, b5, b6, b7, b8) \
       EXTERN_C const GUID CDECL FAR name

   #ifdef INITGUID
   #include "initguid.h"
   #endif

</PRE>NOTE: If the symbol INITGUID is not defined, then DEFINE_GUID simply
defines an external reference to the name.
<P>
In INITGUID.H, you find (among other things):
<P>
<PRE>   #undef DEFINE_GUID

   // Other Code . . .

   #define DEFINE_GUID(name, l, w1, w2, b1, b2, b3, b4, b5, b6, b7, b8) \
      EXTERN_C const GUID CDECL __based(__segname("_CODE")) name \
               = { l, w1, w2, { b1, b2,  b3,  b4,  b5,  b6,  b7,  b8 } }

</PRE>Therefore, include INITGUID.H after COMPOBJ.H DEFINE_GUID is modified to
actually initialize the GUID.
<P>
NOTE: It is important to make sure that this is done exactly once for
each DLL or EXE. If you try to initialize the GUID in two different
implementation files and then link them together, you get this error:
<P>
<PRE>   L2025: &lt;symbol&gt; : symbol defined more than once.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.50 1.51 1.52<BR>
KBCategory: kbole kberrmsg<BR>
KBSubcategory: VCGenIss<BR>
Keywords            : kb16bitonly VCGenIss kberrmsg kbole<BR>
Version             : 1.50 1.51 1.52<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
