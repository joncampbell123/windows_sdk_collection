

<HTML>
<HEAD>
<TITLE>PRB: Picture Property Not Displayed on THREED Button </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119905">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/08/29">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When the function CVBControl::Create() is used to create a Visual Basic custom control (VBX) and a AfxSetPict() is used to set the picture property (as described in MFC Tech Note #27), the picture is not displayed.  CAUSE =====  There are two prima...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYS,QBVV,QAPN,QA7O,QAB5,QAOE,QAMN,QBS0,QBDM,QABA,QBXR,QAB2,QAPF,QBWC,QAG4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Picture Property Not Displayed on THREED Button</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119905</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:
<P>
<PRE>   The Microsoft Foundation Classes (MFC) included with:
    - Microsoft Visual C++ for Windows, version 1.0 and 1.5
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the function CVBControl::Create() is used to create a Visual Basic
custom control (VBX) and a AfxSetPict() is used to set the picture property
(as described in MFC Tech Note #27), the picture is not displayed.
<P>
<P><h2>CAUSE</h2>
 
<P>
There are two primary causes for this problem:

<UL><LI>The picture property is not set properly. Corrections to MFC Tech Note
   #27 can be found in the following article:
<P>
   ARTICLE-ID: <B><A href="../visualc/q104642.htm">Q104642</A></B>
<PRE>   TITLE     : DOCERR: How to Manage VBX Picture Properties with MFC 2.0

</PRE><LI>The BS_OWNERDRAW style was not used. This problem is discussed in this
   article.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Although the control will work properly, you must specify the BS_OWNERDRAW
style for your picture to be displayed. For example, the standard styles
that would be passed as the dwStyle parameter when calling
CVBControl::Create() to create a button are as follows:

<UL><LI>WS_VISIBLE
<LI>WS_CHILD
<LI>WS_TABSTOP
<LI>BS_OWNERDRAW
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The sample code below shows how you can create a THREED SSCommand button
with a displayed picture property.
<P>
NOTE: This problem does not occur when the control is created by the dialog
manager (that is, using App Studio to place the control on a dialog-box
template). The reason for this is that the BS_OWNERDRAW style is included
as one of the default initialization parameters in the model style that is
included in the DLGINIT resource in the .RC file.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: Default AppWizard options
*/

   BOOL CAboutDlg::OnInitDialog()
   {
       CDialog::OnInitDialog();

       CVBControl *pControl = new CVBControl();
       pControl-&gt;Create( "THREED.VBX; SSCommand; Command3D1",
           WS_VISIBLE | WS_CHILD | WS_TABSTOP | BS_OWNERDRAW,
           CRect(10,10,50,50),this,IDC_COMMAND3D1,NULL,TRUE);

       HPIC hPic;
       HBITMAP hBmp = LoadBitmap(AfxGetInstanceHandle(),
           MAKEINTRESOURCE(IDB_BITMAP1));
       PIC picture;
       picture.picData.bmp.hbitmap = hBmp;
       picture.picType = PICTYPE_BITMAP;

       hPic = AfxSetPict( NULL, &amp;picture );
       pControl-&gt;SetPictureProperty( "picture", hPic );

       return TRUE;
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 2.00 2.50<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: MfcVBX<BR>
Keywords            : kb16bitonly<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
