

<HTML>
<HEAD>
<TITLE>PRB: GPF When MultiColumn &amp; LBS_OWNERDRAWVARIABLE in List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129494">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1995/04/26">
<META NAME="Keywords" CONTENT="AppStudioIss kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  A General Protection Fault (GPF) or Application Error will occur when attempting to display a dialog or FormView that contains a list box with both the multicolumn (LBS_MULTICOLUMN) and ownerdraw, variable height (LBS_OWNERDRAWVARIABLE) styles.  CA...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAYL,QBWP,QA01,QBFY,QA56,QA55,QDL9,QBWQ,QBWO,QBWN,QBWS,QBXS,QAAP,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: GPF When MultiColumn &amp; LBS_OWNERDRAWVARIABLE in List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129494</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 1.51 1.52 | 1.00 2.00 2.10 4.00
<PRE>WINDOWS             | WINDOWS NT
</PRE>kbtool kbprb
<P>
 
The information in this article applies to:
<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.0 1.5 1.51 1.52
    - Microsoft Visual C++, 32-bit Edition, versions 1.0 2.0 2.1, and
      4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A General Protection Fault (GPF) or Application Error will occur when
attempting to display a dialog or FormView that contains a list box with
both the multicolumn (LBS_MULTICOLUMN) and ownerdraw, variable height
(LBS_OWNERDRAWVARIABLE) styles.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is expected behavior.  Windows, Windows NT, and Windows 95 do not
support multicolumn, ownerdraw, variable height list boxes.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For listboxes that are owner drawn and multicolumn, use the fixed height
style (LBS_OWNERDRAWFIXED).
<P>
For listboxes that are owner drawn and use the variable height style
(LBS_OWNERDRAWVARIABLE), do not use the multicolumn style
(LBS_MULTICOLUMN).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Dialog Editor that ships with all versions of Visual C++ prior to
version 4.0 incorrectly allow these incompatible styles to be combined
using the check boxes on the property page for the list box control.
(Visual C++, 32-bit Edition, version 4.0 disables the Multi-column check
box when Variable is the setting selected for Owner draw.) These styles,
LBS_MULTICOLUMN and LBS_OWNERDRAWVARIABLE, may also be combined incorrectly
if the dialog box resource file (.RC) is edited directly.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
The problem can be reproduced by modifying the CTRLTEST sample:

<OL><P><LI>Open AppStudio on CTRLTEST project.

<P><LI>Open IDD_CUSTOM_LIST dialog.

<P><LI>Select the list box.

<P><LI>In the ListBox Properties Dialog go to Styles.

<P><LI>Select MultiColumn and OwnerDraw as Variable Styles.

<P><LI>Build and Execute the sample.

<P><LI>The GP fault occurs when you choose the menu item (Custom\Custom
   ListBox).
<P>
</OL>To reproduce the problem using Visual C++ version 4.0, use the following
steps:

<OL><P><LI>Open CTRLTEST.RC in a text editor. (NotePad will suffice.)

<P><LI>Add "| LBS_MULTICOLUMN" to the list of styles for the LISTBOX object
   of the IDD_CUSTOM_LIST DIALOG object.

<P><LI>Save and close CTRLTEST.RC.

<P><LI>Open the CTRLTEST project in Developer Studio.

<P><LI>Build and Execute the sample.

<P><LI>The Application Error occurs when you choose the Custom ListBox option
   from the Custom menu.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: GPF 1.00 1.50 1.51 1.52 2.10 2.00 2.50 2.51<BR>
2.52 3.00 3.10 4.00<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: AppStudioIss<BR>
Keywords            : AppStudioIss kbprb kbtool<BR>
Technology          : kbMfc<BR>
Version             : 1.00 1.50 1.51 1.52 | 1.00 2.00<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
