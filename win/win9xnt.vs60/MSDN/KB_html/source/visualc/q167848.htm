

<HTML>
<HEAD>
<TITLE>PRB: Context Sensitive Help Problems in OLE Common Dialogs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167848">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="kbcode kberrmsg MfcOLE vcbuglist420 kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you invoke context-sensitive Help for some OLE common dialogs using the  ?  button on the title bar or the F1 key, a window with the Help text appears along with the following error message:      The topic does not exist. Contact your applicat...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QA01,QA9Q,QAUD,QAEV,QBVV,QAKP,QBTM,QBJZ,QAMB,QAYC,QAY2,QATX,QALZ,QALQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Context Sensitive Help Problems in OLE Common Dialogs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167848</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Editions, versions 4.2, 4.2b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you invoke context-sensitive Help for some OLE common dialogs using
the "?" button on the title bar or the F1 key, a window with the Help text
appears along with the following error message:
<P>
<PRE>   "The topic does not exist. Contact your application vendor for an
   updated Help file. (129)"

</PRE>This only happens with MFC 4.2 and later versions.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is due to a bug in the OLE common dialog implementation. After
handling the WM_HELP message and displaying the window with the Help text,
the OLE common dialog forwards the message to the parent of the common
dialog. Because this Help ID does not exist in the .hlp file for the
project, an error message is displayed saying that the Help topic does not
exist.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Because the WM_HELP message is propagated to the parent, the workaround
involves handling the message in the parent and preventing the error
message from appearing. The following code does this:
<P>
<PRE>   //main frame is the parent of the OLE common dialog
   BOOL CMainFrame::OnHelpInfo(HELPINFO* pHelpInfo)
   {
      //if there is pop-up window (dialog) and it is derived from
      //COleDialog (base class for OLE common dialogs) just return.
      CWnd *pWnd = FromHandle(::GetLastActivePopup(m_hWnd));

      if (pWnd-&gt;IsKindOf(RUNTIME_CLASS( COleDialog )))
         return TRUE;

      return CMDIFrameWnd::OnHelpInfo(pHelpInfo);
   }

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To reproduce this problem, build and run the OCLIENT sample that shipped
with Visual C++ 4.2 or later. From the edit menu, select Insert Object.
This brings up the COleInsertDialog. Now, using the "?" button or pressing
the F1 key, bring up context-sensitive Help for any of the controls. You
will notice that along with the Help text window, an error message also
appears.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ole common dialog context sensitive help<BR>
Keywords            : kbcode kberrmsg MfcOLE vcbuglist420 kbfasttip<BR>
Technology          : kbole kbmfc<BR>
Version             : 4.2 4.2b 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
