

<HTML>
<HEAD>
<TITLE>APPEND Command Is Not Utilized with access() Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q49006 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1989/09/22">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Microsoft C Run-time library function, access(), determines whether or not a specified file exists and can be accessed in read and/or write mode(s). The access() function searches the current working directory for the particular file or the dir...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBW7,QBWG,QBVV,QAGI,QBFY,QAY5,QAVX,QAVW,QBV8,QBWP,QAB9,QAFI,QBJZ,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>APPEND Command Is Not Utilized with access() Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q49006 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a 6.00ax 7.00 | 1.00 1.50 1.51 1.52
<PRE>MS-DOS                 | WINDOWS
</PRE>kbprg
<P>
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT), included with:
<P>
<P><PRE>    - Microsoft C for MS-DOS, versions 5.1, 6.0, 6.0a, and 6.0ax
    - Microsoft C/C++ for MS-DOS, version 7.0
    - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, and 1.52
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft C Run-time library function, access(), determines
whether or not a specified file exists and can be accessed in read
and/or write mode(s). The access() function searches the current
working directory for the particular file or the directory specified
by a path to the file.
<P>
The MS-DOS and Windows NT APPEND command, which establishes a search
path for data files and works similarly to the PATH environment
variable, appears to be a way to assist access() in finding files
outside the current working directory without having to supply a path.
However, the APPEND command does not search the data path when
locating a file to be used by the access() function. Consequently,
access() fails when searching for a file issued with no path and that
is not in the current working directory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Under MS-DOS, APPEND searches the data path for files only when the
following MS-DOS system calls are made:
<P>
<PRE>   Code          Function
   ----          --------

   0FH           Open File (FCB)
   23H           Get (FCB) File Size
   3DH           Open Handle
   11H           FCB search first  (with /x switch only)
   4EH           Handle find first (with /x switch only)
   4BH           Exec (with /x switch only)

</PRE>In the MS-DOS version of the C run-time library, the access()
function makes an MS-DOS system call to interrupt 21H function 43H,
which sets and retrieves file attributes. Since this is not a system
call listed above, APPEND does not perform file searching.
<P>
In the 32-bit version of the C run-time library, the access()
function makes a call to the Win32 function GetFileAttributes().
The Windows NT version of APPEND does not trap this call and as a
result does not search the data path for the file.
<P>
The following program illustrates the APPEND limitation. The program
uses access() to determine whether the file named TEST exists. Assume
that the TEST data file is not in the current working directory, but
instead is in a directory called c:\mydata, and that the APPEND
command "APPEND=c:\mydata" was issued previously to set the
appropriate search path.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: none
*/

#include &lt;io.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;stdio.h&gt;

</PRE>FILE * stream;
<P>
<PRE>void main( void )
</PRE>{
<PRE>    /* check for existence of TEST fails despite having APPEND set */
    if ((access( "TEST", 0 )) == -1 )
        printf( "File 'TEST' was not found with access()\n\n" );
    else
        printf( "File 'TEST' was found with access()\n\n" );

    /* however, fopen() recognizes APPEND for successful access */
    if ((stream = fopen( "TEST", "r")) != NULL )
        printf( "File 'TEST' opened successfully fopen()\n" );
    else
        printf( "File 'TEST' was not opened successfully with fopen()\n" );
}

</PRE><h2>REFERENCES</h2>
 

<UL><LI>Page 363 of the MS-DOS version 5.0 User's Guide and Reference.
<LI>The MS-DOS Help menu.
<LI>The Windows NT Help menu.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00 1.50 5.10 6.00 6.00a 6.00ax 7.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: CRTIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
