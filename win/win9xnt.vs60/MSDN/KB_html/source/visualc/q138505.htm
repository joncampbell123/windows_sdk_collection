

<HTML>
<HEAD>
<TITLE>HOWTO: Add Context-Sensitive Help Button to Win 95 Dialog Boxes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138505">
<META NAME="KBModify" CONTENT="1997/06/26">
<META NAME="KBCreate" CONTENT="1995/10/22">
<META NAME="Keywords" CONTENT="kbcode kbui MfcUI">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Windows 95 provides DS_CONTEXTHELP as a new dialog box style to implement context-sensitive help in dialog boxes. The Dialog Editor included with Visual C++ versions 2.1 and 2.2, does not provide a way to set this style when designing the dialog bo...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QBTC,QBTM,QA56,QA55,QANX,QBXS,QAO2,QAQ3,QAG4,QBFY,QAL0,QAIM,QAB5,QAK3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Add Context-Sensitive Help Button to Win 95 Dialog Boxes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138505</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Edition, versions 2.1, 2.2, 4.0, 4.1, 5.0
<LI>Microsoft Visual Studio 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows 95 provides DS_CONTEXTHELP as a new dialog box style to implement
context-sensitive help in dialog boxes. The Dialog Editor included with
Visual C++ versions 2.1 and 2.2, does not provide a way to set this style
when designing the dialog box. This article shows, by example, how to add
the context-sensitive help button to the title bar of dialog boxes.
<P>
Starting with version 4.0 of Visual C++, the resource editor does allow
this extended style to be set. However, this causes the resource editor to
generate a DIALOGEX resource that is not supported on Win32s. Therefore, to
stay compatible with Win32s, you can still apply the method discussed in
this article.
<P>
In Visual C++ version 5.0 and Visual Studio 97, the resource editor allows
you set both options.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the DS_CONTEXTHELP style is set for a dialog box, Windows 95 adds a
question mark button to the title bar of the dialog box. When the user
clicks the question mark, the mouse pointer changes to a question mark with
a pointer. If the user then clicks a control in the dialog box, the control
receives a WM_HELP message.
<P>
To set this style, override the OnInitDialog member function of the
CDialog-derived class, and add the WS_EX_CONTEXTHELP style to the extended
styles for the dialog box. The following code illustrates this:
<P>
<PRE>   BOOL CAboutDlg::OnInitDialog()
   {
        CDialog::OnInitDialog();
        LONG style = ::GetWindowLong(m_hWnd, GWL_EXSTYLE);
        style |= WS_EX_CONTEXTHELP;
        ::SetWindowLong(m_hWnd, GWL_EXSTYLE, style);
        return TRUE;
   }

</PRE>NOTE: DS_CONTEXTHELP is just a placeholder. When the dialog box is created,
the system checks for DS_CONTEXTHELP and, if it is there, adds
WS_EX_CONTEXTHELP to the extended style of the dialog box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.10 3.20 3.1 3.2 VS 97<BR>
Keywords            : kbcode kbui MfcUI<BR>
Technology          : kbMfc<BR>
Version             : 2.1 2.2 4.0 4.1 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
