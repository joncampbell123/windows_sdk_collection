

<HTML>
<HEAD>
<TITLE>HOWTO: Connecting a CRecordset to a CDialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125367">
<META NAME="KBModify" CONTENT="1997/06/26">
<META NAME="KBCreate" CONTENT="1995/01/24">
<META NAME="Keywords" CONTENT="kbprg MfcDatabase kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Visual C++ ENROLL tutorial documentation describes how to connect controls of a CRecordView to the field variables of a CRecordset. With a little more work, you can also connect field variables to controls of a CDialog. This article explains th...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAYL,QBFY,QA56,QA55,QA7O,QAI5,QABI,QABO,QBVR,QBEK,QBEJ,QAPF,QAOE,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Connecting a CRecordset to a CDialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125367</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes, included with:
   - Microsoft Visual C++ for Windows, versions 1.5, 1.51, 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 4.0, 4.1,
<P><PRE>     4.2, 4.2b, 5.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Visual C++ ENROLL tutorial documentation describes how to connect
controls of a CRecordView to the field variables of a CRecordset. With a
little more work, you can also connect field variables to controls of a
CDialog. This article explains the steps involved.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can connect a CRecordset to a CDialog in much the same way you connect
a CRecordset to a CRecordView. Once you have your CRecordset and CDialog
created, follow these steps:

<OL><P><LI>Using the ClassWizard, specify the CRecordset class as a 'foreign class'
   for the CDialog. Here's an example of how to do this with the CAboutDlg
   dialog in the ENROLL sample:
<P>
   a. Load the ENROLL step 1 project from the
<P><PRE>      \MSVC\MFC\SAMPLES\ENROLL\STEP1 directory for Visual C++ 2.x, and from
      \MSDEV\SAMPLES\MFC\TUTORIAL\ENROLL\STEP1 for Visual C++ 4.0.
</PRE>   b. Start ClassWizard (CTRL+W).
   c. Select the 'CAboutDlg' class in the 'Class Name' list box.
   d. In ClassWizard, select the 'Class Info' tab.
   e. In the 'Foreign Class' list box, select 'CSectionSet'. CSectionSet is
<P><PRE>      the CRecordset class that you need to associate with the dialog.
</PRE>   f. In the 'Foreign Variable' edit control, type m_pSet (an arbitrary
<P><PRE>      name).
</PRE><P>
   This creates a member variable m_pSet for the CAboutDlg class. The
   variable m_pSet will be a pointer to a CSectionSet object.

<P><LI>In Visual C++ 4.0, use the Resource View, within the Project Workspace,
   to add controls to the CDialog.  In earlier versions of Visual C++, use
   AppStudio to add the controls.

<P><LI>Add code to the CDialog to assign, open, and close the recordset.
   For example:
<P>
<P><PRE>      BOOL CAboutDlg::OnInitDialog()
      {
<PRE></PRE>           CEnrollDoc * pDoc=(CEnrollDoc *) (GetParentFrame()-&gt;
                    GetActiveDocument());
           m_pSet= &amp;(pDoc-&gt;m_SomeRecordset);
          m_pSet-&gt;Open();

           CDialog::OnInitDialog();

          return TRUE;
      }

   Before using this code, make sure the CSectionSet object (derived from
   CRecordset) is defined as the public member variable of the CEnrollDoc
   class (derived from CDocument).  Note, in the code above, this member
   variable is named 'm_SomeRecordset  You can add additional code to check
   for CDBExceptions and to allow the user to move through the records.

   NOTE: this code does not close the CRecordset object. This could be done
   in OnOK and OnCancel in your CDialog's destructor, or you could just let
   it happen when the CRecordset object is itself destroyed.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
To get more information about the 'Foreign Class' and 'Foreign Variable'
features of ClassWizard, go to the 'Class Info' tab in ClassWizard and
click Help.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg MfcDatabase kbprg<BR>
Technology          : kbMfc<BR>
Version             : 1.5 1.51 1.52 2.0 2.1 4.0 4.1<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
