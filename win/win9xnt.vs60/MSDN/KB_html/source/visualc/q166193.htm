

<HTML>
<HEAD>
<TITLE>SAMPLE: ColorFrm Demonstrates ActiveX Control with Popup Toolba </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166193">
<META NAME="KBModify" CONTENT="1997/10/09">
<META NAME="KBCreate" CONTENT="1997/04/01">
<META NAME="Keywords" CONTENT="MfcOLE">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The ColorFrm sample demonstrates adding a popup toolbar to an ActiveX Control. ColorFrm uses a CMiniFrameWnd derived class to contain the toolbar that is visible whenever the control is UI Active. When the control is no longer active, the toolbar i...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOE,QA7O,QAB5,QAMN,QAHV,QAF0,QANS,QAPF,QAY5,QA5F,QAY2,QAMA,QAJ4,QBVV,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: ColorFrm Demonstrates ActiveX Control with Popup Toolba</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166193</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.0a, 4.1, 4.2,
   4.2b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ColorFrm sample demonstrates adding a popup toolbar to an ActiveX
Control. ColorFrm uses a CMiniFrameWnd derived class to contain the toolbar
that is visible whenever the control is UI Active. When the control is no
longer active, the toolbar is hidden and its position is saved.
<P>
The ColorFrm sample details which COleControl functions must be overridden
to achieve this behavior. The sample also demonstrates some other basic
ActiveX Control functionality, such as an OnDraw function that renders
differently based on the AmbientUserMode of the control.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/colorfrm.exe">ColorFrm.exe</A> <I>(size: 61128 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from
               Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
It is often useful to add a popup toolbar to an ActiveX Control that can be
used to provide a user interface to the control. In most cases, you do not
want the toolbar to be visible if the control is not UI Active because
there may be other controls on the dialog or form. The ColorFrm sample
demonstrates how to add a CMiniFrameWnd class and toolbar to an ActiveX
Control.
<P>
The steps listed below outline the process used to create a popup toolbar
that hides itself when its parent control is not UI Active:

<OL><P><LI>Create a basic ActiveX Control using the ControlWizard.

<P><LI>Add a new class to the control project that is derived from
   CMiniFramWnd. An object of this class will contain the toolbar.

<P><LI>Create the CMiniFrameWnd derived object in the OnCreate function
   for the ActiveX Control.

<P><LI>Insert a toolbar resource into the ActiveX Control project.

<P><LI>Override OnCreate for the CMiniFrameWnd derived class and use
   LoadFrame() to create the toolbar.

<P><LI>Override the functions listed below to achieve the desired
   showing / hiding behavior for the toolbar. Please refer to the
   sample code for more details.
<P>
   - OnShowToolBars()
<P>
   - OnHideToolBars()
</OL> 
<PRE>Keywords          : MfcOLE
Technology        : kbMfc kbole
Version           : WINNT:4.0,4.0a,4.1,4.2,4.2b,5.0;
Platform          : NT WINDOWS
Issue type        : kbfile
Solution Type     : kbsample</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
