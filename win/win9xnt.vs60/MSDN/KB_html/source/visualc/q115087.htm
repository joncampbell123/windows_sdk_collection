

<HTML>
<HEAD>
<TITLE>HOWTO: Change the Background Color of a Common Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115087">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1994/05/18">
<META NAME="Keywords" CONTENT="MfcUI">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The common dialog-box classes provided by MFC can be used to modify the background color for common dialog boxes such as the File Open dialog box and the Print dialog box. It is necessary to derive a class from one of the MFC common dialog classes ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QA01,QAUD,QABO,QAY5,QBDM,QAGI,QAEV,QBV8,QAI4,QAB9,QDMW,QDL9,QBWQ,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Change the Background Color of a Common Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115087</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
   - Microsoft Visual C++ 32-bit Edition, versionS 1.0, 2.0, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The common dialog-box classes provided by MFC can be used to modify the
background color for common dialog boxes such as the File Open dialog box
and the Print dialog box. It is necessary to derive a class from one of the
MFC common dialog classes then override the OnCtlColor() and OnDestroy()
member functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The sample code below uses the CFileDialog common dialog-box class to
demonstrate the process. Class Wizard was used to a generate message-
handling function for the WM_CTLCOLOR message. The function called is
"CMyDlg::OnCtlColor()".
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   // mydlg.h : header file
   //
   #include &lt;dlgs.h&gt;
   //////////////////////////////////////////////////////////////////////
   // CMyDlg dialog

   class CMyDlg : public CFileDialog
   {
   // Construction
   public:
       CMyDlg(CWnd* pParent = NULL);   // standard constructor

       // Add a CBrush pointer to store the new background brush
       CBrush m_pBkBrush;

   // Dialog Data
       //{{AFX_DATA(CMyDlg)
       enum { IDD = FILEOPENORD };
           // NOTE: the ClassWizard will add data members here
       //}}AFX_DATA

   // Implementation
   protected:
       virtual void DoDataExchange(CDataExchange* pDX);  // DDX/DDV support

       // Generated message map functions
       //{{AFX_MSG(CMyDlg)
       afx_msg HBRUSH OnCtlColor(CDC* pDC, CWnd* pWnd, UINT nCtlColor);
       //}}AFX_MSG
       DECLARE_MESSAGE_MAP()
   };

   // mydlg.cpp : implementation file
   //
   #include "stdafx.h"
   #include &lt;afxdlgs.h&gt;
   #include "mydlg.h"

   #ifdef _DEBUG
   #undef THIS_FILE
   static char BASED_CODE THIS_FILE[] = __FILE__;
   #endif

   //////////////////////////////////////////////////////////////////////
   // CMyDlg dialog

   CMyDlg::CMyDlg(CWnd* pParent /*=NULL*/)
       : CFileDialog(TRUE, NULL, NULL, OFN_HIDEREADONLY)
   {
       //{{AFX_DATA_INIT(CMyDlg)
           // NOTE: the ClassWizard will add member initialization here
       //}}AFX_DATA_INIT
   }

   void CMyDlg::DoDataExchange(CDataExchange* pDX)
   {
       CDialog::DoDataExchange(pDX);
       //{{AFX_DATA_MAP(CMyDlg)
           // NOTE: the ClassWizard will add DDX and DDV calls here
       //}}AFX_DATA_MAP
   }

   BEGIN_MESSAGE_MAP(CMyDlg, CFileDialog)
       //{{AFX_MSG_MAP(CMyDlg)
       ON_WM_CTLCOLOR()
       //}}AFX_MSG_MAP
   END_MESSAGE_MAP()

   //////////////////////////////////////////////////////////////////////
   // CMyDlg message handlers

   HBRUSH CMyDlg::OnCtlColor(CDC* pDC, CWnd* pWnd, UINT nCtlColor)
   {
       switch (nCtlColor) {

       case CTLCOLOR_STATIC:
           // Set the static text to white on blue.
           pDC-&gt;SetTextColor(RGB(255, 255, 255));
           pDC-&gt;SetBkColor(RGB(0, 0, 255));
           // Drop through to return the background brush.

       case CTLCOLOR_DLG:
           return (HBRUSH)(m_pBkBrush.GetSafeHandle());

       default:
            return CFileDialog::OnCtlColor(pDC, pWnd, nCtlColor);
       }
   }
</PRE> 
<PRE>Keywords          : MfcUI
Technology        : kbMfc
Version           : WIN3.X:1.0,1.5,1.51,1.52;WINNT:1.0,2.0,2.1,4.0;
Platform          : WINDOWS winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
