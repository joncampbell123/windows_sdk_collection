

<HTML>
<HEAD>
<TITLE>First _pg_chartscatter Call May Not Use Specified plotchar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q68384 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1991/01/16">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  In Microsoft C versions 6.0, 6.0a, 6.0ax, C/C++ version 7.0, and Visual C/C++ version 1.0, when producing scatter charts with the Presentation Graphics function _pg_chartscatter(), the first scatter chart created in a program may be drawn with the ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBFY,QBBI,QAIF,QAVX,QAVW,QAEF,QAPG,QDNX,QDK0,QBXS,QBE7,QBE6,QA9V,QA9U V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>First _pg_chartscatter Call May Not Use Specified plotchar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q68384 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a 6.00ax 7.00 | 6.00 6.00a | 1.00 1.50
<PRE>MS-DOS                 | OS/2       | WINDOWS
</PRE>kbprg
<P>
<P>
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT), included with:
<P>
<P><PRE>    - Microsoft C for MS-DOS, versions 6.0, 6.0a, and 6.0ax
    - Microsoft C for OS/2, versions 6.0, and 6.0a
    - Microsoft C/C++ for MS-DOS, versions 7.0
    - Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft C versions 6.0, 6.0a, 6.0ax, C/C++ version 7.0, and
Visual C/C++ version 1.0, when producing scatter charts with the
Presentation Graphics function _pg_chartscatter(), the first scatter
chart created in a program may be drawn with the default plotting
character even if a different character was specified. This usually
results from calling _pg_initchart() before setting the graphics video
mode with _setvideomode().
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The problem stems from an initialization sequence for the palette that
is used whenever a new video mode is set. If the call to _pg_initchart
is made AFTER a call to _setvideomode(), then the palette should not
be affected.
<P>
The sample program below demonstrates this problem and the workaround.
The program draws two scatter charts. For the first chart, the '$'
character is specified for the plotting character. For the second
chart, the '#' character is the plotting character. The second chart
uses the '#' character as specified, but the first chart is drawn with
the '*' character, which is the default plotting character.
<P>
If the program is altered, so that the call to _pg_initchart is moved
down a few lines to after the call to _setvideomode(), then the
problem goes away and the first chart is drawn correctly with the '$'
character.
<P>
This is expected behavior. After entering a new video mode, a call to
_pg_initchart() should be made, then the palette should be changed.
The current plot character is considered to be part of the palette and
requires a valid video mode to be set before the palette is set.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* TEST.C
   Compile line: CL test.c graphics.lib pgchart.lib  */

#include &lt;conio.h&gt;
#include &lt;graph.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;pgchart.h&gt;

</PRE>float _far x[2][5] = { 23.0F, 42.0F, 59.0F, 72.0F, 96.0F };
float _far y[2][5] = {  0.9F,  2.3F,  5.4F,  8.0F,  9.3F };
<P>
<PRE>void main(void)
</PRE>{
<PRE>    chartenv env;
    palettetype pal;
    int i;

    /* Move the following line to after the call to _setvideomode() */
    _pg_initchart();
    if( !_setvideomode( _MAXRESMODE ) )
        exit( 1 );

    _pg_defaultchart (&amp;env, _PG_SCATTERCHART, _PG_POINTONLY );
    strcpy( env.maintitle.title, "Scatter Test" );
    strcpy( env.xaxis.axistitle.title, "X Amount" );
    strcpy( env.yaxis.axistitle.title, "Y Amount" );

    strcpy( env.subtitle.title, "\"plotchar\" should be '$'" );
    _pg_getpalette(pal);
    for(i=0; i &lt; _PG_PALETTELEN; i++)
        pal[i].plotchar = '$';
    _pg_setpalette(pal);
    _pg_chartscatter( &amp;env, x[0], y[0], 5 );
    getch();
    _clearscreen( _GCLEARSCREEN );

    strcpy( env.subtitle.title, "\"plotchar\" should be '#'" );
    _pg_getpalette(pal);
    for(i=0; i &lt; _PG_PALETTELEN; i++)
        pal[i].plotchar = '#';
    _pg_setpalette(pal);
    _pg_chartscatter( &amp;env, x[0], y[0], 5 );
    getch();
    _clearscreen( _GCLEARSCREEN );

    _setvideomode( _DEFAULTMODE );
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00 1.50 6.00 6.00a 6.00ax 7.00 pgchart<BR>
KBCategory: kbprg<BR>
KBSubcategory: CRTIss GraphicsIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
