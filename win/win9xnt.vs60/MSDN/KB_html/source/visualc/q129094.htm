

<HTML>
<HEAD>
<TITLE>FIX: GP Fault in Visual C++ When Separators in Top Level Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129094">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1995/04/18">
<META NAME="Keywords" CONTENT="VwbIss kbbuglist kbenv kbfixlist kbui">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT=" NOTE: This problem exists only when running the above versions of Microsoft Visual C++, 32-bit Edition, under Windows 95 M8 Beta.   The Visual C++ version 2.0 and 2.1 menu editor causes a general protection (GP) fault in the M8 beta of Windows 95 wh...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QA55,QBFY,QA56,QBWS,QAF0,QDL9,QBWQ,QBWO,QBWN,QAR4,QAYZ,QASR,QAIM,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: GP Fault in Visual C++ When Separators in Top Level Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129094</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10
WINDOWS NT
kbui kbenv kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>The development environment included with:
   Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1
<LI>Windows 95 M8 Beta Version 4.0
</UL> 
<P>
NOTE: This problem exists only when running the above versions of Microsoft
Visual C++, 32-bit Edition, under Windows 95 M8 Beta.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Visual C++ version 2.0 and 2.1 menu editor causes a general protection
(GP) fault in the M8 beta of Windows 95 when adding a separator to a top
level menu or opening a menu resource with a separator in the top level
menu.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If it is necessary to edit a resource that contains a top-level menu
separator, you must open the &lt;project&gt;.rc file in a text editor and remove
the top-level menu separators. Then you can use the Resource Editor to edit
a menu resource.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem has been corrected in Visual
C++ version 2.2.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This bug is best observed in the following two scenarios.
<P>
<P><h3>Scenario One - Steps to Reproduce Problem</h3>
 

<OL><P><LI>Generate an AppWizard application and select 'Both container and server'
   in the step 3 property page.

<P><LI>Open the &lt;project&gt;.rc file.

<P><LI>Open the menu folder.

<P><LI>Open the menu with the ID IDR_&lt;project&gt;TYPE_CNTR_IP.
<P>
</OL>A GP fault will now occur in Visual C++. Choose &lt;Close&gt; because &lt;Ignore&gt;
will cause Windows 95 to hang.
<P>
<P><h3>Scenario Two - Steps to Reproduce Problem</h3>
 

<OL><P><LI>Repeat steps 1 through 3 from Scenario One.

<P><LI>Open any menu.

<P><LI>Open the properties box for the empty menu item, and add a separator by
   clearing the Popup checkbox and checking Separator.
<P>
</OL>A GP fault will now occur in Visual C++. Choose &lt;Close&gt; because &lt;Ignore&gt;
will cause Windows 95 to hang.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 4.00 crash chicago ole GPF<BR>
KBCategory: kbui kbenv kbbuglist kbfixlist<BR>
KBSubcategory: VwbIss<BR>
Keywords          : VwbIss kbbuglist kbenv kbfixlist kbui<BR>
Version           : 2.00 2.10<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
