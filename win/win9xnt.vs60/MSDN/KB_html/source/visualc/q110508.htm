

<HTML>
<HEAD>
<TITLE>HOWTO: Create Tables with Foundation Database Classes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110508">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1994/01/24">
<META NAME="Keywords" CONTENT="kbprg MfcDatabase">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Microsoft Foundation Classes (MFC) version 2.5 and later use the Open Database Connectivity (ODBC) API (application programming interface) to access and manipulate data. Before a table can be created, ODBC requires that a  data source  be configure...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAK6,QA9E,QAYY,QA1S,QABM,QAH4,QDN9,QAGT,QBXR,QAZV,QDKY,QAI5,QAM2,QDJ3,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Create Tables with Foundation Database Classes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110508</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
This article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++ for Windows, version 1.5, 1.51, 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Foundation Classes (MFC) version 2.5 and later use the Open
Database Connectivity (ODBC) API (application programming interface) to
access and manipulate data. Before a table can be created, ODBC requires
that a "data source" be configured to allow access to data. A data source
is a set of data that can be located in a variety of databases (for
example, FoxPro, Access, SQL Server, and so forth) in various locations
(for example, local or network). Once a data source is configured/named,
the programmer only needs to specify the name of the data source to connect
to the data. To create a table for the data source, use the
CDatabase::ExecuteSQL() function and pass it a string that uses the CREATE
TABLE SQL statement.
<P>
For additional information about programmatically configuring a data
source, please see the following article(s) in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q110507.htm">Q110507</A></B>
   TITLE     : HOWTO: Configure ODBC Data Sources on the Fly

</PRE>NOTE: The information contained within this article is duplicated in the
<PRE>'Programming with MFC Encyclopedia' shipped with Visual C++ 4.0. The
</PRE>article can be found by searching for "SQLConfigDataSource" and selecting
the article titled 'FAQ:  Programatically Configuring an ODBC Data Source'.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a data source, the ODBC Administrator program, which is normally
found in Windows Control Panel as an icon labeled "ODBC", is typically
used.
<P>
Many data sources, such as FoxPro data source, specify directories for
databases. That is, a directory is the data source and each table is
contained in a separate file (in the case of dBASE or FoxPro, each table is
a .DBF file). Other data sources, such as Microsoft Access and SQL Server
data sources, require that something exists before a data source can be
established. For example, when using the SQL Server ODBC driver, you would
of course need a SQL server established. The Microsoft Access ODBC driver
requires that a .MDB file exists before it can create a data source. When
creating an Access ODBC data source through the ODBC Administrator program,
you are given two choices; you can select a .MDB file or you can create a
.MDB file. There isn't a programmatic way of creating the .MDB file from
your application. Therefore, if your application requires that you place
data into an Access data source (.MDB file), you most likely will want to
have an empty .MDB file that you can use or copy whenever you need it.
<P>
Once you have the data source established, creation of tables can easily be
done by using the CDatabase::ExecuteSQL() function and the CREATE TABLE SQL
statement. For example, if you had a database object called myDB, you could
use the following MFC code to create a table:
<P>
<PRE>   myDB.ExecuteSQL("CREATE TABLE OFFICES (OfficeID TEXT(10)"
                   ", OfficeName TEXT(10))")

</PRE>The code above creates a table called "OFFICES" in the ACCESS data source
connected to by myDB; the table contains two fields "OfficeID" and
"OfficeName".
<P>
NOTE: The field types specified in the CREATE TABLE SQL statement may vary
according to the ODBC driver that you are using. For example, the Btrieve
ODBC driver will require "STRING" in place of the "TEXT" type shown in the
CREATE TABLE statement above. The MSQUERY program is one way to discover
what field types are available for a data source. In MSQUERY, select File,
choose Table_Definition, select a table from a data source, and look at the
type shown in the "Type" combo box.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about data sources, see the "Database Classes
Encyclopedia" in the online books.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.50 2.51 2.52 3.00 3.10<BR>
Keywords            : kbprg MfcDatabase<BR>
Technology          : kbMfc<BR>
Version             : 1.5 1.51 1.52 2.0 2.1<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
