

<HTML>
<HEAD>
<TITLE>PRB: Cannot Set Default Value for Access (Jet) Text Fields </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180611">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1998/02/05">
<META NAME="Keywords" CONTENT="dbDao">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  If you try to set the default value for a text field with a string that starts with a number (for example, 11North), you will get an error. If you set the DAO Struct CDaoFieldInfo fi field member as:     fi.m_strDefaultValue = _T( 11North );  and t...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAMY,QDN9,QABA,QAKD,QAAP,QA7O,QA7N,QAB4,QAKC,QATX,QAH4,QDKY,QBXS,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Cannot Set Default Value for Access (Jet) Text Fields</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180611</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The DAO SDK included with:
<P>
   - Microsoft Visual C++, 32-bit Editions, version 5.0
<P>

<LI>The Microsoft Foundation Classes (MFC) included with:
<P>
   - Microsoft Visual C++, 32-bit Editions, version 5.0
<P>

<LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you try to set the default value for a text field with a string that
starts with a number (for example, 11North), you will get an error. If you
set the DAO Struct CDaoFieldInfo fi field member as:
<P>
<PRE>   fi.m_strDefaultValue = _T("11North");

</PRE>and then call CDaoTableDef::CreateField(fi), DAO throws an exception
reporting:
<P>
<PRE>   Syntax error (missing operator) in table-level validation expression.
   (3320)

</PRE>If you open the Access table in Design View, click the General Tab, and try
to enter 11North in the Default Value field, Access displays an error
dialog box with the message:
<P>
<PRE>   The Expression you have entered contains invalid syntax.
   You may have entered an operand without an operator.

</PRE><h2>CAUSE</h2>
 
<P>
The error occurs because Access accepts expressions for the default value.
(Expressions are operators, constants, functions, literal values, and so
on.) When the default value begins with a number, Access tries to store the
default as a number.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You must use double quotes so that Access knows the default value is a
string. For example, to do this programmatically, the code is:
<P>
<PRE>   fi.m_strDefaultValue = _T("\"11North\"");

</PRE>If you are working directly with an Access table in Design View, you must
start the string with a quote. For example, "11North".
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code reproduces the problem. The code below assumes that you
have an Access database called "db1.mdb" in the root of the C drive:
<P>
<PRE>   void setFI( CDaoFieldInfo &amp;fi)
   {
      fi.m_strName = _T("testfield");
      fi.m_nType = dbText;
      fi.m_lSize = 50;
      fi.m_lAttributes = dbFixedField;
      fi.m_nOrdinalPosition = 2;
      fi.m_bRequired = FALSE;
      fi.m_bAllowZeroLength = TRUE;
      fi.m_lCollatingOrder = dbSortGeneral ;
      // fi.m_strDefaultValue = _T("\"11North\""); // Corrects the error.
      fi.m_strDefaultValue = _T("11North"); // Displays the error.
   }

   void CMy1aDlg::OnBUTcreateTbl()
   {
      CDaoDatabase db;
      try
      {
         db.Open(_T("c:\\db1.mdb"));
         CDaoTableDef td(&amp;db);
         td.Create(_T("FieldTest"));
         CDaoFieldInfo fi;
         setFI( fi);
         td.CreateField(fi);
         td.Append();

         CDaoRecordset rs(&amp;db);
         rs.Open(dbOpenDynaset, _T("Select * from FieldTest"));
         rs.AddNew();
         rs.Update();
         rs.Close();
         db.Close();
      }
   catch(CDaoException *de)
      {
         CString strMsg;
         strMsg.Format(
         _T("ERROR:CDaoException\n\n")
         _T("SCODE_CODE      =%d\n")
         _T("SCODE_FACILITY   =%d\n")
         _T("SCODE_SEVERITY   =%d\n")
         _T("ResultFromScode   =%d\n"),
         SCODE_CODE      (de-&gt;m_scode),
         SCODE_FACILITY   (de-&gt;m_scode),
         SCODE_SEVERITY   (de-&gt;m_scode),
         ResultFromScode (de-&gt;m_scode));
         AfxMessageBox(strMsg);
         de-&gt;Delete();
      }
   }

</PRE>To reproduce this problem in Access, open up a table in Design View. In the
Default Value Edit field, enter 1abc (without quotation marks) and then
click on another field.
 
<PRE>Keywords          : dbDao
Technology        : kbMfc
Version           : WIN95:5.0,7.0,97; WINNT:5.0,7.0,97
Platform          : Win95 winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
