

<HTML>
<HEAD>
<TITLE>How to Run a Code Resource from a Visual C++ Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136997">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1995/09/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article illustrates loading and executing stand-alone Code Resources from a Visual C++ application using the sample code shipped with the Visual C++ Macintosh add-on.  Chapter 8 of the 68K Programmer's Guide in the Visual C++ Books Online disc...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAIM,QAPF,QDO9,QBFY,QA56,QA55,QAUD,QAGI,QABG,QAY5,QAH6,QA9N,QAY2,QASB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Run a Code Resource from a Visual C++ Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136997</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>2.00       | 2.00
</PRE>WINDOWS NT | MACINTOSH
kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT) included with:
   Microsoft Visual C++ 2.0 Cross-Development Edition for Macintosh
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article illustrates loading and executing stand-alone Code
Resources from a Visual C++ application using the sample code shipped
with the Visual C++ Macintosh add-on.
<P>
Chapter 8 of the 68K Programmer's Guide in the Visual C++ Books Online
discusses using stand-alone code and shared libraries in 68K programs.
This chapter provides a brief set of instructions on how to call a code
resource. For more information on Macintosh Code Resources, please
refer to this chapter in the Books Online.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To load a Code Resource, the Macintosh System provides a function
(GetResource) that will load any resources including code resources and
return a handle to a code resource. Visual C++ provides a function
(_PvApplyFixup) that will take a handle to a code resource and return a
pointer to the entry point. You can use these two functions to run a code
resource from a Visual C++ application. The following example demonstrates
how to load and execute the SACODE sample's INIT code resource.
<P>
<P><h3>Step-by-Step Example</h3>
 

<OL><P><LI>Build the SACODE sample project located in Msvc20\Samples\M68k\Sacode
   and copy the resulting file to the Macintosh. Give the remote executable
   path and file name. For example:
<P>
   Macintosh HD:Testing:SACODE

<P><LI>Make a copy of the SKEL sample located in Msvc20\Samples\M68k\Skel and
   call it MYSKEL. Then, make the following modifications:
<P>
   a. Add an include for Resource.h in Skel.c. For example, after this
<P><PRE>      line:
</PRE><P>
<PRE>         #include &lt;macos\QuickDra.h&gt;

      add this line:

         #include &lt;macos\Resource.h&gt;

   b. Add a prototype for _PvApplyFixup and modify the DoAbout function to
      look like this:

      extern ProcPtr _PvApplyFixup(Handle);

      DoAbout ()
      {
      //   SetParamText (aboutStr);
      //   (void) Alert (aboutAlrt, nil);
      //   return 0;

           Handle hResource;
           ProcPtr pCode;

           hResource = GetResource('INIT',1);   // load the resource
           if (hResource != NULL)               // make sure it's loaded
      {
           HLock(hResource);                    // lock down the handle
           pCode = _PvApplyFixup(hResource);    // get pointer to function
           pCode();                             // call the code resource
           HUnlock(hResource);
      }

      return 0;
      }

</PRE><P><LI>Build the MYSKEL sample project, and copy the executable to the
   Macintosh. Give the remote executable path and file name. For example:
<P>
   Macintosh HD:Testing:MYSKEL

<P><LI>Use a Macintosh resource editor application such as ResEdit to copy
   the INIT resource in the SACODE file to the MYSKEL executable.

<P><LI>Execute the MYSKEL program, and click About on the Help menu. The
   code resource will be executed, resulting in a series of five beeps.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 2.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: VCMac<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
