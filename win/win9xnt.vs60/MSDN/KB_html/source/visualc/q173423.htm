

<HTML>
<HEAD>
<TITLE>DOC: IsFieldNull() Does Not Accept NULL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173423">
<META NAME="KBModify" CONTENT="1997/09/04">
<META NAME="KBCreate" CONTENT="1997/09/04">
<META NAME="Keywords" CONTENT="MfcDatabase">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The documentation for Visual C++ states the following about the argument for CDatabase::IsFieldNull():     pv   A pointer to the field data member whose status you want to check,         or NULL to determine if any of the fields are Null.  Accordin...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAD7,QA7O,QA7N,QBV8,QAB9,QBVV,QAUD,QAH7,QAH6,QABH,QABI,QAI4,QBFY,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: IsFieldNull() Does Not Accept NULL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173423</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Enterprise Edition, versions 4.2, 5.0,
   5.0sp1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The documentation for Visual C++ states the following about the argument
for CDatabase::IsFieldNull():
<P>
<PRE>   pv   A pointer to the field data member whose status you want to check,
        or NULL to determine if any of the fields are Null.

</PRE>According to the documentation, you should be able to pass in NULL to
determine if any of the fields are null.
<P>
Beginning with Visual C++ version 4.2, this is not correct. Passing a value
of NULL will cause an exception to be thrown.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can write a function to check whether any fields are null. Here is what
the function would look like:
<P>
<PRE>   BOOL CYourRecordset::IsAnyFieldNull()
   {
      for (DWORD nIndex = 0; nIndex&lt;=m_nFields-1; nIndex++)
      {
        if (IsFieldStatusNull(nIndex))
             return TRUE;
      }
      return FALSE;
   }

</PRE>Notice that the IsAnyFieldNull() function uses an undocumented function
IsFieldStatusNull(). This function is in the implementation section of the
CRecordset class so note that the function may change in future releases of
MFC. To write code that is not dependent upon undocumented functions, call
IsFieldNull() for each field member in the recordset instead.
 
<PRE>Keywords          : MfcDatabase
Technology        : odbc kbMfc
Version           : WINDOWS:4.2,5.0,5.0sp1
Platform          : WINDOWS
Issue type        : kbdocerr</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
