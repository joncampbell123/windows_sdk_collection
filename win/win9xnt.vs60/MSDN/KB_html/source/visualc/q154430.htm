

<HTML>
<HEAD>
<TITLE>BUG: Visual C++ 4.2 DAO Breaks Certain Access95B Functions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154430">
<META NAME="KBModify" CONTENT="1997/09/25">
<META NAME="KBCreate" CONTENT="1996/08/06">
<META NAME="Keywords" CONTENT="MfcDAO vcbuglist420 kbinterop kbusage">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When installing the DAO Components of Visual C++ 4.2 followed by an install of Access95, some of the functionality of Access95 may fail. Specifically, two instances have been reported:   - The Table Wizard within Microsoft Access95 version 7.0b wil...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QA1S,QDI2,QDN9,QBFY,QA56,QA55,QAKP,QDKY,QBVV,QAW6,QAPN,QAIK,QAGU,QDNN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Visual C++ 4.2 DAO Breaks Certain Access95B Functions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154430</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When installing the DAO Components of Visual C++ 4.2 followed by an install
of Access95, some of the functionality of Access95 may fail. Specifically,
two instances have been reported:

<UL><LI>The Table Wizard within Microsoft Access95 version 7.0b will fail
   with the following message:
<P>
<P><PRE>      This feature isn't installed.
</PRE><P>
<P><PRE>      Solution:
      To install this feature, re-run the Microsoft Access Setup
      program to reinstall Microsoft Access, or if you're using
      a 3rd-party add-in, reinstall the add-in.
</PRE>
<LI>.MDB files created with previous versions of Access, via DAO, or
   via ODBC can be opened in Access95 once, but subsequent attempts
   to open these files results in the following message:
<P>
<P><PRE>      OLE Automation error
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
The problem occurs when a user has only installed DAO3032.DLL and not
DAO2532.TLB. Visual C++ is the only Microsoft product that doesn't install
both files. Both files are typically installed in \PROGRAM FILES\COMMON
FILES\MICROSOFT SHARED\DAO.
<P>
If a user's machine has DAO3032.DLL and not DAO2532.TLB, and the user then
installs Access95B, the DAO2532.TLB will exist, but objects in that file
will not be registered. The Access95B Table Wizard relies on these objects
so it fails with one of the messages given above.
<P>
No problem will be encountered if the user first installs Access95B (or any
other application that installs DAO3032.DLL and DAO2532.TLB), and then
later installs the DAO SDK. This is because Access95B will register
DAO3032.DLL, thereby registering objects in both files. When the DAO SDK
registers DAO3032.DLL, it again registers DAO2532.TLB's objects as well,
because the file already exists.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To properly register DAO3032.DLL, enter the following command at the
MS-DOS-PROMPT:
<P>
<PRE>   regsvr32 dao3032.dll

</PRE>This will register DAO3032.DLL correctly and the Access 7.0b Table Wizard
should now work.
<P>
REGSVR32.EXE is installed by Visual C++ 4.2 in the MSDev\Bin directory.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>On a Windows 95 machine, install a typical Visual C++ version 4.2.

<P><LI>Install Office 95(b) Professional, which installs Access version 7.0b.

<P><LI>Open an existing database, and try to insert a new table using the
   Table Wizard.
<P>
   -or-

<P><LI>Open an .MDB file created by Access 2.0, DAO (for instance the DAOTable
   sample) or ODBC. Close the file and reopen it.
<P>
</OL>NOTE: It appears that at least in some cases Access95 will actually corrupt
the .MDB file so that it can no longer be used by Access95. Even performing
a repair on the .MDB does not appear to correct the problem. It may be
possible to retrieve data from such .MDBs via a DAO or ODBC application.
 
<PRE>Keywords          : MfcDAO vcbuglist420 kbinterop kbusage
Technology        : kbMfc
Version           : 4.2
Platform          : NT WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
