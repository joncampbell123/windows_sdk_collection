

<HTML>
<HEAD>
<TITLE>PRB: Invalid Handle Message Using Static Version of CTL3D </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111752">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/02/17">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Microsoft Developer Network (MSDN) CD provides a tool, CTL3D, that can be used with applications to give Windows controls a three-dimensional (3- D) look. The tool is provided as a dynamic-link library (DLL) (CTL3D.DLL) and as a static library ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QBJZ,QAIM,QBWS,QBHQ,QA4H,QAY2,QBVR,QAB5,QAG2,QBVV,QAUR,QAH6,QAJH,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Invalid Handle Message Using Static Version of CTL3D</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111752</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Developer Network (MSDN) CD provides a tool, CTL3D, that can
be used with applications to give Windows controls a three-dimensional (3-
D) look. The tool is provided as a dynamic-link library (DLL) (CTL3D.DLL)
and as a static library (CTL3DS.LIB). When using the static library with an
Microsoft Foundation Class (MFC) application, the controls do not appear as
3-D and the following debug error messages appear when the Ctl3dRegister()
function is called:
<P>
<PRE>   err CTLTST 0117:0138: Invalid HANDLE: 0000
   err CTLTST 0117:0197: Invalid global handle: 0000

</PRE><h2>CAUSE</h2>
 
<P>
The problem occurs when the .RC file does not include CTL3D.H. The include
file, CTL3D.H, is needed to associate a resource ID with the 3-D bitmaps.
When using the static version of CTL3D, the .RC file includes 3DCHECK.BMP,
which is a bitmap used for the 3-D effects. For example,
<P>
<PRE>   CTL3D_3DCHECK             BITMAP  DISCARDABLE     "3DCHECK.BMP"

</PRE>In CTL3D.H, the resource ID CTL3D_3DCHECK is associated with a number as
shown below:
<P>
<PRE>   /* Resource ID for 3dcheck.bmp (for .lib version of ctl3d) */
   #define CTL3D_3DCHECK 26567

</PRE>The association is needed if the library is to successfully load
3DCHECK.BMP. If the CTL3D.H header file is not included in the resource
file, the necessary association is not made. The bitmap is assigned the
string name "CTL3D_3DCHECK" instead of the expected resource number, and
the CTL3D library fails to load the bitmap.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The problem can be corrected by including CTL3D.H in the .RC file. To
include CTL3D.H, open App Studio and choose Set Includes from the File
menu. To the Read-Only Symbol Directives box, add the following text:
<P>
<PRE>   #include &lt;ctl3d.h&gt;

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Below are the steps necessary to link to the static version of CTL3D,
CTL3DS.LIB:

<OL><P><LI>Add CTL3DS to the list of input libraries. This can be done in Visual
   C++ by choosing Project from the Options menu, choosing Linker,
   highlighting the "Category:" Input, and adding ctl3ds to the list of
   libraries.

<P><LI>Start App Studio and choose Set Includes from the File menu. To the
   Read-Only Symbol Directives box add the following:
<P>
<P><PRE>      #include &lt;ctl3d.h&gt;
</PRE>
<P><LI>Save the .RC file and reopen it so the IDs in CTL3D.H will be available
   in App Studio. This can be done from the File menu by choosing Save,
   choosing Close, choosing Open, and selecting the .RC file again.

<P><LI>From the Resource menu, choose Import and enter 3DCHECK.BMP. Once the
   new bitmap resource is opened, change the ID of the bitmap to
   CTL3D_3DCHECK (which is already available). This can be done by choosing
   Properties from the Resource menu and clicking the down arrow of the ID
   list box. Scroll through the list box and select CTL3D_3DCHECK for the
   ID. This will add an entry to the project's RC file:
<P>
<PRE>   CTL3D_3DCHECK           BITMAP  MOVEABLE PRE   "3DCHECK.BMP"

</PRE></OL>It is also necessary to add code to the application in order to use CTL3D.
Refer to the documentation provided with the tool for further information
about how to use the CTL3D functions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 2.00 2.50 ctrl3d ctl3ds listbox<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: MfcMisc<BR>
Keywords            : kb16bitonly<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
