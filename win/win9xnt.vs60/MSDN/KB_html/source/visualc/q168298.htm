

<HTML>
<HEAD>
<TITLE>FILE: DDP_Text Not implemented for COleDateTime and COleCurrency </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168298">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1997/05/08">
<META NAME="Keywords" CONTENT="kbcode MfcOLE kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  DDP_Text functions for COleCurrency and COleDateTime are not implemented in MFC. However code that uses these functions is added to DoDataExchange when ClassWizard is used to associate a CURRENCY or DATE property with a control on a property page. ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAPN,QAB5,QAY2,QAOE,QBFY,QA7O,QAMN,QBWA,QA56,QA55,QAAP,QAB4,QBWC,QAJN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: DDP_Text Not implemented for COleDateTime and COleCurrency</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168298</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
DDP_Text functions for COleCurrency and COleDateTime are not implemented in
MFC. However code that uses these functions is added to DoDataExchange when
ClassWizard is used to associate a CURRENCY or DATE property with a control
on a property page. This results in the following compilation errors.
<P>
For CURRENCY property:
<P>
<PRE>   &lt;filename(lineno)&gt; : error C2665: 'DDP_Text' : none of the 9 overloads
      can convert parameter 3 from type 'class COleCurrency'

</PRE>For DATE property:
<P>
<PRE>   &lt;filename(lineno)&gt; : error C2665: 'DDP_Text' : none of the 9 overloads
      can convert parameter 3 from type 'class COleDateTime'

</PRE>You have to define the DDP functions for COleCurrency and COleDateTime in
order to associate a control on a property page with a property of one of
these types.
<P>
DdpText.exe extracts a Visual C++ 5.0 ActiveX control project. It contains
code for overrides of DDP_Text for COleCurrency and COleDateTime.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/ddptext.exe">DdpText.exe</A> <I>(size: 35235 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When you associate CURRENCY and DATE properties with edit controls on a
property page, ClassWizard adds the following member variables to the
COlePropertyPage derived class:
<P>
<PRE>   COleCurrency m_Currency;
   COleDateTime m_Date;

</PRE>It adds the following to the DoDataExchange for the property page:
<P>
<PRE>   DDP_Text(pDX, IDC_CURRENCY, m_Currency, _T("CurrencyProp") );
   DDX_Text(pDX, IDC_CURRENCY, m_Currency);
   DDP_Text(pDX, IDC_DATE, m_Date, _T("DateProp") );
   DDX_Text(pDX, IDC_DATE, m_Date);

</PRE>This results in a compile error because the compiler cannot find overrides
of DDP_TEXT for COleCurrency and COleDateTime.
<P>
To use the code in the sample it is necessary to derive your code from
CMyOlePropertyPage instead of COlePropertyPage. The project also has code
for CMyOlePropertyPage.
<P>
MyPropPg.h and MyPropPg.cpp have the code required to add code for DDP_Text
to your project. Add these files to your project.
<P>
Use ClassWizard to associate properties with controls on your property
page. Now modify the property page class so that it is derived from
CMyOlePropertyPage. The following steps are required:

<OL><P><LI>Add the following line to your property page header file:
<P>
<P><PRE>      #include "MyPropPg.h"
</PRE>
<P><LI>Replace all instances of COlePropertyPage in the header and .CPP file
   for your project with CMyOlePropertyPage.
<P>
</OL>NOTE: The project was created using Visual C++ 5.0. However the code in
MyPropPg.h and MyPropPg.cpp can be used with MFC for Visual C++ 4.2.
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Sridhar S. Madhugiri, Microsoft Corporation
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbcode MfcOLE kbfasttip<BR>
Technology          : kbole kbmfc<BR>
Version             : 5.0<BR>
Platform            : NT WINDOWS<BR>
Resolution Type     : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
