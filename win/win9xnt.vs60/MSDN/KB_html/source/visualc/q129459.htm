

<HTML>
<HEAD>
<TITLE>HOWTO: Determine Which ODBC Files to Ship </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129459">
<META NAME="KBModify" CONTENT="1997/06/26">
<META NAME="KBCreate" CONTENT="1995/04/26">
<META NAME="Keywords" CONTENT="kbsetup MfcDatabase kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article discusses how to determine which ODBC and ODBC driver files to ship with a Visual C++ application that uses the MFC database classes. This information is more specific than that found in the REDISTRB.WRI file.  MORE INFORMATION  There ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QAU9,QDNN,QA1S,QAH5,QBWP,QAA1,QAJH,QDI2,QDN9,QBFY,QA56,QA55,QA35,QBWU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Determine Which ODBC Files to Ship</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129459</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++ for Windows, versions 1.50, 1.51, 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.1, 4.2
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses how to determine which ODBC and ODBC driver files to
ship with a Visual C++ application that uses the MFC database classes. This
information is more specific than that found in the REDISTRB.WRI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are two categories of files that must be shipped with an application
that uses the MFC database classes:

<UL><LI>The ODBC components.
<LI>The files that make up the ODBC driver(s) that the application uses.
<P>
</UL><h3>ODBC Components</h3>
 
<P>
The set of ODBC components that you need to ship depends on the operating
system supported and on whether the application is a 16-bit or a 32-bit
application. The possible combinations are described in more detail in
Appendix A of the ODBC SDK Guide (ISBN #:1-55615-658-8). The four possible
combinations and their required ODBC component files are:
<P>
<PRE>   16-bit Application with 16-bit Drivers (Windows 3.1 and Windows NT)
   -------------------------------------------------------------------

   ODBC.DLL           16-bit driver manager
   ODBCCURS.DLL       16-bit cursor library
   ODBCINST.DLL       16-bit installer DLL
   ODBCADM.EXE        16-bit administrator
   ODBCINST.HLP       installer help file
   CTL3DV2.DLL        16-bit ctl3d DLL

   16-bit Application with 32-bit Drivers (Windows NT)
   ---------------------------------------------------

   ODBC.DLL           16-bit driver manager
   ODBCCURS.DLL       16-bit cursor library
   ODBC16GT.DLL       16-bit ODBC generic thunking DLL
   ODBC32GT.DLL       32-bit ODBC generic thunking DLL
   ODBCINST.DLL       16-bit installer DLL
   ODBCCP32.DLL       32-bit installer DLL
   ODBCADM.EXE        16-bit administrator
   ODBCAD32.EXE       32-bit administrator
   ODBCINST.HLP       installer help file
   DS16GT.DLL         16-bit driver setup generic thunking DLL
   CTL3D32.DLL        32-bit ctl3d DLL

   32-bit Application with 16-bit Drivers (Win32s)
   -----------------------------------------------

   ODBC32.DLL         32-bit thunking driver manager
   ODBCCURS.DLL       16-bit cursor library
   ODBC.DLL           16-bit driver manager
   ODBC16UT.DLL       16-bit ODBC universal thunking DLL
   ODBCCP32.DLL       32-bit thinking installer DLL
   ODBCINST.DLL       16-bit installer DLL
   CPN16UT.DLL        16-bit installer universal thunking DLL
   ODBCADM.EXE        16-bit administrator
   ODBCINST.HLP       installer help file
   CTL3DV2.DLL        16-bit ctl3d DLL

   NOTE: The Win32s components are included in the \WIN32S\ODBC
   directory on the Visual C++ version 2.X and 4.X CDs.

   32-bit Application with 32-bit Drivers (Windows NT)
   ---------------------------------------------------

   ODBC32.DLL         32-bit driver manager
   ODBCCR32.DLL       32-bit cursor library
   ODBCCP32.DLL       32-bit installer DLL
   ODBCAD32.EXE       32-bit administrator
   ODBCINST.HLP       installer help file
   CTL3D32.DLL        32-bit ctl3d DLL

</PRE><h3>ODBC Drivers</h3>
 
<P>
The files that make up the different ODBC drivers are not documented
completely in any one place. Because of this lack of documentation and also
because these files are prone to change in the future, a good way to
determine which files are needed to redistribute a particular driver is to
use the ODBC.INF file for the setup program that initially installed the
ODBC driver files. The advantage of using ODBC.INF is that it was actually
used to install the ODBC drivers, therefore it is the source of a tested
and working driver installation. For all versions of Visual C++ that ship
ODBC components and drivers, ODBC.INF is located in the REDIST
subdirectory.
<P>
For example, suppose an application needs to install the Microsoft Access
driver that ships with Visual C++ version 1.52a. In that case, you would
look in the "[Microsoft Access Driver (*.mdb)]" of the ODBC.INF file. In
this section, you will see a number of entries, one for each file that
makes up the Microsoft Accesss driver. Each entry is on a single line that
consists of comma-separated values. The second value in each line is the
filename for that entry. Here is the first entry for the Microsoft Access
driver section of ODBC.INF:
<P>
"vbajet.dll" = 1, vbajet.dll,,,, 1994-11-18,,,,,,,,,, 1984,,,, 2.0.0.2420,
<P>
In this case, you can see that the filename for this entry is VBAJET.DLL,
so this is one of the files needed to redistribute the Microsoft Access
driver. Another interesting field in this entry is the next to the last one
(2.0.0.2420). This is the version number of the file.
<P>
Going through all the entries in the Microsoft Access driver section, you
can make a list of all the required files:
<P>
<PRE>   VBAJET.DLL
   STDOLE.TLB
   OLE2.REG
   MSJETERR.DLL
   MSJETINT.DLL
   OLE2PROX.DLL
   VAEN2.OLB
   OLE2CONV.DLL
   ODBCTL16.DLL
   COMPOBJ.DLL
   OLE2NLS.DLL
   ODBCJTNW.HLP
   OLE2DISP.DLL
   STORAGE.DLL
   ODBCJET.HLP
   TYPELIB.DLL
   ODBCJT16.DLL
   OLE2.DLL
   VBAR2.DLL
   MSAJT200.DLL

</PRE>NOTE: Many of these files are OLE2 DLLs. It is very important to do version
checking when installing files on a new system. If there are newer versions
of any of these files and you replace them with older versions,
applications that depend on the newer versions may break.
<P>
<P><h2>REFERENCES</h2>
 
<P>
ODBC 2.0 SDK GUIDE, Appendix A, Developing 16- and 32-Bit Applications and
Drivers (ISBN #:1-55615-658-8).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.50 2.51 2.52 2.52a 3.00 3.10 3.20<BR>
Keywords            : kbsetup MfcDatabase kbsetup<BR>
Technology          : kbMfc<BR>
Version             : 1.5 1.51 1.52 1.52a 2.0 2.1 2.2<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
