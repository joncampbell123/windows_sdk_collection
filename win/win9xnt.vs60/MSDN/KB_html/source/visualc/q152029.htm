

<HTML>
<HEAD>
<TITLE>HOWTO: Prevent Creation of Initial Macintosh Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152029">
<META NAME="KBModify" CONTENT="1997/10/08">
<META NAME="KBCreate" CONTENT="1996/06/01">
<META NAME="Keywords" CONTENT="MacPrgIss MfcDocView MfcMac">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Sometimes it is preferable not to initially open a new document in an MFC application. To implement this behavior on Windows, you can remove the call to OnFileNew() or ParseCommandLine() from InitInstance. On the Macintosh, you need to override CWi...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QDO9,QBVV,QAY2,QAGI,QAJH,QBWS,QBFY,QA56,QA55,QA4P,QAEF,QALW,QAI4,QAA8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Prevent Creation of Initial Macintosh Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152029</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
<PRE>  - Microsoft Visual C++, Macintosh Cross-Development, versions 2.0, 4.0
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes it is preferable not to initially open a new document in an MFC
application. To implement this behavior on Windows, you can remove the call
to OnFileNew() or ParseCommandLine() from InitInstance. On the Macintosh,
you need to override CWinApp::CreateInitialDocument(). This article
describes how to accomplish these behaviors.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In a Windows MFC application, a new document is initially created if the
Command Line is empty. Since Macintosh applications do not have Command
Lines, the open application Apple Event is sent to the application and is
handled by _AfxOpenAppHandler(), which calls CreateInitialDocument() to
open a new document:
<P>
<PRE>   // From Visual C++ 4.0
   OSErr PASCAL _AfxOpenAppHandler(AppleEvent* pae,
                                   AppleEvent* paeReply,
                                   long lRefcon)
   {
     CWinApp* pApp;
     OSErr err = HandlerCommon(pae, lRefcon, pApp);
     if (err == noErr)
     {
       if (pApp-&gt;CreateInitialDocument())
         err = noErr;
       else
         err = errAEEventNotHandled;
     }
     AfxOleSetUserCtrl(TRUE);
     return err;
   }

   // From Visual C++ 4.0
   BOOL CWinApp::CreateInitialDocument()
   {
     if (m_pMainWnd != NULL)
       m_pMainWnd-&gt;SendMessage(WM_COMMAND, ID_FILE_NEW);
     else if (m_pDocManager != NULL)
     {
       POSITION pos = m_pDocManager-&gt;GetFirstDocTemplatePosition();
       if (pos != NULL)
       {
         CDocTemplate* pTemplate = m_pDocManager-&gt;GetNextDocTemplate(pos);

         // if MDI, or SDI but we haven't opened any documents yet,
         // open a new one
         if (pTemplate != NULL &amp;&amp;
           (pTemplate-&gt;IsKindOf(RUNTIME_CLASS(CMultiDocTemplate)) ||
           m_pDocManager-&gt;GetOpenDocumentCount() == 0))
         {
           OnFileNew();
         }
       }
     }
     return TRUE;
   }

</PRE>When a new document is not needed, you can override CreateInitialDocument()
and have it return TRUE. This is desirable to prevent the file type dialog
from appearing in applications supporting multiple document types:
<P>
<PRE>   BOOL CMyWinApp::CreateInitialDocument()
   {
     return TRUE;
   }

</PRE><h2>REFERENCES</h2>
 
<P>
See "Creating Initial Documents" in the Macintosh Porting Guide within
the Online Documentation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: WM_MACINTOSH WLM_MACEVENT<BR>
Keywords          : MacPrgIss MfcDocView MfcMac<BR>
Technology        : kbMfc<BR>
Version           : WINNT:2.0,4.0;MAC:2.0,4.0;<BR>
Platform          : MACINTOSH NT WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
