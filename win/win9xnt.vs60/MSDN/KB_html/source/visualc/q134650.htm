

<HTML>
<HEAD>
<TITLE>HOWTO: Get Info for Troubleshooting Compiler &amp; Linker Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134650">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1995/08/08">
<META NAME="Keywords" CONTENT="CLIss CPPIss LinkIss VCGenIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you investigate a possible problem with the Microsoft Visual C++ compiler or linker, it is important to obtain as much information as possible about the build process and the options being used. This article discusses some trouble-shooting tip...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAOT,QBXS,QAHE,QAKR,QAKP,QAJQ,QBXB,QAX1,QATJ,QAE2,QBFY,QA5A,QAFI,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Get Info for Troubleshooting Compiler &amp; Linker Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134650</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit edition, versions 1.0, 2.0, 2.1, 2.2, 4.0,
   4.1, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you investigate a possible problem with the Microsoft Visual C++
compiler or linker, it is important to obtain as much information as
possible about the build process and the options being used. This article
discusses some trouble-shooting tips to help you resolve your build
problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Compiler Problems</h3>
 
<P>
For compiler problems, such as internal compiler errors (for example,
C1001), hangs, or crashes, use the /P switch to obtain additional compiler
information.
<P>
The /P compiler switch directs CL.EXE to send preprocessor output to a
file. The preprocessor output file (with an extension of .i) has the same
name as the file being compiled and is created in the same directory. Note
that the build will not continue past the preprocessor phase when using
this switch.
<P>
You can compile the preprocessor output file by itself outside of the
context of a project. The file contains all of the header file code, macro
replacement, and preprocessed compiler directive information needed for the
compilation of that particular .C or .CPP source file. The resulting file
will often be long and contain a large amount of white space.
<P>
Alternatively, you can use the /EP and /E compiler switches, which direct
CL.EXE to send preprocessor output to the standard output device.
<P>
<P><h3>Link Problems</h3>
 
<P>
For linker problems (LNKxxxx type errors), you can use the LINK_REPRO
environment variable to reproduce the problem:

<OL><P><LI>Open up an MS-DOS session.

<P><LI>Set LINK_REPRO to point to an existing and empty directory, for
   example:
<P>
   SET LINK_REPRO=C:\TESTPROB

<P><LI>Run the linker in the same MS-DOS session where the variable was set.

<P><LI>Run the VCVARS32.BAT file from the Visual C++ BIN directory to set the
   compiler environment variables.

<P><LI>Change to your project directory, and run NMAKE to rebuild your project,
   using this command:
<P>
   NMAKE /a /f yourproj.mak
<P>
</OL>The /a option directs NMAKE to perform a complete rebuild of the project.
<P>
When LINK.EXE is invoked, it will copy everything it needs to link your
project into the directory specified by the LINK_REPRO environment
variable. Among the files copied will be your object files (*.OBJ),
required library files (*.LIB), including Microsoft libraries, and a linker
response file (LINK.RSP), so that LINK is no longer dependent on your
project makefile.
<P>
This feature is also available from the IDE if it has been run from an
environment where the LINK_REPRO variable has been set.
<P>
To confirm that you have all the necessary files to reproduce the link
problem, you can run LINK in the directory specified by the LINK_REPRO
environment variable, using the linker response file:
<P>
<PRE>   LINK @link.rsp

</PRE></OL>Use the following command to switch off this feature:
<P>
<PRE>   SET LINK_REPRO=

</PRE>You can also use the LINK_REPRO environment variable to verify the files
involved in creating a library, when using LIB.EXE or LINK /LIB.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 9.0 9.00 9.1 9.10 9.2 9.20 2.55<BR>
Keywords          : CLIss CPPIss LinkIss VCGenIss<BR>
Version           : WINNT:1.0,2.0,2.1,2.2,4.0,4.1,5.0;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
