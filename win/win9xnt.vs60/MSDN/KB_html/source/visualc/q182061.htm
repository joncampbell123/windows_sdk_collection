

<HTML>
<HEAD>
<TITLE>FILE: How to Populate a List or Combo Box with Recordset Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182061">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1998/03/04">
<META NAME="Keywords" CONTENT="MfcDAO MfcDatabase MfcUI kbfile kbsample">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The DaoDDX.exe sample demonstrates how to populate list and combo boxes with a column from a CDaoRecordset. The information this sample supplies can be used to provide the same functionality for Crecordset based objects. This sample uses two DDX fu...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAY5,QAE1,QAKD,QBV8,QA7O,QAB9,QAC1,QAXB,QAPN,QAH6,QACI,QA2Q,QAY2,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: How to Populate a List or Combo Box with Recordset Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182061</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC)
<LI>Microsoft Visual C++, 32-bit Enterprise Edition, versions 5.0, 5.0sp1,
   5.0sp2, 5.0sp3
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The DaoDDX.exe sample demonstrates how to populate list and combo boxes
with a column from a CDaoRecordset. The information this sample supplies
can be used to provide the same functionality for Crecordset based objects.
This sample uses two DDX functions to provide data exchange between the
recordsets and the list and combo boxes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/daoddx.exe">DaoDDX.exe</A> <I>(size: 610816 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>This sample contains two DDX functions DDX_BindTextFieldListBoxToColumn()
and DDX_BindTextFieldComboBoxToColumn() to link a particular column from a
recordset to a list or combo box. These functions take the following
parameters:

<UL><LI>A CDataExchange object
<LI>The resource ID of the control to bind to
<LI>The name of the column to bind to
<LI>A CDaoRecordset object to use to retrieve the information.
<P>
</UL>These functions also take the following two optional parameters (both of
which default to false):

<UL><LI>Whether or not to update the column when saving
<LI>Whether or not to allow repeated values in the control
<P>
</UL>When viewing records, these functions first save the current position in
the recordset passed in. This position is treated as the current value of
the current record, and is selected when the population is complete. Then
the function iterates through all the records in the recordset, either
adding the current value to the control, or rejecting the current value if
it cannot be converted to a string or it is a duplicate value and duplicate
values are not being accepted. The function finishes by restoring the
original position of the recordset and then selecting that entry.
<P>
When saving, if the optional parameter to update the column is set, the
function takes the current record, and updates the field in the column
passed in with the currently selected item (or the modified text in a combo
box situation). This method would be used in tables where the choices being
given are not a foreign key. In the foreign key situation, which is the
method used in the example, a second DDX function would be used to tie the
selected value for that particular control to a field in the result set
given.
<P>
The function CDaoDDXView::PositionRecordsets() moves through the foreign
recordsets, positioning each on the record denoted by the key value in the
CDaoDDXView::m_pEnrollmentSet object. This allows the proper item to be
selected in each of the controls, because the selection is based on the
current record.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on how to write custom DDX and DDV functions, see
technical note 26 in the Visual C++ documentation.
<P>
For more information on using the CDaoRecordset and CRecordset classes, see
the CDaoRecordset and CRecordset entries in the Visual C++ Class Library
Reference.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: CComboBox ClistBox combobox listbox<BR>
Keywords          : MfcDAO MfcDatabase MfcUI kbfile kbsample<BR>
Version           : WINDOWS:5.0,5.0sp1,5.0sp2,5.0sp3; WINNT:5.0,5.0sp1,5.0sp2,5.0sp3<BR>
Platform          : WINDOWS winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
