

<HTML>
<HEAD>
<TITLE>PATCH: Visual C++ Version 4.1 Patch </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150937">
<META NAME="KBModify" CONTENT="1997/06/26">
<META NAME="KBCreate" CONTENT="1996/05/13">
<META NAME="Keywords" CONTENT="kbenv kbfile kbtool MfcDatabase WBDebug">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article explains how to get a patch to fix the problems discussed in the SYMPTOMS section below.  The following file is available for download from the Microsoft Software Library:   ~ Vc41a.exe  For more information about downloading files fro...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QACE,QAU3,QAMR,QAFH,QBXB,QATJ,QAFI,QANE,QDL9,QBWQ,QBWO,QBWN,QAM1,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PATCH: Visual C++ Version 4.1 Patch</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150937</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to get a patch to fix the problems discussed
in the SYMPTOMS section below.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/vc41a.exe">Vc41a.exe</A> <I>(size: 438175 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>SYMPTOMS</h2>
 
<P>
This patch fixes two different Visual C++ 4.1 problems described below.

<UL><LI>It fixes a problem you may be seeing in an MFC application that uses
   the Microsoft database classes. While using certain ODBC drivers, you
   may get "Out of memory" errors. See below for a list of files updated.
<P>
   For more information, please also see the following article in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../visualc/q148787.htm">Q148787</A></B>
<PRE></PRE>      TITLE     : FIX: Run Out of Memory or Assertion in
                  GetBufferSetLength()

</PRE><LI>It also fixes the debugger problem in the Microsoft Developer Studio
   where you may not be stopping at breakpoints you have set if your
   project was built from a directory structure that contained long names.
   This problem did not exist in Visual C++ 4.0. See below for a list of
   files updated.
<P>
</UL>For more information, please also see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q150936.htm">Q150936</A></B>
   TITLE     : FIX: VC4.1 Debugger Fails to Stop on Breakpoints with
               Long Names

</PRE><h2>RESOLUTION</h2>
 
<P>
Included in the self-extracting file, VC41A.EXE, you'll find:
<P>
<PRE>   Readme.txt  : The text file that contains more information about this
                 patch.
   Patch.exe   : The executable that runs the patch script.
   Msdev41.rtp : The patch file for the \Msdev tree.
   Mfc41.rtp   : The patch file for the MFC DLLs in the \Windows\System
                 directory.

</PRE><h3>To Patch the MFC DLLs in Your \Windows\System Directory</h3>
 

<OL><P><LI>Close all applications that use MFC, including Microsoft Developer
   Studio.

<P><LI>Copy Patch.exe and Mfc41.rtp to your \Windows\System directory in
   Windows 95 or Windows 3.x running Win32s, or the \Windows\System32
   directory in Windows NT.

<P><LI>Run the command "patch mfc41" (without the quotation marks) at a command
   prompt in that directory.
<P>
</OL>The files patched By Mfc41.rtp in the Windows system directory are:

<UL><LI>mfc40.dll
   (Before)  Size: 921,872  Date: 2/28/96  Time:  6:53a Version: 4.1.6038
<PRE>   (After)         921,872        5/13/96        11:39a          4.1.6130

</PRE><LI>mfc40u.dll
   (Before)  Size: 922,384  Date: 2/28/96  Time:  3:16a Version: 4.1.6038
<PRE>   (After)         919,824        5/13/96        11:45a          4.1.6130

</PRE><LI>mfcd40d.dll
   (Before)  Size: 247,808  Date: 2/27/96  Time: 10:40p Version: 4.1.6038
<PRE>   (After)         247,808        5/13/96        11:46a          4.1.6130

</PRE><LI>mfcd40ud.dll
   (Before)  Size: 255,488  Date: 2/27/96  Time: 11:05p Version: 4.1.6038
<PRE>   (After)         255,488        5/13/96        11:46a          4.1.6130

</PRE><LI>mfcd40d.pdb
   (Before)  Size: 1,134,592  Date: 2/27/96  Time: 10:40p
<PRE>   (After)         1,134,592         5/6/96         3:03p

</PRE><LI>mfcd40ud.pdb
   (Before)  Size: 1,159,168  Date: 2/27/96  Time: 11:05p
<PRE>   (After)         1,159,168         5/6/96         3:27p

</PRE></OL><h3>To Patch the Files in the \Msdev Tree</h3>
 

<OL><P><LI>Close all applications using MFC, including Microsoft Developer
   Studio.

<P><LI>Copy Patch.exe and Msdev41.rtp to your \Msdev Directory.

<P><LI>Run the command "patch msdev41" (without the quotation marks) at a
  command prompt in that directory.
<P>
</OL>The files patched by Msdev41.rtp are:

<UL><LI>\bin\emn0n0.dll
   (Before)  Size: 100,112  Date: 2/16/96  Time: 4:59a  Version: 4.10.6038
<PRE>   (After)         103,696        4/10/96        8:56p           4.10.6038

</PRE><LI>\mfc\src\dbrfx.cpp
<PRE>   (Before)  Size: 65,181      Date: 1/30/96      Time: 9:10a
   (After)         65,183             4/8/96            4:38p

</PRE><LI>\mfc\lib\nafxcw.lib
<PRE>   (Before)  Size: 6,652,314   Date: 2/27/96      Time: 10:12p
   (After)         6,652,314         4/25/96             4:57p

</PRE><LI>\mfc\lib\nafxcwd.lib
<PRE>   (Before)  Size: 7,405,604   Date: 2/27/96      Time: 10:03p
   (After)         7,405,604         4/25/96             4:49p

</PRE><LI>\mfc\lib\uafxcw.lib
<PRE>   (Before)  Size: 6,677,766   Date: 2/27/96      Time: 10:29p
   (After)         6,677,730          5/6/96             2:52p

</PRE><LI>\mfc\lib\uafxcwd.lib
<PRE>   (Before)  Size: 7,437,480   Date: 2/27/96      Time: 10:21p
   (After)         7,437,480          5/6/96            2:43pm

</PRE><LI>\mfc\lib\nafxcw.pdb
<PRE>   (Before)  Size: 569,344     Date: 2/27/96      Time: 10:12p
   (After)         569,344           4/25/96             4:57p

</PRE><LI>\mfc\lib\nafxcwd.pdb
<PRE>   (Before)  Size: 577,536     Date: 2/27/96      Time: 10:03p
   (After)         577,536           4/25/96             4:48p

</PRE><LI>\mfc\lib\uafxcw.pdb
<PRE>   (Before)  Size: 569,344     Date: 2/27/96      Time: 10:29p
   (After)         569,344            5/6/96             2:52p

</PRE><LI>\mfc\lib\uafxcwd.pdb
<PRE>   (Before)  Size: 577,536     Date: 2/27/96      Time: 10:20p
   (After)         585,728            5/6/96             2:43p

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
Several of the MFC files that will potentially get patched are optionally
installed.  You may get a message in the patch log stating that a
particular file wasn't found and that is OK.  If you didn't install the
Unicode MFC libraries for instance, the patch program won't find them.
<P>
For any other potential problems and resolutions, please refer to the
readme file in the patch.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: mfc4.1 softlib fix<BR>
Keywords            : kbenv kbfile kbtool MfcDatabase WBDebug<BR>
Technology          : kbMfc<BR>
Version             : 4.1<BR>
Platform            : NT WINDOWS<BR>
Resolution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
