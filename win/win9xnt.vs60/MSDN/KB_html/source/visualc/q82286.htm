

<HTML>
<HEAD>
<TITLE>MPC Must Be Used Before P-Code .EXEs Can Run </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82286 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1992/03/30">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Two steps are required to build a program that uses packed code (p-code):   - The source must be compiled with /Oq  - The resulting .EXE must be run through the Make P-Code utility (MPC)  In the MS-DOS operating system, an attempt to run a p-code e...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBFY,QDL9,QBWO,QBWN,QDIR,QBWS,QAJH,QAE2,QBWQ,QBVV,QASR,QAH6,QDJH,QBXE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MPC Must Be Used Before P-Code .EXEs Can Run</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82286 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00   | 1.00 1.50
MS-DOS | WINDOWS
kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft C/C++ for MS-DOS, version 7.0
<LI>Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Two steps are required to build a program that uses packed code (p-code):

<UL><LI>The source must be compiled with /Oq
<LI>The resulting .EXE must be run through the Make P-Code utility (MPC)
<P>
</UL>In the MS-DOS operating system, an attempt to run a p-code executable file
that has not been processed by MPC fails and the following message appears
on the screen:
<P>
<PRE>   This program cannot be run in DOS mode.

</PRE>In the Microsoft Windows operating system, the program may generate an
unrecoverable application error (UAE) or display the following message:
<P>
<PRE>   ABNORMAL PROGRAM TERMINATION

</PRE><h2>MORE INFORMATION</h2>
 
<P>
MPC reads the executable (.EXE) file produced by LINK and generates several
internal tables needed by the run-time interpreter. Without these tables,
the program is not a valid executable file. Once MPC has added these
tables, the executable file can be run.
<P>
MPC can be invoked in several different ways. The CL driver calls the MPC
utility after calling LINK if the enable p-code optimization (/Oq) was
used. If you are compiling and linking in separate steps, MPC will be
invoked by the linker if the /PCODE link option is used. It is also
possible to invoke MPC from the command line, passing it the name of the
executable file. If you are building your application inside the
Programmer's WorkBench (PWB), choose one of the following project
templates: DOS P-CODE EXE or Windows P-CODE EXE.
<P>
LINK versions 5.3 and 5.31.009 supplied with Microsoft C/C++ version 7.0
does not automatically detect that an application has been compiled into
p-code. As a result, if an executable is compiled and linked in two
separate steps, the only way to have MPC invoked on the executable is to
either use the /PCODE linker switch or to invoke MPC manually.
<P>
Beginning with LINK version 5.5 supplied with Visual C/C++ version 1.0, the
linker detects that a p-code application is being built and automatically
invokes MPC on the executable.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 7.00 1.00 1.50 pcode<BR>
KBCategory: kbtool<BR>
KBSubcategory: TlsMisc<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
