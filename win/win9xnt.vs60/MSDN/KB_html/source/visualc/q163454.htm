

<HTML>
<HEAD>
<TITLE>PRB: Problem Using Visual C++ v4.2b OLE Controls in VB v4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163454">
<META NAME="KBModify" CONTENT="1997/08/07">
<META NAME="KBCreate" CONTENT="1997/02/11">
<META NAME="Keywords" CONTENT="CDKIss MfcOLE">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  If you create an Appwizard-generated control using Visual C++ 4.2b or 5.0, you may not be able to use that control on some Windows 95 or Windows NT 3.51 machines. Two problems may occur: problems registering the control with the system registry, or...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAOE,QAMN,QBFY,QA56,QA55,QAHV,QBWP,QA9Q,QAB4,QAKP,QDNN,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Problem Using Visual C++ v4.2b OLE Controls in VB v4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163454</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 4.2, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create an Appwizard-generated control using Visual C++ 4.2b or 5.0,
you may not be able to use that control on some Windows 95 or Windows NT
3.51 machines. Two problems may occur: problems registering the control
with the system registry, or problems loading the control for use in the
Visual Basic 4.0 development environment. If you try to load the control
using the Custom Controls dialog box in Visual Basic 4.0, you may see the
error message "Error in loading DLL."
<P>
<P><h2>CAUSE</h2>
 
<P>
ActiveX controls built with the Visual C++ 4.2b technology update or Visual
C++ 5.0, have dependencies to the newer version of Oleaut32.dll. If that
DLL is missing, you may have problems registering and using the control.
With Visual Basic, the type information generated for an ocx control
implicitly imports type information that is contained in a file called
Stdole2.tlb. If that type information is not on the target machine, Visual
Basic reports an error loading the DLL into the Visual Basic development
environment.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The Help topic called "OLE Controls, Distributing OLE Controls" lists the
following files that you should redistribute with an MFC ActiveX control:
<P>
<PRE>   Mfcx0.dll      MFC DLL (ANSI)
   Mfcx0u.dll     MFC DLL (Unicode)
   Msvcrtx0.dll   C run-time libraries
   Olepro32.dll   OLE property frame and standard types support
   Regsvr32.exe   Control registration utility

</PRE>In addition to these files, you should also redistribute Stdole2.tlb and
Oleaut32.dll. Both of these files are version 2.20.4054 and were installed
by the Visual C++ 4.2b technology update. You should install these files in
the target machine's system directory. This allows the control to function
correctly on Windows 95 and Windows NT 3.51.
<P>
Note that the Oleaut32.dll and Stdole2.tlb can be distributed per the
Visual C++ 5.0 redistribution license agreement.
<P>
(c)Microsoft Corporation 1996, All Rights Reserved.
Contributions by Michael Dice, Microsoft Corporation
 
<PRE>Keywords          : CDKIss MfcOLE
Technology        : kbole
Version           : 4.2 5.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
