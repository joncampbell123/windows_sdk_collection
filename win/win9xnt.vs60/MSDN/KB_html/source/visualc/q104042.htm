

<HTML>
<HEAD>
<TITLE>PRB: Unable to Write to the Windows NT Registry </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104042">
<META NAME="KBModify" CONTENT="1997/07/25">
<META NAME="KBCreate" CONTENT="1993/09/05">
<META NAME="Keywords" CONTENT="vc10setup vc20setup kbsetup kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Windows NT sets up each Windows NT user with a different environment. When you install Visual C++ 32-bit Edition, Visual C++ installs for that particular user. If the user changes his or her group membership (privileges), then the Registry Key will...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QA55,QA56,QBFY,QAGU,QAA1,QDI2,QAEV,QAIJ,QAI5,QBVV,QAEF,QAYC,QBW7,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Unable to Write to the Windows NT Registry</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104042</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ 32-Bit Edition, versions 1.0, 2.0, 2.1, 4.0, 4.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Windows NT sets up each Windows NT user with a different environment. When
you install Visual C++ 32-bit Edition, Visual C++ installs for that
particular user. If the user changes his or her group membership
(privileges), then the Registry Key will not work accordingly with Visual
C++. The following two messages may appear if this happens when starting
Visual Workbench:
<P>
<P><h3>Message 1</h3>
 

<UL><LI>The options Registry Key 'Visual C++' is missing. A new Registry
   Key will be created using the default settings."
<P>
   Press OK to continue.
<P>
</UL><h3>Message 2</h3>
 
<P>
<PRE>   Unable to write to the NT Registry. Option settings will not be
   saved.

   Press OK to continue.

</PRE>After these messages, Visual C++ starts running. However, when you exit you
receive the second message again.
<P>
<P><h2>CAUSE</h2>
 
<P>
Each Windows NT user has a different user profile and privilege level. Each
user may not have access to the same Registry Key information as the person
who installed Visual C++. Changing the privilege level of the person who
installed Visual C++ causes this problem.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Check with the Windows NT administrator for the machine to correctly
perform the following steps to rebuild the Registry Key for that particular
Visual C++ user.

<OL><P><LI>Log in as Administrator and give the user of Visual C++  administrative
   privileges to delete the Visual C++ entry, with the Registry Editor
   (REGEDT32.EXE) located in the \WINNT\SYSTEM32 directory. The Visual C++
   entry is under the HKEY_CURRENT_USER, Software, Microsoft, Visual  C++.
   Be sure not to delete any entries other than Visual C++.

<P><LI>Remove the administrative privileges for the Visual C++ user.

<P><LI>Log in as the user and start Visual C++ again; this time you will
   only receive the first message above and a new Registry entry will
   be created.
</OL> 
<PRE>Keywords          : vc10setup vc20setup kbsetup kbfasttip
Version           : 1.0 2.0 2.1 4.0 4.1
Platform          : WINDOWS
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
