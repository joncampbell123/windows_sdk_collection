

<HTML>
<HEAD>
<TITLE>PRB: C4251 &amp; C4275 Compiler Warnings While Compiling an AFXDLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134980">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1995/08/14">
<META NAME="Keywords" CONTENT="MfcDLL kberrmsg kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Compiler issues the following warning for a class derived from one of the MFC classes:     warning C4275: non dll-interface class       used as base for    dll-interface class        A related warning is issued when an object of some MFC class ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QABO,QA3P,QBXF,QBXS,QA4P,QAOT,QAH4,QBWP,QBVV,QAPF,QAYY,QDKS,QA2O,QAZM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: C4251 &amp; C4275 Compiler Warnings While Compiling an AFXDLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134980</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.20
WINDOWS NT
kbprg kberrmsg kbprb
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Compiler issues the following warning for a class derived from one of
the MFC classes:
<P>
<PRE>   warning C4275: non dll-interface class &lt;XXX&gt; used as base for
   dll-interface class &lt;YYY&gt;

</PRE>A related warning is issued when an object of some MFC class is embedded as
a data member of a user-defined class:
<P>
<PRE>   warning C4251: &lt;identifier&gt; : class &lt;XXX&gt; needs to have dll-interface
   to be used by clients of class &lt;YYY&gt;

</PRE>See the "Sample Code" section of this article an example of a class
declaration that generates these warnings.
<P>
This problem no longer occurs in vc 4.0 or later.
<P>
<P><h2>CAUSE</h2>
 
<P>
The DLL version of MFC does not export its classes by declaring them with
"class __declspec(dllexport)." Instead, it exports its classes through
entries in the EXPORTS section of its module definition (.def) file.
<P>
Because the compiler has only the header files to work with, it cannot
determine whether the MFC classes were actually exported, and therefore it
issues the warning.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Because the MFC classes are in fact exported, these warnings can be safely
ignored. As shown in the DLLHUSK sample, you can disable these warnings by
using the following pragma statements:
<P>
<PRE>  #pragma warning(disable: 4275)
  #pragma warning(disable: 4251)

</PRE>On the other hand, if the warnings refer to some user-defined class rather
an MFC class, you should ensure that the class is exported before disabling
these warnings.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code to Reproduce Behavior</h3>
 
<P>
<PRE>/* Compile options needed: None
*/

// The following class declaration causes a C4275 warning
// because the CObject class is not also declared with
// __declspec(dllexport).

</PRE>class __declspec(dllexport) CMyClass : public CObject
{
<PRE>  ...
  // The following data member causes a C4251 warning,
  // because the CString class is not declared with
  // __declspec(dllexport).

  CString m_strName;
  ...
</PRE>};
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, please see MFC TechNote 33 for a discussion of the
reasons behind the decision to export MFC's classes in the module
definition file rather than in the class declaration.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 2.20 3.00 3.10 3.20<BR>
KBCategory: kbprg kberrmsg kbprb<BR>
KBSubcategory: MfcDLL<BR>
Keywords          : MfcDLL kberrmsg kbprb kbprg<BR>
Technology        : kbMfc<BR>
Version           : 2.00 2.10 2.20<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
