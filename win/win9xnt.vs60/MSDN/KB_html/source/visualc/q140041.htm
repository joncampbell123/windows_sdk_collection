

<HTML>
<HEAD>
<TITLE>PATCH: Visual C++ 4.0 Crash Fixes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140041">
<META NAME="KBModify" CONTENT="1997/10/08">
<META NAME="KBCreate" CONTENT="1995/11/21">
<META NAME="Keywords" CONTENT="VwbIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article explains how to get a patch to fix the problems discussed below in the SYMPTOMS section.  The following file is available for download from the Microsoft Software Library:   ~ Vcpatch.exe  For more information about downloading files f...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QBFY,QAUF,QAB4,QBXB,QA56,QA55,QATJ,QAM1,QDJO,QAY2,QAGB,QAFI,QAJN,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PATCH: Visual C++ 4.0 Crash Fixes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140041</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The development environment included with:
   - Microsoft Visual C++, 32-bit Edition, version 4.0
</UL> 
<P>
SUMMARY
 
<P>
This article explains how to get a patch to fix the problems discussed
below in the SYMPTOMS section.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/vcpatch.exe">Vcpatch.exe</A> <I>(size: 424333 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>SYMPTOMS</h2>
 
<P>
This patch fixes three different types of Visual C++ 4.0 Developer Studio
crashing problems. The scenarios are described below:

<OL><P><LI>When the current project has sub-projects and the create browser file
   option is turned on, the Developer Studio may randomly generate an
   access violation. This can happen in response to one of the following
   actions:
<P>
   a. Building the project.
   b. Closing the project, including closing MSDEV.
   c. Opening a different project or creating a new project.
   d. Saving all the files using the Save All command.

<P><LI>When stopping a debugging session then restarting a new debugging
   session with a project loaded, the Developer Studio fails with an
   access violation. The error message could be something like :
<P>
   msdev.exe -  Application Error.
   The instruction at "0x77f85064" referenced memory at "0x00000010".
<PRE>        The memory could not be "read".

   Restarting a new debugging session, the Developer Studio will crash
   with the following error message :

   Microsoft Developer Studio
   (NTDLL.DLL): OxC0000005: Access Violation.

</PRE><P><LI>When deleting sub-projects from a main project, the Developer Studio
   may sometimes crash with an access violation.
<P>
</OL><h2>RESOLUTION</h2>
 

<OL><P><LI>Download the self-extracting patch file to a temporary directory.

<P><LI>Run VCPATCH.EXE. This will create three files : patch.exe, patch.rtp,
   and readme.txt.

<P><LI>Copy patch.exe and patch.rtp to the \msdev\bin directory.

<P><LI>Run patch.exe. The patch will modify the MSVCBLD.PKG file in the
   \msdev\bin\ide directory. It will also modify the MSVCCLS.PKG file in
   the \msdev\bin\ide directory and the MSVCSRC.DLL in the \msdev\bin
   directory.

<P><LI>Delete patch.exe and patch.rtp from \msdev\bin directory.
<P>
</OL>Note: You need to close the Developer Studio when applying the patch.
Otherwise the files will not be modified.
<P>
This patch should be applied to the English version of Visual C++ 4.0
only.
<P>
These problems were fixed in Visual C++ 4.1.
 
<PRE>Keywords          : VwbIss
Version           : WINNT:4.0;
Platform          : NT WINDOWS
Issue type        : kbfile
Solution Type     : kbpatch</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
