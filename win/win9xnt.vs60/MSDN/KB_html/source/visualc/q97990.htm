

<HTML>
<HEAD>
<TITLE>PRB: "Cannot Open the Browser Database File" on Novell Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97990 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1993/04/28">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  An attempt to open the Source Browser .BSC file associated with a project located on a Novell NetWare file server in Microsoft Visual Workbench (VWB) version 1.0 may cause VWB to display the following message:     Cannot open the browser database f...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QBXB,QATJ,QAVV,QAGU,QAC9,QA01,QAI5,QA7T,QAJN,QDH9,QAG0,QA8Y,QBWO,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Cannot Open the Browser Database File" on Novell Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97990 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 1.51 1.52
WINDOWS
kb3rdparty kberrmsg kbprb
<P>
<P>
 
The information in this article applies to:

<UL><LI>The Visual Workbench included with:
   Microsoft Visual C++ for Windows, version 1.0, 1.5, 1.51, and 1.52
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to open the Source Browser .BSC file associated with a
project located on a Novell NetWare file server in Microsoft Visual
Workbench (VWB) version 1.0 may cause VWB to display the following
message:
<P>
<PRE>   Cannot open the browser database file. Share is not installed or
   is not active for this drive.

</PRE><h2>CAUSE</h2>
 
<P>
The user does not have the necessary access rights to the root
directory of the drive on which the .BSC file is stored.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Perform one of the following two steps to work around this situation:

<UL><LI>Use the Novell MAP ROOT command to map the directory in which the
   project is installed to be the root directory for the project
   drive. See below for more information on mapping a directory as the
   root for a drive.

<LI>Have the system administrator grant to the user the following
   rights for the root directory of the drive that contains the .BSC
   file:
<P>
<PRE>      Right         Meaning
      ----------------------------------------------------------
      Create        May create subdirectories and files
      Erase         May erase directory and files
      File Scan     May scan for files
      Read          May read from files
      Write         May write to files

</PRE></UL><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Source Browser attempts to create a hidden file in the
root directory of the drive that contains a project. This file is
named $$MSVC$$.SHR. For example, if your file server is mapped to
drive R:, and a project is located in the R:\WORK\PROJECT directory,
the Source Browser attempts to create its file in the R:\ directory.
<P>
If the user does not have the necessary rights in the server root
directory, the Source Browser cannot create the hidden file and it
generates the message above. These rights include the ability to
search for, create, read from, and write to files. If the user does
not have the right to erase files from the root directory, the Source
Browser may be able to successfully open the file once. However,
because the Source Browser cannot delete the file in the root
directory, subsequent attempts to open the hidden file for writing
fail.
<P>
To determine the rights a user has in a particular directory, use the
Novell RIGHTS command. To determine what rights a user has in the
current directory, enter the following at the MS-DOS command prompt:
<P>
<PRE>    RIGHTS

</PRE>The RIGHTS command generates output similar to the following:
<P>
<PRE>    SERVER_NAME\SYS:WORK\PROJECT
    Your effective rights for this directory are [ RWC    ]
        May Read from File.                        (R)
        May Write to File.                         (W)
        May Create Subdirectories and Files.       (C)

</PRE>One method to work around insufficient access rights in the root
directory involves mapping the directory that contains the project as
the root directory for the project drive. The Novell MAP ROOT command
is provided for this purpose. For example, to map the WORK\PROJECT
directory as the root of drive R:, enter the following at the MS-DOS
command prompt:
<P>
<PRE>    MAP ROOT R:=SYS:\WORK\PROJECT

</PRE>The "SYS:" in the command line represents the volume on the file
server on which the project is installed. Novell volumes are similar
to MS-DOS disk partitions (C:, D:, and so on). To determine the
correct volume, examine the output of the RIGHTS command, as shown
above.
<P>
After you enter the MAP ROOT command shown above, Novell uses the
WORK\PROJECT directory as the root directory for drive R:. In other
words, when the current directory is R:\, the WORK\PROJECT directory
on the SYS: volume is actually the current directory. As long as the
project is opened in the Visual Workbench from the R: drive, when the
Source Browser creates its hidden file in the root directory of the R:
drive, it actually creates the file in the WORK\PROJECT directory on
the SYS: volume. If the user has the necessary rights in this
directory, the file creation and deletion operations succeed. Because
the project directory contains the source code files, the user should
have the right to search for, create, read from, write two, and erase
files in that directory.
<P>
You can also define a drive mapping as a root drive using the
Microsoft Windows File Manager in Microsoft Windows for Workgroups
version 3.1. To do this, the Windows for Workgroups installation must
include Novell NetWare support. To create a drive mapping in File
Manager, perform the following eleven steps:

<OL><P><LI>Start the Windows File Manager.

<P><LI>Connect to a network drive by clicking the network connection
    button on the toolbar or by choosing Connect Network Drive from
    the Disk menu.

<P><LI>Select the NetWare button in the Connect Network Drive dialog box.

<P><LI>File Manager displays its Network-Drive Connections dialog box
    that lists the current data drive mappings in effect and lists the
    drive letters that are available to be mapped. Select the drive
    letter to use for the root mapping then choose the Browse button.

<P><LI>File Manager displays its Browse Connections dialog box that lists
    the current Novell file servers and volumes available to map a
    drive letter to. Choose the appropriate file server/volume
    connection in the Servers/Volumes list box. In the previous
    example, the server/volume would be SERVER_NAME/SYS:.

<P><LI>File Manager displays a list of the directories that can be mapped
    to on the selected server/volume. Choose the directory that
    contains the project. The edit control at the top of the Browse
    Connections dialog box displays the full path to the project
    directory, including the server/volume. For example, using the
    previous example, the edit control displays the following:
<P>
       SERVER_NAME/SYS:WORK/PROJECT

<P><LI>Choose OK to close the Browse Connections dialog box. The focus
    returns to the Network-Drive Connections dialog box.

<P><LI>Choose the Map button. File Manager displays the selected
    server/volume and directory next to the selected drive letter in
    the Data drives list box.

<P><LI>Choose the Set Root button. File Manager displays a message box
    asking for confirmation to assign the root to the current path.

<P><LI>Choose OK to dismiss the message box.

<P><LI>Choose Close to dismiss the Network-Drive Connections dialog box.
<P>
</OL>File Manager maps the drive letter chosen in Step 4 above to the
specified subdirectory on the specified server/volume. NetWare treats
the specified subdirectory as the root directory for that drive
letter. To avoid the situation in which the user has insufficient
rights in the root directory, use this drive letter when you open the
project in the Visual Workbench.
<P>
For more information on granting rights and mapping drives on a
NetWare network, please refer to your Novell NetWare documentation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 1.51 1.52<BR>
KBCategory: kb3rdparty kberrmsg kbprb<BR>
KBSubcategory: VWBIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
