

<HTML>
<HEAD>
<TITLE>PRB: SetItemRects Causes Server to Change Zoom Factor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126563">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1995/02/26">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Calling COleClientItem::SetItemRects() causes the server to change its zoom-factor.  RESOLUTION  In some cases, you may find it advantageous to have a container change the area provided to an in-place active object without changing the zoom factor ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAW6,QAPN,QBXS,QAGI,QAU3,QAKZ,QAH6,QAUD,QAK4,QBSO,QBWP,QAIW,QAH7,QAD7,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SetItemRects Causes Server to Change Zoom Factor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126563</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 1.51 | 1.00 2.00
<PRE>WINDOWS   | WINDOWS NT
</PRE>kbole kbprb kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
<P>
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.50 and 1.51
    - Microsoft Visual C++, 32-bit Edition, versions 2.0 and 2.1
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Calling COleClientItem::SetItemRects() causes the server to change its
zoom-factor.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In some cases, you may find it advantageous to have a container change the
area provided to an in-place active object without changing the zoom factor
of the object. To do this, have the container first set the object's
extents by calling COleClientItem::SetExtent and then set the in-place
item's window size by calling COleClientItem::SetItemRects.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
COleClientItem::SetItemRects() calls IOleInPlaceObject::SetObjectRects()
and passes its parameters. The following is the description of
IOleInPlaceObject::SetObjectRects() in Volume 2 of the OLE2 Programmer's
Reference:
<P>
<PRE>   The object should compare its width and height with those
   provided by its container (conveyed through lprcPosRect).
   If the comparison does not result in a match, the container
   is applying either scaling or zooming to the object.
   The object must then decide whether it should continue the
   in-place editing in the scale/zoom mode or deactivate."

</PRE>The object's width and height are determined by the extent information
passed to it via COleClientItem::SetExtent() -- which calls
IOleObject::SetExtent on the in-place object). Therefore if you want the
client application to change the rectangle used by an in-place active
object, have it first set the extent of the object in HIMETRIC units to the
size of the new rectangle and then set the rectangle.
<P>
The following sample code demonstrates this technique. It assumes that
CMyClientItem is derived from COleClientItem and that rect has coordinates
specified with respect to the view which contains the object. It returns
true if SetItemRects was successful.
<P>
<P><h3>Sample Code</h3>
 
<P>
BOOL CMyClientItem::MySetObjectRects(CRect &amp;rect)
{
<PRE>  ASSERT_VALID(this);
  ASSERT(m_lpObject != NULL);
  ASSERT(IsInPlaceActive());

  // get the size of this new rectangle
  CSize size = rect.Size();

  // now convert this size to HIMETRIC units
  size.cx = XformHeightInPixelsToHimetric(NULL, size.cx);
  size.cy = XformWidthInPixelsToHimetric(NULL, size.cy);

  // use this size to set the extent of the object
  SetExtent(size);

  // finally set the new size for the in-place window
  return SetItemRects(rect, rect);
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 2.00 2.10 2.50 2.51 3.00 3.10<BR>
KBCategory: kbole kbprb kbcode<BR>
KBSubcategory: MfcOLE<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
