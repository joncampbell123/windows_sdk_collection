

<HTML>
<HEAD>
<TITLE>BUG: GetWindowContextHelpId() returns 0 for ActiveX Controls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167170">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1997/04/18">
<META NAME="Keywords" CONTENT="MfcActiveX vcbuglist420 vcbuglist500 kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  You can specify a control's help context ID by selecting the  Help ID  check box from the General tab of the control dialog box in resource editor. If the  Help ID  check box is selected, calling GetWindowContextHelpId() at runtime retrieves the he...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAMN,QAOE,QA4H,QAHV,QAUD,QABI,QABH,QALW,QBXS,QAIM,QBSO,QA2Q,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: GetWindowContextHelpId() returns 0 for ActiveX Controls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167170</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Editions, versions 4.2, 4.2b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You can specify a control's help context ID by selecting the "Help ID"
check box from the General tab of the control dialog box in resource
editor. If the "Help ID" check box is selected, calling
GetWindowContextHelpId() at runtime retrieves the help context identifier
associated with the control. This works for all standard controls, such as
edit controls, button controls, etc. However, for ActiveX controls, such as
TestHelp controls, Circ3 controls, etc., 0 is returned.
<P>
<P><h2>CAUSE</h2>
 
<P>
MFC fails to associate a help context id for ActiveX controls even though
the "Help ID" check box is selected.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When you call SetWindowContextHelpId() on the control with the correct ID,
it sets the Help ID for the control. OnInitDialog is a good place to do
this. For form views, OnInitialUpdate would be the best place to set the
help ID. The sample code below shows a way to set and retrieve the help
context ID of an ActiveX control (TestHelp control) in a CDialog-derived
class.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<PRE>   ...
   #include "resource.hm" // Make sure you include the .hm file
                          // generated by the resource editor
                          // It includes the help ID's for the
                          // controls.
   ...

   BOOL CMyDialog::OnInitDialog()
   {
       CDialog::OnInitDialog();

       ...
       // Associate a help context id with the TestHelp control.
       // IDC_TESTHELP_CONTROL is the id of the TestHelp control and
       // HIDC_TESTHELP_CONTROL is its help context id defined in
       // resource.hm file.
       CWnd* control = GetDlgItem(IDC_TESTHELP_CONTROL);
       control-&gt;SetWindowContextHelpId(HIDC_TESTHELP_CONTROL);

       return TRUE;  // return TRUE unless you set the focus to a control
                     // EXCEPTION: OCX Property Pages should return FALSE
   }

   void CMyDialog::MyFunction()
   {
       // Retrieve the help context id associated with the TestHelp
       // control.
       CWnd* control = GetDlgItem(IDC_TESTHELP_CONTROL);
       DWORD help_id = control-&gt;GetWindowContextHelpId();
       TRACE("Help ID for Control IDC_TESTHELP_CONTROL : %x\n", help_id);
       ...
   }

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Yeong-Kah Tam, Microsoft Corporation
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : MfcActiveX vcbuglist420 vcbuglist500 kbbuglist<BR>
Technology          : kbMfc<BR>
Version             : 4.20 4.20b 5.00<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
