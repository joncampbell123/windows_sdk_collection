

<HTML>
<HEAD>
<TITLE>INFO: Redistributing DAO Components with DAO Apps </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143292">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1996/01/30">
<META NAME="Keywords" CONTENT="MfcDAO kbsetup kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article provides information regarding the redistribution of the DAO components with your DAO-enabled application that was developed using Visual C++ 4.0. The information in this article supersedes all documentation found on or installed from ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDNQ,QDIZ,QBFY,QA56,QA55,QA1S,QAH6,QDKW,QBVV,QA6A,QAY2,QBVP,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Redistributing DAO Components with DAO Apps</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143292</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides information regarding the redistribution of the DAO
components with your DAO-enabled application that was developed using
Visual C++ 4.0. The information in this article supersedes all
documentation found on or installed from the Visual C++ 4.0 CD-ROM.
<P>
This article addresses three major topics:

<UL><LI>The setup script located in Msdev\Redist\Dao
<LI>Errors in the DAO SDK documentation regarding DAO setup
<LI>The Microsoft Jet IISAM files
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>The Setup Script Located in Msdev\Redist\Dao</h3>
 
<P>
The setup script located in Msdev\Redist\Dao is the script that is used by
Visual C++ to install the core DAO components, is also the setup script
that is recommended for redistribution. However, there are certain
limitations to this setup script that may make it unusable for
redistribution with your DAO enabled application.

<UL><LI>The setup script won't work across multiple floppy disks, which may
   mean you won't be able to redistribute on 1.44 Megabyte floppy disks.
   If you attempt to use multiple disks, you will receive this error:
<P>
<P><PRE>      General file transfer error. Please check your target location
      and try again.
</PRE><P>
<P><PRE>      Error Number:-2
</PRE><P>
   The script is not designed to look for the files it requires to be
   located on multiple disks.
<P>
   If you are redistributing on 1.44 Megabyte floppy disks, one way to
   work around this issue is to have your setup script copy all setup
   files to a temporary directory on the target drive and run the
   provided setup script from that location. Then delete the temporary
   directory when setup is complete.

<LI>If you use the setup script as instructed in the Readme.wri file, the
   script won't install the IISAM files that Microsoft Jet requires to
   work with database file formats such as Paradox, Microsoft Excel,
   Xbase, or text files. However, the IISAM file required to work with
   Microsoft Access 2.0/1.x database (.mdb) files is installed.

<LI>For more information on modifying the InstallShield setup script
   to work around this problem, please refer to the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE_ID: <B><A href="../visualc/q151426.htm">Q151426</A></B>
<PRE></PRE>      TITLE     : How to Create a DAO Setup That Installs Jet IISAM Files

   Alternatively, to work around this issue, have your setup script copy
   any required IISAM files to the appropriate system directory and
   register them per the instructions in the Daosdk\Setup\Daosetup.rtf file
   (section 3.4  'Register the DLLs'). It is not sufficient to copy the
   IISAMs without  registering them. These IISAM files are available in
   Msdev\Redist:

   IISAM File        Database File Format
   --------------------------------------
   MSPX3032.DLL      Paradox
   MSRD2x32.DLL      Microsoft Access 2.0
   MSTX3032.DLL      Text
   MSXB3032.DLL      XBase
   MSXL3032.DLL      Microsoft Excel


</PRE></UL><h3>Errors in the DAO SDK Documentation Regarding DAO Setup</h3>
 
<P>
The Daosdk.hlp file's "Installing DAO on another machine" section contains
several errors:

<UL><LI>The NOSDK setup script does not function as the documentation
   indicates.
<P>
   NOTE: This version of setup is identical to the one in
   Msdev\Redist\Dao -- see the previous section for details.

<LI>The DAOMIN setup script will install the DAO components with no IISAM
   files as stated in the documentation. However, if the Microsoft Access
   2.0/1.x IISAM file is not already present on the target computer, a
   message box is displayed stating:
<P>
<P><PRE>      MSRD2X32.DLL not found.
</PRE><P>
   After this dialog box is dismissed, setup runs to a successful
   completion.
<P>
</UL><h3>The Microsoft Jet IISAM Files</h3>
 
<P>
The IISAM files that are installed by the DAO SDK setup scripts that do
install IISAM files differ in size from those located in Msdev\Redist.
The IISAM files located in Msdev\Redist are those installed by the ODBC
setup script and are the only IISAM files that you are authorized to
redistribute.
<P>
Comparing the DAO SDK installed IISAM files with the redistributable IISAM
files reveals that the versions are identical but with the exception of
the Microsoft Access 2.0 IISAM Msrd2x32.dll, the SDK IISAM files are
larger in size and have an earlier timestamp. This is because the IISAM
files installed by the DAO SDK were included in the SDK prior to the
removal of extra version information from the DLLs.
<P>
When redistributing your DAO application, use the IISAM files from
Msdev\Redist.
<P>
Additional information will be added to this article as it becomes
available.
<P>
<P><h3>For Visual C++ 4.2 Users</h3>
 
<P>
Visual C++ 4.2 includes the new InstallShield Express, and no longer
installs the InstallShield SDK directly. Instead, you will need to install
the InstallShield SDK from either the Visual C++ 4.0 or 4.1 CD-ROM. Then
follow the instructions in \ISHIELD\SDK\README.TXT to update the SDK with
the latest files.
<P>
COMPILE.EXE, used to re-compile the DAOMIN.RUL file, is not shipped on the
Visual C++ 4.2 CD-ROM and can only be installed from the InstallShield SDK
found on either Visual C++ 4.0 or Visual C++ 4.1.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Please note that this article supersedes all documentation on the
Visual C++ 4.0 CD-ROM including, but not limited to:

<UL><LI>Msdev\Redist\Dao\Readme.wri (located on the Visual C++ 4.0 CD-ROM only)
<LI>Daosdk\Daosdk.hlp (available only after installing the DAO SDK)
<LI>Daosdk\Setup\Daosetup.rtf (available only after installing the DAO SDK)
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: install installation distribution<BR>
Keywords          : MfcDAO kbsetup kbdocerr<BR>
Technology        : kbMfc<BR>
Version           : 4.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
