

<HTML>
<HEAD>
<TITLE>How to Create a "Clean Boot" Disk to Troubleshoot Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124789">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1995/01/11">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Conflicts may occur between Visual C++, terminate-and-stay-resident (TSR) programs, or device drivers under Windows and Windows for Workgroups. This article explains how to troubleshoot these problems by doing what is often called a  clean boot.  T...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QANE,QDL9,QBWN,QBFY,QDL7,QDIV,QAU9,QDKI,QDKH,QAFY,QBWQ,QAC9,QAA1,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create a "Clean Boot" Disk to Troubleshoot Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124789</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 1.51
WINDOWS
kbprg kbinterop kbtshoot kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, versions 1.0, 1.5, and 1.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Conflicts may occur between Visual C++, terminate-and-stay-resident (TSR)
programs, or device drivers under Windows and Windows for Workgroups. This
article explains how to troubleshoot these problems by doing what is often
called a "clean boot." To perform a "clean boot" means to remove all
unnecessary commands from the CONFIG.SYS and AUTOEXEC.BAT files and restart
the computer.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a conflict occurs, you may encounter problems like these:

<UL><LI>Corrupt or incomplete installations
<LI>Insufficient memory or file handles
<LI>Inexplicable error messages generated from the application
<LI>Complete inability to use the application successfully
<P>
</UL><h3>Removing Commands from CONFIG.SYS and AUTOEXEC.BAT</h3>
 
<P>
If you have MS-DOS version 6.0 or later, you can press the F5 key at
startup to completely bypass your CONFIG.SYS and AUTOEXEC.BAT commands, or
you can press the F8 key to confirm each CONFIG.SYS command. You can also
press and hold down the SHIFT key when MS-DOS displays the "Starting MS-
DOS..." prompt to completely bypass your CONFIG.SYS and AUTOEXEC.BAT
commands.
<P>
Otherwise, you can use a text editor such as MS-DOS EDIT, MS-DOS EDLIN,
SYSEDIT.EXE, or Windows Notepad to edit your CONFIG.SYS and AUTOEXEC.BAT
files. Follow the instructions given below.
<P>
NOTE: Before making changes to the files, make backup copies of the the
AUTOEXEC.BAT and CONFIG.SYS files. You should also have a standby
bootable floppy disk in case the computer fails to boot correctly.
<P>
<P><h3>Before Doing a Clean Boot</h3>
 
<P>
Create a bootable floppy disk that contains the MS-DOS system files
and any other files that are required to make the system operational,
such as disk-compression utilities, disk partitioning drivers, and other
third-party device drivers.
<P>
<P><h3>Doing a Clean Boot Before Running Windows Setup</h3>
 
<P>
If there is no disk compression software, disk partitioning software,
or other third-party drivers necessary to boot the computer, you can boot
it by using a floppy disk that contains only the MS-DOS system files,
without a CONFIG.SYS or AUTOEXEC.BAT file.
<P>
If disk partitioning, disk compression, or other third-party software is
required to boot the computer, the AUTOEXEC.BAT and CONFIG.SYS files on the
bootable floppy disk should contain the following lines:
<P>
<PRE>   AUTOEXEC.BAT
   ------------
   PROMPT $P$G


   CONFIG.SYS
   ----------
   FILES=50
   BUFFERS=30
   &lt;Third-party disk partitioner&gt;
   &lt;Third-party disk compression driver&gt;
   &lt;Other required third-party driver&gt;

</PRE><h3>Windows Clean Boot</h3>
 
<P>
After Windows is installed, the AUTOEXEC.BAT and CONFIG.SYS files on the
bootable floppy disk should contain the following lines:
<P>
<PRE>   AUTOEXEC.BAT
   ------------
   PROMPT $P$G
   PATH=C:\WINDOWS;C:\DOS;C:\
   SET TEMP=C:\&lt;valid path&gt;


   CONFIG.SYS
   ----------
   FILES=50
   BUFFERS=30
   DEVICE=C:\&lt;dir&gt;\HIMEM.SYS
   &lt;Third-party disk partitioner&gt;
   &lt;Third-party disk compression driver&gt;
   &lt;Other third-party drivers&gt;
   STACKS=9,256
   SHELL=C:\&lt;valid path&gt;\COMMAND.COM  /E:1024 /P

</PRE><h3>Windows for Workgroups Clean Boot</h3>
 
<P>
After Windows for Workgroups version 3.1 is installed, the AUTOEXEC.BAT and
CONFIG.SYS files on the bootable floppy disk should contain the following
lines:
<P>
<PRE>   AUTOEXEC.BAT
   ------------
   &lt;WFWG 3.1 dir&gt;NET START
   PROMPT $P$G
   PATH C:\Windows;C:\DOS;C:\
   SET TEMP=C:\&lt;valid path&gt;


   CONFIG.SYS
   ----------
   FILES=50
   BUFFERS=30
   DEVICE=C:\&lt;WFWG 3.1 dir&gt;\HIMEM.SYS
   &lt;Third-party disk partitioner&gt;
   &lt;Third-party disk compression driver&gt;
   &lt;Other required third-party drivers&gt;
   DEVICE=&lt;valid path&gt;\PROTMAN.DOS /I:&lt;valid PATH to PROTOCOL.INI&gt;
   DEVICE=&lt;MAC DRIVER&gt;.DOS
   DEVICE=&lt;valid path&gt;WORKGRP.SYS
   SHELL=C:\&lt;valid path&gt;\COMMAND.COM  /E:1024 /P
   STACKS=9,256

</PRE>After Windows for Workgroups version 3.11 is installed, the AUTOEXEC.BAT
and CONFIG.SYS files on the bootable floppy disk should contain the
following lines:
<P>
<PRE>   AUTOEXEC.BAT
   ------------
   &lt;WFWG 3.11 dir&gt;NET START
   PROMPT $P$G
   PATH=C:\Windows;C:\DOS;C:\
   SET TEMP=C:\&lt;valid path&gt;


   CONFIG.SYS
   ----------
   FILES=50
   BUFFERS=30
   DEVICE=C:\&lt;WFWG 3.11 dir&gt;\HIMEM.SYS
   &lt;Third-party disk partitioner&gt;
   &lt;Third-party disk compression driver&gt;
   &lt;Other required third-party drivers&gt;
   DEVICE=&lt;WFW 3.11 dir&gt;IFSHLP.SYS
   SHELL=C:\&lt;valid path&gt;\COMMAND.COM  /E:1024 /P
   STACKS=9,256

</PRE><h3>Exceptions</h3>
 
<P>
The following are examples of drivers that SHOULD NOT be removed; they are
used when the computer is turned on to make the hard drive accessible. This
is not a complete list, but it does include many frequently used drivers:
<P>
<PRE>   Hard Disk Drivers:          SQY55.SYS, SSTBIO.SYS, SSTDRIVE.SYS,
                               AH1544.SYS, ILIM386.SYS, ASPI4DOS.SYS,
                               SCSIHA.SYS, SCSIDSK.EXE, SKYDRVI.SYS,
                               ATDOSXL.SYS, NONSTD.SYS

   Disk Partitioners:          DMDRVR.BIN, SSTOR.SYS, HARDRIVE.SYS,
                               EDVR.SYS, FIXT_DRV.SYS, LDRIVE.SYS,
                               ENHDISK.SYS

   Disk Compression Utilities: STACKER.COM, SSWAP.COM, SSTOR.EXE,
                               DEVSWAP.COM

</PRE>If the purpose of a device driver or program is unknown, DO NOT remove
it. Most device drivers and programs will display a message describing
their purpose when they are initialized.
<P>
A clean boot DOES NOT include:

<UL><LI>DOS=HIGH,UMB
<LI>EMM386.EXE
<LI>INSTALL=SHARE.EXE
<LI>INSTALL=FASTOPEN.EXE
<LI>Third-party memory managers
<LI>RAM disk devices, such as RAMDRIVE.SYS
<LI>JOIN.EXE, GRAPHICS.COM, PRINT.COM, SUBST.EXE, APPEND
<LI>MODE.COM for printer redirection
<LI>Multiple path statements
<LI>MS-DOS-level mouse drivers
<LI>Third-party disk caches
<LI>Various third-party TSRs
<LI>LOGIMENU, CLICK
<LI>Virus checkers
<LI>Drivers for scanners/fax
<LI>Drivers for CD ROM/network
<LI>Tape backup spoolers/redirectors/buffers
<LI>Data acquisition units
<LI>Keyboard accelerators/buffers
<P>
</UL><h3>Additional Troubleshooting Steps</h3>
 

<OL><P><LI>Verify that the File Allocation Table is valid:
<P>
   a. Exit Windows.
<P>
   b. At the command prompt, type the following:
<P>
<P><PRE>      chkdsk /f
</PRE><P>
   CAUTION: You must exit Windows BEFORE you type the above command.
   CHKDSK will also check the directory structure.

<P><LI>Verify that you are using the correct version of MS-DOS for your
   computer. For example, if you are using a COMPAQ computer, you
   should be using a version of COMPAQ MS-DOS.

<P><LI>Verify that the path, environmental space, and TEMP directory are
   valid. At the command prompt, type:
<P>
   set
<P>
</OL>Reinstall Windows after you make the above changes to the CONFIG.SYS
and AUTOEXEC.BAT files.
<P>
<P><h2>REFERENCES</h2>
 
<P>
More information on doing a "clean boot" can be found on pages 99-100 of
the "Getting Started with Microsoft Windows" version 3.1 manual, on pages
528-531 of the version 3.1 "Microsoft Windows Users Guide", Chapter 6 of
the "Getting Started with Microsoft Windows for Workgroups" manual, and
Chapter 11 of the "Microsoft Windows for Workgroups Users Guide."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00 1.50 3.10 3.11 clean-boot<BR>
KBCategory: kbprg kbinterop kbtshoot kb3rdparty<BR>
KBSubcategory: vc10setup vc15setup<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
