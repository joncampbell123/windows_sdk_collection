

<HTML>
<HEAD>
<TITLE>PATCH: REGSVR.EXE GPFs in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148319">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1996/03/08">
<META NAME="Keywords" CONTENT="CDKIss kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article explains how to get a patch to fix the problem discussed below in the SYMPTOMS section.  The following file is available for download from the Microsoft Software Library:   ~ Oc25.exe  For more information about downloading files from ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QDL9,QBWQ,QBWO,QBWN,QA9Q,QANE,QBJZ,QAJ4,QAB5,QDNF,QBXB,QBWP,QA7O,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PATCH: REGSVR.EXE GPFs in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148319</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 16-bit Edition, versions 1.5, 1.51, 1.52
<LI>Microsoft OLE Control Developer's Kit (CDK) version 1.3
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to get a patch to fix the problem discussed
below in the SYMPTOMS section.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/oc25.exe">Oc25.exe</A> <I>(size: 75953 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>SYMPTOMS</h2>
 
<P>
When you build a 16-bit OLE Control and attempt to register it using the
Register Control command under the Tools menu, Windows 95 terminates,
displaying a blue screen when the REGSVR.EXE utility runs, and reporting
that the REGSVR.EXE application has performed an illegal operation.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is caused by Windows 95's implementation of 16-bit OLE DLLs, where the
OLE DLLs are unloading in an unexpected order. This results in the DLLs'
WEP calling into a code segment at an address which has been discarded and
Windows 95 is not able to call a not-present segment in a WEP.
<P>
<P><h2>RESOLUTION</h2>
 

<OL><P><LI>Download the self-extracting patch file to a temporary directory.

<P><LI>Run OC25.EXE. This will create the following files:
<P>
<P><PRE>      Readme.txt
      Oc25kb.txt
      Patch.exe
      Oc25.rtp
</PRE>
<P><LI>Copy Patch.exe and Oc25.rtp to \Windows\System directory on
   Windows 95, Windows 3.x, or Windows NT.

<P><LI>Run the following command at the command prompt in that directory:
<P>
<P><PRE>      patch OC25
</PRE><P>
</OL>This will patch both Oc25.dll and Oc25d.dll.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Please refer to the README.TXT created by patch for more information, if
the files have not been patched properly.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: softlib<BR>
Keywords          : CDKIss kb16bitonly<BR>
Technology        : kbole<BR>
Version           : WIN3X:1.3,1.5,1.51,1.52;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbfile<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
