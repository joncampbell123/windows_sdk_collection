

<HTML>
<HEAD>
<TITLE>INFO: Visual C++ 5.0 Readme, Build Issues </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165681">
<META NAME="KBModify" CONTENT="1997/06/27">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Build Issues  Reducing the Size of Header Files for Faster Builds Several Project System and Debugger Methods are Disabled When the BuildFinish Event is Fired Building ATL Projects from the Command Line Can Generate NMAKE Error Help File Names With...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAO4,QAVI,QAA5,QBFY,QAH6,QAH7,QAD7,QAY2,QAFF,QBRD,QBXS,QA56,QA55,QAU3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Visual C++ 5.0 Readme, Build Issues</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165681</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h3>Build Issues</h3>
 
<P>
Reducing the Size of Header Files for Faster Builds
Several Project System and Debugger Methods are Disabled When the
BuildFinish Event is Fired
Building ATL Projects from the Command Line Can Generate NMAKE Error
Help File Names With European Characters Do Not Copy Correctly On
Windows 95
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Reducing the Size of Header Files for Faster Builds</h3>
 
<P>
To speed the build process, Visual C++ 5.0 provides the following new
defines. Use them to reduce the size of the Win32 header files.

<UL><LI>VC_EXTRALEAN
<LI>WIN32_LEAN_AND_MEAN
<P>
</UL>Newly generated Visual C++ AppWizard applications automatically benefit
from VC_EXTRALEAN. You can also manually define VC_EXTRALEAN to speed the
build process of many legacy MFC applications.
<P>
Non-MFC C++ and C applications can define WIN32_EXTRA_LEAN and any
applicable NOservice defines, such as NOSOUND (see
DevStudio\Vc\include\Windows.h), to reduce their build times.
<P>
To add these defines, from the Project menu, choose Settings. The Projects
settings dialog box appears. Click the C/C++ tab. In the Category list,
select Preprocessor. Add the desired definitions to the Preprocessor
Definitions box.
<P>
Several Project System and Debugger Methods are Disabled when the
BuildFinish Event is Fired
 
<P>
Consider the following VBScript event handler:
<P>
<PRE>   Sub Application_BuildFinish(nNumErrors, nNumWarnings)

   if nNumErrors+nNumWarnings = 0 then
       ExecuteCommand "ToggleOutputWindow"
       ExecuteConfiguration
   end if

   End Sub

</PRE>ExecuteConfiguration fails because the BuildFinish event is fired before
several project system and debugger commands have been re-enabled. The
methods that invoke these commands, like ExecuteConfiguration, will remain
disabled between the time that the event is fired and the time the event
handler returns. After the Application_BuildFinish event handler returns,
these methods will be re-enabled.
<P>
Workaround

<OL><P><LI>Create a new macro, for example, MyBuild, with the following code:
<P>
<PRE>      Sub MyBuild
          Build
          ' Add other method calls here that can't appear in the
          ' BuildFinish event handler, such as "ExecuteConfiguration"
      End Sub

</PRE><P><LI>Always invoke a build by using this new macro instead of using the
   default Build menu command or toolbar. Note that you can create a custom
   menu command or toolbar button for your new MyBuild macro by going to
   the Tools menu, clicking Customize, and using the Commands tab of the
   dialog box.
<P>
</OL>The Application_BuildFinish VBScript event handler now becomes:
<P>
<PRE>   Sub Application_BuildFinish(nNumErrors, nNumWarnings)

       if nNumErrors+nNumWarnings = 0 then
           ExecuteCommand "ToggleOutputWindow"
       end if
   End Sub

</PRE></OL>In this case Build will fire the BuildFinish event and return control to
the MyBuild subroutine at which time the ExecuteConfiguration will be
enabled. You can see what other methods are disabled simply by looking at
the disabled menu items when a build is in progress.
<P>
<P><h3>Building ATL Projects from the Command Line Can Generate NMAKE Error</h3>
 
<P>
Building an ATL program from the command line can generate NMAKE error
U1073. (This problem does not occur when building ATL samples from within
the integrated development environment.)
<P>
For example, the following command line:
<P>
<PRE>   NMAKE /f beeper.mak CFG="beeper - Win32 Release"

</PRE>will generate this error:
<P>
<PRE>   NMAKE : fatal error U1073: don't know how to make '".\beeper.h"'

</PRE>From the command line, ATL projects require two passes to build. The first
pass directs MIDL to create a header file that is required for the second
pass.
<P>
Workaround:
<P>
Use the following commands to work around this problem:
<P>
<PRE>   nmake /f beeper.mak CFG="beeper - Win32 Release" beeper.h
   nmake /f beeper.mak CFG="beeper - Win32 Release"

</PRE>Help File Names with European Characters Do Not Copy Correctly on
Windows 95
 
<P>
The Help compiler converts the name of the Help file into upper case
characters. On Windows 95, this causes problems when the Visual Studio
Build System tries to copy a name that contains European characters (such
as umlauted characters) to the output directory for the rest of the project
build. This is not a problem on Windows NT.
<P>
Workaround:
<P>
Add a copy step with the name of the Help file, in upper case, to the
custom build rule on the .hpj file in the project.
<P>
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbtlc<BR>
Technology          : kbatl<BR>
Version             : 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbreadme<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
