

<HTML>
<HEAD>
<TITLE>HOWTO: Insert Existing Projects as Sub-Projects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145936">
<META NAME="KBModify" CONTENT="1997/10/06">
<META NAME="KBCreate" CONTENT="1996/02/12">
<META NAME="Keywords" CONTENT="NmakeIss VwbIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  There is currently no way to insert an existing project as a project or subproject of the current workspace. The Insert menu has a Projects command that you can use to create new projects and sub-projects for the workspace, but you can't use it to ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJN,QAG0,QACI,QDIZ,QA9N,QAMA,QAHD,QBV8,QBJZ,QBWS,QAFI,QBVV,QBHQ,QAB9,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Insert Existing Projects as Sub-Projects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145936</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The development environment included with:
   - Microsoft Visual C++, 32-bit Edition, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There is currently no way to insert an existing project as a project or
subproject of the current workspace. The Insert menu has a Projects command
that you can use to create new projects and sub-projects for the
workspace, but you can't use it to insert projects into the workspace.
<P>
However, you can create a new sub-project of type makefile and insert a
link from it to an existing project's makefile. This provides one of the
major benefits of a sub-project; when the main project is building,
it will do a 'make' of the linked project.
<P>
If you have a project that creates a library, and in another workspace you
have a project to create an .exe file that uses the library, you can create
a makefile sub-project in the .exe project that contains commands to build
a library project. When building the main (.exe) project, if a dependent
file of the linked (library) project is out of date, the file and the
library will be re-built, and the changes will be incorporated into the
main project.
<P>
Because the project is not truly inserted into the workspace, the project
workspace window will not be able to display class, file, or resource
information about the linked project.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Procedure</h3>
 
<P>
From a project workspace, to create a sub-project link to an existing
separate project, follow these steps:

<OL><P><LI>On the Insert menu, click Projects. This will bring up the Insert
   Project dialog box that can create (but not insert existing) projects.
   To get here another way, you can on Build menu, click Subprojects, and
   then click New.

<P><LI>From the Insert Project dialog box, select a Project of type Makefile.
   Specify a project name and whether or not it is to be a subproject of an
   existing project.

<P><LI>Click Create, and then click Yes. This takes you directly to the Project
   Settings dialog box for this new project.

<P><LI>In the Settings For list, select a configuration of the new makefile
   sub-project that matches one of the configurations of the main project.
   For example, select the Win32 Debug configuration. This is important
   because when you build a main project, Developer's Studio will look for
   the matching sub-project configuration and build that. If there is no
   matching sub-project configuration, the sub-project will be ignored.

<P><LI>Click the General tab, remove the NMAKE command from the build command
   line, and instead invoke a batch file to run NMAKE on the existing
   project makefile. A batch file is required because project makefiles use
   relative paths, and the current directory must be set to the directory
   of the project makefile - something you can do in a batch file. For
   example, the command for the Win32 Debug configuration should look
   something like this one:
<P>
   c:\MyOldProject\MyOldProject.bat "MyOldProject - Win32 Debug"
<P>
   If the old project was created by Visual C++ 2.0, the string would be
   "Win32 Debug" - look in the makefile to be sure.
<P>
   If you always want the sub-project built the same way for all
   configurations, just have the same batch command for each configuration.
<P>
   In this sample, the batch file is in main directory of the old existing
   project. It works well there because that makes it easy to include the
   project in the sub-projects of any other new projects you might create.

<P><LI>Note the Rebuild all option. When you use the Rebuild all option on the
   main project, this option will be passed as a parameter to your batch
   file. This is best left "/a".

<P><LI>Change the Output file name to the actual library or .exe file that will
   be created, and be sure to specify the full path.

<P><LI>Do steps 4-5 for each configuration you will use.

<P><LI>Write the batch file to change the working directory to that of the
   original project directory, and then invoke NMAKE on the project's .mak
   file. The batch file can also pass along the arguments for rebuild all
   and the configuration specifier. For example:
<P>
   cd c:\MyOldProject
   nmake %2 -f MyOldProject.mak CFG=%1
<P>
   Given the build command listed in step 5, %1 will contain the
   configuration string and %2 will contain the rebuild all option (which
   will be blank for normal builds).
<P>
   NOTE: the batch file must not contain any commands for user interaction
   such as PAUSE. The output of the batch file is sent to the debug window,
   which is display only. Developer's Studio will hang waiting for input
   from the user in a window that does not allow input.
</OL> 
<PRE>Keywords          : NmakeIss VwbIss
Version           : WINNT:4.0;
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
