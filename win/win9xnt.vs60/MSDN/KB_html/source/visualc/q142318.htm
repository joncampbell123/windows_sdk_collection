

<HTML>
<HEAD>
<TITLE>HOWTO: Remove OLE Controls &amp; Gallery Components from a Project </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142318">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1996/01/09">
<META NAME="Keywords" CONTENT="VwbIss">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  There are occasions when you may need to remove an OLE Control or Component Gallery component from your project. Because all components are different, the steps in this are general guidelines only.  MORE INFORMATION  Step-by-Step Prodder  1. If you...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QA9N,QACI,QAJG,QDH6,QANJ,QAH4,QDKD,QAA1,QAJN,QAY2,QA7O,QAOE,QAMN,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Remove OLE Controls &amp; Gallery Components from a Project</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142318</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The development environment included with:
   - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 4.2, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are occasions when you may need to remove an OLE Control or Component
Gallery component from your project. Because all components are different,
the steps in this are general guidelines only.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Step-by-Step Prodder
 

<OL><P><LI>If you are attempting to remove a Component Gallery component from
   your project, read the Results section of the component's Help file
   to find out what the component inserts into your application. If you
   are attempting to remove an OLE Control from your project, locate the
   wrapper classes for the OLE Control that have been inserted into your
   project.

<P><LI>Remove the source code files that were inserted into your project.
   Generally, these are source files that define the class and relevant
   code for the OLE Control or Component. For example, the Password
   Dialog Component creates and adds the PWDLG1.CPP and PWDLG1.H files
   to your project.

<P><LI>If you are attempting to remove a Component Gallery component, remove
   any code that is inserted into existing code files. For example,
   several Components insert code into a project's InitInstance()
   function. To find all occurrences of inserted code, search for
   "// CG:" in your .cpp files. This comment precedes each code
   insertion that was made to your application. Also, be sure to remove
   any added member declarations in the .h files, and make sure your
   remove all appropriate header files from these same source files. For
   example, to remove the Password Dialog Component from your project,
   remove the following from all files in your project:
<P>
<P><PRE>      #include "pwdlg1.h"
</PRE><P>
   When you remove code, be sure to remove any associated message map
   entries. For example, the Clipboard Assistant Component adds a number
   of message map entries to a project.

<P><LI>Remove any added resources. For example, the Password Dialog Component
   inserts a dialog resource into the project's resource file (.rc).
<P>
</OL>In addition to the previous steps, some OLE Controls and Component Gallery
components insert data at the end of your project's .mak file for VC 4.x
and .dsp file for VC 5.0. This data will not affect your project but may
prevent you from reinserting the Control or Component later. Developer
Studio uses this data to determine which controls to display in its
Controls toolbar. This data can be identified by the Section keyword. For
example, inserting the Splash Screen Component adds the following text to
your project's .mak or .dsp file:
<P>
<PRE>   #####################################################################
   # Section SplashIt : {21FFBCBF-33A6-11CF-9420-00AA00C14AF9}
   #   0:8:Splash.h:C:\SplashIt\Splash.h
   #   0:10:Splash.cpp:C:\SpashIt\Splash.cpp
   #   1:10:IDB_SPLASH:102
   #   2:10:ResHdrName:resource.h
   #   2:11:ProjHdrName:stdafx.h
   #   2:10:WrapperDef:_SPLASH_SCRN_
   #   2:12:SplClassName:CSplashWnd
   #   2:21:SplashScreenInsertKey:4.0
   #   2:10:HeaderName:Splash.h
   #   2:10:ImplemName:Splash.cpp
   #   2:7:BmpID16:IDB_SPLASH
   # End Section
   #####################################################################

</PRE></OL>To allow for re-inserting the Splash Screen Component, this section of text
must first be removed from the project's .mak or .dsp file.
<P>
WARNING: Remove only the entries for the component you want to delete. Do
not delete another component's entry that you may still need to keep.
<P>
To determine which Section entries belong to a particular component, you
should create a new MFC project, insert the component in question, and
examine this new project's .mak or .dsp file. Then you can remove the
identical Section entries from the original project.
 
<PRE>Keywords          : VwbIss
Version           : WINNT:4.0,4.1,4.2,5.0;
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
