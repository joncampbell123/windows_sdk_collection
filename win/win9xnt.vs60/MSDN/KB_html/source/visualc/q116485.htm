

<HTML>
<HEAD>
<TITLE>BUG: Visual Workbench Does Not Use .LIB Files as Dependents </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116485">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/06/20">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Microsoft Visual Workbench creates project (.MAK) files based on the individual files added to the project. These project files include dependencies of the target file (.EXE, DLL, and so forth). If a dependency file is modified and its time sta...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QAJN,QBVV,QBHQ,QAJQ,QAG0,QBXS,QAY2,QAVX,QAVW,QANE,QAKP,QBFY,QBCU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Visual Workbench Does Not Use .LIB Files as Dependents</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116485</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbtool kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The Visual Workbench included with:
   Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Visual Workbench creates project (.MAK) files based on the
individual files added to the project. These project files include
dependencies of the target file (.EXE, DLL, and so forth). If a dependency
file is modified and its time stamp is later then the target file, the
Visual Workbench should rebuild the target. Under the following conditions,
the rebuild does not occur when it should:

<UL><LI>The makefile is generated by Visual C++ and has been opened as an
   external makefile in the Visual Workbench.
<P>
   -or-

<LI>The same makefile is built using the external utility, NMAKE.EXE, from
   the MS-DOS prompt.
<P>
   -or-

<LI>The newly modified file is a .LIB file that is specified in the list of
   the project files by choosing Edit from the Project menu.
<P>
</UL>Under the above circumstances, choosing to build the project does not cause
the project to relink even though a library file has been modified.
<P>
However, if the same makefile is opened as an internal makefile in the
Visual Workbench and the Build option is chosen from the Project menu, the
project is linked again as it should be because a .LIB file has been
modified.
<P>
<P><h2>CAUSE</h2>
 
<P>
If a library file is added to the project list of files rather than being
added as a linker option, the Visual Workbench adds the library to the
makefile, but the library is not set as a dependency of the project's
(.EXE, DLL, and so forth) target file. The make engine used by the Visual
Workbench for internal makefiles is not the same as the NMAKE.EXE utility.
(The NMAKE.EXE utility is invoked for external makefiles by the Visual
Workbench.)
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two possible workarounds to this problem:

<UL><LI>If the .LIB file is not "code complete", add the .OBJ files that make up
   the library file to the project's list of files by using the Edit option
   on the Project menu instead of the .LIB file.
<P>
   -or-

<LI>Edit the makefile using the Visual Workbench or any other editor. Add
   the $(LIBS_EXT) macro to the $(PROJECT).EXE dependency block, which
   causes NMAKE to use the library as a dependency. The Visual Workbench
   accepts this minor change to the makefile. However, a shortcoming to
   this method is that the change disappears when you choose Scan All
   Dependencies from the Project menu.
<P>
   An example of the dependency line is shown below:
<P>
<P><PRE>      $(PROJ).EXE:: TEST.OBJ $(OBJS_EXT) $(DEFFILE)
</PRE><P>
   Adding the library dependency results in the above line being changed to
   the following:
<P>
<P><PRE>      $(PROJ).EXE:: TEST.OBJ $(OBJS_EXT) $(DEFFILE) $(LIBS_EXT)
</PRE><P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug with the Visual Workbench,
versions 1.0 and 1.5. We are researching the problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
This is not a problem with either Visual C++ 32-bit Edition.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: VWBIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
