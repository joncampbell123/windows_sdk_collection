

<HTML>
<HEAD>
<TITLE>FIX: "Unable to initialize DAO/Jet db engine" Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168004">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/05/02">
<META NAME="Keywords" CONTENT="MfcDAO VS97FixlistSP3 kberrmsg VS97FixlistSP2 VS97FixlistSP1">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you run a Visual C++ version 4.2 or 4.2b application on a machine that has the 4.21.7022 version of the MFC DLL (MFC42.DLL), the following message appears when you try to use MFC DAO classes:     Unable to initialize DAO/Jet db engine  CAUSE =...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QA56,QBFY,QAR4,QAB4,QA1S,QDO3,QAAP,QDNN,QBVV,QALH,QAKP,QDNL,QDIX,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: "Unable to initialize DAO/Jet db engine" Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168004</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, versions 4.2, 4.2b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Visual C++ version 4.2 or 4.2b application on a machine that
has the 4.21.7022 version of the MFC DLL (MFC42.DLL), the following message
appears when you try to use MFC DAO classes:
<P>
<PRE>   Unable to initialize DAO/Jet db engine

</PRE><h2>CAUSE</h2>
 
<P>
Version 4.21.7022 of the MFC DLL (MFC42.DLL), which comes with Visual C++
5.0, always incorrectly tries to use DAO 3.5. Visual C++ 4.2 applications
use DAO 3.0 and, therefore, DAO 3.0 is installed rather than DAO 3.5. When
MFC tries to load DAO 3.5 and it is not there, the error message shown
above appears.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Visual C++ applications that are statically linked with MFC do not use the
MFC42.DLL and do not see the problem. Also, the MFC DLL (MFC42.DLL) that
comes with Visual C++ 4.2 can be placed in the directory of the application
so that it is used, rather than the newer MFC DLL.
<P>
It is possible to fix the problem by installing DAO 3.5 on the machine as
well. However, keep in mind that this means you will be using a new Jet
database engine, which may introduce new problems with the application that
was tested using DAO 3.0.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Visual
Studio 97 Service Pack 1.
<P>
For additional information about the Visual Studio 97 Service Pack 1,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE><h2>MORE INFORMATION</h2>
 
<P>
You can see the bug with the MFC42.DLL by looking in the DAOCORE.CPP file
included with Visual C++ 5.0. In several places in the file you can see the
following code:
<P>
<PRE>      // Determine whether to use DAO 3.5 or 3.0
      // Use DAO 3.0 if DLL build and not
      // built with MFC 4.21 or later
      BOOL bUseDao30 = FALSE;

   #ifdef _AFXDLL
      AFX_MODULE_STATE* pModuleState = AfxGetModuleState();
      if (pModuleState-&gt;m_dwVersion &lt; 421)
         bUseDao30 = TRUE;
   #endif // _AFXDLL

</PRE>Notice that the version checking is incorrect. The version is checked
against '421' instead of '0x0421'. This means that bUseDao30 will always be
FALSE and this causes DAO 3.5 to be used.
 
<PRE>Keywords          : MfcDAO VS97FixlistSP3 kberrmsg VS97FixlistSP2 VS97FixlistSP1
Version           : 4.2 4.2b 5.0
Platform          : NT WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
