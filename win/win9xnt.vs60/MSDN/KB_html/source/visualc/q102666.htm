

<HTML>
<HEAD>
<TITLE>How to Register Another File Type for an Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102666">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1993/08/08">
<META NAME="Keywords" CONTENT="kb16bitonly WizardIss kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  If you do not associate a file extension with a document when you create an application in App Wizard 1.0, App Wizard does not generate any code to register the file extension. The text below presents the changes necessary to register a file extens...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAOG,QAJH,QA0A,QAUD,QAZV,QAP2,QBWS,QAUJ,QBCF,QBVV,QATX,QAGI,QBXN,QABG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Register Another File Type for an Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102666</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbtool
<P>
<P>
 
The information in this article applies to:

<UL><LI>The ClassWizard included with:
   Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you do not associate a file extension with a document when you create an
application in App Wizard 1.0, App Wizard does not generate any code to
register the file extension. The text below presents the changes necessary
to register a file extension in the Registration database.
<P>
To define the default file extension for an application, use App
Studio to change the application's string resources. For example,
change the following:
<P>
<PRE>   IDR_APPTYPE =
   \nApp\nApp Document

</PRE>to read as follows:
<P>
<PRE>   IDR_APPTYPE =
   \nApp\App Document\n.APP Files (*.app)\n.app\nAppFileType\nAppFileType

</PRE>This code is required for the document template when the application
calls AddDocTemplate(). You must also add the following code to the
InitInstance() function:
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/*
 * Compiler options needed: None
 */

// Cut and paste from line 155 of APPUI.CPP into your source file,
// before the InitInstance() call.
//
</PRE>static BOOL NEAR PASCAL SetRegKey(LPCSTR lpszKey, LPCSTR lpszValue)
{
<PRE>   if (::RegSetValue(HKEY_CLASSES_ROOT, lpszKey, REG_SZ, lpszValue,
          lstrlen(lpszValue)) != ERROR_SUCCESS)
      {
      TRACE1("Warning: registration database update failed for key
          '%Fs'\n", lpszKey);
      return FALSE;
      }

  return TRUE;
</PRE>}
<P>
<PRE>// Modify your InitInstance() definition to include the
// following code:

</PRE>BOOL CAppApp::InitInstance()
{
<PRE>   // Standard Initialization
     .
     .
     .
   m_pMainWnd = pMainFrame;

   // Add the follow code.
   m_pMainWnd-&gt;DragAcceptFiles();
   EnableShellOpen();
   RegisterShellFileTypes();

   // Registration Type Name
   CString      strFileTypeName;

   // Position used if more than one document template.
   POSITION     pos;
   CDocTemplate *pTemplate =
      (CDocTemplate*)m_templateList.GetNext(pos);
   pTemplate-&gt;GetDocString(strFileTypeName,
      CDocTemplate::regFileTypeName);

   // Add another file extension to registration database.
   // If you double-click a .APP or .SAV file in File Manager it
   // automatically starts this application.
   //
   // SetRegKey adds a file extension to the Registration Database
   ((void)SetRegKey(".sav", strFileTypeName);

   // create a new (empty) document)
   OnFileNew();
     .
     .
     .
   return TRUE;
</PRE>}
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Visual C++ for Windows, version 1.5, if you create a project using App
Wizard the code to register a file extension in the Registration database
may be automatically generated by performing the following steps:

<OL><P><LI>Choose AppWizard from the Project menu to create a new project.

<P><LI>Type in the Project Name.

<P><LI>Click on the Classes button in the MFC AppWizard dialog box.

<P><LI>Click on and select the document class to be created from the New
   Application Classes (the document class typically ends with doc).

<P><LI>The new File Extension and Doc Type Name boxes should be displayed with
   suggested text in the Doc Type Name box.

<P><LI>Fill in your file extension and doc type name.
<P>
   NOTE: If you do not enter any text in the file extensions box the code
   to register your file extension in the Registration database will NOT be
   automatically generated.

<P><LI>Click OK.

<P><LI>Click OK.

<P><LI>Review the New Application Information and click Create to generate your
   application.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00 1.50 no32bit noupdate<BR>
KBCategory: kbtool<BR>
KBSubcategory: WizardIss<BR>
Keywords            : kb16bitonly WizardIss kbtool<BR>
Version             : 1.00 1.50<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
