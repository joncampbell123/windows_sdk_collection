

<HTML>
<HEAD>
<TITLE>PRB: "Invalid Object Module" Error Usually From Old LINK </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q22331 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1987/12/16">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  An attempt to link an application fails and the Microsoft LINK utility generates the following message:        invalid object module  CAUSE =====  An incorrect version of Microsoft LINK is in use. In many systems, the MS-DOS directory is listed nea...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QBXB,QAFI,QAE2,QAAP,QBFY,QAR4,QBXA,QAYL,QAC1,QAPN,QAKJ,QAKC,QAA1,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Invalid Object Module" Error Usually From Old LINK</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q22331 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.10 6.00 6.00a 6.00ax 7.00 | 1.00 1.50
<PRE>MS-DOS                      | WINDOWS
</PRE>kbtool kbfasttip kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft C for MS-DOS, versions 5.1, 6.0, 6.0a, and 6.0ax
<LI>Microsoft C/C++ for MS-DOS, version 7.0
<LI>Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to link an application fails and the Microsoft LINK utility
generates the following message:
<P>
<PRE>      invalid object module

</PRE><h2>CAUSE</h2>
 
<P>
An incorrect version of Microsoft LINK is in use. In many systems, the
MS-DOS directory is listed near the beginning of the PATH environment
variable. MS-DOS includes a version of LINK that is often used instead
of the version provided with the C compiler.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Perform one of the following two steps to address this problem:

<UL><LI>Rename the older version of the linker. For example, change its
   name to LINK.OLD. The MS-DOS linker is probably not needed, but
   this method assures that it remains available.
<P>
   -or-

<LI>Modify the contents of your PATH environment variable to list the
   directory that contains the correct version of LINK.EXE before any
   other versions. However, the problem is more likely to recur with
   this approach when you make subsequent modifications to your system.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
To verify that an incorrect linker version is the cause of an "invalid
object module" error, perform the following six steps:

<OL><P><LI>Change the current directory to the directory in which the LINK.EXE
   version provided with the C compiler is installed.

<P><LI>Type "link" (without the quotation marks) at the MS-DOS command
   prompt.

<P><LI>When LINK displays its copyright banner message, note the displayed
   version number. This is the correct version of LINK to use.

<P><LI>Press CTRL+C to exit LINK.

<P><LI>Change the correct directory to the directory in which you compile
   and link your application.

<P><LI>Repeat steps 2 through 4 in this directory.
<P>
</OL>If the LINK version number that displays in your working directory is
less than the version number that displays in the C compiler directory,
then an older version of the LINK utility is installed in a directory
listed in the PATH environment variable before the directory that
contains the correct LINK version.
<P>
If you have an older version of LINK.EXE installed on your system,
determine the directory in which it is installed. Most likely, it is
in your MS-DOS directory. However, it could be the linker from another
Microsoft language product.
<P>
Because it is not uncommon to have a number of linkers in various
directories specified in the PATH, repeat the test above after you
make any of the modifications recommended in the RESOLUTION section of
this article.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 5.10 6.00 6.00a 6.00ax 7.00<BR>
KBCategory: kbtool kbfasttip kbprb<BR>
KBSubcategory: LinkIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
