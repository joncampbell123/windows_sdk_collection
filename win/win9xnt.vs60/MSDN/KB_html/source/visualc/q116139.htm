

<HTML>
<HEAD>
<TITLE>BUG: Visual C++ 1.5 Setup Does Not Set Up SHARE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116139">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/06/13">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Setup program for Visual C++ for Windows, version 1.5, does not modify the AUTOEXEC.BAT file to include changes for the file SHARE.EXE; it also does not modify the SYSTEM.INI file to include changes for the file VSHARE.386. The Visual C++ comma...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAA1,QDI2,QBVV,QBFY,QA56,QA55,QDL9,QBWQ,QBWN,QA3A,QBMR,QA9Q,QBI8,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Visual C++ 1.5 Setup Does Not Set Up SHARE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116139</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50
WINDOWS
kbsetup kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, version 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Setup program for Visual C++ for Windows, version 1.5, does not modify
the AUTOEXEC.BAT file to include changes for the file SHARE.EXE; it also
does not modify the SYSTEM.INI file to include changes for the file
VSHARE.386. The Visual C++ command line tools, as well as Object Linking
and Embedding (OLE) 2.0 compound file support, require file sharing to be
enabled. Details for these requirements can be found on page 9 of the
"Visual C++ Getting Started" manual. Symptoms of this may include a message
stating "System resource exhausted" when you try to build an app from DOS
(or a DOS box).  This message does not occur if the SHARE parameters are
set properly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Under Windows for Workgroups, be sure that the line
<P>
<PRE>   device=vshare.386

</PRE>appears in the [386Enh] section of the SYSTEM.INI file in the \windows
directory. Do not add the SHARE.EXE file to the AUTOEXEC.BAT file when
running Windows for Workgroups.
<P>
Under Windows 3.1, it is necessary for the AUTOEXEC.BAT file to
include the following line:
<P>
<PRE>   SHARE /L:500 /F:5100

</PRE>If SHARE is already installed, make sure that the /L:500 and /F:5100
options are properly set. The /L option sets the number of files that
can be locked at one time; the default value is 20. The /F option
allocates file space for the MS-DOS storage area used for file-sharing
information. This value needs to be at least 5100.
<P>
NOTE: Windows, version 3.1, does not support the Windows for Workgroups
vshare virtual device driver, so do not add a line for this to your
SYSTEM.INI file.
<P>
When installing Visual C++ 1.5 under Windows NT, SHARE does not need
to be installed in AUTOEXEC.BAT unless Visual C++ will be run under
MS-DOS by means of a dual-boot configuration.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug with Visual C++ 1.5 for
Windows. We are researching this bug and will post new information
here in the Microsoft Knowledge Base as soon as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.50<BR>
KBCategory: kbsetup kbbuglist<BR>
KBSubcategory: vc15setup<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
