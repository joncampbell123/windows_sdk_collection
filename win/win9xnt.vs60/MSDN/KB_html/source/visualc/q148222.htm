

<HTML>
<HEAD>
<TITLE>HOWTO: Update Property Values in a Property Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148222">
<META NAME="KBModify" CONTENT="1998/02/17">
<META NAME="KBCreate" CONTENT="1996/03/07">
<META NAME="Keywords" CONTENT="CDKIss MfcOLE">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QA7O,QAXB,QAB5,QAMN,QAKD,QBWC,QAOE,QAPF,QAC1,QBD2,QBWA,QBSO,QAA5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Update Property Values in a Property Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148222</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P>
<P><PRE>    - Microsoft Visual C++, 32-bit Edition, version 4.0. 5.0
    - Microsoft OLE Control Developer's Kit (CDK) versions 2.0, 2.1, 2.2
</PRE> -----------------------------------------------------------------------
<P>
</UL><h2>SUMMARY</h2>
 
<P>
To modify a property of an OLE control, you would normally change the
properties value in the control's property page. However, it is possible
for a property to be modifiable from more than one property page especially
in development environments such as Visual Basic. In this case, when you
change the property in the control's property page, you should synchronize
the value in Visual Basic's Property Form. This article shows by example
how to do it.
<P>
MORE INFORMATION
 
<P>
For example, in Visual Basic, place the Circ3 sample control on the Form
page. Then click the right mouse button to select properties for the
control. You will notice that the same properties can be seen in Visual
Basic's Properties window. For example, one of the properties of Circ3 is
the CircleOffset property. If you change this value in the Control's
property page and click Apply, you will notice that the value has not been
updated in Visual Basic's Properties window. To synchronize the value in
both, you need to call BoundPropertyChanged(dispid) for each property you
want to update.
<P>
Note that the dispid is the id of the property to update. It is usually
found in the header file of the COleControl-derived class. The dispids for
the Circ3 control follow:
<P>
<PRE>// Dispatch and event IDs
</PRE>public:
<PRE>       enum {
       //{{AFX_DISP_ID(CCirc3Ctrl)
       dispidCircleShape = 2L,
       dispidCircleOffset = 3L,
       dispidFlashColor = 1L,
       dispidNote = 4L,
       eventidClickIn = 1L,
       eventidClickOut = 2L,
       //}}AFX_DISP_ID
       };

</PRE>The following sample code shows how to modify the Circ3 sample to
synchronize the CircleShape and CircleOffset properties given the dispids
above.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: none
*/

void CCirc3Ctrl::OnCircleShapeChanged()
</PRE>{
<PRE>   SetModifiedFlag();

   // force the control to redraw itself
   InvalidateControl();

   // reset the circle offset, if necessary
   if (m_circleShape)
      SetCircleOffset(0);

   BoundPropertyChanged(dispidCircleShape);      // *ADD THIS LINE*
}

void CCirc3Ctrl::SetCircleOffset(short nNewValue)
</PRE>{
<PRE>   // Validate the specified offset value
   if ((m_circleOffset != nNewValue) &amp;&amp; m_circleShape&amp;&amp;
       InBounds(nNewValue))
   {
      m_circleOffset = nNewValue;
      SetModifiedFlag();
      BoundPropertyChanged(dispidCircleOffset); // *ADD THIS LINE*
      InvalidateControl();
   }
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Property Page Form Browser<BR>
Keywords          : CDKIss MfcOLE<BR>
Technology        : kbole kbMfc<BR>
Version           : Winnet:2.0,2.1,2.2,4.0,5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
