

<HTML>
<HEAD>
<TITLE>INFO: Tips for Remote Debugging with Visual C++ 2.x, 4.0, 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131058">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1995/06/02">
<META NAME="Keywords" CONTENT="WBDebug kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Chapter 14 of the Visual C++ User's Guide for Visual C++ version 2.x and chapter 17 of the Visual C++ User's Guide for Visual C++ version 4.0 describe how to install the Remote Debug Monitor (MSVCMON.EXE) and how to configure the remote connection....">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QANN,QBFY,QA56,QA55,QAI5,QBG2,QABI,QAVX,QBWO,QAA1,QDJ9,QBXS,QABA,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Tips for Remote Debugging with Visual C++ 2.x, 4.0, 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131058</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The development environment included with:
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 4.0, 4.2, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Chapter 14 of the Visual C++ User's Guide for Visual C++ version 2.x and
chapter 17 of the Visual C++ User's Guide for Visual C++ version 4.0
describe how to install the Remote Debug Monitor (MSVCMON.EXE) and how to
configure the remote connection. Query on "Remote Debug" if you are using
Visual C++ version 5.0. This article provides further details and gives two
methods to help you get started. Note that Visual C++ versions 4.2 and 5.0
do not support WIN32S and Macintosh platforms. Version 5.0 does not support
Serial connection.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The remote debug monitor is a small program on the target computer that
communicates with the debugger and controls the execution of the program
you are debugging.
<P>
To install the remote debug monitor:

<UL><LI>On a Windows 95 or NT computer, the remote debug monitor consists of
   the following files: MSVCMON.EXE, MSVCRT40.DLL, TLN0COM.DLL, TLN0T.DLL,
   and DMN0.DLL. Copy these files to the remote computer. If you are using
   Visual C++ version 5.0, then copy MSVCMON.EXE, MSVCRT.DLL, TLN0T.DLL,
   DM.DLL, MSVCP5O.DLL and MSDIS100.DLL to the remote computer. If remote
   computer is NT 4.0, then copy PSAPI.DLL also.

<LI>On a Win32s computer, the remote debug monitor consists of MSVCMON.EXE,
   TLW3COM.DLL, and DMW3.DLL. These files are installed automatically
   during setup.

<LI>On a Macintosh, the remote monitor is a control panel, called VC++ Debug
   Monitor, installed automatically by the Visual C++ for Macintosh setup
   program.

<LI>On a Power Macintosh, the remote debugger is an application, called VC++
   PowerMac Remote Monitor, installed automatically by the Visual C++ for
   Macintosh setup program. Setup also installs the following files: VC++
   Power Macintosh File Utility, VC++ Power Macintosh ADSP Transport, VC++
   Power Macintosh TCP/IP Transport, and VC++ Power Macintosh Serial
   Transport.
<P>
</UL><h3>Method One - Windows NT host, Win32s remote.</h3>
 
<P>
If you are using Visual C++ versions 4.2 and 5.0, the host and remote
machines can be either a Windows NT machine or a Windows 95 machine, as can
the local machine. Therefore, the project can reside in the local machine
of your choice.

<OL><P><LI>Setup a shared directory that both the local Windows NT machine and the
   remote machine can view. The shared directory can be on either machine
   or a network drive. The easiest option is to share the directory on the
   local Windows NT machine which contains the project's executable.

<P><LI>Load the project into the Visual C++ development environment running
   on Windows NT.

<P><LI>Open the Project Setting dialog box. (In Visual C++ 2.x, choose Settings
   from the Project menu; in Visual C++ 4.0, choose Settings from the Build
   menu; in Visual C++ 5.0, choose Settings from the Project menu.) Select
   the Debug tab. Set the following sections:
<P>
<P><PRE>    - Executable for Debug Session: Enter the name and path of the
      executable as the local Windows NT computer sees it.
</PRE><P>
<P><PRE>    - Additional DLLs: Enter the name and path of any DLLs as the local
      Windows NT computer sees them.
</PRE><P>
<P><PRE>    - Remote Executable Path: Enter the name and path of the executable as
      the remote computer sees it.
</PRE><P>
<P><PRE>    - Working Directory: Should be blank.
</PRE>
<P><LI>Start the remote debugger on the remote computer by starting
   MSVCMON.EXE. For the Win32s platform, find the Visual C++ Win32s program
   group, and select the Visual C++ Debug Monitor icon. Choose the connect
   button to start the connection.

<P><LI>On the Windows NT host computer, check the connection information.
   In the Visual C++ 2.x, choose Options from the Tools menu. Then select
   the Debug tab. Make sure Remote Debugging is selected. Choose the
   Connections button, and confirm the type of connection. Also, select
   Settings and confirm the settings.
   In Visual C++ 4.0, choose Remote Connection from the Tools menu. Confirm
   the choices for Platform and Connection. Select Settings to configure
   the specified connection.
<P>
   In Visual C++ 5.0, choose "Debugger Remote connection" from the Build
   menu. Choose Network (TCP/IP ) then Settings. Enter remote machine name
   or IP address, no password needed. You can ignore the symbolic
   information not found messages for the system DLLs when the debugger is
   started in Step 6 below.
<P>
   NOTE: For Intel (x86) machines, Visual C++ 2.x only supports remote
   debugging via serial connections. In Visual C++ 4.0, it is possible to
   debug using a network connection with TCP/IP except on Win32s, which
   requires a serial connection.

<P><LI>Start Debugging.
<P>
</OL><h3>Method Two</h3>
 
<P>
If you can't make a shareable directory, copy the executable and any
needed DLLs to the remote computer. With this method you need to be sure
that the executables and DLLs are re-copied whenever changes are made.
All the other steps remain the same.
<P>
<P><h3>Troubleshooting</h3>
 
<P>
If the development environment can't find the executable, make sure the
correct directories for the correct computers are given in step 3.
<P>
Since Visual C++ version 5.0 supports only TCP/IP connection, check for
correct machine name and proper network connection with TCP/IP protocol
available. The following troubleshooting does not apply to version 5.0.
<P>
If the connection fails:

<UL><LI>Test the COM port by running Terminal (a Windows version 3.x and Windows
   NT applet) on both your Windows NT computer and your Win32s computer.
   (For information on how to use Terminal, please see your Windows
   manual.) Anything typed into Terminal on one computer should show up in
   Terminal on the other.

<LI>Check the COM port settings. The most reliable setting is 9600 baud with
   XON/XOFF.

<LI>Try a different cable (a null modem cable).

<LI>Try a different COM port.

<LI>If you are using the Windows debug kernel, use the normal kernel.

<LI>On Win32s, complete a Windows clean boot, and do not start any
   applications other than the remote monitor. For information about how to
   perform a clean boot, please see the following articles in the Microsoft
   Knowledge Base:
<P>
   ARTICLE-ID: <B><A href="../win3x/q87290.htm">Q87290</A></B>
<PRE>   TITLE     : What Is a Clean Boot for Windows 3.1?

   ARTICLE-ID: <B><A href="../win3x/q90511.htm">Q90511</A></B>
   TITLE     : What Is a Clean Boot for Windows for Workgroups?
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 9.00 9.10<BR>
Keywords          : WBDebug kbtshoot<BR>
Version           : WINNT:2.0,2.1,4.0,4.2,5.0;<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
