

<HTML>
<HEAD>
<TITLE>How to Hide the Apply Button in CPropertySheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141039">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1995/12/11">
<META NAME="Keywords" CONTENT="MfcUI kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  A modal CPropertySheet will automatically create an Apply button. To hide this button, you need to use different methods for different versions of MFC.  In Visual C++ 2.2 and earlier (MFC 3.2 and earlier), you can derive a class from CPropertySheet...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBFY,QA56,QA55,QA5D,QAJD,QAUD,QANS,QADZ,QAPN,QAH4,QBW8,QAIF,QAFU,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Hide the Apply Button in CPropertySheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141039</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE>1.52    | 2.00 2.10 2.20 4.00
</PRE>WINDOWS | WINDOWS NT
kbprg kbhowto kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P>
<P><PRE>    - Microsoft Visual C++ for Windows, version 1.52
    - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A modal CPropertySheet will automatically create an Apply button. To hide
this button, you need to use different methods for different versions of
MFC.
<P>
In Visual C++ 2.2 and earlier (MFC 3.2 and earlier), you can derive a class
from CPropertySheet, override OnCreate(), call GetDlgItem(ID_APPLY_NOW),
and finally call ShowWindow(SW_HIDE) to hide the Apply button.
<P>
In Visual C++ 4.0 (MFC 4.0), CPropertySheet has a public member called
m_psh. m_psh is a PROPSHEETHEADER structure with a dwFlags member. One of
the possible values of m_psh.dwFlags is PSH_NOAPPLYNOW. Setting this value
before the call to DoModal() hides the Apply button. Another option in
Visual C++ 4.0 is to call GetDlgItem()/ShowWindow(), but you should do it
in OnInitDialog() instead of OnCreate().
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Visual C++ 2.2 and earlier, CPropertySheet was implemented internally by
MFC. Starting with Visual C++ 4.0, the CPropertySheet uses the Windows 95
PropertySheet control, so the method for hiding the Apply button changed.
<P>
You can hide any of the default buttons in a modal property sheet by using
the methods in this article. The IDs for each button are IDOK (OK button),
IDCANCEL (Cancel button), ID_APPLY_NOW (Apply button), and IDHELP (Help
button). Note that the Apply button is disabled by default until you call
SetModified(). In addition, in Visual C++ 4.0, the Help button is not shown
by default. To show it, you can set m_psh.dwFlags |= PSH_HASHELP.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/***** this code applies to Visual C++ 4.0 and later *****/
void CMyView::OnDisplayModalSheet()
</PRE>{
<PRE>   CMySheet sheet ("Set Properties");
   // this hides the Apply button
   sheet.m_psh.dwFlags |= PSH_NOAPPLYNOW;
   sheet.DoModal ();
</PRE>}
<P>
<PRE>/* You can also do the following to hide the Apply button */

</PRE>BOOL CMySheet::OnInitDialog()
{
<PRE>   CPropertySheet::OnInitDialog();

   // this hides the Apply button
   CWnd* pApplyButton = GetDlgItem (ID_APPLY_NOW);
   ASSERT (pApplyButton);
   pApplyButton-&gt;ShowWindow (SW_HIDE);

   return TRUE;
</PRE>}
<PRE>/*********************************************************/

/***** this code applies to Visual C++ 2.2 and earlier *****/
int CMySheet::OnCreate(LPCREATESTRUCT lpCreateStruct)
</PRE>{
<PRE>   if (CPropertySheet::OnCreate(lpCreateStruct) == -1)
      return -1;

   // this hides the Apply button
   CWnd* pApplyButton = GetDlgItem (ID_APPLY_NOW);
   ASSERT (pApplyButton);
   pApplyButton-&gt;ShowWindow (SW_HIDE);

   return 0;
</PRE>}
<PRE>/*********************************************************/
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.52 2.00 2.10 2.20 4.00<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: MfcUI<BR>
Keywords          : MfcUI kbcode kbhowto kbprg<BR>
Technology        : kbMfc<BR>
Version           : 1.52 | 2.00 2.10 2.20 4.00<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
