

<HTML>
<HEAD>
<TITLE>FIX: Library Version of atan2(0,0) Does Not Return 0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122276">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1994/11/01">
<META NAME="Keywords" CONTENT="CRTIss kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The on-line help and documentation for Visual C++ specify that calling the atan2 function should return 0.0 if both parameters are 0. The documentation is correct, but the library version of atan2() does not return 0.0, rather, it returns a  not a ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAUD,QAY5,QAKR,QAGI,QBV8,QAR4,QBVV,QAB9,QBHQ,QBFY,QAC1,QAI4,QAIF,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Library Version of atan2(0,0) Does Not Return 0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122276</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 2.00 2.10 4.00
WINDOWS NT
kbprg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>The C Run-Time (CRT), included with Microsoft Visual C++,
   32-bit Edition, versions 1.0, 2.0, 2.1, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The on-line help and documentation for Visual C++ specify that calling
the atan2 function should return 0.0 if both parameters are 0. The
documentation is correct, but the library version of atan2() does not
return 0.0, rather, it returns a "not a number" value.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The true intrinsic version of atan2() works as documented. There are
two ways to instruct the compiler to use the true intrinsic version of
the atan2() function:

<UL><LI>Compile with the /Oi and /Og switches, or any switch that implies
   them both (such as /Ox or /O2). Using /Oi and /Og together instructs
   the compiler to replace function calls with their true intrinsic
   version, if one exists. Therefore, when using these switches
   together, the library version of atan2() is never called, and the
   problem does not occur.
<P>
   NOTE: /Oi and /Og are implied by the /O2 switch, which is the current
   default for release mode builds.
<P>
   -or-

<LI>Use the #pragma intrinsic directive at the global level in the source
   file that requires the use of atan2() as in this example:
<P>
   #pragma intrinsic(atan2)

<LI>The #pragma stays in effect for the entire source file. Use the #pragma
   function directive to instruct the compiler to use the library version
   of atan2(). Because the #pragma intrinsic is equivalent to using /Oi on
   the command line, the source file must be compiled with /Og, as above.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. This bug was corrected in
Microsoft Visual C++ 32-bit Edition, version 4.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A true intrinsic function is a function that gets expanded inline without
the overhead of a function call. These can be faster than full function
calls. In the case of atan2(), both arguments are pushed onto the floating
point stack, and the arctangent of y/x is calculated via the fpatan
instruction.
<P>
The "not a number" value is -1.#IND00.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed to show the problem: none
   Compile options for workaround /Oi /Og
*/

#include &lt;stdio.h&gt;
#include &lt;math.h&gt;

void main(void) {
     double testreturn;

     testreturn = atan2(0.0,0.0);
     printf("testreturn = %lf",testreturn);
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.10 2.00 4.00 partial arctangent<BR>
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: CRTIss<BR>
Keywords          : CRTIss kbbuglist kbfixlist kbprg<BR>
Version           : 1.00 2.00 2.10 4.00<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
