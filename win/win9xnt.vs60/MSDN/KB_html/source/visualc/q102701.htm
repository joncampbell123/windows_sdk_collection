

<HTML>
<HEAD>
<TITLE>PRB: C2609 or C4270 Error from IOMANIP.H Contents </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102701">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1993/08/08">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  An attempt to compile a C++ application that uses the functions declared in IOMANIP.H fails and Visual C++ generates messages such as the following.  When the compiler command line specifies the /Za option switch:     error C2609: 'initializing' : ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBFY,QAKR,QAH4,QAHE,QBV8,QBVV,QAOT,QAUD,QAEV,QAAP,QAB9,QA56,QA55,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: C2609 or C4270 Error from IOMANIP.H Contents</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102701</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to compile a C++ application that uses the functions declared in
IOMANIP.H fails and Visual C++ generates messages such as the following.
<P>
When the compiler command line specifies the /Za option switch:
<P>
<PRE>   error C2609: 'initializing' : cannot implicitly convert a
         non-lvalue
      'class ::__SMANIP_int ' function return to a
      'class ::__SMANIP_int &amp;' that is not const

</PRE>When the compiler command line does not contain the /Za option switch or
when it contains the /Ze option switch:
<P>
<PRE>   warning C4270: 'initializing' : do not initialize a non-const
      'class ::__SMANIP_int __near &amp;' with a non-lvalue
      'class ::__SMANIP_int ' function return

</PRE>Microsoft C/C++ version 7.0 does not generate these messages.
<P>
The Visual C++ online help files do not document the C4270 warning message.
<P>
<P><h2>CAUSE</h2>
 
<P>
The C4270 is a new warning message introduced starting with Microsoft C/C++
compiler version 8.0 for MS-DOS, which is included with Visual C++ version
1.0 for Windows. Bjarne Stroustrup's book "Annotated C++ Reference Manual"
contains an ambiguity regarding initializing const and non-const
references. To address this ambiguity, the C4270 warning was added to the
compiler but it was overlooked in the documentation.
<P>
The IOMANIP.H header file contains examples of the assignment ambiguity,
and the compiler correctly generates these errors or warnings when it
processes the header file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The warning message is self-explanatory: the function return value is not
an lvalue, therefore, you should not initialize a non-const reference with
it. To work around this problem, perform one of the following four steps:

<UL><LI>Modify the compiler command line to remove the /Za option switch.

<LI>Modify your source code to specify a pragma to turn off the warning
   message. With this method, you can turn the warning on and off in
   the code as desired, or you can disable the warning for the entire
   compilation.

<LI>Compile the code at warning level 1.

<LI>Modify the insertion operator declarations in IOMANIP.H to accept
   const references instead of non-const references.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This error occurs in the sample code listed in Example 3 (page 369) in
Chapter 18, "Fundamentals of iostream Programming," of the "Class Library
User's Guide." The following sample code demonstrates this problem and how
to use a pragma to control the warning:
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/*
 * Compiler options needed: /c /W2
 */

#include &lt;iostream.h&gt;
#include &lt;iomanip.h&gt;

void main()
</PRE>{
<PRE>//#pragma warning(disable: 4270)
    cout &lt;&lt; setw(4) &lt;&lt; "test" &lt;&lt; endl;
//#pragma warning(default: 4270)
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 8.00 8.00c SMANIP IMANIP OMANIP<BR>
IOMANIP<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: CPPLngIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
