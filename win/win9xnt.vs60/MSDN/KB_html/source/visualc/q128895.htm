

<HTML>
<HEAD>
<TITLE>PRB: LNK2001 Link Error on Floating Division Functions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128895">
<META NAME="KBModify" CONTENT="1996/01/09">
<META NAME="KBCreate" CONTENT="1995/04/12">
<META NAME="Keywords" CONTENT="kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Compiling a program containing floating point divisions and linking with run-time libraries other than those supplied with Microsoft Visual C++ version 2.1 can result in LNK2001 unresolved external errors on the following functions:     __adj_fdiv_...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANO,QBC9,QBC8,QBHQ,QAY5,QBV8,QBFY,QAAP,QAB9,QAB4,QA56,QA55,QBQU,QAKM,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: LNK2001 Link Error on Floating Division Functions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128895</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>The Microsoft C/C++ Compiler (CL.EXE) included with:
   Microsoft Visual C++, 32-bit Edition, version 2.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Compiling a program containing floating point divisions and linking with
run-time libraries other than those supplied with Microsoft Visual C++
version 2.1 can result in LNK2001 unresolved external errors on the
following functions:
<P>
<PRE>   __adj_fdiv_m32
   __adj_fdiv_m64
   __adj_fdivr_m64
   __adjust_fdiv

</PRE>This can occur when linking to libraries such as CRTDLL.LIB or the run-time
libraries that came with Microsoft Visual C++ version 2.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
The compiler and libraries that ship with Microsoft Visual C++ version 2.1
provide a method of avoiding Pentium division instructions. Pentium
division instructions can generate inaccurate results in some cases. The
compiler inserts calls to emulation functions instead of inserting floating
point processor instructions. These floating point division emulation
functions are in the run-time libraries shipped with version Visual C++
version 2.1, but not with earlier versions of the libraries.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The libraries and compiler that come with Microsoft Visual C++ version 2.1
are designed to work together. If other libraries must be used, use the
following compiler switch to force insertion of floating point processor
instructions instead of inserting calls to the emulation functions:
<P>
<PRE>   /QIfdiv-          {use coprocessor instead of calls to functions}

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The sample code below will generate the following four errors if the LIB
environment variable is pointing to the Visual C++ version 2.0 libraries:
<P>
<PRE>   error LNK2001: unresolved external symbol "__adj_fdiv_m32"
   error LNK2001: unresolved external symbol "__adj_fdiv_m64"
   error LNK2001: unresolved external symbol "__adj_fdivr_m64"
   error LNK2001: unresolved external symbol "__adjust_fdiv"

</PRE>Using the compile option "/QIfdiv-" will prevent the references to these
functions.
<P>
For information about a related issue on Pentium floating point functions,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q128148.htm">Q128148</A></B>
   TITLE     : Procedure Entry Point fdiv Not Located in MSVCRT20.DLL

</PRE><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: none
   Environment needed    : set LIB point to a directory with the VC++
                           2.0 libraries
*/

void main(void) {
   double x=1.2,z;
   float y=2.1;
   z=x/y;
   x=x/z;
   x=1/z;
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.10 2.00 2.55 9.10<BR>
KBCategory: kbtool kbprb<BR>
KBSubcategory: CRTIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
