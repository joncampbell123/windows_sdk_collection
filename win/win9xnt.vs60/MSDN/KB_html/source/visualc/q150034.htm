

<HTML>
<HEAD>
<TITLE>PRB: LPPICTUREDISP Cannot Be Passed Across Process Boundaries </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150034">
<META NAME="KBModify" CONTENT="1998/02/17">
<META NAME="KBCreate" CONTENT="1996/04/18">
<META NAME="Keywords" CONTENT="CDKIss MfcOLE">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  An automation server that implements a Picture object wrapped by the CPictureHolder class in MFC fails when it attempts to pass a pointer to the picture object's IPictureDisp implementation across process boundaries.  CAUSE =====  IPictureDisp gain...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAB5,QAYS,QAUD,QAK0,QAIB,QAH7,QAH6,QAD7,QAH4,QBBS,QBW7,QAI5,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: LPPICTUREDISP Cannot Be Passed Across Process Boundaries</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150034</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1, 5.0
    - Microsoft OLE Control Developer's Kit (CDK) versions 1.0, 1.1, 1.2
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An automation server that implements a Picture object wrapped by the
CPictureHolder class in MFC fails when it attempts to pass a pointer to the
picture object's IPictureDisp implementation across process boundaries.
<P>
<P><h2>CAUSE</h2>
 
<P>
IPictureDisp gains access to methods of the Picture object that cannot
be marshaled across process boundaries. For example, IPictureDisp
supports DISPID_PICT_RENDER to gain access to the Render method of the
Picture object. The Render method takes a handle to a device context as the
first parameter. Device context handles cannot be marshaled.
<P>
Dispatch interfaces can normally be marshalled by using the IDispatch
marshaling code, but the Picture object implements IMarshal specifically to
cause its marshaling to fail.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ClassWizard in Visual C++ allows you to select a return type of
LPPICTUREDISP for a method. This method might return the IPictureDisp
interface obtained by calling CPictureHolder::GetPictureDispatch. However,
if this method is called by a controller running in another process, the
method fails and returns an error code of E_FAIL.
<P>
Because the Picture object causes the marshaling of IPictureDisp to fail,
problems can also occur when trying to obtain an IPictureDisp interface
across thread boundaries in a multiple-thread apartment model object.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on marshaling, please see "Inside OLE," second
edition, by Kraig Brockschmidt, Chapter 6, "Local/Remote Transparency,"
published by Microsoft Press.
 
<PRE>Keywords          : CDKIss MfcOLE
Technology        : kbole kbMfc
Version           : Winnet:1.5,1.51,1.52,2.0,2.1,2.2,5.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
