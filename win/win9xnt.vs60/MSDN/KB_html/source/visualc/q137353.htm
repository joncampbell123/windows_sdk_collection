

<HTML>
<HEAD>
<TITLE>PRB: Stock Font and Color Property Pages Fail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137353">
<META NAME="KBModify" CONTENT="1996/08/14">
<META NAME="KBCreate" CONTENT="1995/09/25">
<META NAME="Keywords" CONTENT="kbole kbtshoot kbprb">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you include one of the stock CDK property pages (Font, Color, or Picture) in your application, it may not appear when the property sheet dialog box is displayed. The default and other custom property pages may still be visible.  CAUSE =====  O...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA37,QADF,QBJZ,QBWA,QAPG,QAG9,QBWC,QBFY,QA56,QA55,QDNN,QBXB,QBWP,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Stock Font and Color Property Pages Fail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 14, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137353</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
<PRE>  4.1, 4.2
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you include one of the stock CDK property pages (Font, Color, or
Picture) in your application, it may not appear when the property sheet
dialog box is displayed. The default and other custom property pages may
still be visible.
<P>
<P><h2>CAUSE</h2>
 
<P>
One possible cause of this problem is the lack of registration of the DLL
which includes the stock property page implementations.
<P>
Depending on the version of Visual C++, this DLL is:
<P>
VC 2.X ==&gt; OC30.DLL
VC 4.0, VC 4.1 ==&gt; MFC40.DLL
VC 4.2 ==&gt; MFC42.DLL
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Register the appropriate DLL using regsrv32.exe that comes with the CDK and
is located in the CDK \Bin directory. Use this line:
<P>
<PRE>   REGSVR32 OC30.DLL

</PRE><h2>STATUS</h2>
 
<P>
Microsoft is researching this behavior and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft has seen several cases where Oc30.dll was either not registered
at all or only partially registered. We have not been able to isolate the
cause of this failure.
<P>
Before attempting to register OC30.DLL, confirm that it is in the System32
directory in Windows NT and the System directory in Windows 95.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
To demonstrate the problem, first confirm that the CIRC3 sample has been
compiled and registered. Confirm that the Font and Color property pages are
seen when the control is run by looking at the property sheet from the menu
selection Edit Properties. Then follow these steps:

<OL><P><LI>Delete the Font class ID from the HKEY_CLASSES_ROOT\CLSID.  The
   CLSID for the Font property page is:
<P>
   {2542F180-3532-1069-A2CD-00AA0034B50B}.

<P><LI>Run a container (On the Tools menu, click Test Container in Visual C++),
   and insert the CIRC3 Ole control.

<P><LI>On the Edit menu, click Properties, and note that the Font property page
   is no longer visible.
<P>
</OL>You could also delete the Color property page ID:
<P>
<PRE>   {DDF5A00-B9C0-101A-AF1A-00AA0034B50B}

</PRE></OL>Or the Picture proper page ID:
<P>
<PRE>   {FC7AF71D-FC74-101A-84ED-08002B2EC713}

</PRE>NOTE: The class IDs for these property pages are different under Visual C++
version 4.x
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 2.20 invisible fail hidden<BR>
KBCategory: kbole kbprb kbtshoot<BR>
KBSubcategory:<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 14, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
