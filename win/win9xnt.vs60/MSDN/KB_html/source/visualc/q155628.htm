

<HTML>
<HEAD>
<TITLE>PRB: "Save As" Does Not Save a Stored Procedure on the Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155628">
<META NAME="KBModify" CONTENT="1997/06/26">
<META NAME="KBCreate" CONTENT="1996/09/04">
<META NAME="Keywords" CONTENT="kbprg VCEntIDE VCEntIss kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  If you click Save As on the File menu in MSDEV to save a stored procedure, the stored procedure code will be saved as a text file on disk instead of being stored in the server database.  CAUSE =====  File.Save As is not intended for use in saving s...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUR,QAB9,QAU7,QBTI,QBRZ,QAUJ,QAH4,QAHD,QBVV,QABM,QAJQ,QAFI,QDNQ,QA5E,QARM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Save As" Does Not Save a Stored Procedure on the Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155628</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, Enterprise Edition, version 4.2, 4.2b, 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you click Save As on the File menu in MSDEV to save a stored procedure,
the stored procedure code will be saved as a text file on disk instead of
being stored in the server database.
<P>
<P><h2>CAUSE</h2>
 
<P>
File.Save As is not intended for use in saving stored procedures to the
server.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The resolution to this problem depends on your intention:
<P>
If you are attempting to modify an existing stored procedure and save those
modifications to the server to overwrite the original stored procedure
code, then use the File.Save menu item.
<P>
If you are attempting to save the stored procedure code to a new stored
procedure on the server, then you can follow these steps:

<OL><P><LI>Insert a new stored procedure on the server by selecting the "Stored
   Procedures" node in the Data View pane and right-clicking. When
   prompted, specify a name for the target stored procedure that is
   different from the name of any existing stored procedure.

<P><LI>Copy the body of the stored procedure you want to duplicate and paste
   the selection into the body of the new stored procedure.
<P>
   Note: Be sure not to overwrite the name of the new stored procedure when
   pasting code or you will experience the following error when you try to
   save the stored procedure:
<P>
<P><PRE>      The database object &lt;name of existing SP&gt; already exists
</PRE>
<P><LI>Make any additional modifications to the new stored procedure code, and
   then use File.Save to save the new procedure to the server.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
When you click File.Save As, MSDEV brings up the Save As dialog box with
the title of the edit window as the file name, allowing the user to save
the stored procedure to disk as a text file with this name. If you save the
procedure with this name, it is possible to later open both the text file
and the stored procedure and to end up with two windows that have the same
title. You cannot execute a stored procedure that has been saved in this
manner.
<P>
If you save the file with a .sql extension, MSDEV interprets this file name
as a SQL script file and allows execution of it within MSDEV. However, you
are not executing a stored procedure on the server when you execute such a
file. Instead, the file name will result in execution of the full Transact
SQL statement contained in the file, and the resulting attempt to create a
procedure with the same name as an existing stored procedure will likely
result in the error:
<P>
<PRE>   37000[Microsoft][ODBC SQL Server Driver][SQL Server]
   Object 'your procedure name' group number 1 already exists in the
   database.  Choose another procedure name.

</PRE></OL>If you save the modified stored procedure with the .sql extension and
specify a new name for the stored procedure, you can then successfully
execute the SQL script file to create a new stored procedure on the server.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Enterprise<BR>
Keywords            : kbprg VCEntIDE VCEntIss kbprg<BR>
Technology          : kbMfc<BR>
Version             : 4.2 4.2b 5.0<BR>
Platform            : NT Windows<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
