

<HTML>
<HEAD>
<TITLE>INFO: Migrating Visual C++ for Windows to Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103719">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1993/08/29">
<META NAME="Keywords" CONTENT="VCGenIss kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When porting a simple application built by AppWizard from Visual C++ for Windows to Visual C++ 32-bit Edition, a few changes are needed. Here are some helpful hints:   - The .MAK files are not compatible, so a new one must be created.   - The      ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QA55,QBFY,QA56,QDL9,QBWQ,QBWO,QBWN,QAEF,QAJH,QASR,QAH4,QAYY,QANJ,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Migrating Visual C++ for Windows to Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103719</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 1.0, 2.0, 2.1, 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When porting a simple application built by AppWizard from Visual C++
for Windows to Visual C++ 32-bit Edition, a few changes are needed.
Here are some helpful hints:

<UL><LI>The .MAK files are not compatible, so a new one must be created.

<LI>The &lt;PROJECT&gt;.RC2 file includes VER.H, which has been changed to
   WINVER.H for Windows NT, so this must be modified.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
In the Visual C++ version 5.0 Books Online, the Porting and Upgrading
section of the Visual C++ Programmer's guide discusses some of the common
issues concerning porting applications from Visual C++ for Windows (16-bit)
to Visual C++ for Windows NT (32-bit). In the Visual C++ version 4.0, this
information was in Books Online, the "Porting" chapter of the "Key Visual
C++ Topics". In previous versions of Visual C++ 32-bit Edition, this
information is covered in the help file MIGRATING.HLP which is accessible
through the "Moving to Visual C++" help icon in the Visual C++ for Windows
NT program group.
<P>
With version 5.0 the steps for porting a Microsoft Foundation Class (MFC)
application are discussed in the Changes in MFC Versions in the Details
section of the Porting and Upgrading topic. With 4.0 they are in the
"Between MFC Versions" topic of the "Porting" chapter in the Visual C++
version Books Online. To find this information, search on "porting MFC
applications." These steps are also addressed in the MFC.HLP file included
with Visual C++ 32-bit edition versions 1.0 and 2.x. To access this
information, select "MFC Help" and choose "Steps for Porting Framework Apps
to 32-Bits."
<P>
With slight variation, the steps for porting a MFC application are:

<OL><P><LI>Import your application files into a new project.

<P><LI>Remove VBX controls.

<P><LI>Remove Windows for Pen Computing extensions.

<P><LI>Remove AFXDLL.

<P><LI>Change VER.H to WINVER.H.

<P><LI>Replace difficult-to-port code, such as assembly language functions
   and MS-DOS calls, with stubs.

<P><LI>Build your 16-bit application with Visual C++ for Windows NT and note
   any 32-bit related problems.

<P><LI>Use the information in the Porting and Upgrading sections to correct any
   problems.

<P><LI>Implement each stubbed function with portable code until the entire
   application runs correctly.
<P>
</OL>Further details on each step are provided in the online documentation
or help files mentioned above.
 
<PRE>Keywords          : VCGenIss kbfasttip
Version           : WINNT:1.0,2.0,2.1,4.0,5.0
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
