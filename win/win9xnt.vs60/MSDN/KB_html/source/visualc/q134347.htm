

<HTML>
<HEAD>
<TITLE>INFO: Troubleshooting Visual C++ Setup Problems Under Windows  9 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134347">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1995/08/06">
<META NAME="Keywords" CONTENT="vc20setup vc40setup kbsetup kbtshoot kbsetup kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  This article shows you how to troubleshoot problems that may arise as you are setting up Visual C++ under Windows 95. The majority of setup troubles are going to have their root in one of three things:   - Hardware incompatibility  - Hardware failu...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAU9,QAA1,QDI2,QAB5,QDL9,QBWO,QBWN,QA5W,QDLP,QDIV,QBWS,QBWQ,QBFY,QASR,QDJ2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Troubleshooting Visual C++ Setup Problems Under Windows  9</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134347</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to troubleshoot problems that may arise as you
are setting up Visual C++ under Windows 95. The majority of setup troubles
are going to have their root in one of three things:

<UL><LI>Hardware incompatibility
<LI>Hardware failure
<LI>Device driver conflict (the most likely)
<P>
</UL>The goal of this article is to help you get Visual C++ installed, build a
sample program, and run the sample from within the IDE (internal
development environment).
<P>
If you run into a problem or receive an error along the way, the cause and
the steps to take are pretty much the same regardless of whether the error
occurs during the installation or after the installation as you try to
build programs.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step-by-Step Troubleshooting</h3>
 

<OL><P><LI>Determine which hardware device or device driver is causing the problem.
   To isolate the culprit, first look in the Device Manager. To find the
   Device Manager, point to the My Computer icon on your desktop, and click
   the right mouse button. Click Properties on the menu, and then select
   the Device Manager Tab. Be sure the View Devices by Type option is
   selected. This displays a tree control of the various hardware devices
   you have. Opening a given device on the tree control (by double-clicking
   it or by selecting it and clicking the the Properties button) shows the
   property sheet for the driver currently managing the device.

<P><LI>Open each device's property sheet. For each driver, check the device
   status message; you should see "Device is functioning properly." If the
   property sheet has a Driver tab, click it, and note the name of the
   driver file. If there is no Driver tab, the device driver is a standard
   driver, which is loaded internally by Windows 95. If you find a device
   driver that is malfunctioning and has a driver file, remove this driver
   and try again. If you find a standard device driver (no Driver tab on
   the property sheet) that is malfunctioning, check with the device's
   manufacturer to be sure there no third-party driver is required. Take
   careful note of whether or not your hard disk or CD-ROM uses third-party
   driver files, and what those file names are.

<P><LI>Start Windows 95 in a safe mode - that is with only those third-party
   drivers that are absolutely required for the computer to run and install
   Visual C++.
<P>
   a. Shut down your computer, and then restart it.
<P>
   b. When the screen says "Starting Windows 95 ..." press the F8 key to
<P><PRE>      display the Windows 95 start-up menu.
</PRE><P>
   c. Select Safe Mode or Safe Mode With Network Support. This will boot
<P><PRE>      Windows 95 into plain VGA mode, with no third-party drivers loaded.
      If you are installing from a local CD-ROM drive to a local hard-disk
      drive, select Plain Safe Mode, even if you are on a network.
</PRE><P>
<P><PRE>       - If your problem is an unsuccessful installation, re-do the
<PRE></PRE>         installation at this point. If this installation is successful,
         there is a good chance you can restart in standard configuration
         and build a sample successfully. If standard configuration builds
         fail, restart in safe mode and see if you can build a program. If
         you can build in safe mode, proceed to step 4 as though your
         original problem was a successful installation, but you cannot
         build programs.

       - If your problem is a successful installation, but you can't build
         programs, try building a sample under safe mode. If you can build
         the sample, then your task in step 4 will be to re-add drivers one
         at a time until you find the one that breaks the build process.
         Once discovered, you can contact the author to see if there are
         updates, or you can disable that driver when doing Visual C++
         builds.

       - If your CD-ROM or hard-disk drive was previously using a third-
         party driver, there is a good chance you will not be able to
         install in safe mode due to an inability to access either your
         CD-ROM or hard-disk drive. If that is the case, proceed to step #4
         for step-by-step clean boot instructions to load only the hard-
         disk driver or CD-ROM driver file and no others.

</PRE><P><LI>Arriving at this step probably means one of two things. You have
   installed and can build in safe mode, but cannot build in your regular
   configuration, or you could not access your hard-disk drive or CD-ROM in
   safe mode. In this step, you will clean boot again, but with step-by-
   step confirmation for each driver being loaded.
<P>
   a. Rename your System.ini file to something else, such as System.org
<P><PRE>      (avoid .bak as a suffix). Second, copy (do not rename) System.cb to
      System.ini. The System.cb file is the "clean" System.ini that safe
      mode uses to boot your computer.
</PRE><P>
<P><PRE>      NOTE: If you find that your mouse is not working when you boot using
      system.cb, adding the following may correct the problem:
</PRE><P>
<PRE>         [boot]
         drivers=mmsystem.dll
         mouse.drv=mouse.drv

         [enh386]
         mouse=*vmouse

   b. Shut down your computer, and then restart it. When the screen says
      "Starting Windows95 ...," press the F8 key for the windows 95
      start-up menu.

   c. Select Step-by-Step Confirmation, then follow these steps:

      1) Answer Y to process the system registry.

      2) Answer Y to create a start-up log file. The log file can be
         helpful in diagnosing problems, such as VxD's that can't load.

      3) Answer Y to process your start-up device drivers (Config.sys). You
         will not be asked this question if Config.sys is not found.

      4) Answer Y or N to each driver as appropriate (answer Y to
         Himem.sys, Emm386.sys, Ifshlp.sys).

      5) Answer Y to process Autoexec.bat, or Y to load the Windows
         graphical user interface. You will be asked the first question if
         Autoexec.bat is not found, and the second question if it is.

      6) Answer Y to load all Windows Drivers. These are the internal
         Windows system drivers and are required.

   If you are at this step (step 4) because of an inability to access your
   CD-ROM or your Hard-disk drive in safe mode, attempt to complete the
   installation if it is not already complete, and build a program. If you
   still cannot build or install, then the conflict is probably with the
   very driver you need to access your hard-disk or CD-ROM drive. Note the
   name of the driver file involved, the date and time of the file, and the
   size in bytes. You may also be able to get a revision number by clicking
   the right button when the file is selected in the Windows Explorer and
   selecting Properties. With this information, contact your hardware
   vendor to see if they have an update or a patch you can acquire.

   A common symptom of CD-ROM or hard-disk drive drivers conflicting or
   failing is files becoming corrupt during what appears to be a successful
   installation of Visual C++. To verify the integrity of the files copied
   from the CD-ROM to the Hard-disk drive, use FC.exe; for information on
   how to do this, please see the following article in the Microsoft
   Knowledge Base:

      ARTICLE-ID: <B><A href="../zmiscellaneous/q94653.htm">Q94653</A></B>
      TITLE     : Using FC.EXE to Verify CD-ROM File System Drivers

   NOTE: For Visual C++ 2.x, there are two files, Msvcshl.dll and
   Spyxx.exe, in the Bin subdirectory that Fc.exe will report as
   different. These two files are modified as part of the installation
   process, and are therefore expected to be different. For Visual C++
   4.0, there are three files that are different: Msdev.exe, Msvccpp.pkg
   and Spyxx.exe. If any other files are found to differ, simply copying
   them from the CD-ROM drive may fix the problem.

   If setup is still failing, the CD-ROM driver is the one that is
   conflicting, and it is impossible to download a new CD-ROM device
   driver, there is a last resort that sometimes works. Boot to a plain MS-
   DOS mode. Copy the entire Msvc20 directory to a temporary directory on
   the computer's hard drive by using XCOPY. Then install from the
   temporary directory. Run "setup.exe /f" from the CD-ROM afterwards to
   set the Help file paths and other paths correctly. Finally, delete the
   temporary directory. Of course this "solution" requires that the
   computer have plenty of extra disk space available.

   If you are at step 4 because you can build in safe mode, but not in
   standard mode, begin adding the drivers you weren't loading, one by one,
   until the process breaks. If all drivers get loaded and the program
   still builds, your video driver may be at fault, or it may be a
   combination of two or more drivers being loaded simultaneously (and
   conflicting with each other) that is causing the problem. Once the
   culprit is found, again note the date and time, size in bytes, and
   possibly the revision number of the driver. Then contact the driver's
   manufacturer for an update or patch.

</PRE></OL><h3>Creating a Hardware Profile</h3>
 
<P>
If you have to manipulate driver files individually, it may be useful to
create a Hardware Profile, with only certain specified drivers loaded (sort
of a custom clean boot). Hardware Profiles may be created and saved as
follows:

<OL><P><LI>Click My Computer using the right mouse button. Click the Hardware
   Profile tab, highlight Original Profile in the list box, and click
   the Copy Button, naming the new profile as you wish. This hardware
   profile is now an exact copy of your original or default
   configuration.

<P><LI>Click the Device Manager tab, and open up the property sheet for each
   device driver. Note the section called Device Usage. Clear the check
   box next to your new profile for each device driver you don't want to
   load when booting under your new profile.
<P>
</OL>If you have more than one profile, Windows 95 will prompt you for which
profile you wish to boot under at start-up.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Windows 95 win95
<P>

Keywords          : vc20setup vc40setup kbsetup kbtshoot kbsetup kbtshoot<BR>
Version           : 2.0 2.1 4.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
