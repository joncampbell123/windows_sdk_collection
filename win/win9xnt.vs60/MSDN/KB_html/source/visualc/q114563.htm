

<HTML>
<HEAD>
<TITLE>Microsoft Setup Toolkit for Visual C++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114563">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1994/05/08">
<META NAME="Keywords" CONTENT="kb16bitonly TlsMisc kbappnote kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="    Microsoft(R) Product Support Services Application Note (Text File)           CP0982: MICROSOFT SETUP TOOLKIT FOR VISUAL C++(TM)  ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QBHQ,QBVV,QAIM,QAFI,QA01,QDNQ,QDL9,QBXB,QBWO,QBWN,QATJ,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Microsoft Setup Toolkit for Visual C++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114563</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbtool kbappnote
<P>
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
          CP0982: MICROSOFT SETUP TOOLKIT FOR VISUAL C++(TM)
</PRE> 
<P>
 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY     |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an Application |
| Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER      |
| EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED      |
| WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR       |
| PURPOSE. The user assumes the entire risk as to the accuracy and    |
| the use of this Application Note. This Application Note may be      |
| copied and distributed subject to the following conditions:  1) All |
| text must be copied without modification and all pages must be      |
| included;  2) If software is included, all files on the disk(s)     |
| must be copied without modification (the MS-DOS(R)  utility         |
| diskcopy is appropriate for this purpose);  3) All components of    |
| this Application Note must be distributed together;  and  4) This   |
| Application Note may not be distributed for profit.                 |
|                                                                     |
| Copyright (C) 1993-1994 Microsoft Corporation. All Rights Reserved. |
| CodeView, Microsoft, MS-DOS are registered trademarks and Visual    |
| C++  and Windows are trademarks of Microsoft Corporation.           |
|---------------------------------------------------------------------|

</PRE>IMPORTANT: If you do not own Visual C++, you do not have the right to
use the Microsoft Setup Toolkit contained on this disk. The programs
on this disk are subject to the same licensing restrictions agreed to
with your Visual C++ product.
<P>
Download CP0982.EXE, a self-extracting file, from the Microsoft
Software Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P>
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/cp0982.exe">CP0982.EXE</A> <I>(size: 820125 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/cp0982.exe">CP0982.EXE</A> <I>(size: 820125 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<PRE>                               CONTENTS
                               ========

</PRE>The CP0982 disk included with this Application Note contains a single
file, TOOLKIT.EXE, which self-extracts to the following files:
<P>
<PRE>   Filename         Description
</PRE> 
<PRE>   SETUPB.EXE       Setup Toolkit files
   SETUPD.EXE       Setup Toolkit documentation
   MSSETUP.HLP      Help file containing most common questions about
                    the Setup Toolkit
   COMPRESS.EXE     File-compression utility


                             INSTALLATION
                             ============

</PRE>To install TOOLKIT.EXE, create a directory for the Setup files, such
as:
<P>
<PRE>   c:\setuptk

</PRE>Copy the TOOLKIT.EXE file to this directory, move into this directory,
and type:
<P>
<PRE>   toolkit.exe

</PRE>This will give you the files listed above. Place COMPRESS.EXE in your
\MSVC\BIN directory, change to the directory that you created for the
Setup files, and unzip the rest of the files with the following
commands:
<P>
<PRE>   setupb.exe -d
   setupd.exe -d

</PRE>NOTE: -d duplicates the directory structure contained in the zip file.
<P>
<P>
<PRE>                              FILES LIST
                              ===========

</PRE><h2>ROOT DIRECTORY</h2>
 
<P>
The following are the files composing the Setup program and samples.
<P>
<P><h3>Setup Executables</h3>
 
<P>
...\SETUP.EXE. Do not compress this file. Setup bootstrapper copies
SETUP.EXE, .DLLS, include files, and _MSTEST.EXE from your floppy disk
drive to a temporary directory on the local hard disk drive for
execution. This prevents code-segment discarding or reloading after
the original floppy disk has been swapped out. The list of files to
copy is contained in the SETUP.LST file (see below). The name of the
temporary directory may also be specified in the SETUP.LST file. This
.EXE should not be compressed--it will be run by the enduser when
installing your program. This file must be on Disk 1.
<P>
...\SETUP.LST. Do not compress this file. The bootstrapper data file
contains a list of Setup files and other information to copy to the
temporary directory. This file and all files listed in SETUP.LST must
be on Disk 1.
<P>
...\_MSTEST.EXE. Limited run-time version of Microsoft Test for
Windows. This is the .EXE that runs the Setup script (the .MST file),
reads data from the .INF file, and makes calls to the MS???STF.DLL
libraries. This file needs to be listed in the SETUP.LST file and must
be on Disk 1.
<P>
...\_MSSETUP.EXE. This is a special MS-DOS-only program that is
executed if Windows is restarted. This is used only if files marked as
SYSTEM files need to be updated at Setup time and they are locked by
Windows, thus preventing this operation from succeeding without
restarting Windows. If you have no files marked SYSTEM in your .INF
file, you do not need to ship this file; otherwise, it must be listed
in the SETUP.LST file and must be on Disk 1.
<P>
<P><h3>Setup DLLs</h3>
 
<P>
These files contain the code for the routines being called in your
Setup script. They are needed by _MSTEST.EXE and must be listed in the
SETUP.LST file and shipped on Disk 1.
<P>
<PRE>Filename            Description
</PRE> 
<PRE>...\MSCOMSTF.DLL    Common Library DLL
...\MSCUISTF.DLL    Custom UI DLL--This should be customized using the
                    SDK's Dialog Editor and the BLDCUI subdirectory.
...\MSDETSTF.DLL    Detection Routines DLL
...\MSINSSTF.DLL    Install Routines DLL
...\MSSHLSTF.DLL    MS-Setup Shell Library DLL
...\MSUILSTF.DLL    UI--Library DLL

</PRE><h3>Associated Include Files</h3>
 
<P>
These files may be included in your SETUP.MST script. If they are,
they must be listed in the SETUP.LST file and shipped on Disk 1.
<P>
<PRE>Filename            Description
</PRE> 
<PRE>...\SETUPAPI.INC    API definitions include file--Contains prototype
                    declarations for most Setup functions (required)
...\MSDETECT.INC    Detection API include file (optional, but very useful)
...\MSREGDB.INC     Microsoft Windows 3.1 Registration Database Include
                    File (optional)
...\MSSHARED.INC    Microsoft Shared Application Include File (optional)

</PRE><h3>Sample Files</h3>
 
<P>
The following files are setup scripts and related .INF files. Only one
set is necessary. These files must be listed in the SETUP.LST file and
shipped on Disk 1.
<P>
<PRE>Filename            Description
</PRE> 
<PRE>...\SAMPLE1.MST     Sample setup script for a simple
                    installation
...\SAMPLE1.INF     INF file for use with SAMPLE1.MST
...\SAMPLE2.MST     Sample setup script with a
                    complicated Options Dialog
...\SAMPLE2.INF     INF file for use with SAMPLE2.MST
...\SAMPLE3.MST     Sample setup script for installing
                    shared application files
...\SAMPLE3.INF     INF file for use with SAMPLE3.MST

</PRE><h3>Help Files</h3>
 
<P>
<PRE>Filename            Description
</PRE> 
<PRE>...\TESTDRVR.HLP    Windows Help file containing descriptions of the
                    Statements and Intrinsic Functions supplied by
                    Microsoft Test for Windows. (Do not ship)
...\README.WRI      File containing extra information about the
                    product and any last-minute change information.
                    (Do not ship)

</PRE><h2>THE BLDCUI SUBDIRECTORY</h2>
 
<P>
The following files are needed to build the MSCUISTF.DLL. Do not ship
these--only ship the resulting DLL built from them.
<P>
<PRE>Filename            Description
</PRE> 
<PRE>...\DIALOGS.DLG     The text file containing the Dialog Templates
                    definitions used in the samples.
...\DIALOGS.H       The Header file containing the Constant
                    declarations used in the Dialogs Template
                    definitions.
...\DIALOGS.RC      The RC file used by the Resource Compiler to
                    create the MSCUISTF.DLL. It includes DIALOGS.DLG
                    and DIALOGS.H.
...\DIALOGS.RES     A version of DIALOGS.RC that has been compiled
                    with the Resource Compiler. This file may be
                    loaded directly into the SDK Dialog Editor.
...\BLDVER.H        Resource include file containing the Version
                    Resource information. It gets included into
                    DIALOGS.RC.
...\DLGPROCS.C      The C-File containing the Dialog Procedure code.
...\CUI.H           C-language header file that contains prototypes
                    for the functions contained in other Microsoft
                    Setup DLLs, used in DLGPROCS.C and described in
                    Chapter 2 of the Microsoft Setup Toolkit manual.
...\SETUP.ICO       The Setup icon file, which can be included in
                    dialog boxes.
...\BITMAP.DIB      The Microsoft Setup logo painted on the background
                    blue screen. You can replace this with a different
                    .DIB file, but it must be white on black.
...\MAKEFILE        A makefile to build the MSCUISTF.DLL using files
                    in this directory. It contains a setting that
                    determines whether a debug or ship version will be
                    built.
...\MSCUISTF.DEF    DEF file for declaring library exports for the
                    dialog procedures defined in DLGPROCS.C
...\CUISTF.LNK      The ship-version link file
...\CUISTFD.LNK     The debug-version link file with CodeView(R)
                    information
...\MSCOMSTF.LIB    Import libraries for APIs in CUI.H
...\MSSHLSTF.LIB    Import libraries for APIs in CUI.H
...\MSUILSTF.LIB    Import libraries for APIs in CUI.H

</PRE>THE DISKLAY SUBDIRECTORY
 
<P>
The following files compose the Disk-Layout utility. Do not ship these
files--they are used to generate one or more disk images and
associated .INF files.
<P>
<PRE>Filename            Description
</PRE> 
<PRE>...\DSKLAYT.EXE     Disk Layout Front-End. This is a Windows and
                    Visual Basic application that allows you to
                    specify restrictions and attributes of the files
                    you will ship with your product.
...\DSKLAYT2.EXE    Disk-Layout Back-End. This is an MS-DOS-based
                    application that uses the information generated by
                    DSKLAYT.EXE and creates compressed versions of your
                    files, with a corresponding disk image of each disk
                    copied to differently named directory.
...\COLORLST.VBX    Visual Basic run-time custom library. Required by
                    DSKLAYT.EXE.
...\VBRUN100.DLL    Visual Basic run-time library. Required by
                    DSKLAYT.EXE.

</PRE><h2>THE INTLDLL SUBDIRECTORY</h2>
 
<P>
Files in the INTLDLL subdirectory are needed to translate the strings
in the DLL resources to localize a product for another country. Do not
ship these files--they are used to generate localized versions of
shipping .DLLs.
<P>
<PRE>Filename            Description
</PRE> 
<PRE>...\MSCOMSTF.DLL    Linked version of the Common Library that has not
                    had its resources compiled in yet.
...\MSCOMSTF.RC     Uncompiled resource file for the Common Library.
...\MSDETSTF.DLL    Linked version of the Detect Library that has not
                    had its resources compiled in yet.
...\MSDETSTF.RC     Uncompiled resource file for the Detect Library.
...\MSINSSTF.DLL    Linked version of the Install Library that has not
                    had its resources compiled in yet.
...\MSINSSTF.RC     Uncompiled resource file for the Install Library.
...\MSSHLSTF.DLL    Linked version of the Shell (Frame) Library that
                    hasn't had its resources compiled in yet.
...\MSSHLSTF.RC     Uncompiled resource file for the Shell (Frame)
                    Library.
...\MSUILSTF.DLL    Linked version of the UI Library which has not had
                    its resources compiled in yet.
...\MSUILSTF.RC     Uncompiled resource file for the UI Library.
...\GAUGE.DLG       Copy Files Progress Indicator dialog template used
                    in MSINSSTF.RC.
...\BLDVER.H        Resource include file containing the Version
                    Resource information. It gets included each
                    resource file. This is the same file as in BLDCUI.
...\GAUGE.H         Include file.
...\IDS.H           Include file.
...\IDS_INST.H      Include file.
...\LOGIDS.H        Include file.

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 setup toolkit<BR>
KBCategory: kbtool kbappnote<BR>
KBSubcategory: TlsMisc<BR>
Keywords            : kb16bitonly TlsMisc kbappnote kbtool<BR>
Version             : 1.00 1.50<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
