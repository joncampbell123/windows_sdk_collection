

<HTML>
<HEAD>
<TITLE>PRB: Wrong Resources Loaded by Resource Editor or AppStudio </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135912">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1995/08/29">
<META NAME="Keywords" CONTENT="AppStudioIss kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Intermittently, The Resource Editor opens the resources, but the latest modifications are not visible in the editor. This may occur with a project that uses a version control system that doesn't update the timestamp on a file when the file is check...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIM,QAB5,QBJZ,QAVI,QABH,QABI,QAL0,QAEF,QBFY,QAY2,QAGU,QAXB,QAU3,QAMR,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Wrong Resources Loaded by Resource Editor or AppStudio</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135912</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Resource Editor (AppStudio) included with:
   - Microsoft Visual C++ for Windows, versions 1.5, 1.51, 1.52
   - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0,
<P><PRE>     4.1, 5.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Intermittently, The Resource Editor opens the resources, but the latest
modifications are not visible in the editor. This may occur with a project
that uses a version control system that doesn't update the timestamp on a
file when the file is checked out. It is not a bug in the Resource Editor.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Resource Editor generates and uses a .APS file. This file contains a
binary format of the resources. The Resource Editor loads the resources
from this file to reduce the time required to load them. The article
mentioned in the "References" section of this article gives more
information about this file.
<P>
The Resource Editor uses dependency checking to determine if the this file
has to be regenerated. In the following scenario, the .APS file is not
regenerated. None of the following steps occur simultaneously.

<OL><P><LI>Person X checks out the resource file from the source control system.

<P><LI>Person X modifies and saves the changes to a local copy of the
   resources. The time on the resource file is now C.

<P><LI>Person Y retrieves a copy of the resource file from the source control
   system.

<P><LI>Person Y opens and closes the local copy of the resources for the first
   time. A local version of the .APS file is generated on Y's machine at
   this point in time. The time on .APS file is now C + delta.

<P><LI>Person X checks in the modified resource file.

<P><LI>Person Y checks out the resources from the source control system and
   opens the resources.
<P>
</OL>Person Y will see the resources without the modifications that were made by
Person X. The .APS file on Y's machine has a later timestamp (time C +
delta) than the resource file (time C), thus the .APS file is not
regenerated, and the old version of the resources is loaded.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Ensure that the resources are loaded from the resource file instead of from
the .APS file whenever the resource file has been updated. One approach is
to use a source control system that updates the timestamp of a file upon
checkout. The source control system may have a timestamp update option that
can be set. If this approach is not possible, delete the .APS file after
checking out the resources from source code control software. In either
case, the Resource Editor will then open the resources from the resource
files and regenerate the .APS file.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To delete the .APS file after checking out the resource, a menu item can be
added to the Tools menu. The following sections give one way to  implement
the menu item.
<P>
<P><h3>Steps to Implement Menu Item</h3>
 
<P>
To implement a menu item to delete the .APS file, follow these steps:

<OL><P><LI>Create the batch file DELAPS.BAT containing the following command:
<P>
   del %1

<P><LI>Add the item to the tools menu via the method described below.
<P>
</OL>Steps to Add New Menu Item to Tools Menu in Visual C++ 2.x
 

<OL><P><LI>On the Tools menu, click Customize to bring up the Customize Property
   Sheet.

<P><LI>Click the Tools Tab.

<P><LI>Click the Add button to add a tool.

<P><LI>Type:
<P>
<P><PRE>      &lt;path&gt;\DELAPS.Bat
</PRE><P>
   where &lt;path&gt; is the location of the batch file.

<P><LI>On the Tools tab of the Customize Property Sheet, fill in the following
   information for the new tool:
<P>
   Menu Text: Delete .APS files
   Arguments: $PROJDIR*.APS

<P><LI>Select the 'Close Window on Exit' check box.
<P>
</OL><h3>Steps to Add New Menu Item to Tools Menu in Visual C++ 1.5x</h3>
 

<OL><P><LI>On the Options menu, click Tools to bring up the Tools dialog box.

<P><LI>Click the Add button to add a tool.

<P><LI>From the Add Tool dialog box, select the DELAPS.BAT file.

<P><LI>Enter the following information in the Tools dialog box:
<P>
   Menu Text: Delete .APS file
   Arguments: $PROJDIR$PROJ.APS
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q132340.htm">Q132340</A></B>
   TITLE     : Common File Extensions Used by Visual C++
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : AppStudioIss kbtshoot<BR>
Version             : 1.5 1.51 1.52 2.0 2.1 2.2 4.0 4.<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
