

<HTML>
<HEAD>
<TITLE>Determine Whether VBX Support Is Enabled at Run Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117777">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/07/07">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The MFC class library provides support for using VBX controls in a 16-bit Windows-based application. You can call CWinApp::EnableVBX to enable use of VBX controls. You can also determine whether VBX support has been enabled in an MFC program as it ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QADK,QABO,QAY5,QAUD,QA7O,QAV1,QAV0,QAPN,QAOE,QAMN,QAGI,QAB5,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Determine Whether VBX Support Is Enabled at Run Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117777</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MFC class library provides support for using VBX controls in a 16-bit
Windows-based application. You can call CWinApp::EnableVBX to enable use of
VBX controls. You can also determine whether VBX support has been enabled
in an MFC program as it is running. This article presents two possible
methods of determining whether VBX support has been enabled in applications
on MFC, versions 2.0 and 2.5.
<P>
NOTE: Both of these methods rely on the use of implementation-specific
details of MFC, versions 2.0 and 2.5. The techniques presented here are not
guaranteed to function correctly in future versions of MFC.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use one of the following methods to determine whether VBX support has been
loaded:

<UL><LI>Check whether the proxy window class associated with VBX controls has
   been registered. You can do this by writing a global function that
   attempts to locate the window class, such as the following:
<P>
<P><PRE>      BOOL IsVBXEnabled()
      {
<PRE></PRE>         WNDCLASS ClsInfo;

         memset(&amp;ClsInfo,0,sizeof(WNDCLASS));
         return ::GetClassInfo(AfxGetInstanceHandle(),"VBControl",
   &amp;ClsInfo);
      }

   -or-

</PRE><LI>Check your class derived from CWinApp to see whether
   m_lpfnCleanupVBXFiles is non-NULL. If this member is non-NULL, VBX
   support has been enabled; otherwise, the member is NULL. For example,
   suppose that CMyApp is the name of your class that is derived from
   CWinApp. The following member function can be added to check for VBX
   support:
<P>
<P><PRE>      BOOL CMyApp::IsVBXEnabled()
      {
<PRE></PRE>         return m_lpfnCleanupVBXFiles != NULL;
      }

   This function can be called in any part of your program by including
   the header file for your CWinApp-derived class and using the following:

         ((CMyApp*)AfxGetApp())-&gt;IsVBXEnabled();
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00 1.50 2.00 2.50 EnableVBX<BR>
KBCategory: kbprg<BR>
KBSubcategory: MfcVBX<BR>
Keywords            : kb16bitonly<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
