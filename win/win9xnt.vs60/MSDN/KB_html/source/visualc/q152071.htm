

<HTML>
<HEAD>
<TITLE>Calling Hidden Default Method of an OLE Automation Collection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152071">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1996/06/03">
<META NAME="Keywords" CONTENT="CodeSam MfcOLE VCx86 kbcode kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  A technical article found on the Microsoft Developer Network CD-ROM titled  Implementing OLE Automation Collections,  describes the functionality necessary to create an OLE automation collection. This includes creating a method called Item that ret...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAGI,QA9Q,QA2K,QABA,QAJH,QABO,QBS0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Calling Hidden Default Method of an OLE Automation Collection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152071</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.20 4.00 4.10
WINDOWS NT
kbprg kbole kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0, 4.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A technical article found on the Microsoft Developer Network CD-ROM titled
"Implementing OLE Automation Collections," describes the functionality
necessary to create an OLE automation collection. This includes creating a
method called Item that returns the dispatch interface of the indicated
item in the collection.
<P>
All OLE automation collection objects must implement the Item method to
iterate through the objects of the collection. The implementation of the
method might have been created hidden in the .ODL file for some
applications. You cannot find these hidden methods by calling
IDispatch::GetIdsOfNames(). However, in many situations, this hidden method
is the default method of the collection, in which case you can invoke it
with an dispatch ID of DISPID_VALUE.
<P>
Visual Basic 3.0 depends on this Item method being the default method of
the collection object.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code sample illustrates using
COleDispatchDriver::InvokeHelper() to call the Item method from the
Resources collection class provided by Microsoft Project 4.1. The Item
method is hidden and cannot be found in the type library of the object:
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   void IterateCollection(void)
   {
      Application App; // wrapper class for the 'Application' object
      Project Proj;    // wrapper class for the 'Project' object
      Resources Res;   // wrapper class for the 'Resources' object
      CString lpszFileName ("c:\\temp\\project2.mpp");

      App.CreateDispatch("MSProject.Application");

      VARIANT vFileName;
      VariantInit(&amp;vFileName);
      V_VT(&amp;vFileName) = VT_BSTR;
      V_BSTR(&amp;vFileName) = lpszFileName.AllocSysString();
      App.FileOpen(vFileName);

      Proj.AttachDispatch(App.GetActiveProject());
      Res.AttachDispatch(Proj.GetResources());

      VARIANT vCount;
      VariantInit(&amp;vCount);
      V_VT(&amp;vCount) = VT_I4;
      vCount = Res.Count();

      // the index of the collection starts with 1, not 0
      for (int i = 1 ; i &lt;= vCount.lVal ; i++)
      {
         Resource r; // wrapper class for the 'Resource' object

         VARIANT vResult, vIndex, vStr;
         VariantInit(&amp;vResult);
         VariantInit(&amp;vIndex);
         V_VT(&amp;vIndex) = VT_I2;
         V_I2(&amp;vIndex) = i;
         static BYTE parms[] = VTS_VARIANT;

         Res.InvokeHelper(DISPID_VALUE, DISPATCH_METHOD, VT_VARIANT,
   (void*)&amp;vResult, parms, &amp;vIndex);
         r.AttachDispatch(vResult.pdispVal);

         vStr = r.GetName();
         // ... 'vStr' now contains the Name property
      }
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 2.20 4.00 4.10<BR>
KBCategory: kbprg kbole kbcode<BR>
KBSubcategory: CodeSam MfcOLE VCx86<BR>
Keywords            : CodeSam MfcOLE VCx86 kbcode kbole kbprg<BR>
Technology          : kbMfc<BR>
Version             : 2.00 2.10 2.20 4.00 4.10<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
