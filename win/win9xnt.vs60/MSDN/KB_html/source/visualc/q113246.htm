

<HTML>
<HEAD>
<TITLE>BUG: AppWizard and Table with Many Columns May Cause Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113246">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/03/29">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  AppWizard issues the following error message when trying to create a database application that uses a database table containing a large number of fields (number of fields varies depending on the field name lengths):     Not enough memory to complet...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAE1,QAZV,QBXS,QBWS,QAUJ,QAG2,QAB4,QA2Q,QDMN,QAYL,QAA1,QAUR,QAK6,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: AppWizard and Table with Many Columns May Cause Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113246</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50
WINDOWS
kbtool kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The AppWizard included with:
   Microsoft Visual C++ for Windows, version 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
AppWizard issues the following error message when trying to create a
database application that uses a database table containing a large number
of fields (number of fields varies depending on the field name lengths):
<P>
<PRE>   Not enough memory to complete operation.

</PRE>AppWizard may also cause the Visual Workbench to hang in this situation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The workaround is to use AppWizard to generate a "database enabled"
application. This is accomplished by using another table within the same
data source as the table with many columns. However, this other table,
henceforth referred to as the "proxy," does not cause AppWizard to fail
when generating the application. After the application has been
successfully generated, ClassWizard is then used to modify the code to use
the table with many columns instead of the proxy. One other change also
requires the modification of a single line of code.
<P>
The following is a step-by-step approach to using this technique:

<OL><P><LI>Identify another table, the proxy, which contains fewer columns in the
    same data source, or create one.

<P><LI>Using AppWizard, create a skeleton application selecting all of the
    originally desired options. When choosing the data source, use the
    proxy table identified in step 1.

<P><LI>Open ClassWizard (CTRL+W) and switch to the "Member Variables" tab.

<P><LI>For the "Class Name," select the CRecordset derived class (it should be
    a name that ends with "Set").

<P><LI>Delete the CRecordset member variables associated with each of the
    column names in the proxy table. Do this for every member variable by
    selecting a "Column Name" and clicking "Delete Variable."

<P><LI>Now click "Update Columns." Choose "Yes" when prompted to save current
    changes.

<P><LI>Select the data source that has been used during this process and
    choose OK.

<P><LI>Select the table with the large number of columns and choose OK.

<P><LI>Click "Bind All" to add variables for all of the columns in the new
    table.

<P><LI>Choose OK to leave ClassWizard.

<P><LI>Edit the implementation file (.CPP) for the CRecordset derived class
    (the filename should be of the form xxxxSET.CPP).

<P><LI>Change the "GetDefaultSQL" for the CRecordset derived class provided by
    AppWizard. Change the code to read
<P>
       return "XXXXX";
<P>
    where XXXXX is the name of the table with many columns.

<P><LI>Save changes by choosing Save from the File menu.
<P>
</OL>At this point the code is identical to what AppWizard would have generated
had it worked successfully using the table with many columns. Code
development may proceed as usual using this code.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the products listed at the
beginning of this article. We are researching this bug and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For information about adding additional CRecordset and CRecordView classes,
see Chapter 9 of the App Studio "User's Guide." Also see the section titled
"Creating a Recordset for the Course Table" in Chapter 4 of "Database
Classes," "Part 1: Database Tutorial."
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 
<P>
The following steps show how the problem can be produced:

<OL><P><LI>Create a database with one table containing a large number (80-120
   depending on the field name lengths) of fields of any type.

<P><LI>Set up an ODBC data source to refer to the new database and table.

<P><LI>Run AppWizard.

<P><LI>After setting up the project name, directory, and other options, select
   "Database Options."

<P><LI>Select either "Database and File Support" or "Database Support, No File
   Support."

<P><LI>Select "Data Sources," and choose your table name from the list.

<P><LI>Choose OK four times to let AppWizard create the classes.
<P>
</OL>At this point, you'll get the error message listed above.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.50 enough memory hang datasource mfc<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: WizardIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
