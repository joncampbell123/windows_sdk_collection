

<HTML>
<HEAD>
<TITLE>PRB: Add Method/Add Property Adds To All Interfaces </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168528">
<META NAME="KBModify" CONTENT="1997/08/07">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="vcbuglist500 WizardIss kbtool">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  In a wizard-generated application that supports Automation, you can use the Add Method or Add Property on the popup menu in the ClassView or in the ClassWizard's Automation tab dialog box to add a method or a property to a dispinterface. The method...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBBS,QABO,QADZ,QAMB,QAGF,QA9N,QA2K,QAHD,QBWS,QA17,QBWC,QACM,QABI,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Add Method/Add Property Adds To All Interfaces</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168528</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a wizard-generated application that supports Automation, you can use the
Add Method or Add Property on the popup menu in the ClassView or in the
ClassWizard's Automation tab dialog box to add a method or a property to a
dispinterface. The method or the property is added to all of the
dispinterfaces in the project's .odl file. This is incorrect. It should
only be added to one interface.
<P>
<P><h2>CAUSE</h2>
 
<P>
When a dispinterface is created by either ClassWizard or the New Class from
the ClassView, the following code skeleton is added to the project's .ODL
file:
<P>
<PRE>  [ uuid(0C4A40A4-9B05-11D0-81EF-00AA00B92AB3) ]
  dispinterface ITesting
  {
    properties:
     // NOTE - ClassWizard will maintain property information here.
     //    Use extreme caution when editing this section.
     //{{AFX_ODL_PROP(CTestingDoc)
     //}}AFX_ODL_PROP

    methods:
     // NOTE - ClassWizard will maintain method information here.
     //    Use extreme caution when editing this section.
     //{{AFX_ODL_METHOD(CTestingDoc)
     //}}AFX_ODL_METHOD
  };

</PRE>The AFX_ODL_PROP() and AFX_ODL_METHOD() in the comments are used by the
ClassWizard to maintain method/property information. They also specify the
object type of the dispinterface. For example, in the sample code above,
the dispinterface ITesting is associated with CTestingDoc object. If you
created a new dispinterface by copying and pasting an existing
dispinterface without making any changes, ClassWizard would be confused if
you tried to add a new method or a new property using either the
ClassWizard or the popup menu's Add Method/Add Property. Hence, the
property or the method is added to both interfaces.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, you can use either one of the following
methods:

<OL><P><LI>Use ClassWizard to add a class as follows:
<P>
   a. Launch the ClassWizard and click the Automation tab.
   b. Click "Add Class..." and choose "New...".
   c. In the New Class dialog box, type a class name and make sure its base
<P><PRE>      class is a CCmdTarget class or its derived classes.
</PRE>   d. In the Automation group, select "Createable by type ID:".
   e. This creates a new class and its disinterface. The interface is
<P><PRE>      appended to the end of the existing .ODL file.
</PRE>
<P><LI>Use the New Class option on the popup menu in the ClassView to add a
   class as follows:
<P>
   a. In the ClassView popup menu, click "New Class".
   b. Follow steps c, d and e above to create a new class and its
<P><PRE>      dispinterface.
</PRE>
<P><LI>Remove the comments you copied over from an existing dispinterface.
   Notice if the ClassWizard-required comments are deleted, you cannot add
   methods or properties to the interface using the ClassWizard or the
   popup menu.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create an AppWizard-generated application with Automation support.

<P><LI>Open project's .odl file and copy the existing dispinterface, including
   the uuid portion.

<P><LI>Paste the dispinterface at the end of the .odl file.

<P><LI>Change the uuid to a new unique number.

<P><LI>Go to the ClassView and right-click the wizard-generated interface. This
   should bring up the popup menu.

<P><LI>Choose Add Method to add a method to the existing interface.

<P><LI>Notice that the method was added to both interfaces.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Wizard all<BR>
Keywords          : vcbuglist500 WizardIss kbtool<BR>
Version           : 5.0<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
