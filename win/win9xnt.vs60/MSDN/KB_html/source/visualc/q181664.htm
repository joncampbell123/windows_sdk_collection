

<HTML>
<HEAD>
<TITLE>PRB: Rich Edit Control Message Handlers Are Not Called </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181664">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1998/02/24">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  There is a problem with the message-map entries that ClassWizard creates to handle the following Rich Edit control messages: EN_SETFOCUS, EN_KILLFOCUS. The message-map entry created by ClassWizard does not call the handler for these messages.  CAUS...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QAHP,QAYC,QBVV,QAY5,QAGI,QBWS,QA7O,QAOE,QAMN,QAB5,QA01,QAB9,QA6A,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Rich Edit Control Message Handlers Are Not Called</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181664</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
There is a problem with the message-map entries that ClassWizard creates to
handle the following Rich Edit control messages: EN_SETFOCUS, EN_KILLFOCUS.
The message-map entry created by ClassWizard does not call the handler for
these messages.
<P>
<P><h2>CAUSE</h2>
 
<P>
The wrong message map entries are added.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Replace the message-map entries generated for EN_SETFOCUS and EN_KILLFOCUS
with the following entries:
<P>
<PRE>   ON_EN_SETFOCUS(IDC_RICHEDIT1, OnSetfocusRichedit1)

   ON_EN_KILLFOCUS(IDC_RICHEDIT1, OnKillfocusRichedit1)

</PRE>Note: You need to alter IDC_RICHEDIT1 to match the ID of your control.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Use the MFC AppWizard to create a dialog-based application.

<P><LI>Drag a RichEdit control from the Controls palette onto the Dialog
   template using the Dialog Resource Editor.

<P><LI>Open ClassWizard, and choose IDC_RICHEDIT1 for the ObjectID. To add
   message handlers for the EN_SETFOCUS and the EN_KILLFOCUS messages,
   highlight the message and click Add Function.

<P><LI>Click OK, and look at the code. The following entry appears in
   the message-map if you selected EN_SETFOCUS:
<P>
<P><PRE>      ON_NOTIFY(EN_SETFOCUS, IDC_RICHEDIT1, OnSetfocusRichedit1)
</PRE><P>
   However, this message-map entry should be:
<P>
<P><PRE>      ON_EN_SETFOCUS(IDC_RICHEDIT1, OnSetfocusRichedit1)
</PRE><P>
   The following entry is also in the message-map if you selected
   EN_KILLFOCUS:
<P>
<P><PRE>      ON_NOTIFY(EN_KILLFOCUS, IDC_RICHEDIT1, OnKillfocusRichedit1)
</PRE><P>
   However, this message-map entry should be:
<P>
<P><PRE>      ON_EN_KILLFOCUS(IDC_RICHEDIT1, OnKillfocusRichedit1)
</PRE>
<P><LI>If you build and run this project to see the problematic behavior,
   remember to add the line AfxInitRichEdit(); in the InitInstance()
   function of the CWinApp derived class.

<P><LI>You can use the default handler created by ClassWizard and add a TRACE
   statement. Following is an example for the EN_KILLFOCUS message:
<P>
<P><PRE>      void CMyDialog::OnSetfocusRichedit1(NMHDR* pNMHDR, LRESULT* pResult)
      {
<PRE></PRE>         TRACE("This function will never be called\n");
         *pResult = 0;
      }

</PRE><P><LI>The TRACE statement does not execute when you run a Debug build.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q166132.htm">Q166132</A></B>
   TITLE     : PRB: Dialog With RichEdit May Fail During Creation

   ARTICLE-ID: <B><A href="../visualc/q165744.htm">Q165744</A></B>
   TITLE     : BUG: RichEditCtrl IDs Not Shown in Member Variables Tab
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: CRichEditCtrl EN_SETFOCUS EN_KILLFOCUS RichEdit<BR>
Class Wizard<BR>
Version           : WINNT:5.0;win95:5.0<BR>
Platform          : Win95 winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
