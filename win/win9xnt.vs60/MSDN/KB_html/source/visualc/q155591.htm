

<HTML>
<HEAD>
<TITLE>BUG: Cannot Set Access Memo Field to NULL with Snapshots </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155591">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1996/09/03">
<META NAME="Keywords" CONTENT="MfcDatabase kbbuglist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When using a Snapshot recordset with the CRecordset class, if you delete the contents of a CString mapped to a memo field in a Microsoft Access database, nothing is actually deleted in the database. In other words, the data that previously existed ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA7O,QA7N,QAH4,QAZV,QDN9,QBFY,QA9E,QAI4,QAYY,QBHQ,QA6A,QAO2,QALZ,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Cannot Set Access Memo Field to NULL with Snapshots</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155591</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 1.51 1.52c
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++ for Windows, versions 1.5, 1.51, and 1.52c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using a Snapshot recordset with the CRecordset class, if you delete
the contents of a CString mapped to a memo field in a Microsoft Access
database, nothing is actually deleted in the database. In other words, the
data that previously existed in the field remains in that field.
However, the recordset still shows that the field has been changed to
null but it has only been changed in the cache of the cursor library,
not the database.
<P>
<P><h2>CAUSE</h2>
 
<P>
A problem exists in the ODBC cursor library which is used by default
in MFC.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This problem was resolved with the ODBC Cursor Library that ships with
Visual C++ 4.0 for 32-bit ODBC components and remains unresolved for 16-bit
ODBC components.
<P>
If possible, use dynasets in your application. For additional information
on using dynasets with the 16-bit MFC database classes, please see the
following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q124915.htm">Q124915</A></B>
   TITLE:      SAMPLE: Using Dynasets with the 16-Bit MFC Database Classes

</PRE>If you cannot use dynasets, then you need to replace "empty" memo fields
with a single space. The code below shows how to use this solution with a
CRecordView derived class.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this bug
and will post new information here in the Microsoft Knowledge Base as
it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<P>
The code below is from a CRecordView derived class using a recordset for an
Access data source, which has a memo field that maps to m_Memo.
<P>
<PRE>    void CMyView::DoDataExchange(CDataExchange* pDX)
    {
        CRecordView::DoDataExchange(pDX);

        // Data Members --&gt; Dialog
        if (pDX-&gt;m_bSaveAndValidate == 0)
        {
            if( m_pSet-&gt;m_Memo.GetLength() == 0 )
            {
                m_pSet-&gt;m_Memo = " ";
            }
        }

        //{{AFX_DATA_MAP(CMyView)
        ...
        //}}AFX_DATA_MAP

        // Dialog --&gt; Data Members
        if (pDX-&gt;m_bSaveAndValidate != 0)
        {
            if( m_pSet-&gt;m_Memo.GetLength() == 0 )
            {
               m_pSet-&gt;m_Memo = " ";
            }
        }
    }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: MfcDatabase<BR>
Additional reference words: 1.50 1.51 1.52 kbdsd<BR>
Keywords          : MfcDatabase kbbuglist kbprg<BR>
Technology        : kbMfc<BR>
Version           : 1.50 1.51 1.52c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
