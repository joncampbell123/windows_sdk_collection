

<HTML>
<HEAD>
<TITLE>BUG: Visual Workbench Makefile Does Not Produce Map File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113424">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/04/04">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  A makefile generated by Visual Workbench fails to produce a map file when executed from the command line or as an external makefile. The map file is not generated even though the Create Map File option is set in the Linker Options and a map file is...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA55,QBXT,QA56,QBXS,QBVV,QAYL,QA5V,QAIB,QAJ1,QBV8,QAKP,QAJN,QBFY,QAL2,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Visual Workbench Makefile Does Not Produce Map File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113424</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50
MS-DOS
kbtool kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual Workbench for Windows, versions 1.0 and 1.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A makefile generated by Visual Workbench fails to produce a map file when
executed from the command line or as an external makefile. The map file is
not generated even though the Create Map File option is set in the Linker
Options and a map file is created when the project is built as a Visual
Workbench internal makefile.
<P>
<P><h2>CAUSE</h2>
 
<P>
The makefile created by the Visual Workbench contains the following line:
<P>
<PRE>   MAPFILE = nul

</PRE>Even though the makefile uses the /MAP option on the link line, the nul
MAPFILE field causes the map file not to be created.
<P>
The problem can be demonstrated by viewing the link step for the Microsoft
Foundation Classes (MFC) Hello sample. Notice that the /MAP option is
passed to the linker but the List File default filename, HELLO.MAP, is
overridden with nul.
<P>
link /NOLOGO /NOD /PACKC:61440 /STACK:10240 /ALIGN:16 /ONERROR:
NOEXE /MAP @HELLO.CRF
<P>
Object Modules [.obj]: /NOLOGO /NOD /PACKC:61440 /STACK:10240
<PRE>                       /ALIGN:16 /ONERROR:NOEXE /MAP STDAFX.OBJ +
</PRE>Object Modules [.obj]: HELLO.OBJ +
Object Modules [.obj]:
Run File [STDAFX.exe]: HELLO.EXE
List File [c:HELLO.map]: nul
Libraries [.lib]: C:\MSVC\LIB\+
Libraries [.lib]: C:\MSVC\MFC\LIB\+
Libraries [.lib]: mafxcw oldnames libw mlibcew commdlg.lib shell.lib
Definitions File [nul.def]: HELLO.DEF;
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The problem can be corrected by changing the MAPFILE line in the makefile
to:
<P>
<PRE>   MAPFILE =

</PRE>This will force the linker to create a .MAP file with the same name as the
project. You can also specify another name for the map file:
<P>
<PRE>   MAPFILE = MYFILE.MAP

</PRE>The makefile can be opened and manually changed as long as the project is
not open in the Visual Workbench. The line remains changed until the
project or project options are modified, at which time the nul is
introduced back into the makefile. At that point, you must make the
correction again before running the makefile from the command line or as an
external makefile if a map file is desired. Permanently converting the
makefile to an external makefile prevents the makefile from being set back
to nul, but requires that the makefile be maintained manually.
<P>
Another option is to set the MAPFILE environment variable and use the /E
switch (which specifies using the environment variable instead of the macro
definition) when building the project, as in the following:
<P>
<PRE>   SET MAPFILE = HELLO.MAP
   NMAKE /E /fHELLO.MAK

</PRE>If you use the following format then you can set the MAPFILE environment
variable just once for all projects (that is, it could be set in your
AUTOEXEC.BAT file):
<P>
<PRE>   SET MAPFILE=$*.MAP

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
problem and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
This is not a problem in Visual C++ 32-bit Edition.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 file name make<BR>
KBCategory: kbtool kbbuglist<BR>
KBSubcategory: VWBIss<BR>
Keywords            : kb16bitonly<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
