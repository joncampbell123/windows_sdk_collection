

<HTML>
<HEAD>
<TITLE>BUG: PG Chart Displays May Have Uneven Spacing Between Bars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q66779 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1990/11/08">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  If a large number of bars or pie slices are displayed in a Presentation Graphics chart, the spacing between the bars or pie slices may be inconsistent. In most situations, any variation between the sizes of bar separations is minimal and generally ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYV,QBFY,QA4C,QA6T,QA4W,QA4V,QAK2,QDNX,QAI4,QAKD,QAKP,QBSO,QAQG,QALZ,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: PG Chart Displays May Have Uneven Spacing Between Bars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q66779 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a 6.00ax 7.00 | 1.00
<PRE>MS-DOS                 | WINDOWS
</PRE>kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT), included with:
<P>
<P><PRE>    - Microsoft C for MS-DOS, versions 6.0, 6.0a, and 6.0ax
    - Microsoft C/C++ for MS-DOS, version 7.0
    - Microsoft Visual C++ for Windows, version 1.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a large number of bars or pie slices are displayed in a Presentation
Graphics chart, the spacing between the bars or pie slices may be
inconsistent. In most situations, any variation between the sizes of bar
separations is minimal and generally unnoticeable. The sample program below
demonstrates this problem on a bar, column, and pie chart.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in C versions 6.0,
6.0a, 6.0ax, 7.0, and Visual C++ version 1.0. We are researching this
problem and will post new information here as it becomes available.
<P>
In general, this problem really has to do with the resolution of
the video system. As the bars or pie wedges get closer together
the differences of width become more apparent. Since the widths
are based on an average, eventually a difference of one or two
pixels becomes noticable.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>#include &lt;conio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;graph.h&gt;
#include &lt;string.h&gt;
#include &lt;pgchart.h&gt;

#define COUNTRIES 25

</PRE>float _far value[COUNTRIES] = { 18.9F,  7.7F, 42.5F, 14.3F, 35.2F,
<PRE>                                21.3F, 42.5F, 14.3F, 35.2F, 21.3F,
                                42.5F, 14.3F, 35.2F, 21.3F, 32.6F,
                                42.5F, 14.3F, 35.2F, 21.3F, 32.6F,
                                42.5F, 14.3F, 35.2F, 21.3F, 32.6F };
char _far *category[COUNTRIES] = { "AB","YZ","UR","GD","USA","UK",
                                   "UR","GD","USA","UK","UR","GD",
                                   "USA","UK","Other","UR","GD",
                                   "USA","UK","Other","UR","GD",
                                   "USA","UK","Other" };
</PRE>short _far explode[COUNTRIES] = { 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
<PRE>                                  1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1,
                                  1, 1, 1 };

void main(void)
</PRE>{
<PRE>   chartenv env;

   if( !_setvideomode( _MAXRESMODE ) )
           exit( 1 );

   _pg_initchart();              // Initialize chart system

   // Single-series bar chart

   _pg_defaultchart( &amp;env, _PG_BARCHART, _PG_PLAINBARS );
   strcpy( env.maintitle.title, "Widget Production" );
   _pg_chart( &amp;env, category, value, COUNTRIES );
   getch();
   _clearscreen( _GCLEARSCREEN );

   // Single-series column chart

   _pg_defaultchart( &amp;env, _PG_COLUMNCHART, _PG_PLAINBARS );
   strcpy( env.maintitle.title, "Widget Production" );
   _pg_chart( &amp;env, category, value, COUNTRIES );
   getch();
   _clearscreen( _GCLEARSCREEN );

   // Pie chart

   _pg_defaultchart( &amp;env, _PG_PIECHART, _PG_PERCENT );
   strcpy( env.maintitle.title, "Widget Production" );
   _pg_chartpie( &amp;env, category, value, explode, COUNTRIES );
   getch();

   _setvideomode( _DEFAULTMODE );
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 6.00 6.00a 6.00ax 7.00 1.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: CRTIss GraphicsIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
