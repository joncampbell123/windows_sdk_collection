

<HTML>
<HEAD>
<TITLE>BUG: DBGrid Does Not Insert Record if Field Name Contains Dash </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165432">
<META NAME="KBModify" CONTENT="1997/05/21">
<META NAME="KBCreate" CONTENT="1997/03/19">
<META NAME="Keywords" CONTENT="kbprg MfcDAO MfcDatabase vcbuglist500 kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you try to add a row to an SQL Server table using DBGrid bound to a Remote Data Control, you receive the following error message if one of the table's field names contains a  - :     ODBC error:  37000 [Microsoft][SQL Server Driver]Line2: Inco...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACI,QABM,QA9N,QA5V,QA7O,QAB4,QAUJ,QBL4,QAPN,QA7N,QDOQ,QAAP,QBE7,QBE6,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: DBGrid Does Not Insert Record if Field Name Contains Dash</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165432</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to add a row to an SQL Server table using DBGrid bound to a
Remote Data Control, you receive the following error message if one of the
table's field names contains a "-":
<P>
<PRE>   ODBC error:  37000 [Microsoft][SQL Server Driver]Line2: Incorrect syntax
   near '-'

</PRE><h2>CAUSE</h2>
 
<P>
This is occurs because the Remote Data Objects code is creating a SQL
INSERT statement that doesn't put quotes around field names. The INSERT
statement would look like:
<P>
<PRE>   INSERT INTO x (id, e-mail)
   VALUES (1, 'Eric')

</PRE>If RDO generated an INSERT statement that used double quotes around the
field name, then the INSERT would work. The following syntax would work:
<P>
<PRE>   INSERT INTO x (id, "e-mail")
   VALUES (1, 'Eric')

</PRE><h2>RESOLUTION</h2>
 
<P>
Either rename the field so that it doesn't contain a hyphen or do the
updates manually (where the developer creates the proper SQL syntax).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In an SQL Server database, create a table with a field that has a dash
   in it. For example, use the following script with MSQuery:
<P>
<P><PRE>      CREATE TABLE x
      (id INTEGER,
      "e-mail" VARCHAR(10))
      // Note the double quotes to avoid the error with the dash.
</PRE>
<P><LI>Create a Data Source that points to the correct database.

<P><LI>Make an MFC Dialog application.

<P><LI>Add the Microsoft Remote Data Control (MSRDC) to the dialog box that is
   being created. Set the following properties of the MSRDC control:
<P>
<PRE>   DataSourceName    to your data source
   CursorDriver      1-ODBC cursor
   LockType          3-Optimistic concurrency
   ResultType        1-Create a Keyset cursor
   SQL               SELECT * FROM x

</PRE><P><LI>Add a DBGrid to the dialog box and set the following properties:
<P>
<PRE>   AllowAddNew       True
   AllowUpdates      True
   DataSource        the name of the MSRDC

</PRE><P><LI>Build and run the application. While running the application, try to
   insert a record in the grid, that is (1, Eric). Move off the record and
   the error message occurs.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: RDO DBGrid<BR>
Keywords            : kbprg MfcDAO MfcDatabase vcbuglist500 kbbuglist<BR>
Version             : 5.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
