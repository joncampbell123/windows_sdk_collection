

<HTML>
<HEAD>
<TITLE>HOWTO: Create a DAO Setup that Installs Jet IISAM Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151426">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1996/05/23">
<META NAME="Keywords" CONTENT="MfcDAO MfcDatabase kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The DAO setup included on the Visual C++ 4.0 or 4.1 CD-ROM in the \MSDEV\REDIST\DAO directory does not install the Microsoft Jet IISAM files that are used by DAO for accessing databases such as Microsoft Excel and dBase. However, you can modify the...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QBFY,QA56,QA55,QAY2,QAGU,QDLP,QBXT,QA5V,QAMB,QAIB,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Create a DAO Setup that Installs Jet IISAM Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151426</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   - Microsoft Visual C++, 32-bit Edition, versions 4.0, 4.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The DAO setup included on the Visual C++ 4.0 or 4.1 CD-ROM in the
\MSDEV\REDIST\DAO directory does not install the Microsoft Jet IISAM files
that are used by DAO for accessing databases such as Microsoft Excel and
dBase. However, you can modify the DAOMIN.RUL InstallShield file included
in the DAO SDK to create a new SETUP.INS file for the DAO Setup. By using
the new .INS file with the existing DAO Setup, you can create a new DAO
Setup that installs all of the IISAM files.
<P>
Because a modification is needed to an InstallShield .RUL file, you need to
install InstallShield from the Visual C++ 4.0 or 4.1 CD-ROM.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Once you have the DAO SDK and InstallShield installed on your development
machine, follow the steps below to have your setup program install IISAMs
in a silent fashion without prompting the user:

<OL><P><LI>Open the DAOMIN.RUL file located in the Daosdk\Setup directory using
   Notepad. Scroll to line 138, and see the following:
<P>
<P><PRE>      SAMPLE CODE -- from DAOMIN.RUL line 138, BEFORE editing
      ///////////////////////////////////////////////////////////////////
      bIncludeISAMS = FALSE;
</PRE><P>
<P><PRE>      if (bIncludeISAMS) then
<PRE></PRE>        //Ask the user which ISAM drivers to install
        fnDetermineUserSelectionDAO();
      endif;

      END OF SAMPLE CODE
      ///////////////////////////////////////////////////////////////////

</PRE><P><LI>Comment out the bIncludeISAMS = FALSE and comment out the call to
   fnDetermineUserSelectionDAO() as follows:
<P>
<P><PRE>      SAMPLE CODE -- from DAOMIN.RUL line 138, AFTER editing
      ///////////////////////////////////////////////////////////////////
      //bIncludeISAMS = FALSE;
</PRE><P>
<P><PRE>      //if (bIncludeISAMS) then
<PRE></PRE>        //Ask the user which ISAM drivers to install
      //  fnDetermineUserSelectionDAO();
      //endif;

      END OF SAMPLE CODE
      ///////////////////////////////////////////////////////////////////

</PRE><P><LI>Save the file, and run the InstallSheild Command Line utility
   COMPILE.EXE, targeting the freshly edited DAOMIN.RUL file:
<P>
<P><PRE>      [PATH]COMPILE [PATH]DAOMIN.RUL
</PRE>
<P><LI>When the COMPILE.EXE utility completes its task, an intermediate file
   called DAOMIN.INS is created. Rename this file to SETUP.INS and replace
   the SETUP.INS located in the REDIST\DAO directory with the newly-created
   version.

<P><LI>Open the SETUP.BAT file using Notepad. Change SETUP NOSDK to:
<P>
<P><PRE>      SETUP -S NOSDK
</PRE>
<P><LI>Run SETUP.BAT. SETUP.EXE uses the new SETUP.INS and installs IISAMs in a
   silent fashion without prompting the user.
<P>
</OL><h3>For Visual C++ 4.2 Users</h3>
 
<P>
Visual C++ 4.2 includes the new InstallShield Express, and no longer
installs the InstallShield SDK directly. Instead, you will need to install
the InstallShield SDK from either Visual C++ 4.0 or 4.1 CD-ROM. Then follow
the instructions in \ISHIELD\SDK\README.TXT to update the SDK with the
latest files.
<P>
COMPILE.EXE, used to re-compile the DAOMIN.RUL file, is not shipped on the
Visual C++ 4.2 CD-ROM and can only be installed from the InstallShield SDK
found on either Visual C++ 4.0 or Visual C++  4.1.
 
<PRE>Keywords          : MfcDAO MfcDatabase kbsetup
Technology        : kbMfc
Version           : 4.00 4.10
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
