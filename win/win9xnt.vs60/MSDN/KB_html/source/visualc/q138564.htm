

<HTML>
<HEAD>
<TITLE>PRB: Windows 95 Common Controls Not Supported by Ctl3d32.dll </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138564">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Windows 95 common controls can be used under Win32s version 1.3 and Windows NT version 3.51. However, these controls will not appear in 3D if 3D controls are enabled under Windows NT version 3.51 and Win32s version 1.3. These controls will show...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOE,QA7O,QAB5,QAMN,QBWP,QDL9,QBWQ,QBWO,QBWN,QAH6,QAGI,QAHV,QAH7,QAD7,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Windows 95 Common Controls Not Supported by Ctl3d32.dll</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138564</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.30 2.20 4.00 | 2.20 4.00
<PRE>WINDOWS        | WINDOWS NT
</PRE>kbprg kbui kbcode kbprb
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, versions 2.2 and 4.0
<LI>Win32s version 1.30
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Windows 95 common controls can be used under Win32s version 1.3 and
Windows NT version 3.51. However, these controls will not appear in 3D if
3D controls are enabled under Windows NT version 3.51 and Win32s version
1.3. These controls will show up in 3D if 3D controls are enabled under
Windows 95 only.
<P>
<P><h2>CAUSE</h2>
 
<P>
The 3D look of standard controls under Windows NT 3.51 and Win32s version
1.3 is provided by Ctl3d32.dll. Ctl3d32.dll does not support 3D effects for
any of the Windows 95 common controls. These controls show up as 3D under
Windows 95 because the drawing for these controls is handled by User32.dll
under Windows 95.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To give Windows 95 common controls a 3D look under Windows NT 3.51 and
Win32s version 1.3 in an MFC application, perform these steps:

<OL><P><LI>In your override of CWinApp::InitInstance, call Enable3dControls().
   This will initialize the Ctl3d32.dll file.

<P><LI>For each control you want to have the 3D effect, call the CWnd member
   function SubclassCtl3d, and pass a parameter of 1 for the nControlType
   parameter (the only parameter this function takes). Call this function
   before the control is displayed -- for a CDialog object this would be in
   the OnInitDialog function; for a CFormView, this would be in the
   OnInitialUpdate; and for any other window, this should be done right
   after the control is created.
<P>
</OL>To perform step 2, you need to have a member variable that is associated
with the control, or you need to get a CWnd pointer (*) that is associated
with the control. The Sample code at the end of this article shows both
techniques.
<P>
NOTE: If you plan to use this approach, you need to have the proper version
of Ctl3d32.dll on your system. This DLL should reside in the &lt;Windows NT
Dir&gt;\System32 directory for 32-bit systems or in the &lt;Windows Dir&gt;\System
directory for 16-bit systems using Win32s. The version of the DLL you must
use is 2.29.00 or later.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Calling Enable3dControls in your override of CWinApp::InitInstance will
load and initialize Ctl3d32.dll. If you call the CWnd member function
Subclass3dCtl and pass a parameter of 1 for the following controls, they
will appear with a 3D looking border around them in your application:
<P>
<PRE>   Progress Control
   TreeView Control
   ListView Control
   Slider Control
   Tab Control
   Animate Control
   Spin Control

</PRE></OL>Calling Subclass3dCtl will call the Ctl3d32.dll function Ctl3dSubclassCtlEx
and pass it the HWND of your control and the value of 1 for the ControlID.
The valid control IDs that can be used with Ctl3d32.dll are listed in the
header file Ctl3d.h under the heading:
<P>
<PRE>   /* Ctl3d Control ID*/

</PRE>The value 1 corresponds to a list box control, so actually what you are
telling Ctl3d32.dll is that you are subclassing a list box control. Because
the DLL only handles the painting of the border of the control, this method
should work with the previously listed controls.
<P>
Please note that this is a workaround to the problem that Ctl3d32.dll does
not support Winodws 95 common controls, it is not a limitation of the
Win32s or the Windows NT 3.51 operating systems because they are not
inherently 3D. (Any 3D support found in these operating systems is provided
by another support such as Ctl3d32.dll.) Ctl3d32.dll is designed to give a
3D look only to the controls listed in the /* Ctl3d Control ID*/ section of
Ctl3d.h. If you choose to use this workaround, you should test your
programs thoroughly. Furthermore, there is no guarantee that Ctl3d32.dll
would support this capability in future releases.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>// This code shows how to give Windows 95 common controls a 3D look
// in an MFC application.

// Initialize Ctl3d32.dll as shown below. A default
// AppWizard-generated application will already have this code:

</PRE>CMyApp::InitInstance()
{
<PRE>  Enable3dControls();
  ...
</PRE>}
<P>
<PRE>// If you have a member variable associated with the control,
// use code similar to the following in your OnInitDialog or your
// OnInitialUpdate function.

   m_Progress.SubclassCtl3d(1);

// If you do not have a variable associated with the control,
// then you can use GetDlgItem to obtain one, for example:

   GetDlgItem(IDC_PROGRESS1)-&gt;SubclassCtl3d(1);

</PRE><h2>REFERENCES</h2>
 
<P>
For more information, please see the article "Adding 3-D Effects to
Controls" by Wes Cherry and Kyle Marsh. This article can be found on the
MSDN July 1995 compact disc in the following place:
<P>
<PRE>   Technical Articles
      Windows Articles
         User Interface Articles
            Windows(16-bit)Only

</PRE>This article discusses the implementation of earlier versions of
Ctl3d32.dll.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.20 3.2 3.20 4.00<BR>
KBCategory: kbprg kbui kbcode kbprb<BR>
KBSubcategory: MfcUI<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
