

<HTML>
<HEAD>
<TITLE>PATCH: Visual C++ sin(), cos(), and tan() Incorrect w/ 287 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126882">
<META NAME="KBModify" CONTENT="1997/05/23">
<META NAME="KBCreate" CONTENT="1995/03/06">
<META NAME="Keywords" CONTENT="CRTIss kbfile kbhw kbprg kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Calls to the sin(), cos(), or tan() in a program built with the Visual C++ versions listed at the beginning of this article return incorrect results.  CAUSE =====  This is caused by a bug in the Visual C++ run-time (CRT) functions. The functions ha...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QAR4,QBFY,QAAP,QA56,QA55,QAKP,QA6A,QAY5,QAUD,QAL3,QAH4,QAJ4,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PATCH: Visual C++ sin(), cos(), and tan() Incorrect w/ 287</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126882</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT) included with:
   - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
</UL> 
<P>
SYMPTOMS
 
<P>
Calls to the sin(), cos(), or tan() in a program built with the Visual C++
versions listed at the beginning of this article return incorrect results.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is caused by a bug in the Visual C++ run-time (CRT) functions. The
functions have a problem with 287 synchronization on 80286 systems with
80287 coprocessors. The timing problem does not affect programs running on
an 80386 with an 80387 coprocessor, on an 80486, or on a Pentium processor.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can get a patch (VC287P.EXE) to fix a bug that occurs with the sin(),
cos(), and tan() run-time functions. These functions return incorrect
values when a program built with Visual C++ is run on a computer that has
both an 80286 processor and an 80287 math coprocessor.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/vc287p.exe">Vc287p.exe</A> <I>(size: 19930 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. This problem was corrected in
the patch announced in this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Please note that this patch is a partially tested fix for this problem. No
problems have been detected with it, however it has not gone through a full
product test cycle. Microsoft makes no guarantees for its useability or
functionality. See the LEGAL.TXT included with the patch for more details.
<P>
The patch also contains a README.TXT with installation details and the
information in this article.
<P>
<P><h3>Sample Code to Reproduce Problem</h3>
 
<P>
<PRE>   /* Compile options needed: None
   */
   #include &lt;math.h&gt;
   #include &lt;stdio.h&gt;
   #include &lt;stdlib.h&gt;

   void main(void)
   {
      double x;

      x=1.0;
      printf( "cos(x) = %lf, sin(x) = %lf, tan(x) = %lf, x = %lf\n",
              cos(x), sin(x), tan(x), x );
   }

</PRE><h3>Results</h3>
 
<P>
The following correct output was produced on a 286/287 with NO87=1:
<P>
<PRE>   cos(x) = 0.540302, sin(x) = 0.841471, tan(x) = 1.557408, x = 1.000000

</PRE>The following incorrect output was produced on a 286/287 with NO87 not set:
<P>
<PRE>   cos(x) = 1.000000, sin(x) = 2.000000, tan(x) = 0.000000, x = 1.000000

 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : CRTIss kbfile kbhw kbprg kbbuglist kbfixlist<BR>
Version             : 1.00 1.50 1.51 1.52<BR>
Platform            : WINDOWS<BR>
Resolution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
