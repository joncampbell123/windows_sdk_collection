

<HTML>
<HEAD>
<TITLE>DOC: How to Display Tool Tips After Calling EnableToolTips </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140595">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1995/12/04">
<META NAME="Keywords" CONTENT="MfcMisc MfcUI vcbuglist400 kbcode kbprg kbui">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The Microsoft Foundation Classes (MFC) 4.x documentation states that you can call the CWnd::EnableToolTips function to enable tool tips for the child controls of a window. For example, this function can be used to display tool tips for all the cont...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAB4,QAO3,QANE,QA7O,QAMN,QAOE,QATX,QAGI,QAMB,QAH6,QANS,QAEV,QBTL,QAF0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: How to Display Tool Tips After Calling EnableToolTips</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140595</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.0, 4.1, 4.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Foundation Classes (MFC) 4.x documentation states that you
can call the CWnd::EnableToolTips function to enable tool tips for the
child controls of a window. For example, this function can be used to
display tool tips for all the controls on a Form View.
<P>
However, simply calling this function is not sufficient. In an application
built with MFC 4.x, tool tips for your child controls will not display
correctly unless you provide a handler for the TTN_NEEDTEXT tool tip
notification.
<P>
This documentation error has been fixed in Visual C++ version 5.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The default tool tips provided for your windows by EnableToolTips do not
have text associated with them. In order to retrieve text for the tool tip
to display, the TTN_NEEDTEXT notification is sent to the tool tip control's
parent window just before the tool tip window is displayed. If there is no
handler for this message to assign some value to the pszText member of the
TOOLTIPTEXT structure, there will be no text displayed for the tool tip.
<P>
Tool tips are displayed for tool bar buttons without any extra effort. This
is because the parent of the tool bar is derived from CFrameWnd, which has
a default handler for the TTN_NEEDTEXT notification. This handler is
designed for handling TTN_NEEDTEXT notifications from tool tip controls
associated with tool bar buttons.
<P>
This handler is not called when the notification is sent from a tool tip
control associated with a child control in a window that is not a CFrameWnd
such as a control on a dialog box or a form view. Therefore, it is
necessary for the user to provide a handler function for the TTN_NEEDTEXT
notification message in order to display tool tips for child controls.
<P>
<P><h3>Steps to Enable Tool Tips for Child Controls</h3>
 
<P>
To enable tool tips for the child controls of a window (such as the
controls on a form view), follow these steps:

<OL><P><LI>Call EnableToolTips() for the window for which you want to provide
   tool tips.

<P><LI>Provide a separate string resource for each control that has the same ID
   as the control. These separate string resources will contain the text
   for each control's tool tip. Note that when adding tool tip text for
   tool bar buttons, the string resource is of this form:
<P>
<P><PRE>      "Status bar text\nTool Tip Text"
</PRE><P>
   The tool tip text is separated from the status bar text by \n. If you
   want to duplicate this functionality in your form views, you should
   implement the code used in CFrameWnd::OnToolTipText (MFC source:
   Winfrm.cpp, line 1680) in your own handler as described in the next
   step.

<P><LI>Provide a TTN_NEEDTEXT notification handler in the message map of the
   window that contains the child controls (for example, your form view
   class). This handler will call a function that will identify the
   control and pass the ID of the control and the instance handle of the
   application that contains the string resource to the appropriate
   TOOLTIPTEXT structure members.
<P>
</OL><h3>Sample Code</h3>
 
<P>
<PRE>   // Each control on the form view has an associated
   // string resource with the same ID in the string table of
   // this application.

   // Message Map for CFormView derived class
   BEGIN_MESSAGE_MAP(CMyFormView, CFormView)
        ON_NOTIFY_EX_RANGE(TTN_NEEDTEXT,0,0xFFFF,OnToolTipNotify)
   END_MESSAGE_MAP()

   //Notification handler - add entry to class definition
   BOOL CMyFormView::OnToolTipNotify(UINT id, NMHDR *pNMH,
             LRESULT *pResult)
   {
       TOOLTIPTEXT *pText = (TOOLTIPTEXT *)pNMH;
       int control_id =  ::GetDlgCtrlID((HWND)pNMH-&gt;idFrom);
       if(control_id)
       {
           pText-&gt;lpszText = MAKEINTRESOURCE(control_id);
           pText-&gt;hinst = AfxGetInstanceHandle();
           return TRUE;
       }
       return FALSE;
   }

   void CKbtestView::OnInitialUpdate()
   {
       CFormView::OnInitialUpdate();
       EnableToolTips(TRUE);
   }

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For further information on how commands such as WM_NOTIFY are routed, see
Programming with MFC Overview, Working with Messages and Commands, How the
Framework Calls a Handler, Command Routing in Books Online.
<P>
For further information on how to handle a WM_NOTIFY message such as
TTN_NEEDTEXT, see Tech Note 61: ON_NOTIFY and WM_NOTIFY Messages.
 
<PRE>Keywords          : MfcMisc MfcUI vcbuglist400 kbcode kbprg kbui
Technology        : kbMfc
Version           : 4.0 4.1 4.2
Platform          : NT WINDOWS
Issue type        : kbdocerr
Solution Type     : kbdocfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
