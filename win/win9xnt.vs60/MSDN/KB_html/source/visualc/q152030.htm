

<HTML>
<HEAD>
<TITLE>FIX: Port I/O Functions Not in DLL Version of CRT for VC++ 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152030">
<META NAME="KBModify" CONTENT="1997/09/19">
<META NAME="KBCreate" CONTENT="1996/06/01">
<META NAME="Keywords" CONTENT="CRTIss kbbuglist kbfixlist kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When compiling a program that uses the _inp and _outp instructions and links with the DLL version of the CRT, you will see one or more of the following errors:     test.obj : error LNK2001: unresolved external symbol __inp    test.obj : error LNK20...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAVX,QAVW,QAB4,QBV8,QAY5,QAB9,QDIV,QAR4,QA0N,QBFY,QAWM,QAKP,QASR,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Port I/O Functions Not in DLL Version of CRT for VC++ 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152030</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS NT
kbprg kbbuglist kbfixlist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When compiling a program that uses the _inp and _outp instructions and
links with the DLL version of the CRT, you will see one or more of the
following errors:
<P>
<PRE>   test.obj : error LNK2001: unresolved external symbol __inp
   test.obj : error LNK2001: unresolved external symbol __inpw
   test.obj : error LNK2001: unresolved external symbol __inpd
   test.obj : error LNK2001: unresolved external symbol __outp
   test.obj : error LNK2001: unresolved external symbol __outpw
   test.obj : error LNK2001: unresolved external symbol __outpd
   test.exe : fatal error LNK1120: 6 unresolved externals

</PRE><h2>CAUSE</h2>
 
<P>
The _inp and _outp functions are not exported from the DLL versions of the
C Run-time Library (CRT), and do not exist in those versions of the CRT. If
you try to use these functions with the DLL version of the CRT, you will
get LNK2001 errors.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are several ways to get around the LNK2001 errors:

<UL><LI>Use a #pragma intrinsic instruction.

<LI>Turn on Instrinsic Optimizations.

<LI>Link with one of the static versions of the CRT.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem was corrected in Microsoft
Visual C++, 32-bit Edition, version 4.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can avoid the linker errors by using a #pragma intrinsic instruction
that will replace the _inp and _outp function calls with their assembly
equivalents. In each file that refers to the _inp or _outp instruction,
add the following line:
<P>
<PRE>   #pragma intrinsic(_inp,_inpw,_inpd,_outp,_outpw,_outpd)

</PRE>A similar method that can be used to avoid the link errors is to turn on
intrinsic function optimizations for all intrinsic functions. If you
are using the Command Line compiler, adding the /Oi switch to the
compile options will enable intrinsic function optimizations. To turn
on this optimization within Developer Studio, perform the following
steps:

<OL><P><LI>From the Build menu, choose the Settings option to display the Project
   Settings dialog box.

<P><LI>In the Settings For pane, select the Project that is getting the
   link errors.

<P><LI>Choose the C/C++ tab.

<P><LI>Select Optimizations for the Category.

<P><LI>Choose Customize for the optimizations, then check the Generate
   Intrinsic Functions optimization.
<P>
</OL>An additional method to avoid the linker errors is to use the static
version of the CRT because the _inp and _outp functions are implemented in
this version of the CRT. For more information on determining which static
library to use, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../utilities/q140584.htm">Q140584</A></B>
   TITLE     : How to Link with the Correct C Run-Time (CRT) Library
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00<BR>
KBCategory: kbprg kbbuglist kbfixlist<BR>
KBSubcategory: CRTIss<BR>
Keywords          : CRTIss kbbuglist kbfixlist kbprg<BR>
Version           : 4.00<BR>
Platform          : NT WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
