

<HTML>
<HEAD>
<TITLE>PRB: GetActiveView Returns NULL for an MDI Frame Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129649">
<META NAME="KBModify" CONTENT="1997/08/07">
<META NAME="KBCreate" CONTENT="1995/05/01">
<META NAME="Keywords" CONTENT="MfcUI kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The GetActiveView() function returns the active view (if any) attached to a frame window (CFrameWnd). This function returns NULL when called for an MDI main frame window (CMDIFrameWnd).  CAUSE =====  In an MDI application, the MDI main frame window...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADK,QAUD,QAIB,QAIA,QAGQ,QAGI,QDL9,QBWQ,QBWO,QBWN,QA39,QAY5,QAX6,QA62,QBWT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: GetActiveView Returns NULL for an MDI Frame Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129649</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 1.51 1.52 | 1.00 2.00 2.10 4.00
<PRE>WINDOWS             | WINDOWS NT
</PRE>kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P>
<P><PRE>     - Microsoft Visual C++ for Windows, versions 1.0, 1.5, 1.51, 1.52
     - Microsoft Visual C++, 32-bit Edition, versions 1.0, 2.0, 2.1,
       and 4.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The GetActiveView() function returns the active view (if any) attached
to a frame window (CFrameWnd). This function returns NULL when called
for an MDI main frame window (CMDIFrameWnd).
<P>
<P><h2>CAUSE</h2>
 
<P>
In an MDI application, the MDI main frame window (CMDIFrameWnd) does not
have a view associated with it. Instead, each individual child window
(CMDIChildWnd) has one or more views associated with it. Therefore, a call
to the GetActiveView() function for an MDI main frame window returns NULL.
The "More Information" section of this article gives the layout of the
different windows in an MDI application.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve the problem, find the active MDI child window (if any), and then
call the GetActiveView() function for that child window. The active MDI
child window can be found by calling the MDIGetActive() or GetActiveFrame()
function, as demonstrated in this code:
<P>
<PRE>   CMDIFrameWnd *pFrame = (CMDIFrameWnd *)AfxGetApp()-&gt;m_pMainWnd;
   // Get the active MDI child window.
   CMDIChildWnd *pChild =
                  (CMDIChildWnd *) pFrame-&gt;GetActiveFrame();
   /* or CMDIChildWnd *pChild =
                  pFrame-&gt;MDIGetActive();
   */
   // Get the active view attached to the active MDI child window.
   CMyView *pView = (CMyView *) pChild-&gt;GetActiveView();

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The client area of the MDI frame window is covered by the client window
referred to as the MDICLIENT, also known as the Workspace. This client
window in turn contains zero or more child windows, each of which can
display a view, as in this diagram:
<P>
<PRE>                    ---------------------------
                   |      Frame Window         |  ---&gt; CMDIFrameWnd
                   | (main application window) |
                    ---------------------------
                             |
                    --------------------
                   |   Client Window    |  ---&gt; MDICLIENT window class
                   | (no view attached) |
                    --------------------
                             |
         -----------------------------------------------------------
         |                            |
 ---------------------      --------------------
|   Child Window 1    |    |   Child Window 2   |  ---&gt; CMDIChildWnd
| (one or more views) |    | (one or more views |
 ---------------------      --------------------

</PRE>As illustrated in this diagram, the MDI frame window does not have a view
directly associated with it. The views are actually associated with the MDI
child windows.
<P>
Therefore, calling the GetActiveView() function for an MDI main frame
window returns NULL, implying that there is no view directly associated
with MDICLIENT. The active view in an MDI application can be obtained by
first finding the active MDI child window and then finding the active view
for that child window as outlined in the Resolution section of this
article.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Programming Windows 3.1," Charles Petzold, Microsoft Press, 1992.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 2.00 2.10 2.50 2.51 2.52 3.00 3.10<BR>
4.00<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: MfcUI<BR>
Keywords          : MfcUI kbcode kbprg<BR>
Technology        : kbMfc<BR>
Version           : 1.00 1.50 1.51 1.52 | 1.00 2.00<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
