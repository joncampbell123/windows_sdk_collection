

<HTML>
<HEAD>
<TITLE>BUG: Query Designer Not Inserting Record if Field Name Has Dash </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165433">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1997/03/19">
<META NAME="Keywords" CONTENT="kbprg vcbuglist500 VCEntIss kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  When you try to add a row to an SQL Server table using Query Designer you receive the following error if one of the table's field names contains a  - :     ODBC error:  37000 [Microsoft][SQL Server Driver]Line2: Incorrect syntax    near '-'  CAUSE ...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACI,QABM,QA9N,QA5V,QAUJ,QBL4,QAPN,QAB4,QA7O,QA7N,QDOQ,QAAP,QAB9,QBI0,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Query Designer Not Inserting Record if Field Name Has Dash</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165433</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Enterprise Edition, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to add a row to an SQL Server table using Query Designer you
receive the following error if one of the table's field names contains a
"-":
<P>
<PRE>   ODBC error:  37000 [Microsoft][SQL Server Driver]Line2: Incorrect syntax
   near '-'

</PRE><h2>CAUSE</h2>
 
<P>
The data tool creates an SQL INSERT statement that doesn't put quotes
around field names. The generated INSERT statement would look like:
<P>
<PRE>   INSERT INTO "x" (id, e-mail)
   VALUES (1, 'name')

</PRE>If data tools generated an INSERT statement that used double quotes around
the field name, then the INSERT would work. The following syntax would
work:
<P>
<PRE>   INSERT INTO "x" (id, "e-mail")
   VALUES (1, 'name')

</PRE>You can verify this by using the SQL Trace utility that ships with SQL
Server 6.5. You can use MS Query to test both INSERT statements.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can workaround this problem in the following ways:

<UL><LI>Rename the field so that it doesn't contain a hyphen.
<P>
   -or-

<LI>Create the SQL INSERT statement manually. Click the SQL button on the
   Query toolbar after you open the table. Type and execute the correct
   INSERT statement. You need to retype the original SELECT query to see
   the updated contents of the table.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a database project that has an SQL Server data source.

<P><LI>Create a table with a field that has a dash in it. For example, use the
   following script:
<P>
<P><PRE>      create table employee
<PRE></PRE>      ( id              integer,
        "e-mail"   varchar(10) )
         // Note the double quotes to avoid the error with the dash.

</PRE><P><LI>In the data view of the project, open the table.

<P><LI>Try to insert a record, that is (1, name), and the error message
   appears.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg vcbuglist500 VCEntIss kbbuglist<BR>
Version             : 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
