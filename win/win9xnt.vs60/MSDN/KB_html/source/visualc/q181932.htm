

<HTML>
<HEAD>
<TITLE>INFO: Limits on Text in CEditView and CEdit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181932">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1998/03/02">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The CEditView and the CEdit classes wrap the Windows edit control. These classes have limits on the amount of text that they can contain. These limits are operating-system dependent.  Windows 95 has a 64 KB limit on edit controls that cannot be inc...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABN,QAMB,QAHP,QATX,QAJB,QA7O,QAOE,QAMN,QAB5,QDL9,QBWQ,QBWO,QBWN,QABO,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Limits on Text in CEditView and CEdit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181932</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.0a, 4.1, 4.2,
   4.2b, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The CEditView and the CEdit classes wrap the Windows edit control. These
classes have limits on the amount of text that they can contain. These
limits are operating-system dependent.
<P>
Windows 95 has a 64 KB limit on edit controls that cannot be increased. To
adjust the limit within this range, use CEdit::SetLimitText(UINT nMax),
where nMax is the number of bytes in the new text limit. You can set nMax
to 65535 to obtain the maximum (which is actually 64000 bytes).
<P>
Windows NT has a practical, machine-dependent limit on edit controls. Users
will run into this machine-dependent limit before they reach operating-
system dependent limit. You can increase the limit by using
SetLimitText(UINT nMax). You can set nMax to some large number such as
4111222333 to obtain the maximum your machine will allow. The practical
limit is based on the computer's RAM. For example, it is possible to load 1
million very short lines of text (nearly 8 MB) into an edit control using a
computer with 64 MB of RAM. Unfortunately, it may use up nearly 100 percent
of the CPU power and take several minutes to load. Once it is loaded in
memory, the control works slowly.
<P>
If you need to use a control that is expected to contain near or over 64 KB
of data, use CRichEditCtrl or CRichEditView. These classes wrap the rich
edit Windows control. In both Windows 95 and Windows NT4, there is no
definite limit on the amount of text that the control can hold.
Theoretically, the rich edit control allows for a maximum of 4 GB of text.
In practice, you can run into performance problems with even less than 1 MB
of text. Files with many lines of text (not necessarily large files,
because the lines can be very short) require a lot of time and CPU power to
process the first time scrolling or resizing of the view window. Once the
CPU has processed these actions, the control behaves normally.
<P>
The maximum text that a CRichEditCtrl can hold can be changed by calling
CRichEditCtrl::LimitText(). However, this will not effect any of the
problems just mentioned. One possible option for storing huge amounts of
text into a RichEdit control would be to only stream in the amount of text
that is needed at a time. This would not be easy, because you need to
handle the scrolling logic to load in the appropriate text for the position
of the scrollbar thumb for this method to work.
<P>
Another option is to design your own Cview-based class.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Some word processing sample programs that ship with Visual C++ are:

<UL><LI>MultiPad: Provides a simple illustration of how to use CEditView.

<LI>SuperPad: Illustrates advanced uses of CEditView through class
   derivation, including toggling the word wrap state of the edit control
   and changing the screen and printer font.

<LI>WordPad: Example of a professional word processing application written
   using MFC that is included with Windows 95. It is based on the
   CRichEditView, CRichEditDoc, and CRichEditCntrItem classes.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q166132.htm">Q166132</A></B>
   TITLE     : PRB: Dialog With RichEdit May Fail During Creation

   ARTICLE-ID: <B><A href="../visualc/q166213.htm">Q166213</A></B>
   TITLE     : BUG: Right-Clicking CRichEditView Doesn't Activate Frame

   ARTICLE-ID: <B><A href="../visualc/q117778.htm">Q117778</A></B>
   TITLE     : HOWTO: Change the Background Color of an MFC Edit Control

   ARTICLE-ID: <B><A href="../visualc/q155224.htm">Q155224</A></B>
   TITLE     : PRB: Using CEdit SetModify/GetModify Returns Invalid Values

</PRE>For additional information about writing 16-bit applications, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q118308.htm">Q118308</A></B>
   TITLE     : SAMPLE: CEdit Derived Class That Uses the Global Heap

</PRE>(c) Microsoft Corporation 1998, All Rights Reserved.
Contributions by Philip Spory, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: CEdit CEditView CRichEditCtrl CRichEditView limit<BR>
maximum max rich richedit edit control<BR>
Version           : WINNT:4.0,4.0a,4.1,4.2,4.2b,5.0<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
