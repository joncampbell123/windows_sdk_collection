

<HTML>
<HEAD>
<TITLE>PRB: AfxFindResourceHandle Fails w/ Icons, Cursors, &amp; Strings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148305">
<META NAME="KBModify" CONTENT="1997/08/07">
<META NAME="KBCreate" CONTENT="1996/03/08">
<META NAME="Keywords" CONTENT="MfcDLL MfcMisc kbcode kbprb kbusage">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  AfxFindResourceHandle() fails when searching for icon (RT_ICON), cursor (RT_CURSOR), and string resources (RT_STRING).  CAUSE =====  This occurs because of how the Windows API function FindResource, which is called by AfxFindResourceHandle(), is de...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIM,QAUD,QAGI,QATX,QAO2,QDL9,QBWQ,QBWO,QBWN,QBWP,QAIF,QALW,QDIT,QBFY,QA56 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: AfxFindResourceHandle Fails w/ Icons, Cursors, &amp; Strings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148305</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50 1.51 1.52 | 2.00 2.10 2.20 4.00
<PRE>WINDOWS        | WINDOWS NT
</PRE>kbusage kbcode kbprb
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P>
<P><PRE>    - Microsoft Visual C++ for Windows, versions 1.5, 1.51, and 1.52
    - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
AfxFindResourceHandle() fails when searching for icon (RT_ICON), cursor
(RT_CURSOR), and string resources (RT_STRING).
<P>
<P><h2>CAUSE</h2>
 
<P>
This occurs because of how the Windows API function FindResource, which is
called by AfxFindResourceHandle(), is designed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
For icons and cursors, use the RT_GROUP_ICON or RT_GROUP_CURSOR resource
type with AfxFindResourceHandle() to return the EXE or DLL instance where
the resource is located, and then call ::LoadIcon() or ::LoadCursor() to
load the resource.
<P>
For string resources, call CString::LoadString(). It will search the EXE
and MFC extension DLLs for the string resource, and load it into the
CString.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
AfxFindResourceHandle is an _AFXDLL-specific API for walking the resource
list to look for a given match. It takes the name and type of a resource
and returns the resource handle where it was first found (or NULL). It is
documented in MFC Technote TN033: DLL Version of MFC.
<P>
<P><h3>Sample Code</h3>
 
<P>
The following sample code shows successful uses of RT_GROUP_ICON and
RT_GROUP_CURSOR:
<P>
<PRE>// This sample code can be placed in any MFC application or DLL
// that links with the DLL version of MFC. Create an icon with ID
// IDI_ICON1 and a cursor with ID IDC_CURSOR1. Call TestLoadIconCursor
// from CWinApp::Initinstance().

</PRE>HICON MyLoadIcon( LPCTSTR  lpIconName )
{
<PRE>    return ::LoadIcon(AfxFindResourceHandle(lpIconName, RT_GROUP_ICON),
                      lpIconName);
}

</PRE>HCURSOR MyLoadCursor ( LPCTSTR  lpCursorName )
{
<PRE>    return ::LoadCursor(AfxFindResourceHandle(lpCursorName,
                        RT_GROUP_CURSOR),
                        lpCursorName);
}

void TestLoadIconCursor(void)
</PRE>{
<PRE>    HICON   hIcon;
    HCURSOR hCur;
    LPCTSTR lpcszRes;

    lpcszRes = MAKEINTRESOURCE(IDI_ICON1);
    hIcon = MyLoadIcon( lpcszRes );
    ASSERT (hIcon != NULL);

    lpcszRes = MAKEINTRESOURCE(IDC_CURSOR1);
    hCur = MyLoadCursor( lpcszRes );
    ASSERT (hCur != NULL);
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.5 2.50 2.51 2.52 3.0 3.00 3.1 3.10 3.2<BR>
3.20 AfxFindResourceHandle FindResource<BR>
KBCategory: kbusage kbcode kbprb<BR>
KBSubcategory: MfcDLL MfcMisc<BR>
Keywords          : MfcDLL MfcMisc kbcode kbprb kbusage<BR>
Technology        : kbMfc<BR>
Version           : 1.50 1.51 1.52 | 2.00 2.10 2.20<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
