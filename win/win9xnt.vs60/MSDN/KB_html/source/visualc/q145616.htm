

<HTML>
<HEAD>
<TITLE>How to Enable Edit Menu Commands for Edit Controls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145616">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1996/02/04">
<META NAME="Keywords" CONTENT="MfcUI kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  On a CDialog or other window that has no edit menu options for cutting, copying, and pasting, CEdit controls handle these functions through the normal Windows accelerator processing (CTRL+X,V,C, or the SHIFT-DELETE, SHIFT-INSERT, CTRL-INSERT, CTRL-...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA9N,QA7O,QAMN,QAHP,QAOE,QADO,QAEF,QAVI,QAY5,QBRD,QBJZ,QBV8,QAGH,QABB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Enable Edit Menu Commands for Edit Controls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145616</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.50 1.51 1.52 | 2.00 2.10 2.20 4.00
<PRE>WINDOWS             | WINDOWS NT
</PRE>kbprg kbhowto kbcode
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC), included with:
<P>
<P><PRE>    - Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0
    - Microsoft Visual C++ for Windows, version 1.0, 1.5, 1.51, 1.52
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
On a CDialog or other window that has no edit menu options for cutting,
copying, and pasting, CEdit controls handle these functions through the
normal Windows accelerator processing (CTRL+X,V,C, or the SHIFT-DELETE,
SHIFT-INSERT, CTRL-INSERT, CTRL-DELETE, and so on keys). However, in a
typical MDI or SDI application, these options are disabled.
<P>
This is due to the default implementation for menu handlers and accelerator
keys that AppWizard adds to your application to handle these functions.
These menu handlers get the accelerator keystrokes instead of your edit
control. This article shows you how to implement the edit control's
clipboard functions on a CFormView-derived form.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you completely remove the menu options (not just enable or disable) and
any accelerator definitions for the standard edit accelerator keys, then
there will be no conflict and your CEdit controls will take care of their
clipboard functions as usual. However, if you want to implement the common
Edit menu clipboard functions (and toolbar Edit buttons), you will have to
add some additional handlers to your program.

<UL><LI>Your UPDATE_COMMAND_UI handlers will need to determine if the control
   with the focus is really a CEdit and if there is any text available for
   the operation.

<LI>Because you have menu items for Cut, Copy, or Paste that are tied to the
   standard accelerators, you need to write handlers for the actions.
<P>
</UL><h3>Step-by-Step Example</h3>
 
<P>
This example provides the code you would add for doing text cut, copy, or
paste in CEdit controls in a CFormView.

<OL><P><LI>First, determine if it is a CEdit control that has the focus:
<P>
<PRE>   // IsEdit: a helper function to determine if a given CWnd pointer
   // points to a CEDit control.
   // Use the SDK ::GetClassName() function because MFC IsKindOf
   // fails if no CEdit variable has been created for the control you're
   // trying to test.

   BOOL CMyFormView::IsEdit( CWnd* pWnd )
   {
      ASSERT( pWnd != NULL );
      HWND hWnd = pWnd-&gt;GetSafeHwnd();
      if (hWnd == NULL)
         return FALSE;

      TCHAR szClassName[6];
      return ::GetClassName(hWnd, szClassName, 6) &amp;&amp;
             _tcsicmp(szClassName, _T("Edit")) == 0;
   }

</PRE><P><LI>Add an UPDATE_COMMAND_UI handler for ID_EDIT_COPY &amp; ID_EDIT_CUT:
<P>
<PRE>   // UPDATE_COMMAND_UI handler for Edit Copy and Edit Cut which both
   // require that the current focus is on an edit control that has
   // text selected.

   void CMyFormView::OnUpdateNeedSel(CCmdUI* pCmdUI)
   {
     // get the current focus &amp; determine if its on a CEdit control
      CWnd* pWnd = GetFocus();
      if (NULL == pWnd || !IsEdit( pWnd ))
      {
         pCmdUI-&gt;Enable( FALSE );
      }
      else
      {
         CEdit* pEdit = (CEdit*)pWnd;
         int nBeg, nEnd;

         pEdit-&gt;GetSel( nBeg, nEnd );
         pCmdUI-&gt;Enable( nBeg != nEnd );
      }
   }

</PRE><P><LI>Add UPDATE_COMMAND_UI handlers for ID_EDIT_PASTE:
<P>
<PRE>   // UPDATE_COMMAND_UI handlers for Edit Paste requires that focus be
   // on an edit control and that the clipboard contains text to be
   // pasted into the control.

   void CMyFormView::OnUpdateNeedClip(CCmdUI* pCmdUI)
   {
      // get the current focus &amp; determine if its on a CEdit control
      // also check to see if the control is read-only.
      CWnd* pWnd = GetFocus();
      if (  NULL == pWnd ||
            !IsEdit( pWnd ) ||
            (pWnd-&gt;GetStyle() &amp; ES_READONLY) != 0 )
      {
         pCmdUI-&gt;Enable( FALSE );
      }
      else
         pCmdUI-&gt;Enable(::IsClipboardFormatAvailable(CF_TEXT));
   }

</PRE><P><LI>Add standard handlers for ID_EDIT_COPY, ID_EDIT_CUT, and ID_EDIT_PASTE:
<P>
<PRE>   void CMyFormView::OnEditCopy()
   {
      CEdit* pEdit = (CEdit*)GetFocus();
      ASSERT( IsEdit( pEdit) );
      pEdit-&gt;Copy();
   }

   void CMyFormView::OnEditCut()
   {
      CEdit* pEdit = (CEdit*)GetFocus();
      ASSERT( IsEdit( pEdit) );
      pEdit-&gt;Cut();
   }

   void CMyFormView::OnEditPaste()
   {
      CEdit* pEdit = (CEdit*)GetFocus();
      ASSERT( IsEdit( pEdit) );
      ASSERT(::IsClipboardFormatAvailable(CF_TEXT));
      pEdit-&gt;Paste();
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00 1.50 2.50 2.51 2.52 2.00 2.10 2.20<BR>
3.00 3.10 3.20 4.00<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: MfcUI<BR>
Keywords          : MfcUI kbcode kbhowto kbprg<BR>
Technology        : kbMfc<BR>
Version           : 1.00 1.50 1.51 1.52 | 2.00 2.10<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
