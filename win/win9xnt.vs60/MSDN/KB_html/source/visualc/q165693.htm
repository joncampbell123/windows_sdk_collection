

<HTML>
<HEAD>
<TITLE>INFO: Visual C++ 5.0 Readme, SQL and SQL Debugging </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165693">
<META NAME="KBModify" CONTENT="1997/10/02">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="VCEntSQLDebug kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  SQL and SQL Debugging  Enabling SQL Debugging One or More Breakpoints are Disabled Upon Starting Direct Database Debugging SQL Server Service Pack 2 Bug May Cause a Failure in CRecordset::Edit Mode SQL Debugging Will Be Disabled Following a Lost Se...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAGU,QBFY,QA2K,QAH5,QAA1,QA56,QA55,QDI2,QAI5,QBG2,QDO3,QBWS,QAIJ,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Visual C++ 5.0 Readme, SQL and SQL Debugging</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165693</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Enterprise Edition, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h3>SQL and SQL Debugging</h3>
 
<P>
Enabling SQL Debugging
One or More Breakpoints are Disabled Upon Starting Direct Database
Debugging
SQL Server Service Pack 2 Bug May Cause a Failure in CRecordset::Edit Mode
SQL Debugging Will Be Disabled Following a Lost Server Connection
SQL Debugging a Disconnected Data Connection May Produce Unexpected Results
Remote SQL Debugging with Automation Manager Registered as Interactive User
Visual C++ Starts Automation Manager but Doesn't Shut It Down
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Feature Only in Enterprise Edition SQL and SQL debugging are supported only
in Visual C++ Enterprise Editions.
<P>
<P>
<P><h3>Enabling SQL Debugging</h3>
 
<P>
To enable SQL Debugging, you need to install the Visual C++ Enterprise
Edition Server Components on your SQL Server machine. Before you run the
setup program for the VC Server Components, you must first install the
latest Service Pack for Windows NT, and the latest Service Pack for
Microsoft SQL Server. Once these service packs are installed, you will be
able to successfully install the Visual C++ Server Components. The setup
program can be run directly from the VCServer directory, or from the master
setup program in the root directory of Disc 2 (Disc 4 for Visual Studio).
<P>
One or More Breakpoints are Disabled Upon Starting Direct Database
Debugging
 
<P>
If your workspace includes both a C++ and a database project it is possible
to encounter a message that warns of one or more break points being
disabled when you begin debugging the database. This happens when you have
C++ breakpoint set in your C++ project and you begin debugging the database
project before the C++ project. In some cases, the debugger will not be
able to find the C++ symbols. The workaround is to first begin debugging
the C++ project, which allows the debugger to load the C++ symbols, before
you debug the database project.
<P>
<P><h3>SQL Server Service Pack 2 Bug May Cause a Failure in CRecordset::Edit Mode</h3>
 
<P>
The SQL Server Service Pack 2 (06.50.0240) that ships with the Visual C++
Enterprise Edition has a bug that may cause a failure in CRecordset::Edit
mode during the call to CRecordset::Update.
<P>
The ODBC driver that ships with this version of SQL Server now gives you
the option to turn ON or OFF the following items:

<UL><LI>Use ANSI Quoted Identifiers
<LI>Use ANSI Nulls, Padding, and Warnings
<P>
</UL>Previous versions of the ODBC driver turned these items ON by default.
<P>
If you encounter the following error:
<P>
<PRE>   Syntax error or access violation
   State:37000,Native:7134,Origin:[Microsoft][ODBC SQL Server Driver]

</PRE>and you have Use ANSI Nulls, Padding, and Warnings turned ON, try the
following workaround:
<P>
<PRE>  1.Open the ODBC Data Source Administrator using the icon in the Control
    Panel.
  2.Select your SQL Server Data Connection and click the Configure button.
  3.Click the Options button. 4.Clear the Use ANSI Nulls, Padding and
    Warnings option.

</PRE><h3>SQL Debugging Will Be Disabled Following a Lost Server Connection</h3>
 
<P>
If the SQL Server against which you are debugging fails during an SQL
Debugging Session, you can reestablish the connection to the database. Go
to the View menu and use the Refresh command.
<P>
<P><h3>SQL Debugging a Disconnected Data Connection May Produce Unexpected Results</h3>
 
<P>
If you delete or disconnect a Data Connection during a SQL Debugging
session you may find the IDE in an unstable state. It is recommended that
you do not delete or disconnect a Data Connection while you are using SQL
Debugging. Stop Debugging before you delete or disconnect the Data
Connection.
<P>
<P><h3>Remote SQL Debugging with Automation Manager Registered as Interactive User</h3>
 
<P>
If you install SQL Server and then install Visual C++ Enterprise Edition
(including the Visual C++ Enterprise server-side components) on the same
computer, the automation manager's identity is registered as "Interactive
User." In this scenario, if you log off from this machine but keep SQL
server running as a service, you will not be able to remote debug against
this server. Registering the automation manager's identity as "Interactive
User" necessitates that someone be logged onto the computer to remotely
debug SQL.
<P>
Visual C++ setup registers the Automation manager as Interactive User, when
installed with a preexisting SQL Server, with the assumption that you'll
want to do local SQL debugging. SQL Debugging may not work if the
automation manager's identity is registered as "Launching User" (the
default) and SQL server and automation manager are already running in the
service environment.
<P>
To change the identity that the automation manager recognizes:

<OL><P><LI>From the computer on which you installed SQL Server and then installed
   Visual C++ Enterprise Edition, run DCOMCNFG.exe .
</OL>2. From the Applications list, select Remote Automation
<PRE>   CLSID_StubMarshaler.
</PRE></OL>3. Click Properties.
4. Click the Identity tab.
5. Select the appropriate user account.
<P>
<P><h3>Visual C++ Starts Automation Manager but Doesn't Shut it Down</h3>
 
<P>
Starting SQL Debugging automatically starts the Automation Manager to
manage remote OLE objects. Automation Manager displays the current number
of connections and objects that are instantiated on the remote machine.
When Visual C++ shut downs, it does not shut down Automation Manager
because there isn't any method of querying Automation Manager to determine
if another application might also be using it.
<P>
You can manually shut down Automation Manager when it displays that there
are no connections left.
 
<PRE>Keywords          : VCEntSQLDebug kbtlc
Version           : 5.0
Platform          : NT WINDOWS
Issue type        : kbreadme</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
