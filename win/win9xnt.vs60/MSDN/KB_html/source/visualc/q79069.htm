

<HTML>
<HEAD>
<TITLE>fwrite() Returns 0 When the Item Size Is 0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79069 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1991/12/11">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  The  Microsoft C Optimizing Compiler: Run-Time Library Reference  for version 5.1, the Microsoft C versions 6.0, 6.0a, 6.0ax Advisor, and Microsoft C/C++ 7.0 and Visual C++  Run-Time Library Reference  document the syntax for fwrite() as:     size_...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBFY,QALW,QANY,QAKC,QAL3,QAI4,QAKD,QAG8,QBC6,QAY5,QAVX,QAVW,QBWP,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>fwrite() Returns 0 When the Item Size Is 0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79069 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.10 6.00 6.00a 6.00ax 7.00 | 5.10 6.00 6.00a | 1.00 1.50
<PRE>MS-DOS                      | OS/2            | WINDOWS
</PRE>kbprg
<P>
<P>
 
The information in this article applies to:

<UL><LI>The C Run-time (CRT), included with:
<P>
<P><PRE>    - Microsoft C for MS-DOS, versions 5.1, 6.0, 6.0a, and 6.0ax
    - Microsoft C for OS/2, versions 5.1, 6.0, and 6.0a
    - Microsoft C/C++ for MS-DOS, version 7.0
    - Microsoft Visual C++ for Windows, versions 1.0 and 1.5
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "Microsoft C Optimizing Compiler: Run-Time Library Reference" for
version 5.1, the Microsoft C versions 6.0, 6.0a, 6.0ax Advisor, and
Microsoft C/C++ 7.0 and Visual C++ "Run-Time Library Reference" document
the syntax for fwrite() as:
<P>
<PRE>   size_t fwrite( const void *buffer,
                         size_t size,
                        size_t count,
                        FILE *stream)

</PRE>The documentation also states the following about its return value:
<P>
<PRE>   The fwrite() function returns the number of full items actually
   written, which may be less than &lt;count&gt; if an error occurs.

</PRE>The function, as implemented by Microsoft, returns a 0 (zero) if the
item size is 0, since the number of full items actually written is 0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Section 4.9.8.2 of the ANSI standard documents the syntax for fwrite()
as:
<P>
<PRE>   size_t fwrite( const void *ptr,
                      size_t size,
                     size_t nmemb,
                     FILE *stream)

</PRE>ANSI also states that:
<P>
<PRE>   The fwrite() function returns the number of elements successfully
   written, which will be less than &lt;nmemb&gt; only if a write error is
   encountered.

</PRE>ANSI does not state what the return value should be for a write of
&lt;nmemb&gt; items of size 0. The return value would be dependent on the
implementation of the compiler.
<P>
For example, if an item of size 0 is sent to test whether a file is
write enabled, without actually writing anything to the file, the
Microsoft implementation of the function will return a value of 0.
This leaves a return value of 0 ambiguous; in this case it can be
mistakenly interpreted as an error return.
<P>
The sample code below illustrates the ambiguity. The program output
is:
<P>
<PRE>   Result is 0.

</PRE><h3>Sample Code</h3>
 
<P>
<PRE>/* Compile options needed: none
*/

#include&lt;stdio.h&gt;

#define SIZE 0
#define NUMBER_TO_WRITE 10

void main( void );

void main()
</PRE>{
<PRE>   int result;
   FILE *fp;

   fp = fopen( "c:\\test.tmp", "w+t" );
   result = fwrite( &amp;result, SIZE, NUMBER_TO_WRITE, fp );

   printf("Result is %d.\n", result);

   fclose( fp );
</PRE>}
<P>
NOTE: In Visual C++ for Windows NT, versions 1.0, 2.0 and 2.1, fwrite()
returns the number elements written regardless of the size.  The sample
program in this article will return a 10.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 5.10 6.00 6.00a 6.00ax 7.00 1.00 1.50<BR>
KBCategory: kbprg<BR>
KBSubcategory: CRTIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
