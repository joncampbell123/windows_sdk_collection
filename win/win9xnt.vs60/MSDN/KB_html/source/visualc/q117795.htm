

<HTML>
<HEAD>
<TITLE>BUG: MFC Library Build Fails with NOSTRICT Defined </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117795">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1994/07/10">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  Specifying OPT= /DNOSTRICT  when building the MFC Library version 2.5 variants generates the following message:     oledobj2.cpp(706) : error C2664: 'CallWindowProc' : cannot convert      parameter 1 from 'long (__far __pascal *)(unsigned int ,unsi...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QDL9,QBWQ,QBWO,QBWN,QA4Q,QAKP,QBXT,QBHQ,QA5V,QALZ,QAAP,QAIB,QAHE,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: MFC Library Build Fails with NOSTRICT Defined</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117795</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.50
WINDOWS
kbprg kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++ for Windows, version 1.5
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Specifying OPT="/DNOSTRICT" when building the MFC Library version 2.5
variants generates the following message:
<P>
<PRE>   oledobj2.cpp(706) : error C2664: 'CallWindowProc' : cannot convert
     parameter 1 from 'long (__far __pascal *)(unsigned int ,unsigned
     int ,unsigned int ,long )' to 'int (__far __pascal *)(void )'

</PRE><h2>CAUSE</h2>
 
<P>
The problem is caused by the declaration of afxPrevClipboardWndProc
(OLEDOBJ2.CPP, line 692). The variable is declared like this:
<P>
<PRE>   extern WNDPROC NEAR _afxPrevClipboardWndProc;

</PRE>That variable is passed as the first argument to the CallWindowProc
in line 706. The CallWindowProc is declared in the WINDOWS.H file
like this:
<P>
<PRE>   #ifdef STRICT
   LRESULT WINAPI CallWindowProc(WNDPROC, HWND, UINT, WPARAM, LPARAM);
   #else
   LRESULT WINAPI CallWindowProc(FARPROC, HWND, UINT, WPARAM, LPARAM);
   #endif

</PRE>In the case that STRICT is not defined, the _afxPrevClipboardWndProc
variable does not match the type of the first argument to CallWindowProc,
and the error is generated.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Modify line 692 in OLEDOBJ2.CPP to provide the correct declaration by using
preprocessor directives. For example:
<P>
<PRE>   #ifdef STRICT
   WNDPROC NEAR _afxPrevClipboardWndProc;
   #else
   FARPROC NEAR _afxPrevClipboardWndProc;
   #endif

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft Foundation
Classes for Windows, version 2.5. We are researching this problem and
will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: NOSTRICT library build 1.50 2.50<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: MfcMisc<BR>
Keywords            : kb16bitonly<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
