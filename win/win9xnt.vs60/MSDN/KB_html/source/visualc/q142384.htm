

<HTML>
<HEAD>
<TITLE>How to Create Accelerators for CPropertyPages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142384">
<META NAME="KBModify" CONTENT="1997/07/10">
<META NAME="KBCreate" CONTENT="1996/01/10">
<META NAME="Keywords" CONTENT="MfcUI kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; visualc">
<META NAME="Description" CONTENT="  By default, the only keystrokes that will allow you to navigate between CPropertyPages in a CPropertySheet are the CTRL+TAB and SHIFT+CTRL+TAB keys. It may be desirable to have assigned keys that jump you directly to a particular page. Although the...">
<META NAME="Product" CONTENT="Visual C++">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QAUD,QABI,QAOE,QAMN,QAGX,QAEV,QABA,QARP,QBSO,QAH4,QAQT,QBWP,QA7O,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Create Accelerators for CPropertyPages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142384</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.10 2.20 4.00
WINDOWS NT
kbprg kbcode kbhowto
<P>
 
The information in this article applies to:

<UL><LI>The Microsoft Foundation Classes (MFC) included with:
   Microsoft Visual C++, 32-bit Edition, versions 2.0, 2.1, 2.2, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By default, the only keystrokes that will allow you to navigate between
CPropertyPages in a CPropertySheet are the CTRL+TAB and SHIFT+CTRL+TAB
keys. It may be desirable to have assigned keys that jump you directly to a
particular page. Although the CPropertySheet object doesn't contain this
functionality by default, you can add it by overriding the
CPropertySheet::PreTranslateMessage() function to check for the desired
keystroke.
<P>
In the case of ALT key combinations, check for WM_SYSKEYDOWN messages.
OnSysKeyDown cannot be used because the messages will be handled by
::IsDialogMessage before getting to the message handler.
<P>
Mnemonics are not possible in versions of the Microsoft Foundation Classes
(MFC) prior to 4.0 because these earlier versions of MFC creates and drew
the tabs using their own techniques. The code uses TextOut() instead of
DrawText() to display text on a tab. TextOut() doesn't interpret the
mnemonic-prefix character (&amp;) as a directive to underscore the character
that follows, so you cannot use this method to designate accelerator keys.
<P>
MFC 4.0, which comes with Visual C++ 4.0, uses the Windows 95 Tab control.
This control properly draws mnemonics on the tabs. All you need to do is
add the mnemonic-prefix character (&amp;) to the tab text in the caption field
of your dialog resource.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample code shows how to override the PreTranslateMessage()
function to check for keystrokes. Use ClassWizard to override the
PreTranslateMessage() for a CPropertySheet derived class.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/* compile options needed: default
*/

</PRE>BOOL CMyProp::PreTranslateMessage(MSG* pMsg)
{
<PRE>    if (pMsg-&gt;message == WM_SYSKEYDOWN)
    {
        switch (pMsg-&gt;wParam)
        {
            case 'S' :
                SetActivePage(0);
                break;

            case 'C' :
                SetActivePage(1);
                break;

            // ... case statements for each key being trapped

            default :  // unhandled keystroke
                return CPropertySheet::PreTranslateMessage(pMsg);
                break;
        }

        return TRUE;  // msg is processed
    }
    return CPropertySheet::PreTranslateMessage(pMsg);
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 2.10 2.20 4.00<BR>
KBCategory: kbprg kbcode kbhowto<BR>
KBSubcategory: MfcUI<BR>
Keywords            : MfcUI kbcode kbhowto kbprg<BR>
Technology          : kbMfc<BR>
Version             : 2.00 2.10 2.20 4.00<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
