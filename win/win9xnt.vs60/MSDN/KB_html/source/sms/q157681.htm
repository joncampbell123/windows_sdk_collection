

<HTML>
<HEAD>
<TITLE>SMS: IP Address Missing from Client Inventory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157681">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1996/10/16">
<META NAME="Keywords" CONTENT="kbbug1.20 kbfix1.20.sp1 ntconfig smsinv kbfix1.20.sp3">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Systems Management Server Inventory Agent fails to report an IP address for Windows for Workgroups 3.11 client and the following error is logged in the Invdos.log file located on the client in the Ms\Sms\Logs directory:     Executing command: C:\MS...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QBXS,QAYL,QARL,QBWO,QDNT,QBNT,QAPF,QDO3,QDJJ,QBVV,QAFI,QAIJ,QDKW,QDOL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: IP Address Missing from Client Inventory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157681</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.20 3.11
WINDOWS
kbnetwork kbbug1.20 kbfix1.20.sp1
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server version 1.2
<LI>Microsoft Windows for Workgroups 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Systems Management Server Inventory Agent fails to report an IP address for
Windows for Workgroups 3.11 client and the following error is logged in the
Invdos.log file located on the client in the Ms\Sms\Logs directory:
<P>
<PRE>   Executing command: C:\MS\SMS\BIN\ipconfig.exe &gt;
   C:\MS\SMS\TEMP\ipconfig.sms IP address information not found in output
   file

</PRE><h2>CAUSE</h2>
 
<P>
Invdos.exe does not detect TCP/IP inventory while the SMS_P environment
variable is present. SMS_P is a temporary variable set in Runsms.bat or
Smsls.bat, and is used for storing path detail, during client setup. The
variable is then reset during termination of the respective batch file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The absence of TCP/IP inventory causes Remote Control using IP sockets to 
fail. The following message appears during inventory (if it is run in verbose
mode by setting SMSLS=1 prior to execution):
<P>
<PRE>   Looking for TCP/IP stack
   Looking for Wolverine stack
   Performing TCP/IP detection
   &lt;drive&gt;:\MS\SMS\BIN\IPCONFIG.EXE &gt; &lt;drive&gt;:\MS\SMS\TEMP\IPCONFIG.SMS
   "IP address information not found in output file"

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do the following to Runsms.bat (which resides
at \SMS\SITE.SRV\MAINCFG.BOX\CLIENT.SRC) or Smsls.bat (which resides at
\SMS\SITE.SRV\MAINCFG.BOX):

<OL><P><LI>Add an additional variable (for example: SMS_P2) to the :START section.
   For example:
<P>
<P><PRE>      :START
</PRE><P>
<P><PRE>      REM Check to see if we can save path and reserve the necessary
      environment
      REM space before continuing.
      set SMS_P=%PATH%
      set SMS_P2=%PATH%
      set SMS_TEMP=123456789012345678901234567890123456789012345
      if "%SMS_TEMP%"=="123456789012345678901234567890123456789012345" goto
      FIND_OS
      goto LOW_ENV
</PRE><P>

<P><LI>Reset the SMS_P variable prior to execution of Invdos.exe in the
   :RUN_DOS section. For example:
<P>
<P><PRE>      :RUN_DOS
      if not exist %0\..\%SMS_BIN%\setls%SMS_OS%.exe goto NOPATHARG0
</PRE><P>
<P><PRE>      setls%SMS_OS% -m:E -i -p:%SMS_BIN%\CLI_DOS.EXE -pa:/p:%%SMS_UNC%%\ -
<PRE></PRE>         pa:%SMS_VERBOSE% %SMS_VERBOSE%
      set SMS_P=
      setls%SMS_OS% -m:E -i -p:%SMS_BIN%\INVDOS.EXE  -pa:/l:%%SMS_UNC%%\ -
         pa:/i -pa:%SMS_VERBOSE% %SMS_VERBOSE%
      goto RESTORE

</PRE><P><LI>Restore the path from the new variable (SMS_P2) by changing the path
   line in the :RESTORE section. For example:
<P>
<P><PRE>      :RESTORE
      REM Restore the previous path setting.
      PATH=%SMS_P2%
      goto END
</PRE>
<P><LI>Reset the new variable, instead of SMS_P in the :END section. For
   example:
<P>
<P><PRE>      :END
      set SMS_P2=
      set SMS_OS=
</PRE><P>
<P><PRE>      set SMS_BIN=
      set SMS_VERBOSE=
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Systems
Management Server version 1.2. This problem has been corrected in the
latest U.S. Service Pack for Systems Management Server version 1.2. For
information on obtaining the Service Pack, query on the following word in
the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbbug1.20 kbfix1.20.sp1<BR>
KBSubcategory: smsinv ntconfig<BR>
Additional reference words: prodsms 1.20 sms inventory automatic ip tcp/ip tcpip<BR>
configuration enabled<BR>
Keywords          : kbbug1.20 kbfix1.20.sp1 ntconfig smsinv kbfix1.20.sp3<BR>
Version           : 1.20 3.11<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
