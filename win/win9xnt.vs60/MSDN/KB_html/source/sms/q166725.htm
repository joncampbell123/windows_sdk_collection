

<HTML>
<HEAD>
<TITLE>SMS: How to Upgrade Windows NT Workstation 3.51 to 4.0 w/ SMS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166725">
<META NAME="KBModify" CONTENT="1998/03/04">
<META NAME="KBCreate" CONTENT="1997/04/09">
<META NAME="Keywords" CONTENT="smspcm kbnetwork kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  This article describes the steps involved for successfully upgrading a computer running Windows NT Workstation 3.51 to version 4.0 using both Systems Management Server versions 1.1 and 1.2.  MORE INFORMATION  Step 1: Preparing the Required Files  S...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDL9,QBWQ,QBWN,QBWO,QBXB,QATJ,QAFI,QAC1,QBXM,QBWS,QAA1,QABI,QAA5,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: How to Upgrade Windows NT Workstation 3.51 to 4.0 w/ SMS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166725</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server, versions 1.1 and 1.2
<LI>Microsoft Windows NT Workstation, versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes the steps involved for successfully upgrading a
computer running Windows NT Workstation 3.51 to version 4.0 using both
Systems Management Server versions 1.1 and 1.2.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step 1: Preparing the Required Files</h3>
 
<P>
Sending Windows NT Workstation version 4.0 unattended upgrade jobs using
Systems Management Server requires the following:

<OL><P><LI>A Windows NT Workstation package definition file (PDF), available at:
<P>
<P><PRE>      - On the Windows NT Workstation 4.0 compact disc in the platform
<PRE></PRE>        directory of your choice

      - <B><A href="http://www.microsoft.com/smsmgmt/pdfs.htm">http://www.microsoft.com/SMSMGMT/pdfs.htm.</A></B>

</PRE><P><LI>An unattended setup script.
<P>
<P><PRE>      - Ntupgrad.scr is supplied in the Sms\Site.srv\Maincfg.box\mstest
<PRE></PRE>        directory of a Systems Management Server 1.2 installation. You
        must rename this file to Ntupgrad.400.

</PRE><P><LI>The Windows NT Workstation setup wrapper files.
<P>
   For Systems Management Server 1.2, this is not a concern. Systems
   Management Server 1.1 requires the updated Systems Management Server 1.2
   wrapper file. The wrapper files are operating system and platform
   specific, and are located in the Sms\Site.srv\Maincfg.box\mstest
   directory. If you do not have access to a Systems Management Server 1.2
   compact disc, contact Microsoft Technical Support.
<P>
   Wrapper file names, operating systems, and hardware platforms are:
<P>
<P><PRE>    - Ntencap.exe:  Windows NT Workstation on x86-compatible computers
</PRE><P>
<P><PRE>    - Ntencapa.exe: Windows NT Workstation on Digital Alpha computers
</PRE><P>
<P><PRE>    - Ntencapm.exe: Windows NT Workstation on MIPS computers
</PRE>
<P><LI>The retail version of Windows NT Workstation 4.0.
<P>
   You must use a fully licensed retail version of Windows NT
   Workstation 4.0. A limited license, developer edition, or OEM version
   of Windows NT Workstation will not work.
<P>
</OL><h3>Step 2: Preparing the Source Directory</h3>
 
<P>
It is possible to use the entire Windows NT Workstation compact disc as the
source for the package, but it is not recommended. The compact disc
contains all platform versions of Windows NT Workstation, as well as the
debug symbols for each platform. Keep in mind that to distribute the
package, Systems Management Server requires at least four times the amount
of disk space as the source requires.

<OL><P><LI>Create a directory on the site server or any other computer running
   Windows NT Workstation or Server on the network. Give the directory a
   name like Ntw4.src.

<P><LI>Share the directory.

<P><LI>Copy and rename the Ntupgrad.scr file to Ntupgrad.400 to the newly
   created directory (in this case, the Ntw4.src directory).

<P><LI>Copy the appropriate version of NTENCAP to the Ntw4.src directory.

<P><LI>Copy the Nt40.pdf file to the Sms\Primesite.srv\Import.src\Enu directory
   on the site server.

<P><LI>Insert the Windows NT Workstation 4.0 compact disc in an assessable
   CD-ROM drive.

<P><LI>From the root of the Windows NT Workstation 4.0 compact disc, copy the
   Autorun.inf and Cdrom_w.40 files to the Ntw4.src directory.

<P><LI>Copy the entire platform directory of your chose to the Ntw4.src
   directory (for example, Ntw4.src\I386).
<P>
</OL><h3>Step 3: Create the Package</h3>
 

<OL><P><LI>Start the Systems Management Server Administrator program.

<P><LI>open the Packages window.

<P><LI>On the File menu, click New.

<P><LI>Click Import.

<P><LI>Drill down to the site server's Primsite.srv\Import.src\Enu directory.

<P><LI>Select the Windows NT Workstation 4.0 PDF.

<P><LI>Click the Workstations button.

<P><LI>Type in the UNC share name of the source file (for example,
   \\Mango\Ntw4.src).

<P><LI>Click Close and update the package at all sites.
<P>
</OL><h3>Step 4: Distribute the Package</h3>
 

<OL><P><LI>Make sure that you have at least four times the size of the source
   directory of available free space on the Systems Management Server
   installation drive on the site server.

<P><LI>Arrange the windows in the Systems Management Server Administrator
   program so that you can see both the Packages window and the Sites
   window.

<P><LI>In the Sites window, drill down to the domain that your target computer
   belongs to.

<P><LI>Drag the package from the package window and drop it on the target
   computer. Doing this will bring up a Job Details dialog box.

<P><LI>In the Job Details dialog box, make sure the package and job targets are
   correct. Under the Run Phase, select "Automated Upgrade on &lt;platform&gt;"
   (for example, "Automated Upgrade on x86" for a computer with an Intel
   processor.)

<P><LI>Set the Offer After, Mandatory, and Expires After dates.

<P><LI>Click OK.

<P><LI>Click OK in the Job Properties dialog box.
<P>
</OL><h3>Step 5: Run the Package</h3>
 
<P>
When the package appears in the workstation's Package Command Manager
(PCM), click the Execute button.
<P>
<P><h3>Troubleshooting</h3>
 

<OL><P><LI>If the package fails to run correctly, check the Pcmwin32.log file and
   the Ntencap.log file in the client's Ms\Sms\Logs directory.

<P><LI>Try to manually connect to the SMS_PKG package source on the
   distribution server, change to the appropriate package ID directory, and
   try to run the command line from there.
<P>
</OL>NOTE: There are several known issues with performing a Windows NT Server
upgrade using the PCM service. These issues have been addressed in the PCM
service update and is included in Systems Management Server 1.2 Service
Pack 2. You can find information and updates for the PCM service at
<B><A href="http://microsoft.com/smsmgmt">http://microsoft.com/smsmgmt,</A></B> and in the Microsoft Knowledge Base.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ntw NTW4 prodsms<BR>
Keywords          : smspcm kbnetwork kbusage<BR>
Version           : 1.1 1.2<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
