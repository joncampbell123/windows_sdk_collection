

<HTML>
<HEAD>
<TITLE>SMS Will Not Deinstall On Windows for Workgroups clients </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125978">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1995/02/09">
<META NAME="Keywords" CONTENT="kbbug1.00 kbbug1.10 kbnetwork smsgeneral">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  When you run DEINSTAL.BAT on a Windows for Workgroups SMS client machine and Logon at Startup is not selected, the following message appears:     Your machine has successfully been prepared for deinstallation.    Microsoft SMS will be deinstalled t...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAIJ,QARL,QAA1,QBWS,QAEF,QAI5,QDIV,QBVV,QBSO,QDL9,QBWQ,QBWN,QDI2,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS Will Not Deinstall On Windows for Workgroups clients</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125978</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0 and 1.1
<LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run DEINSTAL.BAT on a Windows for Workgroups SMS client machine
and Logon at Startup is not selected, the following message appears:
<P>
<PRE>   Your machine has successfully been prepared for deinstallation.
   Microsoft SMS will be deinstalled the next time you start Windows. Phase
   1 of Client de-install complete. If this is a Windows machine, you must
   start or restart Windows now for the deinstallation to complete.

</PRE>The next time you start Windows for Workgroups, SMS is not removed.
<P>
However, the next time you start Windows for Workgroups, choose the Log
On/Off icon in the Network group, and log on, a similar message appears.
Neither the SMS nor program groups are removed. In addition, the
applications specified on the SMSRUN16.INI autostart line are not run.
<P>
<P><h2>CAUSE</h2>
 
<P>
SMS does not display a dialog box asking the user to logon when it detects
that the Windows for Workgroups machine is not logged on.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<OL><P><LI>Run Control Panel and choose the Networks icons.

<P><LI>Choose Startup.

<P><LI>Select Log On at Startup.

<P><LI>Choose OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
versions 1.0 and 1.1. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you run DEINSTAL.BAT or UPGRADE.BAT, Client Setup flags the SMS.INI
file to indicate that SMS needs to do one or more of the following:

<UL><LI>Install a new client component.
<LI>Remove a client component.
<LI>Complete client upgrade.
<LI>Remove the client.
<P>
</UL>When Windows is restarted, SMSRUN16/32 checks the SMS.INI file. If SMS
determines in needs to perform one of the previously mentioned tasks, it
connects to the logon server and launches SMSSRV16/32. SMSRUN16/32 then
calls Client Setup to do the actual installation or removal of files. When
Client Setup is done, SMSSRV16/32 processes the SMSRUN*.INI file and loads
the applications to be automatically started.
<P>
SMS uses this sequence because SMSRUN16/32 has to ensure that none of the
SMS client components, including itself, are running while Client Setup
tries to delete or overwrite their files.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sms prodsms section SMS.INI SetupPhase=deinstall<BR>
[WorkstationStatus] (CLI_DOS, CLI_NT) deinstall autostarted deinstalled<BR>
Keywords            : kbbug1.00 kbbug1.10 kbnetwork smsgeneral<BR>
Version             : 1.0 1.1 3.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
