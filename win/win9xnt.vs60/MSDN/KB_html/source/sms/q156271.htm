

<HTML>
<HEAD>
<TITLE>SMS: Installation Scripts for "Run Command on Workstation" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156271">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1996/09/20">
<META NAME="Keywords" CONTENT="smsappscripts smspcm kb3rdparty kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  An installation script is required for  Run Command on Workstation  packages, if the executable file specified in the Package Command Line terminates after calling a second executable file that relies on accessing the package share location to cont...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDNQ,QDI2,QBWS,QAB4,QAJH,QDIZ,QBWP,QAVX,QAVW,QBS0,QBV8,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Installation Scripts for "Run Command on Workstation"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156271</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1, and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An installation script is required for "Run Command on Workstation"
packages, if the executable file specified in the Package Command Line
terminates after calling a second executable file that relies on accessing
the package share location to continue.
<P>
Many applications run a setup program, and the original executable (such as
Setup.exe) does not keep running throughout the duration of setup. When
creating a "Run Command on Workstation" package, the executable file to run
is specified. When the workstation receives that package, and the Package
Command Manager (PCM) goes to run it, PCM does a NET USE to the package
share location. As soon as the original executable file is finished
running, PCM deletes the share. If the executable file spawned another
executable file before it closed, the second application will fail if it
relies on the source share. The error messages that may result from this
problem vary from application to application. PCM will report in the
Pcmwin.log file that the package ran successfully.
<P>
There may or may not be error messages when the installation fails,
depending on the setup application. The following are examples of common
error messages or problems that may be encountered:

<UL><LI>"Insert Disk 16 in Drive N:"

<LI>"Unable to read from Drive N:"

<LI>"Disk Error Drive/on Device N:"

<LI>"Error reading Drive N"

<LI>"Error opening file XXX"

<LI>"Error in script line 123 - cannot open media script file"

<LI>Buttons or windows may be blank or not drawn correctly

<LI>The system stops responding
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do one of the following:

<UL><LI>If the application to be installed is an MS-DOS-based application, or a
   Windows-based application on a client computer running Windows NT, it
   may be possible to create a batch file containing the command for the
   setup executable file, and then use the batch file as the command line
   when creating the package.

<LI>If the application is a 16-bit application for a computer running
   Windows 3.1, Windows NT, or Windows 95, use Execute.exe to run a two-
   phase setup program under the PCM program. Execute.exe is provided with
   the Systems Management Server 1.2 Resource Kit, and requires a basic
   understanding of Visual C++.

<LI>Copy the source files to the local hard drive, before launching setup.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
MSTest is not the only option for writing an installation script for "Run
Command on Workstation" packages. There are other options, such as using
InstallShield or WINInstall, Visual Basic, C, or even Visual Test (for
client computers running Windows NT only).
<P>
NOTE: If the entire setup program runs from a single executable file (many
programs do), it is not necessary to write an installation script at all.
<P>
The following are some third-party applications that can be used to write
an installation script:

<UL><LI>MSTest by Microsoft Corporation

<LI>Visual Test by Microsoft Corporation

<LI>InstallShield by Installshield Corporation

<LI>WINInstall by Seagate (formerly OnDemand Software)

<LI>WinBatch by Wilson WindowWare

<LI>LAN Script by ABC Systems

<LI>Wise Solutions, Inc.
<P>
</UL>The products included here are manufactured by vendors independent of
Microsoft; we make no warranty, implied or otherwise, regarding these
products' performance or reliability.
<P>
For more information on this subject, see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sms/q130373.htm">Q130373</A></B>
   TITLE     : Obtaining Package ID From Within an Microsoft Test Script

   ATRICLE-ID: <B><A href="../sms/q151735.htm">Q151735</A></B>
   TITLE     : Visual Test 4.0 Not Supported with Windows 95 PCM

   ARTICLE-ID: <B><A href="../sms/q153227.htm">Q153227</A></B>
   TITLE     : PCM Requires Reboot After Executing Package

   ARTICLE-ID: <B><A href="../sms/q128612.htm">Q128612</A></B>
   TITLE     : SMS: Visual Basic Application Setup Fails When Executed by
               PCM

</PRE>Additional Reference Words: prodsms WIN Install Shield
 
<PRE>Keywords          : smsappscripts smspcm kb3rdparty kbnetwork
Version           : 1.0 1.1 1.2
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
