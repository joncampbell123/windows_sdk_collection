

<HTML>
<HEAD>
<TITLE>SMS: List of Tools Available on the SMS 1.2 Compact Disc </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168724">
<META NAME="KBModify" CONTENT="1997/09/15">
<META NAME="KBCreate" CONTENT="1997/05/20">
<META NAME="Keywords" CONTENT="smsutil kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  This article documents information on the Microsoft Systems Management Server (SMS) tools available in the Support\Debug subdirectory of the Systems Management Server 1.2 CD.  These tools are provided to assist Microsoft Technical Support in diagno...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA5V,QBV8,QBBI,QBWP,QBWS,QAB4,QAGU,QAB5,QAB9,QALQ,QAFI,QBWO,QAJH,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: List of Tools Available on the SMS 1.2 Compact Disc</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168724</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server, version 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article documents information on the Microsoft Systems Management
Server (SMS) tools available in the Support\Debug subdirectory of the
Systems Management Server 1.2 CD.
<P>
These tools are provided to assist Microsoft Technical Support in
diagnosing problems remotely. These utilities are not officially supported,
but we encourage constructive feedback or deficiency reports. For a
complete list of files, please examine both the original media and any
corrective service packs you may have. Wherever possible, versions for each
processor architecture are provided within an appropriate subdirectory.
However, there may be a few exceptions, particularly with 16-bit programs
and batch files that are provided under the "x86" processor type.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Adptstat.exe (Intel platform only)</h3>
 
<P>
With Adptstat.exe, you can debug NetBIOS connectivity problems by issuing
standard calls to the specified NetBIOS name and returning information
specific to that name on the network.
<P>
<P><h3>Bugdata.exe / Hdecomp.exe</h3>
 
<P>
These tools allow for the easy collection of the Systems Management Server
registry, log files, and site control image. A compressed file is created
for easy sending to Microsoft Technical Support for analysis. Hdecomp.exe
decompresses the files.
<P>
Bugdata.exe creates a data-compressed file containing:

<UL><LI>The SMS registry hive.

<LI>All current and backup component trace logs.

<LI>A copy of the master site control image.
<P>
</UL>This information consumes about 3 MB of space, which is compressed to about
150 KB. When you run Bugdata.exe on the site server, a default Bugdata.sms
file is created for you to send to Microsoft Technical Support for
analysis.
<P>
<PRE>   Syntax: bugdata

</PRE>After it is compressed, you can use the Hdecomp.exe program to decompress
the resulting file.
<P>
<PRE>   Syntax: hdecomp bugdata.sms c:\analyze\sms\

</PRE>NOTE: When you run Hdecomp.exe, the Smsunzip.dll file must be located in
the same directory.
<P>
<P><h3>Cliopts.exe (Intel platform only)</h3>
 
<P>
With this tool, you can set special options to control the transport
protocol used by the Helpdesk and Diagnostics components on 16-bit clients.
Client setup now picks up options from the Sms.ini file for the WUSER and
USERTSR/IPX command lines. You can make these entries in the Sms.ini file
for the desired USERTSR and WUSER options, and CLISETUP will impose them.
You can use Cliopts.exe to set these options so that they can be preserved
during upgrade when Smsrun16.exe is run. You can also distribute
Cliopts.exe as a Package Command Manager (PCM) job. There is no package
definition file (PDF) currently available; a batch file containing the
needed options should be written by the administrator.
<P>
<PRE>   Syntax: cliopts /set &lt;option_name&gt; &lt;option_value&gt;
           cliopts /list &lt;option_name&gt;

</PRE>The following are some examples of the use of Cliopts.exe:
<P>
<PRE>   cliopts /set usertsr /L1
   cliopts /list usertsr
   cliopts /set wuser /L1

</PRE>Currently, the only allowable options are usertsr, useripx, and wuser.
Running cliopts /set again overwrites any previous options (although the /w
on usertsr is never modified by this process). Cliopts.exe really just sets
the option in the Sms.ini file and sets SetupPhase=verify_files in the
[Local] section to force CLISETUP to rewrite them. The following are some
example changes to the Sms.ini file:
<P>
<PRE>   [Options]
   usertsr=/L1
   wuser=/L1

   [Local]
   SetupPhase=verify_files

</PRE>These changes do not take effect until the user restarts Windows. USERTSR
also requires the user to subsequently restart the computer after
restarting Windows. This is due to the fact that the first time Windows is
restarted, Client.bat gets the new USERTSR value, but it then requires a
restart of the system to start USERTSR with the new value. For example, on
a computer running Windows for Workgroups, to change the lana number to
lana 1, the user would:

<OL><P><LI>Run cliopts /set usertsr /L1.

<P><LI>Run cliopts /set wuser /L1.

<P><LI>Quit and restart Windows.

<P><LI>Quit Windows again and then restart the computer.
<P>
</OL>For more information, please refer to the "Remote Troubleshooting" chapter
of the Administrator's Guide.
<P>
<P><h3>Dumpsend.exe</h3>
 
<P>
Dumpsend.exe displays the contents of a send request (sendreq) file, which
makes up the following records:

<UL><LI>Send request data record: gives information such as the destination
   site, priority, job name, job ID, and outbox location.

<LI>Cancel record: shows whether the sendreq is canceled.

<LI>Action code record: includes retry, deleted, and so on.

<LI>Address record (multiple records allowed): includes all the
   indecipherable encrypted names, as well as the gateway and destination
   addresses.

<LI>Package file record: the name of the package file.

<LI>Instruction file record: the name of the instruction file.

<LI>Sender record: includes information about what the sender history, that
   is, the status, time of last event, start time, the number of times a
   sender took this sendreq, and the size of the sendreq.

<LI>Access record: file access information.

<LI>Ssps record: information about the remote site installation.
<P>
   Syntax: dumpsend &lt;file_name&gt;
<P>
</UL><h3>Error32.exe</h3>
 
<P>
Error32.exe displays the text of an error message for the specified Windows
NT (Win32 subsystem, driver, or service) error code. If no application or
event log message DLL is specified, the message text comes from the system
message table.
<P>
<PRE>   Syntax: error32 &lt;code&gt; [:&lt;code&gt;] [&lt;source_name&gt; | &lt;message_DLL&gt;]
           [insertion_string[...]] [*]

</PRE></OL>Where:
<P>
<PRE>   &lt;code&gt;           Specifies an error code (in decimal) for a Windows NT
                    error, or an event code for an application or system
                    source (such as SMS). The error code is assumed to be a
                    Win32 error unless &lt;source_name&gt; or &lt;message_DLL&gt; is
                    specified.

   :&lt;code&gt;          Specifies another code to form a range; for example,
                    3:11 specifies the codes from 3 to 11, inclusive.

   &lt;source_name&gt;    Specifies an application (such as SMS) or system name
                    registered for the Windows NT event log. This parameter
                    cannot be used with &lt;message_DLL&gt;.

   &lt;message_DLL&gt;    Specifies a full or partial path to a Windows NT event
                    log message DLL file (such as Netmsg.dll). This
                    parameter cannot be used with &lt;source_name&gt;.

   insertion_string Specifies one or more strings to be inserted into the
                    displayed message.

   *                Displays messages for all matching languages and
                    severities.

</PRE><h3>Hcomp.exe</h3>
 
<P>
Hcomp.exe compresses a Systems Management Server package (.pkg) file, using
the same compression algorithm used when Systems Management Server creates
a package in the Systems Management Server Administrator program.
<P>
<P><h3>Hdecomp.exe</h3>
 
<P>
Hdecomp.exe decompresses a Systems Management Server package (.pkg) file
from the command line.
<P>
<PRE>   Syntax: hdecomp &lt;source&gt; &lt;destination&gt;

</PRE><h3>Hvalcomp.exe</h3>
 
<P>
Hvalcomp.exe validates a Systems Management Server compressed package
(.pkg) file from the command line.
<P>
<PRE>   Syntax: hvalcomp &lt;source&gt;

</PRE>NOTE: When you run Hdecomp.exe, the Smsunzip.dll file must be located in
the same directory.
<P>
<P><h3>Install.bat (Intel platform only)</h3>
 
<P>
This file is in the Support directory, and is used to install the debug
symbol files. This should only be done at the guidance of a Microsoft
Technical Support engineer for the purposes of diagnosing an access
violation (AV) or other critical error.
<P>
<P><h3>Instsrv.doc and Instsrv.exe</h3>
 
<P>
Instsrv.exe allows you to install or control local or remote services
running on remote and local computers. (Do not confuse Instsrv.exe with
INSTSVC, which comes with the Microsoft Windows NT Resource Kit.) The
Instsrv.doc file located in Support\Debug\X86 directory of the Systems
Management Server 1.2 CD describes the usage of Instsrv.exe.
<P>
<P><h3>Mifcheck.exe</h3>
 
<P>
Mifcheck.exe is a MIF parser and syntax checker for use in verifying text
MIFs before submitting them to the system. It reports syntax and semantic
errors, and it is designed to help independent software vendors (ISVs) who
are writing MIFs for new components for the inventory agent to collect and
report to the site server.
<P>
<PRE>   Syntax: mifcheck [/dump] &lt;file&gt;

</PRE>Where:
<P>
<PRE>   /dump  Dumps the parsed information to the console. If you run MIFCHECK
          without the /dump option, the MIF files are checked for syntax
          errors.

   &lt;file&gt; Indicates a MIF text file.

</PRE><h3>Nadreset.bat (Intel platform only)</h3>
 
<P>
When detaching from a parent site, that parent site's network application
database (NAD) remains within the child site's database by design, to
prevent clients from undergoing drastic program group deletion. If the
administrator prefers to clean out these foreign NAD entries, the
Nadreset.bat batch file initiates the process.
<P>
<PRE>   Syntax: nadreset &lt;smsroot&gt;

</PRE>Where &lt;smsroot&gt; is the drive letter and directory where Systems Management
Server is installed, for example, D:\SMS.
<P>
WARNING: Running Nadreset.bat causes all of your shared applications that
use a configuration command line to change status from INSTALLED to
CONFIGURE. The result is that the configuration command line will be run
again, and may cause errors on the client.
<P>
<P><h3>Naduser.exe (Intel platform only)</h3>
 
<P>
Naduser.exe is a Win16 application that, when run on a client, can
indicate:

<UL><LI>User global group membership.

<LI>NAD applications available to a user, based on the user's global group
   membership.
<P>
</UL><h3>Pcdetect.exe (Intel platform only)</h3>
 
<P>
Pcdetect.exe detects certain Japanese personal computers that are sensitive
to the inventory process. Please refer to the release notes and product
documentation for further information on this utility.
<P>
<P><h3>Pcmdump.exe</h3>
 
<P>
This Win32 utility, when run on the site server, dumps the contents of the
Package Command Manager instruction database.
<P>
<PRE>   Syntax: pcmdump [options] {/a | /r &lt;instruction_file&gt;}

</PRE>Where:
<P>
<PRE>   /a                    Dumps all files in the instruction box (that is,
                         the Sms\Logon.srv\Pcmins.box) directory.

   /d                    Dumps detailed information.

   /l                    Lists the contents of the PCM instruction box (the
                         Sms\Logon.srv\Pcmins.box) directory.

   /p                    Pauses before PCMDUMP quits. If you run PCMDUMP in
                         a command prompt window that closes after the
                         command is finished, using the /p option allows
                         you to see PCMDUMP's output before the window
                         closes. Then you can press any key to close the
                         command prompt window.

   /r &lt;instruction_file&gt; Dumps a Package Command Manager instruction (.ins)
                         file from the instruction box (the
                         Sms\Logon.srv\Pcmins.box) directory.

</PRE><h3>Rawcheck.exe</h3>
 
<P>
Rawcheck reads an inventory RAW file and displays its contents to the
console. This tool is used for debugging instances of a reportedly corrupt
RAW file.
<P>
<PRE>   Syntax: rawcheck &lt;raw_file&gt; /v

</PRE>Where /v indicates Verbose mode; more output is displayed on the screen.
If you experience problems with RAWCHECK, please refer to the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sms/q154284.htm">Q154284</A></B>

   TITLE     : RAWCHECK for SMS 1.2 Does Not Check SMS 1.2 *.RAW Files

</PRE><h3>Rsappctl.exe</h3>
 
<P>
Rsappctl.exe resets the shared application databases of subsites. The
subsite shared application databases are cleared and the shared application
information is resent from the master site.
<P>
WARNING: Running Rsappctl.exe causes all of your shared applications that
use a configuration command line to change status from INSTALLED to
CONFIGURE. The result is that the configuration command line will be run
again, and may cause errors on the client.
<P>
<P><h3>Sendcode.exe</h3>
 
<P>
Sendcode.exe sends a numeric code to a Systems Management Server service,
causing it to perform a specific task.
<P>
<PRE>   Syntax: sendcode &lt;sms_service_name&gt; &lt;svcode&gt;

</PRE>For further details on the usage of Sendcode.exe, refer to the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sms/q168682.htm">Q168682</A></B>
   TITLE     : SMS: Usage of Sendcode.exe and Its Service Codes

</PRE><h3>Setgug.exe</h3>
 
<P>
Setgug.exe sets the Global User Group reporting interval by means of a PCM
job. This is useful for reducing the number of User Group enumerations
performed in a complex trust model.
<P>
<PRE>   Syntax: SetGUG [/E On|Off] [/I &lt;days&gt;]

</PRE>Where:
<P>
<PRE>   /E On|Off Specifies whether Global User Group enumeration is enabled for
             this site.

   /I &lt;days&gt; Specifies the interval, in days, between enumeration cycles
             (the minimum is 1).

</PRE><h3>Smstrace.exe</h3>
 
<P>
Smstrace.exe is a graphical user interface (GUI) application that allows
you to view Systems Management Server log files and get real-time updates
as lines are appended to the log files. Smstrace.exe only works with the
Systems Management Server 1.2 final release, not earlier versions (due to
DLL incompatibility). You can use Smstrace.atd with SMSADDIN to add
Smstrace.exe to the Tools menu of the Systems Management Server
Administrator program.
<P>
<P><h3>Snirdr.exe</h3>
 
<P>
With Snirdr.exe, you can read and display the Despooler instruction
information contained in an SNI file.
<P>
<PRE>   Syntax: snirdr &lt;snifile_name&gt;

</PRE><h3>Sqlpwd.exe</h3>
 
<P>
With Sqlpwd.exe, you can change the SQL account and password used by the
Systems Management Server services. This task is normally accomplished
through Systems Management Server Setup.
<P>
<P><h3>Srvinfo.exe (Intel platform only)</h3>
 
<P>
With Srvinfo.exe, you can obtain numerous computer parameters, such as the
amount of available disk space and partition types. You can use this tool
remotely.
<P>
<P><h3>Testnet.exe</h3>
 
<P>
Testnet.exe simulates the networking functions used by the Site
Configuration Manager. You can use this tool to debug specific issues
related to WAN speeds and domain security.
<P>
<P><h3>Tracer.exe</h3>
 
<P>
Tracer.exe is a command-line, console mode utility used to read changes
made to a text file in real time.
<P>
<PRE>   Syntax: tracer &lt;path&gt;

</PRE>Where &lt;path&gt; is the path to one of the Systems Management Server log files.
<P>
There is also a GUI MDI version, called Smstrace.exe, that is included in
the Support\Debug\&lt;platform&gt; directory of the Systems Management Server 1.2
CD.
<P>
<P><h3>Ugmif.exe</h3>
 
<P>
Ugmif.exe is a User Group MIF tool for trusted domains.
<P>
<PRE>   Syntax: UGMIF &lt;domain&gt; [&lt;MIF_directory&gt;]

</PRE>Where:
<P>
<PRE>   &lt;domain&gt;        Specifies the name of a Windows NT domain.

   &lt;MIF_directory&gt; Specifies a directory path for the delta MIF. If
                   &lt;MIF_directory&gt; is not specified and this utility is run
                   on a Systems Management Server site server, the delta
                   MIF is written to the Systems Management Server
                   Inventory Data Loader inbox for the site.

</PRE><h3>Viewnad.exe</h3>
 
<P>
You can use Viewnad.exe from a client computer to view applications that
are on servers and are available to be used by clients. Viewnad.exe also
indicates which applications are accessible to the client.
<P>
<P><h3>Wps.exe (Intel platform only)</h3>
 
<P>
You can use Wps.exe to view Windows 3.x processes and certain resource
information for each process. With Wps.exe, you can also stop a process,
much like the Windows NT Resource Kit utility Pviewer.exe.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms admin terminate close exit end<BR>
Keywords          : smsutil kbtool kbusage<BR>
Version           : 1.2<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
