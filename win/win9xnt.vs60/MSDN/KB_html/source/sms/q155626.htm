

<HTML>
<HEAD>
<TITLE>SMS: Invwin32 Fails After Restarting on Windows NT Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155626">
<META NAME="KBModify" CONTENT="1997/04/18">
<META NAME="KBCreate" CONTENT="1996/09/03">
<META NAME="Keywords" CONTENT="kbbug1.00 kbbug1.10 kbbug1.20 kbfix1.20.sp1 kbnetwork smsinv">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  On a Windows NT Server that is not an SMS Logon Server, if the Inventory Agent Service (Invwin32.exe) is restarted, it fails to do inventory. The Invwin32.log file will show the following errors:     SMS 1.2    -------    Sleeping 1440 minutes.    ...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAI5,QAIJ,QBFY,QAFI,QA9A,QDIK,QBXB,QATJ,QA0B,QBVV,QAHE,QACK,QBW7,QBW3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Invwin32 Fails After Restarting on Windows NT Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155626</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1 and 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
On a Windows NT Server that is not an SMS Logon Server, if the Inventory
Agent Service (Invwin32.exe) is restarted, it fails to do inventory.
The Invwin32.log file will show the following errors:
<P>
<PRE>   SMS 1.2
   -------
   Sleeping 1440 minutes.
   SMS root directory: c:\sms\logon.srv.
   DOMAIN.INI path: c:\sms\logon.srv\DOMAIN.INI.
   SMS.INI reports version 786, DOMAIN.INI reports version 0.
   Looking for c:\sms\logon.srv\x86.bin\cli_nt.exe and
   c:\sms\logon.srv\DOMAIN.INI.
   c:\sms\logon.srv\x86.bin\cli_nt.exe does not exist.  Waiting 1 minute...

   SMS 1.1
   -------
   Root directory =C:\sms\logon.srv
   Domain.ini Path path = C:\sms\logon.srv\domain.ini
   SMS.ini and domain.ini have different .ini file versions, call client
   setup
   (692 vs. 0)
   Looking for C:\SMS\logon.srv\x86.bin\cli_nt.exe
   C:\sms\logon.srv\domain.ini
   C:\sms\logon.srv\x86.bin
   \CLI_NT.exe does not exist, waiting

</PRE><h2>CAUSE</h2>
 
<P>
Invwin32 attempts to find the path to the Logon.srv directory when it
starts its cycle. If it is not given a path explicitly with the use of
the /L parameter, it attempts to get one by using the location where it was
executed from. If Invwin32 was executed from a Helper.srv directory on the
local hard disk drive, SMS assumes that a Logon.srv directory also exists
on that local drive.
<P>
However, the Logon.srv directory does not exist locally on Windows NT
servers that are not SMS Logon servers. When the SMS Site Configuration
Manager service originally installed and started the Inventory Agent on the
Server, it started it with the following parameter:
<P>
<PRE>    /L:\\&lt;site server&gt;\SMS_SHR

</PRE>As a result, you see the following entries in the log file:
<P>
<PRE>   SMS root directory: \\ALADRIEL\SMS_SHR.
   DOMAIN.INI path: \\ALADRIEL\SMS_SHR\DOMAIN.INI.
   Copy list file: \\ALADRIEL\SMS_SHR\cl_nt.txt

</PRE>However, Site Config Manager does not place the /L parameter in the
registry key for the Inventory Agent Service. Therefore, if the Invwin32
service is restarted it starts without the /L parameter and defaults to
looking for the Logon.srv directory on the local hard disk drive.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, modify the ImagePath parameter in the Registry
Editor, as follows:
<P>
WARNING: Using Registry Editor can cause serious, system-wide errors that
may require you to reinstall Windows NT. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.

<OL><P><LI>Start the Registry Editor.

<P><LI>In the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\SMS_INVENTORY_AGENT_NT
</PRE>
<P><LI>Manually add
<P>
<P><PRE>      /L:\\&lt;siteserver&gt;\SMS_SHR
</PRE><P>
   after the executable file for the ImagePath parameter.
<P>
</OL>NOTE: If Site Config Manager has to reinstall the Inventory Agent service,
it may reset the registry settings and the ImagePath parameter will have to
be modified again.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
version 1.2. This problem has been corrected in the latest U.S. Service
Pack for Microsoft Systems Management Server version 1.2. For information
on obtaining the Service Pack, query on the following word in the Microsoft
Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms member standalone domain controller<BR>
Keywords            : kbbug1.00 kbbug1.10 kbbug1.20 kbfix1.20.sp1 kbnetwork smsinv<BR>
Version             : 1.0 1.1 1.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
