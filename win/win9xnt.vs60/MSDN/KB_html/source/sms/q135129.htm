

<HTML>
<HEAD>
<TITLE>Removing FailedHardwareChecks Entry In SMS.INI </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135129">
<META NAME="KBModify" CONTENT="1997/04/18">
<META NAME="KBCreate" CONTENT="1995/08/16">
<META NAME="Keywords" CONTENT="kbbug1.00 kbfix1.10 kbnetwork nttcp smshowto">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Systems Management Server 1.0 and 1.1 checks the version of Microsoft TCPIP-32 on your system. The following procedure adds the FailedHardwareChecks entry to the SMS.INI file for Systems Management Server 1.0 only. This article describes a method o...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QA0B,QDNQ,QBFY,QA9N,QBWS,QDH6,QBXT,QBXS,QA5V,QANJ,QAIB,QAH6,QAJP,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Removing FailedHardwareChecks Entry In SMS.INI</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135129</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0 and 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Systems Management Server 1.0 and 1.1 checks the version of Microsoft
TCPIP-32 on your system. The following procedure adds the
FailedHardwareChecks entry to the SMS.INI file for Systems Management
Server 1.0 only. This article describes a method of removing the entry for
Systems Management Server 1.0 client computers.
<P>
The information in this article is intended to correct the problem
mentioned above for clients that were recently upgraded to Systems
Management Server 1.1 to allow Systems Management Server to report the
TCP/IP information to the Systems Management Server Site Server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To properly remove the FailedHardwareChecks entry for the clients' SMS.INI
file, create and distribute a MSTEST script using the following procedure:
<P>
<PRE>   NOTE: The SMS_INI.PCD file can be created using the information listed
   below. MSTest support is supplied by Microsoft Developer Support, not
   Corporate Network Support. MSTest is available as a separate software
   package and is not included with Microsoft System Management Server
   version 1.0 and 1.1.

</PRE><P><LI>Copy the SMS_INI.PCD file (located in the package directory) to the
   SMS\site.srv\maincfg.box\mstest directory on your site server. You
   may use Package Command Manager (PCM) to locate the PCD file.

<P><LI>Create a Workstation Package for the SMS\site.srv\maincfg.box\mstest
   directory. For Workstation Command Lines, choose New and enter the
   following:
<P>
<P><PRE>      Command Name:  MSTEST
      Command Line:  WBRUN20.EXE sms_ini.pcd
</PRE><P>
   Automate the above and configure it as a System task.

<P><LI>Select the appropriate platforms. For example, Windows 3.1, MS-DOS, or
   Windows NT. Choose OK.

<P><LI>In the Setup Package for Workstations window, choose Close.

<P><LI>In Package Properties, choose OK.

<P><LI>For the message "SMS will update the pkg. at all sites.", choose OK.

<P><LI>Create the Workstation Job and make it mandatory.
<P>
</OL>The following is a MSTEST 2.0 script file. You can use MSTEST 3.0 provided
you have all the runtime files for MSTEST 3.0 in the following directory
on the site server: SMS\site.srv\maincfg.box\mstest
<P>
WARNING: Use of the MSTEST script provided in this article is at your own
risk. Microsoft provides this script "as is" without warranty of any kind.
<P>
<P>
<PRE>' **********************************************************************
'
'   This is a test for finding and removing the WolverineInfo
'   error in the FailedHardwareChecks line in the SMS.INI file.
'
' **********************************************************************
</PRE></OL>DIM infile%, StringVar$, outfile%
infile = Freefile
outfile=Freefile
<P>
<PRE>' **********************************************************************
'   Changing Attributes of the SMS.INI file to be read, write, non-hidden.
' **********************************************************************

</PRE>Attrib "C:\SMS.INI" as " -h"
<P>
<PRE>' *************************************
'   Rename files
'       SMS.INI to SMS.OLD
'  Opening SMS.INI as the output file
' *************************************
</PRE>name "c:\sms.ini" as "C:\SMS.OLD"
<P>
<PRE>' ***************************************
'  Opening the SMS.OLD file in input and
'  opening the SMS.INI out output
' ***************************************

</PRE>open "C:\SMS.OLD" for input as #infile
open "C:\SMS.INI" for output as #2
<P>
<PRE>' ************************************************************************
'   Reading and printing the SMS.INI file into Memory, one line at a time.
'   If the parameter left 7 bytes is not "FailedH",  then write the string
' ************************************************************************

</PRE>While not (EOF (infile))
<PRE>       LINE INPUT #infile, StringVar
           IF (left$ (StringVar,7) &lt;&gt; "FailedH") Then
                   Print #2, StringVar
           endif
WEND

' ***************************************
'   Closing the SMS.INI file
' ***************************************

</PRE>Close #infile
<P>
<PRE>' ***************************************
'   Changing Attributes of the SMS.INI file back to original state
' ***************************************

</PRE>Attrib "C:\SMS.INI" as " +h"
END
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
version 1.0. This problem was corrected in Systems Management Server
version 1.1.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms wolverine<BR>
Keywords            : kbbug1.00 kbfix1.10 kbnetwork nttcp smshowto<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
