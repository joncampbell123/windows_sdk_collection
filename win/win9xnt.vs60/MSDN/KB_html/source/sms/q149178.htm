

<HTML>
<HEAD>
<TITLE>SMS: Upgrading SQL Server Used for an SMS Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149178">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1996/03/27">
<META NAME="Keywords" CONTENT="kbother smsgeneral smshowto">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Microsoft Systems Management Server (SMS) uses a SQL Server database to store its system information and computer inventory. When you upgrade the SQL Server containing the database for an SMS version 1.0 or 1.1 site, additional procedures are requi...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAZV,QABM,QBWS,QBVV,QAUD,QABI,QAB9,QBVX,QALW,QADF,QDMW,QBXF,QA6M,QAM9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Upgrading SQL Server Used for an SMS Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149178</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0 and 1.1
<LI>Microsoft SQL Server versions 4.21a and 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Systems Management Server (SMS) uses a SQL Server database to
store its system information and computer inventory. When you upgrade the
SQL Server containing the database for an SMS version 1.0 or 1.1 site,
additional procedures are required to re-create some of the stored
procedures for the SMS database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the stored procedures are not restored, the SMS Scheduler will not be
able to activate jobs that use the Include Subsites option (jobs will
remain in a Pending state and will never be activated).
<P>
To re-create the stored procedures for an SMS database:

<OL><P><LI>Run the SQL script Sp_site.sql against the SQL Server containing the SMS
   database. When you run the script, make sure the SMS database is the
   active database. The Sp_site.sql script is located in the
   &lt;Smsdrive&gt;:\&lt;Smsdirectory&gt;\&lt;Site&gt;.srv\&lt;Platform&gt;.bin directory of the
   SMS site server.

<P><LI>You can use ISQL/W to run the script file. To use ISQL/W to run the
   script, start ISQL/W, connect to the SQL Server containing the SMS
   database, select the SMS database in the DB box, open the Sp_site.sql
   script located on the site server, and run the script. The script has
   run successfully if only the following text is returned in the Results
   tab:
<P>
<P><PRE>      This command did not return data, and it did not return any rows
</PRE>
<P><LI>If the Results tab displays Invalid Object Name errors, you have run the
   script against a non-SMS database.
<P>
</OL>Note: You do not need to manually run the Sp_site.sql script for SMS 1.2
databases.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms prodsql<BR>
Keywords            : kbother smsgeneral smshowto<BR>
Version             : 1.0 1.1 1.2 4.21a 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
