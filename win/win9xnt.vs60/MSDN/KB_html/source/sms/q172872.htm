

<HTML>
<HEAD>
<TITLE>SMS: Application Group or Icons Not Created in WinNT 3.51 w/PCM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172872">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1997/08/19">
<META NAME="Keywords" CONTENT="smspcm kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Microsoft Systems Management Server provides the functionality to install applications in the background on Windows NT systems using the Package Command Manager (PCM) service. Program groups and icons may or may not be created, depending on the ver...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDIM,QAPN,QDNQ,QABO,QBVV,QAA1,QDL9,QBWQ,QBWO,QBWN,QDI2,QA59,QBXR,QAZ2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Application Group or Icons Not Created in WinNT 3.51 w/PCM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172872</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server, version 1.2
<LI>Microsoft Systems Management Server Installer, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Systems Management Server provides the functionality to install
applications in the background on Windows NT systems using the Package
Command Manager (PCM) service. Program groups and icons may or may not be
created, depending on the version of Windows NT used and the method used to
create them.
<P>
Microsoft Systems Management Server Installer offers two methods to create
program groups and icons or shortcuts. One method is available for
computers running Windows NT 3.5x, and both methods are available for
computers running Windows NT 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
On a computer running Windows NT 3.5x or 4.0, the Package Command Manager
service (PCMSVC32) runs software installations under the context of a
service account, in the background. One of the limitations of this method
of installation is that Dynamic Data Exchange (DDE) communication to the
shell (Program Manager in Windows NT 3.51 or Windows NT Explorer in Windows
NT 4.0) is not available. Please consider the following when creating
software installation packages with the Installer for deployment by means
of PCMSVC32:

<UL><LI>In Windows NT 3.51, the exclusive method for creating program groups and
   icons relies on DDE. Therefore, when a setup program running through
   PCMSVC32 performs the DDE operation to create program groups and icons,
   it fails. No groups or icons are created.

<LI>In Windows NT 4.0, group and icon creation through DDE is also available
   for backwards compatibility, but it also fails when the package is sent
   through PCMSVC32. Another method that does not rely on DDE is normally
   used, and works correctly with PCMSVC32.
<P>
</UL>Two Installer script actions are available for program group and program
icon or shortcut creation:

<UL><LI>Add Progman Icons: This method is available in both Windows NT 3.51 and
   Windows NT 4.0, but it does not work if used with PCMSVC32 because it
   uses DDE.

<LI>Create Shortcut: This method is available in Windows NT 4.0 (but not
   Windows NT 3.51) and works correctly if used with PCMSVC32 because it
   does not use DDE. Note that you must specify the program groups as
   common, not personal, groups. If a personal group is specified, it will
   only create the group and shortcuts under the PCM service account
   profile, and will not be available to the user.
<P>
</UL>When developing scripts for deploying applications to Windows NT 4.0, you
should always use the Create Shortcut script action. Note that the
repackaging/installation expert in the Installer will handle this
automatically because it creates an IF-THEN block to use one of the two
methods described above, based on whether the Windows NT Explorer shell
(with Windows NT 4.0) is present.
<P>
The logic can be summarized as:
<P>
<PRE>   IF
   The Windows 95 (Windows NT 4.0) shell exists

   THEN
   Use the 'Create Shortcut' script action  //This is for Windows NT 4.0
   and works correctly with PCMSVC32//

   ELSE
   Use 'Add Progman Icons' script action //This is for Windows NT 3.51 and
   fails with PCMSVC32//

</PRE>In short, you cannot create program groups or items in Windows NT 3.51 when
you are installing the application through PCMSVC32. When developing
scripts for deploying applications to Windows NT 3.51 through PCMSVC32, you
should create an additional package that runs through Package Command
Manager on the desktop (PCMWIN32) to install the program groups and icons.
You can make it mandatory and silent, but it must run in the context of the
logged on user, in order to communicate with Program Manager and properly
create program groups and icons.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms smsinst<BR>
Keywords          : smspcm kbinterop<BR>
Version           : WINNT:1.0 1.2<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
