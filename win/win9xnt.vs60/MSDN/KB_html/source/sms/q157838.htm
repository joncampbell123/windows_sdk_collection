

<HTML>
<HEAD>
<TITLE>SMS: NetWare Client32 for Windows 95 Stops Responding on Logon </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157838">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1996/10/18">
<META NAME="Keywords" CONTENT="kb3rdparty kbnetwork smshowto smssetup">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Windows 95 clients using the Novell Client 32 (the Client32.nlm file, which has a size of 452,648 bytes) stop responding during the NetWare system login script.  CAUSE =====  There is a known problem with running external commands from Client 32, a...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QARL,QBWP,QA8Y,QBVX,QAGB,QBW7,QDL9,QBWQ,QBWO,QBWN,QBWS,QBVV,QAY2,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: NetWare Client32 for Windows 95 Stops Responding on Logon</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157838</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server version 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Windows 95 clients using the Novell Client 32 (the Client32.nlm file, which
has a size of 452,648 bytes) stop responding during the NetWare system
login script.
<P>
<P><h2>CAUSE</h2>
 
<P>
There is a known problem with running external commands from Client 32, as
documented in the Novell Technical Information Document (TID) 2906860. This
article can be obtained from the Novell web site at www.novell.com.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
A solution is documented in the Novell TID noted above, to allow you to run
external login script commands. If the # command within the login script is
not given an executable file name with an extension (for example, #DOSVER
instead of #DOSVER.COM), the problem will occur.
<P>
By modifying the Smsls.scr script, the problem can be alleviated until a
newer version of Client 32 is released.
<P>
<P><h3>Modifying Smsls.scr</h3>
 
<P>
To modify the Smsls.scr file, find it in the Systems Management Server site
server's Sms\Site.srv\Maincfg.box directory, and then use the following
steps:

<OL><P><LI>Make a backup copy of the Smsls.scr file.

<P><LI>Edit the file with any text editor that has a search function, such as
   Notepad.

<P><LI>Search the Smsls.scr file for instances of the number sign (#).

<P><LI>Change the following instances of "#" to their respective modified
   entries:
<P>
<P><PRE>    - #%&lt;SMS_LOGON&gt;\dosver
      to:
      #%&lt;SMS_LOGON&gt;\dosver.com
</PRE><P>
<P><PRE>    - #%&lt;SMS_LOGON&gt;\netspeed
      to:
      #%&lt;SMS_LOGON&gt;\netspeed.com
</PRE><P>
<P><PRE>    - #%&lt;SMS_LOGON&gt;\x86.bin\NLSMSG16 6 /C YN /T Y,30 /M "Slow network
      detected. Continue"
      to:
      #%&lt;SMS_LOGON&gt;\x86.bin\NLSMSG16.EXE 6 /C YN /T Y,30 /M "Slow network
      detected. Continue"
</PRE><P>
<PRE>    - #%&lt;SMS_LOGON&gt;\x86.bin\CLI_DOS /p:%&lt;SMS_LOGON&gt;\   %&lt;SMS_VERBOSE&gt;
      to:
      #%&lt;SMS_LOGON&gt;\x86.bin\CLI_DOS.EXE /p:%&lt;SMS_LOGON&gt;\%&lt;SMS_VERBOSE&gt;

    - #%&lt;SMS_LOGON&gt;\x86.bin\INVDOS /i /l:%&lt;SMS_LOGON&gt;\ %&lt;SMS_VERBOSE&gt;
      to:
      #%&lt;SMS_LOGON&gt;\x86.bin\INVDOS.EXE /i /l:%&lt;SMS_LOGON&gt;\%&lt;SMS_VERBOSE&gt;

    - #%&lt;SMS_LOGON&gt;\x86.bin\NLSMSG16 11 /M "This version of SMS does not
      support Windows NT workstations"
      to:
      #%&lt;SMS_LOGON&gt;\x86.bin\NLSMSG16.EXE 11 /M "This version of SMS does
      not support Windows NT workstations"

    - #%&lt;SMS_LOGON&gt;\x86.bin\NLSMSG16 12 /M "that are clients to a Novell
      NetWare server."
      to:
      #%&lt;SMS_LOGON&gt;\x86.bin\NLSMSG16.EXE 12 /M "that are clients to a
      Novell NetWare server."

    - #%&lt;SMS_LOGON&gt;\clrlevel
      to:
      #%&lt;SMS_LOGON&gt;\clrlevel.com

</PRE><P><LI>Save the file.
<P>
</OL>The Systems Management Server Maintenance Manager service will then copy
the updated file to your NetWare logon servers.
<P>
NOTE: During the execution of the login script, the Client 32 Login Results
window will display two errors in the form: "Error returned from Dosver &amp;
Cli_dos". These errors can be safely ignored; unfortunately, they cannot be
prevented.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
During the processing of the Systems Management Server Smsls.scr script,
the login process will stop responding. This is due to a problem in the
version of Client 32, which causes the client to stop responding when
attempting to run external programs from the login script. These programs
are run through the # login script command within a NetWare login script.
The Smsls.scr file included a script shipped with Systems Management Server
that uses the # command to run a number of Systems Management Server client
components, such as client setup and the inventory agent.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Novell NLM Client32<BR>
Keywords            : kb3rdparty kbnetwork smshowto smssetup<BR>
Version             : 1.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
