

<HTML>
<HEAD>
<TITLE>Unable to Connect to SQL Server If Default Protocol Is Changed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133250">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1995/07/26">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork ntconfig ntinterop smsadmin smssetup">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  When you change the default network protocol in the SQL Client Configuration Utility, one of the following error messages appears in the SQL Server Administrator or Systems Management Server Administrator program:   - Unable to connect: SQL Server ...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QABA,QAI5,QAB4,QBWD,QDIZ,QBWS,QAVZ,QAA1,QA40,QBVX,QDI2,QBWU,QBWT,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unable to Connect to SQL Server If Default Protocol Is Changed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133250</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1, and 1.2
<LI>Microsoft SQL Server versions 4.21a, 6.0, and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you change the default network protocol in the SQL Client
Configuration Utility, one of the following error messages appears in the
SQL Server Administrator or Systems Management Server Administrator
program:

<UL><LI>Unable to connect: SQL Server is unavailable or does not exist.
   Specified SQL Server not found.

<LI>Couldn't connect to server &lt;server name&gt;.
<P>
</UL>Additionally, after changing the default network protocol, Setup may fail,
with the following error message in the Smssetup.log when upgrading from
Systems Management Server 1.0 or 1.1 to version 1.2:
<P>
<PRE>   &lt;mm-dd-yyyy hh:mm:ss&gt; Registering connects for XXXXXX (server name)
   sa (default value)
   SMS (default value)
   &lt;mm-dd-yyyy hh:mm:ss&gt; Registered the types
   &lt;mm-dd-yyyy hh:mm:ss&gt; Upgrade thread: Failed to register SQL connection
   types.

</PRE><h2>RESOLUTION</h2>
 
<P>
To correct this problem, perform the following steps:

<OL><P><LI>Run the SQL Client Configuration utility.

<P><LI>Select the Default Network for Net Library (by default, SQL Server
   is configured for Named Pipes).

<P><LI>Run SQL Server Setup and click Continue twice.

<P><LI>Click Change Network Support and then click Continue.

<P><LI>Select the network protocol(s) you want SQL Server to use.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsm sms<BR>
Keywords            : kbinterop kbnetwork ntconfig ntinterop smsadmin smssetup<BR>
Version             : 1.0 1.1 1.2 4.21a 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
