

<HTML>
<HEAD>
<TITLE>SMS: Troubleshooting SMS Windows NT Client Services Installation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168518">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1997/05/13">
<META NAME="Keywords" CONTENT="smsconfig smssetup kbenv kbnetwork kbfaq kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  When you install a Systems Management Server 1.2 client on a computer running Windows NT, Systems Management Server does not configure the following as Microsoft Windows NT services on the client:   - Systems Management Server Remote Control Agent ...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QARL,QACK,QAI5,QDIZ,QAA1,QAGR,QBXB,QATJ,QAH5,QAGU,QDI2,QAFI,QAEF,QBW7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Troubleshooting SMS Windows NT Client Services Installation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168518</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server, version 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you install a Systems Management Server 1.2 client on a computer
running Windows NT, Systems Management Server does not configure the
following as Microsoft Windows NT services on the client:

<UL><LI>Systems Management Server Remote Control Agent

<LI>Systems Management Server Inventory Agent

<LI>SNMP Event to Trap Translator
<P>
</UL><h2>CAUSE</h2>
 
<P>
If you are running into this problem, the following are some things to
check:

<OL><P><LI>There Is No Admin$ Share
</OL> 
<P>
The Client Configuration Manager service on the Systems Management Server
site server computer connects to the Admin$ share of a client computer
running Windows NT to install the Systems Management Server Remote Control
Agent and Client Inventory Agent services. If this share is not available,
these services will not be installed and the Client Configuration Manager
will log the following error in the Clicfg.log file:
<P>
<PRE>   ERROR: The SMS service account does not have administrative rights on
   machine "&lt;client computer running Windows NT&gt;" for request "YAP00001".

</PRE></OL>If this is the problem, add the share back, then move the .ccr file from
the Logon.srv\Ccr.box\Retry directory to the Logon.srv\Ccr.box directory.
Doing this forces the Client Configuration Manager service to try
processing the .ccr file again.
<P>
For more information, see the following articles in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sms/q158292.htm">Q158292</A></B>
   TITLE     : SMS: Using Policies May Cause SMS Setup to Fail

   ARTICLE-ID: <B><A href="../winnt/q156365.htm">Q156365</A></B>
   TITLE     : Hidden Shares Are No Longer Available After Using System Policy

</PRE><P><LI>Administrator Privileges
</OL> 
<P>
The Systems Management Server Client Configuration Manager service on the
Systems Management Server site server installs the client services for
Win32 computers. Ensure that the Windows NT Server account used by the
Systems Management Server services has Administrator privileges on the
Windows NT client computer.
<P>
Under normal circumstances, this will not be a problem. When a Windows NT
system joins a domain, the Domain Admins group for the domain is added to
the local Administrators group of the Windows NT system. If the Windows NT
system is a member of a domain that does not contain the Systems Management
Server service account, this could be the cause of the problem. In this
situation, the best solution is to create a duplicate of the Systems
Management Server service account in the domain and make it a member of the
Domain Admins group.
<P>
If the Windows NT system is a member of a workgroup, a local account must
be created on the workstation with the same name and password as the
Systems Management Server service account, and it must be a member of the
local Administrators group.
<P>
After the account problems are resolved, synchronize the domain and move
the .ccr file from the Logon.srv\Ccr.box\retry directory to the
Logon.srv\Ccr.box directory. Doing this forces the Client Configuration
Manager service to try processing the .ccr file again.

<OL><P><LI>Permissions
</OL> 
<P>
Check the permissions set on the following registry keys on the Systems
Management Server client computer:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Client Services

   HKEY_LOCAL_MACHINE\system\currentcontrolset\services

</PRE></OL>Client Configuration manager tries to add registry entries under these
keys.
<P>
If the permissions are improperly set, fix the permissions problem, and
then move the .ccr file from the Logon.srv\Ccr.box\retry directory to the
Logon.srv\Ccr.box directory. Doing this forces the Client Configuration
Manager service to try processing the .ccr file again.

<OL><P><LI>Wait in Case of Pending .Ccr Files
</OL> 
<P>
If you have many new 32-bit Systems Management Server clients whose logon
script was recently modified to install Systems Management Server, you may
see a delay as the Client Configuration Manager must process all the .ccr
files in the Logon.srv\Ccr.box directory. Check this directory to see if
there are many pending .ccr files waiting to be processed by the Client
Configuration Manager service.

<OL><P><LI>Wait for All the Files to Be Copied Before Restarting the Client
</OL> 
<P>
A fairly common mistake when installing the Systems Management Server
Client services is clicking too soon on the "Restart the machine..."
dialog box before the files are completely installed on the client. You may
have restarted the computer as soon as you saw this dialog box, and not
waited for the files to be completely copied, or for the percentage counter
to go all the way up to 100 percent.

<OL><P><LI>Use Windows NT 3.51 or Later
</OL> 
<P>
The Remote Control Agent service requires Windows NT version 3.51 or later.
If the computer is running an earlier version of the Windows NT operating
system, the Systems Management Server Client Setup will not install this
component.

<OL><P><LI>Other Troubleshooting Tips
</OL> 

<UL><LI>Try moving the .ccr file from the Logon.srv\Ccr.box\Retry directory to
   the Logon.srv\Ccr.box directory. Doing this forces the Client
   Configuration Manager service to try processing the .ccr file again.
<P>
   If you have many .ccr files in the Logon.srv\Ccr.box\Retry directory,
   try restarting the Client Configuration Manager service on the Systems
   Management Server site server, and it will try to process all the .ccr
   files in this directory.

<LI>Enable the SNMP registry key. If SNMP is installed after the Systems
   Management Server client services are installed, you may need to
   manually set the TranslatorEnabled value in the
   HKEY_LOCAL_MACHINE\Software\Microsoft\SNMP_EVENTS\EventLog registry
   key. This value is created by SNMP Setup, and is set to Yes by the CliNT
   program the next time the user logs on or runs the Runsms.bat file.
   Ensure that this value is set to Yes so that the event to SNMP trap
   translation will occur.

<LI>Check the Clicfg.log file on the client's Systems Management Server
   logon server for any errors.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>How Systems Management Server Client Services Are Installed</h3>
 
<P>
If any components need to be installed, upgraded or removed, Systems
Management Server Client Setup creates a client configuration request file
named &lt;Sms_id&gt;.ccr, where &lt;Sms_id&gt; is the Systems Management Server Unique
ID for the computer requesting a configuration change. This file is located
on the current Systems Management Server logon server, in the
Logon.srv\Ccr.box directory.
<P>
If the Systems Management Server logon server is a server running LAN
Manager or LAN Server, the Maintenance Manager periodically collects the
.ccr files from the Logon.srv\Ccr.box directory of the Systems Management
Server logon server, and moves them to the Logon.srv\Ccr.box directory of
the site server.
<P>
The Client Configuration Manager is available only on Systems Management
Server logon servers and site servers running Windows NT Server. This means
that the Maintenance Manager must move the .ccr files on servers running
LAN Manager and LAN Server to the site server for processing.
<P>
At the Systems Management Server logon server (or the site server if you
are using LAN Manager or LAN Server), the Client Configuration Manager has
a CCR processing thread that waits for and processes .ccr files in the
Logon.srv\Ccr.box directory.
<P>
The CCR processing thread reads the .ccr file, connects to the target
client computer's registry, checks whether it has access rights to the
computer and its registry (that is, whether the Systems Management Server
service account has access). It reads the registry and performs the
required change to install, configure, or remove the Systems Management
Server client services. It modifies the appropriate values in the Client
Services key to reflect the new configuration.
<P>
If the CCR processing thread completes the configuration requested by a
.ccr file, it deletes the .ccr file. If it cannot complete the
configuration requested by a .ccr file, it performs one of the following
actions:

<UL><LI>If a .ccr file for the same target computer already exists in the
   Logon.srv\Ccr.box\Retry directory, the thread updates the .ccr file in
   the Retry directory with the values for the .ccr file in the Ccr.box
   directory. After updating the .ccr file in the Retry directory, the
   thread deletes the .ccr file in the Ccr.box directory

<LI>If a .ccr file for the same target computer does not exist in the Retry
   directory, the thread moves the .ccr file to that directory.
<P>
</UL>If a configuration change performed by Client Configuration Manager
requires the client computer to be restarted, the Client Monitor program
running on the client displays a message stating that a restart is required
to finish the configuration of the Systems Management Server client
components. The user can choose to restart or not restart.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms CCM sms<BR>
Keywords          : smsconfig smssetup kbenv kbnetwork kbfaq kbhowto<BR>
Version           : 1.2<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
