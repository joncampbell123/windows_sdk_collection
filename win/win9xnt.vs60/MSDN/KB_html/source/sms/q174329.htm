

<HTML>
<HEAD>
<TITLE>SMSINST: Creating Backup Copies of Replaced Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174329">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/09/25">
<META NAME="Keywords" CONTENT="smsinst kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Microsoft Systems Management Server Installer includes a feature that allows you to back up files that are replaced during an installation. This process is not automatic by default.  MORE INFORMATION  To enable support for backing up replaced files...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIU,QA3W,QAA1,QAUR,QDI2,QATJ,QAYL,QACI,QBXB,QA01,QDNQ,QBXS,QAPN,QAFI,QAJP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMSINST: Creating Backup Copies of Replaced Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174329</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server Installer version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Systems Management Server Installer includes a feature that
allows you to back up files that are replaced during an installation. This
process is not automatic by default.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To enable support for backing up replaced files, the Installer variable
BACKUPDIR must be set to a value that is a valid directory path. Typically
a backup directory would be created below a program's main installation
directory.
<P>
Use either of the two following methods to ensure that the BACKUPDIR
variable is set.
<P>
<P><h2>Method 1</h2>
 
<P>
If you wish to display the Backup Replaced Files dialog box or are
performing a silent installation (using the /s command line switch), do the
following:

<OL><P><LI>Under Installation Interface, click the Dialogs tab.

<P><LI>Click to select the Backup Replaced Files check-box.
<P>
   This will display the dialog asking whether you want to back up replaced
   files, and what directory to store them in, and then sets the BACKUPDIR
   appropriately. If the option to display the dialog is selected, the
   default is set to %MAINDIR%\BACKUP.
<P>
</OL>NOTE: When a Systems Management Server Installer executable is run with the
/s switch (for silent installation), none of the dialogs selected are
displayed, but if the Backup Replaced Files dialog box is selected,
BACKUPDIR will still be set to %MAINDIR%\BACKUP, and files will be backed
up accordingly.
<P>
<P><h2>Method 2</h2>
 
<P>
If you wish to have an interactive installation, but prefer not to include
the Backup Replaced Files dialog box, in Script Editor view, insert a Set
Variable script item before the first instance of any Install File script
items:
<P>
<PRE>   Variable:      BACKUPDIR
   New Value:     %MAINDIR%\BACKUP
   Operation:     Nothing

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
Either of these methods will cause a backup directory to be created (user
specified location for Method 1 and BACKUP under the application's main
directory for the Method 2). As each file is installed, Installer will
check to see if the file being installed is replacing a current file. If
it is, it will backup the current file to the specified backup directory,
then install the new file. If the application is later uninstalled, the
backed-up files will be restored.
<P>
For more information on creating backup copies of replaced files, refer to
the online help provided with Microsoft Systems Management Server
Installer. Search the index for the word BACKUPDIR.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms<BR>
Keywords          : smsinst kbusage<BR>
Version           : Windows:1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
