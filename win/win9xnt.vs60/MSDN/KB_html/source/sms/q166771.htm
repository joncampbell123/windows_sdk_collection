

<HTML>
<HEAD>
<TITLE>SMS:  How to Force Site-Wide Client Updates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166771">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1997/04/10">
<META NAME="Keywords" CONTENT="kbnetwork smsconfig smssetup kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  This article describes a fairly automated procedure that you can use to deliver updated Systems Management Server client files to all Systems Management Server clients site-wide.  Systems Management Server tracks updates to the client files' versio...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARL,QAXB,QAA1,QBWP,QBD2,QAKD,QBWS,QAC1,QDI2,QAGR,QDIZ,QA9N,QASB,QA63,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS:  How to Force Site-Wide Client Updates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166771</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server, versions 1.0, 1.1, and 1.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes a fairly automated procedure that you can use to
deliver updated Systems Management Server client files to all Systems
Management Server clients site-wide.
<P>
Systems Management Server tracks updates to the client files' version by
means of the CopyListVersion value in the following copy list files:
Cl_nt.txt, Cl_dos.txt, Cl_os2.txt, Cl_win95.txt and Cl_win.txt. When Client
Setup runs, it compares this value to the value in the [SMS] section of the
client's Sms.ini file. If the values differ, Client Setup forces the client
to go into a "verifying_files" mode that causes the client to compare all
of its Systems Management Server client files with those on the logon
server. If differences are found, the client obtains the updated files from
the logon server.
<P>
The upgrade that results from the procedure discussed in this article may
cause the Systems Management Server client to behave unexpectedly until the
client has completed a successful upgrade and been restarted.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example details each step of this process as it should occur
on the server and the client.
<P>
<P><h3>On the Systems Management Server site server</h3>
 

<OL><P><LI>Make certain that any client files that have been updated are copied to
   the appropriate location under the SMS\Site.srv\Maincfg.box directory
   structure on the site server.

<P><LI>Use Notepad to open the System.map file located in the SMS directory,
   and save it WITHOUT MAKING ANY CHANGES. Simply opening the System.map
   file in Notepad and saving it again gives it a new date/time stamp.
<P>
   NOTE: Other than saving it with a new date/time stamp, Microsoft does
   not support the modification of the copy list files or the System.map
   file.

<P><LI>On its next pass, the Systems Management Server Maintenance Manager
   service will detect the changed date/time stamp on the System.map file
   and regenerate the copy list files, because it assumes the site has been
   upgraded. When the copy list files are regenerated from the "new"
   System.map file, they will get a new CopyListVersion value.
<P>
</OL>Additionally, the Maintenance Manager service will copy all of the updated
client files to each of the Systems Management Server logon servers that
this site manages.
<P>
<P><h3>On the Systems Management Server client</h3>
 

<OL><P><LI>Upon running SMSLS (the Systems Management Server logon script), the
   client setup program Cli_dos.exe (or Cli_nt.exe for client computers
   running Windows NT), compares the CopyListVersion value in the [SMS]
   section of its Sms.ini file with the value stored in the corresponding
   copy list file on the Systems Management Server logon server. If a
   difference is found, the client will display the message, "Verifying
   Microsoft Systems Management Server client installation..."

<P><LI>Client Setup then updates the CopyListVersion value in the [SMS] section
   of the Sms.ini file, and changes the SetupPhase= statement in the
   [Local] section to "verify_files".

<P><LI>As the client’s system continues to start up, Smsrun16.exe (or
   Smsrun32.exe for client computers running Windows NT) is run from the
   client’s LOAD= line in the Win.ini file (for client computers running
   Windows NT, there is a Load value in the registry). When Smsrun16.exe
   finds that the SetupPhase value is set to "verify_files," it actually
   makes another call to the client setup (either Cli_dos.exe or
   Cli_nt.exe).

<P><LI>The second time that Client Setup runs, it again displays the message
   "Verifying Microsoft Systems Management Server client installation..."
   It is at this point that the file comparisons are made and updated files
   are downloaded to the client.
<P>
   NOTE: If it is determined that any of the client components normally
   started by Smsrun16.exe are running, no updates will be downloaded, and
   the SetupPhase will remain as "verifying_files." This will ensure that
   the files will be downloaded the next time the system is restarted and
   Smsrun16.exe is run.

<P><LI>Once the updated files have been downloaded, the last step made by
   Client Setup is to change the SetupPhase value to "installed."
   Additionally, if any changes are made to any of the Systems Management
   Server client services, client computers running Windows NT may see a
   dialog box stating that the Systems Management Server Client has been
   modified and a restart is required for the changes to take effect.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms clisetup<BR>
Keywords            : kbnetwork smsconfig smssetup kbhowto<BR>
Version             : 1.0 1.1 1.2<BR>
Platform            : winnt<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
