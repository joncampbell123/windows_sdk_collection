

<HTML>
<HEAD>
<TITLE>Causes of ErrMsg: "Couldn't Retrieve All Machines..." </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151757">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1996/05/29">
<META NAME="Keywords" CONTENT="smsadmin">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  When you start the SMS Administrator, the following error message appears:     Couldn't retrieve all machines.  SMS administrator has encountered a    problem attempting to load machines from the database.  After you click OK, most or all workstati...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QBWU,QAH5,QAKP,QDMH,QBWP,QAX6,QAL0,QAIJ,QBWS,QALW,QAGR,QAA1,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Causes of ErrMsg: "Couldn't Retrieve All Machines..."</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151757</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1 and 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you start the SMS Administrator, the following error message appears:
<P>
<PRE>   Couldn't retrieve all machines.  SMS administrator has encountered a
   problem attempting to load machines from the database.

</PRE>After you click OK, most or all workstations show up in the sites window.
The following error message appears whenever a query is executed:
<P>
<PRE>   Couldn't execute the specified query.

</PRE><h2>CAUSE</h2>
 
<P>
These errors are general and can be caused by any of the following
problems:

<OL><P><LI>TEMPDB is in single user mode.

<P><LI>TEMPDB is full.

<P><LI>The Transaction log is full. For more information see the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      Article-ID: <B><A href="../sms/q125487.htm">Q125487</A></B>
<PRE></PRE>      Title     : SMS Administrator Unable to Retrieve Machine List

</PRE><P><LI>The stored procedure sp_GetSubSite, created by the SMS setup
   program, may be missing or corrupted. To reload the SMS stored
   procedures, SP_SITE.SQL can be rerun in the Query Window.

<P><LI>One or more tables in the SMS database has been dropped.
<P>
</OL>MORE INFORMATION
 
<P>
Enabling SQL Tracing may help narrow down the problem, and will log errors
to the SMS\LOGS\UI.LOG on the site server when the SMS Administrator is run
at the site server.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
To enable SQL Tracing, complete the following steps:

<OL><P><LI>Open the Registry Editor (Rededt32.exe).

<P><LI>Go to the following location:
<P>
   HKEY_LOCAL_MACHINE\Software\Microsoft\SMS\Tracing

<P><LI>Set the parameter SQLEnabled to 1.

<P><LI>Restart the SMS Administrator and recreate the error.

<P><LI>Check the SMS\LOGS\UI.LOG using SMSTrace or Notepad.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms<BR>
Keywords          : smsadmin<BR>
Version           : 1.00 1.10 1.20<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
