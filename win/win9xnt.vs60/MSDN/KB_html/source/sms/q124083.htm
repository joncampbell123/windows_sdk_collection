

<HTML>
<HEAD>
<TITLE>SMS: ViewNAD and the Network Applications Database (NAD) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124083">
<META NAME="KBModify" CONTENT="1997/04/22">
<META NAME="KBCreate" CONTENT="1994/12/18">
<META NAME="Keywords" CONTENT="kbnetwork kbusage nthowto smsdatabase smspgc">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  ViewNAD provides a text based graphical display of the current Systems Management Server Network Applications Database (NAD) for review. This article describes how to use the ViewNAD utility.  MORE INFORMATION  VIEWNAD.EXE    Dumps the NAD database...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWI,QDIM,QABO,QAGU,QBV8,QAB9,QAH4,QAZV,QAJG,QAC9,QADK,QBWP,QAJH,QDO3,QAIH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: ViewNAD and the Network Applications Database (NAD)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124083</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0 and 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
ViewNAD provides a text based graphical display of the current Systems
Management Server Network Applications Database (NAD) for review.
This article describes how to use the ViewNAD utility.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<PRE>VIEWNAD.EXE    Dumps the NAD database for review
Environment:   32 bit Windows NT
Usage:         VIEWNAD
</PRE>Execute VIEWNAD.EXE from the directory:
<P>
<PRE>   \\&lt;logon server&gt;\SMS\LOGON.SRV\APPCTRL.BOX\DATABASE

</PRE>ViewNAD provides a text based graphical display of the current Network
Applications Database for review. This database consists of *.HGF (groups)
and *.HAF (applications) files. These files are parsed by ViewNAD and are
then displayed.
<P>
The NAD database resides on each SMS logon server in the
..\LOGON.SRV\APPCTRL.BOX\DATABASE directory. The *.HAF files contain the
applications available and the *.HGF files contain information on what
global user groups have access to these applications.
<P>
An SMS client uses the Program Group Control (PGC) utility to read these
databases and update the users desktop based on the information in the
files.
<P>
This is accomplished by using a LAN Manager API to enumerate all global
user groups that the current user belongs to in the currently logged on
domain. PGC will then compare the list generated with the user groups
listed in the NAD files and update the clients desktop to match the NAD
list of applications that are associated with these user groups.
<P>
There are three sections to the ViewNAD output.
<P>
The first section lists what groups the currently logged on user of ViewNAD
belongs to.
<P>
The second section contains a list of the NAD objects. The first line
contains the return code 1 or 0 for success/failure and the size of the
buffer holding the objects. It then lists all the NAD objects in the
database. The first three characters are the site code of the originally
created package.
<P>
The third section contains the NAD program item information. Each program
group is listed with its associated program items. Below is the record
format.
<P>
<PRE>Program Group:   &lt;Internal Database Unique ID&gt;
  Group:         Name of program group
  Users:         A list of global user groups that have been granted access
                 to this program group
  &lt;SMS Program Item Unique ID&gt;
  Registry:      Name of the clients registry key for this program item
  Description:   Name of the program item
  Command:       Command line executable file name
  Servers:       UNC names of the SMS distribution servers available.
  Drive:         Type of redirection required (drive mode)
                    If not listed then runs with UNC name
                    &lt;"?"&gt;: Requires a drive letter
                    &lt;letter&gt;: Requires this specific drive letter
  Platform:      Bit mask of supported platforms. Currently this data is
                 invalid. ViewNAD parses this data incorrectly.

</PRE>Below is an example of a ViewNAD output of an SMS site's NAD database:
<P>
<PRE>   INTERACTIVE
   LOCAL
   Department 8954
   psscnsred-se
   Administrators
   Everyone
   Domain Users

   Get Objects Return Code 1 Size 45
   BPC00001
   BPC00002
   BPC00003
   BPC00004
   GBL00003

   Program Group ======= BPC00001 ==========
     Group          MS Office
     Users          psscnsred-mgr;psscnsred-se
     ÃÄ BPC00007
     ³  Registry    msoffpro+autoconv:msapps
     ³  Description Graph AutoConvert
     ³  Command     msgraph5\autoconv.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC0000C
     ³  Registry    msoffpro+graflink
     ³  Description GraphicsLink
     ³  Command     graflink.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC0000A
     ³  Registry    msoffpro+wrkgadm
     ³  Description MS Access Workgroup Administrator
     ³  Command     wrkgadm.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC0000D
     ³  Registry    msoffpro+mplayer
     ³  Description Media Player
     ³  Command     mplayer.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00009
     ³  Registry    msoffpro+msaccess
     ³  Description Microsoft Access
     ³  Command     msaccess.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00004
     ³  Registry    msoffpro+excel
     ³  Description Microsoft Excel
     ³  Command     excel.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00001
     ³  Registry    msoffpro+msoffice
     ³  Description Microsoft Office
     ³  Command     msoffice.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00006
     ³  Registry    msoffpro+powerpnt
     ³  Description Microsoft PowerPoint
     ³  Command     powerpnt.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00005
     ³  Registry    msoffpro+msquery:msapps
     ³  Description Microsoft Query
     ³  Command     msquery\msquery.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00002
     ³  Registry    msoffpro+winword
     ³  Description Microsoft Word
     ³  Command     winword.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC0000B
     ³  Registry    msoffpro+ofreadme
     ³  Description Office Readme Help
     ³  Command     ofreadme.hlp
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC0000E
     ³  Registry    msoffpro+preview
     ³  Description PowerPoint
     ³  Command     preview.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00008
     ³  Registry    msoffpro+pptview
     ³  Description PowerPoint Viewer
     ³  Command     pptview.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00003
     ³  Registry    msoffpro+macrode
     ³  Description Word Dialog Editor
     ³  Command     macrode.exe
     ³  Servers     \\CNS-SMS\ofc43_sh\;\\CNSSUP2\ofc43_sh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC0000F
     ³  Registry    MSAPPS
     ³  Description MSAPPS Shared Components
     ³  Command     &lt;no command for applets&gt;
     ³  Servers     \\CNS-SMS\msappssh\;\\CNSSUP2\msappssh\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
   Program Group ======= BPC00002 ==========
     Group          CNS Documents
     Users          psscnsred-mgr;psscnsred-se
     ÃÄ BPC0001D
     ³  Registry    oct94hcl.hlp
     ³  Description NT 3.5 October HCL
     ³  Command     miscinfo\oct94hcl.hlp
     ³  Servers     \\CNS-SMS\cns-docs\;\\CNSAPPS1\cns-docs\;\\CNSSUP2\cns-
                    docs\
     ³  Drive       ?
     ³  Platform    556A8556A9556AA556AB
     ÃÄ BPC00014
     ³  Registry    SP2help
     ³  Description NT Service Pack 2
     ³  Command     SP2-3.1\fixlist.hlp
     ³  Servers     \\CNS-SMS\cns-docs\;\\CNSAPPS1\cns-docs\;\\CNSSUP2\cns-
                    docs\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC00015
     ³  Registry    NTSP2a
     ³  Description NT Service Pack 2a
     ³  Command     SP2a-3.1\fixlist.hlp
     ³  Servers     \\CNS-SMS\cns-docs\;\\CNSAPPS1\cns-docs\;\\CNSSUP2\cns-
                    docs\
     ³  Drive       ?
     ³  Platform    556A8556A9556AA556AB
     ÃÄ BPC00016
     ³  Registry    NTSP2b
     ³  Description NT Service Pack 2b
     ³  Command     SP2b-3.1\FIXLIST.HLP
     ³  Servers     \\CNS-SMS\cns-docs\;\\CNSAPPS1\cns-docs\;\\CNSSUP2\cns-
                    docs\
     ³  Drive       ?
     ³  Platform    51EA851EA951EAA51EAB
     ÃÄ BPC0002D
     ³  Registry    BPC0002D
     ³  Description NT Service Pack 3
     ³  Command     SP3-3.1\FIXLIST.HLP
     ³  Servers     \\CNS-SMS\cns-docs\;\\CNSAPPS1\cns-docs\;\\CNSSUP2\cns-
                    docs\
     ³  Platform    555C0555C1555C2555C3
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sms prodsms<BR>
Keywords            : kbnetwork kbusage nthowto smsdatabase smspgc<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
