

<HTML>
<HEAD>
<TITLE>SMS: Remote Controlling a Multihomed Windows NT Client Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170440">
<META NAME="KBModify" CONTENT="1998/01/30">
<META NAME="KBCreate" CONTENT="1997/06/20">
<META NAME="Keywords" CONTENT="kbbug1.20 smsremtshoot kbfix1.20.sp3 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  In some situations, it may be difficult to establish a Remote Control session with a Windows NT system that contains more than one network adapter. These multihomed systems add a certain degree of complexity to the process required to establish a r...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAOE,QAIJ,QANN,QA7O,QAMN,QAB5,QAUJ,QAKD,QA1S,QARL,QBWP,QDIV,QBWS,QDN9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMS: Remote Controlling a Multihomed Windows NT Client Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170440</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server, version 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In some situations, it may be difficult to establish a Remote Control
session with a Windows NT system that contains more than one network
adapter. These multihomed systems add a certain degree of complexity to
the process required to establish a remote control session.
<P>
Please note that Microsoft is working to develop solutions to the variety
of issues that result from the added complexity of multihomed systems. In
some cases, hotfixes have been developed to resolve these issues. The
workarounds described in this article should be tried as a last resort.
<P>
On multihomed systems, it is not uncommon for the Systems Management Server
Remote Control agent to "listen" on a IP address that is different from the
IP address that was reported in the Systems Management Server inventory.
When this occurs, an attempt to establish a remote control session may fail
with the following message:
<P>
<PRE>   Unable to locate &lt;machine name&gt;.

</PRE>To establish any remote control session, it is necessary for the Remote
Control agent (Wuser32.exe) to listen on one of the "network paths" that
the Systems Management Server Administrator program will attempt to use. To
achieve this, you can either make changes to the way the Remote Control
agent functions (client side) or make changes in the way that the
Administrator program locates the client (administrator side).
<P>
The actual change that you should make depends on the network environment
and the configuration of the client you are attempting to remote control.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around these problems, try any one of the following (each
workaround is described in more detail below):

<UL><LI>Apply Systems Management Server 1.2 Service Pack 3.

<LI>Configure the Remote Control agent to use a NetBIOS session.

<LI>Manually override the IP address reported by the Systems Management
   Server inventory.
<P>
</UL><h3>Apply Systems Management Server 1.2 Service Pack 3</h3>
 
<P>
Systems Management Server 1.2 Service Pack 3 contains an enhancement that
allows the Administrator program to perform NetBIOS name resolution to
locate the Systems Management Server client if the IP address in the
Systems Management Server database fails to locate the client successfully.
Try installing the service back before attempting the other workarounds.
<P>
In a situation where the IP address in the database fails to successfully
establish a remote control session, the Administrator program will query on
the NetBIOS name registered by the Remote Control agent. This name appears
as "machine name &lt;43h&gt;" in the WINS database.
<P>
To gain this functionality, you must run the service pack setup on the same
system that is running the Administrator utility. Doing this updates the
Systems Management Server Administrator program on that system.
<P>
<P><h3>Configure the Remote Control Agent to Use a NetBIOS Session</h3>
 
<P>
By default, the Remote Control agent is configured to use IP sockets for a
remote control session. You can use the Administrator program to configure
this site-wide setting. To view these settings, open the Site Properties
window, click Clients, and then click Options.
<P>
NOTE: You must upgrade the Systems Management Server client on computers
running Windows NT to propagate any changes made to the Remote
Troubleshooting Options screen. You can do this by running Upgrade.bat from
the SMS_SHR share on a Systems Management Server logon server.
<P>
It is possible to override these site-wide settings on a per-client basis
by changing a registry value on the client you are attempting to remote
control. Before changing this value, it is necessary to determine which
Lana number (a NetBIOS network path) would be suitable for a Remote Control
session.
<P>
I. View the Lana numbers defined on the client computer running Windows NT.
<P>
<PRE>   1. Open Control Panel Network.

   2. From the installed services, select the NetBIOS Interface, and then
      click Properties.

</PRE>From the list of defined Lana numbers, you may see something like "NetBT -
&gt; El90x -&gt; El90x1" defined for Lana 0. This can be interpreted as NetBIOS
encapsulated in TCP/IP over the Ethernet adapter. This is normally the most
desirable choice for a remote control session. As long as a name resolution
method (such as WINS) is being used in the network environment, this is a
reliable choice.
<P>
<PRE>   NetBT   = NetBIOS encapsulated in TCP/IP
   NwlnkNB = NetBIOS encapsulated in IPX
   NBF     = NetBIOS encapsulated in NetBEUI

</PRE>For systems that use a dial-up connection as well, other Lana numbers may
appear something like "NetBT -&gt; NdisWan4".
<P>
II. Configure the Remote Control agent to listen on a specific Lana number.
<P>
<PRE>   1. Open the Registry Editor (Regedt32.exe) and find the following
      registry key:

         HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SMS\Client Services
         \Remote Control\Parameters

   2. Change the "CommandLine" value from "-IP" (IP Sockets) to "-L0" (Lana
      0). To permanently override the site-wide setting, set the "Override
      Site CommandLine" value under the Remote Control key to a value of
      "1" as well. This ensures that the CommandLine value is not
      overwritten if the Systems Management Server client components are
      ever upgraded.

</PRE>NOTE: Another option would be to set the CommandLine value to "-IPX". This
forces a remote control to occur over NWLink IPX/SPX Compatible Transport.
<P>
<P><h3>Manually Override the IP Address Reported by the SMS Inventory</h3>
 
<P>
In some situations where it is absolutely necessary to establish a remote
control session over IP sockets, it is possible to replace the IP address
normally inventoried by Systems Management Server with the one that the
remote control agent is listening on.
<P>
I. Determine which IP address the Remote Control agent is listening on.
<P>
<PRE>   1. At the Systems Management Server client, start the Help Desk Options
      utility. You will see the following message at the bottom of the
      window:

         WUSER is listening on TCP/IP address xxx.xxx.xxx.xxx

   2. Verify that this is NOT the IP address that is recorded in the
      Systems Management Server database for this client. If it is, no
      further action is required.

   3. Cut and paste the following text into a Notepad text file. The file
      should begin with the "Start Component" statement on the first line
      and end with "End Component" on the last line.

         Start Component
            Name = "Machine"
            Start Group
               Name = "Network"
               ID = 1
               Class = "MICROSOFT|NETWORK|1.0"
               Start Attribute
                  Name = "Network Active"
                  ID = 1
                  Access = READ-ONLY
                  Storage = SPECIFIC
                  Type = Int
                  Value = 1
               End Attribute
               Start Attribute
                  Name = "Major Version"
                  ID = 2
                  Access = READ-ONLY
                  Storage = COMMON
                  Type = Int
                  Value = 3
               End Attribute
               Start Attribute
                  Name = "Minor Version"
                  ID = 3
                  Access = READ-ONLY
                  Storage = COMMON
                  Type = Int
                  Value = 5
               End Attribute
               Start Attribute
                  Name = "Network Type"
                  ID = 4
                  Access = READ-ONLY
                  Storage = COMMON
                  Type = String(64)
                  Value = "Microsoft Windows Network"
               End Attribute
               Start Attribute
                  Name = "IPX Address"
                  ID = 5
                  Access = READ-ONLY
                  Storage = SPECIFIC
                  Type = String(24)
                  Value = "[IPX address]"
               End Attribute
               Start Attribute
                  Name = "IP Address"
                  ID = 6
                  Access = READ-ONLY
                  Storage = SPECIFIC
                  Type = String(20)
                  Value = "[IP address]"
               End Attribute
               Start Attribute
                  Name = "Subnet Mask"
                  ID = 7
                  Access = READ-ONLY
                  Storage = COMMON
                  Type = String(16)
                  Value = "[subnet mask]"
               End Attribute
               Start Attribute
                  Name = "Default Gateway"
                  ID = 8
                  Access = READ-ONLY
                  Storage = COMMON
                  Type = String(16)
                  Value = "[default gateway]"
               End Attribute
               Start Attribute
                  Name = "DNS Machine Name"
                  ID = 9
                  Access = READ-ONLY
                  Storage = COMMON
                  Type = String(128)
                  Value = "[DNS name]"
               End Attribute
               Start Attribute
                  Name = "LogOn Name"
                  ID = 10
                  Access = READ-ONLY
                  Storage = COMMON
                  Type = String(48)
                  Value = "[logon name]"
               End Attribute
            End Group
         End Component

   4. Enter the correct values for all of the attributes. Remove all the
      brackets from inside the double quotation marks. For example, the IP
      Address value should look something like:

         Value = "123.45.67.89"

      NOTE: If any of the defined attributes are removed from this file,
      its corresponding value in the Systems Management Server database
      will appear as "null".

   5. Save the file with the name Network.mif (the name is flexible, but it
      must end with a .mif extension).

   6. Copy the Network.mif file to the Ms\Sms\Noidmifs directory on the
      client computer.

</PRE>The next time this server is inventoried, this Noidmif file will be
appended to its normal inventory and will override the IP address that is
normally collected. This should allow a remote control session to be
established.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
version 1.2. This problem has been corrected in the latest U.S. Service
Pack for Systems Management Server version 1.2. For information on
obtaining the Service Pack, query on the following word in the Microsoft
Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms multi-homed r/c multihome<BR>
Keywords          : kbbug1.20 smsremtshoot kbfix1.20.sp3 kbnetwork<BR>
Version           : WINNT:1.2<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
