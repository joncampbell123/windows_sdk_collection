

<HTML>
<HEAD>
<TITLE>Deleting Computers Fails With Out Of Locks Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153368">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1996/07/08">
<META NAME="Keywords" CONTENT="smsadmin smsconfig smsdatabase smsgeneral kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  Deleting a large number of computers from the SMS Administrator fails with  out of locks  errors. No computers are deleted, and the following error is displayed in a popup:     Couldn't delete all the items.     Error attempting to delete the reque...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QBCT,QAGC,QAGB,QDKD,QAAP,QAB4,QABT,QAKP,QAJ6,QAA8,QABM,QAY2,QAK7,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Deleting Computers Fails With Out Of Locks Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153368</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server versions 1.0, 1.1 and 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Deleting a large number of computers from the SMS Administrator fails with
"out of locks" errors. No computers are deleted, and the following error is
displayed in a popup:
<P>
<PRE>   Couldn't delete all the items.

   Error attempting to delete the requested items. Items have been removed
   from the query result list but not necessarily from the database.
   Refresh the data to ensure the result is correct.

</PRE>The following error is displayed in the SQL messages window:
<P>
<PRE>   &gt;&gt;Msg&gt;&gt; SQL Server has run out of LOCKS. Re-run your command when there
   are fewer active users, or ask your System Administrator reconfigure SQL
    Server with more LOCKS.
   &gt;&gt;Msg&gt;&gt; The rollback transaction request has no corresponding BEGIN
   TRANSACTION.

</PRE>CAUSE
 
<P>
All the computers in the query window get locked during a delete. Each lock
uses 32 bytes, which at 10,000 locks will use up 320,000 bytes, which are
then unavailable for caching the database.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The workaround for this problem with SMS 1.1 is adding more locks in SQL
Server. If there is a one-time delete of a large number of computers, locks
can be increased for the delete and reduced later.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Systems Management Server
version 1.0 and 1.1. This problem has been improved with Systems Management
Server version 1.2.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms<BR>
Keywords          : smsadmin smsconfig smsdatabase smsgeneral kbfixlist<BR>
Version           : 1.0 1.1 1.2<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
