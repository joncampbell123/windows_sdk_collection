

<HTML>
<HEAD>
<TITLE>SMSINST: Access Violation When Adding a Large Number of Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166733">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/04/10">
<META NAME="Keywords" CONTENT="kbbug1.00 smsinst">
<META NAME="KBArea" CONTENT="Support; KB; sms">
<META NAME="Description" CONTENT="  If you use the Systems Management Server Installer 1.0 Repackage option from the Installation Expert, you may receive an access violation (AV) error when you click Finish. Additionally, attempting to use the Application Files, Installation Files di...">
<META NAME="Product" CONTENT="Systems Management Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAA1,QDI2,QAG5,QAFI,QBXB,QATJ,QAPN,QBJZ,QAKC,QAH7,QBC6,QAVX,QAVW,QBJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMSINST: Access Violation When Adding a Large Number of Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166733</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Systems Management Server Installer version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the Systems Management Server Installer 1.0 Repackage option
from the Installation Expert, you may receive an access violation (AV)
error when you click Finish. Additionally, attempting to use the
Application Files, Installation Files dialog box from the Installation
Expert to add the contents of a directory containing more than 5,885 files
will produce the following message :
<P>
<PRE>   You cannot add any more items. Please delete items before trying to
   add any new items.

</PRE><h2>CAUSE</h2>
 
<P>
During a repackage where a large number of files are added, Systems
Management Server Installer attempts to create the Install File(s) script
action for each and every file detected. There is a finite limit to the
number of Install File(s) script actions that can be added by a repackage
at any one time. This is currently limited to approximately 5,885 Install
File(s) script actions added by a repackage. Similarly, attempting to add
the contents of a directory containing a large number of files from the
Installation Expert is limited to 5,885 files.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The workaround provided in this section assumes that you have familiarized
yourself with Systems Management Server Installer scripting, to add
appropriate script actions.

<OL><P><LI>Install the proposed application on another computer to know the number
   of files the application installs.

<P><LI>Record the full paths to directories where more than 5,885 files will be
   created. (for example, d:\Bigapp\bin)

<P><LI>When selecting the Repackage option on the reference computer, click
   Change, to modify the "Files to ignore" option for the repackage.

<P><LI>Type paths to directories to scan as required, by clicking Add in the
   "Directories to Scan" section of the Repackage Advanced Settings dialog
   box.

<P><LI>Click Add in the "Files to ignore" section and then type the full path
   recorded earlier to the directory that will contain the large number of
   files, including a file wildcard (such as d:\Bigapp\Bin\*.*). The
   dialog box will allow you to type paths that do not currently exist,
   along with file wildcards if required.
<P>
   This allows directories that will contain certain file types to be
   ignored, or all files in a particular directory to be ignored. You can
   add multiple directory paths by repeatedly clicking Add and typing each
   path and file specifier to be ignored.

<P><LI>When you are finished selecting files to ignore, Click OK to close the
   Repackage Advanced Options dialog box.

<P><LI>Enter the repackage options as normal (Installation Program, Command
   Line Options and so on) and then click Next.
<P>
   The Systems Management Server Installer will scan directories and the
   registry and then start the application setup program. After the
   repackage is complete, clicking Finish should no longer cause Systems
   Management Server Installer to generate an AV, and return you to the
   Installation Expert.

<P><LI>On the File menu, click Save or Save As to save the script.

<P><LI>To now include the files that were ignored during the repackage, change
   the Systems Management Server Installer view from Installation Expert to
   the Script Editor (on the View menu, click Script Editor).

<P><LI>Examine the script for Install File script actions where other files
   during the repackage have been selected. These are typically added after
   the "Include Script %_SMSINSTL_%\INCLUDE\uninstal.ipf" Include Script
   action.

<P><LI>Add an Install File(s) script action below the Include Script script
   action, using the source the path to the previously excluded files,
   along with file wildcard (*,?) specifiers where possible. For example,
   for the earlier example, the d:\Bigapp\bin directory had all its files
   ignored, so you would type the following as the Source for an Install
   File(s) script action:
<P>
<P><PRE>      d:\Bigapp\bin\*.*
</PRE>
<P><LI>If wildcards were used in the Source entry, type %MAINDIR% as the only
   entry in the Destination field.

<P><LI>Complete other entries in the Install File(s) dialog box as necessary
   and click OK.

<P><LI>Add further Install File(s) script actions if required or change back
   to the Installation Expert from the View menu.
<P>
   At this point, you may want to save the script under another file name,
   to allow testing with the new script.

<P><LI>Use the Test option to test the script as appropriate. To ensure
   conclusive results, test the compiled Systems Management Server
   Installer executable file on a computer that did not previously have a
   copy of the application.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Systems Management
Server Installer version 1.0. We are researching this problem and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To keep scripts small and concise, it is recommended that you review
scripts that are created by using the Repackage option. For example, it is
possible to replace many hundreds of lines containing Install File(s)
script actions that install single files with a single line using the *.*
wildcard.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodsms wild card<BR>
Keywords          : kbbug1.00 smsinst<BR>
Version           : WINNT:1.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
