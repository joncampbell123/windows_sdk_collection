

<HTML>
<HEAD>
<TITLE>PRB: Random ASP 0115 Errors when Submitting Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173741">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/09/11">
<META NAME="Keywords" CONTENT="VIASP kbcode">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  The following error occurs randomly when submitting a HTML form:     error 'ASP 0115'     Unexpected error     /          /               .asp     A trappable error occurred in an external object. The script cannot    continue running.  Again, the ...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAAP,QAB4,QAYL,QAPN,QBWA,QAH4,QAUJ,QBQU,QALZ,QBW7,QAI5,QAO4,QAMB,QAGE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Random ASP 0115 Errors when Submitting Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173741</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
<LI>Microsoft Active Server Pages, versions 1.0, 1.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error occurs randomly when submitting a HTML form:
<P>
<PRE>   error 'ASP 0115'

   Unexpected error

   /&lt;web name&gt;/&lt;asp file name&gt;.asp

   A trappable error occurred in an external object. The script cannot
   continue running.

</PRE>Again, the error occurs randomly.
<P>
<P><h2>CAUSE</h2>
 
<P>
The following conditions cause the error to occur:

<OL><P><LI>The elements of the submitting form are not named. For example, &lt;input
   type="Text"&gt; instead of &lt;input type="Text" name="textinput"&gt;.

<P><LI>The form must have a "Input" or "Select" element. In other words, the
   form must pass values associated with the "Input" or "Select" tags to
   the server.

<P><LI>You have code that accesses the Forms Collection from a second Active
   Server Pages (ASP) page. For example, the "Action" parameter of the
   "Form" tag points to an .asp file other than itself. And the code
   accesses the forms collection via 'Request.Forms("var")'. NOTE: at this
   time we have been unable to reproduce the error when the "Action"
   parameter points to itself -- the .asp file in which the form is
   defined.

<P><LI>You have code that accesses memory; as in, 'Session("variable")=value'.
   This condition is very touchy, sometimes just changing the name of the
   variable will remove the symptoms.
<P>
</OL><h2>RESOLUTION</h2>
 
<P>
Name each element--including the form itself--in the form.
<P>
-or-
<P>
Change the name of the variable, see condition 4 in the CAUSE section
above.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a Virtual Root (or project in VID).

<P><LI>Add the two files below to the project.

<P><LI>Preview the "Testvb.asp" in a browser.

<P><LI>Repeatedly (anywhere from 1-20 times) click OK until the error occurs.
<P>
<P><PRE>      =======frmsubmit.asp================
      &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
</PRE><P>
<P><PRE>      &lt;HTML&gt;
</PRE><P>
<P><PRE>      &lt;BODY&gt;
</PRE><P>
<P><PRE>      &lt;form action="calendarcase.asp" method="POST"&gt;
</PRE><P>
<PRE>         &lt;input type="text" name="Month2" size="1"&gt;
         &lt;input type="submit" value="OK" &gt;

      &lt;/form&gt;

      &lt;/BODY&gt;
      &lt;/HTML&gt;
      =========end frmsubmit.asp============

      ========frmaction.asp==============

      &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

      &lt;%
       'Access the forms collection
       mo=Request.Form("Month")

      'The below code -- setting the session variable -- is also necessary.
</PRE></OL>I     ' suspect setting the session variable below just accesses the
<PRE>      'corrupted forms collection memory and causes the error.
      Session("SelectedMonthNumber") = "1"

      response.redirect "testvb.asp"
      %&gt;

      =========end frmaction.asp======================

</PRE><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : VIASP kbcode
Technology        : kbInetDev
Version           : WINDOWS:1.0; WINNT:1.0,1.0b
Platform          : WINDOWS winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
