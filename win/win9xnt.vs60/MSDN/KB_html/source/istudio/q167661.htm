

<HTML>
<HEAD>
<TITLE>PRB: Visual InterDev Cannot Connect to PWS or Share </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167661">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/04/28">
<META NAME="Keywords" CONTENT="VIMisc VIProject VIServer kbtool kbprb">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  When using Personal Web Server (for Windows 95) or Peer Web Services (for Windows NT 4.0 Workstation) on a computer that does not have an active network connection, Visual InterDev may be unable to access documents shared using HTTP or FTP.  NOTE: ...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDH5,QBWD,QDJE,QBVX,QBWP,QAVZ,QAI5,QAUJ,QA56,QA55,QDN1,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual InterDev Cannot Connect to PWS or Share</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167661</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using Personal Web Server (for Windows 95) or Peer Web Services (for
Windows NT 4.0 Workstation) on a computer that does not have an active
network connection, Visual InterDev may be unable to access documents
shared using HTTP or FTP.
<P>
NOTE: When referring to both Personal Web Server and Peer Web Services
throughout this article, the term "Web Server" will be used; if a
distinction is needed, then their respective names will be used.
<P>
Typical scenarios when using Visual InterDev are as follows:

<UL><LI>When attempting to create a web project, Visual InterDev is unable to
   locate the server and returns the error message:
<P>
<P><PRE>      Unable to connect to the server (HTTP Error 500)
</PRE>
<LI>When attempting to use the Sample Application Wizard to create a sample
   project, Visual InterDev prompts the user (step 4 of 5) for a valid UNC
   path ("\\yourmachinename\sharename") for a shared directory in which to
   copy the database file. Visual InterDev is unable to locate the shared
   directory and returns the error message:
<P>
<P><PRE>      \\machinename\sharename does not exist or is read only, please enter
      a new \\server\share
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
As noted in the documentation for both Personal Web Server (Windows 95) and
Peer Web Services (Windows NT 4.0 Workstation), the Web Server needs to
have an active connection to the Internet to enable Domain Name Resolution.
If the computer does not have an active connection to the Internet, it must
be connected to an Internet Service Provider (ISP) by using Dial-Up
Networking.
<P>
When Visual InterDev tries to connect to the Web Server using the local
computer name, the TCP/IP stack is initialized and attempts to find the
computer name. However, it is unable to find the computer name because
there is no DNS or WINS service to resolve the Host name to an IP address.
Host names are used in virtually all TCP/IP environments and always
correspond to an IP address that is stored in a HOSTS file or on a DNS or a
WINS server.
<P>
RESOLUTION
 
<P>
NOTE: The following workarounds will not work in all cases due to the
complexity and possible variations in Network configurations for any given
machine. Therefore, consult the appropriate documentation for your
operating system or your Network Administrator or contact Windows 95
Networking customer support.
<P>
Possible workarounds are listed below.
<P>
<P><h3>Workaround 1</h3>
 
<P>
Because the Web Server requires an active network connection, one solution
is to connect to an Internet Service Provider (ISP) before attempting to
view documents shared on the Web Server. This resolves the problem because
the ISP provides the Domain Name Resolution service that the Web Server
requires.
<P>
<P><h3>Workaround 2</h3>
 
<P>
If Microsoft Internet Explorer version 3.01 or later is being used, connect
to <B>http://localhost.</B> This initializes the TCP/IP stack and connects the
browser to the home page on the local computer. The browser will then be
able to access documents shared on the Web Server using the computer name
instead of "localhost." If Internet Explorer is closed, the above steps
must be repeated to access documents shared on the Web Server.
<P>
<P><h3>Workaround 3</h3>
 
<P>
Use the HOSTS file to resolve the local machine name to the default IP
Loopback address (127.0.0.1). The HOSTS file is used as a local Domain Name
System (DNS) equivalent to resolve host names to IP addresses. The
"Hosts.sam" file, located in the Windows directory (or the
WinNT\System32\Drivers\Etc directory for Windows NT Workstation and NT
Server), shows an example of the entries that need to be made and can be
used as a template. To edit the "Hosts.sam" file, open it in Notepad and
replace word "Localhost" with the local machine's name. Because entries are
case-sensitive, it is a good idea to assign multiple host names with
different cases using the same IP address. Assuming the local machine's
name is "Nikichan," an example of the edited "Hosts.sam" file is listed
below.
<P>
After editing the HOSTS file, save it as "Hosts.txt" (by default, Notepad
appends the .txt extension to all files that it saves, including file names
without an extension), and then rename it to "Hosts" without the .txt file
extension using the Windows Explorer. (To confirm that it is an extension-
less file, go into click Options from the View menu, select the "Show all
files" option, and deselect "Hide file extensions for known file types.")
Reboot the machine so changes will take effect and load the HOSTS file into
memory. Visual InterDev should now be able to access documents on Personal
Web Server and documents in shared directories.
<P>
<PRE>   ======================= Example Hosts.sam =====================

   # Copyright (c) 1994 Microsoft Corp.
   #
   # This is a sample HOSTS file used by Microsoft TCP/IP for Chicago
   #
   # This file contains the mappings of IP addresses to host names. Each
   # entry should be kept on an individual line. The IP address should
   # be placed in the first column followed by the corresponding host name.
   # The IP address and the host name should be separated by at least one
   # space.
   #
   # Additionally, comments (such as these) may be inserted on individual
   # lines or following the machine name denoted by a '#' symbol.
   #
   # For example:
   #
   #      102.54.94.97     rhino.acme.com          # source server
   #       38.25.63.10     x.acme.com              # x client host

   127.0.0.1   Nikichan
   127.0.0.1   nikichan
   ================================================================

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The information in this article also applies to the following:

<UL><LI>Microsoft Personal Web Server version 1.0a for Windows 95.

<LI>Microsoft Peer Web Services version for Windows NT Workstation.

<LI>Internet Explorer: Version 3.01 (build 4.70.1215) or later.
<P>
</UL>This article assumes that Visual InterDev and either Personal Web Server on
Windows 95 or Peer Web Services on Windows NT 4.0 Workstation have already
been successfully installed.
<P>
If Visual InterDev is still unable to connect to the Web server after
following the steps outlined in Workaround 3 above, check the following
configuration settings for Windows 95 and change them as necessary. (For
Windows NT Workstation, see the Windows NT Workstation documentation on how
to configure these settings):

<OL><P><LI>Go into the Control Panel and double-click Networks.

<P><LI>Click the Identification tab, and ensure that Computer Name is the same
   as the local machine name used in the HOSTS file.

<P><LI>Click the Access tab, and ensure that "share-level access control" is
   selected.

<P><LI>Click the Configuration tab, select TCP/IP, and then click Properties.

<P><LI>Select "Bindings," and ensure that Personal Web Server is bound to
   TCP/IP.

<P><LI>Select "DNS Configuration," and ensure that "Disable DNS" is selected.

<P><LI>Select "WINS Configuration" and change the default setting from "Use
   DHCP for WINS Resolution" to "Disable WINS Resolution."

<P><LI>Reboot, and then try to connect Visual InterDev to Personal Web Server.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q150575.htm">Q150575</A></B>
   TITLE     : How to Set Up a TCP/IP Peer-to-Peer Network Connection

   ARTICLE-ID: <B><A href="../ie_app/q158721.htm">Q158721</A></B>
   TITLE     : How to Configure and Administer Personal Web Server

   ARTICLE-ID: <B><A href="../ie_app/q158366.htm">Q158366</A></B>
   TITLE     : Web Services May Be Stopped When Web Server is Running

   ARTICLE-ID: <B><A href="../ie_app/q158260.htm">Q158260</A></B>
   TITLE     : Cannot Access Personal Web Server Documents

</PRE></OL>For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : VIMisc VIProject VIServer kbtool kbprb
Technology        : kbInetDev
Version           : 1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
