

<HTML>
<HEAD>
<TITLE>PRB: "Unclosed Quote" Error when Calling Oracle Stored Procedure </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175090">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/14">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  The following error occurs when previewing an Active Server Pages (ASP) page that calls an Oracle stored procedure:     Microsoft OLE DB Provider for ODBC Drivers error '80040e14'     [Microsoft][ODBC SQL Server Driver][SQL Server]Unclosed quote be...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QBVR,QA7O,QAOE,QAMN,QAB5,QBV8,QAYY,QAGI,QAAP,QA94,QATX,QAB4,QABH,QBV3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Unclosed Quote" Error when Calling Oracle Stored Procedure</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175090</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error occurs when previewing an Active Server Pages (ASP)
page that calls an Oracle stored procedure:
<P>
<PRE>   Microsoft OLE DB Provider for ODBC Drivers error '80040e14'

   [Microsoft][ODBC SQL Server Driver][SQL Server]Unclosed quote before the
   character string ' '.

   &lt;asp file name and line number&gt;

</PRE><h2>CAUSE</h2>
 
<P>
The conditions that cause this error are as follows:

<OL><P><LI>Making a call to an Oracle stored procedure.

<P><LI>Using the Data Command Control to insert the ActiveX Data Objects
   (ADO) code that accesses the stored procedure.

<P><LI>Editing and closing the Data Command Control at least once after
   initially inserting the control.

<P><LI>Choosing the stored procedure name from the Command Text drop-down list
   box in the Data Command's property sheet.
<P>
</OL>The Data Command Control incorrectly parses the Command Text being assigned
to the cmdText object. The second time the DataCommand Control is opened it
parses the sting as follows:
<P>
<PRE>   cmdTemp.CommandText = 'dbo.''my_stored_proc'''

</PRE></OL>Which should be the following:
<P>
<PRE>   cmdTemp.CommandText = 'dbo.my_stored_proc'

</PRE><h2>RESOLUTION</h2>
 

<OL><P><LI>Open the Data Command Control.

<P><LI>Manually enter your stored procedure name (for example,
   "my_stored_proc") in the Command Text property box.

<P><LI>Close the control and preview the page.

<P><LI>It works. If you open the control again and close it, it still works.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open or create a Visual InterDev project.

<P><LI>Add a data connection to an Oracle database.

<P><LI>Add a new ASP page to the project.

<P><LI>Insert a Data Command Control.

<P><LI>Choose the data connection created in step 2 above from the Data
   Connection drop-down list box.

<P><LI>Choose "Stored Procedure" from the "Command Type" drop-down list box.

<P><LI>Choose one of the stored procedures available to your database from the
   Command Text drop-down list box.

<P><LI>Save and preview the ASP file.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : kberrmsg
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
