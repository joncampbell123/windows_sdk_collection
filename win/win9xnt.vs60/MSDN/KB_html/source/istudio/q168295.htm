

<HTML>
<HEAD>
<TITLE>FIX: Updating Single Row Replaces Data in All Rows of a Cursor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168295">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/05/08">
<META NAME="Keywords" CONTENT="VS97FixlistSP3 kbother VS97FixlistSP2 VS97FixlistSP1">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  When you change the value of a single column and single row in a cursor, the update replaces all rows of the cursor with the new value. This issue arises when you use a two-table cursor and one of the tables has a compound key index.  CAUSE =====  ...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABD,QABE,QAE1,QA5V,QDMN,QAUJ,QAO2,QADX,QDO3,QABI,QBWS,QA56,QA55,QAXB,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Updating Single Row Replaces Data in All Rows of a Cursor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168295</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you change the value of a single column and single row in a cursor,
the update replaces all rows of the cursor with the new value. This issue
arises when you use a two-table cursor and one of the tables has a compound
key index.
<P>
<P><h2>CAUSE</h2>
 
<P>
The cursor does not output all table columns used in the definition of the
table's compound key.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Make sure all columns in a compound key are included in a cursor.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Visual
Studio 97, Service Pack 1.
<P>
For additional information about the Visual Studio 97 Service Pack 1,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open/Create Web project.

<P><LI>Add data connection to SQL database (pubs for this example).

<P><LI>Create a new table named "Test1".

<P><LI>Add two columns to the Test1 table, one column named "cText" and the
   other named "nID". Both fields should not allow nulls and be of type
   char,10 and int,4 respectively.

<P><LI>Create a Primary key based on both the cText and nID columns by
   selecting both column names with the mouse while holding down the CTRL
   key and choosing the key icon from the "Table" toolbar. A key icon
   should appear next to both column names.

<P><LI>Save and close the table design window.

<P><LI>Create a second table named "Test2".

<P><LI>Add one column named "cText".

<P><LI>Uncheck "Allow Nulls" and make the cText column the primary key.

<P><LI>Save and close the table design window.

<P><LI>Add the following data to the Test1 table:
<P>
<PRE>      cText    nID
      test      1
      test2     2
      test3     3
      test4     2
      test5     2

</PRE><P><LI>Add the following data to the Test2 table:
<P>
<P><PRE>      cText
      test
      test2
      test3
      test4
      test5
</PRE>
<P><LI>Double-click the Test1 table to bring up the Query Designer. Open all
   four of the panes ("Diagram Pane", "Grid Pane', "SQL Pane", and the
   "Results Pane") in the Query Designer from the "Query" toolbar.

<P><LI>Type the following SQL into the "SQL Pane":
<P>
<PRE>      SELECT      Test2.cText, Test1.nID
      FROM         Test2 INNER JOIN Test1 ON Test1.cText= Test2.cText

</PRE><P><LI>Run the query.

<P><LI>In the "Results Pane," change one of the "2"'s in the nID column to
   a "5".

<P><LI>Run the query.
<P>
</OL>Result: All of the rows that had a "2" now have a "5," even though you only
updated one of the rows.
<P>
NOTE: The following select is the root of the problem, because it contains
only one column (Test1.nID) of a compound (two or more column) key index in
the output field list.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : VS97FixlistSP3 kbother VS97FixlistSP2 VS97FixlistSP1
Version           : 1.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
