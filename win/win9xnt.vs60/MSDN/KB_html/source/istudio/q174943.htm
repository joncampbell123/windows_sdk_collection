

<HTML>
<HEAD>
<TITLE>PRB: 80004005 "Couldn't Use '(unknown)'; File Already in Use" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174943">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/09">
<META NAME="Keywords" CONTENT="VIMisc kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  An Active Server Pages (ASP) page returns the error:     Microsoft OLE DB Provider for ODBC Drivers error '80004005'    [Microsoft][ODBC Microsoft Access 97 Driver] Couldn't use '(unknown)';    file already in use.  This error can occur when the da...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBG2,QBWG,QBW7,QAZV,QBWA,QA1S,QAAP,QAB4,QAK7,QBVX,QBWP,QA56,QA55,QA3A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 80004005 "Couldn't Use '(unknown)'; File Already in Use"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174943</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
<LI>ActiveX Data Objects (ADO)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An Active Server Pages (ASP) page returns the error:
<P>
<PRE>   Microsoft OLE DB Provider for ODBC Drivers error '80004005'
   [Microsoft][ODBC Microsoft Access 97 Driver] Couldn't use '(unknown)';
   file already in use.

</PRE>This error can occur when the database is open in Access, or when a Visual
InterDev project is open that contains a data connection to the database.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is a Windows NT permissions problem. The account that is accessing the
page doesn't have sufficient permissions to lock the database. The account
would be either the anonymous account (by default the IUSR_&lt;machinename&gt;)
or a specific user account if the page has been secured for authenticated
access.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If the page is meant to be accessed anonymously, give the
IUSR_&lt;machinename&gt; account full control to the ASP page, and the folder and
files where the database is located. Additionally, if the path to the
database is being referenced using UNC (\\Server\Share), ensure that the
Share Permissions allow the IUSR_&lt;machinename&gt; account full access. This
step applies even if the share is on the local Web server.
<P>
If the page has been secured such that the IUSR_&lt;machinename&gt; can't access
the file or database, then ensure that the user's account that is being
authenticated has full control to the appropriate folders and files.
<P>
At a minimum, the account being used needs Create, Destroy, Read, Write to
work with the .ldb file. Specific permission can be applied to the database
to limit access.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A quick way of ensuring any particular error is a permissions issue is to
add the IUSR_&lt;machinename&gt; account to the Administrators group. If this
fixes the error, then it is a matter of ensuring that the user account
being used has sufficient permissions. Ensure that you remove the
IUSR_&lt;machinename&gt; account from the Administrators group when finished
testing.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : VIMisc kberrmsg
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
