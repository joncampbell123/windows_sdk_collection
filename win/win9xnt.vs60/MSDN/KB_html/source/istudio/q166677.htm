

<HTML>
<HEAD>
<TITLE>BUG: Extra Line Feeds Added when Moving File Between Folders </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166677">
<META NAME="KBModify" CONTENT="1997/12/09">
<META NAME="KBCreate" CONTENT="1997/04/09">
<META NAME="Keywords" CONTENT="VIScripting kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  Sometimes when a file containing at least one relative URL is moved into a folder that changes the reference to the linked file, an extra line feed is added to all scripts (whether contained within         ...          tags or within         delimi...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9N,QDNQ,QBWA,QAHT,QAFI,QANJ,QACI,QAVX,QAVW,QAEF,QBXT,QA5V,QAIB,QBXB,QBDA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Extra Line Feeds Added when Moving File Between Folders</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166677</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Sometimes when a file containing at least one relative URL is moved into a
folder that changes the reference to the linked file, an extra line feed is
added to all scripts (whether contained within &lt;SCRIPT&gt;...&lt;/SCRIPT&gt; tags or
within &lt;%...%&gt; delimiters) and comment blocks (enclosed with &lt;!--...--&gt;).
<P>
<P><h2>CAUSE</h2>
 
<P>
When Link Repair is turned on, FrontPage Extensions look for relative URLs
in the file. If found, they modify the URL as necessary to ensure that the
linked files remain valid when called from the new directory. FrontPage
Extensions may also attempt to insert missing HTML in the file. When this
routine runs, it adds an extra line feed when it encounters server-side
scripts.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Turn off Link Repair or use absolute references to linked files.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Be sure Link Repair is enabled for the project (refer to the Properties
   page for the Project).

<P><LI>Be sure your Project has at least one subdirectory, for example,
   /images.

<P><LI>Create an .asp file with the following contents (you don't need a real
   .jpg file, just a relative reference):
<P>
<P><PRE>      &lt;%
      Response.Write "test"
      Response.Write "test2"
      %&gt;
      &lt;img src="images/test.jpg"&gt;
</PRE>
<P><LI>Copy this example to your Clipboard for reuse below.

<P><LI>Release Working Copy for this .asp file and save to the root directory
   when prompted.

<P><LI>Move the file into the images directory.

<P><LI>Open the file. You are prompted with a message box that says, "Lines
   ending with only a carriage return have been detected. These will be
   modified to include a line feed."

<P><LI>The file looks something like this:
<P>
<P><PRE>      &lt;%
</PRE><P>
<P><PRE>      Response.Write "test"
</PRE><P>
<P><PRE>      Response.Write "test2"
</PRE><P>
<P><PRE>      %&gt;&lt;html&gt;
</PRE><P>
<P><PRE>      &lt;body&gt;
</PRE><P>
<P><PRE>      &lt;p&gt;&lt;img src="../images/test.jpg"&gt; &lt;/p&gt;
      &lt;/body&gt;
      &lt;/html&gt;
</PRE><P>
   Visual InterDev has added syntax to make a legal HTML file. In the
   process it has added extra lines in the source ASP code and around the
   first two HTML tags.

<P><LI>Release the Working Copy of this file, then move it back to the root
   directory. Open the file and replace its contents with the contents on
   your Clipboard. You should now be in your original state.

<P><LI>Remove the IMG tag so there is no URL in your file or make the relative
   address absolute by placing a "/" before "images." Release the Working
   Copy and save as before.

<P><LI>Move the file to the images directory again, and open it. This time
   nothing has changed because there is no relative URL in the file.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : VIScripting kbprg kbbuglist
Version           : 1.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
