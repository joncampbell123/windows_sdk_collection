

<HTML>
<HEAD>
<TITLE>PRB: Visual InterDev Source Control Files Checked Out Wrong </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175586">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/10/23">
<META NAME="Keywords" CONTENT="VIMisc">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  There are several symptoms of this problem, two of the most common are listed below:   - When a user checks out a file from a Visual InterDev project that has    been placed under source control, the SourceSafe Explorer tool shows    that the file ...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QAVZ,QAGU,QAEF,QABO,QBG2,QA56,QA55,QBWG,QAI5,QAJQ,QAVV,QAB5,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Visual InterDev Source Control Files Checked Out Wrong</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175586</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
There are several symptoms of this problem, two of the most common are
listed below:

<UL><LI>When a user checks out a file from a Visual InterDev project that has
   been placed under source control, the SourceSafe Explorer tool shows
   that the file has been checked out by the IUSR_machinename account.

<LI>Multiple users will be able to check out the same file at the same time.
   Whoever checks in the file first will succeed, but other users will not
   be able to check in the file.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problem are all caused by files being checked in and out of Visual
SourceSafe "anonymously." When Visual InterDev places a project under
source control, it works completely through the FrontPage server extension
as a kind of "proxy," which then works with SourceSafe to check in and out
the appropriate files.
<P>
Correcting this problem revolves around ensuring that the anonymous account
cannot author or administer the Web.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent the anonymous account to author and administrate a Web, ensure
the following:

<UL><LI>The Web server must be using an NTFS file partition. FrontPage server
   extensions and Visual SourceSafe rely on NTFS to set file permissions to
   control who can check in and out specific files. On a FAT partition, the
   anonymous account (by default, IUSR_&lt;machinename&gt;) will always succeed
   when checking out files.

<LI>Visual InterDev's Web Permissions may not be correctly configured. In
   Visual InterDev, select "Web Permissions from the Project menu. If the
   anonymous account appears on the Users tab, or if the anonymous account
   belongs to any group on the Groups tab with either Author or Administer
   rights, then the anonymous account will be used to check in/out files.
<P>
</UL>While the Everyone account is often in the Groups tab by default, it should
NEVER be left in. There is never a time that files should be allowed to be
checked out anonymously, as multiple anonymous check outs will cause more
serious errors. This configuration is usually the result of the hard disk
being originally formatted as a FAT drive, and later was converted to NTFS.
<P>
The Visual InterDev documentation for Visual SourceSafe also mentions
having the IUSR account entered in the Visual SourceSafe administration
tool so that you can check in and out files anonymously. While this is
technically accurate, it is a poor practice in most any environment for the
same reasons stated above.
<P>
The best practice for configuring Web permissions is to first set the
permissions on the root Web, and then have projects use either the same
permissions as the root Web, or set unique permissions when needed.
<P>
<P><h3>Setting the Web Permissions for the Root Project</h3>
 
<P>
If the root Web has never been accessed before, simply select New from the
File menu and select a new Web Project. Select the appropriate server, and
when you are prompted with the list of existing Webs, select the &lt;Root
Web&gt;. Once the Root Web is opened in the Project Workspace window, you can
choose the Project/Web Permissions menu item and specify users and groups.
<P>
If you select Web Permissions in a normal project (not the root Web) there
will be three tabs: settings, users, and groups. If you change the option
button from the default, you will lock out the tabs and not be able to
switch between them until you click the 'Apply' button. This is because
changes need to be enacted on the Web project before the user and group
tabs can be displayed.
<P>
Note what user and group NT accounts are listed for the Root Web by
default.
<P>
The Everyone account that is added to the root Web by default must be
removed! Having the Everyone group allowed access will cause files to be
checked out on the Web server by the IUSER_&lt;machinename&gt; account. This also
allows multiple individuals to check out the same file and corrupts the
Visual SourceSafe database, completely obviating the very reasons for
implementing source control.
<P>
Note that for each user or group that is added to access list, you must
choose between three levels of authority:

<UL><LI>Browse--Useful if the 'Only registered users have browse access' is
   selected.

<LI>Author and browse--This user can now add, delete and edit content, as
   well as browse.

<LI>Administer--This user can create and delete Web projects, and change
   permissions.
<P>
</UL><h3>Users</h3>
 
<P>
Add specific users to the access list. This is the preferred method. All
users should be entered explicitly in this dialog box.
<P>
<P><h3>Groups</h3>
 
<P>
These are group names that are defined in the NT User Manager for Domains
tool. For best results, ensure that none of your groups contain the
IUSR_machinename account or any account that is anonymous by nature. If the
groups you use consists of explicit NT user accounts, then they will work
fine. A common technique would be to create an NT group called
"WebAuthors," and assign users to this group in the NT User Manager. This
group can be added in Visual InterDev and given appropriate rights.
<P>
<P><h3>Changing Specific Web Project Permissions</h3>
 
<P>
Once the root Web has been correctly setup, and the Everyone account has
been removed, it is possible to successfully setup the Web permissions for
specific projects. The simplest approach is to set a project under source
control, and in Web Permission, select the "Use same permissions as root
Web" button. If it is necessary to give the project unique permissions,
select the alternate button, click Apply to unlock the tabs, and follow the
same steps as for the root Web.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : VIMisc
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
