

<HTML>
<HEAD>
<TITLE>INFO: Breakdown of Data Form Wizard Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172926">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1997/08/20">
<META NAME="Keywords" CONTENT="VIWizards">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  Microsoft Visual InterDev provides a Data Form Wizard for the generation of sample Active Server Pages (ASP) for simple data management. This article breaks down how these pages function so that users may better understand them if they wish to make...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAH4,QA7O,QAYY,QA7N,QAMB,QBWA,QDMR,QAE1,QAGI,QBVV,QAD7,QA5V,QAY5,QAIK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Breakdown of Data Form Wizard Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172926</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Visual InterDev provides a Data Form Wizard for the generation of
sample Active Server Pages (ASP) for simple data management. This article
breaks down how these pages function so that users may better understand
them if they wish to make changes to add functionality.
<P>
NOTE: Microsoft Technical Support does not directly support any changes
made to the code produced by the Data Form Wizard. Changes rendered are
considered to change the code from "Wizard" code to "User" code and are
supported as if it were a user written application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When completed, the Data Form Wizard will produce three files. These files
will be named with the following conventions:
<P>
<PRE>   xxxxForm.asp
   xxxxList.asp
   xxxxAction.asp

</PRE>xxxx represents the name given when the Data Form Wizard is selected from
the New menu command on the File menu.
<P>
All of these files follow a similar format. Each file contains a set of
initial &lt;SCRIPT&gt;&lt;/SCRIPT&gt; tags that contain the various functions and
procedures called by the page. Following this section is the body of the
document. This is the HTML code and ASP code that is then processed
sequentially.
<P>
<P><h3>xxxxFORM.ASP And xxxxLIST.ASP</h3>
 
<P>
In xxxxForm.asp (hereafter referred to as Form.asp) and xxxxList.asp
(List.asp) the body of the document contains four main sections:

<UL><LI>Heading Section
<LI>Data Range Header
<LI>Field display code
<LI>Data Range Footer
<P>
</UL>Heading Section:
<P>
The heading section is responsible for displaying the various actions that
are valid for the form. This code checks for what state the form is in and
displays the appropriate buttons. The state of the form can vary between
being in edit mode, filter mode, and display. Each button displayed is a
submit button that calls the xxxxAction.asp.
<P>
Data Range Header:
<P>
The Data Range Header (DRH) is simply code produced by the Data Range
Header design-time control. This section of code is delimited by the
following tags:
<P>
<PRE>   &lt;!--METADATA TYPE="DesignerControl" startspan

</PRE>-and-
<P>
<PRE>   &lt;!--METADATA TYPE="DesignerControl" endspan --&gt;

</PRE>To change any of this code you can right-click within this area and choose
the "Edit Design-time Control" option. Note that you can change the fields
that are included in the form here, but doing so is not sufficient to
affect changes in the rest of the form. This must be done manually. More
information on this will come later.
<P>
Some key settings to note on this design-time control:

<UL><LI>Record Paging is Enabled
<LI>Record Paging Size for Form.asp is 1, List.asp is 10
<LI>Range Type for Form.asp is Form, List.asp is Table
<LI>Both List.asp and Form.asp require that the CursorType NOT be
   ForwardOnly in order for paging to function properly.
<P>
</UL>Data Range Footer:
<P>
The Data Range Footer (DRF) is similar to the Data Range Header. Towards
the bottom of both of these documents you will find similar sections
delimited by another set of the same tags. Be careful not to mistake the
endspan tag of the DRF as the endspan of the DRH. This control is
responsible for ending the data section and displaying the navigation
buttons, which are all submit buttons that call xxxxAction.asp. When ending
the data range when the Data Range Header has a Paging Size greater than 1,
it causes the form to loop back and process any information contained
between the DRH and DRF. This is what allows the List.asp to display 10
records at a time.
<P>
Field Display Code:
<P>
This section of the document is between the DRH and the DRF. It contains
all information that is displayed on each pass through the loop established
by the DRH and DRF. In the case of the Form.asp this happens only once, and
consequently only one record is displayed.
<P>
In both the List.asp and the Form.asp this code is simply a set of calls to
a function defined at the beginning of the page: ShowField. This function
accepts four parameters. These parameters define what the name of the field
is, the description text, whether or not the field is an
Identity/Autonumber field, and finally an optional array if you wish to
display the field as a drop-down list box. In the ShowField function these
are defined as follows:
<P>
<PRE>   strFieldName, strLabel, blnIdentity, avarLookup

</PRE>strFieldName: The fields to be displayed by calling ShowField must be part
of the Recordset fetched by the DRH. This field is passed as a string and
is the exact name of the column in the Recordset.
<P>
strLabel: This is a text string representing the text that will be
displayed as a column heading in List.asp and next to the text box in
Form.asp.
<P>
blnIdentity: This is a Boolean (true/false) value indicating whether or not
the field is an autonumber or identity field. These are automatically
calculated and consequently not editable.
<P>
avarLookup: This is not accessible through the Data Form Wizard interface
and must be adjusted in the form itself. ShowField looks for a two-
dimensional array to be passed in this variable. The first column of data
in the array should be an index, while the second column contains the data
to be displayed instead of this index when editing. The form displays a
drop-down list box in place of the field so that a user may select from the
values in the second column of the array passed to ShowField.
<P>
The ShowField function examines the field passed to it and determines how
it should display it. How the field is displayed depends upon what data
type it is, and whether the form is in edit mode or not.
<P>
<P><h3>xxxxAction.asp</h3>
 
<P>
This file is responsible for processing all button presses from either the
List.asp or Form.asp. It to begins with various functions defined in the
&lt;SCRIPT&gt;&lt;/SCRIPT&gt; tags. The body of this page performs one of two basic
actions. Either it will process the command and then load one of the other
two forms, or it will display information. The information displayed will
either be a confirmation of an action you performed, or information about
an error that has occurred.
<P>
In the Action Handler section of this page, the VBScript code checks to see
which button was used to call the page, and act accordingly.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE> 
<PRE>Keywords          : VIWizards
Technology        : kbInetDev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
