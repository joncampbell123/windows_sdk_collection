

<HTML>
<HEAD>
<TITLE>BUG: ODBC Script File Does Not Act Like Stored Procedure Editor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166676">
<META NAME="KBModify" CONTENT="1997/12/09">
<META NAME="KBCreate" CONTENT="1997/04/09">
<META NAME="Keywords" CONTENT="VIODBC kbprg">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  When creating a database Stored Procedure in an ODBC Script File window via the ODBC Script File dialog box (from the File menu, select New and click the File tab), the ODBC Script File dialog box does not act like a Stored Procedure Editor dialog ...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAB9,QBWS,QA9E,QAUR,QA2Q,QAU7,QAZV,QBJZ,QAG2,QBG2,QAI5,QAYY,QBVV,QA3J V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ODBC Script File Does Not Act Like Stored Procedure Editor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166676</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When creating a database Stored Procedure in an ODBC Script File window via
the ODBC Script File dialog box (from the File menu, select New and click
the File tab), the ODBC Script File dialog box does not act like a Stored
Procedure Editor dialog box. It allows a save of the Stored Procedure only
once, failing on any successive attempts to save the Stored Procedure.
<P>
<P><h2>CAUSE</h2>
 
<P>
Visual InterDev does not parse any commands in the ODBC Script File window
to see if they are Stored Procedures, Triggers, or Views. It treats them
like regular ODBC commands and does no special work to ensure that they run
properly. However, the Stored Procedure Editor ensures that a stored
procedure saves without encountering the error saying that the Stored
Procedure already exists in the database.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, right-click on the Database Connection node in
the Data View tab of the Workspace window, and click Refresh. Expand the
connection node to see the Stored Procedures folder. Expand that folder.
Double-click the Stored Procedure created in the ODBC Script File window to
edit it.
<P>
NOTE: Another workaround is to create the Stored Procedure by selecting
Data View, right-clicking the Stored Procedures folder, selecting New
Stored Procedure, then Write Procedure. Right-click in the window and
select Run. Right-click and select Run again. No error appears.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this
bug and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Stored Procedures are saved to a database by executing the text of the
Stored Procedure as if it were an ODBC command. They are "run" by executing
the name of the Stored Procedure and adding any parameters ("call
&lt;procedure name&gt;").
<P>
ODBC Script commands are saved to local storage, not in a database. ODBC
Scripts are "run" by simply executing the commands they contain.
<P>
Saving a Stored Procedure requires work to remove the existing Stored
Procedure before the updated one is saved. Visual InterDev does this work
when a Stored Procedure is saved from within the Stored Procedure Editor.
It does no special work when an ODBC Script is run, and so the second time
a Stored Procedure inside an ODBC Script is run fails because the Stored
Procedure already exists in the database.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a database project or add a data connection to a Web project.

<P><LI>Click the Data View tab in the Workspace window.

<P><LI>Select the data connection to which to add a Stored Procedure in the
   Data View window.

<P><LI>From the File menu, select New. Click ODBC Script File.

<P><LI>Enter the text "Create Procedure MyProc as return" in the ODBC Script
   window (without the quotes).

<P><LI>Right-click in the window and select Run.
<P>
</OL>NOTE: Repeating step 6 fails at this point.

<OL><P><LI>Right-click on the data connection node of the Workspace Window and
   select Refresh.

<P><LI>Expand the data connection node.

<P><LI>Expand the Stored Procedures folder.

<P><LI>Double-click the new Stored Procedure node to open it for editing.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, see the following page on the
Microsoft Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : VIODBC kbprg
Technology        : kbInetDev
Version           : 1.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
