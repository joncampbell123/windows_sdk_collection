

<HTML>
<HEAD>
<TITLE>HOWTO: Display Records from an Access Database with ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180814">
<META NAME="KBModify" CONTENT="1998/03/04">
<META NAME="KBCreate" CONTENT="1998/02/10">
<META NAME="Keywords" CONTENT="VIADO VIASP kbcode">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  This article shows you how to create a Web interface that displays information from an Access 97 relational database using Visual InterDev.  There are four main steps in this process:  1. Create the Web project.  2. Add a Data Connection to Your pr...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QA1S,QA2Q,QAVZ,QAFI,QBJZ,QAG2,QDKY,QAH4,QAYY,QBQU,QAZV,QBWA,QACI,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Display Records from an Access Database with ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180814</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
<LI>Microsoft Internet Information Server version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows you how to create a Web interface that displays
information from an Access 97 relational database using Visual InterDev.
<P>
There are four main steps in this process:

<OL><P><LI>Create the Web project.

<P><LI>Add a Data Connection to Your project.

<P><LI>Create an Active Server Pages (ASP) page and Add it to a Data Command
   Control.

<P><LI>Write Code to Act on the Recordset Object Returned by the Data Command
   Control.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Follow the steps below to create an interface that reads data stored in an
Access 97 database.
<P>
<P><h3>Step 1: Create the Web Project</h3>
 

<OL><P><LI>Launch Visual InterDev.

<P><LI>On the File menu, click New.

<P><LI>Select the Web Project Wizard from the list on the Projects tab.

<P><LI>Enter MyDatabaseApp for the name of your Web project in the Project Name
   box (this is the name of your project stored on your remote
   workstation).

<P><LI>In the Location box, enter a path or click the ellipsis (...) to browse
   your local workstation for a place to store your project and files.

<P><LI>Click OK to continue to the next step.

<P><LI>Type or select the server for your Web, and click Next.

<P><LI>In Step 2 of the wizard, select "Create a new Web."

<P><LI>Type "DB" for the name of your new Web. This helps to demonstrate the
   difference between a project and a Web.

<P><LI>Clear "Enable full text searching for pages in this Web."

<P><LI>Click Finish to create your new Web.
<P>
</OL><h3>Step 2: Add a Data Connection to Your Project</h3>
 

<OL><P><LI>From the Project menu, point to Add to Project, and then click Data
   Connection.

<P><LI>Click New on the File Data Source tab.

<P><LI>Select "Microsoft Access Driver (*.mdb)" and click Next.

<P><LI>Click Browse.

<P><LI>By default, this places you in the Data Source folder located in
   the WinNT\ODBC directory on Windows NT or the Program Files\
   Common Files\ODBC directory on Windows 95.

<P><LI>In the File Name box, type MyDataSource and click Save. The full path to
   your new Data Source Name (DSN) file appears in the box.

<P><LI>Click Next, then click Finish.

<P><LI>In the "ODBC Microsoft Access 97 Setup" dialog box, click Select
   (located in the Database section of the dialog box).

<P><LI>Browse or type in the path to the Adventure Works (AdvWorkds.mdb)
   database.
<P>
   NOTES:
<P>
   The Adventure Works example site is installed by default when you add
   Active Server Pages to Microsoft Internet Information Server. The site
   is installed by default into the InetPub\ASPSamp\AdvWorks directory.
<P>
   If your database resides on a machine other than the Microsoft Internet
   Information Server server, you may want to use a Universal Naming
   Convention (UNC) path so that the server can locate it on your network.
   Following is a sample UNC path:
<P>
<P><PRE>      \\SERVERNAME\ROOTSHARENAME\InetPub\ASPSamp\AdvWorks\AdvWorks.mdb
</PRE><P>
   SERVERNAME represents the name of your server and ROOTSHARENAME
   represents the share name of your root directory.
<P>
   Note also that when you use an Access 97 database, you must set the NTLM
   CHANGE permissions for the directory where the database is located.
   This means that the IUSR_&lt;machinename&gt; account, for anonymous user
   logon, must have CHANGE permissions for the entire directory.
<P>
   For additional information, please see the following article(s) in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../istudio/q175804.htm">Q175804</A></B>
<PRE></PRE>      TITLE     : PRB: Server Object Error 'ASP 0177:80040154'
                  Server.CreateObject

      ARTICLE-ID: <B><A href="../adobj/q180815.htm">Q180815</A></B>
      TITLE     : BUG: IIS 4 Fails When Using a UNC to Access

</PRE><P><LI>Click OK to select the database for your DSN.

<P><LI>Click OK to complete the DSN setup.

<P><LI>Select MyDataSource.dsn from the list in the Select Data Source dialog
<P><PRE>    box.
</PRE>
<P><LI>Click OK to complete the process.
<P>
</OL><h3>Step 3: Create an ASP Page and Add It to a Data Command Control</h3>
 

<OL><P><LI>On the Project menu, point to Add to Project, and click New.

<P><LI>Select Active Server Page on the Files tab.

<P><LI>Type "Database" in the File Name box, and leave all other default
   options.

<P><LI>Click OK to create the page.

<P><LI>Leave the "&lt;!-- Insert HTML here --&gt;" line selected in the code window.
   On the Insert menu, point to Into HTML, and click ActiveX Control.

<P><LI>Click the Design-time tab in the Insert ActiveX Control dialog box.

<P><LI>Select the Data Command control from the list provided, and click OK. A
   Properties dialog box for your new control appears.

<P><LI>Leave "DataCommand1" in the ID box, and select DataConn from the
   DataConnection list. This is the DataConnection that you created in step
   2.

<P><LI>Click SQL Builder to build a SQL statement that returns a
   Recordset.

<P><LI>Click the plus sign (+) to expand the Tables tree in the Data View
   window.

<P><LI>Drag the Products table into the Query Builder window.

<P><LI>Select * (All Columns) in the Products table (located in the Query
   Builder window) to create the following SQL statement:
<P>
<P><PRE>      SELECT Products.*
      FROM Products
</PRE>
<P><LI>On the File menu, click Close to close the Query Builder, and click
   Yes when prompted to update DataCommand1.
<P>
   You should see the new SQL statement in the Command Text box of the
   Properties dialog box.

<P><LI>Close the DataCommand1 control window.
<P>
   Note that Visual InterDev creates the code necessary to execute the
   query against the Access database and to return the results in the
   Recordset object.
<P>
</OL>Step 4: Write Code to Act on the Recordset Object Returned by the Data
Command Control
 

<OL><P><LI>Place the following code after the &lt;!--METADATA TYPE="DesignerControl"
   endspan--&gt; tag in your ASP page:
<P>
<P><PRE>      &lt;%
<PRE></PRE>        Dim fldTemp
        For Each fldTemp In DataCommand1.Fields
          Response.Write fldTemp.Value &amp; "&lt;BR&gt;"
        Next
      %&gt;

</PRE><P><LI>On the File menu, click Save to save the ASP page.

<P><LI>Right-click the ASP page file name in the FileView window, and
   select "Preview in browser."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual InterDev and Active Server Pages, link to the following Microsoft
Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/vinterdev/">http://support.microsoft.com/support/vinterdev/</A></B>

</PRE></OL> 
<PRE>Keywords          : VIADO VIASP kbcode
Technology        : kbInetDev
Version           : Win95:1.0,3.0; WINNT:1.0,3.0
Platform          : Win95 winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
