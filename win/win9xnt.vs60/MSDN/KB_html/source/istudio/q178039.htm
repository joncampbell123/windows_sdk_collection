

<HTML>
<HEAD>
<TITLE>BUG: InfoViewer Becomes Inoperable After Window.Close Is Called </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178039">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1997/12/12">
<META NAME="Keywords" CONTENT="VIMisc">
<META NAME="KBArea" CONTENT="Support; KB; istudio">
<META NAME="Description" CONTENT="  InfoViewer ceases to function after browsing a page with client-side script that contains the Window.Close command. Trying to browse other pages with InfoViewer causes a blank error message to appear.  CAUSE =====  InfoViewer is not capable of clos...">
<META NAME="Product" CONTENT="istudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWA,QAMB,QAYL,QABC,QAUJ,QAKD,QA6A,QAK9,QAIV,QA56,QA55,QASR,QAY5,QARM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: InfoViewer Becomes Inoperable After Window.Close Is Called</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178039</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual InterDev, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
InfoViewer ceases to function after browsing a page with client-side script
that contains the Window.Close command. Trying to browse other pages with
InfoViewer causes a blank error message to appear.
<P>
<P><h2>CAUSE</h2>
 
<P>
InfoViewer is not capable of closing itself from within the Visual Studio
shell. The conditions that cause this behavior are:

<UL><LI>Client Side Script using the "Window.Close" command.

<LI>Browsing within the InfoViewer.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Use Internet Explorer to view the page that calls the "window.close"
method.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Add a new .htm file to an existing Visual InterDev project. Name the
   file "test.htm."

<P><LI>Copy the following code and paste it into the file created in the
   previous step:
<P>
<P><PRE>      &lt;INPUT TYPE="button" NAME="Button1" VALUE="Close Window"
      onClick="window.close()"&gt;
</PRE>
<P><LI>Save the file.

<P><LI>Preview the file above in the InfoViewer. If you don't have "InfoViewer"
   set as your default browser within Visual InterDev, right-click the file
   in the "FileView" pane and then, from the context menu, select "Browse
   With" and then "InfoViewer."
<P>
<P>
</OL>&lt;&lt;&lt;CONTENTNUM&gt;&gt;&gt; 178037
&lt;&lt;&lt;CONTENTTYPEID&gt;&gt;&gt; 1
&lt;&lt;&lt;TITLE&gt;&gt;&gt; PRB: Session Variables Lost When ASP Is Located in Frameset
&lt;&lt;&lt;LONGTITLE&gt;&gt;&gt; PRB: Session Variables Lost When ASP Is Located in Frameset
&lt;&lt;&lt;PRODUCT&gt;&gt;&gt; axsf
&lt;&lt;&lt;PRIORITY&gt;&gt;&gt; 1
&lt;&lt;&lt;SECURITY&gt;&gt;&gt; PUBLIC
&lt;&lt;&lt;AUTHOR&gt;&gt;&gt; kerryr
&lt;&lt;&lt;EDITOR&gt;&gt;&gt; lmoloney
&lt;&lt;&lt;EDITSTATUS&gt;&gt;&gt; Released
&lt;&lt;&lt;TECH&gt;&gt;&gt; KERRYR
&lt;&lt;&lt;TECHSTATUS&gt;&gt;&gt; Approved
&lt;&lt;&lt;EXPIREDATE&gt;&gt;&gt; Dec 31 1999 12:00AM
&lt;&lt;&lt;MESSAGE&gt;&gt;&gt; Initial edit by pjriker 12/12/97
&lt;&lt;&lt;KEYWORD&gt;&gt;&gt; VIASP
&lt;&lt;&lt;INTERNALADMIN&gt;&gt;&gt; kbDSupport kbdsi
&lt;&lt;&lt;QUESTION&gt;&gt;&gt;
&lt;&lt;&lt;PRODVERNUM&gt;&gt;&gt; WINNT:1.0,1.0b
&lt;&lt;&lt;COMPONENT&gt;&gt;&gt;
&lt;&lt;&lt;TECHNOLOGY&gt;&gt;&gt;
&lt;&lt;&lt;LINKS&gt;&gt;&gt;
&lt;&lt;&lt;RAIDINFO&gt;&gt;&gt;
&lt;&lt;&lt;INCIDENT&gt;&gt;&gt;
&lt;&lt;&lt;SWEEPDATE&gt;&gt;&gt;
&lt;&lt;&lt;SWEEPSTATUS&gt;&gt;&gt;
&lt;&lt;&lt;SOLUTIONTYPE&gt;&gt;&gt;
&lt;&lt;&lt;ISSUETYPE&gt;&gt;&gt; kbprb
&lt;&lt;&lt;PLATFORM&gt;&gt;&gt; winnt
&lt;&lt;&lt;HARDWARE&gt;&gt;&gt;
&lt;&lt;&lt;BOILERPLATE&gt;&gt;&gt;
&lt;&lt;&lt;PRODUCEDVIEW&gt;&gt;&gt;
&lt;&lt;&lt;TEXT&gt;&gt;&gt;
 
The information in this article applies to:

<UL><LI>Microsoft Active Server Pages, versions 1.0, 1.0b
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Values of session variables defined in an Active Server Pages (ASP) page
are empty when you attempt to access the values from other ASP pages within
the frameset.
<P>
<P><h2>CAUSE</h2>
 
<P>
The following conditions cause this error to occur:

<UL><LI>Session variables initialized within the ASP file, as opposed to being
   initialized in the global.asa. (See NOTE 1 below.)
<P>
<P><PRE>    -and-
</PRE>
<LI>The ASP files in condition 1 above are loaded into a frameset.
<P>
</UL>When displaying ASP files within a frameset, a new session is started for
each ASP file contained within the frameset. Likewise, the Session_OnStart
subroutine is called once for each ASP file.
<P>
Active Server Pages keeps track of sessions through the use of cookies.
When using a frameset that contains ASP files, the cookies aren't returned
to the browser until the entire frameset is loaded. For this reason, if a
session hasn't already been established (for example, a SessionID cookie
hasn't been passed to the browser), Active Server Pages creates a new
session for each ASP file within the frameset.
<P>
NOTE 1: If the session variable is initialized within the Session_OnStart
of the global.asa and the variable increments (for example, a variable that
holds a value indicating how many people have hit your site.), the value
will increment by an amount equal to the number of frames containing ASP
pages you have in your frameset. This behavior is due to the
Session_OnStart executing for each ASP file in your frameset.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Active Server Pages maintains a session only when necessary (for example,
if a session variable is created). To avoid this behavior, you must
establish a session before the frameset is processed. In most cases, the
easiest way to do this is by changing the file that defines the frameset
from an HTML file to an ASP file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Create the following files:
<P>
Main.htm:
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Developer Studio"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;

   &lt;FRAMESET FRAMEBORDER=0 SCROLLING=YES ROWS="15%, 70%, *"&gt;
       &lt;FRAME NAME="Top" SCROLLING="NO" src="top.asp"&gt;
       &lt;FRAME NAME="Middle" SCROLLING="AUTO" src="middle.asp"&gt;
       &lt;FRAME NAME="Bottom" SCROLLING="NO" src="bottom.asp"&gt;
   &lt;/FRAMESET&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE></OL>Top.asp:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;

   &lt;BODY&gt;
   &lt;% Response.Write( "Top.asp: " &amp; Session.SessionID ) %&gt;
   &lt;%'set a session variable I want to be global to all asp files in the
      frameset session("GlobalVar")="Top"%&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>Middle.asp:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;

   &lt;BODY&gt;
   &lt;% Response.Write( "Middle.asp: " &amp; Session.SessionID ) %&gt;

   &lt;SCRIPT LANGUAGE="VBScript"&gt;
      Sub CommandButton1_Click()
         'display the global variable set in top.asp
         msgbox "&lt;%=session("GlobalVar")%&gt;"
         'if GlobalVar is blank, it means the variable is scoped to a
         'different session.
      end sub
   &lt;/SCRIPT&gt;

   &lt;OBJECT ID="CommandButton1" WIDTH=96 HEIGHT=32
     CLASSID="CLSID:D7053240-CE69-11CD-A777-00DD01143C57"&gt;
        &lt;PARAM NAME="Caption" VALUE="display gvar"&gt;
        &lt;PARAM NAME="Size" VALUE="2540;846"&gt;
        &lt;PARAM NAME="FontCharSet" VALUE="0"&gt;
        &lt;PARAM NAME="FontPitchAndFamily" VALUE="2"&gt;
        &lt;PARAM NAME="ParagraphAlign" VALUE="3"&gt;
   &lt;/OBJECT&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>Bottom.asp:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;

   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;META NAME="GENERATOR" Content="Microsoft Visual InterDev 1.0"&gt;
   &lt;META HTTP-EQUIV="Content-Type" content="text/html; charset=iso-8859-1"&gt;
   &lt;TITLE&gt;Document Title&lt;/TITLE&gt;
   &lt;/HEAD&gt;

   &lt;BODY&gt;
   &lt;% Response.Write( "Bottom.asp: " &amp; Session.SessionID ) %&gt;
   &lt;% Session("MyVar") = "Bottom" %&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>Browse Main.htm and you will see that the session IDs are all different.
<P>
Rename Main.htm to Main.asp, and add the following line of code after the
&lt;/FRAMESET&gt; tag:
<P>
<PRE>   &lt;% Session("MyVar") = "Main" %&gt;

</PRE>Note that only one session is created and is maintained until the session
ends.
 
<PRE>Keywords          : VIMisc
Technology        : kbInetDev kbinetdev
Version           : WINDOWS:1.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
