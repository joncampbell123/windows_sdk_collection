

<HTML>
<HEAD>
<TITLE>FP97: Minimum NTFS File Permission Requirements </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162144">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1997/01/14">
<META NAME="Keywords" CONTENT="fpiis kbenv kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  The security architecture of the Microsoft Internet Information Server (IIS) relies on the Windows NT File System (NTFS). This article describes minimum NTFS access permissions required to run FrontPage 97 and which permissions are altered during i...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBFN,QDN9,QAA1,QAVZ,QDI2,QA49,QA7K,QAI5,QBG2,QBWG,QBWP,QAFZ,QBW7,QAQW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP97: Minimum NTFS File Permission Requirements</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162144</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 97 for Windows with Bonus Pack
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The security architecture of the Microsoft Internet Information Server
(IIS) relies on the Windows NT File System (NTFS). This article describes
minimum NTFS access permissions required to run FrontPage 97 and which
permissions are altered during installation or when you run Check
Installation from the FrontPage 97 Server Administrator.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: References to Shtml.dll, Author.dll, or Admin.dll apply equally to
their CGI counterparts, Shtml.exe, Author.exe, and Admin.exe, on IIS 1.x
servers. FrontPage only edits access control lists (ACLs); it does not
change file access permissions of accounts not listed in the following
section.
<P>
<P><h3>File Permissions Assigned by Check Installation</h3>
 
<P>
Check Installation is a feature of the FrontPage 97 Server Administrator
(Fpsrvwin.exe) that you can run to correct problems in NTFS permissions.
When you run Check Installation, permissions are set on the files as
follows:
<P>
Windows NT directory:
<P>
<PRE>   \WINNT\Frontpg.ini
      INTERACTIVE: Read (R)
      NETWORK: Read (R)

   \WINNT\System\Fp20htp.dll
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System\Fp20tl.dll
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System\Fp20txt.dll
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System\Fp20utl.dll
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System\Fp20wel.dll
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Infoadmn.dll
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Mfc40.DLL
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Msvcrt40.DLL
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Netapi32.DLL
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Netrap.dll
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Rpcltc1.DLL
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Samlib.DLL
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \WINNT\System32\Wsock32.DLL
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

</PRE>Microsoft FrontPage Installation Directory:
<P>
NOTE: FrontPage is installed to one of the following directories by
default: C:\Program Files\Microsoft FrontPage or C:\Microsoft FrontPage.
<P>
<PRE>   \Microsoft FrontPage\Servsupp
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \Microsoft FrontPage\Servsupp\Fp20msft.dll
      INTERACTIVE: Read (RX)
      NETWORK: Read (RX)

   \Microsoft FrontPage\Servsupp\Servers.cnf
      INTERACTIVE: Special Access (R)
      NETWORK: Special Access (R)

   \Microsoft FrontPage\Bin
      INTERACTIVE: List (RX)(Not Specified)
      NETWORK: List (RX)(Not Specified)

   \Microsoft FrontPage\Bin\Fp20vss.dll
      INTERACTIVE: Read (RX)
      NETWORK: Read (RX)

   \Microsoft FrontPage\Bin\Fpext*.msg
      (only if files are present for multi-language support)
      INTERACTIVE: Read (RX)
      NETWORK: Read (RX)

   \Microsoft FrontPage\Isapi\
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \Microsoft FrontPage\Isapi\_vti_bin
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \Microsoft FrontPage\Isapi\_vti_bin\Shtml.dll
      INTERACTIVE: Read (RX)
      NETWORK: Read (RX)

   \Microsoft FrontPage\Isapi\_vti_bin\_vti_adm\
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \Microsoft FrontPage\Isapi\_vti_bin\_vti_adm\Admin.dll
      INTERACTIVE: Read (RX)
      NETWORK: Read (RX)

   \Microsoft FrontPage\Isapi\_vti_bin\_vti_aut\
      INTERACTIVE: Read (RX)(RX)
      NETWORK: Read (RX)(RX)

   \Microsoft FrontPage\Isapi\_vti_bin\_vti_aut\Author.dll
      INTERACTIVE: Read (RX)
      NETWORK: Read (RX)

   \Microsoft FrontPage\Temp
      INTERACTIVE: Special Access (RWX)(RWX)
      NETWORK: Special Access (RWX)(RWX)

   \Microsoft FrontPage\Temp\Frontpg.lck
      INTERACTIVE: Special Access (RW)
      NETWORK: Special Access (RW)

</PRE>Web Content Area:
<P>
When you run Check Installation on an existing FrontPage web, the files and
directories in the content root directory are modified. No changes are made
to NTFS permissions in FrontPage subwebs. The minimum access permissions
required in FrontPage subwebs are set by duplicating the permissions in the
following list on all "_vti_*" directories and the files stored within
these directories. In addition, you need to set read permissions on
Shtml.dll for browsers, Author.dll for authors, and Admin.dll for
administrators. The following list assumes that your web content is stored
in \Inetpub\Wwwroot.
<P>
<PRE>   \Inetpub
   (all directories enclosing the content root grant list permissions
    to these accounts)
      INTERACTIVE:List (RX)(Not Specified)
      NETWORK: List (RX)(Not Specified)

   \Inetpub\Wwwroot
      INTERACTIVE: List (RX)(Not Specified)
      NETWORK: List (RX)(Not Specified)

   \Inetpub\Wwwroot\_vti_pvt
      INTERACTIVE: Change (RWXD)(RWXD)
      NETWORK: Change (RWXD)(RWXD)

   \Inetpub\Wwwroot\_vti_pvt\botinfs.cnf
      INTERACTIVE: (RWX)
      NETWORK: (RWX)

   \Inetpub\Wwwroot\_vti_pvt\bots.cnf
      INTERACTIVE: (RWX)
      NETWORK: (RWX)

   \Inetpub\Wwwroot\_vti_pvt\services.cnf
      INTERACTIVE: (RX)
      NETWORK: (RX)

   \VSS\Win32\Ssapi.dll (If Visual SourceSafe 5 is installed)
      INTERACTIVE: (RX)
      NETWORK: (RX)

   \VSS\Win32\Ssxx.dll where xx represents the country code. For example,
   Ssus.dll, which is the default if no other country code is present,
   represents the United States. (If Visual SourceSafe 5 is installed.)
      INTERACTIVE: (RX)
      NETWORK: (RX)

</PRE><h3>Additional File Permissions Assigned by Installation</h3>
 
<P>
File permissions are assigned to the following list of files when FrontPage
is installed. This list combined with the previous list demonstrate the
changes made when you install FrontPage on the server.
<P>
NOTE: This list assumes that the built-in NT Administrators and System
groups already have full control over the entire drive, and that the
IUSR_&lt;hostname&gt; account is granted read access to the web content before
FrontPage is installed.
<P>
FrontPage assumes that an account with read access to the web content
requires read access after installation. Such accounts become end users of
the web content. IUSR_&lt;hostname&gt; is only granted access if it had access to
the files at installation time. You can substitute "all user accounts with
read access to the web content" in place of IUSR_&lt;hostname&gt;. Regardless of
what access permissions these accounts had prior to installation, they are
normalized to the access permissions described in the following list during
the installation process. The installing account is explicitly given
administrator rights throughout the content area even though they are
already an administrator. (NOTE: You need to be an NT Administrator to
successfully run the FrontPage Server Administrator.)
<P>
Microsoft FrontPage Installation Directory:
<P>
NOTE: FrontPage is installed to one of the following directories by
default: C:\Program Files\Microsoft FrontPage or C:\Microsoft FrontPage.
<P>
<PRE>   \Microsoft FrontPage\Temp\_x_todo.htm
      INTERACTIVE: Special Access (RWX)
      NETWORK: Special Access (RWX)

</PRE>Web Content Area:
<P>
<PRE>   \Inetpub\Wwwroot
      IUSR_&lt;host_name&gt;: Special Access (RWXD) (RWD)
      The Installing Account: Special Access (RWXD) (RWD)

   All Browsable Content
      IUSR_&lt;host_name&gt;: Special Access (RWD)

   \Inetpub\Cgi-Bin
      IUSR_&lt;host_name&gt;: Special Access (RWXD)(RWD)
      The Installing Account: Special Access (RWXD) (RWD)

   \Inetpub\Wwwroot\_vti_log
      IUSR_&lt;host_name&gt;: Special Access (RWXD) (RWD)
      The Installing Account: Special Access (RWXD) (RWD)

   \Inetpub\Wwwroot\_vti_pvt
      IUSR_&lt;host_name&gt;: Special Access (RWXD) (RWD)
      The Installing Account: Special Access (RWXD) (RWD)

   \Inetpub\Wwwroot\_vti_pvt\Access.cnf
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_pvt\Doctodep.btr
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_pvt\Deptodoc.btr
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_pvt\Httpconf.lck
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_pvt\Service.cnf
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_pvt\Services.org
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_pvt\Svcacl.cnf
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_pvt\uniqperm.cnf
      IUSR_&lt;host_name&gt;: Special Access (RWD)
      The Installing Account: Special Access (RWD)

   \Inetpub\Wwwroot\_vti_txt
      IUSR_&lt;host_name&gt;: Special Access (RWXD) (RWD)
      The Installing Account: Special Access (RWXD) (RWD)

   \Inetpub\Wwwroot\_vti_bin
      IUSR_&lt;host_name&gt;: Read (RX)(RX)
      The Installing Account: Read (RX)(RX)

   \Inetpub\Wwwroot\_vti_bin\Shtml.dll
      IUSR_&lt;host_name&gt;: Read (RX)
      The Installing Account: Read (RX)

   \Inetpub\Wwwroot\_vti_bin\_vti_aut
      The Installing Account: Read (RX)(RX)

   \Inetpub\Wwwroot\_vti_bin\_vti_aut\author.dll
      The Installing Account: Read (RX)

   \Inetpub\Wwwroot\_vti_bin\_vti_adm
      The Installing Account: Read (RX)(RX)

   \Inetpub\Wwwroot\_vti_bin\_vti_adm\Admin.dll
      The Installing Account: Read (RX)

   \Inetpub\Wwwroot\_vti_cnf
      IUSR_&lt;host_name&gt;: Special Access (RWXD) (RWD)
      The Installing Account: Special Access (RWXD) (RWD)

   \Inetpub\Wwwroot\_private
      IUSR_&lt;host_name&gt;: Special Access (RWXD) (RWD)
      The Installing Account: Special Access (RWXD) (RWD)

</PRE><h3>Changes in Permissions Required by FrontPage 1.1</h3>
 
<P>
IUSR_&lt;hostname&gt; now only has RX to all executable directories (_VTI_*)
thereby closing a security hole. This is a change from FrontPage 1.1. In
FrontPage 1.1, the IUSR_&lt;hostname&gt; account was granted Full Control to the
_vti_bin directory and Shtml.exe. If an intruder had the IUSR_&lt;hostname&gt;
password and logged into the machine they would have write permission in an
executable directory. FrontPage 1.1 itself NEVER allowed any clients to
write into the _vti_bin directory, so the security threat was only from
other means of access to the web server file system. Now that the
IUSR_&lt;hostname&gt; account is only granted RX to the _vti_bin, this potential
hole is sealed. It is no longer necessary to be an NT Administrator to
administer webs using FrontPage Explorer.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 front page<BR>
Keywords          : fpiis kbenv kbdta<BR>
Version           : windows:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
