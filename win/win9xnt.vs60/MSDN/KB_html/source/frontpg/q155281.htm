

<HTML>
<HEAD>
<TITLE>FP1: Runtime WebBot Fails on IIS w/Multiple Home Directories </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155281">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1996/08/26">
<META NAME="Keywords" CONTENT="fpiis kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  If you are running Microsoft Internet Information Server (IIS) with more than  one home directory, and at least one home directory is defined as a virtual server, the run-time WebBot components may not function.  NOTE: This problem only affects Int...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAVZ,QBWA,QBVX,QAD7,QAUR,QAL3,QAH7,QAH6,QAE2,QDJP,QAKG,QAFZ,QAPN,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP1: Runtime WebBot Fails on IIS w/Multiple Home Directories</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155281</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage for Windows, version 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you are running Microsoft Internet Information Server (IIS) with more than 
one home directory, and at least one home directory is defined as a
virtual server, the run-time WebBot components may not function.
<P>
NOTE: This problem only affects Internet Information Server, version
2.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
A Web server passes identification information about the server in a Common 
Gateway Interface (CGI) parameter called Server_Name. While IIS 1.0 passes the 
Internet Protocol (IP) address in this parameter, IIS 2.0 passes the server 
name.
<P>
When the FrontPage Server Extensions for IIS are installed, FrontPage needs to 
know the IP address specified in the World Wide Web service properties (that is 
how the registry keys are stored). From this information, the [Port &lt;ip 
address&gt;:&lt;port&gt;] section is created in the Frontpg.ini file. When IIS 2.0 passes 
a server name other than the IP address, FrontPage looks for the [Port 
&lt;name&gt;:&lt;port&gt;] section in the Frontpg.ini. If it does not find it, FrontPage 
looks for just the port. If FrontPage does not find that either, FrontPage puts 
an error log in the event viewer and fails.
<P>
Note that if FrontPage does find the [Port 80] section it may not be
the section it should find because the non-virtual server on port 80
could (and should) have a different document root than the virtual
server that initiated the WebBot run-time activity.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
<P><h3>Method 1. Use the IP address instead of the host name</h3>
 
<P>
To work around this problem, browse pages that contain run-time WebBot
components using the server IP address rather than the host name. You
can achieve this by ensuring that no run-time WebBot components occur
on your home page (Default.htm) and that all links to pages that
contain run-time WebBot components in your Web are created as World
Wide Web links to the IP address instead of as relative links to the
destination pages.
<P>
Example:
<P>
In the root web, suppose you have a page named Feedback.htm that
contains a WebBot Save Results component. If you create a relative
link to that page, and you use the host name to browse the Web,
the Save Results component will return an error message. However, if
you create the link as an absolute URL using the IP address (for
example, <B>http://127.0.0.1/feedback.htm),</B> the form may work.
<P>
To achieve this result on all links from a page, you can enter the
server's IP address into the Base Location field of the Page Properties.
In the example above, all links on the page could be affected by
typing the following in the Base Location box in the Page Properties
dialog box (File menu) in FrontPage Editor:
<P>
<PRE>   <B>http://127.0.0.1</B>

</PRE>This would change a link on that page defined as
<P>
<PRE>   feedback.htm

</PRE>to be evaluated by the server as
<P>
<PRE>   <B>http://127.0.0.1/feedback.htm</B>

</PRE>This workaround has proven effective for the following WebBot
components running on a TCP/IP configuration that uses WINS
resolution:
<P>
<PRE>   Confirmation Field
   Discussion
   Save Results
   Search

</PRE>To see if this workaround will succeed on your server, alter one of
the links to a fully qualified link to an IP address and test the
functionality of run-time WebBot components on that link.
<P>
<P><h3>Method 2. Install the FrontPage 97 Server Extensions</h3>
 
<P>
Install the FrontPage 97 Server Extensions on the web server. You can
obtain the FrontPage 97 Server Extensions at the following Microsoft
World Wide Web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/frontpage/softlib/current.htm">http://www.microsoft.com/frontpage/softlib/current.htm</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the
Microsoft home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the products listed at
the beginning of this article. This problem was corrected in Microsoft FrontPage
97 for Windows with Bonus Pack.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WebBot run-time components are: Confirmation Field, Discussion,
Registration, Save Results, and Search.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.10 Internet Information Server fp multi-home<BR>
multi-host<BR>
Keywords          : fpiis kbdta<BR>
Version           : windows:1.1<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
