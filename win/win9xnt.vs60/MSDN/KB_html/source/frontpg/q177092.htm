

<HTML>
<HEAD>
<TITLE>FP97: Overview of a FrontPage Discussion Web Architecture </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177092">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1997/11/20">
<META NAME="Keywords" CONTENT="fpedit fpexp fphtml kbdta kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  This article describes which files and processes are needed to administer a FrontPage Discussion Web and offers tips for keeping a Discussion Web functioning correctly.  MORE INFORMATION  The following main components provide the foundation for the...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QA6A,QAVZ,QAVW,QAVX,QALZ,QAFZ,QAKC,QABC,QBC9,QBC8,QBC6,QAWA,QAUJ,QANO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP97: Overview of a FrontPage Discussion Web Architecture</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177092</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 97 for Windows with Bonus Pack
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes which files and processes are needed to administer a
FrontPage Discussion Web and offers tips for keeping a Discussion Web
functioning correctly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following main components provide the foundation for the FrontPage
Discussion Web, assuming you selected the Use Threaded Replies option when you
created the Discussion Web by using the Discussion Web Wizard.

<UL><LI>FrontPage Discussion WebBot component.

<LI>Toc.htm.

<LI>Tocproto.htm.

<LI>Service.cnf.

<LI>The Discussion Web folder. By default, this folder is named _disc# where
   # is the number of discussion webs that you have created so far.
<P>
</UL>NOTE: In FrontPage 97 and earlier versions, you must not use upper case
characters, and you must begin the folder name with an underscore (_) character.
In FrontPage 98, you can use upper case letters in the Discussion Web folder
name.
<P>
All of these items will work only when used with the FrontPage Server
Extensions.
<P>
If any of these components are damaged or configured incorrectly, you may see
one or more of the following symptoms:

<UL><LI>New posts will be appended to existing posts.

<LI>Messages will be threaded incorrectly.

<LI>Posted articles will not appear in the table of contents even when you
   refresh the page.
<P>
</UL><h3>What Happens When an Article Is Submitted?</h3>
 
<P>
When you submit an article, the Discussion WebBot does the following:

<OL><P><LI>Scans the Service.cnf file for an article number and converts this number
   to hexadecimal.

<P><LI>Creates the article using an eight-digit hexadecimal integer. For example,
   00000001.htm or 0000000a.htm.

<P><LI>Updates the Tocproto.htm file with threading structure and hyperlink
   information.

<P><LI>Uses the Include WebBot component in the Toc.htm file and copies the body of
   the Tocproto.htm file to the Toc.htm file for threading structure. The
   Toc.htm file contains a header (also included by an Include WebBot
   component), which creates the Next, Previous, Up, Post, Search, and Reply
   hyperlinks.
<P>
</OL><h3>What is Tocproto.htm?</h3>
 
<P>
The Tocproto.htm file is located in the _disc# folder. It has a specific
architecture that is maintained by the Discussion WebBot and changes every time
an article is posted. For example, the HyperText Markup Language (HTML) code for
the article structure initially looks like this:
<P>
<PRE>   &lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN"&gt;
   &lt;html&gt;

   &lt;head&gt;
   &lt;meta http-equiv="Content-Type"
   content="text/html; charset=iso-8859-1"&gt;
   &lt;meta name="FORMATTER" content="Microsoft FrontPage 2.0"&gt;
   &lt;meta name="GENERATOR" content="Microsoft FrontPage 2.0"&gt;
   &lt;title&gt;&lt;/title&gt;
   &lt;/head&gt;

   &lt;body&gt;

   &lt;dl&gt;
       &lt;dt&gt;&lt;!--webbot bot="FormInsertHere" startspan
           descr="The WebBot FormInsertHere Component indicates the point
   in an HTML file where you want a WebBot SaveResults, Registration, or
   Discussion Component to insert new results." --&gt;&lt;em&gt;Form Results
   Inserted Here&lt;/em&gt;&lt;!--webbot
           bot="FormInsertHere" i-checksum="34463" endspan --&gt;&lt;/dt&gt;
   &lt;/dl&gt;
   &lt;/body&gt;
   &lt;/html&gt;

</PRE></OL>After the first article is posted, the Tocproto.htm file will reflect the
changes as follows. (To conserve space, only the body of the file is shown.)
<P>
NOTE: The asterisks indicate the additions to the file. The position of a new
thread is indented only once, and replies to that thread are indented even
further.
<P>
<PRE>     &lt;body&gt;

   * &lt;dl&gt;
   *  &lt;dt&gt;&lt;b&gt;&lt;a href="00000001.htm" NAME="00000001"&gt;Test&lt;/a&gt;&lt;/b&gt;&lt;i&gt;
   *  Test 11/18/97&lt;/i&gt;&lt;/dt&gt;
   *  &lt;dd&gt;&lt;dl&gt;
   *     &lt;dt&gt;&lt;b&gt;&lt;a href="00000002.htm" NAME="00000002"&gt;Re: Test&lt;/a&gt;&lt;/b&gt;&lt;i&gt;
   *     Test 11/18/97&lt;/i&gt;&lt;/dt&gt;
   *      &lt;dd&gt;&lt;dl&gt;
   *          &lt;!--webbot bot="FormInsertHere" S-RepliesTo="00000002"
   *          startspan --&gt;&lt;!--webbot bot="FormInsertHere" endspan
   *          i-checksum="0" --&gt;
   *        &lt;/dl&gt;
   *      &lt;/dd&gt;
   *      &lt;!--webbot bot="FormInsertHere" DESCR="The FrontPage
   *      FormInsertHere Component indicates the point in an HTML file
   *      where you want a default, Registration, or Discussion Component
   *      to insert new results." S-RepliesTo="00000001" startspan
   *      --&gt;&lt;!--webbot bot="FormInsertHere" endspan i-checksum="0" --&gt;
   *    &lt;/dl&gt;
   *  &lt;/dd&gt;
     &lt;/body&gt;

</PRE>Notice below how the addition of another article (the reply) to that posting
is indented.
<P>
<PRE>      &lt;body&gt;

   * &lt;dl&gt;
   *  &lt;dt&gt;&lt;b&gt;&lt;a href="00000001.htm" NAME="00000001"&gt;Test&lt;/a&gt;&lt;/b&gt;&lt;i&gt;
   *  Test 11/18/97&lt;/i&gt;&lt;/dt&gt;
   *  &lt;dd&gt;&lt;dl&gt;
   *     &lt;dt&gt;&lt;b&gt;&lt;a href="00000002.htm" NAME="00000002"&gt;Re: Test&lt;/a&gt;&lt;/b&gt;&lt;i&gt;
   *     Test 11/18/97&lt;/i&gt;&lt;/dt&gt;
   *      &lt;dd&gt;&lt;dl&gt;
   *          &lt;!--webbot bot="FormInsertHere" S-RepliesTo="00000002"
   *          startspan --&gt;&lt;!--webbot bot="FormInsertHere" endspan
   *          i-checksum="0" --&gt;
   *        &lt;/dl&gt;
   *      &lt;/dd&gt;
   *      &lt;!--webbot bot="FormInsertHere" DESCR="The FrontPage
   *      FormInsertHere Component indicates the point in an HTML file
   *      where you want a default, Registration, or Discussion Component
   *      to insert new results." S-RepliesTo="00000001" startspan
   *      --&gt;&lt;!--webbot bot="FormInsertHere" endspan i-checksum="0" --&gt;
   *    &lt;/dl&gt;
   *  &lt;/dd&gt;
      &lt;/body&gt;

</PRE>A new thread posted to the discussion group will begin at a new indention and
replies to that posting will appear indented under the new thread as shown
above. This structure will continue throughout continuous replies and with
replies to a reply.
<P>
<P><h3>What Components Make the Tocproto.htm Work as it Does?</h3>
 
<P>
The Tocproto.htm file is comprised of three components:

<UL><LI>&lt;DT&gt;, &lt;DD&gt;, &lt;DL&gt;
<LI>"FormInsertHere" (with the quotation marks)
<LI>s-repliesto=x

<LI>&lt;DT&gt;, &lt;DD&gt;, &lt;DL&gt;
<P>
   (where &lt;DT&gt; denotes Designated Term, &lt;DD&gt; denotes Designated Definition, and
   &lt;DL&gt; denotes Designated List. Note that each of these elements requires an
   ending tag (&lt;/DT&gt;, &lt;/DD&gt;, and &lt;/DL&gt;). These tags provide the formatting
   information that displays the threads correctly.

<LI>"FormInsertHere" (with the quotation marks)
<P>
   The point at which the new article is inserted.

<LI>s-repliesto=x
<P>
   This is an argument for the FormInsertHere WebBot component. It instructs the
   particular instance of the WebBot to accept replies to posts of a specific
   article number.
<P>
</UL><h3>What is Toc.htm?</h3>
 
<P>
The Toc.htm file is located in the same folder as the Tocproto.htm file. This
file is a copy of Tocproto.htm, but it contains style information (taken from
the Web's theme for FrontPage 98 or copied from another page for FrontPage 97),
and the WebBot overhead is stripped out.
<P>
<P><h3>What is Service.cnf?</h3>
 
<P>
The Service.cnf file is a configuration file located in the _vti_pvt folder in
the current web. This file contains information about the Discussion Web as well
as other FrontPage Web specific configuration information. The section of this
file that the Discussion Web directly relates to contains the article number
variable. For example, if your discussion group is called "_bob", the
configuration information will be stored in the _vti__bob_articlenumber key.
The number will increment each time an article is submitted. If you change this
number, you can alter the position of the insertion point for an article or
alter the next article number. However, if you change this number so that it is
less than the number of articles you have, newer articles will be appended or
added to an existing article.
<P>
NOTE: If you rename or modify a file in FrontPage Explorer, all subsequent links
and configurations will be updated automatically. Because experimenting with the
structure of your Discussion Web could cause it to function incorrectly, you
should make these types of adjustments to a test Web first. When you have
attained the desired results, check and recheck your Web before you implement
the changes on your primary Web.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../frontpg/q154675.htm">Q154675</A></B>
   TITLE     : FP: How to Edit/Delete Articles in a FrontPage Discussion Web

   ARTICLE-ID: <B><A href="../frontpg/q169835.htm">Q169835</A></B>
   TITLE     : FP: Discussion Web Message Won't Keep Formatting after
               Posting

   ARTICLE-ID: <B><A href="../frontpg/q152097.htm">Q152097</A></B>
   TITLE     : FP: Files in Discussion Web Are Overwritten

   ARTICLE-ID: <B><A href="../frontpg/q143101.htm">Q143101</A></B>
   TITLE     : How to Use FrontPage Without the Server Extensions

   ARTICLE-ID: <B><A href="../frontpg/q176927.htm">Q176927</A></B>
   TITLE     : FP: Newest to Oldest Order Doesn't Work in Discussion Web
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 98 discussion web functionality<BR>
Keywords          : fpedit fpexp fphtml kbdta kbfaq<BR>
Technology        : internet kbinetdev<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
