

<HTML>
<HEAD>
<TITLE>FP98: How to Post Information to a Database Using ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175770">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1997/10/28">
<META NAME="Keywords" CONTENT="fpiis fpodbc kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  This article describes how to post new information to a Microsoft Access 97 database using FrontPage 98 and Active Server Pages (ASP).  MORE INFORMATION  Getting Ready to Use the ASP Features in FrontPage 98  Before you can use the ASP features in ...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QBJZ,QBWS,QBT6,QBQU,QBV4,QDNQ,QA50,QA1S,QALZ,QASR,QAHP,QDKY,QAFZ,QAZV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP98: How to Post Information to a Database Using ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175770</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 98 for Windows
<LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to post new information to a Microsoft Access
97 database using FrontPage 98 and Active Server Pages (ASP).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Getting Ready to Use the ASP Features in FrontPage 98</h3>
 
<P>
Before you can use the ASP features in FrontPage 98, you must install
the following components:

<UL><LI>A 32-bit ODBC driver.

<LI>One of the following servers:
<P>
<P><PRE>    - Microsoft Internet Information Server (IIS) 2.0 or 3.0 for
      Microsoft Windows NT Server.
</PRE><P>
<P><PRE>    - Microsoft Peer Web Services for Microsoft Windows NT Workstation.
</PRE><P>
<P><PRE>    - Microsoft Personal Web Server for Microsoft Windows 95.
</PRE>
<LI>An ASP engine on the IIS derivative Web server.

<LI>FrontPage 98 Server Extensions.
<P>
</UL><h3>Posting Information to a Microsoft Access Database Using ASP</h3>
 
<P>
To posting information to a Microsoft Access database using ASP, follow
these steps:

<OL><P><LI>Start Microsoft Access 97 and follow these steps:
<P>
<P><PRE>    a. Create a database that includes one table. Name the table
       "Employees" (without the quotation marks).
</PRE><P>
<P><PRE>    b. Insert four fields and name them as follows:
</PRE><P>
<PRE>         EmployeesID
         FirstName
         LastName
         EmailName

    c. On the File menu, click Save. In the File Name box, type
       "Aspsamp.mdb" (without the quotation marks), and click Save.

</PRE><P><LI>Start FrontPage Explorer and create a new Web by following these
   steps:
<P>
<P><PRE>    a. On the File menu, point to New, and click FrontPage Web.
</PRE><P>
<P><PRE>    b. In Step 1, click One Page Web.
</PRE><P>
<P><PRE>    c. In Step 2, click Change.
</PRE><P>
<P><PRE>    d. In the "Please specify a location of the New FrontPage Web" box,
       type the following:
</PRE><P>
<PRE>         <B>http://localhost/ASPWeb</B>

    e. In the "Choose a title for your FrontPage Web" box, type "ASPWeb"
       (without the quotation marks).

    f. Click OK twice.

</PRE><P><LI>On the View menu, click Folders.

<P><LI>Import the Microsoft Access 97 database file into FrontPage Explorer,
   by following these steps:
<P>
<P><PRE>    a. On the File menu, click Import.
</PRE><P>
<P><PRE>    b. Click Add file.
</PRE><P>
<P><PRE>    c. Click Browse, select the file you created in step 1, and then
       click Open.
</PRE><P>
<P><PRE>    d. Click OK.
</PRE>
<P><LI>Create an executable folder by following these steps:
<P>
<P><PRE>    a. On the File Menu, point to New, and click Folder.
</PRE><P>
<P><PRE>    b. Name the folder "ASP" (without the quotation marks).
</PRE><P>
<P><PRE>    c. Press ENTER.
</PRE><P>
<P><PRE>    d. Right-click the ASP folder and click Properties on the menu
       that appears.
</PRE><P>
<P><PRE>    e. Click to select the "Allow scripts or programs to be run" check
       box.
</PRE><P>
<P><PRE>    f. Click OK.
</PRE>
<P><LI>Create a system Data Source Name (DSN) by following these steps:
<P>
<P><PRE>    a. On the Windows Start menu, point to Settings, and then click
       Control Panel.
</PRE><P>
<P><PRE>    b. Double-click the 32bit ODBC icon (Windows 95) or the ODBC icon
      (Windows NT).
</PRE><P>
<P><PRE>    c. Click the System DSN tab.
</PRE><P>
<P><PRE>    d. Click Add.
</PRE><P>
<P><PRE>    e. Select the driver you want to use. For example, select
       "Microsoft Access Driver (*.mdb)." Click Finish.
</PRE><P>
<P><PRE>    f. In the Data Source Name box, type the name you want. For example,
       type "Aspdemo" (without the quotation marks). Note that the DSN
       name should not include any spaces.
</PRE><P>
<P><PRE>    g. Click Select.
</PRE><P>
<P><PRE>    h. Select the database file you want to use (for example, select
       Aspsamp.mdb). The file will be located in one of the following
       IIS Web server locations:
</PRE><P>
<PRE>        - Personal Web Server for Windows 95:

             C:\Webshare\Wwwroot\Aspweb\Aspsamp.mdb

        - Internet Information Server for Windows NT Server:

             C:\InetPub\Wwwroot\Aspweb\Aspsamp.mdb

        - Microsoft Peer Web Services for Windows NT Workstation:

             C:\InetPub\Wwwroot\Aspweb\Aspsamp.mdb

    i. Click OK three times.

</PRE><P><LI>In FrontPage Editor, create a form that contains three one-line text
   boxes by following these steps:
<P>
<P><PRE>    a. In FrontPage Explorer, double-click the Default.htm file.
</PRE><P>
<P><PRE>       The file will be opened in FrontPage Editor.
</PRE><P>
<P><PRE>    b. On the Insert menu, point to Form Field, and click One-Line Text
       Box.
</PRE><P>
<P><PRE>       NOTE: When you insert the first form field, the Submit and
       Reset buttons will be present on the form. These will appear to
       the right of the form field. If you want to move these buttons
       to a new line in the form, click in front of the first form
       field and then press ENTER.
</PRE><P>
<P><PRE>    c. Click to the left of the one-line text box form field.
</PRE><P>
<P><PRE>    d. Type "First Name:" (without the quotation marks).
</PRE><P>
<P><PRE>    e. Select the text box and the text that you typed in step d.
</PRE><P>
<P><PRE>    f. On the Insert menu, point to Form Field, and click Label.
</PRE><P>
<P><PRE>    g. Right-click the one line text box and then click Form Field
       Properties on the menu that appears.
</PRE><P>
<P><PRE>    h. In the Name box, type "FirstName" (without the quotation marks).
       Click OK.
</PRE><P>
<P><PRE>    i. Press the RIGHT ARROW key and then press ENTER.
</PRE><P>
<P><PRE>    j. On the Insert menu, point to Form Field, and click One-Line Text
       Box.
</PRE><P>
<P><PRE>    k. Repeat steps b through i for the remaining two fields (LastName
       and EmailName).
</PRE><P>
<P><PRE>    l. Right-click the Submit button and then click Form Properties on
       the menu that appears.
</PRE><P>
<P><PRE>    m. Click Send To Other and select the "Custom ISAPI, NSAPI, CGI, or
       ASP Script" option in the Send To Other list.
</PRE><P>
<P><PRE>    n. Click Options.
</PRE><P>
<P><PRE>    o. In the "Options for Custom Form Handler" dialog box, in the Action
       box, type "ASP/posts.asp" (without the quotation marks).
</PRE><P>
<P><PRE>    p. Click OK twice.
</PRE><P>
<P><PRE>    q. On the File menu, click Save.
</PRE>
<P><LI>In FrontPage Editor, create the ASP page by following these steps:
<P>
<P><PRE>    a. On the File menu, click New, and then click the Page tab.
</PRE><P>
<P><PRE>    b. Double-click Normal Page.
</PRE><P>
<P><PRE>    c. On the Insert menu, point to Database, and click Database Region
       Wizard.
</PRE><P>
<P><PRE>    d. In the "ODBC Data Source Name (DSN)" box, type "ASPDemo" (without
       the quotation marks). Click Next.
</PRE><P>
<P><PRE>    e. In the "Enter the SQL string for the query" box, type the
       following SQL code:
</PRE><P>
<PRE>         Insert into Employees (FirstName, LastName, EmailName) values
         ('%%FirstName%%','%%LastName%%','%%EmailName%%')

       NOTE: The field names, FirstName, LastName, and EmailName,
       represent the fields used in the Aspsamp.mdb file. The fields,
       %%FirstName%%, %%LastName%%, and %%EmailName%% represent the
       one-line text box form fields.

       Click Next.

    f. Click Add Field.

    g. In the Add Field dialog box, type "EmployeesID" (without
       the quotation marks). Click OK.

    h. Repeat Steps f and g for each of the remaining fields (FirstName,
       LastName, and EmailName) that you created in step 1.

    i. Click Finish.

    j. Click OK.

    k. On the File menu, click Save. In the Save As dialog box, select
       the ASP folder you created in step 5. In the File name box, type
       "posts.asp" (without the quotation marks) and click Save.

</PRE><P><LI>Open the page in your Web browser, fill in the form fields, and
   submit the form.
<P>
   NOTE: After you click Submit, you will receive a "No Records
   Returned" message. Start or switch to Microsoft Access and open
   the Aspsamp.asp file. Note that new information will have been
   added to the database.
<P>
   For more information, please see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>       Article-ID : <B><A href="../frontpg/q177082.htm">Q177082</A></B>
<PRE></PRE>       TITLE      : FP98: "No Records Returned" Received When Posting to
                    Database

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about Active Server Pages in FrontPage 98, please
see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>    ARTICLE-ID : <B><A href="../frontpg/q174008.htm">Q174008</A></B>
    TITILE     : FP98: What are Active Server Pages?

    ARTICLE-ID : <B><A href="../frontpg/q174015.htm">Q174015</A></B>
    TITLE      : FP98: How to Create Active Server Pages in FrontPage 98

    ARTICLE-ID : <B><A href="../frontpg/q175771.htm">Q175771</A></B>
    TITLE      : FP98: How to Display Contents of a Database Using ASP
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 98 iis asp fpodbc<BR>
Keywords          : fpiis fpodbc kbdta<BR>
Version           : WINDOWS:98<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
