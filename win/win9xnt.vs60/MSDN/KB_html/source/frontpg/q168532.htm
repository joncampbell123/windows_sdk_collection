

<HTML>
<HEAD>
<TITLE>FP97: Resource Usage by FrontPage 97 Server Extensions on IIS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168532">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="fpext fpiis kbenv kbusage kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  You notice greater resource usage within the Internet Information Server (IIS), versions 2.0 and 3.0, when you perform specific operations with the FrontPage Server Extensions. Resource usage increases as the number of FrontPage extended virtual se...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDH9,QAVZ,QAFZ,QAKC,QBWP,QAGU,QAFI,QBC6,QAOG,QABN,QBWG,QBVX,QAG8,QAMR,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP97: Resource Usage by FrontPage 97 Server Extensions on IIS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168532</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 97 for Windows with Bonus Pack
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You notice greater resource usage within the Internet Information
Server (IIS), versions 2.0 and 3.0, when you perform specific
operations with the FrontPage Server Extensions. Resource usage
increases as the number of FrontPage extended virtual servers and
FrontPage subwebs increases or, in some cases, as the number of files
contained within each FrontPage Web increases.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Following is a list of items that may cause excessive resource usage,
particularly when the number of FrontPage extended virtual servers or
the number of FrontPage subwebs on a given server is large.
<P>
<P><h3>Creating or deleting Root Webs, SubWebs, and Executable Directories</h3>
 
<P>
When you create or delete Root Webs, subwebs and executable
directories, FrontPage reads and writes entries in the IIS Virtual
Roots section of the Windows NT Registry. The Application Program
Interface which IIS and FrontPage Server Extensions use to read and
write these entries must read the entire list, append or delete an
entry, and then rewrite the entire list. This causes noticeable delays
when you create or delete Webs, or install extensions into new Webs.
This also causes problems if multiple users author Webs at the same
time. For example, one user may have the list of virtual roots locked
for an update while another user attempts to write to it. Errors in
the virtual roots of IIS as represented in Event Viewer or Internet
Service Manager may slow down the process even further.
<P>
FrontPage creates seven to eight virtual roots per Root Web (depending
on whether or not you already have a global mapping for "/cgi-bin")
and six virtual roots per subweb. Since each FrontPage Web always
defines these virtual roots, the more FrontPage Root Webs or subwebs
there are on a given machine, the slower the performance of FrontPage
authoring will be.
<P>
The best workaround to prevent this delay is to limit the number of
virtual Roots and the number of FrontPage subwebs. In practice the
number of virtual servers (and thus the number of Root Webs) is
limited by spreading the virtual servers over multiple computers, but
it is possible to limit the number of FrontPage subwebs allowed on a
single computer. New FrontPage subwebs can only be created by
FrontPage Administrators. Therefore, you can avoid creating an
excessive number of subwebs (and virtual roots) by granting only
authoring privileges instead of FrontPage administrative privileges to
the users.
<P>
When you mark a directory as executable, a virtual root is created.
For each directory you mark as executable, you add one virtual root.
To prevent excessive delays in FrontPage Web performance, limit the
number of folders marked as executable. One way to limit the number of
executable directories is to establish a single, shared executable
folder which contains the shared scripts. Any user who takes
advantage of the shared scripts should reference the shared executable
folder and therefore would not require individual executable folders.
<P>
You can limit the ability of FrontPage users to mark directories as
executable by setting the NoExecutableCGIUpload=1 flag in the
Frontpg.ini file.
<P>
For more information about the configuration variables used in the
Frontpg.ini file, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../frontpg/q162145.htm">Q162145</A></B>
   TITLE     : FP97: Configuration Settings for Windows NT Servers

</PRE><h3>Application of Permissions</h3>
 
<P>
IIS implements security on Webs through NT File System (NTFS)
permissions. FrontPage Server Extensions apply permissions to a Web by
checking the file system file by file. With each additional file in a
FrontPage Web, the process of applying permissions to a Web takes more
time. The more users and groups that are included in the permissions
list, the more time it takes to apply permissions.
<P>
If permissions do not change frequently for a given Web, you
should grant this privilege only to server administrators who can
perform the permissions updates during non-peak hours or when truly
necessary. Or, you can grant Authoring privileges to users to allow
them to change content but not modify permissions.
<P>
If the list of users for a given Web changes frequently, you can
achieve significant performance improvements by managing access to
Webs through NT groups rather than through individual user account
permissions. For example, you can establish a Windows NT group for
browsers, one for authors, and another one for administrators of the
Web. When you need to change Web permissions, modify the membership of
the appropriate group in the Windows NT User Manager instead of
updating the NTFS permissions for each file in the Web through the
FrontPage Server Extensions.
<P>
<P><h3>Installing Extensions</h3>
 
<P>
When you install server extensions you also create virtual roots and
grant file permissions, causing a delay in both of these activities.
You can improve performance during installation by decreasing the
amount of data in the content area of the server where
you are installing the server extensions. However, those performance
gains are mitigated when you bring the intended content back into the
Web again. You can also enhance performance by installing the server
extensions during non-peak hours when server demand is decreased.
<P>
<P><h3>Busy Web Server</h3>
 
<P>
If the Web server is heavily used, the FrontPage Server Extensions may
not be able to successfully complete a resource intensive operation
like publishing a Web. Note, however, that there are many other
reasons why publishing may not complete successfully, such as
unreliable modem connections to the Internet.
<P>
To work around this problem, establish a schedule where you publish
your Webs during non-peak hours when the server is not managing
resource intensive operations. As a further precaution, you may be
able to use staging servers to alleviate heavy loads on the production
server used for FrontPage authoring.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97<BR>
Keywords          : fpext fpiis kbenv kbusage kbdta<BR>
Version           : windows:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
