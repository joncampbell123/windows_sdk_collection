

<HTML>
<HEAD>
<TITLE>FP: VSS Source Control Project Box Does Not Appear in FrontPage </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160766">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1996/12/10">
<META NAME="Keywords" CONTENT="fpvss kbinterop kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  When you attempt to use Visual SourceSafe 5.0 and FrontPage Explorer together, you may receive unexpected results. Specifically, FrontPage Explorer will not display a Source Control Project box in the Web Settings dialog box.  There are six forms o...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDML,QAB4,QAAP,QBVV,QBG2,QABI,QAA1,QDH5,QBVX,QAKP,QA56,QA55,QAI5,QAVZ,QAMN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP: VSS Source Control Project Box Does Not Appear in FrontPage</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160766</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 97 for Windows with Bonus Pack
<LI>Microsoft Visual SourceSafe, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to use Visual SourceSafe 5.0 and FrontPage Explorer
together, you may receive unexpected results. Specifically, FrontPage
Explorer will not display a Source Control Project box in the Web Settings
dialog box.
<P>
There are six forms of this problem:
<P>
Case 1: You are using Microsoft Personal Web server for your Web Server.
<P>
Case 2: You see the following errors in the error log:
<P>
<PRE>   Microsoft FrontPage Server Extensions:
      (OS Error #-2147166146 Message:)
   Microsoft FrontPage Server Extensions:
   Error #90017 Message: Source Control System failure: File
   "srcsafe.ini" not found

</PRE>The specific file name in this error message will vary.
<P>
Case 3: You see the following error in the error log:
<P>
<PRE>   Microsoft FrontPage Server Extensions:
   Error #90017 Message: Source Control System failure: User
   &lt;your_user_account&gt; not found

</PRE>Case 4: You see the following errors in the error log:
<P>
<PRE>   Microsoft FrontPage Server Extensions:
     (OS Error #-2147467259 Message: Unspecified error)

   Microsoft FrontPage Server Extensions:
   Error #90017 Message: Source Control System failure: Could not find
   VSS resource DLL

</PRE>Although the error messages may vary, they will always begin with
"Source Control System Failure" or "Visual SourceSafe Failure."
<P>
Case 5: No error message (FrontPage 97 or Visual SourceSafe 5.0 beta)
<P>
Case 6: You see the following errors in the error log:
<P>
<PRE>   Microsoft FrontPage Server Extensions:
      (OS Error #-2147166135 Message: )

   Microsoft FrontPage Server Extensions:
      Error #90017 Message: Source Control System failure:
      Invalid handle.

</PRE>NOTE: All errors logged by FrontPage regarding SourceSafe integration are
logged at the server end of the transaction. On a Windows NT system, the
errors are logged in the "Windows NT Event Viewer Application" log. On a
computer running Windows 95, the errors are logged in the Frontpg.log file
located in the root of the drive to which Windows is installed. The errors
are not logged to the client machine.
<P>
<P><h2>CAUSE/WORKAROUND</h2>
 
<P>
<P><h3>Case 1: Microsoft Personal Web Server</h3>
 
<P>
Cause:
<P>
If you are using Microsoft Personal Web server for you Web Server, you
cannot use FrontPage and Visual SourceSafe together. Currently, this
configuration is unsupported.
<P>
<P><h3>Case 2: "Source Control System failure: File 'srcsafe.ini' not found"</h3>
 
<P>
Cause:
<P>
You did not enable SourceSafe Integration when you installed SourceSafe.
<P>
Workaround:
<P>
To resolve this problem, use the following steps:

<OL><P><LI>Start the SourceSafe installation program.

<P><LI>Select add/remove components, and make sure the "Enable SourceSafe
   Integration" check box is selected. (If it is not selected, click the
   check box to select it).

<P><LI>Complete the installation.
<P>
</OL>SourceSafe Integration should now be enabled.
<P>
<P><h3>Case 3: Source Control System failure: User &lt;your_user_account&gt; not found</h3>
 
<P>
Cause:
<P>
The FrontPage user account or the Internet Guest account (on IIS only) does
not have an account within the SourceSafe Administrator.
<P>
Workaround:
<P>
Start the Visual SourceSafe Administrator and make sure that your user
account has read/write permissions and, for an IIS server only, the
IUSR_&lt;machine_name&gt; (the Internet Guest) account has read permission within
Visual SourceSafe Administrator. Make sure the passwords for these accounts
are left blank.
<P>
<P><h3>Case 4: "Source Control System Failure", "Visual SourceSafe Failure" Errors</h3>
 
<P>
Cause:
<P>
If your Visual SourceSafe and your SourceSafe data are stored on an NTFS
drive, you may have not granted appropriate NTFS file system rights to the
FrontPage user account, to the Internet Guest account (for IIS), or to the
user account under which the web server operates.
<P>
Workaround:
<P>
In order to properly integrate FrontPage and Visual SourceSafe, assign
CHANGE permissions to all SourceSafe logon accounts for all files under the
Visual Source Safe installation directory (including the SourceSafe data
directory if it is in a different location).
<P>
Although tighter file restrictions may be possible, full SourceSafe
functionality may be jeopardized by tighter restriction. The installation
and check installation processes of FrontPage will only set permissions on
Ssapi.dll and the SourceSafe resource DLL (Ssus.dll on US English). The
installation process will not set permissions in other sections of the
SourceSafe directory hierarchy. These permissions must be set manually.
<P>
NOTE: It is assumed that the Administrators and System accounts will be
granted full control to the entire VSS directory hierarchy.
<P>
Grant at least read permissions to all SourceSafe logon accounts for the
following additional files:
<P>
<PRE>   srcsafe.ini
   um.dat
   users.txt

</PRE></OL>Grant at least read/write permissions to all SourceSafe logon accounts for
the following additional files or directories:
<P>
<PRE>   vss\users\&lt;logon account directory&gt;\
   vss\data\
   vss\temp\
   rights.dat
   status.dat

</PRE>If restricting permissions to this level restricts SourceSafe
functionality, assign change permissions to all SourceSafe logon accounts
for all files under the Visual Source Safe installation directory.
<P>
For more information about required levels of NTFS permissions for Visual
SourceSafe, see the Microsoft Visual Source Safe technical support Web site
at:
<P>
<PRE>   <B><A href="http://www.microsoft.com/ssafesupport/">http://www.microsoft.com/ssafesupport/</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE>FrontPage will log errors to the error log if the Internet Guest
Account (of IIS) does not have read permission to the following files
<P>
<PRE>   srcsafe.ini
   um.dat
   users.txt
   vss\users\&lt;Internet Guest Account directory&gt;\

</PRE>and has read/write permissions to
<P>
<PRE>   vss\data\loggedin\

</PRE>These errors will not affect the functionality of the integration. You can
ignore them or grant the rights to the Internet Guest account to stop the
errors.
<P>
<P><h3>Case 5: You Are Using FrontPage 97 or Visual SourceSafe 5.0 Beta</h3>
 
<P>
Cause:
<P>
The SourceSafe integration DLLs are either unregistered or are different
versions.
<P>
NOTE: The server's error log will not report errors in this case.
<P>
Resolution:
<P>
To resolve this problem, use the following troubleshooting techniques:

<UL><LI>Uninstall the beta versions and upgrade to the released versions.

<LI>Verify the following about the Fp20vss.dll and Fp20wel.dll files:
<P>
<P><PRE>    - There is only one of each of these files on your system.
</PRE><P>
<P><PRE>    - The Fp20wel.dll file is in %windir%\system and Fp20vss.dll
      is in the bin directory (the bin directory is located in the
      directory in which you installed of FrontPage).
</PRE><P>
<P><PRE>    - Fp20vss.dll and Fp20wel.dll have the same version number. (If
      the files do not have the same version number, uninstall
      FrontPage, rename any remaining Fp20*.dll files, and then reinstall
      the released version of FrontPage.)
</PRE><P>
<P><PRE>    - To see the version number of a .dll file in Windows, select the file
      and press ALT+ENTER. The version number will be displayed on the
      Version tab of the "&lt;File name&gt; Properties" dialog box.
</PRE>
<LI>Your Ssapi.dll should be version 05.00.2218 or later. If you have an
   earlier version of this file, contact SourceSafe support for
   information about how to obtain the updated file:
<P>
<P><PRE>      <B><A href="http://www.microsoft.com/ssafesupport/">http://www.microsoft.com/SSafeSupport/</A></B>
</PRE><P>
</UL><h3>Case 6: Source Control System failure: Invalid Handle Error</h3>
 
<P>
Cause:
<P>
The SourceSafe database is located on a different computer than the
one running IIS, and the Internet Guest account (typically IUSR_&lt;machine
name&gt;) does not have access permissions to the SourceSafe database.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>  ARTICLE-ID: <B><A href="../ssafe/q131022.htm">Q131022</A></B>
  TITLE     : INFO: Required Network Rights for the SourceSafe Directories  
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: vss<BR>
Keywords          : fpvss kbinterop kbdta<BR>
Version           : windows:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
