

<HTML>
<HEAD>
<TITLE>FP1: Upgrading Extensions to 1.1 Using Netscape UNIX Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153899">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1996/07/22">
<META NAME="Keywords" CONTENT="fpext kb3rdparty kbnetwork kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  The Permissions command does not function after you upgrade from FrontPage 1.0 to FrontPage 1.1 when you are using a Netscape UNIX server.  When you upgrade from FrontPage 1.0 to FrontPage 1.1 and if you are using a Netscape UNIX server, the permis...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QBW7,QAI5,QAOX,QBWG,QDNQ,QAY2,QAFF,QBWS,QAVV,QBXT,QBVV,QA5V,QAIB,QAQW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP1: Upgrading Extensions to 1.1 Using Netscape UNIX Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153899</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage for Windows, version 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Permissions command does not function after you upgrade from FrontPage
1.0 to FrontPage 1.1 when you are using a Netscape UNIX server.
<P>
When you upgrade from FrontPage 1.0 to FrontPage 1.1 and if you are using a
Netscape UNIX server, the permissions menu may not function on the upgraded
Web.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because FrontPage 1.0 does not require an access.cnf
file, but FrontPage 1.1 does. The access.cnf file contains server
permissions information. This file is not supplied when you upgrade the
Web.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, run the following UNIX Perl script on each
port. This will create the necessary access.cnf files in the root Web
and in each sub Web. The script is for use only with Webs running on UNIX
Netscape servers, and may be run either before or after the upgrade to 1.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the UNIX Perl script provided in this article to create the access.cnf
files in the root Web and in each sub Web.
<P>
To use the script:

<OL><P><LI>Copy the script to your UNIX server and name it "makeAccess" (without
   the quotation marks).

<P><LI>Run makeAccess with no parameters to see the help display on using this
   script.
<P>
</OL>You will need to run makeAccess once for each port.
<P>
<P><h3>UNIX PERL Script</h3>
 
<P>
#!/usr/local/bin/Perl
<P>
# To see the usage message, run makeAccess with no parameters
if ($#ARGV != 1)
{
print STDERR "Usage: makeAccess contentDir serverName\n";
print STDERR "Creates access.cnf file for root Web and each sub Web.\n";
print STDERR "\n";
print STDERR "contentDir is the full path name to the content directory\n";
print STDERR " for the root Web, with no trailing slash.\n";
print STDERR "\n";
print STDERR "serverName is the value of ServerName from the Netscape\n";
print STDERR "server config file in config/magnus.conf\n";
exit 1;
}
<P>
# Get command line args
$contentDir = shift;
$serverName = shift;
<P>
# Subroutine to create access.cnf file
<PRE>sub createAccess
</PRE></OL>{
<PRE>    local($accessDir, $passwordDir, $realm, $useRealm) = @_;

    $filename = "$accessDir/access.cnf";
    if (-s $filename)
    {
        # If there is already a non-empty access.cnf, don't overwrite it
        print STDERR "Directory \"$accessDir\" already has a non-empty
        access.cnf file\n";
        return;
    }

    open(OH, "&gt;$accessDir/access.cnf") || die("Could not open file
</PRE>\"$accessDir/access.cnf\" for writing\n  $!");
<PRE>    print OH "RealmName:$realm\n";
    if ($useRealm ne '')
    {
 print OH "UseRealm:$useRealm\n";
    }
    print OH "PasswordDir:$passwordDir\n";
    close OH;
    print STDOUT "Created file \"$accessDir/access.cnf\"\n";
</PRE>}
<P>
# Create access.cnf file for the root Web
$pvtDir = "$contentDir/_vti_pvt";
&amp;createAccess($pvtDir, $pvtDir, $serverName, "");
<P>
# Create access.cnf file for each sub Web
<P>
# Get list of sub Webs by reading services.cnf
$servicesFile = "$contentDir/_vti_pvt/services.cnf";
open(IH, "$servicesFile") ||
<PRE>    die("Could not open \"$servicesFile\" for reading\n
</PRE>$!");
@file = &lt;IH&gt;;
close(IH);
<P>
# Remove newline from each line
chop(@file);
<P>
# Get sub Web name from each line
foreach $line (@file)
{
<PRE>    $line =~ /(\S+)/;
    $Webname = $1;

    # Remove first slash
    $Webname =~ s/^\///;

    # Skip empty Web name (root Web or blank line)
    next
        if ($Webname eq '');

    # Look at .nsconfig file in _vti_adm
    $nsconfig =
</PRE>"$contentDir/$Webname/_vti_bin/_vti_adm/.nsconfig";
<PRE>    open(IH, "$nsconfig") ||
        die("Could not open \"$nsconfig\" for reading\n
</PRE>$!");
<PRE>    @require = grep(/RequireAuth/, &lt;IH&gt;);
    close(IH);

    # Get the realm value from the RequireAuth line of .nsconfig
    $req = $require[0];
    $req =~ /(realm=\")([^\"]+)(\")/;
    $nsrealm = $2;

    $accessDir = "$contentDir/$Webname/_vti_pvt";

    # If the realm from nsconfig is different from the Web name,
    # then we inherit permissions from the root Web
    if ($nsrealm ne $Webname)
    {
 # Inherit permissions from root Web
 $passwordDir = "$contentDir/_vti_pvt";
 $realm = $serverName;
 $useRealm = "";
    }
    else
    {
 # Unique permissions for sub Web
 $passwordDir = "$contentDir/$Webname/_vti_pvt";
 $realm = $Webname;
 $useRealm = "/$Webname";
    }

    &amp;createAccess($accessDir, $passwordDir, $realm,
</PRE>$useRealm);
}
<P>
 
<P>
The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: front page<BR>
Keywords          : fpext kb3rdparty kbnetwork kbdta<BR>
Version           : windows:1.1<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
