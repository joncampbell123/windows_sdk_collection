

<HTML>
<HEAD>
<TITLE>FP98: Hit Counter Doesn't Work in Subweb on Netscape Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181746">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/02/25">
<META NAME="Keywords" CONTENT="fpactive kb3rdparty kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  When you open a Web page that contains a hit counter, the counter does not increment past 1.  This behavior usually appears if the Web page is located in a subweb on a Windows NT Server and one of the following Netscape Web servers is running:     ...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALX,QAM9,QBWA,QBJZ,QAVZ,QASR,QBWS,QAJ3,QBQU,QBVX,QAFI,QA77,QAD7,QAVV,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP98: Hit Counter Doesn't Work in Subweb on Netscape Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181746</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 98 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a Web page that contains a hit counter, the counter does not
increment past 1.
<P>
This behavior usually appears if the Web page is located in a subweb on a
Windows NT Server and one of the following Netscape Web servers is running:
<P>
<PRE>   Netscape Fasttrack (All Versions)
   Netscape Enterprise (All Versions)

</PRE><h2>CAUSE</h2>
 
<P>
This behavior occurs because of how the Netscape Web server determines the name
(path) of a subweb passed to it. Specifically, the PATH_TRANSLATED parameter
does not consistently include a trailing slash. For additional information, see
the "More Information" section of this article.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, follow these steps:

<OL><P><LI>In FrontPage Explorer, create a new subweb in the Root Web. The URL
   should be similar to this
<P>
<P><PRE>      HTTP://&lt;Servername&gt;/&lt;Webname&gt;
</PRE><P>
   where &lt;Servername&gt; is the name of your Web server, and &lt;Webname&gt; is the
   name of the new subweb.

<P><LI>Start or switch to FrontPage Editor and open the home page.

<P><LI>Insert a hit counter, by following these steps:
<P>
<P><PRE>    a. On the Insert menu, point to Active Element, and click Hit Counter.
</PRE><P>
<P><PRE>    b. In the Hit Counter Properties dialog box, select the counter style
       you want, and click Ok.
</PRE>
<P><LI>On the File menu, click Save.

<P><LI>Look at the page in your Web browser. To do this, click Preview In
   Browser on the File menu.
<P>
   NOTE: You will see either of the following:
<P>
   - A broken image icon instead of the hit counter.
<P>
<P><PRE>     -or-
</PRE><P>
   - The hit counter will display 1 hit.
<P>
   If you reload or revisit this Web page, the hit counter will
   not increment past 1.

<P><LI>Promote the subweb to the Root Web by following these steps:
<P>
<P><PRE>    a. On the Windows Start menu, point to programs, and then click
       Windows NT Explorer.
</PRE><P>
<P><PRE>    b. Expand the _Vti_pvt folder in the Web server's content root.
       By default, the content root folder is located in the
       C:\Netscape\Suitespot\docs folder.
</PRE><P>
<P><PRE>    c. Double-click the Services.cnf file. It will open in Notepad.
</PRE><P>
<P><PRE>    d. Find your Web name and delete it from the list. The entry will
       look similar to the following
</PRE><P>
<PRE>          /&lt;Webname&gt;

       where &lt;Webname&gt; is the name you gave to your Web when you
       created it in Step 1.

    e. On the File menu, click Save.

    f. On the File menu, click Close.

   Your FrontPage Web has now been promoted to a subfolder in the Root Web.

</PRE><P><LI>Switch to FrontPage Explorer. Open the Root Web and then open
   the sub folder, &lt;Webname&gt;, that you created in Step 1.

<P><LI>In FrontPage Editor, open the page that contains the hit counter
   and delete the hit counter. Reinsert the hit counter, by following these
   steps:
<P>
<P><PRE>    a. On the Insert menu, point to Active Element, and click Hit Counter.
</PRE><P>
<P><PRE>    b. In the Hit Counter Properties dialog box, select the counter style
       you want, and click Ok.
</PRE>
<P><LI>Open the page in your Web browser, using the URL from Step 1. Note that
   when the page loads, the hit counter will be working correctly. If you
   reload or revisit the page, the hit counter will increment correctly.

<P><LI>In FrontPage Explorer, create a new Web by following these steps:
<P>
<P><PRE>    a. On the File menu, point to New, and then click FrontPage Web.
</PRE><P>
<P><PRE>    b. Click From Wizard Or Template. In the list of templates,
       click Empty Web.
</PRE><P>
<P><PRE>    c. In step 2, type the title you want to use for your Web and click OK.
</PRE><P>
<P><PRE>    d. In the Choose a title for your FrontPage Web box, type the title
       you used in step 1.
</PRE><P>
<P><PRE>    e. Click OK.
</PRE><P>
<P><PRE>    The content from the Web you created in Step 1 will be imported
    automatically from the subfolder in the Root Web into the new
    subweb. The hit counter will continue to function correctly.
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Netscape servers listed in the "Symptoms" section of this article
intermittently change the query string that is constructed by the hit counter
and passed to Fpcount.exe.
<P>
Following are examples of query strings that are constructed by the hit counter
and then passed to Fpcount.exe, and how the Netscape server determines the
location of the file that contains the hit counter information.
<P>
<P><h3>For Hit Counters on Pages in the Root Web</h3>
 
<P>
If the hit counter is on a page in the Root Web, the hit counter constructs the
following query string and passes this string to Fpcount.exe:
<P>
<PRE>   _vti_bin/fpcount.exe/?Page=hitcounttest.htm|Image=4

</PRE></OL>In this example, the Netscape Enterprise server correctly determines the
location of the file that contains the hit counter information and constructs
the path like this:
<P>
<PRE>   C:/Netscape/Server/docs/_private/hitcounttest.htm.cnt

</PRE><h3>For Hit Counters on Pages in a Subweb</h3>
 
<P>
If the hit counter is on a page in a subweb, the hit counter constructs the
following query string and passes this string to FPcount.exe:
<P>
<PRE>   _vti_bin/fpcount.exe/myweb/?Page=hitcounttest.htm|Image=4

</PRE>In this example, the query string is structured in such a way that the subweb is
not included. As a result, the Netscape Enterprise server incorrectly
determines the location of the file that contains the hit counter information
and constructs the path like this:
<P>
<PRE>   C:/Netscape/Server/docs/myweb_private/hitcounttest.htm.cnt

</PRE>Because this path refers to a file that does not exist in the content root, the
hit counter will not work in a subweb on a Netscape Enterprise NT.
<P>
In this example, the correct location for the file that contains the hit counter
information should be:
<P>
<PRE>   C:/Netscape/Server/docs/myweb/_private/hitcounttest.htm.cnt

</PRE>The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Hit Counter Increment Subweb Sub<BR>
Keywords          : fpactive kb3rdparty kbdta<BR>
Version           : WINDOWS:98<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
