

<HTML>
<HEAD>
<TITLE>FP98: How to Use Active Server Pages to Calculate Form Results </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180824">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/02/10">
<META NAME="Keywords" CONTENT="fpscript kbdta">
<META NAME="KBArea" CONTENT="Support; KB; frontpg">
<META NAME="Description" CONTENT="  Microsoft FrontPage includes a Save Results Form Handler that you can use to save information submitted from a form to a text file. You can also use Active Server Pages (ASP) to save submitted information to a file. This might be desirable if the F...">
<META NAME="Product" CONTENT="FrontPage">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBJZ,QA7O,QAGI,QAUR,QBWS,QBSO,QBQU,QBT6,QBRZ,QAGE,QBV4,QA50,QAPN,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FP98: How to Use Active Server Pages to Calculate Form Results</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180824</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft FrontPage 98 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft FrontPage includes a Save Results Form Handler that you can use to
save information submitted from a form to a text file. You can also use Active
Server Pages (ASP) to save submitted information to a file. This might be
desirable if the FrontPage Server Extensions are not installed on the server or
if calculations, such as computing sales tax, need to be performed on the
submitted data.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Before you can use ASP, you must install the ASP engine on the Web server. The
ASP engine can be found in the \60 Minute Intranet Kit\60 Minute Intranet
Kit\Modules folder on the FrontPage 98 compact disc.
<P>
For more information about installing ASP, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../frontpg/q174185.htm">Q174185</A></B>
   TITLE     : FP98: ASP Code Displayed in Browser

</PRE>To use Active Server Pages to save the results of a form to a text file, follow
these steps:

<OL><P><LI>On the Windows Start menu, point to Programs, and click Windows Explorer. In
   Windows Explorer, create a folder on the C: drive called "public" (without
   the quotation marks).

<P><LI>Start FrontPage Explorer. Open or create a new FrontPage Web. To do this,
   point to New on the File menu, and then click FrontPage Web.

<P><LI>Create a folder in FrontPage Explorer. To do this, follow these steps:
<P>
<P><PRE>    a. On the View menu, click Folders.
</PRE><P>
<P><PRE>    b. On the File menu, point to New, and click Folders.
</PRE><P>
<P><PRE>    c. Name the folder "Scripts" (without the quotation marks).
</PRE>
<P><LI>Right-click the Scripts folder and click Properties on the menu that appears.

<P><LI>In the Properties dialog box, click "Allow scripts or programs to be run,"
   and then click OK.

<P><LI>On the Tools menu, click Show FrontPage Editor.

<P><LI>Click the HTML tab at the bottom of the window and then enter the
   following Microsoft Visual Basic Scripting Edition (VBScript) code
   between the &lt;body&gt; and &lt;/body&gt; tags.
<P>
   NOTE: The FileSystemObjects constants are required in order for
   this example to work.
<P>
<P><PRE>      &lt;H3&gt; Thank you for submitting your information &lt;/H3&gt;
      &lt;%
      '-----------------------------------------------------
      ' FileSystemObject constants include file for VBScript
      '-----------------------------------------------------
</PRE><P>
<P><PRE>      '---- iomode Values ----
      Const ForAppending = 8
      Const ForReading = 1
      Const ForWriting = 2
</PRE><P>
<P><PRE>      '---- format Values ----
      Const TristateFalse = 0
      Const TristateMixed = -2
      Const TristateTrue = -1
      Const TristateUseDefault = -2
</PRE><P>
<P><PRE>      ' If the file already exists, then an error will be generated.
      ' This line permits the program to continue executing on error.
      ' Resume next.
      ' Create the scripting object.
      set objfso = createobject("scripting.FileSystemObject")
</PRE><P>
<P><PRE>      ' Create the text file. If the file already exists, then an error
      ' will be generated.
      set myobject = objfso.createtextfile("c:\public\myfile.txt", false)
</PRE><P>
<P><PRE>      ' Open the file for scripting.
      set myobject = objfso.opentextfile("c:\public\myfile.txt", forappending )
</PRE><P>
<P><PRE>      'Calculate the total price.
      quantity = request.form("quantity")
      price = request.form("price")
      totalprice = quantity * price
</PRE><P>
<P><PRE>      ' Assign the submitted form results to a variable.
      productdata = request.form("name") &amp; "," &amp; request.form("product") &amp; "," &amp;
      request.form("quantity") &amp; "," &amp; request.form("price") &amp; "," &amp; totalprice
</PRE><P>
<P><PRE>      ' Write the form results to the file.
      myobject.writeline(productdata)
</PRE><P>
<P><PRE>      ' Close the object.
      myobject.close
      %&gt;
</PRE>
<P><LI>Save the file and name it "Submit.asp" (without the quotation marks).
   Save the file in the Scripts folder that you created in Step 3.

<P><LI>Create the form by following these steps:
<P>
<P><PRE>    a. In FrontPage Editor, create a new page. To do this, click New on
       the File menu, click the Page tab, select Normal Page, and click OK.
</PRE><P>
<P><PRE>    b. On this page, create a form with four one-line text boxes, and
       insert a Submit button. To insert the form field, point to Form
       Field on the Insert menu and then click One-Line Text Box.
</PRE><P>
<P><PRE>       NOTE: The Submit button will automatically appear the first time
       you insert a form field.
</PRE><P>
<P><PRE>    c. Name the four text-boxes "Name," "Product," "Price," and
       "Quantity"(without the quotation marks) respectively. To do this,
       right-click a text box and then click Form Field Properties on
       the menu that appears. The names must match the names referred
       to by the Request.form statements in Step 6.
</PRE>
<P><LI>Set the form to execute the ASP file (Submit.asp), by following these
   steps:
<P>
<P><PRE>    a. Right-click the form and then click Form Properties on the menu
       that appears.
</PRE><P>
<P><PRE>    b. Click Send To Other.
</PRE><P>
<P><PRE>    c. In the Send To Other list, click "Custom ISAPI, NSAPI, CGI, or ASP
       Script."
</PRE><P>
<P><PRE>    d. Click Options.
</PRE><P>
<P><PRE>    e. In the Action box in the "Options for Custom Form Handler" dialog
       box, type the following:
</PRE><P>
<PRE>          Scripts/submit.asp

</PRE><P><LI>Save the file in the root of the Web and name it "Default.htm" (without
<P><PRE>    the quotation marks).
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about VBScript constants, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../axsf/q163009.htm">Q163009</A></B>
   TITLE     : Values for Scripting Object Constants Defined
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 98<BR>
Keywords          : fpscript kbdta<BR>
Version           : WINDOWS:98<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
