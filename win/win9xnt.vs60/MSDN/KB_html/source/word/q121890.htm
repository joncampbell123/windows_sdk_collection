

<HTML>
<HEAD>
<TITLE>WD: Macro: Displaying a List of Directories </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121890">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/10/20">
<META NAME="Keywords" CONTENT="kbmacroexample macword ntword winword word6 word7 word8 word95 word97 wordnt macword98">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The Microsoft WordBasic CountDirectories() and GetDirectory$() functions can be used to assemble a list of directory names within the current directory.  For information and examples about how to perform this function in Word 97 for Windows or Word...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBXB,QATJ,QAFI,QAH4,QAKE,QAUJ,QA01,QA5F,QDL9,QBWQ,QBWO,QBWN,QAPF,QAFF P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Macro: Displaying a List of Directories</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121890</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
<LI>Microsoft Word 98 Macintosh Edition
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft WordBasic CountDirectories() and GetDirectory$() functions
can be used to assemble a list of directory names within the current
directory.
<P>
For information and examples about how to perform this function in Word 97
for Windows or Word 98 Macintosh Edition, from the Visual Basic for
Applications Editor, click the Office Assistant, type "Dir," click Search,
and then click to view "Dir."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office Program or 
               Component

</PRE><h2>MORE INFORMATION</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
The following example macro inserts the directory names from the current
directory into a new document window:
<P>
<PRE>   Sub MAIN
      FileNewDefault
      num  = CountDirectories()
      For i = 1 To num
         Insert GetDirectory$(i)
         InsertPara
      Next i
   End Sub

</PRE>The following example macro determines how many directories stem from the
current directory and defines an array named SubDirs$() to hold the
directory names:
<P>
<PRE>   Sub MAIN
      REM Define an array for the directory names
      Dim subdirs$(CountDirectories())
      subdirs$(0) = "[..]"
      For i = 1 To CountDirectories()
         subdirs$(i) = LCase$(GetDirectory$(i))
      Next
      REM Sort the array of directories and display them in a list box.
      SortArray subdirs$()
      Begin Dialog UserDialog 396, 154, "Directories Available"
         OKButton 254, 88, 88, 21
         CancelButton 254, 113, 88, 21
         ListBox 18, 21, 215, 114, subdirs$(), .ListBox1
      End Dialog
      Dim dlg As UserDialog
      n = Dialog(dlg)
   End Sub

</PRE>NOTE: The disk that accompanies the Word Developer's Kit includes a macro
that allows you to browse through files in any directory. The macro uses a
dynamic dialog box to display a file and directory list similar to the Open
dialog box in Word. The macro is named ch05ex06FileBrowser and is located
in the Examples.dot file.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Word Developer's Kit," version 6.0, page 128-130
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:  GetDirectory$() Array Subdirectory <BR>
CountDirectories<BR>
Keywords          : kbmacroexample macword ntword winword word6 word7 word8 word95 word97 wordnt macword98 kbmacro<BR>
Version           : WINDOWS:6.0,6.0a,6.0c,7.0,7.0a,97; MACINTOSH:6.0,6.0.1,6.0.1a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
