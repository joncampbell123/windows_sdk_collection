

<HTML>
<HEAD>
<TITLE>WD: WordBasic Macros to Test for Annotations and Footnotes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89653 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/09/28">
<META NAME="Keywords" CONTENT="kbmacroexample macword ntword winword word6 word7 word95 wordnt">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Word, the ViewFootnotes and ViewAnnotations macro commands will return the following error messages if there are no annotations or footnotes in the active document:     Word found no footnotes    Word found no annotations  To avoid the...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QAVX,QAVW,QAP3,QANU,QAB4,QAB9,QBV8,QDL9,QBWQ,QBWO,QBWN,QDO7,QDO9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: WordBasic Macros to Test for Annotations and Footnotes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89653 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Word, the ViewFootnotes and ViewAnnotations macro commands
will return the following error messages if there are no annotations or
footnotes in the active document:
<P>
<PRE>   Word found no footnotes
   Word found no annotations

</PRE>To avoid the above error messages you can test for the presence of
footnotes or annotations in a document before using the ViewFootnotes
or ViewAnnotations commands.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR
OWN RISK. Microsoft provides this macro code "as is" without warranty of
any kind, either express or implied, including but not limited to the
implied warranties of merchantability and/or fitness for a particular
purpose.
<P>
The following Word macro will test for the presence of automatic footnotes
in your document:
<P>
Note: This macro will not work with Word version 6.0 for the Macintosh. The
CommandValid()function does not work with the ViewFootnotes command. The
macro does work with Word version 6.0.1 for the Macintosh.
<P>
<PRE>   Sub MAIN
      n = CommandValid("ViewFootnotes")
      If n &lt;&gt; - 1 Then
         MsgBox "There are no footnotes in this document."
      Else
         StartOfDocument
         EditFind .Find = "^f", .Direction = 0
         If EditFindFound() Then
            MsgBox "There are footnotes in this document"
         Else
            MsgBox "There are no footnotes in this document."
         End If
      End If
   End Sub

</PRE>If you are using Word version 2.x for Windows, change the EditFind
statement in the above macro to the following:
<P>
<PRE>   EditFind .Find = "^2", .Direction = 2

</PRE>The following Word macro will test for the presence of annotations in your
document:
<P>
<PRE>   Sub MAIN
      n = CommandValid("ViewAnnotations")
      If n &lt;&gt; - 1 Then
         MsgBox "There are no annotations in this document."
      Else
         StartOfDocument
         EditFind .Find = "^a", .Direction = 0
         If EditFindFound() Then
            MsgBox "There are annotations in this document"
         Else
            MsgBox "There are no annotations in this document."
         End If
      End If
   End Sub

</PRE>If you are using Word version 2.x for Windows, change the EditFind
statement in the above macro to the following:
<P>
<PRE>   EditFind .Find = "^5", .Direction = 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Macro Notes</h3>
 

<UL><LI>The CommandValid command returns -1 if the "ViewAnnotations" or
   "ViewFootnotes" commands are available. In addition to checking
   whether the appropriate View command is valid, the above macros use
   the EditFind command to search for footnotes or annotation
   reference marks.

<LI>The .Find argument in the EditFind command uses "^f" to find
   automatic footnote reference marks and "^a" to find annotation
   reference marks.

<LI>The EditFindFound function tests whether a footnote reference
   or annotation reference was found in the above macros. You can
   replace the MsgBox commands with the logical branches of your
   macro.
<P>
</UL>For information about how to do this in Word 97 for Windows or Word 98
Macintosh Edition, please see the following article(s) in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q158854.htm">Q158854</A></B>
   TITLE     : WD97: Compile Error If VB Code Doesn't Find Comments

</PRE><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, page 325 and 327
<P>
"Microsoft Word for Windows User's Guide," version 2.0, pages 265-266
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword2 word95 word7 word6 errmsg err msg<BR>
viewannotations viewfootnotes macword winword<BR>
Keywords          : kbmacroexample macword ntword winword word6 word7 word95 wordnt<BR>
Version           : WINDOWS:2.0,2.0a,2.0a-CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.6.0.1a<BR>
Platform          : MACINTOSH Win95 WINDOWS winnt<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
