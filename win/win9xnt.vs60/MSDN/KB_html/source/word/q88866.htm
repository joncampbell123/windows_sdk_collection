

<HTML>
<HEAD>
<TITLE>WD: Macro to Determine If a File Exists on Disk </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88866 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/09/02">
<META NAME="Keywords" CONTENT="kbfield macword macword5 winword kbmacro kbprint">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following macro examples determine if a specified file exists in the current directory.  These macros can help you avoid receiving error messages such as  File not found  and  Document does not exist  when you open or delete specific files usin...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBS0,QAH4,QAFI,QAHD,QAUD,QAFF,QBVV,QA5F,QAMA,QAB4,QAKE,QDO9,QBBI,QAVX P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Macro to Determine If a File Exists on Disk</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88866 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, 2.0a,
   2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word 97 for Windows
<LI>Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
<LI>Microsoft Word 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following macro examples determine if a specified file exists in the
current directory.
<P>
These macros can help you avoid receiving error messages such as
"File not found" and "Document does not exist" when you open or delete
specific files using Visual Basic for Applications or WordBasic.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Visual Basic for Applications</h3>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
This example uses the Dir function to check if a certain file exists.
<P>
Dir Function Syntax:
<P>
<PRE>   Dir[(pathname[,attributes])]

</PRE>Word 97 for Windows:
<P>
<PRE>   Sub DoesFileExist()
      Dim MyFile, MyPath, MyName
      ' Returns "WIN.INI" if it exists.
      MyFile = Dir("C:\WINDOWS\WIN.INI")
      If MyFile &lt;&gt; "" Then MsgBox "File Exists."
   End Sub

</PRE>Word 98 Macintosh Edition:
<P>
<PRE>   Sub DoesFileExist()
      Dim MyFile, MyPath, MyName
      ' Returns "My Document" if it exists.
      MyFile = Dir("HD:MyDocs:My Document")
      If MyFile &lt;&gt; "" Then MsgBox "File Exists."
   End Sub

</PRE>NOTE: To avoid getting an error, you must specify pathname the first time
you call the Dir function.
<P>
Dir returns the first file name that matches pathname. When no more file
names match, Dir returns a zero-length string (""). Once a zero-length
string is returned, you must specify pathname in subsequent calls or an
error occurs.
<P>
For more information about the Dir Function, while in the Visual Basic for
Applications Editor, click the Office Assistant, type "Dir" (without the
quotation marks), click Search, and then click to view "Dir Function."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Visual Basic Help is not installed on your
computer, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component

</PRE><h3>WordBasic</h3>
 
<P>
<PRE>   Macro 1:

   Sub MAIN
      a$ = Files$("TEST.TXT")
      If a$ &lt;&gt; "" Then MsgBox "File Exists", a$
   End Sub

   Note: The Files$ command will return a null string ("") if the
   specified file is not found.

   Macro 2:

   Sub MAIN
      ChDir "C:\WinWord"                    'Change current directory
      a$ = Files$("newmacro.doc")
      If a$ = "NEWMACRO.DOC" Then MsgBox "File Exists", a$
      ' The above filename within the If statement must be uppercase
   End Sub

   Note: Word 6 for the Macintosh users, be sure to include a valid
   Macintosh path.

   For example:

      "Mac HD:Microsoft Word 6:Test Document"

</PRE>The following macro tests whether the "Test1.doc" file exists in the
current directory before using the WordBasic Kill command to delete
the file named "Test1.doc".
<P>
<PRE>   Sub MAIN
      a$ = Files$("TEST1.DOC")
      If a$ &lt;&gt; "" Then Kill a$
   End Sub

</PRE>WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, page 207
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: word7 winword word95 word6 winword2 files<BR>
macword word8 word97<BR>
Keywords          : kbfield macword macword5 winword kbmacro kbprint<BR>
Version           : WINDOWS: 1.0, 1.1, 1.1a, 2.0, 2.0a, 2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c, 7.0, 7.0a, 97; MACINTOSH:3.0,3.01,3.02, 4.0, 5.0, 5.1;<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
