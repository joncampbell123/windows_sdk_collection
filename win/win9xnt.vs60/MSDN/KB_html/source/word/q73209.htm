

<HTML>
<HEAD>
<TITLE>WD: Variable Assigned to Comments Field Limited to 127 Character </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73209 ">
<META NAME="KBModify" CONTENT="1998/01/30">
<META NAME="KBCreate" CONTENT="1991/06/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you assign a string variable to the value of the comment field by dimensioning the EditSummaryInfo dialog box in a Microsoft Word for Windows macro, you can only retrieve the first 127 characters from the Comments field.  STATUS ======  Microsof...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QAMB,QAIH,QA7O,QAYL,QAH4,QDL9,QBWQ,QBWO,QBWN,QAFF,QAEF,QACI,QANU,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Variable Assigned to Comments Field Limited to 127 Character</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73209 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you assign a string variable to the value of the comment field by
dimensioning the EditSummaryInfo dialog box in a Microsoft Word for
Windows macro, you can only retrieve the first 127 characters from the
Comments field.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of
Microsoft Word for Windows listed above. This problem was corrected
in Word version 6.0 for Windows.
<P>
To obtain pre-sales information about new or updated Microsoft products,
call the Microsoft Sales Information Center at (800) 426-9400. If you are
outside the United States, contact the Microsoft subsidiary for your area.
To locate your subsidiary, see the Microsoft World Wide Offices Web site
at:
<P>
<PRE>   <B><A href="http://www.microsoft.com/worldwide/default.htm">http://www.microsoft.com/worldwide/default.htm</A></B>

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Comments field in the Summary Info dialog box can hold up to 256
characters. However, if you assign a string variable to the value of
the Comments field (as in the following macro), only the first 127
characters are assigned.
<P>
<P><h3>Word for Windows versions 1.0, 1.1 and 1.1a</h3>
 
<P>
<PRE>Sub MAIN
</PRE>Dim dlg as EditSummaryInfo
GetCurValues dlg
A$ = dlg.Comment
<PRE>End Sub

</PRE> 
<P>
<PRE>Sub MAIN
</PRE>DIM dlg as FileSummaryInfo
GetCurValues dlg
A$=dlg.Comment
<PRE>End Sub

</PRE>If you run this macro, A$ only contains the first 127 characters of
the information in the document's Comments field.
<P>
<P><h3>Workaround</h3>
 
<P>
You can extract more than the first 127 characters from the Comments
field with the following macro:
<P>
<PRE>Sub MAIN
</PRE>EndOfDocument
InsertField "comments"
CharLeft 1,1
UpdateFields
Dim dlg as ViewPreferences
GetCurValues dlg
If dlg.ShowAll Then Super ShowAll
ViewFieldCodes 0
A$=Selection$()
EditClear
<PRE>End Sub

</PRE>This macro moves the insertion point to the end of the document and
inserts the {comments} field code. Once inserted, it is highlighted,
updated to the current value, stored in A$, and removed from the
document. So that A$ is assigned the result of the {comments} field
instead the name of the field itself, the macro also clears the Show
All and Field Codes options to ensure that the result of the field is
displayed rather than the field code itself.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows and OS/2 Technical Reference," pages
163-164
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:   1.0 1.0 1.10 1.1 1.1a winword2 word6<BR>
winword 1.10a 2.0 2.0<BR>
 fixlist6.0<BR>
Version           : 1.x 2.0 2.0a 2.0b 2.0c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
