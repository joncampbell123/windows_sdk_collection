

<HTML>
<HEAD>
<TITLE>WD: A Field Calculation Error Occurred in Record . . . </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120278">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1994/09/07">
<META NAME="Keywords" CONTENT="kbfield kbmerge macword winword word6 word7 word95 word97 kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Word for Windows  The error message  A field calculation error occurred in record #  (where # is every record number) may appear when you use an IF field to include files whose names are specified in other merge fields, and any of the merge fields ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA7O,QA7N,QA5V,QAB4,QBRG,QAAP,QBL4,QAVM,QAP2,QDME,QDO9,QA5S,QAXB,QBD2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: A Field Calculation Error Occurred in Record . . .</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120278</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
<P><h3>Word for Windows</h3>
 
<P>
The error message "A field calculation error occurred in record #" (where #
is every record number) may appear when you use an IF field to include
files whose names are specified in other merge fields, and any of the merge
fields specified is blank.
<P>
The following is a sample statement that will exhibit this problem
<P>
<PRE>   {IF {MERGEFIELD contribution} &gt; 1000 {INCLUDETEXT {MERGEFIELD thanks}}
   {INCLUDETEXT {MERGEFIELD give_more}} }

</PRE>where "thanks" and "give_more" are fields in the data document that contain
names of files to be included, and either of the fields is blank.
<P>
<P><h3>Word for the Macintosh</h3>
 
<P>
In Word 6.0 for the Macintosh, when using an INCLUDETEXT field to include a
document, if the path is not enclosed by quotation marks, the error message
"A field calculation error occurred in record #" will appear. The following
is an example that will give the error:
<P>
<PRE>   {IF {MERGEFIELD No} &gt; 1 "{INCLUDETEXT Mac HD:Desktop Folder:Doc 1}
   "{INCLUDETEXT Mac HD:Desktop Folder:Doc 2}" }

</PRE>Also, if there are any extra spaces in the path statement, the same error
will appear. In the example above, if there is a space inserted after
either ":" (colon), the error will appear, regardless of whether the
quotation marks are used.
<P>
<P><h2>CAUSE</h2>
 
<P>
This happens because of the order in which fields are updated. Innermost
fields are updated first, and they are updated from left to right. Thus,
{MERGEFIELD thanks} is the first field evaluated. If it is blank, Word
cannot finish evaluating the field. If it contains text but {MERGEFIELD
give_more} does not, the IF field still cannot be evaluated.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Change the data document to always refer to two files. Create a file with
just one character in it, and refer to this field in the previously blank
field of the data document.
<P>
For example, create a new file and type one character in it. Save the file
as Blank.doc. In those records that don't contain any typing in the Thanks
field, type Blank.doc. In those records that don't contain typing in the
give_more field, type Blank.doc. Word can update both merge fields and will
include the correct file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.0 8.00<BR>
Keywords          : kbfield kbmerge macword winword word6 word7 word95 word97 kberrmsg<BR>
Version           : WINDOWS:6.0,6.0a,6.0c,7.0,7.0a,97; MACINTOSH:6.0,6.0.1,6.0.1a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
