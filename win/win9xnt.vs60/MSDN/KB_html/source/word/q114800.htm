

<HTML>
<HEAD>
<TITLE>Troubleshooting GP Faults in Word 2.x and 6.0 for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114800">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1994/05/12">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This document presents a systematic approach to eliminating general protection (GP) fault error messages in Word for Windows.  MORE INFORMATION  WHAT IS A GENERAL PROTECTION (GP) FAULT?  A GP fault signifies that something unexpected has happened w...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAIH,QDL9,QBWN,QBWQ,QAIJ,QBFY,QBWS,QBXS,QANE,QAA1,QBJZ,QDI2,QAKP,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting GP Faults in Word 2.x and 6.0 for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114800</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00 2.00a 2.00a-CD 2.00b 2.00c 6.00 6.00a 6.00c
WINDOWS
kbusage kberrmsg kbtshoot
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Windows operating system versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This document presents a systematic approach to eliminating general
protection (GP) fault error messages in Word for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>WHAT IS A GENERAL PROTECTION (GP) FAULT?</h3>
 
<P>
A GP fault signifies that something unexpected has happened within the
Windows environment, typically an improper memory access. For example, an
application or a Windows component might read or write to a memory location
that has not been allocated to it (memory that it does not "own"),
potentially overwriting and corrupting other program code in that area of
memory.
<P>
For more specific information about troubleshooting system level General
Protection Faults as well as a technical overview of the problem, refer to
the Windows Application note "WW0524: Troubleshooting GP Faults (UAEs)".
<P>
For information on how to obtain this application note, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win3x/q95505.htm">Q95505</A></B>
   TITLE     : WW0524: Troubleshooting GP Faults (UAEs)

</PRE><h3>RESTARTING</h3>
 
<P>
Depending on the severity of a GP fault in Windows 3.1, you can press
CTRL+ALT+DEL to display information concerning system integrity and the
application that caused the fault. When you press CTRL+ALT+DEL after a less-
severe fault occurs, the following message appears:
<P>
<PRE>   System has either become busy or has become unstable
    - Press any key to return to Windows and wait
    - Press CTRL+ALT+DEL again to restart your computer (all unsaved
      information will be lost)

</PRE>If the system hangs because of a severe GP fault and you get this message,
you can return to Windows and wait for the system to recover, but you will
probably have to restart the computer. When you press CTRL+ALT+DEL after a
more-severe fault occurs, the following message appears:
<P>
<PRE>   This Windows application has stopped responding to the system
     - Press ESC to cancel and return to Windows
     - Press ENTER to close this application (all unsaved information
       will be lost)
     - Press CTRL+ALT+DEL again to restart your computer (all unsaved
       information will be lost)

</PRE>When you get this error message, you can usually press the ESC key to
return to your application and save your work (if possible) or press the
ENTER key to close the application and return to Windows; this is known as
a local restart. Once you have saved your work or returned to Windows, quit
Windows and restart your computer to prevent additional GP faults.
<P>
<P><h3>GETTING CLUES FROM THE ERROR MESSAGE</h3>
 
<P>
The first clue as to the cause of the GP fault is in the General Protection
Fault message that is displayed. Note the module name that is displayed
after you choose the Close button.
<P>
The first message will say:
<P>
<PRE>   An Error Has Occurred in Your Application

</PRE>Choose the Close button, and another message will appear:
<P>
<PRE>   ...General Protection Fault in Module &lt;module name&gt; at &lt;memory
   address&gt;...

</PRE>Note the module name that is listed. If the module name is Winword.exe,
then you must continue searching for the cause. Sometimes, the module name
may be a printer driver file or a video driver file. Sometimes, removing
and reinstalling the file mentioned corrects the problem. If this does not
correct the problem, or if you are unsure as to what the file is, continue
troubleshooting.
<P>
<P><h3>DETERMINING THE SCOPE OF THE PROBLEM</h3>
 
<P>
There are 4 circumstances in which General Protection Faults occur:

<UL><LI>The problem seems to be related to opening or editing one particular
   document.

<LI>The problem occurs when starting Word.

<LI>The problem occurs randomly or when executing a particular command.

<LI>None of the above describes the problem.
<P>
</UL><h3>Case 1</h3>
 
The problem seems to be related to opening or editing one particular
document.
<P>
If the error message only occurs when working with a particular document,
that file may be damaged or corrupt. For information, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q87856.htm">Q87856</A></B>
   TITLE     : Troubleshooting Corrupted Documents in Word for Windows

</PRE><h3>Case 2</h3>
 
The problem occurs when starting Word.
<P>
A. Setting Word Back To The Default Settings
<P>
<PRE>   It is possible that the Word initialization file or the Normal template
   has become damaged. To correct this, follow these steps:

   For Word 6.0
   ------------

   Note: Instructions for Word 2.x appear after the Word 6.0 instructions.

   1. From the Windows Program Manager Main group, start File Manager.

   2. On the left side of the window, double-click the Word for Windows
      folder.

   3. On the right side of the window, click the WINWORD.OPT file once to
      select it.

   4. From the File menu, choose Rename.

   5. Rename the file to WINWORD.OLD (or some other name).

   6. On the left side of the window, double-click the TEMPLATE directory.

   7. On the right side of the Window, click the NORMAL.DOT file once to
      select it.

   8. From the File menu, choose Rename.

   9. Rename the file to NORMAL.OLD (or some other name).

   10.Exit the File Manager, restart Word, and test the document. If the
       error still occurs, continue troubleshooting.

   For Word 2.x
   ------------

   1. From the Windows Program Manager Main group, start File Manager.

   2. On the left side of the window, double-click the Word for Windows
      folder.

   3. On the right side of the window, click the WINWORD.INI file once to
      select it.

   4. From the File menu, choose Rename.

   5. Rename the file to WINWORD.OLD (or some other name).

   6. On the right side of the window, click the NORMAL.DOT file once to
      select it.

   7. From the File menu, choose Rename.

   8. Rename the file to NORMAL.OLD (or some other name).

   9. Exit the File Manager, restart Word, and test the document. If the
      error is still occurring, continue troubleshooting.

</PRE>B. Checking the video driver
<P>
<PRE>   1. From the Windows Program Manager Main Group, choose the Windows
      Setup icon.

   2. If the Display is set to VGA, continue with the next section of
      troubleshooting.

   3. From the Options menu, choose Change System Settings.

   4. From the Display list, choose VGA (not VGA 3.0).

   5. Choose the OK Button.

   6. Choose the Current Button (or insert the requested Windows disk in
      your floppy disk drive).

   7. Choose the Restart Windows option.

   8. Once Windows is restarted, start Word and see if the problem is
      corrected. If the problem is corrected, you may need to reinstall
      your video driver, or you may need to contact the manufacturer of
      the video driver for an update. If the problem is not corrected,
      continue on with the troubleshooting.

</PRE>C. Checking the printer driver
<P>
<PRE>   1. From the Windows Program Manager Main Group, choose Control Panel.

   2. Choose the Printers Icon.

   3. If you are using a PostScript Printer, install the HP LaserJet III
      driver, or choose any non-PostScript printer and make it your
      default printer.

      If you are not using a PostScript printer, install a PostScript
      printer driver (such as the Apple Laserwriter), or any PostScript
      printer and make it your default printer.

   4. Start Word and see if the problem is corrected. If the problem is
      not corrected, continue with the troubleshooting. If the problem is
      corrected, you will need to delete the printer driver using the File
      Manager and reinstall the driver from your disks.

</PRE>D. Checking for corrupt Autosave files
<P>
<PRE>   The Word for Windows AUTOSAVE feature can be used to create emergency
   backup copies of documents. Word will automatically try to load any
   Autosave documents when it starts. To see if this may be causing your
   problems:

   1.  Open File Manager

   2.  Choose File\Search

   3.  In the Search For box, type "*.ASD"  (without the quotes)

   4.  Set the Start From box to C:\  (or whichever drive Word is
      installed on)

   5.  Check the "Search All Subdirectories" box, Click OK

   6.  Delete any found Autosave files

</PRE>E. Checking the Word startup group (Word 6.0x only)
<P>
<PRE>   1. From the FILE menu in Program Manager, Choose Run

   2. Type &lt;path to Winword directory&gt;\WINWORD.EXE /a

   3. Click OK

   If Word now runs successfully, the problem is possibly an item in the
   Word Startup group. To remove these any items there open the Startup
   folder (located one level below the WinWord folder) and rename any
   items listed there.

</PRE><h3>Case 3</h3>
 
The problem occurs randomly or when executing a particular command.
<P>
In addition to the steps listed above for troubleshooting GPFs when
starting Word, try the following steps.
<P>
A. Quick list of things to try

<UL><LI>Run Windows in standard mode by typing "win /s" at the MS-DOS prompt.
<LI>Try using the Windows VGA driver.
<LI>Empty the Windows Startup Group.
<LI>Open the WIN.INI file and make sure the LOAD= and RUN= lines are blank.
<LI>Open the SYSTEM.INI file and verify that the SHELL= line in the [boot]
   section reads:
<P>
<PRE>           Shell=PROGMAN.EXE

</PRE><LI>Go into the Windows Printer Control Panel and set the Generic Text Only
   printer driver as your default printer.
<LI>Clean out your AUTOEXEC.BAT and CONFIG.SYS files so they contain only
   the essentials to run Windows and Word:
<P>
<PRE>           CONFIG.SYS                 AUTOEXEC.BAT
           ----------                 ------------

           files=60                   path c:\;c:\dos;c:\windows
           buffers=30                 prompt $p$g
           device=&lt;path&gt;\himem.sys    set temp=c:\temp
           stacks=9,256               c:\dos\SHARE.EXE /L:500 /F:5100

     Also, be sure to include the device drivers needed for DoubleSpace
     (DBLSPACE.BIN and DBLSPACE.SYS) if you're using DoubleSpace, or the
     device drivers for any other disk compression utility or special
     hardware you might be using.

</PRE><LI>Rename your NORMAL.DOT and WINWORD.OPT (or WINWORD.INI for Word 2.0x)
   files to NORMAL.OLD and WINWORD.OLD, respectively.
<P>
   More troubleshooting tips are listed in the remainder of this document
   if the problem has not been corrected.
<P>
</UL>B. Preparing to troubleshoot GP Faults
<P>
<PRE>   The procedures in the following sections provide proven ways to
   troubleshoot GP faults. Many of these troubleshooting steps require
   changes to system configuration files. These changes are not intended
   to be permanent; they should be used as techniques for isolating the
   conflict that caused the GP fault.

   Before you begin making changes, you should back up your system files
   and make a startup disk (also known as system disk or boot disk). This
   gives you the ability to restart your computer and edit your CONFIG.SYS
   or AUTOEXEC.BAT files should any changes cause the system to hang. This
   also ensures that you can return to your original system configuration
   by restoring your original system files after you have determined the
   source of the problem.

   The following procedure assumes you are using version 5.0 or later of
   MS-DOS.

   To create a startup disk with the necessary files:

   1. Insert a formatted disk in your floppy drive, type the following,
      and press ENTER:

          sys c: a:

   2. Copy your AUTOEXEC.BAT, CONFIG.SYS, SYSTEM.INI, and WIN.INI files to
      the disk in drive A with the following commands:

         copy c:\autoexec.bat a:
         copy c:\config.sys a:
         copy c:\windows\system.ini a:
         copy c:\windows\win.ini a:

          NOTE: If your Windows directory is on a drive other than C,
          substitute the appropriate drive letter for "c" in the above
          steps.

</PRE>C. Configuring your system for a clean boot
<P>
<PRE>   1. Exit Windows and restart Windows.

   2. From the Program Manager, choose Run from the File Menu.

   3. In the command line, type "sysedit" (without the quotation marks)
      and  choose the OK button.

      CAUTION!! THE FOLLOWING PROCEDURE MAY CAUSE SOME SYSTEMS TO BE
      UNABLE TO REBOOT!! Make sure you have followed the instructions in
      the above section "Preparing to Troubleshoot GP Faults". If you have
      any questions, contact Microsoft Product Support Services before
      proceeding. If you are running Windows or Word from a network
      server, or if you are running any type on disk compression, contact
      Microsoft Product Support Services for assistance.

      Temporarily disable all command lines relating to device drivers and
      terminate-and-stay-resident programs (TSRs) that are not required to
      start your system. These may include virus-detection programs, disk-
      imaging programs, undelete utilities, caching programs, CD-ROM
      drivers, multimedia drivers, terminal-emulation software, and so on.

      To disable a line in the AUTOEXEC.BAT or CONFIG.SYS file, position
      your cursor at the start of the line and type "REM" (without the
      quotation marks) followed by a space.

      Caution: Before modifying these files, make sure you don't disable
      lines pertaining to other hardware-specific device drivers, such as
      disk- compression utilities, extended memory boards, third-party
      disk- partitioning programs, and so on. If you don't know the
      purpose of a line in your CONFIG.SYS or AUTOEXEC.BAT file, do not
      disable it. The following drivers may be required to start the
      computer or to access your hard disk:

               Device Driver            Function
               -------------            --------

               SSWAP.COM                Stacker(TM) disk compression

               STACKER.COM              Stacker disk compression

               DASDDRVR.SYS             IBM BIOS fix

               DMDRVR.SYS               Ontrack disk partition

               SSTORE.SYS               SpeedStor(R) disk compression

               ASPI4DOS.SYS             Adaptec(TM) SCSI BIOS extensions

               SCSIHA.SYS               Adaptec SCSI buffering device

   4. Disable command lines or type them in, so that the unREMed lines in
      the AUTOEXEC.BAT look like this:

               For Windows 3.1 and Word 2.0 (AUTOEXEC.BAT)
               -------------------------------------------

               PATH C:\;C:\DOS;C:\WINDOWS
               PROMPT $P$G
               SET TEMP=C:\

               For Windows 3.1 and Word 6.0 (AUTOEXEC.BAT)
               -------------------------------------------

               PATH C:\;C:\DOS;C:\WINDOWS
               PROMPT $P$G
               SET TEMP=C:\
               C:\DOS\SHARE.EXE /L:500 /F:5100

               For Windows for Workgroups 3.1 or 3.11 and
               Word 2.0 or 6.0 (AUTOEXEC.BAT)
               ------------------------------------------

               PATH C:\;C:\DOS;C:\WINDOWS
               PROMPT $P$G
               SET TEMP=C:\

   5. Click on the CONFIG.SYS window to bring it to the front.

   6. Disable lines or type them in, so that the unREMed lines in the
      CONFIG.SYS look like this:

      For Windows 3.1 and Word 2.x or 6.0
      -----------------------------------

      FILES=60
      BUFFERS=30
      DEVICE=C:\WINDOWS\HIMEM.SYS

      For Windows for Workgroups 3.1 and Word 2.x or 6.0
      --------------------------------------------------

      FILES=60
      BUFFERS=30
      DEVICE=C:\WINDOWS\HIMEM.SYS

      For Windows for Workgroups 3.11 and Word 2.x or 6.0
      ---------------------------------------------------

      FILES=60
      BUFFERS=30
      DEVICE=C:\WINDOWS\HIMEM.SYS
      DEVICE=C:\WINDOWS\IFSHLP.SYS

   7. Click on the WIN.INI window to bring it to the front.

   8. Place a semicolon (;) at the beginning of the line that starts with
      "Load=" (without the quotation marks). This disables any programs
      that are started before Windows starts.

    9. Place a semicolon (;) at the beginning of the line that starts with
      "Run=" (without the quotation marks). This disables any programs
      that are started before Windows starts.

   10. From the File menu for the System Configuration Editor, choose
      Exit. Windows prompts you to save changes to the modified files.
      Choose Yes to save the changes.

   11. From the Program Manager, choose Exit from the File menu to quit
      Windows.

   12. Once you are at the MS-DOS command prompt, restart (reboot) your
      system by pressing CTRL+ALT+DEL (or choose the RESET button on your
      machine).

   13. After the machine reboots, enter Windows, start Word, and see if
      the problem is corrected.

   If the previous procedure corrects the problem, the problem is related
   to one of the drivers or TSR programs that you temporarily disabled. To
   identify which line is loading the TSR program or device driver that
   causes the error, restore the disabled lines one by one until the
   problem reoccurs. If the problem is not corrected, continue
   troubleshooting.

</PRE><h3>Case 4</h3>
 
None of the above steps resolve the problem.
<P>
If none of the above troubleshooting techniques are effective in
eliminating the General Protection Fault, it may become necessary to
reinstall Windows and Word in a new, clean directory.
<P>
A. Correcting damaged Windows files
<P>
<PRE>   The following procedure will allow you to update Windows files that may
   have become damaged without losing your custom Windows settings. To do
   this, you will install Windows to a new directory and then copy the new
   files back to the old Windows installation, retaining the old Windows
   customized settings:

   1. Quit Windows and return to the MS-DOS command prompt.

   2. Place Windows Disk 1 in drive A or B, as appropriate.

   3. Type "a:\setup" or "b:\setup" (without the quotation marks) and
      press ENTER.

   4. Install Windows to a directory called NEWWIN31, and select the VGA
      video driver. When asked to update the AUTOEXEC.BAT and CONFIG.SYS
      files, choose "Do Not Update."

   5. Once the new instance of Windows is installed, choose Exit Windows
      from the File menu to return to the MS-DOS command prompt.

   6. Type the following commands at the MS-DOS command prompt, pressing
      ENTER after each line:

        COPY C:\NEWWIN31\*.EXE C:\WINDOWS
        COPY C:\NEWWIN31\*.DLL C:\WINDOWS
        COPY C:\NEWWIN31\SYSTEM\*.* C:\WINDOWS\SYSTEM
        CD C:\WINDOWS
        WIN

        This will start the original instance of Windows.

   7. Start Word and see if the problem is corrected. If the problem is
      corrected, delete the NEWWIN31 directory and all of its
      subdirectories. If the problem is not corrected, continue
      troubleshooting.

</PRE>B. Installing Word under the new installation of Windows
<P>
<PRE>   In this procedure, you will take the old instance of Windows off the
   PATH statement and replace it with a new installation of Windows. You
   will then install Word under the new installation of Windows.

   1. Quit Windows to return to the MS-DOS command prompt.

   2. Type the following line and press ENTER:

          edit c:\autoexec.bat

   3. Change this line

          path=c:\;c:\dos;c:\windows

      to this:

          path=c:\;c:\dos;c:\newwin31

   4. From the File menu, choose Exit and save changes.

   5. Reboot the computer.

   6. Start the new installation of Windows by typing "win" (without the
      quotation marks).

   7. From the Program Manager File menu, choose Run.

   8. Insert your Word Setup disk (Disk 1) into drive A or B.

   9. Type "a:\setup" or "b:\setup" (without the quotation marks).

   10. Continue with the Word installation.

   11. Once Word is installed, quit Windows and restart windows.

   12. Start Word and see if the problem is corrected. If the problem is
      corrected, you will need to reinstall your software under the new
      installation of Windows.

   If the problem is not corrected, you may have damaged Word disks.
   Contact Microsoft Product Support Services for information on receiving
   new disks.

   Once the software is installed, and all of your custom changes are
   made, you can delete the original installation of Windows. If the
   problem reoccurs after installing all of your software, then the
   problem is being caused by one of the installed programs. You will need
   to repeat the installation of Windows and Word to a new directory, and
   add your other software back, one program at a time. After each program
   is installed, check to see if the problem with Word reoccurs. When the
   problem reoccurs, you have isolated the software that is causing the
   problem. Contact the manufacturer of the software or Microsoft Product
   Support Services for additional instructions.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kberrmsg kbtshoot<BR>
KBSubcategory:
<P>

Additional reference words: winword2  troubleshooting troubleshoot guide<BR>
word6 hang hung crash crashed winword locks locked frozen gpf freezes<BR>
crashing quit quits stopped crashes bomb frozen tshoot<BR>
Version           : 2.00 2.00a 2.00a-CD 2.00b 2.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
