

<HTML>
<HEAD>
<TITLE>Merged Table Cell References Differ Between Word 2.x and 6.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114114">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1994/04/25">
<META NAME="Keywords" CONTENT="kbtable kbtemplate">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you merge table cells, Word 6.0 for Windows references the merged cells differently in relation to the table than do earlier versions of Word. This may cause unexpected results in Word 6.0 when you use formulas such as =SUM(ABOVE) in tables yo...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QDNZ,QDO7,QBE7,QBE6,QARR,QA5V,QANX,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Merged Table Cell References Differ Between Word 2.x and 6.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114114</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a
WINDOWS
kbusage kbtable kbmacro kbtemplate
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you merge table cells, Word 6.0 for Windows references the merged
cells differently in relation to the table than do earlier versions of
Word. This may cause unexpected results in Word 6.0 when you use formulas
such as =SUM(ABOVE) in tables you created in Word 2.x.
<P>
<P><h2>CAUSE</h2>
 
<P>
By design, Word 6.0 renumbers the cells in the entire table row when you
merge one or more cells in that row. For example, if you merge cells A2 and
B2, Word renumbers the row so cell C2 becomes B2, as shown in the following
example:
<P>
<PRE>   ----------------------
   |  A1  |  B1  |  C1  |
   ----------------------
   |      A2     |  B2  |   -----&gt; Word 6.0 omits cell C2
   ----------------------
   |  A3  |  B3  |  C3  |
   ----------------------

</PRE>By contrast, Word 2.x (which uses relative cell references) retains the
original cell references and does not renumber the cells in the row when
you merge cells in that row. When you merge table cells in Word 2.x, Word
treats the merged cell references as "hidden." In the following example, in
which cells R2C1 and R2C2 are merged, notice that the table no longer
includes cell R2C2:
<P>
<PRE>   ----------------------
   | R1C1 | R1C2 | R1C3 |
   ----------------------
   |     R2C1    | R2C3 |   -----&gt; Word 2.x skips cell R2C2
   ----------------------
   | R3C1 | R3C2 | R3C3 |
   ----------------------

</PRE>In Word 6.0, when you open a Word 2.x document or template that contains
merged table cells, Word 6.0 maintains the cell references, so a table
calculation in a converted document may yield different results than one in
a table you originally created in Word 6.0.
<P>
For example, if you open the Word 2.x table shown above in Word 6.0, Word
6.0 numbers the table cells as follows (notice that cell B2 is missing in
the Word 2.x table):
<P>
<PRE>   ----------------------
   |  A1  |  B1  |  C1  |
   ----------------------
   |      A2     |  C2  |   -----&gt; Word 6.0 skips cell B2 in
   ----------------------          converted Word 2.x table
   |  A3  |  B3  |  C3  |
   ----------------------

</PRE>As a result, formulas such as =SUM(ABOVE) or =SUM(BELOW) use different
cells to calculate the result, depending on which version of Word you used
to create the table. For example, in Word 6.0, if you insert the following
formula in cell B3 of one table you created in Word 2.x and in cell B3 of
another table you created in Word 6.0
<P>
<PRE>   {= SUM(ABOVE)}

</PRE>then Word sums cells B1 and B2 in the Word 6.0 table, but Word sums B1 only
in the Word 2.x table. In other words, in the Word 2.x table, cell B2 is
"hidden," so Word 6.0 does not include it in the calculation.
<P>
TIP: To see which cells Word includes in a specific column, position the
insertion point in a cell, then choose Select Column from the Table menu.
<P>
<P><h3>Invoice Template</h3>
 
<P>
The Invoice template (INVOICE.DOT), supplied with Word 6.0, contains a
converted Word 2.x table. The last row of the table contains two cells (A12
and D12), but the first cell was created by merging three cells together
(cells A12, B12, and C12). The last formula in the table references cells
in column D, which is the second column in this table. If the table had
been created originally in Word 6.0, the formula would reference column B.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Method 1: In tables that contain merged cells in which relative formulas
<PRE>          such as =SUM(ABOVE) do not yield correct results, use specific
          cell references in the formula instead. For example, use =B1+A2.
          For large groups of cells, refer to specific cell ranges; for
          example, use =SUM(B1:B4,A5,B6:B8).

</PRE>Method 2: Select the cells you want to use in a formula and assign a
<PRE>          bookmark to the selection using the Bookmark command on the Edit
          menu. Then use the bookmark name in the formula. For example,
          use =SUM(BookmarkName).

</PRE><h2>MORE INFORMATION</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
You can use the following macro to report row, column, and cell information
about a table:
<P>
<PRE>Sub MAIN
</PRE>LF$ = Chr$(13) + Chr$(10)
If SelInfo(12) = - 1 Then
<PRE> TR$ = Str$(SelInfo(15))
 TC$ = Str$(SelInfo(18))
 CR$ = LTrim$(Str$(SelInfo(13)))
 S$ = "The table has" + TR$ + " rows." + LF$
 S$ = S$ + "This row has" + TC$ + " columns."
 S$ = S$ + LF$ + "This cell is "
 S$ = S$ + Chr$(SelInfo(16)+64) + CR$ + "."
 MsgBox S$
</PRE>Else
<PRE> MsgBox "The Insertion Point must be in a table!"
</PRE>EndIf
<PRE>End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Word User's Guide," version 6.0, pages 296-297, 300-302
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbmacro<BR>
KBSubcategory: kbtable kbtemplate<BR>
Additional reference words: 6.00 6.00a merged cells incorrect sum<BR>
word6 winword above results product<BR>
Keywords          : kbtable kbtemplate<BR>
Version           : 6.00 6.00a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
