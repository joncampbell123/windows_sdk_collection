

<HTML>
<HEAD>
<TITLE>WD: Macros to Read Data from a Private .ini File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81793 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/03/17">
<META NAME="Keywords" CONTENT="kbhowto kbmacroexample macword ntword winword winword2 word6 word7 word95 wordnt kbmacr">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You can write macros that use a settings file to store and retrieve settings. For example, you can store the name of the active document when you quit Word so that it can be reopened automatically the next time you start Word. In Windows, a setting...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAH4,QDL9,QBWO,QBWN,QABA,QBBI,QBAO,QATX,QA01,QAUD,QA6A,QAY5,QAY2,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Macros to Read Data from a Private .ini File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81793 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can write macros that use a settings file to store and retrieve
settings. For example, you can store the name of the active document when
you quit Word so that it can be reopened automatically the next time you
start Word. In Windows, a settings file is a text file with information
arranged like the information in the Windows 3.x Win.ini file. On the
Macintosh, a settings file is a resource file such as Word Settings (97).
<P>
This article discusses methods you can use to extract information from a
settings file other than the Win.ini file. Each method and example is
specific to a version of Microsoft Word.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Word for Windows 6.0, 7.0, 7.0a</h3>
 
<P>
WARNING: ANY USE BY YOU OF THE MACRO CODE PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this macro code "as is" without warranty
of any kind, either express or implied, including but not limited to the
implied warranties of merchantability and/or fitness for a particular
purpose.
<P>
GetPrivateProfileString:
<P>
The GetPrivateProfileString function was added in Word version 6.0. Use
GetPrivateProfileString to return a setting from a private settings
file.
<P>
A settings file is a text file such as Win.ini that your macros can use
to store and retrieve settings.
<P>
The following is an example of the GetPrivateProfileString$() command.
<P>
<PRE>   Sub MAIN
      temp$ = GetPrivateProfileString$("Section Name", "keyname", \
      "H:\winword\text.ini")
      MsgBox temp$
   End Sub

</PRE>The above macro reads the contents the Text.ini file and posts the
contents of "keyname=" heading in a message box.
<P>
The GetPrivateProfileString function reads a character string from the
specified section of the specified initialization file. The return
value is the number of characters copied into the buffer if successful
or 0 (zero) if unsuccessful.
<P>
<P><h3>Word for the Macintosh 6.0, 6.0.1</h3>
 
<P>
The following is an example of the GetPrivateProfileString$() command.
<P>
<PRE>   Sub MAIN
      temp$ = GetPrivateProfileString$("Microsoft Word", "INI-Path", \
      "Word Settings (6)")
      MsgBox temp$
   End Sub

</PRE>The above macro reads the contents the Word Settings (6) file and posts the
contents of "INI-Path=" heading in a message box.
<P>
The GetPrivateProfileString function reads a character string from the
specified section of the specified initialization file. The return
value is the number of characters copied into the buffer if successful
or 0 (zero) if unsuccessful.
<P>
<P><h3>Word for Windows 2.x</h3>
 
<P>
According to the Microsoft Windows Software Development Kit documentation,
the GetPrivateProfileString function has the following parameters:
<P>
<PRE>   INT GetPrivateProfileString(lpszSectionName, lpszKeyName, lpszDefault,
   lpszReturnBuffer, cbReturnBuffer, lpszFileName)

   LPCSTR lpszSectionName;    section name
   LPCSTR lpszKeyName;        keyname
   LPCSTR lpszDefault;        default return string
   LPSTR lpszReturnBuffer;    variable assignment for INI information
   int cbReturnBuffer;        size of the destination buffer
   LPCSTR lpszFileName;       initialization filename

   [section name]
   keyname=string to read

</PRE>The following WordBasic macro demonstrates the use of the Windows
GetPrivateProfileString function:
<P>
<PRE>   Declare Function GetPrivateProfileString Lib "kernel" \
   (lpApplicationName$, lpKeyName$, lpDefault$, lpReturnedString$, \
   nSize As Integer, lpFileName$)  As Integer

   Sub MAIN
      a = GetPrivateProfileString("Section Name", "keyname", "", Temp$,\
      255,"H:\WINWORD\Text.ini")
      MsgBox Temp$
   End Sub

</PRE>The above macro reads the contents the Text.ini file and posts the
contents of "keyname=" heading in a message box.
<P>
The GetPrivateProfileString function reads a character string from the
specified section of the specified initialization file. The return
value is the number of characters copied into the buffer if successful
or 0 (zero) if unsuccessful.
<P>
NOTE: To obtain a string from the Win.ini file use the WordBasic
"GetProfileString" function.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Windows Software Development Kit," Vol. 1, page 4-199
through page 4-200
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: WritePrivateProfileString <BR>
Keywords          : kbhowto kbmacroexample macword ntword winword winword2 word6 word7 word95 wordnt kbmacro<BR>
Version           : WINDOWS:2.0,2.0a,2.0a-CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.6.0.1a<BR>
Platform          : MACINTOSH Win95 WINDOWS winnt<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
