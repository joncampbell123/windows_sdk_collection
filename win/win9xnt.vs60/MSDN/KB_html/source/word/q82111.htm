

<HTML>
<HEAD>
<TITLE>WordBasic Macro to Assign Clipboard Text to a String Variable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82111 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1992/03/25">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This function retrieves any text residing on the Clipboard. All formatting is ignored, and the Clipboard content is stored in the variable clipboard$. As with all WordBasic strings, the maximum string size is 32,768 characters or what local memory ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QATX,QAIH,QAY5,QAYL,QANH,QANE,QAFF,QBV8,QAB9,QBJZ,QAMB,QA6F,QBXS,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WordBasic Macro to Assign Clipboard Text to a String Variable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82111 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This function retrieves any text residing on the Clipboard. All formatting
is ignored, and the Clipboard content is stored in the variable clipboard$.
As with all WordBasic strings, the maximum string size is 32,768 characters
or what local memory allows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Function to Assign Clipboard Text to a String Variable</h3>
 
<P>
<PRE>Declare Function CloseClipboard Lib "user32"() As Long
Declare Function GetClipboardData Lib "user32"(wFormat As Long) As Long
Declare Function OpenClipboard Lib "user32"(hwnd As Long) As Long

Declare Function GlobalLock Lib "kernel32"(h As Long) As Long
Declare Sub  GlobalUnlock Lib "kernel32"(h As Long)
Declare Function lstrcpyA Lib "kernel32"(lpszDest$, lpsz2 As Long)As Long
Declare Function lstrlenA Lib "kernel32"(lpsz As Long) As Long
' **********************************************************************
Sub Main

</PRE>hwnd = GetFocus
If (OpenClipboard(hwnd) &lt;&gt; 0) Then
<PRE>        h = GetClipboardData(1)
        If (h &lt;&gt; 0) Then
                lpStr = GlobalLock(h)
                Clip$  = String$(lstrlenA(lpStr), "x")
                r = lstrcpyA(Clip$, lpStr)
                Clip$ = LTrim$(RTrim$(Clip$))
                GlobalUnlock(h)
        Else
                Clip$ = "NULL"
        End If
        r = CloseClipboard
</PRE>MsgBox Clip$
<PRE>End Sub

</PRE>This function can be called from within any subroutine in a macro. It
can also reside in a "functions" macro. You can then call this
function from within another WordBasic macro. The syntax is as
follows:
<P>
<P><h3>Within Same Macro</h3>
 
<P>
<PRE>Sub MAIN
</PRE>MsgBox Clipboard$
<PRE>End Sub

</PRE><h3>Within Another Macro</h3>
 
<P>
<PRE>Sub MAIN
</PRE>MsgBox Global.Clipboard$
<PRE>End Sub

</PRE>Use the following steps to create the macro:

<OL><P><LI>From the Tools menu, choose Macro.

<P><LI>Type a name for the macro in the Macro Name box, and choose the
   Edit button.

<P><LI>In the macro-editing window, type the above macro text.

<P><LI>Press CTRL+F4 to close the macro-editing window.

<P><LI>Choose the Yes button in response to the prompt "Do you want to
   keep the changes to Global: xxxx?".

<P><LI>From the File menu, choose Save All.

<P><LI>Choose the Yes button in response to the prompt "Save global,
   glossary and command changes?".
<P>
</OL>Information provided in this document is provided "as is" without
warranty of any kind, either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.
<P>
For information about how to do this in Word 97, please see the following
article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q158436.htm">Q158436</A></B>
   TITLE     : Sample VB Code to Assign Clipboard Text to String Variable

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows User's Guide," version 2.0, pages 765,
784-786
<P>
"Using WordBasic," by WexTech Systems and Microsoft, pages 173, 186
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.0 2.0a  6.0 6.0a 6.0c winword2<BR>
word7 winword 7.0 word95 word6 word6<BR>
Version           : 2.x 6.0 6.0a 6.0c 7.0 7.0a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
