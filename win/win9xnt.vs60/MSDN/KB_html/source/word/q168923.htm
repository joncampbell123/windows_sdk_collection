

<HTML>
<HEAD>
<TITLE>WD97: Invalid Page Fault Using DocVariable Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168923">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1997/05/22">
<META NAME="Keywords" CONTENT="kbfield word8 word97 kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use the DocVariable field in a header, footer, or text box, the following error may occur:     This program has performed an illegal operation and will be shut    down. If the problem persists, contact the program vendor.  If you click Det...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QBWS,QAPN,QBT6,QBJZ,QA88,QBV4,QAIH,QAHP,QAKE,QAXB,QAKD,QAB4,QACI P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: Invalid Page Fault Using DocVariable Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168923</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the DocVariable field in a header, footer, or text box, the
following error may occur:
<P>
<PRE>   This program has performed an illegal operation and will be shut
   down. If the problem persists, contact the program vendor.

</PRE>If you click Details, you will receive the following error message:
<P>
<PRE>   WINWORD caused an invalid page fault in module WINWORD.EXE at
   0137:3037f1db.

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use custom document properties (on the File
menu, click Properties, and then click the Custom tab) to set custom
document variables and then use the DocProperty field to use the values in
a header, footer, or text box.
<P>
<P><h3>To Create a Custom Document Property</h3>
 

<OL><P><LI>On the File menu, click Properties, and then click the Custom tab.

<P><LI>In the Name box, type a name for the custom property, or select a name
   from the list.

<P><LI>In the Type box, click the type of property you want.

<P><LI>In the Value box, type a value for the property.
<P>
   The value you enter must match the selection in the Type box. For
   example, if you click Number in the Type box, you must type a number in
   the Value box. Values that don't match the property type are stored as
   text.

<P><LI>Click Add.

<P><LI>Click OK.
<P>
</OL><h3>To Insert the DocProperty Field in the Document</h3>
 

<OL><P><LI>Click where you want to insert the DocProperty field.

<P><LI>On the Insert menu, click Field.

<P><LI>Click the Document Information category, and then click the DocProperty
   field.

<P><LI>To add the Custom Document Property to the field, click Options.

<P><LI>From the Property list, select the custom Property.

<P><LI>Click Add To Field.

<P><LI>In the Field Options dialog box, click OK.

<P><LI>In the Fields dialog box, click OK.
<P>
</OL>NOTE: For more information about a specific field or option, while in the
Field dialog box, select the field name or option, and then press F1.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you insert a blank DocVariable field into a header or footer, that is,
when you insert the field with no reference to a stored document variable,
and then you later add the document variable reference and update the
field, you do not receive the error described in the "Symptoms" section of
this article. However, when you update the DocVariable field, the field
remains blank.
<P>
Performing these same steps in a text box causes the error described in the
"Symptoms" section of this article to occur when you update the field.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the DocVariable field, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q166098.htm">Q166098</A></B>
   TITLE     : WD97: DocVariable Field Is Autoindex Field After Conversion

</PRE></OL>For more information about "the DocVariable field," click the Office
Assistant, type "docvariable," click Search, and then click "Field
Codes:DocVariable field."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Word Help is not installed on your computer, please
see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.0 8.0<BR>
Keywords          : kbfield word8 word97 kberrmsg<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
