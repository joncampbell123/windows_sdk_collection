

<HTML>
<HEAD>
<TITLE>GP Fault Printing Document with Many Fonts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105565">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="kbprint">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you print a Word for Windows document that contains a large number of downloadable fonts, a general protection (GP) fault error may occur.  CAUSE =====  You are using the Windows Universal Printer Driver (UNIDRV.DLL) version 3.1.2 or earlier and...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QBKN,QAIH,QBJQ,QAOX,QBWN,QAYL,QAU9,QAAP,QAKC,QDL9,QBWQ,QBWO,QAA1,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>GP Fault Printing Document with Many Fonts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105565</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you print a Word for Windows document that contains a large number
of downloadable fonts, a general protection (GP) fault error may
occur.
<P>
<P><h2>CAUSE</h2>
 
<P>
You are using the Windows Universal Printer Driver (UNIDRV.DLL)
version 3.1.2 or earlier and your Word document contains more than 64
downloadable fonts, such as TrueType fonts. The problem also occurs
when you print using the Windows PostScript printer driver
(PSCRIPT.DRV) version 3.56 or earlier and your document contains more
than 256 downloadable fonts.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in UNIDRV.DLL version
3.1.2 and earlier and in PSCRIPT.DRV version 3.56 and earlier. This
problem was corrected in version 3.1.3 of UNIDRV.DLL and in version
3.57 of PSCRIPT.DRV.
<P>
The corrected printer drivers are supplied with Word 6.0. Setup DOES NOT
automatically install these drivers. To assure that the new drivers are
correctely installed, rename the existing UNIDRV.DLL prior to installing
Word 6.0.
<P>
If you do not have Word 6.0, you can obtain these new printer drivers
from the Windows Driver Library (WDL). For information about obtaining
the WDL, query on the following words in the Microsoft Knowledge Base:
<P>
<PRE>   wdl.txt and obtain and msdl and win3x

</PRE><h2>WORKAROUNDS</h2>
 

<UL><LI>To avoid the GP fault errors using the problem printer drivers,
   decrease the number of fonts in your document.
<P>
   -or-

<LI>If your document contains mostly TrueType fonts, turn on the "Print
   TrueType as Graphics" option. This reduces the number of downloadable
   fonts. The drawback to this workaround is that it increases printing
   time.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
In both UNIDRV.DLL and PSCRIPT.DRV, the GP fault error occurs when the
printer driver copies conflicting font cache information during the
ResetDC() call. Specifically, the driver fails to copy the value of
the sMaxDLSlots variable, so it incorrectly resets the sMaxDLSlots
variable to the default value (32 for UNIDRV.DLL and 128 for
PSCRIPT.DRV). This default value does not cause a problem until your
document contains more than 64 fonts (256 fonts for PSCRIPT.DRV).
<P>
Note: The sMaxDLSlots variable indicates the total number of entries
(used or empty) in the font downloading list.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: <BR>
KBSubcategory:<BR>
Additional query words: 6.0  2.0 2.0a 2.0a-CD 2.0b word6<BR>
2.0c win3x globalalloc snumdownfonts lpdownfontlist hdownfontlist<BR>
gpf hang hung crash crashed locks locked frozen freezes crashing quit<BR>
quits stopped winword2 winword<BR>
Keywords          : kbprint<BR>
Version           : 2.0 2.0a 2.0a-CD 2.0b 2.0c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
