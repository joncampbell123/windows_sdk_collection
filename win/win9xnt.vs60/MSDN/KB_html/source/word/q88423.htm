

<HTML>
<HEAD>
<TITLE>WordBasic Error with Dialog Box Created in Macro Dialog Editor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88423 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1992/08/26">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use the Dialog Editor to create an option button, if you type text in the Text$ box and select the Auto Quote check box, a WordBasic error may appear when you run the resulting macro in Microsoft Word for Windows. The error message occurs ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA50,QA01,QBJZ,QAHP,QAB4,QAMB,QBT6,QBV4,QATX,QBWS,QBXS,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WordBasic Error with Dialog Box Created in Macro Dialog Editor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88423 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use the Dialog Editor to create an option button, if you type
text in the Text$ box and select the Auto Quote check box, a WordBasic
error may appear when you run the resulting macro in Microsoft Word
for Windows. The error message occurs if you type quotation marks in
the Text$ field of the Button Info dialog box in Dialog Editor. No
error message occurs if you do not type quotation marks in the Text$
field.
<P>
The error message occurs because the Dialog Editor does not translate
literal quotation marks to "Chr$(34)" in the Text$ box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Dialog Editor is used to create custom dialog boxes for use with
Word for Windows WordBasic macros. The Auto Quote option automatically
encloses button label text in quotation marks so that you don't have
to type the quotation marks yourself. In effect, the Auto Quote option
forces the text you type to be a string variable, rather than a
literal.
<P>
<P><h3>Workaround</h3>
 
<P>
If you want quotation marks to appear around text in a macro, you must
use the Chr$(34) statement instead of literal quotation marks. When
the Auto Quote check box is selected, do not type any quotation marks
in the Text$ field of the Button Info dialog box. If you want to add
quotation marks, add them after you paste the text in the
macro-editing window in Word for Windows.
<P>
For example, to add an option button title such as ""My" Button" while
the Auto Quote check box is selected, type "My Button" in the Text$
box (without the quotation marks). When you paste the dialog box in
the Word for Windows macro-editing window, the following text appears:
<P>
<PRE>   OptionButton 10, 6, 110, 16, "My Button"

</PRE>Modify the line so that it reads as follows:
<P>
<PRE>   OptionButton 119, 107, 121, 16, Chr$(34) + "My" + Chr$(34) +
   " Button"

</PRE><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Launch the Dialog Editor. For information on this procedure, refer
   to pages 787-790 of the "Microsoft Word for Windows User's Guide."

<P><LI>From the Item menu in the Dialog Editor, choose Button. Under
   Button Type, select Option, then choose the OK button.

<P><LI>Double-click the option button to open the Option Button Info
   dialog box. In the Text$ box, type the following:
<P>
<P><PRE>      "My" Button
</PRE>
<P><LI>Select the Auto Quote check box, then choose the OK button. Notice
   that the quotation marks display correctly in the dialog box.

<P><LI>From the Edit menu, choose Select Dialog. From the Edit menu,
   choose Copy. From the File menu, choose Exit to close the Dialog
   Editor.

<P><LI>Launch Word for Windows. From the Tools menu, choose Macro. Type a
   macro name, such as "TestDialog" (without the quotation marks), and
   choose the Edit button.

<P><LI>From the Edit menu, choose Paste. The following text should now
   appear in the macro-editing window:
<P>
<PRE>      Sub MAIN
      Begin Dialog UserDialog 320, 144, "Microsoft Word"
         OptionGroup  .OptionGroup1
            OptionButton 10, 6, 110, 16, ""My" Button"
      End Dialog
      End Sub

</PRE><P><LI>Type the following lines before the "End Sub" line and after the
   "End Dialog" line in the above macro:
<P>
<P><PRE>      Dim dlg as UserDialog
      Dialog dlg
</PRE>
<P><LI>Choose the Start button on the macro-editing bar to run the macro.
<P>
</OL>The above steps produce the following error message:
<P>
<PRE>   WordBASIC Err=100
   Syntax Error

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows User's Guide," version 2.0, pages 787-788,
790-791
<P>
"Using WordBasic," by WexTech Systems and Microsoft, page 163
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword2 2.0 2.0a 2.0a-CD   winword 6.0c<BR>
winword 7.0 word95 word7 word6 winword macrode.exe errmsg err msg double<BR>
winword2 6.0<BR>
Version           : 2.x 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
