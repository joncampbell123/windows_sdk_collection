

<HTML>
<HEAD>
<TITLE>WD: WordBasic Error 152 with DlgFilePreview Statement </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110414">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1994/01/20">
<META NAME="Keywords" CONTENT="kbmacroexample macword winword word6 word7 word95 kbcode kberrmsg kbmacro kbprg">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you specify a document file name to preview with the DlgFilePreview statement and no document windows are open, the DlgFilePreview statement generates the following error:     WordBasic Error 152    This command is not available because no docum...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QABH,QDL9,QBWO,QBWN,QAB9,QA01,QAPN,QBWQ,QAVZ,QAVX,QAPF,QBWS,QBV8,QDO9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: WordBasic Error 152 with DlgFilePreview Statement</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110414</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Windows operating system version 3.1
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you specify a document file name to preview with the DlgFilePreview
statement and no document windows are open, the DlgFilePreview statement
generates the following error:
<P>
<PRE>   WordBasic Error 152
   This command is not available because no document is open.

</PRE>The WordBasic DlgFilePreview statement is used within a Word 6.0 for
Windows dialog function to preview the document specified by Filename$.
<P>
<P><h3>Syntax for DlgFilePreview</h3>
 
<P>
DlgFilePreview [Identifier[$]] [, Filename$]
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>The following sample macro checks the number of open windows (CountWindows)
prior to displaying the dialog box. If no document windows are open, the
macro opens a new document window with ScreenUpdating turned off. When the
dialog box is closed, the new document window is closed without saving
changes.
<P>
<PRE>   Sub MAIN
   Begin Dialog UserDialog 354, 258, "Preview", .dlgTest
    PushButton 255, 10, 88, 21, "Close", .close
    Text 15, 8, 151, 25, "File Preview Example:", .Text1
    FilePreview 15, 58, 219, 183, .fileprev
   End Dialog
   Dim dlg As UserDialog
   ScreenUpdating 0
   If CountWindows() = 0 Then
    FileNewDefault
    ThisWindow$ = WindowName$()
    DocMinimize
   End If
   x = Dialog(dlg)
   If ThisWindow$ &lt;&gt; "" Then
    Activate ThisWindow$
    FileClose 2
   End If
   End Sub
   
   Function dlgTest(identifier$, action, suppvalue)
   Select Case action
   Case 1
    DlgFilePreview "fileprev", "C:\WINWORD\TEST.DOC"
   Case Else
   End Select
   End Function

</PRE>Note to Macintosh users: Use a Macintosh path in the DlgFilePreview command
line, for example:
<P>
<PRE>   DlgFilePreview "fileprev", "Macintosh HD:Desktop Folder:Test Document"

</PRE>For information about using a dialog function, see the "Creating Dynamic
Dialog Boxes" topic in the Word 6.0 Online Help file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: DlgFilePreview dialog dynamic function boxes error<BR>
152 not available<BR>
Keywords          : kbmacroexample macword winword word6 word7 word95 kbcode kberrmsg kbmacro kbprg<BR>
Version           : MACINTOSH:6.0,6.0.1,6.0.1a;WINDOWS: 6.0a,6.0c,7.0,7.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
