

<HTML>
<HEAD>
<TITLE>WD: Sharing Variables Between User-Defined Subroutines </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99000 ">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1993/05/19">
<META NAME="Keywords" CONTENT="kbmacroexample winword winword2 word6 word7 word95 kbmacro kbusage">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you want to share the contents of a variable between subroutines, you must declare (dimension) the variable as a global variable.  MORE INFORMATION  To define a variable as  global  (to make it accessible in multiple subroutines), use the Dim co...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAFF,QAIH,QAGI,QAH7,QAD7,QAH6,QAH4,QBTL,QA3A,QAYV,QAHE,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Sharing Variables Between User-Defined Subroutines</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99000 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, 2.0a,
   2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you want to share the contents of a variable between subroutines, you
must declare (dimension) the variable as a global variable.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To define a variable as "global" (to make it accessible in multiple
subroutines), use the Dim command with the shared parameter. The following
sample macro defines variables A and B as global variables.
<P>
NOTE: The Dim statement for global variables must appear before the
<PRE>Sub MAIN statement.

   Dim Shared A, B
   Sub MAIN
      A = 2
      B = 3
      Call SumRoutine
   End Sub

   Sub SumRoutine
      Print a; " +" ; b;" is";a + b
   End Sub

</PRE>The above macro displays "2 + 3 is 5" on the status bar at the bottom
of the screen. If you omit the first line of the macro (the Dim
statement), the result is "0 + 0 is 0." Without declaring the A and B
variables as shared, the subroutine called "SumRoutine" does not have
access to the values of A and B.
<P>
The following macro displays "2 + 3 is 5" on the status bar without
defining the A and B variables as global variables.
<P>
<PRE>   Sub MAIN
      A = 2
      B = 3
      Call SumRoutine a, b
   End Sub

   Sub SumRoutine(a, b)
      Print a ; " +" ; b ; " is" ; a + b
   End Sub

</PRE>Each variable in the comma-delimited parameter list must correspond to
a value that the subroutine being called is prepared to receive.
<P>
NOTE: The WordBasic language for Word versions 1.x for Windows allows
you to call and pass parameters to routines within the current macro
only. It is not possible to call or pass values to subroutines within
other macros in versions 1.x of Word for Windows.
<P>
For more information on passing parameters to another macro, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q94374.htm">Q94374</A></B>
   TITLE     : Passing Parameters "By Reference" and "By Value"

   ARTICLE-ID: <B><A href="../word/q94734.htm">Q94734</A></B>
   TITLE     : CALL Statement Cannot Accept Variable Argument

</PRE><h2>REFERENCES</h2>
 
<P>
"Using WordBASIC for Word for Windows and Word for OS/2," by WexTech
Systems Incorporated, pages 122-123
<P>
"Using WordBasic," by WexTech Systems and Microsoft, pages 58-59, 157
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: subroutine passing parameter value share sub dim<BR>
global<BR>
Keywords          : kbmacroexample winword winword2 word6 word7 word95 kbmacro kbusage<BR>
Version           : 1.x 2.x 6.0 6.0a 6.0c 7.0 7.<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
