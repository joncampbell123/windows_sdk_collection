

<HTML>
<HEAD>
<TITLE>WD: Conditional Alphanumeric Merge May Yield Incorrect Results </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97484 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/04/13">
<META NAME="Keywords" CONTENT="kbfield kbmerge winword word6 word7 word95 word97 kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  A print merge or mail merge operation may yield incorrect results if you use a conditional statement to evaluate alphanumeric data when the first character of the data is numeric.  CAUSE =====  This happens because conditional statements (IF fields...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALI,QA5V,QAIH,QBTS,QA7O,QA7N,QAKC,QBL4,QDME,QBC6,QAPF,QAYY,QAG8,QAVX,QAVW P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Conditional Alphanumeric Merge May Yield Incorrect Results</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97484 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, 2.0a,
   2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A print merge or mail merge operation may yield incorrect results if you
use a conditional statement to evaluate alphanumeric data when the first
character of the data is numeric.
<P>
<P><h2>CAUSE</h2>
 
<P>
This happens because conditional statements (IF fields) evaluate only the
first two characters of a numeric string.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For example, using the sample data file below, the following conditional
statement incorrectly yields a true result for the first and second
records, although only the second record satisfies the condition:
<P>
<PRE>   {IF {MERGEFIELD NUMBER} = "1AB" "This is true"}

</PRE>NOTE: The IF field evaluated only the first two characters (1A) of the
numeric string.
<P>
<P><h3>Sample Data File</h3>
 
<P>
<PRE>   ---------------------------------
   |  Rec_Num  |Name      |Number  |
   ---------------------------------
   |     1     |John      |1AA     |
   ---------------------------------
   |     2     |Bill      |1AB     |
   ---------------------------------
   |     3     |Fred      |2AA     |
   ---------------------------------
   |     4     |George    |ABC     |
   ---------------------------------

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use the appropriate method for your version of 
Word.
<P>
<P><h3>Word Versions 6.x, 7.x, 97, 98 Macintosh Edition</h3>
 
<P>
Modify the data so that each field begins with a non-numeric character.
Then modify the conditional field in the main merge document to match the
data.

<OL><P><LI>In the data document, add a character to the beginning of each data
   field that starts with a number. You can use any character, such as a
   parenthesis (you can also add one to the end of the field, so that it's
   easier to read) or an ampersand (&amp;). This makes the first character in 
   the number field a character instead of a numeral.
<P>
   Modified with parentheses:
<P>
   ---------------------------------
<PRE>   |  Rec_Num  |Name      |Number  |
   ---------------------------------
   |     1     |John      |(1AA)   |
   ---------------------------------
   |     2     |Bill      |(1AB)   |
   ---------------------------------
   |     3     |Fred      |(2AA)   |
   ---------------------------------
   |     4     |George    |(ABC)   |
   ---------------------------------

   Modified with an ampersand:

   ---------------------------------
   |  Rec_Num  |Name      |Number  |
   ---------------------------------
   |     1     |John      |&amp;1AA    |
   ---------------------------------
   |     2     |Bill      |&amp;1AB    |
   ---------------------------------
   |     3     |Fred      |&amp;2AA    |
   ---------------------------------
   |     4     |George    |&amp;ABC    |
   ---------------------------------

</PRE><P><LI>In the main document, edit the test portion of the conditional field so
   that it matches the newly modified data. For example:
<P>
   If the data is surrounded by parentheses, modify the field to look like
   this:
<P>
   {IF {MERGEFIELD number} = "(1A)" "This is true"}
<P>
   If the data begins with an ampersand, modify the field to look like
   this:
<P>
   {IF {MERGEFIELD number} = "&amp;1A" "This is true"}
<P>
<P>
</OL><h3>Word Version 2.x</h3>
 
<P>
If your alphanumeric data contains entries that begin with a numeric
character, use the print merge Record Selection feature to perform a
conditional merge of the data. By setting record selection rules, you can
merge only data records that meet the criteria you specify.
<P>
The disadvantage of this workaround is that you must perform multiple print
merge operations if your main document contains more than one conditional
statement for alphanumeric fields. In this case, you must modify your main
document for each condition, change the Record Selection settings to
evaluate each condition individually and then perform a separate print
merge operation. The functionality of the Record Selection feature differs
from that of an IF field, so you must modify your print merge procedure
accordingly.
<P>
For example, the following procedure uses the Record Selection feature to
perform a conditional print merge of the sample data file above.
This procedure replaces the following conditional statement:
<P>
<PRE>   {IF {MERGEFIELD TEST} = "1AB" "This is true"}

</PRE><P><LI>Attach the data file to the main document and then activate the main
   document.

<P><LI>On the File menu, click Print Merge, and then click Merge.

<P><LI>Click Record Selection.

<P><LI>In the Field Name list, click to select Test.

<P><LI>In the Is list, click to select Equal To.

<P><LI>In the Compared To box, type "1AB" (without the quotation marks) and
   then click Add Rule. Click OK.

<P><LI>Complete the print merge operation. For record 2, "This is true" should
   appear in the merged document.
<P>
</OL><h3>Word Version 1.x</h3>
 

<OL><P><LI>Sort your data file based on the field that contains entries that begin
   with a numeric character.

<P><LI>Number your data records.

<P><LI>Insert a conditional field, such as IF or NEXTIF, to print merge the
   correct data records.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword2 numbers strings alphabetic <BR>
Keywords          : kbfield kbmerge winword word6 word7 word95 word97 kbualink97<BR>
Version           : WINDOWS:1.0,1.1,1.1a,2.0,2.0a,2.0a- CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.a;97;MACINTOSH:6.0,6.0.1,6.0.1a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
