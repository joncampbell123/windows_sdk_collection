

<HTML>
<HEAD>
<TITLE>How Word for Windows Uses Temporary Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89247 ">
<META NAME="KBModify" CONTENT="1998/03/04">
<META NAME="KBCreate" CONTENT="1992/09/15">
<META NAME="Keywords" CONTENT="winword word7 word8 word95 word97 kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article explains when, where, and how Microsoft Word for Windows creates temporary files.  Definition of a Temporary File  A program creates a temporary file to temporarily store information. The program determines where and when to create tem...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBF0,QAUR,QAFI,QDO7,QAU7,QBXB,QATJ,QA9N,QAJQ,QASB,QABA,QDL9,QBWQ,QBWO P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Word for Windows Uses Temporary Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89247 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, 2.0a,
   2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains when, where, and how Microsoft Word for Windows
creates temporary files.
<P>
<P><h3>Definition of a Temporary File</h3>
 
<P>
A program creates a temporary file to temporarily store information. The
program determines where and when to create temporary files. Temporary
files are available only for the current session of the program.
<P>
<P><h3>Why Does Word Create Temporary Files?</h3>
 
<P>
Speed:
<P>
Word sometimes copies portions of a file into memory so that it can
access the information more quickly when you copy and paste or scroll
through a document. Word references the location of the information
instead of actually accessing the information, which reduces the time
Word spends performing these functions.
<P>
Data Integrity:
<P>
Word's uses temporary files as a "safety net" to protect against system
errors in its file saving scheme. By saving to a temporary file first and
then renaming the file to the proper name, Word ensures the data integrity
of your original file against problems (such as a power failure or lost
network connections) that might occur while the file is being written.
<P>
<P><h2>TEMPORARY FILES IN WORD VERSION 6.0 AND LATER</h2>
 
<P>
Word creates a variety of temporary files.
<P>
<P><h3>MS-DOS-Based File</h3>
 
<P>
These are standard MS-DOS files.
<P>
<P><h3>Document File Based File</h3>
 
<P>
The difference between this file and a traditional MS-DOS file is that
multiple programs can read and write to these files without the original
owner knowing about it. Additionally, document files have inherent
properties that allow Word to create files and directories within files. At
startup, Word creates one temporary (direct) document file called
~wrfxxxx.tmp. You can determine that it is a document file because the
initial size is 1536 bytes. This temporary document file is used to store
all OLE objects belonging to unnamed documents, undo, the Clipboard, and to
documents whose native formats are not document format (for example, .txt,
.rtf, and Word 2.0 documents). Word can open document files using two
different modes: transacted and direct. These modes are discussed later in
this article.
<P>
<P><h3>Transacted Document Files</h3>
 
<P>
Transacted files allow Word to open a file, write to it, and have other
programs--such as Microsoft Excel--write to it, but still retain the
right to restore the file to the state it was in when Word first opened it.
<P>
To do this, the document file creates ghost images (typically ~dftxxxx.tmp)
of all the changes made to the file after it was opened; if Word keeps all
the changes, the contents of ~dftxxxx.tmp merge with the original file, and
then saves a complete version of it. On the other hand, if Word discards
all changes, then ~dftxxxx.tmp is deleted, and the original file does not
change. Word opens all of the Word 6.0 native files using transacted files,
which create ghost images in the Temp directory. When you start Word,
Normal.dot is typically opened in transacted mode, and a ghost file is
created for it called dftxxxx.tmp. FastSave, for example, merges these two
files when a save occurs.
<P>
<P><h3>Direct</h3>
 
<P>
Word uses direct storage when opening the temporary document file and when
performing either a Save As or a Full Save (non-FastSave save). This type
of file is a low (if any) consumer of memory and does not create a ghost
image when created or opened.
<P>
<P><h3>Specific Files That Word Versions 6.0 and Later Create</h3>
 
<P>
The following tables list some of the specific temporary files that Word
creates.
<P>
<P>
<PRE>   Files typically created when Word is started                File name
   ------------------------------------------------------------------------

   MS-DOS-based file (to reserve 4 file handles) 0 bytes      ~wrf0000.tmp
   MS-DOS-based scratch file                     0 bytes      ~mfxxxx.tmp
   Compound file - transacted                    0 bytes      ~dftxxxx.tmp
   Compound file - direct                        1536 bytes   ~wrf0001.tmp
                   (unnamed non-Word/OLE files)

   Word recovery files                                        File name
   -----------------------------------------------------------------------

   Temporary file for AutoSave/AutoRecovery                ~wraxxxx.tmp
   AutoSave (Word 6.0/95)                                  &lt;docname&gt;.asd
   AutoRecovery (Word 97)             AutoRecovery save of &lt;docname&gt;.asd

   Other Word temporary files                                 File name
   -----------------------------------------------------------------------

   Copy of another document                                   ~wrcxxxx.tmp
   Word document                                              ~wrdxxxx.tmp
   Temp document file                                         ~wrfxxxx.tmp
   Dictionary                                                 ~wrixxxx.tmp
   Clipboard                                                  ~wrlxxxx.tmp
   Macro                                                      ~wrmxxxx.tmp
   Word OLE document                                          ~wroxxxx.tmp
   Scratch file                                               ~wrsxxxx.tmp
   Converted (foreign) document                               ~wrvxxxx.tmp

</PRE><h3>A Simplified View of the Scheme Used to Save an Edited File</h3>
 
<P>
<PRE>Create temp file                     Create ~wrdxxxx.tmp
Write temp file                      Save example data to ~wrdxxxx.tmp
Delete original file                 Delete EXAMPLE.DOC
Move temp to target name             Move ~wrdxxxx.tmp to Example.doc

</PRE>Word gains significant performance speed by placing the temporary file in
the same directory as the saved file. If Word placed the temporary file
elsewhere, it would have to use the MS-DOS COPY command to move the
temporary file from the other directory to the saved location. By leaving
the temporary file in the same directory as the saved document file, Word
can use the MS-DOS MOVE command to quickly designate the temporary file as
the saved document.
<P>
<P><h3>When and Where Word Creates Temporary Files</h3>
 
<P>
Word creates temporary files for the following types of data.
<P>
Embedded Word Objects (Temp Directory):
<P>
<PRE>   When Word acts as an OLE server program, the embedded Word objects
   are stored as temporary files in the Temp directory.

   OLE 2.0 requires extra drive storage. When you start OLE programs,
   Word needs to provide copies of the data to the server. It is not
   Unusual for extensive OLE 2.0 usage in a single session of a
   program to accumulate a large amount of temporary storage on
   the hard drive.

</PRE>Scratch File (Temp Directory):
<P>
<PRE>   When Word runs out of internal random access memory (RAM), it always
   creates a single temporary scratch file in the Temp directory to hold
   information. This scratch file holds information that is swapped out
   from the Word internal file cache, which is allocated from global system
   memory. The scratch file varies in size from 64 kilobytes (KB) to 3.5
   megabytes (MB). You can prevent Word from having to write to the scratch
   file by allocating more RAM for Word to use internally.

   The default cachesize in Word is 64 KB.

   For more information about increasing the cachesize in Word, please see
   the following articles in the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../word/q108503.htm">Q108503</A></B>
      TITLE     : WD1015: How to Optimize the Performance of Word 6.0

      ARTICLE-ID: <B><A href="../word/q135872.htm">Q135872</A></B>
      TITLE     : WD95: Where Settings Are Stored in the Registry

      ARTICLE-ID: <B><A href="../word/q157464.htm">Q157464</A></B>
      TITLE     : WD97: Where Settings Are Stored in the Registry

</PRE>Recorded Macro (Temp Directory):
<P>
<PRE>   When you record a macro, Word creates a temporary file in the Temp
   directory.

</PRE>Converted Files (Temp Directory):
<P>
<PRE>   The word processor converters supplied with Word create temporary files
   in Rich Text Format (RTF), which Word uses to access specific
   converters.

</PRE>Locked Files (Temp Directory):
<P>
<PRE>   When you open a file that is locked, either because it is open in
   another window of Word or because another user on the network has it
   open, you can work with a copy of the file. Word places this copy in
   the Windows Temp directory. Likewise, if a template attached to a
   document is locked, Word automatically makes a copy of the template in
   the Temp directory. The copy of a locked file does not automatically
   update the original owner's file.

</PRE>Saved Files (Same Directory as the Saved File):
<P>
<PRE>   When you click Save on the File menu, the following happens:

      - Word builds a new temporary file using the edited version of the
        document.

      - Once Word successfully creates the temporary file, Word deletes the
        previous version of the document.

      - Word renames the temporary file to the same name as the previous
        version of the document.

</PRE>Text Pasted Between Files (Same Directory as Source File):
<P>
<PRE>   When Word copies and pastes between documents, it may create a
   temporary file in the same directory as the source file--especially if
   the source file is saved or closed. The temporary file represents the
   information that was referenced by the Clipboard prior to saving the
   file. Word creates this temporary file by renaming the old copy of the
   file to a temporary file name.

</PRE>Owner File (Same Directory as Source File):
<P>
<PRE>   When a previously saved file is opened for editing, printing or
   review, Word creates a temporary file with a .doc file name extension
   that begins with a tilde "~" followed by a dollar sign "$" followed 
   by the remainder of the original file name. This temporary file holds 
   the logon name of person opening the file and is known as the "owner
   file." When you attempt to open a file that is available on a network
   and is already open by someone else, this file supplies the &lt;user 
   name&gt; for the following error message:

      "This file is already opened by &lt;user name&gt;. Would you like to
       make a copy of this file for your use?"

       If the Owner File is damaged or missing the error message 
       changes to:

      "This file is already opened by another user. Would you like to
       make a copy of this file for your use?"

   Word automatically deletes this temporary file when the original
   file is closed from memory.

</PRE>Automatic Save:
<P>
<PRE>   Word 6.0/7.0 Automatic Save Directory:

      The temporary file created when Word performs an automatic save is
      stored in the Autosave directory. The default Autosave directory is
      the Temp directory.

      Under Windows 95, Word 6.x will create a temporary file with a file
      name extension of .doc in the same directory where Word opens a
      document. For example, when opening Test.doc the result is a
      temporary file called ~$Test.doc. If Word quits abnormally, for
      example if Word stops responding, these files remain in that
      directory.

   Word 97 Auto Recover Save Directory:

      The temporary file created when Word performs an automatic save is
      stored in the Temp folder, unless there is not a valid Temp folder;
      Word then saves the temporary file in the same folder where it
      saves the document.

</PRE><h3>The Location of Temporary Files When You Close a File</h3>
 
<P>
Word may occasionally have to maintain a link to a file after it is
closed. This occurs when text has been copied to the Clipboard from the
file. When you close a file, Word attempts the following actions:

<UL><LI>If the selection that was copied to the Clipboard does not contain
   multiple sections or a picture, or is not large, Word copies the piece
   of the document to the scratch file.

<LI>If the copied selection does contain pictures or multiple sections, or
   if the file is on a floppy disk, Word copies the entire file to the
   Temp directory and moves the pointer there.

<LI>If the file is larger than 256 KB, Word 6.0 maintains an open link to
   the original file.
<P>
</UL><h2>WORD VERSION 2.0 AND EARLIER</h2>
 
<P>
<P><h3>General Notes: How Word for Windows Handles Files</h3>
 
<P>
All Word version 2.0 for Windows files are always stored on disk and
referenced during each Word session. Word for Windows sometimes copies
portions of a file into memory so that Word can access the information
more quickly when you copy and paste information or scroll through a
document.
<P>
Word references the location of the information instead of actually
accessing the information, which reduces the time Word spends performing
these functions. If you copy large portions of a Word document to the
Clipboard, Word for Windows maintains an open handle to the file that
contains the copied information.
<P>
In MS-DOS, you can use the RENAME command within a directory. If
you want to move a file to another directory, you must use the COPY
command. The COPY command is slower than the RENAME command because COPY
rewrites the entire file to disk, whereas RENAME changes only a few bytes
of the file.
<P>
<P><h3>When and Where Word for Windows Creates Temporary Files</h3>
 
<P>
Recorded Macro (Temp Directory):
<P>
<PRE>   When you record a macro, Word for Windows creates a temporary file in
   the Temp directory. This also occurs when it duplicates a template
   because the macros in the template are duplicated through the recording
   code. The Temp directory is specified using the SET TEMP command, which
   is usually located in your Autoexec.bat file.

</PRE>File Save (Same Directory as the Saved File):
<P>
<PRE>   When you run the File Save command, Word does the following things:

    - Word builds a new temporary file (named ~doc####.tmp) using the
      edited version of the document.

    - Once Word successfully creates the temporary file, Word deletes the
      previous version of the document.

    - Word renames the temporary file to the same name as the previous
      version of the document.

    NOTE: If Always Create Backup is selected, Word renames the previous
    version with a .bak file name extension instead of deleting it.

   Word for Windows gains significant performance speed by placing the
   temporary file in the same directory as the saved file. If Word
   placed the temporary file elsewhere, it would have to use the MS-DOS
   COPY command to move the temporary file from the other directory to
   the saved location. By leaving the temporary file in the same
   directory as the saved document file, Word can use the MS-DOS RENAME
   command to quickly designate the temporary file as the saved document
   file.

   Word for Windows uses this scheme to protect against system errors.
   By saving to a temporary file first and then renaming the file to
   the proper name, Word ensures the integrity of your original file
   against problems (such as a power failure or lost network
   connections) that might occur while the file is being written. If
   Word for Windows wrote directly over the original file or copied
   the file from another directory, the original file would be more
   vulnerable to damage.

</PRE>Open a Locked File (Temp Directory):
<P>
<PRE>   When you open a file that is locked, either because it is open in
   another instance of Word for Windows or because another user on the
   network has it open, you can make a copy of the file. Word for
   Windows places this copy in the Windows Temp directory. If you attach a
   locked template, Word for Windows automatically makes a copy of the
   file in the Temp directory. Note: This copy of a locked file does not
   automatically update the original owner's file.

</PRE>AutoSave (Autosave Directory):
<P>
<PRE>   The temporary file created when Word for Windows performs an
   AutoSave is stored in the Autosave directory, which is defined in
   the [Microsoft Word 2.0] section of the Windows WIN.INI file.

</PRE>Embedded Word Objects (Temp Directory):
<P>
<PRE>   When Word for Windows acts as an object-linking-and-embedding (OLE)
   server program, the embedded Word objects are stored as
   temporary files in the Temp directory.

</PRE>Scratch File (Temp Directory):
<P>
<PRE>   When Word for Windows runs out of internal RAM, it always creates a
   single temporary scratch file in the Temp directory to hold
   information. This scratch file holds information that is swapped
   out from the Word for Windows internal file cache, which is
   allocated from global system memory. The scratch file varies in
   size from 64 KB to 3.5 MB. You can prevent Word from having to write
   to the scratch file by allocating more RAM for Word to use
   internally. You do so by increasing the CACHESIZE setting in the
   [Microsoft Word 2.0] section of the Win.ini file. Experimentation
   is required to find optimal settings for every configuration.

</PRE>Converting Files (Temp Directory):
<P>
<PRE>   The word processing converters supplied with Word for Windows
   create temporary files in RTF file format, which are read when Word
   accesses a specific converter.

</PRE>Paste Between Files (Same Directory as Source File):
<P>
<PRE>   When Word copies and pastes between documents, it may create a
   temporary file in the same directory as the source file, especially
   if the source file is saved or closed. The temporary file represents
   the information that was referenced by the Clipboard prior to saving
   the file. Word for Windows creates this temporary file by renaming the
   old copy of the file to a temporary file name (~doc####.tmp).

</PRE>Owner File (Same Directory as Source File):
<P>
<PRE>   When a previously saved file is opened for editing, printing or
   review, Word creates a temporary file with a .doc file name extension
   that begins with a tilde "~" followed by a dollar sign "$" followed by
   the remainder of the original file name. This temporary file is a
   copy of the original file that is open and is referred to as the "owner
   file." When you attempt to open a file that is available on a network
   and is already open by someone else, this file causes Word to prompt
   the following error message:

      "This file is already opened by USER Name.  Would you like to make
       a copy of this file for your use?"

   Word automatically deletes this temporary file when the original
   file is closed from memory.

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q78425.htm">Q78425</A></B>
   TITLE     : Network Message 'Another Use' When Second User Opens File

   ARTICLE-ID: <B><A href="../word/q78386.htm">Q78386</A></B>
   TITLE     : Hidden Temporary Files Left on Hard Drive

   ARTICLE-ID: <B><A href="../word/q86271.htm">Q86271</A></B>
   TITLE     : Error Message: Unrecoverable Disk Error on File
               ~doc####.tmp

   ARTICLE-ID: <B><A href="../word/q105593.htm">Q105593</A></B>
   TITLE     : List of WINWORD6.INI Settings; Word Default Settings

</PRE>See also the "Microsoft Word 6.0 for Windows Resource Kit."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: tmp 8.0 8.00<BR>
Keywords          : winword word7 word8 word95 word97 kbfaq<BR>
Version           : WINDOWS: 1.x, 2.x, 6.x, 7.x, 97;<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
