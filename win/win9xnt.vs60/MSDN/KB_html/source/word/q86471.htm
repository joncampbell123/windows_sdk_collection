

<HTML>
<HEAD>
<TITLE>DDE Channel Not Closed After DDE Time-Out in Word for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86471 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1992/07/07">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you link a Microsoft Word for Windows document to a cell of information in version 3.0 or 4.0 of Microsoft Excel for Windows and you choose the No button in response to the prompt  DDE timed out. Continue waiting?,  the channel between the two a...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QDL9,QBWO,QBWN,QBWQ,QBXS,QBVP,QAZ2,QBJZ,QANE,QAGB,QBWS,QAEV,QDO7,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DDE Channel Not Closed After DDE Time-Out in Word for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86471 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, and 2.0a
<LI>Microsoft Windows operating system, versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you link a Microsoft Word for Windows document to a cell of
information in version 3.0 or 4.0 of Microsoft Excel for Windows and
you choose the No button in response to the prompt "DDE timed out.
Continue waiting?," the channel between the two applications will
remain open, even after you close Word for Windows. Word for Windows
should close the channel to Excel after you to the prompt.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Excel and open a previously opened spreadsheet (for example,
    SHEET1.XLS).

<P><LI>Type text in cell R1C1 in Sheet1, but do not press ENTER (leave the
    cell in active edit mode).

<P><LI>Minimize Excel.

<P><LI>Start Word for Windows. From the File menu, choose New, then choose
    the OK button.

<P><LI>Press CTRL+F9 to create a field. Type the following information
    between the field braces:
<P>
       DDE Excel &lt;filename&gt; R1C1
<P>
</OL>For version 1.x of Word for Windows, follow steps 6-10 to reproduce the
problem. For version 2.0 or 2.0a of Word for Windows, follow steps
6a-9a to reproduce the problem.

<OL><P><LI>With the insertion point in the DDE field, press F9 to update the
    field. The error message "DDE Timed Out. Continue Waiting?" appears.
    Choose the No button.

<P><LI>A second, unnecessary "DDE Timed out..." message appears. Choose
    the No button again.

<P><LI>After the second "DDE Timed out..." message appears, the message
    "Cannot obtain data from Excel for Sheet1, R1C1." appears. Choose
    the OK button.

<P><LI>From the File menu, choose Exit. Choose the No button when prompted
    to save changes to the document.

<P><LI>Try to run Word for Windows again.
<P>
</OL>The message "Word is already running" appears on the screen. This is
not correct. The first instance of Word has been terminated. Exiting
Word should have terminated the DDE link.
<P>
<PRE> 6a. With the insertion point in the DDE field, press F9 to update the
     field. The error message "This task is taking longer than expected. Do
     you want to continue waiting?" appears. Choose the No button.

 7a. A second, unnecessary "This task is..." message appears. Choose
     the No button again.

 8a. After the second "This task is..." message appears, the message
     "Cannot obtain data from Excel for Sheet1, R1C1." appears. Choose the
     OK button.

 9a. From the File menu, choose Exit. Choose the No button when
     prompted to save changes to document.

</PRE></OL>Word stops the system as it tries to exit.
<P>
Microsoft has confirmed this to be a problem in versions 1.0, 1.1,
1.1a, 2.0, and 2.0a of Word for Windows. We are researching this
problem and will post new information here as it becomes available.
<P>
Reference(s):
<P>
"Microsoft Word for Windows User's Reference," version 1.x, pages
177-179
<P>
"Microsoft Word for Windows User's Guide," version 2.0, page 806
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory: kbfield<BR>
Additional query words: 1.0 1.10 1.10a 2.0 2.0a freeze winword2<BR>
winword crash<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
