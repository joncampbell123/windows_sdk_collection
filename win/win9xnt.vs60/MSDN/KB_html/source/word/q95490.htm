

<HTML>
<HEAD>
<TITLE>Excel Temporarily Hangs After Running Word for Windows Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95490 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1993/02/11">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you run a Microsoft Word for Windows macro from Microsoft Excel for Windows using DDE, Excel may temporarily hang (stop responding) if the Word macro contains the FileExit command. This happens if Word is minimized when you launch the macro from...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBVP,QAH4,QAB4,QDL9,QBWO,QBWN,QBWQ,QDO7,QBWS,QAY2,QAGB,QDO5,QBVV,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel Temporarily Hangs After Running Word for Windows Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95490 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c
<LI>Microsoft Excel for Windows, versions 3.0, 4.0
<LI>Microsoft Windows operating system versions 3.0, 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you run a Microsoft Word for Windows macro from Microsoft Excel for
Windows using DDE, Excel may temporarily hang (stop responding) if the
Word macro contains the FileExit command. This happens if Word is
minimized when you launch the macro from Excel. It does not happen if
Word is maximized when you launch the macro from Excel.
<P>
When this happens, an error appears in the Excel spreadsheet cell from
which you launched the Word macro. In Word, the following error
message occurs after several seconds:
<P>
<PRE>   Microsoft Word: This task is taking longer than expected.
   Do you want to continue waiting?

</PRE>If you choose the Yes button, Excel continues to hang temporarily and
Word does not close. If you choose the No button, Word appears to
close and Excel stops hanging.
<P>
<P><h3>Workaround 1</h3>
 
<P>
Remove the FileExit command from the WordBasic macro and send it as a
separate command from Microsoft Excel, via DDE. The following is a
sample Excel macro that sends the FileExit command to Word:
<P>
<PRE>   A1: =INITIATE("winword","system")
   A2: =EXECUTE(A1,"[ToolsMacro.Name=""test"",.Run]")
   A3: =EXECUTE(A1,"[FileExit]")
   A4: =TERMINATE(A1)
   A5: =RETURN()

</PRE><h3>Workaround 2</h3>
 
<P>
Add the AppMaximize command to your Word for Windows macro before the
FileExit command, as shown in the following sample macro:
<P>
<PRE>   Sub Main
   AppMaximize
   FileExit
   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
If you later attempt to launch Word after you receive the "This task
is taking longer..." error message, the following error message occurs
if you are not running the MS-DOS Share utility:
<P>
<PRE>   Word is already running.

</PRE>This happens even though Word is not running because a portion of the
Word program still resides in memory. If this happens, exit and
restart Windows.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this macro code "as is" without
warranty of any kind, either express or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.
<P>
Reference(s):
<P>
"Microsoft Excel User's Guide 2," version 4.0, pages 299-304
<P>
"Microsoft Excel User's Guide," version 3.0, pages 341-344
<P>
"Microsoft Excel Function Reference," version 4.0, pages 139-140
<P>
"Microsoft Excel Function Reference," version 3.0, pages 71-72
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbmacro<BR>
KBSubcategory:<BR>
Additional query words: 4.0 3.0 2.0 2.0a 2.0a-CD 2.0b 2.0c<BR>
winword2  hang hung crash crashed locks locked frozen freezes crashing<BR>
quit quits wait too long  dynamic data exchange link  winword<BR>
errmsg err msg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
