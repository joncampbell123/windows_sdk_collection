

<HTML>
<HEAD>
<TITLE>WD: Known Issues with the Scanprot Macro Virus Protection Tool </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138868">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1995/10/30">
<META NAME="Keywords" CONTENT="macword winword word6 word7 word95 kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="-   This article describes issues known to occur with the Scanprot.dot template which is supplied with the Application Note titled  Macro Virus Protection Tool  (WD1215 for Windows; MW1222 for the Macintosh).  If you are using Word for Windows 95 ver...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBWS,QDO9,QAFI,QAB4,QAUJ,QDL9,QBWQ,QBWO,QBWN,QAH4,QBQ9,QBVV,QAEF,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Known Issues with the Scanprot Macro Virus Protection Tool</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138868</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
<LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
</UL> 
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes issues known to occur with the Scanprot.dot
template which is supplied with the Application Note titled "Macro Virus
Protection Tool" (WD1215 for Windows; MW1222 for the Macintosh).
<P>
If you are using Word for Windows 95 version 7.0, upgrade to version 7.0a.
This latest version of Word is designed to alert you whenever you open a
document that contains macros. Because of the way version 7.0a is designed, 
it does not have some of the problems described below, such as document 
protection and multiple files issues.
<P>
Please note that the Macro Virus Protection Tool and Word version 7.0a are
intended as interim tools only. For a permanent solution to macro virus
problems, install anti-virus software that is specifically designed to
detect Word macro viruses. Such software is available from several third-
party companies. For information on anti-virus software vendors, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q49500.htm">Q49500</A></B>
   TITLE     : Anti-Virus Software Vendors

</PRE><h2>MORE INFORMATION</h2>
 
<P>
 
<P>
<PRE>Symptom:     Documents and Templates protected for forms are unprotected
             when Scanprot has been used to clean the files of macro
             viruses.

Cause:       This is caused by code in the macro protection tool.

Platform:    Macintosh and Windows.

</PRE> 
<P>
<PRE>Symptom:     When you try to open a password-protected forms document, 
             you are prompted for the protection password. If you click
             Cancel instead of entering the password, the error message
             "WordBasic Err=102 - Command failed" appears, and the file
             opens and is not scanned. Note that if you open the file by
             choosing it from the File Most Recently Used list, you are
             not prompted for a password, and the document is scanned.

Cause:       Unknown.

</PRE>Resolution:  None.
<P>
<PRE>Platform:    Macintosh and Windows.

</PRE> 
<P>
<PRE>Symptom:     If you have an autoopen macro that protects a document for
             forms and you choose not to disable the auto macros, the
             template opens unprotected.

Cause:       Unknown.

Platform:    Macintosh and Windows.

   ------------------------------------------------------------------------

Symptom:     When you try to run Scanprot, you receive the following
             error message:

                WordBasic Err=1177 - Document name or path invalid

Cause:       The hard drive name starts with a space. Although the hard
             drive name can start with any number of spaces, some 
             WordBasic operations will fail if a path name starts with a
             space.

</PRE>Resolution:  Remove the spaces in the drive name. This will affect other
<PRE>             parts of Word and other programs; you may also need to
             retype the File Locations setting in Tools Options, and you 
             may need to reregister some applications.

Platform:   Macintosh

</PRE> 
<P>
<PRE>Symptom:     On a Macintosh, when you run Scanprot from a Windows 95-
             formatted floppy disk, you may receive the following error
             message:

                WordBasic Err=154 - Document not found

             The macro then halts.

             Disks formatted by a computer running Windows NT do not
             exhibit this problem when used on the Macintosh.

Cause:       The error occurs because of the way the Macintosh computer
             reads the disk label which has been automatically named by
             Windows 95. The default name given by Windows 95 is 
             "Axxxx".

</PRE>Resolution:  Do either of the following:
<P>
<PRE>              - Copy Scanprot.dot to the Macintosh hard drive, and open 
                it from within Word

                -or-

              - Rename the the floppy disk, using the Macintosh Finder,
                then open Scanprot from within Word

Platform:    Macintosh

</PRE> 
<P>
<PRE>Symptom:     Cannot install Scanprot with WordMail running.

Cause:       If WordMail is started before Word is, it has ownership of
             the Normal template. Scanprot is unable to save its changes
             to the Normal template because WordMail has control of
             Normal.dot.

</PRE>Resolution:  Exit WordMail and then install Scanprot.
<P>
<PRE>Platform:    Windows only.

</PRE> 
<P>
<PRE>Symptom:     "WordBasic Err=1078 - This file could not be found (Global)."

Cause:       There is no Normal template, or the Tools/Options/File
             Locations/User Templates setting points to the wrong 
             folder.

             This can happen on the Macintosh platform if the Word
             Settings File has been removed, and the Normal template is
             not on Word's search path.

</PRE>Resolution:  1. Click OK.
<P>
<PRE>             2. Quit Word (this creates a Normal template).

             3. Restart Word.

             4. In the Tools/Options/File Locations tab, correct the
                setting for User Templates.

             5. Reopen Scanprot.dot.

Platform:    Macintosh and Windows.

</PRE> 
<P>
<PRE>Symptom:     "WordBasic Err=1078 - This file could not be found
             (&lt;file name&gt;)." Where &lt;file name&gt; is the name of your 
             document.

Cause:       This can happen on the Macintosh platform if there is a
             space at the end of the file name.

</PRE>Resolution:  Rename the file to remove the space after the file name.
<P>
<PRE>Platform:    Macintosh

</PRE> 
<P>
<PRE>Symptom:     "WordBasic Err=1025 - Word cannot open the document
             &lt;file name&gt;."

Cause:       The scanning portion of the Protection Tool opened a main
             document, and it can't find the attached data document (the
             data document was renamed, moved, or deleted).

</PRE>Resolution:  When asked if you want to locate the data document, answer
<PRE>             "Yes." Locate the data document and click OK.

             If you answer "No," the main document will not be scanned.

Platform:    Windows and Macintosh.

</PRE> 
<P>
<PRE>Symptom:     The message "This file should be converted into a Master
             Document" appears.

Cause:       The scanning tool encountered a Word 4.x or Word 5.x File
             Series.

</PRE>Resolution:  Answer "No." If you answer "Yes," the scanning continues, 
<PRE>             but an untitled master document is created, and a Word 6.0
             document is created for each document in the file series. 
             In addition, the same question will appear for each 
             subsequent file in the File Series that has a Next File. 
             The remainder of the documents will also produce an 
             untitled document (a master document with the remainder of 
             the files), but it does not create any Word 6.0 copies of 
             the files.

Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     Mouse pointer is corrupted; it displays as an arrow, an
             italic I-bar, or some other unexpected shape.

Cause:       Unknown; happens during File Find portion of scan tool.

</PRE>Resolution:  Wait for the usual pointer shape to return.
<P>
<PRE>Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     There is no "wait" mouse pointer while the scanning portion
             of the tool works. The user receives no indication that the
             macro is still running.

Cause:       Unknown; this happens during the File Find portion of scan.

</PRE>Resolution:  Wait.
<P>
<PRE>Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     File names on NT server are truncated from long file names 
             to 8.3 nomenclature.

Cause:       Unknown.

</PRE>Resolution:  Unknown.
<P>
<PRE>Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     Scanning tool ignores Windows files when run on Macintosh.

Cause:       When a file is copied from a PC disk to a Macintosh, the 
             file type is incorrectly registered as "text." The scanning 
             tool looks only for Word documents and templates.

</PRE>Resolution:  Open the Word for Windows files in Word for the Macintosh,
<PRE>             and save the documents. Run the scan tool again.

Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     "Bad file name error" when you open files from a PC floppy
             disk while using a Macintosh.

Cause:       Anomaly in the WordBasic FileOpen Dialog call.

</PRE>Resolution:  Change the name of the floppy disk after inserting it into 
<PRE>             the Macintosh drive.

Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     When the scan tool examines documents with passwords, you 
             are prompted to enter the password twice.

Cause:       Unknown.

</PRE>Resolution:  Enter the password each time you are prompted for it.
<P>
<PRE>Platform:    Windows and Macintosh.

</PRE> 
<P>
<PRE>Symptom:     When you open a file known to be infected, the scan tool
             doesn't run.

Cause:       The Winword7.reg file has been double-clicked. This removes
             the registry information that Scanprot created.

</PRE>Resolution:  Delete the Scanprot macros from the Normal.dot file and
<PRE>             reinstall Scanprot.

Platform:    Windows only.

</PRE> 
<P>
<PRE>Symptom:     "WordBasic Err=1078 - This file could not be found
             (&lt;aliasname&gt;)."

Cause:       The scanning tool searched alias names that were on the
             Recent Documents list on the Apple menu.

</PRE>Resolution:  None.
<P>
<PRE>Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     The scanning tool shows the message "The file &lt;aliasname&gt; 
             has been cleaned and is a template file, convert to 
             document?"

Cause:       Unable to differentiate between aliases and documents in
             WordBasic.

</PRE>Resolution:  None.
<P>
<PRE>Platform:    Macintosh only.

</PRE> 
<P>
<PRE>Symptom:     Right-click a template with macros, and click Print on the
             File menu. When Word starts and displays the macro alert,
             choose "Yes" to disable the macros.

Result:      The new file is created based on the template but does not
             print.

</PRE>Resolution:  None.
<P>
<PRE>Platform:    Windows only.

</PRE> 
<P>
<PRE>Symptom:     Using the Open command from the File menu produces the 
             error "WordBasic Err=1078 - This file could not be found
             &lt;file name&gt;." (where &lt;file name&gt; is the name of your file) 
             when choosing to open a file.

Cause:       This can happen on the Macintosh platform if the file name 
             has a space at the end of the file name.

</PRE>Resolution:  Rename the file to remove the space after the file name.
<P>
<PRE>Platform:    Macintosh

</PRE> 
<P>
<PRE>Symptom:     When you open a Word attachment from electronic mail and 
             Word is not currently running, Word becomes infected with 
             the virus

Cause:       Unknown.

</PRE>Resolution:  Start Word first prior or opening mail. Open the electronic
<PRE>             mail and then open the Word attachment.

Platform:    Windows.

</PRE> 
<P>
<PRE>Symptom:     When running Scanprot in Word 7 under Windows 95, you may
             receive page fault errors or illegal command errors when
             trying to create a new file from the Start button, from a 
             New document, from the New document button on the Office
             Shortcut Bar, or within Word from the File New command.

Cause:       Scanprot changes some Registry items.

Solution:    Close Word, double-click on the winword7.reg file, then 
             start Word and quit from Word. This will register Word.

              -or-

             Run Word or Office Setup using the "/Y" switch to re
             register all items.

             This problem was corrected in Word version 7.0a. For
             additional information, please see the following article in
             the Microsoft Knowledge Base:

                ARTICLE-ID: <B><A href="../office/q146059.htm">Q146059</A></B>
                TITLE     : Page Fault in KERNEL32.DLL When You Open or
                             Create a Document
</PRE> 
<P>
<PRE>Symptom:     When you run Scanprot, you receive the following error
             message:

                WordBasic Err=102 - Command Failed

             followed by

                Not enough memory to complete the operation

Cause:       The FindFile WordBasic command is not functioning.

</PRE>Resolution:  Delete the Microsoft Find File folder, located in the
<PRE>             System:Preferences folder.

              -or-

             Reinstall the Shared Code dll files (the OLE Client DLL, 
             the OLE Reg DLL, and the OLE Server DLL). To do this, 
             delete or rename the Shared Code folder, located in the
             System:Extensions folder, and then reinstall Word or 
             Office.

</PRE> 
<P>
<PRE>Symptoms:    Scanprot gives the following error message:

               WordBasic Err=513

Cause:       Scanprot is trying to scan a file whose name is complex.

</PRE>Resolution:  Simplify or shorten the file name by removing multiple 
<PRE>             spaces and punctuation. After the file has been scanned and 
             found clear of viruses, you can rename the file back to its
             original file name.

Platform:    Macintosh


</PRE> 
<P>
<PRE>Symptom:     When Word is not running and you right-click a document 
             from Windows 95 and choose Print, a WordBasic error 100
             (Syntax Error) appears and the document is not printed.

Cause:       This problem occurs when the Scanprot.dot macros have been
             manually removed from your Normal template (for example if
             Normal.dot is renamed or deleted). Scanprot.dot changes
             entries in the registry that instruct Word how to handle
             printing and opening documents from Windows.  These DDE
             commands are not syntactically correct and will generate
             the error when a document is launched.

</PRE>Resolution:  Reopen Scanprot.dot and let it install its macros in the
<PRE>             Normal template. The commands that have syntax problems in 
             the registry are not used when the Scanprot macros are 
             installed.

Platform:    Windows 95

</PRE> 
<P>
<PRE>Symptoms:    Nothing happens when you try to merge the Word Settings (5)
             file with Word 6.0.1.

Cause:       Unknown.

</PRE>Resolution:  None.
<P>
<PRE>Platform:    Macintosh.

</PRE> 
<P>
<PRE>Symptoms:    AutoOpen macros execute only when the document is opened 
             from the MRU list. They do not execute when the document is 
             opened by pressing CTRL+O or by clicking Open on the File 
             menu.

Cause:       Unknown.

</PRE>Resolution:  Open the document by clicking Open on the File menu, or by
<PRE>             pressing CTRL+O.
</PRE> 
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: beam scan831 scan831.doc Scanprot.dot scan prot <BR>
prank concept<BR>
Keywords          : macword winword word6 word7 word95 kberrmsg kbtool<BR>
Version           : WINDOWS: 6.0 6.0a 6.0c 7.0; MACINTOSH: 6.0,6.0.1<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug kbref<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
