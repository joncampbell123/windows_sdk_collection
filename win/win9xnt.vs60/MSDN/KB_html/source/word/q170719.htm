

<HTML>
<HEAD>
<TITLE>WD97: Using SendKeys with Dialog Boxes in Word for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170719">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1997/06/27">
<META NAME="Keywords" CONTENT="kbwordvba kbcode kbmacro kbprg">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use the SendKeys function after calling a dialog box, your macro does not run as expected. For example, the following macro does not run correctly:     Sub SendKeysExample()       ChDir  C:\My Documents            ' Change Directory.      ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA01,QAIH,QAH4,QBVV,QAKE,QAH6,QBWS,QAB9,QAX6,QAPF,QAMB,QAFF,QAJH,QANX P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: Using SendKeys with Dialog Boxes in Word for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170719</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SendKeys function after calling a dialog box, your macro
does not run as expected. For example, the following macro does not run
correctly:
<P>
<PRE>   Sub SendKeysExample()
      ChDir "C:\My Documents"           ' Change Directory.
      Dialogs(wdDialogFileOpen).Show    ' Show the FileOpen dialog.
      SendKeys "%A" '                   ' Send the ALT+A keystroke.
   End Sub

</PRE><h2>CAUSE</h2>
 
<P>
Visual Basic for Applications processes code one line at a time. The
SendKeys function sends the specified keys to the active application, just
as if they were typed at the keyboard. If Word is not the active
application, and if wait is set to -1, Word will wait for all the keys to
be processed before proceeding.
<P>
Whenever a Word dialog box is opened, it becomes the active foreground
application and it is ready to take commands; it also must be terminated
(with OK or Cancel) before the next line can be processed.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
In the example, the SendKeys command should come before the Dialogs command
so that the FileOpen dialog box can process the keys and display the
Advanced search dialog box. Then the next line of code can be processed.
<P>
<PRE>   Sub SendKeysExample()
      ChDir "C:\My Documents"           ' Change Directory.
      SendKeys "%A"                     ' Send the ALT+A keystroke.
      Dialogs(wdDialogFileOpen).Show    ' Show the FileOpen dialog.
   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For more information about SendKeys, please see the following articles in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A href="../word/q165078.htm">Q165078</A></B>
   TITLE: WD97: Some Open Shortcuts Changed

   ARTICLE ID: <B><A href="../urjump.htm">Q163575</A></B>
   TITLE: WD97: Macro to Set "Float Over Text" in Insert Object Dialog Box

</PRE>For more information about SendKeys, from the Visual Basic for Applications
Editor, click the Office Assistant, type "SendKeys," click Search, and then
click to view "SendKeys Statement."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: offcon wordcon vba vb vbe execute<BR>
Keywords          : kbwordvba kbcode kbmacro kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
