

<HTML>
<HEAD>
<TITLE>WD97: How to Insert a Caption Next to an Equation or Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158918">
<META NAME="KBModify" CONTENT="1998/03/11">
<META NAME="KBCreate" CONTENT="1996/11/07">
<META NAME="Keywords" CONTENT="kbfield kblayout kbmacroexample word8 word97 kbualink97 kbusage kbdta kbdtacode">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Word does not offer a built-in method to automatically insert a caption flush with the right margin of the document. Many scientific journals require equation objects to be in one of two formats: the equation is centered and the caption is right-al...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAPN,QACI,QBJZ,QAEB,QA9N,QBWS,QAB9,QAW6,QAIB,QAEF,QDMY,QA2Q,QBS0,QAC2 P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: How to Insert a Caption Next to an Equation or Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158918</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Word does not offer a built-in method to automatically insert a caption
flush with the right margin of the document. Many scientific journals
require equation objects to be in one of two formats: the equation is
centered and the caption is right-aligned; or, the equation is left-
aligned and the caption is right-aligned. In both cases, the caption number
is enclosed in parentheses. This article describes several methods for
formatting equation objects in one of these styles.
<P>
NOTE: This article uses the term "equation," but this method applies to any
item (such as a figure or picture) where the caption needs to appear on the
same line as the object.
<P>
Examples of scientific journal formats:
<P>
<PRE>                              y = mx + b                            ( 1 )

</PRE>- or -
<P>
<PRE>y = mx + b                                                          ( 1 )

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step 1: Setting Up the Caption</h3>
 
<P>
To create the caption label with the parentheses, follow these steps:

<OL><P><LI>On the Insert menu, click Caption.

<P><LI>Click New Label.

<P><LI>In the Label box, type an opening parenthesis.

<P><LI>Click OK.

<P><LI>In the Caption box, to the right of the number, type a space.

<P><LI>Type a closing parenthesis.

<P><LI>Click OK.
<P>
</OL>Once you create the caption format, you can insert additional captions by
doing the following:

<OL><P><LI>On the Insert menu, click Caption.

<P><LI>In the Caption box, to the right of the existing caption, type a space
    and a closing parenthesis.

<P><LI>Click OK.
<P>
</OL><h3>Step 2: Aligning the Equation and Caption</h3>
 
<P>
NOTE: If you intend to cross-reference the caption number, use Method 2.
<P>
Method 1: To set a right-aligned Equation and Caption Number:

<OL><P><LI>On the Insert menu, click Caption.

<P><LI>Under Label, select the Open Parenthesis, type a space and a closing
    parenthesis, and then click OK.

<P><LI>Move the insertion point to the beginning of the line, before the 
    caption.

<P><LI>Set a right-aligned tab at the right margin. For example, if the right
    margin is six inches from the left margin, set the right-aligned tab at
    six inches by:
<P>
    a. On the Format menu, click Tabs.
<P>
    b. Under Tab Stop Position, enter 6.
<P>
    c. Under Alignment, click Right.
<P>
    d. Click OK.

<P><LI>Insert the equation. 

<P><LI>Press the TAB key to move the caption to the right edge of the page.
<P>
    NOTE: When you insert the equation, clear the Float Over Text check box.
    The equation object must be an inline object for this method to work.
<P>
</OL>Method 2: To set a a left-aligned Equation:

<OL><P><LI>On a new, blank line, insert the equation.
<P>
    NOTE: When you insert the equation, clear the Float Over Text check box.
    The equation object must be an inline object for this method to work.

<P><LI>Exit the Equation Editor by clicking anywhere in the document area.

<P><LI>Press TAB and then insert the caption.

<P><LI>Select the entire line containing the equation and caption. On the Table
    menu, click Convert Text to Table. The selection is converted to a two
    column table.

<P><LI>Remove the border around the table by doing the following:
<P>
    a. With the table selected, on the Format menu, click Borders and 
       Shading.
<P>
    b. Under Setting, select None.
<P>
    c. Click OK.

<P><LI>Select the table cell that contains the caption and then click the Align
    Right button on the Formatting toolbar.
<P>
</OL>Method 3: To set a center-aligned Equation:

<OL><P><LI>On a new, blank line, press TAB, and then insert the equation.

<P><LI>Exit the Equation Editor by clicking anywhere in the document area.
<P>
    NOTE: When you insert the equation, clear the Float Over Text check box.
    The equation object must be an inline object for this method to work.

<P><LI>Press TAB and then insert the caption.

<P><LI>Select the entire line containing the equation and caption. On the Table
    menu, click Convert Text to Table. The selection is converted to a three
    column table.

<P><LI>Remove the border around the table by doing the following:
<P>
    a. With the table selected, on the Format menu, click Borders and 
       Shading.
<P>
    b. Under Setting, select None.
<P>
    c. Click OK.

<P><LI>Select the table cell containing the equation and click the Center
    button on the Formatting toolbar.

<P><LI>Select the table cell containing the caption and click the Align Right
    button on the Formatting toolbar.
<P>
</OL>Method 4: Create a Microsoft Visual Basic for Applications macro:
<P>
Create a macro that automates the process outlined in Method 2.
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<PRE>     
   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

   Sub CaptionRight()
      Dim Align As Integer
      On Error GoTo bye
      If Selection.Information(wdWithInTable) Then
         MsgBox "You are in a table. Please move outside of the " _
            &amp; "table to run this macro.", vbInformation
         Exit Sub
      End If
      Align = MsgBox("Would you like the Equation to be " _
               &amp; "centered? (Selecting No will left-align the " _
               &amp; "Equation.)", vbYesNoCancel)
      If Align &gt; 2 Then
         Selection.InsertParagraphAfter
         Selection.Collapse (wdCollapseEnd)
         W = ActiveDocument.PageSetup.PageWidth
         L = ActiveDocument.PageSetup.LeftMargin
         R = ActiveDocument.PageSetup.RightMargin
         RTMarg = W - R - L
         CaptionLabels.add Name:="("
         If Align = 6 Then
            tblT1 = Selection.Tables.add(Selection.Range, 1, 3)
         Else
            tblT1 = Selection.Tables.add(Selection.Range, 1, 2)
         End If
         tblT1.Select
         With Selection
            If Align = 6 Then
               .Columns(1).Cells.Width = 50.4
               .Columns(3).Cells.Width = 50.4
               .Columns(2).Cells.Width = RTMarg - 100.8
               'Represents 1.5" in Points
            Else
               .Columns(2).Cells.Width = 50.4
               .Columns(1).Cells.Width = RTMarg - 50.4
                 'Represents .75" in Points
            End If
            .InsertCaption Label:="(", _
               Position:=wdCaptionPositionBelow, Title:= " )"
            .HomeKey unit:=wdLine, Extend:=wdExtend
            .Cut
            .MoveRight unit:=wdCharacter, Extend:=wdExtend
            .Delete
            .MoveLeft unit:=wdCharacter, Count:=2
            .Paste
            .Rows(1).Select
            For Each x In Selection.Borders
               x.LineStyle = wdLineStyleNone
            Next x
            .Borders.Shadow = False
            .Cells(9 - Align).Select
            .ParagraphFormat.Alignment = wdAlignParagraphRight
            .Cells(1).VerticalAlignment = wdCellAlignVerticalCenter
            .Font.Bold = True
            .Rows(1).Select
            If Align = 6 Then
               .Cells(2).Select
               .ParagraphFormat.Alignment = wdAlignParagraphCenter
               .InlineShapes.AddOLEObject ClassType:="Equation.3", _
                   FileName:="", LinkToFile:=False, DisplayAsIcon:=False
            Else
               .Collapse
               .InlineShapes.AddOLEObject ClassType:="Equation.3", _
                 FileName:="", LinkToFile:=False, DisplayAsIcon:=False
            End If
         End With
      End If
   End Sub

</PRE></OL>Several methods exist for inserting captions. AutoCaption will insert a
caption either above or below an inserted object; manually inserted
captions are placed above or below the object when the object is selected,
or to the immediate right when the insertion point is to the right of the
object.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q173707.htm">Q173707</A></B>
   TITLE     : OFF97: How to Run Sample Code from Knowledge Base Articles

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about getting help with Visual Basic for Applications,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for 
               Applications

</PRE>For information about how to do this in earlier versions of Word, see the
following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../word/q123430.htm">Q123430</A></B>
<PRE>TITLE     : WD: How to Insert a Caption Next to an Equation or Object
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: equations captions right center centered align<BR>
alignment position positioned equation table figure photo picture pictures<BR>
object objects graphic graph 8.0 word8 word97<BR>
Keywords          : kbfield kblayout kbmacroexample word8 word97 kbualink97 kbusage kbdta kbdtacode<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
