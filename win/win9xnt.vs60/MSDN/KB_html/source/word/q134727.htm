

<HTML>
<HEAD>
<TITLE>WD: What to Do If You Have a Macro Virus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134727">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="macword ntword winword word6 word7 word8 word95 word97 wordnt kbtshoot kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The first macro virus was discovered in the summer of 1995. Since that time, other macro viruses have appeared. This article describes what to do if you think you might have a Word macro virus, or if you want to ensure that your documents never bec...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBQ9,QAIH,QAH4,QBJZ,QBWS,QBHJ,QAEF,QACI,QAMN,QA9N,QBVV,QABA,QDO7,QA36,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: What to Do If You Have a Macro Virus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134727</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The first macro virus was discovered in the summer of 1995. Since that
time, other macro viruses have appeared. This article describes what to do
if you think you might have a Word macro virus, or if you want to ensure
that your documents never become infected with one.
<P>
The following are some symptoms of a Word macro virus that are known to
affect Word and Word documents:

<UL><LI>When you try to save a document, Word only lets you save the
   document as a template.
<P>
<P><PRE>    -or-
</PRE>
<LI>The icon for the file looks like a template rather than a document.
<P>
<P><PRE>    -or-
</PRE>
<LI>When you open a document, a dialog box showing the number 1 appears.
<P>
<P><PRE>    -or-
</PRE>
<LI>New macros appear in the list of macros. AutoOpen and FileSaveAs macros
   may also appear; if you already had macros by these names, their content
   may have been changed by the macro virus.
<P>
<P><PRE>    -or-
</PRE>
<LI>The Winword6.ini file contains the following line:
<P>
<P><PRE>      ww6=1
</PRE><P>
<P><PRE>    -or-
</PRE>
<LI>Unusual or unexpected messages appear when you open a Word
   document or template.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To protect your existing and future documents from Word macro viruses, you
must install software that is specifically designed to detect and remove
macro viruses.
<P>
For information on anti-virus software vendors, including a list software
capable of detecting and preventing macro viruses, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q49500.htm">Q49500</A></B>
   TITLE     : Anti-Virus Software Vendors

</PRE><h2>WORKAROUND</h2>
 
<P>
Use the following workarounds as interim solutions only.
<P>
NOTES:

<UL><LI>Word version 7.0a for Windows 95, and the Macro Virus Protection Tool
   are designed to alert you if you open a file that contains macros,
   regardless of what the macros do. For a permanent solution, you must
   use anti-virus software that is specifically designed to detect and
   prevent macro viruses.

<LI>Word 7.0a doesn't look for or remove any macro viruses from existing
   documents and templates. It will simply warn you if the document you
   are opening contains macros. The warning lets you either open the
   document with the macros active or open it with the macros disabled.
   You should not open a document with the macros active unless you are
   absolutely sure that the document contains no harmful macro viruses.

<LI>The Macro Virus Protection Tool (available for Word 6.0 users only)
   includes the ability to look for Word files that contain the Concept
   Virus and to remove the Concept Virus if it is found. However, it looks
   ONLY for the Concept Virus and not for any other type of macro
   virus. Since the development of the Macro Virus Protection Tool,
   many other macro viruses have been discovered, and the tool is not
   capable of searching for these viruses.
<P>
</UL>For a long-term solution to macro viruses, install anti-virus software that
is specifically designed to detect macro viruses. For information on anti-
virus software vendors, including software capable of detecting and
preventing macro viruses, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q49500.htm">Q49500</A></B>
   TITLE     : Anti-Virus Software Vendors

</PRE><h3>Method 1: Upgrade to Word 7.0a, Word 97, or Word 98 Macintosh Edition</h3>
 
<P>
<P><h3>Windows</h3>
 
<P>
If you are using Word for Windows 95 version 7.0, obtain Word version 7.0a.
Version 7.0a alerts you if you try to open a file that contains macros.
If you are using any version of Word for Windows earlier than Word 95,
upgrade to Word 97 for Windows.
<P>
<P><h3>Macintosh</h3>
 
<P>
If you are using version 6.0, 6.0.1, or 6.0.1a, upgrade to Microsoft
Word 98 Macintosh Edition.
<P>
To obtain pre-sales information about new or updated Microsoft products,
call the Microsoft Sales Information Center at (800) 426-9400. If you are
outside the United States, contact the Microsoft subsidiary for your area.
To locate your subsidiary, see the Microsoft World Wide Offices Web site
at:
<P>
<PRE>   <B><A href="http://www.microsoft.com/worldwide/default.htm">http://www.microsoft.com/worldwide/default.htm</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE><h3>Method 2: Obtain the "Macro Virus Protection Tool"</h3>
 
<P>
If you are using Word version 6.x (for Windows or Macintosh), obtain the
Microsoft Application Note titled "Macro Virus Protection Tool." The Word
for Windows version is WD1215, and the Word for the Macintosh version is
MW1222.
<P>
These Application Notes contain a tool called Scanprot.dot that alerts you
if you try to open a file that contains macros. It does not clean the
macros from your system.
<P>
For more information about how to obtain these Application Notes, please
see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q134728.htm">Q134728</A></B>
   TITLE     : WD1215: "Macro Virus Protection Tool" for Word for Windows

   ARTICLE-ID: <B><A href="../word/q133895.htm">Q133895</A></B>
   TITLE     : MW1222: "Macro Virus Protection Tool" for Word for the
               Macintosh

</PRE>The "Macro Virus Protection Tool" will install the following macros in your
Normal (Normal.dot) template: AutoExit, FileOpen, InstVer, and ShellOpen.
<P>
<P><h3>Method 3: Press SHIFT When You Open a File</h3>
 
<P>
If you do not have any of the symptoms described in this article, but you
do not want to be affected by a macro virus, hold down the SHIFT key when
you open a file that might be affected by a macro virus. Pressing SHIFT
will prevent any Auto macros from being run; if a macro virus is present,
it will not be loaded.
<P>
<P><h3>Method 4: Delete the Macro and Recover the Document</h3>
 
<P>
If you have experienced the symptoms listed in this article, or if you
suspect that you have a macro virus that is not described here, use the
following steps to remove the offending macros and correct affected
documents. (Remember, this is only a temporary solution; because new
macros are being created, these steps may not work):

<OL><P><LI>Close Word and rename the Normal.dot file to Normal.xxx (Windows) or
    move Normal to the Desktop.

<P><LI>Make a back-up copy of an affected file.

<P><LI>Open Word.

<P><LI>On the File menu click Open.

<P><LI>Navigate to the folder containing the affected file.

<P><LI>Click to select the affected file.

<P><LI>Press and hold the SHIFT key and click Open.
<P>
    Continue to hold the SHIFT key until the affected file is open
    in Word.
<P>
    NOTE: Holding the SHIFT key while opening a file keeps any of Words
    automatic macros from running.

<P><LI>To remove suspect virus containing macros, follow the steps below:
<P>
    a. On the Tools menu, click Macro.
<P>
    b. In the Macros Available In list, click All Active Templates.
<P>
    c. Select the suspect macro and click Delete. Click Yes.
<P>
    d. Repeat step c for all suspect macros.
<P>
    e. Click Close.

<P><LI>To recover the text of an infected document:
<P>
    a. Select the entire document by pressing CTRL+A (Windows) or
       COMMAND+A (Macintosh), or by clicking Select All on the Edit
       menu.
<P>
    b. Delete the document's final paragraph mark from the selection
       by pressing SHIFT+LEFT ARROW.
<P>
    c. On the Edit menu, click Copy.
<P>
    d. On the File menu, click New. Select the template you want to
       use, and click OK.
<P>
    e. On the Edit menu, click Paste.
<P>
    f. Repeat step 8 to ensure that the virus containing macros have not
       again replicated.
<P>
    g. Save the document.

<P><LI>Repeat these steps for any document suspect of containing a macro
    virus.
<P>
</OL>NOTE: If this method does not work, try Method 5.
<P>
<P><h3>Method 5: Using the Organizer to temporarily clean up macro viruses</h3>
 
<P>
Use the Organizer to clean up the macro virus. Keep in mind that if
other files were opened after the infected file, they most likely will
be infected as well.
<P>
To Remove the virus from the Normal template:

<OL><P><LI>Close all documents. If an infected document is open, it can easily
   reinfect Normal.dot (Windows) or Normal (Macintosh).

<P><LI>On the File menu, click Templates, and click the Organizer button.

<P><LI>Select the Macros tab. Rename or delete all of the following macros:
<P>
<P><PRE>      AutoClose
      AutoExec
      AutoOpen
      FileExit
      FileNew
      FileOpen
      FileSave
      FileSaveAs
      Macros
      ToolsMacro
</PRE>
<P><LI>Close the Organizer.

<P><LI>On the File menu, click Save All to save the template.
<P>
</OL>To remove the virus from infected documents:
<P>
If a file is infected, use the same method as above, but remove the macros
from both the Normal template and also from the infected document
(template) while in the Organizer. When you are done, click the File menu
and click Save All and move on to the next file. Keep in mind that every
time you open an infected file it will infect your Normal template, so you
constantly need to remove the macros from the Normal template.
<P>
<P><h3>Method 6: Insert It into a New Document</h3>
 
<P>
With this method, you will need to rename Normal.dot (Windows) or move
Normal to the Desktop (Macintosh) and then on the Insert menu, click File
to temporarily remove the macros. This method is particularly useful with
The macro virus called "CAP" that removes Macro and Customize from the
Tools menu.
<P>
NOTE: In this situation, the Templates command (Word 6.x and 7.x) may
not work.

<OL><P><LI>Close Word and rename the Normal.dot file to Name.dot (Windows) or move
   Normal to the Desktop (Macintosh).

<P><LI>Open Word and verify that Macro and Customize are on the Tools menu.

<P><LI>Open a new document. On the Insert menu, click File.

<P><LI>Navigate to the folder containing the affected file.

<P><LI>Click to select the affected file.

<P><LI>Press and hold the SHIFT key and click Open.
<P>
   Continue to hold the SHIFT key until the affected file is open
   in Word.
<P>
   NOTE: Holding the SHIFT key while opening a file keeps any of Words
   automatic macros from running.

<P><LI>To see if there are any macros in the new document (there should not be
   any listed), click Macro on the Tools menu. In the Macros Available In
   list, click All Active Templates.

<P><LI>Save the file with a different file name.

<P><LI>Delete the infected file.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
A macro virus is a program written in the macro language of a program, like
Word. It propagates itself among data files and can harm your files or your
computer's operating system.
<P>
Word macro viruses do not travel freely over the Internet or any other
media; they can only be transferred when a user opens a document or
template that contains the virus macro.
<P>
Microsoft Internet Assistant and documents created or read by it
cannot be affected by such macros. Internet Assistant, by design,
blocks the mechanism that distributes the macro virus.
<P>
Macro viruses cannot be transferred by WordMail unless an affected document
is embedded in the e-mail message and the receiver opens the document.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: virus disinfect protect protected corporate infect<BR>
protection normal.dot saving opening saveas nuclear DMV prank concept<BR>
Keywords          : macword ntword winword word6 word7 word8 word95 word97 wordnt kbtshoot kbfaq<BR>
Version           : Windows: 6.0,6.0a,6.0c,7.0,7.0a,97; Macintosh: 6.0,6.0.1,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
