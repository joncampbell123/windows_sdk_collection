

<HTML>
<HEAD>
<TITLE>How to Use WordBasic to Return Values from Win.ini or Registry </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86470 ">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1992/07/07">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Using the Microsoft WordBasic GetProfileString and GetPrivateProfileString functions, you can extract information from the Windows Win.ini file if you are using Windows 3.x or the Registry if you are using Word 7.0.  Below are macros that demonstra...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QDL9,QBWO,QBWN,QBWP,QBWQ,QAH4,QA5F,QABA,QAFI,QAUD,QAFF,QDO7,QBXB,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Use WordBasic to Return Values from Win.ini or Registry</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86470 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, 2.0a,
   2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Word for Windows NT, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using the Microsoft WordBasic GetProfileString and GetPrivateProfileString
functions, you can extract information from the Windows Win.ini file if you
are using Windows 3.x or the Registry if you are using Word 7.0.
<P>
Below are macros that demonstrate the use of the GetProfileString and
GetPrivateProfileString functions.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h3>Word 7.0 for Windows 95 and Word for Windows NT</h3>
 
<P>
In Windows 95 and Windows NT, settings are stored in the Registry. You can
use SetProfileString and GetProfileString$() to set and return settings
from a text file with the name Win.ini (see Word version 6.x macro below),
but neither Windows 95, Windows NT, nor Word 7.0 uses these settings. To
access values in the Registry from within WordBasic, you need to use the
GetPrivateProfileString$() function.
<P>
In the following macro, the program directory path for Word 7.0 in the
Windows registry is retrieved and stored in the proofdir$ variable. Note:
For Word for Windows NT, substitute 6.0 for 7.0 in the registry key for
GetPrivateProfileString$() shown below.
<P>
<PRE>Sub MAIN
</PRE>progdir$ =
GetPrivateProfileString$("HKEY_CURRENT_USER\Software\Microsoft\Word\7.0\opt
ions", "Programdir", "")
MsgBox progdir$
<PRE>End Sub

</PRE><h3>Word 6.x for Windows</h3>
 
<P>
In the following macro, the proof path under the [MSAPPS] heading in the
Win.ini file is retrieved and stored in the A$ variable.
<P>
<PRE> Sub MAIN
 A$ = GetProfileString$("MSAPPS", "PROOF")
 Msgbox "Proof directory is " + A$
 End Sub

</PRE><h3>Word 2.x for Windows</h3>
 
<P>
If the DOC-path statement is not present in the [Microsoft Word 2.0]
section of your Win.ini file, a dialog box indicates that the default
directory has not been set.
<P>
<PRE> Sub MAIN
 A$ = GetProfileString$("Microsoft Word 2.0", "DOC-Path")
 If A$ = "" Then
  MsgBox "Default Directory is not set"
 Else
  MsgBox "Default Directory is " + A$
 End If
 End Sub

</PRE><h3>Word 1.x for Windows</h3>
 
<P>
<PRE> Sub MAIN
 A$ = GetProfileString$("Microsoft Word", "DOC-Path")
 If A$ = "" Then
  MsgBox "Template Directory is not set"
 Else
  MsgBox "Template Directory is " + A$
 End If
 End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
If you are using Word 7.0 and the GetPrivateProfileString$() function in
Windows 95 and Windows NT to return a setting in the Registry, you must
specify the complete path to the key, including the root (for example,
"HKEY_CURRENT_USER\software\Microsoft\Word\7.0\Options").
<P>
Word 6.0 for Windows stores most of the Word-specific settings in the
Winword6.ini file. This file is located in your Windows folder. Using the
GetPrivateProfileString statement, you can read information from the
Winword6.ini file.
<P>
If you are using Word 2.x for Windows, you can use the Microsoft
Windows GetPrivateProfileString command in a WordBasic macro to
read information from an .ini file other than the Win.ini file. For
more information, query on the following words in the Microsoft
Knowledge Base:
<P>
<PRE>   private and text and file

</PRE><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, page 228
"Microsoft Word Developers Kit", by MS Press
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbmacro kbhowto<BR>
KBSubcategory:<BR>
Additional query words: 1.0 1.10 1.10a 2.0 2.0a 2.0a-CD 2.0b 2.0c<BR>
6.0 6.0a 6.0c 7.0 winword2 winword word6 word7 word95 registry ntword<BR>
wordnt<BR>
Version           : 1.x 2.x 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
