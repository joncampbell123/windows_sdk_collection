

<HTML>
<HEAD>
<TITLE>WD: Sample 'While EditFindFound' Looping Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86259 ">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1992/07/01">
<META NAME="Keywords" CONTENT="macword macword5 winword winword2 word6 word95">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following sample macros can be used to search for the occurrence of text in a Microsoft Word document.  MORE INFORMATION  NOTE: Microsoft provides macros  as is  without warranty of any kind, either expressed or implied, including but not limit...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALX,QAM9,QAIH,QATX,QAMB,QBVV,QAZM,QAZL,QAH4,QA01,QBE7,QBE6,QAUD,QAPF,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Sample 'While EditFindFound' Looping Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86259 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, 2.0a,
   2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following sample macros can be used to search for the occurrence of
text in a Microsoft Word document.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: Microsoft provides macros "as is" without warranty of any kind,
either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h3>Word 6.x, 7.x</h3>
 
<P>
This sample macro prompts you for a text string to search for and then
returns the number of times the text was found in a message box. The
macro starts at the top of the document and counts the total number of
occurrences in the document.
<P>
<PRE>   Sub MAIN
      StartOfDocument
      counter = 0
      On Error Goto bye
      searchtext$ = InputBox$("Enter text to search for?")
      EditFind .Find = searchtext$, .Direction = 0
      If Not EditFindFound() Then
         MsgBox "Search Text Not Found"
         Goto bye
      End If
      While EditFindFound()
         counter = counter + 1
         EditFind .Find = searchtext$, .Direction = 0
      Wend
      MsgBox searchtext$ + " was found" + Str$(counter) + "time(s)"
   bye:
   End Sub


</PRE><h3>Word 2.x</h3>
 
<P>
<PRE>   Sub MAIN
      StartOfDocument
      counter = 0
      On Error Goto bye
      searchtext$ = InputBox$("Enter text to search for?")
      EditFind .Find = searchtext$, .Direction = 2
      If Not EditFindFound() Then
         MsgBox "Search Text Not Found"
         Goto bye
      End If
      While EditFindFound()
         counter = counter + 1
         EditFind .Find = searchtext$, .Direction = 2
      Wend
      MsgBox searchtext$ + " was found" + Str$(counter) + "time(s)"
   bye:
   End Sub


</PRE><h3>Word 1.x</h3>
 
<P>
Make the following substitutions in the Word 2.x macro:

<UL><LI>Change the EditFind commands to the following syntax:
<P>
<P><PRE>      EditSearch .Search = searchtext$, .Direction = 2
</PRE>
<LI>Change the line, "If Not EditFindFound() Then" to the following:
<P>
<P><PRE>      If Not EditSearchFound() Then
</PRE>
<LI>Change the line, "While EditFindFound()" to the following:
<P>
<P><PRE>      While EditSearchFound()
</PRE><P>
</UL>The counter variable is used to count the number of times the search text
is found (counter = counter + 1). If the search text is not found in the
document, a message box informs you that the search text was not found.
<P>
If you want to apply a format or perform commands when the search text
is found, add the appropriate commands below the EditFind command. For
example, in Word 2.x:
<P>
<PRE>   EditFind .Find = searchtext$, .Direction = 2
   FormatCharacter .Bold = 1     'Makes search text bold

   While EditFindFound()
      counter = counter + 1
      EditFind .Find = searchtext$, .Direction = 2
      FormatCharacter .Bold = 1     'Makes search text bold
   Wend

</PRE>If the search text is found, the text formatting is changed to bold and
the counter increments by 1. Other WordBasic commands can be used in place
of the line that reads "FormatCharacter .Bold = 1." (WordBasic commands
entered below the EditFind command are executed when the search text is
found.)
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Using WordBasic," by WexTech Systems and Microsoft, pages 180-181
<P>
"Microsoft Word for Windows and OS/2 Technical Reference," pages
200, 224-225, 286
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.0 1.10 1.10a 2.0 2.0a 2.0a-cd 2.0 2.0c<BR>
6.0 6.0a 6.0c 7.0 7.0a 6.0.1 cwinword2 word95 winword msgbox<BR>
search loop editsearchfound search macword word7 word6 find while<BR>
editfindfound<BR>
Keywords          : macword macword5 winword winword2 word6 word95<BR>
Version           : WINDOWS: 1.0, 1.1, 1.1a, 2.0, 2.0a, 2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c, 7.0, 7.0a; MACINTOSH:3.0,3.01,3.02,4.0,5.0,5.10,6.0,6.0.1,6.0.1a;<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
