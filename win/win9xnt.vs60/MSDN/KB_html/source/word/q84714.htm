

<HTML>
<HEAD>
<TITLE>WinWord: PAGEREF Field Does Not Work with INCLUDE Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84714 ">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1992/05/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Word for Windows, if you use a PAGEREF field inside an INCLUDE field, the PAGEREF field will not reference the correct page number.  MORE INFORMATION  The PAGEREF field inserts the page number of a specific bookmark as a cross-referenc...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QAIH,QA7O,QBJZ,QBGD,QA50,QAXB,QAPP,QBTP,QBXV,QBD2,QBWA,QBWR,QDL9,QBWQ P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WinWord: PAGEREF Field Does Not Work with INCLUDE Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84714 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a
<LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b, 2.0c
<LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Word for Windows, if you use a PAGEREF field inside an
INCLUDE field, the PAGEREF field will not reference the correct page
number.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The PAGEREF field inserts the page number of a specific bookmark as a
cross-reference. If you use this field in a document that is included
as a linked document in a second document, the second document will
not display the correct result of the included PAGEREF field unless
the PAGEREF fields are updated individually before the entire INCLUDE
field is updated. This problem occurs because of the order in which
nested fields are updated. Fields are updated from the innermost field
to the outermost one. When the INCLUDE field is updated, the nested
PAGEREF fields update first and therefore without a proper reference.
This results in incorrect page numbers.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid this problem, when you insert documents into a second
document using PAGEREF fields, do NOT use the Link option. This
eliminates the active link between documents and causes Word to
correctly display all PAGEREF field results.
<P>
In certain situations, you may want to prevent the original values of
the PAGEREF fields in the source document from updating when you
insert the source document into the second document. In these
situations, you can lock the INCLUDE field with the \! switch to keep
the PAGEREF fields from updating in the second document.
<P>
For more information on using the lock field switch:

<UL><LI>Search for "Field Types and Instructions" and "Page Ref." using the
   Help menu in Word version 2.0 or 2.0a for Windows.
<P>
  -or-

<LI>Query on the following words in the Microsoft Knowledge Base:
<P>
<P><PRE>      pageref and bookmark and field and switch
</PRE><P>
</UL><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>In a new document, type "1st bookmark" (without the quotation
   marks), and press ENTER.

<P><LI>Select the new text. From the Insert menu, choose Bookmark, and
   type the bookmark name "b1" (without the quotation marks).

<P><LI>On a new line, type "see page {pageref b1}" (without the quotation
   marks). Press ENTER. Note: The braces are created by pressing CTRL+F9.

<P><LI>From the Insert menu, choose Break.

<P><LI>Select Page Break, then choose the OK button.

<P><LI>Type "2nd bookmark" (without the quotation marks), and press ENTER.

<P><LI>Select the new text. From the Insert menu, choose Bookmark. Type
   the bookmark name "b2" (without the quotation marks).

<P><LI>On a new line, type "see page {pageref b2}" (without the quotation
   marks), and press ENTER.

<P><LI>Select the entire document, and press F9 to update it. From the
   View menu, clear the Field Codes command.
<P>
</OL>The document should display as follows:
<P>
<PRE>   1st bookmark
   see page 1

   ... (page break)

   2nd bookmark
   see page 2

</PRE></OL>If this document is included in a second document using an INCLUDE
field, the PAGEREF fields above will incorrectly display the result of
the last page in the document rather than the page the bookmarks are
actually located on.
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this
problem and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows User's Guide," version 2.0, pages 746, 749
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: <BR>
KBSubcategory:<BR>
Additional query words:  1.0 1.10 1.10a 2.0 2.0a 2.0a-CD 2.0b<BR>
word6 2.0c 6.0 6.0a 6.0c winword winword2<BR>
Version           : 1.x 2.x 6.0 6.0a 6.0c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
