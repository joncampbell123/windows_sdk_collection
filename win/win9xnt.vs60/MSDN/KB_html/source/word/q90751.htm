

<HTML>
<HEAD>
<TITLE>WD: Modifying FileSaveAs to Use Different Default Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90751 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/10/21">
<META NAME="Keywords" CONTENT="kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Word 7.x and earlier, you can change the default file format selected in the Save As dialog box by modifying the FileSaveAs macro. The  More Information  section of this article discusses how to do this for each version of Word.  NOTE: Beginning...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAUR,QBE7,QBE6,QDNG,QABA,QBTI,QBJZ,QAU7,QAWP,QDO7,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Modifying FileSaveAs to Use Different Default Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90751 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word for the Macintosh, version 6.0, 6.0.1, 6.0.1a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Word 7.x and earlier, you can change the default file format selected
in the Save As dialog box by modifying the FileSaveAs macro. The "More
Information" section of this article discusses how to do this for each
version of Word.
<P>
NOTE: Beginning with Word 97 for Windows or Word 98 Macintosh Edition you
can set the file format that Word uses by default each time you save a
document. To do this, click Options (Preferences in Word 98 Macintosh 
Edition) on the Tools menu, click the Save tab, and select the file format
you want from the Save Word Files As drop-down list.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you click Save As on the File menu, Normal file format is selected
by default. To change this selection, modify the global FileSaveAs macro
by setting the Format argument to a specific number that corresponds to
the desired default file format as follows.
<P>
<P><h3>Word 7.x</h3>
 
<P>
Word version 7.x includes a function called ConverterLookup that returns a
number corresponding to a specified converter. The number returned by
ConverterLookup can be used with FileSaveAs to specify a different
format.
<P>
<PRE>   Sub MAIN
      Dim dlg As FileSaveAs
      GetCurValues dlg
      x = ConverterLookup("Word 2.x for Windows")
      dlg.Format = x
      n = Dialog(dlg)
      If n = -1 then FileSaveAs dlg
   End Sub

</PRE>NOTE: "Word 2.x for Windows" is the name of the file format as it appears
in the Save File As Type box in the Save As dialog box (File menu).
<P>
NOTE: The ConverterLookup() method described above, can also be used with
Word 6.0 for the Macintosh. For example, the following macro instructions
save the current document as Test in the stationery file format.
<P>
<PRE>   x = ConverterLookup("Stationery")
   FileSaveAs .Name = "Test" , .Format = x

</PRE><h3>Word 6.x</h3>
 
<P>
Word version 6.x for Windows includes a function called ConverterLookup
that returns a number corresponding to a specified converter. The number
returned by ConverterLookup can be used with FileSaveAs to specify a
different format.
<P>
<PRE>   Sub MAIN
      Dim dlg As FileSaveAs
      GetCurValues dlg
      x = ConverterLookup("Word for Windows 2.0")
      dlg.Format = x
      n = Dialog(dlg)
      If n = -1 then FileSaveAs dlg
   End Sub

</PRE>NOTE: "Word for Windows 2.x" is the name of the file format as it appears
in the Save File As Type box in the Save As dialog box (File menu).
<P>
NOTE: The ConverterLookup() method described above, can also be used with
Macintosh Word 6.x. For example, the following macro instructions save the
current document as Test in the stationery file format.
<P>
<PRE>   x = ConverterLookup("Stationery")
   FileSaveAs .Name = "Test" , .Format = x

</PRE><h3>Word 2.x</h3>
 
<P>
<PRE>   Sub MAIN
      Dim dlg As FileSaveAs
      GetCurValues dlg
      dlg.Format = N '(number corresponding to the Format argument)
      n = Dialog(dlg)
      If n = - 1 Then FileSaveAs dlg
   End Sub

</PRE>To indicate a file format other than the six internal formats, you can
count the first converter listed under the [MSWord TextConverters]
section as either 7 or 100 and then count down the list. For example,
based on the following WIN.INI settings, the WordPerfect 5.1 converter
can be counted as format 103 or 10:
<P>
<PRE>   [MSWord Text Converters]
   DOS Text with Layout-DOS Text with Layout, C:\WINWORD\TXTWLYT.CNV, asc
   Text with Layout-Text with Layout, C:\WINWORD\TXTWLYT.CNV, ans
   WrdPrfctDOS50-WordPerfect 5.0, C:\WINWORD\WPFT5.CNV, doc
   WrdPrfctDOS-WordPerfect 5.1, C:\WINWORD\WPFT5.CNV, doc
   MSWordWin-Word for Windows 1, C:\WINWORD\WORDWIN1.CNV, doc

</PRE>To save a document to the Word for Windows 1.x file format by default,
set the .Format parameter to 104 or 11 (based on the above WIN.INI
settings) as follows:
<P>
<PRE>   Sub MAIN
      Dim dlg As FileSaveAs
      GetCurValues dlg
      dlg.Format = N '(number corresponding to the Format argument)
      n = Dialog(dlg)
      If n = - 1 Then FileSaveAs dlg
   End Sub

</PRE>The following six formats are internal to Word for Windows and can be
set using the .Format parameter:
<P>
<PRE>   0  Normal (Word format).

   1  Document Template.

   2  Text Only (extended characters saved in ANSI character set).

   3  Text+Breaks (plain text with line breaks; extended characters saved
      in ANSI character set).

   4  Text Only (PC-8) (extended characters saved in IBM PC character
      set).

   5  Text+Breaks (PC-8) (text with line breaks; extended characters
      saved in IBM PC character set).

   6  Rich Text Format (RTF).

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows and OS/2 Technical Reference," 177-178
"Using WordBasic," by WexTech Systems and Microsoft, page 208
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword2 winword macword 7.0 word7 word6<BR>
word95 6.0 6.0c word95 File Save 2.0 2.0a 2.0a-CD 2.0b 2.0c<BR>
filesave word97<BR>
Keywords          : kbmacro<BR>
Version           : WINDOWS: 2.x, 6.0, 6.0a, 6.0c, 7.0, 7.0a; MACINTOSH: 6.0, 6.0.1, 6.0.1a;<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
