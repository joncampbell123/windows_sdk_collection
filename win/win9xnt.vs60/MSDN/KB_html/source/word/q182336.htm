

<HTML>
<HEAD>
<TITLE>PRB: Lists in Word Cause Numbering Problems When Saved As RTF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182336">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/11">
<META NAME="Keywords" CONTENT="appsconv kblist kbconversion">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you save a document in Rich Text Format (RTF) in Microsoft Word 97 for Windows to generate Help (.hlp) files with the Microsoft Help Compiler, unwanted line numbering may precede paragraphs in the help source file. The document does not show t...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE1,QAH4,QBLA,QAIH,QBC6,QAKC,QA3Z,QA3Y,QAEF,QAG8,QA2B,QDNG,QBVV,QABA,QBWS P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Lists in Word Cause Numbering Problems When Saved As RTF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182336</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
<LI>Microsoft Windows Software Development Kit (SDK)
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you save a document in Rich Text Format (RTF) in Microsoft Word 97 for
Windows to generate Help (.hlp) files with the Microsoft Help Compiler,
unwanted line numbering may precede paragraphs in the help source file. The
document does not show these line numbers in Word 97.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs in Word when you choose to continue a previous list,
but there are non-list paragraphs between the two lists. The list can be
either a bulleted or a numbered list.
<P>
Word places RTF codes after the first list which indicates that line
numbering should continue silently, as in the example below:
<P>
<PRE>   {\*\pn \pnlvlcont\ilvl0\ls0\pnrnot0\pndec }

</PRE>The codes in the example above specify the following:
<P>
<PRE>   \*\pn = line numbering

   \pnlvlcont = continue line numbering but silently (don't display on
   screen)

   \ls0 = the list id that should be continued

   \pndec = the list is decimal (1,2,3)

</PRE>However, these codes are unnecessary. Word relies on the list id (/ls#) to
determine whether a list should continue a previous list. When you take
those codes out of the RTF file, Word still renders the file correctly.
Hence, the additional RTF codes cause the Help compiler to place line
numbers on every paragraph between the two lists.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The Help compiler does not allow you to continue a previous automatically
numbered list. To generate this effect, turn off automatic numbering.
<P>
To turn off Automatic numbering, follow these steps:

<OL><P><LI>On the Format menu, click AutoFormat, and click Options in the
   AutoFormat dialog box.

<P><LI>Click the AutoFormat As You Type tab and click to clear the Automatic
   Numbered Lists check box.

<P><LI>Click OK twice.
<P>
</OL>You will then have to type in the numbers for the list manually. Note that
this is only necessary if you have two separate lists, and the second list
needs to continue numbering where the first list stopped.
<P>
NOTE: Because bulleted lists do not provide the option to continue a
previous list, this situation is more rare. When it occurs it is more
difficult to solve, because you can not turn off the "continue previous
list" option for bullets.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE></OL>The following Word 97 code fixes any RTF document where bulleted lists are
causing the problem. The code cycles through each paragraph. If the current
paragraph is in a list, it copies the formatting of the list. It then
removes the list attribute and reapplies it. By default, these actions
remove any continuation of previous lists. Note that this will cause
separate numbered lists that were previously continuous to begin
renumbering after each break. However, since the Help files can not render
this type of list, that problem will need to be dealt with separately
anyway by manually typing in the list numbers.
<P>
<PRE>   Sub BulletFix()
   '
   ' BulletFix Macro
   '
   Dim par As Object

   ' Cycle through all paragraphs in document
      For Each par In ActiveDocument.Paragraphs
         ' Select paragraph
         par.Range.Select
         ' Save its ListTemplate (its formatting)
         Dim lt As ListTemplate
         Set lt = Selection.Range.ListFormat.ListTemplate
         If TypeName(lt) &lt;&gt; "Nothing" Then
            Dim FirstLine As Double
            Dim LeftIndent As Double
            FirstLine = Selection.ParagraphFormat.FirstLineIndent
            LeftIndent = Selection.ParagraphFormat.LeftIndent

            ' Remove Bullets/Numbers
            Selection.Range.ListFormat.RemoveNumbers _
               NumberType:=wdNumberParagraph
            ' Restore the list format
            Selection.Range.ListFormat.ApplyListTemplate _
            ListTemplate:=lt, ApplyTo:=wdListApplyToWholeList

            ' Restore Indentation Settings
            Selection.ParagraphFormat.FirstLineIndent = FirstLine
            Selection.ParagraphFormat.LeftIndent = LeftIndent
         End If
      Next
   ' Go back to the beginning of the document
   Selection.HomeKey Unit:=wdStory
   End Sub

</PRE>Deleting the problematic RTF codes should be the last option. In this case,
keep a backup copy of the RTF file (in case the wrong codes are deleted).
The file could become corrupt and unreadable by Word.
<P>
For more information about the Listformat Property, while in the Visual
Basic for Applications Editor, click the Office Assistant, type
"Listformat," click Search, and then click to view "Listformat Property."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If the Assistant is not able to answer your query, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : OFFICE: How to Add/Remove a Single Office Program of
               Component

</PRE>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q173707.htm">Q173707</A></B>
   TITLE     : OFF97: How to Run Sample Code from Knowledge Base Articles


</PRE>This problem also occurs with bulleted lists when numbered lists are
converted to bulleted lists.
<P>
Although there is no continuation option for bulleted lists, a bulleted
list can inherit this behavior from a numbered list. If you look at the RTF
code, the same problem RTF codes immediately follow the bulleted list,
although they specify "\pndec" (referring to a numbered list.)
<P>
<P><h2>REFERENCES</h2>
 
<P>
Rich Text Format (RTF) Specification
<P>
For additional information about the Rich Text Format (RTF) Specification,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q86999.htm">Q86999</A></B>
   TITLE     : WD: Rich Text Format (RTF) Specification 1.5 (GC0165)
</PRE> 
<PRE>Keywords          : appsconv kblist kbconversion
Version           : WINDOWS:97
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
