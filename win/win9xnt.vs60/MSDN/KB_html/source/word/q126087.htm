

<HTML>
<HEAD>
<TITLE>How to Load the Windows Help File Using WordBasic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126087">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1995/02/14">
<META NAME="Keywords" CONTENT="kbinterop kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article describes how to use WordBasic to load your own Windows Help file.  Below is a sample WordBasic macro that calls the WinHelp() Windows API function.  WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Mic...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QDL9,QBWO,QBWN,QATX,QBWQ,QAY5,QAFF,QAGI,QBWP,QAHE,QDO7,QBV8,QAB9,QBK4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Load the Windows Help File Using WordBasic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126087</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b, 2.0c,
   6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Word for Windows NT, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to use WordBasic to load your own Windows Help
file.
<P>
Below is a sample WordBasic macro that calls the WinHelp() Windows API
function.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h2>Word Version 6.0 for Windows</h2>
 
<P>
REM The declaration for WinHelp is as follows:
<PRE>Declare Sub WinHelp Lib "User" (hWnd As Integer, lpHelpFile$ As String,
</PRE>wCommand As Integer, dwData As Long)
<P>
REM The GetFocus SDK function to obtain the handle of Word which is the
REM hWnd parameter to WinHelp
<PRE>Declare Function GetFocus Lib "User"() As Integer

Sub Main
 hWnd = GetFocus
 WinHelp (hWnd, "c:\winword\winword.hlp", 3, 0)
End Sub


</PRE><h2>Word Version 6.0 for Windows NT, Word 7.0 for Windows 95</h2>
 
<P>
REM The declaration for WinHelp32 is as follows:
<PRE>Declare Function WinHelp Lib "user32" Alias "WinHelpA"(hwnd As Long,
</PRE>lpHelpFile$ As String,
wCommand As Long, dwData As String) As Long
<P>
REM The GetFocus SDK function to obtain the handle of Word which is the
REM hWnd parameter to WinHelp
<PRE>Declare Function GetFocus Lib "user32" Alias "GetFocus"() As Long

Sub Main
</PRE>hWnd = GetFocus
WinHelp(hWnd, "c:\msoffice\winword\wrdbasic.hlp", 261, "")
<PRE>End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The hWnd parameter is the window handle to Word, the active application.
<P>
The lpHelpFile$ parameter is the path and name of the Help file.
<P>
The wCommand parameter to the WinHelp function is set to the number 3 so
that Help will display the contents or first page of the Help file.
<P>
See below for an explanation of the dwData parameter.
<P>
You can also go to a particular section of a Help file depending upon a
keyword by doing the following:

<OL><P><LI>In your Help file, create a footnote that contains a keyword.

<P><LI>From the Insert menu, choose Footnote.

<P><LI>Select Custom Mark and type the letter "K" (without the quotation
   marks).

<P><LI>Use this text as the text$ field for the Help call.
<P>
</OL>For example, if you define a Keyword called "normal view" in your Help
file, call it this way:
<P>
<P><h2>Word Version 6.0 for Windows</h2>
 
<P>
<PRE>Declare Sub WinHelp Lib "User" (hWnd As Integer, helpfilename$ As String,
</PRE></OL>wCommand As Integer, dwData As String)
<PRE>Declare Function GetFocus Lib "User"() As Integer

Sub Main
 helpfilename$ = "c:\winword\winword.hlp"
 hwnd = GetFocus
 text$ = "normal view"
 WinHelp(hwnd, helpfilename$, 257, text$)
End Sub


</PRE><h2>Word 6.0 for Windows NT, Word 7.0 for Windows 95</h2>
 
<P>
<PRE>Declare Function WinHelp Lib "user32" Alias "WinHelpA"(hwnd As Long,
</PRE>helpfilename$ As String,
wCommand As Long, dwData As String) As Long
<PRE>Declare Function GetFocus Lib "user32" Alias "GetFocus"() As Long

Sub Main
 helpfilename$ ="c:\msoffice\winword\wrdbasic.hlp"
 hWnd = GetFocus
 text$ = "msgbox$"
 WinHelp(hWnd, helpfilename$, 257, text$)
End Sub

</PRE>Notice that the dwData parameter can be either Long or a String depending
on how you are calling the WinHelp function.
<P>
NOTE: Always call dwData as String from 32 bit versions of Word.
<P>
<PRE>wCommand parameter     Defined in Windows.H     Decimal Equivalent
==================     ====================     ==================
HELP_CONTEXT           0x0001                   1
HELP_QUIT              0x0002                   2
HELP_INDEX             0x0003                   3
HELP_CONTENTS          0x0003                   3
HELP_HELPONHELP        0x0004                   4
HELP_SETINDEX          0x0005                   5
HELP_SETCONTENTS       0x0005                   5
HELP_CONTEXTPOPUP      0x0008                   8
HELP_FORCEFILE         0x0009                   9
HELP_KEY               0x0101                   257
HELP_COMMAND           0x0102                   258
HELP_PARTIALKEY        0x0105                   261

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Word for Windows 6.0 On-Line Help, WordBasic, Declare Example
<P>
Microsoft Windows SDK "Programming Tools," Chapter 3, "Creating Help Files"
<P>
Microsoft Windows SDK "Programmer's Reference, Volume 2: Functions,"
pages 985-988
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory:  kbmacro <BR>
KBSubcategory:<BR>
Additional query words: 2.0 2.0a 2.0a-CD 2.0b 2.0c 6.0 6.0a<BR>
winword 7.0 word95 word7 word6 6.0c winword winword2 winapi<BR>
Keywords          : kbinterop kbmacro<BR>
Version           : 2.x 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
