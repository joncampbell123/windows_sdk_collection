

<HTML>
<HEAD>
<TITLE>WD: How to Merge Conditional Number of Records to the Same Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105888">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1993/10/27">
<META NAME="Keywords" CONTENT="kbfield kbhowto kbmerge macword ntword winword winword2 word6 word95 kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Word, you can merge a conditional number of records to the same page.  MORE INFORMATION  To merge a conditional number of records to the same page, use a combination of SET, IF, and NEXTIF fields. For example, you could use this method...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QABH,QABI,QDME,QAVM,QA5V,QAFO,QAJQ,QAJN,QAKS,QAGU,QBE7,QBE6,QAKC,QA7N P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: How to Merge Conditional Number of Records to the Same Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105888</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a 2.0, 2.0a,
   2.0a-CD, 2.0b, 2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
<LI>Microsoft Word 98 Macintosh Edition
<LI>Microsoft Word for Windows NT, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Word, you can merge a conditional number of records to
the same page.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To merge a conditional number of records to the same page, use a
combination of SET, IF, and NEXTIF fields. For example, you could use
this method to merge all records with the same name to one page in the
merge and create a new page in the merge when a new name is encountered in
the data file.
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this field code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
The following example uses a data file with employee names (Employee)
and projects they are working on (Projects). The Check field is used
in the data file to mark the last record of a particular name.
<P>
Sample Data File:
<P>
<PRE>   Employee     Project     Check
   John Doe     4578j
   John Doe     86785x
   John Doe     543p          1
   Jane Doe     87x
   Jane Doe     89976m        1
   Sam Smith    7897r
   Sam Smith    857t
   Sam Smith    78974x
   Sam Smith    7868p         1

</PRE>The main document should be set up as follows, with a copy of the
conditional statements equal to the maximum number of projects for
each employee (four in the above example).
<P>
<PRE>   Employee     Project
   {MERGEFIELD Employee}     {MERGEFIELD Project}{set duplicate {if
   {MERGEFIELD Check}="1" "off" "on"}}{nextif {mergefield check}=""}{if
   {duplicate}="on" "P
   t{MERGEFIELD Project}"}{set duplicate {if {MERGEFIELD Check}="1"
   "off" "on"}}{nextif {mergefield check}=""}{if {duplicate}="on" "P
   t{MERGEFIELD Project}"}{set duplicate {if {MERGEFIELD Check}="1"
   "off" "on"}}{nextif {mergefield check}=""}{if {duplicate}="on" "P
   t{MERGEFIELD Project}"}{set duplicate {if {MERGEFIELD Check}="1"
   "off" "on"}}{nextif {mergefield check}=""}{if {duplicate}="on" "P
   t{MERGEFIELD Project}"}

</PRE>Where "P" represents a paragraph mark that would push the next Project
to a new line and "t" represents a tab character that would align the
next project under the previous project.
<P>
The resulting merge document would appear as follows:
<P>
<PRE>   Employee     Project
   John Doe     4578j
                86785x
                5436435p
   --- Page Break ---
   Jane Doe     87x
                89976m
   --- Page Break ---
   Sam Smith    7897r
                857t
                78974x
                7868p
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: catalog index list table print merge mail<BR>
merge<BR>
Keywords          : kbfield kbhowto kbmerge macword ntword winword winword2 word6 word95 kbualink97<BR>
Version           : Windows:1.0,1.1,1.1a,2.0,2.0a,2.0a- CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a,97;Macintosh:6.0,6.0.1,6.0.1a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
