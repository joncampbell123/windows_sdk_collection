

<HTML>
<HEAD>
<TITLE>WD: Using WordBasic to Add Sequential Number to Form Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119990">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/08/30">
<META NAME="Keywords" CONTENT="kbmacroexample macword winword word6 word7 word95 kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  With Microsoft WordBasic, you can produce a series of document forms with a number that is incremented with each new document created. This may be helpful if you are designing an invoice template form and you want to automatically increment the inv...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QAKC,QAH4,QBC6,QBJZ,QBJN,QAG8,QA36,QAIH,QBWS,QASR,QBSO,QAUJ,QACI,QAG4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Using WordBasic to Add Sequential Number to Form Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119990</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With Microsoft WordBasic, you can produce a series of document forms with
a number that is incremented with each new document created. This may be
helpful if you are designing an invoice template form and you want to
automatically increment the invoice number. The following macro example
increments the value stored in the INVOICE# AutoText entry each time the
macro is run and places the result in a text form field called
Invoice_Number.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>To create the sample macro, follow these steps:

<OL><P><LI>If you have not created a custom template for your forms document,
    create a new template that will serve as the form template. To do this,
    follow these steps:
<P>
     a. On the File menu, click New.
<P>
     b. Select Blank Document.
<P>
     c. Under "Create New," select Template.
<P>
     d. Click OK.
<P>
     e. Save the new template.

<P><LI>Make sure your custom template is open and is the active window in
    Word. Insert a text form field with the name Invoice_Number. To do
    this, follow these steps:
<P>
     a. Position the insertion point where you want to place the invoice
<PRE>        number.

     b. On the Insert menu, click Form Field.

     c. For Type, click Text.

     d. Click Options.

     e. In Field Settings Bookmark: type "Invoice_Number" (without the
        quotation marks).

     f. Click OK twice to insert the form field into the template.

</PRE><P><LI>On the Tools Menu, click Macro.

<P><LI>In the Macro Name text box, enter a name for the macro.
<P>
    NOTE: Macro names cannot contain spaces or punctuation.
    You can name this macro AutoNew and store it in a protected
    form template (protect the template for Forms). If the macro is named
    AutoNew, Word runs the macro whenever you create a new document
    based on the template.

<P><LI>From the "Macros in" box, select the custom template name.
<P>
    NOTE: The SetAutoText and GetAutoText statements in this macro
    have the context set to template; therefore, you must run this macro
    from a document based on a template other than Normal.dot.

<P><LI>Click Create.

<P><LI>In the macro editor window, you will see:
<P>
     Sub Main
<P>
     End Sub

<P><LI>Enter the following code between the existing Sub Main and End Sub
    lines as follows.
<P>
     Sub MAIN
<PRE>        ' Unprotect form so an AutoText entry can be changed.
        ToolsUnprotectDocument
        ' Retrieve the contents of the INVOICE# AutoText entry and
        ' add 1 to it.
        number = Val(GetAutoText$("INVOICE#", 1)) + 1
        ' Convert the number to a string variable.
        InvoiceNum$ = Str$(number)
        ' Remove the preceding space.
        Temp$ = LTrim$(InvoiceNum$)
        ' SET the contents of the INVOICE# AutoText entry.
        SetAutoText "INVOICE#", Temp$, 1
        ' Set the contents of the Invoice form field.
        SetFormResult "Invoice_Number", Temp$
        ' Re-Protect the current document for forms.
        ToolsProtectDocument .Type = 2, .NoReset = 1
        ' Save the template.
        SaveTemplate
     End Sub

</PRE><P><LI>From the macro editor window, click Close on the File menu.

<P><LI>Click Yes to save changes to the macro you just created.
<P>
</OL>You can define the AutoText item INVOICE# from this example to specify the
starting number for the sequence. If the INVOICE# AutoText entry does not
exist, the first time you run this macro, INVOICE# is set to the number 1.
<P>
<P><h3>To Change the Starting INVOICE# Number</h3>
 

<OL><P><LI>Open your Template.

<P><LI>Unprotect your document if necessary (click Unprotect document on the
   Tools menu).

<P><LI>Place the insertion point on a blank line and type a starting number,
   for example:
<P>
<P><PRE>      100000
</PRE>
<P><LI>Select the typed number only.

<P><LI>On the Edit menu, click AutoText.

<P><LI>In the "Make AutoText Available To" list, select "Documents Based on
   &lt;template&gt;."

<P><LI>For Name, type "INVOICE#" (without the quotation marks).

<P><LI>Click Add. (If Word prompts you with a question about Redefining the
   AutoText entry, click Yes.)

<P><LI>Delete the text that was typed in the document template.
<P>
</OL>The AutoText entry (INVOICE#) has been set.
<P>
The SetFormResult statement inserts the sequence number into a text form
field named "Text1." You may need to change "Text1" to refer to a form
field name that exists in your template.
<P>
The template you create should be protected for forms. To do this, follow
these steps:

<OL><P><LI>On the Tools menu, click Protect Document.

<P><LI>Select Forms and then click OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
If your form is a document rather than a template, the number can be saved
in a document variable using the SetDocumentVar statement. For example,
the following macro stores a number in the document variable named
"number." Each time the macro runs, it increments the number by one.
<P>
To create this macro, follow the steps for creating a macro listed earlier
in this article.
<P>
<PRE>   Sub MAIN
      number = Val(GetDocumentVar$("number")) + 1
      number$ = LTrim$(Str$(number))
      SetDocumentVar "number", number$
      SetFormResult "Text1", number$
   End Sub

</PRE></OL>You can assign this macro to a form field as an on-exit or on-entry macro.
This way, the contents of the Text1 form field are automatically
incremented when the form field is entered or exited.
<P>
Other methods for preserving values between sessions of a macro are as
follows:

<UL><LI>Use SetPrivateProfileString to store values to a private settings file.

<LI>Use SetProfileString to store values in the Win.ini file.

<LI>Use the WordBasic File Input/Output statements to write to a text file
   (for example, Write or Print statements).
<P>
</UL>For information about how to do this in Word 97, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q161309.htm">Q161309</A></B>
   TITLE     : Word 97: Macro Increments Invoice Number To New Form
               Document

   ARTICLE-ID: <B><A href="../vbapps/q85905.htm">Q85905</A></B>
   TITLE     : WordBasic Macro to Number New Documents in Sequence

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Word Developer's Kit," version 6.0, pages 183-198
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: form text field macro SetFormResult auto serial<BR>
increment sequential seq sequence increment incremental automatically<BR>
Keywords          : kbmacroexample macword winword word6 word7 word95 kbmacro<BR>
Version           : WINDOWS:6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
