

<HTML>
<HEAD>
<TITLE>WinWord 2.0: Macro to Remove Shading Does Not Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82958 ">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1992/04/01">
<META NAME="Keywords" CONTENT="kbtable kbmacro kbusage">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you create a macro in Microsoft Word for Windows select multiple paragraphs and remove any shading in the selection, the macro does not remove the shading unless the entire selection is shaded. If the entire selection contains shading, the macro...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QBXS,QAPG,QA38,QAIH,QAH4,QBWS,QAEF,QAI4,QAY2,QAG2,QAIB,QA9N,QDH6,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WinWord 2.0: Macro to Remove Shading Does Not Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82958 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you create a macro in Microsoft Word for Windows select multiple
paragraphs and remove any shading in the selection, the macro does not
remove the shading unless the entire selection is shaded. If the
entire selection contains shading, the macro removes the shading
correctly; however, if only a part of the selection contains shading,
the macro does not remove the shading.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of
Microsoft Word for Windows listed above. We are researching this
problem and will post more information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<P><h3>Example 1: Shading in Table Cells</h3>
 

<OL><P><LI>From the File menu, choose New, and choose the OK button.

<P><LI>From the Tools menu, choose Macro.

<P><LI>Type "UnShadeTable" (without the quotation marks) in the Macro Name
   box, and choose the Edit button.

<P><LI>In the macro-editing window, type the following macro:
<P>
<PRE>      Sub Main
      TableSelectTable
      FormatBorder .FromText = "", .ApplyTo = 3, .Shadow = 0, \
      .TopBorder =  0, .LeftBorder = 0, .BottomBorder = 0, \
      .RightBorder = 0, .HorizBorder =  0, .VertBorder = 0, \
      .TopColor = 0, .LeftColor = 0, .BottomColor = 0, \
      .RightColor = 0, .HorizColor = 0, .VertColor = 0, \
      .Pattern = 0, .Foreground = 0, .Background = 0
      End Sub

</PRE><P><LI>From the File menu, choose Close. Choose the Yes button when
   prompted to save changes to the macro.

<P><LI>In the document, create a multi-column, multi-row table. (From the
   Table menu, choose Insert Table; or, choose the Table button on the
   tool bar.)

<P><LI>Select several cells in the table. From the Format menu, choose
   Border, select a border, then choose the Shading button. Select the
   Custom option button, select an percentage from the Pattern box, and
   choose the OK button twice.

<P><LI>From the Tools menu, choose Macro, select UnShadeTable, and choose
   the Run button.
<P>
</OL>Word removes the borders from the cells, but the shading remains.
<P>
<P><h3>Example 2: Shading in Paragraphs</h3>
 

<OL><P><LI>From the File menu, choose New, and choose the OK button.

<P><LI>From the Tools menu, choose Macro.

<P><LI>Type "UnShade" (without the quotation marks) in the Macro Name box,
   and choose the Edit button.

<P><LI>In the macro-editing window, type the following macro:
<P>
<PRE>      Sub Main
      EditSelectAll
      FormatBorder .FromText = "1 pt", .ApplyTo = 0, .Shadow = 0, \
      .TopBorder =  0, .LeftBorder = 0, .BottomBorder = 0, \
      .RightBorder = 0, .HorizBorder =  0, .VertBorder = 0, \
      .TopColor = 0, .LeftColor = 0, .BottomColor = 0, \
      .RightColor = 0, .HorizColor = 0, .VertColor = 0, \
      .Pattern = 0, .Foreground = 0, .Background = 0
      End Sub

</PRE><P><LI>From the File menu, choose Close. Choose the Yes button when
   prompted to save changes to the macro.

<P><LI>In the document, type four paragraphs, and apply different amounts
   of shading to each paragraph. (From the Format menu, choose Border,
   then choose the Shading button to access the Shading dialog box.)

<P><LI>From the Tools menu, choose Macro, select UnShade, and choose the
   Run button.
<P>
</OL>The macro runs, but the paragraph shading remains.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows User's Guide," version 2.0, page 377-379,
764-765
<P>
Kbcategory: kbusage kbmacro
KBSubcategory: kbtable

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword2 2.0 2.0a 2.0a-CD word6<BR>
winword 2.0b 2.0c<BR>
Keywords          : kbtable kbmacro kbusage<BR>
Version           : 2.0 2.0a 2.0a-CD 2.0b 2.0c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
