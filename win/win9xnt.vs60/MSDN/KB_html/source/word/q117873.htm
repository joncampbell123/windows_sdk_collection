

<HTML>
<HEAD>
<TITLE>WD: WordBasic Macro: Displaying a List of Files from a Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117873">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/07/11">
<META NAME="Keywords" CONTENT="kbmacroexample macword ntword winword word6 word7 word95 wordnt kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article demonstrates the Microsoft WordBasic Files$() function. This  function can be used to assemble a list of file names within a directory.  The Files$() function returns the first file name that matches the  specified file specification (...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QAIH,QBXB,QATJ,QAE1,QAPF,QAH4,QA5F,QAUJ,QAVZ,QA01,QAY5,QAY2,QAG8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: WordBasic Macro: Displaying a List of Files from a Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117873</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates the Microsoft WordBasic Files$() function. This 
function can be used to assemble a list of file names within a directory. 
The Files$() function returns the first file name that matches the 
specified file specification (for example: *.* or *.doc). If you specify a 
file specification on the first iteration and then omit it thereafter, you 
can generate a list of files. 
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web: 
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B> 

</PRE>The following sample macro inserts the file names from the current
directory into a new document window:
<P>
<PRE>   Sub MAIN
      FileNewDefault
      doc$ = Files$("*.*")
      While doc$ &lt;&gt; ""
         Insert doc$
         InsertPara
         doc$ = Files$()
      Wend
   End Sub

</PRE>To insert only the file names with a ".doc" extension, change "*.*" to
"*.doc" in the above example.
<P>
The following macro example determines how many files are in the current
directory and defines an array named List$() to hold the file names. 
Because the Files$() function returns the file names with the full path 
(for example, C:\Document.doc), the FileNameInfo$() function is used to 
extract just the file names which are then assigned to elements within the 
List$() array.
<P>
<PRE>   Sub MAIN
      REM Determine how many files are in the current directory.
      count = - 1
      temp$ = Files$("*.*")
      While temp$ &lt;&gt; ""
         count = count + 1
         temp$ = Files$()
      Wend
      If count &gt; - 1 Then
         Dim List$(count)    'dimension array for file names
      Else
         MsgBox "There are no files in the current directory."
         Goto theend
      EndIf
      REM Extract the file name from the full path string.
      REM Assign the file names to elements in the List$() array.
      doc$ = Files$("*.*")
      For i = 0 To count
         List$(i) = FileNameInfo$(doc$, 3)
         doc$ = Files$()
      Next i
      REM Sort the array of file names and display them in a list box.
      SortArray List$()
      Begin Dialog UserDialog 396, 154, "Microsoft Word"
         OKButton 254, 88, 88, 21
         CancelButton 254, 113, 88, 21
         ListBox 18, 21, 215, 114, List$(), .ListBox1
         Text 16, 6, 175, 13, "Files in Current Directory:", .Text1
      End Dialog
      Dim dlg As UserDialog
      n = Dialog(dlg)
   theend: ' NOTE: This line must be left aligned.
   End Sub

</PRE>Note to Macintosh users: The third line of the macro which reads
<P>
<PRE>   doc$ = Files$("*.*")

</PRE>should be replaced with the following line
<P>
<PRE>   doc$ = Files$(MacID$("&lt;TYPE&gt;"))

</PRE>where &lt;TYPE&gt; is the file type. For example: "TEXT", "W6BN", etc.
<P>
NOTE: The disk that accompanies the "Microsoft Word Developer's Kit,"
includes a macro that allows you to browse through files in any directory.
The macro uses a dynamic dialog box to display a file and directory list
similar to Word's Open dialog box. The macro is named ch05ex06FileBrowser
and is located in the Examples.dot file.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Word Developer's Kit," version 6.0, pages 128-130
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Files$() Array List File Name FileName print<BR>
Keywords          : kbmacroexample macword ntword winword word6 word7 word95 wordnt kbmacro<BR>
Version           : WINDOWS:6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.1a<BR>
Platform          : MACINTOSH Win95 WINDOWS winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
