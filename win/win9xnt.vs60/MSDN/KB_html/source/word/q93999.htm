

<HTML>
<HEAD>
<TITLE>WD: VAL() Returns Illegal Function Call - WordBasic Err=5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q93999 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/12/22">
<META NAME="Keywords" CONTENT="kbmacroexample kberrmsg kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Word for Windows, you receive the following error message  Word 6.x, 7.x     WordBasic err=100    Syntax error  Word 2.x --------     Illegal function call - WordBASIC Err=5  if the argument for the Val() function begins with a number and ends w...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAY5,QAB4,QAUD,QAH4,QAOX,QBTL,QAYV,QA5F,QAB9,QDL9,QBWQ,QBWO,QBWN,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: VAL() Returns Illegal Function Call - WordBasic Err=5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q93999 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Word for Windows, you receive the following error message
<P>
<P><h3>Word 6.x, 7.x</h3>
 
<P>
<PRE>   WordBasic err=100
   Syntax error

</PRE><h3>Word 2.x</h3>
 
<P>
<PRE>   Illegal function call - WordBASIC Err=5

</PRE>if the argument for the Val() function begins with a number and
ends with one of the following characters:
<P>
<PRE>   D
   d
   E
   e

</PRE>For example, the following WordBasic macro statement causes the above
error message.:
<P>
<PRE>   Print Val("123e")

</PRE>Further, if any of the above characters appears in the middle of a
numeric string, such as "123e4", the return value is incorrect. In the
following example, Word incorrectly prints 1230000 on the status bar.
Word should print 123 on the status bar, ignoring everything from the
letter "e" and beyond:
<P>
<PRE>   Print Val("123e4")

</PRE><h2>WORKAROUND</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR
OWN RISK. Microsoft provides this macro code "as is" without warranty of
any kind, either express or implied, including but not limited to the
implied warranties of merchantability and/or fitness for a particular
purpose.
<P>
Use the macro function NewVal() instead of Val() to correctly convert
a numeric string into a number. The following macro demonstrates the
correct operation of NewVal().
<P>
NOTE: The Sub MAIN subroutine is included here to demonstrate that
NewVal() correctly works on the example given previously.
<P>
<PRE>   Sub MAIN
      Print NewVal("123e4")
   End Sub

   Function NewVal(a$)
      src$ = a$
      result = 0
      For i = 1 To Len(src$)
         sNum$ = Left$(src$, 1)
         If(Asc(sNum$) &gt; 47) And(Asc(sNum$) &lt; 58) Then
            result =(result * 10) + Val(sNum$)
         Else
            Goto ByeNewVal
         End If
         src$ = Right$(src$, Len(src$) - 1)
      Next i
   ByeNewVal: ' NOTE: This line must be left aligned.
      NewVal = result
   End Function


</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Word for Windows
version's listed above. This problem was corrected in Word for Windows 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Val() function converts a text string into a numeric variable.
<P>
In Visual Basic for Applications (which is available with the Word 97 and 
later) the Val function stops reading the string at the first character it 
can't recognize as part of a number. Symbols and characters that are often 
considered parts of numeric values, such as dollar signs and commas, are 
not recognized. However, the function recognizes the radix prefixes &amp;O (for 
octal) and &amp;H (for hexadecimal). Blanks, tabs, and linefeed characters are 
stripped from the argument.
<P>
The following returns the value 123:
<P>
<PRE>   Debug.Print Val("123e")

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows Technical Reference," pages 39, 101, 111,
121
<P>
"Using WordBasic," by WexTech Systems and Microsoft, page 325
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: word6 macword winword word95 word7 winword winword2
<P>

Keywords          : kbmacroexample kberrmsg kbmacro<BR>
Version           : WINDOWS:6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.1a<BR>
Platform          : MACINTOSH Win95 WINDOWS winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
