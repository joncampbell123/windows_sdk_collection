

<HTML>
<HEAD>
<TITLE>WD: ToolsCalculate w/ Combination Cell Range and Table Bookmark </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113836">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1994/04/17">
<META NAME="Keywords" CONTENT="kbmacroexample macword ntword winword word6 word7 word95 wordnt kberrmsg kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" SYMPTOM  The ToolsCalculate WordBasic command gives a WordBasic error 24  bad parameter  if the function form is used with both a cell reference and a table bookmark. The example on page 747 of the  Microsoft Word Developer's Kit  is not correct.  C...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QADP,QAGF,QBC9,QBC8,QANO,QAIH,QDMF,QAE5,QA5F,QACI,QDNZ,QAB9,QAKC,QAPP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: ToolsCalculate w/ Combination Cell Range and Table Bookmark</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113836</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SYMPTOM</h2>
 
<P>
The ToolsCalculate WordBasic command gives a WordBasic error 24 "bad
parameter" if the function form is used with both a cell reference and a
table bookmark. The example on page 747 of the "Microsoft Word Developer's
Kit" is not correct.
<P>
<P><h2>CAUSE</h2>
 
<P>
The ToolsCalculate function in Microsoft WordBasic takes the form
<P>
<PRE>     ToolsCalculate([Expression$])

</PRE>where Expression$ takes the form of the =(Formula) field. Expression$ can
have arguments that are numbers, bookmarks, or table cells. Combinations
can also be used as arguments. However, the following example (as shown on
page 747), which specifies the use of specific cell references within two
bookmarked tables, is not a valid expression and gives a WordBasic error 24
"bad parameter":
<P>
<PRE>     total = ToolsCalculate("sum(sales a5, other b5)")

</PRE>This construction behaves correctly for formula fields. The following field
yields the correct result:
<P>
<PRE>     {= sum(sales a5, other b5)}

</PRE><h2>RESOLUTION</h2>
 
<P>
You can simulate the functionality of the WordBasic statement above by
bookmarking cell a5 of the "Sales" table and cell b5 of the "Other" table
and then adding the two bookmarks (see example 3 below).
<P>
<P><h3>Examples</h3>
 
<P>
The following are all valid uses of the WordBasic ToolsCalculate command.
(Note: In the following examples, "Sales" is a bookmarked table, "Units" is
a bookmarked cell whose value is 10, and "Cost" is a bookmarked number
elsewhere in the document whose value is 2.5.)

<OL><P><LI>Total = ToolsCalculate()                Total is the sum of all the
<PRE>                                            selected table cells or
                                            numbers.
 
</PRE><P><LI>Total = ToolsCalculate("a1 + a2")       Total is the sum of A1 and A2
<PRE>                                            for the table holding the
                                            insertion point.
 
</PRE><P><LI>Total = ToolsCalculate("Units * Cost")  Total is 25. The insertion 
<PRE>                                            point position and selection 
                                            are irrelevant.
 
</PRE><P><LI>Total = ToolsCalculate("Sales")         Total is the sum of all cells
<PRE>                                            bookmarked in the table. The
                                            insertion point position and
                                            selection are irrelevant.
 
</PRE><P><LI>Total = ToolsCalculate("Units * 5")     Total is 50. The insertion 
<PRE>                                            point position and selection 
                                            are irrelevant.
 
</PRE><P><LI>Total = ToolsCalculate("A1 * 10")       Total is 10 times the value in
<PRE>                                            cell A1 of the table holding
                                            the insertion point.
 
</PRE><P><LI>Total = ToolsCalculate("A1 * Units")    Total is 10 times the number in
<PRE>                                            cell A1 of the table holding
                                            the insertion point.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: err message Word Basic macro <BR>
Keywords          : kbmacroexample macword ntword winword word6 word7 word95 wordnt kberrmsg kbmacro<BR>
Version           : WINDOWS:2.0,2.0a,2.0a-CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.6.0.1a<BR>
Platform          : MACINTOSH Win95 WINDOWS winnt<BR>
Issue type        : kbdocerr<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
