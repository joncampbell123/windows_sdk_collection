

<HTML>
<HEAD>
<TITLE>WD: How to Update Fields in a Protected Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115607">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1994/05/31">
<META NAME="Keywords" CONTENT="kbfield kbforms macword winword winword2 word6 word7 macword98 kbgraphic kbmacro kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Fields in a document protected for forms may not be updated when you fill out the form. This article describes four methods you can use to update regular fields or automatically insert and update the result of one form field into another area of a ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QAIH,QAXB,QBD2,QAH4,QAC1,QACI,QBJZ,QAFF P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: How to Update Fields in a Protected Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115607</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Fields in a document protected for forms may not be updated when you fill
out the form. This article describes four methods you can use to update
regular fields or automatically insert and update the result of one form
field into another area of a form.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h3>Method 1: Use the "Calculate On Exit" Option Microsoft Word 97 for Windows</h3>
 
<P>
In Microsoft Word 97 for Windows, form fields include a "Calculate on exit"
option. When you enable this option, fields and form fields can be updated
in a protected form document. Fields not updated by this switch include:
<P>
<PRE>   TOC
   PAGE
   INDEX
   PAGEREF

</PRE>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q157463.htm">Q157463</A></B>
   TITLE     : Using Calculate on Exit in a Forms Document

</PRE><h3>Method 2: Use a Macro</h3>
 
<P>
The following macro can be used as an on-exit macro for the first form
field called TEXT1 so that the information entered into this field will
automatically appear in the form field called TEXT2. Alternatively, the
macro can be used as an on-entry macro for the second form field called
TEXT2. When you tab to this second field, the result of the first form
field is placed automatically as the field result of this second field.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<PRE>   Word 97
   -------

   Sub Main()
      ActiveDocument.FormFields("text2").Result =
      ActiveDocument.FormFields("Text1").Result
   End Sub

   -or-

   Sub Main()
     With ActiveDocument
       .FormFields("Text2").Result = .FormFields("Text1").Result
     End With
   End Sub

   Word 6.x and 7.x
   ----------------

   Sub Main
      SetFormResult "text2", GetFormResult$ ("text1")
   End Sub

</PRE>In the examples above, "text1" and "text2" are bookmarks. The text1
bookmark represents the field that contains the information you want to
automatically appear in the field represented by the text2 bookmark.
<P>
For each field that receives the information automatically, clear the Fill-
In Enabled check box in the Text Form Field Options dialog box. This
minimizes the chance of accidentally modifying the field result.
<P>
<P><h3>Method 3: Reference a Form Field Entry Elsewhere in a Document</h3>
 
<P>
There may be times that you may want to reference a form field entry
elsewhere in a document.
<P>
To repeat a form field entry using a reference field, follow these steps:

<OL><P><LI>Position the insertion point where you want the data to
   be repeated.
<P>
   NOTE: The document (or section where the insertion point is)
   must be unprotected to insert a field.

<P><LI>From the Insert menu, choose Field and select REF from the
   Field Name list.

<P><LI>In the Field Code box, insert the bookmark name (for
   example, text1) that represents the field into which you are
   entering the data. Choose OK.
<P>
   The REF field must be updated to display and print the text.
   An update will include all fields such as DATE and TIME. There
   are two ways to update fields in the protected area of your
   form:
<P>
<P><PRE>      - If the form will be a printed form, you can have the REF
<PRE></PRE>        fields update when you print the document. From the Tools
        menu, choose Options, select the Print tab, and select the
        Update Fields check box. When you select this option, fields
        may not be updated on the screen, but Word will update them
        properly when you print the document.
   
      - If you need all fields to be updated on the screen as you
        fill out the form, including fields not updated using the
        "Calculate on exit" option as described in Method 1,
        use the an exit macro for your form field:

     Word 97
     -------

     Sub MAIN
        Application.ScreenUpdating = True
        PrintPreview=True
        ActiveDocument.ClosePrintPreview
     End Sub

     Word 6.x and 7.x
     ----------------

     Sub MAIN
        ScreenUpdating 0
        FilePrintPreview
        ClosePreview
     End Sub

</PRE></OL>NOTE: Because this exit macro may cause a slight delay on some
computers, you may opt for selecting the "Update Fields on
printing" option if this will be a printed form. For Word 97, you
may opt to choose the "Calculate on exit" option as described in
Method 1.
<P>
<P><h3>Method 4: Place the REF Field in an Unprotected Section of the Document</h3>
 
<P>
If you choose this option, the macro will update the fields in the
unprotected section or you can create a separate exit macro to go to that
specific field and update it.
<P>
To place REF fields in unprotected sections of your document:

<OL><P><LI>Insert continuous section breaks above and below the REF
   fields.

<P><LI>On the Tools menu, click Protect Document.

<P><LI>Click the Sections button.

<P><LI>Select the sections you want to have protected. Click OK.
<P>
</OL>For more information on using a REF field to reference a list box, please
see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q114237.htm">Q114237</A></B>
   TITLE     : REF Field Creates Duplicate Drop-Down List in
               Protected Form

   ARTICLE-ID: <B><A href="../word/q117209.htm">Q117209</A></B>
   TITLE     : How to Use AutoText As a Result of a Form Field
               Entry

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Word User's Guide," version 6.0, pages 305-326, 731-
755
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: forms formfield ref unprotect wordbasic vba<BR>
Keywords          : kbfield kbforms macword winword winword2 word6 word7 macword98 kbgraphic kbmacro kbfaq<BR>
Version           : WINDOWS:2.0,2.0a,2.0a-CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.1a<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
