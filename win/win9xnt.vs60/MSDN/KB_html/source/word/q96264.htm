

<HTML>
<HEAD>
<TITLE>WD: FileSaveAs Macro Causes Error Message in Word Document Objec </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96264 ">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1993/03/14">
<META NAME="Keywords" CONTENT="winword2 word6 word7 word95 wordnt macword6 word kbmacro kbole">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Word versions 2.x through 6.x, if you execute the FileSaveAs command  from a WordBasic macro while editing a Word Document Object, the following  error message occurs, regardless of the file name specified:     This is not a valid filename.()  W...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAB4,QAUR,QAH4,QBJZ,QAU7,QAVX,QAVW,QBV8,QAB9,QAJQ,QAW6,QAPN,QDO7,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: FileSaveAs Macro Causes Error Message in Word Document Objec</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96264 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b,
   2.0c, 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Word versions 2.x through 6.x, if you execute the FileSaveAs command 
from a WordBasic macro while editing a Word Document Object, the following 
error message occurs, regardless of the file name specified:
<P>
<PRE>   This is not a valid filename.()

</PRE>Word for Windows version 7.x does not issue an error message.
<P>
For example, the following macro command causes this error message:
<P>
<PRE>   FileSaveAs .name="test.doc"

</PRE><h2>WORKAROUND</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this macro code "as is" without
warranty of any kind, either express or implied, including but not
limited to the implied warranties of merchantability and/or fitness
for a particular purpose.
<P>
Use the WindowName$() function to determine if the active document is an
embedded Word document object. If the active document window is not an
embedded Word document object, the file is saved. Otherwise, the macro
uses the SendKeys command to use the Save Copy As command(On the File menu)
to save editing changes made to the embedded document object to the
original document.
<P>
<PRE>   Sub MAIN
      a$ = WindowName$()
      ' If the active document is the embedded document.
      If InStr(a$, "Document in") &lt;&gt; 0 Then
         ' The following sequence of commands are sent using SendKeys:
         '
         ' File
         ' Save Copy As
         ' Name of file to save to
         ' OK(Enter or Return)
         ' (y)es-overwrite the file
         '
         SendKeys "%f" : SendKeys "a" : SendKeys "C:\test.doc" : \
         SendKeys "{ENTER}" : SendKeys "y"
      Else
         ' Otherwise, save the document.
         FileSaveAs .Name = "test.doc"
      End If
   End Sub

</PRE>Note: Use SendKeys only when there is no alternative, and then use it with
caution. You should test even the simplest use of SendKeys under a variety
of conditions to avoid unpredictable results, data loss, or both. When
stepping through a macro (using the Step or Step Subs button on the Macro
toolbar) that contains a SendKeys instruction, note that the macro will
not perform as expected unless the SendKeys instruction and the instruction
that activates the target application or dialog box are on the same line,
separated by a colon.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you execute the FileSaveAs command by choosing Save As from the
File menu, Word saves the object as a Word document. You cannot
perform the same operation using a WordBasic macro.
<P>
By contrast, the FileSave command behaves the same regardless of
whether you execute the command from a macro or by choosing Update
from the File menu (the Save command changes to Update while editing a
Word Document Object).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ole embed<BR>
Keywords          : winword2 word6 word7 word95 wordnt macword6 word kbmacro kbole<BR>
Version           : WINDOWS:2.0,2.0a,2.0a-CD,2.0b,2.0c,6.0,6.0a,6.0.1:MACINTOSH:6.0,6.01,6.01a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
