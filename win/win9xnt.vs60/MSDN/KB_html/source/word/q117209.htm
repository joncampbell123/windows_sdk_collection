

<HTML>
<HEAD>
<TITLE>WD: How to Use AutoText as a Result of a Form Field Entry </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117209">
<META NAME="KBModify" CONTENT="1998/03/06">
<META NAME="KBCreate" CONTENT="1994/06/22">
<META NAME="Keywords" CONTENT="macword winword winword2 word6 word7 word95 word97 macword98 kbgraphic kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article describes how to use AutoText as the result of a form field. The procedure uses a drop-down form field that contains an on-exit macro.  MORE INFORMATION  In the example that follows, you will create a form that contains a form field th...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QAIH,QBJZ,QBWS,QACI,QBV3,QASM,QAH4,QA9N,QBJN,QA9Z,QAUJ,QAPP,QA6A,QBWR P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: How to Use AutoText as a Result of a Form Field Entry</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117209</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1, 6.0.1a
<LI>Microsoft Word 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to use AutoText as the result of a form field.
The procedure uses a drop-down form field that contains an on-exit macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In the example that follows, you will create a form that contains a form
field that causes a company's address to be inserted automatically when
the user enters a form field and selects a company name. The address will
be placed at a bookmark located in an unprotected section of the document.
<P>
<P><h2>CREATING THE ON-EXIT MACRO</h2>
 
<P>
Create the macro appropriate for your version of Word, where "DropDown1" is
the bookmark that represents the drop-down form field containing your list
of items, and "Mark1" is the bookmark that represents where you want the
AutoText inserted.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Word 97 for Windows or Word 98 Macintosh Edition</h3>
 
<P>
<PRE>   Sub DropDownAutoText1()     'This is the name of the macro
      Dim DropResult As String
      ' Get result of the form field.
      DropResult = ActiveDocument.FormFields("DropDown1").Result
      ' UnProtect the document.
      ActiveDocument.UnProtect 
      With Selection
         ' Go to location to insert Autotext
         .GoTo What:=wdGoToBookmark, Name:="Mark1"
         ' Insert AutoText name chosen from dropdown list.
         .InsertAfter DropResult
         ' Insert the AutoText.
         .Range.InsertAutoText
      End With
      ' Re-Protect the document.
      If ActiveDocument.ProtectionType = wdNoProtection Then
         ActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True
      End If
   End Sub

</PRE>WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR
OWN RISK. Microsoft provides this macro code "as is" without warranty of
any kind, either express or implied, including but not limited to the
implied warranties of merchantability and/or fitness for a particular
purpose.
<P>
<P><h3>Word 6.0 and 7.0</h3>
 
<P>
<PRE>   Sub Main
      ' Get result of the form field.
      A$ = GetFormResult$ ("DropDown1")
      ' UnProtect the document.
      ToolsUnprotectDocument
      ' Go to location to insert Autotext
      EditGoTo .Destination = "Mark1"
      ' Insert AutoText name chosen from dropdown list.
      Insert A$
      ' Insert the AutoText.
      InsertAutoText
      ' Re-Protect the document.
      ToolsProtectDocument .NoReset = 1
   End Sub

</PRE>For more information about the GetFormResult() function, see page 494 of
the "Microsoft Word Developer's Kit" for version 6.0 and page 557 of the
"Microsoft Word Developer's Kit, rev. 3."
<P>
<P><h2>CREATING THE DROP-DOWN FORM FIELD</h2>
 
<P>
<P><h3>Word 97 for Windows or Word 98 Macintosh Edition</h3>
 
<P>
Open a new document and follow these steps to create a drop-down form
field:

<OL><P><LI>On the View menu, point to Toolbars, and then click Forms.

<P><LI>On the Forms toolbar, click Drop-Down Form Field (the third
   button).

<P><LI>Double-click the newly inserted form field. Enter an item
   name in the Drop-down Item box, and choose the Add button. Use
   items (such as company names) to denote information (such as
   addresses) to be inserted into other places on the form.

<P><LI>Repeat step 3 for each item needed in the Drop-Down list. Then
   click the OK button.

<P><LI>Right-click the Drop-Down Form Field and click Properties on
   the shortcut menu.

<P><LI>From the Drop-Down Form Field Options dialog box, under "Run
   Macro On," in the Exit box, select the macro you created
   in the "Create the On-Exit Macro" section of this article.
   Click OK.
<P>
</OL><h3>Word 6.0/7.0</h3>
 
<P>
Open a new document and follow these steps to create a drop-down form
field:

<OL><P><LI>From the Insert menu, click Form Field, and then select Drop-Down
   from the Type list.

<P><LI>Click the Options button. Enter an item name in the Drop-Down Item
   box, and choose the Add button. Use items (such as company names) to
   denote information (such as addresses) to be inserted into other
   places on the form.

<P><LI>Repeat step 2 for each item needed in the Drop-Down list. Then click
   the OK button.

<P><LI>Right-click the Drop-Down Form Field and then click Form Field Options.

<P><LI>In the Form Field Drop-Down Options dialog box, under "Run Macro On",
   select the macro you created in the "Create the On-Exit Macro"
   section of this article. Click OK.
<P>
</OL>For more information about creating form fields, see "Forms" beginning
on page 305 in the "Microsoft Word User's Guide" for version 6.0.
<P>
<P><h2>CREATING THE AUTOTEXT ENTRIES</h2>
 
<P>
Create the AutoText entries. Give each AutoText entry the same name that
is used in the drop-down form field list. The content of the AutoText
entry will be the company address.
<P>
For additional information on creating AutoText entries, use Word Help. To
locate the appropriate Help topic use the appropriate procedure for your
version of Word.
<P>
<P><h3>Word 97 for Windows or Word 98 Macintosh Edition</h3>
 
<P>
Follow these steps:

<OL><P><LI>On the Help menu, click Contents and Index.

<P><LI>Click the Index tab, and then type AutoText on the Step 1
   line.

<P><LI>Under Step 2, select Creating from the AutoText topic, and
   then click Display.
<P>
</OL><h3>Word 7.x</h3>
 

<OL><P><LI>On the Help menu, click Microsoft Word Help Topics.

<P><LI>Select the Index tab, and then type "AutoText" (without the
   quotation marks).

<P><LI>Under AutoText, Select "creating entries," and then click
   Display.

<P><LI>Select the "Use shortcuts to insert frequently used text or
   graphics" topic.
<P>
</OL><h3>Word 6.x</h3>
 

<OL><P><LI>On the Help menu, click "Search for help on."

<P><LI>Click the Index tab, and then type "AutoText" (without the
   quotation marks).

<P><LI>Under AutoText, select "creating entries," and then click
   Display.

<P><LI>Click the "Use shortcuts to insert frequently used text or
   graphics" topic.
<P>
</OL><h2>PLACING THE BOOKMARK IN THE FORM</h2>
 
<P>
Use the appropriate procedure to insert a bookmark (in this example, name
the bookmark Mark1) where you want the AutoText (address) to appear. This
section of the document will be unprotected so that the AutoText result
can be inserted into the document. Insert a Continuous Section Break above
and below this bookmark.
<P>
<P><h3>Word 97 for Windows or Word 98 Macintosh Edition</h3>
 
<P>
Follow these steps:

<OL><P><LI>On the Insert menu, click Bookmark.

<P><LI>Type Mark1 on the Bookmark name line.

<P><LI>Click Add.
<P>
</OL><h3>Word 6.x and 7.x</h3>
 
<P>
Follow these steps:

<OL><P><LI>On the Edit menu, click Bookmark.

<P><LI>Type Mark1 on the Bookmark Name line.

<P><LI>Click Add.
<P>
</OL>NOTE: You will not be able to use bookmarks in headers, footers,
annotations, footnotes, or endnotes because the EditGoto command in the
macro will not see these bookmarks, and they cannot be unprotected in
your form.
<P>
<P><h2>PROTECTING THE FORM</h2>
 
<P>
To protect the form, use the following steps:
<P>
1 .On the Tools menu click Protect document, select the Forms option, and
<PRE>   click Sections.

</PRE><P><LI>In the Section Protection dialog box, clear the check box corresponding
   to the section where the AutoText will be inserted and click OK twice.

<P><LI>Save the Form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Word Developer's Kit," for version 6.0, pages 494
[GetFormResult() function], 681 (SetFormResult statement)
<P>
"Microsoft Word User's Guide," version 6.0, pages 305-326 ("Forms"), 743-
755 ("Recording and Running Macros")
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: forms result module auto text<BR>
Keywords          : macword winword winword2 word6 word7 word95 word97 macword98 kbgraphic kbmacro<BR>
Version           : WINDOWS:2.0,2.0a,2.0a-CD,2.0b,2.0c,6.0,6.0a,6.0c,7.0,7.0a; MACINTOSH:6.0,6.0.1,6.0.1a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto kbref kbinfo<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
