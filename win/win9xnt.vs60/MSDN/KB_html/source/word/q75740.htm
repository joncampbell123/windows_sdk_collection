

<HTML>
<HEAD>
<TITLE>How to Change the Default File Name/Directory in Open Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75740 ">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1991/09/02">
<META NAME="Keywords" CONTENT="kbmacro kbusage">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Word, you can change the default directory and default file names that appear when you click Open on the File menu.  MORE INFORMATION  Word 6.x for Windows  In Microsoft Word version 6.x for Windows, you can modify the FileOpen macro t...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBJZ,QAH4,QBWS,QAFI,QDL9,QBWQ,QBWO,QBWN,QBXB,QATJ,QAUR,QABA,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Change the Default File Name/Directory in Open Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75740 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a
<LI>Microsoft Word for Windows, versions 2.0, 2.0a, 2.0a-CD, 2.0b, 2.0c,
<LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Word for the Macintosh, versions 6.0, 6.0.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Word, you can change the default directory and default file
names that appear when you click Open on the File menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Word 6.x for Windows</h3>
 
<P>
In Microsoft Word version 6.x for Windows, you can modify the FileOpen
macro to list all files or only files with a particular extension within a
directory. You can also modify the FileNew macro to change the default
directory that is displayed when you choose New from the File menu.
<P>
If you have the Scanprot.dot macros installed on your computer, use the
following steps:

<OL><P><LI>Open the ShellOpen macro.

<P><LI>On the Edit menu, click Find, and search for "dlg" (without the
   quotation marks).

<P><LI>Click Find Next.

<P><LI>At the end of the line that reads "GetCurvalues dlg," insert the
   dlg.name = "*." line.

<P><LI>On the File menu, click Close, and save the changes to the document.
<P>
</OL><h3>Changing the Default Extension in Word 2.x for Windows</h3>
 
<P>
Adding a DOC-EXTENSION line to the WIN.INI file will change the default
file extension that appears when you use the Open and Save commands on the
file menu are used. Use the following procedure to make this change:

<OL><P><LI>On the Tools menu, click Options, and click the WIN.INI icon.

<P><LI>In the Options box, type "DOC-EXTENSION" (without the quotation marks).

<P><LI>In the Setting box, type the extension you want to see. Choose Close.
   For example:
<P>
<P><PRE>      DOC-EXTENSION = .txt
</PRE><P>
</OL><h3>Displaying All Files in a Directory</h3>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR
OWN RISK. Microsoft provides this macro code "as is" without warranty
of any kind, either express or implied, including but not limited to
the implied warranties of merchantability and/or fitness for a
particular purpose.
<P>
CAUTION: See the "Note" section below this procedure before proceeding.
<P>
To modify the FileOpen macro so that it will list all the files in a
specific directory, do the following:

<OL><P><LI>In versions 1.x of Word for Windows, choose Edit from the Macro menu.
   In versions 2.x, 6.0 and 7.0 of Word, choose Macro from the Tools menu.

<P><LI>In the Macro Name box, type "FileOpen" (without the quotation marks)
   and choose Edit or Create (Word 6.0 if the command has not previously
   been modified).

<P><LI>The macro-editing window displays the FileOpen macro. Make the
   following changes to this macro:
<P>
   WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR
   OWN RISK. Microsoft provides this macro code "as is" without warranty
   of any kind, either express or implied, including but not limited to
   the implied warranties of merchantability and/or fitness for a
   particular purpose.
<P>
   Word for Windows, Versions 6.0 and 7.0
   --------------------------------------
<P>
<PRE>      Sub MAIN
         ChDir "f:\winword"      'use any existing directory here
         Dim dlg As FileOpen
         GetCurValues dlg
         dlg.AddToMru = 1
         dlg.Name = "*.*"
         If Dialog(dlg) Then FileOpen dlg
      End Sub

      Note: If you use this macro to replace the built-in FileOpen macro,
      the MRU (Most Recently Used) list will not be updated unless a file
      is  opened and saved. This macro will also disable the print
      function in the File Open dialog box in Word 7.0.

   Word for the Macintosh, Versions 6.0, 6.0.1
   -------------------------------------------

      Sub Main
         Dim dlg As FileOPen
         GetCurValues dlg
         dlg.AddToMru = 1
         dlg.Name = MacID$("****")
         If Dialog(dlg) Then FileOpen dlg
      End Sub

   Word Version 1.x, 2.x
   ---------------------

      Sub MAIN
         ChDir "f:\winword"   'use any existing directory here
         Dim dlg As FileOpen
         GetCurValues dlg
         dlg.Name = "*.*"
         If Dialog(dlg) Then
          Super FileOpen dlg
         End If
      End Sub

</PRE><P><LI>On the File menu, click Close and save changes to Global:FileOpen.
<P>
</OL>Now when you click Open on the File menu, the File Name list box will
display all the files in the desired directory.
<P>
NOTE: If you use this macro to replace the built-in FileOpen macro, the
Find button will no longer be available in the Open dialog box in Word 1.x
and 2.x. The OK and Cancel buttons will be the only buttons available. To
use the macro listed above while keeping the Find option accessible in the
Open dialog box, create the above macro in addition to the FileOpen macro
instead of replacing it. The following steps outline this procedure:

<OL><P><LI>In Word 1.x for Windows, click Edit on the Macro menu. In Word 2.x
   for Windows, click Macro on the Tools menu.

<P><LI>Type a new macro name, such as "OpenAll" (without the quotation marks).

<P><LI>Type a description, such as "Opens all files" (without the quotation
   marks).

<P><LI>In the macro-editing window, type the macro as it appears in the above
   procedure. From the File menu, choose Close and save the changes to the
   Global:OpenAll macro.
<P>
</OL>You can now assign this macro to the File menu so that it appears in
addition to the regular Open command. The Find button will remain
functional in the Open dialog box when you run the FileOpen macro.
<P>
<P><h3>Changing the Default Directory</h3>
 
<P>
To change the default directory that will appear when you click Open on
the File menu, add a ChDir statement to your FileOpen macro. Refer to the
previous macro examples. In the macros listed above, the directory
specified in the ChDir line must be a valid directory on your system.
<P>
NOTE: When you exit Word for Windows after you have modified or added any
of these macros the message, "Do you want to save the global glossary and
command changes?" may appear. Choose Yes to save your changes.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Word for Windows User's Guide," version 2.0, page 765
<P>
"Microsoft Word for Windows User's Reference," versions 1.x, pages
186-189
<P>
"Microsoft Word for Windows Technical Reference," pages 16-17, 115
<P>
"Microsoft Word for Windows and OS/2 Technical Reference," pages 95-97
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbmacro kbtlc<BR>
KBSubcategory:
<P>

Additional query words:  2.0 2.0a 2.0a-CD 2.0b 2.0c 6.0 6.0a<BR>
6.0c 7.0 grey gray unavailable 1.x set winword macword winword2 word6<BR>
word7 word95 filespec default<BR>
Keywords          : kbmacro kbusage<BR>
Version           : 1.x 2.x 6.0 6.0a 6.0c 7.0 7.<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
