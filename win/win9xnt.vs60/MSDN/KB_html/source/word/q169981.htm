

<HTML>
<HEAD>
<TITLE>WD97: Addin Field Data Lost in Word 6.0/7.0 Conversion </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169981">
<META NAME="KBModify" CONTENT="1997/08/15">
<META NAME="KBCreate" CONTENT="1997/06/13">
<META NAME="Keywords" CONTENT="kbfield kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The contents of an Addin field may be incomplete when you convert documents between Microsoft Word 6.0, Microsoft Word for Windows 95, version 7.0, and Microsoft Word 97.  This problem occurs in all of the following cases.  Case 1 ------  Insert an...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA7O,QA7N,QAH0,QAH4,QDO7,QAUR,QAFF,QBWS,QA6A,QACI,QDNE,QBS0,QA5F,QAGX P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: Addin Field Data Lost in Word 6.0/7.0 Conversion</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169981</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
   on the following platforms: Alpha, Windows NT, Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The contents of an Addin field may be incomplete when you convert documents
between Microsoft Word 6.0, Microsoft Word for Windows 95, version 7.0, and
Microsoft Word 97.  This problem occurs in all of the following cases.
<P>
<P><h3>Case 1</h3>
 
<P>
Insert an Addin field into a Microsoft Word 6.0 or 7.0 document and then
open that document in Microsoft Word 97.
<P>
<P><h3>Case 2</h3>
 
<P>
Insert an Addin field into a Microsoft Word 97 document, save the document
as Word 6.0/95 or Rich Text Format (RTF), and then open that document in
Microsoft Word 6.0 or 7.0.
<P>
<P><h3>Case 3</h3>
 
<P>
Insert an Addin field into a Microsoft Word 97 document, and then open that
document in Microsoft Word 6.0 or 7.0 with the Microsoft Word 97 import
converter (Wrd97cnv.exe).
<P>
<P><h2>CAUSE</h2>
 
<P>
The conversion process changes the contents of the Addin field from ANSI to
Unicode.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct the problem in Case 1, install Microsoft Word 97 Service Release
1 (SR-1).
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE>NOTE: SR-1 does not correct the problems in Case 2 or Case 3.
<P>
To work around this problem, use document variables to create and store
variables within your document.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
The following Visual Basic for Applications code example adds a document
variable named "Value1" to the active document. The code then retrieves the
value from the Value1 variable, adds 3 to it, and displays the results.
<P>
<PRE>   Sub AddDocVar()
      Dim MyDoc As Document
      Set MyDoc = Documents.Add
      MyDoc.Variables.Add name:="Value1", Value:="1"
      MsgBox MyDoc.Variables("Value1") + 3
   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following sample macros exhibit the problems described in the
"Symptoms" section of this article.
<P>
<P><h3>Case 1</h3>
 
<P>
Data stored in a Addin field may be corrupted opening a word 6.0/95
document in Word 97.

<OL><P><LI>In Word 7.0, run the following macro to insert a Addin field.
<P>
<PRE>      Sub MAIN
        InsertField ("ADDIN")
        CharLeft
        PutFieldData ("123")
      End Sub

</PRE><P><LI>Save the document as a Word document.

<P><LI>Open the document in Word 97.

<P><LI>Place the insertion point in the Addin field and then run the following
   macro to display the contents of the Addin field.
<P>
<PRE>      Sub DisplayAddinFieldData()
         MsgBox WordBasic.GetFieldData$()
      End Sub

</PRE></OL>NOTE: The field should contain "123"; however, the last character is a
vertical bar: "12|." This problem may occur with three and seven digit
character strings.
<P>
<P><h3>Case 2</h3>
 
<P>
Data stored in an Addin field may be corrupted saving a word 97 document as
either a Word 6.0/95 document or as a Rich Text Format (RTF) file.

<OL><P><LI>Open Word 97 and run the following macro to insert an Addin field.
<P>
<PRE>      Sub CreateAddinField()
         WordBasic.InsertField ("ADDIN")
         WordBasic.CharLeft
         WordBasic.PutFieldData ("test")
      End Sub

</PRE><P><LI>Save the document in Word 97 format.

<P><LI>Put the insertion point in the Addin field and run the following
   DisplayAddinFieldData macro to display the contents of the Addin field.
<P>
<PRE>      Sub DisplayAddinFieldData()
         MsgBox WordBasic.GetFieldData$()
      End Sub

   The word "test" is displayed.

</PRE><P><LI>Save the document in Word 6.0/95 format.

<P><LI>Close and reopen the document.

<P><LI>Run the DisplayAddinFieldData macro.
<P>
</OL>NOTE: The letter "t" is displayed instead of the word "test."
<P>
<P><h3>Case 3</h3>
 
<P>
Addin fields are not converted in Word 7.0, when opening a Word 97 document
with the Word 97 converter.

<OL><P><LI>Create a new Word 97 document and insert an Addin field using the
   following CreateAddinField macro.
<P>
<PRE>      Sub CreateAddinField()
         WordBasic.InsertField ("ADDIN")
         WordBasic.CharLeft
         WordBasic.PutFieldData ("test")
      End Sub

</PRE><P><LI>Save the document as a Word 97 document.

<P><LI>Open the Word 97 document in Word 7.0.
<P>
</OL>NOTE: The Addin field will now be displayed as a "pimprivate" field. The
GetFieldData statement will not work on this field.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For information about Addin fields, please see the following articles
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q140868.htm">Q140868</A></B>
   TITLE     : ADDIN Field Not Documented in Word 5.x Help

   ARTICLE-ID: <B><A href="../word/q140868.htm">Q140868</A></B>
   TITLE     : ADDIN Field Not Documented in Word 6.x Help

</PRE></OL>For more information about obtaining the Word 97 import converter for Word
6.0 and 7.0, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q162214.htm">Q162214</A></B>
   TITLE     : How to Obtain the Word 97 Converter

</PRE>For more information about saving documents in other file formats, click
the Office Assistant, type "saving in another format" (without the
quotation marks), click Search, and then click the "Results of saving Word
97 documents in other file formats" topic.
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Word Help is not installed on your computer, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SR1 release1 8.0 8.00<BR>
Keywords          : kbfield kbinterop<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
