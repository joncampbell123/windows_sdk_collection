

<HTML>
<HEAD>
<TITLE>WD97: Using Calculate on Exit in a Forms Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157463">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1996/10/11">
<META NAME="Keywords" CONTENT="kbfield kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Word 97 for Windows, form fields include a Calculate On Exit option. This option, when enabled, updates fields and form fields in a form document.  Fields not updated by this option include:     TOC    PAGE    INDEX    PAGEREF  MORE IN...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QBJZ,QA7N,QAUR,QBWS,QAMB,QATX,QA36,QBI4 P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: Using Calculate on Exit in a Forms Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157463</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Word 97 for Windows, form fields include a Calculate On
Exit option. This option, when enabled, updates fields and form fields in a
form document.
<P>
Fields not updated by this option include:
<P>
<PRE>   TOC
   PAGE
   INDEX
   PAGEREF

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This option is especially useful when you automate documents and need to
update calculation of text form fields automatically or to repeat text
typed in one form field in other locations in the same document.
<P>
<P><h2>EXAMPLE OF USING CALCULATION WITH A TEXT FORM FIELD</h2>
 
<P>
<P><h3>Create a New Document with Text Form Fields</h3>
 
<P>
To create a new document with text form fields, follow these steps:

<OL><P><LI>Create a new document. On the View menu, point to Toolbars, and click
   Forms to enable the Forms toolbar.

<P><LI>On the Forms toolbar, click the Text Form Field button to insert a text
   form field, and then press ENTER.

<P><LI>Insert two additional text form fields in the same manner, and press
   ENTER after you insert each form field.

<P><LI>Double-click the first Form Field (or right-click the field and click
   Properties on the shortcut menu) to access its options. Set the options
   to the following:
<P>
   a. Under Type, select Number.
<P>
   b. Under Field Settings, click to select the Calculate On Exit check
<P><PRE>      box, and click OK.
</PRE>
<P><LI>Repeat step 4 for the second form field.

<P><LI>Double-click the last form field to access its options. Set the options
   to the following:
<P>
   a. Under Type, select Calculation.
<P>
   b. For Expression, type: =SUM(Text1,Text2)

<P><LI>Click OK.
<P>
</OL>NOTE: Word uses Text# bookmark names (where # is a number) to sequentially
name each new text form field. The first two text form fields have bookmark
names of Text1 and Text2. Capitalization is important. In this example, the
expression returns the sum of the first two text form fields.
<P>
<P><h3>Save the Document as a Protected Template</h3>
 
<P>
To save and protect the document, follow these steps:

<OL><P><LI>Save the document as a template by clicking Save As on the File menu.
   Under Save As Type, select Document Template, type a name, and then
   click Save.

<P><LI>Protect the template. To do this, click Protect Document on the Tools
   menu, under Protect Document For, click Forms, and then click OK.

<P><LI>Save and close the template.
<P>
</OL><h3>Test the Template</h3>
 
<P>
To test the template, follow these steps:

<OL><P><LI>On the File menu, click New, and open a document based on the newly
   created template.

<P><LI>Type a number in the first form field and press TAB.

<P><LI>Type a number in the second form field and press TAB.
<P>
</OL>Notice that when you exit either of the first two form fields, the
calculation form field is updated.
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q110014.htm">Q110014</A></B>
   TITLE     : WD: Calculation Text Fields Within Forms Fail to Update

   ARTICLE-ID: <B><A href="../word/q141990.htm">Q141990</A></B>
   TITLE     : How to Create an Online Form Using Form Fields

</PRE></OL><h2>EXAMPLE OF USING THE REF FIELD</h2>
 
<P>
<P><h3>Creating the Document with the REF Field</h3>
 
<P>
To repeat the result of a form field in another location, use a REF field.
To do this, follow these steps:

<OL><P><LI>Create a new document. On the View menu, point to Toolbars and click
   Forms to display the Forms toolbar.

<P><LI>Click the Text Form Field button on the Forms toolbar to insert a text
   form field, and then press ENTER.

<P><LI>Double-click the form field to access its options.

<P><LI>Under Field Settings click to select the Calculate On Exit check box,
   and then click OK.
<P>
   Notice that Word assigns the Text1 bookmark name to the form field.

<P><LI>Press the RIGHT ARROW to remove selection from the form field, and press
   ENTER four times to insert blank lines.

<P><LI>On the Insert menu, click Field. Under Categories, select Links and
   References. Under Field Names, select Ref.

<P><LI>In the Field codes box, type "REF Text1" (without the quotation marks),
   and click OK.
<P>
   Note that Text1 is the bookmark name of the form field. Capitalization
   is important.
</OL><h3>Save the Document as a Protected Template</h3>
 
<P>
To save and protect the document, follow these steps:

<OL><P><LI>Save the document as a template by clicking Save As on the File menu.
   Under Save File As Type, select Document Template, type a name, and then
   click Save.

<P><LI>Protect the template. To do this, click Protect Document on the Tools
   menu, under Protect Document For, click Forms, and then click OK.

<P><LI>Save and close the template.
<P>
</OL><h3>Testing the Template</h3>
 
<P>
To test the template, follow these steps:

<OL><P><LI>On the File menu, click New and open a document based on the newly
   created template.

<P><LI>Type a number in the text form field and press TAB.
<P>
</OL>When you exit the form field, the REF field is updated. This field
duplicates the contents of the text form field.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q115607.htm">Q115607</A></B>
   TITLE     : How to Update Fields in a Protected Form
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: table of contents page reference example word8<BR>
word97 8.0<BR>
Keywords          : kbfield kbualink97<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
