

<HTML>
<HEAD>
<TITLE>WinWord: DDEPoke Results Contain Incorrect Character Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89527 ">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1992/09/24">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When poking, or sending, data to a bookmarked location in a Microsoft Word for Windows document during a DDE conversation, the information may arrive formatted for the incorrect font and size.  STATUS ======  Microsoft has confirmed this to be a pr...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QDL9,QBWO,QBWN,QBJZ,QBWQ,QADF,QAH4,QABF,QABI,QDNG,QBXS,QBRD,QBJC,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WinWord: DDEPoke Results Contain Incorrect Character Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89527 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 1.0, 1.1, 1.1a, 2.0, 2.0a,
   2.0a-CD, 2.0b 2.0c, 6.0, 6.0a, 6.0c, 7.0
<LI>Microsoft Windows operating system versions 3.0, 3.1, and Windows95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When poking, or sending, data to a bookmarked location in a Microsoft
Word for Windows document during a DDE conversation, the information
may arrive formatted for the incorrect font and size.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of
Microsoft Word for Windows listed above. We are researching this
problem and will post more information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
During a DDE conversation with Word for Windows as the server, data
can be sent to and extracted from a Word document by referencing a
bookmarked location within a document. The document is the topic of
the conversation and the bookmarked location is the item.
<P>
However, when data is sent, or poked, into a bookmarked location in a
Word document, the data may not arrive formatted with the same font
and size that the bookmarked location is formatted for. The
information should arrive formatted just as though the data were typed
at that location manually.
<P>
This problem is inconsistent; sometimes the formatting of poked
information is correct and sometimes it is incorrect.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Because the problem is inconsistent, it is best to add additional
commands to your macro to format the text as desired. The following
sample selects the poked data then formats it for Arial 20 point, bold
and italic:
<P>
Note: Menu commands have changed in different versions of Word.  Make sure you type in the correct menu commands for the version of Word that you are using.
<P>
<PRE>   Sub MAIN
   chan = DDEInitiate("WINWORD", "Document1")
   DDEPoke chan, "MyBookmark", "Hello World!"

   ' Goto the bookmark location, selecting the text
   cmd$ = "[EditGoTo .Destination = " + Chr$(34) + "MyBookmark" \
   + Chr$(34) + "]"
   DDEExecute chan, cmd$

   ' Format the text with Arial 20, bold and italic
   cmd$ = "[FormatCharacter .Font = " + Chr$(34) + "Arial" \
   + Chr$(34) + ", .Points = " + Chr$(34) + "20" + Chr$(34) \
   + ", .Bold = 1, .Italic = 1]"
   DDEExecute chan, cmd$

   DDETerminate chan
   End Sub

</PRE><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Launch two instances of Word for Windows (in other words, run two
   copies of the program on the same computer). In these steps, one
   instance will communicate with the other.

<P><LI>The first instance of Word for Windows is designated as the client
   in the DDE conversation. This means it initiates the DDE conversation.
   Close the default "Document1" and open a document titled something
   other than "Document1."

<P><LI>From the Tools menu, choose Macro. Type a unique name in the Macro
   Name box, and choose the Edit button.

<P><LI>In the macro editing window, type the following macro:
<P>
<PRE>      Sub MAIN
      chan = DDEInitiate("WINWORD", "Document1")
      DDEPoke chan, "MyBookmark", "Hello World!"
      DDETerminate chan
      End Sub

</PRE><P><LI>Switch to the other instance of Word for Windows (the server in the
   DDE conversation) and make sure that the default document
   ("Document1") is the active document. Press ENTER a few times to
   create some blank lines.

<P><LI>Select one of the blank lines. From the Format menu, choose
   Character. Select a different font and a larger point size. Select
   the bold and italic options and choose the OK button.

<P><LI>Press HOME to position the insertion point at the start of the
   line. Choose Bookmark from the Insert menu and type "MyBookmark"
   (without the quotation marks) in the Bookmark Name box. Choose the
   OK button.

<P><LI>Switch back to the first instance of Word and choose the Start
   button on the macro testing bar to execute the macro.
<P>
</OL>Result: The data appears in the second instance of Word but is not
formatted with the chosen font or size. The bold and italic formatting
may or may not appear.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Win 2.x, 3.0: Windows Dynamic Data Exchange (DDE)," Application Note
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword2  poke 1.0 1.10 1.1a 2.0 2.0a<BR>
word6 2.0a-CD 2.0b winword word7 word95 windows95 win95<BR>
Version           : 1.x 2.x 6.0 6.0a 6.0c 7.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
