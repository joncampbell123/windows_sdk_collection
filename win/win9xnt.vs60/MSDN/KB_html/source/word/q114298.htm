

<HTML>
<HEAD>
<TITLE>Limiting the Amount of Text in a Macro Combo Box or Text Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114298">
<META NAME="KBModify" CONTENT="1997/08/04">
<META NAME="KBCreate" CONTENT="1994/04/28">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you create a custom dialog box, you can specify a limit to the amount of text that can be entered into a combo box or text box by using SendMessage (a Windows API function) with the EM_LIMITTEXT constant.  MORE INFORMATION  The preferred way to ...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QAGX,QBV4,QBT6,QABN,QATX,QAY5,QAIH,QA4Q,QAMB,QDL9,QBWO,QBWN,QA01,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Limiting the Amount of Text in a Macro Combo Box or Text Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114298</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.00 6.00a 6.00c 7.00
WINDOWS
kbusage kbmacro
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you create a custom dialog box, you can specify a limit to the amount of
text that can be entered into a combo box or text box by using SendMessage
(a Windows API function) with the EM_LIMITTEXT constant.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The preferred way to limit the length of a string entered into a combo or
text box is to use the SendMessage API function call. After you set the
focus to the desired edit control, you must send a message to the window's
message queue that will reset the text limit for the control. The argument
EM_LIMITTEXT, as the second parameter to SendMessage, will set the desired
text limit based on the value specified by the third argument. The
SendMessage function requires the following parameters for setting the text
limit
<P>
<PRE>   SendMessage Lib "User"(hWnd As Integer, wMsg As Integer, wParam As
   Integer, lParam As String) As Long

</PRE>where:
<P>
<PRE>   hWnd     Specifies the handle to the edit control.

   wParam   Specifies the maximum number of bytes that can be entered.
            If the user attempts to enter more characters, the edit
            control beeps and does not accept the characters.

   lParam   Is not used.

</PRE><h3>Example</h3>
 
<P>
WARNING: ANY USE BY YOU OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this macro code "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
<P>
<P><h3>Word 7.0</h3>
 
<P>
<PRE>Declare Function GetFocus Lib "User32"() As Long
Declare Function SendMessageA Lib "User32"(hWnd As Long, wMsg As Integer,
</PRE>wParam As Integer, lParam As String) As Long
Dim Shared WM_USER, EM_LIMITTEXT, TextLimit
<PRE>Sub MAIN
 WM_USER    = 1024
 EM_LIMITTEXT = WM_USER + 21
 TextLimit = 4     'Sets the number of chars
 Begin Dialog UserDialog 320, 144, "MyApp", .dlgfun
  OKButton 10, 6, 88, 21
  TextBox 10, 30, 160, 18, .TextBox1
  PushButton 10, 51, 88, 21, "Push", .Push1
 End Dialog
 Dim dlg As UserDialog
 Dialog dlg
End Sub

</PRE>Function dlgfun(id$, action, wValue)
<PRE> Select Case action
 Case 1
  DlgVisible "TextBox1", 0
 Case 2
  If id$ = "Push1" Then
   DlgVisible "TextBox1", 1
   DlgFocus "TextBox1"
   hWnd = getfocus
   retVal  = SendMessageA(hWnd, EM_LIMITTEXT, TextLimit, "")
   dlgfun = 1
  End If
 Case 3
 Case 4
 Case 5
 Case 6
 Case Else
 End Select
</PRE>End Function
<P>
<P><h3>Word 6.0</h3>
 
<P>
<PRE>Declare Function GetFocus Lib "User"() As Integer
Declare Function SendMessage Lib "User"(hWnd As Integer, wMsg As
</PRE>Integer, wParam As Integer, lParam As String) As Long
Dim Shared WM_USER, EM_LIMITTEXT, TextLimit
<PRE>Sub MAIN
 WM_USER    = 1024
 EM_LIMITTEXT = WM_USER + 21
 TextLimit = 2     'Sets the number of chars
 Begin Dialog UserDialog 320, 144, "MyApp", .dlgfun
  OKButton 10, 6, 88, 21
  TextBox 10, 30, 160, 18, .TextBox1
  PushButton 10, 51, 88, 21, "Push", .Push1
 End Dialog
 Dim dlg As UserDialog
 Dialog dlg
End Sub

</PRE>Function dlgfun(id$, action, wValue)
<PRE> Select Case action
 Case 1
  DlgVisible "TextBox1", 0
 Case 2
  If id$ = "Push1" Then
   DlgVisible "TextBox1", 1
   DlgFocus "TextBox1"
   hWnd = getfocus
   retVal  = SendMessage(hWnd, EM_LIMITTEXT, TextLimit, "")
   dlgfun = 1
  End If
 Case 3
 Case 4
 Case 5
 Case 6
 Case Else
 End Select
</PRE>End Function
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Software Development Kit (SDK) for Microsoft Windows operating
system version 3.1"
<P>
Kbcategory: kbusage kbmacro
KBSubcategory:

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 6.00 6.00a winword word6 6.00c 7.00 word95<BR>
word7<BR>
Version           : 6.00 6.00a 6.00c 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
