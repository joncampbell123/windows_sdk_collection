

<HTML>
<HEAD>
<TITLE>WD: Incorrect Results Using Backslash in Conditional Merge </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176620">
<META NAME="KBModify" CONTENT="1998/02/18">
<META NAME="KBCreate" CONTENT="1997/11/11">
<META NAME="Keywords" CONTENT="kbfield kbmerge macword98">
<META NAME="KBArea" CONTENT="Support; KB; word, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use a conditional MergeField for a result that includes quotation marks, the result of the field will contain a backslash.  For example, if you have the following conditional statement in your mail merge main document which uses backslashe...">
<META NAME="Product" CONTENT="Word">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA50,QBL4,QAL3,QAIH,QDME,QAYZ,QBQ0,QAVM,QAPF,QA7O,QA7N,QACI,QDO0,QADQ,QBDM P1 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD: Incorrect Results Using Backslash in Conditional Merge</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176620</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
<LI>Microsoft Word 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use a conditional MergeField for a result that includes quotation
marks, the result of the field will contain a backslash.
<P>
For example, if you have the following conditional statement in your mail
merge main document which uses backslashes to have quotation marks appear
in the result of a true condition for a record
<P>
<PRE>   {IF {MERGEFIELD name} = "John Doe" "\"Now is the time...\"" "false
   condition"}

</PRE>you would expect to receive the result of "Now is the time" on a true
statement. However, Word will give you the following result:
<P>
<PRE>   "Now is the time...\"

</PRE>NOTE: This problem may also occur with commas or backslashes.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use a unique character in place of the
quotation mark. After the merge is completed, use the Replace command to
search for the unique character and replace it with a quotation mark. (Note
that the character you choose should not occur elsewhere in your document.)
<P>
<P><h3>Example</h3>
 
<P>
In the merge field, use the pound sign instead of quotation marks.
<P>
<PRE>   {IF {MERGEFIELD name} = "John Doe" "#Now is the time...#" "false
   condition"}

</PRE>After the merge is completed, follow these steps to replace the pound sign
with a quotation mark:

<OL><P><LI>On the Edit menu, click Replace.

<P><LI>In the Find What box, type the unique character (the pound sign in this
   example).

<P><LI>In the Replace With box, type a quotation mark.
<P>
</OL>All instances of the unique character (the pound sign in this example) will
be replaced with a quotation mark.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The general syntax for a conditional {IF} field is as follows:
<P>
<PRE>   {IF {MERGEFIELD name} = "John Doe" "true condition" "false condition"}

</PRE></OL>Note that quotation marks are used to denote the parameters of the
conditional statements, and are not included in the printed result of the
merge.
<P>
The comma also has a special use inside the {IF} field. Therefore, use the
backslash before a comma as well as before the quotation mark. In addition,
the backslash has a special use inside the {IF} field. Therefore, use a
backslash before a backslash. In other words, use two backslashes if you
want one to appear in the merged document.
<P>
For example to have the result "John said, "The file was on f:\harddrive\
my documents"", the {IF} field should have a format of:
<P>
<PRE>   {IF {MERGEFIELD name} = "John Doe" "John said, \"The file was on
   f:\\harddrive\\my documents\"" "false condition"}

</PRE>Note that the actual result of this field will be
<P>
<PRE>   John Doe said, \"The file was on f:\\harddrive\\my documents\"

</PRE>For additional information about this issue, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q134998.htm">Q134998</A></B>
   TITLE     : WD: Certain Characters Do Not Appear in Field Result

</PRE>For additional information about this situation in earlier versions of
Word, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: Q:146648
   TITLE     : WD: How to Use Quotation Marks in a Conditional Merge Result
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: quote mail merge else print condition word8 word97
<P>

Keywords          : kbfield kbmerge macword98<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
