

<HTML>
<HEAD>
<TITLE>XL97: Redraw Problem Changing Visibility of Object on Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159966">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/11/25">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbainfo xl97vbmigrate">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a Visual Basic for Applications macro that changes the Visible property for a drawing object on a Microsoft Excel 5.0 dialog sheet that is displayed, the border of the drawing object may not appear correctly.  When you set the Visible ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA01,QBS0,QBPV,QBJZ,QAH4,QBWS,QAPN,QBVV,QAIB,QBUE,QBSQ,QBQU,QAK4,QAKR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Redraw Problem Changing Visibility of Object on Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159966</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Visual Basic for Applications macro that changes the Visible
property for a drawing object on a Microsoft Excel 5.0 dialog sheet that is
displayed, the border of the drawing object may not appear correctly.
<P>
When you set the Visible property to True, the border of the drawing object
may not be displayed completely. Conversely, when you set the Visible
property to False, the border of the drawing object may not be erased
completely.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because Microsoft Excel 97 does not redraw the screen
correctly.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
To work around this problem, use a UserForm instead of a Microsoft Excel
5.0 dialog sheet. UserForms are new in Microsoft Excel 97; Microsoft
recommends that you use a UserForm instead of a dialog sheet. A UserForm is
more flexible and offers more functionality than a Microsoft Excel 5.0
dialog sheet.
<P>
If you must use a Microsoft Excel 5.0 dialog sheet, you can use an
alternative method. When you change the Visible property for the shape,
close the dialog sheet, and then display it again. This forces Microsoft
Excel to redraw the screen, which causes the border around the shape to
appear correctly. The following example forces Microsoft Excel to do this:

<OL><P><LI>Start a new workbook.

<P><LI>Right-click a sheet tab in the workbook and click Insert.

<P><LI>Click MS Excel 5.0 Dialog and click OK.

<P><LI>Click Rectangle on the Drawing toolbar and draw a rectangle on the
    dialog sheet. (If the Drawing Toolbar is not displayed, point to
    Toolbars on the View menu and click Drawing.)

<P><LI>For the caption for the OK button, type "Toggle" (without the quotation
    marks), and then click the dialog frame to deselect the button.

<P><LI>Press ALT+F11 to start the Visual Basic Editor.

<P><LI>On the Insert menu, Click Module.

<P><LI>Type the following code in the module:
<P>
<PRE>       Sub Main()

           Dim contin
           'Set the flag to True.
           contin = True

           'Continue to show the dialog sheet while Contin is set to
           'True.
           Do While contin
               contin = DialogSheets(1).show
           Loop

       End Sub

       Sub Toggle()

           'Toggle the Visible property of the Rectangle on the
           'dialog sheet.
           DialogSheets(1).Shapes("Rectangle 4").Visible = _
               Not (DialogSheets(1).Shapes("Rectangle 4").Visible)

       End Sub

</PRE><P><LI>On the File menu, click "Close and Return to Microsoft Excel".

<P><LI>Right-click the Toggle button and click Assign Macro. Select the
    macro "Toggle" and click OK.

<P><LI>On the Tools menu, point to Macro, and then click Macros. Select the
    macro "Main" and click Run.
<P>
</OL>The dialog sheet appears. Click the Toggle button to toggle the Visible
property of the rectangle on the dialog sheet.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.0 8.00 dialogsheet transparent<BR>
Keywords          : kbcode kbprg xlvbainfo xl97vbmigrate<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
