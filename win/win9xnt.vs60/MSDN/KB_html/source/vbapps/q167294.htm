

<HTML>
<HEAD>
<TITLE>ACC97: Using a File DSN or DSN-Less Connection with ASP files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167294">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/04/22">
<META NAME="Keywords" CONTENT="kbinterop IntpWeb IntAsp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you export Microsoft Access 97 objects to ASP format, you provide the name of a System DSN on your Web server, which Microsoft Access uses in the ConnectionString prope...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVX,QDNQ,QA1S,QAVZ,QDN9,QAI5,QAFI,QAVX,QAVW,QDNJ,QBG2,QA9N,QASB,QBWG,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Using a File DSN or DSN-Less Connection with ASP files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167294</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you export Microsoft Access 97 objects to ASP format, you provide the
name of a System DSN on your Web server, which Microsoft Access uses in the
ConnectionString property of the ASP script that it generates.
<P>
You can modify the ASP script so that it uses either a File DSN or a
DSN-less ConnectionString (by providing detailed connection information).
This capability has the following advantages:

<UL><LI>If you are not the administrator of the Web server, you do not have to
   ask the administrator to create a System DSN.

<LI>You can change the arguments in a File DSN or in the ASP
   ConnectionString without having to ask the Web server administrator to
   modify a System DSN.

<LI>If you are the administrator, you do not have to create multiple System
   DSNs for every person who wants to create Web pages that have database
   access.

<LI>File DSNs can be shared with other users.
<P>
</UL>NOTE: This article contains information about editing ASP files. It
assumes that you are familiar with Active Server, Visual Basic Scripting,
and editing HTML files. Microsoft Access Technical Support engineers do not
support modification of any HTML, HTX, IDC, or ASP files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example shows you how to create an ASP file with Microsoft
Access 97, and then modify it so that a System DSN is not required. This
section is divided into these parts:

<UL><LI>Important Notes
<LI>Copying Northwind and Your File DSN to the Web Server
<LI>Creating and Modifying the ASP File
<LI>Testing the ASP file
<P>
</UL><h3>Important Notes</h3>
 
<P>
For the sake of simplicity, the example in this article instructs you to
copy all files to the same folder on your Web server. This is not a
requirement, as long as the ConnectionString information in the ASP file
contains the correct path to the files. For example, the database and the
File DSN (if you use one) can be located on a network share, and you can
use universal naming convention (UNC) paths in your ConnectionString.
<P>
All files that you want to access require appropriate permissions on the
Web server computer. This includes IIS permissions, NTFS permissions, and
network share permissions. If IIS is configured to use Anonymous Access
with an Internet Guest Account, then that account must have Read and Write
access to the folder in which the database resides. If you use a File DSN,
then the Internet Guest Account must have Read access to the File DSN. And
if network shares and UNC paths are used in the File DSN or in the
ConnectionString, then the Internet Guest Account must have appropriate
network share permissions. For a detailed description of permissions issues
when using ASP files, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q161333.htm">Q161333</A></B>
   TITLE     : Check NT Permissions When Using IDC/ASP Files with Access

</PRE><h3>Copying Northwind and Your File DSN to the Web Server</h3>
 
<P>
You must have a folder on your Web server where you can copy files. The
folder should be an IIS virtual directory with Execute permissions. Copy
the Northwind sample database, Northwind.mdb, to this folder. Write down
the complete path to this file; you will need that information when you
create the ConnectionString later. The path can use either a drive letter
or a UNC name.
<P>
If you plan to use a File DSN in the ConnectionString instead of detailed
connection information, make sure the appropriate argument in your File DSN
contains the complete path to your database on the Web server (drive letter
or UNC path). Copy your File DSN to the same folder on your Web server
where you place Northwind.mdb. Then, when you modify the ConnectionString
in the ASP file, you only need to provide a path to the File DSN.
<P>
For more information about creating File DSNs and DSN-less connections,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q165866.htm">Q165866</A></B>
   TITLE     : How to Use File DSNs and DSN-less Connections

</PRE><h3>Creating and Modifying the ASP File</h3>
 
<P>
If you are using a File DSN, please skip to the next section.

<OL><P><LI>Start Microsoft Access 97 and open the sample database Northwind.mdb.

<P><LI>Export the Customers table to ASP format. When you are presented with
   the "Microsoft Active Server Pages Output Options" dialog box, leave the
   Data Source Name box blank.

<P><LI>Use Notepad or another text editor to open the Customers.asp file.
   Look for the following line of code in the first If...End If block in
   the file:
<P>
<P><PRE>      conn.open "","",""
</PRE>
<P><LI>Modify the ASP file to use either a DSN-less or File DSN connection.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code.
<P>
<P><PRE>    a. To use a DSN-less connection, modify the line in step 3 to provide
       the correct ConnectionString information. For example, if you copied
       Northwind.mdb to the C:\Inetpub\wwwroot\Test folder on your Web
       server, type the following as your ConnectionString:
</PRE><P>
<PRE>         conn.open "driver={Microsoft Access Driver _
         (*.mdb)};dbq=c:\inetpub\wwwroot\test\northwind.mdb;uid=Admin"

    b. To use a File DSN, modify the line in step 3 to provide the File DSN
       information. For example, if the File DSN is called Northwind.dsn
       and it resides in the C:\Inetpub\wwwroot\Test folder on your Web
       server, type the following as your ConnectionString:

         conn.open "FILEDSN=c:\inetpub\wwwroot\test\northwind.dsn", _
         "Admin", ""

</PRE><P><LI>Save and close the Customers.asp file. Copy the file to the same folder
   on your Web server where Northwind.mdb and your File DSN (if you are
   using one) reside.
<P>
</OL><h3>Testing the ASP File</h3>
 

<OL><P><LI>Start Microsoft Internet Explorer 3.0, or another Web browser program.

<P><LI>Type the uniform resource locator (URL) in the address box of your Web
   browser to view Customers.asp. For example, if you copied your files to
   a folder called Test in the scripts folder of your Web server, type:
<P>
<P><PRE>      <B>http://&lt;servername&gt;/scripts/test/Customers.asp</B>
</PRE><P>
   Note that the URL depends on where your files are located on the Web
   Server.

<P><LI>The Web browser returns the records from the Customers table in
   Northwind.mdb.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about exporting ASP files, search the Help Index for
"ASP files," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information on how to create and modify ASP files, please refer
to your Microsoft ASP online documentation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: data source name<BR>
Keywords          : kbinterop IntpWeb IntAsp<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
