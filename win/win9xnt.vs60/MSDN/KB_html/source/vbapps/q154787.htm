

<HTML>
<HEAD>
<TITLE>ACC: How to Use Automation with Microsoft Project </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154787">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/08/14">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to use Automation to manipulate a Microsoft Project for Windows 95, version 4.1a (*.mpp) file.  This article assumes that you are familiar with...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRM,QA1S,QBWS,QBS0,QDN9,QAH4,QAPN,QAPF,QABH,QAJN,QAJH,QA2K,QAY5,QAGB,QAG0 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use Automation with Microsoft Project</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154787</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Project for Windows 95, version 4.1a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to use Automation to manipulate a Microsoft
Project for Windows 95, version 4.1a (*.mpp) file.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample procedure opens an existing Microsoft Project 4.1a
file to perform these actions:

<UL><LI>Run a macro
<LI>Add tasks to the project
<LI>Change font properties in a column
<LI>Move to a specific cell in the project
<LI>Display a print preview of the project
<LI>Close the Microsoft Project file and application
<P>
</UL>This example assumes you have the sample file Pert.mpp installed in a
folder (directory) called C:\Msoffice\Winproj\Library.

<OL><P><LI>Open the sample database Northwind.mdb and create a new module.

<P><LI>On the Tools menu, click References.

<P><LI>Click to select the Project 4.1 Object Library check box. If the
   selection is not available, click Browse to locate the Pj4en32.olb
   file.

<P><LI>Click OK.

<P><LI>Create the following procedure in the open module:
<P>
<P><PRE>      Function ProjectOLE()
<PRE></PRE>         Dim ProjObj As MSProject.Application
         Set ProjObj = CreateObject("msproject.application")
         ProjObj.FileOpen "C:\Msoffice\Winproj\Library\Pert.mpp", _
            ReadOnly:=True
         ProjObj.Visible = True

         ' Run a macro.
         ProjObj.Macro "ToggleReadOnly" ' Toggle file back to read-write.

         ' Add tasks to the project.
         Dim i As Integer
         Dim ProjDoc As MSProject.Project
         Set ProjDoc = ProjObj.ActiveProject
         For i = 1 To 10
            ProjDoc.Tasks.Add Name:="Task" &amp; i
         Next i

         ' Change font properties.
         ProjObj.SelectColumn
         ProjObj.FontItalic True

         ' Go to a specific cell in the column.
         ProjObj.EditGoTo 5, Date

         ' Print preview the file.
         ProjObj.FilePrintPreview
         'ProjObj.FilePrint   ' Use this line to print the file.
         'ProjObj.Filesave    ' Use this line to save the file.
         ProjObj.FileClose 0  ' 0=pjDoNotSave, 1=pjSave, 2=pjPromptSave.
         ProjObj.Quit
         Set ProjObj = Nothing
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ?ProjectOLE()
</PRE><P>
</OL>Microsoft Project opens, performs the specified actions, and displays
a Print Preview window. Click Close in the Print Preview window. The
sample function finishes, closing the Pert.mpp file and quitting Microsoft
Project.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about working with other applications using
Automation, search the Help Index for "Working across Applications,"
or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : AutoGnrl kbinterop IntpOleA
Technology        : kbole
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
