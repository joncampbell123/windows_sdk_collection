

<HTML>
<HEAD>
<TITLE>VBA: ErrMsg: "Class Not Registered" Inserting UserForm </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182500">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1998/03/13">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you attempt to insert a UserForm while you are in the Microsoft Visual Basic Editor in one the products listed at the beginning of this article, or when you attempt to open a document that contains a UserForm, you may receive the following err...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBVP,QBWQ,QBS0,QBWA,QBWS,QBVV,QA5E,QDNN,QA9N,QAB4,QAD7,QBTI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VBA: ErrMsg: "Class Not Registered" Inserting UserForm</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182500</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft PowerPoint 97 for Windows
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Visual Basic for Applications version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to insert a UserForm while you are in the Microsoft Visual
Basic Editor in one the products listed at the beginning of this article,
or when you attempt to open a document that contains a UserForm, you may
receive the following error message:
<P>
<PRE>   Class not registered.
   Looking for object with CLSID:{AC9F2F90-E877-11CE-9F68-00AA00574A4F}

</PRE>When you click Help, the following message appears:
<P>
<PRE>   The Help topic does not exist. Contact your application vendor for an
   updated Help file (129)

</PRE>The dialog box is dismissed when you click OK.
<P>
The error may also appear when you attempt to save a Microsoft Excel 97
document as an Hypertext Markup Language (HTML) document by clicking Save
As HTML on the File menu. When you click OK, a dialog box with the
following message appears:
<P>
<PRE>   400

</PRE><h2>CAUSE</h2>
 
<P>
This problem may be caused by a missing or incorrect Microsoft Windows
registry entry for the Dynamic Link Library Fm20.dll. The proper
registration of this file is required when you work with UserForms and form
controls in Microsoft Excel 97.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, register Fm20.dll. You must have Regsvr32.exe to
register Fm20.dll. If you do not have Regsvr32.exe you can download the
file. For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q161983.htm">Q161983</A></B>
   TITLE     : ACC: Regsv32a.exe Available on MSL

</PRE><h3>Registering Fm20.dll</h3>
 
<P>
To Register Fm20.dll, follow these steps:

<OL><P><LI>Use Microsoft Windows Explorer to locate the Fm20.dll file in the
   Windows\System folder or in the Winnt\system32 folder (under Microsoft
   Windows NT).
<P>
   If the file is not present, copy it from the OS\System folder on the
   Microsoft Office 97 compact disc to the appropriate location.

<P><LI>Close all open programs.

<P><LI>Click Start on the Windows taskbar, click Run, and then type the
   following:
<P>
<P><PRE>      Regsvr32.exe fm20.dll
</PRE>
<P><LI>Click OK. The following message should appear:
<P>
<P><PRE>      DllRegisterServer in c:\windows\system\fm20.dll succeeded.
</PRE><P>
</OL>The file Fm20.dll should be registered correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kberrmsg kbprg<BR>
Version           : WINDOWS:5.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
