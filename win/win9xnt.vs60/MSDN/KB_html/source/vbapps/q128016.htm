

<HTML>
<HEAD>
<TITLE>ACC: How to Alter Field's Data Type at Run Time Using Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128016">
<META NAME="KBModify" CONTENT="1997/09/10">
<META NAME="KBCreate" CONTENT="1995/03/23">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  A field's DataType property is not available using Visual Basic for Applications, and its Size property is read-only in a TableDef object. Therefore, a field's data type cannot b...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA7O,QA7N,QBS0,QDN9,QAH4,QA5F,QAMA,QAYY,QAP2,QATX,QA5V,QAUJ,QAM9,QALX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Alter Field's Data Type at Run Time Using Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128016</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
A field's DataType property is not available using Visual Basic for
Applications, and its Size property is read-only in a TableDef object.
Therefore, a field's data type cannot be altered directly using Visual
Basic for Applications at run time. However, you can alter a field's data
type using a combination of data access objects (DAO) and Data Definition
Language (DDL) in Visual Basic for Applications code.
<P>
This article demonstrates how to create and use a sample user-defined Sub
procedure called AlterFieldType that uses DAO and DDL to alter a field's
type at run time.
<P>
NOTE: You will have to delete and rebuild any relationships and indexes
that involve the altered field after using this procedure.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create and use the
AlterFieldType Sub procedure, which uses DAO to create a data
definition query to alter a field's data type:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0)

<P><LI>In the Database window, make a copy of the Products table and name it
   PROD1.

<P><LI>Create a new module with the following line in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Enter the following code in the module.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      '*****************************************************************
      ' The AlterFieldType Sub procedure requires three string
      ' parameters. The first string specifies the name of the table
      ' containing the field to be changed. The second string specifies
      ' the name of the field to be changed. The third string specifies
      ' the new data type for the field.
      '*****************************************************************
</PRE><P>
<PRE>      Sub AlterFieldType (TblName As String, FieldName As String, _
         NewDataType As String)
         Dim db As Database
         Dim qdf As QueryDef
         Set db = CurrentDb()

         ' Create a dummy QueryDef object.
         Set qdf = db.CreateQueryDef("", "Select * from PROD1")

         ' Add a temporary field to the table.
         qdf.SQL = "ALTER TABLE [" &amp; TblName &amp; "] ADD COLUMN_
            AlterTempField " &amp; NewDataType
         qdf.Execute

         ' Copy the data from old field into the new field.
         qdf.SQL = "UPDATE DISTINCTROW [" &amp; TblName &amp; "] SET_
            AlterTempField = [" &amp; FieldName &amp; "]"
         qdf.Execute

         ' Delete the old field.
         qdf.SQL = "ALTER TABLE [" &amp; TblName &amp; "] DROP COLUMN ["_
            &amp; FieldName &amp; "]"
         qdf.Execute

         ' Rename the temporary field to the old field's name.
         db.tabledefs("[" &amp; TblName &amp; "]").Fields("AlterTempField")._
            Name = FieldName
         ' Clean up.
      End Sub

</PRE><P><LI>On the View menu, click Debug Window (or Immediate Window in
   version 2.0)

<P><LI>In the Debug window, type the following line, and then press ENTER:
<P>
<P><PRE>      AlterFieldType "PROD1", "UnitsInStock", "LONG"
</PRE><P>
   NOTE: In Microsoft Access 2.0 there are spaces in Units in Stock
<P>
   The AlterFieldType Sub procedure changes the data type of the Units
   In Stock field in the PROD1 table from Integer to Long Integer.
<P>
</OL><h3>Notes</h3>
 

<UL><LI>If Microsoft Access cannot convert a particular value to the new
   data type, it deletes the value, setting the field to null for all
   records containing the value.

<LI>If you convert the data type of a field to a data type with a
   smaller field size, Microsoft Access truncates any data longer
   than the allowable field size.

<LI>Microsoft Access prohibits the conversion of any field data type
   to the Counter data type. So, instead of changing a data type to
   Counter, add a Counter field to your table.

<LI>In large tables, changing a data type may take a long time.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information about modifying tables using DDL, search the
Help Index for "ALTER TABLE."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: programming modify design<BR>
Keywords          : kbprg PgmHowTo PgmObj<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
