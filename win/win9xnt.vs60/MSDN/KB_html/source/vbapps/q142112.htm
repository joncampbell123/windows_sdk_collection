

<HTML>
<HEAD>
<TITLE>XL: Sample Macro to Sort List Based on Custom Sort Order </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142112">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/01/04">
<META NAME="Keywords" CONTENT="kbcode kbualink97 PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can create your own custom sort lists and you can use these lists to specify sort orders when you sort a list of information. This article describes the procedures for creating a custom sort list and includes a sample Micros...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAG9,QAE1,QBPM,QAB6,QBJZ,QARW,QAH4,QAPF,QABA,QAKC,QBWS,QAVZ,QAYY,QAUD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Sample Macro to Sort List Based on Custom Sort Order</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142112</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can create your own custom sort lists and you
can use these lists to specify sort orders when you sort a list of
information. This article describes the procedures for creating a custom
sort list and includes a sample Microsoft Visual Basic for Applications 
macro (Sub procedure) that uses this custom list to sort a range of cells 
according to the custom sort order.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To create a custom sort list that will be used later with the sample macro, 
follow these steps:

<OL><P><LI>In a new worksheet, enter the following:
<P>
<P><PRE>      A1: red
      A2: blue
      A3: green
      A4: yellow
      A5: pink
</PRE>
<P><LI>On the Tools menu, click Options (Preferences if you are using Excel
   for the Macintosh), and in the Options (Preferences) dialog box click
   the Custom Lists tab.

<P><LI>In the Import List From Cells box, type A1:A5, click Import, and
   then click OK.
<P>
   You should now have a custom sort list based on the list in step 1.

<P><LI>Enter the following data in a new worksheet. (This data will be the
   data that is sorted by the sample macro.)
<P>
<P><PRE>      A1: pink
      A2: blue
      A3: green
      A4: blue
      A5: yellow
      A6: pink
      A7: red
      A8: blue
      A9: red
</PRE>
<P><LI>In a new module sheet, type the following macro code:
<P>
<PRE>      Sub Custom_Sort()
         Range("A1").Sort Key1:=Range("A1"), Order1:= _
            xlAscending, Header:=xlGuess, OrderCustom:=6, _
            MatchCase:=False, Orientation:= xlTopToBottom
      End Sub

   NOTE: The number for the "OrderCustom" argument is the position of
   your custom list in the list from the Custom Lists tab of the Options
   dialog box. The number you use may be different from the one used in
   this example. To find out what number you should use, click Options
   on the Tools menu, and click the Custom Lists tab. By default, there
   are four default sort lists in Microsoft Excel. Their values for the
   "OrderCustom" argument would be 2, 3, 4, and 5, respectively.
   Therefore, the first custom sort list would be 6. If you have only
   the custom sort list created in steps 1 through 3 above, this is the
   value you would use for the "OrderCustom" argument. Use this value
   because the number 1 item in the list is reserved for the "New List"
   item.

</PRE><P><LI>Activate the worksheet where you entered the value in step 4, and
   then run the Custom_Sort macro.
<P>
   The list should be sorted according to the custom sort list you
   created in steps 1-3, and your data should resemble the following:
<P>
<P><PRE>      A1: red
      A2: red
      A3: blue
      A4: blue
      A5: blue
      A6: green
      A7: yellow
      A8: pink
      A9: pink
</PRE><P>
</OL>For additional information on determining the position for a custom sort
list, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q134913.htm">Q134913</A></B>
   TITLE     : XL: GetCustomListNum Returns Unexpected List Number

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about Custom Lists, click Answer Wizard on the Help
menu and type:
<P>
<PRE>   tell me about creating custom lists

</PRE>For more information about Custom Lists, choose the Search button in
Help and type:
<P>
<PRE>   custom lists
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 8.00 XL97<BR>
Keywords          : kbcode kbualink97 PgmHowto<BR>
Version           : WINDOWS: 5.0,5.0c,7.0,97; MACINTOSH: 5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
