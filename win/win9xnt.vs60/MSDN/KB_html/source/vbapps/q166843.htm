

<HTML>
<HEAD>
<TITLE>ACC97: How to View Images from OLE Object Field in IDC/ASP Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166843">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/04/11">
<META NAME="Keywords" CONTENT="kbinterop kbole IntpOle IntAsp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you export a table to HTML, IDC, or ASP format, Microsoft Access does not export OLE Object fields in the table.  This article demonstrates how you can display images f...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVX,QDNQ,QAUR,QAFI,QAGU,QBTI,QA7O,QA7N,QAU7,QAPF,QA3P,QBWS,QAUJ,QADF,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: How to View Images from OLE Object Field in IDC/ASP Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166843</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you export a table to HTML, IDC, or ASP format, Microsoft Access does
not export OLE Object fields in the table.
<P>
This article demonstrates how you can display images from an OLE Object
field in IDC or ASP files; this example does not work for HTML files. Note
that the images from the OLE Object field must be a file type that is
supported by your Web browser, such as *.bmp, *.jpg, or *.gif files.
<P>
NOTE: This method does not work with ASP forms; it only works with IDC or
ASP files created from tables or queries.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order to view images from your OLE Object field in an IDC or ASP file,
you must store the image in a folder on your Web server's hard drive.
Because of this limitation, the example in this article works best with
images that are static or do not change very often -- pictures of products
for sale or photographs of your employees, for example.
<P>
You can store images in two ways in an OLE Object field: embedded or
linked. If your image objects are embedded in the table, you must create a
copy of the image to store on your Web server; if your OLE Object images
are linked to files on your hard drive, you can copy or move those files to
your Web server. Note that with embedded images, if you change the OLE
Object image, you must recopy it to your Web server in order to see your
changes in the IDC or ASP file. If your images are linked, and you locate
the linked files on your Web server, you can edit an image in your table
and see your changes automatically the next time you open or refresh your
IDC or ASP file; however, if you change a linked file that is not stored on
your Web server, you must recopy the file to the server in order to see
your changes.
<P>
The following example uses two different folders on your Web server. You
store the graphics files in a folder where you have Read permission, and
you store the IDC or ASP files in a folder where you have Execute
permission. You can also modify the example to put all the files in a
single folder for which you have both Read and Execute permissions.
<P>
<P><h3>Creating a File from a Stored Bitmap Image</h3>
 
<P>
The following steps show you how to create copies of employee photographs
in the Northwind sample database. Then you copy those files to your Web
server and modify the Employees table so that it will display an employee's
photograph in your IDC or ASP file.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.

<OL><P><LI>Open the sample database Northwind.mdb, and open the Employees table
   in Datasheet view.

<P><LI>Locate the employee record for Nancy Davolio, and double-click the
   bitmap image stored in the Photo field. This invokes Microsoft Paint
   (or whatever application you have associated with .bmp files) and opens
   Nancy's picture.

<P><LI>In Microsoft Paint, click Save Copy As on the File menu.

<P><LI>In the Save Copy As dialog box, type NancyD in the File Name box, and
   save the file to a folder on your Web server where you have Read
   permission, such as \Inetsrv\wwwroot or \Webshare\wwwroot.

<P><LI>Quit Microsoft Paint, and return to Microsoft Access.

<P><LI>Repeat steps 2-5 for Andrew Fuller, and save his bitmap picture as
   AndrewF in step 4.

<P><LI>Switch the Employees table to Design view, and add a new field to
   display the bitmap image:
<P>
<P><PRE>      Table: Employees
      ----------------
      Field Name: PhotoPath
      Data Type: Text
</PRE>
<P><LI>Save the Employees table, and then open it in Datasheet view.

<P><LI>Type the following information in the PhotoPath field for Nancy Davolio
   and Andrew Fuller, and then close the Employees table:
<P>
<PRE>      Record to Change     Enter in PhotoPath Field
      ---------------------------------------------
      Nancy Davolio        &lt;IMG src=\nancyd.bmp&gt;
      Andrew Fuller        &lt;IMG src=\andrewf.bmp&gt;

   NOTE: The path and file name you type after IMG src= in the PhotoPath
   field depends on the alias name for the folder where you store the
   bitmap files on your Web server. For example, if you store the bitmap
   files in the \wwwroot subfolder, which has an alias of /, enter
   \NancyD.bmp and \AndrewF.bmp in the PhotoPath field; if you store them
   in a different folder that has an alias of /Photos, enter
   \Photos\NancyD.bmp and \Photos\AndrewF.bmp in the PhotoPath field.

</PRE></OL><h3>Exporting the Employees Table to IDC Format</h3>
 

<OL><P><LI>Select the Employees table in the Database window.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an External File or Database," and
   then click OK.

<P><LI>In the "Save Table 'Employees' In" dialog box, select Microsoft IIS 1-2
   (*.htx;*.idc) in the Save As type box. Type Employees.htx in the File
   Name box, and save the files to a folder on your Web server where you
   have Execute permission, such as the \Inetsrv\Scripts or
   \Webshare\Scripts folder. Click Export.

<P><LI>In the Data Source Name box of the HTX/IDC Output Options dialog box,
   type the name of a System DSN on your Web server that points to the
   Northwind sample database that you modified in the previous section.
   Click OK. This step creates two files: Employees.htx and Employees.idc.

<P><LI>Start Microsoft Internet Explorer, and type the Uniform Resource
   Locator (URL) to Employees.idc in the Address box. For example, if you
   saved the file in a folder on your Web server that has an alias name of
   /Scripts, type the following URL:
<P>
<P><PRE>      <B>http://&lt;Web</B> Server Name&gt;/Scripts/Employees.IDC
</PRE>
<P><LI>Scroll down to the record for Nancy Davolio or Andrew Fuller and note
   that their photographs are displayed in the PhotoPath field of the
   table.
<P>
</OL><h3>Exporting the Employees Table to ASP Format</h3>
 
<P>
NOTE: This section contains information about editing ASP files. It assumes
that you are familiar with Active Server, Visual Basic Scripting, and
editing HTML files. Microsoft Access Technical Support engineers do not
support modification of any HTML, HTX, IDC, or ASP files.

<OL><P><LI>Select the Employees table in the Database window.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As Dialog box, click "To an External File or Database," and
   then click OK.

<P><LI>In the "Save Table 'Employees' In" dialog box, select Microsoft Active
   Server Pages (*.asp) in the Save As type box. Type Employees.asp in the
   File Name box, and save the files to a folder on your Web server where
   you have Execute permission, such as the \Inetsrv\Scripts or
   \Webshare\Scripts folder. Click Export.

<P><LI>In the Data Source Name box of the Microsoft Active Server Pages Output
   Options dialog, type the name of a System DSN on your Web server that
   points to the Northwind sample database that you modified for this
   example. In the Server URL box, type the URL for the folder on your
   Web server where you are saving this file. For example, if you save
   the file in the /Scripts folder on your Web server, type
<P>
<P><PRE>      <B>http://&lt;Web</B> Server Name&gt;/Scripts
</PRE><P>
   and then click OK.

<P><LI>Using Notepad or another text editor, open the Employees.asp file to
   change the way the PhotoPath field is displayed. Look for the following
   line near the bottom of the file:
<P>
<P><PRE>      &lt;TD BORDERCOLOR=#c0c0c0 &gt;&lt;FONT SIZE=2 FACE="Arial"
      COLOR=#000000&gt;&lt;%=Server.HTMLEncode(rs.Fields("PhotoPath").Value)%&gt;
      &lt;BR&gt;&lt;/FONT&gt;&lt;/TD&gt;
</PRE><P>
   Modify the line so it looks as follows:
<P>
<P><PRE>      &lt;TD BORDERCOLOR=#c0c0c0 &gt;&lt;FONT SIZE=2 FACE="Arial"
      COLOR=#000000&gt;&lt;%=rs.Fields("PhotoPath").Value%&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/TD&gt;
</PRE>
<P><LI>Save and close the Employees.asp file.

<P><LI>Start Microsoft Internet Explorer, and type the URL to Employees.asp in
   the Address box. For example, if you saved the file in a folder on your
   Web server that has an alias name of /Scripts, type the following URL:
<P>
<P><PRE>      <B>http://&lt;Web</B> Server Name&gt;/Scripts/Employees.asp
</PRE>
<P><LI>Scroll down to the record for Nancy Davolio or Andrew Fuller and note
   that their photographs are displayed in the PhotoPath field of the
   table.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about exporting to IDC or ASP formats, search the Help
Index for "IDC files" or "ASP files."
<P>
For more information about creating system data sources, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q159682.htm">Q159682</A></B>
   TITLE     : ACC97: "Data Source Name Not Found" Err Msg Opening Web Page
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: HTM JPEG Picture IE<BR>
Keywords          : kbinterop kbole IntpOle IntAsp<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
