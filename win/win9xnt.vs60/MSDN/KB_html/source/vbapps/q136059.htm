

<HTML>
<HEAD>
<TITLE>ACC: Errors Concatenating Variables or Controls (2.0/7.0/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136059">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/08/31">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you concatenate variables or controls in a function or OpenRecordset method, you may receive one of the following error messages.  In Microsoft Access 97  The Microsoft Jet ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QA1S,QAY5,QAB9,QAYL,QAPN,QA7O,QAPF,QAHE,QAP2,QBV8,QBXS,QAR4,QAOE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Errors Concatenating Variables or Controls (2.0/7.0/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136059</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you concatenate variables or controls in a function or OpenRecordset
method, you may receive one of the following error messages.
<P>
<P><h3>In Microsoft Access 97</h3>
 
<P>
The Microsoft Jet database engine does not recognize &lt;name&gt; as a valid
Field name or expression. (Error 3070)
<P>
-or-
<P>
Data type mismatch in criteria expression. (Error 3464)
<P>
-or-
<P>
<P><h3>In Microsoft Access 2.0 and 7.0</h3>
 
<P>
Can't bind name '&lt;argument&gt;'
<P>
-or-
<P>
Type Mismatch
<P>
-or-
<P>
<P><h3>In Microsoft Access 7.0 and 97</h3>
 
<P>
Too few parameters. Expected 1
<P>
-or-
<P>
<P><h3>In Microsoft Access 2.0</h3>
 
<P>
1 parameter expected only 0 supplied.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
These error messages can occur if one of the following is true:

<UL><LI>You incorrectly declare the data type of the argument being passed to
   the function.

<LI>You include a variable or control name in the function syntax and
   Microsoft Access is unable to recognize the data type.

<LI>You use incorrect syntax to concatenate the variables.
<P>
</UL>This article presents examples of how these errors can occur and explains
how to correct them.
<P>
<P><h3>Microsoft Jet Engine error(3070) or "Can't bind name '&lt;argument&gt;'" Error</h3>
 
<P>
You may receive the Microsoft Jet Engine error message or the "Can't bind
name '&lt;argument&gt;'" error message when you concatenate a variable or control
that has a String data type in a method or function as a Numeric data type.
For example, the following sample function produces one of these error
messages:
<P>
<PRE>   Call the function as follows: MyFunction ("Seattle")

   Function MyFunction (DataToFind As String)
      Dim MyDB As Database, Myset As Recordset
      Set MyDB = CurrentDB()
      Set Myset = MyDB.OpenRecordset("Employees", DB_OPEN_DYNASET)
      Myset.FindFirst "[City]= " &amp; DataToFind
   End Function

</PRE>The correct syntax for the last line of the code above is as follows:
<P>
<PRE>   MySet.FindFirst "[City] = '" &amp; DataToFind &amp; "'"

</PRE><h3>"Type Mismatch" or "Data Type Mismatch in Criteria Expression" Error</h3>
 
<P>
You may receive the "Type Mismatch" or "Data Type Mismatch in Criteria
Expression" error message when you concatenate a variable or control that
has a Numeric data type in a method or function as a String data type. For
example, the following function produces one of these error messages:
<P>
<PRE>   Call the function as follows: MyFunction (3).

   Function MyFunction (NumberToFind As integer)
      Dim MyDB As Database, MySet As Recordset
      Set MyDB = CurrentDB()
      Set MySet = MyDB.OpenRecordset("Order Details", DB_OPEN_DYNASET)
      MySet.FindFirst "[Quantity] = '" &amp; NumberToFind &amp; "'"
   End Function

</PRE>The correct syntax for the next to the last line of the code above is as
follows:
<P>
<PRE>   MySet.FindFirst "[Quantity] = " &amp; NumberToFind

</PRE>Keep the following requirements in mind:

<UL><LI>When the argument for a user-defined function or method is a String
   data type, single quotation marks around the string variable are
   required.

<LI>Dates passed as a string require the number sign (#). For example:
<P>
<P><PRE>      MySet.FindFirst "[HireDate] = #" &amp; DateToFind &amp; "#"
</PRE>
<LI>Numeric data types do not require delimiters. For example:
<P>
<P><PRE>      MySet.FindFirst "[Quantity] = " &amp; NumericDataToFind
</PRE><P>
</UL><h3>"Too few parameters. Expected 1" Error</h3>
 
<P>
You may receive this error message when you use the OpenRecordset method in
code on an existing query. If the query is a parameter query, you need to
explicitly declare the parameter and its data type and set the parameter
value for that query in the function.
<P>
For example in Query1, which includes fields from the Employees table in
the sample database Northwind.mdb (or NWIND.MDB in version 2.0), the
following sample code generates the error message when Query1 has the
parameter "[Enter a City]" in the criteria for the [City] field:
<P>
<PRE>   Function TestQP()
      Dim MyDB As Database, MySet As Recordset
      Set MyDB = CurrentDB()
      Set MySet = MyDB.OpenRecordset("Query1", DB_OPEN_DYNASET)
      Debug.Print MySet![City]; Tab(10); MySet![Region]
   End Function

</PRE>When you refer to the parameter query, the correct syntax is as follows:
<P>
<PRE>   Function TestQP()
      Dim MyDB As Database, MyDef As QueryDef, MySet As Recordset
      Set MyDB = CurrentDB()
      Set MyDef = MyDB.QueryDefs("Query1")
      MyDef![Enter a City] = "Seattle"
      Set MySet = MyDef.OpenRecordset(DB_OPEN_DYNASET)
      Debug.Print MySet![City]; Tab(10); MySet![Region]
      MySet.Close
      MyDef.Close
   End Function

</PRE>The same error message may appear when you concatenate a variable in the
SQL SELECT statement of a OpenRecordset method. A syntactically correct
example is as follows.
<P>
NOTE: In the following statement, an underscore (_) at the end of a line is
used as a line-continuation character. Remove the underscore from the end
of the line when re-creating this statement.
<P>
<PRE>   Set MySet = MyDB.OpenRecordset("SELECT * FROM Employees WHERE [City] _
      = '" &amp; Forms!Form1!Field0 &amp; "';")

</PRE>This SELECT statement points to a control on a form for the WHERE clause.
[City] is a Text field type and the contents of the control are text.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about concatenating variables or controls in Microsoft
Access versions 1.x, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q96576.htm">Q96576</A></B>
   TITLE     : ACC1x: Error Messages when Concatenating Variables or
               Controls
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: parameters<BR>
Keywords          : kberrmsg kbprg<BR>
Version           : 2.0 7.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
