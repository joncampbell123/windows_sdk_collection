

<HTML>
<HEAD>
<TITLE>ACC: Rounding a Number Up or Down by a Desired Increment </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155696">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/09/05">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo SynFnc">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to create a procedure that rounds a number up or down by a specified increment. For example, given the number 3.23, rounding to the nearest .05 resu...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAK2,QDN9,QAKC,QASR,QBS0,QA5F,QAMA,QBC6,QAUD,QAG8,QBDM,QAB9,QAHH,QAD2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Rounding a Number Up or Down by a Desired Increment</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155696</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to create a procedure that rounds a number
up or down by a specified increment. For example, given the number 3.23,
rounding to the nearest .05 results in the number 3.25. The procedure in
this article accepts any positive rounding increment as a parameter. In
addition to rounding numbers to the nearest fractional amount, you can
also round to whole numbers, such as 1, 10, or 100.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example creates a procedure called RoundToNearest, which
accepts three parameters:
<P>
<PRE>   Parameter     Value
   ---------     ---------------------------------------------------------
   Amt           The numeric value you want to round
   RoundAmt      The increment to which Amt will be rounded
   Direction     Constant indicating which direction to round (up or down)

</PRE>For example, RoundToNearest(3.33, 0.1, vb_roundup) returns the value 3.4.

<OL><P><LI>Create a module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
      Public Const vb_roundup = 1
      Public Const vb_rounddown = 0
</PRE><P>
   NOTE: In versions 1.x and 2.0, use the word "Global" instead of
   "Public."

<P><LI>Create the following procedure.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      Function RoundToNearest (Amt As Double, RoundAmt As Variant, _
<PRE></PRE>                               Direction As Integer) As Double
         On Error Resume Next
         Dim Temp As Double
         Temp = Amt / RoundAmt
         If Int(Temp) = Temp Then
            RoundToNearest = Amt
         Else
            If Direction = vb_rounddown Then
               Temp = Int(Temp)
            Else
               Temp = Int(Temp) + 1
            End If
            RoundToNearest = Temp * RoundAmt
         End If
      End Function

</PRE><P><LI>To test this function, type each of the following lines in the Debug
   window (or Immediate window in 1.x and 2.0), and then press ENTER.
<P>
<P><PRE>      ?RoundToNearest(1.36, 0.25, vb_roundup)
</PRE><P>
   Note that the procedure returns 1.5.
<P>
<P><PRE>      ?RoundToNearest(1.36, 0.05, vb_rounddown)
</PRE><P>
   Note that the procedure returns 1.35.
<P>
<P><PRE>      ?RoundToNearest(1.36, 0.75, vb_roundup)
</PRE><P>
   Note that the procedure returns 1.5, which is two increments of 0.75.
<P>
</OL>NOTE: To use the above function in the ControlSource property of a control
on a form, you will need to replace the constants vb_roundup and
vb_rounddown with their integer values.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about rounding, please see the following articles in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q97524.htm">Q97524</A></B>
   TITLE     : ACC: Round or Truncate Values to Desired Number of Decimals

   ARTICLE-ID: <B><A href="../vbapps/q111781.htm">Q111781</A></B>
   TITLE     : ACC: Rounding Errors Using Floating-Point Numbers
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: factor cents dollars quarter dime nickel<BR>
Keywords          : kbprg PgmHowTo SynFnc<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
