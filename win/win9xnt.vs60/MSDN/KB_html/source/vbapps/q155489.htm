

<HTML>
<HEAD>
<TITLE>ACC: Changing Column Headings in a Crosstab Query Using Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155489">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/08/29">
<META NAME="Keywords" CONTENT="kbusage PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article shows you how to change the column headings in a crosstab query using Visual Basic for Applications.  This article assumes that you are familiar with Visual Basic fo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBS0,QDN9,QAWH,QAMB,QAPN,QADP,QDPA,QA5F,QAMA,QABM,QA4H,QAB6,QBVU,QAG8 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Changing Column Headings in a Crosstab Query Using Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155489</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article shows you how to change the column headings in a crosstab
query using Visual Basic for Applications.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The only way you can programmatically change the column headings in a
crosstab query is to modify the PIVOT clause of the query's SQL property.
<P>
The following example shows you how to create a crosstab query in Microsoft
Access. Then it shows you how to change the query's column headings using
Visual Basic for Applications to modify the PIVOT clause of the query's SQL
property. This example uses the sample database Northwind.mdb (or NWIND.MDB
in 2.0).

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in 2.0).

<P><LI>Create a new query in Design view and add the Customers and Orders
    tables.

<P><LI>On the Query menu, click Crosstab.

<P><LI>In the query grid, add the following fields:
<P>
       Field: Country
<PRE>          Total: Group By
          Crosstab: Row Heading
          Sort: Ascending
       Field: Country Total: OrderID (or Order ID in version 2.0)
          Total: Count
          Crosstab: Row Heading
       Field: CompanyName (or Company Name in version 2.0)
          Total: Group By
          Crosstab: Column Heading
       Field: OrderID (or Order ID in version 2.0)
          Total: Count
          Crosstab: Value

</PRE><P><LI>On the Query menu, click Run. The query counts each customer's orders
    and groups them by country. Note that each customer's name appears
    as a column heading.

<P><LI>On the View menu, click SQL. Note that the PIVOT clause at the end
    of the SQL statement reads "PIVOT Customers.CompanyName;" (or "PIVOT
    Customers.[Company Name];" in version 2.0).

<P><LI>Save the query as qryOrdersByCountry, and then close it.

<P><LI>Create a module, and type the following line in the Declarations
    section if it is not already there:
<P>
      Option Explicit

<P><LI>Type the following procedure:
<P>
    In Microsoft Access 7.0 and 97
    ------------------------------
<P>
      Function ChangeColumnHeadings()
      Dim db As DATABASE
      Dim qd As QueryDef
      Dim strSQL as string
      Set db = CurrentDb()
      Set qd = db.QueryDefs("qryOrdersByCountry")
      strSQL = "TRANSFORM Count(Orders.[OrderID]) AS [CountOfOrder ID] "
      strSQL = strSQL &amp; "SELECT Customers.Country, "
      strSQL = strSQL &amp; "Count(Orders.[OrderID]) AS [Country Total] "
      strSQL = strSQL &amp; "FROM Customers INNER JOIN Orders ON "
      strSQL = strSQL &amp; "Customers.[CustomerID] = Orders.[CustomerID] "
      strSQL = strSQL &amp; "GROUP BY Customers.Country ORDER BY "
      strSQL = strSQL &amp; "Customers.Country PIVOT "
      strSQL = strSQL &amp; "IIf(Customers.[CompanyName] Like 'A*', "
      strSQL = strSQL &amp; "'A', 'B-Z');"
      qd.SQL = strSQL
      End Function
<P>
    In Microsoft Access 2.0
    -----------------------
<P>
      Function ChangeColumnHeadings()
      Dim db As DATABASE
      Dim qd As QueryDef
      Dim strSQL as string
      Set db = CurrentDb()
      Set qd = db.QueryDefs("qryOrdersByCountry")
      strSQL = "TRANSFORM Count(Orders.[Order ID]) AS [CountOfOrder ID] "
      strSQL = strSQL &amp; "SELECT Customers.Country, "
      strSQL = strSQL &amp; "Count(Orders.[Order ID]) AS [Country Total] "
      strSQL = strSQL &amp; "FROM Customers INNER JOIN Orders ON "
      strSQL = strSQL &amp; "Customers.[Customer ID] = Orders.[Customer ID] "
      strSQL = strSQL &amp; "GROUP BY Customers.Country ORDER BY "
      strSQL = strSQL &amp; "Customers.Country PIVOT "
      strSQL = strSQL &amp; "IIf(Customers.[Company Name] Like 'A*', "
      strSQL = strSQL &amp; "'A', 'B-Z');"
      qd.SQL = strSQL
      End Function

<P><LI>To test this function, type the following line in the Debug window (or
    the Immediate window in version 2.0), and then press ENTER.
<P>
      ?ChangeColumnHeadings()

<P><LI>Run the qryOrdersByCountry query. Note that there are two column
    headings. One column heading is called "A," which counts the orders
    for company names starting with letter A; one is called "B-Z," which
    counts the orders for company names starting with letters B through Z.

<P><LI>On the View menu, click SQL. Note that only the wording of the PIVOT
    clause has changed from the SQL in the original query.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the SQL property of a QueryDef object, search
the Help Index on the phrase "SQL property," and then view "SQL Property,"
or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about using the IIf() function, search the Help
Index for "IIf function," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : kbusage PgmObj
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
