

<HTML>
<HEAD>
<TITLE>ACC: Field Object Type Property Returns "Invalid Operation" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115901">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/06/06">
<META NAME="Keywords" CONTENT="kberrmsg kbprg SynRef PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you assign a variable to a property (such as Type) of a field object of an Index object, you receive the error message  Invalid Operation.  This occurs for all properties ex...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA28,QATJ,QA1S,QAW6,QDN9,QBS0,QA7O,QA7N,QAY5,QAUD,QAH4,QAMA,QBJZ,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Field Object Type Property Returns "Invalid Operation"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115901</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0, 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you assign a variable to a property (such as Type) of a field object
of an Index object, you receive the error message "Invalid Operation." This
occurs for all properties except Name and Attributes.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications" manual.
<P>
NOTE: Visual Basic for Applications (used in Microsoft Access for Windows
95, version 7.0) is called Access Basic in version 2.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
Field objects of an Index object have a subset of the normal properties.
The only valid properties are Name and Attributes, and the Attributes
property has special values. For an Index object's field object, the
Attributes property represents an ascending or descending sort order.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you need to refer to other properties of the field object, use the
TableDef field object. For example, to get the Type property you could use
<P>
<PRE>   x = tabledef.fields("myfield").properties("Type")

</PRE>instead of:
<P>
<PRE>   x = tabledef.indexes("Myindex").fields("myfield").properties("Type")

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0) and
   create a new module.

<P><LI>Enter the following line in the Declarations section of the module:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Enter the following code in the module:
<P>
<P><PRE>      Function FieldType ()
<PRE></PRE>         Dim ws As WorkSpace
         Dim db As Database
         Dim tdef As TableDef
         Dim result As String
         Dim i As Integer

         ' Set up the environment.
         Set ws = DBEngine.Workspaces(0)
         Set db = ws.Databases(0)

         ' Main routine
         Set tdef = db.tabledefs("Employees")

         ' The line below results in "Invalid Operation."
         result = tdef.indexes("PrimaryKey").fields(0).properties("Type")
         Debug.Print result

         ' Cleanup
         db.Close
         ws.Close
      End Function

</PRE><P><LI>On the View menu, click Debug Window (Or Immediate window in
   version 2.0.

<P><LI>Type the following line, and then press ENTER:
<P>
<P><PRE>      ? FieldType()
</PRE><P>
   Note the resulting error message.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Index object properties, search on "Index
object," and then "Index Object, Indexes Collection Summary" using the
Microsoft Access for Windows 95 Help Index.
<P>
For more information about the Index object properties in Access, version
2.0, search on "Index," and then "Index Object, Indexes Collection-Summary"
using the Microsoft Access Help menu.
 
<PRE>Keywords          : kberrmsg kbprg SynRef PgmObj
Version           : 2.0 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
