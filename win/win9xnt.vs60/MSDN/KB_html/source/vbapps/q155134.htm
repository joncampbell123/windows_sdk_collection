

<HTML>
<HEAD>
<TITLE>ACC: How to Format Fax Numbers to Merge with Microsoft Word </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155134">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1996/08/22">
<META NAME="Keywords" CONTENT="kbinterop ExrStrg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to format a fax number in Microsoft Access so you can merge it with a Microsoft Word document that uses Microsoft Exchange to print to a fax modem.  Th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAKC,QAVU,QBC6,QA1S,QAG8,QDME,QDN9,QDNG,QALI,QAM9,QALX,QA5V,QAH4,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Format Fax Numbers to Merge with Microsoft Word</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155134</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to format a fax number in Microsoft Access so
you can merge it with a Microsoft Word document that uses Microsoft
Exchange to print to a fax modem.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Word, you can create a merge document that uses Microsoft
Exchange to print to a fax modem. However, if the fax number is not in a
specific format, Microsoft Exchange cannot process it. When that happens,
Microsoft Exchange presents a Check Names dialog box during the merge for
each unrecognized fax number it encounters.
<P>
The fax number data must be in the following format
<P>
<PRE>   [FAX:&lt;number&gt;]

</PRE>where &lt;number&gt; is the fax number you are dialing. For example:
<P>
<PRE>   [FAX:12065551212]

</PRE>The following example uses the sample database Northwind.mdb. It
demonstrates how to create a procedure to format your fax numbers, then
uses the procedure in a Make Table query. The resulting new table
contains only records that have 7- or 10-digit fax numbers.
<P>
NOTE: During a mail merge, Microsoft Word can use dynamic data exchange
(DDE) or Open Database Connectivity (ODBC) to connect with Microsoft
Access. DDE, the most common connection type, recognizes a user-defined
procedure in a query. If you use DDE, you can make the query in this
example a Select query, and use it as the source of data for the mail
merge. However, the Microsoft Access 7.0 and 97 ODBC drivers produce an
error when using a Select Query because the drivers do not recognize the
user-defined procedure. The following example uses a Make Table query
instead of a select query in order to be compatible with both connection
methods.
<P>
<PRE>  1. Open the Northwind.mdb sample database.

  2. Create a module and type the following line in the Declarations
     section:

       Option Explicit

  3. Type the following procedure:

     NOTE: In the following sample code, an underscore (_) at the end of a
     line is used as a line-continuation character. Remove the underscore
     from the end of the line when re-creating this code.

       Function FaxNumFormat(FaxNum)

       ' If the fax number field is empty, return "Invalid Fax" and exit.
       If IsNull(FaxNum) Then
          FaxNumFormat = "Invalid Fax Number"
          Exit Function
       End If

       Dim Counter As Integer
       Dim NewString As String

       ' Strip out all characters except numbers.
       For Counter = 1 To Len(FaxNum)
          If IsNumeric(Mid(FaxNum, Counter, 1)) Then
             NewString = NewString &amp; Mid(FaxNum, Counter, 1)
          End If
       Next Counter

       ' If NewString is 10 digits long and the call is local, format the
       ' digits to the right of the area code.
       If Len(NewString) = 10 And _
          Left(NewString,3) = "&lt;YourAreaCode&gt;" Then
          NewString = Right(NewString,7)
          NewString = Format(NewString,"\[\F\A\X\:#\]")

       ' If NewString is 10 digits long, and the call is long distance, add
       ' the long distance prefix '1' to the beginning, then format
       ' accordingly.
       ElseIf Len(NewString) = 10 Then
          NewString = "1" &amp; NewString
          NewString = Format(NewString, "\[\F\A\X\:#\]")
       ' If NewString is 7 digits long, format accordingly.
       ElseIf Len(NewString) = 7 Then
          NewString = Format(NewString, "\[\F\A\X\:#\]")
       Else
          ' All other numbers are invalid.
          NewString = "Invalid Fax Number"
       End If
       FaxNumFormat = NewString

      End Function

  4. Save the module as basFaxNumber and close it.

  5. Create a new query in Design view and add the Suppliers table.

  6. In the query grid, add the following fields:

       Field: CompanyName
          Show: Yes
       Field: ContactName
          Show: Yes
       Field: FaxNbr: FaxNumFormat([Fax])
          Show: Yes
          Criteria: &lt;&gt; "Invalid Fax Number"

  7. On the Query menu, click Make Table.

  8. In the Make Table dialog box, type the name tblMergeFax and click OK.

  9. On the Query menu, click Run.

 10. When you see the prompt "Are you sure you want to create a new table
     with the selected records?" click Yes.

 11. Open the table tblMergeFax.

 12. Notice that all records in the table contain the correct fax number
     format in the FaxNbr field. For example:

       CompanyName                 ContactName     FaxNbr
       -------------------------   -------------   -----------------
       Grandma Kelly's Homestead   Regina Murphy   [FAX:13135553349]

 13. Use the table tblMergeFax to merge with Microsoft Word.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about faxing documents in Microsoft Word, please see
the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q137160.htm">Q137160</A></B>
   TITLE     : How to Fax a Document Using File Send and Exchange

   ARTICLE-ID: <B><A href="../word/q142344.htm">Q142344</A></B>
   TITLE     : Merging to Fax Unexpectedly Causes Exchange to Check Names

</PRE>For more information about merging data with Microsoft Word, search the
Help Index for "Merging data with Microsoft Word Mail Merge Wizard," or
ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : kbinterop ExrStrg
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
