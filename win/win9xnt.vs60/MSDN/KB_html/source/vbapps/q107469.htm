

<HTML>
<HEAD>
<TITLE>XL: Err Msg: Error in Procedure Causes "Cannot Find Procedure" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107469">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/11/19">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you open a workbook that contains a defined-name automatic Visual Basic procedure, you may receive the following error message:     Cannot find            , which has been assigned to run each time    [          ]          ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QAB9,QBS0,QBVP,QAUJ,QBWS,QAH4,QAKP,QARM,QDNM,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Err Msg: Error in Procedure Causes "Cannot Find Procedure"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107469</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you open a workbook that contains a defined-name
automatic Visual Basic procedure, you may receive the following error
message:
<P>
<PRE>   Cannot find &lt;procedure&gt;, which has been assigned to run each time
   [&lt;workbook&gt;]&lt;worksheet&gt; is opened. Continuing could cause errors. Cancel
   opening [&lt;workbook&gt;]&lt;worksheet&gt;?

</PRE>where &lt;procedure&gt; is the name of the Visual Basic procedure that has
been defined on a worksheet in &lt;workbook&gt; with a name that begins
with Auto_Open and &lt;worksheet&gt; is the first worksheet in &lt;workbook&gt;.
<P>
<P><h2>CAUSE</h2>
 
<P>
<P><h3>CAUSE 1</h3>
 
<P>
This error message may be caused by one of the following:

<UL><LI>The procedure that is being called cannot be located, as the error
   message states.
<P>
   -or-

<LI>Although Microsoft Excel does locate the procedure, the procedure
   contains an error, such as a syntax error.
<P>
</UL><h3>CAUSE 2</h3>
 
<P>
You can also receive the aforementioned error message if you have a defined
name "Auto_Open" (referring to Sheet1!A1 for example), without quotes, and
a macro in the workbook that is also called "Auto_Open", without quotes.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>CAUSE 1</h3>
 
<P>
If you receive this error message, and you have verified that the
procedure does exist in the location specified in the defined name,
do the following to view the error in the procedure that is causing
the incorrect error message:

<OL><P><LI>In the worksheet that the procedure is defined on, choose Macro from the
   Tools menu.

<P><LI>From the Macro Name/Reference list, select the procedure that is causing
   the error, and choose Run.
<P>
</OL>The real error message appears, making it easier for you to debug the
procedure. When you correct the problem with the macro, the "Cannot
find..." error message will no longer appear.
<P>
<P><h3>CAUSE 2</h3>
 
<P>
If you receive the above error message because you have both a defined name
called "Auto_Open", without quotes, and a macro called "Auto_Open", without
quotes, do the following:

<UL><LI>Change either your defined name or your macro name to something other
   than "Auto_Open."
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
You can create a defined name on a worksheet that refers to a Visual Basic
procedure so that it automatically runs that procedure when the worksheet
is opened, closed, activated, or deactivated. If you define a name that
begins with Auto_Open, Auto_Close, Auto_Activate, or Auto_Deactivate, and
the name refers to a Visual Basic procedure, that procedure will run when
the described action is performed on the worksheet.
<P>
If the procedure contains an error, such as a syntax error, the error
message described above will occur when the procedure is run as a defined-
name automatic procedure. The error indicates that the procedure was not
found, although the actual cause of the error may be a runtime error in the
procedure itself.
<P>
NOTE: If the same macro is run as an automatic procedure (the procedure is
given the name Auto_Open or Auto_Close) and you do not have a defined name
called "Auto_Open", without quotes, the correct error will appear. For more
information about creating automatic procedures and using defined-name
automatic procedures, see pages 266-268 in the "Visual Basic User's Guide,"
version 5.0.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 7.00<BR>
Keywords          : kbprg PgmHowTo PgmOthr<BR>
Version           : 5.00 7.00<BR>
Platform          : WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
