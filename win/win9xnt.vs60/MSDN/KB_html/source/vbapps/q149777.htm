

<HTML>
<HEAD>
<TITLE>XL: How to Play a Warning Sound If Critical Value Is Exceeded </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149777">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1996/04/10">
<META NAME="Keywords" CONTENT="PgmHowTo kbcode kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  You can use Microsoft Excel to continuously import data to a worksheet in real time by using third-party products or custom applications. For example, you can use DDE to import live data from a stock market wire service, or you can import data dire...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAHR,QAYS,QBWQ,QDL2,QAH4,QAGI,QAB4,QDL9,QBWO,QBWN,QBWP,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Play a Warning Sound If Critical Value Is Exceeded</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149777</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use Microsoft Excel to continuously import data to a worksheet in
real time by using third-party products or custom applications. For
example, you can use DDE to import live data from a stock market wire
service, or you can import data directly into Microsoft Excel from a remote
sensor or device.
<P>
In these situations, there may be times that an audible alert is desired to
notify you that a critical value has been reached or exceeded, thefore
eliminating the need for you to continuously monitor Microsoft Excel.
<P>
In Microsoft Excel, a Visual Basic for Applications macro can be used
to continuously monitor real-time or changing values in a worksheet,
compare them against a specific criteria, and then sound an audible warning
when that criteria has been met.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
In order to play a sound in a Visual Basic for Applications procedure, a
Windows API function, sndPlaySound(), can be used to play a .wav file.
<P>
This macro assumes that a sound card capable of playing .wav files is
installed. For information about how to programmatically determine if a
sound card is currently installed, see the following Knowledge Base
article:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q123974.htm">Q123974</A></B>
   TITLE     : VB 3: How to Detect If Your Computer Has a Sound Card

</PRE><P><LI>In a new Workbook, enter the following data in the appropriate cells:
<P>
<PRE>   A1: Sensor     B1: Temperature     C1: Critical Temp
   A2: 1          B2: 100             C2: 100
   A3: 2          B3: 150             C3: 125
   A4: 3          B4: 25              C4: 100
   A5: 4          B5: 85              C5: 50
   A6: 5          B6: 60              C6: 75

</PRE><P><LI>In a new module sheet, enter the following macro
<P>
<PRE>   'Declare API functions
   '32bit function for Windows NT and Windows 95
   Declare Function sndPlaySound32 Lib "winmm.dll" Alias "sndPlaySoundA"
  (ByVal lpszSoundName As String, ByVal uFlags As Long) As Long

   '16 bit function for Windows 3.x
   Declare Function sndPlaySound Lib "MMSYSTEM.DLL" (ByVal lpszSoundName As
      String, ByVal wFlags As Integer) As Integer

   Sub SoundWarning()

   'Activate the worksheet containing the data
   Worksheets("sheet1").Activate

   'Select the range of cells to watch

   Range("b2:b6").Select

   'Loop through the selected cells
   For Each x In Selection

   'check if the value of each cell in the selected range in greater than
   'the value in cell to it's right.
   If x.Value &gt; x.Offset(0, 1).Value Then

      'Call the appropriate sound API, depending on the Operating System.
         'If Windows NT or Win95 is being used
         If (Application.OperatingSystem Like "*32-bit*") Then
             Call sndPlaySound32("c:\win95\phaser.wav", 0)
             'If Excel is running on the Macintosh
             ElseIf (Application.OperatingSystem Like "*Mac*") Then
             MsgBox "This macro will not run on a Macintosh"
             'If Windows 3.x is being used
             Else
             Call sndPlaySound("c:\win95\phaser.wav", 0)
         End If
      End If
   Next x
End Sub

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Visual Basic User's Guide"
<P>
"Developing Excel 95 Solutions with Visual Basic for Applications," by Eric
Wells, Microsoft Press, 1995; Appendix C, pages 757-764
<P>
"Developing Microsoft Excel 5 Solutions," by Eric Wells, Microsoft Press,
1995; Appendix C, pages 599-601
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00<BR>
Keywords          : PgmHowTo kbcode kbhowto kbprg<BR>
Version           : 5.00 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
