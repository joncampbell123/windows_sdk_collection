

<HTML>
<HEAD>
<TITLE>XL: Macro to Automatically Save Personal.xls Without Prompt </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153893">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1996/07/22">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you edit the Personal.xls file in Microsoft Excel for Windows (or the Personal Macro Workbook in Microsoft Excel for the Macintosh), you are asked to save changes to it when you exit Microsoft Excel.  This article describes how to create a mac...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAH4,QAUR,QBWS,QAU7,QBS0,QANE,QAGB,QDNM,QDL9,QBWQ,QBWO,QBWN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Macro to Automatically Save Personal.xls Without Prompt</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153893</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you edit the Personal.xls file in Microsoft Excel for Windows (or the
Personal Macro Workbook in Microsoft Excel for the Macintosh), you are
asked to save changes to it when you exit Microsoft Excel.
<P>
This article describes how to create a macro that will prevent the message
from appearing and that will save the changes automatically when you close
the file.
<P>
For information on the purpose and location of this file, see the
"Background" section at the end of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>Use one of the following methods to automatically save the macro file when
you quit Microsoft Excel:
<P>
<P><h3>Microsoft Excel 97 for Windows</h3>
 

<OL><P><LI>On the Window menu, click Unhide.

<P><LI>In the "unhide workbook" list, click Personal.xls, and click OK.

<P><LI>On the Tools menu, point to Macro, and click Visual Basic Editor.
<P>
   The Visual Basic Editor appears.

<P><LI>In the Project pane, click the plus sign next to "VBAProject
   (PERSONAL.XLS)". Then, click the plus sign next to "Modules."
   Double-click one of the modules listed as part of PERSONAL.XLS.

<P><LI>In the Code pane, type the following code:
<P>
<PRE>      Sub Auto_Close()
         ThisWorkbook.Save
      End Sub

</PRE><P><LI>On the File menu, click "Close And Return To Microsoft Excel."

<P><LI>On the Window menu, click Hide.

<P><LI>On the File menu, click Exit to quit Microsoft Excel.
<P>
</OL>You should not be prompted to save the Personal.xls file when you quit
Microsoft Excel.
<P>
<P><h3>Microsoft Excel 5.0 and 7.0 for Windows</h3>
 

<OL><P><LI>On the Window menu, click Unhide.
<P>
   If you have a Personal.xls file, it is listed in the Unhide
   dialog box.

<P><LI>Click Personal.xls and click Unhide.

<P><LI>On the Insert menu, click Macro, and then click Module.

<P><LI>Type the following macro code into the module sheet:
<P>
<PRE>      Sub Auto_Close()
         ThisWorkbook.Save  'Saves the workbook the macro is in.
      End Sub

</PRE><P><LI>On the File menu, click Save.

<P><LI>On the Window menu, click Hide.

<P><LI>On the File menu, click Exit.
<P>
</OL>When you quit Microsoft Excel, you are not prompted to save changes to the
Personal.xls file. Instead, the changes are saved automatically.
<P>
<P><h3>Microsoft Excel 5.0 for the Macintosh</h3>
 

<OL><P><LI>On the Window menu, click Unhide.
<P>
   If you have a Personal Macro Workbook, it is listed in the Unhide
   dialog box.

<P><LI>Click Personal Macro Workbook and then click Unhide.

<P><LI>On the Insert menu, click Macro, and then click Module.

<P><LI>Type the following macro code into the module sheet:
<P>
<PRE>      Sub Auto_Close()
         ThisWorkbook.Save  'Saves the workbook the macro is in.
      End Sub

</PRE><P><LI>On the File menu click Save.

<P><LI>On the Window menu, click Hide.

<P><LI>On the File menu, click Quit.
<P>
</OL>When you quit Microsoft Excel, you are not prompted to save changes to the
Personal Macro Workbook file. Instead, the changes are saved automatically.
<P>
<P><h2>BACKGROUND</h2>
 
<P>
The Personal.xls file in Microsoft Excel for Windows and the Personal Macro
Workbook in Microsoft Excel for the Macintosh are used to store custom
macros.
<P>
In Microsoft Excel for Windows, the Personal.xls file normally resides in
the \Excel\Xlstart folder. In Microsoft Excel for the Macintosh, the
Personal Macro Workbook normally resides in the "System Folder:Preferences:
Excel Startup Folder(5)" folder.
<P>
When you open Microsoft Excel, the Personal macro Workbook opens
automatically but is hidden. If you record a new macro and specify that the
macro be recorded into the Personal.xls or Personal Macro Workbook, or if
you edit it in any way, you will be prompted to save it when you quit
Microsoft Excel. Simply unhiding workbook and then rehiding it counts as a
change, and you will be prompted to save changes when you quit Microsoft
Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Visual Basic Programmer's Guide," pages 205-210
<P>
"Visual Basic User's Guide," version 5.0, Chapter 13, Creating Automatic
Procedures and Add-in Applications
<P>
For more information about Auto_Close macros, click the Index tab in
Microsoft Excel Help, and type the following text:
<P>
<PRE>   auto_close
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a 97 8.00 xl97<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS:5.0,5.0c.7.0,7.0a,97; MACINTOSH:5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
