

<HTML>
<HEAD>
<TITLE>ACC: Sample Function to Fill a ListView Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155178">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/08/22">
<META NAME="Keywords" CONTENT="IntpCstm kbprg PgmHowTo FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes a method to fill a ListView control on a form with the contents of a table or query.  This article assumes that you are familiar with Visual Basic for...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QA1S,QAPN,QBXS,QBCF,QAHV,QDN9,QAY5,QAB4,QBS0,QBJZ,QADK P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sample Function to Fill a ListView Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155178</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes a method to fill a ListView control on a form with
the contents of a table or query.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ListView control is one of the ActiveX controls (or Custom Controls in
Microsoft Access 7.0) included with the Microsoft Office 97 Developer
Edition and the Microsoft Access Developer's Toolkit for Windows 95. It
displays a list of objects in one of four different views. You can
arrange items into columns with or without column headings as well as
display accompanying icons with text. If you want to use the ListView
control, you must fill it with data programmatically.
<P>
The following example uses the Employees table in the sample database
Northwind.mdb. The sample function FillList() populates a ListView control
with data and displays it in one of its four different views, the Report
view.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new form not based on any table or query. Save it as
   frmListView and open it in Design view.

<P><LI>On the Insert menu, click ActiveX Control (or Custom Control in version
   7.0). Click Microsoft ListView Control in the list of controls, and then
   click OK.

<P><LI>On the View menu, click Properties. Set the following properties of the
   ListView control:
<P>
<P><PRE>      Name: ctlListView
      Width: 5"
      Height: 2"
</PRE>
<P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function FillList(Domain As String, LV As Object) As Boolean
      '==================================================================
<PRE></PRE>      '  Purpose:   to fill a ListView control with data from a table or
      '             query
      '  Arguments: a Domain which is the name of the table or query, and
      '             a ListView control object
      '  Returns:   A Boolean value to indicate if the function was
      '             successful
      '==================================================================

      Dim db As DATABASE, rs As Recordset
      Dim intTotCount As Integer
      Dim intCount1 As Integer, intCount2 As Integer
      Dim colNew As ColumnHeader, NewLine As ListItem

      On Error GoTo Err_Man

      ' Clear the ListView control.
      LV.ListItems.Clear
      LV.ColumnHeaders.Clear

      ' Set Variables.
      Set db = CurrentDb
      Set Rs = db.OpenRecordset(Domain)

      ' Set Column Headers.
      For intCount1 = 0 To Rs.Fields.Count - 1
         Set colNew = LV.ColumnHeaders.Add(, , Rs(intCount1).Name)
      Next intCount1
      LV.View = 3    ' Set View property to 'Report'.

      ' Set Total Records Counter.
      Rs.MoveLast
      intTotCount = Rs.RecordCount
      Rs.MoveFirst

      ' Loop through recordset and add Items to the control.
      For intCount1 = 1 To intTotCount
         If IsNumeric(Rs(0).Value) Then
            Set NewLine = LV.ListItems.Add(, , Str(Rs(0).Value))
         Else
            Set NewLine = LV.ListItems.Add(, , Rs(0).Value)
         End If
         For IntCount2 = 1 To Rs.Fields.Count - 1
            NewLine.SubItems(intCount2) = Rs(intCount2).Value
         Next intCount2
         Rs.MoveNext
      Next intCount1

      Exit Function

      Err_Man:
         ' Ignore Error 94 which indicates you passed a NULL value.
         If Err = 94 Then
            Resume Next
         Else
         ' Otherwise display the error message.
            MsgBox "Error: " &amp; Err.Number &amp; Chr(13) &amp; _
               Chr(10) &amp; Err.Description
         End If

      End Function

   NOTE: If you try to compile this function before you insert the ListView
   control into your form, you receive the following error:

      User-defined type not defined

</PRE><P><LI>Set the OnLoad property of the frmListView form to the following event
   procedure:
<P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>         Dim intResult as Integer
         intResult = FillList("Employees",Me!ctlListView)
      End Sub

</PRE><P><LI>Open the form in Form view. Note that the ListView control displays the
   contents of the Employees table.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the ListView control and its properties and
methods, search the Help Index for "ListView control."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: adt<BR>
Keywords          : IntpCstm kbprg PgmHowTo FmsHowTo<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
