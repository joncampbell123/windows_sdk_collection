

<HTML>
<HEAD>
<TITLE>XL: How to Use the TabStrip Control in a UserForm </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155009">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1996/08/20">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article explains how to use the TabStrip control in a UserForm and provides a Microsoft Visual Basic for Applications example.  MORE INFORMATION  Microsoft provides programming examples for illustration only, without warranty either expressed ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAMN,QAOE,QA7O,QA2Q,QBWS,QAPN,QAG9,QARP,QAG2,QBS0,QBJZ,QDKR,QAUJ,QAHV P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Use the TabStrip Control in a UserForm</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155009</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition 
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to use the TabStrip control in a UserForm and
provides a Microsoft Visual Basic for Applications example.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>Use a TabStrip control to view different sets of information for related
controls. A TabStrip is recommended if you use a single layout for your
data. For example, use different tabs in a TabStrip control to display
different "views" for one group of controls.
<P>
The TabStrip is implemented as a container of a Tabs collection, which in
turn contains a group of Tab objects. By default, the control contains two
Tab objects; you can add or remove Tab objects as needed.
<P>
The client region of a TabStrip control is not a separate form. Instead,
the region is a portion of the form that contains the TabStrip control.
<P>
The border of a TabStrip control defines a region of the form that you can
associate with tabs. When you place a control in the client region of a
TabStrip, you are adding a control to the form that contains the TabStrip.
<P>
<P><h3>Adding a TabStrip Control to a UserForm</h3>
 
<P>
To add a TabStrip control to a UserForm in the Visual Basic Editor, follow 
these steps:

<OL><P><LI>Click the UserForm to activate it.

<P><LI>On the View menu, click Toolbox to display the toolbox.

<P><LI>Click the TabStrip control button.

<P><LI>Draw the TabStrip control on the form.
<P>
</OL><h3>Working with Existing Tabs in a TabStrip Control</h3>
 
<P>
To select an individual tab in a TabStrip control, follow these steps:

<OL><P><LI>Select the TabStrip control.

<P><LI>Press the SHIFT key and click the tab that you want to select.
<P>
</OL>After you select a tab, you can change the tab properties, delete the
tab, add new tabs, or move tabs by right-clicking the selected tab and
clicking the appropriate command on the shortcut menu.
<P>
<P><h3>Controlling a TabStrip Programmatically</h3>
 
<P>
Use the SelectedItem property of the TabStrip control to indicate which
Tab object is selected in the TabStrip control at run time. For example, if
you create a TabStrip control named TabStrip1, you can use the following
statement to display the caption of the selected Tab:
<P>
<PRE>   MsgBox TabStrip1.SelectedItem.Caption

</PRE></OL>The SelectedItem property is read-only and cannot be set at run time. If
you need to programmatically set which tab is selected, set the Value
property for the TabStrip control. The following example selects the third
tab on a TabStrip named TabStrip1:
<P>
<PRE>   TabStrip1.Value=2

</PRE>NOTE: The values of tabs in a TabStrip control start with zero. If the
TabStrip control contains three tabs, their values are 0, 1, and 2.
<P>
<P><h3>Example</h3>
 
<P>
The following example describes how you can create a simple UserForm that
implements a TabStrip control.
<P>
<PRE>  1. In a new workbook in Microsoft Excel, point to Macro on the Tools
     menu, and then click Visual Basic Editor.

  2. On the Insert menu, click UserForm. Press F4 to activate the 
     Properties window for the form. Next to the Name property of the form, 
     type "frmMain" (without the quotation marks), and type "Choose a 
     Color" (without the quotation marks) next to the Caption property.

  3. Select the form. Click the TabStrip control on the Toolbox window and
     draw a TabStrip control on the form. With the TabStrip control
     selected, press F4 to activate the Properties window. Type "tbsColor"
     (without the quotation marks) next to the Name property.

  4. To select the first tab in the TabStrip control, press the SHIFT key
     and click Tab1. Right-click Tab1, and click Rename on the shortcut
     menu. Type "Red" (without the quotation marks) in the Caption box, and
     then click OK.

  5. Click Tab2 to select it. Right-click Tab2, and click Rename on the
     shortcut menu. Type "Green" (without the quotation marks) in the 
     Caption box, and then click OK.

  6. With the second tab still selected, right-click Green, and click New
     Page on the shortcut menu.

     The Visual Basic Editor inserts a third Tab.

  7. Right-click Tab3, and click Rename on the shortcut menu. Type
     "Blue" (without the quotation marks) in the Caption box, and then 
     click OK.

  8. Click Red and cancel the selection of the Tab control by clicking on 
     the TabStrip container.

  9. Add the following controls to the TabStrip container with the listed
     property setting:

      Control Type          Property                Value
      ----------------------------------------------------------

      Image                 Name                    imgColor
                            BackColor               &amp;H000000FF&amp;

      CommandButton         Name                    cmdOK
                            Caption                 OK

      CommandButton         Name                    cmdCancel
                            Caption                 Cancel

 10. Press F7 to view the Code window for the form.

 11. Type the following event procedures for the form in the Code
     window:

        Private Sub tbsColor_Change()

        ' This procedure runs when the TabStrip control named tbsColor
        ' changes. This procedure will change the color of the image 
        ' control based on which tab the user selects.

           Dim i As Integer

           i = tbsColor.SelectedItem.Index

           Select Case i
              Case 0      
                 ' First tab selected, change color of image to red.
                 imgColor.BackColor = RGB(255, 0, 0)

              Case 1      
                 ' Second tab selected, change color of image to green.
                 imgColor.BackColor = RGB(0, 255, 0)

              Case 2      
                 ' Third tab selected, change color of image to blue.
                 imgColor.BackColor = RGB(0, 0, 255)
           End Select

        End Sub

        Private Sub cmdCancel_Click()

        ' This procedure will run when the command button cmdCancel is
        ' clicked. This procedure unloads the form.

           Unload Me

        End Sub

        Private Sub cmdOK_Click()

        ' This procedure will run when the command button cmdOK is clicked.
        ' This procedure displays a message indicating which tab is
        ' selected and then unloads the form.

           MsgBox "You selected " &amp; tbsColor.SelectedItem.Caption
           Unload Me

        End Sub

 12. On the Insert menu, click Module.

 13. Type the following procedure in the Code window of the new module:

        Public Sub ShowForm()
        ' This procedure displays the form named frmMain.

           frmMain.Show

        End Sub

 14. With the insertion point in the procedure ShowForm, press F5 to run
     the macro.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the TabStrip control, follow these steps:

<OL><P><LI>Create a TabStrip control on a form.

<P><LI>Select the TabStrip control and press F1.
<P>
   The "TabStrip Control" topic in the "Microsoft Forms Reference" Help
   file appears.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dialog tabbed XL97 XL98 deselect <BR>
Keywords          : kbcode kbprg<BR>
Version           : WINDOWS:97; MACINTOSH:98<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
