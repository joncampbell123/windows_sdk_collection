

<HTML>
<HEAD>
<TITLE>ACC97: IsMissing() Returns False for Non-Variant Data Types </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162534">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/01/23">
<META NAME="Keywords" CONTENT="kbenv kbprg PgmHowTo SynFnc">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you pass Optional arguments that are of a data type other than Variant to a Visual Basic for Applications function, the IsMissing() function returns a value of False fo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAHT,QAMS,QAPN,QAHE,QAY5,QAB9,QBS0,QATX,QBV8,QAVX,QA1S,QBVV,QALW,QDN9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: IsMissing() Returns False for Non-Variant Data Types</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162534</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you pass Optional arguments that are of a data type other than
Variant to a Visual Basic for Applications function, the IsMissing()
function returns a value of False for those Optional arguments.
<P>
This is perceived as a problem because IsMissing() will return False for
any non-Variant data type regardless of whether an Optional argument is
passed or not.
<P>
<P><h2>CAUSE</h2>
 
<P>
The IsMissing() function is used to detect whether or not Optional Variant
arguments have been provided in calling a procedure. It will always return
False for non-Variant data types.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
Initialize your Optional non-Variant variables with a default value when
defining the function. The following is an example declaration of a
function, including the initialization of an Optional string argument with
a default value of "Empty String":
<P>
<PRE>   Public Function Test(Optional str1 As String = "Empty String", _
                    Optional var2 As Variant)

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Optional arguments are used in procedures to indicate that an argument is
not required. Although the IsMissing() function always returns False for
non-variant data types, it is important to learn what values are returned
if the Optional argument is not specified when calling the procedure. The
following list summarizes what values are returned if an Optional argument
is not specified or an Optional argument is not initialized with a default
value:
<P>
<PRE>   Data Type           Value returned by Default
   ---------           ---------------------------------
   String              "" (returns a zero length string)
   Variant             Error 448
   Integer             0
   Single              0
   Long                0
   Double              0
   Currency            0
   Date                12:00:00 AM
   Byte                0
   Boolean             False
   Object              (Run-time error 91: "Object variable or With block
                       variable not set")

</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example demonstrates what the IsMissing() function will
return, given an optional String and optional Variant arguments. In order
to assure the optional String argument won't return a zero-length string,
you will want to replace the function definition with the one noted in the
"Resolution" section of this article:

<OL><P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Public Function Test1(Optional str1 as String, _
<PRE></PRE>                          Optional var2 as Variant)
         Debug.Print "IsMissing(str1) = " &amp; IsMissing(str1)
         Debug.Print "IsMissing(var2) = " &amp; IsMissing(var2)
         Debug.Print str1
         Debug.Print var2

      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       ?Test1()
</PRE><P>
   Note that the following information is returned:
<P>
<P><PRE>       IsMissing(str1) = False
       IsMissing(var2) = True
</PRE><P>
<P><PRE>       Error 448
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using optional arguments in procedures, search
the Help Index for "Optional Keyword."
<P>
For more information about understanding optional arguments, search the
Help Index for "Optional arguments, Understanding Named Arguments and
Optional Arguments."
<P>
For more information about using the IsMissing() function, search the Help
Index for "IsMissing Function."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: type cast form report object ParamArray null<BR>
Keywords          : kbenv kbprg PgmHowTo SynFnc<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
