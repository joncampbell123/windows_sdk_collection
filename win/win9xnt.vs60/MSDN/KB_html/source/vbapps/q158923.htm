

<HTML>
<HEAD>
<TITLE>ACC95: TransferDatabase/CopyObject in Runtime May Corrupt Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158923">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/11/07">
<META NAME="Keywords" CONTENT="kbprg MdlOthr IsmIea">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you use the /Runtime command-line option to open a database that uses TransferDatabase or CopyObject to import or export a Microsoft Access object, objects in the target datab...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA1S,QDN9,QBWS,QAZV,QAPN,QDKY,QBJZ,QA01,QAW6,QA3P,QAUR,QAFY,QAKP,QDKH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: TransferDatabase/CopyObject in Runtime May Corrupt Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158923</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you use the /Runtime command-line option to open a database that uses
TransferDatabase or CopyObject to import or export a Microsoft Access
object, objects in the target database may become corrupted.
<P>
This applies to the TransferDatabase and CopyObject methods of the DoCmd
object, as well as to the TransferDatabase and CopyObject macro actions.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
7.0. This problem no longer occurs in Microsoft Access 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This problem only occurs when you are importing or exporting an object that
contains a Visual Basic code module: Forms, Reports, or Modules. If you use
TransferDatabase or CopyObject to import or export Tables, Queries or
Macros the problem does not occur.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Access and create a new database called Db1.mdb.

<P><LI>Create a new, blank report, and save it as Report1.

<P><LI>Create another new database called Db2.mdb.

<P><LI>Create a module called Module1, and type the following procedure:
<P>
   NOTE: In the following procedure, replace "C:\My Documents\Db1.mdb"
   with the correct path to the database you created in step 1.
<P>
<P><PRE>      Function TestTransfer()
<PRE></PRE>         DoCmd.TransferDatabase acImport, "Microsoft Access", _
            "C:\My Documents\Db1.mdb", acReport, "Report1", "Report1"
      End Function

</PRE><P><LI>Save the module and close it.

<P><LI>Create the following new macro called AutoExec:
<P>
<PRE>      Macro Name    Action
      --------------------------------
      AutoExec      RunCode
                    MsgBox

      AutoExec Actions
      -------------------------------
      RunCode
         Function Name: TestTransfer()
      MsgBox
         Message: Database Is Open!

</PRE><P><LI>Quit Microsoft Access, and make a backup copy of Db2.mdb.

<P><LI>Open the Db2.mdb database using the /runtime command-line switch. For
   example, create a shortcut or program icon with the following command
   line:
<P>
<P><PRE>      "C:\MSOffice\Access\MSAccess.exe" "C:\My Documents\Db2.mdb" /Runtime
</PRE>
<P><LI>When the database opens, click OK in the "Database Is Open!" message
   box, and then quit Microsoft Access.

<P><LI>Start Microsoft Access and open Db2.mdb.
<P>
<P><PRE>    NOTE: When you open the database, the AutoExec macro runs again.
    Because Report1 was already imported from Db1.mdb, it is imported this
    time as Report11.
</PRE>
<P><LI>When you see the "Database Is Open!" message box, click OK, and then
<P><PRE>    try to open Module1 in Design view. Note that you receive an empty
    warning box, and when you click OK, no code module is visible. The same
    thing happens if you open Report1 in Design view, and then click Code
    on the View menu.
</PRE>
<P><LI>Open Report11 in Design view and click Code on the View menu. Because
<P><PRE>    this report was created when the database was opened without the
    /Runtime switch, the code module opens without any problems.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about TransferDatabase, search the Help Index for
"TransferDatabase."
<P>
For more information about CopyObject, search the Help Index for
"CopyObject."
 
<PRE>Keywords          : kbprg MdlOthr IsmIea
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
