

<HTML>
<HEAD>
<TITLE>XL97: How to Record a Macro Using Relative Cell References </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161677">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/02">
<META NAME="Keywords" CONTENT="kbcode kbprg kbui xlvbahowto xlvbainfo xlui">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, unlike in earlier versions of Microsoft Excel, there is no menu command to record a macro that uses relative cell references. However, you can click Relative Reference on the Stop Recording toolbar.  MORE INFORMATION  Microso...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAH4,QBJZ,QBVP,QBDA,QBWS,QBQU,QAGB,QAVX,QDNZ,QAVW,QA50,QAB3,QAF0,QBS0 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: How to Record a Macro Using Relative Cell References</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161677</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel 97, unlike in earlier versions of Microsoft Excel, there
is no menu command to record a macro that uses relative cell references.
However, you can click Relative Reference on the Stop Recording toolbar.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>To record a macro that uses relative cell references, click Relative 
Reference on the Stop Recording toolbar. Clicking Relative Reference a 
second time turns off relative recording.
<P>
NOTE: The ScreenTip for Relative Reference does not change to indicate
whether relative recording is already available. The only indication that
relative recording is started is the appearance of the Relative Reference
button. When the button has a sunken 3-dimensional appearance, relative
recording is started.
<P>
If the Stop Recording toolbar does not appear when you begin recording a
macro, you must display it. To display the Stop Recording toolbar, point to
Toolbars on the View menu, and then click Stop Recording. When you do this,
Microsoft Excel inserts an extra line of code in your macro. Note that when
you run the recorded macro, the Stop Recording toolbar is displayed. To
avoid this, follow these steps:

<OL><P><LI>On the Tools menu, point to Macro, and then click Macros.

<P><LI>In Macro Name list, click the name of the macro that you recorded
   and click Edit.
<P>
   This step starts the Visual Basic Editor.

<P><LI>In the Code window, type an apostrophe (') at the beginning of the
   following line of code:
<P>
<P><PRE>      Application.CommandBars("Stop Recording").Visible = True
</PRE>
<P><LI>On the File menu, click "Close and Return to Microsoft Excel."
<P>
</OL>NOTE: If you enable relative recording, Microsoft Excel does not retain the
setting for the next session of Microsoft Excel.
<P>
<P><h3>Absolute vs. Relative Recording</h3>
 
<P>
By default, recorded macros use absolute cell referencing, which means that
exact cell locations are recorded into the macro. The macro works only with
the exact cells addresses you use when you record the macro.
<P>
When you record a macro with relative cell referencing, the actions
recorded in the macro are relative to the starting cell location.
<P>
The following examples record the same action with absolute, and then
relative cell referencing.
<P>
<P><h3>Recording with Absolute Cell Referencing</h3>
 
<P>
To record a macro with absolute cell referencing, follow these steps:

<OL><P><LI>Create a new workbook in Microsoft Excel.

<P><LI>Select cell C1 on the worksheet.

<P><LI>On the Tools menu, point to Macro, and then click Record New Macro.

<P><LI>In the Macro Name box type "Absolute_Recording" (without the quotation
    marks), and then click OK.

<P><LI>On the Stop Recording toolbar, check the appearance of the Relative
    Reference button. If the Relative Reference button has a sunken
    3-dimensional appearance, click it to disable relative recording.

<P><LI>Type "test" (without the quotation marks) and click Enter (green check
    mark).

<P><LI>On the Edit menu, click Copy.

<P><LI>Select cell C3.

<P><LI>On the Edit menu, click Paste.

<P><LI>On the Stop Recording toolbar, click Stop Recording.

<P><LI>To view the contents of the macro you recorded, point to Macro on the
    Tools menu, and then click Macro. In Macro Name list, click "Absolute
    Recording" and click Edit.
<P>
    This step starts the Visual Basic Editor.
<P>
    The macro is similar to the following:
<P>
<PRE>       Sub Absolute_Recording()
       '
       ' Absolute_Recording Macro
       ' Macro recorded 12/27/96 by &lt;your username&gt;
       '
       '
           ActiveCell.FormulaR1C1 = "test"
           Selection.Copy
           Range("C3").Select
           ActiveSheet.Paste
       End Sub

    This macro enters the word "test" (without the quotation marks), in the
    active cell. Then, the macro copies and pastes the entry you typed in
    cell C3 regardless of the active cell location when you started the
    macro.

</PRE><P><LI>When you are finished viewing the macro, click "Close and Return to
    Microsoft Excel" on the File menu.
<P>
</OL><h3>Recording with Relative Cell Referencing</h3>
 
<P>
To record a macro with relative cell referencing, follow these steps:

<OL><P><LI>Create a new workbook in Microsoft Excel.

<P><LI>Select cell C1 on the worksheet.

<P><LI>On the Tools menu, point to Macro, and then click Record New Macro.

<P><LI>In the Macro Name box type "Relative_Recording" (without the quotation
    marks) and click OK.

<P><LI>On the Stop Recording toolbar, check the appearance of the Relative
    Reference button. If the Relative Reference button does not have a
    sunken 3-dimensional appearance, click it to enable relative recording.

<P><LI>Type "test" (without the quotation marks) and click Enter (green check
    mark).

<P><LI>On the Edit menu, click Copy.

<P><LI>Select cell C3.

<P><LI>On the Edit menu, click Paste.

<P><LI>On the Stop Recording toolbar, click Stop Recording.

<P><LI>To view the contents of the macro you recorded, point to Macro on
    the Tools menu and click Macro. In Macro Name list, click "Relative
    Recording" and click Edit.
<P>
    This step starts the Visual Basic Editor.
<P>
   The macro is similar to the following:
<P>
<PRE>        Sub Relative_Recording()
        '
        ' Relative_Recording Macro
        ' Macro recorded 12/27/96 by &lt;your username&gt;
        '
        '
            ActiveCell.FormulaR1C1 = "test"
            Selection.Copy
            ActiveCell.Offset(2,0).Range("A1").Select
            ActiveSheet.Paste
        End Sub

    This macro enters the word "test" (without the quotation marks) in the
    active cell. Then, the macro copies and pastes the entry you typed to a
    cell location two rows down from the active cell.

</PRE><P><LI>When you are finished viewing the macro, click "Close and Return to
    Microsoft Excel" on the File menu.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about recording macros, click Contents and Index on 
the Help menu, click the Index tab in Excel Help, type the following text
<P>
<PRE>   macros, recording

</PRE></OL>and then double-click the selected text to go to the "Record a macro"
topic. If you are unable to find the information you need, ask the Office 
Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbcode kbprg kbui xlvbahowto xlvbainfo xlui<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
