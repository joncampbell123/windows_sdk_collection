

<HTML>
<HEAD>
<TITLE>XL97: Show Pages Does Not Use Sheet.xlt for Worksheets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165238">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/03/14">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  If you use the Show Pages shortcut menu command to create separate worksheets for all the items for a page field in a PivotTable, the worksheets that are created are not based on any template files that may be on the computer.  NOTE: In Microsoft E...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QBVU,QBWS,QBVH,QAH4,QBVP,QBWA,QA7O,QA7N,QAUR,QDNM,QBS0,QAF8,QA36,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Show Pages Does Not Use Sheet.xlt for Worksheets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165238</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the Show Pages shortcut menu command to create separate
worksheets for all the items for a page field in a PivotTable, the
worksheets that are created are not based on any template files that may be
on the computer.
<P>
NOTE: In Microsoft Excel 7.0, if the template Sheet.xlt is in the Xlstart
folder, the Show Pages command uses the template as the basis for new
worksheets.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To use an existing worksheet template when you use the Show Pages menu item
to create new worksheets, create and run a macro that simulates the Show
Pages functionality. See the "More Information" section in this article for
a sample macro that simulates the command.
<P>
NOTE: There is no way to manually force the Show Pages command to create
new worksheets using an existing worksheet template.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create a sample worksheet
template, a PivotTable, and a Visual Basic for Applications macro that
simulates the Show Pages command.
<P>
<P><h3>Creating the Worksheet Template</h3>
 
<P>
To create a sample worksheet template, use the following steps:

<OL><P><LI>Close and save any open workbooks, and then create a new workbook.

<P><LI>Delete all but one worksheet in the workbook.

<P><LI>On the File menu, click Page Setup.

<P><LI>In the Page Setup dialog box, click the Header/Footer tab. In the
    Header/Footer tab, click Custom Header.

<P><LI>In the Left Section box type "this is a test" (without the quotation
    marks), and then click OK. Click OK in the Page Setup dialog box.

<P><LI>On the File menu, click Save.

<P><LI>In the Save As dialog box, click Template in the Save As Type list.

<P><LI>In the File Name box, type "Sheet" (without the quotation marks).

<P><LI>In the Save In list, locate and click the Xlstart folder to select it.
    This folder is located in the following default location:
<P>
       Program Files\Microsoft Office\Office\Xlstart

<P><LI>Click Save.

<P><LI>On the File menu, click Close.
<P>
</OL><h3>Creating the PivotTable</h3>
 
<P>
To create a sample PivotTable, use the following steps:

<OL><P><LI>Create a new workbook and then enter the following data in Sheet1:
<P>
<PRE>   A1: Name    B1: Amount   C1: Area
   A2: Bob     B2: 1        C2: e
   A3: Sue     B3: 1        C3: w
   A4: Sue     B4: 1        C4: e
   A5: Bob     B5: 1        C5: n
   A6: Tom     B6: 1        C6: e
   A7: Sue     B7: 1        C7: n
   A8: Tom     B8: 1        C8: n
   A9: Bob     B9: 1        C9: w

</PRE><P><LI>Click cell A1. Then, click PivotTable Report on the Data menu.

<P><LI>In step 1 of the PivotTable Wizard, click Next.

<P><LI>In step 2 of the PivotTable Wizard, verify that the specified range is
   $A$1:$C$9, and then click Next.

<P><LI>In step 3 of the PivotTable Wizard, drag the Name button onto the ROW
   field, drag the Amount button onto the DATA field, and then drag the
   Area button onto the PAGE field.

<P><LI>Click Finish.
<P>
</OL>A PivotTable is created in a new worksheet in the workbook.
<P>
<P><h3>Sample Visual Basic for Applications Macro</h3>
 
<P>
To create the macro that simulates the Show Pages command, use the
following steps:

<OL><P><LI>On the Tools menu, point to Macro, and then click Visual Basic Editor.
   Or, press ALT+F11.

<P><LI>On the Insert menu, click Module.

<P><LI>Enter the following code in the module:
<P>
<PRE>      Sub Show_Pages()

          Dim mysheet As String

          ' Reduce the amount of screen flickering.
          Application.ScreenUpdating = False

          ' Set the name of the worksheet with the PivotTable.
          mysheet = ActiveSheet.Name

          With Sheets(mysheet).PivotTables(1)

              ' Loop through all items in the "Area" page field.
              For Each x In .PageFields("Area").PivotItems

                  .PivotFields("Area").CurrentPage = x.Name

                  ' Insert a new worksheet using Sheet.xlt in the Xlstart
                  ' folder.
                  Sheets.Add Type:="Worksheet"
                  ActiveSheet.Name = x.Name

                  ' Activate the worksheet that contains the PivotTable.
                  Sheets(mysheet).Select

                  ' Select the PivotTable and copy it.
                  .PivotSelect "", xlDataAndLabel
                  Selection.Copy

                  ' Activate the worksheet with the name from the item
                  ' in the page field and paste the PivotTable with this
                  ' page field item displayed.
                  Sheets(x.Name).Select
                  ActiveSheet.Paste

              Next
          End With

      End Sub

</PRE><P><LI>On the File menu, click "Close and Return to Microsoft Excel."

<P><LI>Save your workbook.
<P>
</OL><h3>Running the Macro</h3>
 
<P>
To use the sample macro, use the following steps:

<OL><P><LI>Switch to the worksheet that contains the PivotTable.

<P><LI>Run the Show_Pages macro.
<P>
   For the sample PivotTable that you created, the macro creates three new
   worksheets. Each worksheet uses a name that corresponds to an item in
   the Area page field and contains a view of the PivotTable that is set to
   the corresponding page field value.

<P><LI>Switch to any of the newly created worksheets.

<P><LI>On the File menu, click Page Setup.

<P><LI>Click the Header/Footer tab in the Page Setup dialog box.
<P>
</OL>Note that the header is the same header that is specified in Sheet.xlt.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about PivotTable page fields, click the Index tab in
Microsoft Excel Help, type the following text
<P>
<PRE>   Page fields

</PRE></OL>and then double-click the selected text to go to the "Work with PivotTable
page fields" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbprg kbhowto<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
