

<HTML>
<HEAD>
<TITLE>ACC: How to Delete Items from Combo/List Box After Selection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132026">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/06/26">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo FmsCmbo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how you can remove an entry from a list box or combo box after you have selected that entry. This technique uses a parameter query to delete the se...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QA1S,QAGB,QDN9,QAPN,QAEF,QAE1,QAGC,QAFF,QBS0,QBXS,QBCT,QDKD,QACF,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Delete Items from Combo/List Box After Selection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132026</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how you can remove an entry from a list box
or combo box after you have selected that entry. This technique uses
a parameter query to delete the selected entry from the underlying
recordset and then requeries the list box to update the list. This is
useful in situations in which, once an item has been selected, that item
cannot be selected again.
<P>
This technique is not useful for large lists (more than 1000 items),
because it would take too long to requery the list.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a list box whose items are deleted from the list box list after
they have been selected, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0)
   and create the following query based on the Customers table:
<P>
<P><PRE>      Query: ListTemp
      ----------------------
      Type: Make Table Query
</PRE><P>
<P><PRE>      Field: Country
<PRE></PRE>         Table: Customers
         Total: Group By

   You can start by creating a regular select query, adding the Customers
   table, and including only the Country field. Then, on the View menu,
   click Totals. Leave the Totals row as Group By. Then, on the Query menu,
   click Make Table.

   Specify ListTemp as the Table Name in the Make Table dialog box.

</PRE><P><LI>Run the MakeListTemp query to create the ListTemp table.

<P><LI>Create the following query based on the Customers table:
<P>
<P><PRE>      Query: AppendListTemp
      ---------------------
      Type: Append Query
</PRE><P>
<P><PRE>      Field: Country
<PRE></PRE>         Table: Customers
         Total: Group By
         Sort: Ascending
         Append To: Country

   Specify ListTemp as the Table Name in the Append dialog box.

</PRE><P><LI>Create the following query based on the ListTemp table:
<P>
<P><PRE>      Query: DeleteListTemp
      ---------------------
      Type: Delete Query
</PRE><P>
<P><PRE>      Field: Country
<PRE></PRE>         Table: ListTemp
         Delete: Where

</PRE><P><LI>Create the following form not based on any table or query:
<P>
<P><PRE>      Form: Test
      -----------------------------
      Caption: TestForm
</PRE><P>
<P><PRE>      List box:
<PRE></PRE>         Name: ShrinkingList
         RowSourceType: Table/Query
         RowSource: ListTemp
         ColumnCount: 1

</PRE><P><LI>Set the Test form's OnOpen property to the following event procedure:
<P>
<PRE>         Private Sub Form_Open(Cancel As Integer)
             Dim db As DATABASE
             Dim qy As QueryDef
             Set db = CurrentDb()
             Set qy = db.QueryDefs("DeleteListTemp")
             qy.Execute
             Set qy = db.QueryDefs("AppendListTemp")
             qy.Execute
             qy.Close
         End Sub

   NOTE: In Microsoft Access version 2.0, omit the "Private" keyword. In
   that version Private is not valid for Sub procedures.

</PRE><P><LI>Set the Test form's OnLoad property to the following event procedure:
<P>
<PRE>         Private Sub Form_Load()
             Me!ShrinkingList.Requery
         End Sub

</PRE><P><LI>Set the ShrinkingList list box's AfterUpdate property to the following
   event procedure.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      Private Sub ShrinkingList_AfterUpdate ()
<PRE></PRE>         On Local Error GoTo ShrinkingList_AfterUpdate_Err

   'NOTE: In Microsoft Access version 2.0, omit the Private keyword for the
   'Sub statement and the Local keyword for the On Error sentence. In
   'version 2.0, those keywords are not valid for these statements.

         Dim db As Database, rs As Recordset, criteria As String
         Dim UserMessage As String
         Set db = CurrentDB()
         ' Create recordset based on the list box RowSource.
         Set rs = db.OpenRecordset(Me!ShrinkingList.RowSource, _
         DB_OPEN_DYNASET)
         ' Check for the existence of Null values.
         If IsNull(Me!ShrinkingList) Then
            MsgBox "Shrinking List is Null!"
            Exit Sub
         End If
         UserMessage = Me!ShrinkingList
         criteria = "[Country] = '" &amp; Me!ShrinkingList &amp; "'"
         ' Locate the record that was selected in the list box
         ' list and delete it.
         rs.FindFirst criteria
         rs.Delete
         ' Refresh the List Box's RowSource property entries.
         Me!ShrinkingList.Requery
         ' Set the contents of the List Box to blank.
         Me!ShrinkingList = Null
         ' Prompt user.
         MsgBox "The Item " &amp; UserMessage &amp; " has been deleted!"
         Exit Sub

      ShrinkingList_AfterUpdate_Err:
          MsgBox Error$
          Exit Sub
      End Sub

      NOTE: The FindFirst criteria can be based on any column of the
      list box. If the list box column is not the column set in the
      BoundColumn property, change the criteria's list box reference to
      ShrinkingList.Column(n), where (n) is the column's zero-based ordinal
      position in the RowSource property field list.

</PRE><P><LI>Save the Test form and view it in Form view. Click any element
   in the list box to delete it. Note that a message appears that states
   that the item you selected was deleted.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about list box properties, search the Help Index for
"List Boxes, properties," or "List box: properties" or ask the Microsoft
Access 97 Office Assistant.
 
<PRE>Keywords          : kbprg PgmHowTo FmsCmbo
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
