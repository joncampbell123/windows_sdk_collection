

<HTML>
<HEAD>
<TITLE>ACC97: Example Using Animation ActiveX Control in MS Access 97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163440">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/02/10">
<META NAME="Keywords" CONTENT="IntpCstm kbprg kbusage PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article shows two different examples of using the Animation Control in a Microsoft Access 97 database. The Animation ActiveX Control ships with Microsoft Office 97 Developer...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QDM6,QAHV,QA1S,QDN9,QAYA,QBWS,QAPN,QBJZ,QAB9,QA01,QAB4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Example Using Animation ActiveX Control in MS Access 97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163440</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article shows two different examples of using the Animation Control
in a Microsoft Access 97 database. The Animation ActiveX Control ships
with Microsoft Office 97 Developer Edition Tools.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Animation ActiveX Control enables you to play .avi files on a Microsoft
Access 97 form. When you open the form in Design view, you can see the
control; in Form view, however, the control is hidden until you play the
.avi file associated with the control. One common use for the Animation
control is to provide animation with command buttons. If you place the
animation control on top of a command button and use the Click event of
the button to invoke the Open and Play methods of the animation control,
the button appears to be animated.
<P>
The Animation ActiveX Control supports only two types of .avi files:
uncompressed .avi files, and .avi files that have been compressed using
Run-Length Encoding (RLE). In addition, the .avi file cannot contain any
audio components.
<P>
If you use an unsupported file format with the animation control, you
receive the error message "Unable to Open AVI File." For more information
about this error message, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q162978.htm">Q162978</A></B>
   TITLE     : ACC97: "Unable to Open AVI File" Error Using Animation
               Control

</PRE><h3>Example 1: Using the Animation Control to Animate a Command Button</h3>
 

<OL><P><LI>Copy Firework.avi from the \Clipart\Mmedia folder on your Microsoft
   Office 97 Professional Edition compact disc to your computer hard
   drive.

<P><LI>Start Microsoft Access and create a new blank database called
   Animate.mdb.

<P><LI>Create a new form not based on any table or query in Design view.

<P><LI>Add a command button to the form, and set the following properties:
<P>
<P><PRE>      Command button
      --------------
      Name: cmd1
      Caption: Play Animation
      Left: 1"
      Top: .5"
      Width: 1"
      Height: 1"
      OnClick: [Event Procedure]
</PRE>
<P><LI>Type the following code in the command button's OnClick event
   procedure:
<P>
<P><PRE>      Private Sub cmd1_Click()
<PRE></PRE>         With An1
            .Visible = True
            .AutoPlay = True
            ' Type the full path to Firework.avi on the following line.
            .Open "Firework.avi"
         End With
      End Sub

</PRE><P><LI>On the Insert menu, click ActiveX Control.

<P><LI>In the Insert ActiveX Control dialog box, select Microsoft Animation
   Control, version 5.0, and then click OK.

<P><LI>Set the following properties for the animation control:
<P>
<P><PRE>      Animation control
      -----------------
      Name: an1
      Visible: No
      Left: 1"
      Top: .5"
      Width: 1"
      Height: 1"
</PRE>
<P><LI>Save the form as frmAnimate, and then switch to Form view.

<P><LI>Click the Command button and note that the Firework.avi file plays.
<P>
</OL><h3>Example 2: Selecting and Playing an Animation File</h3>
 

<OL><P><LI>Perform steps 1-3 in Example 1.

<P><LI>Add a command button to the form, and set the following properties:
<P>
<P><PRE>      Command button
      --------------
      Name: cmd2
      Caption: Select &amp;&amp; Play
      OnClick: [Event Procedure]
</PRE>
<P><LI>Type the following code in the command button's OnClick event
   procedure:
<P>
<P><PRE>      Private Sub cmd2_Click()
<PRE></PRE>         With cd2
            .Filter = "avi (*.avi)|*.avi"
            .ShowOpen
         End With
         With an2
            .AutoPlay = True
            .Open cd2.FileName
         End With
      End Sub

</PRE><P><LI>On the Insert menu, click ActiveX Control.

<P><LI>In the Insert ActiveX Control dialog box, select Microsoft Animation
   Control, version 5.0, and then click OK.

<P><LI>Set the Name property of the animation control to an2.

<P><LI>On the Insert menu, click ActiveX Control.

<P><LI>In the Insert ActiveX Control dialog box, select Microsoft Common
   Dialog Control, version 5.0, and then click OK.

<P><LI>Set the Name property of the common dialog control to cd2.

<P><LI>Save the form as frmSelectPlay, and then switch to Form view.

<P><LI>Click the command button. Note that an Open dialog box appears and
<P><PRE>    enables you to select the Firework.avi file, and then the .avi plays on
    the form.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Animation ActiveX Control, search the Help
Index for "Animation control."
<P>
For more information about Common Dialog ActiveX Control, search the Help
Index for "CommonDialog control."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OLE custom<BR>
Keywords          : IntpCstm kbprg kbusage PgmHowTo<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
