

<HTML>
<HEAD>
<TITLE>ACC95: Using MS Word's FileClose/DocClose Statements in OLE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156226">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/09/19">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop kbole IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The WordBasic FileClose and DocClose statements unexpectedly close Microsoft Word when used through OLE automation.  This article assumes that you are familiar with Visual B...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAPN,QAVX,QA1S,QAVW,QAB9,QA9Q,QDN9,QA2K,QA5F,QAW6,QBFY,QAH4,QBS0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Using MS Word's FileClose/DocClose Statements in OLE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156226</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The WordBasic FileClose and DocClose statements unexpectedly close
Microsoft Word when used through OLE automation.
<P>
This article assumes that you are familiar with Visual Basic for
Applications, Word Basic and with creating Microsoft Access applications
using the programming tools provided with Microsoft Access. For more
information about Visual Basic for Applications, please refer to the
"Building Applications with Microsoft Access for Windows 95" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The FileClose and DocClose statements close Microsoft Word unexpectedly if
the following conditions are true:

<UL><LI>Microsoft Word is started through OLE automation. In other words,
   Microsoft Word is not previously running when the OLE Automation
   session begins.

<LI>The FileClose or DocClose statement is used via OLE Automation from
   any OLE Automation client.

<LI>Microsoft Word is not visible during the operation.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Use either of the following two methods to work around this behavior.
<P>
<P><h3>Method 1: Make Microsoft Word Visible Before the FileClose Statement</h3>
 
<P>
This method uses the AppShow statement to make Microsoft Word visible
before using the FileClose/DocClose statement. The AppShow statement is a
Microsoft WordBasic statement that can be issued through OLE automation to
make Microsoft Word visible.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub WordTest()
      Dim objWordBasic As Object
      Set objWordBasic = CreateObject("Word.Basic")
      objWordBasic.AppShow
      objWordBasic.FileNewDefault
      objWordBasic.INSERT "This is test 1"
      objWordBasic.FileSaveAs "C:\Testword.doc", 0
      objWordBasic.FileClose 1
      objWordBasic.FileNewDefault
      objWordBasic.INSERT "This is test 2"
      objWordBasic.FileSaveAs "C:\Testword.doc", 0
      objWordBasic.FileClose 1
      End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       WordTest
</PRE><P>
   Note that Microsoft Word correctly saves the document to your C:\
   folder.
<P>
</OL><h3>Method 2: Create the Word Object Based on the Word.Document Class</h3>
 
<P>
This method uses two OLE automation objects. The first object is created
using the Word.Document class. The second object is created off the
Application.WordBasic class that is derived from the first object.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub WordTest()
      Dim objWordDoc As Object
      Dim objWordBasic As Object
      Set objWordDoc = CreateObject("Word.Document")
      Set objWordBasic = objWordDoc.Application.WordBasic
      objWordBasic.FileNewDefault
      objWordBasic.INSERT "This is test 1"
      objWordBasic.FileSaveAs "C:\Testword.doc", 0
      objWordBasic.FileClose 1
      objWordBasic.FileNewDefault
      objWordBasic.INSERT "This is test 2"
      objWordBasic.FileSaveAs "C:\Testword.doc", 0
      objWordBasic.FileClose 1
      End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       WordTest
</PRE><P>
   Note that Microsoft Word correctly saves the document to your C:\
   folder.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Microsoft WordBasic uses the FileClose statement to close the currently
active document and all associated document windows, and uses the DocClose
statement to close only the currently active document window in Microsoft
Word. When either of these statements is issued from an OLE Automation
controlling application, such as Microsoft Access or Microsoft Excel,
Microsoft Word is closed unexpectedly.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub WordTest()
      Dim objWordBasic As Object
      Set objWordBasic = CreateObject("Word.Basic")
      objWordBasic.FileNewDefault
      objWordBasic.INSERT "This is test 1"
      objWordBasic.FileSaveAs "C:\Testword.doc", 0
      objWordBasic.FileClose 1
      objWordBasic.FileNewDefault
      objWordBasic.INSERT "This is test 2"
      objWordBasic.FileSaveAs "C:\Testword.doc", 0
      objWordBasic.FileClose 1
      End Sub

   NOTE: The code in this procedure uses the FileClose statement to
   demonstrate the behavior. To reproduce the behavior using the DocClose
   statement, simply substitute all occurrences of FileClose with
   DocClose.

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       WordTest
</PRE><P>
   Note that when the code attempts to create the second new document, you
   receive the error:
<P>
<P><PRE>      Run-time error -2147418094 (80010012): OLE Automation Error
</PRE><P>
   This is because Microsoft Word has been unexpectedly closed by either
   the FileClose or DocClose statement.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the FileClose and DocClose statements, search
for "FileClose statement" and "DocClose statement" using the Microsoft Word
for Windows 95 Help Index.
<P>
For more information about creating objects with OLE Automation, search on
the phrase "Create an object with OLE Automation," and then
"CreateObject Function" or "Using Microsoft Access as an OLE Automation
Controller" using the Microsoft Access for Windows 95 Answer Wizard.
<P>
Microsoft Access, "Building Applications with Microsoft Access for Windows
95," version 7.0, Chapter 11, "Communicating with Other Applications,"
pages 262-290.
<P>
 
<PRE>Keywords          : AutoGnrl kbinterop kbole IntpOleA
Technology        : kbole
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
