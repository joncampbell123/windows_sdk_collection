

<HTML>
<HEAD>
<TITLE>ACC: Set the RowSource Property of a Report Graph Dynamically </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158927">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/11/07">
<META NAME="Keywords" CONTENT="AutoGrph kbinterop kbprg PgmHowTo IntpGrph">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article discusses how to set the RowSource property of a graph object in a Microsoft Access report programmatically.  MORE INFORMATION  If you try to set the RowSource prope...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QBWS,QDN9,QA5V,QA01,QAH4,QBRM,QBXS,QAH8,QAQG,QDNX,QAUR,QABH,QADK P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Set the RowSource Property of a Report Graph Dynamically</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158927</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article discusses how to set the RowSource property of a graph object
in a Microsoft Access report programmatically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you try to set the RowSource property of a graph object on a report in
Print Preview, you may receive the following error message.
<P>
<P><h3>Microsoft Access 7.0 and 97</h3>
 
<P>
<PRE>   You can't set the Row Source property after printing has started.

</PRE><h3>Microsoft Access 2.0</h3>
 
<P>
<PRE>   Can't set property 'Row Source' after printing has started.

</PRE>You must open the report in Design view first, set the RowSource property
of the graph object, and then print or view the report. In the following
example, you create a macro to open a report in Design view, set the
RowSource property of a graph, and then display the report in Print
Preview. Then the macro is attached to a command button on a form to
dynamically change the contents of the graph based on the current record on
the form.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in Microsoft Access 2.0). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.
<P>
<P><h3>Creating the Graph Report</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in 2.0).

<P><LI>Create a new report not based on any table or query in Design view.

<P><LI>Add a graph to the detail section of the report showing the total number
   of customer orders taken by each employee.
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>    a. On the Insert menu, click Chart, and then click in the detail
       section of the report to invoke the Chart Wizard.
</PRE><P>
<P><PRE>    b. In the "Which table or query would you like to use to create your
       chart?" dialog box, select the Orders table, and then click Next.
</PRE><P>
<P><PRE>    c. In the "Which fields contain the data you want for the chart?"
       dialog box, add OrderID and EmployeeID to the Fields For Chart box,
       and then click Next.
</PRE><P>
<P><PRE>    d. In the "What type of chart would you like" dialog box, click Column
       Chart, and then click Next.
</PRE><P>
<P><PRE>    e. In the "How do you want to lay out the data in your chart?" dialog
       box, drag OrderID to Data (at the upper-left of the graph). Drag
       EmployeeID to Axis (at the bottom of the graph). Leave Series blank,
       and then click Next.
</PRE><P>
<P><PRE>    f. In the "What title would you like for your chart" dialog box, click
       Finish.
</PRE><P>
   In Microsoft Access 2.0:
<P>
<P><PRE>    a. Click the Graph button on the Toolbox toolbar, and then click in the
       detail section of the report to invoke the Graph Wizard.
</PRE><P>
<P><PRE>    b. In the "Where do you want your graph to get its data?" dialog box,
       select the Orders table and then click Next.
</PRE><P>
<P><PRE>    c. In the "Which fields contain the data you want for your graph?"
       dialog box, add Order ID and Employee ID to the Fields For graph
       box, and then click Next.
</PRE><P>
<P><PRE>    d. In the "What categories do you want along the graph's axis?" dialog
       box, add Employee ID to the Categories For Axis box, and then click
       Next.
</PRE><P>
<P><PRE>    e. In the "How to you want to calculate the totals for each category on
       your graph?" dialog box, click "Count the number of records in each
       category," and then click Next.
</PRE><P>
<P><PRE>    f. In the "What type of graph do you want?" dialog box, click Next.
</PRE><P>
<P><PRE>    g. In the "What title do you want on your chart?" dialog box, click
       Finish.
</PRE>
<P><LI>Set the Name property of the graph object to GraphTest.

<P><LI>Save the report as OrdersPerEmployee and close it.
<P>
</OL><h3>Creating the Macro</h3>
 

<OL><P><LI>Create a new macro called RptGraph with the following actions.
<P>
   NOTE: In the SetValue expression of the following macro, an underscore
   (_) at the end of a line is used as a line-continuation character.
   Remove the underscore from the end of the line when re-creating this
   expression.
<P>
   NOTE: In the SetValue expression of the following macro, type a
   space in [Employee ID], [Order ID], and [Customer ID] in Microsoft
   Access 2.0.
<P>
<PRE>    Macro Name   Action
    -----------------------
    RptGraph     Echo
                 OpenReport
                 SetValue
                 RunCommand (or DoMenuItem in versions 2.0 and 7.0)
                 OpenReport
                 Echo

    RptGraph Actions
    ------------------------------------------------------------
    Echo
       Echo On: No
    OpenReport
       Report Name: OrdersPerEmployee
       View: Design
    SetValue
       Item: Reports!OrdersPerEmployee!GraphTest.RowSource
       Expression: "SELECT [EmployeeID], Count([OrderID]) as _
          [Number of Orders] FROM [Orders] where [CustomerID] = _
          Forms!Customers![CustomerID] GROUP BY [EmployeeID];"

    In Microsoft Access 97 only, use the following Runcommand:

    RunCommand
       Command: Save

    In Microsoft Access 2.0 and 7.0 only, use the following DoMenuItem:

    DoMenuItem
       Menu Bar: Report
       Menu Name: File
       Command: Save

    OpenReport
       Report Name: OrdersPerEmployee
       View: Print Preview
    Echo
      Echo On: Yes

</PRE><P><LI>Save the macro and close it.
<P>
</OL><h3>Adding the Macro to a Button on a Form</h3>
 

<OL><P><LI>Open the Customers form in Design view.

<P><LI>Add a command button to the Form Header section of the form and set the
   following properties:
<P>
<P><PRE>      Command Button
      --------------
      Name: OpenReport
      Caption: Preview Graph
      OnClick: RptGraph
</PRE>
<P><LI>Open the form in Form view and click the Preview Graph button. Note that
   the graph report opens and shows a count of orders taken, by employee,
   for the current customer record.

<P><LI>Close the report and return to the Customers form.

<P><LI>Move to a different customer record and click the Preview Graph
   button. Note that the graph report opens and shows orders, by employee,
   for the current customer record.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the RowSource property, search the Help Index
for "RowSource property," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : AutoGrph kbinterop kbprg PgmHowTo IntpGrph
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
