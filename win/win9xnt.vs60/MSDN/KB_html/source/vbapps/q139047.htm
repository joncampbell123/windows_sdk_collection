

<HTML>
<HEAD>
<TITLE>ACC95: How to Create a FindRecord Form Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139047">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="JetFind kbprg kbusage PgmHowTo FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Microsoft Access version 7.0 now exposes the form module events, functions, and routines that have been created using Visual Basic for Applications. In earlier versions of Micros...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAY5,QDN9,QBS0,QAH4,QBV8,QAB9,QAPN,QA5V,QA5F,QAPF,QAMA,QAIB,QAB5,QAI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: How to Create a FindRecord Form Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139047</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Microsoft Access version 7.0 now exposes the form module events, functions,
and routines that have been created using Visual Basic for Applications. In
earlier versions of Microsoft Access that use Access Basic, it was
difficult to pass parameters to a form to allow searches, configuration,
and so on. To do so usually involved setting the Tag property of the form
or creating global variables to hold values.
<P>
The new form module functionality in Microsoft Access 7.0 enables you
to code specific rules and behavior directly into the form object, and
enables outside OLE applications or other functions within the database to
use these functions to perform tasks from the very simple to the highly
complex.
<P>
This article demonstrates a technique to enable a calling function
to find a specific record on a form. This is done with a single call to
a user-defined search function. The search function, defined in the
form's code module, hides the complexity of the method used, which
involves changing the focus, enabling and disabling a control, and using
the FindRecord method.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications With Microsoft Access For Windows 95" manual.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
or perform these steps on a copy of the Northwind database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create the search function, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Orders form in Design view.

<P><LI>Create a new module and type the following line in the Declarations
   section if it's not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Public Function FormFindRecord(IdValue As Variant) As Boolean
<PRE></PRE>         On Local Error GoTo FormFindRecord_Err
         Me.SetFocus
         ' Set focus to OrderId control for lookup.
         Me!OrderID.Enabled = True
         DoCmd.GoToControl "OrderID"
         DoCmd.FindRecord IdValue, , True, , True
         DoEvents
         If Me!OrderID = IdValue Then
            FormFindRecord = True
         End If
      FormFindRecord_End:
         DoCmd.GoToControl "CustomerID"
         Me!OrderID.Enabled = False
         Exit Function
      FormFindRecord_Err:
         MsgBox Error$
         Resume FormFindRecord_End
      End Function

   NOTE: The design of the Orders form disables the OrderID control
   so it cannot be edited. The above method is consistent with the
   form's design by not allowing the OrderID control to be edited. By
   encapsulating this rule in the function, you limit the visibility of
   this rule to the function itself and the caller of the function never
   needs to be concerned with this restriction.

</PRE><P><LI>Save and close the Orders form.

<P><LI>Open the Orders form in Form view.

<P><LI>Open the Debug window by pressing CTRL+G.

<P><LI>Type the following line in the Debug window, and then press ENTER.
<P>
<P><PRE>       ? FORM_Orders.FormFindRecord(10400)
</PRE><P>
   Note that the function runs and finds the record 10400.
</OL> 
<PRE>Keywords          : JetFind kbprg kbusage PgmHowTo FmsHowTo
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
