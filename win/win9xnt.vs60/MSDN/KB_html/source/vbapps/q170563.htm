

<HTML>
<HEAD>
<TITLE>OFF97: How to Prevent Customization of Menus and Toolbars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170563">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1997/06/24">
<META NAME="Keywords" CONTENT="IntpMenu IntpToolbr kbinterop kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Office 97, Service Release 1 (SR-1), the CommandBars object model allows you to disable the Toolbars shortcut menu. This simplifies preventing others from changing the toolbars and menus of a custom application that you develop with Mi...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QDKR,QBS0,QANS,QA4P,QAFF,QBVV,QAE1,QDO3,QBXS,QBJZ,QAKE,QAJH,QARW,QDKX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: How to Prevent Customization of Menus and Toolbars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170563</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
<UL><LI>Microsoft Visual Basic for Applications included with:
<P>
   - Microsoft PowerPoint 97 for Windows, Service Release 1
   - Microsoft Excel 97 for Windows, Service Release 1
   - Microsoft Word 97 for Windows, Service Release 1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Office 97, Service Release 1 (SR-1), the CommandBars object
model allows you to disable the Toolbars shortcut menu. This simplifies
preventing others from changing the toolbars and menus of a custom
application that you develop with Microsoft Office 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Disabling and Enabling the Toolbar Shortcut Menu</h3>
 
<P>
The following Visual Basic for Applications subroutine disables the Toolbar
List shortcut menu:
<P>
<PRE>   Sub DisableToolbarMenu()
       CommandBars("Toolbar List").Enabled = False
   End Sub

</PRE>After you run this subroutine, the Toolbars command on the View menu is
unavailable. Also, you cannot display a list of available toolbars by
pointing to, and then right-clicking a toolbar.
<P>
The following subroutine enables the Toolbar List shortcut menu:
<P>
<PRE>   Sub EnableToolbarMenu()
       CommandBars("Toolbar List").Enabled = True
   End Sub

</PRE><h3>Preventing Users from Changing Menus and Toolbars</h3>
 
<P>
Setting the Visible property of the Toolbar List shortcut menu does not
prevent others from making changes to the menus and toolbars of a custom
application. To prevent others from changing the menus and toolbars in a
custom application, remove or disable the Customize option on the Tools
menu and disable the Toolbar List shortcut menu.
<P>
The following sample subroutine disables the Toolbar List shortcut menu and
deletes the Cutomize menu option, which prevents others from modifying the
menus and toolbars in a custom application:
<P>
<PRE>   Sub DisableCustomize()
        Application.CommandBars("Tools").Controls("&amp;Customize...").Delete
        CommandBars("Toolbar List").Enabled = False
   End Sub

</PRE>You can use the following subroutine to restore the Customize menu command
and allow others to display the Toolbar List shortcut menu:
<P>
<PRE>   Sub EnableCustomize()
       Application.CommandBars("Tools").Controls.Add _
               Type:=msoControlButton, Id:=797, Before:=13
       CommandBars("Toolbar List").Enabled = True
   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about customizing command bars, click the Office
Assistant in the Visual Basic Editor, type "commandbars", click Search, and
then click to view "Using command bars".
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: xlvbainfo <BR>
Keywords          : IntpMenu IntpToolbr kbinterop kbprg PgmHowTo<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
