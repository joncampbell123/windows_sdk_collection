

<HTML>
<HEAD>
<TITLE>FIX: ActiveX Control Incorrectly Reports ScaleWidth/ScaleHeight </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171492">
<META NAME="KBModify" CONTENT="1997/12/19">
<META NAME="KBCreate" CONTENT="1997/07/16">
<META NAME="Keywords" CONTENT="kbprg VS97FixlistSP2 VB5FixlistSP2 GnrlVB VS97FixlistSP3">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When using an ActiveX control created in Visual Basic 5.0 in Microsoft PowerPoint 97, the ScaleWidth and ScaleHeight of the control are changed after going to  Slide Show  mode and back.  CAUSE =====  PowerPoint 97 zooms the control's window when t...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB5,QA7O,QAMN,QDO3,QBVQ,QAOE,QDKP,QAR4,QAHV,QAJM,QAM1,QBJZ,QA56,QA55 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ActiveX Control Incorrectly Reports ScaleWidth/ScaleHeight</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171492</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Learning, Professional, and Enterprise
   Editions for Windows, version 5.0
<LI>Microsoft PowerPoint 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using an ActiveX control created in Visual Basic 5.0 in Microsoft
PowerPoint 97, the ScaleWidth and ScaleHeight of the control are changed
after going to "Slide Show" mode and back.
<P>
<P><h2>CAUSE</h2>
 
<P>
PowerPoint 97 zooms the control's window when the slide is displayed, even
if Zoom is set to 100%. Because ScaleWidth and ScaleHeight are based on the
size of the control's window, and PowerPoint doesn't resize this window
back to the control's extents when the control gets deactivated, the window
retains its "zoomed" size until explicitly resized. In all containers that
don't zoom, these values are always identical and do not exhibit this
problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been fixed in Visual Studio
97 Service Pack 2.
<P>
For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE>For a list of the Visual Basic 5.0 bugs that were fixed in the Visual
Studio 97 Service Pack 2, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q171554.htm">Q171554</A></B>
   TITLE     : INFO: Visual Basic 5.0 Fixes in Visual Studio 97
               Service Pack 2

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new ActiveX Control Project.

<P><LI>Select Project1 Properties from the Project menu, and change the
   Project Name to "ScaleTest."

<P><LI>Add the following to the Paint event:
<P>
<P><PRE>      Private Sub UserControl_Paint()
<PRE></PRE>         Dim sCaption As String
         sCaption = ScaleWidth &amp; " ," &amp; ScaleHeight
         CurrentX = (ScaleWidth - TextWidth(sCaption)) / 2
         CurrentY = (ScaleHeight - TextHeight(sCaption)) / 2
         Print sCaption
         Line (0, ScaleHeight / 2)-(ScaleWidth / 2, 0)
         Line (ScaleWidth / 2, 0)-(ScaleWidth, ScaleHeight / 2)
         Line (ScaleWidth, ScaleHeight / 2)-(ScaleWidth / 2, ScaleHeight)
         Line (ScaleWidth / 2, ScaleHeight)-(0, ScaleHeight / 2)
      End Sub

</PRE><P><LI>Select "Make ScaleTest.ocx" from the File menu.

<P><LI>Close Visual Basic and start PowerPoint 97.

<P><LI>Create a new Blank Presentation that contains one Blank Slide.

<P><LI>Use the "More Controls" button on the ToolBox to add the previously-
   created control to the slide. Note the ScaleWidth and ScaleHeight.

<P><LI>Select "Slide Show" from the View menu. The control will get larger
   and the ScaleWidth and ScaleHeight will be changed.

<P><LI>Press the Escape key to return to layout mode and note that the
   ScaleWidth and ScaleHeight still reflect the "Slide Show" settings.
</OL> 
<PRE>Keywords          : kbprg VS97FixlistSP2 VB5FixlistSP2 GnrlVB VS97FixlistSP3
Technology        : kbvba
Version           : WINDOWS:5.0 97
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
