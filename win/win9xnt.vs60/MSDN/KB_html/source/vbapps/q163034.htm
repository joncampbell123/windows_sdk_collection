

<HTML>
<HEAD>
<TITLE>ACC97: Form Control Format Property Ignored when Exported to ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163034">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="kbinterop IntAsp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you browse to an ASP file that was exported with Microsoft Access 97, the Format property of fields in Microsoft Access forms is not preserved. This article discusses t...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAKD,QAUJ,QA3P,QDNG,QA1S,QDN9,QBVX,QA7O,QAUR,QBTI,QAKC,QA7N,QAPN,QBWA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Form Control Format Property Ignored when Exported to ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163034</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI> Microsoft Access 97
<LI> Microsoft Internet Information Server version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you browse to an ASP file that was exported with Microsoft Access 97,
the Format property of fields in Microsoft Access forms is not preserved.
This article discusses the workaround for this behavior.
<P>
<P><h2>CAUSE</h2>
 
<P>
When forms are exported to ASP format, Microsoft Access 97 generates a
SQL statement for the ASP file that retrieves the data from the underlying
tables. This functionality is not designed to preserve Format properties
of fields or form controls. Numbers will be displayed in General Number
format, Dates will be displayed in General Date format, Times will be
displayed in Long Time format, and Yes/No fields will be displayed in
True/False format.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In order to preserve the Format properties of fields when exporting tables
and queries to ASP format, one workaround is to export a Microsoft Access
query that uses the Format function around the fields that you want
formatted. However, this workaround should not be used for forms. When
exporting forms to ASP format, the fields that use the Format function will
not be updateable and ASP forms are designed for use with updateable
recordsets.
<P>
NOTE: This section contains information about editing ASP files and
assumes that you are familiar with editing HTML files, Active Server, and
Visual Basic Scripting. Microsoft Access Technical Support engineers do
not support customization of any HTML, HTX, IDC, or ASP files.
<P>
<PRE>  1. Open the sample database Northwind.mdb in Microsoft Access 97.

  2. Use the AutoForm: Columnar Wizard to create a new form based on the
     Products table.

  3. Switch to Design view of the form, delete the ProductID label and text
     box because it is an AutoNumber field that you do not want users
     to enter data in. Save the form and call it frmFormatTest. Close the
     form.

  4. Select frmFormatTest in the Database window.

  5. On the File menu, click Save As/Export.

  6. In the Save As dialog box, click to select "To an External File or
     Database," and click OK. Note that the "Save Form 'frmFormatTest' In"
     dialog box appears.

  7. In the Save As Type box, select Microsoft Active Server Pages (*.asp)
     and type frmFormatTest.asp in the File Name box. Note the folder where
     the files will be exported to. Click Export. Note that the Microsoft
     Active Server Pages Output Options dialog box appears.

  8. In the Data Source Name box, enter the name of a System DSN that
     points to the sample database Northwind.mdb.

     For more information about how to define a system DSN, search the Help
     index for "ODBC, setting up data sources," and see the following
     article in the Microsoft Knowledge Base:

        ARTICLE-ID: <B><A href="../access/q159682.htm">Q159682</A></B>
        TITLE     : ACC97: "Data Source Name Not Found" Err Msg Opening Web
                    Page

  9. In the Server URL box, enter the URL that points to the Web Server
     location where your ASP files will be stored. For example, if you
     store the ASP files in the \ASPsamp folder on the \\PubTest server,
     type "<B>http://pubtest/aspsamp/</B>" (without the quotation marks) as your
     Server URL. Click OK. The ASP output creates the files
     frmFormatTest.asp and frmFormatTestalx.asp.

 10. Use Notepad or another text editor to open the frmFormatTestalx.asp
     file. Towards the middle of the file, you will find the following code
     which sets the value of the UnitPrice object equal to the value of the
     current UnitPrice field in the recordset.

      &lt;OBJECT ID="UnitPrice"
      CLASSID="CLSID:8BD21D10-EC42-11CE-9E0D-00AA006002F3"
      STYLE="TOP:225;LEFT:168;WIDTH:231;HEIGHT:25;TABINDEX:5;ZINDEX:8;"&gt;
      &lt;%If Not IsNull(rs.Fields("UnitPrice").Value) Then%&gt;
      &lt;PARAM NAME="Value"
      VALUE="&lt;%=Server.HTMLEncode(rs.Fields("UnitPrice").Value)%&gt;"&gt;
      &lt;%End If%&gt;
      &lt;PARAM NAME="BackStyle" VALUE="1"&gt;
      &lt;PARAM NAME="BackColor" VALUE="2147483653"&gt;
      &lt;PARAM NAME="BorderStyle" VALUE="1"&gt;
      &lt;PARAM NAME="BorderColor" VALUE="0"&gt;
      &lt;PARAM NAME="ForeColor" VALUE="2147483656"&gt;
      &lt;PARAM NAME="FontHeight" VALUE="160"&gt;
      &lt;PARAM NAME="Font" VALUE="MS Sans Serif"&gt;
      &lt;PARAM NAME="FontName" VALUE="MS Sans Serif"&gt;
      &lt;PARAM NAME="Size" VALUE="6006;650"&gt;
      &lt;PARAM NAME="SpecialEffect" VALUE="2"&gt;
      &lt;PARAM NAME="VariousPropertyBits" VALUE="2894088219"&gt;
      &lt;/OBJECT&gt;

      To format the value as Currency, you should use the VB Script
      formatcurrency() function by modifying the &lt;PARAM NAME="Value"...&gt;
      so that it matches the following:

      &lt;PARAM NAME="Value"
      VALUE="&lt;%=Server.HTMLEncode(formatcurrency(rs.Fields("UnitPrice")
      .Value))%&gt;"&gt;

     NOTE: VB Script has the FormatCurrency, FormatNumber, FormatDatetime,
     and FormatPercent functions, but there is no Format function with
     which you can provide custom formats. Please refer to your VB Script
     Language Reference available in the ASP online documentation for more
     information on VB Script functions.

     Save and then close frmFormatTestalx.asp.

 11. Copy frmFormatTest.asp and frmFormatTestalx.asp to a folder on your
     Web Server computer where you have Execute permission. For more
     information about configuring Microsoft Internet Information Server
     (IIS) permissions, please refer to the IIS Help Index, and see the
     following article in the Microsoft Knowledge Base:

        ARTICLE-ID: <B><A href="../access/q162975.htm">Q162975</A></B>
        TITLE     : ACC97: Permissions Necessary to View HTML, IDC, and ASP
                    Files

 12. Start Microsoft Internet Explorer 3.0, or another Web browser program.

 13. Type the Uniform Resource Locator (URL) in the address box of your Web
     browser to view frmFormatTest.ASP. For example, if you saved your ASP
     file in a folder called Test in the wwwroot folder of your Web Server,
     type:

       <B>http://&lt;servername&gt;/test/frmFormatTest.ASP</B>

     Note that the URL depends upon where your files are located on the Web
     Server.

 14. Note that the UnitPrice field has the Currency format applied.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about exporting forms to ASP, search the Help Index
for "ASP files," and then "Export a form to dynamic HTML format."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: iis pws peer web services personal web server<BR>
Keywords          : kbinterop IntAsp<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
