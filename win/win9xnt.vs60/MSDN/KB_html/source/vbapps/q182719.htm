

<HTML>
<HEAD>
<TITLE>XL98: Warning Appears When You Use GetObject to Open Workbook </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182719">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/18">
<META NAME="Keywords" CONTENT="kberrmsg kbprg kbdta kbdtacode">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  If you run a Microsoft Visual Basic for Applications macro that uses the GetObject method to open a Microsoft Excel workbook, you may receive the following error message:     The workbook you are opening contains macros. Some macros may contain    ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBQ9,QBVP,QAB4,QAH4,QBWS,QA4P,QDO9,QBJZ,QBXS,QBHJ,QAVX,QAVW,QABH,QABI,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Warning Appears When You Use GetObject to Open Workbook</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182719</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you run a Microsoft Visual Basic for Applications macro that uses the
GetObject method to open a Microsoft Excel workbook, you may receive the
following error message:
<P>
<PRE>   The workbook you are opening contains macros. Some macros may contain
   harmful viruses. If you are sure this workbook is from a trusted
   source, click Yes. If you are not sure and want to prevent any macros
   from running, click No.

</PRE>The macro pauses until you click Yes, No, or Cancel. Note that if the macro
is designed to run unattended, this behavior may cause a problem.
<P>
<P><h2>CAUSE</h2>
 
<P>
You may receive this error message when the following conditions are true:

<UL><LI>You are using Automation to control Microsoft Excel 98 Macintosh Edition
   from another program, such as Microsoft Word 98 or Microsoft PowerPoint
   98.
<P>
<P><PRE>    -and-
</PRE>
<LI>The line of code you are using to open the workbook is similar to the
   following:
<P>
<P><PRE>      Set xlWkbk = GetObject("Macintosh HD:Test")
</PRE><P>
<P><PRE>    -and-
</PRE>
<LI>You select the Macro Virus Protection check box on the General tab in
   the Preferences dialog box (click Preferences on the Tools menu).
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, disable Macro Virus Protection in
Microsoft Excel 98 Macintosh Edition. Note that making Macro Virus
Protection unavailable makes it possible (although unlikely) for a macro
virus to infect your Microsoft Excel workbooks.
<P>
To make Macro Virus Protection unavailable in Microsoft Excel 98 Macintosh
Edition, follow these steps:

<OL><P><LI>On the Tools menu, click Preferences.

<P><LI>Select the General tab.

<P><LI>Click to clear the Macro Virus Protection check box.

<P><LI>Click OK.
<P>
</OL>Note that you cannot programmatically disable the Macro Virus Protection
feature. Also, you cannot programmatically detect whether the feature is
available or unavailable; you must do this manually.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, the Macro Virus Protection feature
is designed to prevent macro viruses, such as the ExcelMacro/Laroux virus,
from running. If you select the Macro Virus Protection check box, you are
prompted to enable or disable macros whenever you open a workbook that
contains macros.
<P>
If you use the GetObject method of Automation to open a Microsoft Excel
workbook that contains macros, and if Macro Virus Protection is available,
you receive a warning message when you open the workbook.
<P>
Example:
<P>
If you make Macro Virus Protection available in Microsoft Excel 98
Macintosh Edition, and the workbook "Test" contains any macros, you receive
the error message when you run the following sample Sub procedure:
<P>
<PRE>   Sub TestOLEAutomation()

      ' Dimension variables.
      Dim xlWkbk As Object

      ' The error message appears when this line is executed.
      Set xlWkbk = GetObject("Macintosh HD:Test")

      ' Display the program and document windows, and then close the
      ' workbook.
      xlWkbk.Parent.Visible = True
      xlWkbk.Parent.Windows(xlWkbk.Name).Visible = True
      xlWkbk.Close SaveChanges:=True

      Set xlWkbk = Nothing

   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98<BR>
Keywords          : kberrmsg kbprg kbdta kbdtacode<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
