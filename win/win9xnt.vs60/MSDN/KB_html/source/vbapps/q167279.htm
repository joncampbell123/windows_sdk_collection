

<HTML>
<HEAD>
<TITLE>XL97: How to Use the ApplyCustomType Method to Format Charts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167279">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/04/22">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a Visual Basic for Applications macro in Microsoft Excel 97, you can use the ApplyCustomType method to apply standard or custom chart types to a chart or a series in a chart.  This article explains how to use the ApplyCustomType method...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDNX,QAPN,QAH4,QAQG,QAKJ,QBS0,QDNG,QBVV,QAB4,QAP2,QBXT,QA5V,QAIB,QABA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: How to Use the ApplyCustomType Method to Format Charts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167279</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you run a Visual Basic for Applications macro in Microsoft Excel 97,
you can use the ApplyCustomType method to apply standard or custom chart
types to a chart or a series in a chart.
<P>
This article explains how to use the ApplyCustomType method and its
arguments.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Syntax</h3>
 
<P>
In Microsoft Excel 97, the ApplyCustomType method uses the following
syntax
<P>
<PRE>   &lt;Expression&gt;.ApplyCustomType(&lt;ChartType&gt;,&lt;TypeName&gt;)

</PRE>where the arguments are as follows:

<UL><LI>&lt;Expression&gt; is a Chart or Series object.

<LI>&lt;ChartType&gt; is a standard chart type, as listed in the Help topic for
   the ChartType property, or one of the following three constants:
<P>
<P><PRE>      xlBuiltIn
      xlUserDefined
      xlAnyGallery
</PRE>
<LI>&lt;TypeName&gt; is the name of the custom chart type you want to apply to
   the chart. Use this argument only when &lt;ChartType&gt; is one of the three
   constants listed for &lt;ChartType&gt;, and when &lt;Expression&gt; refers to a
   Chart object (not a Series object).
<P>
</UL><h3>The xlBuiltIn, xlUserDefined, and xlAnyGallery Constants</h3>
 
<P>
You can use the ChartType xlBuiltIn, xlUserDefined, and xlAnyGallery
constants to determine the source of custom chart formats that the
ApplyCustomType method will use. The sources that are used by each constant
are listed in the following table.
<P>
<PRE>   Constant        Source
   ---------------------------------------------------------------------
   xlBuiltIn       Uses custom chart formats in Xl8galry.xls. These
                   formats are included with Microsoft Excel 97.

   xlUserDefined   Uses custom chart formats in Xlusrgal.xls. You create
                   these formats.

   xlAnyGallery    Uses custom chart formats in Xlusrgal.xls or
                   Xl8galry.xls.

</PRE>To view the custom chart formats that are available in Xl8galry.xls
and Xlusrgal.xls files, do the following:

<OL><P><LI>In Microsoft Excel 97, click a chart to select it.

<P><LI>On the Chart menu, click Chart Type. Then, click the Custom Types tab.

<P><LI>Under Select From, click the type of custom chart formats you want to
   view (User-defined or Built-in).
<P>
</OL>The names in the Chart Type list are TypeName arguments for the
ApplyCustomType method. For example, if you want to format the chart as a
"Floating Bars" chart, use the following line of code:
<P>
<PRE>   Charts(1).ApplyCustomType xlBuiltIn, "Floating Bars"

</PRE></OL>Because "Floating Bars" is a built-in custom chart format, use the
xlBuiltIn constant. In most cases, you can also use the xlAnyGallery
constant.
<P>
NOTE: If you specify an invalid TypeName argument, you receive the
following error message:
<P>
<PRE>   Run-time error '1004':
   Application-defined or object-defined error

</PRE>If you use the xlAnyGallery constant, Microsoft Excel 97 first look for the
specified TypeName in Xlusrgal.xls. If the TypeName is not found, Microsoft
Excel 97 then looks in Xl8galry.xls. If the TypeName is not found, you
receive the previous error message.
<P>
<P><h3>Examples</h3>
 
<P>
Changing to a 3-D Line Chart:
<P>
To change the active chart to a 3-D line chart, use the following line of
code:
<P>
<PRE>   ActiveChart.ApplyCustomType xl3DLine

</PRE>Changing to a User-Defined Chart:
<P>
To change the first chart in the workbook to a user-defined chart type
called "Rainbow Columns," use either of the following lines of code:
<P>
<PRE>   Charts(1).ApplyCustomType xlUserDefined, "Rainbow Columns"

</PRE>-or-
<P>
<PRE>   Charts(1).ApplyCustomType xlAnyGallery, "Rainbow Columns"

</PRE>Changing to a Built-In Chart Type:
<P>
To change the second chart in the workbook to a built-in chart type called
"Outdoor Bars," use the following line of code:
<P>
<PRE>   Charts(2).ApplyCustomType xlBuiltIn, "Outdoor Bars"

</PRE>Note that you can also use the following line of code:
<P>
<PRE>   Charts(2).ApplyCustomType xlAnyGallery, "Outdoor Bars"

</PRE>However, this code does not achieve the same results if a user-defined
chart type called "Outdoor Bars" also exists.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using the ApplyCustomType method and the
ChartType property, click the Office Assistant in the Visual Basic Editor,
type "ApplyCustomType" or "ChartType"(without the quotation marks), click
Search, and then click to view the topics.
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Excel Help is not installed on your
computer, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbprg kbhowto<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
