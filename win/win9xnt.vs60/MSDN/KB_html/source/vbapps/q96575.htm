

<HTML>
<HEAD>
<TITLE>ACC: How to Use Code to Derive the Statistical Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96575 ">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/03/22">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes a Visual Basic for Applications function that creates a snapshot that determines the frequency of occurrences for all numbers in a table.  The most frequen...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA5W,QBS0,QAH4,QDN9,QAY5,QBXS,QA5F,QAMA,QBV8,QAB9,QBT6,QBV4,QAKC,QAZV P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use Code to Derive the Statistical Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96575 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes a Visual Basic for Applications function that
creates a snapshot that determines the frequency of occurrences for all
numbers in a table.
<P>
The most frequently occurring number in a data set is called the mode,
which is a measure of central tendency (a "middle" measure of a data set).
For example, the data set consisting of the numbers
<P>
<PRE>   {1,1,2,2,2,3,6,100}

</PRE>has a mode of 2 because 2 occurs three times in the set. The data set
consisting of the numbers
<P>
<PRE>   {1,1,1,2,2,2,3,6,10}

</PRE>is bimodal, and has modes of 1 and 2 (both numbers occur three time in
the set).
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a Visual Basic for Applications function that determines the
mode, open a new module or a previously created module and enter the
following code:
<P>
NOTE: In the following sample code, an underscore (_) is used as a line-
continuation character. Remove the underscore form the end of the line when
re-creating this code in Access Basic.
<P>
Create the following Mode() function in the module:
<P>
<PRE>   Function Mode (tName$, fldName$)
   ' The function will initialize:
   ' - A variable for the database object.
   ' - A variable for the snapshot.
   ' - Sets the database object to the opened database.
   ' - Creates a snapshot based on the database object.
   ' - This function requires table and field name parameters where the
   '     arguments are passed using "[" when the name includes spaces.

      Dim ModeDB As Database
      Dim ssMode As Recordset
      Dim ModalField1, ModalField2, ModalResult1, ModalResult2

      If tName$ = "" Or fldName$ = "" Then Exit Function

      Set ModeDB = CurrentDB()
      Set ssMode = ModeDB.OpenRecordSet("SELECT DISTINCTROW Count _
                      (" &amp; fldName$ &amp; ") AS Mode, " &amp; fldName$ &amp; " _
                      FROM " &amp; tName$ &amp; " GROUP BY " &amp; fldName$ &amp; " _
                      ORDER BY Count(" &amp; fldName$ &amp; ") _
                      DESC;",DB_OPEN_SNAPSHOT)
      ModalField1 = ssMode(fldName$)
      ModalResult1 = ssMode!Mode
      ssMode.MoveNext
      ModalField2 = ssMode(fldName$)
      ModalResult2 = ssMode!Mode

         If ModalField1 &lt;&gt; ModalField2 Then
            Mode = "The Result is Modal: " &amp; ModalField1
         Else
            Mode = "The Result is Bimodal: " &amp; ModalField1 &amp; _
                     " and " &amp; ModalField2
         End If
      ssMode.Close
      ModeDB.Close
   End Function

</PRE><h3>How to Use the Mode() function</h3>
 
<P>
Create a form with text box controls that will reflect all measures of
central tendency of a data set. In the ControlSource property for the
text box control, enter:
<P>
<PRE>   =Mode("TableName", "FieldName").

</PRE>The value of this control will be the statistical mode of the data set.
Another way to use this function is to call it from within another function
that compares mode from different data sets. For example:
<P>
<PRE>   Function CompareModes()
      Dim MyDB as Database
      .
      .
      .
      X = Mode("[TableName]", "[FieldName]")
      Y = Mode("[Table Name]", "[Field Name]")
      If X &gt; Y Then Debug.Print "The mode for X is greatest."
   End Function
</PRE> 
<PRE>Keywords          : kbprg PgmHowTo PgmOthr
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
