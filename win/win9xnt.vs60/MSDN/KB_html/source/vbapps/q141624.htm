

<HTML>
<HEAD>
<TITLE>ACC: How to Concatenate a List of Items from a Many-Side Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141624">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo RptLayou">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes a technique that you can use to concatenate information from multiple records based on the many side of a relationship and to format the results into a sin...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QABO,QBT6,QBS0,QA5F,QAMA,QBV4,QAH4,QA7O,QA7N,QAPN,QAHP,QA5V,QAUJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Concatenate a List of Items from a Many-Side Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141624</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes a technique that you can use to concatenate
information from multiple records based on the many side of a relationship
and to format the results into a single line separated by commas on a
report.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0). You may want to
back up the Northwind.mdb (or NWIND.MDB) file and perform these steps
on a copy of the database.

<OL><P><LI>Create the following query as the basis for the sample report:
<P>
<P><PRE>      Query: qryCategoriesProducts
      -------------------------------------------------------------
      Type: Select Query
      Join: Categories.[CategoryID] &lt;-&gt; Products.[CategoryID]
<PRE></PRE>            (or Categories.[Category ID] &lt;-&gt; Products.[Category ID]
            in Microsoft Access 2.0)
      Field: CategoryName (or Category Name in Microsoft Access 2.0)
         Table: Categories
         Sort: Ascending
      Field: ProductName (or Product Name in Microsoft Access 2.0)
         Table: Products
         Sort: None

</PRE><P><LI>Create the following report:
<P>
<P><PRE>      Report: rptCategoriesProducts
      -----------------------------------
      Caption: Products by Category
      RecordSource: qryCategoriesProducts
</PRE>
<P><LI>Create the following Sorting and Grouping sections in the report:
<P>
<P><PRE>      Field Expression: CategoryName
<PRE></PRE>         Sort: Ascending
         Group Header: Yes
         Group Footer: Yes

      Field Expression: ProductName
         Sort: Ascending
         Group Header: No
         Group Footer: No

</PRE><P><LI>Name the CategoryName header section grpHeaderCategoryID and set the
   header section's Height property to zero (0).

<P><LI>Place the ProductName field in the report's detail section and set the
   detail section's Visible property to No.

<P><LI>Place the CategoryName field in the report's Category Name footer
   section.

<P><LI>Add an unbound text box named AllProducts to the report's Category Name
   footer section.
<P>
   NOTE: You may want to set the CanGrow property of the AllProducts field
   to Yes if you anticipate that the number of items may exceed the width
   of the text box. This enables the text box to grow vertically.
<P>
   NOTE: Place the CategoryName and AllProducts fields side by side for
   clarity when you print the report.

<P><LI>Add the following lines to the report's Declarations section if they are
   not already there:
<P>
<P><PRE>      Option Compare Database  ' Use database order for string comparisons.
      Option Explicit
      Dim FirstPass As Integer
</PRE>
<P><LI>Add the following code to the CategoryName header section's OnFormat
   property [Event Procedure]:
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<PRE>      Sub grpHeaderCategoryID_Format (Cancel As Integer, _
                                      FormatCount As Integer)
         Me!AllProducts = Null
         FirstPass = False
      End Sub

</PRE><P><LI> Add the following code to the detail section's OnFormat property
<P><PRE>    [Event procedure]:
</PRE><P>
<PRE>      Sub Detail1_Format (Cancel As Integer, FormatCount As Integer)
         On Local Error GoTo Detail1_Format_Err
         If Not FirstPass Then
            Me!AllProducts = Me![ProductName]
            FirstPass = True
         Else
            Me!AllProducts = Me!AllProducts &amp; ", " &amp; Me![ProductName]
         End If
      Detail1_Format_End:
         Exit Sub
      Detail1_Format_Err:
         MsgBox Error$
         Resume Detail1_Format_End
      End Sub

</PRE><P><LI>Close and save the report.

<P><LI>Open the report in Print Preview. Note that the following data is
<P><PRE>    displayed in vertical format.
</PRE><P>
<P><PRE>       Category:  Beverages  Products:  Chai, Chang, Chartreuse
<PRE></PRE>                                        verte, Cote de Blaye,
                                        Guarana Fantastica, Ipoh
                                        Coffee, Lakkalikoori,
                                        Laughing Lumberjack
                                        Lager, Outback Lager,
                                        Rhonbrau Klosterbier,
                                        Sasquatch Ale, Steeleye
                                        Stout

       Category:  Condiments  Products: Aniseed Syrup, Chef
                                        Anton's Cajun Seasoning,
                                        Chef Anton's Gumbo Mix,
                                        Genen Shouyu, Grandma's
                                        Boysenberry Spread,
                                        Gula Malacca, Louisiana
                                        Fiery Hot Pepper Sauce,
                                        Louisiana Hot Spiced
                                        Okra, Northwoods
                                        Cranberry Sauce,
                                        Original Frankfurter
                                        grune Sobe, Sirop
                                        d'erable, Vegie-spread
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: horizontal<BR>
Keywords          : kbusage PgmHowTo RptLayou<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
