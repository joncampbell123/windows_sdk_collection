

<HTML>
<HEAD>
<TITLE>XL: How to Populate an Array with a Discontiguous Range </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149831">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/04/11">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  To populate an array using Microsoft Visual Basic for Applications in  Microsoft Excel, you need to iterate through the range object to populate  an array with the data if the range object is discontiguous (whether it is  a selection, range name, o...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAM9,QALX,QBS0,QDMR,QBJZ,QDNZ,QAJB,QBWS,QABI,QAVZ,QAYL,QAPF,QA01 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Populate an Array with a Discontiguous Range</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149831</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To populate an array using Microsoft Visual Basic for Applications in 
Microsoft Excel, you need to iterate through the range object to populate 
an array with the data if the range object is discontiguous (whether it is 
a selection, range name, or the reference).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>When the range is contiguous, there is no need to iterate through the
range. The following Visual Basic macro code includes an example of how you
can iterate through a discontiguous range of data to populate an array and
an example of how you can use a contiguous range of data to populate an
array.
<P>
To use the sample macro code, follow these steps:

<OL><P><LI>Open a new workbook and insert a Visual Basic module sheet.

<P><LI>On the module sheet, type the following macro code:
<P>
<PRE>      Sub PopulateArrayThroughIteration()

          ' Dimension the variables.
          Dim MyArray() As Integer
          Dim cell As Object
          Dim counter As Integer

          ' Set the value of the counter variable.
          counter = 1

          ' Start the loop on the range.
          For Each cell In Range("a1,a3:a20")

              ' Redimension the array, while preserving the previous
              ' elements using the counter variable.
              ReDim Preserve MyArray(counter)
              ' Place a value into the array.
              MyArray(counter) = cell.Value
              ' Increase counter by 1.
              counter = counter + 1
          ' Loop.
          Next cell

          ' Check a value to make sure the array is populated
          ' this should return 5.
          MsgBox MyArray(4)

      End Sub

</PRE><P><LI>On Sheet1, type the numbers 1 to 20 in the range A1:A20.

<P><LI>Activate Sheet1.

<P><LI>Run the macro. To do this, use the following steps:
<P>
   a. On the Tools menu, click Macro. 
<P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      On the Tools menu, point to Macro, and then click Macros.
</PRE><P>
   b. In the Macro dialog box, select the name of the macro, and then click
<P><PRE>      Run.
</PRE><P>
</OL>The following macro populates an array from a contiguous range of data.
<P>
<PRE>   Sub PopulateArrayContiguous()
       Dim MyArray As Variant

       ' Populate the array.
       MyArray = Range("a1:a20")

       ' Display a message box with a value in the array
       ' this should display a 5.
       MsgBox MyArray(5, 1)

   End Sub

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"Visual Basic User's Guide," version 5.0, Chapter 6, "Working with Visual
Basic Code in Procedures"
<P>
For more information about looping in Microsoft Excel version 7.0, click
Answer Wizard on the Help menu, and type the following:
<P>
<PRE>   For Each

</PRE>For more information about looping in Microsoft Excel version 5.0, click
the Search button in Help and type:
<P>
<PRE>   For Each
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 5.0 5.0c 7.00 7.00a XL98 XL97 XL7 <BR>
XL5<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS:5.x,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
