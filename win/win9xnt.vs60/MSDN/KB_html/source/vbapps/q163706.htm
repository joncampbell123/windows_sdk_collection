

<HTML>
<HEAD>
<TITLE>ACC97: ASP Files Display Hyperlinks as Text in Web Browser </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163706">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1997/02/14">
<META NAME="Keywords" CONTENT="kbinterop IntAsp IntPubWiz">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Hyperlink fields in an Active Server Pages (ASP) file created with Microsoft Access 97 are displayed as text with number signs (#) when you view them with a Web browser.  CAUSE =...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBVX,QAE2,QBTI,QAUR,QBWA,QA1S,QA3P,QAVZ,QBWS,QDN9,QA7O,QA7N,QAMB,QAFI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: ASP Files Display Hyperlinks as Text in Web Browser</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163706</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft Internet Information Server version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Hyperlink fields in an Active Server Pages (ASP) file created with
Microsoft Access 97 are displayed as text with number signs (#) when
you view them with a Web browser.
<P>
<P><h2>CAUSE</h2>
 
<P>
Data that is stored in a Microsoft Access hyperlink field is stored in
three parts (displaytext, address, and subaddress) separated by number
signs. This is different from hyperlinks in HTML files, which are created
using the &lt;A&gt; tag. Microsoft Access outputs the data in a hyperlink field
as it exists, without adding the &lt;A&gt; tags or parsing the data into an HTML
format.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Create a select query that parses the hyperlink field and adds the
appropriate &lt;A&gt; tags. Then export the query to an ASP file, and modify the
file so the hyperlink field is not HTML encoded.
<P>
If you do not modify the ASP file, the &lt; and &gt; symbols are translated to
&amp;lt and &amp;gt respectively, and the hyperlink is still displayed as text.
<P>
NOTE: If you create form based on the query and export it to ASP format,
the hyperlinks are not preserved. This method does not work with Microsoft
Access forms exported to ASP format.
<P>
The following example demonstrates how to create a select query that you
can export to ASP format so the hyperlink fields are preserved when you
view them in a Web browser. The query contains a column that parses the
HomePage Hyperlink field in Northwind's Suppliers table, and adds HTML
tags to preserve the links.
<P>
NOTE: This example contains information about editing ASP files. It
assumes that you are familiar with Active Server, Visual Basic Scripting,
and editing HTML files. Microsoft Technical Support engineers do not
support modification of any HTML, HTX, IDC, or ASP files.
<P>
<PRE>  1. Start Microsoft Access 97 and open the sample database Northwind.mdb.

  2. Create a new query in Design view based on the Suppliers table.

     NOTE: In the field expression below, an underscore (_) at the end of a
     line is used as a line continuation character. Remove the underscore
     from the end of each line when you create this example.

        Query: HyperASP
        ------------------------------------------------------------------
        Type: Select Query

        Field: SupplierID
           Table: Suppliers
        Field: GoodHyper: "&lt;A href=""" &amp; Right([HomePage],Len(IIf(IsNull _
               ([HomePage]),"",[HomePage]))-InStr(IIf(IsNull([HomePage]), _
               "",[HomePage]),"#")) &amp; """&gt;" &amp; IIf(Left([HomePage], _
               IIf(InStr(IIf(IsNull([HomePage]),"",[HomePage]),"#")&gt;1, _
               InStr(IIf(IsNull([HomePage]),"",[HomePage]),"#")-1,0))="", _
               [HomePage],Left([HomePage],IIf(InStr(IIf(IsNull _
               ([HomePage]), "",[HomePage]),"#")&gt;1,InStr(IIf(IsNull _
               ([HomePage]),"",[HomePage]),"#")-1,0))) &amp; "&lt;/A&gt;"

     The expression in the GoodHyper column is so long because it must
     account for nulls in the hyperlink field, and the NZ function cannot
     be used with ASP. The expression must also handle hyperlinks that do
     not contain the displaytext portion of the hyperlink field.

  3. Save the HyperASP query and close it.

  4. Select the HyperASP query in the Database window, and then on the File
     menu, click Save As/Export.

  5. In the Save As dialog box, click "To an External File or Database,"
     and then click OK.

  6. In the "Save Query 'HyperASP' In" dialog box, select Microsoft Active
     Server Pages (*.asp) in the Save As Type box, and type HyperASP.asp in
     the File Name box. Select a folder to store the files, and then click
     Export.

  7. In the Microsoft Active Server Pages Output Options dialog box, type
     the name of a System DSN on your Web server that points to the
     Northwind sample database in the Data Source Name box.

     For more information on how to create a System DSN, search the Help
     Index for "ODBC, setting up data sources," and see the following
     article in the Microsoft Knowledge Base:

        ARTICLE-ID: <B><A href="../access/q159682.htm">Q159682</A></B>
        TITLE     : ACC97: "Data Source Name Not Found" Err Msg Opening Web
                    Page

  8. In the Server URL box, type a Uniform Resource Locator (URL) of the
     Web server location where your ASP files will be stored. For example,
     if you store the ASP files in the \ASPsamp folder on the \\PubTest
     server, type <B>http://pubtest/aspsamp/</B> in the Server URL box. Click OK
     to create the ASP files.

  9. Use Notepad or another text editor to open the HyperASP.asp file. Near
     the bottom of the file you will see the following text:

      COLOR=#000000&gt;&lt;%=Server.HTMLEncode(rs.Fields("GoodHyper").Value)%&gt;
      &lt;BR&gt;&lt;/FONT&gt;&lt;/TD&gt;

     Remove the Server.HTMLEncode portion of the text so it looks like
     this:

      COLOR=#000000&gt;&lt;%=rs.Fields("GoodHyper").Value%&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/TD&gt;

 10. Save the HyperASP.asp file and close it.

 11. Copy HyperASP.asp to the folder on your Web server computer that you
     indicated in step 8. You must have Execute permission in this folder.

     For more information about configuring Microsoft Internet Information
     Server (IIS) permissions, please refer to the IIS Help Index, and see
     the following article in the Microsoft Knowledge Base:

        ARTICLE-ID: <B><A href="../access/q162975.htm">Q162975</A></B>
        TITLE     : ACC97: Permissions Necessary to View HTML, IDC, and ASP
                    Files

 12. Start Microsoft Internet Explorer 3.0, or another Web browser program.

 13. Type the URL in the address box of your Web browser to view
     HyperASP.asp, for example, <B>http://pubtest/aspsamp/HyperASP.asp.</B> Note
     that the URL depends upon where your files are located on the Web
     server.

 14. Your Web browser returns the SupplierID and the HomePage hyperlink
     field with the hyperlinks preserved.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access 97 and open the sample database Northwind.mdb.

<P><LI>Select the Suppliers table in the Database window, and then on the File
   menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an External File or Database," and
   then click OK.

<P><LI>In the "Save Table 'Suppliers' In" dialog box, select Microsoft Active
   Server Pages (*.asp) in the Save As Type box, and type Suppliers.asp in
   the File Name box. Select a folder to store the files, and then click
   Export.

<P><LI>In the Microsoft Active Server Pages Output Options dialog box, type the
   name of a System DSN on your Web server that points to the Northwind
   sample database in the Data Source Name box. In the Server URL box, type
   a URL that points to the Web server location where your ASP files will
   be stored. Click OK to create the Suppliers.asp file.

<P><LI>Copy the Suppliers.asp to a folder on your Web server computer where you
   have Execute permission.

<P><LI>Start Microsoft Internet Explorer 3.0, or another Web browser program.

<P><LI>Type the URL in the address box of your Web browser to view
   Suppliers.asp. For example, if you saved your ASP files in a folder
   called Test in the wwwroot folder of your Web server, type:
<P>
<P><PRE>      <B>http://&lt;servername&gt;/test/Suppliers.asp</B>
</PRE><P>
   Note that the URL depends upon where your files are located on the Web
   Server.

<P><LI>The Web browser returns the HomePage field, but note that the hyperlinks
   are not preserved, and text containing number signs appears in place of
   the hyperlinks.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about exporting ASP files, search the Help Index for
"ASP files," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: IIS 3.0 PWS Personal Web Server Peer Web Services<BR>
Keywords          : kbinterop IntAsp IntPubWiz<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
