

<HTML>
<HEAD>
<TITLE>ACC: How to Fax from Microsoft Access Using SendObject Command </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145787">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1996/05/30">
<META NAME="Keywords" CONTENT="kbprg IntpOle">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes a technique to use Microsoft Fax to fax reports from Microsoft Access using a macro or Visual Basic code. The examples assume that you have Microsoft Excha...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVU,QA1S,QBWS,QBVH,QBS0,QDN9,QAH4,QAPF,QAZV,QBJZ,QAPN,QAA1,QARJ,QAF8,QAD7 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Fax from Microsoft Access Using SendObject Command</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145787</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes a technique to use Microsoft Fax to fax reports
from Microsoft Access using a macro or Visual Basic code. The examples
assume that you have Microsoft Exchange, Microsoft Fax, and a fax modem
installed and functioning.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following examples use the sample database Northwind.mdb to show you
how to create a macro and a Visual Basic procedure to fax a report using
Microsoft Fax.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.
<P>
<P><h3>Creating a Macro</h3>
 
<P>
This example faxes the Catalog report to a single fax number using the
SendObject action.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Catalog report in Design view.

<P><LI>On the File menu, click Page Setup.

<P><LI>In the Page Setup box, click the Page tab.

<P><LI>In the Printer for Catalog box, click Use Specific Printer, and then
    click the Printer button.

<P><LI>In the Name box, select Microsoft Fax, and then click OK.

<P><LI>In the Page Setup box, click OK.

<P><LI>Save the Catalog report and close it.

<P><LI>Create the following macro named SendFax:
<P>
<PRE>       Macro Name   Action
       ------------------------
       SendFax      SendObject

       SendFax Actions
       ---------------------------------------------------------
       SendObject
          Type         : Report
          Object Name  : Catalog
          Output Format: Rich Text Format
          To:          : [Fax: ###-####] (where ###-#### is the fax number)

</PRE><P><LI>Run the macro to fax the report.
<P>
</OL><h3>Creating a Visual Basic Procedure</h3>
 
<P>
This example shows how to fax the Invoice report to each customer in
the Customers table.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Invoice report in Design view.

<P><LI>On the File menu, click Page Setup.

<P><LI>In the Page Setup Box, click the Page tab.

<P><LI>In the Printer for Invoice box, click Use Specific Printer, and then
    click the Printer button.

<P><LI>In the Name box, select Microsoft Fax, and then click OK.

<P><LI>In the Page Setup box, click OK.

<P><LI>Set the report's OnOpen property to the following event procedure:
<P>
       Me.Filter = strInvoiceWhere

<P><LI>Save the report and close it.

<P><LI>In the Database Window, click the Modules tab, and then click New.

<P><LI>Type or paste the following code into the module:
<P>
       Option Explicit
       Public strInvoiceWhere As String
<P>
       ' ****************************************************************
       ' This function will walk through the Customers table and fax the
       ' Invoice report which is filtered by the CustomerID field using
       ' MS Fax through the MS Access SendObject.
       ' This function assumes the Invoice report has the default
       ' printer set to MS Fax and the MS Fax driver is installed
       ' correctly.
       ' ****************************************************************
       Function FaxInvoices()
<P>
       Dim dbsNorthwind As DATABASE
       Dim rstCustomers As Recordset
<P>
       Set dbsNorthwind = CurrentDb()
       Set _
       rstCustomers = dbsNorthwind.OpenRecordset("Customers",dbOpenDynaset)
<P>
       If MsgBox("Do you want to fax invoices" &amp; Chr(13) &amp; _
<PRE>          "to all customers using Microsoft Fax?", 4) = 6 Then
          With rstCustomers
          Do Until .EOF
             ' Create the Invoice report Filter used by the Report_Open
             ' event.
             strInvoiceWhere = "[CustomerID] = '" &amp; ![CustomerID] &amp; "'"
              DoCmd.SendObject acReport,"Invoice",acFormatRTF, _
                 "[fax: " &amp; ![fax] &amp; "]", , , , , False
              .MoveNext
          Loop
          End With
       End If
       rstCustomers.Close
       End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
    and then press ENTER.
<P>
       ? FaxInvoices()
<P>
</OL>To improve performance, you can choose to delay faxing until an
appropriate time, and you can also change the rendering engine. Rich
Text Format (RTF) messages sent to Microsoft Fax need to be rendered.
The rendering process uses the application associated with .rtf
documents. If, for example, you have installed Microsoft Word 7.0, that
is the rendering application. Microsoft WordPad is a smaller and faster
application. If you want to send many fax documents, you might consider
changing the .rtf association from Microsoft Word 7.0 to WordPad.
<P>
To change the association for .rtf documents to WordPad, follow these
steps:

<OL><P><LI>Click the Start button, and then click Run.

<P><LI>In the Open box, type winfile, and then click OK.

<P><LI>In File Manager, on the File menu, click Associate.

<P><LI>In the Associate box, under File With Extension, type rtf.

<P><LI>Click Browse.

<P><LI>Locate WordPad.Exe in C:\Program Files\Accessories, and then click OK.

<P><LI>Quit File Manager.
<P>
</OL>To change the time to send a fax, follow these steps:

<OL><P><LI>Click the Start button, point to Settings, and then click Control
   Panel.

<P><LI>Double-click the Mail and Fax icon.

<P><LI>In "The following information services are set up in this profile"
   box, select Microsoft Fax, and then click Properties.

<P><LI>In the Time To Send box, select Specific Time, type a time in the
   Time box, and then click OK.

<P><LI>Close the Mail and Fax box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about SendObject, search the Help Index for
"SendObject Action."
<P>
For more information about OutputTo, search the Help Index for
"OutputTo."
<P>
For more information about FindFirst, search the Help Index for
"FindFirst Method."
 
<PRE>Keywords          : kbprg IntpOle
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
