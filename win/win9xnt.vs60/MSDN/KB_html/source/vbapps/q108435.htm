

<HTML>
<HEAD>
<TITLE>ACC: Sample Function to Return a Random Record </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108435">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/12/12">
<META NAME="Keywords" CONTENT="JetRS kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Microsoft Access does not contain a built-in mechanism for returning a random record from a set of records. This article describes a sample user- defined function you can use to ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QDN9,QAY5,QAUD,QBS0,QBV8,QAB9,QA5F,QAMA,QAAP,QAB4,QAND,QANF,QAD2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sample Function to Return a Random Record</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108435</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Microsoft Access does not contain a built-in mechanism for returning a
random record from a set of records. This article describes a sample user-
defined function you can use to return a random record.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample function will return a random record using the
recordset name and the field name that you provide.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
   In Microsoft Access 2.0, 7.0 and 97:
<P>
<P><PRE>      Function FindRandom (RecordSetName As String, Fieldname As String)
      Dim MyDB As Database
      Dim MyRS As Recordset
      Dim SpecificRecord As Long, i As Long, NumOfRecords As Long
</PRE><P>
<P><PRE>      Set MyDB = CurrentDB()
      Set MyRS = MyDB.OpenRecordset(RecordSetName, DB_Open_Dynaset)
      On Error GoTo NoRecords
      MyRS.MoveLast
      NumOfRecords = MyRS.RecordCount
      SpecificRecord = Int(NumOfRecords * Rnd)
      If SpecificRecord = NumOfRecords Then
<PRE></PRE>         SpecificRecord = SpecificRecord - 1
      End If
      MyRS.MoveFirst
      For i = 1 To SpecificRecord
          MyRS.MoveNext
      Next i
      FindRandom = MyRS(Fieldname)
      Exit Function
      NoRecords:
         If Err = 3021 Then
            MsgBox "There Are No Records In The Dynaset", 16, "Error"
         Else
            MsgBox "Error - " &amp; Err &amp; Chr$(13) &amp; Chr$(10) &amp; Error, _
               16, "Error"
         End If
      FindRandom = "No Records"
      Exit Function
      End Function

   In Microsoft Access 1.x:

      Function FindRandom (RecordSetName As String, Fieldname As String)
      Dim MyDB As Database
      Dim MyRS As DynaSet
      Dim SpecificRecord As Long, i As Long, NumOfRecords As Long

      Set MyDB = CurrentDB()
      Set MyRs = MyDB.CreateDynaset(RecordSetName)
      On Error GoTo NoRecords
      MyRS.MoveLast
      NumOfRecords = MyRS.RecordCount
      SpecificRecord = Int(NumOfRecords * Rnd)
      If SpecificRecord = NumOfRecords Then
         SpecificRecord = SpecificRecord - 1
      End If
      MyRS.MoveFirst
      For i = 1 To SpecificRecord
          MyRS.MoveNext
      Next i
      FindRandom = MyRS(Fieldname)
      Exit Function
      NoRecords:
         If Err = 3021 Then
            MsgBox "There Are No Records In The Dynaset", 16, "Error"
         Else
            MsgBox "Error - " &amp; Err &amp; Chr$(13) &amp; Chr$(10) &amp; Error, _
               16, "Error"
         End If
      FindRandom = "No Records"
      Exit Function
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window (or
   the Immediate window in versions 1.x and 2.0), and then press ENTER.
<P>
<P><PRE>      ?FindRandom("&lt;RecordSetName&gt;", "&lt;FieldName&gt;")
</PRE><P>
   where &lt;RecordSetName&gt; is the name of your recordset and &lt;FieldName&gt; is
   the name of a field in your recordset.
<P>
   Each time you run the function, a different record will be returned.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about returning random records using a query, please
see the following article here in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICKE-ID: <B><A href="../access/q128874.htm">Q128874</A></B>
   TITLE:      ACC: Find N Records in Random Order

</PRE></OL>For more information about the Int() function or the Rnd() function, search
the Help Index for "Int" or "Rnd," or ask the Microsoft Access 97 Office
Assistant.
 
<PRE>Keywords          : JetRS kbprg PgmHowTo
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
