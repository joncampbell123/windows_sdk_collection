

<HTML>
<HEAD>
<TITLE>ACC: How to Create Tasks in MS Project for Windows Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103273">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/08/19">
<META NAME="Keywords" CONTENT="IntpDde kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Before data can be sent to Microsoft Project for Windows versions 3.0, 3.0a, 4.0 as well as Microsoft Project for Windows 95, a task must exist in the active project. This a...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QBS0,QAH4,QAY5,QA5F,QAMA,QAIJ,QDL9,QBWO,QBWN,QAZ2,QBV8,QAB9,QAJN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create Tasks in MS Project for Windows Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103273</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Before data can be sent to Microsoft Project for Windows versions 3.0,
3.0a, 4.0 as well as Microsoft Project for Windows 95, a task must exist
in the active project. This article contains sample code to start Microsoft
Project, create 10 tasks, and fill the task fields with data.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example is intended as a demonstration of the technique
required to create a task in Project. The following function is not
intended to be replicated exactly.

<OL><P><LI>Create a new module in a Microsoft Access database. Add the
   following statement to the Declarations section of the module:
<P>
<P><PRE>      '------------------------------------------------------------------
      'Declarations Section
      '------------------------------------------------------------------
      Option Explicit
</PRE>
<P><LI>Add the following function to the module:
<P>
   NOTE: In the following sample code, an underscore (_)is used as a
   line-continuation character. Remove the underscore from the end of the
   line when re-creating this code in Access Basic.
<P>
<P><PRE>    '---------------------------------------------------------------------
    'Start of Function
    '---------------------------------------------------------------------
</PRE><P>
<P><PRE>    Function DDE_CreateTasks (ProjectPath as String)
</PRE><P>
<PRE>      Const DDE_ERROR = 282               ' Define DDE return error.
      Dim Temp, Mynum, Chan1, Chan2       ' Define variables.

      On Error GoTo StartUp               ' If Project is not open, start
                                          ' it.

      Chan1 = DDEInitiate("winproj", "system")
      ' Initiate a channel to Project.

      On Error GoTo QuitNow

      Chan2 = DDEInitiate("winproj", DDERequest(Chan1, "ActiveProject"))
      ' Initiate a channel to the active Project.

      For Mynum = 1 To 10
         DDEExecute Chan2, "EditGoto .ID=[" &amp; Mynum &amp; "]"
         ' Go to the task.
         DDEExecute Chan2, "SetField .Field=[Name] .Value=MyNewTask" &amp;_
            Mynum &amp; " .Create=[Yes]"
         ' Create a new task.
         DDEPoke Chan2, "T((" &amp; Mynum &amp; "),(Name,Duration))", "Task_
            Number " &amp; Mynum &amp; Chr(9) &amp; Mynum &amp; "d"
         ' Send information to Project.
      Next

      DDETerminateAll                     'Terminate the DDE channel.

      Exit Function

      QuitNow:

         DDETerminateAll                  ' Terminate the DDE channel.
         Exit Function

      StartUp:

         If Err = DDE_ERROR Then
            Temp = Shell(ProjectPath, 6)  ' Start Project.
            Resume                        ' Re-execute DDEInitiate()
                                          ' function.
         End If

    End Function

</PRE><P><LI>To test this function, type the following line in the Debug window
   (or Immediate window in versions 1.x and 2.0), and press ENTER
<P>
<P><PRE>      ?DDE_CreateTasks ("&lt;c:\winproj\winproj.exe&gt;")
</PRE><P>
   where "&lt;c:\winproj\winproj.exe&gt;" is the path to Project.
<P>
</OL>Note that Microsoft Project installs two files, Macro.wri and Ddeinfo.wri,
in the program folder that contain more information about macro commands
and dynamic data exchange (DDE) functionality. These files can be opened
in Microsoft Windows Write.
<P>
The following Microsoft Access versions work with the following Microsoft
Project versions:
<P>
<PRE>    Microsoft Access | Microsoft Project
    ------------------------------------
        1.0, 1.1     |     3.0, 3.0a
           2.0       |  3.0, 3.0a, 4.0
           7.0       |        95
           97        |        95

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about DDE, search the Help Index for "dynamic-data
exchange," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dde<BR>
Keywords          : IntpDde kbinterop<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
