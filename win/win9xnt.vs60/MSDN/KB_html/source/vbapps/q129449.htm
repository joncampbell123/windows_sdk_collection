

<HTML>
<HEAD>
<TITLE>PRB: Object Created w/NEW Instantiated When Passed as Argument </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129449">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1995/04/26">
<META NAME="Keywords" CONTENT="APrg APrgOther VB4ALL VB4WIN vbwin">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Visual Basic version 4.0 instantiates objects created with the  New  keyword in cases where Visual Basic version 3.0 does not.  This may apply to earlier versions of VBA (specifically 1.0) used in Microsoft Excel 5.0 (16-bit).  RESOLUTION  When pas...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAPN,QAW6,QAH4,QA5F,QAMA,QAGI,QAFF,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Object Created w/NEW Instantiated When Passed as Argument</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129449</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Visual Basic version 4.0 instantiates objects created with the "New"
keyword in cases where Visual Basic version 3.0 does not.
<P>
This may apply to earlier versions of VBA (specifically 1.0) used in
Microsoft Excel 5.0 (16-bit).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When passing an object (declared with the New keyword) to a procedure,
Visual Basic 4.0 first instantiates the object (if it isn't already
instantiated).
<P>
This behavior is different than Visual Basic version 3.0. In Visual Basic
3.0, the object isn't instantiated until a member of the object is
referenced inside the called procedure. If the object is never referenced,
then it is never instantiated. Because a form is not shown when it is
instantiated anyway (it is only shown when the Show method is called), the
only difference in behavior is that the Form_Load event runs at a different
time in Visual Basic 4.0 than in Visual Basic 3.0.
<P>
In a TypeOf statement, if an object variable that was declared with the New
keyword is being tested, then Visual Basic 4.0 will instantiate the object
before doing the test. For example:
<P>
<PRE>   Dim X As New Form1
   If TypeOf X Is Form1 Then ... ' X WILL be instantiated

</PRE>This is different from Visual Basic 3.0. Visual Basic 3.0 does not
instantiate the object in this case. Visual Basic 3.0 can do this because
it can determine the type of the object even if the object has not yet been
instantiated.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add the following code to the General Declarations section of Form1.
<P>
<PRE>   Sub ABC()
      Dim Y as New Form1
      Call DEF(Y) ' The object is instantiated here in Visual Basic 4.0
   End Sub

   Sub DEF( X as Object)
      X.Backcolor = 10 'The object is instantiated here in Visual Basic 3.0
   End Sub

</PRE><P><LI>Add the following code to the Form_Load event of Form1.
<P>
<PRE>      Sub Form_Load ()
         MsgBox "I code therefore, I am!"
         Call ABC
      End Sub

</PRE><P><LI>Step through the code by pressing the F8 function key or clicking the
   Step button on the button bar.
<P>
</OL>The Form_Load event code will fire on the call to DEF in Sub ABC rather
than on the code reference to X in DEF. Note that in both versions of
Visual Basic, the above code produces runaway recursion and should not be
used.
 
<PRE>Keywords          : APrg APrgOther VB4ALL VB4WIN vbwin
Technology        : kbvba
Version           : WINDOWS:3.0 4.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
