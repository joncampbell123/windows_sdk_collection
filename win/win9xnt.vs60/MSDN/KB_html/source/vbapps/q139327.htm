

<HTML>
<HEAD>
<TITLE>XL: Error Programmatically Accessing Data Series on Chart </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139327">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/11/08">
<META NAME="Keywords" CONTENT="kberrmsg kbprg xlchart PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you run a macro that attempts to access a data series in a chart, you may receive any of the following error messages:     Microsoft Excel 97 for Windows and Excel 98 Macintosh Edition    -----------------------------------...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QBOM,QAAP,QAA7,QDKW,QABI,QAPN,QAKP,QAKD,QBJZ,QDNX,QBWS,QDIJ,QAIX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Error Programmatically Accessing Data Series on Chart</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139327</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Macintosh, version 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you run a macro that attempts to access a data
series in a chart, you may receive any of the following error messages:
<P>
<PRE>   Microsoft Excel 97 for Windows and Excel 98 Macintosh Edition
   -------------------------------------------------------------

   Run-time error '1004':
   Unable to get the Name property of the Series class.

   Microsoft Excel 5.0 or 7.0
   --------------------------

   Run-time error '1006':
   Unable to get the Name property of the Series class.

</PRE>You may also receive the following error message:
<P>
<PRE>   Run-time error '1005':
   Unable to set the Value property of the Series class.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when you run a macro that attempts to access a data
series that is not visible on a chart, and the chart is a line, xy 
(scatter), or radar series chart.
<P>
The error message appears when the data series is not visible because it
has an empty set of y-axis values or has #N/A for all y-axis values. The
error that you receive depends on which method you apply to the series or
which property you set or return in the macro.
<P>
If you click Options on the Tools menu, click the Chart tab, and then click 
"Not Plotted (leave gaps)", all y-axis values are empty. A macro that 
accesses the series generates a run-time error.
<P>
If all the y-axis values for the series are #N/A, a run-time error appears
regardless of the Options dialog box settings.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use one of the following appropriate methods.
<P>
<P><h3>Method 1: All Y-Values Are Empty</h3>
 
<P>
To work around this problem, use the following steps to make the series
visible on the chart:

<OL><P><LI>On the Tools menu, click Options.

<P><LI>In Excel 97 and Excel 98, click the Chart tab. Under Plot Empty Cells 
   As, verify that the Zero check box is selected, and then click OK.
<P>
   In Microsoft Excel 5.0 or 7.0, click the Chart tab. Under Empty Cells
   Plotted As, verify that the Zero check box is selected, and then click 
   OK.
<P>
</OL>With the Zero check box selected, empty cells are plotted as zeros.
<P>
<P><h3>Method 2: All Y-Values Are #N/A</h3>
 
<P>
To work around this behavior, use a formula in the y-axis value cells that
returns blank data instead of an error. For example, if the #N/A is the
result of the following formula:
<P>
<PRE>   =VLOOKUP(C1,D2:E5,2)

</PRE></OL>modify the formula to the following:
<P>
<PRE>   =IF(ISERROR(VLOOKUP(C1,D2:E5,2)),"",VLOOKUP(C1,D2:E5,2))

</PRE>This causes any errors (#N/A, #REF!, and so on) to be returned as blanks. 
Data points that contain blanks for the y-axis values are displayed as 
zeros on the chart, and the series is visible. The run-time error does not 
appear when you access the series programmatically.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. Microsoft is researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a xl97 xl98<BR>
Keywords          : kberrmsg kbprg xlchart PgmOthr<BR>
Version           : WINDOWS: 5.0, 5.0c, 7.0, 7.0a, 97; MACINTOSH: 5.0, 5.0a, 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
