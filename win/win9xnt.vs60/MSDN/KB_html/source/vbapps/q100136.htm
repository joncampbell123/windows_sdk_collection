

<HTML>
<HEAD>
<TITLE>ACC: Two Functions to Calculate Age in Months and Years </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100136">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/06/16">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo SynFnc">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article explains how to create a function to calculate the age of a person or thing based on a given date.  This article assumes that you are familiar with Visual Basic...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAY5,QAML,QACE,QBS0,QBV8,QAB9,QAUD,QAYZ,QAH4,QA5F,QAMA,QBDM,QAD2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Two Functions to Calculate Age in Months and Years</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100136</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article explains how to create a function to calculate the age of a
person or thing based on a given date.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Enter the following code in a module:
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.
<P>
<PRE>   '==========================================================
   ' General Declaration
   '==========================================================
    Option Explicit

   '*************************************************************
   ' FUNCTION NAME: Age()
   '
   ' PURPOSE:
   '    Calculates age in years from a given date to today's date.
   '
   ' INPUT PARAMETERS:
   '    StartDate: The beginning date (for example, a birth date).
   '
   ' RETURN
   '    Age in years.

   '*************************************************************
    Function Age (varBirthDate As Variant) As Integer
       Dim varAge As Variant

      If IsNull(varBirthdate) then Age = 0: Exit Function

      varAge = DateDiff("yyyy", varBirthDate, Now)
      If Date &lt; DateSerial(Year(Now), Month(varBirthDate), _
                           Day(varBirthDate)) Then
         varAge = varAge - 1
      End If
      Age = CInt(varAge)
    End Function

    '*************************************************************
    ' FUNCTION NAME: AgeMonths()
    '
    ' PURPOSE:
    '  Compliments the Age() function by calculating the number of months
    '  that have expired since the last month supplied by the given date.
    '  If the given date is a birthday, the function returns the number of
    '    months since the last birthday.
    '
    ' INPUT PARAMETERS:
    '    StartDate: The beginning date (for example, a birthday).
    '
    ' RETURN
    '    Months since the last birthday.

    '*************************************************************
    Function AgeMonths(ByVal StartDate As String) As Integer
      Dim tAge As Double
      tAge = (DateDiff("m", StartDate, Now))
      If (DatePart("d", StartDate) &gt; DatePart("d", Now)) Then
          tAge = tAge - 1
      End If

      If tAge &lt; 0 Then
         tAge = tAge + 1
      End If

      AgeMonths = CInt(tAge Mod 12)

    End Function

</PRE><h3>Testing the Age() and AgeMonths() Functions</h3>
 
<P>
The following steps describe how to test the Age() and AgeMonths()
functions:

<OL><P><LI>Open a module or create a new one.

<P><LI>On the View menu, click Debug Window (or Immediate Window in Microsoft
   Access 2.0 or earlier).

<P><LI>Assume your friend's birth date was November 15, 1967 and today is
   June 3, 1993. Type the following in the Debug window and press ENTER:
<P>
<P><PRE>      ? Age("11/15/67")
</PRE><P>
   Note that Microsoft Access responds with the value 25 (years).

<P><LI>Type the following and press ENTER:
<P>
<P><PRE>      ? AgeMonths("11/15/67")
</PRE><P>
   Note that Microsoft Access responds with the value 6, indicating that
   six months have passed since this person's last birthday. Your friend
   is 25 years and six months old.
<P>
</OL><h3>Using the Age() and AgeMonths() Functions</h3>
 
<P>
The following procedure explains how to mark old orders by placing the age
value in a new control:

<OL><P><LI>In the sample database Northwind.mdb (or NWIND.MDB in Microsoft Access
   2.0 or earlier) enter the Age() and AgeMonth() functions in a new
   module.

<P><LI>Open the Orders form in Design view and add an unbound text box.

<P><LI>Type the following in the ControlSource property of the new control:
<P>
<P><PRE>      =Age([OrderDate]) &amp; " ys " &amp; AgeMonths([OrderDate]) &amp; " mo"
</PRE><P>
<P><PRE>    NOTE: In versions 1.x and 2.0, there is a space in Order Date.
</PRE>
<P><LI>View the form in Form view. Note that the age of the order is displayed
   in the new control.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about date differences, search the Help Index for
"DateDiff," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: birth birthday birthdate age abc elapsed time<BR>
Keywords          : kbprg PgmHowTo SynFnc<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
