

<HTML>
<HEAD>
<TITLE>ACC95: How to Import Microsoft Word Tables Using OLE Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141700">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/21">
<META NAME="Keywords" CONTENT="AutoGnrl kbole IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how you can import a table from a Microsoft Word for Windows document using OLE automation. You can use this technique to import data source docume...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA5V,QA1S,QAUD,QAKC,QDN9,QBC6,QA7O,QA7N,QAUJ,QA9Q,QA2K,QAG8,QDO7,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: How to Import Microsoft Word Tables Using OLE Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141700</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
<LI>Microsoft Word for Windows 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how you can import a table from a Microsoft Word
for Windows document using OLE automation. You can use this technique to
import data source documents created with the Mail Merge Helper in
Microsoft Word.
<P>
This article assumes that the document contains only a table, which begins
at the beginning of the document, and whose first record contains field
names. It also assumes that the Word document is not open at the time in
which the code is run to import the table. Finally, it assumes that you are
familiar with Visual Basic for Applications and with creating Microsoft
Access applications using the programming tools provided with Microsoft
Access. For more information about Visual Basic for Applications, please
refer to the "Building Applications with Microsoft Access for Windows 95"
manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following function prompts you for the name of the Word data document
to import and the number of columns and rows in the table. If you do not
know the total number of rows in the document, you can overestimate the
number. Later, you can delete any blank rows after the data is imported.
Because the first record of a Word Mail Merge data document contains field
names, it is important that these field names are legitimate field names in
a Microsoft Access table.

<OL><P><LI>Open a new, blank database.

<P><LI>Create a new module and type the following procedure:
<P>
<P><PRE>      Function ImportWordDoc()
<PRE></PRE>         Dim x As Variant, y As Variant, i As Variant, j As Variant
         Dim tabtext As String
         On Error GoTo Errlabel

         Dim db As DATABASE, t As TableDef, wordobject As Object, f As _
                 Field
         Dim r As Recordset, filename As String

         ' Get Word Merge Document to Import into Microsoft Access.
         filename = InputBox("Enter the Word Document With its Path,to _
         Import","Enter FileName", "C:\WINWORD")
         x = InputBox("Enter the Number of Columns", "Enter # of Columns")
         y = InputBox("Enter the Number of Rows", "Enter # of Rows")

         If x = "" Or y = "" Or filename = "" Then
           MsgBox "You must supply a valid filename, and the number of _
                   table columns and rows."
           Exit Function
         End If

         Set db = Currentdb()
         Set t = db.CreateTableDef("IMPORT WORD TABLE")
         Set wordobject = CreateObject("Word.Basic")
         wordobject.fileopen filename
         wordobject.selectcurword

         'Create Field Names.
         For i = 0 To x - 1
           Set f = t.CreateField(wordobject.selection(), DB_TEXT)
           t.Fields.Append f
           f.AllowZeroLength = True
           wordobject.nextcell
         Next i

         'Append Table to Database Table Collection.
         db.TableDefs.Append t

         ' Append records from Word table into Microsoft Access table,
         ' IMPORT WORD TABLE.
         Set r = db.OpenRecordset("IMPORT WORD TABLE")
         For j = 2 To y + 1
           r.AddNew
           For i = 0 To x - 1
              tabtext = wordobject.selection()
              ' Remove any carriage returns in the table cells.
              While InStr(1, tabtext, Chr$(13)) &lt;&gt; 0
              tabtext = Left$(tabtext, InStr(1, tabtext, Chr$(13)) - 1) &amp; _
              Right$(tabtext, Len(tabtext) - InStr(1, tabtext, Chr$(13)))
              Wend
              r.Fields(i) = tabtext
              wordobject.nextcell
           Next i
         r.UPDATE
         Next j
         Exit Function

       Errlabel:
         MsgBox Error
         Exit Function

       End Function

</PRE><P><LI>To test this function, on the View menu click Debug Window. Type the
   following line in the Debug window, and then press ENTER:
<P>
<P><PRE>      ?ImportWordDoc()
</PRE>
<P><LI>When prompted for the document name, enter the full path and name of
   the Word document to import.

<P><LI>When prompted for the number of columns, enter the number of columns in
   the Word table.

<P><LI>When prompted for the number of rows, enter the number of rows, not
   including the header row (that is, the first row of the table which
   contains the field names).

<P><LI>Save and close the module.

<P><LI>In the Database window, click the Table tab, and then double-click the
   Import Word Table to view the table in Datasheet view. If you have blank
   rows at the end of the table, you can select and delete them.

<P><LI>Switch the Import Word Table to Design view. Note that the data type
   for each field is Text. You may want to modify the data types as
   appropriate; for example, you may want to change a date field to
   Date/Time.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about OLE Automation, search for "OLE Automation,"
and then "OLE Automation" using the Microsoft Access Help Index.
<P>
For more information about OLE Automation, search on the phrase "OLE
Automation," and then view "Sharing information between office products"
using the Answer Wizard from the Microsoft Word for Windows 95 Help menu.
 
<PRE>Keywords          : AutoGnrl kbole IntpOleA
Technology        : kbole
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
