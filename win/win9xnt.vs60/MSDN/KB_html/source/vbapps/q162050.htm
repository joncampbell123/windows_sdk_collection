

<HTML>
<HEAD>
<TITLE>XL97: Using the LoadPicture Function with an Image Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162050">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/10">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, you can add an Image control to a UserForm. There are two ways to specify which picture file is displayed in the Image control; you can specify the picture when you design the UserForm, or when you run the UserForm. The techn...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBLP,QBS0,QAH4,QAYS,QBWS,QBVP,QAPN,QA0J,QAEF,QAUR,QAKD,QAFF,QAB2,QAMN,QAJX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Using the LoadPicture Function with an Image Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162050</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel 97, you can add an Image control to a UserForm. There
are two ways to specify which picture file is displayed in the Image
control; you can specify the picture when you design the UserForm, or when
you run the UserForm. The technique you use depends on whether you want to
store the picture file with your project.
<P>
The advantage of using the run-time method is that the picture file is not
stored with the project, which minimizes the size of the project. However,
if you distribute the project to others, you must remember to include the
picture file with the project file, and you must provide instructions for
placing the picture file in the correct location.
<P>
This article provides an example Visual Basic for Applications macro that
uses the LoadPicture function to load a picture file into an Image control
during run time.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Creating the UserForm and the Macro Code</h3>
 

<OL><P><LI>Save and close any open workbooks, create a new workbook, and then
   start the Visual Basic Editor (press ALT+F11).

<P><LI>On the Insert menu, click UserForm.

<P><LI>Add an Image control near the top and center of the UserForm, and
   then set the following values for the properties for the Image control.
<P>
<PRE>      Property   Value
      -----------------
      Name       Image1
      AutoSize   True
      Height     100
      Width      100

</PRE><P><LI>Add an OptionButton below the Image control to the UserForm and set
   the following values for the properties for the OptionButton.
<P>
<PRE>      Property   Value
      ------------------------
      Name       OptionButton1
      Caption    HI

</PRE><P><LI>Add another OptionButton below the first OptionButton to the UserForm
   and set the following values for the properties for the OptionButton.
<P>
<PRE>      Property   Value
      ------------------------
      Name       OptionButton2
      Caption    BYE

</PRE><P><LI>Add another OptionButton below the second OptionButton to the UserForm
   and set the following values for the properties for the OptionButton.
<P>
<PRE>      Property   Value
      ------------------------
      Name       OptionButton3
      Caption    Clear

</PRE><P><LI>Double-click the UserForm to display the code module that is associated
   with the UserForm.

<P><LI>Type the following code for the Initialize event for the UserForm:
<P>
<P><PRE>      Private Sub UserForm_Initialize()
</PRE>   
<PRE>          'Select the "HI" option button.
          OptionButton1.Value = True
   
          'Load the Hi.bmp picture file into the Image control.
          Image1.Picture = LoadPicture("C:\Windows\Desktop\hi.bmp")
      End Sub

</PRE></OL>NOTE: The path to your Desktop folder may be different, depending on how
you logged on to Windows. If you log on to Windows with a password, the
Desktop location may be the Windows\Profiles\&lt;username&gt;\Desktop folder.
Therefore, you must use a different path in the LoadPicture function.

<OL><P><LI>Type the following code for the Click events for the three
   OptionButtons:
<P>
<P><PRE>      Private Sub OptionButton1_Click()
</PRE>   
<PRE>          'Load the Hi.bmp picture file into the Image control.
          Image1.Picture = LoadPicture("C:\Windows\Desktop\hi.bmp")
   
      End Sub
   
      Private Sub OptionButton2_Click()
   
          'Load the Bye.bmp picture file into the Image control.
          Image1.Picture = LoadPicture("C:\Windows\Desktop\bye.bmp")
   
      End Sub
   
      Private Sub OptionButton3_Click()
   
          'Clear the picture file in the Image control.
          Image1.Picture = LoadPicture("")
   
      End Sub

</PRE></OL><h3>Creating the Two Picture Files</h3>
 

<OL><P><LI>Start Microsoft Paint.

<P><LI>Create the word "HI" (without the quotation marks) by free hand. The
   letters should be about 1.5 inches tall.

<P><LI>On the Paint toolbar, click Select, and then draw a square box around
   the letters you created. The sides of the box should be about 2 inches
   long.

<P><LI>On the Edit menu, click Copy To, in the Copy To dialog box, locate
   your Desktop, type "hi.bmp" (without the quotation marks) in the File
   name box, and then click Save.
<P>
</OL>NOTE: It is important to save your picture files to the Desktop because
the macro code in this article refers to files in your Windows\Desktop
folder.

<OL><P><LI>Repeat steps 2-4, but type the word "BYE" (without the quotation marks)
   and save the file as Bye.bmp.

<P><LI>Quit Microsoft Paint.
<P>
</OL><h3>Running the Macro</h3>
 

<OL><P><LI>In the Microsoft Excel Visual Basic Editor, run your UserForm.
<P>
   The UserForm is displayed, the picture in the Image control is the
   Hi.bmp picture, and the "HI" OptionButton is selected.

<P><LI>Click the "BYE" OptionButton.
<P>
</OL>The picture in the Image control is the Bye.bmp picture, and the "BYE"
OptionButton is selected.

<OL><P><LI>Click the "Clear" OptionButton.
<P>
</OL>The picture in the Image control is cleared completely.

<OL><P><LI>Close the UserForm.
<P>
</OL>NOTE: The Image control in the UserForm does not display any picture when
you view the UserForm while you are designing the UserForm.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Image control, click the Office Assistant in
the Visual Basic Editor, type "image control", click Search, and then click
to view "Things you can do with an Image control".
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If &lt;Product&gt; Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97<BR>
Keywords          : kbcode kbprg xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
