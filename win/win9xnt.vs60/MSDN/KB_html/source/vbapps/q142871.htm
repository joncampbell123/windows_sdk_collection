

<HTML>
<HEAD>
<TITLE>ACC: How to Create a Stopwatch Form (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142871">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1996/01/21">
<META NAME="Keywords" CONTENT="kbusage FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to create and use a form that contains Start/Stop and Reset command buttons that use the form's Timer event to display elapsed hours, minutes, and seco...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QDN9,QAH4,QBT6,QBV4,QACE,QAB9,QANF,QAHP,QAO4,QBS0,QBXS,QATX,QAMB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create a Stopwatch Form (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142871</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to create and use a form that contains
Start/Stop and Reset command buttons that use the form's Timer event to
display elapsed hours, minutes, and seconds in a text box control.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, FrmSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and FrmSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q150895.htm">Q150895</A></B>
   TITLE     : ACC95: Microsoft Access Sample Forms Available on MSL

   ARTICLE-ID: <B><A href="../access/q175066.htm">Q175066</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Forms Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create and use a form to track
elapsed time:

<OL><P><LI>Open any database.

<P><LI>Create a blank form not based on any table or query and set the
    following properties for the form:
<P>
       ScrollBars: Neither
       RecordSelectors: No
       NavigationButtons: No
       OnTimer: [Event Procedure]
       TimerInterval: 0

<P><LI>Add a text box to the form and set the following properties for the
    text box:
<P>
       Name: ElapsedTime
       DefaultValue: "00:00:00:00"
       Enabled: No
       Locked: Yes

<P><LI>Add a command button to the form and set the following properties for
    the command button:
<P>
       Name: btnStartStop
       Caption: Start
       OnClick: [Event Procedure]

<P><LI>Add a second command button to the form and set the following
    properties for the second command button:
<P>
       Name: btnReset
       Caption: Reset
       OnClick: [Event Procedure]

<P><LI>Click Code on the View menu to display the form module. In the
    Declarations section, type the following:
<P>
       Dim TotalElapsedMilliSec As Long
       Dim StartTickCount As Long
       Private Declare Function GetTickCount Lib "kernel32" () As Long

<P><LI>Type the following code for the form's OnTimer property event
    procedure:
<P>
       Private Sub Form_Timer ()
<P>
<PRE>          Dim Hours As String
          Dim Minutes As String
          Dim Seconds As String
          Dim MilliSec As String
          Dim Msg As String
          Dim ElapsedMilliSec As Long

          ElapsedMilliSec = (GetTickCount() - StartTickCount) + _
             TotalElapsedMilliSec

          Hours = Format((ElapsedMilliSec \ 3600000), "00")
          Minutes = Format((ElapsedMilliSec \ 60000) Mod 60, "00")
          Seconds = Format((ElapsedMilliSec \ 1000) Mod 60, "00")
          MilliSec = Format((ElapsedMilliSec Mod 1000) \ 10, "00")

          Me!ElapsedTime = Hours &amp; ":" &amp; Minutes &amp; ":" &amp; Seconds &amp; ":" _
             &amp; MilliSec
       End Sub

</PRE><P><LI>Type the following code for the btnStartStop command button's OnClick
    property event procedure:
<P>
       Private Sub btnStartStop_Click()
<PRE>          If Me.TimerInterval = 0 Then
             StartTickCount = GetTickCount()
             Me.TimerInterval = 15
             Me!btnStartStop.Caption = "Stop"
             Me!btnReset.Enabled = False
          Else
             TotalElapsedMilliSec = TotalElapsedMilliSec + _
                (GetTickCount() - StartTickCount)
             Me.TimerInterval = 0
             Me!btnStartStop.Caption = "Start"
             Me!btnReset.Enabled = True
          End If
     End Sub

</PRE><P><LI>Type the following code for the btnReset command button's OnClick
    property event procedure:
<P>
       Private Sub btnReset_Click()
<PRE>          TotalElapsedMilliSec = 0
          Me!ElapsedTime = "00:00:00:00"
       End Sub

</PRE><P><LI>Open the form in Form view to test the stop watch.
<P>
</OL>For more information about creating a Stopwatch Form in Microsoft Access
2.0, please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q128813.htm">Q128813</A></B>
   TITLE     : ACC2: How to Create a Stopwatch Form
</PRE></OL> 
<PRE>Keywords          : kbusage FmsHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
