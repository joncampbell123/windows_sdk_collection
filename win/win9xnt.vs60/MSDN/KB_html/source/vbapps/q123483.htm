

<HTML>
<HEAD>
<TITLE>ACC: How to Prevent Users from Creating New Databases </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123483">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/12/04">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo ScrtPerm">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to use the security constant dbSecDBCreate (or DB_SEC_DBCREATE in version 2.0) to prevent database users from creating new databases. This constan...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QBFY,QAZV,QBS0,QAGU,QAKJ,QBWG,QABO,QAH4,QBJZ,QA5F,QAMA,QBVV,QAEF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Prevent Users from Creating New Databases</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123483</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to use the security constant dbSecDBCreate (or
DB_SEC_DBCREATE in version 2.0) to prevent database users from creating new
databases. This constant can be set and removed only with Visual Basic for
Applications code.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you negate the security constant dbSecDBCreate (or DB_SEC_DBCREATE in
version 2.0) for a user, you remove that user's permission to create new
databases. The following example demonstrates how to use the dbSecDBCreate
constant to remove the permission to create new databases from all users in
the Users group:

<OL><P><LI>Quit Microsoft Access if it is running. Copy the System.mdw file
   (or SYSTEM.MDA file in version 2.0), usually in the Access folder,
   to a file with another name. For example, copy the file to a file
   named System.bak.

<P><LI>Start Microsoft Access and open the sample database Northwind.mdb
   (or NWIND.MDB in version 2.0)

<P><LI>Create a new module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following code in the module:
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>      Function Remove_DBCreate()
<PRE></PRE>        Dim d As Database, c As Container, SystemDB As String
        SystemDB = "c:\access\system.mda" ' Use path for your system.
        Set d = DBEngine(0).OpenDatabase(SystemDB)
        Set c = d.Containers!Databases
        c.Username = "Users"
        c.Permissions = c.Permissions And Not dbSecDBCreate
      End Function

   In Microsoft Access 2.0:

      Function Remove_DBCreate()
        Dim d As Database, c As Container, SystemDB As String
        SystemDB = "c:\access\system.mda" ' Use path for your system.
        Set d = DBEngine(0).OpenDatabase(SystemDB)
        Set c = d.Containers!Databases
        c.Username = "Users"
        c.Permissions = c.Permissions And Not DB_SEC_DBCREATE
      End Function

</PRE><P><LI>On the View menu, click Debug Window (or Immediate Window in version
   2.0).

<P><LI>In the Debug window, type the following line, and then press ENTER:
<P>
<P><PRE>      ?Remove_DBCreate()
</PRE>
<P><LI>Quit Microsoft Access, and then restart it. Log in as a member of the
   Users group.

<P><LI>On the File menu, click New Database. In the File Name box, type
   "c:\db1.mdb" (without the quotations marks), and then click OK. Note
   that you receive the following message:
<P>
<P><PRE>      No permissions on 'C:\DB1.MDB'
</PRE><P>
</OL>Note that if a member of the Users group has permission to create new
databases by also belonging to another group (such as the Admins group),
that user will still be able to create new databases. Microsoft Access
uses the most liberal permissions of the groups that a user belongs to.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about permissions, search the Help Index for
"Permissions property," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: rights<BR>
Keywords          : kbusage PgmHowTo ScrtPerm<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
