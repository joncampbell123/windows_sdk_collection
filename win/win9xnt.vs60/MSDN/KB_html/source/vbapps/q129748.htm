

<HTML>
<HEAD>
<TITLE>ACC: Using the PrtDevMode Property to Verify Custom Page Size </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129748">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/05/03">
<META NAME="Keywords" CONTENT="kbprg kbprint PgmHowTo RptProp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use the PrtDevMode property, keep the following printer driver characteristics in mind.  This article assumes that you are familiar with Visual Basic for Applicatio...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA4Q,QDN9,QBS0,QAPN,QAMA,QA5F,QADF,QBWA,QATX,QBVV,QABI,QAP2,QBXS,QANF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using the PrtDevMode Property to Verify Custom Page Size</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129748</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use the PrtDevMode property, keep the following printer driver
characteristics in mind.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.

<UL><LI>Set only those members that the printer driver supports. For example,
   if you set a custom page size for a driver that does not support a
   custom page size, you may encounter unexpected results.
<P>
   Follow these steps to find out if you are using a driver that supports
   the Custom page size option:
<P>
<P><PRE>    1. On the Start menu, point to Settings, and then click Printers.
</PRE><P>
<P><PRE>    2. In the Printers box, using the right-mouse button, right-click
       the printer name that represents the printer you are using in
       conjunction with this article. Click Properties.
</PRE><P>
<P><PRE>    3. In the '&lt;Printer name&gt;' Properties box, click the Paper tab and view
       the Paper size box. If the Custom icon does not appear in the box,
       you will not be able to use this article.
</PRE>
<LI>Set the PrtDevMode property's Fields member if you change any other
   member to let the printer driver know which members you are changing.

<LI>Change only the first 68 bytes of the PrtDevMode property. Printer
   drivers are able to store driver-specific information after the first
   68 bytes; therefore, it is important not to overwrite this information.
<P>
</UL>To verify that a report has the correct page size, check the setting in
the PrtDevMode property. The PrtDevMode property is available only in
Visual Basic for Applications.
<P>
To create the Sub procedure, follow these steps:
<P>
NOTE: If you are using Microsoft Access 2.0 on a computer running Windows
95, you will need to modify the Type statement in step 1 to read as
follows:
<P>
<PRE>    Type str_DevMode
      RGB As String * 512
    End Type

</PRE>For more information about PrtDevMode settings in Windows 95, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q140286.htm">Q140286</A></B>
   TITLE     : ACC2: PrtDevMode Settings Do Not Work Under Windows 95

</PRE><P><LI>Create a module and type the following lines in the Declarations
    section:
<P>
      Option Explicit
<P>
      Type zwtDevModeStr
<PRE>        RGB As String * 94
      End Type

      Type zwtDeviceMode
        dmDeviceName As String * 16
        dmSpecVersion As Integer
        dmDriverVersion As Integer
        dmSize As Integer
        dmDriverExtra As Integer
        dmFields As Long
        dmOrientation As Integer
        dmPaperSize As Integer
        dmPaperlength As Integer
        dmPaperWidth As Integer
        dmScale as Integer
        dmCopies As Integer
        dmDefaultSource As Integer
        dmPrintQuality As Integer
        dmColor As Integer
        dmDuplex As Integer
        dmResolution As Integer
        dmTTOption As Integer
        dmCollate As Integer
        dmFormName As String * 16
        dmPad As Long
        dmBits As Long
        dmPW As Long
        dmDFI As Long
        dmDRr as Long
      End Type

</PRE><P><LI>Create the following procedure:
<P>
    NOTE: In the following sample code, an underscore (_) at the end of a
    line is used as a line-continuation character. Remove the underscore
    from the end of the line when re-creating this code in Access Basic.
<P>
<PRE>      Sub CheckCustomPage (rptName As String)
         ' The zwtDevModeStr and zwtDeviceMode types are defined in the
         ' zwAllGlobals module in the WZFRMRPT.MDA file.
         Dim DevString As zwtDevModeStr
         Dim DM As zwtDeviceMode
         'Constants for the Fields member.
         Const DM_PAPERSIZE = &amp;H2
         Const DM_PAPERLENGTH = &amp;H4
         Const DM_PAPERWIDTH = &amp;H8
         Dim DevModeExtra As String
         Dim rpt As Report
         Dim response
         Dim msg As String
         'Open the report in Design view.
         DoCmd.OpenReport rptName, A_DESIGN
         'DoCmd OpenReport rptName, A_DESIGN (in Microsoft Access 2.0)
         Set rpt = Reports(rptName)
         If Not IsNull(rpt.PrtDevMode) Then
            'Copy the PrtDevMode property to a string.
            DevModeExtra = rpt.PrtDevMode
            DevString.rgb = DevModeExtra
            LSet DM = DevString
            'Check for the custom page size.
            If DM.dmPaperSize = 256 Then
               'Display the custom page size.
               msg = "The Custom Page Size is " &amp; DM.dmPaperWidth / 254
               msg = msg &amp; " inches wide by " &amp; DM.dmPaperLength / 254
               msg = msg &amp; " inches long. Change the size?"
               response = MsgBox(msg, 4)
            Else
               msg = "The report does not have a custom page. "
               msg = msg &amp; " Do you want to define one?"
               response = MsgBox(msg, 4)
            End If
            If response = 6 Then
               'User chose Yes; change the size.
               'Initialize the Fields member.
               DM.dmFields = DM.dmFields Or DM_PAPERSIZE Or _
                  DM_PAPERLENGTH Or DM_PAPERWIDTH
               'Set the page size.
               DM.dmPaperSize = 256
               msg = "Please enter Page Length in inches"
               DM.dmPaperLength = InputBox(msg) * 254
               msg = "Please enter Page Width in inches"
               DM.dmPaperWidth = InputBox(msg) * 254
               'Update the first 68 bytes of the PrtDevMode property.
               LSet DevString = DM
               Mid$(DevModeExtra, 1, 68) = DevString.rgb
               rpt.PrtDevMode = DevModeExtra
            End If
         End If
      End Sub

</PRE><P><LI>On the View menu, click Debug Window (or Immediate window in version
    2.0), type the following line in the Debug window, and press ENTER
<P>
      CheckCustomPage "&lt;Report1&gt;"
<P>
    where &lt;Report1&gt; is the name of your report.
<P>
    Note that the report opens in Design view, the custom page size (if it
    exists) is displayed, and you are prompted to change it.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using PrtDevMode, search the Help Index for
"PrtDevMode," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : kbprg kbprint PgmHowTo RptProp
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
