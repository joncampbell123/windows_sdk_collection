

<HTML>
<HEAD>
<TITLE>OL97 VBScript: How to Populate a ComboBox with Your Contacts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167240">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1997/04/22">
<META NAME="Keywords" CONTENT="kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article describes how you can use Visual Basic Scripting Edition (VBScript) version 2.0 or higher, and Microsoft Outlook 97 to populate a ComboBox control with the FullName field of all of your contacts.  MORE INFORMATION  Microsoft provides p...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QDNQ,QBVO,QBWS,QAIF,QBV3,QBUP,QBXS,QAH4,QBXD,QAI2,QAVZ,QAHP,QAYC,QBWA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OL97 VBScript: How to Populate a ComboBox with Your Contacts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167240</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how you can use Visual Basic Scripting Edition
(VBScript) version 2.0 or higher, and Microsoft Outlook 97 to populate
a ComboBox control with the FullName field of all of your contacts.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>NOTE: This example does not work with VBScript, version 1.0. You must
install VBScript, version 2.0 or higher, to use this example.
<P>
For additional information on how to determine your version of VBScript,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q167138.htm">Q167138</A></B>
   TITLE     : OL97: General Information About Using VBScript with Outlook

</PRE>The latest version of VBScript is available on the Microsoft Web site
at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/vbscript">http://www.microsoft.com/vbscript</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE>This example contains four steps.

<OL><P><LI>Create a new Contact form and place a ComboBox1 control on the form.

<P><LI>Type the VBScript code that populates ComboBox1 with the FullName
   field of all of your contacts.

<P><LI>Publish the new form so that the Item Open event runs when you open the
   new Contact form.

<P><LI>Open the new form and expose the ComboBox list containing your contacts.
<P>
</OL><h3>Create the Form and ComboBox1 Control</h3>
 

<OL><P><LI>On the Outlook File menu, click New, and then Contact.

<P><LI>On the Tools menu, click "Design Outlook Form."

<P><LI>Click the (P.2) form tab.

<P><LI>On the Form menu, click "Display This Page."

<P><LI>On the Form menu, click Rename Page, and in the Page name box,
   type TabName and click OK.
<P>
   NOTE: The VBScript code uses this name.

<P><LI>On the Form menu, click Control Toolbox and drag the ComboBox to the
   form's TabName page.
<P>
</OL><h3>Create the VBScript Code to Populate ComboBox1</h3>
 

<OL><P><LI>On the Form menu, click View Code, to open the Script Editor.

<P><LI>Type the following code in the Script Editor.
<P>
<P><PRE>    Sub Item_Open
    ' Set the NameSpace object
    Set objOLNS = Application.GetNameSpace("MAPI")
    ' Set the Contacts folder, which is in the MAPI NameSpace
    Set objContactFolder = objOLNS.GetDefaultFolder(10)
    ' Set the collection of all Contact items
    Set objAllContacts = objContactFolder.Items
    ' Set the object referring to the form page the combobox is on
    Set objFormTab = Item.GetInspector.ModifiedFormPages("TabName")
    ' Set the object referring to the combobox
    Set objCombo = objFormTab.Controls("ComboBox1")
    ' Loop through all of the contacts
    For Each Contact in objAllContacts
      ' Add the current contact's fullname to the combobox
      objCombo.AddItem Contact.FullName
    Next
    End Sub
</PRE>
<P><LI>On the Script Editor File menu, click Close.

<P><LI>On the form Tools menu, click "Design Outlook Form."
<P>
</OL><h3>Publish the New Contact Form</h3>
 

<OL><P><LI>On the form File menu, click "Publish Form As."

<P><LI>In the Form name box, type a name for your new form and click
   Publish In.

<P><LI>In the "Set Library To" box, click "Folder Forms Library."

<P><LI>In the folder list, click to select your Contacts folder, and then
   click OK.

<P><LI>Click Publish to publish the form in your Contacts folder.

<P><LI>On the File menu, click Close to close the form.
<P>
</OL>Using the New Contact Form
 

<OL><P><LI>Open your Contacts folder.

<P><LI>On the Contacts menu, click the new form name to open your newly
   published form.

<P><LI>In the new form, click the TabName tab.
<P>
</OL>On the TabName page of the form, you will see a single ComboBox. If you
click to display the ComboBox list, you will see a list containing the full
name of all of your contacts.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating solutions with Microsoft Outlook 97,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q166368.htm">Q166368</A></B>
   Title     : OL97: How to Get Help Programming with Outlook

   Article-ID: <B><A href="../vbapps/q170783.htm">Q170783</A></B>
   Title     : OL97: Q&amp;A: Questions about Customizing or
               Programming Outlook
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OutSol OutSol97
<P>

Keywords          : kbcode<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
