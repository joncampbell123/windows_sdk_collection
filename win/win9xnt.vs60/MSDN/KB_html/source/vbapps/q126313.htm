

<HTML>
<HEAD>
<TITLE>XL: Macro Doesn't Function on Multiple Sheets in Group Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126313">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/02/20">
<META NAME="Keywords" CONTENT="kbcode kbinterop kbprg xlvbahowto AutoGnrl PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use a Microsoft Visual Basic for Applications  procedure to perform an action while worksheets are selected in group mode,  the action performed may only be performed on one of the worksheets instead  of on every worksh...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAXM,QBS0,QA2Q,QAPF,QBE7,QBE6,QAPN,QAYL,QAB9,QDNQ,QAG2,QA5C,QDNM,QBDM P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Macro Doesn't Function on Multiple Sheets in Group Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126313</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use a Microsoft Visual Basic for Applications 
procedure to perform an action while worksheets are selected in group mode, 
the action performed may only be performed on one of the worksheets instead 
of on every worksheet in the selection.
<P>
This behavior may also occur if you use a Visual Basic Standard or
Professional Edition procedure or an AppleScript script to perform an
action while worksheets are selected in group mode in Microsoft Excel.
<P>
For example, if you use a Visual Basic procedure or an AppleScript script
to select multiple worksheets, and you spell check the selected worksheets,
if you use the Change All button to change a word that is found on all of
the selected worksheets, the word is only changed on the active worksheet.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs because some of the Visual Basic commands in Microsoft
Excel perform an action on one worksheet at a time, even if the equivalent
menu command performs the action on all selected sheets.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To work around this behavior, you must loop through each sheet in the
selection individually in your procedure or script to perform the action as
in the following examples. (Note that the following examples use the
Spelling command to demonstrate the workaround. These examples can be
modified to work with other commands.)
<P>
<P><h3>Sample Visual Basic Procedure</h3>
 
<P>
<PRE>   Sub SpellCheck()

      ' Dimension variable x as Object type
      Dim x as Object
      ' Group select Sheet1, Sheet2, and Sheet3 worksheets
      ' Note that there are other methods for selecting multiple sheets
      Sheets(Array("sheet1", "sheet2", "sheet3")).Select

      ' Perform spell check on each selected sheet
      ' Note that the Change All button will only change
      ' words on one worksheet, but the spell checker dialog
      ' will appear once for each sheet selected.
      For Each x In ActiveWindow.SelectedSheets
         x.CheckSpelling CustomDictionary:="CUSTOM.DIC", _
            IgnoreUpperCase:=False, AlwaysSuggest:=True
      Next x

   End Sub

</PRE><h3>AppleScript Example</h3>
 
<P>
The following AppleScript script does the following:

<OL><P><LI>Activates Microsoft Excel.

<P><LI>Selects worksheets Sheet1, Sheet2, and Sheet3.

<P><LI>Displays Spell Checker once for each selected worksheet.
<P>
</OL>NOTE: The SpellCheck command in the following example should be entered as
one line.
<P>
<PRE>   tell Application "Microsoft Excel"
      Activate
      Select Sheet { "Sheet1", "Sheet2", "Sheet3" }
      repeat with x in ( SelectedSheets of ActiveWindow )
         SpellCheck x UsingDictionary "Macintosh HD:Microsoft:Custom
            Dictionary" with AlwaysSuggest without IgnoreUppercase
      end repeat
  end tell

</PRE></OL><h3>Visual Basic, Standard or Professional Edition Example</h3>
 
<P>
NOTE: The following example assumes that the worksheets that you want to
spell check are already selected in the active workbook in Microsoft Excel
before you run this procedure.
<P>
<PRE>   Sub XL_SpellChk_Selection ()
      ' Dimension variables
      Dim xl As Object, NumSheets as Integer, x as Integer
      ' Activate Microsoft Excel and assign to variable xl
      Set xl = GetObject(, "Excel.Application.5")

      NumSheets = xl.activewindow.selectedsheets.count

      For x = 1 to numSheets
         ' Note that the following command should be entered on one line
         xl.ActiveWindow.SelectedSheets.Item(x).CheckSpelling "CUSTOM.DIC",
           False, True
      Next x

      Set xl = Nothing
   End Sub

</PRE>NOTE: The following example selects the worksheets, one at a time, that you
want to spell check (Sheet1, Sheet2, and Sheet3 in this example) in the
active workbook in Microsoft Excel, and spell checks each sheet
individually.
<P>
<PRE>   Sub XL_SpellChk()
      ' Dimension variables
      Dim xl As Object, n As Integer, wksheet()
      ' Dimension wksheet variable as array with 3 elements
      ReDim wksheet(3)
      ' Assign worksheet you want to spell check
      ' as elements of wksheet array
      wksheet(1) = "sheet1"
      wksheet(2) = "sheet2"
      wksheet(3) = "sheet3"

      ' Activate Microsoft Excel and assign to variable xl
      Set xl = GetObject(, "Excel.Application.5")

      For n = 1 To 3
         ' Display Spell Checker dialog, once for each sheetname in array
         xl.Sheets(wksheet(n)).CheckSpelling "CUSTOM.DIC", False, True
      Next n

      Set xl = Nothing
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Selecting A Sheet Or Sheets, choose the
Search button in Help and type:
<P>
<PRE>   selecting worksheets
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 98 97 7.00 5.00 5.00c group edit active sheet only <BR>
procedure modifies first sheet only find replace search all
<P>

Keywords          : kbcode kbinterop kbprg xlvbahowto AutoGnrl PgmOthr<BR>
Version           : WINDOWS:5.0,5.0c,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
