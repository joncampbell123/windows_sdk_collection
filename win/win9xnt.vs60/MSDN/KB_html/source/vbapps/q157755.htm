

<HTML>
<HEAD>
<TITLE>XL97: Using "Checked", "Gray", and "Unchecked" in Macros </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157755">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/10/17">
<META NAME="Keywords" CONTENT="kbcode kberrmsg kbprg xlvbainfo xl97vbmigrate">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, when you run a Visual Basic for Applications macro, you may receive the following error message:     Compile error:    Invalid Qualifier  CAUSE =====  This problem will occur if the following conditions are both true:   - You...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QABH,QABI,QAH4,QANF,QAG9,QAUJ,QA7O,QAOE,QAMN,QAB5,QBS0,QAB4,QAKP,QDNE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Using "Checked", "Gray", and "Unchecked" in Macros</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157755</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, when you run a Visual Basic for Applications macro,
you may receive the following error message:
<P>
<PRE>   Compile error:
   Invalid Qualifier

</PRE><h2>CAUSE</h2>
 
<P>
This problem will occur if the following conditions are both true:

<UL><LI>You have controls in a custom dialog box named, without quotation
   marks, "Checked", "Gray", or "Unchecked".
<P>
<P><PRE>    -and-
</PRE>
<LI>In your macro, you enclose the name of one of the controls in brackets
   when referring to it. For example:
<P>
<P><PRE>      [Checked].Value = xlOn
</PRE><P>
</UL>NOTE: This problem does not apply to controls named "Grey".
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can avoid this problem by performing either of the following:

<UL><LI>Rename your controls so that none of them are named "Checked", "Gray",
   or "Unchecked". If you do this, you will also need to modify your
   Visual Basic macro code so that it refers to controls by their new
   names.
<P>
<P><PRE>    -or-
</PRE>
<LI>Within your macros, replace all occurrences of "[&lt;controlname&gt;]" with
   a proper reference to the specified control. For example, if your
   macro contains the following line of code:
<P>
<P><PRE>      [Unchecked].Value = xlOff
</PRE><P>
   and "Unchecked" is the name of a check box within your custom dialog
   box, change the line to read:
<P>
<P><PRE>      ActiveDialog.Checkboxes("Unchecked").Value = xlOff
</PRE><P>
   If you do this throughout your macro code, you can still use controls
   named "Checked", "Gray", and "Unchecked".
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In earlier versions of Microsoft Excel, the words "Checked", "Gray", and
"Unchecked" have no special meaning. However, in Microsoft Excel 97, these
three words are global constants belonging to the Stdole Type Library.
<P>
Because of this, it is not possible to refer to these constants by
enclosing them in brackets when running a macro in Microsoft Excel 97. Use
either of the workarounds shown above to eliminate this problem.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00<BR>
Keywords          : kbcode kberrmsg kbprg xlvbainfo xl97vbmigrate<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
