

<HTML>
<HEAD>
<TITLE>VBA: How to Create a New Contact Item in Outlook with Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161012">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/12/13">
<META NAME="Keywords" CONTENT="kbinterop IntpOleA kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to use Automation from a Microsoft Access form to start Microsoft Outlook and display a new contact screen for input. You can change just one l...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QAYC,QA1S,QAH4,QDN9,QA2K,QBWS,QAIJ,QBUP,QAGB,QBS0,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VBA: How to Create a New Contact Item in Outlook with Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161012</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Outlook 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to use Automation from a Microsoft Access
form to start Microsoft Outlook and display a new contact screen for
input. You can change just one line of code to make this example apply to
a new Microsoft Outlook appointment, journal entry, mail message, note,
post, or task.
<P>
For information about how to run Microsoft Schedule+ with Automation,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q147633.htm">Q147633</A></B>
   TITLE     : ACC: How to Run Schedule+ from MS Access Using Automation

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example shows how to create a form in Microsoft Access that
starts Microsoft Outlook from a command button. Then, the Automation code
opens a new contact screen for input in Microsoft Outlook. After you enter
the contact, and save and close the contact form, the Automation code
quits Microsoft Outlook and returns to the Microsoft Access form.
<P>
To run Microsoft Outlook from a Microsoft Access form, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new form not based on any table or query in Design view:
<P>
<P><PRE>      Form: FrmOutlook
      ---------------------------
      Caption: Outlook Form
</PRE><P>
<P><PRE>      Command button:
<PRE></PRE>         Name: RunOutlook
         Caption: Start Outlook
         OnClick: =StartOutlook()

</PRE><P><LI>On the View menu, click Code to open the form module.

<P><LI>On the Tools menu, click References.

<P><LI>Click Microsoft Outlook 8.0 Object Library in the Available References
   box. If it does not appear in the list, click the Browse button and
   browse for MSOutl8.olb, which is installed by default in the C:\Program
   Files\Microsoft Office\Office folder.

<P><LI>Click OK to close the References dialog box.

<P><LI>Type the following procedure in the form's code module:
<P>
<P><PRE>      Public Function StartOutLook()
<PRE></PRE>         On Error GoTo StartOutLook_Error
         Dim spObj As Object, MyItem As Object

         ' Create a Microsoft OutLook object.
         Set spObj = CreateObject("Outlook.Application")

         ' Create and open new contact form for input.
         ' You can substitute olAppointmentItem, olJournalItem, olMailItem,
         ' olNoteItem, olPostItem, or olTaskItem for olContactItem.
          Set MyItem = spObj.CreateItem(olContactItem)
          MyItem.Display

         ' Quit Microsoft Outlook.
          Set spObj = Nothing
          Exit Function

      StartOutLook_Error:
         MsgBox "Error: " &amp; Err &amp; " " &amp; Error
         Exit Function
      End Function

</PRE><P><LI>Close the module and switch the form to Form view.

<P><LI>Click the Start Outlook button. Note that Microsoft Outlook starts and
   displays a new contact screen.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using Automation with Microsoft Outlook, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q160502.htm">Q160502</A></B>
   TITLE     : ACC: Using Automation to Add Appointments to Microsoft
               Outlook

</PRE></OL>For more information about using Automation to work with other programs,
search the Help Index for "Automation, overview," or ask the Microsoft
Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OutSol OutSol97<BR>
Keywords          : kbinterop IntpOleA kbfaq<BR>
Technology        : kbole<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
