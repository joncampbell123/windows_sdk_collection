

<HTML>
<HEAD>
<TITLE>ACC: Using TAPI to Dial a Phone Under Win95/NT 4.0 (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141625">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes a sample Visual Basic function, DialNumber(), that you can use to dial a telephone number from Microsoft Access 7.0 and 97 using your computer's modem...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDL4,QA1S,QBXE,QDN9,QAY5,QAB9,QBWP,QBS0,QBV8,QAKC,QBC6,QAPN,QDL9,QBWO,QBWN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using TAPI to Dial a Phone Under Win95/NT 4.0 (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141625</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes a sample Visual Basic function, DialNumber(),
that you can use to dial a telephone number from Microsoft Access 7.0
and 97 using your computer's modem. This method uses Telephony
Application Programming Interface (TAPI) function calls to dial the
number.
<P>
This technique provides the same behavior as the built-in AutoDialer
feature in Microsoft Access 7.0 and 97.
<P>
NOTE: Although this technique works in Windows 95 and Windows NT 4.0,
it may not work in Windows NT 3.51 because Windows NT 3.51 does not have
built-in TAPI support. For more information about dialing a phone number
in Microsoft Access without using TAPI, please see the following article
here in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q148857.htm">Q148857</A></B>
   TITLE     : ACC: How to Dial a Phone Number Using MS Access 95/97

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Although the TAPI software development kit (SDK) contains a complete set
of telephony functions, you need only one function, tapiRequestMakeCall(),
to dial a phone number.
<P>
The following steps demonstrate how to create and use the DialNumber()
function in Microsoft Access 7.0 and 97.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following lines in the Declarations
   section:
<P>
   NOTE: You may have some Microsoft Windows API functions defined in an
   existing Microsoft Access library; therefore, your declarations may be
   duplicates. If you receive a duplicate procedure name error message,
   remove or comment out the declarations statement in your code.
<P>
   NOTE: Type the Declare statement exactly as shown, including
   capitalization, because Win32 names are case-sensitive.
<P>
<P><PRE>      Option Explicit
      Declare Function tapiRequestMakeCall Lib "tapi32.dll" _
<PRE></PRE>         (ByVal stNumber As String, ByVal stDummy1 As String, _
         ByVal stDummy2 As String, ByVal stDummy3 As String) As Long
      Public Const ID_CANCEL = 2
      Public Const MB_OKCANCEL = 1
      Public Const MB_ICONSTOP = 16, MB_ICONINFORMATION = 64

</PRE><P><LI>Type the following procedure:
<P>
<P><PRE>      ' ***********************************************************
      ' FUNCTION: DialNumber()
      '
      ' PURPOSE: To dial a telephone number using the computer's modem
      '
      ' ARGUMENTS:
<PRE></PRE>      '    PhoneNumber: The telephone number to dial
      '
      ' EXAMPLE:
      '    Type the following in the Debug window to dial a phone number:
      '
      '       ? DialNumber("555-1212")
      ' ***********************************************************
      Function DialNumber (PhoneNumber)
         Dim Msg As String, MsgBoxType As Integer, MsgBoxTitle As String
         Dim RetVal As Long

         ' Ask the user to pick up the phone.
         Msg = "Please pickup the phone and click OK to dial " _
            &amp; PhoneNumber
         MsgBoxType = MB_ICONINFORMATION + MB_OKCANCEL
         MsgBoxTitle = "Dial Number"

         If MsgBox(Msg, MsgBoxType, MsgBoxTitle) = ID_CANCEL Then
            Exit Function
         End If

         ' Send the telephone number to the modem.
         RetVal = tapiRequestMakeCall(PhoneNumber, "", "", "")

         If RetVal &lt; 0 Then
            Msg = "Unable to dial number " &amp; PhoneNumber
            GoTo Err_DialNumber
         End If

         Exit Function

      Err_DialNumber:      'This is not an On Error routine.
         Msg = Msg &amp; vbCr &amp; vbCr &amp; _
            "Make sure no other devices are using the Com port"
         MsgBoxType = MB_ICONSTOP
         MsgBoxTitle = "Dial Number Error"
         MsgBox Msg, MsgBoxType, MsgBoxTitle

      End Function

</PRE><P><LI>Open the Employees form in Design view.

<P><LI>Add a command button to the form next to the HomePhone field and set
   the command button's properties as follows:
<P>
<P><PRE>      Name: btnDialPhone
      Caption: Dial
      OnClick: =DialNumber([HomePhone])
</PRE>
<P><LI>View the form in Form view. To dial an employee's home phone number,
   click the Dial button.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the AutoDialer feature, search the Help Index
for "AutoDialer."
<P>
For more information about the Declare statement, search the Help Index
for "Declare Statement."
 
<PRE>Keywords          : kbprg PgmApi
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
