

<HTML>
<HEAD>
<TITLE>ACC: Text Import Wizard Doesn't Import Data Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149946">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/04/16">
<META NAME="Keywords" CONTENT="kberrmsg kbusage IsmTxtfx PgmFilM">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you import certain text files, using the Import Text Wizard, you may see one of the following symptoms:   - The records in the imported file are combined into one, continuou...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA5V,QA1S,QAUD,QATX,QAIH,QDO0,QDN9,QBE7,QBE6,QBS0,QBXT,QAIB,QAY5,QAMB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Text Import Wizard Doesn't Import Data Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149946</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you import certain text files, using the Import Text Wizard, you may
see one of the following symptoms:

<UL><LI>The records in the imported file are combined into one, continuous
   record.

<LI>The Import Text Wizard stops responding (hangs), or your computer
   stops processing.

<LI>You receive one of the following error messages:
<P>
<P><PRE>    - External File isn't in the expected format
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - Out of stack space
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
Certain text files are created with only a Chr(10) (linefeed character) at
the end of each line to indicate a new record. The Import Wizard expects a
Chr(13) and a Chr(10) to recognize the end of a record and the character
codes MUST be in this order. Because neither Microsoft Access 7.0 nor 97
see this combination, they interpret the imported data as one record.
Microsoft Word and Microsoft Access 2.0 on the other hand, recognize
Chr(10) to indicate the end of a record.
<P>
NOTE: Unix text files use the line feed character at the end of the line.
OS/2 and MS-DOS text files use the line feed and the carriage return
together at the end of the line.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use one of the following three methods to work around this behavior.
<P>
<P><h3>Method 1</h3>
 
<P>
Insert a Chr(13) after each record using a text editor (such as NotePad).
<P>
<P><h3>Method 2</h3>
 
<P>
Use Microsoft Word 6.0 or later to search for paragraph marks and replace
them with carriage returns/line feeds.
<P>
For more information about finding and replacing paragraph marks in
Microsoft Word, search the Microsoft Word Help Index for "find and
replace," and then "Examples of special characters and document elements
you can find and replace."
<P>
<P><h3>Method 3</h3>
 
<P>
Use the following steps to create a Visual Basic for Applications function
that checks to see if a file contains only a CHR(10) at the end of each
record and, if so, replaces it with a CHR(13) + CHR(10) so that Microsoft
Access will be able to successfully import the records.
<P>
This part of the article assumes that you are familiar with Visual Basic
for Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.

<OL><P><LI>Open any database and create a new module. Type the following line in
   the Declarations section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedures:
<P>
<P><PRE>      Function TestImportText(ImportTextFile As String)
<PRE></PRE>        Dim x As String, y As String
        Dim NumberOfCarriageReturns As Long
        Dim NumberOfLineFeeds As Long

        NumberOfCarriageReturns = 0
        NumberOfLineFeeds = 0

        Open ImportTextFile For Input As #1
        Do Until EOF(1)
          Line Input #1, x
          If InStr(1, x, Chr(13)) &gt; 0 Then
             NumberOfCarriageReturns = NumberOfCarriageReturns + 1
          End If
          If InStr(1, x, Chr(10)) &gt; 0 Then
             NumberOfLineFeeds = NumberOfLineFeeds + 1
          End If
        Loop
        Close #1
      'If no Carriage returns found, run the next function to modify
      'the text file.

         If NumberOfCarriageReturns &lt; NumberOfLineFeeds And _
            NumberOfLineFeeds &gt; 0 Then
            Dim NameOfNewText As String
            NameOfNewText = InputBox( _
            "Enter The Name Of The New TextFile In Which To Save The _
                 Changes.")
            y = ImportText(ImportTextFile, NameOfNewText)
         End If
      End Function

      Function ImportText(OldText As String, NewText As String)
        Dim x As String, Endvalue As Integer
        Dim StartValue As Integer, OutputTxt As String

        Open OldText For Input As #1
        Open NewText For Output As #2
        Do Until EOF(1)
           Line Input #1, x
           Endvalue = InStr(1, x, Chr(10))
           StartValue = 1
           Do Until Endvalue = 0
              If Endvalue &gt; 0 Then
                 OutputTxt = Mid(x, 1, (Endvalue - 1))
                 Print #2, OutputTxt
                 StartValue = Endvalue + 1
                 x = Mid(x, StartValue)
                 Endvalue = InStr(1, x, Chr(10))
              End If
           Loop
        Loop
        Close #1
        Close #2
        MsgBox NewText &amp; " Successfully created."
      End Function

</PRE><P><LI>To run this function, type the following line in the Debug window,
   and then press ENTER
<P>
<P><PRE>      ? TestImportText("&lt;name of text file to import&gt;")
</PRE><P>
   where &lt;name of text file to import&gt; is the location of your file, for
   example:
<P>
<P><PRE>      ? TestImportText("c:\my documents\testfile.txt")
</PRE><P>
</OL>If the text file does not need to show carriage returns, an input box will
appear asking for the name of the new text file that is going to be
created. This will prevent the original text file from being overwritten.
Type in the name of the new text file and click OK. This will create a new
text file that is in the proper format for Microsoft Access 7.0 or
97 to import.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about importing, search the Help Index for "importing
data," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: line feed return delimiter EBCDC UNIX OS/2 DOS<BR>
Keywords          : kberrmsg kbusage IsmTxtfx PgmFilM<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
