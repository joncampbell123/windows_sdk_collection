

<HTML>
<HEAD>
<TITLE>XL97: ParamArray Must be Declared as an Array of Variant </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158355">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/10/29">
<META NAME="Keywords" CONTENT="kbprg xlvbahowto xlvbainfo xl97vbmigrate">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you attempt to run a Visual Basic for Applications macro in Microsoft Excel 97, or while you are editing code in a Visual Basic module, you may receive the following error message:     Compile error:    ParamArray must be declared as an array ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAYL,QBS0,QAY5,QAB9,QAPN,QAG1,QAH4,QAB4,QBV8,QAVX,QAVW,QACJ,QAGB,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: ParamArray Must be Declared as an Array of Variant</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158355</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to run a Visual Basic for Applications macro in Microsoft
Excel 97, or while you are editing code in a Visual Basic module, you may
receive the following error message:
<P>
<PRE>   Compile error:
   ParamArray must be declared as an array of Variant

</PRE><h2>CAUSE</h2>
 
<P>
This will occur if you have declared a variable as a ParamArray and either
of the following conditions are true:

<UL><LI>The variable name is not immediately followed by an open and a close
   parenthesis, like this:
<P>
<P><PRE>      ParamArray MyVar()
</PRE><P>
<P><PRE>    -or-
</PRE>
<LI>The open and close parentheses that follow the variable name are
   followed by "As &lt;vartype&gt;", where &lt;vartype&gt; is any variable type other
   than Variant.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
In Microsoft Excel 97, variables declared as ParamArrays must be
immediately followed by an open and a close parenthesis, and must be
declared either as type Variant or as no type at all. Note that if a data
type is not specified, the variable will default to the Variant data type.
<P>
Making this change will allow your macros to work in all versions of
Microsoft Excel that support the Visual Basic for Applications macro
language, including Microsoft Excel 97.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you write a custom Visual Basic subroutine function in Microsoft
Excel, the last argument accepted by the function can be declared as a
ParamArray. When you do this, the function will accept one or more values
and place them in the specified variable as an array, so that they can then
be used within the function. For example, if you have the following
function:
<P>
<PRE>   Function Test(X As Integer, ParamArray Y())
       Test = "Hello"
   End Function

</PRE>If you enter the formula
<P>
<PRE>   =Test(6,7,8,9,10)

</PRE>in a cell, the first argument (6) will be used as the value of the variable
X. The remaining arguments (7, 8, 9, 10) will become elements in the array
Y().
<P>
When you declare a variable as a ParamArray in earlier versions of
Microsoft Excel, you can sometimes omit the open and close parentheses
immediately following the variable. Specifically, if the variable is
declared within a Declare statement, the parentheses may be omitted. For
example:
<P>
<PRE>   Declare Function MyFunc Lib "XYZ.DLL" (X As String, ParamArray Y As
       Variant) As Variant

</PRE>This Declare statement will work in earlier versions of Microsoft Excel,
but it will not work in Microsoft Excel 97. If you attempt to run any
macros when this statement is present, you will receive the error message
shown in the Symptoms section of this article.
<P>
In order for the statement to work, you must add open and close parentheses
immediately after the variable name, like this:
<P>
<PRE>   Declare Function MyFunc Lib "XYZ.DLL" (X As String, ParamArray Y() As
       Variant) As Variant

</PRE>Also, note that ParamArrays must be declared either as type Variant or as
no type at all:
<P>
<PRE>   Valid ParamArrays           Invalid ParamArrays
   -----------------------------------------------------
   ParamArray A()              ParamArray C() As Integer
   ParamArray B() As Variant   ParamArray D() As Double
                               ParamArray E() As String
                               ParamArray F() As Boolean
                               ParamArray G() As Long

</PRE>For additional information on ParamArrays, please see the following
article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q151582.htm">Q151582</A></B>
   TITLE     : XL: Methods to Use Custom Functions with Varying Arguments
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 97 XL97<BR>
Keywords          : kbprg xlvbahowto xlvbainfo xl97vbmigrate<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
