

<HTML>
<HEAD>
<TITLE>HOWTO: Have a VB Program Change a Word Document's Page Layout </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115782">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1994/06/02">
<META NAME="Keywords" CONTENT="IAPOLE vbwin GnrlVb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The stretch setting of the SizeMode property re-sizes an OLE server's image to best fit the dimensions of the MSOLE2.VBX control. OLE servers, such as Word for Windows, are responsible for the display of the image inside an OLE container. OLE serve...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QABA,QATX,QAFF,QA9Q,QBJZ,QBXS,QBWS,QA5D,QBWA,QA28,QATJ,QARJ,QA7O,QAOE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Have a VB Program Change a Word Document's Page Layout</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115782</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows version 3.0
</PRE>- Microsoft Word, version 6.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The stretch setting of the SizeMode property re-sizes an OLE server's
image to best fit the dimensions of the MSOLE2.VBX control. OLE servers,
such as Word for Windows, are responsible for the display of the image
inside an OLE container. OLE servers will create a display based on a
unit defined by the server. For example, the display of a Word for
Windows version 6.0 document is based on the Page Layout dimensions of
the document and the amount of vertical text being displayed. This
article gives two techniques you can use to alter the appearance of
a Word object in the OLE control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ChangePageSize Sub procedure defined in the following example is a
generic routine that accepts three parameters (the OLE control, a string
for page height, and a string for page width). The ChangePageSize Sub
procedure redefines the page height and width based on the parameters
passed to it. Both strings (page height and page width) must include a
unit of measure. The following example uses inches as the unit of measure.
The ChangePageSize Sub procedure expects the second and third parameters
to represent the page height and page width.
<P>
<P><h3>Steps to Create Example Program for Changing a Page Size</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Add a command button (Command1) to Form1.

<P><LI>Create a control array of three Command1 buttons. From the Edit
   menu, choose Copy. Then from the Edit menu, choose Paste. You will be
   asked if you want to create a control array of Command1 buttons. Choose
   the Yes button. Continue this process for a total of three Command1
   buttons. Change the caption on the first button to 100%, the caption on
   the second button to 75%, and the caption on the third button to 50%.

<P><LI>Add the following code to Command1_Click (Index As Integer) event
   procedure:
<P>
<PRE>      Sub Command1_Click (Index As Integer)
         ' OLE1 is the name of the OLE control.
         Select Case Index
            Case 0 '100%
               Call ChangePageSize(OLE1, "", "")
            Case 1 '75%
               ' Enter the following two lines as one, single line:
               Call ChangePageSize(OLE1, CStr(11 * .75) &amp; """",
                  CStr(8.5 * .75) &amp; """")
            Case 2 '50%
               ' Enter the following two lines as one, single line:
               Call ChangePageSize(OLE1, CStr(11 * .5) &amp; """",
                  CStr(8.5 * .5) &amp; """")
         End Select
      End Sub

</PRE><P><LI>Add the following Sub procedure to the General Declarations
   section of Form1:
<P>
<P><PRE>      ' Enter the following two lines as one, single line:
<PRE></PRE>      Sub ChangePageSize (cOLE As OLE, strPageHeight As String,
         strPageWidth As String)
         ' Declare the variables to be used:
         Dim WB As Object
         ' Initialize Page Definition variables for default:
         If strPageHeight = "" Then strPageHeight = "11.0"""
         If strPageWidth = "" Then strPageWidth = "8.5"""
         ' Activate OLE container:
         cOLE.Action = 7
         ' Use WB as an Alias for the WordBasic Object:
         Set WB = CreateObject("Word.Basic")
         ' Use OLE Automation to define the embedded documents page def.
         ' Change width and height, ,, will leave settings as is.
         WB.FilePageSetup , , , , , , , strPageWidth, strPageHeight
         ' If object is linked, save, close, and activate Form:
         If cOLE.SourceDoc &lt;&gt; "" Then
            WB.FileSave
            WB.FileClose
            AppActivate Me.Caption
         End If
      End Sub

</PRE><P><LI>Add an MSOLE2.VBX control to Form1 and select the Create from
   File option. Then choose the Browse button and find the desired
   document to load. Next select the Display as Icon option, and
   choose the OK button.

<P><LI>Run the sample. Click the 50% button to see the document displayed
   at 50% of the page size. Then click the 75% button to see the document
   displayed at 75% of the page size. Finally, click the 100% button to
   see the document displayed at 100% of the page size.
<P>
</OL><h3>Steps to add to the Example Program for Changing the Margin Size</h3>
 
<P>
The ChangeMargins Sub procedure listed in the following example is a
generic routine that excepts five parameters (the OLE control and four
string type parameters for the four margin settings).
<P>
The ChangeMargins Sub procedure redefines the page margins (top, bottom,
left, and right) based on the parameters passed to it. All four of
the margin strings must include a unit of measure, which for the following
example is inches. In the ChangeMargins Sub procedure, the second, third,
fourth and fifth parameters set the margins. The second parameter
represents the value for the top margin, the third represents the value
for the bottom margin, the fourth represents the value for the left
margin, and the fifth represents the value for the right margin.

<OL><P><LI>Add a command button (Command2) to Form1.

<P><LI>Create a control array of four Command2 buttons. From the Edit menu,
   choose Copy. Then from the edit menu, choose Paste. When asked if
   you want to create a control array of Command1 buttons, choose the
   Yes button. Continue this process for a total of four Command2 buttons.
   Change the first button's caption to Default, the second button's
   caption to No Margins, the third button's caption to 1/2 Inch, and the
   fourth button's caption to 1 Inch.

<P><LI>Add the following code to the Command2_Click (Index As Integer) event
   procedure:
<P>
<PRE>      Sub Command2_Click (Index As Integer)
         Dim strTop As String, sBottom As String
         Dim sRight As String, sLeft As String

         Select Case Index
            Case 0 'Default Settings:
               ' Do nothing
            Case 1 ' No Margins:
               strTop = "0.00" &amp; """"
               sBottom = "0.00" &amp; """"
               sRight = "0.00" &amp; """"
               sLeft = "0.00" &amp; """"
            Case 2 ' 1/2 Inch all the way around:
               strTop = "0.5" &amp; """"
               sBottom = "0.5" &amp; """"
               sRight = "0.5" &amp; """"
               sLeft = "0.5" &amp; """"
            Case 3 ' 1 Inch all the way around:
               strTop = "1.00" &amp; """"
               sBottom = "1.00" &amp; """"
               sRight = "1.00" &amp; """"
               sLeft = "1.00" &amp; """"
         End Select
         Call ChangeMargins(OLE1, strTop, sBottom, sRight, sLeft)
      End Sub

</PRE><P><LI>Add the following Sub procedure to the General Declarations
   section of Form1:
<P>
<P><PRE>      ' Enter the following three lines as one, single line:
<PRE></PRE>      Sub ChangeMargins (cOLE As OLE, strTopMargin As String,
         strBottomMargin As String, strLeftMargin As String,
         strRightMargin As String)
         ' Declare the variables to be used:
         Dim WB As Object

         ' Initialize Page Definition variables and defaults:
         If strTopMargin = "" Then strTopMargin = "1.0"""
         If strBottomMargin = "" Then strBottomMargin = "1.0"""
         If strLefMargin = "" Then strLefMargin = "0.5"""
         If strRightMargin = "" Then strRightMargin = "0.5"""

         cOLE.Action = 7  ' Activate OLE container.
         ' Use WB as an Alias for the WordBasic Object:
         Set WB = CreateObject("Word.Basic")

         ' Use OLE Automation to define the embedded documents page def.
         ' Enter the following two lines as one, single line:
         WB.FilePageSetup , , strTopMargin, strBottomMargin,
            strLefMargin, strRightMargin
         If cOLE.SourceDoc &lt;&gt; "" Then
            WB.FileSave
            WB.FileClose
            AppActivate Me.Caption
         End If
      End Sub

</PRE><P><LI>Press the F5 key to run the application. Click the 1 Inch button
   to see the document displayed with a one-inch margin. Click the
   1/2 Inch button to see the document displayed with a one-half-inch
   margin. Click the No Margins button to see the document displayed
   with no margin. Click the Default button to use the Microsoft Word
   default margin setting.
<P>
</OL>You can use these techniques to produce a zoom or PagePreview effect and
control the effect within your Visual Basic program.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OLE Automation OA OLE2 Kbmacro<BR>
Keywords          : IAPOLE vbwin GnrlVb kbprg<BR>
Technology        : kbole kbvba<BR>
Version           : WINDOWS:3.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
