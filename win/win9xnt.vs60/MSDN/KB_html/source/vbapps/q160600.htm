

<HTML>
<HEAD>
<TITLE>XL97: ScreenUpdating Causes Problems in MS Internet Explorer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160600">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/12/06">
<META NAME="Keywords" CONTENT="kbcode xlvbainfo xlui xlweb">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you view a Microsoft Excel worksheet in Microsoft Internet Explorer, version 3.0 or 3.01, and run a Visual Basic for Applications macro, Microsoft Excel may not redraw the worksheet correctly after the macro is finished running. When this beha...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRJ,QBV9,QAH4,QBVP,QBS0,QBVV,QBWS,QBXT,QBXS,QA63,QA5V,QAIB,QBD2,QAXB,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: ScreenUpdating Causes Problems in MS Internet Explorer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160600</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Internet Explorer for Windows, version 3.x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you view a Microsoft Excel worksheet in Microsoft Internet Explorer,
version 3.0 or 3.01, and run a Visual Basic for Applications macro,
Microsoft Excel may not redraw the worksheet correctly after the macro is
finished running. When this behavior occurs, cells and objects in the
worksheet may not appear to be updated by the macro.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when you run a macro that turns off screen updating
with the following line of code:
<P>
<PRE>   Application.ScreenUpdating = False

</PRE>The problem will occur even if your macro also includes the following line 
of
code:
<P>
<PRE>   Application.ScreenUpdating = True

</PRE><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
To work around this behavior, use either of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
You can force the worksheet to be redrawn correctly by resizing the
Microsoft Internet Explorer window in any way. For example, resize the
window by doing any of the following:

<UL><LI>Minimize, and then restore the window

<LI>Maximize, and then restore the window

<LI>Resize the window manually
<P>
</UL><h3>Method 2</h3>
 
<P>
If the macro includes the following line of code:
<P>
<PRE>   Application.ScreenUpdating = True

</PRE>you can force the worksheet to redraw correctly programmatically by
displaying a different section of the worksheet and returning to the cell
range you originally selected. When you do this, you force the screen to be
redrawn, which prevents the problem from occurring. To do this, add the
following lines of code to the end of the macro immediately before the "End
Sub" line:
<P>
<PRE>   Set xRange = Selection    'Set a variable to the active selection.
   Range("IV65536").Select   'Select another cell in the sheet.
   xRange.Select             'Select the original range.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, you can disable screen updating while running a macro
by adding the following line of code:
<P>
<PRE>   Application.ScreenUpdating = False

</PRE>Screen updating remains disabled until the macro finishes running or you 
re-
enable updating by setting the ScreenUpdating property to True.
<P>
If you run a macro that sets ScreenUpdating to False while you view a
worksheet in Microsoft Internet Explorer, ScreenUpdating is not correctly
re-enabled when the macro is finished running.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97<BR>
Keywords          : kbcode xlvbainfo xlui xlweb<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
