

<HTML>
<HEAD>
<TITLE>XL: Visual Basic Macro to Convert Number to a Different Base </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135635">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/08/24">
<META NAME="Keywords" CONTENT="kbcode kbprg xlformula PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article contains a sample Microsoft Visual Basic for Applications  function that converts an integer number to any base less than 10.  MORE INFORMATION  Microsoft provides programming examples for illustration only, without warranty either exp...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QABA,QA2O,QAKC,QAY5,QBC6,QAB9,QAG8,QAKN,QAKU,QBV8,QAYL,QAPF,QAVZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Visual Basic Macro to Convert Number to a Different Base</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135635</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains a sample Microsoft Visual Basic for Applications 
function that converts an integer number to any base less than 10.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>Following is a sample function called "baseconv" that takes two
arguments. The first argument, InputNum, is an integer number to be
converted. The second argument, BaseNum, is the number of the base to
convert InputNum to.
<P>
<P><h3>Sample Visual Basic Procedure</h3>
 
<P>
<PRE>   Function baseconv(InputNum, BaseNum)

      Dim quotient, remainder As Single
      Dim answer As String
      quotient = InputNum   ' Set quotient to number to convert.
      remainder = InputNum  ' Set remainder to number to convert.
      answer = ""

      Do While quotient &lt;&gt; 0   ' Loop while quotient is not zero.

         ' Store the remainder of the quotient divided by base number in a
         ' variable called remainder.
         remainder = quotient Mod BaseNum

         ' Reset quotient variable to the integer value of the quotient
         ' divided by base number.
         quotient = Int(quotient / BaseNum)

         ' Reset answer to contain remainder and the previous answer.
         answer = remainder &amp; answer

      Loop
      baseconv = Val(answer)   ' Convert answer variable to a number.

   End Function

</PRE>The function should be typed in a worksheet cell as follows:
<P>
<PRE>   =baseconv(InputNum, BaseNum)

</PRE>For example, the following call to the baseconv function:
<P>
<PRE>   =baseconv(100,2)

</PRE>returns the following value in the cell:
<P>
<PRE>   1100100

</PRE><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Excel for Windows 95</h3>
 
<P>
For more information about user-defined functions, click the Index tab in
Microsoft Excel Help, type the following text
<P>
<PRE>   user-defined functions

</PRE>and then double-click the selected text to go to the "Writing a Function
procedure" topic.
<P>
<P><h3>Microsoft Excel version 5.0</h3>
 
<P>
"Visual Basic User's Guide," version 5.0, Chapter 12, "Creating User-
Defined Functions"
<P>
For more information about user-defined functions, click the Search button
in Microsoft Excel Help and type:
<P>
<PRE>   user-defined functions

</PRE>For information about how to do this in earlier versions of Microsoft
Excel, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q69777.htm">Q69777</A></B>
   TITLE     : Macro to Convert Decimal Number to a Different Base
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 8.00 97 98 XL98 XL97 XL7 XL5 <BR>
custom<BR>
Keywords          : kbcode kbprg xlformula PgmHowto<BR>
Version           : WINDOWS:5.0,5.0c,7.0,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
