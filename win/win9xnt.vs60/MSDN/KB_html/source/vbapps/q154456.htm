

<HTML>
<HEAD>
<TITLE>ACC: How to Open and Close Word Documents with OLE Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154456">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/08/06">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop PgmHowTo IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This Article demonstrates how to use OLE Automation to Open and Close Microsoft Word for Windows 95 documents.  This article assumes that you are familiar with Visual Basic ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA1S,QDN9,QAPN,QBS0,QBWS,QAGB,QAW6,QAPF,QAAW,QDL9,QBWQ,QBWO,QBWN,QA9Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Open and Close Word Documents with OLE Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154456</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0
<LI>Microsoft Word for Windows version 6.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This Article demonstrates how to use OLE Automation to Open and Close
Microsoft Word for Windows 95 documents.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access for Windows 95" manual.
<P>
NOTE: Visual Basic for Applications (used in Microsoft Access for
Windows 95 version 7.0) is called Access Basic in version 2.0. For
more information about Access Basic, please refer to the "Building
Applications" manual.
<P>
For more information about using OLE Automation between Microsoft Access
and Microsoft Word, search on the phrase "Create a Word Document using OLE
Automation," and then "CreateObject function" using the Microsoft Access
for Windows 95 Answer Wizard. For more information about the Microsoft
Access Verb and Action properties, search on the phrases "Verb property"
and "Action property," using the Microsoft Access Help Index.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following two examples demonstrate how to manipulate Microsoft Word 7.0
documents:
<P>
<P><h3>Example 1</h3>
 
<P>
The following example assumes there is a document named Test.doc in the
C:\Winword folder (directory). This example demonstrates how to open a
Microsoft Word Document, reformat the text, and then close the document:

<OL><P><LI>Open Microsoft Access and open the sample database Northwind.mdb.
   (NWIND.MDB in Microsoft Access version 2.0)

<P><LI>Create a new module and add the following function:
<P>
<P><PRE>      Function CloseDoc ()
<PRE></PRE>        Dim wordobj As Object
        Set wordobj = CreateObject("Word.Basic")
        wordobj.FileOpen "C:\Winword\Test.doc"
        ' View the invoked instance of Word.
        wordobj.AppShow
        ' Selects the entire document and makes it Bold.
        wordobj.EditSelectAll
        wordobj.Bold 1
        ' Closes the document and saves changes.
        wordobj.filesave
        wordobj.FileClose (1)
        wordobj.appclose
        Set wordobj = Nothing
      End Function

</PRE><P><LI>Type the following into the Debug window (or Immediate window in
   Microsoft Access version 2.0), and then press ENTER:
<P>
<P><PRE>      ?Closedoc()
</PRE><P>
   Note that the object is opened, formatted, saved, and then closed.
<P>
</OL><h3>Example 2</h3>
 
<P>
The following example demonstrates how to close a Microsoft Word document
which is embedded on a form:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0) and
   create a new form.

<P><LI>In Design view, create an unbound object frame named OLEObj on the form.
   Change the Enabled property for the object frame control to Yes and the
   Locked property to No. When prompted with the Insert Object dialog box,
   click "Create New" and in the list of Object Types click "Microsoft
   Word Document." Click OK. In the blank Word document that appears, enter
   some text, and then on the File menu, click "Close and Return to
   Formx: Form."

<P><LI>Add a command button to the form and for the OnClick property add the
   following code:
<P>
<P><PRE>      Dim WordObj as Object
<PRE></PRE>      Me![OLEObj].Verb = -2   ' Tells Microsoft Access to open the
                              ' application.
      Me![OLEObj].Action = 7  ' Activates the application.
      Set WordObj = Me![OLEObj].Object.Application.WordBasic
      WordObj.EditSelectAll
      WordObj.Bold 1
      Wordobj.FileSave
      WordObj.FileClose(1)
      Wordobj.Appclose
      Set WordObj = Nothing

</PRE><P><LI>Open the form and click the command button. Note that OLE Object is
   opened, formatted, and then closed.
</OL> 
<PRE>Keywords          : AutoGnrl kbinterop PgmHowTo IntpOleA
Technology        : kbole
Version           : 2.0 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
