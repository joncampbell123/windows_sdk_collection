

<HTML>
<HEAD>
<TITLE>OLE Automation: Add-Ins Don't Load When Using CreateObject </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108888">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/12/20">
<META NAME="Keywords" CONTENT="IntpOthr kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you access Microsoft Excel as an OLE Automation object using the CreateObject command, add-ins, files located in the XLStart directory, and the default new workbook are not loaded.  CAUSE =====  Add-ins, files in the XLStart directory, and the...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAGI,QBS0,QBVV,QAPN,QBWS,QA9Q,QA2K,QAW6,QAH4,QAH0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OLE Automation: Add-Ins Don't Load When Using CreateObject</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108888</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you access Microsoft Excel as an OLE Automation object using the
CreateObject command, add-ins, files located in the XLStart directory, and
the default new workbook are not loaded.
<P>
<P><h2>CAUSE</h2>
 
<P>
Add-ins, files in the XLStart directory, and the default new workbook are
not loaded when Microsoft Excel is run as an OLE Automation object using
the CreateObject command. This is by design. When add-ins and files are
loaded, Microsoft Excel sends a message to the calling application, such as
Visual Basic version 3.0, that it is not ready to respond to the request
and to try again later. The calling application may not be able to handle
this request, and will not be able to continue with the rest of the
commands.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
To load an add-in file when you run Microsoft Excel as an OLE Automation
object, load the add-in manually. The following is an example of using this
method:
<P>
<PRE>   Sub LoadAddin()

      ' Dimension variable xl as object type
      Dim xl As Object

      ' Activate Microsoft Excel and assign to variable xl
      Set XL = CreateObject("Excel.Application")

      ' Open the desired add-in file, in this example, XLQUERY.XLA
      XL.Workbooks.Open (XL.librarypath &amp; "\MSQUERY\XLQUERY.XLA")

      ' Run any auto macros contained in the add-in file
      ' Auto macros don't run when you open a file
      ' using the Open method
      XL.Workbooks("xlquery.xla").RunAutoMacros 1

      Set XL = Nothing

   End Sub


</PRE><h2>MORE INFORMATION</h2>
 
<P>
Because Microsoft Excel does not load add-ins or files in the XLStart
directory when you call it as an OLE Automation object, you have complete
control of the loading process. If you want an add-in loaded, you can load
it manually. This behavior also means that no macro errors, locked file
alerts, or read-only file alerts will keep Microsoft Excel from loading
when it is being called by the CreateObject command. Another benefit of
this behavior is that it takes less time to load Microsoft Excel than it
does when add-ins or files are loaded when you run Microsoft Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about an Overview of Controlling What Happens
When you start Microsoft Excel, choose the Search button in Help and
type:
<P>
<PRE>   startup workbook

</PRE>For more information about Installing Or Removing An Add-in, click
the Search button in Help and type:
<P>
<PRE>    add-ins
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00 8.00 97 personal.xls personal<BR>
macro workbook<BR>
Keywords          : IntpOthr kbprg PgmOthr<BR>
Version           : 5.00 5.00c 7.00 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
