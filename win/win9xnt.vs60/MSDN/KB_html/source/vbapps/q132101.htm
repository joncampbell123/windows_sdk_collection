

<HTML>
<HEAD>
<TITLE>ACC: How to Get the Fiscal Year/Month of a Particular Date </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132101">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/06/28">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo ExrStrg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how you can get the fiscal year or fiscal month of a particular date using an expression or a user-defined function.  This article assumes that you are ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QALP,QA1S,QDN9,QBE7,QBE6,QAB9,QBS0,QAY5,QA7O,QA7N,QA5V,QA5F,QAMA,QBDM P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Get the Fiscal Year/Month of a Particular Date</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132101</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how you can get the fiscal year or fiscal month
of a particular date using an expression or a user-defined function.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using an Expression to Get the Fiscal Year or Fiscal Month</h3>
 
<P>
To get the fiscal year or fiscal month of a particular date using an
expression, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in earlier
   versions).

<P><LI>Create a new query based on the Orders table.

<P><LI>In the query's QBE grid, add the following fields.
<P>
   NOTE: In the sample expressions below, an underscore (_) at the end
   of a line is used as a line-continuation character. Remove the
   underscore from the end of the line when re-creating these sample
   expressions.
<P>
<P><PRE>      Query: GetFiscalDates
      -------------------------------------------------------------------
      Field: OrderDate
<PRE></PRE>         Table: Orders
         Criteria: Like "*/*/94"
      Field: FYear: Year([OrderDate])-IIf([OrderDate]&lt; _
               DateSerial(Year([OrderDate]),6,16),1,0)
      Field: FMonth: (Month([OrderDate])+IIf(Day([OrderDate])&lt;16,6,7)-1) _
                     Mod 12+1

   NOTE: In Microsoft Access 1.x and 2.0, [Order Date] contains a space.

</PRE><P><LI>Run the query, and then scroll through the query datasheet. Note that
   the fiscal year and fiscal month appear for each record in the Orders
   table.
<P>
</OL>NOTE: You can use the FYear and FMonth expressions in your database by
modifying the date field, the day and the month, to the appropriate
values for your fiscal year. For example, if the fiscal year begins on 9/15
of the current calendar year, you can modify the previous expressions as
follows:
<P>
<PRE>   Field: FYear: Year([FieldName])-IIf([FieldName]&lt; _
            DateSerial(Year([FieldName]),9,15),1,0)
   Field: FMonth: (Month([FieldName])+IIf(Day([FieldName])&lt;15,9,10)-1) _
            Mod 12+1

</PRE></OL>If the fiscal year begins on 9/15 of the previous calendar year, you can
modify the FYear expression as follows:
<P>
<PRE>   Field: FYear: Year([FieldName])-IIf([FieldName]&lt; _
            DateSerial(Year([FieldName]),9,15),1,0)+1

</PRE><h3>Using Sample Functions to Get the Fiscal Year or Fiscal Month</h3>
 
<P>
To get the fiscal year or fiscal month of a particular date using sample
functions, follow these steps:

<OL><P><LI>Create a module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
<PRE></PRE>      Const FMonthStart = 6   ' Numeric value representing the first month
                              ' of the fiscal year.
      Const FDayStart = 16    ' Numeric value representing the first day of
                              ' the fiscal year.
      Const FYearOffset = -1  ' 0 means the fiscal year starts in the
                              ' current calendar year.
                              ' -1 means the fiscal year starts in the
                              ' previous calendar year.

</PRE><P><LI>Type the following two procedures:
<P>
<P><PRE>      Function GetFiscalYear (ByVal x As Variant)
<PRE></PRE>         If x &lt; DateSerial(Year(x), FMonthStart, FDayStart) Then
            GetFiscalYear = Year(x) - FYearOffset - 1
         Else
            GetFiscalYear = Year(x) - FYearOffset
         End If
      End Function

      Function GetFiscalMonth (ByVal x As Variant)
         Dim m
         m = Month(x) - FMonthStart + 1
         If Day(x) &lt; FDayStart Then m = m - 1
         If m &lt; 1 Then m = m + 12
         GetFiscalMonth = m
      End Function

</PRE><P><LI>To test these functions, type each of the following lines in the
   Debug window (or Immediate window in versions 1.x and 2.0), and then
   press ENTER.
<P>
<P><PRE>      ? GetFiscalYear (#7/1/95#)
</PRE><P>
   Note that this line returns the year 1996.
<P>
<P><PRE>      ? GetFiscalMonth (#8/1/95#)
</PRE><P>
   Note that this line returns the number 2. The 2 represents the second
   month in the fiscal year.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the DateSerial function, search the Help Index
for "DateSerial function."
 
<PRE>Keywords          : kbprg PgmHowTo ExrStrg
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
