

<HTML>
<HEAD>
<TITLE>PRB: "Object not a Collection" Trying to Read Array Element </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129871">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1995/05/08">
<META NAME="Keywords" CONTENT="IAPVBA VB4ALL VB4WIN vbwin GnrlVb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  If a public member of a class of type variant is assigned an array, you get the following error message when trying to read an element of the array by directly indexing the variant member:     Object not a Collection.  This happens only if the inst...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAH4,QBE7,QBE6,QBS0,QBJZ,QAB4,QAVX,QBXS,QAY5,QANF,QABB,QDKW,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Object not a Collection" Trying to Read Array Element</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129871</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a public member of a class of type variant is assigned an array, you get
the following error message when trying to read an element of the array by
directly indexing the variant member:
<P>
<PRE>   Object not a Collection.

</PRE>This happens only if the instance of the class object is late bound; that
is, the instance is dimensioned "As Object."
<P>
<P><h2>RESOLUTION</h2>
 

<UL><LI>Dimension the object instance as being of the exact type of the class,
   so that it is Early Bound.
<P>
   -or-

<LI>Index the variant member with another level of parenthesis. For example,
   in the "Steps to Reproduce Behavior" section of this article, use:
<P>
<P><PRE>      Debug.Print x.arr()(0)
</PRE><P>
   Instead of:
<P>
<P><PRE>      Debug.Print x.arr(0)
</PRE><P>
   This explicitly specifies that the variant holds an array.
<P>
</UL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start a new project in Visual Basic. Form1 is created by default.

<P><LI>Choose Module from the Insert menu to add a new standard module
   (Module1)

<P><LI>Add the following code to Module1:
<P>
<PRE>      Sub main()
         Dim a(2) As Integer
         a(0) = 5

         Dim x As Object
         Set x = New Class1

         x.arr = a
         Debug.Print x.arr(0)
      End Sub

</PRE><P><LI>Choose Class Module from the Insert menu to add a new class module
   (Class1).

<P><LI>Add the following code to Class1:
<P>
<P><PRE>      Public arr As Variant
</PRE>
<P><LI>Press the F5 key to run the program. You will get the error message on
   the Debug.Print line.
<P>
</OL><h3>Example Workaround</h3>
 
<P>
To work around the behavior, declare the object with a specific object type
instead of Object. In Step 3 above, replace:
<P>
<PRE>   Dim x As Object

</PRE></OL>with:
<P>
<PRE>   Dim x As New Class1

</PRE>Then change the Set statement into a comment. After making these changes,
run the program again. You should see a value of 5 in the Debug Window.
 
<PRE>Keywords          : IAPVBA VB4ALL VB4WIN vbwin GnrlVb kbprg
Technology        : kbvba
Version           : WINDOWS:4.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
