

<HTML>
<HEAD>
<TITLE>ACC: Dynamically Synchronizing Two Forms using Code (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149940">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1996/04/16">
<META NAME="Keywords" CONTENT="kbusage FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to synchronize a form to the current record on the subform of another form using Visual Basic for Applications. The method described in this artic...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA5V,QAH4,QAPN,QBS0,QAI2,QAPF,QAJH,QA6A,QDNW,QABI,QBWS,QAX6,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Dynamically Synchronizing Two Forms using Code (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149940</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to synchronize a form to the current record
on the subform of another form using Visual Basic for Applications. The
method described in this article synchronizes the form's bookmark with
the bookmark of the form's recordset after searching the recordset for
the current key value from the other form's subform.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, FrmSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and FrmSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q150895.htm">Q150895</A></B>
   TITLE     : ACC95: Microsoft Access Sample Forms Available on MSL

   ARTICLE-ID: <B><A href="../access/q175066.htm">Q175066</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Forms Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file,
or perform these steps on a copy of the database.
<P>
The following example demonstrates how to synchronize the Products form
to the current record in the Product List subform on the Categories form.

<OL><P><LI>Open the sample database Northwind.mdb

<P><LI>Open the Product List form in Design view.

<P><LI>Set the form's OnCurrent property to the following event procedure:
<P>
<P><PRE>      '**********************************************************
      'Sub Form_Current()
      '**********************************************************
</PRE><P>
<PRE>         'If the ProductName is blank, then exit the Sub.
         If IsNull(Me![ProductName]) Then
            Exit Sub
         End If

         'Dimension variables.
         Dim formname As String, SyncCriteria As String
         Dim f As Form, rs As Recordset

         'Set the formname to "Products," the form that will be
         'synchronized.
         formname = "Products"

         'Check to see if the Products form is open. If it
         'is not open, open it.
         If Not SysCmd(acSysCmdGetObjectState, acForm, formname) Then
             DoCmd.OpenForm formname
         End If

         'Define the form object and Recordset object for
         'the Products form.
         Set f = Forms(formname)
         Set rs = f.RecordsetClone

         'Define the criteria used for the synchronization.
         SyncCriteria = BuildCriteria("ProductName", dbText, _
            Me!ProductName)

         'Synchronize the corresponding record in the Products form to
         'the current record in the subform.
         rs.FindFirst SyncCriteria

         'If a record exists in the Products form, find the
         'matching record.
         If rs.nomatch Then
            MsgBox "No match exists!", 64, formname
         Else
            f.bookmark = rs.bookmark
         End If

      '**********************************************************
      'End Sub
      '**********************************************************

</PRE><P><LI>Save and then close the Product List form.

<P><LI>Open the Categories form in Form view. When you open the Categories
   form, the subform's OnCurrent event procedure is triggered. This
   causes the Products form to open, if it is not already open, and
   synchronizes that form to the current record on the Categories
   subform.
<P>
</OL>You can adapt this method to occur when a command button is clicked by
moving the code specified in the subform's OnCurrent property event
procedure to a command button on the Categories form. If you do move the
code to a command button, make sure to change the references to "Me" in
the code to a full form reference, using the following syntax:
<P>
<PRE>   Forms!Categories![Product List].Form

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about synchronizing forms with Microsoft Access 2.0,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q119398.htm">Q119398</A></B>
   TITLE     : ACC2: Dynamically Synchronizing Two Forms using Code

</PRE>For more information about the SysCmd() function, search for "SysCmd
Function" using the Microsoft Access 97 Help Index.
<P>
For more information about the Me property, search for "Me Property"
using the Microsoft Access 97 Help Index.
 
<PRE>Keywords          : kbusage FmsHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
