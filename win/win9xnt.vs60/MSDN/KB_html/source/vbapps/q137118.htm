

<HTML>
<HEAD>
<TITLE>ACC: How to Flag Out-of-Sequence Numbers on a Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137118">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/09/20">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo RptOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article shows you how to create a report that marks (or flags) any items that are missing from a given a list of sequential integers or dates. For example, when you receive ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QBS0,QAH4,QA1S,QBV4,QABH,QDN9,QA7O,QAY5,QAUJ,QAB5,QBWS,QAB9,QAHP,QAJH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Flag Out-of-Sequence Numbers on a Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137118</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article shows you how to create a report that marks (or flags) any
items that are missing from a given a list of sequential integers or dates.
For example, when you receive your bank statement, your bank has flagged
checks that have not cleared by placing an asterisk by the next check in
the sequence. This article uses a Visual Basic for Applications function to
compare the current item with the previous one in the sequence.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a function that compares the current item with the previous one
in a sequence, follow these steps.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb.  You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new report based on the Current Product List query.

<P><LI>On the View menu, click Code.

<P><LI>Type the following code in the module's Declarations section:
<P>
       Dim GlobalFlag as Variant

<P><LI>On the Insert menu, click Procedure. Type "SetFlag" (without the
    quotation marks) in the Name box, and then click OK.

<P><LI>Modify the SetFlag function as follows:
<P>
       Function SetFlag(x as Variant)
<PRE>          If GlobalFlag &lt;&gt; x - 1 then
             SetFlag = "*"
          Else
             SetFlag = ""
          End If

          GlobalFlag = x
       End Function

</PRE><P><LI>Close the Code window.

<P><LI>On the View menu, click Sorting and Grouping to display the Sorting
    and Grouping dialog box.

<P><LI>In the first row of the Sorting and Grouping dialog box, select
    ProductID for the Field/Expression column and select Ascending for
    the Sort Order column.

<P><LI>Close the dialog box.

<P><LI>Add the following three text box controls to the detail section of the
    report:
<P>
       Textbox:
<PRE>          Name: Product ID
          ControlSource: ProductID
       Textbox:
          Name: OutOfSequence
          ControlSource: =SetFlag([ProductID])
       Textbox:
          Name: Product Name
          ControlSource: ProductName

</PRE><P><LI>Place the controls so that they are aligned horizontally and that the
    OutOfSequence control is flush against the Product ID control.

<P><LI>To view the results, click Print Preview on the File menu. In the
    Preview window, note that an asterisk is placed next to each
    ProductID where the preceding ProductID is not in sequence.
</OL> 
<PRE>Keywords          : kbusage PgmHowTo RptOthr
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
