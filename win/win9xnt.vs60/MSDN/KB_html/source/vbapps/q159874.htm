

<HTML>
<HEAD>
<TITLE>XL97: Indexes for Methods and Collections are Rounded </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159874">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/11/22">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you specify a decimal value for the index of a method or collection in a Visual Basic for Applications macro, the index is rounded. This behavior differs from that of earlier versions of Microsoft Excel. In earlier version...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QATJ,QA28,QAPN,QAH4,QAK2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Indexes for Methods and Collections are Rounded</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159874</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you specify a decimal value for the index of a
method or collection in a Visual Basic for Applications macro, the index is
rounded. This behavior differs from that of earlier versions of Microsoft
Excel. In earlier versions, the index is truncated rather than rounded.
<P>
Because of this difference, if your macro relies on Microsoft Excel to
convert decimal values for the indexes of methods or collections, your
macro may provide different results in different versions of Microsoft
Excel.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Excel 97 utilizes stricter typing for arguments of collections
and methods. If an argument is typed as an integer, decimal values that are
passed to that argument are automatically rounded.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The example below demonstrates a situation where you receive conflicting
results between versions of Microsoft Excel.
<P>
<PRE>   MsgBox Sheets(1.6).Name

</PRE>In Microsoft Excel 97, 1.6 is rounded to 2 and this line of code will
reference the second Sheet in the Sheets collection. In Microsoft Excel
versions 5.0 and 7.0, the number 1.6 is truncated to 1 and this line of
code references the first Sheet in the Sheets collection.
<P>
You should not rely on Microsoft Excel to automatically convert your
decimal values for indexes. If you require that the index be truncated in
all versions of Microsoft Excel, use the INT function:
<P>
<PRE>   MsgBox Sheets(INT(1.6)).Name

</PRE>If you require that the index be rounded in all versions of Microsoft
Excel, use the CInt function:
<P>
<PRE>   MsgBox Sheets(CInt(1.6)).Name


</PRE><h2>STATUS</h2>
 
<P>
This is by design in Microsoft Excel 97.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00 fraction integer convert conversion<BR>
whole range offset array<BR>
Keywords          : kbcode kbprg xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
