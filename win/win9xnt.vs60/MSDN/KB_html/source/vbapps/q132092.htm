

<HTML>
<HEAD>
<TITLE>PRJ4: Converting Duration Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132092">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1995/06/28">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The DurationValue method in Microsoft Project is used to convert a duration value into the equivalent number of minutes. This conversion is always based on the current conversion defaults for the application, rather than the conversion defaults for...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QAUD,QAKD,QABA,QAKC,QAGJ,QAY5,QAGX,QAB9,QBC6,QAZA,QAPN,QBS0,QBJZ,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRJ4: Converting Duration Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132092</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project 98 for Windows
<LI>Microsoft Project for Windows 95, versions 4.1, 4.1a
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Project for the Macintosh, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The DurationValue method in Microsoft Project is used to convert a duration
value into the equivalent number of minutes. This conversion is always
based on the current conversion defaults for the application, rather than
the conversion defaults for a specific project.
<P>
A custom function can be used in place of DurationValue to return values
based on project-specific conversion defaults.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DurationValue method takes a duration value as a string argument and
returns an integer number of minutes. If the duration value is specified in
units of Days or Weeks, this conversion is based on the current application
default values for Hours Per Day and Hours Per Week. For example, with the
initial default value for Hours Per Day set to 8.00 using this value, 5d =
40h = 2400m; Application.DurationValue("5d") = 2400.
<P>
Changing the Hours Per Day setting for a specific project does not affect
this calculation. For example, making the following change will not affect
this calculation:

<OL><P><LI>On the Tools menu, click Options.

<P><LI>Select the Calendar tab.

<P><LI>In the Hours Per Day box, type "7.00" (without the quotation marks), and
   choose OK.
<P>
</OL>This procedure changes the Hours Per Day value for the current project
only. In this situation, Application.DurationValue still returns 2400
because this method operates at the application level not the project
level.
<P>
<P><h3>To change the default value for the entire application</h3>
 

<OL><P><LI>On the Tools menu, click Options.

<P><LI>Select the Calendar tab.

<P><LI>In the Hours Per Day box, type "7.00" (without the quotation marks).

<P><LI>Choose the Set as Default button.

<P><LI>Choose the OK button.
<P>
</OL>After you make this change, Application.DurationValue("5d") = 2100.
(5d = 35h = 2100m)
<P>
It is also possible to create an equivalent function that returns the
number of minutes based on the conversion settings in a particular project.
The following example ProjDurationValue function takes a project object and
a duration string as arguments, and returns the corresponding number of
minutes for that duration.
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h3>Sample Macro</h3>
 
<P>
Function ProjDurationValue(oProj As Object, sDur As String) As Long
<PRE>' This function returns the number of minutes equivalent
' to the passed duration based on conversion values in the
' passed project.
' ProjDurationValue returns -1 if an invalid duration value is passed.

' oProj = project whose conversion values we're using
' sDur  = duration to convert

   ProjDurationValue = -1        ' Return -1 if invalid duration

   If InStr(sDur, "e") &gt; 0 Then  ' Elapsed duration
      Select Case Right(sDur, 2)
         Case "ed"   ' Elapsed days
            '1440 = number of minutes in 1 elapsed day
            ProjDurationValue = Val(sDur) * 1440
            Exit Function
         Case "ew"   ' Elapsed weeks
            '10080 = number of minutes in 1 elapsed week
            ProjDurationValue = Val(sDur) * 10080
            Exit Function
      End Select
   End If

   Select Case Right(sDur, 1)
      Case "m"    ' Minutes and Elapsed Minutes
         ProjDurationValue = Val(sDur)
      Case "h"    ' Hours and Elapsed Hours
         ProjDurationValue = Val(sDur) * 60
      Case "d"    ' Days
         Temp = oProj.Duration1
         oProj.Duration1 = "1d"
         ProjDurationValue = Val(sDur) * 60 * (oProj.Duration1 / 60)
         oProj.Duration1 = Temp
      Case "w"    ' Weeks
         Temp = oProj.Duration1
         oProj.Duration1 = "1w"
         ProjDurationValue = Val(sDur) * 60 * (oProj.Duration1 / 60)
         oProj.Duration1 = Temp
   End Select

</PRE></OL>End Function
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : kbcode kbprg<BR>
Version           : 4.0 4.1 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
