

<HTML>
<HEAD>
<TITLE>ACC: Conditionally Run AutoExec Macro in Automation Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160951">
<META NAME="KBModify" CONTENT="1998/01/30">
<META NAME="KBCreate" CONTENT="1996/12/12">
<META NAME="Keywords" CONTENT="kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you open a database in another instance of Microsoft Access using Automation code, if the database you are opening contains an AutoExec macro, the macro runs. If the ma...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAH4,QA01,QDN9,QAZV,QAPN,QBWS,QAFY,QDNJ,QDKH,QA2K,QDKY,QAPF,QBS0,QBE7 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Conditionally Run AutoExec Macro in Automation Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160951</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you open a database in another instance of Microsoft Access using
Automation code, if the database you are opening contains an AutoExec
macro, the macro runs. If the macro contains a MsgBox action or opens
a modal dialog box, code execution is suspended until you respond by
closing the message box or the dialog box.
<P>
This article demonstrates a technique to conditionally turn off any or all
AutoExec macro actions when you open a database with Automation.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If there are actions in the AutoExec macro that you do not want to execute
when you open the database with Automation, you can use the UserControl
property in the Condition column of a macro action. The UserControl
property lets you determine whether Microsoft Access is started by a user
or through Automation.
<P>
<P><h3>Conditionally Excluding AutoExec Macro Actions</h3>
 
<P>
The following example shows you how to use the UserControl property of the
Application object to conditionally run an action in the AutoExec macro:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>In the Database window, click the Macros tab and then click New.

<P><LI>Create a new macro and save it as AutoExec:
<P>
    NOTE: On the View menu, click Conditions to display the Condition
    column in the macro.
<P>
<PRE>       Condition                        Action
       ---------------------------------------
       Application.UserControl = True   MsgBox

       AutoExec Actions
       ------------------------------
       MsgBox
          Message: Opening Northwind

</PRE><P><LI>Close the Northwind database.

<P><LI>Create a new blank database called Db1.mdb.

<P><LI>Create a module and type the following procedure:
<P>
       Function TestAuto()
<PRE>          Static AccObj as Object, x as String
          x = _
            "C:\Program Files\Microsoft Office\" _
                &amp; "Office\Samples\Northwind.mdb"
          Set AccObj = GetObject(x)
       End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
    and then press ENTER:
<P>
       ?TestAuto()
<P>
    Note that the Northwind database opens in a separate instance of
    Microsoft Access, but does not display the message box.

<P><LI>Close the Northwind database in the second instance of Microsoft 
    Access.

<P><LI>Close the module in Db1.mdb without saving it, and then close the
    Db1.mdb database.

<P><LI>Open the Northwind sample database. Note that the message box 
    appears.
<P>
</OL><h3>Suspending Code Execution by Opening a Message Box</h3>
 
<P>
The following example demonstrates how code execution stops until you
respond to a message box in a database opened with Automation:

<OL><P><LI>Repeat steps 1-4 in the previous example, but do not add the Condition
   in the AutoExec macro.

<P><LI>Create a module in Db1.mdb and type the following procedure:
<P>
<P><PRE>      Function TestAuto2()
<PRE></PRE>         Static AccObj as Object, x as String
         x = _
           "C:\Program Files\Microsoft Office\Office\Samples\Northwind.mdb"
         Set AccObj = GetObject(x)
         MsgBox "All Done!"
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ?TestAuto2()
</PRE><P>
   Note that the Northwind database opens in a separate instance of
   Microsoft Access, but the "All Done!" message does not display until
   you switch to the Northwind instance of Microsoft Access, click the OK
   button in the message box, and then switch back to the Db1.mdb instance
   of Microsoft Access.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using Microsoft Access as an Automation Server,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q147816.htm">Q147816</A></B>
   TITLE     : ACC: Using Microsoft Access as an Automation Server

</PRE></OL>For more information about the UserControl property, search the Help
Index for "UserControl property," or ask the Microsoft Access 97 Office
Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Blinking Frozen Freeze Stop Responding Hung OLE<BR>
Keywords          : kbinterop IntpOleA<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
