

<HTML>
<HEAD>
<TITLE>XL: Visual Basic Procedure to Change the Standard Font </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114795">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/05/11">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article includes a sample Visual Basic, Applications Edition, procedure you can use to change the standard font in Microsoft Excel. This procedure may be useful if you are creating a custom application and you want to be able to change the Nor...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVP,QADF,QABB,QAFF,QABA,QAB9,QBJZ,QBWS,QBXS,QAH8,QAH4,QAKJ,QA5F,QAMA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Visual Basic Procedure to Change the Standard Font</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114795</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article includes a sample Visual Basic, Applications Edition,
procedure you can use to change the standard font in Microsoft Excel. This
procedure may be useful if you are creating a custom application and you
want to be able to change the Normal style font automatically.
<P>
If you want this procedure to run automatically when you start Microsoft
Excel, you can make it into an Auto_Open macro and place it in your
Personal.xls file.
<P>
<P><h3>Sample Visual Basic Procedure</h3>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
The following macro has both Auto_Open and Auto_Close sub procedures that
execute when applicable. The Change_Font sub procedure is executed whenever
you switch to another window or open a new book. The subroutine contains a
MsgBox dialog that will prompt you to change the standard font for the
book. If you choose OK in this alert message, the Fonts dialog box will be
displayed, allowing you to specify a new font.
<P>
<PRE>'Runs the Change_Font sub procedure whenever you open a new
'window or switch to another book.
Sub Auto_Open()
    Application.OnWindow = "Change_Font"
End Sub

'This procedure will run each time a new window is displayed.
Sub Change_Font()
    'If the active sheet is a worksheet or macro sheet then
    'ask the user if they want to change the Normal style font.
    If TypeName(ActiveSheet) = "Worksheet" Then
       response = MsgBox("Do you want to change the Normal style?", 1)
       'If user chooses Cancel, then stop the procedure.
       If response = vbCancel Then End
       'If user chooses OK, then display the Fonts dialog box.
       Application.Dialogs(xlDialogStandardFont).Show
    End If
End Sub

'Discontinues the OnWindow function when the book containing the
'subroutines is closed.
Sub Auto_Close()
        Application.OnWindow = ""
End Sub


</PRE><h2>MORE INFORMATION</h2>
 
<P>
Other ways you can change the standard font include the following:

<UL><LI>Using Microsoft Excel 5.0 for Windows, you can add the entry
   Font=&lt;fontname,size&gt; in the EXCEL5.INI file. For example, if you want to
   change the Normal style to 10-point Arial, add the following entry:
<P>
<P><PRE>      Font=Arial,10
</PRE><P>
   -or-

<LI>From the Tools menu, choose Options, and then select the General tab.
   You can set the Standard Font by selecting a font and size from the
   drop-down lists.
<P>
   -or-

<LI>Change the Font for the Sheet Style by choosing Style from the
   Format menu and changing the Font from there.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information about the Personal.xls file, see pages 22-23 of the
Microsoft Excel 5.0 "Visual Basic User's Guide."
<P>
For more information about Creating Automatic Procedures, see page 266 of
the Microsoft Excel 5.0 "Visual Basic User's Guide."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00 7.00c howto 8.0 8.00<BR>
Keywords          : kbprg PgmHowTo kbcode kbprg<BR>
Version           : 5.00 7.00 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
