

<HTML>
<HEAD>
<TITLE>PRB: Error When Excel VBApp Proc &amp; Implicit Var Have Same Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113947">
<META NAME="KBModify" CONTENT="1997/07/29">
<META NAME="KBCreate" CONTENT="1994/04/20">
<META NAME="Keywords" CONTENT="kbcode kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In an Excel Visual Basic for Applications module, if you have a procedure and an implicitly declared variable that share the same name, you will get one of two possible errors:     Type-declaration character does not match declared data type.      ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVP,QAFF,QBS0,QAYL,QAUD,QAAP,QAB4,QAY5,QBJZ,QAB9,QAJQ,QBWS,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error When Excel VBApp Proc &amp; Implicit Var Have Same Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113947</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic, Applications Editions, version 1.0
<LI>Microsoft Excel, version 5.0
<LI>Microsoft Office for Windows, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In an Excel Visual Basic for Applications module, if you have a procedure
and an implicitly declared variable that share the same name, you will get
one of two possible errors:
<P>
<PRE>   Type-declaration character does not match declared data type.

      -or-

   Expected function or variable.

</PRE><h2>RESOLUTION</h2>
 
<P>
Use the Dim statement to explicitly dimension the local variable (ThingOne$
or ThingOne):
<P>
<PRE>   Sub ThingOne

   End Sub

   Sub ThingTwo
      Dim ThingOne$  ' Or: Dim ThingOne As Variant
      ThingOne$ = "hi"
   End Sub

</PRE>Or add the Option Explicit statement at the beginning of your code module
to force you to explicitly dimension all variables.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. The local variable ThingOne (or ThingOne$) must
be explicitly declared or you will get an error. Sub procedures within
modules are visible to each other in the Visual Basic, Applications
Edition.
<P>
Because ThingOne is visible inside ThingTwo (see the code in the More
Information section below) and Sub and Function procedures may be called
without parameters the reference to ThingOne as a variable is ambiguous.
<P>
In the first case, the type char is checked first. The type is determined
to be a String. However, the Sub declaration is equivalent to a function
which has a void return. The $ contradicts this void return, so you get an
error.
<P>
In the second case, without the type character, Visual Basic, Applications
Edition checks the return type of the procedure. The return for a Basic Sub
is void so it results in the second error.
<P>
This behavior can be avoided altogether by using the Option Explicit
statement.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Excel version 5.0.

<P><LI>From the File menu, choose New to create a new Excel book.

<P><LI>From the Insert menu, choose Macro and then choose Module to create a
   new module in the book.

<P><LI>Add the following code to the Excel module:
<P>
<PRE>   Sub ThingOne

   End Sub

   Sub ThingTwo
      ThingOne$ = "hi"
   End Sub

</PRE><P><LI>Run the macro by choosing Start from the Run menu or by pressing the F5
   key. Excel will pop-up an error dialog:
<P>
   Type-declaration character does not match declared data type.

<P><LI>Replace the above code with the following code.
<P>
<PRE>   Sub ThingOne

   End Sub

   Sub ThingTwo
      ThingOne = 4
   End Sub

</PRE><P><LI>Run the macro. Excel will pop-up an error dialog:
<P>
   Expected function or variable.
</OL> 
<PRE>Keywords          : kbcode kberrmsg kbprg
Version           : 1.00 5.00 4.00
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
