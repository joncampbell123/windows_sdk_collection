

<HTML>
<HEAD>
<TITLE>XL97: UserControl Property Code Example Doesn't Work Properly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157555">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/10/14">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto xlvbainfo xlhelp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97 Visual Basic Help, the example code provided for the UserControl property does not work properly.  CAUSE =====  The example code for the UserControl property assumes that the UserControl property applies to Workbook objects, w...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAH4,QAPN,QBJZ,QBWS,QAPF,QAIH,QBXS,QBVV,QDKA,QBQU,QA01,QA5F,QAMA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: UserControl Property Code Example Doesn't Work Properly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157555</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97 Visual Basic Help, the example code provided for the
UserControl property does not work properly.
<P>
<P><h2>CAUSE</h2>
 
<P>
The example code for the UserControl property assumes that the UserControl
property applies to Workbook objects, when the property actually applies
only to the Application object.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Instead of using the UserControl Property example, use the examples shown
in the "More Information" section if you want to use the UserControl
property.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, you can use the UserControl property to determine
whether or not an instance of Microsoft Excel opened through OLE Automation
will continue to run when its object is released. By default, the
UserControl property has a value of False.
<P>
The following examples demonstrate how you can use the UserControl property
in a macro in Visual Basic or Visual Basic for Applications.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Example One: Leave UserControl Set to False</h3>
 

<OL><P><LI>In Microsoft Word 97, on the Tools menu point to Macro, and click
   Visual Basic Editor. Or, press ALT+F11.

<P><LI>On the Insert menu, click Module.

<P><LI>Enter the following code:
<P>
<PRE>      Sub UserControlStaysFalse()
          Set xlApp = CreateObject("Excel.Application.8")
          xlApp.Visible = True
          MsgBox "This is Microsoft Excel 97, build " &amp; xlApp.Build
          xlApp.Quit
          Set xlApp = Nothing
      End Sub

</PRE><P><LI>On the Tools menu, click Macros. In the list of macros, click
   UserControlStaysFalse, and then click Run.
<P>
</OL>The macro runs and displays a message box with the message "This is
Microsoft Excel, build &lt;xxxx&gt;". When the macro is finished running,
Microsoft Excel is automatically shut down.
<P>
<P><h3>Example Two: Set UserControl Set to True</h3>
 

<OL><P><LI>In Microsoft Word 97, on the Tools menu point to Macro, and click
   Visual Basic Editor. Or, press ALT+F11.

<P><LI>On the Insert menu, click Module.

<P><LI>Enter the following code:
<P>
<PRE>      Sub UserControlSetToTrue()
          Set xlApp = CreateObject("Excel.Application.8")
          xlApp.Visible = True
          MsgBox "This is Microsoft Excel 97, build " &amp; xlApp.Build
          xlApp.UserControl = True
          Set xlApp = Nothing
      End Sub

</PRE><P><LI>On the Tools menu, click Macros. In the list of macros, click
   UserControlSetToTrue, and then click Run.
<P>
</OL>The macro runs and displays a message box with the message "This is
Microsoft Excel, build &lt;xxxx&gt;". When the macro is finished running, the
instance of Microsoft Excel continues to run, even though the xlApp object
has been released.
<P>
<P><h3>Notes About Using the UserControl Property</h3>
 

<OL><P><LI>When you set the UserControl property for Microsoft Excel 97 to True,
   you must also set the Visible property to True. For example:
<P>
<P><PRE>      xlApp.Visible = True
      xlApp.UserControl = True
</PRE><P>
   If you do not do this, you will be left with an invisible instance of
   Microsoft Excel. You can shut down an invisible instance of Microsoft
   Excel by pressing CTRL+ALT+DELETE, selecting "Excel" in the list of
   tasks/programs, and clicking Shut Down.

<P><LI>The UserControl property does not apply to workbooks within Microsoft
   Excel 97. It applies only to the Application object itself. Because of
   this, you will generally not use the UserControl property within a
   macro unless it uses OLE Automation (either the CreateObject or
   GetObject) to control Microsoft Excel from another program (such as
   Microsoft Word 97 or Microsoft Visual Basic).

<P><LI>The example of the UserControl property included in the Microsoft
   Excel Visual Basic help file is incorrect, and will not work in
   Microsoft Excel 97.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information on the UserControl property of Microsoft Excel 97,
type the word "UserControl" (without the quotation marks) in a Visual Basic
module. Select the word, and press F1 to view the "UserControl Property"
help topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.0 vbe<BR>
Keywords          : kbcode kbprg xlvbahowto xlvbainfo xlhelp<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
