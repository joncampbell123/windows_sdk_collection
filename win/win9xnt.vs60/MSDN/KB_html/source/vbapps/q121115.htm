

<HTML>
<HEAD>
<TITLE>XL5: Using the WinHelp Function with Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121115">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/09/26">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmApi PgmDecl PgmHowTo kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article describes how to use the Microsoft Windows version 3.1 WinHelp function with Visual Basic, Applications Edition, to use custom Help files with applications you create. This article assumes that you are familiar both with Visual Basic, ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA6A,QDL9,QBWO,QBWN,QBVP,QAB9,QAH4,QAFF,QBFY,QAPF,QAHH,QAGI,QBXT,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Using the WinHelp Function with Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121115</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c
WINDOWS
kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to use the Microsoft Windows version 3.1 WinHelp
function with Visual Basic, Applications Edition, to use custom Help files
with applications you create. This article assumes that you are familiar
both with Visual Basic, Applications Edition, and with creating custom Help
files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Visual Basic Code Example</h3>
 
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose. Note that a line that is preceded by
an apostrophe introduces a comment in the code--comments are provided to
explain what the code is doing at a particular point in the procedure. Note
also that an underscore character (_) indicates that code continues from
one line to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line-
continuation character. For more information about Visual Basic for
Applications programming style, see the "Programming Style in This Manual"
section in the "Document Conventions" section of the "Visual Basic User's
Guide."
<P>
The following examples include:

<OL><P><LI>A global declaration section that demonstrates the declaration for the
   WinHelp function and includes predefined constants recognized by this
   function.

<P><LI>A sample procedure called SHOWHELPTOPIC that demonstrates how to
   display a specific topic within a Help file.

<P><LI>A sample procedure called HELPONHELP that demonstrates how to display
   the contents of the designated "Using Help" file.

<P><LI>A sample procedure called KEYWORDSEARCH that demonstrates how to start
   the Windows Help search engine to search for a specific keyword.

<P><LI>A sample procedure called HELPCONTENTS that demonstrates how to display
   the Contents topic in a help file.

<P><LI>A sample procedure called QUITHELP that demonstrates how to quit help.

<P><LI>A sample procedure called RUNHELPMACRO that demonstrates how to execute
   a WinHelp macro.
<P>
</OL>NOTE: For demonstration purposes, the following examples use the
MACROFUN.HLP help file, which should be located in your Microsoft Excel 5.0
directory.
<P>
<PRE>'---------------------------------------------------------------------
'GLOBAL DECLARATION SECTION
'---------------------------------------------------------------------

'The following two lines must be entered into a single line in your Visual
'Basic module.
</PRE></OL>Public Declare Function WinHelp% Lib "USER" (ByVal hwnd As Integer, _
<PRE>     ByVal HelpFile$, ByVal wCommand As Integer, ByVal dwData As Any)

'Predefined Help Constants
Const HELP_CONTEXT = &amp;h1      'Display topic in ulTopic
Const HELP_QUIT = &amp;h2         'Terminate help
Const HELP_INDEX = &amp;h3        'Display index
Const HELP_CONTENTS = &amp;h3     'Display Contents for help
Const HELP_HELPONHELP = &amp;h4   'Display help on using help
Const HELP_SETINDEX = &amp;h5     'Set the current Index for multiindex help
</PRE>Const HELP_SETCONTENTS = &amp;h5  'Set the Contents for help
Const HELP_CONTEXTPOPUP = &amp;h8 'Display index in popup window
<PRE>Const HELP_FORCEFILE = &amp;h9    'Ensure that help displays correct file
Const HELP_KEY = &amp;h101        'Display topic for keyword in dwData
Const HELP_COMMAND = &amp;h102    'Execute a Winhelp macro
</PRE>Const HELP_PARTIALKEY = &amp;h105 'Call the Windows help search engine
<P>
<P>
<P>
<PRE>'----------------------------------------------------------------------
'SHOWHELPTOPIC PROCEDURE
'Displays Help for a particular topic identified by a context number
'that has been defined in the [MAP] section of the .HPJ file.
'dwData is an unsigned long integer containing the context number
'for the topic.
'----------------------------------------------------------------------

Sub ShowHelpTopic()
</PRE>Dim ContextID As Long
<PRE>    ContextID = 2697
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_CONTEXT, ContextID
End Sub



'----------------------------------------------------------------------
'HELPONHELP PROCEDURE
'Displays the Contents topic of the designated Using Help file.
'dwData is ignored and should be set to zero length
'----------------------------------------------------------------------

Sub HelponHelp()
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_HELPONHELP, ""
End Sub



'----------------------------------------------------------------------
'KEYWORDSEARCH PROCEDURE
'Displays the topic found in the keyword list that matches the keyword
'passed in the dwData parameter if there is one exact match. If there
'is more than one match, displays the Search dialog box with the topics
'listed in the Go To list box. If there is no match, displays the search
'dialog box.
'dwData is a string that contains a keyword for the desired topic.
'-----------------------------------------------------------------------

Sub KeywordSearch()
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_PARTIALKEY, "WHILE-NEXT loops"
End Sub



'-----------------------------------------------------------------------
'HELPCONTENTS PROCEDURE
'Displays the Help contents topic as defined by the Contents option
'in the [OPTIONS] section of the .HPJ file.
'dwData is ignored and should be set to 0 length.
'-----------------------------------------------------------------------

Sub HelpContents()
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_CONTENTS, ""
End Sub



'-----------------------------------------------------------------------
'QUITHELP PROCEDURE
'Informs the Help application that Help is no longer needed.
'If no other applications have asked for Help, Windows closes the Help
'application.
'dwData is ignored and should be set to zero length.
'-----------------------------------------------------------------------

Sub QuitHelp()
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_CONTENTS, ""
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_QUIT, ""
End Sub



'-----------------------------------------------------------------------
'RUNHELPMACRO PROCEDURE
'Executes a Help macro.
'dwdata is a string that contains a Help macro to be executed.
'-----------------------------------------------------------------------

Sub RunHelpMacro()
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_CONTENTS, ""
    WinHelp 0, "c:\excel\macrofun.hlp", HELP_COMMAND, "CopyDialog()"
End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For more information on using the Windows API:
"Microsoft Windows 3.1 Software Development Kit"
<P>
For more information regarding creating custom help files:
"Microsoft Windows 3.1 Programming Tools", Microsoft Press, pages 21-66
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.00c<BR>
Keywords          : kbcode kbprg PgmApi PgmDecl PgmHowTo kbprg<BR>
Version           : 5.00 5.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
