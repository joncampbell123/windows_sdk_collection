

<HTML>
<HEAD>
<TITLE>ACC: How to Set Focus and Close Instances of Report Objects </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161878">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/01/07">
<META NAME="Keywords" CONTENT="kbusage PgmApi PgmObj RptEvent">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Access enables you to create temporary instances of reports and forms in Visual Basic code using the New keyword. This functionality enables you to create an insta...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QA1S,QADO,QAB9,QAGB,QAAW,QAPN,QDN9,QAY5,QBXS,QAW6,QAF3,QAUR,QANF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Set Focus and Close Instances of Report Objects</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161878</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access enables you to create temporary instances of reports and
forms in Visual Basic code using the New keyword. This functionality
enables you to create an instance of an object on demand.
<P>
A new instance of a form or report keeps the original object's Name
property, which can make it difficult to refer to a particular instance of
the object in code.
<P>
This article demonstrates how to set the focus on an instance of a report
and then to close it using Windows application programming interface (API)
procedures and Visual Basic for Applications code.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new report based on the Products table using the AutoReport:
   Tabular Wizard, and then save it as Report1.

<P><LI>Open the Report1 report in Design view.

<P><LI>On the View menu, click Code.

<P><LI>Type the following procedures in the report's class module:
<P>
<P><PRE>      Public Function MySetFocus()
<PRE></PRE>         Dim Result As Long
         Result = SetFocusAPI(Me.hWnd)
      End Function

      Public Function MyClose()
         Dim Result As Long
         Result = CloseWindowAPI(Me.hWnd)
      End Function

</PRE><P><LI>Close the module, and then save and close Report1.

<P><LI>Create a module and type the following in the Declarations section:
<P>
<P><PRE>      Declare Function SetFocusAPI Lib "User32" _
<PRE></PRE>                                       Alias "SetFocus" _
                                       (ByVal hWnd As Long) As Long

      Declare Function CloseWindowAPI Lib "User32" _
                                       Alias "DestroyWindow" _
                                       (ByVal hWnd As Long) As Long

</PRE><P><LI>Type the following procedure:
<P>
<PRE>      Sub ReportInstancesDemo()
         Dim i As Integer
         Dim r(1 To 4) As New Report_Report1
         ' Create instances of the reports
         ' with unique captions.
         For i = LBound(r) To UBound(r)
            r(i).Visible = True
            r(i).Caption = "Report" &amp; CStr(i)
         Next i
         ' Set focus and close each report instance.
         For i = LBound(r) To UBound(r)
            r(i).MySetFocus
            MsgBox "Click OK to close report instance Report" &amp; CStr(i)
            r(i).MyClose
         Next i
      End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ReportInstancesDemo
</PRE><P>
   Note that the procedure creates four instances of the Report1 report,
   each with a different caption. Then the procedure sets the focus to each
   report in turn, and prompts you to close the instance of the report.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about declaring API procedures, search the Help Index
for "Declare statement."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: New Objects Reports<BR>
Keywords          : kbusage PgmApi PgmObj RptEvent<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
