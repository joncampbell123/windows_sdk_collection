

<HTML>
<HEAD>
<TITLE>WD98: Sample VBA Code to Set, Retrieve Summary Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181441">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1998/02/19">
<META NAME="Keywords" CONTENT="kbdta kbdtacode word97 OffVBA macword98">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Word, you can use Microsoft Visual Basic for Applications to access the summary information in the Document Properties dialog box (on the File menu, click Properties) and then display the information in a message box, insert the inform...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QAPN,QBT3,QBXS,QAMB,QBS0,QAKD,QDMW,QAUD,QABA,QAIH,QAKJ,QAH4,QALW,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD98: Sample VBA Code to Set, Retrieve Summary Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181441</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Word, you can use Microsoft Visual Basic for Applications to
access the summary information in the Document Properties dialog box (on
the File menu, click Properties) and then display the information in a
message box, insert the information into the active document, or store the
values within a variable.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To retrieve or set values on the Summary tab of the Document Properties
dialog box, use the following literal string arguments or property
constants with either of the two methods below.
<P>
<PRE>   Literal String Arguments             Property Constants
   ------------------------             ------------------
   Title                                wdPropertyTitle
   Subject                              wdPropertySubject
   Author                               wdPropertyAuthor
   Manager                              wdPropertyManager
   Company                              wdPropertyCompany
   Category                             wdPropertyCategory
   Keywords                             wdPropertyKeywords
   Comments                             wdPropertyComments
   Hyperlink base                       wdPropertyHyperlinkbase

</PRE><h3>Method 1: Use the BuiltInDocumentProperties Property</h3>
 
<P>
Use the BuiltInDocumentProperties property to set and return summary
information for the active document. You can specify which value to set or
retrieve by referencing the argument through a built-in constant or a
literal string. The following sample code uses the wdPropertyTitle constant
to retrieve the title for the active document and displays the result in a
message box.
<P>
<PRE>   Sub GetSetDocProps()

      If Documents.Count &gt; 0 Then

         Dim dp As Object
         Set dp = ActiveDocument.BuiltInDocumentProperties

         ' Retrieve and display the active document's
         ' title by using the constant "wdPropertyTitle."
         MsgBox dp(wdPropertyTitle)

      End If

   End Sub

</PRE>The following sample code uses a literal string to define the keywords for
the active document:
<P>
<PRE>   Sub SetDocProps()

      If Documents.Count &gt; 0 Then

         Dim dp As Object
         Set dp = ActiveDocument.BuiltInDocumentProperties

         ' Set KeyWords for the active document by
         ' using a literal string.
         dp("KeyWords") = "Summary Information Example Macro"
         ActiveDocument.Save

      End If

   End Sub

</PRE><h3>Method 2: Use the Dialogs Collection to Set and Return Values</h3>
 
<P>
Use the Dialogs collection to set and return values for the active
document's summary information.
<P>
Before you return or change a built-in dialog box setting, you need to
identify the individual dialog box. To do this, use the Dialogs collection
and a WdWordDialog constant that identifies the dialog box. The following
Visual Basic statement returns the Dialog object that refers to the Summary
tab of the Document Properties dialog box.
<P>
<PRE>   Set myDialog = Dialogs(wdDialogFileSummaryInfo)

</PRE>You can set or retrieve the following literal string arguments without
displaying the Summary tab when a document is open.
<P>
<PRE>   Title
   Subject
   Author
   Manager
   Company
   Category
   Keywords
   Comments
   Hyperlinkbase

</PRE>The following sample macro retrieves the current value of the Title string,
places this value in a variable string, and sets a new value without
displaying the Properties dialog box.
<P>
<PRE>   Sub SetSummaryInfo()

      If Documents.Count &gt; 0 Then

         Dim dp As Object
         Set dp = Dialogs(wdDialogFileSummaryInfo)

         ' Retrieve value of Title and store in a variable.
         a$ = dp.Title

         ' Set Title to a new value.
         dp.Title = "My Title"

         ' Set the value without showing the dialog box.
         dp.Execute

         ' Save the changes.
         ActiveDocument.Save

      End If

   End Sub

</PRE>The following sample macro sets a new value for Title and displays the
Properties dialog box.
<P>
<PRE>   Sub SetSummaryInfo()

      If Documents.Count &gt; 0 Then

         Dim dp As Object
         Set dp = Dialogs(wdDialogFileSummaryInfo)

         ' Set Title to a new value.
         dp.Title = "My Title"

         ' Set the value.
         dp.Execute

         ' Save the changes.
         ActiveDocument.Save

         ' Display the dialog box.
         ' Note: Using the Display method will not keep changes
         ' manually entered into the dialog box. To keep changes
         ' manually entered in the dialog box, use the Show method.
         dp.Display

      End If

   End Sub

</PRE>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q173707.htm">Q173707</A></B>
   TITLE     : OFF97: How to Run Sample Code from Knowledge Base Articles

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about displaying, setting, or retrieving values in
Word dialog boxes, click Office Assistant while in the Visual Basic Editor,
type "Displaying dialog boxes" (without the quotation marks), click Search,
and then click Displaying built-in Word dialog boxes.
<P>
For information about how to do this in earlier versions of Word, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q85168.htm">Q85168</A></B>
   TITLE     : WD: How to Access the Summary Info Dialog Box from a Macro

</PRE>For more information about getting help with Visual Basic for Applications,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : kbdta kbdtacode word97 OffVBA macword98<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
