

<HTML>
<HEAD>
<TITLE>ACC: Sample Function to Format Names </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149953">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/04/17">
<META NAME="Keywords" CONTENT="kbprg kbusage PgmHowTo PgmParse">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article lists a sample function that you can use in Microsoft Access to concatenate portions of text fields. The function is useful in displaying names in various formats on...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAML,QA1S,QAIV,QDN9,QAGX,QBS0,QA5F,QAY5,QAMA,QAB9,QBV8,QAQ3,QAG4,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sample Function to Format Names</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149953</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article lists a sample function that you can use in Microsoft Access
to concatenate portions of text fields. The function is useful in
displaying names in various formats on forms and reports. This function can
be used as a control source in a text box on either a form or report, or as
an expression in a query.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.
<P>
Open any database in Microsoft Access and follow these steps to create the
NFORMAT() function:

<OL><P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function NFormat(First As Variant, Middle As Variant, Last As _
<PRE></PRE>         Variant, Style As Variant)
      On Error GoTo Err_NFormat
      Dim iFirst As Variant, iMiddle As Variant, iLast As Variant
      Dim NewName As String

      iFirst = IIf(Len(First),Left(First, 1) + IIf(Len(First) = 1, " ", _
         ". "), "")
      iMiddle = IIf(Len(Middle),Left(Middle, 1) + IIf(Len(Middle) = 1, _
         " ", ". "),"")
      iLast = IIf(Len(Last),Left(Last, 1) + IIf(Len(Last) = 1, " ", ". ") _
         , "")

      Select Case Style

         Case "0", "FML"
           NewName = First &amp; " " &amp; (Middle + " ") &amp; Last
         Case "1", "FIL"
           NewName = First &amp; " " &amp; iMiddle &amp; Last
         Case "2", "IIL"
           NewName = iFirst &amp; iMiddle &amp; Last
         Case "3", "LFM"
           NewName = Last &amp; ", " &amp; First &amp; (" " + Middle)
         Case "4", "LFI"
           NewName = Last &amp; ", " &amp; First &amp; (" " + iMiddle)
         Case "5", "LII"
           NewName = Last &amp; ", " &amp; iFirst &amp; iMiddle
         Case "6", "FL"
           NewName = First &amp; " " &amp; Last
         Case "7", "FI"
           NewName = First &amp; " " &amp; iLast
         Case "8", "LF"
           NewName = Last &amp; ", " &amp; First
         Case "9", "LI"
           NewName = Last &amp; ", " &amp; iFirst
         Case "10", "III"
           NewName = iFirst &amp; iMiddle &amp; iLast
         Case "11", "II"
           NewName = iFirst &amp; iLast
         Case Else
           NewName = ""
         End Select
           NFormat = Trim(NewName)
         Exit Function

      Err_NFormat:
           NFormat = "#Error"
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window
   (or Immediate window in Microsoft Access 2.0), and then press ENTER.
<P>
<P><PRE>       ? NFormat("Nancy","Anne","Davolio",4)
</PRE><P>
<P><PRE>     Note that Davolio, Nancy A. displays.
</PRE><P>
</OL>Sample Output with the following fields [First]="Nancy", [Middle]="Anne",
[Last]="Davolio":
<P>
<PRE>   NFormat([First],[Middle],[Last],[Style])

   Where                     Displays
   [Style]=0                  Nancy Anne Davolio
   [Style]=1                  Nancy A. Davolio
   [Style]=2                  N. A. Davolio
   [Style]=3                  Davolio, Nancy Anne
   [Style]=4                  Davolio, Nancy A.
   [Style]=5                  Davolio, N. A.
   [Style]=6                  Nancy Davolio
   [Style]=7                  Nancy D.
   [Style]=8                  Davolio, Nancy
   [Style]=9                  Davolio, N.
   [Style]=10                 N. A. D.
   [Style]=11                 N. D.

</PRE></OL>If you use an invalid style, the procedure returns an empty string ("").
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: how to<BR>
Keywords          : kbprg kbusage PgmHowTo PgmParse<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
