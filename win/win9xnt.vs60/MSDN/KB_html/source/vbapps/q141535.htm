

<HTML>
<HEAD>
<TITLE>ACC: Change Active Control Background Color with Timer Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141535">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbusage PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This articles demonstrates a method that you can use to change the background color of the active control on a form. This method will change the control's background color a...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAG9,QA1S,QAB5,QDN9,QA7O,QAMN,QAOE,QBS0,QAPN,QAYL,QAAP,QAB4,QBXS,QAH4,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Change Active Control Background Color with Timer Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141535</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This articles demonstrates a method that you can use to change the
background color of the active control on a form. This method will
change the control's background color as long as the control supports
the BackColor property.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create the method that changes the background color of the active
control on a form, follow these steps.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0). You may want to back
up the Northwind.mdb (or NWIND.MDB) or perform these steps on a copy of the
Northwind database.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Click the Module tab, and then click New.

<P><LI>In the Declarations section of the module type the following line:
<P>
<P><PRE>      Global myctrname as String
</PRE>
<P><LI>Save the module as Module1, and then close the module.

<P><LI>Open the Customers form in Design view.

<P><LI>Set the Customers form OnTimer property to the following event
   procedure:
<P>
<PRE>      Private Sub form_Timer ()         ' In Microsoft Access 2.0, the word
                                        ' "Private" will not appear in this
                                        ' line of the code.

      Dim lngYellow As Long, lngWhite As Long
          On Error GoTo Errhandler
          lngYellow = RGB(255, 255, 0)     'Set lngYellow variable for
                                           'yellow color.
          lngWhite = RGB(255, 255, 255)    'Set lngWhite variable for white
                                           'color.

          If Screen.ActiveControl.Name &lt;&gt; myctrname Then  ' If active
                                                          ' control not
                                                          ' equal to
                                                          ' myctrname do
                                                          ' next line.
          Me(myctrname).BackColor = lngWhite            ' Set myctrname
                                                        ' variable to white
                                                        ' BackColor.
          Screen.ActiveControl.BackColor = lngYellow    ' Set active color
                                                        ' BackColor to
                                                        ' yellow.
          myctrname = Screen.ActiveControl.Name         ' Set myctrname
                                                        ' variable to
                                                        ' active control
                                                        ' name.
          End If

      Exit Sub

      Errhandler:
      If Err = 2465 Then        ' If error is 2465 which is "Object-defined
                                ' error."
      Resume Next               ' Resume running on next line after error.
      ElseIf Err = 2474 Then    ' If error is 2474 which is "No Control is
                                ' active."
      Resume Next
      Else
         MsgBox Err &amp; " " &amp; Error   ' Show Error number and string of error
                                    ' value.
      Exit Sub
      End If

      End Sub

</PRE><P><LI>Set the Customers form's TimerInterval property to 200.

<P><LI>View the Customers form in Form view. Press TAB to move from one control
   to another. Note that the background color changes from white to yellow
   for each control that receives the focus.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about this topic, search for "backcolor," and then
"Change the background color of a control or section" using the Microsoft
Access 97 Help Index.
<P>
NOTE: The TimerInterval property uses milliseconds (1000 = One second).
Smaller numbers produce quicker responses. You may have to experiment with
the numbers to achieve the desired effect.
 
<PRE>Keywords          : kbusage PgmObj
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
