

<HTML>
<HEAD>
<TITLE>XL5: Using Global and Local References in Formulas </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107197">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/11/16">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo kbprb kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can define names on a worksheet as either global or local names.  Global Names  Global names are available to the entire workbook. For example, if you define cells A1:A10 on Sheet1 as Sales, you can sum the sales on Sheet2 w...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDMF,QAUJ,QA7H,QANG,QARM,QAAW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Using Global and Local References in Formulas</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107197</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can define names on a worksheet as either
global or local names.
<P>
<P><h3>Global Names</h3>
 
<P>
Global names are available to the entire workbook. For example, if
you define cells A1:A10 on Sheet1 as Sales, you can sum the sales
on Sheet2 with the formula =SUM(Sales). When you use a global name,
you do not need to indicate a sheet name because a global name is
available to any sheet in the workbook.
<P>
<P><h3>Local Names</h3>
 
<P>
A local name is available only on the sheet where it is defined. You
create a local name by including the sheet name with an exclamation
point (!) before the name in the Define Name dialog box. For example,
in the Name box, type "Sheet1!Sales" (without the quotation marks) and
in the Refers To box, type "Sheet1!$A$1:$A$10" (without the quotation
marks). To use this name on a another sheet in the workbook, create an
external reference, for example, type:
<P>
<PRE>   =SUM(Sheet1!Sales)

</PRE>Local names take precedence over global names. To refer to a global
name that duplicates a local name on the active sheet, use an
external reference by specifying the workbook name.
<P>
The following discusses the ways to refer to global and local names,
both on the current workbook and on another workbook.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Referring to Global and Local Names Located on the Current Workbook</h3>
 
<P>
The following table uses as an example a workbook called "Products"
which contains the worksheets "Sheet1," "Sheet2," and "Sheet3." Sales
is a global name on Products and is also a local name defined on both
Sheet1 and Sheet2 but not on Sheet3. Sheet1!Sales is the name of the
local Sales on Sheet1. Sheet2!Sales is the name of the local Sales on
Sheet2. Sales is the name of the global Sales on Products.
<P>
<PRE>   To Refer to this name     On this sheet     Use this formula
   ------------------------------------------------------------

   Sheet1!Sales              Sheet1            =Sales
   Sheet1!Sales              Sheet2            =Sheet1!Sales
   Sheet1!Sales              Sheet3            =Sheet1!Sales
   Sheet2!Sales              Sheet1            =Sheet2!Sales
   Sheet2!Sales              Sheet2            =Sales
   Sheet2!Sales              Sheet3            =Sheet2!Sales
   Sales                     Sheet1            =Sheet3!Sales (see
                                                NOTE below)
   Sales                     Sheet2            =Products!Sales
   Sales                     Sheet3            =Sales

</PRE>NOTE: To refer to the global name Sales from Sheet1 which also
contains the local name Sales, you must use the name of a worksheet
in the workbook that does not contain the local name Sales. In this
case, Sheet3 must be used in the reference to the global name
Sales. For more information on this exception involving the first
worksheet in a workbook, query on the following words in the Microsoft
Knowledge Base:
<P>
<PRE>   reference and global and first


</PRE><h3>Search Order of Global and Local Names on the Current Workbook</h3>
 
<P>
If you enter the formula =Sales on a worksheet in Products, the
following search order is used:
<P>
<PRE>   Local Sales on the current worksheet in Products
   Global Sales on Products

</PRE>If you enter the formula =Sheet1!Sales or the formula
=[Products]Sheet1!Sales on a worksheet in Products, the following
search order is used:
<P>
<PRE>   Local Sales on Sheet1
   Global Sales on Products

</PRE>If you enter the formula =Products!Sales on a worksheet in
Products, the formula will look for the following defined name:
<P>
<PRE>   Global Sales on the Products workbook (see NOTE above)

</PRE><h3>Referring to Global and Local Names Located on Another Workbook</h3>
 
<P>
The following table uses Workbook2, as well as the Products workbook
defined above.
<P>
<PRE>                             On a worksheet
   To Refer to this name     in this workbook      Use this formula
   -----------------------------------------------------------------

   Sheet1!Sales              Workbook2             =[Products]Sheet1!Sales
   Sheet2!Sales              Workbook2             =[Products]Sheet2!Sales
   Sales                     Workbook2             =Products!Sales

</PRE>To refer to a global or local name on another workbook, you must
include the workbook name.
<P>
<P><h3>Search Order of Global and Local Names on Another Workbook</h3>
 
<P>
If you enter the formula =[Products]Sheet1!Sales on a worksheet in
Workbook2, the following search order is used:
<P>
<PRE>   Local Sales on Sheet1
   Global Sales on Products

</PRE>If you enter the formula =Products!Sales on a worksheet in
Workbook2, the formula will look for the following defined name:
<P>
<PRE>   Global Sales on the Products workbook

</PRE>If the name Sales is found in the first step of the search, that
value of Sales is returned, and the search is complete. If the name
Sales is not found after the final step in the search, the #NAME!
error will be returned.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide," version 5.0, pages 144-150
<P>
For more information about Naming a Cell, Range or Formula, choose
the Search button in Help and type:
<P>
<PRE>    naming
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00<BR>
Keywords          : kbprg PgmHowTo kbprb kbprb<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
