

<HTML>
<HEAD>
<TITLE>XL97: How to Verify the Value of a CheckBox on a UserForm </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161326">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, a CheckBox control on a UserForm can have one of three values: True, False or Null. This article contains a sample macro that programmatically retrieves the value of a CheckBox control.  MORE INFORMATION  CheckBox Behavior  By d...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAKD,QAMN,QAHP,QA7O,QAOE,QAB5,QAMB,QBVP,QAPN,QBWS,QBXS,QAH4,QABI,QABH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: How to Verify the Value of a CheckBox on a UserForm</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161326</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, a CheckBox control on a UserForm can have one of three
values: True, False or Null. This article contains a sample macro that
programmatically retrieves the value of a CheckBox control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>CheckBox Behavior</h3>
 
<P>
By default, Microsoft Excel 97 allows you to set the value of a CheckBox
control to True or False. A True value indicates that the CheckBox control
is selected, False indicates that the CheckBox control is cleared.
<P>
You can also set a CheckBox control to a third value called Null. Note that
before you can set the Null value, you must set the TripleState property of
a CheckBox control to True.
<P>
A CheckBox control set to Null is shaded. Note that when you set the
TripleState property of a CheckBox control to True, the Value of the check
box is set to the following values in the following order: False, Null, and
True.
<P>
When you set the value of a CheckBox control to Null, the Click event for
the check box is not executed. If you want to check for a Null value when
you click a CheckBox control, use the Change event.
<P>
<P><h3>Visual Basic for Applications Macro Example</h3>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.

<OL><P><LI>Close and save any open workbooks, and then open a new workbook.

<P><LI>Start the Visual Basic Editor (press ALT+F11).

<P><LI>If the Properties window is not visible, click Properties on the
    View menu (or press F4).

<P><LI>On the Insert menu, click UserForm.

<P><LI>Draw a CheckBox control on the UserForm.

<P><LI>Activate the Properties window (press F4).

<P><LI>Change the value of the TripleState property to True.

<P><LI>Draw a Label control on the UserForm.

<P><LI>Double-click the CheckBox to display the Code window for the
    UserForm.

<P><LI>Click Change in the Procedure list.

<P><LI>In the module, type the following code for the CheckBox1 Change event:
<P>
       Private Sub CheckBox1_Change()
<P>
<PRE>           'Evaluate the value of the CheckBox
           Select Case CheckBox1.Value
               Case True, False

                   'Set the caption of the Label to the value of the 
                   'CheckBox.
                   Label1.Caption = CheckBox1.Value

               Case Else
                   'If Null, set the Label's caption appropriately.
                   Label1.Caption = "Null"

           End Select

       End Sub

</PRE><P><LI>Run the UserForm.
<P>
</OL>When you click the CheckBox control, the value of the label changes. When
you are finished, close the UserForm.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about CheckBoxes, click the Index tab in Visual Basic
for Applications Help, type the following text
<P>
<PRE>   check

</PRE></OL>and then double-click the selected text to go to the "CheckBox control"
topic.
<P>
For more information about the TripleState property, click the Index tab in
Visual Basic for Applications Help, type the following text
<P>
<PRE>   triple

</PRE>and then double-click the selected text to go to the "TripleState Property"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbcode kbprg xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
