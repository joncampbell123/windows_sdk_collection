

<HTML>
<HEAD>
<TITLE>ACC: Line Numbers Not Automatically Returned by Erl Variable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148358">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/04/12">
<META NAME="Keywords" CONTENT="kbprg PgmErr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When a run-time error occurs in a Visual Basic for Applications user- defined function with error handling in effect, the Erl() function returns 0 unless a line number is sp...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIB,QBXT,QA5V,QA1S,QAAP,QAB4,QAY5,QBS0,QAUD,QDN9,QAKC,QBC6,QAYL,QAG8,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Line Numbers Not Automatically Returned by Erl Variable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148358</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When a run-time error occurs in a Visual Basic for Applications user-
defined function with error handling in effect, the Erl() function returns
0 unless a line number is specified in the user-defined function.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access for Windows 95" manual.
<P>
NOTE: Visual Basic for Applications (used in Microsoft Access version 7.0)
is called Access Basic in earlier versions.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can return a line number in the Erl() function by specifying a line
number on or above the line that causes the error. The Erl() function
will return the line number currently in effect. You must specify a numeric
line number, not an alphanumeric line label. The Erl function() will only
return a line number. For an example of how this works, see the "Steps to
Work Around Behavior" section later in this article.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open any database.

<P><LI>Open a new module.

<P><LI>Type the following code:
<P>
<PRE>      Sub ErrorTest ()
          Dim x as Integer                ' Declare variable.
          On Error Goto ErrorTest_Error
          x = 5 / 0                       ' Divide by zero error.
          Exit Sub

      ErrorTest_Error:
          Debug.Print "Error occurred in line #" &amp; Erl
          Resume Next
      End Sub

</PRE><P><LI>Open the Debug window.

<P><LI>Type the following line in the Debug window (or Immediate window in
   1.x and 2.0), and then press ENTER:
<P>
<P><PRE>      ErrorTest
</PRE><P>
   Note that you receive the following error:
<P>
<P><PRE>      Error occurred in line #0
</PRE><P>
</OL><h3>Steps to Work Around Behavior</h3>
 

<OL><P><LI>Open the module containing ErrorTest().

<P><LI>Modify ErrorTest() as follows:
<P>
<PRE>      Sub ErrorTest ()
          Dim x as Integer                ' Declare variable.
      10:                                 ' NEW LINE!!!
          On Error Goto ErrorTest_Error
      11:                                 ' NEW LINE!!!
          x = 5 / 0                       ' Divide by zero error
      12:                                 ' NEW LINE!!!
          Exit Sub

      ErrorTest_Error:
          Debug.Print "Error occurred in line #" &amp; Erl
          Resume Next
      End Sub

</PRE><P><LI>Open the Debug window.

<P><LI>Type the following line into the Debug window, and then press ENTER:
<P>
<P><PRE>      ErrorTest
</PRE><P>
   Note that now you receive the following error:
<P>
<P><PRE>    Error occurred in line #11
</PRE><P>
</OL>NOTE: In the example above, if the numeric line label 11 did not exist, the
Erl() function would have returned the number 10 as it is the first
preceding numeric label.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Error handling, search for "Error handling," and
then "Error Trapping" using the Microsoft Access for Windows 95 Help Index.
<P>
For more information about the Erl() function, search for "Erl" and then
"Err, Erl Functions" using the Microsoft Access Help menu.
<P>
NOTE: There is no reference to the Erl() function in the Microsoft Access
version 7.0 Help.
 
<PRE>Keywords          : kbprg PgmErr
Version           : 1.0 1.1 2.0 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
