

<HTML>
<HEAD>
<TITLE>Using MS Excel 5.0 Dialog Boxes MS Excel 4.0 Macro Language </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132355">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1995/07/09">
<META NAME="Keywords" CONTENT="kbcode kbmacro kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Microsoft Excel version 5.0 includes several enhancements to the Microsoft Excel version 4.0 macro language that enable users to send and retrieve information from various dialog sheet controls in Microsoft Excel 5.0. The following information incl...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QBV4,QAHP,QBVP,QA2Q,QBVR,QAKD,QAG2,QAH4,QALW,QBXS,QAB4,QBV3,QABH,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using MS Excel 5.0 Dialog Boxes MS Excel 4.0 Macro Language</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132355</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel version 5.0 includes several enhancements to the Microsoft
Excel version 4.0 macro language that enable users to send and retrieve
information from various dialog sheet controls in Microsoft Excel 5.0. The
following information includes examples of tasks that you may want to
perform using this functionality.
<P>
NOTE: In each of the following examples, the dialog sheet must be the
active sheet prior to running each macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>EDIT BOXES</h3>
 
<P>
To set the value of an edit box:
<P>
This examples sets the value of an edit box to "MyValue" and then displays
the dialog box. The quotation marks are not necessary for numeric values.
<P>
<PRE>   =SELECT("Edit Box 1")
   =TEXT.BOX("MyValue")
   =SHOW.DIALOG("Dialog1")
   =RETURN()

</PRE>To obtain the value of an edit box:
<P>
<PRE>   =SELECT("Edit Box 1")
   Answer=GET.OBJECT(12)
   =ALERT(Answer)
   =RETURN()

</PRE><h3>CHECK BOXES</h3>
 
<P>
To obtain the value from three different check boxes:
<P>
Returns 0 if the check box is not checked, 1 if it is checked, and 2 if it
is mixed.
<P>
<PRE>   =FOR("counter",1,3)
   =Answer=GET.OBJECT(62,"Check Box " &amp;counter)
   =ALERT(Answer)
   =NEXT()
   =RETURN()

</PRE><h3>OPTION BUTTONS</h3>
 
<P>
To obtain the value of three different option buttons:
<P>
Returns 0 if the option button is not selected and 1 if it is selected.
<P>
<PRE>   =FOR("counter",1,3)
   Answer=GET.OBJECT(62,"Option Button " &amp;counter)
   =ALERT(Answer)
   =NEXT()
   =RETURN()

</PRE><h3>LIST BOXES</h3>
 
<P>
To obtain the selected value of a list box:
<P>
This macro will return the #VALUE! error if nothing is selected.
<P>
<PRE>   Answer=GET.OBJECT(72,"List Box 1",1,100,GET.OBJECT(62,"List Box 1"))
   =ALERT(Answer)
   =RETURN()

</PRE>To set the selected item in a list box:
<P>
This macro sets the selected value to the third item of the list.
<P>
<PRE>   =SELECT("List Box 1")
   =SELECT.LIST.ITEM(3)
   =SHOW.DIALOG("Dialog1")
   =RETURN()

</PRE><h3>DROP-DOWN LIST BOXES</h3>
 
<P>
To obtain the selected value of a drop-down list box:
<P>
<PRE>   Answer=GET.OBJECT(72,"Drop Down 1",1,100,GET.OBJECT(62,"Drop Down 1"))
   =ALERT(Answer)
   =RETURN()

</PRE>To set the selected item of a drop-down list box:
<P>
This macro will not take effect until the drop-down control is selected at
least once. This macro sets the selected value to the third item in the
drop-down list.
<P>
<PRE>   =SELECT("Drop Down 1")
   =SELECT.LIST.ITEM(3)
   =SHOW.DIALOG("Dialog1")
   =RETURN()

</PRE><h3>COMBINATION LIST-EDIT BOX</h3>
 
<P>
To obtain the selected value of a combination list-edit box:
<P>
<PRE>   Answer=GET.OBJECT(72,"ComboList1",1,100,GET.OBJECT(62,"ComboList1"))
   =ALERT(Answer)
   =RETURN()

</PRE>To set the selected item of a combination list-edit box:
<P>
This macro sets the selected value to the third item of the list.
<P>
<PRE>   =SELECT("ComboList1")
   =SELECT.LIST.ITEM(3)
   =SHOW.DIALOG("Dialog1")
   =RETURN()

</PRE>To obtain the value in the edit box portion of a combination list-edit:
<P>
<PRE>   =SELECT("ComboEditBox1")
   Answer=GET.OBJECT(12)
   =ALERT(Answer)
   =RETURN()

</PRE><h3>COMBINATION DROP-DOWN EDIT BOXES</h3>
 
<P>
To obtain the selected value of a combination drop-down edit box:
<P>
<PRE>  Ans=GET.OBJECT(72,"ComboDropDown1",1,100,GET.OBJECT(62,"ComboDropDown1"))
  =ALERT(Ans)
  =RETURN()

</PRE>To set the selected item of a combination drop-down edit box:
<P>
This macro sets the selected value to the third item of the drop-down box.
<P>
<PRE>   =SELECT("ComboDropDown1")
   =SELECT.LIST.ITEM(3)
   =SHOW.DIALOG("Dialog1")
   =RETURN()

</PRE><h3>SCROLL BARS</h3>
 
<P>
To return a scroll bar value to an edit box:
<P>
Assign the control to the following macro by clicking the dialog box
control with the right mouse button and choosing Assign Macro from the
shortcut menu.
<P>
<PRE>   Answer=GET.OBJECT(62,"Scroll Bar 1")
   =SELECT("Edit Box")
   =TEXT.BOX(Answer)
   =RETURN()

</PRE>To obtain the scroll bar step increment value:
<P>
Assign the control to the following macro by clicking the dialog control
with the right mouse button and selecting Assign Macro from the shortcut
menu.
<P>
<PRE>   Answer=GET.OBJECT(65,"Scroll Bar 1")
   =ALERT(Answer)
   =RETURN()

</PRE><h3>SPINNERS</h3>
 
<P>
To return the value of a spinner:
<P>
Assign the control to the following macro by clicking the dialog control
with the right mouse button and choosing Assign Macro from the shortcut
menu.
<P>
<PRE>   Answer=GET.OBJECT(62,"Spinner 1")
   =ALERT(Answer)
   =RETURN()
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Dialogs<BR>
Keywords          : kbcode kbmacro kbprg PgmOthr<BR>
Version           : WINDOWS:5.0,5.0c; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
