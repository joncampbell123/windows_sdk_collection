

<HTML>
<HEAD>
<TITLE>ACC: How to Display Line Numbers on Subform Records </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120913">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1994/09/21">
<META NAME="Keywords" CONTENT="kbusage FmsSubf">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to create and use a procedure to display the current line or row number in a subform.  This article assumes that you are familiar with Visual Basi...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA5V,QDN9,QA7O,QA7N,QBC6,QAKC,QBT6,QBS0,QAPF,QBV4,QBXT,QAIB,QA5F,QAY5 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Display Line Numbers on Subform Records</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120913</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to create and use a procedure to display the
current line or row number in a subform.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following examples demonstrate how to create and use the sample
function GetLineNumber():
<P>
<P><h3>How to Create the GetLineNumber() Function</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).

<P><LI>Create a new module and type the following line in the Declarations
   section if it isn't already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      Function GetLineNumber (F As Form, KeyName As String, KeyValue)
<PRE></PRE>         Dim RS As Recordset
         Dim CountLines

         On Error GoTo Err_GetLineNumber

         Set RS = F.RecordsetClone

         ' Find the current record.
         Select Case RS.Fields(KeyName).Type
            ' Find using numeric data type key value.
            Case DB_INTEGER, DB_LONG, DB_CURRENCY, DB_SINGLE, _
            DB_DOUBLE, DB_BYTE
               RS.FindFirst "[" &amp; KeyName &amp; "] = " &amp; KeyValue
            ' Find using date data type key value.
            Case DB_DATE
               RS.FindFirst "[" &amp; KeyName &amp; "] = #" &amp; KeyValue &amp; "#"
            ' Find using text data type key value.
            Case DB_TEXT
               RS.FindFirst "[" &amp; KeyName &amp; "] = '" &amp; KeyValue &amp; "'"
            Case Else
               MsgBox "ERROR: Invalid key field data type!"
               Exit Function
         End Select

         ' Loop backward, counting the lines.
         Do Until RS.BOF
            CountLines = CountLines + 1
            RS.MovePrevious
         Loop

      Bye_GetLineNumber:
         ' Return the result.
         GetLineNumber = CountLines

         Exit Function

      Err_GetLineNumber:
         CountLines = 0
         Resume Bye_GetLineNumber

      End Function

</PRE></OL>The GetLineNumber() function requires the following three parameters:

<UL><LI>The form object on which to place line numbers.

<LI>The name of the unique key field in the subform's underlying table. If
   the record source does not have a single unique key field, add a field
   with an AutoNumber data type (or Counter in version 2.0) to the
   underlying table for this purpose.

<LI>The current key field value.
<P>
</UL>You could use the following sample expression as the ControlSource property
setting of a text box on a subform, given that the subform's underlying
table has a field called ID as its unique key field:
<P>
<PRE>   =GetLineNumber(Form,"ID",[ID])

</PRE><h3>How to Use the GetLineNumber() Function</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0). You may want to back
up the Northwind.mdb file, or perform these steps on a copy of the
Northwind database.

<OL><P><LI>Open the Order Details table in Design view, add the following
   field to the table, and then save the table:
<P>
<P><PRE>      Field Name: ID
      Data Type:  AutoNumber
</PRE><P>
   NOTE: AutoNumber is called Counter in version 2.0.
<P>
   This field will serve as the required single unique field for the
   table.

<P><LI>Open the Order Details Extended query in Design view, add the
   ID field from the Order Details table to the query grid, and then
   save the query.

<P><LI>Open the Orders Subform form in Design view and add the following text
   box to the form:
<P>
<P><PRE>      Name: LineNum
      ControlSource: =GetLineNumber([Form], "ID", [ID])
</PRE>
<P><LI>On the View menu (or Edit menu in version 2.0), click Tab Order. Drag
   the LineNum field from the bottom of the Custom Order list to the top,
   and then click OK.

<P><LI>Save and then close the Orders Subform.

<P><LI>Open the Orders form in Form view and move to a record with multiple
   order line items. Note that the LineNum text box displays the record
   number for each product in the order.
</OL> 
<PRE>Keywords          : kbusage FmsSubf
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
