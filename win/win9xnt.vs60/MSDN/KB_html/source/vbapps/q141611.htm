

<HTML>
<HEAD>
<TITLE>ACC: How to Import Several dBASE Databases at Once 95/97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141611">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kb3rdparty PgmHowTo PgmObj PgmFilM">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article demonstrates how you can import multiple dBASE databases using a batch process using Visual Basic for Applications.  Many new Microsoft Access 7.0 and 97 users want to immediately import data from the systems they are currently using. ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDI1,QABM,QA1S,QAZV,QBS0,QDN9,QAEQ,QAJZ,QA7O,QA7N,QAUJ,QATJ,QAK6,QBCF,QAP2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Import Several dBASE Databases at Once 95/97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141611</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how you can import multiple dBASE databases using
a batch process using Visual Basic for Applications.
<P>
Many new Microsoft Access 7.0 and 97 users want to immediately import
data from the systems they are currently using. The Import dialog box in
Microsoft Access enables you to import one table at a time, which usually
is sufficient. However, some users have numerous tables to import, or they
may want to import multiple tables regularly.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can quickly import tables with a batch process using a Visual Basic
procedure and a batch table. This procedure is designed for importing only
dBASE databases, but you can easily modify the procedure to accommodate
other file formats.
<P>
The batch table lists the tables that you want to import. The Visual Basic
procedure reads the table and imports each foreign table listed there. To
do so, follow these steps:

<OL><P><LI>Create a table called Batch Import with the following structure:
<P>
<P><PRE>      Table: Batch Import
      ----------------------------
      Field Name: Source Directory
<PRE></PRE>         Data Type : Text
         Field Size: 50
      Field Name: Source Database
         Data Type : Text
         Field Size: 50
      Field Name: Imported Name
         Data Type : Text
         Field Size: 50
      Field Name: Type of Table
         Data Type : Text
         Field Size: 50

</PRE><P><LI>Enter information in the new Batch Import table about the tables you
   want to import. The fields in the Batch Import table should be
   filled out as follows:
<P>
<P><PRE>    - Source Directory: This is the full path for the location of the
      foreign database file (for example, C:\dBase).
</PRE><P>
<P><PRE>    - Source Database: This is the name and extension of the dBASE
      database you want to import (for example, Customer.dbf).
</PRE><P>
<P><PRE>    - Imported Name: This is the name you want the table to have once it
      is imported into Microsoft Access (for example, Customers).
</PRE><P>
<P><PRE>    - Table Type: This can be either dBASE III or dBASE IV. Specify dBASE
      III for both dBASE III and dBASE III PLUS databases.
</PRE><P>
   For example, to import a dBASE IV database called Employee.dbf from the
   C:\dBase4 directory and a dBASE III database called Orders.dbf from the
   D:\dBase3\Data directory, you would fill out the fields in the Batch
   Import table as follows:
<P>
<PRE>      Source Directory   Source Database  Imported Name   Table Type
      --------------------------------------------------------------
      C:\dBase4          Employee.dbf     Employee Table  dBASE IV
      D:\dBase3\data     Orders.dbf       Orders Table    dBASE III

</PRE><P><LI>Create a module and type the following line in the Declarations section
   if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function BatchImport() As Boolean
<PRE></PRE>         On Local Error GoTo BatchImport_Err
         Dim MyDB As DATABASE, MyTbl As Recordset
         Set MyDB = CurrentDb()
         Set MyTbl = MyDB.OpenRecordset("Batch Import", dbOpenTable)
         DoCmd.Hourglass True
         MyTbl.MoveFirst
         Do Until MyTbl.EOF
            DoCmd.TransferDatabase acImport, _
             MyTbl("Type of Table"), _
             MyTbl("Source Directory"), _
             acTable, _
             MyTbl("Source Database"), _
             MyTbl("Imported Name"), _
             False
            MyTbl.MoveNext
         Loop
         MyTbl.Close
      BatchImport_End:
         DoCmd.Hourglass False
         Exit Function
      BatchImport_Err:
         MsgBox Err.Description
         Resume BatchImport_End
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<PRE>         ?BatchImport()

   Note that the pointer becomes an hourglass and remains so until all of
   your databases are imported. This process may take several minutes,
   depending on the size of the databases.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about TransferDatabase, search the Help Index for
"TransferDatabase method," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about batch importing dBASE databases in Microsoft
Access version 1.x or 2.0, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q88764.htm">Q88764</A></B>
   TITLE     : ACC: How to Import Several dBASE Databases at Once (1.x/2.0)

</PRE>dBase III, dBASE III PLUS, and dBASE IV are manufactured by Borland
International, Inc., a vendor independent of Microsoft; we make no
warranty, implied or otherwise, regarding the performance or reliability of
these products.
 
<PRE>Keywords          : kb3rdparty PgmHowTo PgmObj PgmFilM
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
