

<HTML>
<HEAD>
<TITLE>ACC: How to Make Empty or Null OLE Object Not Appear on Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90855 ">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1992/10/22">
<META NAME="Keywords" CONTENT="kbusage RptLayou IntpOle RptProp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If a report has OLE objects that are empty or null, you can set up a report so that empty or null OLE objects do not appear.  This article assumes that you are familiar with Visu...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAPN,QBT6,QBV4,QBVV,QAW6,QA9Q,QAHP,QBS0,QBJZ,QA7O,QA5F,QAPF,QAMA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Make Empty or Null OLE Object Not Appear on Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90855 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If a report has OLE objects that are empty or null, you can set up a
report so that empty or null OLE objects do not appear.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following example uses the sample database Northwind.mdb (or NWIND.MDB
In versions 1.x and 2.0).
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or the NWIND.MDB in versions 1.x and 2.0.) You may
want to back up the Northwind.mdb (or NWIND.MDB) file or perform these
steps on a copy of these databases.

<OL><P><LI>Start Microsoft Access and open Northwind.mdb.

<P><LI>Open the Employees table in Datasheet view and add a few records. Do
    not insert any objects in the Photo field.

<P><LI>Create a module and type the following line in the Declarations
    section if it is not already there:
<P>
       Option Explicit

<P><LI>Type the following procedure:
<P>
       Function HideNullOle (ctl As Control)
<PRE>          On Error Resume Next
          ctl.visible = Not IsNull(ctl)
          If Err = 2427 Then ctl.visible = True
       End Function

    The function checks to see if the OLE Object is null. If it is null,
    the control is hidden. If it is not null, the control is not hidden.
    Some OLE Objects take longer to retrieve data and will generate error
    2427, "Object has no value." When this error is generated, the OLE
    Object is not null and the control is not hidden.

</PRE><P><LI>Create a new report in Design view based on the Employees table.

<P><LI>If the field list is not visible, click Field List on the View menu.
    Drag EmployeeID, LastName, FirstName, and Photo from the field list to
    the Detail section of the report.
<P>
    NOTE: In versions 1.x and 2.0, there is a space in Employee ID,
    Last Name, and First Name.

<P><LI>If the property sheet is not visible, click Properties on the View
    menu.

<P><LI>Set the following properties for the Detail section of the report:
<P>
      CanShrink: Yes
      OnFormat: =HideNullOle([Photo])

<P><LI>Add an unbound text box to your report that completely overlaps the
    Photo control, and set the following properties:
<P>
      Visible: No
      CanShrink: Yes
<P>
    The text box is necessary to cause the items below it to be pulled up.

<P><LI>On the Format menu, click Send To Back. The OLE object appears on top
    of the unbound text box.

<P><LI>Save the report as Report1 and close it.

<P><LI>Open the report in Print Preview and scroll through the pages of the
    report to the last page. Note how the CanShrink property works with
    null or empty OLE objects. When an OLE object is visible, the
    CanShrink property prevents the empty text box from shrinking. When
    the OLE object is invisible, the text box shrinks to nothing.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: remove delete erase<BR>
Keywords          : kbusage RptLayou IntpOle RptProp<BR>
Version           : 1.0 1.10 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
