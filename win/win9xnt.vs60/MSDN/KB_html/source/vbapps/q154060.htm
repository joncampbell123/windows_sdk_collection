

<HTML>
<HEAD>
<TITLE>ACC: How to Test a User-Defined Filter in Filter By Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154060">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/07/26">
<META NAME="Keywords" CONTENT="JetQryFiltr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to test the validity of a user-defined filter when using the Filter By Form feature of Microsoft Access. The sample procedure demonstrates some of the ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAUD,QA1S,QAVX,QAVW,QBS0,QBQU,QDN9,QBWS,QAGB,QAFF,QALW,QAPN,QAPF,QAI2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Test a User-Defined Filter in Filter By Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154060</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to test the validity of a user-defined filter
when using the Filter By Form feature of Microsoft Access. The sample
procedure demonstrates some of the validation techniques you can use to
ensure that the filter you apply to the form returns records.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In this example, if the filter you apply does not return any records, a
message appears, and you return to the Filter By Form screen to retry the
filter:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Employees form in Design view.

<P><LI>Set the OnApplyFilter property to the following [Event Procedure]:
<P>
       Private Sub Form_ApplyFilter(Cancel As Integer, ApplyType As _
<PRE>          Integer)
          Me.TimerInterval = 100
       End Sub

</PRE><P><LI>Set the OnTimer property to the following [Event Procedure]:
<P>
       Private Sub Form_Timer()
<PRE>          Dim strfilter As String
          Me.TimerInterval = 0
          If IsNull(Me.Filter) Then Exit Sub
          strfilter = Me.Filter
          If Me.RecordsetClone.RecordCount = 0 Then
              MsgBox "The selected filter:" &amp; Chr(13) &amp; _
              strfilter &amp; Chr(13) &amp; _
              "returns no records. Try a less restrictive search."
              ' Form, Records, Filter, Filter By Form.
              DoCmd.DoMenuItem 0, 5, 0, 0, acMenuVer70
          End If
       End Sub

</PRE><P><LI>Save and open the form in Form view.

<P><LI>On the Records menu, point to Filter, and then click Filter By Form.

<P><LI>In the First Name field, select Laura.

<P><LI>On the Filter menu, click Apply Filter/Sort. Note that the record for
    Laura Callahan is returned.

<P><LI>On the Records menu, point to Filter, and then click Filter By Form.

<P><LI>In the First Name field, type "Test" (without the quotation marks).

<P><LI>On the Filter menu, click Apply Filter/Sort.

<P><LI>Note that the following message appears, indicating the filter does
    not return records:
<P>
       The selected filter:
       ((Employees.FirstName="Test"))
       returns no records. Try a less restrictive search.
<P>
</OL>NOTE: To cancel out of the Filter By Form mode, remove all criteria and
click Apply Filter/Sort on the Filter menu.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about OnFilter and OnApplyFilter, type "Filters and
OnApplyFilter," in the Office Assistant, click Search, and then click to
view the appropriate topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Validate FormFilter Count Query<BR>
Keywords          : JetQryFiltr kbusage<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
