

<HTML>
<HEAD>
<TITLE>XL97: Page Fault Accessing Demand-Loaded Add-in </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160085">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="kberrmsg kbprg xlloadsave xladdins xl97vbmigrate">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, when you run a Visual Basic for Applications macro, and then attempt to access a demand-loaded add-in, you receive an error message, and then Microsoft Excel quits.  In Microsoft Windows 95, you receive the following error me...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QAB4,QBS0,QBW7,QAI5,QBWG,QAIK,QAKP,QDL9,QBWO,QBWN,QA1S,QAAP,QBUL P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Page Fault Accessing Demand-Loaded Add-in</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160085</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, when you run a Visual Basic for Applications macro,
and then attempt to access a demand-loaded add-in, you receive an error
message, and then Microsoft Excel quits.
<P>
In Microsoft Windows 95, you receive the following error message:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at 
   0137:300c7df8.

</PRE>In Microsoft Windows NT 3.51 or later, you receive the following error:
<P>
<PRE>   An application error has occurred and an application error log is being
   generated.

   EXCEL.exe
   Exception: Access Violation (0xc0000005), Address: 0x300c7df8

</PRE>NOTE: The exact address in the message may vary.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>You run a Visual Basic for Applications macro during the Microsoft
   Excel session.
<P>
<P><PRE>    -and-
</PRE>
<LI>You access a demand-loaded add-in while no workbooks are open in
   Microsoft Excel.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, open at least one workbook or 
start a new workbook before you access the demand-loaded add-in.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
"Demand-loaded" means that an add-in is set up for use in Microsoft Excel;
functionality in the add-in is available dialog boxes and menus, but the
add-in file is not actually loaded into random access memory (RAM) until
the functionality is requested. Demand loading an add-in requires less time
than fully loading the add-in into RAM.
<P>
You may experience the problem that is described in this article when you
access one of the demand-loaded add-ins in the following list:
<P>
<PRE>   AutoSave
   Conditional Sum
   File Conversion Wizard
   Internet Assistant Wizard
   Lookup Wizard
   Report Manager
   Solver
   Template Wizard with Data Tracking
   Web Form Wizard
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.0 8.00 addin __demandload demandload<BR>
save as html fast load<BR>
Keywords          : kberrmsg kbprg xlloadsave xladdins xl97vbmigrate<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
