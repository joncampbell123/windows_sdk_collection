

<HTML>
<HEAD>
<TITLE>MXL: Problems Using the SAVE.AS and SaveAs Macro Functions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143344">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1996/01/31">
<META NAME="Keywords" CONTENT="kberrmsg kbprg xlmac PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the SAVE.AS function in a Microsoft Excel 4.0 macro, you may receive the following error message:     Cannot access '           '  where             is the name of the file you are saving.  In Microsoft Excel version 5.0, if you attemp...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBTI,QAUR,QAFI,QAU7,QAY5,QAPN,QAB4,QBS0,QBV8,QAH4,QAB9,QAUJ,QAX6,QDO9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MXL: Problems Using the SAVE.AS and SaveAs Macro Functions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143344</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Macintosh, versions 3.0, 4.0, 5.0, 5.0a
<LI>Microsoft Excel for the Power Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SAVE.AS function in a Microsoft Excel 4.0 macro, you may
receive the following error message:
<P>
<PRE>   Cannot access '&lt;file name&gt;'

</PRE>where &lt;file name&gt; is the name of the file you are saving.
<P>
In Microsoft Excel version 5.0, if you attempt to save a workbook using the
SaveAs method in a Microsoft Visual Basic for Applications macro, you may 
receive the following error message:
<P>
<PRE>   Path not found

</PRE>The file name may appear correctly in the file's title bar on the screen.
However, the directory to which the file is saved will actually contain a
file name with random numbers and characters, such as 860FB600. If you make
additional attempts to save files by using the Save or SaveAs methods
during the current session of Microsoft Excel, you may receive the error
message stated above.
<P>
<P><h2>CAUSE</h2>
 
<P>
In both cases, the behavior occurs if the file name you provide in the
SAVE.AS function or the SaveAs method is longer than 31 characters. The
Apple Macintosh operating system limits a file name to 31 characters.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, use a shorter file name when you save your
document with the SAVE.AS function or SaveAs method. If you experience this
behavior with the SaveAs method, quit and restart Microsoft Excel in order
to programmatically save any more files with the Save or SaveAs methods. If
you need to save a file before quitting Microsoft Excel, use the Save or
SaveAs commands on the File menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Both the SAVE.AS function and the SaveAs method have arguments to specify a
name for the file you are saving. These arguments are document_text and
filename, respectively. These macro functions are used to save a worksheet
or workbook with a new file name, file type, protection password, or to
create a backup file.
<P>
For both the document_text and filename arguments, you can include a full
path and file name. Regardless of the path length, the actual file name
you use must be no more than 31 characters long.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, page 369
<P>
For more information about SAVE.AS, click the Search button in the
Microsoft Excel Macro Functions Help file and type:
<P>
<PRE>   SAVE.AS

</PRE>For more information about the SaveAs method, click the Search button in
the Microsoft Excel Visual Basic Help file and type:
<P>
<PRE>   SaveAs Method
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 4.00 5.00 5.00a 32<BR>
Keywords          : kberrmsg kbprg xlmac PgmOthr<BR>
Version           : MACINTOSH:3.0,4.0,5.0,5.0a<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
