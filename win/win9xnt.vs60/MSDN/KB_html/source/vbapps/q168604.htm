

<HTML>
<HEAD>
<TITLE>XL97: Error When You Change List Property of Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168604">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/05/15">
<META NAME="Keywords" CONTENT="kberrmsg kbui kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you click a combo box in a UserForm in Microsoft Excel 97, you may receive the following error message:     Run-time error '28':    Out of stack space  Or, you may receive the following error message:     This program has performed an illegal ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QAPN,QAFF,QAO4,QAE1,QAYZ,QAH4,QAKP,QBWS,QA7O,QAOE,QAMN,QAB5,QBV3 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error When You Change List Property of Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168604</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you click a combo box in a UserForm in Microsoft Excel 97, you may
receive the following error message:
<P>
<PRE>   Run-time error '28':
   Out of stack space

</PRE>Or, you may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to either of the
following:
<P>
<PRE>   EXCEL caused an invalid page fault in module FM20.DLL at
   0137:60025b9e.

   EXCEL caused an invalid page fault in module KERNEL32.DLL at
   0137:bff85808.

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur if the following conditions are true:

<UL><LI>A Visual Basic subroutine is assigned to the DropButtonClick event of
   the combo box.
<P>
   -and-

<LI>The DropButtonClick subroutine uses the List property to reset the
   list assigned to the combo box.
<P>
</UL>See the "More Information" section of this article for an example that
causes this problem to occur.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent this problem from occurring, do not change the List property for
a combo box in the subroutine assigned to the DropButtonClick event of the
combo box.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you add a control to a UserForm in Microsoft Excel 97, you can assign
a subroutine to each event to which the control responds: for example,
Click, Change, DblClick, and so on. To do this, follow these steps:

<OL><P><LI>In the UserForm, double-click the control.

<P><LI>In the Procedure list box, select the event to which you want to
   assign a subroutine.
<P>
</OL>The code window will display a subroutine for the specified event and
control. For example:
<P>
<PRE>   Private Sub ComboBox1_DropButtonClick()
       '&lt;code goes here&gt;
   End Sub

</PRE></OL>The DropButtonClick event for a combo box is triggered whenever the list
for the combo box appears or disappears. If the subroutine assigned to this
event uses the List property to reset the list for the combo box, you will
receive an error message when you run the UserForm and click the combo box.
For example:
<P>
<PRE>   Private Sub ComboBox1_DropButtonClick()
       Dim ListArray(0 To 3) As String
       ListArray(0) = Now
       ListArray(1) = Now + 0.25
       ListArray(2) = Now + 0.5
       ListArray(3) = Now + 1
       ComboBox1.List = ListArray
   End Sub

</PRE>It is recommended that you do not use this method to reset the list for a
combo box in Microsoft Excel 97. Instead, reset the list when you display
the UserForm, or when you click another control in the UserForm, such as a
command button.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97 combobox dropdown list box<BR>
Keywords          : kberrmsg kbui kbhowto<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
