

<HTML>
<HEAD>
<TITLE>ACC: RecordCount Property Returns Incorrect Number of Records </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105976">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/10/28">
<META NAME="Keywords" CONTENT="JetRS kbprg PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The RecordCount property, when used with a recordset or snapshot, returns a recordset containing an incorrect number of records.  This article assumes that you are familiar with ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QAY5,QAUD,QDN9,QBV8,QAB9,QAPN,QBS0,QBXS,QANF,QAG8,QAAP,QAKC,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: RecordCount Property Returns Incorrect Number of Records</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105976</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The RecordCount property, when used with a recordset or snapshot, returns
a recordset containing an incorrect number of records.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
For recordsets and snapshots, Microsoft Access does not automatically
return the number of records that exist in the recordset. It returns
the number of records accessed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To determine the exact number of records in a dynaset or snapshot, use
the MoveLast method before checking the RecordCount property.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following Visual Basic function, MyWrongRecordCount(), returns the
number 1 for the Customers table in the sample database Northwind.mdb (or
NWIND.MDB in versions 1.x and 2.0) because only one record has been
accessed. The MyRightRecordCount() function uses the MoveLast method first
to access all records in the dynaset and then to return the RecordCount
value.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in versions 1.x
   and 2.0).

<P><LI>Create a module and type the following line in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedures:
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>      '===========================================================
      ' The following function, MyWrongRecordCount(), demonstrates
      ' the incorrect way to use the RecordCount property to count
      ' records in a dynaset.
      '===========================================================
      Function MyWrongRecordCount ()
<PRE></PRE>         Dim MyDB As Database
         Dim MyRS as Recordset
         Set MyDB = CurrentDB()
         Set MyRS = MyDb.OpenRecordset("Customers", dbOpenDynaset)
         MyWrongRecordCount = MyRS.RecordCount
         MyRS.Close
      End Function

      '===========================================================
      ' The following function, MyRightRecordCount(), demonstrates
      ' the correct way to use the RecordCount property to count
      ' records in a dynaset.
      '===========================================================
      Function MyRightRecordCount ()
         Dim MyDB As Database
         Dim MyRS as Recordset
         Set MyDB = CurrentDB()
         Set MyRS = MyDb.OpenRecordset("Customers", dbOpenDynaset)
         MyRS.MoveLast
         MyRightRecordCount = MyRS.RecordCount
         MyRS.Close
      End Function

   In Microsoft Access 2.0:

      '===========================================================
      ' The following function, MyWrongRecordCount(), demonstrates
      ' the incorrect way to use the RecordCount property to count
      ' records in a dynaset.
      '===========================================================
      Function MyWrongRecordCount ()
         Dim MyDB As Database
         Dim MyRS as Recordset
         Set MyDB = CurrentDB()
         Set MyRS = MyDb.OpenRecordset("Customers", DB_OPEN_DYNASET)
         MyWrongRecordCount = MyRS.RecordCount
         MyRS.Close
      End Function

      '===========================================================
      ' The following function, MyRightRecordCount(), demonstrates
      ' the correct way to use the RecordCount property to count
      ' records in a dynaset.
      '===========================================================
      Function MyRightRecordCount ()
         Dim MyDB As Database
         Dim MyRS as Recordset
         Set MyDB = CurrentDB()
         Set MyRS = MyDb.OpenRecordset("Customers", DB_OPEN_DYNASET)
         MyRS.MoveLast
         MyRightRecordCount = MyRS.RecordCount
         MyRS.Close
      End Function

   In Microsoft Access 1.x:

      '===========================================================
      ' The following function, MyWrongRecordCount(), demonstrates
      ' the incorrect way to use the RecordCount property to count
      ' records in a dynaset.
      '===========================================================
      Function MyWrongRecordCount ()
         Dim MyDB As Database
         Dim MyRS as Dynaset
         Set MyDB = CurrentDB()
         Set MyRS = MyDb.CreateDynaset("Customers")
         MyWrongRecordCount = MyRS.RecordCount
         MyRS.Close
      End Function

      '===========================================================
      ' The following function, MyRightRecordCount(), demonstrates
      ' the correct way to use the RecordCount property to count
      ' records in a dynaset.
      '===========================================================
      Function MyRightRecordCount ()
         Dim MyDB As Database
         Dim MyRS as Dynaset
         Set MyDB = CurrentDB()
         Set MyRS = MyDb.CreateDynaset("Customers")
         MyRS.MoveLast
         MyRightRecordCount = MyRS.RecordCount
         MyRS.Close
      End Function

</PRE><P><LI>To test these functions, type the following lines in the Debug window
   (or Immediate window in versions 1.x and 2.0), and then press ENTER.
<P>
<P><PRE>      ?MyWrongRecordCount()
</PRE><P>
   Note that the function returns 1.
<P>
<P><PRE>      ?MyRightRecordCount()
</PRE><P>
   Note that the function returns the correct number of records in the
   Customers table.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about RecordCount Property, search the Help Index for
"RecordCount Property," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: record count move last<BR>
Keywords          : JetRS kbprg PgmObj<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
