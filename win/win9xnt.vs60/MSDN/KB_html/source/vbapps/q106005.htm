

<HTML>
<HEAD>
<TITLE>XL: Can't Step Through Excel 4.0 Macro If Dialog Box Visible </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106005">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1993/10/28">
<META NAME="Keywords" CONTENT="kbprg kbprb PgmOthr kbprb">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel versions 5.0 and 7.0, it is not possible to step through  a Microsoft Excel 4.0 macro while a custom dialog box is displayed on the  screen.  STATUS ======  Microsoft has confirmed this to be a problem in the versions of Microsof...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QA01,QASR,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Can't Step Through Excel 4.0 Macro If Dialog Box Visible</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel versions 5.0 and 7.0, it is not possible to step through 
a Microsoft Excel 4.0 macro while a custom dialog box is displayed on the 
screen.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Microsoft 
Excel listed at the beginning of this article. This problem was corrected 
in Microsoft Excel 97 for Windows and Microsoft Excel 98 Macintosh Edition. 
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel versions 5.0 and 7.0, when you step through a Microsoft
Excel 4.0 macro, one of the following situations may occur:

<UL><LI>When a custom dialog box is displayed by the SHOW.DIALOG() command,
   Microsoft Excel exits step mode and closes the Single Step window
   before showing the dialog box.
<P>
<P><PRE>    -or-
</PRE>
<LI>If a custom dialog box is visible on the screen, if you run the
   Microsoft Excel 4.0 macro STEP() macro command, you will receive an
   error message and the macro will halt.
<P>
<P><PRE>    -or-
</PRE>
<LI>If a Microsoft Excel 4.0 macro command fails while a custom dialog
   box is showing, the Step button in the Single Step dialog box will
   be unavailable (dimmed).
<P>
<P><PRE>    -or-
</PRE>
<LI>If the dialog box was displayed by a SHOW.DIALOG() command while in
   step mode, Microsoft Excel will return to step mode when the dialog
   box is finally dismissed.
<P>
</UL>Because it is not possible to step through a Microsoft Excel 4.0 macro 
while a custom dialog box is showing on the screen, you will need to debug 
the macro before you run the actual dialog box. To debug a Microsoft Excel 
4.0 macro that is called from an item in a custom dialog box, follow these 
steps:

<OL><P><LI>Select the item in the dialog sheet.

<P><LI>On the Tools menu, click Macro.
<P>
   Microsoft Excel will display the Macro dialog box and will insert the 
   reference of the item's macro into the Macro Name/Reference box.

<P><LI>In the Macro dialog box, click Step.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Visual Basic User's Guide", version 5.0, pages 234-239
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a XL7 XL5<BR>
Keywords          : kbprg kbprb PgmOthr kbprb<BR>
Version           : WINDOWS:5.0,5.0c,7.0; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
