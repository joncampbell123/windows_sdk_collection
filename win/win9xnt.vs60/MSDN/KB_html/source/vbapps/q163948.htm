

<HTML>
<HEAD>
<TITLE>ACC97: Data in ASP Fields with Spaces Not Committed to Access DB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163948">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1997/02/20">
<META NAME="Keywords" CONTENT="kbinterop IntpWeb IntAsp GnlDe">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you try to enter or change data on an ASP file that is linked to a Microsoft Access database, the new data will be committed only for fields that do not have spaces in their...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDNQ,QA7O,QA7N,QDN9,QBVV,QAUJ,QAYY,QDKY,QAH4,QABI,QBDM,QAY5,QAUR,QAML P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Data in ASP Fields with Spaces Not Committed to Access DB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163948</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you try to enter or change data on an ASP file that is linked to a
Microsoft Access database, the new data will be committed only for fields
that do not have spaces in their field names. You will not receive any
errors about the data not being saved.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In order to have the data saved back to a Microsoft Access database, make
sure that the underlying recordset does not contain field names that have
space in them. Three possible solutions are as follows:

<UL><LI>Redesign your table to include only field names that do not have spaces,
   and then recreate your ASP files.
<P>
   NOTE: If you select this option, be sure to update all of the other
   objects in the database which use the newly modified fields. Otherwise,
   you will receive errors when you try use those objects.

<LI>Build a query based on the original ASP record source and alias the
   fields in the query that contain spaces. Once the new query is created,
   you can recreate your ASP file based on the new query.

<LI>Modify the ALX file that is linked to a Microsoft Access database as
   follows:
<P>
   NOTE: This solution contains information about editing ASP files and
   assumes that you are familiar with editing HTML files, Active Server
   Pages, and Visual Basic Scripting. Microsoft Access Technical Support
   engineers do not support customization of any HTML, HTX, IDC, or ASP
   files.
<P>
   The following example demonstrates how to change the VBScript code in an
   ASP file. To modify the VBScript for a particular file, follow these
   steps:
<P>
<P><PRE>      1. Open the &lt;object name&gt;alx.asp file. It has a function that looks
<PRE></PRE>         something like this:

         NOTE: In the following sample code, an underscore (_) at the end
         of a line is used as a line-continuation character. Remove the
         underscore from the end of the line when re-creating this code.

            Function GetCtrlQueryString()
            Dim szRet
            Dim i
               for i = 1 to cMaxCtrls
                  if rgszCtrls(i, 1) = "" Then Exit For
               szRet = szRet &amp; rgszCtrls(i, 2) &amp; "=" &amp;
            MakeHTMLValue(Test_Formalx.Controls(rgszCtrls(i, 1)).Value) &amp; _
            "&amp;"
               next
            GetCtrlQueryString = szRet
            End Function

      2. Modify the function, changing only the line that sets szRet so it
         looks like the following (note the use of MakeHTMLValue):

            Function GetCtrlQueryString()
            Dim szRet
            Dim i
               for i = 1 to cMaxCtrls
                  if rgszCtrls(i, 1) = "" Then Exit For
               szRet = szRet &amp; MakeHTMLValue(rgszCtrls(i, 2)) &amp; "=" &amp;
            MakeHTMLValue(Test_Formalx.Controls(rgszCtrls(i, 1)).Value) &amp; _
            "&amp;"
               next
            GetCtrlQueryString = szRet
            End Function

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create the following new table called Table1:
<P>
<P><PRE>      Table: Table1
      -------------------------------
      Field Name: ID
<PRE></PRE>         Data Type: Counter
         Indexed: Yes (No Duplicates)
      Field Name: FirstName
         Data Type: Text
      Field Name: Last Name
         Data Type: Text

</PRE><P><LI>Create an AutoForm based on this table.

<P><LI>Use the "Publish to the Web Wizard" to create an ASP File. Please note
   this must be publish to a site which supports ASP file formats and has
   a system DSN assigned to your database.

<P><LI>Use a Web browser to open your new ASP file.

<P><LI>Enter and save data in your ASP form.

<P><LI>Check the underlining data in the table.
<P>
   Note that the data you entered into the FirstName field is saved, but
   that the data you entered into the Last Name field is not saved.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about aliasing fields, search the Help Index for
"alias," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: missing gone saved maintained<BR>
Keywords          : kbinterop IntpWeb IntAsp GnlDe<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
