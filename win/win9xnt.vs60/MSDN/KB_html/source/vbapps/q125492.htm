

<HTML>
<HEAD>
<TITLE>MSQUERY: DDE Commands Available Only on System Channel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125492">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1995/01/29">
<META NAME="Keywords" CONTENT="IntpDde kbinterop xlquery kbprg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use an application that supports dynamic data exchange (DDE) to initiate a DDE conversation with Microsoft Query, a DDE command that you use may fail to complete, may return an error message, or may return unexpected results.  CAUSE ===== ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QAZ2,QAUD,QBII,QBS0,QAB9,QBGP,QBV8,QALQ,QBUG,QBUF,QA3Q,QAC6,QACF,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQUERY: DDE Commands Available Only on System Channel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125492</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 2.00
WINDOWS
kbtool kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Query for Windows 95, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use an application that supports dynamic data exchange (DDE) to
initiate a DDE conversation with Microsoft Query, a DDE command that you
use may fail to complete, may return an error message, or may return
unexpected results.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs if you initiate a DDE conversation using a query
channel and if you use a DDE command that is only supported on a system
channel.
<P>
You can use a system channel to establish a DDE conversation with Microsoft
Query to return general and query-related information. You use a query
channel to establish a DDE conversation with a specific query in Microsoft
Query. The following is a list of the DDE commands that you can use with
Microsoft Query. The commands marked with an asterisk (*) are commands that
are only supported on a system channel and that cannot be used on a query
channel:
<P>
<PRE>   Activate*
   AllowEdit
   BuildSQL*
   Close
   Command*
   Exit*
   Fetch and Fetch.Advise
   Fetch.Unadvise
   Logoff*
   Logon*
   ODBCLogon*
   Open*
   QueryNow
   SaveAs
   SetWindowState
   UserControl*
   ViewPane

</PRE><h2>WORKAROUND</h2>
 
<P>
To avoid returning an error when you use one of the Microsoft Query DDE
commands that is only supported on a system channel, use a system channel
instead of a query channel in the DDE conversation. The following Visual
Basic, Applications Edition, examples show how to establish a DDE
conversation with Microsoft Query using either a system channel or a query
channel.
<P>
<P><h3>System Channel</h3>
 
<P>
<PRE>Sub UsingSystemChan()

</PRE>Dim chan As Integer
Dim sql As String
<P>
<PRE>   ' Establish DDE conversation using system channel
   chan = DDEInitiate("MSQUERY", "System")

   ' logon using NWind data source
   DDEExecute chan, "[Logon('NWind')]"

   ' Execute an SQL query to retrieve all records from Customer table
   DDEExecute chan, "[Open('SELECT Custmr_ID FROM Customer')]"

   'Return data to Sheet1 at cells A1:A63
   DDEExecute chan, "[Fetch('Excel', 'Sheet1', 'R1C1:R63C1', 'All')]"

   ' Close the DDE channel
   DDETerminate chan

End Sub

</PRE><h3>Query Channel</h3>
 
<P>
<PRE>Sub UseQueryChannel()

</PRE>Dim chan As Integer
Dim NRows, NCols
<P>
<PRE>   ' Establish DDE conversation using query channel
   ' ** Note that QUERY1 must be open in Microsoft Query
   ' in order for the following command to work
   chan = DDEInitiate("MSQUERY", "query1")

   'Determine the number of rows and columns in query1
   NRows = DDERequest(chan, "NumRows")
   NCols = DDERequest(chan, "NumCols")

   ' Return the data in Query1 to Sheet1 starting at A1.
   ' ** The following two lines should be entered on one line.
   DDEExecute chan,"[Fetch('Excel', 'Sheet1', 'R1C1:R" &amp; NRows(1) &amp; "C"
    &amp; NCols(1) &amp; "', 'All')]"

   ' Close the DDE channel
   DDETerminate chan

End Sub

</PRE>Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft Products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about individual DDE commands, such as the
Activate command, choose the Search button in Help and type:
<P>
<PRE>    DDE commands
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 5.00 5.00a 5.00c 7.00 7.00a<BR>
Keywords          : IntpDde kbinterop xlquery kbprg kbtool<BR>
Version           : 1.00 2.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
