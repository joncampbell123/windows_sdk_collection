

<HTML>
<HEAD>
<TITLE>ACC: Using Automation to Run Word 97 Mail Merge from MS Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159328">
<META NAME="KBModify" CONTENT="1997/11/21">
<META NAME="KBCreate" CONTENT="1996/11/12">
<META NAME="Keywords" CONTENT="kbinterop kbualink97 IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to use Automation to run a Microsoft Word 97 for Windows mail merge in Microsoft Access version 7.0 or 97.  For information about how to run a ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QALI,QA1S,QDME,QDN9,QBS0,QAPN,QAH4,QBWS,QDNE,QA2K,QDO7,QAPF,QDH3,QBMH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using Automation to Run Word 97 Mail Merge from MS Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159328</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access, versions 7.0, 97
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to use Automation to run a Microsoft Word 97
for Windows mail merge in Microsoft Access version 7.0 or 97.
<P>
For information about how to run a Word 7.0 mail merge in Microsoft
Access 7.0, please see the following article here in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q154571.htm">Q154571</A></B>
   TITLE     : ACC95: Running Word Mail Merge from Access Using OLE
               Automation

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Word 97 takes advantage of the Visual Basic for Applications object
hierarchy used in other Microsoft Office applications. Word 7.0 and
earlier versions used a flat command model called WordBasic.
<P>
Using Automation, you can perform a mail merge in a Microsoft Word 97
document from Microsoft Access. The example in this article uses the
OpenDataSource and Execute methods of the MailMerge object in Word 97.
<P>
<P><h3>Example: Mail Merge a Microsoft Access Query with a Word 97 Document</h3>
 
<P>
The following example opens a Word 97 document called C:\MyMerge.doc and
executes a mail merge using the Customers table in the Microsoft Access
sample database Northwind.mdb as its data source. The following sample
code assumes that the main document for the merge, C:\MyMerge.doc, already
exists.

<OL><P><LI>Start Microsoft Access and open any database, or create a new one.

<P><LI>Create a module and type the following procedure:
<P>
<P><PRE>      Function MergeIt()
<PRE></PRE>         Dim objWord As Word.Document
         Set objWord = GetObject("C:\MyMerge.doc", "Word.Document")
         ' Make Word visible.
         objWord.Application.Visible = True
         ' Set the mail merge data source as the Northwind database.
         objWord.MailMerge.OpenDataSource _
            Name:="C:\Program Files\Microsoft " &amp; _
          "Office\Office\Samples\Northwind.mdb", _
            LinkToSource:=True, _
            Connection:="TABLE Customers", _
            SQLStatement:="Select * from [Customers]"
         ' Execute the mail merge.
         objWord.MailMerge.Execute
      End Function

   NOTE: If you would like to print the merged document, delete the
   Execute statement above and add the following four lines of code
   above the End Function statement:

       objWord.MailMerge.Destination = wdSendToNewDocument
       objWord.MailMerge.Execute

   'The following line must follow the Execute statement because the
   'PrintBackground property is available only when a document window is
   'active. Without this line of code, the function will end before Word
   'can print the merged document.

        objWord.Application.Options.PrintBackground = False
        objWord.Application.ActiveDocument.PrintOut

</PRE><P><LI>With the module still open in Design view, click References on the
   Tools menu. Add the Word 97 Object Library to the list of available
   references. If the Object Library is not on the list, click the
   Browse button and locate the file Msword8.olb.

<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ?MergeIt()
</PRE><P>
   An instance of Word 97 opens, displays MyMerge.doc, and then merges it
   with the Customers table in the Northwind sample database.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Automation, search the Help Index for
"Automation," or ask the Microsoft Access 97 Office Assistant.
<P>
For information about using the Microsoft Access Object Browser to
explore the methods and properties of Microsoft Word 97 Visual Basic
for Applications objects, search the Help Index for "Automation, using
the Object Browser," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : kbinterop kbualink97 IntpOleA
Technology        : kbole
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
