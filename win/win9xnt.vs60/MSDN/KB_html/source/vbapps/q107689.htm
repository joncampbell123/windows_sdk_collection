

<HTML>
<HEAD>
<TITLE>XL: Disabling Microsoft Excel Control Menu Commands </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107689">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/11/24">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmOthr kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  You can use the Microsoft Windows Dynamic Link Libraries (DLLs) to disable the commands in the Microsoft Excel Control menu. For example, you can use these tools to delete the Minimize and Maximize buttons.  MORE INFORMATION  Microsoft Excel does n...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAVI,QBRD,QAB9,QA4Q,QAB5,QA7O,QAOE,QAMN,QBS0,QAGI,QAEF,QBXS,QBCT,QAGC P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Disabling Microsoft Excel Control Menu Commands</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107689</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use the Microsoft Windows Dynamic Link Libraries (DLLs) to
disable the commands in the Microsoft Excel Control menu. For example,
you can use these tools to delete the Minimize and Maximize buttons.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel does not have the built-in functionality to modify the
Control menu commands. However, you can use the Declare statement in a
Visual Basic procedure to call Microsoft Windows functions to disable and
restore Control menu items.
<P>
The following example Visual Basic procedure, Disable_Control, disables
the entire Control menu in Microsoft Excel. The macro disables the
Control menu for the current session of Microsoft Excel (when you restart
Microsoft Excel the Control menu will be reset). The procedure
RestoreSystemMenu restores the Control menu.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Microsoft Excel version 97 and 7.0</h3>
 
<P>
<PRE>Declare Function GetActiveWindow Lib "User32" () As Integer

'Enter the following Declare statement as a single line
Declare Function GetSystemMenu Lib "User32" (ByVal hWnd As Integer, ByVal
</PRE>bRevert As Integer) As Integer
<P>
<PRE>'Enter the following Declare statement as a single line
Declare Function DeleteMenu Lib "User32" (ByVal hMenu As Integer, ByVal
</PRE>nPosition As Integer, ByVal wFlags As Integer) As Integer
<P>
<PRE>'The following procedure disables the Control menu
Sub Disable_Control()
   Dim X As Integer
   For X = 1 To 9
      'Delete the first menu command and loop until
      'all commands are deleted
      Call DeleteMenu(GetSystemMenu(GetActiveWindow, False), 0, 1024)
   Next X
End Sub

'The following procedure restores the Control menu
'Note that to run this procedure, the Declare statements above
'must be in the module
Sub RestoreSystemMenu()
   'get the window handle of the Excel application
   hWnd = GetActiveWindow()
   'restore system menu to original state
   hMenu% = GetSystemMenu(hWnd, 1)
End Sub

</PRE><h3>Microsoft Excel version 5.x</h3>
 
<P>
<PRE>'The following procedure disables the Control menu
Declare Function GetActiveWindow Lib "User" () As Integer

'Enter the following Declare statement as a single line
Declare Function GetSystemMenu Lib "User" (ByVal hWnd As Integer, ByVal
</PRE>bRevert As Integer) As Integer
<P>
<PRE>'Enter the following Declare statement as a single line
Declare Function DeleteMenu Lib "User" (ByVal hMenu As Integer, ByVal
</PRE>nPosition As Integer, ByVal wFlags As Integer) As Integer
<P>
<PRE>Sub Disable_Control()
   Dim X as Integer
   For X = 1 to 9
      'Delete the first menu command and loop until
      'all commands are deleted
      Call DeleteMenu(GetSystemMenu(GetActiveWindow, False),0,1024)
   Next X
End Sub

'The following procedure restores the Control menu
'Note that to run this procedure, the Declare statements above
'must be in the module
Sub RestoreSystemMenu()
   'get the window handle of the Excel application
   hWnd = GetActiveWindow()
   'restore system menu to original state
   hMenu% = GetSystemMenu(hWnd, 1)
End Sub


</PRE><h3>Notes</h3>
 
<P>
The commands on the control menu are numbered starting at zero. The
default control menu items are as follows: Control Menu Restore is item
0, Move is item 1, Size is item 2, and so on. Even if items are deleted,
the first item always starts at zero.
<P>
To delete individual items from the control menu without deleting the
entire menu, you can specify the menu command to delete. For example the
following two lines of code when used in place of the For Next loop in
the procedure Disable_Control above, will delete the Maximize (item 4)
and Minimize (item 3) commands and disable the Maximize and Minimize
buttons.
<P>
<PRE>   Call DeleteMenu(GetSystemMenu(GetActiveWindow, False),4,1024)
   Call DeleteMenu(GetSystemMenu(GetActiveWindow, False),3,1024)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.00c 7.00 8.00 97 call register remove<BR>
api<BR>
Keywords          : kbprg PgmHowTo PgmOthr kbcode<BR>
Version           : 5.00 5.00c 7.00 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
