

<HTML>
<HEAD>
<TITLE>ACC: How to Avoid Abandoned Group Headers in Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100920">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/06/30">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes a routine to keep a given number of records together on a page with their group header. The article also explains how to avoid an abandoned group head...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QABO,QANO,QAOX,QA1S,QAPN,QDN9,QBVV,QAY5,QBWA,QAWI,QAF8,QBS0,QBV8,QBEX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Avoid Abandoned Group Headers in Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100920</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes a routine to keep a given number of records
together on a page with their group header. The article also explains how
to avoid an abandoned group header at the bottom of a page and how not to
print the group header beyond a certain position on the page in a single-
column or multiple-column report.
<P>
NOTE: For Single columns, the KeepTogether property for groups in Microsoft
Access 2.0, 7.0, and 97 gives you the ability to keep groups of similar
information together. This property is available in the Sorting And
Grouping dialog box for reports. However, this property only prevents page
breaks from occurring within a group; it does not prevent column breaks. To
prevent column breaks from occurring within a group, use one of the methods
described in this article.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The KeepTogether property is used to keep all of the controls for one
record together in a particular section of a report. This property
does not keep multiple records together, nor does it keep a group
header and its detail records together.
<P>
Method 1 below helps you to find the location on the page beyond which
you should not print a group header if you want to keep a given number of
records together with that header.
<P>
Method 2 below helps you to determine the twip location by trial and
error and describes two sample functions, one for a single-column report
and the other for a multi-column report.
<P>
<P><h3>Method 1</h3>
 
<P>
To keep a set number of records together on a single page with the group
header, you need to know approximately how many records will be printed
per group, or, more importantly, how many records you want to print with
a particular group header. You can preview your report to find the group
that prints the most records to determine how many records to keep with
the group header.
<P>
For example, say you have determined that the largest group prints 24
records. The detail section of your report is 1/4 inch in height; thus,
24 detail records take up 6 inches on a page. You must also consider the
top and bottom margins, which default to 1 inch each, and the height of
your group header section.
<P>
Using the Report.Top property, you can determine where on the page the next
section will be printed. If enough space remains to print your group
header, all of its detail records, and the page footer (if any), plus the
bottom margin, your group header will be printed on the same page as its
detail records. If there is not enough blank space, delay printing the
report (use a combination of the MoveLayout, NextRecord, and PrintSection
properties to leave the rest of the page blank) and continue the group
header information on the next page.
<P>
Below are sample measurements on which this article's calculations are
based:
<P>
<PRE>    Page Length:    11 inches
    Detail.Height:  0.25 inch

</PRE>Add the following values together:
<P>
<PRE>    Top Margin:          1 inch
    Page Header.Height:  1 inch
    Group Header.Height: 0.5 inch
    Group Footer.Height: 0.5 inch
    Page Footer.Height:  1 inch
    Bottom Margin:       1 inch
    -----------------------------
    Total = 5 inches

</PRE>To determine the blank space left on the page for detail records, subtract
the total above from your Page Length property value (11 inches - 5 inches
= 6 inches).
<P>
Divide the maximum space for detail records by the Detail.Height property
value (6 inches / 0.25 inch). A total of 24 detail records will fit on a
page. Force a new page if fewer than 8 records will print with the header
(for example, if the formula returns either less than the sum of 8 * 0.25
inches or less than 2 inches of blank space).
<P>
To determine where the top of the 2-inch limit is, or the point beyond
which you should not print the group header, add the following values
together:
<P>
<PRE>     Top margin 1 inch
     + Page Header.Height 1 inch
     + Remainder of detail section (6 inches - 2 inches)

     = 1 inch + 1 inch + (6 inches - 2 inches)

</PRE>Final calculation for the function: = 6 inches or (6 * 1440 twips)
<P>
To implement this calculation in a module, use the following steps:

<OL><P><LI>Enter the =PrintOK() function in the OnPrint property of your
   group header. (This function assumes a report name of MyReport.)

<P><LI>Type the following lines in the Declarations section of a module:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Function PrintOK()
<PRE></PRE>         Dim R As Report
         Set R = Reports!MyReport
         If R.Top &gt; (6 * 1440) Then
            R.MoveLayout = TRUE
            R.PrintSection = FALSE
            R.NextRecord = FALSE
         End If
      End Function

</PRE></OL><h3>Method 2</h3>
 
<P>
Another way to avoid an abandoned group header at the bottom of a page, or
not to print the group header beyond a certain position on the page, is to
replace (6*1440) in the function above with the twip location beyond which
you do not want to print.
<P>
The report tests the Top property; if the condition is True, the report
does not print the section. Instead, it moves down the report layout and
attempts to print the section until the condition is False, which occurs at
the top of the next page.
<P>
For a multi-column report, the function must be modified as follows:
<P>
<PRE>   Option Compare Database
   Option Explicit
   '=====================================================================
   '
   ' Function to force to new column if at bottom of column.
   '  R is the name of the Report being formatted, as in
   '  Reports![ReportName], and
   '  Bottom is the value (in inches) at which a new column is forced.
   '  This function should be called from the OnPrint property of the Group
   '  Header.
   '====================================================================
   Function IfBottom (R As Report, Bottom As Integer)
      Dim YPos
      Static LastPos

      YPos = R.Top
      If YPos &gt; Bottom * 1440 Then  ' Beyond this position, go to a new
                                    ' column.
         R.MoveLayout = True
         R.NextRecord = False
         R.PrintSection = (YPos = LastPos) ' Set to True when at Max
                                           ' position.
         LastPos = YPos
      End If
   End Function

</PRE>NOTE: This function will not work properly if Item Layout is set to
Horizontal (in Print Setup) for the columns.
 
<PRE>Keywords          : kbusage
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
