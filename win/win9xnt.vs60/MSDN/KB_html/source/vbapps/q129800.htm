

<HTML>
<HEAD>
<TITLE>PRB: VB/VB Apps Won't Run if Windows NT OLE Service Stopped </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129800">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1995/05/04">
<META NAME="Keywords" CONTENT="IAPOLE VB4ALL VB4WIN vbwin GnrlVb kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  If the OLE service under Windows NT is stopped, when you attempt to start Visual Basic or an application written with Visual Basic, you'll see this error:      Unexpected error; quitting   Or, if the OLE service is stopped while Visual Basic or an ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QANE,QBWP,QA9Q,QAMA,QAIJ,QACF,QBWS,QA5F,QAFX,QDL9,QBWQ,QBWO,QBWN,QA5E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: VB/VB Apps Won't Run if Windows NT OLE Service Stopped</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129800</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
<LI>Microsoft Windows NT operating system version 3.51 and later
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the OLE service under Windows NT is stopped, when you attempt to start
Visual Basic or an application written with Visual Basic, you'll see this
error:
<P>
<PRE>   "Unexpected error; quitting"

</PRE>Or, if the OLE service is stopped while Visual Basic or an application
written with Visual Basic is running and you attempt to use an OLE control
in Visual Basic, you'll see this error:
<P>
<PRE>   "Unable to create embedded object"

</PRE><h2>CAUSE</h2>
 
<P>
Visual Basic uses OLE extensively for controls, data access, and even
internal communication. The OLE Service is a necessary component for Visual
Basic, but it is not absolutely necessary for this service to be running
under Windows NT. It may be stopped to increase the overall performance of
other tasks. If this is done, Visual Basic and Visual Basic applications
will not run.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
<P><h3>Scenario One</h3>
 

<OL><P><LI>With Windows NT running, go to an MS-DOS command prompt. (Double-click
   the MS-DOS Command Prompt icon in your Main group in Program Manager.)

<P><LI>Type the following at the command prompt:
<P>
<P><PRE>      Net Stop OLE
</PRE>
<P><LI>Switch back to Windows, and start Visual Basic. You'll see this error:
<P>
<P><PRE>      Unexpected error; quitting
</PRE>
<P><LI>Switch back to MS-DOS, and type the following to restore everything to
   normal:
<P>
<P><PRE>      Net Start OLE
</PRE><P>
</OL><h3>Scenario Two</h3>
 

<OL><P><LI>Start Visual Basic.

<P><LI>With Windows NT running, go to an MS-DOS command prompt. (Double-click
   the MS-DOS Command Prompt icon in your Main group in Program Manager.)

<P><LI>Type the following at the command prompt.
<P>
<P><PRE>      Net Stop OLE
</PRE>
<P><LI>Attempt to add an OLE control to the default form. (Any control where an
   .OCX file appears in your Project window will be an OLE control.) Visual
   Basic reports this error:
<P>
<P><PRE>      Unable to create embedded object
</PRE>
<P><LI>Switch back to MS-DOS, and type the following to restore everything to
   normal:
<P>
<P><PRE>      Net Start OLE
</OL></PRE> 
<PRE>Keywords          : IAPOLE VB4ALL VB4WIN vbwin GnrlVb kberrmsg kbprg
Technology        : kbole kbvba
Version           : WINDOWS:4.0
Platform          : NT WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
