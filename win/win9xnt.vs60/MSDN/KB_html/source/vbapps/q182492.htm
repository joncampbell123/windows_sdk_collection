

<HTML>
<HEAD>
<TITLE>XL98: How to Populate One ListBox Based on Another ListBox </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182492">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1998/03/13">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article contains an example that uses the selected item in one ListBox control on a UserForm to determine the list that populates a second ListBox control.  MORE INFORMATION  Microsoft provides programming examples for illustration only, witho...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBLC,QBPZ,QAHP,QBWS,QBS0,QAE1,QAKE,QAH4,QAB5,QAVZ,QA7O,QAOE,QAMN,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: How to Populate One ListBox Based on Another ListBox</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182492</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains an example that uses the selected item in one
ListBox control on a UserForm to determine the list that populates
a second ListBox control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To use this example, follow these steps:

<OL><P><LI>Close and save any open workbooks, and then open a new workbook.

<P><LI>On Sheet1, enter the following values:
<P>
     A1: North Carolina  B1: Charlotte  C1: Charleston  D1: Charlottesville
<PRE>     A2: South Carolina  B2: Greensboro C2: Columbia    D2: Norfolk
     A3: Virginia        B3: Raleigh    C3: Greenville  D3: Richmond

</PRE><P><LI>Start the Visual Basic Editor (press OPTION+F11).

<P><LI>On the Insert menu, click UserForm.

<P><LI>Draw two ListBox controls on the UserForm.

<P><LI>Draw another ListBox control on the UserForm

<P><LI>Double-click the UserForm to display the Code window for the UserForm.

<P><LI>In the module, type the following code:
<P>
       Private Sub UserForm_Initialize
<P>
<PRE>          ' Populate ListBox1.
          ListBox1.List = Worksheets("Sheet1").Range("A1:A3").Value

       End Sub


       Private Sub ListBox1_Click()

           ' Get the currently selected item
           Select Case ListBox1.Value

               ' If North Carolina, set List property of ListBox2
               ' to Column B.
               Case "North Carolina"
                   ListBox2.List = _
                       Worksheets("Sheet1").Range("B1:B3").Value

               ' If South Carolina, set List property of ListBox2
               ' to Column C.
               Case "South Carolina"
                   ListBox2.List = _
                       Worksheets("Sheet1").Range("C1:C3").Value

               ' If Virginia, set List property of ListBox2 to
               ' Column D.
               Case "Virginia"
                   ListBox2.List = _
                       Worksheets("Sheet1").Range("D1:D3").Value

           End Select

       End Sub

</PRE><P><LI>Run the UserForm.
<P>
    When you choose one of the items in ListBox1, the list in ListBox2
    is updated, reflecting the choice you made in ListBox1.

<P><LI>Close the UserForm.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about list boxes, click the Office Assistant in the
Visual Basic Editor, type "listbox," click Search, and then click to view
"ListBox control."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q179216.htm">Q179216</A></B>
   TITLE     : OFF98: How to Use the Microsoft Office Installer Program
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 XL98 dynamic<BR>
Keywords          : kbcode kbprg xlvbahowto<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
