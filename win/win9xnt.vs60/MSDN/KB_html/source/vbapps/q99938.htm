

<HTML>
<HEAD>
<TITLE>ACC: Sample Function to Remove Alphas from a Numeric Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99938 ">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/06/10">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmParse">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to create a sample Microsoft Access function called RemoveAlphas() to remove alpha, or nonnumeric, characters from an alphanumeric string. All non...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAY5,QDN9,QAEF,QDL4,QBS0,QAB9,QBV8,QA7O,QA7N,QAXB,QA9N,QDH6,QANJ,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sample Function to Remove Alphas from a Numeric Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99938 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to create a sample Microsoft Access function
called RemoveAlphas() to remove alpha, or nonnumeric, characters from an
alphanumeric string. All nonnumeric characters will be removed.
<P>
A common use for the RemoveAlphas() function is to remove the parentheses,
dashes, and spaces from a telephone number or social security number field.
The following strings contain parentheses, dashes, and spaces:
<P>
<PRE>   "(206) 635-7050"
   "206-635-7050"
   "535-87-4529"

</PRE>After the RemoveAlphas() function is run, these strings will be:
<P>
<PRE>   "2066357050"
   "2066357050"
   "535874529"

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create the RemoveAlphas()
function, and how to use it either while data is being entered, or in an
update query to remove nonnumeric characters from phone numbers in a
table.
<P>
<P><h3>How to Create the RemoveAlphas() Function</h3>
 

<OL><P><LI>Create a new module.

<P><LI>On the Insert menu, click Procedure.
<P>
   NOTE: In Microsoft Access 2.0 or earlier, on the Edit menu, click New
   Procedure.

<P><LI>Type "RemoveAlphas" (without the quotation marks) in the Name box, and
   select Function in the Type box. Click OK.

<P><LI>Type the following function in the Module window:
<P>
<P><PRE>      Function RemoveAlphas (ByVal AlphaNum as Variant)
<PRE></PRE>         Dim Clean As String
         Dim Pos, A_Char$

         Pos = 1
         If IsNull(AlphaNum) Then Exit Function

         For Pos = 1 To Len(AlphaNum)
            A_Char$ = Mid(AlphaNum, Pos, 1)
            If A_Char$ &gt;= "0" And A_Char$ &lt;= "9" Then
              Clean$ = Clean$ + A_Char$
            End If
         Next Pos

         RemoveAlphas = Clean$

      End Function

</PRE><P><LI>Save the module with any unique name.
<P>
</OL><h3>How to Use the RemoveAlphas() Function in Data Entry</h3>
 
<P>
You can use the RemoveAlphas() function to remove dashes or parentheses
while phone numbers are being typed into a field.
<P>
For a field called Phone, add the following code to the AfterUpdate
property to the Phone text box on a form:
<P>
<PRE>   Private Sub Phone_AfterUpdate()
      Me![Phone] = RemoveAlphas(Me![Phone])
   End Sub

</PRE></OL><h3>How to Use the RemoveAlphas() Function in an Update Query</h3>
 

<OL><P><LI>Create a new query based on the table with the phone number field.

<P><LI>Place the phone number field in the first column of the query grid.

<P><LI>On the Query menu, click Update.

<P><LI>In the Update To row, enter the following for a field named Phone:
<P>
<P><PRE>      RemoveAlphas([Phone])
</PRE>
<P><LI>Run the query.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ssn hyphens<BR>
Keywords          : kbprg PgmHowTo PgmParse<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
