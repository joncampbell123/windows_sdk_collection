

<HTML>
<HEAD>
<TITLE>XL97: "Run-Time Error '1004': ATPVBAEN.XLA Could Not Be Found" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171027">
<META NAME="KBModify" CONTENT="1997/09/03">
<META NAME="KBCreate" CONTENT="1997/07/03">
<META NAME="Keywords" CONTENT="kberrmsg kbprg xlwin xladdins">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  If you run a macro that uses a function from the Analysis ToolPak add-in, you receive the following error message:     Run-time error '1004':    'ATPVBAEN.XLA' could not be found. Check the spelling of the file    name, and verify that the file loc...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QA5V,QAB4,QBWS,QAY5,QAH0,QAAP,QBV8,QAB9,QBVV,QA5F,QBS0,QABI,QDNE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: "Run-Time Error '1004': ATPVBAEN.XLA Could Not Be Found"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171027</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you run a macro that uses a function from the Analysis ToolPak add-in,
you receive the following error message:
<P>
<PRE>   Run-time error '1004':
   'ATPVBAEN.XLA' could not be found. Check the spelling of the file
   name, and verify that the file location is correct.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if you run a Microsoft Visual Basic for Applications
macro that uses a function from the Analysis ToolPak add-in and the
Analysis ToolPak VBA add-in is not loaded.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you use recorded macro code that uses a function in the Analysis
ToolPak, select the Analysis ToolPak - VBA add-in before you run the macro
code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In earlier versions of Microsoft Excel, recorded macro code that uses a
function in the Analysis ToolPak uses the Microsoft Excel 4.0
ExecuteExcel4Macro macro command. In Microsoft Excel 97, the recorded code
uses the Application.Run "Atpvbaen.xla!&lt;function&gt;" command. In Microsoft
Excel 97, the Analysis ToolPak - VBA add-in must be loaded to run the
recorded macro.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about recording macros, click the Index tab in
Microsoft Excel 97 Help, type the following text
<P>
<PRE>  macros, recording

</PRE>and then double-click the selected text to go to the "Record a macro"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00 vba atp analysis toolpak toolpack<BR>
Keywords          : kberrmsg kbprg xlwin xladdins<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
