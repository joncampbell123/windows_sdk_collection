

<HTML>
<HEAD>
<TITLE>HOWTO: Save an Embedded Word Document in Visual Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112440">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1994/03/08">
<META NAME="Keywords" CONTENT="IAPOLE PrgCtrlsCus vbwin GnrlVb kbprg kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Word version 6.0 for Windows disables the ability to do a FileSaveAs while an object is being edited in an OLE container. While these methods may not be enabled, it is possible to work around this limitation in code. This article explains how.  MOR...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAW6,QBS0,QAPN,QBXS,QAUR,QDO7,QA7O,QAOE,QAMN,QAB5,QAH4,QA5F,QAU7,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Save an Embedded Word Document in Visual Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112440</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
<PRE>  Windows, versions 2.0 and 3.0
</PRE>- Microsoft Word for Windows, version 6.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Word version 6.0 for Windows disables the ability to do a FileSaveAs while
an object is being edited in an OLE container. While these methods may not
be enabled, it is possible to work around this limitation in code. This
article explains how.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Commands that are part of the workspace are the responsibility of the top
container (the Visual Basic application). That is, the application is
responsible for the organization of windows, file level operations, and how
edits are ultimately saved. The top container must supply a single File
menu that contains file level commands such as Open, Close, Save, and
Print.
<P>
If the object is an opened object server application, the commands in its
File menu are modified to show containership (Close &amp; Return to &lt;container
doc&gt;, Exit &amp; Return to &lt;container doc&gt;).
<P>
A well-behaved OLE server will not allow workspace commands to be executed.
This is why they are disabled. To work around the problem, edit the object
in the server application -- without using in-place editing. In the server,
you'll find that the workspace commands are enabled. Therefore edit the
object in the server and use OLE Automation to control the server to
execute the Workspace commands.
<P>
<P><h3>Step-by-Step Example</h3>
 
<P>
The following example uses an OLE2 control called OLE1, which contains an
embedded Word version 6.0 document and a CommonDialog control called
CMDialog1. To make the code generic, the OLE1 control is passed to the
WordFileSave subroutine.

<OL><P><LI>Start a new project in Visual Basic, Form1 is created by default.

<P><LI>Add a command button (Command1), MSOLE2.VBX (OLE1) control, and a
   CMDIALOG.VBX (CMDialog1) control to Form1.

<P><LI>Add the following code to the Command1_Click event:
<P>
<PRE>   Sub Command1_Click ()
      ' Pass the name of the Control to WordFileSave subroutine.
      WordFileSave OLE1
   End Sub

</PRE><P><LI>Add the following code to the general declarations section of Form1:
<P>
<PRE>   Sub WordFileSave (OLECtrl As Control)
      'Purpose: Example of how to save an embedded Word object from
      'Visual Basic as a Word Document.

      'Overview of technique:      '
      'Activate Object. Select its contents. Copy contents to clipboard.
      'Launch a hidden instance of Word. Create a new file.
      'Paste clipboard into document. Save document.

      Dim Word As Object  'Alias to Hidden instance of Word.
                          'Only if Word is not already running.
      Dim WB As Object    'alias to WordBasic object.

      OLECtrl.Action = 7  'Activate OLE control. This must be done in order
                          'to have the Word Basic alias act on the correct
                          'instance of Word.
      Set WB = CreateObject("Word.Basic") 'Set the object variable.

      WB.editselectall    'Select the contents of the embedded object.
      WB.EditCopy         'Copy the selection to the clipboard.
      OLECtrl.Action = 9  'Deactivate the OLE control. This must be
                          'done before the following set statements to
                          'reference the correct instances of Word.

      'Use the Common dialog control to display a SaveAs dialog.
      CMDialog1.Filter = "Word Document (*.Doc)|*.doc"  'Set the filter
      CMDialog1.DefaultExt = "*.doc"            'Set the default extension
      CMDialog1.FileName = OLECtrl.SourceDoc 'Set default filename
      CMDialog1.Action = 2                      'Display the dialog.


      Set WB = Nothing    'Free the WB object reference.
      Set Word = GetObject("", "Word.Document.6")  'Create a hidden inst.
      Set WB = Word.application.Wordbasic  'Set WB to the WordBasic object
                                           'of the new instance of Word.

      WB.filenew        'Create a New file in hidden instance of Word.
      WB.editpaste      'Paste contents of clipboard into new document.
      WB.filesaveas CMDialog1.Filename  'Save file as selected by user.
      WB.fileclose       'Close document.

      Set WB = Nothing   'Free WordBasic object
      Set Word = Nothing 'Free Word Document object, if Word wasn't
                         'running previously, Word will shut itself down
                         'from memory; otherwise, it is up to the user to
                         'shut Word down.
   End Sub

</PRE><P><LI>Run the program. The program will ask you to input a name and then save
   the document to the name that you input.
</OL> 
<PRE>Keywords          : IAPOLE PrgCtrlsCus vbwin GnrlVb kbprg kbfasttip
Technology        : kbole kbvba
Version           : WINDOWS:3.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
