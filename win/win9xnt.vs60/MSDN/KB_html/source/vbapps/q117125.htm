

<HTML>
<HEAD>
<TITLE>XL5: Name Defined Incorrectly If Sheet Name Contains Space </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117125">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/06/21">
<META NAME="Keywords" CONTENT="kbprg SynFnc kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, if you use a Visual Basic, Applications Edition, subroutine to define a name on a worksheet and the name of the worksheet contains a space, the name is not defined correctly.  CAUSE =====  This problem may occur if y...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QBVP,QARM,QDMF,QBS0,QDMW,QAAP,QBWD,QBW5,QAR4,QAPF,QAKP,QDNM,QACJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Name Defined Incorrectly If Sheet Name Contains Space</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117125</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, if you use a Visual Basic, Applications
Edition, subroutine to define a name on a worksheet and the name of the
worksheet contains a space, the name is not defined correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur if you use the following syntax to define a name:
<P>
<PRE>   Workbooks(BookName).Sheets(SheetName).Range(RangeName).Name =
      "NameToDefine"

</PRE>If you use this syntax to define a name, the name may be incorrectly
defined if the worksheet name contains a space. For example, if the
worksheet name is "Sales Summary" and the range to refer to is $A$1,
the name may be defined as
<P>
<PRE>   =Sales SUMMARY!$A$1

</PRE>This defined name refers instead to the intersection of the ranges 'Sales'
and 'SUMMARY!$A$1' instead of cell $A$1 on 'Sales Summary'.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid this problem, use the Names.Add syntax to define names in a
Visual Basic subroutine, as in the following example:
<P>
<PRE>   Workbooks(BookName).Names.Add Name:="NameToDefine",
      RefersTo:="='" &amp; Sheets(SheetName).Name &amp; "'!" &amp;
      Sheets(SheetName).Range(RangeName).Address

</PRE>Note the use of apostrophes (') in the RefersTo argument. These apostrophes
are included to ensure that the worksheet name is treated as a single name,
instead of as two words separated by a space.
<P>
Using the above example, the name would be defined as
<P>
<PRE>   ='Sales Summary'!$A$1

</PRE>This is the correct definition of the name.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00<BR>
Keywords          : kbprg SynFnc kbcode kbprg<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
