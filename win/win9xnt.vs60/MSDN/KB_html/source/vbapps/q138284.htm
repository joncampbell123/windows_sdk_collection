

<HTML>
<HEAD>
<TITLE>XL7: Visual Basic Macro to Insert Data in Schedule+ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138284">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1995/10/16">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo xlwin kbhowto kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Microsoft Schedule+ for Windows 95, version 7.0, can be programmatically controlled through Visual Basic for applications. The following example takes data from a Microsoft Excel worksheet and places it in the Contacts database in Microsoft Schedul...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAL4,QBVP,QBXS,QA9Q,QA6A,QA2K,QAH4,QAYY,QDL9,QBWS,QBWQ,QBWO,QBWN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: Visual Basic Macro to Insert Data in Schedule+</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138284</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Schedule+ for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Schedule+ for Windows 95, version 7.0, can be programmatically
controlled through Visual Basic for applications. The following example
takes data from a Microsoft Excel worksheet and places it in the Contacts
database in Microsoft Schedule+.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for applications procedures for
illustration only, without warranty either expressed or implied, including
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. This Visual Basic procedure is provided 'as is'
and Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h3>Sample Macro</h3>
 
<P>
<PRE>   Sub Place_Data_From_XL_Into_Contacts()
   Dim objSched, objTable, objItem As Object

   ' Sets a variable to the caption of Excel
   CurApp = Application.Caption

   ' Creates the schedule+ object
   Set objSched = CreateObject("scheduleplus.application.7")

   ' Checks to see if you are logged on to Schedule+
   If Not objSched.LoggedOn Then

      AppActivate CurApp 'activates Excel

      ' Prompts you for you email name
      UserName = Application.InputBox("Please Enter Your Email Name")

      objSched.Logon UserName, "", True   'logs you into schedule+
   End If

   ' Creates the contacts database object
   Set objTable = objSched.ScheduleSelected.Contacts
      With Worksheets("Sheet1")

      ' Starts a loop from 1 to the number of rows of data
         For i = 2 To .Range(.Range("a2"), _
         .Range("a2").End(xlDown)).Rows.Count

            Set objItem = objTable.New ' Creates a blank new entry in the
                                       ' table

            ' Creates new entries in the contacts database
            ' using the values in the appropriate cells
            'The following three lines need to be on one line

            objItem.SetProperties FirstName:=.Range("a" &amp; i).Value, _
                LastName:=.Range("b" &amp; i).Value, _
                PhoneBusiness:=.Range("c" &amp; i).Value, _
                PhoneHome:=.Range("d" &amp; i).Value

         Next i 'returns to the top of the loop

      End With

   End Sub

</PRE><h3>To test the sample macro</h3>
 

<OL><P><LI>Enter the following data on Sheet1 of a new workbook:
<P>
   A1: First Name  B1: Last Name  C1: Business Phone  D1: Home Phone
<PRE>   A2: John        B2: Doe        C2: (232)653-6545   D2: (232)345-4343
   A3: Larry       B3: Popper     C3: (434)564-5465   D3: (434)534-8967
   A4: Peter       B4: Los        C4: (212)896-3465   D4: (867)756-3654
   A5: Neal        B5: West       C5: (545)927-7261   D5: (999)888-1234
   A6: Kevin       B6: Slack      C6: (111)555-6306   D6: (555)596-0000

</PRE><P><LI>Run the Place_Data_From_XL_Into_Contacts macro.

<P><LI>To view the new data, switch to Schedule+ and click the Contacts tab.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about OLE Automation, click the Index tab in
Microsoft Help, type the following text
<P>
<PRE>   OLE Automation

</PRE></OL>click the OLE Automation topic, and click the OLE Automation topic in the
list of topics found to go to the "OLE Automation" topic.
<P>
For more information about programming with Microsoft Schedule+ for Windows
95, version 7.0, you need to have the Microsoft BackOffice Software
Development Kit (SDK) installed. In Microsoft BackOffice SDK in the Entire
Contents pane, choose Microsoft Exchange Server. There will be a sub-level
entitled Microsoft Schedule+ Programmer's Guide.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 howto<BR>
Keywords          : kbprg PgmHowTo xlwin kbhowto kbole kbprg<BR>
Version           : 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
