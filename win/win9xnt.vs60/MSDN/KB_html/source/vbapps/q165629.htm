

<HTML>
<HEAD>
<TITLE>ACC97: How to Create Custom Navigation Buttons on an ASP Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165629">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="kbinterop IntAsp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you export a form from Microsoft Access 97 as an Active Server Page, and that form has custom buttons that move from one record to the next, the buttons will not work on you...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAH4,QA1S,QAFF,QBWA,QDN9,QA3P,QA5D,QBS0,QA62,QACI,QAEF,QAJD,QA9N,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: How to Create Custom Navigation Buttons on an ASP Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165629</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
<PRE>  - Microsoft Access 97
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you export a form from Microsoft Access 97 as an Active Server Page,
and that form has custom buttons that move from one record to the next, the
buttons will not work on your Active Server Page form. This happens because
the Visual Basic code that performs the actions in Microsoft Access is not
exported to your Active Server Page form.
<P>
There are two ways to have navigation buttons appear on your Active Server
Page form:

<UL><LI>Use the Microsoft Access built-in navigation buttons and set the
   Navigation property of the form to Yes.

<LI>Modify the VBScript for the Active Server Page form that you are
   exporting so that the code will allow you to move through your
   form as you click a button.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This section contains information about editing ASP files and
assumes that you are familiar with editing HTML files, Active Server
Pages, and Visual Basic Scripting. Microsoft Access Technical Support
engineers do not support customization of any HTML, HTX, IDC, or ASP
files.
<P>
This article demonstrates a method that creates custom navigation buttons
that enable you to move through the form by modifying the VBScript for the
Active Server Page file. To modify the VBScript for a particular form,
follow these steps:

<OL><P><LI>Create the form that you will be using as an Active Server Page and
   add the following command buttons to the form:
<P>
<P><PRE>      Command Button:
<PRE></PRE>         Name: MoveNextRecord
         Caption: MoveNextRecord

      Command button:
         Name: MoveFirstRecord
         Caption: MoveFirstRecord

      Command button:
         Name: MoveLastRecord
         Caption: MoveLastRecord

</PRE><P><LI>Set the Navigation property of the Form to No.

<P><LI>Export the form to Active Server Page format and note the folder to
   which the file is exported. There should be two files in this folder
   that are associated with your Active Server Page. One of the files will
   contain the characters "alx" (without the quotation marks).

<P><LI>Use Notepad or another text editor to open the file that contains the
   characters "alx." You should see code similar to the following:
<P>
<P><PRE>      &lt;SCRIPT LANGUAGE=VBScript&gt;
      &lt;!--
      Dim rgszCtrls(6,2)
      Dim cMaxCtrls
      cMaxCtrls = 6
<PRE></PRE>      Sub AddCtrlToList(szCtrl, szCtrlSrc)
          Dim i
          for i = 1 to cMaxCtrls
              if rgszCtrls(i, 1) = szCtrl Then Exit Sub
              if rgszCtrls(i, 1) = "" Then
                  rgszCtrls(i, 1) = szCtrl
                  rgszCtrls(i, 2) = szCtrlSrc
                  Exit Sub
               End If
           next
       End Sub

</PRE><P><LI>Add the following three Sub procedures to the code just before the line
   that reads &lt;/SCRIPT&gt;.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code.
<P>
<PRE>      Sub FirstRecord_MoveFirstRecord_Click()

          Window.Location.href =
              "/scripts/formname.asp?nav_btn=nav_btn_movefirstrecord&amp;" _
          &amp; GetCtrlQueryString()

      End Sub

      Sub NextRecord_MoveNextRecord_Click()

          Window.Location.href =
              "/scripts/formname.asp?nav_btn=nav_btn__movenextrecord&amp;" _
          &amp; GetCtrlQueryString()

      End Sub

      Sub LastRecord_MoveLastRecord_Click()

          Window.Location.href =
          "/scripts/formname.asp?nav_btn=nav_btn__movelastrecord&amp;" _
          &amp; GetCtrlQueryString()

      End Sub

</PRE><P><LI>Modify the OBJECT ID's for the above controls in the &lt;/SCRIPT&gt; section
   and replace the names as follows:
<P>
<P><PRE>       FirstRecord = FirstRecord_MoveFirstRecord.
       NextRecord = NextRecord_MoveNextRecord.
       LastRecord = LastRecord_MoveLastRecord.
</PRE>
<P><LI>Close and save the file.

<P><LI>Open your Web browser and your Active Server Page form. Click one of
   the custom command buttons. The buttons should now enable you to move
   through the pages.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about what can be exported to ASP format, search the
Help Index for "ASP files," and then view the topic "Using Supported and
unsupported form controls for dynamic ASP format," or ask the Microsoft
Access 97 Office Assistant.
 
<PRE>Keywords          : kbinterop IntAsp
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
