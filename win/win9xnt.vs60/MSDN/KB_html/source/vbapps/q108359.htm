

<HTML>
<HEAD>
<TITLE>XL: Cannot Define Name If Active Sheet Protected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108359">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1993/12/08">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, if the active sheet and its contents are protected, you may not be able to do either of the following:   - Define a name by pointing to Name on the Insert menu and then clicking    Define.      -or-   - Add a name anywhere in th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUJ,QAVX,QAVW,QBS0,QARM,QAH4,QAK7,QAVY,QAPF,QAVZ,QDL9,QBWQ,QBWO,QBWN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Cannot Define Name If Active Sheet Protected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108359</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if the active sheet and its contents are protected, you
may not be able to do either of the following:

<UL><LI>Define a name by pointing to Name on the Insert menu and then clicking
   Define.
<P>
<P><PRE>    -or-
</PRE>
<LI>Add a name anywhere in the workbook by using the Visual Basic for
   Applications Names.Add method or the Microsoft Excel 4.0 DEFINE.NAME()
   macro command. This applies only to Microsoft Excel for Windows, version
   5.0.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To define a name when the active sheet and its contents are protected,
follow the appropriate procedure below.
<P>
<P><h3>Manually Define the Name</h3>
 
<P>
Use the name box on the left side of the formula bar. For example, to
define the new global name "Test" when the active sheet and its contents
are protected:

<OL><P><LI>Select the range to which "Test" should refer.

<P><LI>In the name box, type "Test" (without the quotation marks) and press
   ENTER to define the name.
<P>
</OL>To define a local name, include the sheet's name in the name box. For
example type, "Sheet1!Test" or "Sheet2!Sample".
<P>
NOTE: To protect a worksheet and prevent names from being created using the
name box, disable the formula bar.
<P>
NOTE: You cannot use this method to define a name in Microsoft Excel 97 or 
Microsoft Excel 98 Macintosh Edition when the active sheet is protected.
<P>
<P><h3>Use Code to Define the Name</h3>
 
<P>
Using the Names.Add method or the DEFINE.NAME() macro command to define a
name, you must first activate an unprotected sheet or unprotect the active
sheet.
<P>
If you want to add a defined name without unprotecting the worksheet, use
code similar to the following sample Visual Basic for Applications macro.
<P>
<PRE>   Sub Insert_Name()

       'This will define the range A1:A5 on the active sheet
       'to the name "test".
       ActiveSheet.Range("A1:A5").Name = "test"

   End Sub

</PRE></OL>Run the macro "Insert_Name" and the range A1:A5 will be defined as "test" 
(without the quotation marks).
<P>
NOTE: In Microsoft Excel versions 5.0c and later, you can use a Visual 
Basic subroutine or Microsoft Excel 4.0 macro to define a name on a 
protected worksheet without first unprotecting the worksheet. The 
workaround shown above is necessary only in Microsoft Excel for Windows, 
version 5.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide," version 5.0, pages 688-692
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 7.00 XL98 XL97 XL7 XL5<BR>
Keywords          : kbcode kbprg PgmOthr<BR>
Version           : WINDOWS:5.0,5.0c,7.0,97; MACINTOSH:5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
