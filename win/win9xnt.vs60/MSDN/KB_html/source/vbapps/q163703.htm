

<HTML>
<HEAD>
<TITLE>ACC: RecordsAffected Property Incorrect for SQL Pass-Through </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163703">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/02/14">
<META NAME="Keywords" CONTENT="kbusage ODBCSPT QryPass MdlQry">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the RecordsAffected property of a Database or QueryDef object to determine the number of records affected by the Execute method, the value is incorrect with SQL pass...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QAPN,QA01,QDKY,QAKC,QDN9,QAZV,QABM,QAAP,QBC6,QAUD,QAR4,QAL3,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: RecordsAffected Property Incorrect for SQL Pass-Through</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163703</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the RecordsAffected property of a Database or QueryDef object
to determine the number of records affected by the Execute method, the
value is incorrect with SQL pass-through queries.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The RecordsAffected property is not set when you execute a pass-through
query.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you view the RecordsAffected property, it reflects the number of
records affected by the most recent Execute method on an object that uses
the Microsoft Jet database engine. Pass-through queries bypass the Jet
database engine and interact directly with the back-end database through
the ODBC driver.
<P>
The following example shows a correct RecordsAffected value because the
Execute method operates on a table in the sample database Northwind.mdb:

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub ViewRecs()
         Dim db As DATABASE
         ' Substitute the correct path to Northwind.mdb on your computer.
         Set db = DBEngine.Workspaces(0).OpenDatabase _
         ("C:\Program Files\Microsoft Office\Office\Samples\Northwind.mdb")
         db.Execute "Update employees set country = 'United States' " _
          &amp; "where country = 'USA';"
         Msgbox db.RecordsAffected
      End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       ViewRecs
</PRE><P>
   Note that a message box opens and displays the number of records
   affected by the update. The number is 5 in an unaltered copy of
   Northwind.mdb.
<P>
</OL><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example uses an ODBC connection to the Pubs database in
Microsoft SQL Server. Substitute the correct parameters for your ODBC
database in the OpenDatabase method.
<P>
NOTE: If the number of records affected by the most recent Execute method
in your current instance of Microsoft Access happens to be 2, the
RecordsAffected property will return the correct number of records. Quit
and restart Microsoft Access to ensure that you reproduce the desired
results from this example.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub WrongNum()
         Dim db As DATABASE
         Dim SPTErr As Error
         On Error GoTo WrongNum_err
         ' Substitute your own ODBC connection parameters.
         Set db = OpenDatabase("", False, False, _
            "ODBC;DSN=Pubs1;DATABASE=pubs;UID=sa;PWD=")
         ' Create a table in SQL Server and create a unique index.
         db.Execute "create table testrecs (f1 int)", dbSQLPassThrough
         db.Execute "create unique index idx on testrecs (f1)", _
            dbSQLPassThrough

         ' Insert two records.
         db.Execute "Insert into testrecs values(1)", dbSQLPassThrough
         db.Execute "Insert into testrecs values(2)", dbSQLPassThrough

         ' This message box returns 0 records.
         Msgbox db.RecordsAffected &amp; " Records Affected."

         ' Delete the testrecs table.
         db.Execute "drop table testrecs", dbSQLPassThrough

         ' This message box returns 0 records.
         Msgbox db.RecordsAffected &amp; " Records Affected."
       Exit Sub
         WrongNum_err:
         For Each SPTErr In DBEngine.Errors
            With SPTErr
               Msgbox .Number &amp; vbcr &amp; .Description &amp; vbcr &amp; .Source
            End With
         Next SPTErr
      End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      WrongNum
</PRE><P>
   Note that a message box opens twice and displays the number 0 instead
   of the actual number of records affected, which is 2.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the RecordsAffected property, search the Help
Index for "RecordsAffected property."
 
<PRE>Keywords          : kbusage ODBCSPT QryPass MdlQry
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
