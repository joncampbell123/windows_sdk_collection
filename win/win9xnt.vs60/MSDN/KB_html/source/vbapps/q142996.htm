

<HTML>
<HEAD>
<TITLE>ACC: How to Use Automation to Fill a List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142996">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/01/24">
<META NAME="Keywords" CONTENT="AutoGnrl kbprg kbusage PgmHowTo IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to use Automation to populate a list box from values contained in a Microsoft Excel worksheet.  This article assumes that you are familiar with...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBVP,QBS0,QA1S,QBCF,QA4C,QAH4,QAGX,QDN9,QA2K,QAY5,QAE1,QA5V,QBV8,QBXS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use Automation to Fill a List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142996</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to use Automation to populate a list box
from values contained in a Microsoft Excel worksheet.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of
the "Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following function uses Automation to retrieve a list of countries
from a Microsoft Excel worksheet. The list is used to populate a list
box bound to the Country field of the Suppliers table in the sample
database Northwind.mdb.

<OL><P><LI>Start Microsoft Excel and create a new worksheet with the following
    data:
<P>
<PRE>       Cell   Value
       ----------------
       A1     Australia
       A2     China
       A3     Scotland

</PRE><P><LI>Save the worksheet as C:\My Documents\Country.xls.
<P>
    NOTE: If you change the name or location of this file, be sure to
    change the sample code to reflect this change.

<P><LI>Open the sample database Northwind.mdb and create a new module.

<P><LI>Type the following lines in the Declarations section:
<P>
       Option Explicit
       Dim Countries(3) As String

<P><LI>Type the following subroutine:
<P>
<PRE>       Sub OLEFillCountries()
          Dim i%
          Dim XL As Object
          Dim WrkBook As Object
          Set XL = CreateObject("Excel.Application")
          Set WrkBook = XL.Workbooks.Open("C:\My Documents\Country.xls")
          For i% = 0 To 2
             Countries(i%) = WrkBook.Sheets(1).Cells(i% + 1, 1).Value
          Next i%
          XL.Quit
          Set WrkBook = Nothing
          Set XL = Nothing
       End Sub

</PRE><P><LI>Type the following function:
<P>
       Function OLEFillList(fld As Control, id, row, col, code)
<PRE>          Select Case code
             Case 0                     ' Initialize.
                Call OLEFillCountries
                OLEFillList = True
             Case 1                     ' Open.
                OLEFillList = id
             Case 3                     ' Get number of rows.
                OLEFillList = 3
             Case 4                     ' Get number of columns.
                OLEFillList = 1
             Case 5                     ' Force default width.
                OLEFillList = -1
             Case 6
                OLEFillList = Countries(row)
          End Select
       End Function

</PRE><P><LI>Save the module as "OLE Fill list box" (without the quotation marks).

<P><LI>Create a new form based on the Suppliers table.

<P><LI>Create a list box with the following properties:
<P>
       Object: List Box
       --------------------------
       ControlSource: Country
       RowSourceType: OLEFillList

<P><LI>Open the form in Form view. Note that the list box contains the
    values entered in the spreadsheet.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using functions to fill list boxes, search
the Help Index for "List Boxes, Create a list box or combo box that gets
its rows from a Visual Basic function," or ask the Microsoft Access 97
Office Assistant.
<P>
For more information about Automation, search the help Index for "OLE
Automation."
 
<PRE>Keywords          : AutoGnrl kbprg kbusage PgmHowTo IntpOleA
Technology        : kbole
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
