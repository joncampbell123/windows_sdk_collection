

<HTML>
<HEAD>
<TITLE>ACC: How to Use Schema.ini for Accessing Text Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149090">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/03/27">
<META NAME="Keywords" CONTENT="kb3rdparty PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to programmatically open or link to a text file using a Schema.ini file and Data Access Objects (DAO). A Schema.ini file contains the specifics...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA1S,QAMB,QATX,QDN9,QA5V,QAVX,QBS0,QAY5,QAYY,QAP2,QAIF,QADF,QAZV,QBV8 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use Schema.ini for Accessing Text Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149090</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to programmatically open or link to a text
file using a Schema.ini file and Data Access Objects (DAO). A Schema.ini
file contains the specifics on how data is formatted in a particular text
file and is used by the Text ISAM driver to read and manipulate data.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Follow these steps to create a Schema.ini file and a fixed-width text file
that you can use in the Example sections later in the article:

<OL><P><LI>Start a text editor, such as NotePad or WordPad.

<P><LI>In a new text file, type the following text and save the file as
   Contacts.txt:
<P>
<PRE>      First     NameLast NameHireDate
      Nancy     Davolio  10-22-91
      Robert    King     10-23-91

</PRE><P><LI>In another new text file, type the following text and save the file as
   Schema.ini:
<P>
<P><PRE>      [Contacts.txt]
      ColNameHeader=True
      Format=FixedLength
      MaxScanRows=0
      CharacterSet=OEM
      Col1="First Name" Char Width 10
      Col2="Last Name" Char Width 9
      Col3="HireDate" Date Width 8
</PRE><P>
</OL>NOTE: Make sure both the Contacts.txt and Schema.ini files are stored in
the same folder (directory), for example, C:\My Documents.
<P>
<P><h3>Example 1</h3>
 
<P>
To create a recordset using data from a text file (Contacts.txt), follow
these steps:

<OL><P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function TestSchema()
<PRE></PRE>         Dim db As DATABASE, rs As Recordset
         Set db = OpenDatabase("c:\my documents", False, _
         False,"TEXT;Database=c:\my documents;table=contacts.txt")
         Set rs = db.OpenRecordset("contacts.txt")

         rs.MoveLast
         Debug.Print "Record count= " &amp; rs.RecordCount
         rs.Close

      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ?TestSchema()
</PRE><P>
   Note that "Record count= 2" is displayed.
<P>
</OL><h3>Example 2</h3>
 
<P>
To create a table linked to a text file (Contacts.txt), follow these
steps:

<OL><P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function LinkSchema()
<PRE></PRE>         Dim db As DATABASE, tbl As TableDef
         Set db = CurrentDb()
         Set tbl = db.CreateTableDef("Linked Text")

         tbl.Connect = "Text;DATABASE=c:\my documents;TABLE=contacts.txt"
         tbl.SourceTableName = "contacts.txt"
         db.TableDefs.Append tbl
         db.TableDefs.Refresh
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ?LinkSchema()
</PRE><P>
   Note that linked table is added to the database.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about accessing data in a text file, search on
"accessing data in text documents," using the Microsoft Access Help
Index.
 
<PRE>Keywords          : kb3rdparty PgmHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
