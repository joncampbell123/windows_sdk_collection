

<HTML>
<HEAD>
<TITLE>ACC: Type Mismatch When Comparing Bookmarks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152548">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/06/18">
<META NAME="Keywords" CONTENT="JetRS kberrmsg kbprg PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you compare a recordset's bookmark with a Variant or String variable, you may receive the following error message:     Run-time error '13:'    Type Mismatch  This error mess...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAML,QAB4,QAPP,QA1S,QBWR,QAG7,QAH4,QDN9,QAYL,QAKE,QAY5,QAPN,QAP2,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Type Mismatch When Comparing Bookmarks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152548</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you compare a recordset's bookmark with a Variant or String variable,
you may receive the following error message:
<P>
<PRE>   Run-time error '13:'
   Type Mismatch

</PRE>This error message can also occur when you compare a recordset's bookmark
to the RecordsetClone of, for example, a form's record source.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use the StrComp() function to compare a Variant or String variable to a
bookmark, or to compare a bookmark against a bookmark. The third argument
for the StrComp() function must be set to a value of 0 (zero).
<P>
For example, the following code tests to see if a form is displaying its
last record by first cloning the record source of the form, moving to the
last record within the cloned recordset, and then testing to see if the
last record within the cloned recordset matches the record currently
displayed on the form:
<P>
<PRE>   Dim RS As Recordset
   Set RS = Me.RecordsetClone
   RS.MoveLast
   If StrComp(Me.Bookmark, RS.Bookmark, 0) = 0 Then
      MsgBox "Form is displaying the last record."
   End If

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Online Help for the Bookmark Property contains the following subheading:
<P>
<PRE>   'Settings and Return Values.'

</PRE>The information under this subheading reads as follows:
<P>
<PRE>   The setting or returned value is a string expression or variant
   expression that evaluates to a valid bookmark. (Data type is Variant
   array of Byte data.)

</PRE>Despite the information in Help, if a bookmark is compared against a
variable of data type Variant or String, or compared to another
bookmark while using a comparison operator (such as an equal sign) in
Visual Basic for Applications, the procedure fails, generating the
error message defined in the SYMPTOMS section.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Enter the following into the OnCurrent event of the Customers form:
<P>
<P><PRE>      Dim RS As Recordset
      Set RS = Me.RecordsetClone
      RS.MoveLast
      If Me.Bookmark = RS.Bookmark Then
<PRE></PRE>         MsgBox "Form is displaying the last record."
      End If

</PRE><P><LI>Click Form on the View menu. Note that Microsoft Access displays the
   following error message:
<P>
<P><PRE>      Run-time error '13:'
      Type mismatch
</PRE>
<P><LI>Click the Debug button. Note that Microsoft Access highlights the line
   of code where the type mismatch occurs. The line of code is:
<P>
<P><PRE>      If Me.Bookmark = RS.Bookmark Then
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the StrComp() function, search the Help Index
for "StrComp Function," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the Bookmark Property, search the Help Index
for "Bookmark Property," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : JetRS kberrmsg kbprg PgmObj
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbdocerr</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
