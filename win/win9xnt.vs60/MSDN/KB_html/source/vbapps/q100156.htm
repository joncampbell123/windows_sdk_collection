

<HTML>
<HEAD>
<TITLE>ACC: How to Specify a Custom Starting Page Number for a Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100156">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/06/16">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  In Microsoft Access reports, page numbering always starts with the number 1. However, you may want your report to have page numbering that starts with some number other than 1. T...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBTP,QDN9,QBXV,QAKC,QBJZ,QBC6,QAPN,QBS0,QAIJ,QBWS,QAH4,QAG8,QA5F,QAMA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Specify a Custom Starting Page Number for a Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100156</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
In Microsoft Access reports, page numbering always starts with the
number 1. However, you may want your report to have page numbering
that starts with some number other than 1. This article describes two
methods of defining custom starting page numbers. Both methods provide
custom page numbers; however, the second method uses Visual Basic for
applications and can therefore include error checking. This method is
more complex, but avoids the possibility that a nonnumeric value will be
entered when you are prompted for a starting number.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in Microsoft Access
   1.x and 2.0)

<P><LI>Create a new report based on Employees table.

<P><LI>Add fields by dragging them from the fields list

<P><LI>On the View menu, click Page Header/Footer.

<P><LI>In Microsoft Access 7.0 and 97:
<P>
<P><PRE>     On the Insert menu, click Page Number, and then click OK.
</PRE><P>
   In Microsoft Access 1.x and 2.0:
<P>
<P><PRE>     Create a new unbound text box in the header or footer section.
</PRE>
<P><LI>Click to select the new field and on the View menu, click Properties.

<P><LI>Change the ControlSource property to read as follows:
<P>
<P><PRE>      ="Page " &amp; [Page] + [Enter a Starting Page Number] - 1
</PRE><P>
</OL>When you preview or print the report, you will be prompted for a starting
page number. Each page will be numbered consecutively starting with this
number.
<P>
<P><h3>Method 2</h3>
 
<P>
This part of the article assumes that you are familiar with Visual Basic
for Applications and with creating Microsoft Access applications using
the programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Open Northwind.mdb (NWIND.MDB in Microsoft Access 1.x and 2.0).

<P><LI>Create a new module and type the following code:
<P>
<P><PRE>      '******************************************************
      'Declarations Section of Module
      '******************************************************
      Option Explicit
      Global PageChoice As Integer
</PRE><P>
<P><PRE>      '===========================================================
      'Create the following GetPageChoice() function in the Module
      '===========================================================
      'This function is called in the OnOpen property of the Report.
      Function GetPageChoice ()
<PRE></PRE>         Dim choice As String
         Do
            choice = InputBox("Enter a Starting Page Number:"," _
                          Number Report", "1")
            If Not (IsNumeric(choice)) Then
               MsgBox "Value Entered is not a Number."
            End If
         Loop While Not (IsNumeric(choice))
         PageChoice = CInt(choice)
      End Function

      '==============================================================
      'Create the following ReturnPageChoice() function in the Module
      '==============================================================
      'This function is called by the text box that will contain the
      ' pagenumber.
      Function ReturnPageChoice (pgnumber As Integer)
         ReturnPageChoice = PageChoice + pgnumber - 1
      End Function

</PRE><P><LI>Compile the module, and then save it as "basPages" (without the
   quotation marks).

<P><LI>Open the Summary Of Sales By Quarter report in Design view.

<P><LI>On the Edit menu, click Select Report, and then on the View menu,
   click Properties to display the property sheet. Change the OnOpen
   property to read as follows:
<P>
<P><PRE>      OnOpen: =GetPageChoice()
</PRE>
<P><LI>Select the text box PageNumber in the footer by clicking it. Change
   the ControlSource property to read as follows:
<P>
<P><PRE>      ="Page " &amp; ReturnPageChoice(Page).
</PRE><P>
</OL>When you preview or print the report, you will be prompted for a starting
page number. Each page will be numbered consecutively starting with this
number.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Page property, search for "Page Numbers,"
and then "Page, Pages Properties" using the Microsoft Access 97 Help Index.
<P>
For more information about looping structures, search for "loops" using
the Microsoft Access 97 Help Index.
 
<PRE>Keywords          : kbusage PgmHowTo
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
