

<HTML>
<HEAD>
<TITLE>ACC: How to Change Area Codes Based on Telephone Number Prefix </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96010 ">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/03/03">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Some states are adding new telephone area codes based on a phone number's prefix. This article describes how to change a phone number's area code in a table based on the pre...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDL4,QA1S,QBS0,QDN9,QAY5,QANF,QAMA,QA5F,QAH6,QBV8,QAKC,QABG,QAB9,QAUJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Change Area Codes Based on Telephone Number Prefix</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96010 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Some states are adding new telephone area codes based on a phone number's
prefix. This article describes how to change a phone number's area code in
a table based on the prefix. This is accomplished by creating a table with
the prefix you want to find and the new area code. A Visual Basic function
then reads this table into an array and searches the phone number table and
changes the area code in the phone number table.
<P>
IMPORTANT: Before running this function, back up your database and make a
copy of your table.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create the function, follow these steps:

<OL><P><LI>Create the following table that will contain the phone number prefix
   to search for and the new area code:
<P>
<P><PRE>      Table: Area Codes To Change
      ---------------------------
      Field Name: Prefix
<PRE></PRE>         Data type: Text
      Field Name: Area Codes
         Data type: Text

</PRE><P><LI>Type the phone number prefixes and area codes in the table Area Codes To
   Change, for example:
<P>
<PRE>      Prefix      Area Codes
      ----------------------
      635            207
      634            208

</PRE><P><LI>Open a module or create a new one, and type the following code:
<P>
   NOTE: In the following sample code, an underscore (_) is used as a
   line-continuation character. Remove the underscore from the end of the
   line when re-creating this code in Access Basic.
<P>
<P><PRE>      '*************************************************************
      'Declarations section of the module.
      '*************************************************************
</PRE><P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      '=============================================================
      ' Create the following ChgAreaCode() function in the Module
      ' The following function will initialize:
      ' - A variable for the database object.
      ' - Variables for the table objects and several other objects.
      ' - Sets the database object to the opened database.
      ' - Opens table "Area Codes To Change" and tPhName.
      ' - The action of this function is to locate the phone number
<PRE></PRE>      '     entries with certain prefixes and then change the
      '     corresponding area code. This function operates on numbers
      '     with the following format "(206) 635-7050". The table name
      '     and field name containing the phone number must be passed
      '     as arguments.
      '=============================================================
      Function ChgAreaCode (tPhName, fldPhone)
         Dim PhoneDB As Database
         Dim tPhone As Recordset, tPrefix As Recordset
         Dim PCount%
         Dim i%
         Dim tPrefixName$
         Dim Prefix$
         Dim SpacePos%
         Dim HyphenPos%
         Dim PrefixLen%
         Dim PrefixToFind$
         Dim AreaCode$
         Dim Lastfour$
         tPrefixName$ = "Area Codes To Change"

         If tPhName = "" Or fldPhone = "" Then Exit Function

         Set PhoneDB = CurrentDB()
         Set tPrefix = PhoneDB.OpenRecordset(tPrefixName$)

         tPrefix.MoveLast
         PCount% = tPrefix.RecordCount
         tPrefix.MoveFirst
         ReDim PrefixArray$((PCount% - 1), 1)

         For i% = 0 To PCount% - 1 Step 1
            PrefixArray$(i%, 0) = tPrefix![Prefix]
            PrefixArray$(i%, 1) = tPrefix![Area Codes]
            tPrefix.MoveNext
         Next i%
         tPrefix.MoveFirst
         tPrefix.Close

         Set tPhone = PhoneDB.OpenRecordset(tPhName)
         Do Until tPhone.EOF
            SpacePos% = InStr(1, tPhone(fldPhone), " ")
            HyphenPos% = InStr(SpacePos% + 1, tPhone(fldPhone), "-")
            PrefixLen% = (HyphenPos% - SpacePos%) - 1
            PrefixToFind$ = Mid(tPhone(fldPhone), SpacePos% + _
                               1, PrefixLen%)

            For i% = 0 To PCount% - 1 Step 1
               If PrefixArray$(i%, 0) = PrefixToFind$ Then
                  AreaCode$ = PrefixArray$(i%, 1)
                  Prefix$ = Mid$(tPhone(fldPhone), 7, 3)
                  Lastfour$ = Right$(tPhone(fldPhone), 4)
                  tPhone.Edit
                  tPhone(fldPhone) = "(" &amp; AreaCode &amp; ") " _
                                        &amp; Prefix &amp; "-" &amp; Lastfour
                  tPhone.Update
               End If
            Next i%

            tPhone.MoveNext
         Loop
         tPhone.Close
         PhoneDB.Close
      End Function

</PRE></OL>When using this function, you pass (tPhName), the name of the table
containing the number to change, as a string. Then you pass (fldPhone),
the field name that contains the number to change, as a string.
<P>
<P><h3>Example</h3>
 
<P>
To call this function from the Debug window (or the Immediate window
in versions 1.x and 2.0), type the following line, and then press ENTER
<P>
<PRE>   ?ChgAreaCode(&lt;"Contacts"&gt;, "&lt;Business Phone&gt;")

</PRE>where &lt;Contacts&gt; is a table name and "&lt;Business Phone&gt;" is a field
containing the phone number.
 
<PRE>Keywords          : kbprg PgmHowTo PgmObj
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
