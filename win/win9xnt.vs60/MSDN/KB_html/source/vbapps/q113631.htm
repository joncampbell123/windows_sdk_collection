

<HTML>
<HEAD>
<TITLE>XL: Shell Function Doesn't Accept Built-in Constants </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113631">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/04/11">
<META NAME="Keywords" CONTENT="kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0 for Windows, it is not possible to use built- in constants, such as xlNormal, xlMinimized, or xlMaximized, for the  windowstyle  argument of the Visual Basic Shell function. This behavior is by design.  MORE INFORMATI...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBIC,QADO,QAY5,QAKJ,QBVP,QABA,QAB9,QDL9,QBWO,QBWN,QAPN,QAH4,QAHE,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Shell Function Doesn't Accept Built-in Constants</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113631</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel version 5.0 for Windows, it is not possible to use built-
in constants, such as xlNormal, xlMinimized, or xlMaximized, for the
"windowstyle" argument of the Visual Basic Shell function. This behavior is
by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Visual Basic Shell function is used to run an executable program from a
Visual Basic subroutine. Here is an example of the Shell function that will
run the Microsoft Windows Notepad program in a normal window with focus:
<P>
<PRE>   RetVal = Shell("c:\windows\notepad.exe", 1)

</PRE>The second argument (in this case, 1) is the windowstyle argument of the
function. Valid windowstyle values are as follows:
<P>
<PRE>   Value     Window Style
   ---------------------------------
   1, 5, 9   Normal with focus
   2         Minimized with focus
   3         Maximized with focus
   4, 8      Normal without focus
   6, 7      Minimized without focus

</PRE>The windowstyle you specify determines how the application's window
will appear when it is started.
<P>
It is not possible to use built-in constants such as xlNormal, xlMinimized,
or xlMaximized in place of the standard numerical values shown here. This
is because the values of the built-in constants are not valid when applied
to the Shell command.
<P>
The values of the various built-in constants that might be expected
to work as windowstyle arguments are as follows:
<P>
<PRE>   Constant      Value
   -------------------
   xlNormal      -4143
   xlMinimized   -4140
   xlMaximized   -4137

</PRE>If you try to use a built-in constant for the windowstyle argument,
you will receive the following error message:
<P>
<PRE>   Run-time error '5':
   Invalid procedure call


</PRE><h3>Steps to Reproduce Behavior</h3>
 
<P>
Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. This Visual Basic procedure
is provided 'as is' and Microsoft does not guarantee that it can be
used in all situations. Microsoft does not support modifications of
this procedure to suit customer requirements for a particular purpose.
Note that a line that is preceded by an apostrophe introduces a
comment in the code--comments are provided to explain what the code is
doing at a particular point in the procedure. Note also that an
underscore character (_) indicates that code continues from one line
to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line
continuation character. For more information about Visual Basic for
Applications programming style, see the "Programming Style in This
Manual" section in the "Document Conventions" section of the "Visual
Basic User's Guide."
<P>
The following examples illustrate proper, and improper, use of the
windowstyle argument in the Shell function.
<P>
<PRE>'----------------------------------------------------------------------
</PRE>Option Explicit
<P>
<PRE>Sub ProperShellFunction()

   'Dimension variables.
   Dim RetVal As Double

   'This Shell function will work because the windowstyle argument is
   'valid (1).
   RetVal = Shell("c:\windows\notepad.exe", 1)
End Sub

Sub ImproperShellFunction()

   'Dimension variables.
   Dim SecondRetVal As Double

   'This Shell function will NOT work because the windowstyle argument
   'is invalid (cannot use this built-in constant in this case).
   SecondRetVal = Shell("c:\windows\notepad.exe", xlNormal)
End Sub
'----------------------------------------------------------------------

</PRE><h2>REFERENCES</h2>
 
<P>
For more information on the Shell function, choose the Search button
in Visual Basic Help and type:
<P>
<PRE>   Shell
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00<BR>
Keywords          : kbprg PgmOthr<BR>
Version           : 5.00 5.00c 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
