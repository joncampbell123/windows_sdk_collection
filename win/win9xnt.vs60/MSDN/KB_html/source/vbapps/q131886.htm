

<HTML>
<HEAD>
<TITLE>ACC: Using Code to Set Control's Colors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131886">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/06/22">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo FmsHowTo FmsProp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article shows you how to create and use two user-defined Visual Basic for Applications Sub procedures that you can use for a control's Enter and Exit events to set and reset...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QBS0,QA7O,QAMN,QAG9,QA1S,QAFF,QBXS,QAPG,QDN9,QA5F,QAMA,QAOE,QAH4,QAUR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using Code to Set Control's Colors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131886</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article shows you how to create and use two user-defined Visual Basic
for Applications Sub procedures that you can use for a control's Enter and
Exit events to set and reset the control's ForeColor and BackColor
properties.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0 or earlier). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create and use the two Visual
Basic Sub procedures to set and reset the LastName control's background and
foreground colors:

<OL><P><LI>Open the sample database Northwind.MDB (or NWIND.MDB in version 2.0).

<P><LI>Create a module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
      Dim SaveForeColor As Single
      Dim SaveBackColor As Single
</PRE><P>
<P><PRE>      Const MyBackColor = 0
      Const MyForeColor = 16777215
</PRE>
<P><LI>Type the following two Sub procedures:
<P>
<PRE>      Sub SetControlColor (MyControl As Control)
      ' ******************************************************************
      ' Sub:     SetControlColor
      '
      ' Purpose: This procedure sets the colors of the referenced control.
      ' ******************************************************************

      On Local Error Resume Next

      ' Save the current control colors.
      SaveBackColor = MyControl.BackColor
      SaveForeColor = MyControl.ForeColor

      ' Set the custom colors.
      MyControl.BackColor = MyBackColor
      MyControl.ForeColor = MyForeColor

      End Sub

      Sub ReSetControlColor (MyControl As Control)
      ' ***********************************************************
      ' Sub: ReSetControlColor
      '
      ' Purpose: This procedure resets the colors of the referenced
      '          control.
      ' ***********************************************************

      On Local Error Resume Next

      ' Reset to the saved colors.
      MyControl.BackColor = SaveBackColor
      MyControl.ForeColor = SaveForeColor

      End Sub

</PRE><P><LI>Save the module as SetColorModule.

<P><LI>Open the Employees form in Design view.

<P><LI>Set the LastName control's OnEnter property to the following event
   procedure:
<P>
<P><PRE>      Private Sub LastName_Enter ()
<PRE></PRE>        Call SetControlColor([LastName])
      End Sub

   NOTE: In version 2.0, there is a space in Last Name.

</PRE><P><LI>Set the LastName control's OnExit property to the following event
   procedure:
<P>
<P><PRE>      Private Sub LastName_Exit (Cancel As Integer)
<PRE></PRE>        Call ReSetControlColor([LastName])
      End Sub

</PRE><P><LI>Save and close the form.
<P>
</OL>To test the results, follow these steps:

<OL><P><LI>Open the Employees form in Form view.

<P><LI>Press the TAB key to move to the LastName control. Note that the
   control's background color changes to black and the control's
   foreground color changes to white.

<P><LI>Press TAB to move to the next control. Note that the original colors
   return to the LastName control.
</OL> 
<PRE>Keywords          : kbusage PgmHowTo FmsHowTo FmsProp
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
