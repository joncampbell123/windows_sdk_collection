

<HTML>
<HEAD>
<TITLE>PRJ: Error Using Command Without Required Arguments </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113272">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1994/03/30">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Project, when you run a macro that contains a command that is missing required arguments, you receive the following error message:     Argument not optional  Additionally, if you assign macro command to a toolbar without required argum...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QBV8,QAPN,QAHE,QAH4,QANE,QA01,QAB4,QA5V,QALM,QBS0,QBVV,QAVI,QANX,QACF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRJ: Error Using Command Without Required Arguments</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113272</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Project 98 for Windows
<LI>Microsoft Project for Windows 95, versions 4.1, 4.1a
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Project for the Macintosh, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Project, when you run a macro that contains a command that is
missing required arguments, you receive the following error message:
<P>
<PRE>   Argument not optional

</PRE>Additionally, if you assign macro command to a toolbar without required
arguments, you receive the following error message:
<P>
<PRE>   Required argument not included

</PRE><h2>CAUSE</h2>
 
<P>
This behavior is by design in Microsoft Project. When you use a command in
a macro, or assign a command to a toolbar button, you must include required
arguments with the command.
<P>
One exception to this rule is a command that displays a dialog box, such as
FileOpen. When you use a command that displays a dialog box, you do not
necessarily need to include arguments, even if they are described as
required in the Visual Basic Reference. If the help topic for the command
states that the command displays a dialog box, you can use the command
without arguments to display the dialog box.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
If you want to prompt a user for input, and use this input as an argument
for a macro command that does not display a dialog box, you can use the
InputBox function to store information from the user as a variable, then
use the variable as the value of the required argument. The following is a
simple example of how to use this method:
<P>
<PRE>   Sub Edit_View()
      ' Dimension variables
      Dim ViewName, ViewTable, ViewFilter As String
      ' Prompt user for view to edit
      ViewName = InputBox("Type name of single-pane view to edit")
      ' Prompt user for table to apply
      ViewTable = InputBox("Type name of table to apply to view")
      ' Prompt user for filter to apply
      ViewFilter = InputBox("Type name of filter to apply to view")
      ViewEditSingle Name:=ViewName, Table:=ViewTable, _
         Filter:=ViewFilter
   End Sub

</PRE>Note that the macro example would need to have error checking procedures to
test for valid user input.
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose. Note that a line that is preceded by
an apostrophe introduces a comment in the code--comments are provided to
explain what the code is doing at a particular point in the procedure. Note
also that an underscore character (_) indicates that code continues from
one line to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line-
continuation character.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you record a macro in Microsoft Project, and you choose an option in a
dialog box that displays another dialog box, the command recorded usually
does not display that second dialog box. There are some commands that are
"non- interactive" meaning they are designed only to record complex dialog
boxes, but there is no command to display them directly.
<P>
For example, if you turn on the macro recorder and edit a filter, by first
displaying the More Filters dialog box, then choosing Edit to display the
Filter Definition dialog box, the EditFilter command is recorded with all
of the EditFilter arguments. If you use the EditFilter command by itself in
a macro however, you receive the error message described above because the
EditFilter command does not display a dialog box.
<P>
On the other hand, if you turn on the macro recorder and open a file, by
displaying the Open dialog box, the FileOpen command is recorded with each
of the parameters following the command. If you use the FileOpen command in
a macro without any arguments, the FileOpen dialog box is displayed.
<P>
For a list of the arguments required for a specific command when you use
the command in a macro, select the command in the macro you are editing and
press F1. The help topic for that command appears, with a description of
all arguments and the word Optional or Required.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In a new project, hold down the CTRL key, and click the Standard
   Toolbar.

<P><LI>In the Customize Tool dialog box, select GanttBarStyleEdit from the
   Command list. Choose OK.
<P>
   The following error message appears:
<P>
<P><PRE>      Required argument not included
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 vbappcode<BR>
Keywords          : kbcode kbprg<BR>
Version           : 4.0 4.1 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
