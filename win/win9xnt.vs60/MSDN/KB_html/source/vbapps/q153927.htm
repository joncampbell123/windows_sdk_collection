

<HTML>
<HEAD>
<TITLE>HOWTO: Create Pie Charts Using the Circle Method in VB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153927">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1996/07/24">
<META NAME="Keywords" CONTENT="PrgOther VB4ALL VB4WIN vbwin GnrlVb kbgraphic kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The Pinnacle-BPS Graph control shipping with Visual Basic gives users the ability to create pie charts. The Pinnacle-BPS is a relatively large control and uses a large amount of disk space on distribution disks. Therefore, the custom effects availa...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHH,QAK2,QAGI,QBS0,QAPN,QAK4,QAH4,QAFO,QAIF,QA5F,QAFF,QBSO,QDNX,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Create Pie Charts Using the Circle Method in VB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153927</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Pinnacle-BPS Graph control shipping with Visual Basic gives users
the ability to create pie charts. The Pinnacle-BPS is a relatively large
control and uses a large amount of disk space on distribution disks.
Therefore, the custom effects available are limited to the features of the
control. The Circle method in the VBA language provides functionality to
draw arcs and segments. By drawing segments, you can easily create a pie
chart and add custom features as you require. Below is a code sample
demonstrating how to do this.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start a new Visual Basic project. Form1 is created by default.

<P><LI>Place a Command button on the form.

<P><LI>Place a 200x200 pixel Picture box on the form.

<P><LI>Add the following code to the Form1 code window:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Public Sub DrawPiePiece(lColor As Long, fStart As Double, fEnd As
      Double)
<PRE></PRE>        Const PI As Double = 3.14159265359
        Const CircleEnd As Double = -2 * PI
        Dim dStart As Double
        Dim dEnd As Double
        Picture1.FillColor = lColor
        Picture1.FillStyle = 0
        dStart = fStart * (CircleEnd / 100)
        dEnd = fEnd * (CircleEnd / 100)
        Picture1.Circle (100, 100), 60, , dStart, dEnd
      End Sub

      Private Sub Command1_Click()
        Picture1.ScaleMode = vbPixels
        Call DrawPiePiece(QBColor(1), 0.001, 36)
        Call DrawPiePiece(QBColor(2), 36, 55)
        Call DrawPiePiece(QBColor(3), 55, 75)
        Call DrawPiePiece(QBColor(4), 75, 99.999)
      End Sub

</PRE><P><LI>Press the F5 key to run the project. You should see a pie chart being
   drawn with four sections mirroring the four times that the DrawPiece
   routine was called in the Command1_Click event.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q83906.htm">Q83906</A></B>
   TITLE     : How to Draw an Ellipse with Circle Statement in VB

   ARTICLE-ID: <B><A href="../vbwin/q73280.htm">Q73280</A></B>
   TITLE     : Overflow in VB Drawing Circle Segment w/ Radius of Zero

</PRE></OL>Instead of using the Circle method in the VBA language, you can also use
the Win16/Win32 API Call to achieve the same result.
 
<PRE>Keywords          : PrgOther VB4ALL VB4WIN vbwin GnrlVb kbgraphic kbprg
Technology        : kbvba
Version           : WINDOWS:4.0
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
