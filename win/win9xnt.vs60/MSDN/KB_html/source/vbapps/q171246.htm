

<HTML>
<HEAD>
<TITLE>OL97: Supported Outlook Forms Control Events </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171246">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1997/07/10">
<META NAME="Keywords" CONTENT="kbprg FmsEvnt">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article describes the three events that are supported by a form's fields and controls in Microsoft Outlook 97.  MORE INFORMATION  Microsoft provides programming examples for illustration only, without warranty either expressed or implied, incl...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAO4,QA7O,QAB5,QBVO,QBWS,QBJZ,QDNQ,QAOE,QAMN,QDMZ,QAFF,QAB9,QAYC,QAUJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OL97: Supported Outlook Forms Control Events</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171246</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes the three events that are supported by a form's
fields and controls in Microsoft Outlook 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>Controls in forms in Outlook can perform three types of events:
<P>
<PRE>   Click
   PropertyChange
   CustomPropertyChange

</PRE><h3>The Click Event</h3>
 
<P>
The Click event occurs when the user clicks a form control. You can create
as many Click event procedures as you have controls on a form. The name of
each event procedure is the name of the control (such as "CommandButton1"),
followed by an underscore character (_) and the word "Click." The following
example displays a greeting containing the log on name of the current user
whenever the button named "CommandButton1" is clicked:
<P>
<PRE>   Sub CommandButton1_Click()
      MsgBox "Hello " &amp; Application.GetNameSpace("MAPI").CurrentUser
   End Sub

   NOTE: The Message and Note form controls do not support the Click
   event.

   NOTE: If a control is bound to a field, then the Click event will not
   fire. Instead of using the Click event, you should typically use the
   CustomPropertyChange or PropertyChange event when a control is bound
   to a field.

   For more information about the Click event and bound controls,
   please see the following article in the Microsoft Knowledge Base:

      Article-ID: <B><A href="../vbapps/q166853.htm">Q166853</A></B>
      Title     : OL97: Bound Control Does Not Support Click Event

</PRE><h3>The PropertyChange Event</h3>
 
<P>
The PropertyChange event occurs when one of the item's standard properties
is changed. The property name is passed to the procedure, making it
possible for the procedure to determine which property was changed. The
following example disables setting a reminder for an item:
<P>
<PRE>   Sub Item_PropertyChange(ByVal myPropertyName)
   Select Case myPropertyName
      Case "ReminderSet"
         MsgBox "You cannot set a reminder on this item."
         Item.ReminderSet = False
     Case Else
   End Select
   End Sub

</PRE><h3>The CustomPropertyChange Event</h3>
 
<P>
The CustomPropertyChange event occurs when one of the item's custom
properties is changed. These properties are the user-defined fields
added to the item at design time. The property name is passed to the
procedure, making it possible for the procedure to determine which field
was changed. The following example enables a control when a Boolean field
is set to True.
<P>
<PRE>   Sub Item_CustomPropertyChange(ByVal myPropName)
   Select Case myPropName
      Case "RespondBy"
         Set myPropChg = myItem.GetInspector.ModifiedFormPages
         Set myCtrl = myPropChg("Page 2").Controls("DateToRespond")
         If myItem.UserProperties("RespondBy").Value Then
            myCtrl.Enabled = True
            myCtrl.Backcolor = 1
         Else
            myCtrl.Enabled = False
            myCtrl.Backcolor = 0
         End If
      Case Else
   End Select
   End Sub

</PRE><h3>Adding a Control and an Event to a Custom Form</h3>
 
<P>
To add a control and an event to a custom form, follow these steps:

<OL><P><LI>Open a custom form.

<P><LI>On the Tools menu in the form, click Design Outlook Form.

<P><LI>On the Form menu in Design View, click Control Toolbox.

<P><LI>From the Toolbox, drag the appropriate control to your form.

<P><LI>On the Form menu, click View Code to open the Script Editor.
<P>
</OL>The Script Editor has templates for all the item events. To add an event
template to your script in the Script Editor:

<OL><P><LI>On the Script menu, click Event.

<P><LI>Click an event name in the list, and then click Add. The appropriate
   Sub...End Sub or Function...End Function statement is inserted, with
   its arguments (if any) specified.
<P>
   NOTE: You cannot add Click event procedures by using the Event command
   on the Script menu; you must type the Sub...End Sub statement for those
   procedures from scratch.

<P><LI>When you are finished in the Script Editor, click Close on the File menu
   to return to your form.

<P><LI>On the Tools menu, click Design Outlook Form to switch out of Design
   view.
<P>
   NOTE: If the Script Editor detects an error in your code, it will
   display a message at this point.

<P><LI>On the File menu, click Publish Form As, and then click Publish.

<P><LI>On the File menu, click Close. Do not save changes when prompted.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating solutions with Microsoft Outlook 97,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q166368.htm">Q166368</A></B>
   Title     : OL97: How to Get Help Programming with Outlook

   Article-ID: <B><A href="../vbapps/q170783.htm">Q170783</A></B>
   Title     : OL97: Q&amp;A: Questions about Customizing or
               Programming Outlook
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OutSol OutSol97<BR>
Keywords          : kbprg FmsEvnt<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
