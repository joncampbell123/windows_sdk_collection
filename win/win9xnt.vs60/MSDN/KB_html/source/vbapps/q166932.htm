

<HTML>
<HEAD>
<TITLE>XL97: List Box Doesn't Work Correctly When Workbook Is Hidden </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166932">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/04/15">
<META NAME="Keywords" CONTENT="kbprg kbui kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you display a UserForm that contains a list box in Microsoft Excel 97, the following problems may occur:   - The list box does not display any contents, even though it is linked    to a range of cells on a worksheet in the same workbook.   - T...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QDMR,QAPN,QBVP,QDNZ,QAUJ,QDNM,QAE1 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: List Box Doesn't Work Correctly When Workbook Is Hidden</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166932</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you display a UserForm that contains a list box in Microsoft Excel 97,
the following problems may occur:

<UL><LI>The list box does not display any contents, even though it is linked
   to a range of cells on a worksheet in the same workbook.

<LI>The list box appears to be linked to the correct range of cells, however
   the cells are in another workbook. As a result, the list box displays
   the incorrect contents.
<P>
</UL>Also, when you change the RowSource property of a list box in a UserForm,
you may receive the following error message:
<P>
<PRE>   Could not set the RowSource property. Invalid property value.

</PRE><h2>CAUSE</h2>
 
<P>
These problems occur if the following conditions are true:

<UL><LI>The list box is linked to a range of cells in a closed workbook or in an
   open workbook that has a window that is hidden.
<P>
   -and-

<LI>The RowSource property of the list box refers to the worksheet name and
   a range but does not refer to the workbook name, for example:
<P>
<P><PRE>      Sheet1!A1:A7
</PRE><P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, change the RowSource property for the list box to
include the workbook name, the worksheet name, and the range that is used
by the list box. You can change the RowSource property for a list box by
selecting the list box and then double-clicking RowSource in the Properties
window of the Visual Basic Editor.
<P>
For example, if the RowSource property for a list box is as follows
<P>
<PRE>   Sheet1!A1:A7

</PRE>change the RowSource property to the following
<P>
<PRE>   [&lt;Book1&gt;]Sheet1!A1:A7

</PRE>where &lt;Book1&gt; is the name of the workbook that contains the range of cells.
<P>
NOTE: The workbook to which the list box is linked must be open.
<P>
If you rename the workbook by changing its name in the Save As dialog box,
you must change the RowSource property of each of the list boxes.
Otherwise, the list boxes continue to refer to the original workbook name.
<P>
To prevent this problem from occurring, do not hide the workbook that
contains the range of cells to which the list box is linked. To unhide a
workbook, click Unhide on the Window menu, click the workbook you want to
unhide, and then click OK.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the RowSource property of a list box refers to the following range
<P>
<PRE>   Sheet1!A1:A7

</PRE>the list box refers to the specified range in the workbook only if the
workbook is open and its window is not hidden. Otherwise, the list box uses
the range in Sheet1!A1:A7 that is in another open workbook. In this case,
the list box will contain incorrect data. If no other visible workbook is
open, the list box refers to an invalid range and appears empty.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 forms3<BR>
Keywords          : kbprg kbui kbhowto<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
