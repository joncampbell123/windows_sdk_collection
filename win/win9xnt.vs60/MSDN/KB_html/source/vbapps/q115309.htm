

<HTML>
<HEAD>
<TITLE>XL5 Err Msg: "OLE Automation Method Did Not Return a Value" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115309">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/05/24">
<META NAME="Keywords" CONTENT="IntpOthr kbinterop kbprg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use a Visual Basic application to return the value of a cell on a Microsoft Excel worksheet, using the Value property of the Range object, you receive the following error message if the cell is empty:     OLE Automation Method Did Not Retu...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAB4,QAUD,QBVP,QAKD,QDIJ,QAPN,QAGB,QAEF,QBVV,QAYL,QDNZ,QABH,QABI,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5 Err Msg: "OLE Automation Method Did Not Return a Value"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115309</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use a Visual Basic application to return the value of a cell
on a Microsoft Excel worksheet, using the Value property of the Range
object, you receive the following error message if the cell is empty:
<P>
<PRE>   OLE Automation Method Did Not Return A Value

</PRE><h2>CAUSE</h2>
 
<P>
This error message is displayed because Microsoft Visual Basic does
not understand the value that is returned when you return the value
of an empty cell on a Microsoft Excel worksheet.
<P>
Note that you do not receive an error message when an empty value is
returned in a Microsoft Visual Basic Programming System, Applications
Edition, procedure. This is because Visual Basic, Applications Edition,
has a direct representation of the Empty variant type. You can also
use the IsEmpty() function in Visual Basic, Applications Edition, to
check for an empty cell value.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid receiving this error message when you use a Visual Basic
application to return the value of a cell on a Microsoft Excel
worksheet, use the On Error statement to check for empty cells on the
worksheet as in the following example:
<P>
<PRE>   ' Define xlobj variable as object type
     Dim xlobj as object
   ' Set value of xlobj to worksheet object, first worksheet in BOOK1.XLS
     Set xlobj = GetObject("C:\EXCEL\BOOK1.XLS","Excel.Sheet")
   ' Dimension variable v as variant type
   Dim v as Variant
   ' Dimension variables i and j as integer type
   Dim i as integer
   Dim j as integer
   ' Ignore the error message that appears on blank cells
   On Error Resume Next
   For I = 1 to 5
      For j = 1 to 5
         ' Set variable v equal to value contained in cell
         v = xlobj.Cells(i,j).Value
         ' Check for empty cell, vartype of zero indicates empty value
         If VarType(v) = 0 Then
            ' Enter commands here for case when cell is empty
         Else
            ' Enter commands here for case when cell has something in it.
         End If
      Next
   Next
   Set xlobj = Nothing

</PRE>Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 5.00 err msg<BR>
Keywords          : IntpOthr kbinterop kbprg kbprg<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
