

<HTML>
<HEAD>
<TITLE>OFF97: Macro That Retrieves the Number of Files in a Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165639">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1997/03/24">
<META NAME="Keywords" CONTENT="kbprg PgmFilem PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article includes a sample Microsoft Visual Basic for Applications function that retrieves the total number of files that exist in a specified directory. The article also includes a procedure that demonstrates how to use the function.  MORE INF...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBXB,QATJ,QBBI,QAFI,QAY5,QAWH,QAKC,QAB9,QAG8,QBC6,QBV8,QAH6,QAGI,QADP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Macro That Retrieves the Number of Files in a Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165639</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic for Applications included with:
   - Microsoft Excel 97 for Windows
   - Microsoft PowerPoint 97 for Windows
   - Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article includes a sample Microsoft Visual Basic for Applications
function that retrieves the total number of files that exist in a specified
directory. The article also includes a procedure that demonstrates how to
use the function.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<PRE>'--------------------------------------------------------------
' Procedure       CountAllFiles()
'
' Arguments       strDirName: A string that represents the path
'                 to the directory you want to check.
'
' Returns         The number of files in a specified directory.
'                 If the directory is not valid, the function
'                 returns 0.
'
' Description     This function retrieves the total number
'                 of all files in a specified directory.
'--------------------------------------------------------------
</PRE>Function CountAllFiles(strDirName As String) As Long
<P>
<PRE>   Dim oSearch As FileSearch

   ' Get a reference to the FileSearch object.
   Set oSearch = Application.FileSearch

   With oSearch

      ' Resets the search.
      .NewSearch

      ' Specify the directory that contains the files you want to
      ' count. The variable strDirName is the parameter of the
      ' CountAllFiles() function.
      .LookIn = strDirName

      ' Exclude subfolders.
      .SearchSubFolders = False

      ' Specify what types of files you want to find.
      ' For example, to search for text files change this line to:
      '   .FileName "*.txt"
      .FileName = "*.*"

      'The Execute command begins the search.
      .Execute

      ' Count the number of files in the specified directory.
      CountAllFiles = .FoundFiles.Count

   End With

</PRE>End Function
<P>
<PRE>' The following example calls the CountAllFiles() ' function.

Sub TestCountFiles()

   ' Change this to the directory you want to check.
   Const strMyDirectory As String = "c:\temp"

   ' This holds the total number of files found.
   Dim lFileTotal As Long

   ' Call the function. Pass the directory to check.
   lFileTotal = CountAllFiles(strMyDirectory)

   ' Display the total files found in a message box.
   MsgBox lFileTotal

End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 kbmacro ppt8 vba vbe kbwordvba ppt97 xlvbainfo<BR>
Keywords          : kbprg PgmFilem PgmHowTo<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
