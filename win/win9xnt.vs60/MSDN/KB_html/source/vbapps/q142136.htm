

<HTML>
<HEAD>
<TITLE>XL: Inserting and Formatting Text in Headers and Footers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142136">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/01/04">
<META NAME="Keywords" CONTENT="kbcode kbprg kbualink97 xlprint PgmOthr kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you may want to use a header or footer in a worksheet.  The  More Information  section of this article discusses the formatting  codes that you can use to automatically insert and format text in a header  or footer, and it also ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVP,QAOX,QBJZ,QBS0,QBCI,QATX,QAMB,QADF,QA5V,QAF8,QDNG,QBTP,QBXV,QBXT P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Inserting and Formatting Text in Headers and Footers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142136</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you may want to use a header or footer in a worksheet. 
The "More Information" section of this article discusses the formatting 
codes that you can use to automatically insert and format text in a header 
or footer, and it also contains a sample Microsoft Visual Basic for 
Applications macro (Sub procedure) that you can used to add and format text 
in the header and footer of a worksheet.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE><h3>Formatting Codes for Headers and Footers</h3>
 
<P>
To use multiple lines in a header, use either of the following:

<UL><LI>Use CHR(10) to insert a linefeed character
<LI>Use CHR(13) to insert a return character
<P>
</UL>Note that you cannot record these characters in a macro.
<P>
The following tables contain the format codes that you can use in
headers and footers.
<P>
<PRE>   Codes to format text:
   -------------   -------------------------------------------

   &amp;L              Left-aligns the characters that follow
   &amp;C              Centers the characters that follow
   &amp;R              Right-aligns the characters that follow
   &amp;E              Turns double-underline printing on or off
   &amp;X              Turns superscript printing on or off
   &amp;Y              Turns subscript printing on or off
   &amp;B              Turns bold printing on or off.
   &amp;I              Turns italic printing on or off.
   &amp;U              Turns underline printing on or off.
   &amp;S              Turns strikethrough printing on or off.
   &amp;O              Turns outline printing on or off (Macintosh only).
   &amp;H              Turns shadow printing on or off (Macintosh only).
   &amp;"fontname"     Prints the characters that follow in the specified
                   font.
                   Be sure to include the quotation marks around the
                   font name.
   &amp;nn             Prints the characters that follow in the specified
                   font size. Use a two-digit number to specify a size
                   in points.

</PRE>Codes to insert specific data:
<P>
<PRE>   Use this code  To do this
   --------------------------------------------------------

   &amp;D           Prints the current date.
   &amp;T           Prints the current time.
   &amp;F           Prints the name of the document.
   &amp;A           Prints the name of the workbook tab (the "sheet name").
   &amp;P           Prints the page number.
   &amp;P+number    Prints the page number plus number.
   &amp;P-number    Prints the page number minus number.
   &amp;&amp;           Prints a single ampersand.
   &amp;N           Prints the total number of pages in the document.

</PRE><h3>Sample Visual Basic Procedure</h3>
 
<P>
Note that the following code samples assume that the list has a header
row starting in cell A1 and data starting in A2. Note also that the "~"
indicates a step to be performed on each line of the loop, or at a
specified time.
<P>
Use the following steps to create a sample macro that uses some of the
formatting codes:

<OL><P><LI>Open a new workbook.

<P><LI>Insert a module sheet into the workbook. In Microsoft Excel 97,
   point to Macro on the Tools menu, and click Visual Basic Editor. In
   the Visual Basic Editor, click Module on the Insert menu. In
   Microsoft Excel 7.0, point to Macro on the Insert menu and click
   Module.

<P><LI>Type the following macro on the module sheet:
<P>
<PRE>      Sub Format_Codes()

         'The line below will print the words "header text" underlined
         'and in font size 24. Even though the CenterHeader is
         'indicated, the "&amp;L" will force it to the left.

         ActiveSheet.PageSetup.CenterHeader = "&amp;L&amp;U&amp;24header text"

         'This line of code will format the words, "my text", in the
         'font Arial and use Bold. Notice that each piece is enclosed in
         'quotation marks.

         ActiveSheet.PageSetup.RightHeader = "&amp;""arial,bold""my text"

         'To get more than one line, concatenate the linefeed or return
         'character into the string.

         ActiveSheet.PageSetup.CenterHeader = "First line" &amp; Chr(13) &amp; _
            "Second line"

         'The following will put the current date in the left footer,
         'the file name in the center footer and the number of pages and
         'the total number of pages in the right footer.  The last uses
         'simple concatenation to achieve the desired result.

         With ActiveSheet.PageSetup
           .LeftFooter = "&amp;D"
           .CenterFooter = "&amp;F"
           .RightFooter = "Page " &amp; "&amp;P" &amp; " of " &amp; "&amp;N"
         End With

      End Sub

    NOTE: To type a format code, enclose it in quotation marks. To use
    the format code for font type, enclose the name in two sets of
    quotation marks (for example, type ""Arial""). You can also format
    user-supplied text.

</PRE><P><LI>Return to Sheet1 and run the Format_Codes macro created in step 3.

<P><LI>To view the results, click the Print Preview button on the Standard
   toolbar, or click Print Preview on the File menu.
<P>
</OL>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q141578.htm">Q141578</A></B>
   TITLE     : How to Display Quotation Marks in Function Results and
               Macros

</PRE></OL><h2>REFERENCES</h2>
 
<P>
In Microsoft Excel 7.0, for more information about formatting codes,
click the Index tab in Microsoft Excel Help, type the following text
<P>
<PRE>   headers

</PRE>and then double-click the selected text to go to the "Formatting Codes
for Headers and Footers" topic.
<P>
For more information about Formatting Codes for Headers and Footers,
click Answer Wizard on the Help menu and type:
<P>
<PRE>   format header footer
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 97 xl97 8.00<BR>
Keywords          : kbcode kbprg kbualink97 xlprint PgmOthr kbfaq<BR>
Version           : WINDOWS: 5.0, 5.0c, 7.0, 97; MACINTOSH: 5.0, 5.0a, 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
