

<HTML>
<HEAD>
<TITLE>ACC97: TransferDatabase Causes Page Fault If Object Exists </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160875">
<META NAME="KBModify" CONTENT="1997/09/05">
<META NAME="KBCreate" CONTENT="1996/12/11">
<META NAME="Keywords" CONTENT="kberrmsg kbprg OtpOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use TransferDatabase to copy an object to a target database, you may receive the following error message if the target database already contains the same type of object ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDKY,QAPN,QAB4,QDN9,QAZV,QAH4,QAVX,QBS0,QAW6,QAVW,QAUR,QAY5,QAPF,QABI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: TransferDatabase Causes Page Fault If Object Exists</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160875</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use TransferDatabase to copy an object to a target database, you
may receive the following error message if the target database already
contains the same type of object with the same name:
<P>
<PRE>   Object invalid or no longer set.

</PRE>That message is followed by an invalid page fault which causes Microsoft
Access to shut down:
<P>
<PRE>   MSACCESS caused an invalid page fault in module MSJET35.DLL

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the error, test for the existence of the object in the
target database and delete it before you use TransferDatabase, as in the
following example:

<OL><P><LI>Create a copy of the sample database Northwind.mdb as Northwind2.mdb.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<P><PRE>      Public Function TransferObject(Filename As String, _
<PRE></PRE>                                     objType As Integer, _
                                     objName As String)
         On Error GoTo TransferObject_Err
         Dim accObj As New Access.Application
         accObj.OpenCurrentDatabase Filename
         accObj.DoCmd.DeleteObject objType, objName
         accObj.CloseCurrentDatabase
         Set accObj = Nothing
         DoCmd.TransferDatabase acExport, _
                                 "Microsoft Access", _
                                 Filename, _
                                 objType, objName, objName, False
         MsgBox "Transferred Object: " &amp; objName &amp; _
                " to database file " &amp;  Filename, _
                vbInformation, "Test"
      TransferObject_End:
         Exit Function
      TransferObject_Err:
         MsgBox Err.Description, vbCritical, "Test"
         Resume TransferObject_End
      End Function

</PRE><P><LI>Save the module as TestXfer and close it.

<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
   NOTE: Type the full path and file name for Northwind2.mdb as the first
   parameter in the following function.
<P>
<P><PRE>       ?TransferObject("Northwind2.mdb", acForm, "Orders")
</PRE><P>
   Note that when the transfer is complete, you receive the message:
<P>
<P><PRE>      Transferred Object: Orders to database file Northwind2.mdb
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
We are researching this problem and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<P><h3>Using a Visual Basic Procedure</h3>
 
<P>
WARNING: Following these steps will cause an invalid page fault on your
computer. Make sure you save and close any open work on your computer
before following these steps.

<OL><P><LI>Create a copy of the sample database Northwind.mdb as Northwind2.mdb.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure.
<P>
   NOTE: Type the full path and file name for Northwind2.mdb in the
   Database Name argument of the TransferDatabase method in this example.
<P>
<P><PRE>      Function XferError()
<PRE></PRE>         DoCmd.TransferDatabase acExport, "Microsoft Access", _
              "Northwind2.mdb", acForm, "Orders", "Orders", False
      End Function

</PRE><P><LI>Save the module as Module1 and close it.

<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>      ?XferError()
</PRE><P>
   Note that you may need to execute the function twice to produce invalid
   page fault error.
<P>
</OL><h3>Using a Macro</h3>
 
<P>
WARNING: Following these steps will cause an invalid page fault on your
computer. Make sure you save and close any open work on your computer
before following these steps.

<OL><P><LI>Create a copy of the sample database Northwind.mdb as Northwind2.mdb.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new macro.
<P>
   NOTE: Type the full path and file name for Northwind2.mdb in the
   Database Name argument of the TransferDatabase action in this example.
<P>
<PRE>      Macro: XferError       Action
      --------------------------------------
                            TransferDatabase

      XferError Actions
      ----------------------------------
      TransferDatabase
         Transfer Type: Export
         Database Type: Microsoft Access
         Database Name: Northwind2.mdb
         Object Type: Form
         Source: Orders
         Destination: Orders
         Structure Only: No

</PRE><P><LI>Save the XferError macro and close it.

<P><LI>Run the macro. You may need to run the macro twice to produce the
   following error message:
<P>
<P><PRE>      Object Invalid or no longer set.
</PRE><P>
   When you click OK in response to the error message, you receive the
   invalid page fault error.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about TransferDatabase, search the Help Index for
"TransferDatabase method" or "TransferDatabase action," or ask the
Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: IPF OutputTo xfer GPF<BR>
Keywords          : kberrmsg kbprg OtpOthr<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
