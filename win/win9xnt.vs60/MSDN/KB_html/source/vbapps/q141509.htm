

<HTML>
<HEAD>
<TITLE>XL: Macro to Append Text from One Text File to Another </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141509">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/12/19">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The  More Information  section of this article contains sample Microsoft  Visual Basic for Applications macros (Sub procedures) that you can use to  append the contents of one text file to another.  MORE INFORMATION  Microsoft provides programming ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QBVP,QBS0,QBN0,QAH4,QAYY,QATX,QAMB,QBWS,QA5V,QAK6,QAB9,QDL9,QBWQ,QBWO P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Macro to Append Text from One Text File to Another</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141509</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "More Information" section of this article contains sample Microsoft 
Visual Basic for Applications macros (Sub procedures) that you can use to 
append the contents of one text file to another.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>In the following macro examples, the AppendFiles1 and AppendFiles2 macros
take the data from one text file, Source.txt, and append it to the data in
the Dest.txt text file.
<P>
To set up the example, use a text editor such as Windows Notepad to create
the following text files.
<P>
The Dest.txt file should contain the following information:
<P>
<PRE>   Last Name, First Name, Address, City, State, Zip Code
   John,Smith,1 Main St.,Seattle,WA,12345
   Jane,Doe,2 East Rd,Charlotte,NC,52631
   Tom,Jones,3 West Cir.,Tuscon,AZ,36258

</PRE>The Source.txt file should contain the following information:
<P>
<PRE>   Bill,Adams,6 Elm Ln.,Seattle,WA,85692
   Sue,Thompson,33 Maple Ct.,Las Colinas,TX,58692
   Jerry,Brown,32 Main Rd.,Tuscon,AZ,96524
   Pamela,Smith,88 Rain Rd.,Charlotte,NC,89526

</PRE><h3>Method 1</h3>
 
<P>
Use file input and output (file I/O) commands in a Visual Basic macro.
<P>
The following macro demonstrates how you can use the Open, Line Input, and
Print statements to read data from one text file and append it to another.
<P>
<PRE>   Sub AppendFiles1()

      Dim SourceNum As Integer
      Dim DestNum As Integer
      Dim Temp As String

      ' If an error occurs, close the files and end the macro.
      On Error GoTo ErrHandler

      ' Open the destination text file.
      DestNum = FreeFile()
      Open "DEST.TXT" For Append As DestNum

      ' Open the source text file.
      SourceNum = FreeFile()
      Open "SOURCE.TXT" For Input As SourceNum

      ' Include the following line if the first line of the source
      ' file is a header row that you do now want to append to the
      ' destination file:
      ' Line Input #SourceNum, Temp

      ' Read each line of the source file and append it to the
      ' destination file.
      Do While Not EOF(SourceNum)
         Line Input #SourceNum, Temp
         Print #DestNum, Temp
      Loop

   CloseFiles:

      ' Close the destination file and the source file.
      Close #DestNum
      Close #SourceNum
      Exit Sub

   ErrHandler:
      MsgBox "Error # " &amp; Err &amp; ": " &amp; Error(Err)
      Resume CloseFiles

   End Sub

</PRE><h3>Method 2</h3>
 
<P>
Use the MS-DOS "copy" command. This method applies only to Microsoft Excel
for Windows or Windows 95.
<P>
The following example runs the MS-DOS "copy" command to append two text
files.
<P>
<PRE>   Sub AppendFiles2()

      ' Run the DOS Copy command to append the text files.
      Shell "command.com /c" &amp; _
         "copy c:\dest.txt+c:\source.txt c:\dest.txt /b"

   End Sub

</PRE>NOTE: When you use the Shell command to execute a command in the command
interpreter (Command.com), use the /c switch followed by the command. The
/b switch can be used with the Copy command to indicate that an end-of-file
character should not be added to the destination file.
<P>
After you run either macro, Dest.txt should resemble the following:
<P>
<PRE>   Last Name, First Name, Address, City, State, Zip Code
   John,Smith,1 Main St.,Seattle,WA,12345
   Jane,Doe,2 East Rd,Charlotte,NC,52631
   Tom,Jones,3 West Cir.,Tuscon,AZ,36258
   Bill,Adams,6 Elm Ln.,Seattle,WA,85692
   Sue,Thompson,33 Maple Ct.,Las Colinas,TX,58692
   Jerry,Brown,32 Main Rd.,Tuscon,AZ,96524
   Pamela,Smith,88 Rain Rd.,Charlotte,NC,89526

</PRE><h2>REFERENCES</h2>
 
<P>
In Microsoft Excel for Windows 95 version 7.0, for more information about
writing data to files, click the Index tab in Microsoft Excel Help, type
the following text
<P>
<PRE>   Files, Writing Data

</PRE>and then double-click the selected text to go to the "Writing Data to
Files" topic.
<P>
In Microsoft Excel 5.0, for more information about "Writing Data to Files"
choose the Search button in Help, and type:
<P>
<PRE>   Writing Data

</PRE>Choose the Show Topics button, select the topic, and choose Go To.
<P>
For additional information about getting help with Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 5.00 5.00a 5.00c
<P>

Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS: 5.0,5.0c,7.0,97; MACINTOSH: 5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
