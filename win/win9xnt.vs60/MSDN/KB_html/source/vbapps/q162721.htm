

<HTML>
<HEAD>
<TITLE>XL97: VBA Macro Behavior Is Different from MS Excel 5.0 or 7.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162721">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/27">
<META NAME="Keywords" CONTENT="kbprg kbprb kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT=" When you run a Visual Basic for Applications macro in Microsoft Excel 97, the way the macro behaves may be different from the way it behaves in earlier versions of Microsoft Excel. This may be true for any of the following reasons:   - The architect...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAMB,QAH4,QBS0,QDO5,QAPN,QAAP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: VBA Macro Behavior Is Different from MS Excel 5.0 or 7.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162721</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
When you run a Visual Basic for Applications macro in Microsoft Excel 97,
the way the macro behaves may be different from the way it behaves in
earlier versions of Microsoft Excel. This may be true for any of the
following reasons:

<UL><LI>The architecture of Microsoft Excel 97 is somewhat different from the
   architecture that is used in earlier versions of Microsoft Excel. Some
   elements (for example, menu bars and toolbars) are greatly enhanced in
   Microsoft Excel 97. As a result, Visual Basic code that interacts with
   these elements may work differently.

<LI>Microsoft Excel 97 corrects some problems that are present in earlier
   versions of Microsoft Excel. As a result, Visual Basic code that works
   in earlier versions of Microsoft Excel may work differently in
   Microsoft Excel 97.

<LI>Because all of the Microsoft Office programs include Microsoft Visual
   Basic for Applications, the Visual Basic environment in Microsoft Excel
   includes changes that accommodate the new programs and provide
   consistent behavior in all programs. As a result, code that uses OLE
   Automation or other cross-product functionality may work differently in
   Microsoft Excel 97.
<P>
</UL>Microsoft realizes the importance of minimizing the amount of effort that
is required to use macros in Microsoft Excel 97. Microsoft Excel 97 is
designed to be compatible with earlier versions of Microsoft Excel;
however, in some cases, it may be necessary to modify your code so that it
works in Microsoft Excel 97.
<P>
Modifying your code so that it works with Microsoft Excel 97 usually
requires making only a few minor changes. The following is a list of
articles in the Microsoft Knowledge Base that address compatibility issues
in Microsoft Excel 97. Wherever possible, the articles contain the
information you need to modify Visual Basic macros so that they function in
both Microsoft Excel 97 and in earlier versions of Microsoft Excel.
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q143452.htm">Q143452</A></B>
   TITLE     : XL97: MS Excel Hangs When You Programmatically Save a
               Workbook

   ARTICLE-ID: <B><A href="../vbapps/q143453.htm">Q143453</A></B>
   TITLE     : XL: Named Arguments Are Not Supported with DAO

   ARTICLE-ID: <B><A href="../vbapps/q143458.htm">Q143458</A></B>
   TITLE     : XL97: Cannot Move or Copy Sheet After Last Sheet

   ARTICLE-ID: <B><A href="../vbapps/q143460.htm">Q143460</A></B>
   TITLE     : XL97: Overflow Error Occurs When Using Err Object

   ARTICLE-ID: <B><A href="../vbapps/q143461.htm">Q143461</A></B>
   TITLE     : XL97: CreateObject and GetObject Work Differently

   ARTICLE-ID: <B><A href="../vbapps/q154873.htm">Q154873</A></B>
   TITLE     : XL: Error When You Concatenate String and Numeric Values

   ARTICLE-ID: <B><A href="../vbapps/q156879.htm">Q156879</A></B>
   TITLE     : XL97: Visual Basic Modules Cannot Be Hidden or Protected

   ARTICLE-ID: <B><A href="../vbapps/q156880.htm">Q156880</A></B>
   TITLE     : XL97: Using the MenuBars Method in Microsoft Excel 97

   ARTICLE-ID: <B><A href="../excel/q157027.htm">Q157027</A></B>
   TITLE     : XL97: Attached Toolbar Is Not Saved in 5.0/95 File Format

   ARTICLE-ID: <B><A href="../vbapps/q157103.htm">Q157103</A></B>
   TITLE     : XL97: Macro Stops Running When its Workbook is Closed

   ARTICLE-ID: <B><A href="../vbapps/q157107.htm">Q157107</A></B>
   TITLE     : XL97: "Type Mismatch" Comparing String Variable to
               Boolean

   ARTICLE-ID: <B><A href="../excel/q157108.htm">Q157108</A></B>
   TITLE     : XL97: Options not Available in Macro Options Dialog Box

   ARTICLE-ID: <B><A href="../vbapps/q157113.htm">Q157113</A></B>
   TITLE     : XL97: "Invalid Use of Null" Error Setting OnRepeat Method

   ARTICLE-ID: <B><A href="../vbapps/q157124.htm">Q157124</A></B>
   TITLE     : XL97: Styles("X").Parent Different in MS Excel 97

   ARTICLE-ID: <B><A href="../vbapps/q157203.htm">Q157203</A></B>
   TITLE     : XL97: Cannot Add Macros to the Tools Menu

   ARTICLE-ID: <B><A href="../vbapps/q157308.htm">Q157308</A></B>
   TITLE     : XL97: Calling RunAutoMacros Method More than Once Fails

   ARTICLE-ID: <B><A href="../vbapps/q157351.htm">Q157351</A></B>
   TITLE     : XL97: Compile Error Passing ParamArray

   ARTICLE-ID: <B><A href="../vbapps/q157412.htm">Q157412</A></B>
   TITLE     : XL97: Select Method May Select More Cells Than Expected

   ARTICLE-ID: <B><A href="../vbapps/q157436.htm">Q157436</A></B>
   TITLE     : DAO 3.0 CopyFromRecordSet Method Not Compatible With XL97

   ARTICLE-ID: <B><A href="../vbapps/q157471.htm">Q157471</A></B>
   TITLE     : XL97: Run-Time Error Using CreateObject With DAO.DBEngine

   ARTICLE-ID: <B><A href="../office/q157553.htm">Q157553</A></B>
   TITLE     : XL97: Dialog Boxes and UserForms Use Tahoma Font

   ARTICLE-ID: <B><A href="../vbapps/q157754.htm">Q157754</A></B>
   TITLE     : XL97: Problems When Disabling/Enabling Menus in MS Excel
               97

   ARTICLE-ID: <B><A href="../vbapps/q157755.htm">Q157755</A></B>
   TITLE     : XL97: Using "Checked", "Gray", and "Unchecked" in Macros

   ARTICLE-ID: <B><A href="../vbapps/q158066.htm">Q158066</A></B>
   TITLE     : XL97: Reference to DAO 3.0 Changes to DAO 3.5 When File
               Opened

   ARTICLE-ID: <B><A href="../vbapps/q158072.htm">Q158072</A></B>
   TITLE     : XL97: Menu Added in Wrong Position on Menu Bar

   ARTICLE-ID: <B><A href="../vbapps/q158080.htm">Q158080</A></B>
   TITLE     : XL97: Cannot Paste Array Formula in its Original Cell

   ARTICLE-ID: <B><A href="../vbapps/q158222.htm">Q158222</A></B>
   TITLE     : XL97: ParamArrays are Always Zero-Based

   ARTICLE-ID: <B><A href="../vbapps/q158353.htm">Q158353</A></B>
   TITLE     : XL97: Error When Invalid Characters in Drawing Object
               Name

   ARTICLE-ID: <B><A href="../vbapps/q158355.htm">Q158355</A></B>
   TITLE     : XL97: ParamArray Must be Declared as an Array of Variant

   ARTICLE-ID: <B><A href="../vbapps/q158360.htm">Q158360</A></B>
   TITLE     : XL97: PasteSpecial Method Activates Target Sheet

   ARTICLE-ID: <B><A href="../vbapps/q158434.htm">Q158434</A></B>
   TITLE     : XL97: Cannot Make Changes to Some Shortcut Menus

   ARTICLE-ID: <B><A href="../vbapps/q158472.htm">Q158472</A></B>
   TITLE     : XL97: No Automatic Type Coercion Between Variable Types

   ARTICLE-ID: <B><A href="../vbapps/q158550.htm">Q158550</A></B>
   TITLE     : XL97: Problems Disabling and Enabling Shortcut Menus

   ARTICLE-ID: <B><A href="../vbapps/q158632.htm">Q158632</A></B>
   TITLE     : XL97: Limitations for Naming Visual Basic Modules

   ARTICLE-ID: <B><A href="../vbapps/q158638.htm">Q158638</A></B>
   TITLE     : XL97: ApplyNames Method May Cause Invalid Page Fault

   ARTICLE-ID: <B><A href="../vbapps/q158711.htm">Q158711</A></B>
   TITLE     : XL97: Cannot Edit Text Box with Unlocked Text

   ARTICLE-ID: <B><A href="../vbapps/q158746.htm">Q158746</A></B>
   TITLE     : XL97: Error When Passing an Array Value Between Macros

   ARTICLE-ID: <B><A href="../excel/q158801.htm">Q158801</A></B>
   TITLE     : XL97: Text is Truncated in a Text Box with Rounded
               Corners

   ARTICLE-ID: <B><A href="../vbapps/q158895.htm">Q158895</A></B>
   TITLE     : XL97: Invalid Page Fault After Closing Last Open Workbook

   ARTICLE-ID: <B><A href="../vbapps/q158905.htm">Q158905</A></B>
   TITLE     : XL97: "Bad DLL Calling Convention" When Running a Macro

   ARTICLE-ID: <B><A href="../vbapps/q158997.htm">Q158997</A></B>
   TITLE     : XL97: Error When Variable Refers to Deleted or Moved
               Sheet

   ARTICLE-ID: <B><A href="../vbapps/q159465.htm">Q159465</A></B>
   TITLE     : XL97: "Module not Found" Error Opening Workbook

   ARTICLE-ID: <B><A href="../excel/q159622.htm">Q159622</A></B>
   TITLE     : XL97: Cannot Change Value for Form Control on Worksheet

   ARTICLE-ID: <B><A href="../vbapps/q159794.htm">Q159794</A></B>
   TITLE     : XL97: Cannot Programmatically Close Referenced Workbook

   ARTICLE-ID: <B><A href="../vbapps/q159845.htm">Q159845</A></B>
   TITLE     : XL97: Parentheses Around Object May Dereference the
               Object

   ARTICLE-ID: <B><A href="../vbapps/q159861.htm">Q159861</A></B>
   TITLE     : XL97: Setting Window Caption Changes Caption for Active
               Window

   ARTICLE-ID: <B><A href="../excel/q159877.htm">Q159877</A></B>
   TITLE     : XL97: Crash Saving Workbook If Module Name Contains Equal
               Sign

   ARTICLE-ID: <B><A href="../excel/q159914.htm">Q159914</A></B>
   TITLE     : XL97: Bitmap Image Shrinks When Pasted to Toolbar Button

   ARTICLE-ID: <B><A href="../vbapps/q159915.htm">Q159915</A></B>
   TITLE     : XL97: Deleting Cells While In a For Each Loop

   ARTICLE-ID: <B><A href="../vbapps/q159922.htm">Q159922</A></B>
   TITLE     : XL97: Using Quit Method May Cause Illegal Operation

   ARTICLE-ID: <B><A href="../vbapps/q159938.htm">Q159938</A></B>
   TITLE     : XL97: Structure and Windows Arguments of Protect Method

   ARTICLE-ID: <B><A href="../vbapps/q159944.htm">Q159944</A></B>
   TITLE     : XL97: Range.PasteSpecial Changes Selection

   ARTICLE-ID: <B><A href="../vbapps/q159947.htm">Q159947</A></B>
   TITLE     : XL97: Illegal Operation Unhiding a Row with a Macro

   ARTICLE-ID: <B><A href="../vbapps/q159949.htm">Q159949</A></B>
   TITLE     : XL97: Input # Statement Does Not Retain Trailing Spaces

   ARTICLE-ID: <B><A href="../vbapps/q159957.htm">Q159957</A></B>
   TITLE     : XL97: Run-time Error '1004' Accessing Locally Defined
               Name

   ARTICLE-ID: <B><A href="../excel/q159958.htm">Q159958</A></B>
   TITLE     : XL97: Unexpected Results Paste Linking Noncontiguous
               Range

   ARTICLE-ID: <B><A href="../vbapps/q159960.htm">Q159960</A></B>
   TITLE     : XL: Drawing Objects Behave Differently when Clicked

   ARTICLE-ID: <B><A href="../vbapps/q159964.htm">Q159964</A></B>
   TITLE     : XL97: Pointer is an Hourglass When You Display a
               Message Box

   ARTICLE-ID: <B><A href="../vbapps/q159966.htm">Q159966</A></B>
   TITLE     : XL97: Redraw Problem Changing Visibility of Object on
               Dialog

   ARTICLE-ID: <B><A href="../vbapps/q160032.htm">Q160032</A></B>
   TITLE     : XL97: Invalid Page Fault Saving a Workbook or Add-In

   ARTICLE-ID: <B><A href="../vbapps/q160058.htm">Q160058</A></B>
   TITLE     : XL97: Error Changing Order of Option Buttons on a
               Dialog Sheet

   ARTICLE-ID: <B><A href="../vbapps/q160085.htm">Q160085</A></B>
   TITLE     : XL97: Page Fault Accessing Demand-Loaded Add-in

   ARTICLE-ID: <B><A href="../vbapps/q160462.htm">Q160462</A></B>
   TITLE     : XL97: Auto_Close Macros Run When you use Application.Quit

   ARTICLE-ID: <B><A href="../vbapps/q160520.htm">Q160520</A></B>
   TITLE     : XL97: Error Adding or Deleting a Menu Command in a Macro

   ARTICLE-ID: <B><A href="../excel/q163718.htm">Q163718</A></B>
   TITLE     : XL97: Page Setup Command Does Not Exist in Modules

   ARTICLE-ID: <B><A href="../vbapps/q164500.htm">Q164500</A></B>
   TITLE     : XL97: Help Argument for MsgBox Function Behaves
               Differently

   ARTICLE-ID: <B><A href="../vbapps/q164810.htm">Q164810</A></B>
   TITLE     : XL97: Run-Time Error Using ShowDependents Method

   ARTICLE-ID: <B><A href="../vbapps/q165103.htm">Q165103</A></B>
   TITLE     : XL97: Value Returned by VarType for Omitted Arguments
               Differs

   ARTICLE-ID: <B><A href="../vbapps/q165866.htm">Q165866</A></B>
   TITLE     : XL97: How to Use File DSNs and DSN-less Connections

   ARTICLE-ID: <B><A href="../vbapps/q166101.htm">Q166101</A></B>
   TITLE     : XL97: Visible Property does not Apply to All CommandBars

   ARTICLE-ID: <B><A href="../excel/q167178.htm">Q167178</A></B>
   TITLE     : XL97: Some Properties and Methods Are Missing in Object
               Browser

   ARTICLE-ID: <B><A href="../vbapps/q168364.htm">Q168364</A></B>
   TITLE     : XL97: Charts.Delete Command in Macro May Delete Worksheets

   ARTICLE-ID: <B><A href="../vbapps/q168436.htm">Q168436</A></B>
   TITLE     : XL97: Can't Tile Windows with Macro If a Window Is
               Minimized

   ARTICLE-ID: <B><A href="../vbapps/q168754.htm">Q168754</A></B>
   TITLE     : XL97: Error Applying Comment When Worksheets Are Grouped
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97 macro subroutine code fail error halt<BR>
message convert conversion vba xl97vbmigrate<BR>
Keywords          : kbprg kbprb kbfaq<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
