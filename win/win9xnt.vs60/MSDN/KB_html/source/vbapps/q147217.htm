

<HTML>
<HEAD>
<TITLE>MSQuery: DDE Activate Command Does Not Activate Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147217">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1996/02/21">
<META NAME="Keywords" CONTENT="PgmOthr xlquery xlwin kbcode kbprg kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the Microsoft Query DDE command, Activate, to activate a query window, the window may not be activated.  RESOLUTION  To work around the problem, close out each query window when you are finished working with it and then create a new on...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QAGI,QAH4,QBS0,QBVV,QAYY,QBWS,QAB9,QBUG,QBUF,QAZ2,QAKC,QABI,QBC6,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQuery: DDE Activate Command Does Not Activate Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147217</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows 95, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the Microsoft Query DDE command, Activate, to activate a query
window, the window may not be activated.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, close out each query window when you are
finished working with it and then create a new one with the OPEN command.
The following macro is an example of using this method.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft Product Support Services (PSS) Engineers
can help explain the functionality of a particular macro, they will not
modify these examples to provide added functionality, nor will they help
you construct macros to meet your specific needs. If you have limited
programming experience, you may want to consult one of the Microsoft
Solution Providers. Solution Providers offer a wide range of fee-based
services, including creating custom macros. For more information about
Microsoft Solution Providers, call Microsoft Customer Information Service
at (800) 426-9400.
<P>
To run the macro do the following:

<OL><P><LI>Start Microsoft Query.

<P><LI>Create a data source with the name "NWind" (without the quotation
   marks), using the dBASE files included with Microsoft Excel.

<P><LI>In the workbook that contains the macro code, make sure there are
   two sheets named sheet1 and sheet2.

<P><LI>Type the following procedure:
<P>
<PRE>      Sub Open_And_Close_Windows()
       Dim chan as integer
       Dim NumRows As Variant
       Dim NumCols As Variant

       'Initiate a channel to MSQuery.
       chan = DDEInitiate("MSQuery","System")

       'Log on to the NWind datasource.
       DDEExecute chan, "[Logon('NWind')]"

       'Execute a SQL statement.
       DDEExecute chan,"[Open('Select * From Customer')]"

       'Request the number of rows in the data set.
       NumRows = DDERequest(chan,"NumRows")

       'Request the number of columns in the data.
       NumCols = DDERequest(chan,"NumCols")

       'Return the data to sheet1.
       DDEExecute chan, "[Fetch('Excel', 'Sheet1', 'R1C1:R" _
        &amp; NumRows(1) &amp; "C" &amp; NumCols(1) &amp; "', 'All')]"

       'Close the current query window.
       DDEExecute chan, "[Close()]"

       'Create a new query window.
       DDEexecute chan, "[Open('Select * From Employee')]"

       'Request the number of rows in the data set.
       NumRows = DDERequest(chan,"NumRows")

       'Request the number of columns in the data.
       NumCols = DDERequest(chan,"NumCols")

       'Return the data to sheet2.
       DDEExecute chan, "[Fetch('Excel', 'Sheet2', 'R1C1:R" _
        &amp; NumRows(1) &amp; "C" &amp; NumCols(1) &amp; "', 'All')]"

       'Logoff the datasource.
       DDEExecute chan, "[Logoff('NWind')]"

       'Tterminate the channel.
       DDETerminate chan

      End Sub

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Query User's Guide," version 1.0, Chapter 9, "Using Dynamic Data
Exchange with Microsoft Query"
<P>
For more information about DDE, on the Microsoft Query Help menu, click
Contents and under References, select "DDE Commands."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.00<BR>
Keywords          : PgmOthr xlquery xlwin kbcode kbprg kbtool kbusage<BR>
Version           : 2.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
