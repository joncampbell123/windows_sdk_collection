

<HTML>
<HEAD>
<TITLE>ACC: How to Hide Duplicate Group Header Information on Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158935">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/11/07">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo RptEvent">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to use Visual Basic for Applications to hide duplicate information in successive group headers in a report.  This article assumes that you are famil...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QABO,QBS0,QDN9,QA5F,QAMA,QBJZ,QAH4,QA7O,QA7N,QAUJ,QAGB,QAFO,QAUR,QAJH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Hide Duplicate Group Header Information on Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158935</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to use Visual Basic for Applications to hide
duplicate information in successive group headers in a report.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in version 2.0.
For more information about Access Basic, please refer to the "Building
Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In a sorting and grouping report where each group header can contain
information that may be duplicated from the previous group header, you can
use the following code to hide duplicate information in successive group
headers.
<P>
NOTE: In the following steps, some of the fields have a space in their
names in version 2.0. Replace all occurrences of CategoryName, ProductName
and OrderID with Category Name, Product Name, and Order ID respectively
when recreating this example in version 2.0.

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).

<P><LI>Create the following new select query in Design view based on the
   Categories, Products, and Order Details tables:
<P>
<P><PRE>       Query: qryOrders
       ------------------------
       Field: CategoryName
<PRE></PRE>          Table: Categories
       Field: ProductName
          Table: Products
       Field: OrderID
          Table: Order Details
          Criteria: &lt;10300
       Field: Quantity
          Table: Order Details

</PRE><P><LI>Save the query as qryOrders, and then close it.

<P><LI>Create a new module. In the module Declarations section, declare a
   global variable called DupeHeader:
<P>
<P><PRE>      Global DupeHeader as String
</PRE>
<P><LI>Save the module as basPrint and close it.

<P><LI>Create a new report in Design view based on the qryOrders query.

<P><LI>On the View menu, click Sorting And Grouping.

<P><LI>In the first row of the Sorting And Grouping dialog box, select
   CategoryName in the Field/Expression box.

<P><LI>In the second row of the Sorting And Grouping dialog box, select
   ProductName, and set the GroupHeader property to Yes.

<P><LI>Close the Sorting And Grouping dialog box.

<P><LI>On the View menu, click Field List.

<P><LI>Drag ProductName and CategoryName from the field list to the
<P><PRE>    ProductName Header section of the report.
</PRE>
<P><LI>Drag OrderID and Quantity to the detail section of the report.

<P><LI>On the View menu, click Properties.

<P><LI>Set the OnFormat property of the ProductName header to the following
<P><PRE>    event procedure:
</PRE><P>
<P><PRE>    In Microsoft Access 7.0 and 97:
</PRE><P>
<P><PRE>      Private Sub GroupHeader0_Format(Cancel As Integer, FormatCount _
<PRE></PRE>            As Integer)
      If DupeHeader = Me![CategoryName] Then
         Me![CategoryName].Visible = False
      Else
         Me![CategoryName].Visible = True
      End If
      DupeHeader = Me![CategoryName]
      End Sub

    In Microsoft Access 2.0:

    NOTE: In the following sample code, an underscore (_) at the end of a
    line is used as a line-continuation character. Remove the underscore
    from the end of the line when re-creating this code in Access Basic.

      Sub GroupHeader3_Format(Cancel As Integer, FormatCount _
            As Integer)
      If DupeHeader = Me![Category Name] Then
         Me![Category Name].Visible = False
      Else
         Me![Category Name].Visible = True
      End If
      DupeHeader = Me![Category Name]
      End Sub

</PRE><P><LI>Save the report as rptTest and close it.

<P><LI>Open the report in Print Preview and scroll through it. Any
<P><PRE>    duplication of the CategoryName field in successive ProductName
    Headers will not be visible.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about techniques for report grouping, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q138770.htm">Q138770</A></B>
   TITLE     : ACC: Repeating Group Name at Top of New Column or Page
               95/97

   ARTICLE-ID: <B><A href="../access/q93927.htm">Q93927</A></B>
   TITLE     : ACC2: Repeating Group Name at Top of New Column or Page
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: invisible suppress<BR>
Keywords          : kbprg PgmHowTo RptEvent<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
