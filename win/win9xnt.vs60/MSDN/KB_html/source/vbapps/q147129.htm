

<HTML>
<HEAD>
<TITLE>XL7: #NA Returned When Data put Into Specific Cells via DAO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147129">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1996/02/20">
<META NAME="Keywords" CONTENT="PgmOthr xlwin kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you place data from specific fields or records into a cell on a Microsoft Excel 7.0 worksheet, you may receive  #NA  instead of your data.  CAUSE =====  If you attempt to return data to Microsoft Excel by using data access objects (DAO) by spe...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVP,QAPN,QAYL,QAUD,QANF,QBS0,QA7O,QA7N,QAPF,QDNZ,QBBI,QAYY,QACI,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: #NA Returned When Data put Into Specific Cells via DAO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147129</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you place data from specific fields or records into a cell on a
Microsoft Excel 7.0 worksheet, you may receive "#NA" instead of your data.
<P>
<P><h2>CAUSE</h2>
 
<P>
If you attempt to return data to Microsoft Excel by using data access
objects (DAO) by specifying the cell and field from a recordset as in the
following line of code
<P>
<PRE>   Sheets("Sheet1").Range("A1").Value=Rs("Company")

</PRE>you will receive "#NA" in the cell you specified, instead of the data you
were trying to return.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two methods to work around this behavior:

<UL><LI>You can assign a variable to the field and then assign a cell to the
   variable, as described in Method 1 below.
<P>
   -or-

<LI>You can use the Value property to retrieve the text from the field,
   as described in Method 2 below.
<P>
</UL>NOTE: In order to run this code, you need to have "Microsoft DAO 3.0 Object
Library" selected. To do so, in a Module sheet, click References on
the Tools menu and click to select the "Microsoft DAO 3.0 object library"
option.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft Product Support Services (PSS) Engineers
can help explain the functionality of a particular macro, they will not
modify these examples to provide added functionality, nor will they help
you construct macros to meet your specific needs. If you have limited
programming experience, you may want to consult one of the Microsoft
Solution Providers. Solution Providers offer a wide range of fee-based
services, including creating custom macros. For more information about
Microsoft Solution Providers, call Microsoft Customer Information Service
at (800) 426-9400.
<P>
<P><h3>Method 1</h3>
 
<P>
This example shows how to assign the contents of the field to a variable,
and then to assign a cell to the variable. This code will place the
"CustomerID" in cell A1 on Sheet1:
<P>
<PRE>   Sub GetTable()
          Dim Db As Database
          Dim Rs As Recordset
          Dim Path As String
      Dim Var1 as String

          Path = "c:\msoffice\access\samples\northwind.mdb"

   Set Db = Workspaces(0).OpenDatabase(Path, ReadOnly:=True, _
          Exclusive:=False)
          Set Rs = Db.OpenRecordset("Customers")
          Rs.MoveFirst
      Var1 = Rs("CustomerID")
          Sheets("Sheet1").Range("A1") = Var1
       Rs.Close
       Db.Close
   End Sub

</PRE><h3>Method 2</h3>
 
<P>
This example shows how to use the Value property of Microsoft Excel to
return the data in the specified field. This code will place the
"CustomerID" in cell A1 on Sheet1.
<P>
<PRE>   Sub GetTable()
          Dim Db As Database
          Dim Rs As Recordset
          Dim Path As String

          Path = "c:\msoffice\access\samples\northwind.mdb"

          Set Db = Workspaces(0).OpenDatabase(Path, ReadOnly:=True, _
   Exclusive:=False)
          Set Rs = Db.OpenRecordset("Customers")
          Rs.MoveFirst
         Sheets("Sheet1").Range("A1") = Rs("CustomerID").Value
         Rs.Close
          Db.Close
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00<BR>
Keywords          : PgmOthr xlwin kbcode kbprg<BR>
Version           : 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
