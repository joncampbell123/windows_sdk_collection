

<HTML>
<HEAD>
<TITLE>XL5: Custom Menu Commands Displayed in Incorrect Order </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115697">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/06/01">
<META NAME="Keywords" CONTENT="kbprg PgmOthr kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the Menu Editor tool to customize your menus, adjacent menus that contain submenu items may not be displayed in the order in which they were created.  STATUS ======  Microsoft has confirmed this to be a problem in the Microsoft product...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QAVI,QBS0,QANS,QBRD,QAG2,QBWS,QA2Q,QAKJ,QAH4,QBXS,QBJZ,QACI,QBWR,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Custom Menu Commands Displayed in Incorrect Order</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115697</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the Menu Editor tool to customize your menus, adjacent menus
that contain submenu items may not be displayed in the order in which they
were created.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do either of the following:

<UL><LI>Put a separator ("-") between the menu commands that contain submenu
   items, or place a menu item that doesn't have submenu items between the
   menu commands that do contain submenu items.
<P>
   -or-

<LI>Use a Visual Basic, Applications Edition, procedure to create the new
   menus (rather than using the Menu Editor).
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 
<P>
To set up the custom menus:

<OL><P><LI>In a new Visual Basic module, choose Menu Editor from the Tools menu.

<P><LI>In the Menu Bars box, choose any menu bar from the list.
<P>
   You should see the name of the menu bar repeated in the Caption box.

<P><LI>Choose the Insert button.
<P>
   A new menu bar is created (New Menu Bar1).

<P><LI>In the Menus box, select (End of menu bar), and choose Insert.

<P><LI>In the Caption box, type "Test Menu" (without the quotation marks) and
   select (End of menu bar).
<P>
</OL>To insert the menu items:

<OL><P><LI>In the Menus Box, select Test Menu.

<P><LI>In the Menu Items box, select (End of menu), and choose the Insert
   button.

<P><LI>In the Caption box, type "Constants" (without the quotation marks), and
   under Menu Items, select (End of menu).

<P><LI>Repeat steps 2 through 3 to create the following additional menu items
   (substitute the following items for the word "Constants" in step 3):
<P>
<P><PRE>      Formulas
      -
      Hello
</PRE><P>
</OL>To insert the submenu items:

<OL><P><LI>Under Menu Items, select Constants, and under Submenu Items,
   select (End of submenu).

<P><LI>Choose Insert.

<P><LI>In the Caption box, type "Errors" without the quotation marks.

<P><LI>Select "(End of submenu)".

<P><LI>Repeat steps 2 through 4 to create the following additional submenu
   items (substitute the following items for the word "Errors" in step 3):
<P>
<P><PRE>      Text
      Numbers
</PRE>
<P><LI>Under Menu Items, select Formulas, and under Submenu Items, select (End
   of submenu).

<P><LI>Repeat steps 2-6 to add submenu items to the Formulas menu.

<P><LI>Choose OK to close the Menu Editor.
<P>
</OL>To display the menus:

<OL><P><LI>On the module sheet, type the following:
<P>
<PRE>      Sub MyMenu()
         MenuBars("New Menu Bar1").Activate
      End Sub

</PRE><P><LI>Choose Macro from the Tools menu.

<P><LI>Select "MyMenu" from the list of macros, and choose Run.
<P>
</OL>The resulting menu items in the Select menu are: Formulas, &lt;separator&gt;,
Hello, Constants. Constants should be first with Formulas directly beneath
it.
<P>
To reset the menu bar to the default module menu bar, create and run the
following macro:
<P>
<PRE>   Sub newmenu()
      MenuBars(xlModule).Activate
   End Sub

</PRE></OL>Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. This Visual Basic procedure
is provided 'as is' and Microsoft does not guarantee that it can be
used in all situations. Microsoft does not support modifications of
this procedure to suit customer requirements for a particular purpose.
Note that a line that is preceded by an apostrophe introduces a
comment in the code--comments are provided to explain what the code is
doing at a particular point in the procedure. Note also that an
underscore character (_) indicates that code continues from one line
to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line-
continuation character. For more information about Visual Basic for
Applications programming style, see the "Programming Style in This
Manual" section in the "Document Conventions" section of the "Visual
Basic User's Guide."
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Visual Basic User's Guide," version 5.0, Chapter 12, "Menus and Toolbars"
<P>
For more information about Menu Editor command (Tools menu), choose
the Search button in Help for Visual Basic and type:
<P>
<PRE>   menu bars
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 editor<BR>
Keywords          : kbprg PgmOthr kbprg<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
