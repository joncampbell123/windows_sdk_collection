

<HTML>
<HEAD>
<TITLE>ACC: Using Automation to Add Appointments to Microsoft Outlook </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160502">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1996/12/04">
<META NAME="Keywords" CONTENT="kbinterop IntpOleA kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes a technique to create appointments in a Microsoft Access database and add them to the Microsoft Outlook calendar using Automation.  For information ab...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QAYC,QA1S,QBDP,QA7O,QA7N,QBS0,QAUJ,QAUR,QAPN,QAP2,QACE,QBV0,QDN9,QAYY P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using Automation to Add Appointments to Microsoft Outlook</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160502</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes a technique to create appointments in a Microsoft
Access database and add them to the Microsoft Outlook calendar using
Automation.
<P>
For information about using Automation to add an appointment to Microsoft
Schedule+ for Windows 95, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q149078.htm">Q149078</A></B>
   TITLE     : ACC: How to Add Appointments to Schedule+ using OLE
               Automation

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create a form and a table to
enter and store appointment information in a Microsoft Access database, and
provides a sample Visual Basic for Applications procedure that uses
Automation to add your appointments to Microsoft Outlook.

<OL><P><LI>Start Microsoft Access and create a new database called Appt.mdb.

<P><LI>Create the following new table in Design view:
<P>
<P><PRE>      Table: tblAppointments
      --------------------------
      Field Name: Appt
<PRE></PRE>         Data Type: Text
         Field Size: 50
         Required: Yes
      Field Name: ApptDate
         Data Type: Date/Time
         Format: Short Date
         Required: Yes
      Field Name: ApptTime
         Data Type: Date/Time
         Format: Medium Time
         Required: Yes
      Field Name: ApptLength
         Data Type: Number
         Field Size: Long Integer
         Default Value: 15
         Required: Yes
      Field Name: ApptNotes
         Data Type: Memo
      Field Name: ApptLocation
         Data Type: Text
         Field Size: 50
      Field Name: ApptReminder
         Data Type: Yes/No
      Field Name: ReminderMinutes
         Data Type: Number
         Field Size: Long Integer
         Default Value: 15
      Field Name: AddedToOutlook
         Data Type: Yes/No

      Table Properties: tblAppointments
      ---------------------------------
      PrimaryKey: ApptDate;ApptTime

   NOTE: In this example, the primary key in the appointment table is the
   appointment date and time. You can remove or alter the primary key if
   you want to be able to add multiple appointments for the same date and
   time.

</PRE><P><LI>Create a reference to the Microsoft Outlook 8.0 Object Library. To do
   so, follow these steps:
<P>
<P><PRE>    a. Create a new module.
</PRE><P>
<P><PRE>    b. On the Tools menu, click References.
</PRE><P>
<P><PRE>    c. Click Microsoft Outlook 8.0 Object Library in the Available
       References box. If that reference does not appear, click Browse
       to locate the Msoutl8.olb file, which is installed by default in the
       C:\Program Files\Microsoft Office\Office folder.
</PRE><P>
<P><PRE>    d. Click OK in the Reference dialog box.
</PRE><P>
<P><PRE>    e. Close the module without saving it.
</PRE>
<P><LI>Use the AutoForm: Columnar Form Wizard to create a new form based on the
   tblAppointments table. Save the form as frmAppointments.

<P><LI>Open the form in Design view and change the following properties:
<P>
<P><PRE>      Form: frmAppointments
      -------------------------
      Caption: Appointment Form
</PRE><P>
<P><PRE>      Form Header:
<PRE></PRE>         Height: .5"
      Check Box: AddedToOutlook
         Enabled: No

</PRE><P><LI>Add a command button to the Form Header section, and set the following
   properties:
<P>
<P><PRE>      Command Button:
<PRE></PRE>         Name: AddAppt
         Caption: Send to Outlook
         OnClick: [Event Procedure]

</PRE><P><LI>Set the OnClick property of the command button to the following event
   procedure:
<P>
<P><PRE>      Private Sub AddAppt_Click()
<PRE></PRE>         On Error GoTo AddAppt_Err
         ' Save record first to be sure required fields are filled.
         DoCmd.RunCommand acCmdSaveRecord
         ' Exit the procedure if appointment has been added to Outlook.
         If Me!AddedToOutlook = True Then
            MsgBox "This appointment already added to Microsoft Outlook"
            Exit Sub
         ' Add a new appointment.
         Else
            Dim outobj As Outlook.Application
            Dim outappt As Outlook.AppointmentItem
            Set outobj = CreateObject("outlook.application")
            Set outappt = outobj.CreateItem(olAppointmentItem)
            With outappt
               .Start = Me!ApptDate &amp; " " &amp; Me!ApptTime
               .Duration = Me!ApptLength
               .Subject = Me!Appt
               If Not IsNull(Me!ApptNotes) Then .Body = Me!ApptNotes
               If Not IsNull(Me!ApptLocation) Then .Location = _
                  Me!ApptLocation
               If Me!ApptReminder Then
                  .ReminderMinutesBeforeStart = Me!ReminderMinutes
                  .ReminderSet = True
               End If
               .Save
            End With
         End If
         ' Release the Outlook object variable.
         Set outobj = Nothing
         ' Set the AddedToOutlook flag, save the record, display a message.
         Me!AddedToOutlook = True
         DoCmd.RunCommand acCmdSaveRecord
         MsgBox "Appointment Added!"
      Exit Sub
      AddAppt_Err:
         MsgBox "Error " &amp; Err.Number &amp; vbCrLf &amp; Err.Description
         Exit Sub
      End Sub

</PRE><P><LI>Save the form and open it in Form view. Add an appointment record, and
   then click the Send To Outlook button. Be sure you only enter minutes,
   not hours and minutes, in the ApptLength field.

<P><LI>Start Microsoft Outlook and click Calendar on the Go menu to view the
   appointments you added.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: integrate meeting OLE OutSol OutSol97<BR>
Keywords          : kbinterop IntpOleA kbfaq<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
