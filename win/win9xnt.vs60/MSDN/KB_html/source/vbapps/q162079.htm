

<HTML>
<HEAD>
<TITLE>XL97: How to Display a Custom Office Assistant Balloon </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162079">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/13">
<META NAME="Keywords" CONTENT="kbcode kbprg kbtool kbualink97 xlvbahowto xlvbainfo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  You can use the Office Assistant to display a custom message (balloon) with the options you specify. The Assistant can display a simple message with buttons or check boxes. You can display several types of buttons (OK, Cancel, Retry, and so on) at ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA0O,QA0P,QAKE,QAH4,QBWS,QAGB,QAD7,QAUR,QBS0,QAGC,QAFF,QBJZ,QABH,QABI,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: How to Display a Custom Office Assistant Balloon</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162079</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use the Office Assistant to display a custom message (balloon) with
the options you specify. The Assistant can display a simple message with
buttons or check boxes. You can display several types of buttons (OK,
Cancel, Retry, and so on) at the bottom of the Assistant.
<P>
This article provides sample macros that customize the Assistant.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE><h3>Creating the Visual Basic Module</h3>
 
<P>
To create a custom message, you must first create a module. To do this,
follow these steps:

<OL><P><LI>Save and close any open workbooks, and then create a new workbook.

<P><LI>Start the Visual Basic Editor (press ALT+F11).

<P><LI>On the Insert menu, click Module.
<P>
</OL><h3>Simple Balloon Macro</h3>
 
<P>
To create a sample balloon, follow these steps:

<OL><P><LI>Type the following code in the module:
<P>
<PRE>      Sub Simple_Balloon()

          ' Create the balloon object.
          Set myballoon= Assistant.NewBalloon

          With myballoon

              .Heading = "My Balloon"
              .Text = "Click OK to close the balloon"
              .Show
          End With

      End Sub

</PRE><P><LI>Run the Simple_Balloon macro.
<P>
   The Office Assistant displays a balloon with the heading "My Balloon" in
   bold letters and a message that prompts you to click OK.

<P><LI>Click OK.
<P>
   The balloon disappears.
<P>
</OL><h3>Balloon with a Numbered List</h3>
 

<OL><P><LI>Type the following code in the module:
<P>
<PRE>      Sub List_Balloon()

          ' Create the balloon object.
          Set myballoon= Assistant.NewBalloon

          With myballoon

              .Heading = "My Balloon"
              .Text = "Click OK to close the balloon."

              ' Text for the list items:
              .Labels(1).Text = "Click Save on the File menu to save " _
                  &amp; "the file."
              .Labels(2).Text = "Click Print on the File menu to " _
                  &amp; "print the file."

              ' Create a numbered list.
              .BalloonType = msoBalloonTypeNumbers

              ' Display the balloon.
              .Show
          End With

      End Sub

   The Office Assistant displays a balloon with a number list.

</PRE><P><LI>Click OK to close the balloon.
<P>
</OL><h3>Balloon with Check Boxes</h3>
 

<OL><P><LI>Type the following code in the module:
<P>
<PRE>      Sub Balloon_Checkboxes()

          ' Create balloon object.
          Set myballoon = Assistant.NewBalloon

          With myballoon
              .Heading = "Regional Sales Data"
              .Text = "Select your region"

              ' Place OK and Cancel buttons at bottom of the balloon.
              .Button = msoButtonSetOkCancel

              For i = 1 To 3
                  .CheckBoxes(i).Text = "Region " &amp; i
              Next

              ' Display the balloon and assign it to x.
              x = .Show

              i = 0
              Select Case x

                  Case -1 'You clicked OK.

                      ' Loop through check boxes on the balloon.
                      For Each y In .CheckBoxes
                          i = i + 1

                          If y.Checked Then
                              MsgBox "region " &amp; i
                          End If
                      Next

                  Case -2 ' You clicked Cancel.

                      MsgBox "You clicked Cancel."
              End Select
          End With
      End Sub

</PRE><P><LI>Run the Balloon_Checkboxes macro.
<P>
   A balloon with three check boxes appears.

<P><LI>Click one or more check boxes, and then click OK.
<P>
   Messages boxes that display your choices appear.
<P>
</OL>If you click Cancel, a message box with a message that indicates you
clicked Cancel appears.
<P>
<P><h3>Multiple Balloons</h3>
 

<OL><P><LI>Type the following code in the module:
<P>
<PRE>      Sub Balloon_Array()

          Dim myBalloonArray(2) As Balloon

          With Assistant
              For i = 1 To 2
                  ' Create a new balloon object.
                  Set myBalloonArray(i) = .NewBalloon
              Next
          End With

          With myBalloonArray(1)
              .Heading = "This is balloon #1."
              .Text = "Click OK to close the balloon."

              ' Display the first balloon.
              .Show
          End With

          With myBalloonArray(2)
              .Heading = "This is balloon #2."
              .Text = "Click OK to close the balloon."

              ' Display the second balloon.
              .Show
          End With

      End Sub

</PRE><P><LI>Run the Balloon_Array macro.
<P>
   The first balloon appears.

<P><LI>Click OK in the balloon.
<P>
   The second balloon appears.

<P><LI>Click OK in the balloon.
<P>
   The second balloon is dismissed.
<P>
</OL><h3>Performing Actions Based on a Selection</h3>
 

<OL><P><LI>Type the following code in the module:
<P>
<PRE>      Sub Balloon_Options()

          ' Create a new balloon object.
          Set balloon1 = Assistant.NewBalloon

          With balloon1
              .Heading = "First Balloon"

              ' Create buttons for the list items.
              .BalloonType = msoBalloonTypeButtons

              .Text = "Click an option or click OK to close the balloon."

              ' Set the text for list items.
              .Labels(1).Text = "Save your file."
              .Labels(2).Text = "Print your file."

              ' Mode must be msoModeModeless in order to use Callback
              ' property.
              .Mode = msoModeModeless

              ' Call the "ProcessOption" macro when a balloon list item is
              ' clicked.
              .Callback = "ProcessOption"

              .Show
          End With

      End Sub

      ' Every procedure specified in the Callback property is
      ' passed three arguments: the balloon that activated the
      ' procedure, the return value of the button the user pressed,
      ' and an integer that uniquely identifies the balloon that
      ' called the procedure.

      Sub ProcessOption(bln As Balloon, ibtn As Long, iPriv As Long)

          ' bln: the name of the balloon that activated the procedure
          ' ibtn: the number of the button clicked in the balloon
          ' iPriv: an integer that uniquely identifies the balloon

          Assistant.Animation = msoAnimationGoodbye

          Select Case ibtn
              Case 1
                  ' Insert your routine here.
                  bln.Close
                  bln.Text = "You chose the Save option."
                  bln.Show
              Case 2
                  ' Insert your routine here.
                  bln.Close
                  bln.Text = "You chose the Print option."
                  bln.Show

              Case Else ' You clicked something other than a list item.
                  bln.Close

          End Select

      End Sub

</PRE><P><LI>Run the Balloon_Options macro.
<P>
   A balloon with two options appears.

<P><LI>Click "Save your file."
<P>
   The balloon reappears, and the text in the balloon is "You chose the
   Save option."

<P><LI>Click "Print your file."
<P>
   The balloon reappears, and the text in the balloon is "You chose the
   Print option."

<P><LI>Click OK to dismiss the balloon.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating custom Office Assistant balloons, click
the Office Assistant while in the Visual Basic Editor, type "balloon",
click Search, and then click to view "Creating and modifying balloons".
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If the Assistant is not able to answer your query, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q176476.htm">Q176476</A></B>
   TITLE     : OFF: Office Assistant Not Answering Visual Basic Questions
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97<BR>
Keywords          : kbcode kbprg kbtool kbualink97 xlvbahowto xlvbainfo<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
