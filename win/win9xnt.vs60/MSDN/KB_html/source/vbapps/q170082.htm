

<HTML>
<HEAD>
<TITLE>XL97: Custom Toolbar Added Above Existing Toolbars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170082">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/06/13">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you display a custom toolbar by using a Visual Basic for Applications macro, and you specify the constant xlTop for the Position property of the toolbar, the toolbar is added above the toolbars that are docked at the top of the Microsoft Excel...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QANS,QAF0,QBOG,QAH4,QAML,QBWS,QBE7,QBE6,QBJZ,QACI,QAKE,QAPN,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Custom Toolbar Added Above Existing Toolbars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170082</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you display a custom toolbar by using a Visual Basic for Applications
macro, and you specify the constant xlTop for the Position property of the
toolbar, the toolbar is added above the toolbars that are docked at the top
of the Microsoft Excel window.
<P>
In earlier versions of Microsoft Excel, if you specify the xlTop constant
for the Position property of a toolbar, the toolbar is added immediately
after he last toolbar that is docked at the top of the Microsoft Excel
window.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To produce the behavior that occurs in earlier versions of Microsoft Excel,
use the CommandBars object to create custom toolbars.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Example</h3>
 
<P>
In the following example, a new toolbar is created by using the CommandBars
object model. The new toolbar is positioned immediately after the last
toolbar docked at the top of the Microsoft Excel window. To use this
example, follow these steps:

<OL><P><LI>Close and save any open workbooks, and then create a new workbook.

<P><LI>Start the Visual Basic Editor (press ALT+F11).

<P><LI>On the Insert menu, click Module.

<P><LI>In the Visual Basic module window, type the following code:
<P>
<PRE>      Sub AddToolbar()

         Dim NewBar As CommandBar
         Dim x As CommandBar, LastBar As CommandBar
         Dim LastRow As Integer

         ' The following loop goes through all toolbars.
         ' to determine which is the last toolbar docked
         ' at the top of the Microsoft Excel window.
         For Each x In Application.CommandBars
            If x.Visible = True And x.Position = msoBarTop Then
               If x.RowIndex &gt; LastRow Then
                  Set LastBar = x
                  LastRow = x.RowIndex
               End If
            End If
         Next x

         ' Create a new toolbar.
         Set NewBar = CommandBars.Add(Name:="NewCmdBar")

         With NewBar
            ' Add a button to the toolbar.
            .Controls.Add Type:=msoControlButton, Id:=270

            ' Dock the toolbar at the top of the Microsoft Excel window.
            .Position = msoBarTop

            ' Set the leftmost position of the toolbar.
            .Left = LastBar.Left + LastBar.Width + 1

            ' Place the toolbar in the correct row.
            .RowIndex = LastRow

            ' Display the toolbar.
            .Visible = True
         End With

      End Sub

</PRE><P><LI>Switch back to Microsoft Excel (press ALT+F11).

<P><LI>Run the AddToolbar subroutine.
<P>
</OL><h3>Creating a Reference to the Library</h3>
 
<P>
Before you run the AddToolbar subroutine, you must reference the Microsoft
Office 8.0 Object Library. To do this, follow these steps:

<OL><P><LI>Click the module sheet.

<P><LI>On the Tools menu, click References.

<P><LI>Click to select the Microsoft Office 8.0 Object Library check box and
   click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating CommandBars, click the Office Assistant
in the Visual Basic Editor, type "commandbars," click Search, and then
click to view "Using command bars."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE></OL> 
<PRE>Version           : WINDOWS:97
Platform          : WINDOWS
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
