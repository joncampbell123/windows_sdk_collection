

<HTML>
<HEAD>
<TITLE>ACC: Fill Record w/Data from Prev. Record Automatically (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136127">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1995/08/31">
<META NAME="Keywords" CONTENT="kbprg FmsHowTo MdlDao">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you are creating new records using a form, you may want to speed the data entry process by having fields in the new record fill automatically with values from the previous r...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBCF,QA7O,QAM3,QA1S,QA7N,QBCE,QBT6,QBV4,QDN9,QAHP,QAY5,QAPF,QAY2,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Fill Record w/Data from Prev. Record Automatically (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136127</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you are creating new records using a form, you may want to speed the
data entry process by having fields in the new record fill automatically
with values from the previous record. This article demonstrates a sample
Visual Basic for Applications function called AutoFillNewRecord() that
enables you to fill selected fields (or all fields) in a new record with
values from the previous record automatically.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, FrmSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and FrmSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q150895.htm">Q150895</A></B>
   TITLE     : ACC95: Microsoft Access Sample Forms Available on MSL

   ARTICLE-ID: <B><A href="../access/q175066.htm">Q175066</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Forms Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
One technique to speed repetitive data entry for the field containing the
insertion point is to press CTRL+APOSTROPHE (') to retrieve the value
from the previous record.
<P>
Another technique is to use the AutoFillNewRecord()function described later
in this article. You can call this function from a form's OnCurrent
property event procedure to fill all the fields in a new record using data
from the previous record. If you want to fill only selected fields, you can
create a text box and set the DefaultValue property with a semicolon-
delimited list of field names to automatically fill, for example:
<P>
<PRE>   Text box:
      Name: AutoFillNewRecordFields
      Visible: No
      DefaultValue: Phone;Company Name;City;State;Zip

</PRE>To create and use the AutoFillNewRecord() function, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations section
   if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function AutoFillNewRecord(F As Form)
<PRE></PRE>         Dim RS As Recordset, C As Control
         Dim FillFields As String, FillAllFields As Integer

         On Error Resume Next

         ' Exit if not on the new record.
         If Not F.NewRecord Then Exit Function

         ' Goto the last record of the form recordset (to autofill form).
         Set RS = F.RecordsetClone
         RS.MoveLast

         ' Exit if you cannot move to the last record (no records).
         If Err &lt;&gt; 0 Then Exit Function

         ' Get the list of fields to autofill.
         FillFields = ";" &amp; F![AutoFillNewRecordFields] &amp; ";"

        ' If there is no criteria field, then set flag indicating ALL
        ' fields should be autofilled.
        FillAllFields = Err &lt;&gt; 0

        F.Painting = False

        ' Visit each field on the form.
        For Each C In F
        ' Fill the field if ALL fields are to be filled OR if the
        ' ...ControlSource field can be found in the FillFields list.
           If FillALLFields Or _
           InStr(FillFields, ";" &amp; (C.Name) &amp; ";") &gt; 0 Then
              C = RS(C.ControlSource)
           End If
        Next

        F.Painting = True

      End Function

</PRE><P><LI>Save and close the module.

<P><LI>Open the Customers form in Design view. Change the form's OnCurrent
   property to read as follows:
<P>
   In Microsoft Access 97
<P>
<P><PRE>      =AutoFillNewRecord([Forms]![Customers])
</PRE><P>
   In Microsoft Access 7.0
<P>
<P><PRE>      =AutoFillNewRecord([Form])
</PRE>
<P><LI>Add a text box to the form, and set the control's properties as follows:
<P>
<P><PRE>      Name: AutoFillNewRecordFields
      Visible: No
      DefaultValue: CompanyName;ContactName;ContactTitle;Address
</PRE><P>
</OL>When you go to a new record, the CompanyName, ContactName, ContactTitle,
and Address fields are filled in automatically. If you want all
fields to automatically be filled in, you can leave the DefaultValue
property blank or omit putting the AutoFillNewRecordFields text box on the
form.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the For Loop, search the Help Index for "For
Each...Next Statement," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: default value tag duplicate copy carry forward keep<BR>
Keywords          : kbprg FmsHowTo MdlDao<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
