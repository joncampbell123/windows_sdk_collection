

<HTML>
<HEAD>
<TITLE>XL: Prompt to Save Workbook After Using GetObject Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115313">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/05/24">
<META NAME="Keywords" CONTENT="IntpOthr kbole kbprg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In a Microsoft Visual Basic application, if you use the GetObject function with a filename to activate a file in Microsoft Excel, you are prompted to save changes to the file when you use the Quit method, even if you have not made any changes to th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAPN,QAUR,QBS0,QAU7,QAGB,QANE,QA9Q,QAB9,QBWS,QBVV,QBMR,QAW6,QBXT,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Prompt to Save Workbook After Using GetObject Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115313</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In a Microsoft Visual Basic application, if you use the GetObject
function with a filename to activate a file in Microsoft Excel, you
are prompted to save changes to the file when you use the Quit
method, even if you have not made any changes to the file.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you use the GetObject function to activate the workbook as an
object linking and embedding (OLE) Automation object, a hidden
instance of Microsoft Excel starts, and the workbook is opened as
hidden. Therefore, because this change has been made to the workbook,
you are prompted to save changes when you quit the OLE Automation
object.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid receiving a dialog box with a message to save the file after
you have activated a workbook as an OLE Automation object, close the
workbook and use the xlfalse argument to avoid saving any changes, or
the xltrue argument to save changes to the workbook. Note that when
you use this method, Microsoft Excel remains running if it was
running before you activated the OLE Automation object. The following
is an example of using this method:
<P>
<PRE>   ' Dimension variable xlsheet as object type
   Dim xlsheet As object
   ' Activate BOOK1.XLS and assign to variable xlsheet.
   ' Note: use the appropriate path for your file
   ' (this example assumes BOOK1.XLS has been saved in
   ' C:\EXCEL5\FILES).
   Set xlsheet = GetObject("C:\EXCEL5\FILES\BOOK1.XLS")
   ' Close workbook
   ' If Microsoft Excel is running when you run this procedure, the
   ' following statement does not close the application.
   ' If Microsoft Excel is not running when you run this procedure, the
   ' following statement closes the application.
   ' Use the xltrue argument in the following statement instead of
   ' xlfalse if you DO want to save changes to the file
   xlsheet.Parent.[close] xlfalse
   ' Quit Microsoft Excel
   Set xlsheet = Nothing

</PRE>Note that the DisplayAlerts method does not work in this case to
avoid the save changes dialog box.
<P>
Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. This Visual
Basic procedure is provided 'as is' and Microsoft does not guarantee
that it can be used in all situations. Microsoft does not support
modifications of this procedure to suit customer requirements for a
particular purpose. Note that a line that is preceded by an
apostrophe introduces a comment in the code--comments are provided to
explain what the code is doing at a particular point in the
procedure. Note also that an underscore character (_) indicates that
code continues from one line to the next. You can type lines that
contain this character as one logical line or you can divide the
lines of code and include the line continuation character. For more
information about Visual Basic for Applications programming style,
see the "Programming Style in This Manual" section in the "Document
Conventions" section of the "Visual Basic User's Guide."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information about using the GetObject function to open a
Microsoft Excel workbook, query on the following words in the
Microsoft Knowledge Base:
<P>
<PRE>   getobject and filename and opens

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the Close Method, choose the Search button
in Help and type:
<P>
<PRE>   Close Method
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 5.00 5.00c 7.00 dirty<BR>
Keywords          : IntpOthr kbole kbprg kbprg<BR>
Version           : 5.00 5.00c 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
