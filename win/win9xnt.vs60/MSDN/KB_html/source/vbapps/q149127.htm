

<HTML>
<HEAD>
<TITLE>ACC: How to Determine If a Date Falls on a Weekend or Holiday </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149127">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/03/27">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to use Visual Basic for Applications to determine if a date falls on a weekend or holiday. This example is useful for setting due dates in applicati...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGJ,QBS0,QA1S,QAY5,QACE,QADK,QAB9,QAPF,QAVX,QDN9,QDMJ,QBV8,QAVW,QAHF,QA5V P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Determine If a Date Falls on a Weekend or Holiday</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149127</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to use Visual Basic for Applications to
determine if a date falls on a weekend or holiday. This example is useful
for setting due dates in applications that have billing or invoicing
features.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample procedure uses the WeekDay() function to determine if
a specific date falls on a Saturday or Sunday. Then, it uses a DLookup()
function to determine if it falls on a date stored in a user-created
Holidays table.
<P>
<P><h3>Creating a Holidays Table</h3>
 
<P>
The following sample procedure requires a table with a particular structure
for storing Holiday dates. You can follow these steps for creating the
table and sample records:

<OL><P><LI>Create a new table in Design view and add the following fields:
<P>
<P><PRE>      Table: Holidays
      ---------------
      Field Name: Description
<PRE></PRE>         Data Type: Text
      Field Name: HoliDate
         Date Type: Date/Time

</PRE><P><LI>Save the table as Holidays and switch the table to Datasheet view. Add
   the following records:
<P>
<PRE>      Description                         HoliDate
      --------------------------------------------
      New Year's Day                      1/1/96
      Martin Luther King, Jr. Day (USA)   1/15/96
      Memorial Day (observed-USA)         5/27/96
      Labor Day (USA)                     9/2/96

</PRE><P><LI>Close and save the Holidays table.
<P>
</OL><h3>Creating the Custom Procedure</h3>
 
<P>
To create a function that determines if a date falls on a weekend or
holiday, follow these steps:

<OL><P><LI>Create a new module in Design view.

<P><LI>Add the following function:
<P>
<P><PRE>      Function OfficeClosed(TheDate) As Integer
      OfficeClosed = False
</PRE><P>
<PRE>         ' Test for Saturday or Sunday.
         If WeekDay(TheDate) = 1 Or WeekDay(TheDate) = 7 Then
            OfficeClosed = True
         ' Test for Holiday.
         ElseIf Not IsNull(DLookup("HoliDate", "Holidays", "[HoliDate]=#" _
            &amp; TheDate &amp; "#")) Then
            OfficeClosed = True
         End If

      End Function

</PRE><P><LI>To test this function, type the following line into the Debug window,
   and then press ENTER:
<P>
<P><PRE>      ? OfficeClosed(#9/2/96#)
</PRE><P>
   Note that this returns a True value (-1) because 9/2/96 is listed in
   the Holidays table.
<P>
</OL><h3>Usage Example</h3>
 
<P>
You can use the custom OfficeClosed() function to calculate due dates. For
example, if your office or business is closed for a 3-day weekend, you may
want to extend your customers' grace period for their outstanding bills.
Here's sample code for adding one more day to a grace period:
<P>
<PRE>   DueDate=OrderDate+30
   Do While OfficeClosed(DueDate)
      DueDate=DateDue+1
   Loop

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about the Weekday() function, search the Help Index
for "weekday," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the DLookup() function, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q108098.htm">Q108098</A></B>
   TITLE     : ACC1x: DLookup() Usage, Examples, and Troubleshooting Tips
</PRE> 
<PRE>Keywords          : kbusage PgmHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
