

<HTML>
<HEAD>
<TITLE>PPT97: Sample Code to Rotate 3D Shapes During a Slide Show </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162236">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1997/01/16">
<META NAME="Keywords" CONTENT="kbcode kbmacro kbprg kbdta kbdtacode kbpptvba">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The following macro code enables you to have a three-dimensional (3-D) shape rotate along the X and Y axes during a slide show. This animation is launched by creating an action button linked to the macro Rotate3d_Object.  MORE INFORMATION  Microsof...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJM,QAH4,QAPN,QASR,QAR8,QDKP,QBXS,QBS0,QBVQ,QAY0,QAK8,QAVZ,QAW6,QABA,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PPT97: Sample Code to Rotate 3D Shapes During a Slide Show</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162236</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft PowerPoint 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following macro code enables you to have a three-dimensional (3-D)
shape rotate along the X and Y axes during a slide show. This animation is
launched by creating an action button linked to the macro Rotate3d_Object.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>This macro assumes that you have linked the macro code to an action
setting, either to an action button or an object on the slide itself.
To start the macro, click on the linked button or object.
<P>
For more information about linking macros to action controls, search the
Help Index for "Set up a macro to run during a slide show", or ask the
Microsoft PowerPoint Office Assistant.
<P>
<PRE>   Sub Rotate3d_Object()

      ' Change this constant for different degrees or rotation.
      Const Increment As Integer = 5

      ' Use to control the for loop.
      Dim i As Integer
      Dim j As Integer

      ' A handle used to control the shape.
      Dim FirstShape As Shape

      ' A handle to reference the slide show window.
      Dim show as SlideShowWindow

      ' Two methods to set the active SlideShowWindow to the variable show:
      ' Set show = ActivePresentation.SlideShowSettings.Run
      ' -or-
      Set show = ActivePresentation.SlideShowWindow

      ' The first method allows you either to start the macro, which then
      ' automatically runs the slide show and the animations, or to link
      ' the macro to an object on the slide via an action setting. The
      ' animations would then run by clicking the object during a slide
      ' show. The second method is strictly an action setting, and
      ' functions only during a slide show.

      ' Get a reference to the shape. This assumes that the 3-D shape is in
      ' index position 2 on slide 1 of the presentation. That is, it is
      ' the second shape on the slide.
      Set FirstShape = ActivePresentation.Slides(1).Shapes(2)

      ' The RotationY and RotationX commands can rotate an object only
      ' from -90 degrees to 90 degrees. Also, it rotates to a specific
      ' point on a compass: if you rotate along the y axis to 45 degrees,
      ' the shape is now 45 degrees from dead center.
      For i = -45 To 45 Step Increment

         ' Rotate the shape to the degree specified.
         FirstShape.ThreeD.RotationY = i
         FirstShape.ThreeD.RotationX = i

         ' Refresh the slide. This step is needed to redraw the screen
         ' after the rotation step; Otherwise, the animation effect is
         ' invisible.
         show.View.GotoSlide 1

      Next i

      For i = 45 To -45 Step -Increment

         FirstShape.ThreeD.RotationY = i
         FirstShape.ThreeD.RotationX = i

         ' Refresh the slide.
         show.View.GotoSlide 1
      Next i

   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about getting help with Visual Basic for Applications,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 8.00 kbmacro kbpptvba ppt8 vba vbe<BR>
Keywords          : kbcode kbmacro kbprg kbdta kbdtacode kbpptvba<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
