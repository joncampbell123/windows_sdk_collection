

<HTML>
<HEAD>
<TITLE>XL97: Using the Common Dialog (Print) Control Flags Property </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170698">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1997/06/27">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The Flags property for the CommonDialog control is used to return or set options in CommonDialog control dialog boxes. Most settings in the dialog boxes are related to a constant that can be used to set or return the value of the Flags property. Th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QAOX,QAUD,QABH,QABI,QAB5,QBXS,QAHP,QAPN,QANX,QBS0,QBWS,QA7O,QAOE,QAMN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Using the Common Dialog (Print) Control Flags Property</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170698</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Flags property for the CommonDialog control is used to return or set
options in CommonDialog control dialog boxes. Most settings in the dialog
boxes are related to a constant that can be used to set or return the value
of the Flags property. This article contains an example that uses the Flags
property to set and return several options in the CommonDialog control (in
this case, the Print dialog box).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P>
The following steps assume you installed the ActiveX controls from the
Microsoft Office 97 Office Developer Edition (ODE); the CommonDialog
control is not installed when you install Microsoft Office 97.
<P>
<P><h3>Setting Options in the Print Dialog Box</h3>
 
<P>
To use the Flags property to set options in the Print dialog box, follow
these steps:

<OL><P><LI>Save and close all open workbooks, and then create a new workbook.

<P><LI>Start the Visual Basic Editor.

<P><LI>On the Insert menu, click UserForm.

<P><LI>If the CommonDialog control is not displayed in the Toolbox, click
   Additional Controls on the Tools menu. Click "Microsoft Common Dialog
   Control, version 5.0" in the Additional Controls dialog box, and then
   click OK.

<P><LI>Place a copy of the CommonDialog control on the UserForm, and then
   place a CommandButton on the UserForm.

<P><LI>Double-click the CommandButton to display the module behind the
   UserForm, and then enter the following code for the Click event of the
   CommandButton:
<P>
<P><PRE>      Private Sub CommandButton1_Click()
</PRE><P>
<P><PRE>      CommonDialog1.Flags = cdlPDDisablePrintToFile + cdlPDNoSelection
      CommonDialog1.ShowPrinter
</PRE><P>
<P><PRE>      End Sub
</PRE>
<P><LI>Run the UserForm, and then click the CommandButton when the UserForm is
   displayed.
<P>
   The Print dialog box is displayed. The Print To file check box is
   cleared, and the Selection option is not selected.

<P><LI>Click OK, and then close the UserForm.
<P>
</OL><h3>Returning User Options from the Print Dialog Box</h3>
 
<P>
To continue the project in the previous section and return user options
from the Print dialog box, follow these steps:

<OL><P><LI>Change the code for the click event of the CommandButton to the
   following:
<P>
<P><PRE>      Private Sub CommandButton1_Click()
</PRE><P>
<P><PRE>      CommonDialog1.ShowPrinter
</PRE><P>
<P><PRE>      ' The statement "CommonDialog1.Flags And cdlPDPrintToFile" has a
      ' value of 0 when the Print To file check box is not selected and
      ' a value of 32 when it is selected.
      MsgBox CommonDialog1.Flags And cdlPDPrintToFile
</PRE><P>
<P><PRE>      End Sub
</PRE>
<P><LI>Run the UserForm, and then click the CommandButton when the UserForm is
   displayed.

<P><LI>Click the Print To File check box, and then click OK.
<P>
   A message box displays a value of 32. This is the decimal equivalent of
   Hexadecimal 20, the value of the cdlPDPrintToFile constant.

<P><LI>Click OK to close the message box.

<P><LI>Click the CommandButton again and clear the Print To File check box when
   the Print dialog box is displayed.

<P><LI>Click OK to close the Print dialog box.
<P>
   A message box displays a value of 0, which indicates that the Print To
   File check box was not selected.

<P><LI>Click OK to close the message box.

<P><LI>Close the UserForm.
<P>
</OL>The constants that are available for the Flags property are listed in the
following table.
<P>
<PRE>   Constant                 Value    Description
   ----------------------------------------------------------------------

   cdlPDAllPages            &amp;H0      Returns or sets the state of the All
                                     Pages option button.

   cdlPDCollate             &amp;H10     Returns or sets the state of the
                                     Collate check box.

   cdlPDDisablePrintToFile  &amp;H80000  Disables the Print To File check box.

   cdlPDHelpButton          &amp;H800    Causes the dialog box to display the
                                     Help button.

   cdlPDHidePrintToFile     &amp;H100000 Hides the Print To File check box.

   cdlPDNoPageNums          &amp;H8      Disables the Pages option button and
                                     the associated edit control.

   cdlPDNoSelection         &amp;H4      Disables the Selection option button.

   cdlPDNoWarning           &amp;H80     Prevents a warning message from being
                                     displayed when there is no default
                                     printer.

   cdlPDPageNums            &amp;H2      Returns or sets the state of the Pages
                                     option button.

   cdlPDPrintSetup          &amp;H40     Causes the system to display the Print
                                     Setup dialog box rather than the Print
                                     dialog box.

   cdlPDPrintToFile         &amp;H20     Returns or sets the state of the Print
                                     To File check box.

   cdlPDReturnDC            &amp;H100    Returns a device context for the
                                     printer selection made in the dialog
                                     box. The device context is returned
                                     in the dialog box's hDC property.

   cdlPDReturnDefault       &amp;H400    Returns default printer name.

   cdlPDReturnIC            &amp;H200    Returns an information context for the
                                     printer selection made in the dialog
                                     box. An information context provides a
                                     fast way to get information about the
                                     device without creating a device
                                     context. The information context is
                                     returned in the dialog box's hDC
                                     property.

   cdlPDSelection           &amp;H1      Returns or sets the state of the
                                     Selection option button. If neither
                                     cdlPDPageNums nor cdlPDSelection is
                                     specified, the All option button is in
                                     the selected state.

   cdlPDUseDevModeCopies    &amp;H40000  If a printer driver doesn't support
                                     multiple copies, setting this flag
                                     disables the Number of copies spinner
                                     control in the Print dialog. If a
                                     driver does support multiple copies,
                                     setting this flag indicates that the
                                     dialog box stores the requested number
                                     of copies in the Copies property.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about the Flag property, click the Index tab in
Visual Basic for Applications Help, type the following text
<P>
<PRE>   flags

</PRE>and then double-click the selected text to go to the "Flags Property (Print
Dialog)" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbcode kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
