

<HTML>
<HEAD>
<TITLE>ACC: Form Is Editable Even When AllowEdits Property Set to False </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167420">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/04/24">
<META NAME="Keywords" CONTENT="kbusage FmsProp FmsEvnt">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you open a Microsoft Access form that has the AllowEdits property set to No (False), you can still edit the fields on that form.  This article assumes that you are familiar ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QBXS,QDN9,QA7O,QBS0,QA7N,QAI2,QA5V,QA4B,QAO4,QAKJ,QADK,QAH4,QAKE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Form Is Editable Even When AllowEdits Property Set to False</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167420</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you open a Microsoft Access form that has the AllowEdits property set
to No (False), you can still edit the fields on that form.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs if you set the value of a control programmatically in
the Current event of the form. It also occurs if you set the value of a
control in the Load event of the form. In that case, however, the only
record that you can edit is the first record that is displayed on the form.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you need to edit the values of bound fields programmatically in forms
that have the AllowEdits property set to False, edit those fields in the
RecordsetClone of the form, and not in the form itself.
<P>
The following example demonstrates how to create Visual Basic code in the
Current event of a form that can change the values of fields in the
RecordsetClone of a form.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Open the Customers form in Design view.

<P><LI>Set the AllowEdits property of the form to No.

<P><LI>Set the OnCurrent property of the form to the following event procedure:
<P>
<P><PRE>      Private Sub Form_Current()
      Dim rs As Recordset
      Set rs = Me.RecordsetClone
      rs.Bookmark = Form.Bookmark
      rs.Edit
      ' The following updates the CompanyName field to itself plus the
      ' letter "a".
      rs!CompanyName = rs!CompanyName &amp; "a"
      rs.Update
      End Sub
</PRE>
<P><LI>Save the form and open it in Form view. Note that each time you view a
   record, the letter "a" is appended to the Company Name, but you cannot
   edit any of the fields on the form.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Open the Customers form in Design view.

<P><LI>Set the AllowEdits property of the form to No.

<P><LI>Set the OnCurrent property of the form to the following event procedure:
<P>
<P><PRE>      Private Sub Form_Current()
      ' The following updates the CompanyName field to itself plus the
      ' letter "a".
      Me!CompanyName = Me!CompanyName &amp; "a"
      End Sub
</PRE>
<P><LI>Save the form and open it in Form view. Note that each time you view a
   record, the letter "a" is appended to the Company Name, and note that
   you can also change other fields on the form.

<P><LI>Press CTRL+G to open the Debug window.

<P><LI>Type the following in the Debug window, and then press ENTER:
<P>
<P><PRE>      ?Forms!Customers.AllowEdits
</PRE><P>
   Note that the property is set to False, but that you are able to edit
   fields on the form.
<P>
</OL>If you modify the code in step 4 to programmatically set the AllowEdits
property to False (or to True and then back to False), it has no effect;
you are still able to edit fields on the form.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the AllowEdits property, search the Help Index
for "AllowEdits property," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the RecordsetClone property, search the Help
Index for "RecordsetClone property," or ask the Microsoft Access 97 Office
Assistant.
 
<PRE>Keywords          : kbusage FmsProp FmsEvnt
Version           : 7.00 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
