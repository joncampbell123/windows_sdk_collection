

<HTML>
<HEAD>
<TITLE>ACC: How to Use Seek Method with Multiple-Field Index </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109710">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="JetFind JetRS kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to use the Seek method when your table's primary key or index includes more than one field. Note that when you use the Seek method on multiple fie...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA28,QATJ,QA5V,QAPN,QAMA,QBS0,QAH6,QA7O,QA7N,QBV8,QBE7,QBE6,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use Seek Method with Multiple-Field Index</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109710</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to use the Seek method when your table's primary
key or index includes more than one field. Note that when you use the Seek
method on multiple fields, the Seek fields must be in the same order as the
fields in the underlying table. If they are not, the Seek method will fail.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use the Seek method to find a record using the primary key, you
need to supply a value for each field in the primary key. If you cannot
supply values for all the fields in the primary key, use "&gt;=" instead of
"=" for the Comparison argument.
<P>
In Microsoft Access 1.x, multiple-field indexes are named Index1, Index2,
Index3, Index4, or Index5, corresponding to the two-field index created in
the table. In Microsoft Access 2.0 and later, multiple-field index names
can be customized. All versions of Microsoft Access refer to a multiple-
field primary key index as PrimaryKey.
<P>
The following example demonstrates how to use the Seek method on a table
with a multiple-field primary key.

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 1.x or
   2.0).

<P><LI>Create a new module and type the following procedure:
<P>
   In Microsoft Access 2.0 and later:
<P>
<P><PRE>      '********************************************************
      ' Declarations section of the module
      '********************************************************
</PRE><P>
<P><PRE>      Option Compare Database
      Option Explicit
</PRE><P>
<P><PRE>      '**************************************************
      ' This function uses Seek on a two-field PrimaryKey
      '**************************************************
</PRE><P>
<P><PRE>      Function SeekOnMultiFields()
<PRE></PRE>         Dim db As Database, tbl As Recordset
         Set db = CurrentDB()
         Set tbl = db.OpenRecordset("Order Details")

         tbl.Index = "PrimaryKey"
         tbl.Seek "=", 10300, 68
         ' If you are only supplying one value, the statement above
         ' becomes:  tbl.Seek "&gt;=", 10300

         If tbl.NoMatch Then
            MsgBox "Not a record. Try another"
         Else
            MsgBox "The Record is in the table"
         End If
         tbl.Close
      End Function

   In Microsoft Access 1.x:

      '********************************************************
      ' Declarations section of the module
      '********************************************************

      Option Compare Database
      Option Explicit

      '**************************************************
      ' This function uses Seek on a two-field PrimaryKey
      '**************************************************

      Function SeekOnMultiFields()
         Dim db As Database, tbl As Table
         Set db = CurrentDB()
         Set tbl = db.OpenTable("Order Details")

         tbl.Index = "PrimaryKey" ' Or "Indexn" for other multi-field index

         tbl.Seek "=", 10300, 68
         ' If you are only supplying one value, the statement above
         ' becomes:  tbl.Seek "&gt;=", 10300
         If tbl.NoMatch Then
            MsgBox "Not a record. Try another"
         Else
            MsgBox "The Record is in the table"
         End If
         tbl.Close
      End Function

</PRE><P><LI>Type the following line in the Debug Window (or Immediate window in
   version 1.x or 2.0) and then press ENTER:
<P>
<P><PRE>      ? SeekOnMultiFields()
</PRE><P>
   Note that you receive the message "The Record is in the table."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Seek method, search for "Seek method," and
then "Seek Method (DAO)," using the Microsoft Access 97 Help Index.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: multi-field index<BR>
Keywords          : JetFind JetRS kbprg PgmHowTo<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
