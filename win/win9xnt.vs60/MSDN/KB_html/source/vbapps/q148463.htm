

<HTML>
<HEAD>
<TITLE>ACC: How to Display Image in Form Without Storing It in Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148463">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/03/13">
<META NAME="Keywords" CONTENT="kbinterop FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  This article describes how you can display bitmap images on a form with only the path and file name stored in the Microsoft Access table.  This article assumes that you are...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAPN,QA5V,QAUJ,QBS0,QDL9,QBWQ,QBWO,QBWN,QBFY,QAFF,QBT6,QAFI,QBV4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Display Image in Form Without Storing It in Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148463</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
This article describes how you can display bitmap images on a form with
only the path and file name stored in the Microsoft Access table.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Sometimes it is not practical to store images in a Microsoft Access table.
If you have a large number of images, or if each of your image files is
large, the size of the Microsoft Access database file can rapidly increase.
<P>
The following examples demonstrate how to display Windows bitmap images
on a Microsoft Access form without storing the images in a Microsoft
Access table.
<P>
<P><h3>In Microsoft Access 97 and 7.0</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create an new table named Imagetable and add a text field named
   ImagePath.

<P><LI>Open the Imagetable table in Datasheet view and add the path and name of
   a bitmap file to each record. The following examples show how the
   records might look:
<P>
<P><PRE>      c:\windows\circles.bmp
      C:\windows\waves.bmp
      c:\windows\tiles.bmp
      c:\windows\bubbles.bmp
</PRE>
<P><LI>Create a new form based on the ImageTable table using the Autoform
   Columnar Wizard. Name the form Imageform.

<P><LI>Open the Imageform form in Design view and add an image using the Image
   tool on the toolbox. You will be prompted to select an image to
   insert. Select any image available on your computer. Name the control
   ImageFrame.

<P><LI>Set the Imageform form's OnCurrent property to the following [Event
   Procedure]:
<P>
<P><PRE>      Private Sub Form_Current()
<PRE></PRE>         On Error Resume Next
         Me![ImageFrame].Picture = Me![ImagePath]
      End Sub

</PRE><P><LI>Set the ImagePath text box's AfterUpdate property to the following
   [Event Procedure]:
<P>
<P><PRE>      Private Sub Form_AfterUpdate()
<PRE></PRE>         On Error Resume Next
         Me![ImageFrame].Picture = Me![ImagePath]
      End Sub

</PRE><P><LI>Open the Imageform form in Form view. Note that the form displays the
   corresponding bitmap for each record.
<P>
</OL><h3>In Microsoft Access 2.0</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create an new table named Imagetable and add a text field named
   ImagePath.

<P><LI>Open the Imagetable table in Datasheet view and add the path and name of
   a bitmap file to each record. The following examples show how the
   records might look:
<P>
<P><PRE>      c:\windows\circles.bmp
      C:\windows\waves.bmp
      c:\windows\tiles.bmp
      c:\windows\bubbles.bmp
</PRE>
<P><LI>Create a new form based on the ImageTable table using the AutoForm
   Wizard. Name the form Imageform.

<P><LI>Open the Imageform form in Design view and add an unbound object frame
   using the Unbound Object Frame tool on the toolbox. Name the control
   ImageFrame.

<P><LI>Set the Imageform form's OnCurrent property to the following [Event
   Procedure]:
<P>
<P><PRE>      Private Sub Form_Current()
<PRE></PRE>         On Error Resume Next
         If Not IsNull(Me![ImagePath]) Then
         Me![ImageFrame].OLETypeAllowed = 1
         Me![ImageFrame].SourceDoc = Me![Imagepath]
         Me![ImageFrame].Action = 0
         End If
      End Sub

</PRE><P><LI>Set the ImagePath text box's AfterUpdate property to the following
   [Event Procedure]:
<P>
<PRE>      Sub ImagePath_AfterUpdate ()
         On Error Resume Next
         Me![ImageFrame].OLETypeAllowed = 1
         Me![ImageFrame].SourceDoc = Me![Imagepath]
         Me![ImageFrame].Action = 0
      End Sub

</PRE><P><LI>Set the following properties for the ImageFrame unbound object frame:
<P>
<P><PRE>       Enabled: Yes
       Locked: No
</PRE>
<P><LI>Open the Imageform in Form view. Note that the form displays the
   corresponding bitmap for each record.
<P>
</OL>NOTE: In Microsoft Access 97 and 7.0, the form will not display any image
if an invalid path or file name is added to the ImageTable table. However,
error trapping can be implemented to a further degree to ensure a valid
path and file name are entered. In Microsoft Access 2.0, the form will just
ignore the error and display the most recent bitmap on the form.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the OleTypeAllowed property, search the Help
Index for "OleTypeAllowed," and then "OleTypeAllowed Property," or ask the
Microsoft Access 97 Office Assistant.
<P>
For more information about the Sourcedoc property, search the Help Index
for "Sourcedoc," and then "SourceDoc Property," or ask the Microsoft Access
97 Office Assistant.
 
<PRE>Keywords          : kbinterop FmsHowTo
Technology        : kbole
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
