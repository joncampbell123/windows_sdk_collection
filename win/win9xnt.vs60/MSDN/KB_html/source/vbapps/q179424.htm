

<HTML>
<HEAD>
<TITLE>ACC: How to Export All Modules in a Database to Text Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179424">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1998/01/16">
<META NAME="Keywords" CONTENT="PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to export all modules in a database to text files.  MORE INFORMATION  Microsoft provides programming examples for illustration only, without wa...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA3P,QAH4,QATX,QANF,QAB9,QAZV,QAY5,QAPN,QAPF,QAH6,QAVZ,QAYL,QBV8,QACJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Export All Modules in a Database to Text Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179424</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to export all modules in a database to text
files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please
seethe following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>The following example exports all the modules in the sample database
Northwind.mdb to text files.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
      Public MyMsg as String, MyTitle as String ' Global variables.
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function OutPutModules(strMyloc As Variant)
      '******************************************************************
      ' This function will export ALL modules in the current dbase as
      ' text files to the user supplied location or to the default
      ' location. This function will except an optional argument as the
      ' location to export to. The Optional argument should consist of a
      ' path to the location where you want to store the text files. If
      ' you don't supply the optional argument, the default location of
      ' c:\ will be used.
      '******************************************************************
      On Error GoTo OutPutModules_Error
</PRE><P>
<P><PRE>      Dim strMyMsg As String
      Dim strMyTitle As String
      Dim DB As Database
      Dim strModuleName As String
      Dim intI As Integer
      Dim mdl As Module
      Dim strMyExt As String
      Dim strDisplayError As String
      Dim strNewMsg As String
      Dim strNewLoc As String
</PRE><P>
<P><PRE>      Set DB = CurrentDb()
      ' If user enters the backslash in the location, for example, 'A:\',
      ' parse out the '\' backslash, assign the drive letter and the colon
      ' ONLY to variable 'Myloc'.
      If Right(strMyloc, 1) = "\" Then strMyloc = Left(strMyloc, _
<PRE></PRE>         Len(strMyloc) - 1)
      strMyExt = ".txt"  ' Set extension for file names.
     ' Loop through module names.
      For intI = 0 To DB.Containers("Modules").Documents.Count - 1
         ' Set string variable(strModuleName) to module names.
         strModuleName = DB.Containers("Modules").Documents(intI).Name
         ' Print out ALL modules in designated format to designated
         ' drive/folder.
         strNewLoc = strMyloc &amp; "\" &amp; strModuleName &amp; strMyExt
         DoCmd.OutputTo acOutputModule, strModuleName, acFormatTXT, _
            strNewLoc, 0
         ' In Microsoft Access 7.0 change acOutputModule to acModule
      Next intI
      ' Display message with # of objects exported.
      strNewMsg = intI &amp; " Module Objects Exported" &amp; Chr(13) &amp; Chr(10)
      strNewMsg = strNewMsg &amp; "to " &amp; strMyloc &amp; "."
      MsgBox strNewMsg, vbOK, "Export Objects"

      Exit_OutPutModules:
         Exit Function

      OutPutModules_Error:
         strMyTitle = "Error in Procedure: OutPutTo ; Module: " &amp; mdl
         strMyMsg = "Error Number: " &amp; Err.Number &amp; Chr(13) &amp; Chr(10)
         strMyMsg = strMyMsg &amp; "Error Description :" &amp; Err.Description &amp; _
            Chr(13) &amp; Chr(10)
         MsgBox strMyMsg, vbExclamation, strMyTitle
         Resume Exit_OutPutModules
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>       ?OutPutModules("C:\My Documents")
</PRE><P>
   Note that you receive the following message:
<P>
<P><PRE>      3 Modules Exported to C:\My Documents
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: textfile textfiles exporting<BR>
Keywords          : PgmHowto<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
