

<HTML>
<HEAD>
<TITLE>ACC: Sending the Current Record to Word 97 with Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131583">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1996/11/19">
<META NAME="Keywords" CONTENT="kbmacro kbole kbprg word8 word95 IntpOleA OffVBA kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to merge the current record in a Microsoft Access 7.0 and 97 object into a Microsoft Word 97 document, print it, and then close Microsoft Word 97....">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA1S,QA5V,QDN9,QAML,QAMB,QAPP,QAGB,QDNE,QAEF,QAGU,QA9N,QBS0,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sending the Current Record to Word 97 with Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131583</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Word 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to merge the current record in a Microsoft
Access 7.0 and 97 object into a Microsoft Word 97 document, print it, and
then close Microsoft Word 97.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Word 97 uses the Visual Basic for Applications programming model
instead of the WordBasic flat command model used in earlier versions.
<P>
For information about how to send the current record to Microsoft Word
version 7.0 or earlier using WordBasic, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q124862.htm">Q124862</A></B>
   TITLE     : ACC: Sending the Current Record to Word with OLE Automation

</PRE>The following example uses bookmarks in a Microsoft Word 97 document to
mark the locations where you want to place data from a record on a
Microsoft Access form.
<P>
<P><h3>Creating a Microsoft Word 97 Document</h3>
 

<OL><P><LI>Start Microsoft Word 97 and create the following new document:
<P>
<P><PRE>      First Last
      Address
      City, Region, PostalCode
</PRE><P>
<P><PRE>      Dear Greeting,
</PRE><P>
<P><PRE>      Northwind Traders would like to thank you for
      your employment during the past year. Below
      you will find your photo. If this is not your
      most current picture, please let us know.
</PRE><P>
<P><PRE>      Photo
</PRE><P>
<P><PRE>      Sincerely,
</PRE><P>
<P><PRE>      Northwind Traders
</PRE>
<P><LI>Create a bookmark in Microsoft Word 97 for the words "First," "Last,"
   "Address," "City," "Region," "PostalCode," "Greeting," and "Photo":
<P>
<P><PRE>    a. Select the word "First."
</PRE><P>
<P><PRE>    b. On the Insert menu, click Bookmark.
</PRE><P>
<P><PRE>    c. In the Bookmark Name box, type "First," (without the quotation
       marks) and then click Add.
</PRE><P>
<P><PRE>    d. Repeat steps 2a-2c for each of the remaining words, substituting
       that word for the word "First" in steps 2a and 2c.
</PRE>
<P><LI>Save the document as C:\My Documents\MyMerge.doc, and then quit
   Microsoft Word 97.
<P>
</OL><h3>Sending Data to Microsoft Word from a Microsoft Access Form</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Set a reference to the Microsoft Word 8.0 Object Library. To do so,
   follow these steps:
<P>
<P><PRE>    a. Open any module in Design view.
</PRE><P>
<P><PRE>    b. On the Tools menu, click References.
</PRE><P>
<P><PRE>    c. Click Microsoft Word 8.0 Object Library in the Available References
       box. If that selection does not appear, browse for Msword8.olb,
       which installs by default in the C:\Program Files\Microsoft
       Office\Office folder.
</PRE><P>
<P><PRE>    d. Click OK.
</PRE><P>
<P><PRE>    e. Close the module.
</PRE>
<P><LI>Open the Employees form in Design view.

<P><LI>Add a command button to the form and set the following properties:
<P>
<P><PRE>      Command Button:
<PRE></PRE>         Name: MergeButton
         Caption: Send to Word
         OnClick: [Event Procedure]

</PRE><P><LI>Set the OnClick property of the command button to the following event
   procedure.
<P>
   NOTE: In the following sample code, you must remove the comment from one
   line of code as indicated, depending on your version of Microsoft
   Access.
<P>
<P><PRE>      Private Sub MergeButton_Click()
      On Error GoTo MergeButton_Err
<PRE></PRE>         Dim objWord As Word.Application
         ' Copy the Photo control on the Employees form.
         DoCmd.GoToControl "Photo"
         ' Remove the following comment in Microsoft Access 97.
         ' DoCmd.RunCommand acCmdCopy
         ' Remove the following comment in Microsoft Access 7.0.
         ' DoCmd.DoMenuItem acFormBar, acEditMenu, acCopy, , acMenuVer70
         ' Start Microsoft Word 97.
         Set objWord = CreateObject("Word.Application")
         With objWord
            ' Make the application visible.
            .Visible = True
            ' Open the document.
            .Documents.Open ("c:\my documents\mymerge.doc")
            ' Move to each bookmark and insert text from the form.
            .ActiveDocument.Bookmarks("First").Select
            .Selection.Text = (CStr(Forms!Employees!FirstName))
            .ActiveDocument.Bookmarks("Last").Select
            .Selection.Text = (CStr(Forms!Employees!LastName))
            .ActiveDocument.Bookmarks("Address").Select
            .Selection.Text = (CStr(Forms!Employees!Address))
            .ActiveDocument.Bookmarks("City").Select
            .Selection.Text = (CStr(Forms!Employees!City))
            .ActiveDocument.Bookmarks("Region").Select
            .Selection.Text = (CStr(Forms!Employees!Region))
            .ActiveDocument.Bookmarks("PostalCode").Select
            .Selection.Text = (CStr(Forms!Employees!PostalCode))
            .ActiveDocument.Bookmarks("Greeting").Select
            .Selection.Text = (CStr(Forms!Employees!FirstName))
            ' Paste the photo.
            .ActiveDocument.Bookmarks("Photo").Select
            .Selection.Paste
         End With
         ' Print the document in the foreground so Microsoft Word 97
         ' will not close until the document finishes printing.
         objWord.ActiveDocument.PrintOut Background:=False
         ' Close the document without saving changes.
         objWord.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
         ' Quit Microsoft Word 97 and release the object variable.
         objWord.Quit
         Set objWord = Nothing
         Exit Sub
      MergeButton_Err:
         ' If a field on the form is empty
         ' remove the bookmark text and continue.
         If Err.Number = 94 Then
            objWord.Selection.Text = ""
            Resume Next
         ' If the Photo field is empty.
         ElseIf Err.Number = 2046 Then
            MsgBox "Please add a photo to this record and try again."
         Else
            MsgBox Err.Number &amp; vbCr &amp; Err.Description
         End If
         Exit Sub
      End Sub 

</PRE><P><LI>Save the Employees form and open it in Form view.

<P><LI>Click the Send To Word button to start Microsoft Word 97, merge data
   from the current record on the form into MyMerge.doc, print the
   document, and then close Microsoft Word 97.
<P>
</OL>Note: When you use this method of inserting text into a Word Document you
are deleting the bookmark when you insert the record field content. If 
you need to reference the text you entered into the document you must 
bookmark it, you can use the following sample to add the bookmark "Last"
to the text inserted from record field "LastName".
<P>
<PRE>  .ActiveDocument.Bookmarks("Last").Select
  .Selection.Text = (CStr(Forms!Employees!LastName))
  'add this line to reapply the bookmark name to the selection
  .ActiveDocument.Bookmarks.Add Name:="Last",Range:=Selection.Range

</PRE></OL>This macro could be used to simulate a mailmerge with Word that includes
the picture field from an MS Access record, by placing the above code in 
a "For-Next", While-Wend, "For-Each" Loop.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Automation between Microsoft Access 97 and
Microsoft Word, search the Help Index for "sharing data between
applications, Microsoft Word mail merge data."
<P>
For more information about Automation between Microsoft Access 7.0 and
Microsoft Word, search the Help Index for "Word (Microsoft), sharing data."
<P>
For more information about bookmarks, search the Microsoft Word 97 Help
Index for "bookmarks," or ask the Microsoft Word 97 Office Assistant.
 
<PRE>Keywords          : kbmacro kbole kbprg word8 word95 IntpOleA OffVBA kbfaq
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
