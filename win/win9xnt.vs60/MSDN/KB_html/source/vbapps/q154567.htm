

<HTML>
<HEAD>
<TITLE>ACC95: Create and Date Stamp a Word Document Using OLE Automatio </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154567">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/08/08">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to use OLE Automation to create a Microsoft Word document and add a date stamp.  This article assumes that you are familiar with Visual Basic for Ap...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA1S,QDN9,QA9Q,QBWS,QA2K,QAH4,QAPN,QBS0,QACI,QDL9,QBWQ,QBWO,QBWN,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Create and Date Stamp a Word Document Using OLE Automatio</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154567</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
<LI>Microsoft Word for Windows 95 version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to use OLE Automation to create a Microsoft
Word document and add a date stamp.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access for Windows 95" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example - Create and Date Stamp a Microsoft Word document</h3>
 
<P>
The following example creates a new Microsoft Word document, inserts some
text and formats it, and then inserts a text date stamp.
<P>
To run this code:

<OL><P><LI>Open Microsoft Word. When the code is run from Microsoft Access,
   Microsoft Word will remain open.

<P><LI>Open a Microsoft Access for Windows 95 database and create a new module.

<P><LI>Add a Reference to the Word95Acc.TLB reference file. To do this, on the
   Tools menu, click References. Click the Browse button and locate the
   Wrd95Acc.dll file. Usually, this file is located in the \ACCESS
   folder. Select the file and click OK. The Word 95 reference library is
   now referenced by the active Microsoft Access database.

<P><LI>Type the following function in the Module window:
<P>
<P><PRE>      Function CreateDoc()
      Dim ThisWord As Word95ACC.Word95Access
      Set ThisWord = CreateObject("Word.Basic")
      With ThisWord
<PRE></PRE>          .AppMaximize
          ' Create a new document based on the default template (usually
          ' Normal)
          .FileNewDefault
          .FormatFont _
              Points:=22, _
              Bold:=True, _
              Italic:=True
          .INSERT "Welcome to Word OLE  Automation"
          .InsertPara
          .FormatFont _
              Points:=10, _
              Bold:=False, _
              Italic:=False
          .INSERT "Report Created:"
          ' Insert the date as text, not as an updateable field
          .InsertDateTime _
              DateTimePic:="YYYY MM DD HH:MM:SS", _
              InsertAsField:=False
          .InsertPara
      End With
      End Function

</PRE></OL>To run the function, open the Debug window, type the following line, and
then press ENTER:
<P>
<PRE>   ?CreateDoc()

</PRE>NOTE: In both examples, when the OLE Automation object goes out of scope,
the instance of Microsoft Word is unloaded unless the object was created
from a previous instance (already opened). It is possible to set the object
to a global variable so that it does not lose scope until the application
is closed.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For information about OLE Automation, in the Microsoft Word for Windows
help file (you must have the WordBasic help file, WRDBASIC.HLP installed),
search on "OLE Automation" and choose the "Accessing Word for OLE
Automation" topic. For information about the WordBasic commands used in
this code search on "Insert statement," "FormatFont statement,"
"FileNewDefault statement," and "InsertDateTime statement."
<P>
For more information about using OLE Automation between Microsoft Access
and Microsoft Word, search on the phrase "Create a Word Document using OLE
Automation," and then "CreateObject function" using the Microsoft Access
for Windows 95 Answer Wizard.
<P>
For more examples of OLE Automation between Microsoft Access and Microsoft
Graph, see the OLE Automation Help File available on the World Wide Web at
www.microsoft.com. To locate the file, on the Microsoft Home page, click
Support. On the next page, click "Search the Knowledge Base." In box 1,
select Access. In box 3, type <B><A href="../access/q148124.htm">Q148124</A></B>, and then click Go!
 
<PRE>Keywords          : AutoGnrl kbinterop IntpOleA
Technology        : kbole
Version           : 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
