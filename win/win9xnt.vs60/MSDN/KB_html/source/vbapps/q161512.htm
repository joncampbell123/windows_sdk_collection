

<HTML>
<HEAD>
<TITLE>XL97: GetSaveAsFilename Method Returns Extra Character </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161512">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/12/26">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbainfo xlloadsave">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the GetSaveAsFilename or GetOpenFilename methods in a Visual Basic for Applications macro, Microsoft Excel may add a period (.) to the end of the string that is returned. When the period is appended, unexpected results may occur when y...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBS0,QAPN,QAH6,QAFI,QBVP,QATX,QAUD,QAKE,QALY,QAH7,QAD7,QAVX,QAVW,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: GetSaveAsFilename Method Returns Extra Character</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161512</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the GetSaveAsFilename or GetOpenFilename methods in a Visual
Basic for Applications macro, Microsoft Excel may add a period (.) to the
end of the string that is returned. When the period is appended, unexpected
results may occur when you use the string as the file name argument for the
SaveAs or Open methods.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if you do not add a file name extension to the file
name that you type into the dialog box provided by GetSaveAsFilename or
GetOpenFilename. For example, if you type "Test" (without the quotation
marks), GetSaveAsFilename returns "Test." (without the quotation marks). If
the macro passes this string to the SaveAs method, the macro does not add a
file name extension to the file name when the file is saved. If you type a
file name with a file name extension, such as "Test.xls" (without the
quotation marks), a period is not added to the end of the string
that is returned.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When you use the GetSaveAsFilename or GetOpenFilename method, determine
whether there is a period at the end of the string that is returned and
remove it if it is present. If the rightmost character is a period, strip
it from the string before you pass it to the SaveAs method.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this
problem and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
The following sample macro code checks for a trailing period (.) in the
string that is returned by the GetSaveAsFilename method. To use the macro,
use the following steps:

<OL><P><LI>Close and save any open workbooks, and then create a new workbook.

<P><LI>Start the Visual Basic Editor (press ALT+F11).

<P><LI>On the Insert menu, click Module.

<P><LI>Type the following code in the module:
<P>
<PRE>      Sub Test()

          Dim FileIn as String
          Dim Fname as String

          'Display the Dialog box.
          FileIn = Application.GetSaveAsFilename

          'Check for a trailing period.
          If Right(FileIn, 1) = "." Then

              'Remove the period from the string.
              Fname = Left(FileIn, Len(FileIn) - 1)

          Else
              Fname = FileIn
          End If

          'Pass the string Fname to the SaveAs method.
          ActiveWorkbook.SaveAs FileName:=Fname

      End Sub

</PRE></OL>When you run the macro, it strips the trailing period before the results of
GetSaveAsFilename are passed to the SaveAs method.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about GetSaveAsFilename method, click the Office
Assistant, type "getsaveasfilename", click Search, and then click to view
"GetSaveAsFilename".
<P>
For more information about GetOpenFilename method, click the Office
Assistant, type "getopenfilename", click Search, and then click to view
"GetOpenFilename".
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Excel Help is not installed on your
computer, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbcode kbprg xlvbainfo xlloadsave<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
