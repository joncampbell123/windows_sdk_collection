

<HTML>
<HEAD>
<TITLE>XL5: Can't Use Horizontal Array for List Box/Drop-Down Input </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115793">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/06/02">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmOthr kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, you cannot use a horizontal array for the input range for list boxes or drop-down boxes. When you use a horizontal range for the input range of a list box or a drop-down box, you will not receive an error message; ho...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBJZ,QAH4,QBXS,QBWS,QAY2,QBV3,QBI4,QA9Z,QDMR,QAFF,QAG2,QBS0,QAE1,QANX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Can't Use Horizontal Array for List Box/Drop-Down Input</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115793</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0, 5.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel version 5.0, you cannot use a horizontal array for the
input range for list boxes or drop-down boxes. When you use a horizontal
range for the input range of a list box or a drop-down box, you will not
receive an error message; however, only the first item in the array will be
displayed in the list box or drop-down box.
<P>
Note also that you cannot use the ListFillRange property to fill a list box
or drop-down box with a row of data. For information about how to populate
a list box or drop-down box with a row of data, see the sample macros at
the end of this article.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h3>To use a horizontal range of values in a list box on a worksheet</h3>
 

<OL><P><LI>From the File menu, choose New to start a new workbook.

<P><LI>In the range A1:F1 on Sheet1, type the following:
<P>
<P><PRE>      A1: Apple B1: Banana C1: Orange D1: Peach E1: Pear F1: Watermelon
</PRE>
<P><LI>To display the Forms toolbar, choose Toolbars from the View menu,
   and select the Forms check box, and choose OK.

<P><LI>From the Forms toolbar, choose the List Box button. Create a list box
   on Sheet1.

<P><LI>From the Insert menu, choose Macro, and then choose Module to insert
   a new module sheet in the workbook.

<P><LI>Enter the following macro on the module sheet:
<P>
<PRE>   Sub AddArrayToListBoxOnWorksheet()
     Sheets("Sheet1").ListBoxes(1).List = Sheets("Sheet1").Range("A1:F1")
   End Sub

</PRE><P><LI>To activate Sheet1, click on the Sheet1 tab.

<P><LI>From the Tools menu, choose Macro. In the list of macros, select
   AddArrayToListBoxOnWorksheet, and choose the Run button to fill the
   list box with the horizontal array of values in A1:F1.
<P>
</OL>To use a horizontal range of values in a list box on a dialog sheet
 

<OL><P><LI>From the File menu, choose New to start a new workbook.

<P><LI>Type the following in cells A1:F1 on Sheet1:
<P>
<P><PRE>      A1: Apple B1: Banana C1: Orange D1: Peach E1: Pear F1:Watermelon
</PRE>
<P><LI>From the Insert menu, choose Macro, and then choose Dialog to insert a
   new Dialog sheet in the workbook.

<P><LI>Select the List Box tool from the Forms toolbar. Draw a list box
   on the sheet Dialog1.

<P><LI>From the Insert menu, choose Macro, and choose Module to insert a new
   Module.

<P><LI>Enter the following macro on the module sheet:
<P>
<PRE>   Sub AddArrayToListBoxOnDialogSheet()
      Sheets("Dialog1").ListBoxes(1).List = Sheets("Sheet1").Range("A1:F1")
   End Sub

</PRE><P><LI>Activate the Dialog1 sheet by clicking on the tab for Dialog1.

<P><LI>From the Tools menu, choose Macro. From the list of macros, select
   AddArrayToListBoxOnDialogsheet and choose the Run button to fill the
   list box with the horizontal array of values in A1:F1.
<P>
</OL><h3>To use a horizontal range of values in a drop-down list box on a worksheet</h3>
 
<P>
<PRE>Sub AddArrayToDropDownOnWorksheet()
  Sheets("Sheet1").DropDowns(1).List = Sheets("Sheet1").Range("A1:F1")
End Sub

</PRE></OL>To use a horizontal range of
<P><h3>values in a drop-down list box on a dialog sheet</h3>
 
<P>
<PRE>Sub AddArrayToDropDownOnDialogSheet()
  Sheets("Dialog1").DropDowns(1).List = Sheets("Sheet1").Range("A1:F1")
End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c<BR>
Keywords          : kbprg PgmHowTo PgmOthr kbcode kbprg<BR>
Version           : 5.00 5.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
