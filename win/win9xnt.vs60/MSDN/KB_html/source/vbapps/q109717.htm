

<HTML>
<HEAD>
<TITLE>ACC: Memo and OLE Fields in a Snapshot Are Not Static </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109717">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/01/06">
<META NAME="Keywords" CONTENT="JetRS kbprg IntpOle">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Data contained in a snapshot that includes a Memo or OLE field can be changed if the data in the underlying table for the snapshot changes.  This article assumes that you ar...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAWI,QAVX,QDN9,QDN3,QA5V,QAYY,QA7O,QA7N,QBS0,QA9Q,QAY5,QBVV,QA5F,QABO P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Memo and OLE Fields in a Snapshot Are Not Static</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109717</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Data contained in a snapshot that includes a Memo or OLE field can be
changed if the data in the underlying table for the snapshot changes.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Access stores the contents of Memo and OLE fields differently
than other data types. Memo and OLE field data is not stored in the data
page holding the actual record. Instead, the data page holding the record
contains an address pointer that specifies the data page(s) containing
the data.
<P>
When you create a snapshot, a static copy of the data page holding the
record is copied. This copy contains only the address of the Memo or OLE
information. If the actual Memo or OLE information is changed, the
snapshot will look to the same data page and will find the changed
information.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. The actual Memo or OLE information is not
loaded into the snapshot in order to avoid performance degradation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A snapshot is a copy of the record source data at the point in time when
the snapshot was created. Unlike the data in a dynaset, snapshot data is
not linked to data in the underlying tables. The snapshot data does not
change as its underlying tables change.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
You can use the following sample function to demonstrate that a Memo field
contained in a snapshot can be changed:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in versions 1.x
   and 2.0).

<P><LI>Create the following new function in a module:
<P>
<P><PRE>     Public Function TestSnapshot()
<PRE></PRE>         Dim SS As Recordset
         Dim DS As Recordset
         Dim DB As Database

         Set DB = CurrentDb()

         ' Create a snapshot and recordset of the Categories table.
         Set SS = DB.OpenRecordset("Categories", dbOpenSnapshot)
         Set DS = DB.OpenRecordset("Categories", dbOpenDynaset)

         ' Move to the first record.
         SS.MoveFirst
         DS.MoveFirst

         ' Print the contents of the CategoryName and Description
         ' .. fields from both record sets. CategoryName is a
         ' .. Text field and Description is a Memo field.
         Debug.Print
         Debug.Print "Snapshot:"
         Debug.Print "   CategoryName: " &amp; SS![CategoryName]

         ' NOTE: In versions 1.x and 2.0, type a space in [Category Name].

         Debug.Print "   Description: " &amp; SS![Description]
         Debug.Print "Dynaset:"
         Debug.Print "   CategoryName: " &amp; DS![CategoryName]
         Debug.Print "   Description: " &amp; DS![Description]

         ' Alter the Description and CategoryName fields using
         ' .. the dynaset.
         DS.Edit
            DS![Description] = "My Description"
            DS![CategoryName] = "My Category"
         DS.Update

         ' Print the new contents of the recordsets.
         Debug.Print
         Debug.Print "Snapshot:"
         Debug.Print "   CategoryName: " &amp; SS![CategoryName]
         Debug.Print "   Description: " &amp; SS![Description]
         Debug.Print "Dynaset:"
         Debug.Print "   CategoryName: " &amp; DS![CategoryName]
         Debug.Print "   Description: " &amp; DS![Description]
      End Function

</PRE><P><LI>Type the following line in the Debug window (or Immediate window in
   versions 1.x and 2.0), and then press ENTER:
<P>
<P><PRE>      ? TestSnapShot()
</PRE><P>
   Note that the following text is displayed in the Debug window:
<P>
<P><PRE>      Snapshot:
<PRE></PRE>         Category Name: Beverages
         Description: Soft drinks, coffees, teas, beer, and ale
      Dynaset:
         Category Name: Beverages
         Description: Soft drinks, coffees, teas, beer, and ale

      Snapshot:
         Category Name: Beverages
         Description: My Description
      Dynaset:
         Category Name: My Category
         Description: My Description

</PRE></OL>Note that the second Description for the snapshot reads "My Description,"
which is the same as the change made by the dynaset. Note also that the
second CategoryName for the snapshot is unchanged, as Text fields are
static in a snapshot.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about snapshots, search the Help Index for
"snapshots," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : JetRS kbprg IntpOle
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
