

<HTML>
<HEAD>
<TITLE>ACC: How to Place the User Login Name on Form or in Title Bar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94599 ">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/01/11">
<META NAME="Keywords" CONTENT="kbprg PgmApi PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article explains how to use the CurrentUser() function in Microsoft Access (or User() function in Microsoft Access 1.x), to display the current user name in a control o...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBTM,QDN9,QAH4,QAGU,QBWF,QBS0,QAY5,QA5F,QAMA,QBE7,QBE6,QAPN,QAB5,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Place the User Login Name on Form or in Title Bar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94599 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article explains how to use the CurrentUser() function in Microsoft
Access (or User() function in Microsoft Access 1.x), to display the current
user name in a control on a form or in the title bar of the Microsoft
Access window.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Access, you can implement security to control user access to
the different objects in your database. Then, you can use the User() or
CurrentUser() function to display the current user's name.
<P>
<P><h3>Displaying the User Name in a Control on a Form</h3>
 
<P>
Use the following procedure to display a user name in a control on a form:

<OL><P><LI>Create a form and add an unbound text box control to the form.

<P><LI>Set the ControlSource property to "=CurrentUser()", (or "=User()" in
   Microsoft Access 1.x), without the quotation marks.

<P><LI>Switch the form to Form view to see the current user name displayed in
   the control.
<P>
</OL><h3>Displaying the User Name in the Title Bar (Microsoft Access 97 and 7.0)</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in Microsoft Access 2.0 or earlier).
You may want to back up the Northwind database file and perform these steps
on a copy of the database.
<P>
Use the following procedure to display a user name in the title bar of the
Microsoft Access window in Microsoft Access 97 and 7.0:

<OL><P><LI>Create a new module.

<P><LI>Enter the following Visual Basic for Applications code:
<P>
<P><PRE>      Function ChangeTitle()
<PRE></PRE>         Dim dbs As DATABASE, prp As Property
         Const conPropNotFoundError = 3270

         On Error GoTo ErrorHandler
         ' Return Database variable pointing to current database.
         Set dbs = CurrentDb
         ' Change title bar.
         dbs.Properties!AppTitle = "User = " &amp; CurrentUser
         ' Update title bar on screen.
         Application.RefreshTitleBar
      Exit Function

      ErrorHandler:
         If Err.Number = conPropNotFoundError Then
            Set prp = dbs.CreateProperty("AppTitle", dbText, _
               "User = " &amp; CurrentUser)
            dbs.Properties.Append prp
         Else
            MsgBox "Error: " &amp; Err.Number &amp; vbCrLf &amp; Err.Description
         End If
         Resume Next
      End Function

</PRE><P><LI>Create a new macro with the RunCode action, using the following as the
   action argument:
<P>
<P><PRE>      ChangeTitle()
</PRE><P>
   Save the macro and name it ShowUser.

<P><LI>Run the ShowUser macro. You should see the Microsoft Access title bar
   change from "Microsoft Access" to "User = &lt;username&gt;."
<P>
</OL><h3>Displaying the User Name in the Title Bar (Microsoft 2.0 and 1.x)</h3>
 
<P>
Use the following procedure to display a user name in the title bar of the
Microsoft Access window in Microsoft Access 2.0 and 1.x:

<OL><P><LI>Create a new module.

<P><LI>Enter the following Access Basic code:
<P>
   NOTE: In the following sample code, an underscore (_) is used as a line-
   continuation character. Remove the underscore from the end of the line
   when re-creating this code in Access Basic.
<P>
 '=====================================================================
<PRE>   ' Declarations section of the module
 '=====================================================================
      Option Explicit

      Declare Function SendMessage&amp; Lib "User" (_
                   ByVal hw%, ByVal message%, ByVal wParam%, LParam As Any)
      Declare Function GetActiveWindow% Lib "User" ()

      Const WM_SETTEXT = &amp;HC

      DIM stTitle$
      DIM x%

 '=====================================================================
   ' The following function places the user name in the title bar.
 '=====================================================================

      Function ChangeTitle ()
      ' Use only one of the following two lines of code,
      ' depending on your version of Microsoft Access
         stTitle$ = "User = " + User()          ' For Version 1.x only
         stTitle$ = "User = " + CurrentUser()   ' For Version 2.0 only
         x% = SendMessage(GetActiveWindow(), WM_SETTEXT, 0, ByVal stTitle$)
      End Function

 '=====================================================================
   ' End of code section.
 '=====================================================================

</PRE><P><LI>On the Run menu, click Compile All.

<P><LI>Save the module.

<P><LI>Create a new macro with the RunCode action, using the following as the
   action argument:
<P>
<P><PRE>      ChangeTitle()
</PRE><P>
   Save the macro and name it ShowUser.

<P><LI>Run the ShowUser macro. You should see the Microsoft Access title bar
   change from "Microsoft Access" to "User = &lt;username&gt;."
</OL> 
<PRE>Keywords          : kbprg PgmApi PgmHowTo
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
