

<HTML>
<HEAD>
<TITLE>XL: Using Visual Basic to Create a Chart Using a Dynamic Range </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146055">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/02/13">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you record a macro to create a chart, the source address of cells used to create the chart is fixed by Microsoft Excel. This article contains a  sample Microsoft Visual Basic for Applications macro (Sub procedure) that  you can use to create a...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QDNX,QAH4,QA5V,QBWS,QBJZ,QBXT,QAPN,QAIB,QAQG,QAVZ,QDMR,QAX6,QDNZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using Visual Basic to Create a Chart Using a Dynamic Range</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146055</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for the Macintosh, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you record a macro to create a chart, the source address of cells used
to create the chart is fixed by Microsoft Excel. This article contains a 
sample Microsoft Visual Basic for Applications macro (Sub procedure) that 
you can use to create a chart when the source address containing the data 
to be used in the chart may vary.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>Follow these steps to create the sample macro:

<OL><P><LI>Enter the following information in a new worksheet:
<P>
<PRE>      C3:         D3:  Region 1   E3:  Region 2   F3:  Region 3
      C4:  Jan    D4:  10         E4:  80         F4:  15
      C5:  Feb    D5:  20         E5:  70         F5:  25
      C6:  Mar    D6:  30         E6:  60         F6:  35
      C7:  Apr    D7:  40         E7:  50         F7:  45

</PRE><P><LI>Type the following in a new module sheet:
<P>
<PRE>      Sub CreateChart()

         ' Select the cell in the upper-left corner of the chart.
         Range("c4").Select
         ' Select the current range of data. This line of code assumes that
         ' the current region of cells is contiguous - without empty rows 
         ' or columns.
         Selection.CurrentRegion.Select

         ' Assign the address of the selected range of cells to a variable.
         myrange = Selection.Address

         ' Assign the name of the active sheet to a variable. This line is
         ' used in order to allow a chart to be created on a separate chart
         ' sheet.
         mysheetname = ActiveSheet.Name

         ' Add a chart to the active sheet.
         ActiveSheet.ChartObjects.Add(125.25, 60, 301.5, 155.25).Select

         ' To create a chart on a separate chart sheet, remark out the 
         ' previous line, and substitute the next line for the one above.

         ' Charts.Add

         Application.CutCopyMode = False

         ' This line can best be written by recording a macro, and 
         ' modifying the code generated by the Microsoft Excel Macro 
         ' recorder.

         ActiveChart.ChartWizard _ 
            Source:=Sheets(mysheetname).Range(myrange), _
            Gallery:=xlLine, Format:=4, PlotBy:=xlRows, _
            CategoryLabels:=1, SeriesLabels:=1, HasLegend:=1, _
            Title:="", CategoryTitle:="", _
            ValueTitle:="", ExtraTitle:=""

      End Sub

</PRE><P><LI>Activate the worksheet where you entered the data in Step 1 and run the
   CreateChart macro.
<P>
</OL>A new chart will be created on your worksheet.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Excel Version 7.0</h3>
 
<P>
For more information about the ChartWizard Method, on the Help menu, click
"Microsoft Excel Help Topics," click the Index Tab, and then type:
<P>
<PRE>   ChartWizard Method

</PRE></OL><h3>Microsoft Excel Version 5.0</h3>
 
<P>
For more information about the ChartWizard Method, on the Help menu, click
Contents, click Programming with Visual Basic, click the search button, and
then type:
<P>
<PRE>   ChartWizard Method

</PRE><h3>In Microsoft Excel 5.0 for the Macintosh</h3>
 
<P>
For more information about the ChartWizard Method, click the Balloon Help
icon, click Microsoft Excel Help, click Programming with Visual Basic,
click the search button, and then type:
<P>
<PRE>   ChartWizard Method
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: automatic 7.00<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS: 5.0, 7.0, 97; MACINTOSH: 5.0, 98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
