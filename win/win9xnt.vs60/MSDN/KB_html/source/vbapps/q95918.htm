

<HTML>
<HEAD>
<TITLE>ACC: How to Use Code to Derive a Statistical Median </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95918 ">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/03/01">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes a Visual Basic for Applications procedure that you can use to open a table, read the data, and find the statistical median. The median is a measure of...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIV,QA1S,QDN9,QBE7,QBE6,QBXS,QBS0,QAY5,QA5F,QAMA,QAH4,QAB9,QAY2,QANF,QBT6 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use Code to Derive a Statistical Median</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95918 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes a Visual Basic for Applications procedure that you
can use to open a table, read the data, and find the statistical median.
The median is a measure of central tendency, another "middle" of a data
set, like the mean or average). The data set consisting of the numbers 1,
2, 3, 6, and 100 has a median of 3, the middle of the set. The data set
consisting of the numbers 1, 2, 6, and 10 has a median of 4, the middle
of the set [(2 + 6) / 2 = 4].
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a procedure that determines the statistical median of a set
of numbers:

<OL><P><LI>Create a module and type the following line in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
   In Microsoft Access 2.0, 7.0, and 97:
<P>
<P><PRE>    Function Median (tName$, fldName$) As Single
      Dim MedianDB As Database
      Dim ssMedian As Recordset
      Dim RCount%, i%, x%, y%, OffSet%
      Set MedianDB = CurrentDB()
      Set ssMedian = MedianDB.Openrecordset("SELECT [" &amp; fldName$ &amp; _
<PRE></PRE>                "] FROM [" &amp; tName$ &amp; "] WHERE [" &amp; fldName$ &amp; "] IS _
                NOT NULL ORDER BY [" &amp; fldName$  &amp; "];")
      'NOTE: To include nulls when calculating the median value, omit
      'WHERE [" &amp; fldName$ &amp; "] IS NOT NULL from the example.
      ssMedian.MoveLast
      RCount% = ssMedian.RecordCount
      x% = RCount% Mod 2
      If x% &lt;&gt; 0 Then
         OffSet% = ((RCount% + 1) / 2) - 2
         For i% = 0 To OffSet%
            ssMedian.MovePrevious
         Next i
         Median = ssMedian(fldName$)
      Else
         OffSet% = (RCount% / 2) - 2
         For i% = 0 To OffSet%
            ssMedian.MovePrevious
         Next i
         x% = ssMedian(fldName$)
         ssMedian.MovePrevious
         y% = ssMedian(fldName$)
         Median = (x% + y%) / 2
      End If
      ssMedian.Close
      MedianDB.Close
    End Function

   In Microsoft Access 1.x:

    Function Median (tName$, fldName$) As Single
      Dim MedianDB As Database
      Dim ssMedian As Snapshot
      Dim RCount%, i%, x%, y%, OffSet%
      Set MedianDB = CurrentDB()
      Set ssMedian = MedianDB.CreateSnapshot("SELECT [" &amp; fldName$ &amp; _
                "] FROM [" &amp; tName$ &amp; "] WHERE [" &amp; fldName$ &amp; "] IS _
                NOT NULL ORDER BY [" &amp; fldName$  &amp; "];")
      'NOTE: To include nulls when calculating the median value, omit
      'WHERE [" &amp; fldName$ &amp; "] IS NOT NULL from the example.
      ssMedian.MoveLast
      RCount% = ssMedian.RecordCount
      x% = RCount% Mod 2
      If x% &lt;&gt; 0 Then
         OffSet% = ((RCount% + 1) / 2) - 2
         For i% = 0 To OffSet%
            ssMedian.MovePrevious
         Next i
         Median = ssMedian(fldName$)
      Else
         OffSet% = (RCount% / 2) - 2
         For i% = 0 To OffSet%
            ssMedian.MovePrevious
         Next i
         x% = ssMedian(fldName$)
         ssMedian.MovePrevious
         y% = ssMedian(fldName$)
         Median = (x% + y%) / 2
      End If
      ssMedian.Close
      MedianDB.Close
    End Function

</PRE></OL><h3>How to Use the Median() Function</h3>
 
<P>
Create a form and add a text box control where you want to display the
median values of a data set. Set the ControlSource property of the text
box control to the following:
<P>
<PRE>   =Median("&lt;TableName&gt;", "&lt;FieldName&gt;")

</PRE>The value of this control is the median of the data set. Another way
to use this function is to call it from within another function that
compares the median from different data sets. For example,
<P>
<PRE>   Function CompareMedians()
      Dim MyDB as Database
      .
      .
      .
      X = Median("&lt;TableName&gt;", "&lt;FieldName&gt;")
      Y = Median("&lt;TableName&gt;", "&lt;FieldName&gt;")
      If X &gt; Y Then Debug.Print "The median for X is greatest."
   End Function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: statistics<BR>
Keywords          : kbprg PgmHowTo PgmOthr<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
