

<HTML>
<HEAD>
<TITLE>ACC: Automation Object Disappears When Code Finishes Executing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161253">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/12/18">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use Automation to control another application, such as Microsoft Word or Microsoft Excel, the application quits as soon as your procedure finishes executing.  This artic...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAYL,QAH4,QAPN,QAW6,QAGB,QA1S,QAB9,QAVX,QDN9,QA2K,QBWS,QAY5,QBS0,QA28 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Automation Object Disappears When Code Finishes Executing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161253</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use Automation to control another application, such as Microsoft
Word or Microsoft Excel, the application quits as soon as your procedure
finishes executing.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The application quits because its object variable loses scope.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you do not want the Automation server application to close when your
code finishes executing, use one of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Declare the Object Variable in the Declarations Section of Your Code
Module:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Dim xlApp as Object
</PRE>
<P><LI>Type the following procedure:
<P>
<PRE>      Sub LeaveXLOpen1()
      Set xlApp = CreateObject("Excel.Application")
      xlApp.Visible = True
      End Sub

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       LeaveXLOpen1
</PRE><P>
</OL>Note that Microsoft Excel starts and remains visible after the procedure
stops executing. Microsoft Excel quits automatically when you close your
database because that is when the object variable loses scope.
<P>
NOTE: If you declare your object variable in the Declarations section of a
form or report module, Microsoft Excel remains open only as long as the
form or report remains open.
<P>
<P><h3>Method 2</h3>
 
<P>
Declare the Object Variable as a Static Variable at the Procedure Level:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub LeaveXLOpen2()
      Static xlApp as Object
      Set xlApp = CreateObject("Excel.Application")
      xlApp.Visible = True
      End Sub

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       LeaveXLOpen2
</PRE><P>
</OL>Note that Microsoft Excel starts and remains visible after the procedure
stops executing. Microsoft Excel quits automatically when you close your
database because that is when the object variable loses scope.
<P>
NOTE: If you declare the Static variable as part of a procedure in a form
or report module, Microsoft Excel remains open only as long as the form or
report remains open.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Where and how you declare a variable in a code module determines its scope
and its lifetime. Scope is defined as the availability of a variable,
constant, or procedure for use by another procedure. Lifetime is defined as
the time during which a variable retains its value.
<P>
When you declare an object variable within a procedure, the variable only
retains its value as long as the procedure is running, as shown in the
example in the "Steps to Reproduce Behavior" section.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<PRE>      Sub OpenAndClose()
      Dim xlApp as Object
      Set xlApp = CreateObject("Excel.Application")
      xlApp.Visible = True
      End Sub

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       OpenAndClose
</PRE><P>
   Note that Microsoft Excel starts and then quits. That is because its
   object variable, xlApp, loses scope as soon as the procedure stops
   running.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the scope and lifetime of variables, search the
Help Index for "variables, scope," or "variables, lifetime."
<P>
For more information about using the CreateObject function, search the
Help Index for "CreateObject function."
<P>
For more information about declaring Static variables, search the Help
Index for "Static statement."
<P>
For information about using Microsoft Access as an Automation server,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q147816.htm">Q147816</A></B>
   TITLE     : ACC: Using Microsoft Access as an Automation Server

</PRE></OL>For more information about quitting Microsoft Excel after you run
Automation code, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q145770.htm">Q145770</A></B>
   TITLE     : ACC: Automation Does Not Close Microsoft Excel
</PRE> 
<PRE>Keywords          : AutoGnrl kbinterop IntpOleA
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
