

<HTML>
<HEAD>
<TITLE>ACC: Record Count Incorrect with Multiuser Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105129">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1993/10/10">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo MdlRcd">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When multiple users access the same table and delete records from it, the record count does not always accurately reflect the actual number of records in the table.  For example,...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAG8,QAJQ,QAGU,QBJZ,QA1S,QAUD,QAKC,QDMH,QARR,QBC6,QDN3,QDN9,QAPN,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Record Count Incorrect with Multiuser Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105129</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When multiple users access the same table and delete records from it, the
record count does not always accurately reflect the actual number of
records in the table.
<P>
For example, say two different users access the same table. User 1
prints a count of the number of records in the table, deletes the last
record, and then closes the table. User 2 then opens the same table and
prints a count of the number of records in the table. The record count may
be the same for the two users even though the record count for User 2
should be one less than for User 1.
<P>
<P><h2>CAUSE</h2>
 
<P>
Pages are not removed from the page cache when a table is closed. When a
table is reopened, it is possible for out-of-date pages to be present in
the page cache, which can lead to inaccurate record counts.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Although the RecordCount property of a table returns the approximate
number of records in the table, the RecordCount property of a snapshot
returns the actual number of records in the snapshot. You can use the
following user-defined sample function to return a table's record count
by creating a snapshot of the table:
<P>
<PRE>   Function ReturnRecordCount (mytablename As String)

      'Define variables.
      Dim mytable As Table, mydb As Database
      Dim mysnapshot As Snapshot

      'Initialize variables.
      Set mydb = CurrentDB()
      Set mytable = mydb.OpenTable(mytablename)
      'Create a snapshot based on the table.
      Set mysnapshot = mytable.CreateSnapshot()

      mysnapshot.MoveLast
      myrecordcount = mysnapshot.recordcount

      mysnapshot.Close
      mytable.Close
      mydb.Close

      ReturnRecordCount = myrecordcount

   End Function

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about snapshots, search for "snapshot," and then
"Snapshot Object--Summary" using the Microsoft Access Help menu.
<P>
For more information about the RecordCount property, search for
"RecordCount," and then "RecordCount Property" using the Microsoft Access
Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: multiuser<BR>
Keywords          : kbusage PgmHowTo MdlRcd<BR>
Version           : 1.0 1.1 2.0 7.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
