

<HTML>
<HEAD>
<TITLE>ACC: Printing a Microsoft Word Document Using Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154569">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/08/08">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to use Automation to print a Microsoft Word document you are working with in a Microsoft Access function or in a Microsoft Access form's object fram...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QAPN,QA1S,QAOX,QDN9,QAW6,QBS0,QBXS,QAPF,QBWS,QAB9,QA2K,QAIB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Printing a Microsoft Word Document Using Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154569</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft Word for Windows versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to use Automation to print a Microsoft
Word document you are working with in a Microsoft Access function or in a
Microsoft Access form's object frame.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use Microsoft Access with Microsoft Word 7.0, you must use Word
Basic commands in all Automation code. Microsoft Word 97 uses Visual Basic
for Applications.  The following examples show syntax for both. Each
example assumes you have a Microsoft Word document called C:\Wordtest.doc.
<P>
<P><h3>Example - Printing a Microsoft Word Document</h3>
 
<P>
This example opens and prints a Microsoft Word document.

<OL><P><LI>Start Microsoft Access and open any database.

<P><LI>Create a module and type the following procedure:
<P>
   Using Microsoft Word 97:
<P>
<P><PRE>      Function PrintDoc()
      Dim WordObj As Object
      Set WordObj = CreateObject("Word.Application")
      WordObj.Documents.Open "C:\Wordtest.doc"
      WordObj.PrintOut Background:=False
      WordObj.Quit
      Set WordObj = Nothing
      End Function
</PRE><P>
   Using Microsoft Word 7.0:
<P>
<P><PRE>      Function PrintDoc()
      Dim WordObj As Object
      Set WordObj = CreateObject("Word.Basic")
      WordObj.FileOpen "C:\Wordtest.doc"
      ' Where 2 is the number of copies. In this example, the parameter
      ' names have been included to show which argument does what.
      WordObj.FilePrint Background:=0, AppendPrFile:=0, Range:=0, _
      PrToFileName:="", From:="", To:="", Type:=0, NumCopies:=2
      ' The following line demonstrates how to preview instead of print
      ' WordObj.FilePrintPreview.
      ' Close without saving.
      WordObj.FileClose 2
      Set WordObj = Nothing
      End Function
</PRE>
<P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ? PrintDoc()
</PRE><P>
</OL><h3>Example - Printing a Microsoft Word Document in a Form's Object Frame</h3>
 
<P>
This example shows how to print an embedded Microsoft Word object on a
form.

<OL><P><LI>Start Microsoft Access and open any database.

<P><LI>Create a new form not based on any table or query in Design view.

<P><LI>Add an unbound object frame control to the form.

<P><LI>In the Insert Object dialog box, click Create From File and type
   C:\Wordtest.doc in the File box. Click OK.

<P><LI>Set the Name property of the object frame to OLEObj.

<P><LI>Add a command button to the form and set the following properties:
<P>
<P><PRE>      Command Button:
<PRE></PRE>         Name: PrintDoc
         Caption: Print Word Doc
         OnClick: [Event Procedure]

</PRE><P><LI>Click the Build button next to the command button's OnClick property and
   type the following procedure:
<P>
   Using Microsoft Word 97:
<P>
<P><PRE>      Private Sub PrintDoc_Click()
      Dim WordObj As Object
<PRE></PRE>      Me![OLEObj].Verb = -2   'Tells Access to open the application
      Me![OLEObj].Action = 7  'Activates the application
      Set WordObj = Me![OLEObj].Object.Application
      WordObj.PrintOut Background:=False
      WordObj.Quit
      Set WordObj = Nothing
      End Sub

   Using Microsoft Word 7.0:

      Private Sub PrintDoc_Click()
      Dim WordObj As Object
      Me![OLEObj].Verb = -2   'Tells Access to open the application
      Me![OLEObj].Action = 7  'Activates the application
      Set WordObj = Me![OLEObj].Object.Application.WordBasic
      ' This example prints the current document using FilePrintDefault.
      WordObj.FilePrintDefault
      ' The following line demonstrates how to preview instead of print.
      ' Comment out the FileClose method that follows, in order to leave
      ' Print Preview open.
      ' WordObj.FilePrintPreview
      WordObj.FileClose 2
      End Sub

</PRE><P><LI>Open the form in Form view and click the Print Word Doc button. Note
   that Microsoft Word starts, prints the document, and then returns to
   the form.
<P>
</OL>NOTE: In both examples, when the Automation object goes out of scope,
the instance of Microsoft Word is unloaded, unless the object was created
from a previous instance (already opened).
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using Automation, search the Help Index for
"Automation."
<P>
For more information about the Verb and Action properties, search the Help
Index for "Verb property" or "Action property."
 
<PRE>Keywords          : AutoGnrl kbinterop IntpOleA
Technology        : kbole
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
