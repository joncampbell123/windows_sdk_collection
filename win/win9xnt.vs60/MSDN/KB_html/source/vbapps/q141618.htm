

<HTML>
<HEAD>
<TITLE>ACC: Changing Application Title Using Visual Basic (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141618">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how you can programmatically change the title bar text, also referred to as the Application Title, in Microsoft Access version 7.0 and 97 using Visual Basi...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QBTM,QAMB,QAY5,QAJH,QDN9,QBXS,QAUJ,QATX,QAB9,QAZV,QAPN,QBV8,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Changing Application Title Using Visual Basic (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141618</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how you can programmatically change the title bar
text, also referred to as the Application Title, in Microsoft Access
version 7.0 and 97 using Visual Basic for Applications.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Unless you set the Application Title in the Startup dialog box to
something different for your database, the default text that appears in
the title bar is "Microsoft Access."
<P>
You can manually change the Application Title property of a database by
clicking Startup on the Tools menu, and then typing a new name in the
Application Title box. Then, whenever you open the database, the title bar
text displays the name you typed.
<P>
You can also programmatically change the Application Title setting every
time the database opens by using Visual Basic. As an example, the following
steps demonstrate how to set the Application Title to the name of the
current database and the name of the current user in the database.

<OL><P><LI>Create a module and type the following procedures:
<P>
<P><PRE>      Function SetApplicationTitle(ByVal MyTitle As String)
<PRE></PRE>         If SetStartupProperty("AppTitle", dbText, MyTitle) Then
            Application.RefreshTitleBar
         Else
            Msgbox "ERROR: Could not set Application Title"
         End If
      End Function

      Function SetStartupProperty(prpName As String, _
            prpType As Variant, prpValue As Variant) As Integer
         Dim DB As DATABASE, PRP As Property, WS As Workspace
         Const ERROR_PROPNOTFOUND = 3270

         Set DB = CurrentDb()

         ' Set the startup property value.
         On Error GoTo Err_SetStartupProperty
         DB.Properties(prpName) = prpValue
         SetStartupProperty = True

      Bye_SetStartupProperty:
         Exit Function

      Err_SetStartupProperty:
         Select Case Err
         ' If the property does not exist, create it and try again.
         Case ERROR_PROPNOTFOUND
            Set PRP = DB.CreateProperty(prpName, prpType, prpValue)
            DB.Properties.Append PRP
            Resume
         Case Else
            SetStartupProperty = False
            Resume Bye_SetStartupProperty
         End Select
      End Function

      Function CurrentMDB() As String
         Dim i As Integer, FullPath As String
         FullPath = CurrentDb.Name
         ' Search backward in string for back slash character.
         For i = Len(FullPath) To 1 Step -1
            ' Return all characters to the right of the back slash.
            If Mid(FullPath, i, 1) = "\" Then
               CurrentMDB = Mid(FullPath, i + 1)
               Exit Function
            End If
         Next i
      End Function

</PRE><P><LI>Create the following macro and save it as AutoExec:
<P>
<P><PRE>      Macro Name  Action
      -------------------
<PRE></PRE>      AutoExec    Runcode

      AutoExec Actions
      ---------------------------------------------------------------
      RunCode
         Function Name: =SetApplicationTitle(CurrentMDB() &amp; " - " &amp; _
              CurrentUser)

   NOTE: In the Function Name setting above, the underscore (_) at the end
   of the line is used as a line-continuation character. Remove the
   underscore from the end of the line when typing the Function Name
   setting.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about changing the application title bar, search for
"apptitle," and then "AppTitle Property" using the Microsoft Access 97 Help
Index.
 
<PRE>Keywords          : kbprg PgmHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
