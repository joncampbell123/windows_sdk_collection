

<HTML>
<HEAD>
<TITLE>ACC: Eliminating White Space in Reports with CanShrink &amp; Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95390 ">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="kbusage RptLayou">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Before printing a form or report, you can save space by conditionally reducing the sizes of the controls on the form or report. For example, you might want to reduce the size of ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA7O,QAB5,QDN9,QAOE,QAMN,QBT6,QBS0,QBV4,QAPF,QAPN,QAYV,QAL2,QAMB,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Eliminating White Space in Reports with CanShrink &amp; Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95390 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Before printing a form or report, you can save space by conditionally
reducing the sizes of the controls on the form or report. For example,
you might want to reduce the size of text boxes that contain varied-length
text or reduce the size of text boxes bound to fields that could be empty.
<P>
Before you try to reduce the size of controls in reports, however, consider
the following:

<UL><LI>Overlapping controls will not shrink, even when the CanShrink property
   is set to Yes.

<LI>Controls shrink line by line (vertically). This means, for example, that
   if there are a group of controls placed on the left side of the page and
   a large control (for example, an OLE picture) on the right side of the
   page, the controls on the left side of the page will not shrink, unless
   the picture is blank and hidden.

<LI>Space between controls is not affected by the CanShrink or CanGrow
   properties.

<LI>Controls located in the Page Header or Page Footer will not shrink
   or grow in Microsoft Access version 1.x.

<LI>Controls located in the Page Header or Page Footer can shrink and grow
   in Microsoft Access 2.0, 7.0, and 97. However, the sections do not
   have CanGrow and CanShrink properties. This means, you can still have
   blank space in a Page Header or Page Footer section (even though its
   controls may shrink).
<P>
</UL>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
A control containing null information automatically shrinks to nothing and
disappears when its CanShrink property is set to Yes, but the space
between the controls is not affected by the CanShrink property.
<P>
For example, say you have 11 controls in a column of a report, and there is
.1 inch of space between each control. Even if all 11 controls contain null
information and all 11 have their CanShrink property set to Yes, the space
between the controls adds up to 1 inch. When you print the report, even
though the 11 controls are not printed, the first control that does contain
text will print 1 inch lower than you might expect because of all the
accumulated space.
<P>
A good way to manage the size of your controls is to have as few as
possible. This will minimize the white space between the controls.
<P>
The following example demonstrates how to print mailing labels by using
a Visual Basic function to minimize the number of controls and to give you
nice, even spacing. Say you want to create mailing labels containing a
name, business name, address, city, state, and zip code. You could use
several different fields, but it would be better to use a single text box,
as in the following step-by-step example:

<OL><P><LI>Create a new module and type the following line in the declarations
   section if the line is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedures:
<P>
<P><PRE>      Function AddressBlock$ (AName, Addr1, Addr2, City, State, Zip)
<PRE></PRE>         Dim A1$, A2$, A3$, A4$, CR$

         CR$ = Chr(13) &amp; Chr(10)  'Carriage return and line feed.

         A1$ = IIf(ISB(AName),"",AName &amp; CR$)
         A2$ = IIf(ISB(Addr1),"",Addr1 &amp; CR$)
         A3$ = IIf(ISB(Addr2),"",Addr2 &amp; CR$)
         A4$ = City &amp; ", " &amp; State &amp; " " &amp; Zip

         AddressBlock = A1$ &amp; A2$ &amp; A3$ &amp; A4$   'Concatenate the strings.
      End Function

      Function ISB (V) As Integer
         If IsNull(V) or V = "" Then ISB = True Else ISB = False
      End Function

</PRE><P><LI>To test this function, create a blank report based on the Employees
   table in the Northwind.mdb (or NWIND.MDB in versions 1.x and 2.0). Set
   the detail section Height property to 0.1667 inches.

<P><LI>Create a single text box control with the CanGrow property set to Yes,
   the Height property set to the 0.1667", and delete the associated label.
   Set its ControlSource property to the following expression:
<P>
   NOTE: In the following example, an underscore(_) is used as a
   line-continuation character. Remove the underscore from the end
   of the line when re-creating this example.
<P>
   =AddressBlock([LastName],[Title],[Address],[City],[Region],_
<P><PRE>       [PostalCode])
</PRE><P>
   NOTE: In Microsoft Access 2.0 and earlier there are spaces in the
   [Last Name] and [Postal Code] fields.
<P>
</OL>Now you can print your report, and the report will automatically run the
function and keep wasted space to a minimum.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the CanShrink or CanGrow property, search the
Help Index for "CanShrink" or "CanGrow," or ask the Microsoft Access 97
Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: shrinking functions<BR>
Keywords          : kbusage RptLayou<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
