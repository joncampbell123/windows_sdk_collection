

<HTML>
<HEAD>
<TITLE>XL: Macro with OnEntry or ON.ENTRY() Not Activated </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125810">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/02/06">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmEvnt PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, the Microsoft Visual Basic for Applications OnEntry property or the Microsoft Excel 4.0 ON.ENTRY() macro function runs a macro when data is entered in any cell on a specified worksheet. Note, however, that you must first run the...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAVX,QAVW,QAUD,QAB9,QBWS,QBS0,QAY5,QAUR,QDNM,QAVZ,QBBI,QBV8,QBVV P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Macro with OnEntry or ON.ENTRY() Not Activated</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125810</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, the Microsoft Visual Basic for Applications OnEntry
property or the Microsoft Excel 4.0 ON.ENTRY() macro function runs a macro
when data is entered in any cell on a specified worksheet. Note, however,
that you must first run the macro containing the OnEntry property or
ON.ENTRY() function in order for it to be effective.
<P>
To run the macro with the OnEntry property or ON.ENTRY() function, use the
appropriate procedure below to define an auto_open procedure or macro on
the specified worksheet. The auto_open procedure should contain either the
OnEntry property or the ON.ENTRY() function, and it should specify another
macro that will be run when you enter data on the worksheet.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE><h3>Microsoft Excel 5.0 or Later</h3>
 

<OL><P><LI>In a new Visual Basic module, enter the following:
<P>
<PRE>      Sub Auto_Open()
          Worksheets("Sheet1").OnEntry = "Test"
      End Sub

      Sub Test()
          MsgBox "A key was pressed."
      End Sub

</PRE><P><LI>Save the workbook as Test.xls, and close it.
<P>
</OL>When you open Test.xls, the auto_open macro will run automatically. When
you enter data in any cell on Sheet1 of Test.xls, a message box is 
displayed.
<P>
<P><h3>Microsoft Excel version 4.0</h3>
 

<OL><P><LI>Enter the following in a new Microsoft Excel 4.0 macro sheet:
<P>
<PRE>      A1: Auto_Open                       B1: Test
      A2: =ON.ENTRY("SHEET1.XLS","test")  B2: =ALERT("A key was pressed.")
      A3: =RETURN()                       B3: =RETURN()

</PRE><P><LI>Define cells A1 and B1 as command macros by clicking Define Name on
   the Formula menu.

<P><LI>Save the macro sheet as On_entry.xlm.

<P><LI>Select any cell on a worksheet, and click Define Name on the Formula
   menu. In the Name box, type "Auto_Open" (without the quotation marks).

<P><LI>In the Refers To box, type a reference to the macro sheet and the cell
   containing the ON.ENTRY() function. For example, type
   "=On_entry.xlm!$A$1" (without the quotation marks).

<P><LI>Save the worksheet as On_entry.xlm.
<P>
</OL>When the On_entry.xls worksheet is opened, On_entry.xlm will also be
opened, and the Auto_Open macro will be run. When you enter data in any
cell on On_entry.xls, an alert box will be displayed.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, page 302
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.00a 5.00 5.00a 5.00c 7.00 7.00a XL98 XL97 <BR>
XL7 XL5 XL4<BR>
Keywords          : kbcode kbprg PgmEvnt PgmHowto<BR>
Version           : WINDOWS:4.0,5.0,5.0c,7.0,7.0a,97; MACINTOSH:4.0,5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
