

<HTML>
<HEAD>
<TITLE>ACC: Maximized Form Shows Control Box, Min/Max/Restore Buttons </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128196">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1995/03/27">
<META NAME="Keywords" CONTENT="kbusage PgmApi FmsProp">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  In Microsoft Access 97, a form whose ControlBox, MinMaxButtons, and ControlBox properties are set to No still displays the Restore and Close buttons when you maximize the fo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA4Q,QBS0,QAFF,QAY5,QAH4,QBW1,QA5F,QAMA,QAB9,QBV8,QAJH,QAI2,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Maximized Form Shows Control Box, Min/Max/Restore Buttons</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128196</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
In Microsoft Access 97, a form whose ControlBox, MinMaxButtons, and
ControlBox properties are set to No still displays the Restore and Close
buttons when you maximize the form.
<P>
In Microsoft Access 2.0, a form whose ControlBox, MinButton, and MaxButton
properties are set to No still displays the Control-menu box and a Restore
button when you maximize the form.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Access is a multiple document interface (MDI) application. The
default behavior for an MDI application is for all maximized child windows
to always display a Control-menu box and a Restore button.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can simulate maximizing a window by sizing it as large as possible
in the restored, windowed (non-maximized), state using the following
technique.
<P>
The following example demonstrates how to create and use a sample Sub
procedure called MaximizeRestoredForm to restore a form if it is maximized
and then move it to the upper left corner of the Microsoft Access client
area window and size it as large as possible.
<P>
NOTE: This technique will produce a blank section at the top of the form
that is approximately the height and width of a toolbar, if the form is
opened in Design view, and then switched to Form view. This code works best
when the form is opened from the Database window or through code while
running the application.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Create a new module and type the following lines in the Declarations
   section:
<P>
   In Microsoft Access 97:
<P>
<P><PRE>      Type Rect
<PRE></PRE>         x1 As Long
         y1 As Long
         x2 As Long
         y2 As Long
      End Type

      Declare Function GetWindowRect Lib "user32" (ByVal hwnd As Long, _
         lpRect As Rect) As Long
      Declare Function IsZoomed Lib "user32" (ByVal hwnd As Long) As Long
      Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal _
         nCmdShow As Long) As Long
      Declare Function MoveWindow Lib "user32" (ByVal hwnd As Long, ByVal _
         X As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight _
         As Long, ByVal bRepaint As Long) As Long
      Declare Function GetParent Lib "user32" (ByVal hwnd As Long) As Long

      Public Const SW_MAXIMIZE = 3
      Public Const SW_SHOWNORMAL = 1

   In Microsoft Access 2.0:

      Option Explicit

      Type Rect
         x1 As Integer
         y1 As Integer
         x2 As Integer
         y2 As Integer
      End Type

      Declare Sub GetWindowRect Lib "User" (ByVal hWnd As Integer, _
         lpRect As Rect)
      Declare Function IsZoomed Lib "User" (ByVal hWnd As Integer) _
         As Integer
      Declare Sub ShowWindow Lib "User" (ByVal hWnd%, ByVal nCmdShow%)
      Declare Sub MoveWindow Lib "User" (ByVal hWnd As Integer, _
         ByVal X As Integer, ByVal Y As Integer, ByVal nWidth As _
         Integer, ByVal nHeight As Integer, ByVal bRepaint As Integer)
      Declare Function GetParent Lib "User" (ByVal hWnd As Integer) _
         As Integer

      Const SW_MAXIMIZE = 3
      Const SW_SHOWNORMAL = 1

</PRE><P><LI>Type the following Sub procedure in the module:
<P>
<PRE>      Sub MaximizeRestoredForm (F As Form)
         Dim MDIRect As Rect

         ' If the form is maximized, restore it.
         If IsZoomed(F.hWnd) &lt;&gt; 0 Then
            ShowWindow F.hWnd, SW_SHOWNORMAL
         End If

         ' Get the screen coordinates and window size of the
         ' MDIClient window.
         GetWindowRect GetParent(F.hWnd), MDIRect

            ' Move the form to the upper left corner of the MDIClient
            ' window (0,0) and size it to the same size as the
            ' MDIClient window.
            MoveWindow F.hWnd, 0, 0, MDIRect.x2 - MDIRect.x1, _
               MDIRect.y2 - MDIRect.y1, True
      End Sub

</PRE><P><LI>To simulate maximizing a form automatically when it is opened, set the
   form's OnLoad property to the following event procedure:
<P>
<PRE>      Sub Form_Load()
         MaximizeRestoredForm Me
      End Sub

</PRE><P><LI>To simulate maximizing a form called MyForm, use the following statement
   in a function or subroutine:
<P>
<P><PRE>      MaximizeRestoredForm Forms!MyForm
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
This behavior does not occur in Microsoft Access 7.0.
 
<PRE>Keywords          : kbusage PgmApi FmsProp
Version           : 2.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
