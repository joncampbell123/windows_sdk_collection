

<HTML>
<HEAD>
<TITLE>OL97: Working With the Message or Body of an Outlook Item </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172755">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1997/08/14">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article describes how Microsoft Outlook 97 implements the Message or Notes field and answers some common questions regarding its use when customizing Outlook forms.  MORE INFORMATION  NOTE: This article discusses using fields and controls with...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QAYC,QBVO,QAEV,QAB5,QABC,QAOE,QAMN,QAMB,QBDM,QDMZ,QATX,QAPN,QBUP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OL97: Working With the Message or Body of an Outlook Item</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172755</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how Microsoft Outlook 97 implements the Message or
Notes field and answers some common questions regarding its use when
customizing Outlook forms.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This article discusses using fields and controls with Outlook forms
and it is important to understand the difference between the two.
<P>
For more information on the differences between fields and controls, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q168975.htm">Q168975</A></B>
   Title     : OL97: How to Use Fields and Controls with VBScript

</PRE><h3>Working with the Message or Notes Field</h3>
 
<P>
The Message field is most commonly associated with a Mail Message form and
is the main portion or "body" of the message. This is a unique field
because it supports Rich Text Formatting (RTF), meaning that you can change
various attributes of the text, such as the font size and formatting. You
can also embed objects, such as shortcuts or files into the message field.
<P>
This field also exists on other Outlook forms. On a Post form, it is called
the Message field, but on all other forms, it is referred to as the Notes
field. When accessing this field through the Outlook object model, use the
Body property of the appropriate item (ContactItem, PostItem, and so on).
<P>
The following table summarizes the naming conventions:
<P>
<PRE>   Item Type          Field Name    Property Name
   ---------          ----------    -------------
   Mail               Message       Body
   Post               Message       Body
   Contact            Notes         Body
   Appointment        Notes         Body
   Meeting Request    Notes         Body
   Task               Notes         Body
   Task Request       Notes         Body
   Journal            Notes         Body
   Note*              N/A           Body

   * You cannot customize "Note" items.

</PRE>NOTE: The remainder of this article will use the term "Message field", but
unless otherwise noted, information will apply to the Notes field as well.
<P>
Each Outlook item contains one Message field to store RTF information; it
is not possible to add an additional field of the same type as the Message
field.
<P>
<P><h3>Working with the Message or Notes Control</h3>
 
<P>
When designing an Outlook form, you can use the Message control more than
once on a form. However, when you insert a second Message control on a
form, Outlook displays the following warning:
<P>
<PRE>   This form has more than one Message or Notes control. If more than
   one control is visible at run time, only one control works.

</PRE>This warning may also appear when you use the form, (at "run time") such as
when you switch to a form page that contains a second Message control.
<P>
Outlook controls are typically bound to MAPI fields to store the actual
data and each Outlook form (or item) has only one field that supports RTF.
Therefore, when you drag the Message field from the Field Chooser onto the
form, it is automatically bound to the appropriate Outlook field. You
cannot change this behavior. If there is more than one Message field on a
form, they all display the same data since there is only one field of this
type permitted for each Outlook form. However, if you change data in one of
the Message fields, it does not automatically replicate to the other
Message field unless you refresh the field by saving and reopening the form
or setting the Body property via code. This is the main reason for the
warning message mentioned above.
<P>
The control used to display the Message field is built into the Outlook
program and is not designed for use on non-Outlook forms. However, you can
add the control to the Control Toolbox since it is a registered control on
the system. Use your right mouse button to click on a blank area of the
Control Toolbox and from the context-sensitive menu, click Custom Controls.
"Outlook DocSite OLE Control." should appear in the list of available
controls. This is the control used to display the Message field.
<P>
NOTE: The other Outlook-specific control is the "Outlook Recipient
Collection Edit OLE Control," which is used for the To and From fields on a
Mail Message. It is specifically designed to resolve e-mail addresses and
provide other functionality specific to fields containing e-mail addresses,
such as handling copy and paste between fields of this type.
<P>
<P><h3>Working with the Body Property</h3>
 
<P>
Although you can use Rich Text Formatting through the user interface, when
you use the Body property from Microsoft Visual Basic Script (VBScript) or
Microsoft Visual Basic for Applications automation code, all of the text
formatting is lost. This is because the data type of the Body field is
text, so it behaves no differently than other types of controls, such as a
label or textbox.
<P>
You can write VBScript code that will retrieve the Body of the message and
add text to the beginning of it; however, you cannot preserve the text
formatting. Use the Body property to retrieve the text that is in the body.
Programmatically add extra text to the beginning of the body (Item.Body =
"Added text" &amp; Item.Body). When VBScript replaces the text in the field,
the text is unformatted and any previous formatting is lost. There is no
workaround to this limitation.
<P>
For more information on manipulating text within a form's Message field,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q162995.htm">Q162995</A></B>
   Title     : OL97: VBScript Cannot Access Characters in the Body Property

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about creating solutions with Microsoft Outlook 97,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q166368.htm">Q166368</A></B>
   Title     : OL97: How to Get Help Programming with Outlook

   Article-ID: <B><A href="../vbapps/q170783.htm">Q170783</A></B>
   Title     : OL97: Q&amp;A: Questions about Customizing or
               Programming Outlook
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OutSol OutSol97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
