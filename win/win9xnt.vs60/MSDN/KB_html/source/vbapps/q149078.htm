

<HTML>
<HEAD>
<TITLE>ACC: How to Add Appointments to Schedule+ using Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149078">
<META NAME="KBModify" CONTENT="1997/09/03">
<META NAME="KBCreate" CONTENT="1996/03/27">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to add appointments automatically to Microsoft Schedule+ for Windows 95 using Automation.  This article assumes that you are familiar with Visu...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBDP,QBXS,QDN9,QBS0,QAIJ,QAL4,QACE,QAU3,QAPN,QAMR,QA2K,QAY5,QAH4,QBVO P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Add Appointments to Schedule+ using Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149078</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to add appointments automatically to
Microsoft Schedule+ for Windows 95 using Automation.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The example described below creates a table for storing appointment
information, such as date, start time, end time, and a brief description.
Then, it creates a form with a command button, which runs a custom Visual
Basic for Applications procedure. The code uses Automation to connect
with Microsoft Schedule+ and to create new appointments using information
stored in the table.
<P>
To add appointments to Microsoft Schedule+, follow these steps:

<OL><P><LI>Create a new table in Design view with the following structure:
<P>
       Table: Conference Sessions
       --------------------------
       Field Name: Session
<PRE>          Data Type: Text
       Field Name: Date
          Data Type: Text
       Field Name: Start Time
          Data Type: Text
       Field Name: End Time
          Data Type: Text

</PRE><P><LI>Save the table as Conference Sessions. Switch to Datasheet view and
    add the following four records:
<P>
<PRE>     Session                                  Date    Start Time  End Time
     ---------------------------------------------------------------------
     DMT408:Distributing Access Applications  4/16/96   11:30 AM   1:00 PM
     OFC307:Overview of Office Object Models  4/16/96    9:30 AM  11:30 AM
     OFC401:Performance Optimization          4/17/96    2:30 PM   4:30 PM
     OFC406:Access External Data              4/18/96   11:30 AM   1:00 PM

</PRE><P><LI>Create a new form based on the Conferences Sessions table using the
    AutoForm: Tabular Wizard.

<P><LI>Switch the form to Design view.

<P><LI>Select the form footer and set its Height property to .5 inches.

<P><LI>Add a command button to the form footer with the following properties:
<P>
       Name: AddAppt
       Caption: Add Appointments
       OnClick: =AddAppts()

<P><LI>On the View menu, click Code to open the form module.

<P><LI>In the General section of the module, add the following procedure:
<P>
       Function AddAppts()
       On Error GoTo Command1_Click_error
<P>
<PRE>          Dim objApp As Object, objSched As Object
          Dim objTable As Object, objItem As Object
          Dim db As DATABASE, rs As Recordset, i As Integer, UserName As _
             String
          Dim startDateTime As Variant, endTime As Variant, apptText As _
             Variant

          ' Connect to Schedule+ and check if user is logged on or not
          ' logged on.
          Set objApp = CreateObject("SchedulePlus.Application")
             If Not objApp.LoggedOn Then
                UserName = InputBox("Please enter your profile name." &amp; _
                           Chr(13) &amp; Chr(13) &amp; "Example: Nancy Davolio")
                   If UserName = "" Then
                      Set objApp = Nothing
                      Exit Function
                   End If
                objApp.Logon UserName, " ", True
             End If
          Set objSched = objApp.ScheduleLogged
          Set objTable = objSched.SingleAppointments

          ' Create a recordset from the Conference Sessions table.
          Set db = CurrentDb()
          Set rs = db.OpenRecordset("Conference Sessions")

             ' Loop through recordset and retrieve values for appointments.
             For i = 0 To rs.RecordCount - 1
                startDateTime = rs!Date &amp; " " &amp; rs![start time]
                endTime = rs!Date &amp; " " &amp; rs![end time]
                apptText = rs!session

                ' Create a new appointment and set its properties.
                Set objItem = objTable.New
                   objItem.SetProperties Text:=apptText, _
                   BusyType:=CLng(1), Start:=CDate(startDateTime), _
                   End:=CDate(endTime)

                rs.MoveNext
             Next I

          ' Log off Schedule+ and release the objects.
          objApp.logoff
          Set objApp = Nothing
          Set objSched = Nothing
          Set objItem = Nothing
          Set objTable = Nothing

          MsgBox i &amp; " appointments were added to Schedule+."
          Exit Function

       Command1_Click_error:
          If Err = -2147221229 Or Err = 5 Or Err = 3270 Then
             MsgBox "Operation canceled."
          Else
             MsgBox "Error: " &amp; Err &amp; " " &amp; Error
          End if
          Exit Function

       End Function

</PRE><P><LI>Close the form module and switch the form to Form view.

<P><LI>Click the Add Appointments button to create appointments in Microsoft
    Schedule+. If you are not currently logged on to Microsoft Schedule+,
    you are asked for your profile name. Once logged on, the AddAppts()
    function creates four new appointments for you using information
    stored in the Conference Sessions table.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For information about using Automation to add appointments to Microsoft
Outlook, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q160502.htm">Q160502</A></B>
   TITLE     : ACC: Using Automation to Add Appointments to Microsoft
               Outlook

</PRE></OL>For more information about using Automation in Microsoft Access, search
the Help Index for "Automation," or ask the Microsoft Access 97 Office
Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OLE<BR>
Keywords          : AutoGnrl kbinterop IntpOleA<BR>
Technology        : kbole<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
