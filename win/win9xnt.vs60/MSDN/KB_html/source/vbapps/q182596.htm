

<HTML>
<HEAD>
<TITLE>XL97: Revised Dao350.dll File for "No current row" Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182596">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/17">
<META NAME="Keywords" CONTENT="xlvbainfo xlwin xldao kbprg OffVBA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  A revised Dao350.dll file that fixes a problem that may occur when you run a Visual Basic for Applications macro that uses Data Access Objects (DAO) is available. When this problem occurs, the following error message appears:     Run-time error '40...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVP,QAB4,QA5F,QART,QAMA,QAC9,QBWS,QAAP,QDL9,QBWO,QBWN,QAA1,QAH4,QDNN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Revised Dao350.dll File for "No current row" Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182596</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A revised Dao350.dll file that fixes a problem that may occur when you run
a Visual Basic for Applications macro that uses Data Access Objects (DAO)
is available. When this problem occurs, the following error message
appears:
<P>
<PRE>   Run-time error '40009':
   No current row.

</PRE>For additional information about this problem, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q172322.htm">Q172322</A></B>
   TITLE     : XL97: Run-Time Error 40009 when you Run DAO Macro

</PRE>The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/newdao.exe">Newdao.exe</A> <I>(size: 255200 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>The FTP location is the following:
<P>
<PRE>   <B><A href="ftp://ftp.microsoft.com/softlib/mslfiles/">ftp://ftp.microsoft.com/Softlib/MSLFILES/</A></B>

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This Dao350.dll file is the same file that is included with Microsoft Excel
97. The version and date of the file have been changed to prevent Microsoft
Visual Basic version 5.0 from replacing Dao350.dll with a newer version
that is not fully compatible with Microsoft Excel 97.
<P>
After you install this revised file, you can install Microsoft Visual Basic
or custom Visual Basic applications without having to manually replace the
Dao350.dll file that is included with Microsoft Excel 97 after each
installation. To see the contents of the Readme file that is included with
the revised Dao350.dll file, see the "Contents of the Readme File" section.
<P>
NOTE: This revised file does not resolve the problem if the recordset
contains a field of type BIGINT.
<P>
<P><h3>Contents of the Readme File</h3>
 
<P>
The revised Dao350.dll file that is included in the Newdao.exe
file corrects a problem that prevents you from running Visual Basic(R)
for Applications macros that use Data Access Objects (DAO). Without
this revised Da0350.dll, the macro may fail and you may receive the
following error message:
<P>
<PRE>   Run-time error '40009':
   No current row.

</PRE>NOTE: This is the same Dao350.dll that is included with Microsoft
Excel 97 for Windows(R). The version and date of Dao350.dll have been
changed to prevent Microsoft Visual Basic version 5.0 (or a Visual
Basic application that uses DAO) from replacing it with a version of
the file that has a later date but that is not fully compatible with
Microsoft Excel 97.
<P>
To correct the problem, follow these steps:

<OL><P><LI>Close all programs.

<P><LI>On the Start menu, point to Find, and click Files Or Folders.

<P><LI>In the Named box, type "Dao350.dll" (without the quotation marks).
   In the Look In box, select "(C:)" (or the hard disk drive
   in which Microsoft Windows is located). Click to select the
   Include Subfolders check box, and then click Find Now.
<P>
   One copy of the original Dao350.dll should be in the following
   folder
<P>
<P><PRE>      &lt;WinDrv&gt;\Program Files\Common Files\Microsoft Shared\Dao
</PRE><P>
   where &lt;WinDrv&gt; is the disk drive letter for the hard disk on
   which Windows is installed.

<P><LI>Right-click each Dao350.dll file. On the shortcut menu, click
   Rename. Change the name of the file to "Dao350.vb5" (without
   the quotation marks). Press ENTER.
<P>
   These files are backup copies of the existing Dao350.dll files.

<P><LI>Start Microsoft(R) Windows Explorer and open the following folder
<P>
<P><PRE>      &lt;WinDrv&gt;\Program Files\Common Files\Microsoft Shared\Dao
</PRE><P>
   where &lt;WinDrv&gt; is the disk drive letter for the hard disk
   on which Windows is installed.

<P><LI>Copy the downloaded Dao350.dll into the folder you opened in
   step 5.
<P>
</OL>You can now safely install Microsoft Visual Basic version 5.0 (or
Microsoft Visual Basic applications that use DAO) without affecting
DAO in Visual Basic for Applications.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about getting help with Visual Basic for Applications,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Run-time error 40009 vba<BR>
Keywords          : xlvbainfo xlwin xldao kbprg OffVBA<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
