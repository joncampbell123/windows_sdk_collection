

<HTML>
<HEAD>
<TITLE>How to Fill a UserForm ListBox with Database Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164923">
<META NAME="KBModify" CONTENT="1997/11/10">
<META NAME="KBCreate" CONTENT="1997/03/10">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article includes a Visual Basic for Applications sample macro that fills a ListBox control with values from an external database using the DAO 3.5 Object Library reference.  MORE INFORMATION  Microsoft provides examples of Visual Basic for App...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAZV,QBVR,QAH4,QAPF,QAKD,QBCF,QA7O,QBXS,QBHQ,QA7N,QAB3,QAW6,QAPN,QAFF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Fill a UserForm ListBox with Database Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164923</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic for Applications included with:
   - Microsoft Word 97 for Windows
   - Microsoft PowerPoint 97 for Windows
   - Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article includes a Visual Basic for Applications sample macro that
fills a ListBox control with values from an external database using the DAO
3.5 Object Library reference.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures
for illustration only, without warranty either expressed or implied,
including, but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. The Visual Basic procedures in
this article are provided 'as is' and Microsoft does not guarantee that
they can be used in all situations. While Microsoft support engineers can
help explain the functionality of a particular macro, they will not modify
these examples to provide added functionality, nor will they help you
construct macros to meet your specific needs. If you have limited
programming experience, you may want to consult one of the Microsoft
Solution Providers. Solution Providers offer a wide range of fee-based
services, including creating custom macros. For more information about
Microsoft Solution Providers, call Microsoft Customer Information Service
at (800) 426-9400.
<P>
This Visual Basic for Applications example uses three routines for future
expansion and portability. To use the procedures, place them in the
UserForm module. These procedures are as follows:

<UL><LI>The UserForm Initialize procedure sets the database values to use, such
   as the database path and name values, and sets the table and field
   values in the selected table.

<LI>The DBConnect procedure makes the actual connections to the database,
   the table, and the fields that you want to use.

<LI>The PopulateListBoxData procedure populates the list box.
<P>
</UL><h3>Referencing the DAO 3.5 Object Library</h3>
 
<P>
For this example to work, you must add the DAO 3.5 Object Library
reference.
<P>
To add the DAO 3.5 Object Library reference, use the following steps:

<OL><P><LI>In the Visual Basic Editor, click References on the Tools menu to
   display the References dialog box.
<P>
   The References dialog box displays all object libraries and projects
   that are registered with the operating system.

<P><LI>Scroll through the list for the library you want to reference. If the
   application is not listed, click Browse to search for object library
   (.olb and .tlb) files or executable (.exe and .dll) files. References
   with check boxes that are selected are used by the project; references
   with check boxes that aren't selected are not used.

<P><LI>Click to select the check box for the reference in the Available
   References list and click OK.
<P>
</OL><h3>Typing the Code in the UserForm</h3>
 
<P>
Type the following code in the General Declarations section of the
UserForm:
<P>
<PRE>   Public oDataBase As Database
   Public oWorkSpace As Workspace
   Public oRecordSet As Recordset
   Public strDB As String
   Public strDBTable As String
   Public strDBField As String

</PRE></OL><h3>Sample Macro</h3>
 
<P>
The following example macro uses the Microsoft Access 97 Northwind.mdb
database, which is located in the default Office folder in the Samples
folder:
<P>
<PRE>   Private Sub UserForm_Initialize()
      ' ********************************************
      ' Form initialization.
      ' Enter all values here for Database, Table
      ' and Field to use.
      ' ********************************************
      ' DataBase to Use.
      strDB = Options.DefaultFilePath(wdProgramPath) &amp; _
      "\Samples\Northwind.mdb"
      ' Database Table to Use.
      strDBTable = "Customers"
      ' Database Field to Use.
      strDBField = "CompanyName"
      DBConnect
      PopulateListBoxData
   End Sub

   Sub DBConnect()
      ' ********************************************
      ' Initializes Jet workspace and opens a database
      ' ********************************************
      ' Establish database WorkSpace.
      Set oWorkSpace = CreateWorkspace(Name:="JetWorkspace", _
      UserName:="admin", Password:="", UseType:=dbUseJet)
      ' Open the database.
      Set oDataBase = OpenDatabase(strDB)
      ' Set the record set to the specified table.
      Set oRecordSet = oDataBase.OpenRecordset(strDBTable)
   End Sub

   Sub PopulateListBoxData()
   ' Fill list box with data from selected field in table.
      ' This example populates the list box with values from
      ' the CompanyName field of the Customers table.
      oRecordSet.MoveFirst
      Do Until oRecordSet.EOF
         ListBox1.AddItem oRecordSet.Fields(strDBField)
         oRecordSet.MoveNext ' Move to next record in table.
      Loop
   End Sub

</PRE>NOTE: To use the example, change the values to the full database path and
name and change the values for the table and fields that you want to use.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q164815.htm">Q164815</A></B>
   TITLE     : How To Create And Display A Custom Dialog Box
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: word8 word97 8.00 8.0 vb vbe vba kbwordvba xlvbainfo<BR>
Keywords          : kbprg<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
