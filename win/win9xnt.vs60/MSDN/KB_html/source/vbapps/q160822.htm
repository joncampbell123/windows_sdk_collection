

<HTML>
<HEAD>
<TITLE>ACC: How to Create a PowerPoint Presentation Using Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160822">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/12/10">
<META NAME="Keywords" CONTENT="AutoGnrl kbinterop IntpOleA">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article contains sample Visual Basic for Applications code that uses Automation to create a Microsoft PowerPoint presentation.  This article assumes that you are famili...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVQ,QDKP,QAGX,QBS0,QAM2,QA1S,QBXS,QAG9,QAFF,QBWS,QAPN,QAH4,QAI4,QBQ3,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create a PowerPoint Presentation Using Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160822</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
<LI>Microsoft PowerPoint for Windows 95 version 7.0
<LI>Microsoft PowerPoint 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article contains sample Visual Basic for Applications code that uses
Automation to create a Microsoft PowerPoint presentation.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create the following new form not based on any table or query in Design
   view:
<P>
<P><PRE>      Form: PowerPointDemo
      --------------------
      Caption: PowerPoint Demo
</PRE><P>
<P><PRE>      Command Button:
<PRE></PRE>         Name: cmdPowerPoint
         Caption: PowerPoint Example
         Width: 2"
         OnClick: [Event Procedure]
      Command Button:
         Name: cmdQuit
         Caption: Quit PowerPoint
         Width: 2"
         OnClick: [Event Procedure]

</PRE><P><LI>On the View menu, click Code.

<P><LI>On the Tools menu, click References.

<P><LI>If you have Microsoft PowerPoint 97, click Microsoft PowerPoint 8.0
   Object Library in the Available References box. If that reference does
   not appear, click the Browse button and browse for MSPPT8.OLB, which is
   installed by default in the C:\Program Files\Microsoft Office\Office
   folder.
<P>
   If you have Microsoft PowerPoint 7.0, click PowerPoint 7.0 Object
   Library in the Available References box. If that reference does not
   appear, click the Browse button and browse for Powerpnt.tlb, which is
   installed by default in the C:\Office\Powerpnt folder.

<P><LI>Click OK to close the References dialog box.

<P><LI>Type the following line in the Declarations section of the
   PowerPointDemo form's class module:
<P>
<P><PRE>       Dim ppObj As Object, ppPres As Object
</PRE>
<P><LI>Type the following procedures.
<P>
   For Microsoft PowerPoint 97:
<P>
<P><PRE>      Private Sub cmdPowerPoint_Click()
<PRE></PRE>        Dim xloop As Integer
        On Error Resume Next
        Set ppObj = GetObject(, "PowerPoint.application")
        If Err.Number Then
           Set ppObj = CreateObject("PowerPoint.Application")
           Err.Clear
        End If
        On Error GoTo err_cmdOLEPowerPoint
        Set ppPres = ppObj.Presentations.Add

        With ppPres
           For xloop = 1 To 5
              .Slides.Add xloop, ppLayoutTitle
              .SlideMaster.Background.Fill.PresetTextured _
                 msoTextureOak
              .Slides(xloop).Shapes(1).TextFrame.TextRange.Text = _
                 "Hi!  Page " &amp; xloop
              .Slides(xloop).SlideShowTransition.EntryEffect = ppEffectFade

              Select Case xloop
                 Case 1
                    With .Slides(xloop).Shapes(2).TextFrame.TextRange
                       .Text = "This is an Example of Automation."
                       .Characters.Font.Color.RGB = RGB(255, 255, 255)
                       .Characters.Font.Shadow = True
                    End With
                    .Slides(xloop).Shapes(1).TextFrame.TextRange. _
                       Characters.Font.Size = 50

                 Case 2
                    With .Slides(xloop).Shapes(2).TextFrame.TextRange
                       .Text = "The programs interact seamlessly..."
                       .Characters.Font.Color.RGB = RGB(255, 0, 255)
                       .Characters.Font.Size = 48
                       .Characters.Font.Shadow = True
                    End With
                    .Slides(xloop).Shapes(1).TextFrame.TextRange. _
                       Characters.Font.Size = 90

                 Case 3
                    With .Slides(xloop).Shapes(2).TextFrame.TextRange
                       .Text = "Demonstrating the power..."
                       .Characters.Font.Color.RGB = RGB(255, 0, 0)
                       .Characters.Font.Size = 42
                       .Characters.Font.Shadow = True
                    End With
                    .Slides(xloop).Shapes(1).TextFrame.TextRange. _
                       Characters.Font.Size = 50

                 Case 4
                    With .Slides(xloop).Shapes(2).TextFrame.TextRange
                       .Text = "Of interoperable applications..."
                       .Characters.Font.Color.RGB = RGB(0, 0, 255)
                       .Characters.Font.Size = 34
                       .Characters.Font.Shadow = True
                    End With
                    .Slides(xloop).Shapes(1).TextFrame.TextRange. _
                       Characters.Font.Size = 100

                 Case 5
                    With .Slides(xloop).Shapes(2).TextFrame.TextRange
                       .Text = "Created on the Fly!!!!"
                       .Characters.Font.Color.RGB = RGB(0, 255, 0)
                       .Characters.Font.Size = 72
                       .Characters.Font.Shadow = True
                    End With
                    .Slides(xloop).Shapes(1).TextFrame.TextRange. _
                       Characters.Font.Size = 60

              End Select
           Next
        End With
        ppPres.SlideShowSettings.Run
        Exit Sub
        err_cmdOLEPowerPoint:
        MsgBox Err.Number &amp; " " &amp; Err.Description
      End Sub

      Private Sub cmdQuit_Click()
         ppPres.Close
         Set ppPres = Nothing
         ppObj.Quit
         Set ppObj = Nothing
         MsgBox "Action Complete"
      End Sub

    For Microsoft PowerPoint 7.0:

      Private Sub cmdPowerPoint_Click()
        Dim xloop As Integer
        On Error Resume Next
        Set ppObj = GetObject(, "PowerPoint.application")
        If Err.Number Then
           Set ppObj = CreateObject("PowerPoint.Application")
           Err.Clear
        End If
        On Error GoTo err_cmdOLEPowerPoint
        Set ppPres = ppObj.Presentations.Add

        With ppPres
           For xloop = 1 To 5
              .Slides.Add xloop, ppLayoutTitle
              .SlideMaster.Background.Fill.PresetTextured _
                 ppPresetTextureOak
              .Slides(xloop).Objects(1).Text = "Hi!  Page " &amp; xloop
              .Slides(xloop).SlideShowEffects.EntryEffect = ppEffectFade

              Select Case xloop
                 Case 1
                    .Slides(xloop).Objects(2).Text = _
                       "This is an Example of Automation."
                    .Slides(xloop).Objects(2).Text.CharFormat.Color.RGB = _
                       RGB(255, 255, 255)
                    .Slides(xloop).Objects(2).Text.CharFormat.Shadow = _
                       True
                    .Slides(xloop).Objects(1).Text.CharFormat.Points = 50

                 Case 2
                    .Slides(xloop).Objects(2).Text = _
                       "The programs interact seamlessly..."
                    .Slides(xloop).Objects(2).Text.CharFormat.Color.RGB = _
                       RGB(255, 0, 255)
                    .Slides(xloop).Objects(2).Text.CharFormat.Points = 48
                    .Slides(xloop).Objects(2).Text.CharFormat.Shadow = _
                       True
                    .Slides(xloop).Objects(1).Text.CharFormat.Points = 90

                 Case 3
                    .Slides(xloop).Objects(2).Text = _
                       "Demonstrating the power..."
                    .Slides(xloop).Objects(2).Text.CharFormat.Color.RGB = _
                       RGB(255, 0, 0)
                    .Slides(xloop).Objects(2).Text.CharFormat.Points = 42
                    .Slides(xloop).Objects(2).Text.CharFormat.Shadow = _
                       True
                    .Slides(xloop).Objects(1).Text.CharFormat.Points = 50

                 Case 4
                    .Slides(xloop).Objects(2).Text = _
                       "Of interoperable applications..."
                    .Slides(xloop).Objects(2).Text.CharFormat.Color.RGB = _
                       RGB(0, 0, 255)
                    .Slides(xloop).Objects(2).Text.CharFormat.Points = 34
                    .Slides(xloop).Objects(2).Text.CharFormat.Shadow = _
                       True
                    .Slides(xloop).Objects(1).Text.CharFormat.Points = 100

                 Case 5
                    .Slides(xloop).Objects(2).Text = _
                       "Created on the Fly!!!!"
                    .Slides(xloop).Objects(2).Text.CharFormat.Color.RGB = _
                       RGB(0, 255, 0)
                    .Slides(xloop).Objects(2).Text.CharFormat.Points = 72
                    .Slides(xloop).Objects(2).Text.CharFormat.Shadow = _
                       True
                    .Slides(xloop).Objects(1).Text.CharFormat.Points = 60

              End Select
           Next
        End With
        ppPres.SlideShow.Run ppSlideShowFullScreen
        Exit Sub
        err_cmdOLEPowerPoint:
        MsgBox Err.Number &amp; " " &amp; Err.Description
      End Sub

      Private Sub cmdQuit_Click()
         ppPres.Delete
         Set ppPres = Nothing
         ppObj.Quit
         Set ppObj = Nothing
         MsgBox "Action Complete"
      End Sub

</PRE><P><LI>Save the PowerPointDemo form and open it in Form view.

<P><LI>Click the command button and note that the PowerPoint slide show is
<P><PRE>    created and displays on your screen.
</PRE><P>
</OL>NOTE: Although the presentation ends, it is not removed from memory. To
make sure the presentation is not left lingering in memory, be sure to
click the Quit PowerPoint button on the PowerPointDemo form. This removes
the PowerPoint object variables from memory.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using Automation with Microsoft PowerPoint,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q149088.htm">Q149088</A></B>
   TITLE     : ACC: How to Display Microsoft PowerPoint Slides on a Form
</PRE></OL> 
<PRE>Keywords          : AutoGnrl kbinterop IntpOleA
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
