

<HTML>
<HEAD>
<TITLE>XL97: Problems Using ColorIndex to Set Color of Borders </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171953">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/07/25">
<META NAME="Keywords" CONTENT="kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you run a Visual Basic for Applications macro that uses ColorIndex property to specify a color for the borders of a cell, some of the borders may fail to use that color or may not appear. For example, this problem occurs w...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIB,QBVP,QAH4,QAPN,QAG9,QBS0,QAPG,QBXS,QALV,QBVV,QARJ,QBBI,QAPF,QAKJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Problems Using ColorIndex to Set Color of Borders</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171953</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you run a Visual Basic for Applications macro
that uses ColorIndex property to specify a color for the borders of a cell,
some of the borders may fail to use that color or may not appear. For
example, this problem occurs when you use the following sample code in a
macro:
<P>
<PRE>   ActiveCell.Borders.ColorIndex = 3


</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs because Microsoft Excel 97 applies the specified color
to only the left, right, top, and bottom borders.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
The following example code uses the ColorIndex property to specify a color
for the borders of a cell or a range of cells.
<P>
<P><h3>Left, Right, Top, and Bottom Borders</h3>
 
<P>
To use the ColorIndex property for these types of borders, set the
ColorIndex property to the value you want, for example:
<P>
<PRE>   ActiveCell.Borders(xlEdgeLeft).ColorIndex = 2
   ActiveCell.Borders(xlEdgeRight).ColorIndex = 3
   ActiveCell.Borders(xlEdgeTop).ColorIndex = 4
   ActiveCell.Borders(xlEdgeBottom).ColorIndex = 5

</PRE>You can set all four borders to the same value by using a line of code
similar to the following:
<P>
<PRE>   ActiveCell.Borders.ColorIndex = 6

</PRE><h3>Inside Vertical and Inside Horizontal Borders</h3>
 
<P>
To use the ColorIndex property for these types of borders, set the
ColorIndex property for the appropriate constant to the correct value, for
example:
<P>
<PRE>   Selection.Borders(xlInsideVertical).ColorIndex = 7
   Selection.Borders(xlInsideHorizontal).ColorIndex = 8

</PRE>NOTE: When you use the xlInsideVertical constant, the selected range must
contain at least two columns. When you use the xlInsideHorizontal constant,
the selected range must contain at least two rows. If the selection does
not contain the necessary number of columns or rows, you receive the
following error message:
<P>
<PRE>   Run-time error '1004':
   Unable to set the ColorIndex property of the Border class

</PRE><h3>Diagonal Up and Diagonal Down Borders</h3>
 
<P>
To use the ColorIndex property for these types of borders, first set the
Weight property of the border, for example:
<P>
<PRE>   With Selection.Borders(xlDiagonalUp)
       .Weight = xlThin
       .ColorIndex = 9
   End With

</PRE>-or-
<P>
<PRE>   Selection.Borders(xlDiagonalDown).Weight = xlMedium
   Selection.Borders(xlDiagonalDown).ColorIndex = 10

</PRE>NOTE: If you use the ColorIndex property of the diagonal border before you
set its Weight property, the ColorIndex property is ignored, and the border
appears in the default color (black). If you do not set the Weight
property, the border does not appear.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior, with the exception of the behavior of diagonal borders, is
by design of Microsoft Excel 97.
<P>
Microsoft has confirmed the behavior of diagonal borders to be a problem in
the Microsoft products listed at the beginning of this article. We are
researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, if you run a macro with the following line of code
<P>
<PRE>   MsgBox ActiveCell.Borders.Count

</PRE>a message box with the number of borders for the active cell appears. By
running this macro, you can determine that a cell contains six borders:
left, right, top, bottom, diagonal up, and diagonal down. However, if you
specify a color for all six borders by running a macro that uses the
following line of code
<P>
<PRE>   ActiveCell.Borders.ColorIndex = 3

</PRE>the color for only the first four borders is changed. The color for the
diagonal borders is not changed because no weight is specified for them.
Note that you can use the workaround in this article to force the diagonal
borders to appear.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbcode kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
