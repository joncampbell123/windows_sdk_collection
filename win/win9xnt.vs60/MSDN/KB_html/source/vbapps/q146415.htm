

<HTML>
<HEAD>
<TITLE>ACC: Creating Functions Similar to DFirst and DLast (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146415">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/02/15">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmParse">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  By design, the DFirst() and DLast() functions always return the first and last record that you entered in the underlying table, not the first and last record as ordered by t...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QA5V,QAY5,QAML,QAPF,QAB9,QBV8,QBS0,QA1S,QA9A,QBPM,QBXS,QA28,QATX,QATJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Creating Functions Similar to DFirst and DLast (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146415</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
By design, the DFirst() and DLast() functions always return the first and
last record that you entered in the underlying table, not the first and
last record as ordered by the table's index or the query's sort order.
DFirst() and DLast() ignore indexes, even primary keys and sort orders.
<P>
This article provides examples of how to write custom domain functions that
can be used in a way similar to DFirst() and DLast(). The DStart() and
DEnd() custom domain examples in this article return the first and last
records listed in a sorted query.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create and use custom domain functions similar to DFirst() and Dlast(),
follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new standard module and enter the following two functions:
<P>
<P><PRE>      '--------------------------------------
      ' Use DStart()instead of DFirst() to return
      ' the first sorted record in a domain.
      '--------------------------------------
      Function DStart(FieldName As String, DomainName As String, Optional
<PRE></PRE>                   Criteria As Variant)

        Dim MyDB As DATABASE, MySet As Recordset

        ' Error out if there is no fieldname sent.
        If Len(FieldName) = 0 Then
           MsgBox "You Must Specify a Field name", , "DStart"
           Exit Function
        End If

        ' Error out if there is no domain sent.
        If Len(DomainName) = 0 Then
           MsgBox "You Must Specify a Domain name", , "DStart"
           Exit Function
        End If

        Set MyDB = CurrentDb()
        Set MySet = MyDB.OpenRecordset(DomainName, dbOpenDynaset)

        ' Apply a filter to the recordset if a criteria is sent.
        If Not IsMissing(Criteria) Then
           MySet.Filter = Criteria
           Set MySet = MySet.OpenRecordset()
        End If

        ' If there are no records, return the null, else return the value
        ' of the first record.
        If MySet.EOF Then
           DStart = Null
        Else
           MySet.MoveFirst
           DStart = MySet(FieldName)
        End If

        MySet.Close
        MyDB.Close
      End Function

      '-------------------------------------------
      'Use DEnd()instead of DLast() to return
      '  the last sorted record in a domain.
      '-------------------------------------------

      Function DEnd(FieldName As String, DomainName As String, Optional _
        Criteria As Variant)

        Dim MyDB As DATABASE, MySet As Recordset

        ' Error out if there is no fieldname sent.
        If Len(FieldName) = 0 Then
           MsgBox "You Must Specify a Field name", , "DEnd"
           Exit Function
        End If

        ' Error out if there is no domainname sent.
        If Len(DomainName) = 0 Then
           MsgBox "You Must Specify a Domain name", , "DEnd"
           Exit Function
        End If

        Set MyDB = CurrentDb()
        Set MySet = MyDB.OpenRecordset(DomainName, dbOpenDynaset)

        ' Apply a filter to the recordset if a criteria is sent.
        If Not IsMissing(Criteria) Then
           MySet.Filter = Criteria
           Set MySet = MySet.OpenRecordset()
        End If

        ' If there are no records, return the null, else return the value
        ' of the last record.
        If MySet.EOF Then
           DEnd = Null
        Else
           MySet.MoveLast
           DEnd = MySet(FieldName)
        End If
        MySet.Close
        MyDB.Close
      End Function

</PRE><P><LI>Close and save the new module.

<P><LI>Create a new query based on the Orders table as follows:
<P>
<P><PRE>      Query: Orders By Date
      ---------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: OrderID
<PRE></PRE>         Table: Orders
      Field: OrderDate
         Table: Orders
         Sort: Descending

</PRE><P><LI>Close and save the query as RecentOrders.

<P><LI>Open the Debug Window, type the following expression, and then press
   ENTER:
<P>
<P><PRE>      ?DStart("OrderID","RecentOrders")
</PRE><P>
   Note that the OrderID 11077 is returned, which is the first OrderID
   in the query.

<P><LI>Type the following expression in the Debug Window, and then press ENTER:
<P>
<P><PRE>      ?DFirst("OrderID","RecentOrders")
</PRE><P>
   Note that the OrderID 10314 (or 10248 in 7.0) is returned, which is the
   first OrderID entered in the Orders table, not the first in the
   RecentOrders query.
<P>
</OL><h3>General Limitations to Custom Domain Functions</h3>
 

<UL><LI>You cannot use Forms!FormName!ControlName or Form.ID in quotation
   marks. For example, instead of
<P>
<P><PRE>      DStart("[ProductName]","Products","[ProductID]=Forms![Products] _
<PRE></PRE>         ![ProductID]")

   use:

      DStart("[ProductName]","Products", BuildCriteria("[ProductID]" _
         ,dblong,"=" &amp; Forms![Products]![ProductID]))

   Note that the BuildCriteria() function is a Visual Basic function that
   creates a properly formed criteria string. You can use BuildCriteria()
   anywhere you concatenate criteria strings, such as the FindFirst method
   or when building custom SQL criteria.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about BuildCriteria() function, search the Help Index
for "BuildCriteria Method."
 
<PRE>Keywords          : kbprg PgmHowTo PgmParse
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
