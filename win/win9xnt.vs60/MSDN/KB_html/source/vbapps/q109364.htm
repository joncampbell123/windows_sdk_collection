

<HTML>
<HEAD>
<TITLE>ACC: How to Calculate Averages Excluding Zero Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109364">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo RptTotal">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the Avg() function in a report to average a set of values, the function uses records containing zero values in the calculation. In some cases you may not want to inc...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QA1S,QDN9,QAKD,QBS0,QA5F,QAY5,QAMA,QAPF,QAB9,QAE5,QBXS,QBV8 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Calculate Averages Excluding Zero Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109364</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
SUMMARY
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the Avg() function in a report to average a set of values, the
function uses records containing zero values in the calculation. In some
cases you may not want to include records with zero values in this
calculation.
<P>
This article includes two examples of how to calculate an average for all
the non-zero values in a set by counting the number of non-zero values in
the set of values and then using that total with a running sum calculation.
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example One</h3>
 
<P>
In this example, one text box displays the number of non- zero values, and
the other text box displays the average for the set:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 1.x or
   2.0).

<P><LI>Use a Report Wizard to create a new Groups/Totals report based on
   the Order Details table. This report will calculate the average
   discount for each Product ID.

<P><LI>Include the ProductID and Discount fields on the report. Group the
   report on the ProductID field, grouped as Normal.
<P>
   NOTE: In versions 1.x and 2.0, there is a space in Product ID.

<P><LI>Open the report in Design view.

<P><LI>Add an unbound text box to the report's detail section. Position this
   text box to the left of the Discount text box. The new text box will
   display the count of non-zero values. Set the text box's ControlSource
   property to:
<P>
<P><PRE>      =IIf([Discount]=0 or [Discount] is null,0,1)
</PRE><P>
   This expression returns 0 if the value of the Discount field is
   equal to zero or null, otherwise it returns 1. The Avg() function
   automatically excludes nulls as well.

<P><LI>Set the text box's RunningSum property to Over Group and its
   Name property to CountOfData.
<P>
   NOTE: In version 1.x, the Name property is called the ControlName
   property.

<P><LI>Add another text box to the report's footer section. This text
   box will display the result of the average calculation.

<P><LI>Set the ControlSource property of this text box to:
<P>
<P><PRE>      =Sum([Discount])/[CountOfData]
</PRE>
<P><LI>Preview the report.
<P>
</OL>The left column displays a running count of non-zero (and non-null)
Discounts and the group footer displays an average Discount based on the
running count.
<P>
<P><h3>Example Two</h3>
 
<P>
This example uses a user-defined Access Basic function that is the
functional inverse of the NullToZero() function in the Northwind sample
database:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in versions 1.x and
   2.0).

<P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function ZeroToNull( MyValue As Variant) As Variant
<PRE></PRE>         If MyValue = 0 Or MyValue = Null Then
            ZeroToNull = Null
         Else
            ZeroToNull = MyValue
         End If
      End Function

</PRE><P><LI>Repeat the steps in Example One, but use the following expression in
   place of the expression in step 5:
<P>
<P><PRE>      =ZeroToNull([Discount])
</PRE><P>
   You can also use the ZeroToNull() function in a query.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Avg function, search the Help Index for
"Avg function."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: nonzero pure<BR>
Keywords          : kbusage PgmHowTo RptTotal<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
