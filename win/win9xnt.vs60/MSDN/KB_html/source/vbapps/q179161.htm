

<HTML>
<HEAD>
<TITLE>ACC: How to Recover a Table Deleted from a Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179161">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1998/01/09">
<META NAME="Keywords" CONTENT="PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates a sample Visual Basic for Applications function that you can use to recover a table deleted from a Microsoft Access for Windows 95 and Microsoft Access ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAH4,QAGB,QDN9,QAZV,QAGC,QAEF,QAY5,QBCT,QBXT,QA5V,QAIB,QAB9,QBML,QAU7 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Recover a Table Deleted from a Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179161</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates a sample Visual Basic for Applications function
that you can use to recover a table deleted from a Microsoft Access for
Windows 95 and Microsoft Access 97 database under the following conditions:
<P>
<PRE>  - The database has not been closed since the deletion of the table.

  - The database has not been compacted since the deletion of the table.

  - The table was deleted using the Microsoft Access user interface.

</PRE>NOTE: If multiple tables have inadvertently been deleted, this function
recovers only the last table that was deleted. The other tables are lost.
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following sample function recovers the last table deleted within a
Microsoft Access database. To create the sample function, follow these
steps.
<P>
NOTE: These steps assume that you are creating the sample function for
future use. If instead you are adding the code directly to a database in
which a table has recently been deleted, skip step 1, because if you have
closed Microsoft Access or the database, the deleted table is not
recoverable.

<OL><P><LI>Open your database in Microsoft Access.

<P><LI>In the Database window, click the Modules tab, and then click New.

<P><LI>Type or paste the following code in the module that you have just
   created:
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character indicates that the code 
   continues from one line to the next. You can type lines that contain
   this character as one logical line or you can divide the lines of code
   and include the line continuation character. For additional 
   information refer to the Microsoft Access 97 Readme File(Acread80.wri).
   This file is installed by default in the C:\Program Files\
   Microsoft Office\Office folder.
<P>
<P><PRE>    Function undo()
</PRE><P>
<P><PRE>      Dim db As Database, strTablename As String
      Dim i As Integer, StrSqlString As String
</PRE><P>
<P><PRE>      Set db = CurrentDb()
</PRE><P>
<P><PRE>      For i = 0 To db.TableDefs.Count - 1
</PRE><P>
<P><PRE>      If Left(db.TableDefs(i).Name, 4) = "~tmp" Then
<PRE></PRE>         strTablename = db.TableDefs(i).Name
         StrSqlString = "SELECT DISTINCTROW [" &amp; strTablename &amp; _
           "].* INTO MyUndeletedTable FROM [" &amp; strTablename &amp; "];"
         DoCmd.SetWarnings False
         DoCmd.RunSQL StrSqlString
         DoCmd.SetWarnings True
         MsgBox "A table has been restored as MyUndeletedTable", _
           vbOKOnly,"Restored"
         GoTo Exit_undo
      End If
      Next i
      MsgBox "No Recoverable Tables Found", vbOKOnly, "Not Found"

      Exit_undo:
         Set db = Nothing
         Exit Function
      Err_undo:
         MsgBox Err.Description
         Resume Exit_undo

    End Function

</PRE><P><LI>On the Debug menu, click "Compile and Save All Modules" (or in Microsoft
   Access for Windows 95, on the Run menu click "Compile All Modules"; then
   on the File menu, click "Save All Modules").

<P><LI>Save the Module as RecoverTable.
<P>
   To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>       ?Undo()
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about TableDefs, search the Help Index for "Tabledef
Object."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Restore Delete Recover<BR>
Keywords          : PgmHowto<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
