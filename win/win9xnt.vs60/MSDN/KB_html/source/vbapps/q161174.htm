

<HTML>
<HEAD>
<TITLE>ACC97: Sample Procedure to Attach a Microsoft Outlook Folder </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161174">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/12/17">
<META NAME="Keywords" CONTENT="AutoGnrl kbole kbusage PgmHowTo IsmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article contains a sample procedure to link a Microsoft Outlook folder as a table in a Microsoft Access database.  This article assumes that you are familiar with Visual Bas...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QAYC,QA1S,QAFI,QDN9,QBS0,QBQO,QA5V,QAB9,QAZV,QAU9,QAPF,QAH4,QAE2,QAA1 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Sample Procedure to Attach a Microsoft Outlook Folder</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161174</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article contains a sample procedure to link a Microsoft Outlook
folder as a table in a Microsoft Access database.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The example in this article uses the Microsoft Messaging Driver, which you
can install from the Microsoft Data Access Pack in the Office 97 ValuPack.
For more information about obtaining and installing the Microsoft
Messaging Driver, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q159322.htm">Q159322</A></B>
   TITLE     : ACC97: Paradox, Lotus, &amp; MS Exchange/Outlook ISAMs in
               ValuPack

   ARTICLE-ID: <B><A href="../access/q161173.htm">Q161173</A></B>
   TITLE     : ACC97: MS Exchange ISAM Driver Requires Manual Registration

</PRE>The Microsoft Messaging Driver gives you programmatic access to Microsoft
Outlook and Microsoft Exchange mail items. Note that you cannot use this
driver through the user interface in Microsoft Access 97. You must use it
in a Visual Basic for Applications procedure.
<P>
There are some issues to consider when you use a linked Microsoft Outlook
folder in Microsoft Access:

<UL><LI>You cannot select which fields appear in the linked table; a subset of
   the total number of Microsoft Outlook fields appears in the table, and
   they are pre-programmed in the Microsoft Messaging Driver. However, you
   can rearrange or hide the fields in Datasheet view of the table to
   customize its appearance.

<LI>You can add and delete records, but you cannot modify any records in the
   table.

<LI>You cannot enter data into some fields in the linked table, even when
   you are adding a new record.

<LI>If items in the linked Microsoft Outlook folder use a special form, you
   must enter the correct form type in the Message Class field when you add
   new records to the table. If you do not specify a Message Class,
   Microsoft Outlook uses the default mail form to display your data. The
   Message Classes for the standard Microsoft Outlook folders are:
<P>
<PRE>      Folder       Message Class
      ----------------------------
      Calendar     IPM.Appointment
      Contacts     IPM.Contact
      Inbox        IPM.Note
      Journal      IPM.Activity
      Notes        IPM.StickyNote
      Tasks        IPM.Task

</PRE></UL>The following sample procedure creates a table linked to a folder in a
Microsoft Outlook mailbox. To use the procedure, you must do the following:

<UL><LI>Set up Microsoft Outlook on your computer.

<LI>Set the SourceTableName property in the procedure to the name of the
   mail folder you want to attach to your database.

<LI>Substitute valid Connect property parameters for the linked table in
   the procedure:
<P>
<PRE>      Parameter     Value
      --------------------------------------------------------------------
      MAPILEVEL     The path to the parent of the folder you want to link.

      DATABASE      The path and file name of the current database.

      PROFILE       A valid Microsoft Outlook or Microsoft Exchange
                    profile.

</PRE><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<P><PRE>      Function AttachMail()
      Dim db As Database
      Dim td As TableDef
      On Error GoTo Errorhandler
<PRE></PRE>         Set db = CurrentDb()
         Set td = db.CreateTableDef("tblInbox")

         ' Substitute your own MAPILEVEL, DATABASE and PROFILE arguments.
         td.Connect = "Exchange 4.0;MAPILEVEL=Mailbox - Nancy Davolio|;"
         td.Connect = td.Connect &amp; "DATABASE=C:\Program Files\Microsoft "
         td.Connect = td.Connect &amp; "Office\Office\Samples\Northwind.mdb;"
         td.Connect = td.Connect &amp; "PROFILE=Microsoft Outlook"

         ' Substitute the name of the folder you want to attach.
         td.SourceTableName = "Inbox"

         db.TableDefs.Append td
         Application.RefreshDatabaseWindow
         MsgBox "Table Appended!"
      Exit Function
      Errorhandler:
         Msgbox "Error " &amp; Err &amp; " " &amp; Error
         Exit Function
      End Function

</PRE><P><LI>Press CTRL+G to open the Debug window, type the following line, and
   then press ENTER:
<P>
<P><PRE>     ?AttachMail()
</PRE><P>
   After the procedure runs, the Inbox mail folder appears as a linked,
   read-only table in the database.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the Microsoft Messaging Driver, refer to
the Microsoft Exchange/Outlook Driver section of the Acread80.wri file in
the C:\Program Files\Microsoft Office\Office folder.
<P>
For more information about setting the Connect property for a linked
Microsoft Exchange/Microsoft Outlook mail folder, search the Help index
for "Connect property."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: mail mapi mailbox<BR>
Keywords          : AutoGnrl kbole kbusage PgmHowTo IsmOthr<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
