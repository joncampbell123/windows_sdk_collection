

<HTML>
<HEAD>
<TITLE>XL: Macro to Delete Defined Names with Links </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138619">
<META NAME="KBModify" CONTENT="1998/02/27">
<META NAME="KBCreate" CONTENT="1995/10/24">
<META NAME="Keywords" CONTENT="kbcode kbmacro kbprg xlformula">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, workbooks can have two kinds of links: internal or external. Internal links are references to objects within (or internal to) the document (for example, another cell on a given sheet or another cell on another sheet in the same ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAUJ,QAWM,QAE2,QAPF,QBJZ,QBCT,QA6A,QARM,QAH4,QAHE,QAGC,QAGB,QAEF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Macro to Delete Defined Names with Links</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 27, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138619</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, workbooks can have two kinds of links: internal or
external. Internal links are references to objects within (or internal to)
the document (for example, another cell on a given sheet or another cell on
another sheet in the same workbook). The following examples demonstrate how
an internal link may appear on your sheet:
<P>
<PRE>   =C2

   -or-

   =Sheet1!C2

</PRE>External links are references to objects outside the document (for example
a cell on a sheet in another file). The following example demonstrates how
an external link may appear on your sheet:
<P>
<PRE>   ='C:\EXCEL\[BOOK1.XLS]Sheet1'!$C$2

</PRE>The macro in the "More Information" section of this article displays all
the defined names in the active workbook that has an external reference to
a defined name in a different workbook. External links not referenced by a
defined name are unaffected. After a defined name is deleted by the macro,
the error value "#NAME" is displayed in the cell(s) that use the defined
name.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE><h3>Visual Basic Code Example</h3>
 
<P>
Option Explicit
<P>
<PRE>Sub delete_external_names()

'variable declarations
</PRE>Dim response As Integer
Dim msg As String
Dim flag As Boolean
Dim defined_name As Object
<P>
<PRE>   flag = True     ' check if external links were found

   ' loop through each defined name in workbook
   For Each defined_name In ActiveWorkbook.Names

      ' if a [ was found, then the name has a link
      If InStr(defined_name.RefersTo, "[") &gt; 0 Then

         flag = False ' set flag to False indicating a link was found

         ' Message displayed to ask if you want to delete name
          msg = "Do you want to delete the defined name " &amp; "'" &amp; _
             defined_name.Name &amp; "'" &amp; Chr(13) &amp; " that refers to '" &amp; _
             defined_name &amp; "' ?"

          ' delete the defined name
          If MsgBox(msg, 292) = vbYes Then defined_name.Delete
       End If
   Next defined_name  ' get the next defined name

   If flag = True Then  ' if flag was not set, display message below

      MsgBox "No defined names with external were links found."
   End If
End Sub

</PRE>REFERENCES
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID:  <B><A href="../excel/q136314.htm">Q136314</A></B>
   TITLE     :  Copying Sheets Between Workbooks Can Create
                Unexpected Links

</PRE>For more information about Visual Basic for Applications in Excel 7, select
Excel's On-line Help menu, choose "Microsoft Excel Help Topics", click on
the Contents tab and choose "Getting Started with Visual Basic".
<P>
For more information about Visual Basic for Applications in Excel 5,
choose Excel's On-line Help menu, select "Contents" then "Programming with
Visual Basic".
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 7.00<BR>
Keywords          : kbcode kbmacro kbprg xlformula<BR>
Version           : WINDOWS:5.0,7.0,97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 27, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
