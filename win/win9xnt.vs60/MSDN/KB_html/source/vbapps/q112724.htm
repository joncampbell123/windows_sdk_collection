

<HTML>
<HEAD>
<TITLE>ACC: Speeding Up Iterative Processes in Visual or Access Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112724">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/03/17">
<META NAME="Keywords" CONTENT="kbprg PgmLoop PgmOthr PgmPrfm">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  To speed up iterative (looping) processes through large numbers of rows using Visual Basic for Applications (or Access Basic in version 2.0), declare all field references ex...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QBS0,QA1S,QAEN,QA5F,QAMA,QDN9,QBXS,QAH4,QAYL,QAPF,QAMR,QAZM,QAZL P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Speeding Up Iterative Processes in Visual or Access Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112724</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
To speed up iterative (looping) processes through large numbers of rows
using Visual Basic for Applications (or Access Basic in version 2.0),
declare all field references explicitly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following is a code example that does not iterate efficiently:
<P>
<PRE>   Sub Slow()
      Dim d As Database
      Dim r As Recordset
      Set d = CurrentDB()
      Set r = d.OpenRecordset("Order Details")
      While Not r.EOF
         r.Edit
         r.Fields("Price") = r.Fields("Qty") * r.Fields("UnitCost")
         r.Update
         r.MoveNext
      Wend
      r.Close
   End Sub

</PRE>In the example above, the field variable "lookup" (that is, where the
Visual Basic function equates variable names with database fields) for the
three field variables Price, Qty, and UnitCost is performed in the same
While loop in which the calculations are performed. In this configuration,
both calculations and lookups must be performed inside the While loop,
which is not an efficient design.
<P>
The following code example is more efficient:
<P>
<PRE>   Sub Faster()
      Dim d As Database
      Dim r As Recordset
      Dim Price As Field, Qty As Field, UnitCost As Field
      Set d = CurrentDB()
      Set r = d.OpenRecordset("Order Detail")
      Set Price = r.Fields("Price")
      Set Qty = r.Fields("Qty")
      Set UnitCost = r.Fields("UnitCost")
      While Not r.EOF
         r.Edit
         Price = Qty * UnitCost
         r.Update
         r.MoveNext
      Wend
      r.Close
   End Sub

</PRE>This example runs faster because Visual Basic performs the field lookup
only once for each field and completes it before executing the loop. A
direct reference to each of the three fields is then stored in the three
field variables Price, Qty, and UnitCost. As a result, no lookup is
required in the While loop, and the field values are accessed and
manipulated directly.
<P>
NOTE: The code examples above are only for illustrative purposes. In some
cases, an Update query can accomplish the task faster. For example, when
you need to modify one field based on another field (or fields). Also,
speed differences are slight for few records.
<P>
Using the transaction processing features of Visual Basic (BeginTrans,
CommitTrans, and Rollback) can also help optimize performance. These
features enable Microsoft Access to cache information and reduce disk
input and output (I/O).
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about transaction processing, search the Help Index
for "Transactions," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: queries programming<BR>
Keywords          : kbprg PgmLoop PgmOthr PgmPrfm<BR>
Version           : 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
