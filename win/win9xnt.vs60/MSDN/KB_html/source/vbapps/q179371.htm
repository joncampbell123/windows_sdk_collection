

<HTML>
<HEAD>
<TITLE>ACC: How to Create a Password Protected Form or Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179371">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1998/01/15">
<META NAME="Keywords" CONTENT="FmsHowTo ScrtOthr OffVBA PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Access has two built-in security features for protecting your database: User/Group accounts and permissions, and database passwords.  This article shows you how yo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWK,QAGB,QAUD,QBWS,QAZV,QANF,QAPF,QANE,QAGC,QAAP,QAVZ,QBVV,QAPN,QAIV,QAGX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create a Password Protected Form or Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179371</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access has two built-in security features for protecting your
database: User/Group accounts and permissions, and database passwords.
<P>
This article shows you how you can also set individual passwords for each
form and report in your database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please
seethe following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>By using code, you can prompt for a password when a user opens a form or a
report. If the correct password is entered, the form or report is opened.
<P>
The following example shows you how you can password protect the Orders
form in the sample database Northwind.mdb:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure:
<P>
<P><PRE>      Public Function KeyCode(Password As String) As Long
<PRE></PRE>         ' This function will produce a unique key for the
         ' string that is passed in as the Password.
         Dim I As Integer
         Dim Hold As Long

         For I = 1 To Len(Password)
            Select Case (Asc(Left(Password, 1)) * I) Mod 4
            Case Is = 0
               Hold = Hold + (Asc(Mid(Password, I, 1)) * I)
            Case Is = 1
               Hold = Hold - (Asc(Mid(Password, I, 1)) * I)
            Case Is = 2
               Hold = Hold + (Asc(Mid(Password, I, 1)) * _
                  (I - Asc(Mid(Password, I, 1))))
            Case Is = 3
               Hold = Hold - (Asc(Mid(Password, I, 1)) * _
                  (I + Len(Password)))
         End Select
         Next I
         KeyCode = Hold
      End Function

</PRE><P><LI>Create a new table as follows:
<P>
<P><PRE>      Table: tblPassword
      ---------------------------
      Field Name: ObjectName
<PRE></PRE>         Data Type: Text
         Field Size: 50
      Field Name: KeyCode
         Data Type: Number
         Field Size: Long Integer
         Input Mask: Password

      Table Properties: tblPassword
      -----------------------------
      PrimaryKey: ObjectName

</PRE><P><LI>Open the tblPassword table and enter the following data:
<P>
<P><PRE>      ObjectName: Orders
      KeyCode: 2818
</PRE>
<P><LI>Open the Orders form in Design view.

<P><LI>Set the form's OnOpen property to the following event procedure:
<P>
<P><PRE>      Private Sub Form_Open(Cancel as Integer)
<PRE></PRE>         Dim Hold As Variant
         Dim tmpKey As Long
         Dim I As Integer
         Dim rs As Recordset
         Dim db As Database

         On Error GoTo Error_Handler
         ' Check to see if the user is passing in the Password.
         If IsNull(Me.OpenArgs) Then
            Hold = InputBox("Please your Password", "Enter Password")
         Else
            Hold = Me.OpenArgs
         End If
         ' Open the table that contains the password.
         Set db = CurrentDb
         Set rs = db.OpenRecordset("tblPassword", dbOpenTable)
         rs.Index = "PrimaryKey"
         rs.Seek "=", Me.Name
         If rs.NoMatch Then
            MsgBox "Sorry cannot find password info. Please Try Again"
            Cancel = -1
         Else
            ' Test to see if the key generated matches the key in
            ' the table; if there is not a match, stop the form
            ' from opening.
            If Not (rs![keycode] = KeyCode(Cstr(Hold))) Then
               MsgBox "Sorry you entered the wrong password.  " &amp; _
                  "Please try again.", vbOKOnly, "Incorrect Password"
               Cancel = -1
            End If
         End If
         rs.Close
         db.Close
         Exit Sub

      Error_Handler:
         MsgBox Err.Description, vbOKOnly, "Error #" &amp; Err.Number
         Exit Sub
      End Sub

</PRE><P><LI>Close and save the Orders form.

<P><LI>Open the Orders form and enter "PASSWORD" when prompted for a password.
<P>
   Note the Orders form opens.

<P><LI>Close and reopen the Orders form and enter "PassWord" when prompted for
   a password.
<P>
   Note that you receive the message "Sorry you entered the wrong password.
   Please try again." and the Orders form does not open.
<P>
</OL>To determine what the corresponding KeyCode is for a given string, type the
following into the Debug window and press ENTER:
<P>
<PRE>    ?KeyCode("TestString")

</PRE></OL>The above example returns 5864.
<P>
To hide the tblPassword table in the Database window, right-click on the
tblPassowrd table and click Properties. In the properties window click the
Hidden check box, and then click OK.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: password-protected pass word<BR>
Keywords          : FmsHowTo ScrtOthr OffVBA PgmHowto<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
