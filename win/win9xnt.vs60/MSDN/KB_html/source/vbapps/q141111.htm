

<HTML>
<HEAD>
<TITLE>ACC: How to Determine If a Form Is Maximized or Minimized </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141111">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1995/12/11">
<META NAME="Keywords" CONTENT="kbusage FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Access provides no properties for determining if a form or report is maximized or minimized. This article shows you how to create custom form properties that deter...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QBW1,QDN9,QBWC,QAB9,QBS0,QAH4,QAI2,QAVX,QAUD,QAKD,QAJQ,QAXC,QADK P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Determine If a Form Is Maximized or Minimized</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141111</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access provides no properties for determining if a form or report
is maximized or minimized. This article shows you how to create custom form
properties that determine if a form window is maximized or minimized using
Windows application programming interface (API) functions.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, FrmSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and FrmSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q150895.htm">Q150895</A></B>
   TITLE     : ACC95: Microsoft Access Sample Forms Available on MSL

   ARTICLE-ID: <B><A href="../access/q175066.htm">Q175066</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Forms Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
By using the Property Get and Property Let statements in Visual Basic for
Applications, you can create custom form properties. You can use the
Property Get statement to define and retrieve the value of a custom form
property. You can use the Property Let statement to set the value of the
custom property.
<P>
The following example demonstrates how you can use the IsZoomed() and
IsIconic() Windows API functions to determine if a form is maximized or
minimized and how you can use custom form properties to retrieve and set
these values:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following lines in the Declarations
   section, if they are not already there:
<P>
<P><PRE>      '=================================================================
      'Module Declarations section
      '=================================================================
</PRE><P>
<P><PRE>      Option Compare Database
      Option Explicit
</PRE><P>
<P><PRE>      Declare Function IsZoomed Lib "User32" (ByVal hWnd As Long) As _
<PRE></PRE>           Integer
      Declare Function IsIconic Lib "User32" (ByVal hWnd As Long) As _
           Integer

</PRE><P><LI>Save and close the module.

<P><LI>Open the Customers form in Design view.

<P><LI>On the View menu, click Code, and type the following code in the form
   module:
<P>
<P><PRE>      '===================================================================
      'Property Maximized
      '
      'This procedure uses the Property Get statement to define the custom
      'form property 'Maximized' by calling the IsZoomed() function.
      '
      'Return Value:
<PRE></PRE>      '    True(-1) - The form is maximized.
      '    False(0) - The form is not maximized.
      '
      '====================================================================

      Public Property Get Maximized() As Integer
           Maximized = IsZoomed(Me.hWnd) * -1
      End Property

      '====================================================================
      'Property Minimized
      '
      'This procedure uses the Property Get statement to define the custom
      'form property 'Minimized' by calling the IsIconic() function.
      '
      'Return Value:
      '    True(-1) - The form is minimized.
      '    False(0) - The form is not minimized.
      '
      '====================================================================

      Public Property Get Minimized() As Integer
           Minimized = IsIconic(Me.hWnd) * -1
      End Property

      '===================================================================
      'Property Maximized
      '
      'This procedure uses the Property Let statement to set the value of
      'the custom form property 'Maximized'. The IsMax argument must be
      'defined as the same data type returned by the corresponding Property
      'Get procedure for the same custom property.
      '
      '====================================================================

      Public Property Let Maximized(IsMax As Integer)
           If IsMax Then
               Me.SetFocus
               DoCmd.Maximize
           Else
               Me.SetFocus
               DoCmd.Restore
           End If
      End Property

      '====================================================================
      'Property Minimized
      '
      'This procedure uses the Property Let statement to set the value of
      'the custom form property 'Minimized'. The IsMin argument must be
      'defined as the same data type returned by the corresponding Property
      'Get procedure for the same custom property.
      '
      '====================================================================

      Public Property Let Minimized(IsMin As Integer)
           If IsMin Then
               Me.SetFocus
               DoCmd.Minimize
           Else
               Me.SetFocus
               DoCmd.Restore
           End If
      End Property

</PRE><P><LI>Open the Customers form in Form view. Maximize the form.
<P>
<P><PRE>    NOTE: To test the Maximized property in the Debug window in Microsoft
    Access 97, before opening the Debug window, be sure to set the
    "Debug Window on Top" option. This option is set on the Tools menu by
    clicking Options and then clicking the Modules tab. This option must be
    set to get the expected results in step 9.
</PRE>
<P><LI>Press CTRL+G to invoke the Debug window, type the following line in the
   Debug window, and then press ENTER:
<P>
<P><PRE>       ?Forms!Customers.Maximized
</PRE><P>
<P><PRE>    Note that you receive a True(-1) value, indicating the form is
    maximized.
</PRE>
<P><LI>Minimize the form and repeat step 9. Note that you receive a False(0)
   value, indicating the form is minimized.

<P><LI>Type the following line in the Debug window, and then press ENTER:
<P>
<P><PRE>       Type Forms!Customers.Maximized=True
</PRE><P>
<P><PRE>    Note that the form is immediately maximized.
</PRE>
<P><LI>Type the following line in the Debug window, and then press ENTER:
<P>
<P><PRE>       Forms!Customers.Minimized=True
</PRE><P>
<P><PRE>    Note that the form is immediately minimized.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Property Get and Property Let statements,
search for "Property Get Statement" or "Property Let Statement" using the
Microsoft Access Help Index.
 
<PRE>Keywords          : kbusage FmsHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
