

<HTML>
<HEAD>
<TITLE>ACC97: Example Using the Internet Transfer ActiveX Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163653">
<META NAME="KBModify" CONTENT="1997/11/10">
<META NAME="KBCreate" CONTENT="1997/02/13">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article shows two examples using the Microsoft Internet Transfer ActiveX Control that is included with the Microsoft Office Developer Edition 97.  This article assumes that ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QBW9,QAB5,QA7O,QAMN,QAOE,QAH6,QASP,QBWA,QAQW,QAHV,QA1S,QBT6,QBJZ,QBV4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Example Using the Internet Transfer ActiveX Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163653</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article shows two examples using the Microsoft Internet Transfer
ActiveX Control that is included with the Microsoft Office Developer
Edition 97.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Internet Transfer ActiveX Control provides you with access to the
Internet and the World Wide Web using the two most common protocols:
Hypertext Transfer Protocol (HTTP) and File Transfer Protocol (FTP). When
you use the internet transfer control with HTTP, you can retrieve HTML
documents from the Internet or an intranet. Using the internet transfer
control with FTP, you can log on to FTP servers and download or upload
files; the control supports many of the most common FTP commands such as
GET, DIR, DELETE and CD.
<P>
<P><h3>Example 1 - Using the OpenURL Method to Retrieve an HTML Page</h3>
 
<P>
The following example uses the internet transfer control with HTTP to
create an HTML page based on Microsoft's World Wide Web home page, and to
view the header information for the page.
<P>
<PRE>  1. Start Microsoft Access and open the sample database Northwind.mdb.

  2. Create a new form not based on any table or query in Design view:

       Form: frmOpenURL
       --------------------------
       Caption: OpenURL Form

       Command button:
          Name: cmdWriteFile
          Caption: Write to Disk

       Command button:
          Name: cmdGetHeader
          Caption: Get Header

  3. On the Insert menu, click ActiveX control.

  4. In the Insert ActiveX Control dialog box, select Microsoft Internet
     Transfer Control, version 5.0, and then click OK.

  5. Set the internet control's Name property to axInetTran.

  6. On the View menu, click Code.

  7. Type the following line in the Declarations section of the form's
     class module:

       Dim objInet as Inet

  8. Type the following procedures for the form's Load event and for the
     Click event of each command button:

      Private Sub Form_Load()
         ' Set a reference to the internet transfer control.
         Set objInet = Me!axInetTran.Object
      End Sub

      Private Sub cmdWriteFile_Click()
         Dim b() as Byte

         ' Set the internet transfer control protocol and URL.
         objInet.Protocol = icHTTP
         objInet.URL = "HTTP://www.microsoft.com"

         ' Retrieve the HTML data into a byte array.
         b() = objInet.OpenURL(objInet.URL,icByteArray)

         ' Create a local file from the retrieved data.
         Open "C:\Homepage.htm" For Binary Access Write As #1
         Put #1, , b()
         Close #1

         MsgBox "Done"
      End Sub

      Private Sub cmdGetHeader_Click()
         ' Set the internet transfer control protocol and URL.
         objInet.Protocol = icHTTP
         objInet.URL = "HTTP://www.microsoft.com"

         ' Open the HTML and display the header information.
         objInet.openURL objInet.URL, icByteArray
         MsgBox objInet.GetHeader
      End Sub

  9. Save the frmOpenURL form, and switch it to Form view.

 10. Click the Write To Disk button. Use Windows Explorer or File Manager
     to verify that the file C:\Homepage.htm has been created on your hard
     drive. You can open the file in your Web browser to view the contents
     of Microsoft's home page.

     NOTE: No graphics appear on the page; only the text was transferred.

 11. Click the Get Header button. Note the message box that displays the
     header information from Microsoft's home page on the World Wide Web.

</PRE><h3>Example 2 - Using FTP to Retrieve a File from an FTP Site</h3>
 
<P>
The following example uses the internet transfer control with FTP to
retrieve a file called Dirmap.txt from Microsoft's FTP site.
<P>
NOTE: The internet transfer control File Transfer Protocol will not work
with some Internet proxy servers. If you do not have a direct connection
to the Internet through an Internet Service Provider (ISP), verify that
your proxy server supports FTP connections.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a new form not based on any table or query in Design view:
<P>
<P><PRE>      Form: frmRetrieveFile
      --------------------------
      Caption: Retrieve FTP File
</PRE><P>
<P><PRE>      Command button:
<PRE></PRE>         Name: cmdGetFile
         Caption: Get FTP File
      Text box:
         Name: txtFTPSite
      Text box:
         Name: txtFileName

</PRE><P><LI>On the Insert menu, click ActiveX control.

<P><LI>In the Insert ActiveX Control dialog box, select Microsoft Internet
   Transfer Control, version 5.0, and then click OK.

<P><LI>Set the internet control's Name property to axFTP.

<P><LI>On the View menu, click Code.

<P><LI>Type the following line in the Declarations section of the form's
   class module:
<P>
<P><PRE>       Dim objFTP as Inet
</PRE>
<P><LI>Type the following procedures for the form's Load event, for the
   Click event of the command button, and for the StateChanged event of
   the internet transfer control:
<P>
<P><PRE>      Private Sub Form_Load()
<PRE></PRE>         ' Set a reference to the internet transfer control.
         Set objFTP = Me!axFTP.Object
      End Sub

      Private Sub cmdGetFile_Click()
         Dim strSite As String
         Dim strFile As String
         strSite = Me!txtFTPSite
         strFile = Me!txtFileName
         objFTP.Protocol = icFTP
         objFTP.URL = strSite
         objFTP.Execute strSite, "Get " &amp; strFile &amp; " C:\" &amp; strFile
      End Sub

      Private Sub axFTP_StateChanged(ByVal State As Integer)
         ' Display a message when the transfer is finished.
         If State = 12 Then Msgbox "File Transferred"
      End Sub

</PRE><P><LI>Save the frmRetrieveFile form, and switch it to Form view. Type
   <B><A href="ftp://ftp.microsoft.com">ftp://ftp.microsoft.com</A></B> in the txtFTPSite text box, type
   Dirmap.txt in the txtFileName text box, and then click the Get FTP
   File button. After Dirmap.txt is transferred to C:\, a message box
   is displayed.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Internet Transfer ActiveX Control, search the
Help Index for "Internet Transfer control."
<P>
For more information about the Execute method, search the Help Index for
"Execute method (Internet Transfer Control)."
<P>
For more information about the StateChanged event, search the Help Index
for "StateChanged event."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ole custom<BR>
Keywords          : kbusage<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
