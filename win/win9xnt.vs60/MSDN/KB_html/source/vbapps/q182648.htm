

<HTML>
<HEAD>
<TITLE>XL98: Error with Invalid Characters in Drawing Object Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182648">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/17">
<META NAME="Keywords" CONTENT="kberrmsg kbdta kbdtacode xlvbahowto xlvbainfo xl97vbmigrate xldraw">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a Visual Basic for Applications macro in Microsoft Excel 98 Macintosh Edition, you may receive the following error message:     Run-time error '1004':    Unable to get the DrawingObjects property of the Worksheet class  CAUSE =====  Th...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBPV,QAUJ,QBS0,QBVP,QAB4,QAPN,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Error with Invalid Characters in Drawing Object Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182648</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Visual Basic for Applications macro in Microsoft Excel 98
Macintosh Edition, you may receive the following error message:
<P>
<PRE>   Run-time error '1004':
   Unable to get the DrawingObjects property of the Worksheet class

</PRE><h2>CAUSE</h2>
 
<P>
This error will occur if you attempt to reference a drawing object such as
a rectangle or an ellipse, or an AutoShape whose name contains non-valid
characters.
<P>
Valid characters for drawing object names include the following:

<UL><LI>Alphanumerics (A-Z, a-z, 0-9)
<LI>Spaces ( )
<LI>Underscores (_)
<P>
</UL>All other characters are invalid and should not be used in drawing object
names.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
The following line of code will fail:
<P>
<PRE>   ActiveSheet.DrawingObjects("Hello!").Select

</PRE>The drawing object's name, Hello!, contains an exclamation point (!)
character, which is invalid. You can still reference it by using its index.
<P>
For example, if you know that the drawing object in question is the first
drawing object in the worksheet, you can reference it as follows:
<P>
<PRE>   ActiveSheet.DrawingObjects(1).Select

</PRE>If your worksheet contains a large number of drawing objects, you can use a
loop to cycle through the drawing objects, checking each drawing object's
name. For example, this sample subroutine will loop through all of the
drawing objects in the active worksheet and select the drawing object named
"Hello!":
<P>
<PRE>   Sub Test()
       For X = 1 To ActiveSheet.DrawingObjects.Count
           If ActiveSheet.DrawingObjects(X).Name = "Hello!" Then
               ActiveSheet.DrawingObjects(X).Select
               Exit For
           End If
       Next X
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, you can create drawing objects and
AutoShapes by using the tools on the Drawing toolbar. After you have
created a drawing object, you can change its name by selecting it, clicking
the Name box to the left of the Formula Bar, typing a new name, and
pressing the RETURN key.
<P>
If you rename a drawing object so that its name includes invalid
characters, you cannot use a Visual Basic macro to directly reference the
drawing object by its name. If your drawing objects' names include such
characters, use the workaround shown in this article to reference the
drawing objects.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 commandbars oval circle shape<BR>
Keywords          : kberrmsg kbdta kbdtacode xlvbahowto xlvbainfo xl97vbmigrate xldraw<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
