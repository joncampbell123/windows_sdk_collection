

<HTML>
<HEAD>
<TITLE>ACC: Adding "(all)" to a Combo Box or List Box Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128881">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/04/12">
<META NAME="Keywords" CONTENT="kbusage PgmHowTo FmsHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to create and use a sample user-defined Visual Basic function called AddAllToList(). You can use this function to add  (all)  as the first row ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QA1S,QAH4,QAY5,QBS0,QA5V,QDN9,QAE1,QAPF,QBV8,QAUD,QAB9,QA7O,QA5F,QAMA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Adding "(all)" to a Combo Box or List Box Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128881</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to create and use a sample user-defined
Visual Basic function called AddAllToList(). You can use this function to
add "(all)" as the first row of any existing combo box or list box control
in a Microsoft Access application.
<P>
The Developer Solutions sample application (Solutions.mdb) that comes with
Microsoft Access demonstrates a similar technique for adding "(all)" to a
list, but the AddAllToList() function has the following advantages:

<UL><LI>It works with any existing combo box or list box control.

<LI>You can specify in which column "(all)" is displayed.

<LI>You can specify what you want the optional text to be. For example, you
   can change "(all)" to read "none" or "nothing."

<LI>You do not need to change the code to change the optional text.
<P>
</UL>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This section demonstrates how to create and use the sample user-defined
Visual Basic function, AddAllToList().
<P>
<P><h3>How to Create the AddAllToList()function</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0)

<P><LI>Open any form containing a combo box or list box control in Design view.

<P><LI>On the View menu, click Code to open the form module. Add the following
   code to the module.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      Function AddAllToList (C As Control, ID As Long, Row As Long, _
      Col As Long, Code As Integer) As Variant
</PRE><P>
<P><PRE>      '***************************************************************
      ' FUNCTION: AddAllToList()
      '
      ' PURPOSE:
<PRE></PRE>      '   Adds "(all)" as the first row of a combo box or list box.
      '
      ' USAGE:
      '   1. Create a combo box or list box that displays the data you
      '      want.
      '
      '   2. Change the RowSourceType property from "Table/Query" to
      '      "AddAllToList."
      '
      '   3. Set the value of the combo box or list box's Tag property to
      '      the column number in which you want "(all)" to appear.
      '
      '   NOTE: Following the column number in the Tag property, you can
      '   enter a semicolon (;) and then any text you want to appear
      '   other than the default "all."
      '
      '         For example
      '
      '             Tag: 2;&lt;None&gt;
      '
      '         displays "&lt;None&gt;" in the second column of the list.
      '
      '***************************************************************
         Static DB As Database, RS As Recordset
         Static DISPLAYID As Long
         Static DISPLAYCOL As Integer
         Static DISPLAYTEXT As String
         Dim Semicolon As Integer

      On Error GoTo Err_AddAllToList

         Select Case Code
            Case LB_INITIALIZE
               ' See if the function is already in use.
               If DISPLAYID &lt;&gt; 0 Then
                  MsgBox "AddAllToList is already in use by another _
                  control!"
                  AddAllToList = False
                  Exit Function
               End If

               ' Parse the display column and display text from the Tag
               ' property.
               DISPLAYCOL = 1
               DISPLAYTEXT = "(All)"
               If Not IsNull(C.Tag) Then
                  SemiColon = InStr(C.Tag, ";")
                  If SemiColon = 0 Then
                     DISPLAYCOL = Val(C.Tag)
                  Else
                     DISPLAYCOL = Val(Left(C.Tag, SemiColon - 1))
                     DISPLAYTEXT = Mid(C.Tag, SemiColon + 1)
                  End If
               End If

               ' Open the recordset defined in the RowSource property.
               Set DB = DBEngine.Workspaces(0).Databases(0)
               Set RS = DB.OpenRecordset(C.RowSource, DB_OPEN_SNAPSHOT)

               ' Record and return the ID for this function.
               DISPLAYID = Timer
               AddAllToList = DISPLAYID

            Case LB_OPEN
               AddAllToList = DISPLAYID

            Case LB_GETROWCOUNT
               ' Return the number of rows in the recordset.
               RS.MoveLast
               AddAllToList = RS.RecordCount + 1

            Case LB_GETCOLUMNCOUNT
               ' Return the number of fields (columns) in the recordset.
               AddAllToList = RS.Fields.Count

            Case LB_GETCOLUMNWIDTH
               AddAllToList = -1

            Case LB_GETVALUE
               ' Are you requesting the first row?
               If Row = 0 Then
                  ' Should the column display "(All)"?
                  If Col = DISPLAYCOL - 1 Then
                     ' If so, return "(All)."
                     AddAllToList = DISPLAYTEXT
                  Else
                     ' Otherwise, return NULL.
                     AddAllToList = Null
                  End If
               Else
                  ' Grab the record and field for the specified row/column.
                  RS.MoveFirst
                  RS.Move Row - 1
                  AddAllToList = RS(Col)
               End If
            Case LB_END
               DISPLAYID = 0
               RS.Close
         End Select

      Bye_AddAllToList:
         Exit Function

      Err_AddAllToList:
         Beep: MsgBox Error$, 16, "AddAllToList"
         AddAllToList = False
         Resume Bye_AddAllToList
      End Function

</PRE><P><LI>Set the combo box or list box's properties according to the instructions
   in the function header.
<P>
</OL><h3>How to Use the AddAllToList() Function</h3>
 
<P>
The following example demonstrates how you can use the AddAllToList()
function on the Orders form in the sample database Northwind.mdb (or
NWIND.MDB in version 2.0). The function adds "&lt;No Salesperson&gt;" as the
first row of the Salesperson combo box drop-down list so that you can clear
the selection if you choose a salesperson for an order in which no
salesperson was involved.

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0)

<P><LI>Open the Orders form in Design view, and then click Code on the View
   menu.

<P><LI>Copy the AddAllToList() function you created above, and then paste it
   into the form module, removing the underscore characters.

<P><LI>Compile Loaded Modules to check if you entered the function correctly.
   Close the Module window.

<P><LI>Set the following properties for the Salesperson combo box control:
<P>
<P><PRE>      RowSourceType: AddAllToList
      Tag: 2;&lt;No Salesperson&gt;
</PRE>
<P><LI>View the Orders form in Form view. Note that "&lt;No Salesperson&gt;" is
   displayed as the first row of the combo box drop-down list.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
You can find information, instructions, and examples in the Developer
Solutions sample application (Solutions.mdb) included with Microsoft Access
97. For more information about adding "(all)" to a combo box or list box,
open the Solutions.mdb database usually located in the ACCESS\SAMPLES
folder. Select "Get more mileage from combo boxes, list boxes, subforms,
and subreports" in the Select A Category Of Examples box, then "Add '(all)'
to a list" in the Select An Example box.
 
<PRE>Keywords          : kbusage PgmHowTo FmsHowTo
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
