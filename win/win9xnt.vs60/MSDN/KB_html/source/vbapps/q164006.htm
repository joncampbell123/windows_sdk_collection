

<HTML>
<HEAD>
<TITLE>ACC: Cannot Use Intrinsic Constants in Queries, Forms, Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164006">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/02/20">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use Microsoft Access intrinsic constants in expressions in a query, on a form or report, or in the Condition column of a macro, you receive an error or you are prompted ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAXB,QDN9,QAY5,QAB9,QAKJ,QBS0,QAB4,QAC1,QBWS,QACF,QBD2,QAPF,QBV8,QAKD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Cannot Use Intrinsic Constants in Queries, Forms, Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164006</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use Microsoft Access intrinsic constants in expressions in a
query, on a form or report, or in the Condition column of a macro, you
receive an error or you are prompted to enter a parameter.
<P>
For example, when you use the StrConv() function in the Update To cell of
an update query and then run it, you receive the following error message:
<P>
<PRE>   Microsoft Access can't update all the records in the update query.

</PRE>When you use the StrConv() function in the Criteria cell of a select query,
you receive the following error message:
<P>
<PRE>   Data type mismatch in criteria expression.

</PRE>If you use the StrConv() function in an expression in the Field cell of a
query, or in the ControlSource property of a control on a report, Microsoft
Access prompts you for a parameter value. For example, if you type Expr1:
StrConv([CompanyName], vbUpperCase) in the Field cell of a query, and then
run it, Microsoft Access prompts you to enter a parameter value for
"vbUpperCase."
<P>
If you use the StrConv() function in the ControlSource property of a
control on a form, the control displays #Name? in Form view.
<P>
If you use the StrConv() function in the Condition column of a macro, you
receive the following error message:
<P>
<PRE>   Microsoft Access can't find the name '&lt;intrinsic constant name&gt;' you
   entered in the expression.

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The query does not recognize the value of the Visual Basic intrinsic
constants you used in the function.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, use one of the following methods:

<UL><LI>Use the numeric value for the conversion argument instead of the
   constant. For example, instead of using
<P>
<P><PRE>      Expr1: StrConv([CompanyName],vbProperCase)
</PRE><P>
   use
<P>
<P><PRE>      Expr1: StrConv([CompanyName],3)
</PRE><P>
   For a list of numeric values associated with each of the intrinsic
   constants used in the conversion argument of the StrConv() function,
   search the Help Index for "StrConv function."
<P>
   For a list of the numeric values associated with intrinsic constants in
   other built-in functions in Microsoft Access, search the Help Index for
   that function.

<LI>Create a procedure that contains the built-in function with its
   intrinsic constant, and then use that procedure in your query. For
   example, you can create the following procedure in a module:
<P>
<P><PRE>      Function UseConstants(FieldName As String)
<PRE></PRE>         UseConstants = StrConv(FieldName, vbUpperCase)
      End Function

   Then you can use the custom procedure in your query expression:

      Expr1: UseConstants([CompanyName])

</PRE></UL><h2>STATUS</h2>
 
<P>
This behavior is by design. Intrinsic constants can only be used in Visual
Basic for Applications code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create the following new query in Design view based on the Customers
   table:
<P>
<P><PRE>      Query: qryCustomers
      ---------------------------------------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: CompanyName
<PRE></PRE>         Table: Customers
         Criteria: StrConv([CustomerID], vbLowerCase) = "alfki"

</PRE><P><LI>On the Query menu, click Run. Note that you receive the error "Data type
   mismatch in criteria expression." Click OK.

<P><LI>Delete the Criteria expression and type the following expression in a
   new column in the QBE grid:
<P>
<P><PRE>      StrConv([CompanyName], vbUpperCase)
</PRE>
<P><LI>On the Query menu, click Run. Note that you are prompted to enter a
   parameter value for vbUpperCase.
<P>
   NOTE: If you type the correct numeric value for the vbUpperCase constant
   (which is 1) in the Enter Parameter Value dialog box, and then click OK,
   the query runs correctly.

<P><LI>Switch the query back to Design view.

<P><LI>On the Query menu, click Update Query (or Update in version 7.0).

<P><LI>In the QBE grid, delete the column with the StrConv expressions, and
   set the Update To cell of the CompanyName column to the following
   expression:
<P>
<P><PRE>      StrConv([CompanyName], vbUpperCase)
</PRE>
<P><LI>On the Query menu, click Run. Click Yes to confirm that you want to
   update the records, and note that you receive the error "Microsoft
   Access can't update all the records in the update query." Click No to
   stop the update.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Microsoft Access intrinsic constants, search the
Help Index for "constants, intrinsic."
<P>
For more information about using the StrConv() function in Microsoft
Access, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q110391.htm">Q110391</A></B>
   TITLE     : ACC: Sample Function to Capitalize Words and Phrases
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: action update delete make table select<BR>
Keywords          : kberrmsg kbusage QryOthr<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
