

<HTML>
<HEAD>
<TITLE>ACC: Cannot Perform OpenTable Method on Linked/Attached Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138769">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/10/26">
<META NAME="Keywords" CONTENT="JetRS kberrmsg kbprg PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you attempt to open a recordset on a linked (attached) table using the dbOpenTable constant (or DB_OPEN_TABLE in version 2.0), you may receive the following error message.  In...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA39,QDKY,QBWS,QBXS,QBE7,QBE6,QAY5,QAH4,QBS0,QAZV,QABT,QDNJ,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Cannot Perform OpenTable Method on Linked/Attached Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138769</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you attempt to open a recordset on a linked (attached) table using the
dbOpenTable constant (or DB_OPEN_TABLE in version 2.0), you may receive the
following error message.
<P>
In Microsoft Access 7.0 and 97:
<P>
<PRE>   Run-time error '3219':
   Invalid Operation.

</PRE>In Microsoft Access 2.0:
<P>
<PRE>   Invalid Operation

</PRE>In Microsoft Access 1.x:
<P>
<PRE>   Can't perform operation; it is illegal.

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In Microsoft Access 2.0, 7.0, and 97:
<P>
In Microsoft Access 2.0, 7.0, and 97, a linked table must be opened as the
Recordset object. The following code example assumes that you are linked
to the Customers table in the sample database Northwind.mdb, which resides
in the same folder as the database containing this code. The code opens the
Northwind.mdb file, which actually contains the Customers table. The code
then creates a recordset based on the Customers table.
<P>
Microsoft Access 7.0 and 97:
<P>
<PRE>   Public Function testLink()
      Dim myDb As DATABASE, rstCustomers As Recordset
      ' Open the Northwind.mdb database.
      Set myDb = DBEngine.Workspaces(0).OpenDatabase("Northwind.mdb")
      ' Create the recordset.
      Set rstCustomers = myDb.OpenRecordset("Customers", dbOpenDynaset)
   End Function

</PRE>Microsoft Access 2.0:
<P>
<PRE>   Public Function testLink()
      Dim myDb As DATABASE, rstCustomers As Recordset
      ' Open the Northwind.mdb database.
      Set myDb = DBEngine.Workspaces(0).OpenDatabase("Northwind.mdb")
      ' Create the recordset.
      Set rstCustomers = myDb.OpenRecordset("Customers", DB_OPEN_DYNASET)
   End Function

</PRE>In Microsoft Access 1.x:
<P>
In Microsoft Access 1.x, an attached table must be opened as the Dynaset
object as shown in the following example:
<P>
<PRE>   DIM MyDB as Database
   DIM MyDynaset as Dynaset
   Set MyDB = OpenDatabase("NWIND.MDB")
   Set MyDynaset = MyDB.CreateDynaset("Customers")

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new, blank database in the same folder as the sample database
   Northwind.mdb (or NWIND.MDB in versions 1.x and 2.0).

<P><LI>In Microsoft Access 7.0 and 97, on the File menu, point to Get External
   Data, and then click Link Tables.
<P>
   In Microsoft Access 1.x and 2.0, on the File menu, click Attach Table.

<P><LI>In Microsoft Access 7.0 and 97, in the Link dialog box, click
   Northwind.mdb, and then click Link.
<P>
   In Microsoft Access 1.x and 2.0, in the Attach dialog box, click
   Microsoft Access, and then click OK. In the Select Microsoft Access
   Database dialog box, click NWIND.MDB, and then click OK.

<P><LI>In Microsoft Access 7.0 and 97, in the Link Tables dialog box, click the
   Customers table, and then click OK.
<P>
   In Microsoft Access 1.x and 2.0, in the Attach Tables dialog box, click
   Customers, and then click Attach. When prompted that the table is
   successfully attached, click OK, and then click Close.

<P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function Test()
      Dim db as Database
      Dim mySet as Recordset
<PRE></PRE>         ' In versions 1.x and 2.0, dimension mySet as table.
         ' Dim mySet as table.
      Set db = CurrentDB()
         ' Create the recordset based on the Customers table.
      Set mySet = db.OpenRecordset("Customers", dbOpenTable)
         ' In version 2.0, use the following line to set mySet
         ' Set mySet = db.OpenRecordset("Customers",db_Open_Table).
         ' In version 1.x, use the following line to set mySet.
         ' Set mySet = db.OpenTable("Customers")
      End function

</PRE><P><LI>To test this function, type the following line in the Debug window (or
   Immediate window in versions 1.x and 2.0), and then press ENTER.
<P>
<P><PRE>      ? Test()
</PRE><P>
   Note that you receive the error message described above in the
   Symptoms section.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the OpenRecordset Method, search the Help
Index for "OpenRecordset."
<P>
For more information about how to use the Seek method with linked tables,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q131829.htm">Q131829</A></B>
   TITLE     : ACC: How to Use the Seek Method on Linked Tables
</PRE></OL> 
<PRE>Keywords          : JetRS kberrmsg kbprg PgmObj
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
