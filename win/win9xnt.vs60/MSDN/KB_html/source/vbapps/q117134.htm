

<HTML>
<HEAD>
<TITLE>XL: Can't Change Size or Position of Object in Custom Dialog </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117134">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/06/21">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you cannot use the Width, Height, Top, or Left properties of the DrawingObjects object to change the size or position of an object in a custom dialog box while the dialog box is displayed.  NOTE: This limitation does not apply t...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA01,QAPN,QBJZ,QAH4,QACI,QAW6,QAYS,QBWS,QANX,QA9N,QBS0,QBI4,QAJP,QAK3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Can't Change Size or Position of Object in Custom Dialog</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117134</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, you cannot use the Width, Height, Top, or Left
properties of the DrawingObjects object to change the size or position of
an object in a custom dialog box while the dialog box is displayed.
<P>
NOTE: This limitation does not apply to objects in UserForms in 
Microsoft Excel 97 for Windows or Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is by design in Microsoft Excel. You can move and size an object on a
dialog sheet, and the object is displayed with this size and position when
you display the dialog box. However, because a dialog box is not updated
during an event macro (only after the event macro finishes), you cannot
dynamically move or resize an object in the dialog box while the dialog box
is displayed.
<P>
Note that you also cannot change the size or position of a custom dialog 
box when you use the Show method to display the dialog box.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To work around this behavior, you can link a picture of an object on a
worksheet to a custom dialog box, and then move the object on the worksheet
using a Visual Basic module assigned to a button in the dialog box.
<P>
<P><h3>Example of Visual Basic Procedure</h3>
 
<P>
For an example of using this method, do the following:

<OL><P><LI>On a new worksheet (Sheet1), insert a picture in the range A1:C6.

<P><LI>On the Tools menu, click Options. Select the View tab, and under
   Window Options, clear the Gridlines check box. Click OK. Select the
   Picture, and click Copy on the Edit menu.

<P><LI>On the Insert menu, point to Macro, and then click Dialog. On the
   Edit menu, click Paste. Drag the picture to the dialog box. Click
   the Formula bar, and enter the following formula:
<P>
<P><PRE>      =Sheet1!$A$1:$C$6
</PRE>
<P><LI>Size the picture on the dialog box as desired. The picture on the
   dialog box is now linked to the picture on the worksheet (Picture 1).

<P><LI>On the Forms toolbar, click the Create Button button. Drag on the
   dialog box to create a button (Button 5). Select the button, and click
   the Edit Code button on the Forms toolbar. In the new module, enter the
   following code:
<P>
<P><PRE>      ' Code assigned to Button 5.
<PRE></PRE>      Sub Button5_Click()
          ' Change width and height of picture.
          With Worksheets("Sheet1").DrawingObjects("Picture 1")
              .Width = 30
              .Height = 40
         End With
      End Sub

      ' Macro to display dialog box.
      Sub Display_Dialog()
          DialogSheets("Dialog1").Show
      End Sub

</PRE><P><LI>On the Tools menu, click Macro. In the Macro Name/Reference list, select
   Display_Dialog, and click Run.
<P>
</OL>Note that you can also use the Top and Left properties of the DrawingObects
object to change the location of the object on the dialog box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information about positioning a custom dialog box, query on the 
following words in the Microsoft Knowledge Base:
<P>
<PRE>   directly and possible and on-screen and position and dialog
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a XL5 XL7 vba<BR>
Keywords          : kbcode kbprg PgmHowto PgmOthr<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a; MACINTOSH:5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
