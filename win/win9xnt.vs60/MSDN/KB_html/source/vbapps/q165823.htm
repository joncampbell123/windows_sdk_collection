

<HTML>
<HEAD>
<TITLE>ACC: Database Grows Rapidly When You Modify SQL Statements </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165823">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/03/25">
<META NAME="Keywords" CONTENT="kbprg QryParm QryPass">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Each time you modify the SQL property of a query, the size of your database increases. This applies to SQL statements that you use in the RecordSource property of a form or ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QABM,QAPN,QAZV,QAKJ,QDN9,QBS0,QACF,QAH4,QAX6,QAB9,QA5F,QA26,QAMA,QAJH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Database Grows Rapidly When You Modify SQL Statements</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165823</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Each time you modify the SQL property of a query, the size of your database
increases. This applies to SQL statements that you use in the RecordSource
property of a form or report, as well as to stored queries on the Queries
tab of the Database window.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The query is saved each time you modify its SQL property. Because the
Microsoft Jet database engine does not reuse the same space in the database
when the query is saved, the database increases in size.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can use the following techniques to work around the problem:

<UL><LI>Compact your database, which can reduce the size of the database by
   compressing unused space in the database file.

<LI>If you are modifying SQL pass-through queries, consider using temporary
   QueryDef objects in code when you need to alter the SQL statement.
   Because the query is not stored, the database does not increase in size.
   For more information about creating temporary queries, please see the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../vbapps/q124391.htm">Q124391</A></B>
<PRE></PRE>      TITLE     : ACC: Sample Code for Running Temporary SQL Pass-Through
                  Query

   NOTE: A disadvantage to this method is that you cannot bind a form or
   report to a temporary QueryDef object.

</PRE><LI>In Microsoft Access 97, use ODBCDirect to query an ODBC data source. For
   more information about opening a recordset using ODBCDirect, search the
   Help Index for "OpenRecordset method" or "ODBCDirect workspaces."
<P>
   NOTE: A disadvantage to this method is that you cannot bind a form or
   report to a recordset unless you programmatically bind each field and
   manage record navigation in code.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
In general, your database grows in size as you work on the design of its
objects. For example, repeated modifications to the design of a table,
form, or report cause a database to grow; compacting the database restores
it to a smaller size. However the growth is faster and more dramatic when
you change the SQL property of a query, or if you change the SQL statement
in the RecordSource property of a form or report. This is because the Jet
database engine generates a new query plan each time you change the SQL,
and the new plan is saved to an unused portion of your hard disk.
<P>
This behavior is reported frequently in databases that use SQL pass-through
queries because application developers will often modify the SQL property
of a query in code to change a parameter passed to a SQL Server stored
procedure, for example, or to change an Insert, Update, or Delete
statement.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example causes a database file to grow from 64 kilobytes (KB)
to approximately 5564 KB. The example edits the SQL property of an SQL pass-
through query 3000 times.

<OL><P><LI>Start Microsoft Access and create a new blank database. Note the size of
   the database, which should be approximately 64 KB or less.

<P><LI>Create a new query not based on any table in Design view.

<P><LI>On the Query menu, point to SQL Specific, and then click Pass-Through.

<P><LI>In the SQL Pass-Through Query window, type the following SQL statement:
<P>
<P><PRE>      sp_test
</PRE>
<P><LI>Save the query as qryPassThruTest and close it.

<P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<PRE>      Sub TestQDF()
         Dim i As Long
         Dim qdf As QueryDef
         Dim db As Database

         Set db = CurrentDb()
         Set qdf = db.QueryDefs("qryPassThruTest")

         For i = 1 To 3000
            qdf.SQL = "sp_test " &amp; Chr(34) &amp; i &amp; Chr(34)
         Next
      End Sub

</PRE><P><LI>To run the TestQDF() procedure, type the following line in the Debug
   window (or the Immediate window in version 2.0), and then press ENTER.
<P>
<P><PRE>      TestQDF
</PRE><P>
   When the procedure finishes, check the size of the database again. It
   will be approximately 5.5MB in size.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For an example of modifying the SQL property of a pass-through query, see
"Building Applications with Microsoft Access 97," Chapter 19, "Developing
Client/Server Applications," pages 550-551.
<P>
For more information about using parameters in pass-through queries, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q131534.htm">Q131534</A></B>
   TITLE     : ACC: How to Simulate Parameters in an SQL Pass-Through
               Query
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SPT Grow increase Bloat Pass-Thru Thru Insert Into<BR>
Delete Union Update Append<BR>
Keywords          : kbprg QryParm QryPass<BR>
Version           : 2.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
