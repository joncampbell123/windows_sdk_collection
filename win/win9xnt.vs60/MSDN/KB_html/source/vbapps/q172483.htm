

<HTML>
<HEAD>
<TITLE>HOWTO: Run a Word 97 Macro that Requires Arguments </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172483">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1997/08/07">
<META NAME="Keywords" CONTENT="VB4ALL VB4WIN vb5all vb5howto vbwin GnrlVb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When using Microsoft Word 97 as an ActiveX server, you can run a Word VBA macro by using Word's Run method. However, the Run method cannot be used with automation to run a Word macro that requires arguments. To run a Word macro that requires argume...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QBS0,QAH4,QAPN,QBWS,QDO7,QAIJ,QA5F,QAFF,QAHE,QAMA,QDL9,QBXS,QBWQ,QBWO P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Run a Word 97 Macro that Requires Arguments</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172483</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
<LI>Microsoft Visual Basic Standard, Professional, and Enterprise Editions
   for Windows, version 4.0
<LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using Microsoft Word 97 as an ActiveX server, you can run a Word VBA
macro by using Word's Run method. However, the Run method cannot be used
with automation to run a Word macro that requires arguments. To run a Word
macro that requires arguments, you can make your Word macro a method of
your document or template. This article illustrates how to do this.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To make a macro act as a method for your document or template, add the
macro as a Public Sub to the ThisDocument object in the Visual Basic Editor
for Microsoft Word.
<P>
The following steps demonstrate how to create a Visual Basic application
that executes a custom method of a Word document. This method expects two
arguments, a string and an integer.
<P>
<P><h3>Steps to Create the Word Macro</h3>
 

<OL><P><LI>Start a new Word document (Document1).

<P><LI>Press Alt+F11 to start the Visual Basic Editor.

<P><LI>Click Project Explorer on the View menu to display the Project Explorer.

<P><LI>In the Project Explorer, locate the "ThisDocument" object for
   Document1's project. Right-click "ThisDocument" and select View Code.

<P><LI>In the code window for ThisDocument, add the following macro:
<P>
<P><PRE>      Public Sub Macro1(s As String, i As Integer)
<PRE></PRE>         MsgBox s        'Display the string
         MsgBox i * 10   'Display the product i and 10
      End Sub

</PRE><P><LI>Press Alt+Q to exit the Visual Basic Editor and return to Document1.

<P><LI>Save this document as C:\TEST.DOC and exit Word.
<P>
</OL><h3>Steps to Create the Visual Basic Application</h3>
 

<OL><P><LI>Start a new "Standard EXE" project.

<P><LI>On the Project menu, click References. Check "Microsoft Word 8.0 Object
   Library", and click OK.

<P><LI>Add the following code to Form1.
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Dim objWordApp As Word.Application
      Dim objWordDoc As Word.Document
</PRE><P>
<P><PRE>      Private Sub Form_Click()
</PRE><P>
<PRE>         'Create a new instance of Word
         Set objWordApp = New Word.Application

         'Open the document containing the macro
         Set objWordDoc = _
            objWordApp.Documents.Open("C:\TEST.DOC")

         'Run the macro
         objWordDoc.macro1 "Hello!", 23

         'Close the document and clear the variables
         objWordDoc.Close
         Set objWordDoc = Nothing
         Set objWordApp = Nothing

      End Sub

</PRE><P><LI>Press the F5 keys to run the application. Click Form1 to run the Word
   macro.
</OL> 
<PRE>Keywords          : VB4ALL VB4WIN vb5all vb5howto vbwin GnrlVb kbprg
Technology        : kbvba
Version           : WINDOWS:4.0 5.0 97</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
