

<HTML>
<HEAD>
<TITLE>ACC: How to Automate Importing All Files in a Specific Folder </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158940">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/11/07">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmObj IsmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article explains how you can automate importing all files of a particular type from a specific folder on your hard drive.  This article assumes that you are familiar with Vi...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAFI,QAPN,QBS0,QAJZ,QDN9,QAH8,QAH4,QAEQ,QAP2,QANE,QACM,QA5F,QAMA,QDI1 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Automate Importing All Files in a Specific Folder</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158940</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article explains how you can automate importing all files of a
particular type from a specific folder on your hard drive.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example runs a procedure from a command button on a form.
The procedure uses an input box to prompt for the folder containing the
files you want to import. Then the code loops through all the files in
the folder you specify and imports them all.
<P>
NOTE: The following example imports Microsoft FoxPro version 3.0 files.
You select the file type you want to import by changing the second
argument of the TransferDatabase method. If you want to see a list of file
types that you can import using TransferDatabase, create a new macro and
insert the TransferDatabase action. Then view the list of file types under
the Database Type argument. When you are finished, close the macro without
saving it.

<OL><P><LI>Create a new form not based on any table or query in Design view.

<P><LI>Add a command button to the form and set its OnClick property to the
   following event procedure:
<P>
<P><PRE>      Private Sub Command0_Click()
      Dim InputDir, ImportFile As String, tblName As String
      Dim InputMsg as String
</PRE><P>
<P><PRE>      InputMsg = "Type the pathname of the folder that contains "
      InputMsg = InputMsg &amp; "the files you want to import."
      InputDir = InputBox(InputMsg)
      ' Change the file extension on the next line for the
      ' type of file you want to import.
      ImportFile = Dir(InputDir &amp; "\*.dbf")
</PRE><P>
<P><PRE>      Do While Len(ImportFile) &gt; 0
<PRE></PRE>         ' Use the import file name without its extension as the table
         ' name.
         tblName = Left(ImportFile, (InStr(1, ImportFile, ".") - 1))
         ' Change FoxPro 3.0 on the next line to the type of file you
         ' want to import.
         DoCmd.TransferDatabase acImport, "FoxPro 3.0", InputDir, _
               acTable, ImportFile, tblName
         ImportFile = Dir
      Loop
      End Sub

</PRE><P><LI>Open the form in Form view and click the button to begin importing
   tables.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the TransferDatabase method, search the Help
Index for "TransferDatabase Method," or ask the Microsoft Access 97 Office
Assistant.
<P>
For an alternative method to import files, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q88764.htm">Q88764</A></B>
   TITLE     : ACC: How to Import several dBASE Databases at Once (1.x/2.0)

   ARTICLE-ID: <B><A href="../vbapps/q141611.htm">Q141611</A></B>
   TITLE     : ACC: How to Import several dBASE Databases at Once 95/97
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: programming<BR>
Keywords          : kbprg PgmHowTo PgmObj IsmHowTo<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
