

<HTML>
<HEAD>
<TITLE>ACC: How to Capture Screens of Your Forms (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148392">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/03/12">
<META NAME="Keywords" CONTENT="kbprg PgmApi PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  You can use Microsoft Windows API functions to capture screens of any object on the Microsoft Windows desktop. You can perform screen captures of the Microsoft Access user i...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAY5,QAH4,QDN9,QAB9,QBV8,QDL9,QBWO,QBWN,QBS0,QACJ,QA1O,QAGI,QAA1,QAPN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Capture Screens of Your Forms (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148392</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
You can use Microsoft Windows API functions to capture screens of any
object on the Microsoft Windows desktop. You can perform screen captures
of the Microsoft Access user interface, Microsoft Access objects, other
Microsoft Windows applications, or the entire desktop.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample Visual Basic for Applications code captures an
object on the screen in the Clipboard. Note that you can change the
handle AccessHwnd in the sample code below to create screen captures of
other applications, including specific objects within Microsoft Access.
<P>
After capturing a screen, you can open Paint (Pbrush.exe) and click the
Paste command on the Edit menu. The screen capture from Microsoft Access
is loaded into the Paint window.
<P>
To run this code, call the ScreenDump() function from an event, a macro,
or the module's Debug window. To run ScreenDump() from the Debug window,
type the following, and then press ENTER:
<P>
<PRE>   ?ScreenDump()

</PRE>To set up the ScreenDump() function, open a new or existing module and
insert the code listed below.
<P>
NOTE: You may have some Microsoft Windows API functions defined in an
existing Microsoft Access library; therefore, your declarations may be
duplicates. If you receive a duplicate procedure name error message,
remove or comment out the declarations statement in your code.
<P>
Insert the following code into the Declarations section of your module:
<P>
<PRE>   Option Compare Database
   Option Explicit

   Type RECT_Type
      left As Long
      top As Long
      right As Long
      bottom As Long
   End Type

   'The following declare statements are case sensitive.

   Declare Function GetActiveWindow Lib "User32" () As Long
   Declare Function GetDesktopWindow Lib "User32" () As Long
   Declare Sub GetWindowRect Lib "User32" (ByVal Hwnd As Long, _
                                       lpRect As RECT_Type)
   Declare Function GetDC Lib "User32" (ByVal Hwnd As Long) As Long
   Declare Function CreateCompatibleDC Lib "Gdi32" (ByVal hdc As Long) _
                                       As Long
   Declare Function CreateCompatibleBitmap Lib "Gdi32" (ByVal hdc _
                                       As Long, ByVal nWidth As Long, _
                                       ByVal nHeight As Long) As Long
   Declare Function SelectObject Lib "Gdi32" (ByVal hdc As Long, _
                                       ByVal hObject As Long) As Long
   Declare Function BitBlt Lib "Gdi32" (ByVal hDestDC As Long, _
                                       ByVal X As Long, ByVal Y _
                                       As Long, ByVal nWidth As Long, _
                                       ByVal nHeight As Long, _
                                       ByVal hSrcDC As Long, _
                                       ByVal XSrc As Long, _
                                       ByVal YSrc As Long, _
                                       ByVal dwRop As Long) As Long
   Declare Function OpenClipboard Lib "User32" (ByVal Hwnd As Long) As Long
   Declare Function EmptyClipboard Lib "User32" () As Long
   Declare Function SetClipboardData Lib "User32" (ByVal wFormat As Long, _
                                       ByVal hMem As Long) As Long
   Declare Function CloseClipboard Lib "User32" () As Long
   Declare Function ReleaseDC Lib "User32" (ByVal Hwnd As Long, _
                                       ByVal hdc As Long) As Long
   Declare Function DeleteDC Lib "Gdi32" (ByVal hdc As Long) As Long

   Global Const SRCCOPY = &amp;HCC0020
   Global Const CF_BITMAP = 2

</PRE>Code for the ScreenDump() Function:
<P>
<PRE>   Function ScreenDump()
      Dim AccessHwnd As Long, DeskHwnd As Long
      Dim hdc As Long
      Dim hdcMem As Long
      Dim rect As RECT_Type
      Dim junk As Long
      Dim fwidth As Long, fheight As Long
      Dim hBitmap As Long

      DoCmd.Hourglass True

      '---------------------------------------------------
      ' Get window handle to Windows and Microsoft Access
      '---------------------------------------------------
      DeskHwnd = GetDesktopWindow()
      AccessHwnd = GetActiveWindow()

      '---------------------------------------------------
      ' Get screen coordinates of Microsoft Access
      '---------------------------------------------------
      Call GetWindowRect(AccessHwnd, rect)
      fwidth = rect.right - rect.left
      fheight = rect.bottom - rect.top

      '---------------------------------------------------
      ' Get the device context of Desktop and allocate memory
      '---------------------------------------------------
      hdc = GetDC(DeskHwnd)
      hdcMem = CreateCompatibleDC(hdc)
      hBitmap = CreateCompatibleBitmap(hdc, fwidth, fheight)

      If hBitmap &lt;&gt; 0 Then
         junk = SelectObject(hdcMem, hBitmap)

         '---------------------------------------------
         ' Copy the Desktop bitmap to memory location
         ' based on Microsoft Access coordinates.
         '---------------------------------------------
         junk = BitBlt(hdcMem, 0, 0, fwidth, fheight, hdc, rect.left, _
                       rect.top, SRCCOPY)

         '---------------------------------------------
         ' Set up the Clipboard and copy bitmap
         '---------------------------------------------
         junk = OpenClipboard(DeskHwnd)
         junk = EmptyClipboard()
         junk = SetClipboardData(CF_BITMAP, hBitmap)
         junk = CloseClipboard()
      End If

      '---------------------------------------------
      ' Clean up handles
      '---------------------------------------------
      junk = DeleteDC(hdcMem)
      junk = ReleaseDC(DeskHwnd, hdc)

      DoCmd.Hourglass False

   End Function

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about API calls, please see the following article
here in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q147781.htm">Q147781</A></B>
   TITLE     : ACC: How to Convert API Calls from 16-bit to 32-bit

</PRE>For more information about a screen-capture function for Microsoft
Access version 2.0, please see the following article here in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q100973.htm">Q100973</A></B>
   TITLE     : ACC2: How to Capture Screens of Your Forms
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dump how to<BR>
Keywords          : kbprg PgmApi PgmHowTo<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
