

<HTML>
<HEAD>
<TITLE>XL97: Cannot Move or Copy Sheet After Last Sheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143458">
<META NAME="KBModify" CONTENT="1998/03/11">
<META NAME="KBCreate" CONTENT="1996/02/01">
<META NAME="Keywords" CONTENT="kbdta kbdtacode xlui xl97vbmigrate">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run a Microsoft Visual Basic for Applications macro that copies or moves a worksheet or a chart sheet after the last worksheet in the workbook, or if you attempt to do this manually, Microsoft Excel does not insert the copied or moved work...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9N,QBVP,QAML,QACI,QANJ,QAEF,QBJZ,QASB,QBXV,QBS0,QBSO,QBQU,QASC,QAJP,QDNM P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Cannot Move or Copy Sheet After Last Sheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143458</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run a Microsoft Visual Basic for Applications macro that copies or
moves a worksheet or a chart sheet after the last worksheet in the
workbook, or if you attempt to do this manually, Microsoft Excel does not
insert the copied or moved worksheet after the last worksheet in the
workbook.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when the last worksheet in the workbook is hidden.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To prevent this behavior from occurring, move all hidden sheets to the
front in the order of sheet tabs in the workbook. To do this manually,
unhide all hidden sheets, drag the sheet tabs to the left (in front of the
other tabs), and then rehide the sheets.
<P>
To unhide a sheet, follow these steps:

<OL><P><LI>On the Format menu, point to Sheet, and then click Unhide.

<P><LI>Click the name of the sheet you want to unhide and click OK.
<P>
</OL>To hide a sheet, follow these steps:

<OL><P><LI>Activate the sheet.

<P><LI>On the Format menu, point to Sheet, and click Hide.
<P>
</OL>Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE></OL>Alternatively, you can use the following Visual Basic for Applications
macro to move all hidden sheets to the beginning of the workbook:
<P>
<PRE>   Sub MoveHiddenSheets()
       For Each xSheet In ActiveWorkbook.Sheets
           If xSheet.Visible = False Then
               xSheet.Move Before:=Sheets(1)
           End If
       Next xSheet
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If Microsoft Excel, you can use the Copy and Move methods within a Visual
Basic macro to copy or move sheets within a single workbook or to another
workbook. You can also copy or move sheets by clicking Move Or Copy Sheet
on the Edit menu.
<P>
In earlier versions of Microsoft Excel, you can copy or move a sheet after
the other sheets in the workbook programmatically by using one of the
following commands in a macro:
<P>
<PRE>   Sheets("Sheetname").Copy After:=Sheets(Sheets.Count)

   -or-

   Sheets("Sheetname").Move After:=Sheets(Sheets.Count)

</PRE>In Microsoft Excel 97, if you run a macro that contains either of these
commands, and the last sheet in the workbook is hidden, the copied or moved
sheet is not inserted at the end of the workbook. Instead, the sheet is
moved to the right of the last visible sheet in the workbook.
<P>
The same behavior applies if you click "Move or Copy Sheet" on the Edit
menu, click "(move to end)," and then click OK. In Microsoft Excel 97, the
copied or moved sheet is moved to the right of the last visible sheet in
the workbook. In earlier versions of Microsoft Excel, the copied or moved
sheet is moved to the end of the workbook.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.0<BR>
Keywords          : kbdta kbdtacode xlui xl97vbmigrate<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
