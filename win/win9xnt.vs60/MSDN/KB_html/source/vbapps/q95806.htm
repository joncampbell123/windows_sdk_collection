

<HTML>
<HEAD>
<TITLE>ACC: How to Skip Used Mailing Labels and Print Duplicates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95806 ">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1993/02/25">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to print multiple copies of the same mailing label, and how to use a partially used page where only some of the labels are available.  This article ass...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAC2,QA1S,QAOX,QDN9,QBQP,QAY5,QAVS,QBS0,QBJZ,QAB9,QBV8,QAMA,QAJQ,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Skip Used Mailing Labels and Print Duplicates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95806 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to print multiple copies of the same mailing
label, and how to use a partially used page where only some of the labels
are available.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access versions 1.x and 2.0. For more information about Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x or the "Building Applications" manual in Microsoft
Access version 2.0
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Printing Multiple Copies of the Same Label</h3>
 
<P>
When you click Print on the File menu, you can choose to print multiple
copies of the same report. But when you try to print a single mailing
label 20 times, Microsoft Access prints one label on each of 20 pages.
<P>
On a dot matrix printer, using single column labels, you can work around
this behavior by defining each label as a separate page. However, you
cannot use this method for laser printers or multiple-column labels. To
work around this behavior, use the step-by-step procedure described below.
<P>
<P><h3>Using Labels That Would Otherwise Be Wasted</h3>
 
<P>
After printing labels, you usually end up with a partially used last page.
There is no built-in mechanism in Microsoft Access to use the remaining
labels on a partially used page. Microsoft Access always starts on a new
page. On a dot matrix printer, you can adjust the top of form manually. But
you cannot do that on laser printers. To solve this problem, use the
step-by-step procedure described below.
<P>
<P><h3>Step-by-Step Procedure to Solve Both Problems</h3>
 
<P>
The Microsoft Access report generator provides powerful hooks that allow
control over the finished product. By calling a function from the OnFormat
property of the report's detail section, you can alter the MoveLayout,
NextRecord, and PrintSection properties to leave blank spaces or print
multiple copies on the same page.
<P>
The code listed below is generic. You can attach it to any Mailing Label
report to print multiple copies and to skip used labels if needed. To use
the example, you need to have a mailing label report called MyLabels.

<OL><P><LI>Create a new module, and place the following lines in the Declarations
   section:
<P>
<P><PRE>      '*********************************************************
<PRE></PRE>         'Declarations section of the module.
      '**********************************************************

      Option Compare Database
      Option Explicit

      Dim LabelBlanks&amp;
      Dim LabelCopies&amp;
      Dim BlankCount&amp;
      Dim CopyCount&amp;

      '==========================================================
         ' The following function will cause an input box to
         ' display when the report is run that prompts the user
         ' for the number of used labels to skip and how many
         ' copies of each label should be printed.
      '===========================================================

      Function LabelSetup ()
      LabelBlanks&amp; = Val(InputBox$("Enter Number of blank labels to skip"))
      LabelCopies&amp; = Val(InputBox$("Enter Number of Copies to Print"))
      If LabelBlanks&amp; &lt; 0 Then LabelBlanks&amp; = 0
      If LabelCopies&amp; &lt; 1 Then LabelCopies&amp; = 1
      End Function

      '===========================================================
         ' The following function sets the variables to a zero
      '===========================================================

      Function LabelInitialize ()
         BlankCount&amp; = 0
         CopyCount&amp; = 0
      End Function

      '===========================================================
         ' The following function is the main part of this code
         ' that allows the labels to print as the user desires.
      '===========================================================

      Function LabelLayout (R As Report)
         If BlankCount&amp; &lt; LabelBlanks&amp; Then
            R.NextRecord = False
            R.PrintSection = False
            BlankCount&amp; = BlankCount&amp; + 1
         Else
            If CopyCount&amp; &lt; (LabelCopies&amp; - 1) Then
               R.NextRecord = False
               CopyCount&amp; = CopyCount&amp; + 1
            Else
               CopyCount&amp; = 0
            End If
         End If
      End Function

</PRE><P><LI>Open the report named MyLabels in Design view and add the following line
   to the OnPrint property of the Detail section:
<P>
<P><PRE>      =LabelLayout(Reports![MyLabels])
</PRE>
<P><LI>Add the following line to the OnOpen property of the MyLabels Report:
<P>
<P><PRE>      =LabelSetup()
</PRE>
<P><LI>Although typically labels do not have a report header, add a Report
   Header and Footer to the report by selecting Report Header/Footer from
   the View menu (or Format menu in version 2.0 or Layout menu in version
   1.x). Then, add the following line to the OnFormat property of the
   report header:
<P>
<P><PRE>      =LabelInitialize()
</PRE>
<P><LI>Set the Height property for both the report header and report footer
   to 0.
<P>
</OL>When you print the report, the report calls the LabelSetup() function,
which first asks you to enter the number of used labels to skip on the
first page (BlankCount) and then asks how many of each label you want
printed (CopyCount).
<P>
When the report header is formatted, it calls the LabelInitialize()
function, so when you switch from preview to print, the BlankCount and
CopyCount fields are set to zero. As each label is formatted, the
LabelLayout() function adjusts the NextRecord and MoveLayout properties
to skip used labels and print the desired duplicates.
 
<PRE>Keywords          : kbusage
Version           : 1.0 1.1 2.0 7.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
