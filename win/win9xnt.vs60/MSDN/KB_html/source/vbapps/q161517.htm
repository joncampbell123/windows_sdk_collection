

<HTML>
<HEAD>
<TITLE>XL97: Visual Basic Example for Using SpinButton with a Date </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161517">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/12/26">
<META NAME="Keywords" CONTENT="kbcode kbprg xlvbahowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, you can use a SpinButton on a UserForm to change values on a worksheet or in a Visual Basic procedure. Microsoft Visual Basic for Applications in Excel 97 provides the ability to attach procedures to object events such as cli...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QBVP,QBWS,QBM8,QBXS,QA5F,QAMA,QAHP,QAB5,QACI,QAUD,QAPN,QBSV,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Visual Basic Example for Using SpinButton with a Date</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161517</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel 97, you can use a SpinButton on a UserForm to change
values on a worksheet or in a Visual Basic procedure. Microsoft Visual
Basic for Applications in Excel 97 provides the ability to attach
procedures to object events such as clicking on the down arrow of the
SpinButton (SpinDown event) and clicking on the up arrow (SpinUp event).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
The following Visual Basic procedure demonstrates how to use a SpinButton
control to both increment and decrement a date value in an edit box.

<OL><P><LI>From a new workbook in Microsoft Excel 97, press ALT + F11 to activate
    the Visual Basic Editor.

<P><LI>In the Microsoft Visual Basic Editor, click Insert and choose UserForm.

<P><LI>Choose the TextBox tool from the Controls Toolbox. Place a TextBox
    (TextBox1) on the UserForm.

<P><LI>Choose the SpinButton tool from the Controls Toolbox. Place a
    SpinButton (SpinButton1) on the UserForm.

<P><LI>Choose the CommandButton tool from the Controls Toolbox. Place a
    CommandButton (CommandButton1) on the UserForm.

<P><LI>On the View menu, click Properties Window.

<P><LI>With CommandButton1 selected, click the Caption and type "Close Now"
    (without the quotation marks) and press ENTER. This places the text
    on the CommandButton.

<P><LI>Select the UserForm by clicking anywhere on the form. In the
    Properties Window, click Caption, type "Change Date" (without the
    quotation marks), and press ENTER.

<P><LI>Right-click the CommandButton and choose View Code. Two lines of code
    are automatically entered for you. Between those two lines, type the
    following:
<P>
       UserForm1.Hide

<P><LI>Click "UserForm1 (UserForm)" on the Window menu to return to the
    UserForm.

<P><LI>On the UserForm, right-click the SpinButton and choose View Code.

<P><LI>Ensure that the Object dropdown (the dropdown in the upper left of the
    window) shows "SpinButton1" (without the quotation marks). Click the
    Procedures dropdown box (the dropdown in the upper right of the window)
    and choose SpinDown. Type the following code between the two lines
    placed automatically on the sheet.
<P>
       UserForm1.TextBox1.Text = DateValue(UserForm1.TextBox1.Text) - 1

<P><LI>Click the Procedures dropdown box and choose SpinUp. Type the
    following code between the two lines of code placed automatically
    on the sheet.
<P>
       UserForm1.TextBox1.Text = DateValue(UserForm1.TextBox1.Text) + 1

<P><LI>In the Microsoft Visual Basic Editor, click Insert and choose
    Module. On the module sheet, type the following code:
<P>
<PRE>       Sub ShowForm()
           UserForm1.TextBox1.Text = Date
           UserForm1.Show
       End Sub

</PRE><P><LI>In the Microsoft Visual Basic Editor, click Tools and choose Macros.
    In the Macros dialog, click ShowForm and then click Run.
<P>
</OL>The UserForm appears. Click the up arrow to increment the date. Click the
down arrow to decrement the date. Click the Close Now button to close the
UserForm and return to the Microsoft Visual Basic Editor.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information about how this can be accomplished in Microsoft
Excel versions 5.x and 7.x, see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q116118.htm">Q116118</A></B>
   TITLE     : Visual Basic Example of Spinner Use on a Date

</PRE></OL>For more information about the Microsoft Visual Basic for Applications
SpinButton control, click the Index tab in Microsoft Excel Help, type the
following text
<P>
<PRE>   spinner controls

</PRE>and then double-click the selected text to go to the "About adding buttons,
check boxes, and other controls" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 8.00 XL97<BR>
Keywords          : kbcode kbprg xlvbahowto<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
