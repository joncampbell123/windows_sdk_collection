

<HTML>
<HEAD>
<TITLE>WD97: Macro to Turn All Field Codes On and Off </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159968">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1996/11/25">
<META NAME="Keywords" CONTENT="kbwordvba kbmacro kbusage">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  This article discusses two methods for turning fields codes on or off. The first method adds a built-in button to the Standard toolbar. The second method uses Microsoft Visual Basic for Applications to create a macro that turns all field codes in a...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QAH4,QBS0,QBOR,QAPN,QAIH,QAKE,QANS,QAPF,QADK,QAF0,QBVV,QA6A,QBWS,QABA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: Macro to Turn All Field Codes On and Off</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159968</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses two methods for turning fields codes on or off.
The first method adds a built-in button to the Standard toolbar. The second
method uses Microsoft Visual Basic for Applications to create a macro that
turns all field codes in a document on or off.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1: Add the built-in View Field Codes button to the Standard toolbar</h3>
 

<OL><P><LI>On the View menu, point to Toolbars, and then click Customize.

<P><LI>Click the Commands tab.

<P><LI>In the Categories list, click View.

<P><LI>In the Commands list, click View Field Codes.

<P><LI>Drag View Field Codes to the Standard toolbar.  Release the
   mouse button when you see a vertical bar indicating the
   location on the toolbar where the command will be inserted.
<P>
</OL>For more information about customizing toolbars, click the
Office Assistant, type "customize toolbars" (without the
quotation marks), click Search, and then click to view the
"Add a button to a toolbar" topic.
<P>
NOTE: If the Assistant is hidden, click the Office Assistant
button on the Standard toolbar. If Word 97 Help is not
installed on your computer, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE: Office: How to Add/Remove a Single Office Program or Component

</PRE></OL><h3>Method 2: Use the ShowFieldCodes property</h3>
 
<P>
The following Visual Basic macro uses the ShowFieldCodes property and
displays a message in the status bar to indicate whether field codes are on
or off.
<P>
Microsoft provides examples of Visual Basic for Applications
procedures for illustration only, without warranty either
expressed or implied, including, but not limited to the implied
warranties of merchantability and/or fitness for a particular
purpose. The Visual Basic procedures in this article are provided
<PRE>'as is' and Microsoft does not guarantee that they can be used in
</PRE>all situations. While Microsoft support engineers can help
explain the functionality of a particular macro, they will not
modify these examples to provide added functionality, nor will
they help you construct macros to meet your specific needs. If
you have limited programming experience, you may want to consult
one of the Microsoft Solution Providers. Solution Providers offer
a wide range of fee-based services, including creating custom
macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<PRE>   Sub ToggleAllFieldCodes()
      If ActiveWindow.View.ShowFieldCodes Then
         ActiveWindow.View.ShowFieldCodes = False
         StatusBar = "Field Codes Off"
      Else
         ActiveWindow.View.ShowFieldCodes = True
         StatusBar = "Fields Codes On"
      End If
   End Sub

</PRE><h3>Method 3: Use the following simpler approaches</h3>
 
<P>
The following two macro examples are a simpler approach, however there is
no notification of the current field code state provided in the previous
example.
<P>
Example 1:
<P>
<PRE>   ActiveWindow.View.ShowFieldCodes = Not ActiveWindow.View.ShowFieldCodes

</PRE>Example 2:
<P>
<PRE>   ActiveWindow.Document.Fields.ToggleShowCodes


</PRE>For information about how to do this in earlier versions of Word,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q99954.htm">Q99954</A></B>
   TITLE     : Macro to Toggle All Document Field Codes On and Off
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: word8 word97 8.0 8.0 vb vba vbe<BR>
Keywords          : kbwordvba kbmacro kbusage<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
