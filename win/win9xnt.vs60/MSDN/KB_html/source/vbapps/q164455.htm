

<HTML>
<HEAD>
<TITLE>ACC: Problems Quitting Microsoft Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164455">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/02/28">
<META NAME="Keywords" CONTENT="AutoGnrl JetRS kbusage IntpOleA MdlDao">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you click Exit on the File menu in Microsoft Access, the program does not quit.  This article assumes that you are familiar with Visual Basic for Applications and with creat...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAGB,QAPN,QAW6,QAH4,QBS0,QAAW,QBXS,QA2K,QBJZ,QBWS,QBVV,QAFF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Problems Quitting Microsoft Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164455</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you click Exit on the File menu in Microsoft Access, the program does
not quit.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
There are two possible causes for this problem:

<UL><LI>You are using Microsoft Access as an automation server, and you have
   not closed all references to Microsoft Access or Data Access Objects
   (DAO).

<LI>You have not explicitly closed all DAO recordsets or query definitions
   in your Microsoft Access database. If you are using Visual Basic for
   Applications code to manipulate recordsets, QueryDefs, or recordset
   clones (on forms), in some cases you must explicitly close the object;
   otherwise, Microsoft Access does not close.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
When you use Microsoft Access as an automation server, invoke the Quit
method to explicitly close the Microsoft Access object when you are
finished with it in your code, and then set its object variable equal to
Nothing, for example:
<P>
<PRE>   Sub CloseAccess()
      Dim objAccess As Object
      Set objAccess = CreateObject("Access.Application")
      objAccess.Visible = True
      Msgbox "Microsoft Access is open; this procedure will now close it."
      objAccess.Quit
      Set objAccess = Nothing
   End Sub

</PRE>When you create Recordset or QueryDef objects in code, explicitly close
the object when you are finished with it. Microsoft Access automatically
closes those types of objects under most circumstances; however, if you
explicitly close the object in your code, you can avoid occasional
instances when the object remains open. The following sample code opens
and closes a Recordset and a QueryDef object in the Northwind sample
database:
<P>
<PRE>   Sub CloseObjects()
      Dim db As Database
      Dim rs As Recordset
      Dim qd As QueryDef

      Set db = CurrentDb
      Set rs = db.OpenRecordset("Employees", dbOpenTable)
      Set qd = db.QueryDefs("Invoices")

      rs.MoveLast
      MsgBox "The Employees recordset is open." &amp; vbcr &amp; _
         "The last Employee ID is " &amp; rs![EmployeeID] &amp; "."

      Msgbox "The Invoices query definition is open." &amp; vbcr &amp; _
         "The first field in the query is " &amp; qd.Fields(0).Name

      ' Explicitly close the Recordset and QueryDef objects.
      rs.Close
      qd.Close
   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example uses automation to open a second instance of
Microsoft Access that will not close:

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
   section:
<P>
<P><PRE>      Dim objAccess As Object
</PRE>
<P><LI>Type the following procedure:
<P>
<PRE>      Sub LeaveOpen()
         Set objAccess = CreateObject("Access.Application")
         objAccess.Visible = True
      End Sub

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       LeaveOpen
</PRE>
<P><LI>When another instance of Microsoft Access starts, switch to that
   instance.

<P><LI>On the File menu, click Exit. Note that the new instance of Microsoft
   Access minimizes, but does not quit. You must switch back to the first
   instance of Microsoft Access and close the database. Then the second
   instance quits automatically because its object variable ceases to
   exist.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using Microsoft Access as an automation server,
search the Help Index for "Automation," and please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q147816.htm">Q147816</A></B>
   TITLE     : ACC: Using Microsoft Access as an Automation Server

   ARTICLE-ID: <B><A href="../vbapps/q145707.htm">Q145707</A></B>
   TITLE     : ACC: Using Automation to Print Microsoft Access Reports
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: close down quit stop exit OLE<BR>
Keywords          : AutoGnrl JetRS kbusage IntpOleA MdlDao<BR>
Version           : 7.00 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
