

<HTML>
<HEAD>
<TITLE>ACC97: Cannot View Class Module in a Referenced Database Library </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160011">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/11/26">
<META NAME="Keywords" CONTENT="kbusage PgmCM MdlLib">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you open the Object Browser in Microsoft Access 97, you cannot view any of the form or report class modules in a referenced database.  This article assumes that you are fami...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBMH,QAH4,QA1S,QDM0,QDN9,QBJZ,QAZV,QABO,QAGI,QBS0,QAY5,QAPN,QAB9,QAUR,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Cannot View Class Module in a Referenced Database Library</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160011</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you open the Object Browser in Microsoft Access 97, you cannot view
any of the form or report class modules in a referenced database.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Access 97 corrects an anomaly with class module visibility that
exists in Microsoft Access 7.0 by not allowing you to browse or view any
form, report, or stand-alone class modules in a referenced database.
<P>
Microsoft Access 7.0 allows you to use the Object Browser to browse forms
and reports (stand-alone class modules are not supported in version 7.0),
and to call their methods and properties. Microsoft Access 97 corrects this
behavior by marking all form, report and stand-alone class modules as
private.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To make a class module visible in the Object Browser, declare a public
variable in a standard module in the referenced database that encapsulates
the class module.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access 7.0 and 97 both support calling functions from an external
database by creating a Visual Basic for Applications reference. This allows
you to use the Object Browser to view functions marked as Public in a
referenced database, and call the code from within the current database.
<P>
The following example creates a class object in a referenced database to
demonstrate how to call functions in a class module of a referenced
database, and to illustrate how the reference appears in the Microsoft
Access 97 Object Browser.
<P>
<P><h3>Create the Reference Database</h3>
 

<OL><P><LI>Create a new database called ClassTestRef.mdb.

<P><LI>On the Insert menu, click Class Module.

<P><LI>Save the class module as clsTest.

<P><LI>Select Class in the Object box of the module window. "Initialize" is
   automatically selected in the Procedure box of the module window.

<P><LI>Type the following procedure for the Initialize event:
<P>
<P><PRE>      Private Sub Class_Initialize()
<PRE></PRE>         On Local Error GoTo Class_Initialize_Err
         Dim Msg As String
         MsgBox "Class Initialized", vbInformation, "Class Example"
      Class_Initialize_End:
         Exit Sub
      Class_Initialize_Err:
         Msg = "Error #: " &amp; Format$(Err.Number) &amp; vbCrLf
         Msg = Msg &amp; Err.Description
         Err.Raise vbObjectError, "clsTest.Initialize (Private)", Msg
         Resume Class_Initialize_End
      End Sub

</PRE><P><LI>Type the following public procedure:
<P>
<P><PRE>      Public Function CallClass()
<PRE></PRE>         MsgBox "clsTest.CallClass method", _
                 vbInformation, "Class Example"
      End Function

</PRE><P><LI>Save and close the clsTest class module.

<P><LI>Create a new standard module by clicking Module on the Insert menu.

<P><LI>Type the following line in the Declarations section:
<P>
<P><PRE>      Public cls As New clsTest
</PRE>
<P><LI>Save the module as modTest and close it.

<P><LI>Close the ClassTestRef.mdb database.
<P>
</OL><h3>Create the Front-End Database</h3>
 

<OL><P><LI>Create a new database called ClassTestFront.mdb.

<P><LI>Create a new standard module by clicking Module on the Insert menu, and
<P><PRE>    then save the module as Module1.
</PRE>
<P><LI>On the Tools menu, click References.

<P><LI>In the References dialog box, click Browse.

<P><LI>In the Add Reference dialog box, select Microsoft Access Databases
   (*.mdb) in the File name box, and then select the ClassTestRef.mdb
   file. Click OK.

<P><LI>Note the new reference to ClassTestRef in the References dialog box,
   and then click OK.

<P><LI>Type the following procedure in the open module. This procedure calls
   the public CallClass function of the clsTest class module in the
   ClassTestRef database:
<P>
<P><PRE>       Public Function TestClass() As Boolean
<PRE></PRE>          cls.CallClass
          TestClass = True
       End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       ? TestClass()
</PRE><P>
<P><PRE>    Note that you receive two message boxes; the first one displays the
    text "Class Initialized," and the second one displays the text
    "clsTest.CallClass method."
</PRE>
<P><LI>Open Module1 in Design view.

<P><LI>On the View menu, click Object Browser.

<P><LI>Select ClassTestRef in the Project/Library box. Note that only modTest
<P><PRE>    is visible in the Classes box, and that you can see the public variable
    cls that it contains; the class module clsTest is not visible in
    the Object Browser.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about class modules, search the Help Index for "class
modules," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the Object Browser, search the Help Index for
"Object Browser," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ClassMod OLE instance<BR>
Keywords          : kbusage PgmCM MdlLib<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
