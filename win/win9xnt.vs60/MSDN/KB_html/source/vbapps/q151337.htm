

<HTML>
<HEAD>
<TITLE>XL: Increment Relative References by More Than One Cell in VBA </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151337">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/05/21">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The Fill feature always increments relative references by one for each cell filled. This article shows how to use Microsoft Visual Basic for  Applications code to fill a range of cells with a formula and increment the  relative references by an amo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QASR,QDNZ,QBCF,QAM3,QAPF,QAB9,QDMR,QBDA,QBCE,QAH4,QA5F,QAB3,QAVZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Increment Relative References by More Than One Cell in VBA</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151337</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Fill feature always increments relative references by one for each cell
filled. This article shows how to use Microsoft Visual Basic for 
Applications code to fill a range of cells with a formula and increment the 
relative references by an amount that you choose.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>As an example, suppose you have the following list of names and addresses
on a Microsoft Excel worksheet:
<P>
<PRE>   A1: Alice
   A2: 123 Anywhere St.
   A3: Brian
   A4: 234 Indeterminate Lane
   A5: Catherine
   A6: 345 Unknown Ave.
   A7: Dave
   A8: 456 Not Sure Blvd.
   A9: Erica
   A10: 567 Wherever Way

</PRE>Suppose you want the range B1:B5 to contain links to the names in this
list, but not to the addresses. If you enter "=A1" in cell B1, select the
range B1:B5, and click Fill Down on the Edit menu, you will get the
following formulas:
<P>
<PRE>   B1: =A1
   B2  =A2
   B3: =A3
   B4: =A4
   B5: =A5

   rather than the following formulas:

   B1: =A1
   B2  =A3
   B3: =A5
   B4: =A7
   B5: =A9

</PRE>which, in this example, would produce the desired result. The following
sample macro enables you to get this result without having to type the
formulas in each cell.
<P>
To use the sample macro, first select a vertical range of cells starting
with the cell that contains the formula you want to fill down. In the
example above, you would select the range B1:B5. When you run the macro, a
dialog box will prompt you for the number of cells to increment the
relative references for each cell filled.
<P>
WARNING: The macro will overwrite any data in the selected range and the
&lt;n&gt;-1 cells below it, where &lt;n&gt; is the number you enter in the dialog box.
<P>
<P><h3>Sample Visual Basic Procedure</h3>
 
<P>
<PRE>   Option Explicit

   Sub FillAndSkip()

      Dim CellToCopy As Range
      Dim n As Integer
      Dim x As Integer
   
      n = Val(InputBox("Increment relative references by how many cells?"))
      Set CellToCopy = Selection.Cells(1)

      For x = 2 To Selection.Rows.Count

         ' COPY the formula to a cell n cells down to update relative
         ' references.
         CellToCopy.Copy
         CellToCopy.Offset(n, 0).Range("A1").Select
         ActiveSheet.Paste

         ' CUT and paste to the desired destination so the references don't
         ' change.
         Application.CutCopyMode = False
         Selection.Cut
         CellToCopy.Offset(1, 0).Range("A1").Select
         ActiveSheet.Paste

         ' Start from the formula just created to get the next formula.
         Set CellToCopy = Selection

      Next x

   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information about getting help with Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 8.00<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS: 5.0,5.0c,7.0,97; MACINTOSH: 5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
