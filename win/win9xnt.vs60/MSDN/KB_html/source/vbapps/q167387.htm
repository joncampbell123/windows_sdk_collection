

<HTML>
<HEAD>
<TITLE>WD97: WordBasic.Files$() Command Adds Quotation Marks to Result </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167387">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1997/04/24">
<META NAME="Keywords" CONTENT="kbmacro kbprg kbwordvba">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the Visual Basic for Applications WordBasic object in combination with the WordBasic Files$() command and a path that includes spaces, the return value will contain quotation marks. If you attempt to use this return value with another ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA50,QA5F,QAB9,QAUD,QAY5,QBV8,QAKE,QBVV,QAKD,QAMA,QAFI,QAEF,QBWS,QAJH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WD97: WordBasic.Files$() Command Adds Quotation Marks to Result</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167387</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Word 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the Visual Basic for Applications WordBasic object in
combination with the WordBasic Files$() command and a path that
includes spaces, the return value will contain quotation marks. If you
attempt to use this return value with another command, you will
receive the following error message:
<P>
<PRE>   Run-time error '76': "Path not found."

</PRE><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications
procedures for illustration only, without warranty either expressed or
implied, including, but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. The Visual
Basic procedures in this article are provided 'as is' and Microsoft
does not guarantee that they can be used in all situations. While
Microsoft support engineers can help explain the functionality of a
particular macro, they will not modify these examples to provide added
functionality, nor will they help you construct macros to meet your
specific needs. If you have limited programming experience, you may
want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution
Providers, call Microsoft Customer Information Service at (800) 426-
9400.
<P>
Use one of the following methods to work around this problem:
<P>
<P><h3>Method 1: Remove the extra quotation marks</h3>
 
<P>
The following Visual Basic for Applications subroutine,
"GetWordBasicPath," retrieves the current path using the WordBasic
File$() command. It then calls the function, "RemoveQuotes," that
checks to see if the path begins with a quotation mark. If it does,
the function strips the beginning and ending quotation marks from the
path and returns the value to the calling subroutine. If the path does
not contain quotation marks, the original value is returned.
<P>
<PRE>   Sub GetWordBasicPath()
      Dim sPath As String
      sPath = RemoveQuotes(WordBasic.Files$("."))
      MsgBox sPath
   End Sub

   Function RemoveQuotes(sPath As String)
   ' ***********************************************
   ' This function strips extra quotation marks from
   ' the return value when using the WordBasic
   ' Files$() command.
   ' ***********************************************
      ' If the value starts with a quotation mark...
      If Left$(sPath, Length:=1) = Chr$(34) Then
         ' ...remove opening and closing quotation marks.
         RemoveQuotes = Mid$(sPath, Start:=2, Length:=Len(sPath) - 2)
      Else
         ' ...otherwise, return the value as is.
         RemoveQuotes = sPath
      End If
   End Function

</PRE><h3>Method 2. Use Visual Basic for Applications equivalent commands</h3>
 
<P>
In Visual Basic for Applications, use the CurDir and/or the Dir
functions instead of the WordBasic object. When you use either of
these functions, the value returned does not contain quotation marks.
The following example code does not enclose the current path in
quotation marks when it stores it in the variable, MyPath:
<P>
<PRE>   Dim MyPath As String
   MyPath = CurDir

</PRE>For more information about the Dir Function, from the Visual Basic for
Applications Editor, click the Office Assistant, type "Dir," click
Search, and then click to view "Dir Function."
<P>
For more information about the CurDir Function, from the Visual Basic
for Applications Editor, click the Office Assistant, type "CurDir,"
click Search, and then click to view "CurDir Function."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on
the Standard toolbar. If Visual Basic for Applications Help is not
installed on your computer, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbmacroexample vb vbe vba<BR>
Keywords          : kbmacro kbprg kbwordvba<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kberrmsg<BR>
Solution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
