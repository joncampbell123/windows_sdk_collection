

<HTML>
<HEAD>
<TITLE>ACC: Cannot Set LogMessages Property Using Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118367">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1994/07/17">
<META NAME="Keywords" CONTENT="kberrmsg kbusage ODBCSPT QryPass">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you create an SQL pass-through query in a Visual Basic for Applications procedure, you may receive the following error message when you try to set the QueryDef object's...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QBS0,QBXS,QAH4,QDN9,QA5F,QAMA,QAB4,QBWC,QAY5,QAW6,QANF,QAJH,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Cannot Set LogMessages Property Using Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118367</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you create an SQL pass-through query in a Visual Basic for
Applications procedure, you may receive the following error message when
you try to set the QueryDef object's LogMessages property.
<P>
In Microsoft Access 7.0 or 97:
<P>
<PRE>   Method or data member not found

</PRE>In Microsoft Access version 2.0:
<P>
<PRE>   Name not found in this collection

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
LogMessages is an extended property that cannot be addressed directly as a
property of the QueryDef object because an extended property does not
exist within the QueryDefs collection. You can set the LogMessages property
setting using the query's property sheet, or you can use the CreateProperty
function in code to append the LogMessages property to the query object.
Then you can set the property in your procedure.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Because the LogMessages property is an extended property, it must be
defined and then appended to the QueryDef object before you can set the
value of the property. For example, given a QueryDef object dimensioned
as MyQD, you need to add the following code to your Visual Basic for
Applications procedure before you set the LogMessages property:
<P>
<PRE>   Dim MyProp as Property
   ...
   Set MyProp = MyQD.CreateProperty("LogMessages", DB_BOOLEAN, True)
   MyQD.Properties.Append MyProp

</PRE>Once MyProp is appended to the Properties collection of MyQD, use the
following syntax when you reference the LogMessages property:
<P>
<PRE>   MyQD.Properties("LogMessages") = True

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following sample code demonstrates the error message that occurs when
you try to set the QueryDef object's LogMessages property.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.
<P>
<PRE>   Option Explicit
   Function MyFunct ()
      Dim MyDB as Database
      Dim MyQD as QueryDef
      Set MyDB = CurrentDb()
      Set MyQD = MyDB.CreateQueryDef("QueryName")
      MyQD.connect = "ODBC;DSN=Server_Name;UID=UserName; _
         PWD=MyPassword; DATABASE=DB_Name"
      MyQD.sql = "SELECT * from TableName"
      MyQD.returnsrecords = True
      ' The following line generates the error message
      MyQD.LogMessages = True
      MyQD.Close
   End Function

</PRE>The following sample code demonstrates how to change the sample code above
to set the LogMessages property correctly:
<P>
<PRE>   Option Explicit
   Function MyFunct2 ()
      Dim MyDB as Database
      Dim MyQD as QueryDef

      ' Dimension a variable as type Property.
      Dim MyProp as Property
      Set MyDB = DBEngine.Workspaces(0).Databases(0)
      Set MyQD = MyDB.CreateQueryDef("QueryName")

      ' Create a Boolean property called LogMessages.
      Set MyProp = MyQD.CreateProperty("LogMessages",DB_BOOLEAN,True)

      ' Append the property to the QueryDef variable.
      MyQD.Properties.Append MyProp
      MyQD.connect = "ODBC;DSN=Server_Name;UID=UserName; _
         PWD=MyPassword; DATABASE=DB_Name"
      MyQD.sql = "SELECT * from TableName"
      MyQD.returnsrecords = True

      ' Set a value for the property you just created
      MyQD.Properties("LogMessages") = True
      MyQD.Close
   End Function
</PRE> 
<PRE>Keywords          : kberrmsg kbusage ODBCSPT QryPass
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
