

<HTML>
<HEAD>
<TITLE>XL: OLE Automation Err Msg: Method Not Applicable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108661">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/12/15">
<META NAME="Keywords" CONTENT="IntpOthr kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you run code in a Microsoft Visual Basic version 3.0 application and the code uses a method or property of an object linking and embedding (OLE) automation object, you may receive the following error message     Method not applicable for this ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QBVP,QAPN,QAH4,QAW6,QA9Q,QA5F,QAMA,QAB4,QBXT,QBVV,QA5V,QA2K,QAIB,QBMR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: OLE Automation Err Msg: Method Not Applicable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108661</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Visual Basic version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run code in a Microsoft Visual Basic version 3.0 application and
the code uses a method or property of an object linking and embedding (OLE)
automation object, you may receive the following error message
<P>
<PRE>   Method not applicable for this object

</PRE><h2>CAUSE</h2>
 
<P>
Some of the methods and properties of OLE Automation objects are
keywords in Visual Basic version 3.0 and will cause the error
message above when you use them in a Visual Basic application.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To use a method or property of a Microsoft Excel object in a Visual
Basic application when the method or property is a Visual Basic
keyword, use square brackets ([]) around the keyword in the Visual
Basic code. For example, to use the Close method of the Microsoft
Excel Workbooks object in a Visual Basic application, use the
following syntax:
<P>
<PRE>   XL.Workbooks(1).[close]

</PRE><h2>MORE INFORMATION</h2>
 
<P>
OLE Automation is an industry standard that applications use to expose OLE
objects to development tools, macro languages, and other containers that
support OLE Automation. A few of the objects exposed by Microsoft Excel are
workbooks, worksheets, and charts. These objects can be accessed with
Visual Basic commands.
<P>
You use Visual Basic commands to manipulate these objects by invoking
methods on the object or by getting and setting the objects' properties
(just as you would with the objects in Visual Basic).
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. This Visual
Basic procedure is provided 'as is' and Microsoft does not guarantee
that it can be used in all situations. Microsoft does not support
modifications of this procedure to suit customer requirements for a
particular purpose. Note that a line that is preceded by an
apostrophe introduces a comment in the code--comments are provided to
explain what the code is doing at a particular point in the
procedure. Note also that an underscore character (_) indicates that
code continues from one line to the next. You can type lines that
contain this character as one logical line or you can divide the
lines of code and include the line continuation character. For more
information about Visual Basic for Applications programming style,
see the "Programming Style in This Manual" section in the "Document
Conventions" section of the "Visual Basic User's Guide.

<OL><P><LI>Run Microsoft Excel.

<P><LI>Run Microsoft Visual Basic version 3.0.

<P><LI>In Microsoft Visual Basic, enter and run the following code:
<P>
<PRE>         ' Dimension variable xl as object type
         Dim xl as Object
         ' Activate Microsoft Excel and assign to variable xl
         Set xl = GetObject(,"Excel.Application.5")
         ' Create a new workbook so we can close it
         xl.Workbooks.Add
         ' Close the workbook we just created
         xl.ActiveWorkbook.Close

</PRE></OL>The following error message appears
<P>
<PRE>   Method not applicable to this object

</PRE>even though Close is a method of the Microsoft Excel Workbooks object.
<P>
To make this piece of code work correctly, change the last line to:
<P>
<PRE>         xl.ActiveWorkbook.[Close]


</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the GetObject Function, choose the Search
button in Microsoft Visual Basic Help and type:
<P>
<PRE>    OLE Automation
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00<BR>
Keywords          : IntpOthr kbprg PgmOthr<BR>
Version           : 5.00 7.00<BR>
Platform          : WINDOWS<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
