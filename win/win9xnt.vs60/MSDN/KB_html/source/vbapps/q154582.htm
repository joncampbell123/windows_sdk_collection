

<HTML>
<HEAD>
<TITLE>ACC: How to Change a Graph Chart Type Using OLE Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154582">
<META NAME="KBModify" CONTENT="1998/01/06">
<META NAME="KBCreate" CONTENT="1996/08/09">
<META NAME="Keywords" CONTENT="kbinterop kbtool IntpGrph">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates how to use Automation to change the chart type of a Microsoft Graph object.  This article assumes that you are familiar with Visual Basic for Appli...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QA1S,QAPN,QDNX,QDN9,QA2K,QADK,QBWS,QAQG,QBS0,QAP2,QAPF,QAW6,QAH4,QABH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Change a Graph Chart Type Using OLE Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154582</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates how to use Automation to change the chart
type of a Microsoft Graph object.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is possible to change the chart type of a Microsoft Graph using
Automation. However, changing a graph from one type to another
automatically resets properties of the graph that do not apply to the new
graph type. For example, Trendlines apply to a Two Dimensional Column
graph, but do not apply to a Pie chart. Therefore, changing the type from
a Column to a Pie drops the Trendline.
<P>
<P><h3>Example: Changing a Chart Type</h3>
 
<P>
The following example shows how to produce a chart in the Northwind.mdb
database and change a graph's chart type to a 3-Dimensional Pie:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new form not based on any table or query in Design view.

<P><LI>On the Insert menu, click Chart. Click and drag a chart to the form.

<P><LI>In the first dialog box of the Chart Wizard, under View, click Queries,
    and then select the "Employee Sales By Country" query. Click Next.

<P><LI>In the next dialog box, add the Country and SaleAmount fields to the
    Fields For Chart box. Click Finish. Your graph appears in the form.

<P><LI>On the View menu, click Properties. Select the Graph so that you are
    viewing the graph object's properties. Set the Name property to
    MyGraph.

<P><LI>Add a command button to the form with the following properties:
<P>
       Command button: MyButton
<PRE>          Name: MyButton
          Caption: Pie Chart
          OnClick: [Event Procedure]

</PRE><P><LI>On the View menu, click Code to view the form's module.

<P><LI>On the Tools menu, click References, and then check the Microsoft Graph
    8.0 Object Library (in Microsoft Access 7.0, check the Microsoft Graph
    5.0 Object Library.)

<P><LI>Type the following procedure into the module.
<P>
<PRE>       Sub MyButton_Click()
          Dim GraphObj As Object
          Set GraphObj = Me![MyGraph].Object.Application.Chart
          GraphObj.Type = xl3DPie
       End Sub

    NOTE: To view other chart types you can set through Visual Basic for
    Applications, click Object Browser on the View menu and search the
    Microsoft Graph object library for "Constants".

</PRE><P><LI>Switch the form to Form view. When prompted for a beginning and ending
    date, enter "1/1/94" and "1/1/95" respectively (without the quotation
    marks). Click the command button. Note that the chart changes to a
    3-dimensional pie shape.
<P>
</OL><h3>Example: Determine Chart Type of Graph</h3>
 
<P>
The following example determines if the chart type of the graph in the
earlier example is a 2-Dimensional Bar:

<OL><P><LI>Open any module in Design view. On the Tools menu, click References,
   and then check the Microsoft Graph 8.0 Object Library reference (in
   Microsoft Access 7.0, check the 5.0 Object Library reference.) Click OK.

<P><LI>Using the form created in the first example, change the code of the
   command button to the following:
<P>
<P><PRE>      Dim GraphObj As Object
      Set GraphObj = Me![MyGraph].Object.Application.Chart
      If GraphObj.Type = xlBar Then 'xlBar equals 2
<PRE></PRE>         Msgbox "The graph is a 2-D Bar chart"
      Else
         Msgbox "The graph is NOT a 2-D Bar chart"
      End If

</PRE><P><LI>Switch the form to Form view. When prompted for a beginning and ending
   date, enter "1/1/94" and "1/1/95" respectively (without the quotation
   marks). Click the command button. Note the message box that states the
   graph is not a 2-Dimensional bar chart.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Type property and for a listing of chart
types and their constants, open the Microsoft Graph help file (you must
have the Vbagrp8.hlp help file installed), and search on "Type" and then
view the available topics.
<P>
For more information about Automation, search on "Automation," and
"Automation with Microsoft Access" using the Microsoft Access 97 Help
Index.
<P>
For more examples of Automation between Microsoft Access and Microsoft Graph,
see the Office 97 Automation Help File, Auto97.exe. The Auto97.exe file contains
the Microsoft Office 97 Automation Help file created by Microsoft Technical
Support. This Help file contains Automation theory and multiple examples on
automating all the Office 97 products (Microsoft Access, Microsoft Excel,
Microsoft Word, Microsoft PowerPoint, and Microsoft Outlook) as well as 
Microsoft Graph, DAO/ODBCDirect, Microsoft Binder, OLE Messaging, and the
Office Assistant.
<P>
For more information about how to obtain this help file, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q167223.htm">Q167223</A></B>
   TITLE     : Microsoft Office 97 Automation Help File Available on MSL
</PRE></OL> 
<PRE>Keywords          : kbinterop kbtool IntpGrph
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
