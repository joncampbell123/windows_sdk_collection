

<HTML>
<HEAD>
<TITLE>XL97: Format Function May Return an Incorrect Date </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172588">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1997/08/11">
<META NAME="Keywords" CONTENT="kbdta kbdtacode xlvbainfo xlformat">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you run a Visual Basic for Applications macro that uses the Format function with a date, you may notice the following problems:   - When you use the General Date format or the Short Date format, the    month, day, and/or year...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACE,QBVP,QBJZ,QDNG,QBWS,QABA,QBAO,QBS0,QBQU,QAH4,QDNZ,QAPF,QAGJ,QAUD,QDNE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Format Function May Return an Incorrect Date</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172588</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you run a Visual Basic for Applications macro
that uses the Format function with a date, you may notice the following
problems:

<UL><LI>When you use the General Date format or the Short Date format, the
   month, day, and/or year of the dates may be switched.
<P>
   For example, although the date January 10, 1997 may appear in the cell
   as 1/10/97, the actual value of the date is October 1, 1997 (10/1/97).
<P>

<LI>When you use the General Date format or the Short Date format, some of
   the dates appear as text not as valid dates.
<P>
   This problem may occur if the day or year of a date is greater than 12.
   For example, the date July 30, 1997 may appear in the cell as the text
   string "30/07/97" instead of the date 30/07/97.
<P>

<LI>When you use the Long Date format, dates may appear in the Medium Date
   format instead.
<P>
   For example, if the date should appear as "Tuesday, August 12, 1997", it
   may appear as 12-Aug-97 instead.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems may occur if are using regional settings that use a date
order of either day-month-year or year-month-day.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, dates contain three elements: a year, a month, and a
day. The order in which these elements are displayed in a date depends
on the regional settings in use on the computer; these regional settings
vary from country to country. Microsoft Excel mainly uses the three date
orders that are listed in the following table.
<P>
<PRE>   Order            July 5, 1997 is represented as
   -----------------------------------------------

   month-day-year   7/5/97
   day-month-year   5/7/97
   year-month-day   97/7/5

</PRE>Under Microsoft Windows 95 and Microsoft Windows NT, the first order,
month-day-year, is used by the following regional settings:
<P>
<PRE>   English (United States)
   Spanish (Dominican Republic)
   Spanish (Panama)

</PRE>If you are using any of these three regional settings, the problems
described in the "Symptoms" section in this article do not occur.
<P>
If you are using any other regional settings and you run a Visual Basic
macro that uses the Format function to insert dates into cells or to
display a date in a message box, you may encounter the problems described
in this article.
<P>
<P><h3>Example</h3>
 
<P>
You can demonstrate these problems by following these steps:

<OL><P><LI>On the Start menu, point to Settings, and click Control Panel.

<P><LI>Double-click Regional Settings. Select the Regional Settings tab.

<P><LI>In the list of regional settings, click "English (British)," and then
   click OK. When you are prompted, restart the computer.

<P><LI>Start Microsoft Excel 97 and create a new workbook.

<P><LI>On the Tools menu, point to Macro, and click Visual Basic Editor. Then,
   click Module on the Insert menu.

<P><LI>Type the following code into the new module:
<P>
<PRE>      Sub Test()

          Range("A1").Value = Format(Date, "General Date")
          Range("A2").Value = Format(Date, "Long Date")
          Range("A3").Value = Format(Date, "Medium Date")
          Range("A4").Value = Format(Date, "Short Date")

      End Sub

</PRE><P><LI>On the File menu, click "Close and Return to Microsoft Excel."

<P><LI>On the Tools menu, point to Macro, and then click Macros. Click Test
   and click Run.
<P>
</OL>Dates are inserted into cells A1:A4 in the worksheet. Note the following
behavior:

<UL><LI>Cell A2, which should contain a date in the Long Date format (for
   example, Tuesday, August 12, 1997), contains a date in the Medium Date
   format (for example, 12-Aug-97).

<LI>If the day of the month is 12 or less, select cells A1 and A4. On the
   Format menu, click Cells. Click the Number tab. In the Category list,
   click Date. In the Type list, click March 4, 1997. Then, click OK.
<P>
   Note that in the dates in cell A1 and cell A4 the months and days
   are switched. For example, if today is August 12, 1997, the date
   displayed in the cell is December 8, 1997.
<P>

<LI>If the day of the month is more than 12, the dates appear as text
   strings instead of proper dates. You can see an example of this in
   cells A1 and A4

<LI>The date in cell A3, which is formatted by using the Medium Date format,
   appears correctly and has the correct value.
<P>
</UL>NOTE: Be sure to switch the regional settings back to the default settings
when you are done.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 sr1 sr-1 australian canadian new zealand<BR>
french german italian british norwegian portuguese swedish danish ireland<BR>
south africa argentina chile colombia paraguay uruguay peru mexican costa<BR>
rica ecuador guatemala peru venezuela brazilian swiss icelandic indonesian<BR>
afrikaans basque catalan dutch belgian finnish luxembourg austrian<BR>
liechtenstein caribbean jamaica nynorsk bokmal sr1<BR>
Keywords          : kbdta kbdtacode xlvbainfo xlformat<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
