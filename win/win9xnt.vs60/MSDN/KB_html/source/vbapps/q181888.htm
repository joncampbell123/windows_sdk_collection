

<HTML>
<HEAD>
<TITLE>PRB: IPF While Debugging Microsoft Access Automation Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181888">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1998/02/27">
<META NAME="Keywords" CONTENT="kberrmsg kbdta offinterop VBKBAutomation">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  While debugging your code that uses Automation to control Microsoft Access, you may receive one of the following errors.  When automating Microsoft Access 95:     MSACCESS caused an Invalid Page Fault in    module MSACCESS.EXE at 0137:5000f878     ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAH4,QAYL,QAPN,QBXS,QAW6,QAGB,QANF,QA5W,QAPF,QBWS,QAKP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: IPF While Debugging Microsoft Access Automation Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181888</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Basic for Applications version 5.0
<LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
While debugging your code that uses Automation to control Microsoft Access,
you may receive one of the following errors.
<P>
When automating Microsoft Access 95:
<P>
<PRE>   MSACCESS caused an Invalid Page Fault in
   module MSACCESS.EXE at 0137:5000f878

   -or-

   MSACCESS caused an Invalid Page Fault in
   module KERNEL32.DLL at 0137:bff78040

</PRE>When automating Microsoft Access 97:
<P>
<PRE>   VB5 caused an invalid page fault in
   module OLEAUT32.DLL at 0137:65345949.

</PRE>This problem only occurs when you run your code in Break mode (Debug mode).
<P>
<P><h2>CAUSE</h2>
 
<P>
The cause of the problem depends on the version of Microsoft Access that
you are automating.
<P>
<P><h3>In Microsoft Access 95</h3>
 
<P>
When automating Microsoft Access 95, this problem may occur when all of the
following conditions apply:

<UL><LI>You run the code in Break mode.
<LI>You Dim a procedure-level Microsoft Access object variable.
<LI>You set this variable to reference a form or report in the database.
<LI>You do not set this variable to Nothing before ending the procedure.
<P>
</UL>The error occurs when you stop or reach the end the procedure and Microsoft
Access attempts to quit. See the "More Information" section for an example
and workaround.
<P>
<P><h3>Microsoft Access 97</h3>
 
<P>
When automating Microsoft Access 97, this problem may occur when all of the
following conditions apply:

<UL><LI>You run the code in Break mode.
<LI>You Dim a procedure-level Microsoft Access object variable as
   Access.Form or Access.Report.
<LI>You set this variable to reference a form or report in the database.
<P>
</UL>The error occurs when you reference the form or report variable. See the
"More Information" section for an example and workaround.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples show how to reproduce this problem under each
version of Microsoft Access. A workaround is provided for each example.
<P>
<P><h3>Microsoft Access 95</h3>
 
<P>
<PRE>   Sub TestAccess95()
      Dim objAccess As Object
      Dim objForm As Object
      Set objAccess = CreateObject("Access.Application")
      objAccess.Visible = True
      objAccess.OpenCurrentDatabase _
         objAccess.SysCmd(acSysCmdAccessDir) &amp; "Samples\Northwind.mdb"
      objAccess.DoCmd.OpenForm "Employees"
      Set objForm = objAccess.Forms("Employees")
      objAccess.DoCmd.Close acForm, "Employees"
      Stop 'Enters Break Mode, pausing code execution
   End Sub

</PRE>You should establish a reference to the "Microsoft Access for Windows 95"
library in your project before running the code. When you run this
procedure and get to the Stop statement, which enters Break mode, switch
over to Microsoft Access and close the startup form if it is open. Then
switch back to your code and press F8 to continue past the Stop statement
and again past the End Sub.
<P>
Result: Microsoft Access will close automatically because the object
variables lose scope and no forms and reports are open in the database.
This is by design. However, you then receive an Invalid Page Fault error.
<P>
Workaround:
<P>
Set all procedure-level form and report object variables to Nothing before
ending the procedure. For this example, add the following lines at the end
of the procedure:
<P>
<PRE>   Set objForm = Nothing
   Set objAccess = Nothing

</PRE><h3>Microsoft Access 97</h3>
 
<P>
<PRE>   Sub TestAccess97()
      Dim objAccess As Access.Application
      Dim objForm As Access.Form
      Set objAccess = CreateObject("Access.Application")
      objAccess.Visible = True
      objAccess.OpenCurrentDatabase _
         objAccess.SysCmd(acSysCmdAccessDir) &amp; "Samples\Northwind.mdb"
      objAccess.DoCmd.OpenForm "Employees"
      Set objForm = objAccess.Forms("Employees")
      Stop 'Enters Break Mode, pausing code execution
      MsgBox objForm.Name
   End Sub

</PRE>Be sure to establish a reference to the "Microsoft Access 8.0 Object
Library" in your project before running the code. When you run this
procedure and get to the Stop statement, which enters Break mode, press F8
to continue to the MsgBox line.
<P>
Result: An Invalid Page Fault error occurs, causing the client application
to terminate.
<P>
Workaround:
<P>
Dim all procedure-level form and report object variables as Object. For
this example, Dim objForm as Object instead of Access.Form. Another
workaround is to Dim the variable as Access.Form at the module level.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q147816.htm">Q147816</A></B>
   TITLE     : ACC: Using Microsoft Access as an Automation Server

   ARTICLE-ID: <B><A href="../office/q167223.htm">Q167223</A></B>
   TITLE     : Microsoft Office 97 Automation Help File Available on MSL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: access violation gpf crash<BR>
Keywords          : kberrmsg kbdta offinterop VBKBAutomation<BR>
Technology        : ole<BR>
Version           : WINDOWS:5.0,7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
