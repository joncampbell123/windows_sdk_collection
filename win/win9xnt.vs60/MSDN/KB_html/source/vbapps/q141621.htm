

<HTML>
<HEAD>
<TITLE>ACC: How to Create Pop-up Context-Sensitive Help (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141621">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbusage PgmApi PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  One alternative to displaying your application's online Help system in a separate window is to display it in a small, shaded pop-up window within your application. To do thi...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDL9,QBWO,QBWN,QAY5,QDN9,QAB5,QBV8,QAB9,QBWQ,QAPN,QAB4,QBS0,QBSO,QBK5 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create Pop-up Context-Sensitive Help (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141621</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
One alternative to displaying your application's online Help system in a
separate window is to display it in a small, shaded pop-up window within
your application. To do this, you can use the Windows API WinHelp()
function with its HELP_CONTEXTPOPUP argument. This article describes how
to implement such a Help system.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
This article also assumes that you are familiar with creating Windows Help
files using the Windows Help Workshop.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Windows API WinHelp() function supports a large number of options. The
HELP_CONTEXTPOPUP option opens a shaded pop-up window for you to display
Help in. This window is similar to the window that opens when you click a
glossary entry (green, underlined text) in the Microsoft Access Help
system.
<P>
To implement this feature you need to do the following:

<UL><LI>Create a working Help system by setting the HelpContextID and HelpFile
   properties for your forms to a valid Windows Help file.

<LI>Redirect the F1 key to call a user-defined function that opens the
   Help file using the HELP_CONTEXTPOPUP option.
<P>
</UL>Note that jumping or branching to other Help topics from the pop-up Help
window is not supported using the methods discussed in this article.
<P>
The following steps describe how to create the user-defined function to
open the pop-up Help window and how to redirect the F1 key:

<OL><P><LI>Create a module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Declare Function WinHelp Lib "user32" Alias "WinHelpA" _
<PRE></PRE>                       (ByVal hwnd As Long, _
                        ByVal lpHelpFile As String, _
                        ByVal wCommand As Long, _
                        ByVal dwData As Long) As Long
      Public Const HELP_CONTEXTPOPUP = &amp;H8&amp;

   NOTE: You may have some Microsoft Windows API functions defined in an
   existing Microsoft Access library; therefore, your declarations may be
   duplicates. If you receive a duplicate procedure name error message,
   remove or comment out the declarations statement in your code.

</PRE><P><LI>Type the following procedure:
<P>
<P><PRE>      Function Help32() As Boolean
<PRE></PRE>         On Local Error GoTo Help32_Err
         Dim Cid As Long, Result As Long
         On Error Resume Next
         ' Get the HelpContextID of the active control.
         ' The error is 2474 if no control is active.
         Cid = Screen.ActiveControl.HelpContextId

         If Cid = 0 Then
            ' There is no control context ID, so check the form and get
            ' the HelpContextID of the active form.
            ' The error is 2475 if no form is active.
            Cid = Screen.ActiveForm.HelpContextId
         End If

         ' If there is a context ID, open the Help file with context.
         ' Specify your custom Help file for the second argument.
         If Cid &gt; 0 And Cid &lt; 32767 Then
            Result = WinHelp(Application.hWndAccessApp, "C:\Myhelp.Hlp", _
            HELP_CONTEXTPOPUP, Cid)
            Help32 = True
         End If

      Help32_End:
         Exit Function

      Help32_Err:
         MsgBox Err.Description
         Resume Help32_End
      End Function

</PRE><P><LI>Create the following new macro named AutoKeys to redirect the F1 key:
<P>
<PRE>      Macro Name   Condition   Action
      --------------------------------
      {F1}                     RunCode

      AutoKeys Action
      -------------------------
      RunCode
         Function Name: Help32()

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about creating Help files, refer to the online Help
supplied Windows Help Workshop and the Help Workshop's training Cards.
<P>
For more information about HelpContextID, search the Help Index for
"HelpContextID" or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : kbusage PgmApi PgmHowTo
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
