

<HTML>
<HEAD>
<TITLE>XL: Deleted Project or Library Listed Twice In References </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110755">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/01/28">
<META NAME="Keywords" CONTENT="kbprg PgmOthr kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  If you delete a project (.XLS, .XLA) or library (.OLB) file from the hard drive that is referenced by a Visual Basic module, the project or library may be listed twice in the Available References list for the Visual Basic module (even when you clos...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBHQ,QAJN,QAB3,QAFI,QBXB,QATJ,QAEF,QAAW,QBS0,QAJQ,QABI,QABH,QAG0,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Deleted Project or Library Listed Twice In References</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110755</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you delete a project (.XLS, .XLA) or library (.OLB) file from the
hard drive that is referenced by a Visual Basic module, the project
or library may be listed twice in the Available References list for
the Visual Basic module (even when you close and reopen the workbook
that contains the reference). This behavior may also occur if you move
a project or library to a directory on the hard drive other than the
directory you installed Microsoft Excel to, or to a directory that is
contained in your path statement in the AUTOEXEC.BAT file.
<P>
This behavior does not create a problem, but it may be confusing.
<P>
<P><h2>CAUSE</h2>
 
<P>
You may encounter the above behavior if you delete a referenced project or
library from the hard drive in the same session of Microsoft Excel while
the workbook containing the reference is closed, and if all of the
following conditions are true:

<UL><LI>The referenced project or library, and the project that references it
   are located in different directories.
<P>
   -and-

<LI>The project that references the project or library is located in a
   directory that is not contained in your path statement and is not the
   directory to which you installed Microsoft Excel.
<P>
   -and-

<LI>The referenced project or library is located in your Microsoft Excel
   directory, or a directory that IS contained in your path statement.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To remove the "extra" reference to the missing project or library,
you must exit Microsoft Excel.
<P>
NOTE: If the first reference to the missing project or library contains the
prefix "MISSING:", you can resolve this problem by clearing the check box
next to that reference.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In a Visual Basic module, you can use the References command on the
Tools menu to add a project or library as a reference to your module.
This allows you to access information in the project or library
directly from your module. For example, if you add the project
TASK.XLS to a module in BOOK1.XLS using the References dialog box,
you can run any procedure contained in TASK.XLS from any module in
BOOK1.XLS using only the procedure name.
<P>
When you add a project or library to a module using the References
dialog box, the project or library is added to the Available
References list and the check box next to the reference is selected.
The added project or library remains available to the workbook you
added it to unless you clear the check box manually from the
Available References list, or you move or delete the project or
library from the hard drive.
<P>
When you open a workbook that contains references to a project or
library, Microsoft Excel first searches for the project or library in
the directory the project or library was located when you added it.
Then the following directories are searched (not necessarily the
exact order):

<UL><LI>The directory in which you installed Microsoft Excel
<LI>The directory in which the workbook containing the reference is located
<LI>Directories that are in your path statement in the AUTOEXEC.BAT file
<P>
</UL><h3>No Reference Found</h3>
 
<P>
If the project or library is not found, it is listed with the prefix
"MISSING:" in the Available References list. If the project or
library is not found in the same session of Microsoft Excel that it
was added, and the conditions listed above are true, the reference will be
listed a second time and the check box next to it will be cleared.
<P>
<P><h3>Another Reference Found with Same Name</h3>
 
<P>
If the project or library is not found, but a project or library with the
same name is found in a directory in the search order listed above, the
found project or library replaces the previous one in the Available
References list. If the project or library is not found in it's original
location in the same session of Microsoft Excel that it was added, and the
conditions listed above are true, the reference will be listed a second
time and the check box next to it will be cleared.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For a definition of a Referenced Project, choose the Search button in
Help and type:
<P>
<PRE>   referenced project
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00
<P>

Keywords          : kbprg PgmOthr kbprg<BR>
Version           : 5.00 5.00c 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
