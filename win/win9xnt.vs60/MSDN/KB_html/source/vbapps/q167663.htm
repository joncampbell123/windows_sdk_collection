

<HTML>
<HEAD>
<TITLE>ACC97: Only One Menu Bar Can Be Visible at a Time Using Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167663">
<META NAME="KBModify" CONTENT="1998/01/30">
<META NAME="KBCreate" CONTENT="1997/04/28">
<META NAME="Keywords" CONTENT="kbui PgmObj UifMenub">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you create a new menu bar in Visual Basic for Applications code, or when you set the Visible property of an existing menu bar to True, the current menu bar disappears. Howev...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QANS,QAH4,QA1S,QBS0,QDN9,QAPN,QBJZ,QBXS,QAB9,QAHD,QBQU,QAX6,QADX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Only One Menu Bar Can Be Visible at a Time Using Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 30, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167663</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you create a new menu bar in Visual Basic for Applications code, or
when you set the Visible property of an existing menu bar to True, the
current menu bar disappears. However, if you create a new menu bar or view
an existing menu bar by pointing to Toolbars on the View menu, and then
clicking Customize, the current menu bar remains visible along with the new
one.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can set the Visible property of any existing menu bar in code to make
it visible, but this method only allows you to display one menu bar at a
time. When you set the Visible property of any menu bar to True, Microsoft
Access automatically sets the Visible property of all other menu bars to
False.
<P>
For example, assume your database contains two menu bars: MenuBar1 and
MenuBar2. If MenuBar1 is displayed on your screen, the following line of
code automatically sets the Visible property of MenuBar1 to False:
<P>
<PRE>   CommandBars("MenuBar2").Visible = True

</PRE>If MenuBar2 is displayed on your screen, the following line of code
automatically sets the Visible property of MenuBar2 to False:
<P>
<PRE>   CommandBars("MenuBar1").Visible = True

</PRE>In order to display more than one menu bar at a time, you must create your
new menu bar or view an existing one through the user interface as follows:

<OL><P><LI>On the View menu, point to toolbars, and then click Customize.

<P><LI>In the Customize dialog box, select an existing menu bar, or click New
   to create a new one.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a new module.

<P><LI>On the Tools menu, click References.

<P><LI>In the References dialog box, select Microsoft Office 8.0 Object
   Library, and then click OK. If that reference is not listed in the
   Available References box, click the Browse button and search for the
   file, Mso97.dll.

<P><LI>Type the following line in the Declarations section of your module:
<P>
<P><PRE>      Public strCurrentMenuName As String
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      '*******************************************************************
      ' This procedure creates a new menu bar and makes it visible.
      '*******************************************************************
<PRE></PRE>      Sub CreateMenuBar(strNewMenuName as String)
      Dim cmdNewMenu As CommandBar

      ' Set Global strCurrentMenuName to existing menu for use later when
      ' toggling.
      strCurrentMenuName = CommandBars.ActiveMenuBar.Name

      ' Create a new menu bar.
      Set cmdNewMenu = Application.CommandBars.Add(strNewMenuName, _
         msoBarFloating, True, False)
      With cmdNewMenu
        ' Set Protection property to no protection so users can customize
        ' it.
        .Protection = msoBarNoProtection
        ' Show new menu.
        .Visible = True
      End With
      End Sub

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>      CreateMenuBar "ExampleMenu"
</PRE><P>
   A new floating menu bar is displayed on the screen, and the original
   menu bar is hidden from view.
<P>
   NOTE: All command bars require a unique name. If you use the name of an
   existing command bar in the strNewMenuName argument of this procedure,
   you receive the following error message:
<P>
<P><PRE>      Run-time error '5':
      Invalid procedure call or argument
</PRE>
<P><LI>To restore the original menu bar to the screen, type the following line
   in the Debug window, and then press ENTER:
<P>
<P><PRE>      CommandBars(strCurrentMenuName).Visible = True
</PRE><P>
   Note that the original menu bar reappears, and your custom menu bar
   disappears.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about menu bars, search the Help Index for "menu
bars," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the Protection property of command bars, search
the Help Index for "Protection property."
<P>
For more information about creating command bars in code, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q159692.htm">Q159692</A></B>
   TITLE     : ACC97: How to Create Command Bars Using Visual Basic Code

</PRE></OL>For more information on how to programmatically add and remove items on
command bars, please see the following article(s) in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q172300.htm">Q172300</A></B>
   TITLE     : ACC97: Command Bar Wizard Available on MSL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Cmdbar menubar commandbar display show hide<BR>
invisible disappear appear<BR>
Keywords          : kbui PgmObj UifMenub<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 30, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
