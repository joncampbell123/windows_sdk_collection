

<HTML>
<HEAD>
<TITLE>XL98: Problems When Disabling/Enabling Menus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182645">
<META NAME="KBModify" CONTENT="1998/03/18">
<META NAME="KBCreate" CONTENT="1998/03/17">
<META NAME="Keywords" CONTENT="kbprg kbdta kbdtacode xlvbahowto xlui xl97vbmigrate">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel 98 Macintosh Edition, if you run a Visual Basic for Applications macro that attempts to disable an entire menu (the File menu, for example), the menu is not disabled and you do not receive any error messages. The same macro works...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QBJZ,QDO9,QBXS,QBS0,QA4P,QAF0,QAJQ,QBVV,QAB4,QAA5,QAJH,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Problems When Disabling/Enabling Menus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182645</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, if you run a Visual Basic for
Applications macro that attempts to disable an entire menu (the File menu,
for example), the menu is not disabled and you do not receive any error
messages. The same macro works correctly in Microsoft Excel version 5.0.
<P>
The same applies if a Visual Basic for Applications macro attempts to
enable an entire menu.
<P>
<P><h2>CAUSE</h2>
 
<P>
This will occur if your macro uses code similar to the following to disable
or enable an entire menu, respectively:
<P>
<PRE>   Application.MenuBars(xlWorksheet).Menus("File").Enabled = False

    -or-

   Application.MenuBars(xlWorksheet).Menus("File").Enabled = True

</PRE><h2>WORKAROUND</h2>
 
<P>
If a Visual Basic for Applications macro in Microsoft Excel 98 Macintosh
Edition must disable or enable an entire menu, use code similar to the
following in your macro, respectively:
<P>
<PRE>   CommandBars("File").Enabled = False

    -or-

   CommandBars("File").Enabled = True

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel version 5.0, menus are contained in menubars. For
example, the File menu is contained by the "xlWorksheet" menubar. Because
of this, the command to disable a particular menu requires that you refer
not only to the menu, but also to the menubar that contains it. For
example:
<P>
<PRE>   Application.MenuBars(xlWorksheet).Menus("File").Enabled = False

</PRE>NOTE: Adding "Application." to the beginning of the line of code is usually
not required, but it is included here in order to provide a complete code
example.
<P>
In Microsoft Excel 98 Macintosh Edition, menus are not contained by
menubars. Instead, they are independent entities belonging to the
CommandBars collection. So, you don't have to refer to any other object
when trying to disable a particular menu:
<P>
<PRE>   CommandBars("File").Enabled = False

</PRE>This command will work correctly in Microsoft Excel 98 Macintosh Edition.
<P>
Because of the change in program design, Microsoft Excel 98 Macintosh
Edition cannot properly execute the first command shown above. However, you
will not receive an error message when the command is executed: Microsoft
Excel 98 Macintosh Edition will merely ignore the command and continue
macro execution.
<P>
Below are two macro examples that demonstrate the difference in behavior
between Microsoft Excel 98 Macintosh Edition and earlier versions of
Microsoft Excel. The first macro will disable the File menu in Microsoft
Excel version 5.0, but will do nothing in Microsoft Excel 98 Macintosh
Edition. The second macro will disable the File menu in Microsoft Excel 98
Macintosh Edition. To redisplay the File menu in any version of Microsoft
Excel, set the Enabled property in either macro to True and then rerun the
macro.
<P>
<PRE>   Sub WorksInExcel5()
       Application.MenuBars(xlWorksheet).Menus("File").Enabled = False
   End Sub

   Sub WorksInExcel98()
       CommandBars("File").Enabled = False
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98<BR>
Keywords          : kbprg kbdta kbdtacode xlvbahowto xlui xl97vbmigrate<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
