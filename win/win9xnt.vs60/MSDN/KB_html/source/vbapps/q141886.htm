

<HTML>
<HEAD>
<TITLE>ACC: How to Create a Version 2.0 Database Using Access 95/97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141886">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1995/12/31">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo MdlDao">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how you can use data access objects (DAO) to create a Microsoft Access 2.0 database and to copy entire tables from a Microsoft Access 7.0 or 97 database...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAZV,QA3P,QAPN,QBS0,QBXL,QDNE,QA28,QAY2,QAX6,QAW6,QATJ,QAC1 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create a Version 2.0 Database Using Access 95/97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141886</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how you can use data access objects (DAO) to
create a Microsoft Access 2.0 database and to copy entire tables from a
Microsoft Access 7.0 or 97 database. This technique enables you to share
data with others who run Microsoft Access 2.0.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a Microsoft Access 2.0 database and copy tables from the
current Microsoft Access 7.0 or 97 database, follow these steps:

<OL><P><LI>Create a new module.

<P><LI>Type the following procedure:
<P>
<P><PRE>      Public Function CreateDB()
<PRE></PRE>         Dim newdb As DATABASE, mydb As DATABASE
         Dim dbname As String
         Dim tdf As TableDef

         'Set the path and name for the new database.
         dbname = "c:\msoffice\access\Newdb.mdb"

         'Create the new 2.0 database and close newdb.
         Set newdb = DBEngine.Workspaces(0).CreateDatabase(dbname, _
         dbLangGeneral, dbVersion20)
         newdb.Close

         'Export all non-system tables to the version 2.0 database.
         Set mydb = CurrentDb()
         For Each tdf In mydb.TableDefs
            If (tdf.Attributes And dbSystemObject) = 0 Then
               DoCmd.TransferDatabase acExport, "Microsoft Access", _
               dbname, acTable, tdf.Name, tdf.Name
            End If
         Next tdf

      End Function

</PRE><P><LI>To test the function, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>      ? CreateDB()
</PRE><P>
   Note that the new version 2.0 database is created (in the location you
   specified) and that all nonsystem tables in the current version
   database are exported to the new version 2.0 database.
<P>
   NOTE: You can export only tables to a Microsoft Access 2.0 database; you
   cannot export other database objects such as forms or reports. If you
   try to export other objects, you receive the following error:
<P>
<P><PRE>      Run-time error '7854':
      You can't export database objects (except tables) from the
      current version of Microsoft Access to previous versions of
      Microsoft Access.
</PRE><P>
   In addition, you cannot export tables from databases that have been
   replicated, since these tables have system-defined fields with a
   datatype of ReplicationID, which do not export because Microsoft Access
   2.0 does not have a ReplicationID datatype.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating databases using DAO, search for
"CreateDatabase," and then "CreateDatabase method" using the Microsoft
Access 97 Help Index.
<P>
For more information about the Attributes property and the dbSystemObject
constant, search for "Attributes," and then "Attributes property" using the
Microsoft Access 97 Help Index.
 
<PRE>Keywords          : kbprg PgmHowTo MdlDao
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
