

<HTML>
<HEAD>
<TITLE>ACC97: Error: "There Isn't Enough Disk Space or Memory" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161329">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1996/12/19">
<META NAME="Keywords" CONTENT="kberrmsg kbnetwork PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.  Advanced: Requ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QAB4,QBXS,QBW5,QDN9,QAAP,QBS0,QAXB,QAH4,QDL9,QBWQ,QBWO,QBWN,QDKY P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Error: "There Isn't Enough Disk Space or Memory"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161329</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you perform an operation on a table, you may receive the following
error message if the operation creates a large number of page locks:
<P>
<PRE>   There isn't enough disk space or memory.

</PRE>If you run an action query on a large table, you may receive this error
message:
<P>
<PRE>   There isn't enough disk space or memory to undo the data changes this
   action query is about to make.

</PRE>Portions of this article assume that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
The page locks required for the transaction exceed the MaxLocksPerFile
value, which defaults to 9500 locks. The MaxLocksPerFile setting is stored
in the Windows Registry.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are several ways to work around this behavior:

<UL><LI>You can use Regedit.exe to edit the Windows Registry and change the
   MaxLocksPerFile value permanently.

<LI>You can use the SetOption method of the DBEngine object to change the
   MaxLocksPerFile value temporarily in code.

<LI>If the error occurs when you run an action query, you can modify the
   query and set its UseTransaction property to No.
<P>
</UL><h3>Method 1: Changing MaxLocksPerFile in the Windows Registry</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
Use Registry Editor to increase the MaxLocksPerFile value under the
following key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Jet\3.5\Engines\Jet 3.5

</PRE>Note that this method changes the Windows Registry setting for all
applications that use the Microsoft Jet database engine version 3.5.
<P>
<P><h3>Method 2: Using SetOption to Change MaxLocksPerFile Temporarily</h3>
 
<P>
The SetOption method temporarily overrides values for the Microsoft Jet
database engine keys in the Windows Registry. The new value remains in
effect until you change it again, or until the DBEngine object is closed.
<P>
NOTE: Changes made to the MaxLocksPerFile setting using the SetOption
<PRE>      method will only be available through the current session of DAO
     (Data Access Objects).  Queries run through the Microsoft Access user
      interface, will still use the settings within the registry.

</PRE>The following code sample sets MaxLocksPerFile to 200,000 before executing
an update operation inside a transaction:
<P>
<PRE>   Sub LargeUpdate()
      On Error GoTo LargeUpdate_Error
      Dim db As Database, ws As Workspace

      ' Set MaxLocksPerFile.
      DBEngine.SetOption dbMaxLocksPerFile, 200000

      Set db = CurrentDb
      Set ws = Workspaces(0)

      ' Perform the update.
      ws.BeginTrans
      db.Execute "UPDATE LargeTable SET Field1 = 'Updated Field'", _
         dbFailOnError
      ws.CommitTrans

      db.Close
      MsgBox "Done!"
      Exit Sub
   LargeUpdate_Error:
      MsgBox Err &amp; " " &amp; Error
      ws.Rollback
      MsgBox "Operation Failed - Update Canceled"
      Exit Sub
   End Sub

</PRE><h3>Method 3: Setting the UseTransaction Property in an Action Query</h3>
 
<P>
If a stored action query causes the error, you can set its UseTransaction
property to No. Note that if you do this, you will not able to roll back
your changes if there is a problem or an error while the query is
executing:

<OL><P><LI>Open the query in Design view.

<P><LI>On the View menu, click Properties.

<P><LI>Click an empty space in the upper half of the query window to display
   the Query Properties dialog box.

<P><LI>Set the UseTransaction property to No.

<P><LI>Save the query and close it.
<P>
</OL>STATUS
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The MaxLocksPerFile setting in the Windows Registry prevents transactions
in the Microsoft Jet database engine from exceeding a specified value. If a
transaction attempts to create locks in excess of the MaxLocksPerFile
value, then the transaction is split into two or more parts and partially
committed. This feature was added to Microsoft Access 97 to prevent Netware
3.1 server crashes when the specified Netware lock limit was exceeded, and
to improve performance with both Netware and Windows NT.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example uses a Visual Basic procedure to create a table with
10,000 records in it, and then modifies the table in order to cause the
error message:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following procedure.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code.
<P>
<PRE>      Sub CreateBigTable()
         Dim db As Database, rs As Recordset
         Dim iCounter As Integer, strChar As String
         Set db = CurrentDb
         db.Execute "CREATE TABLE BigTable (ID LONG, Field1 TEXT(255), _
            Field2 TEXT(255), Field3 TEXT(255), Field4 TEXT(255))", _
            dbFailOnError
         Set rs = db.OpenRecordset("BigTable", dbOpenDynaset)
         iCounter = 0
         strChar = String(255, " ")
         While iCounter &lt;= 10000
            rs.AddNew
            rs!ID = iCounter
            rs!Field1 = strChar
            rs!Field2 = strChar
            rs!Field3 = strChar
            rs!Field4 = strChar
            rs.Update
            iCounter = iCounter + 1
         Wend
         MsgBox "Done!"
      End Sub

</PRE><P><LI>To run the procedure, type the following line in the Debug window,
   and then press ENTER.
<P>
<P><PRE>       CreateBigTable
</PRE><P>
   The procedure creates a table called BigTable with 10,000 records in it.

<P><LI>Save the module as Module1 and close it.

<P><LI>Open the BigTable table in Design view.

<P><LI>Change the FieldSize property of Field4 to 253.

<P><LI>Save the table. Click OK when you are prompted that some data may be
   lost. Note that after a time you receive the following error messages:
<P>
<P><PRE>      Microsoft Access can't change the data type.
      There isn't enough disk space or memory.
</PRE><P>
<P><PRE>      Errors were encountered during the save operation. Data types were
      not changed. Properties were not updated.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the SetOption method, search the Help Index for
"SetOption method."
<P>
For more information about customizing Windows Registry settings for
Microsoft Access 97, search the Help Index for "Registry."
<P>
For more information about the UseTransaction property, search the Help
Index for "UseTransaction property."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MaxLocksPerFile Netware<BR>
Keywords          : kberrmsg kbnetwork PgmObj<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
