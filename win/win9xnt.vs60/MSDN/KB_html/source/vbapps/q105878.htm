

<HTML>
<HEAD>
<TITLE>XL5: Using SENDKEYS to Change Paper Source in Printer Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105878">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/10/27">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can use the following Visual Basic, Applications Edition, macros to change the paper source on the Hewlett-Packard (HP) LaserJet 4/4M to the lower tray.  Sample Macros  Microsoft provides examples of Visual Basic procedures ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QAK6,QAYZ,QAA1,QACT,QDI2,QDIZ,QACS,QA2Q,QAG2,QBVP,QAJH,QAFF,QAOX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Using SENDKEYS to Change Paper Source in Printer Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105878</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can use the following Visual Basic, Applications
Edition, macros to change the paper source on the Hewlett-Packard (HP)
LaserJet 4/4M to the lower tray.
<P>
<P><h3>Sample Macros</h3>
 
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
To send key commands to the Printer Setup dialog box, use the following
code:
<P>
<PRE>   Sub HP4_Paper_Source()
        Application.Wait Now + Timevalue("00:00:01")
        Application.ActivePrinter = "HP LaserJet 4/4M on LPT1:"
        SendKeys "%(f)(p)(r)%(s)%(s){pgup}{down}{down}
        {down}{down}~~~"
   End Sub

</PRE>In order to use this Macro with a shortcut key, you must put a wait
statement before the Application.ActivePrinter line. The wait may have to
be adjusted depending on the system environment. For example, to make the
macro wait one second, use the following line of code:
<P>
<PRE>   Application.Wait Now + Timevalue("00:00:01")

</PRE>The following is an explanation of the string used in the SendKeys
function:
<P>
<PRE>   This command       Performs this action
   ----------------------------------------------------

   %(f)(p)(r)         Chooses Printer Setup in the Print dialog
   %(s)               Chooses Setup in the Printer Setup dialog
   %(s)               Chooses Paper Source in the HP 4/4M Setup dialog
   {pgup}             Moves Paper Source selection up
   {down}             Moves Paper Source selection down

</PRE>To set the paper source, and then set it back to Auto Select, use the
following code:
<P>
<PRE>   Sub HP4_Paper_Source()
      Application.Wait Now + TimeValue("00:00:01")
      Application.ActivePrinter = "HP LaserJet 4Si/4Si MX on LPT1:"
      SendKeys "%(f)(p)(r)%(s)%(s){pgup}{down}{down}{down}{down}~~~"
      Application.OnTime Now + TimeValue("00:00:08"), "setback"
      ' SendKeys "%(f)(p)(r)%(s)%(s){pgup}~~~"
   End Sub

   Sub setback()
      Application.Wait Now + TimeValue("00:00:01")
      Application.ActivePrinter = "HP LaserJet 4Si/4Si MX on LPT1:"
      SendKeys "%(f)(p)(r)%(s)%(s){pgup}~~~"
   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
In the Printer Setup dialog box, there is no accelerator key combination
that will directly select a paper source such as lower tray. Instead, the
arrow key should be used to select from the list of available sources. For
example, on the HP LaserJet 4/4M there are six possible choices for the
paper source:

<UL><LI>Auto Select
<LI>MP Tray
<LI>Paper Cassette
<LI>Manual Feed
<LI>Lower Cassette
<LI>Envelope Feeder
<P>
</UL>Because the current paper source selection is not known before
execution of the macro, use the {pgup} command to select the first
item in the Paper Source list. This will guarantee that Auto Select is
chosen. Four DOWN ARROW keystrokes will select the lower cassette.
<P>
NOTE: This macro may work for other printers or may require a
different sequence of keystrokes depending on the printer driver.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Visual Basic User's Guide," version 5.0, Chapter 6
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 print<BR>
Keywords          : kbprg PgmHowTo<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
