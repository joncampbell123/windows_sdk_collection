

<HTML>
<HEAD>
<TITLE>More Data Pasted Than Expected with SELECTION.OFFSET.SELECT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113703">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1994/04/12">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmOthr kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use the following Visual Basic, Applications Edition, command in a macro     SELECTION.OFFSET(rowOffset, columnOffset).SELECT  in conjunction with the Copy and Paste methods, you may receive the following unexpected results:   - More data ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9N,QDMR,QAH4,QBS0,QDNZ,QBVP,QAYY,QAJB,QAE1,QA2Q,QASB,QBCF,QDMN,QAX6,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>More Data Pasted Than Expected with SELECTION.OFFSET.SELECT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113703</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the following Visual Basic, Applications Edition, command in a
macro
<P>
<PRE>   SELECTION.OFFSET(rowOffset, columnOffset).SELECT

</PRE>in conjunction with the Copy and Paste methods, you may receive the
following unexpected results:

<UL><LI>More data is pasted to the destination than expected.
<P>
   -or-

<LI>You receive the "Copy and Paste Areas Are Different Shapes" error
   message.
<P>
</UL><h2>CAUSE</h2>
 
<P>
When you use a macro to paste data in a worksheet, and you then attempt to
paste another selection to the same worksheet, if you do not make a new
selection for the range that you want to paste to, the copied data is
pasted to the range that you previously pasted to. For example, if you copy
one column of cells, and the last range you pasted to contained three
columns, when you use the Paste method without making another selection,
the three columns are filled with the single column of data you copied.
<P>
If you use the Offset method to offset the selected range, the offset
selection retains the size of the previously pasted range (that is, the
entire selected range is offset by the number of specified rows and
columns).
<P>
In addition, because the Paste method allows you to paste data to fill the
entire selected range, when you offset the selected range, if that range is
larger than the range of data you want to paste, Microsoft Excel will fill
the remaining cells in the selection.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, create a variable for your selection, and use
the Resize method to make the destination range the desired size. For
example, to create a destination range that is offset by the number of
columns in your selection, but is resized to one column, use the following
code:
<P>
<PRE>   x = Selection.Columns.Count
      Selection.Offset(0, x).Resize(, 1).Select

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a workbook with two worksheets, Sheet2 (the sheet that the
   original data will be on), and Sheet 1 (the sheet on which data will be
   pasted).

<P><LI>On Sheet2, type the following information:
<P>
<PRE>           A        B      C
      -------------------------

      1    100      200    300
      2    100      200    300
      3    100      200    300
      4    100      200    300
      5    100      200    300

</PRE><P><LI>In a Visual Basic module, type the following macro:
<P>
<PRE>   Sub Test()
        ' Select the first two columns from the source sheet
        Sheets("Sheet2").Select
        Range("A1:B5").Select
        Selection.Copy
        ' Paste the data into the destination sheet
        Sheets("Sheet1").Select
        ActiveSheet.Paste
        Application.CutCopyMode = False
        ' Copy the third column from the destination sheet
        Sheets("Sheet2").Select
        Range("C1:C5").Select
       ' Paste it into the destination area
        Selection.Copy
        Sheets("Sheet1").Select
        Selection.Offset(0,2).Select
        ActiveSheet.Paste
   End Sub

</PRE></OL>When you run this macro, column C is pasted to fill the selected range (in
this case, the selected range is C1:D5 which is the result of offsetting
the originally selected range, A1:B5, by two columns).
<P>
<PRE>           A        B      C      D
      ---------------------------------

      1    100      200    300    300
      2    100      200    300    300
      3    100      200    300    300
      4    100      200    300    300
      5    100      200    300    300

</PRE>To edit this macro so that the data is copied correctly, replace the line
of code that reads:
<P>
<PRE>   Selection.Offset(0,2).Select

   -with-

    x = Selection.Columns.Count
      Selection.Offset(0, x).Resize(, 1).Select

</PRE>When you run the macro with this change included, the copied data is pasted
once into the correct paste range.
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:5.00 5.00c 7.00 7.00a<BR>
Keywords          : kbprg PgmHowTo PgmOthr kbprg<BR>
Version           : 5.00 5.00c 7.00 7.00a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
