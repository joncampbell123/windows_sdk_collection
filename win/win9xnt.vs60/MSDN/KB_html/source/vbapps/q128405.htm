

<HTML>
<HEAD>
<TITLE>XL: How to Run a WordBasic Macro from an MS Excel Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128405">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1995/04/02">
<META NAME="Keywords" CONTENT="IntpDde kbhowto kbinterop kbmacro kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel for Windows, you can create a Microsoft Excel macro that uses either dynamic data exchange (DDE) or OLE Automation with Microsoft Word to run a WordBasic Macro. The purpose of this article is to demonstrate, by example, how to ru...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAIH,QAH4,QA5F,QDL9,QBWQ,QBWO,QBWN,QBWS,QBS0,QBWP,QBUG,QBUF,QAPN,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Run a WordBasic Macro from an MS Excel Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128405</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Word for Windows NT, version 6.0
<LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel for Windows, you can create a Microsoft Excel macro that
uses either dynamic data exchange (DDE) or OLE Automation with Microsoft
Word to run a WordBasic Macro. The purpose of this article is to
demonstrate, by example, how to run a WordBasic macro using both of these
methods.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Example 1</h3>
 
<P>
<PRE>' The following macro demonstrates how to run the WordBasic macro
' "Macro1" by using DDE

Sub RunWordMacro_DDE()
</PRE>Dim chan
<P>
<PRE>   ' Initiate a channel with Microsoft Word.
   chan = DDEInitiate("Winword", "System")

   ' Execute a command on the channel to run the Wordbasic macro.
   DDEExecute chan, "[Toolsmacro.name=""Macro1"",.Run]"

   ' Terminate the channel.
   DDETerminate chan

End Sub

</PRE><h3>Example 2</h3>
 
<P>
<PRE>' The following macro demonstrates how to run the WordBasic macro
' "Macro1" by using OLE Automation

Sub RunWordMacro_OLE()
</PRE>Dim WordObj As Object
<P>
<PRE>   ' Create the WordBasic object.
   Set WordObj = CreateObject("Word.Basic")
   '
   ' In Microsoft Excel 97, the line of code to use is
   '
   ' Set WordObj = CreateObject("Word.Basic.8")

   ' Run the WordBasic macro "Macro1".
   With WordObj
       .ToolsMacro Name:="Macro1", Run:=True
   End With

   ' Set the WordBasic object to nothing to end OLE Automation.
   Set WordObj = Nothing

End Sub


</PRE>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q120979.htm">Q120979</A></B>
   TITLE     : How to Use Named WordBasic Arguments in OLE Automation

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 7.00 97 WORD7 WORD97<BR>
Keywords          : IntpDde kbhowto kbinterop kbmacro kbole kbprg<BR>
Version           : 5.00 5.00c 7.00 7.00a 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
