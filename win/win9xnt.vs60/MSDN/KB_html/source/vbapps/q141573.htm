

<HTML>
<HEAD>
<TITLE>XL: How to Add Data to a Drop-Down or List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141573">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbcode kbprg PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In Microsoft Excel, there are two ways of populating a list or drop-down box: you can link worksheet data to the control, or you can run a Microsoft Visual Basic for Applications macro to add data to the control.  MORE INFORMATION  To link the list...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBVP,QBV3,QA01,QBS0,QANX,QA9Z,QAH4,QAB5,QACI,QBWS,QA9N,QA7O,QAUJ,QAOE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Add Data to a Drop-Down or List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141573</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, there are two ways of populating a list or drop-down
box: you can link worksheet data to the control, or you can run a Microsoft
Visual Basic for Applications macro to add data to the control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>To link the list box or drop-down box to a range of cells on a worksheet</h3>
 

<OL><P><LI>Create a list box or drop-down on a custom dialog box.

<P><LI>Select the control.

<P><LI>On the Format menu, click Object, and click the Control tab.

<P><LI>In the Input Range box, enter a reference to a vertical range of cells
   (for example, Sheet1!$A$1:$A$10).
<P>
   Do not include a header row unless you want that row to be included in
   the list or drop-down box.
<P>
</OL><h3>To use a Visual Basic Macro to populate the drop-down or list box</h3>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE></OL>To create the dialog box:

<OL><P><LI>Insert a dialog sheet. Name this sheet "Dialog1" (without the quotation
   marks).
<P>
   NOTE: To name a dialog box element, type the name in the Name box (the
   box at the left end of the formula bar).

<P><LI>Create a list box control on the dialog box. Name the list box "List Box
   4" (without the quotation marks).

<P><LI>Create a drop-down box on the dialog box. Name drop-down box "Drop Down
   5" (without the quotation marks).

<P><LI>In a module sheet, enter the following macro code:
<P>
<PRE>      Sub Fill_Control()
         Dim diag As Object
         Dim mylist As Object
         Dim mydrop As Object

         Set diag = DialogSheets("Dialog1")
         Set mylist = diag.ListBoxes("List Box 4")
         Set mydrop = diag.DropDowns("Drop Down 5")

         'Remove all items from drop-down and list box
         mylist.RemoveAllItems
         mydrop.RemoveAllItems

         'Insert data into List Box and Drop Down
         myarray = Array("Tom", "Fred", "Sam", "Wilma", "Sandy")

         For x = 0 To 4
            mylist.AddItem myarray(x)
            mydrop.AddItem myarray(x)
         Next x

         'Show Dialog Box
         diag.Show

      End Sub

</PRE><P><LI>To run the macro, position the insertion point on the line that reads,
<PRE>   Sub Fill_Control(), and press F5.

</PRE></OL>Switch to the dialog sheet and click the Run Dialog button to run the
dialog box. When you use each of the controls, note that they contain the
data from the arrays that you created in the macro. To quit the dialog box,
click Enter or Cancel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Visual Basic User's Guide," version 5.0, page 231
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 7.00 97 98 XL98 XL97 XL7 XL5<BR>
Keywords          : kbcode kbprg PgmHowto<BR>
Version           : WINDOWS:5.0,7.0;MACINTOSH:5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
