

<HTML>
<HEAD>
<TITLE>XL: Returning Address of the Cell with Largest or Smallest Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139574">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1995/11/13">
<META NAME="Keywords" CONTENT="kbprg xlformula PgmHowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The examples in the  More Information  section of this article demonstrate two ways you can find the address of the cell containing the largest or smallest value in a range of cells. If you are using a single row or column of data, you can use a wo...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNZ,QAKD,QBVP,QAR5,QAC2,QAUD,QBS0,QAB9,QAY5,QAYL,QAHH,QBV8,QDMR,QAPF,QANX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Returning Address of the Cell with Largest or Smallest Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139574</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for the Macintosh, version 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The examples in the "More Information" section of this article demonstrate
two ways you can find the address of the cell containing the largest or
smallest value in a range of cells. If you are using a single row or column
of data, you can use a worksheet formula. If you are using multiple rows or
columns of adjacent data, you will need to create a custom Visual Basic for
applications function. For examples of both methods, see the "More
Information" section of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using Formulas</h3>
 
<P>
You can return the address of the cell with the largest or smallest value
in a column or row by using the CELL(), OFFSET(), and MATCH() functions
along with the MAX()or the MIN() function.
<P>
If there are multiple occurrences of the largest or smallest value, the
following formulas will return the cell address of the first occurrence of
the value. If there is only one occurrence of the value, the address of
the cell containing that value will be returned.
<P>
To return the address of a cell in a column (in this example, column A,
cells A1:A10), use the appropriate formula in the following table.
<P>
<PRE>   For this
   address      Use this formula
   ------------------------------------------------------------------------

   Cell with
   largest
   value        =CELL("address",OFFSET(A1,MATCH(MAX(A1:A10),A1:A10,0)-1,0))

   Cell with
   smallest
   value        =CELL("address",OFFSET(A1,MATCH(MIN(A1:A10),A1:A10,0)-1,0))

</PRE>To return the address of a cell in a row (in this example, column A, cells
A1:J1), use the appropriate formula in the following table.
<P>
<PRE>   For this
   address      Use this formula
   ------------------------------------------------------------------------

   Cell with
   largest
   value        =CELL("address",OFFSET(A1,0,MATCH(MAX(A1:J1),A1:J1,0)-1))

   Cell with
   smallest
   value        =CELL("address",OFFSET(A1,0,MATCH(MIN(A1:J1),A1:J1,0)-1))

</PRE><h3>Using Custom Functions</h3>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>To return the cell address of the largest value in an adjacent range that
is larger than a single column or row, you can create a custom Microsoft 
Visual Basic for Applications function.
<P>
<PRE>   Function MaxAddress(The_Range)

      ' Sets variable equal to maximum value in the input range.
      MaxNum = Application.Max(The_Range)
      ' Loop to check each cell in the input range to see if equals the
      ' MaxNum variable.
      For Each cell In The_Range
         If cell = MaxNum Then
            ' If the cell value equals the MaxNum variable it
            ' returns the address to the function and exits the loop.
            MaxAddress = cell.Address
            Exit For
         End If
      Next cell

   End Function

</PRE>To find the cell address of the smallest value in an adjacent range,
substitute the Min() function for the Max() function as in the following
example:
<P>
<PRE>   Function MinAddress(The_Range)

      ' Sets variable equal to minimum value in the input range.
      MinNum = Application.Min(The_Range)
      ' Loop to check each cell in the input range to see if equals the
      ' min variable.
      For Each cell In The_Range
         If cell = MinNum Then
            ' If the cell value equals the max variable it
            ' returns the address to the function and exits the loop
            MinAddress = cell.Address
            Exit For
         End If
      Next cell

   End Function

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information about getting help with Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 7.00 8.00 adjacent contiguous nonadjacent <BR>
noncontiguous discontiguous discontinuous maximum minimum greatest least<BR>
Keywords          : kbprg xlformula PgmHowto<BR>
Version           : WINDOWS:5.0,7.0,97; MACINTOSH:5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
