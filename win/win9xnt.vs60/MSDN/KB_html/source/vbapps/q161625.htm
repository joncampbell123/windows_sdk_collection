

<HTML>
<HEAD>
<TITLE>XL97: Cannot Move Among Unlocked Cells in Scroll Area with TAB </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161625">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/12/31">
<META NAME="Keywords" CONTENT="kbcode xlvbahowto">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  When you use a Visual Basic for Applications macro to cycle through unlocked cells, you cannot use the TAB or arrow key to move the active cell through the unlocked cells. However, you can select an unlocked cell in the scroll area with the pointer...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDNZ,QAH4,QABT,QAM9,QALX,QAK9,QBXQ,QA2Q,QAK7,QDMR,QBVP,QA6A,QAO2,QAJ6 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Cannot Move Among Unlocked Cells in Scroll Area with TAB</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161625</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use a Visual Basic for Applications macro to cycle through
unlocked cells, you cannot use the TAB or arrow key to move the active cell
through the unlocked cells. However, you can select an unlocked cell in the
scroll area with the pointer.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when all of the following conditions are true:

<UL><LI>The macro restricts the scroll area to a specific range of cells by
   using the ScrollArea property.
<P>
   -and-

<LI>The worksheet contains multiple (noncontiguous) selections of unlocked
   cells.
<P>
   -and-

<LI>You unlock cells outside of the scroll area and use the TAB or arrow
   key to move between unlocked cells.
<P>
</UL>Pressing the TAB or arrow key fails because these keystrokes function by
determining the next unlocked cell that is to the right or below the active
cell, and these cells are outside the restricted scroll area.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
To work around this problem, temporarily lock all cells that are outside of
the scroll area. To do this, create a Visual Basic macro that limits the
cells that can be selected on the worksheet. This macro must unlock cells
that can be selected, protect the worksheet, and then restrict the scroll
area to encompass the cells that can be viewed.
<P>
NOTE: By restricting the scroll area, you cannot select some cells using
the TAB or the arrow key.
<P>
<P><h3>Visual Basic Macro Example</h3>
 
<P>
The following macro example locks cells outside of the scroll area on
Sheet1 of a new workbook:
<P>
<PRE>   Sub Set_Restrictions()
   
       Dim myArea As Object
       Dim counter As Integer
   
       Range("B5:C10").Locked = False
       Range("C14:D16").Locked = False
   
       With Worksheets("sheet1")
           .EnableSelection = xlUnlockedCells
           .Protect contents:=True, userinterfaceonly:=True
           .ScrollArea = "a1:e20"
       End With
   
       Set myArea = Range(Worksheets("sheet1").ScrollArea)
   
       For counter = (myArea.Column + myArea.Columns.Count + 1) To 256
           Columns(counter).Locked = True
       Next counter
   
   End Sub

</PRE>To reset the scroll area and avoid putting restrictions cells that can be
selected, run the following macro:
<P>
<PRE>   Sub No_Restrictions()
       With Worksheets("sheet1")
           .EnableSelection = xlNoRestrictions
           .Protect contents:=False, userinterfaceonly:=True
           .ScrollArea = ""
       End With
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Locked property, click the Index tab in
Microsoft Visual Basic Help, type the following text
<P>
<PRE>   locked

</PRE>and then double-click the selected text to go to the "Locked Property"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00<BR>
Keywords          : kbcode xlvbahowto<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
