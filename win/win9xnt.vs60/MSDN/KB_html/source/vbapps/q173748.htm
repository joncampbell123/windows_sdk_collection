

<HTML>
<HEAD>
<TITLE>ACC: How to Use DAO to Link an Excel Spreadsheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173748">
<META NAME="KBModify" CONTENT="1998/02/24">
<META NAME="KBCreate" CONTENT="1997/09/11">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  You can use data access objects (DAO) to programmatically link a Microsoft Excel spreadsheet using Microsoft Visual Basic for Applications code.  MORE INFORMATION  Microsof...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QAVZ,QA1S,QDN9,QAKE,QATX,QDNM,QAE2,QAX6,QAPN,QAH4,QDO5,QBWA,QAI5 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use DAO to Link an Excel Spreadsheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 24, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173748</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
You can use data access objects (DAO) to programmatically link a Microsoft
Excel spreadsheet using Microsoft Visual Basic for Applications code.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>The following example uses DAO in a Visual Basic procedure to link a
Microsoft Excel spreadsheet.

<OL><P><LI>Start Microsoft Excel.

<P><LI>On Sheet1 of a new workbook, type the following in cells A1:C3.
<P>
<PRE>      A1: First   B1: Last    C1: Middle.
      A2: Adam    B2: Smith   C2: A.
      A3: Bob     B3: Jones   C3: B.

</PRE><P><LI>Save the workbook as LinkTest.xls in the folder My Documents.

<P><LI>Close the workbook and quit Microsoft Excel.

<P><LI>Start Microsoft Access and create a new database.

<P><LI>Create a new module and type the following procedure in it:
<P>
<PRE>      Sub XLLink(strNewAccTable as string, strXLFileName as String, _
           strImportSheet as String)

         ' Variables:
         '   strNewAccTable - the name of your new linked table.
         '   strXLFileName - the path and name of your Excel file. This
         '                   should be in the form "C:\MyDir\MyFile.xls."
         '   strImportSheet - the name of the sheet you want to link.
         ' All these variable are strings, and should be supplied to the
         ' subroutine enclosed in quotation marks.

         On Error GoTo XLError

         Dim db As DATABASE
         Dim td As TableDef

         Set db = CurrentDb

         ' Create a new TableDef using the passed name.
         Set td = db.CreateTableDef(strNewAccTable)

         ' Set the ConnectString property to the Excel file to link.
         ' In Microsoft Access 7.0, the ConnectString needs to reflect the
         ' version of Excel. Remove the apostrophe from the Excel 5.0
         ' line and comment out the Excel 8.0 line when working with
         ' Excel 5.0/95.
         ' td.Connect = "Excel 5.0;DATABASE=" &amp; strXLFileName &amp; ";"
         td.Connect = "Excel 8.0;DATABASE=" &amp; strXLFileName &amp; ";"
         td.SourceTableName = strImportSheet &amp; "$"

         ' Append the new TableDef to the TableDefs collection.
         db.TableDefs.Append td

      Exit_XLLink:
         Exit Sub

      XLError:
         MsgBox Err.Number &amp; " " &amp; Err.Description
         Resume Exit_XLLink

      End Sub

</PRE><P><LI>On the Debug menu, click Compile Loaded Modules.

<P><LI>On the Tools menu, click Debug Window.

<P><LI>In the Debug window, type:
<P>
<P><PRE>      XLLink "New Link", "C:\My Documents\LinkTest.xls", "Sheet1"
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about connection strings, search the Help Index for
"Connect Property," or ask the Microsoft Access 97 Office Assistant. You
can also obtain more information about connection strings from the
following Microsoft World Wide Web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/ado/dao/daoconnectstring.htm">http://www.microsoft.com/ado/dao/daoconnectstring.htm</A></B>

</PRE></OL>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE>For more information about TableDefs, search the Help Index for "DAO
collections, TableDefs," or ask the Microsoft Access 97 Office Assistant.
<P>
For additional information about getting help with Visual Basic for
Applications, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q163435.htm">Q163435</A></B>
   TITLE     : VBA: Programming Resources for Visual Basic for
               Applications
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: inf vba<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 24, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
