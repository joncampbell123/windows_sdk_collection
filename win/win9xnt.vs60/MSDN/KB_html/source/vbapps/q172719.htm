

<HTML>
<HEAD>
<TITLE>OL97: Programmatically-Created Attachment Loses Icon </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172719">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1997/08/14">
<META NAME="Keywords" CONTENT="kbcode">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Using Visual Basic Scripting Edition (VBScript) or Visual Basic for Applications code, you can attach one Microsoft Outlook 97 item to another. If you send a mail message with such an attachment, the person who receives the message may not be able ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAH4,QBVO,QDNQ,QA5T,QAEV,QBS0,QBM8,QBJZ,QA39,QDMZ,QAVZ,QBWS,QBXT,QA5V P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OL97: Programmatically-Created Attachment Loses Icon</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172719</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using Visual Basic Scripting Edition (VBScript) or Visual Basic for
Applications code, you can attach one Microsoft Outlook 97 item to another.
If you send a mail message with such an attachment, the person who receives
the message may not be able to see the icon for the attachment. The
attached item however, is intact and functions correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem is a result of how you write the code for the item attachment.
Using an object variable results in the problem described above.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When attaching the second item to the first, use the
ActiveInspector.CurrentItem object to reference the attached item. For an
example of how to resolve this problem, see the Corrected Code section
below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft Support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft Consult Line at (800) 936-5200. For more information about
the support options available from Microsoft, please see the following page
on the World Wide Web:
<P>
<PRE>    <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE><h3>Corrected Code</h3>
 
<P>
If you repeat the steps below but follow the comment instructions to use:
<P>
<PRE>    ItemToSend.Attachments.Add Application.ActiveInspector.CurrentItem, 4

      instead of

    ItemToSend.Attachments.Add Item, 4

</PRE>your e-mail message will include the attachment icon.
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 

<OL><P><LI>Create a new mail message.

<P><LI>On the Tools menu, click Design Outlook Form.

<P><LI>Drag to resize the message control, creating enough space for
   a CommandButton.

<P><LI>Click the Control Toolbox button to view the Control Toolbox and drag a
   CommandButton to the form.

<P><LI>On the Form menu, click View Code and type the following VBScript code
   in the Script Editor.
<P>
   NOTE: Be sure to change Line 4 in the code below to your e-mail name.
<P>
<PRE>   Sub CommandButton1_Click()
   ' Saves the current mailitem in the Inbox
   Item.Save
   ' Create a new mail message
   Set ItemToSend = Application.CreateItem(0)
   ' Change below to your emailname to send message
   ItemToSend.To = "&lt;enter your e-mail here&gt;"
   ItemToSend.Subject = "test"
   ' The following line results in a blank icon for attachment.
   ' 4 is the olAttachmentType constant olByValue to create a link.
   ItemToSend.Attachments.Add Item, 4
   ' The following syntax will preserve the icon in the sent message
   ' if it's substituted for the line above.
   'ItemToSend.Attachments.Add Application.ActiveInspector.CurrentItem, 4
   ItemToSend.Send
   End Sub

</PRE><P><LI>Close the VBScript editor.

<P><LI>On the Tools menu, click Design Outlook Form to exit design mode.

<P><LI>Click CommandButton1 to run the VBScript code. You should receive a
   new message in your Inbox that contains the blank attachment icon. If
   you single-click in the upper left portion of the message area, you
   will see the bounding box for the icon.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating solutions with Microsoft Outlook 97,
please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q166368.htm">Q166368</A></B>
   Title     : OL97: How to Get Help Programming with Outlook

   Article-ID: <B><A href="../vbapps/q170783.htm">Q170783</A></B>
   Title     : OL97: Q&amp;A: Questions about Customizing or
               Programming Outlook
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OutSol OutSol97<BR>
Keywords          : kbcode<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
