

<HTML>
<HEAD>
<TITLE>HOWTO: Extract Appointment Information from Schedule Plus </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154575">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1996/08/09">
<META NAME="Keywords" CONTENT="IAPOLE VB4ALL VB4WIN vbwin GnrlVb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  The OLE Scheduling Library exposes an object model for Microsoft Schedule Plus 7.0 that can be manipulated by the VBA language. This object model allows programmers to gain access to appointment information. This article provides a code sample of h...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAL4,QAW6,QAPN,QAOX,QBXS,QBDP,QA3P,QAH4,QAY2,QANF,QA9Q,QAPF,QAKM,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Extract Appointment Information from Schedule Plus</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154575</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Standard, Professional, and Enterprise Editions of Microsoft
   Visual Basic, 16-bit and 32-bit, for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The OLE Scheduling Library exposes an object model for Microsoft Schedule
Plus 7.0 that can be manipulated by the VBA language. This object model
allows programmers to gain access to appointment information. This article
provides a code sample of how to extract appointment information between
two given dates from Schedule Plus.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Start Visual Basic. If Visual Basic is already running, choose New
   Project from the File menu. Form1 is created by default.

<P><LI>Place a Command button on Form1.

<P><LI>Add the following code to the General Declarations section of Form1:
<P>
   Option Explicit
<P>
<PRE>   Private Sub Command1_Click()
     GetAppointments "06/03/96", "08/03/96"
   End Sub

   Sub GetAppointments(sStartdate As String, sEndDate As String)
     Dim objSchdPlus As Object
     Dim gobjappt As Object
     Dim objappt As Object
     Dim objitem As Object
     Dim obatt As Object
     Screen.MousePointer = vbHourglass
     Set objSchdPlus = CreateObject("SchedulePlus.Application")
     objSchdPlus.Logon
     Set gobjappt = objSchdPlus.ScheduleSelected
     Print objSchdPlus.UserName
     Set objappt = gobjappt.singleappointments
     Set objitem = objappt.Item()
     Print objappt.Rows
     While Not objappt.IsEndOfTable
       Set objitem = objappt.Item()
       If CDate(objitem.start) &gt;= CDate(Format$(sStartdate, "dd/mm/yy") &amp; _
         " 00:00:00") And CDate(objitem.end) &lt;= CDate(Format$(sEndDate, _
         "dd/mm/yy") &amp; " 23:59:59") Then
         Print "Starts " &amp; objitem.start &amp; "---" &amp; "Ends " &amp; objitem.end
         Print "Appointment := " &amp; objitem.Text
       End If
       objappt.Skip
     Wend
     Screen.MousePointer = vbArrow
     MsgBox "Done"
   End Sub

</PRE><P><LI>Press the F5 key to run the project. When you click on the button, the
   appointments that fall into the date range specified will be printed
   onto the form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
OLE Messaging is fully documented in the Win32 SDK, available on the
Microsoft Developer Network (MSDN).
<P>
OLE Scheduling is documented in the Microsoft Schedule+ Programmer's Guide
found under Microsoft Exchange Server in the BackOffice SDK on the
Microsoft Developer Network (MSDN).
<P>
The Mastering Series for Exchange Development, also available from
Microsoft, has extensive Visual Basic code samples and explanations
relating to OLE Scheduling.
 
<PRE>Keywords          : IAPOLE VB4ALL VB4WIN vbwin GnrlVb kbprg
Technology        : kbole kbvba
Version           : WINDOWS:4.0
Platform          : NT WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
