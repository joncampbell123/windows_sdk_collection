

<HTML>
<HEAD>
<TITLE>Macro to Change Default *.XL* to *.* in Open Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104581">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1993/09/22">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  In the Open dialog box in Microsoft Excel, the default string in the File Name box is  *.XL*.  (To view the Open dialog box, choose Open from the File menu.) This string causes all files with a filename extension beginning with the letters  XL  to ...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBWS,QBJZ,QBXS,QAFI,QAY2,QAG2,QAUR,QAUD,QAH4,QA2Q,QAKJ,QAIJ,QBTI,QA50 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Macro to Change Default *.XL* to *.* in Open Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104581</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for OS/2, versions 2.2, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the Open dialog box in Microsoft Excel, the default string in the File
Name box is "*.XL*." (To view the Open dialog box, choose Open from the
File menu.) This string causes all files with a filename extension
beginning with the letters "XL" to be displayed in the list of files below
the File Name box.
<P>
If you want a list of all of the files in the current directory to appear
in the list of files, use one of the following methods to change the
default string from "*.XL*" to "*.*".
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>To permanently change this string</h3>
 
<P>
Microsoft Excel versions 5.0 and 7.0

<OL><P><LI>In a Visual Basic module, enter the following:
<P>
<PRE>   Sub Open_File()
      Application.Dialogs(xlDialogOpen).Show arg1:="*.*"
   End Sub

</PRE><P><LI>From the File menu, choose Save As. In the File Name box, type
   "OPEN.XLS" (without the quotation marks), and choose OK.
<P>
   Note that you may want to save the OPEN.XLS file to the XLSTART
   subdirectory so that this file will be opened automatically when you
   start Microsoft Excel.

<P><LI>With the module sheet still active, choose Menu Editor from the Tools
   menu. From the Menu Items list, select &amp;Open..., and choose Delete.
   Choose the Insert button. In the Caption box, type "&amp;Open..." (without
   the quotation marks). From the Macro list, select Open_File. From the
   Menu Bars list, select Worksheet, and choose OK.
<P>
</OL>To replace the Open command on the File menu for a chart sheet, module
sheet, or when no documents are open, repeat step 3 for each of these menu
bars. Note that the file OPEN.XLS that contains the Open_File macro must be
available in the directory in which you saved it in step 2 to avoid
receiving an error message when you choose Open from the File menu.
<P>
You may want to save the OPEN.XLS file to the XLSTART subdirectory so that
this add-in will be opened automatically when you start Microsoft Excel.
<P>
Microsoft Excel version 4.0 and earlier

<OL><P><LI>In a macro sheet, enter the following:
<P>
   A1: Auto_Open
   A2: =DELETE.COMMAND(1,1,"Open...")
   A3: =ADD.COMMAND(1,1,B1:F1,2)
   A4: =RETURN()
   A5:
   A6: Open
   A7: =OPEN?("*.*")
   A8: =RETURN()
<P>
<PRE>   B1: &amp;Open... C1: OPEN.XLA!OPEN  D1:    E1:   F1: EXCELHLP.HLP!1058

</PRE><P><LI>Select cell A1.

<P><LI>From the Formula menu, choose Define Name. Select the Command
   option and choose OK.

<P><LI>Select cell A6 and repeat step 2.

<P><LI>From the File menu, choose Save As and select Add-In from the Save
   File As Type list. (In Microsoft Excel 3.0, choose Options to
   access the File Format list). In the File Name box, type "OPEN.XLA"
   (without the quotation marks).
<P>
</OL>Each time that you open the OPEN.XLA file, the Open command will be
automatically altered as described above. You may want to save the
OPEN.XLA file to the XLSTART subdirectory so that this add-in will be
opened automatically when you start Microsoft Excel.
<P>
This setting will remain changed as long as the add-in macro you
create loaded when you start Microsoft Excel.
<P>
<P><h3>To temporarily change this setting</h3>
 
<P>
Microsoft Excel versions 5.0 and 7.0

<OL><P><LI>In a Visual Basic module, enter the following:
<P>
<PRE>      Sub Auto_Open
         SendKeys "*.*{enter}{esc}"
         Application.Dialogs(xlDialogOpen).Show
      End Sub

</PRE><P><LI>On the Tools menu, click Make Add-In. In the File Name box, type
   "Open" (without the quotation marks). From the Directories list, select
   the XLSTART subdirectory of the Microsoft Excel directory, and choose
   OK.
<P>
</OL>Microsoft Excel version 4.0 and earlier

<OL><P><LI>In a macro sheet, type the following:
<P>
   A1: Auto_Open
   A2: =SEND.KEYS("%FO*.*~{esc}")
   A3: =RETURN()

<P><LI>Select cell A1. From the Formula menu, choose Define Name. Select
   the Command option and choose OK.

<P><LI>From the File menu, choose Save As and select Add-In from Save File
   As Type list. (In Microsoft Excel 3.0, choose Options to access the
   File Format list). In the File Name box, type "OPEN.XLA" (without
   the quotation marks).
<P>
</OL>This macro, invokes the keystrokes necessary to change the string in
the Open dialog box from "*.XL*" to "*.*." Since this macro is
saved in the startup directory, it will be started each time you start
Microsoft Excel.
<P>
With this method, the setting will remain changed for the session of
Microsoft Excel in which you make the change, or until you change the
setting again.
<P>
The following is an explanation of keystrokes sent by the SEND.KEYS()
function:
<P>
<PRE>   This keystroke              Does this
   --------------------------------------------------------

   %F (Alt-F)                  Selects the File menu

   O                           Chooses the Open command from the File
                               menu

   *.*                         Sends new string

   ~                           Sends the ENTER key to confirm change

   {esc}                       Cancels the File dialog box since no
                               files are being opened at this time.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
"User's Guide 2," version 4.0, pages 282-294
"User's Guide 1," version 4.0, page 79
"User's Guide," version 3.0, pages 553-554, 641-652
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.1 2.10 2.1c 2.10c 2.1d 2.10d 2.2 2.20<BR>
2.21 3.0 3.00 4.0 4.00 4.0a 4.00a 5.00 7.00 howto List Files Of Type
<P>

Keywords          : kbprg PgmHowTo<BR>
Version           : 2.x 3.00 4.00 4.00a 5.00 7.00 |<BR>
Platform          : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
