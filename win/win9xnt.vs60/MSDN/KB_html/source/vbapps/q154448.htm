

<HTML>
<HEAD>
<TITLE>ACC: How to Create a Collection of Collections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154448">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1996/08/06">
<META NAME="Keywords" CONTENT="PgmColl PgmHowTo PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  One of the limitations of the Visual Basic for Applications Collection object is that it cannot contain a user-defined data type. Similar behavior can be accomplished, however, b...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBS0,QA1S,QAVX,QDN9,QA6A,QA5F,QAY5,QAMA,QAX6,QAP2,QANF,QAH4,QAJH,QBXR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create a Collection of Collections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154448</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
One of the limitations of the Visual Basic for Applications Collection
object is that it cannot contain a user-defined data type. Similar behavior
can be accomplished, however, by creating a collection that contains the
elements you would normally define in your user-defined data type, and then
storing that collection in a second collection. This article provides an
example of how to create "nested" collections.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a collection within a collection, follow these steps:

<OL><P><LI>Create a module and type the following procedure:
<P>
<P><PRE>      Function CollectionCollection()
<PRE></PRE>         Dim element
         Dim insideCollection As New Collection
         Dim outsideCollection As New Collection

         ' Populate the first element of the collection and add
         ' it to the parent collection.
         insideCollection.Add KEY:="fname", Item:="joe"
         insideCollection.Add KEY:="lname", Item:="smith"
         insideCollection.Add KEY:="age", Item:=12
         outsideCollection.Add insideCollection

         ' Clear the collection - prevents duplication of elements.
         Set insideCollection = Nothing

         ' Populate the second element of the collection and add
         ' it to the parent collection.
         insideCollection.Add KEY:="fname", Item:="fred"
         insideCollection.Add KEY:="lname", Item:="smith"
         insideCollection.Add KEY:="age", Item:=14
         outsideCollection.Add insideCollection

         ' Print the contents of the parent collection to the Debug window.
         For Each element In outsideCollection
            Debug.Print element("fname"), element("lname"), element("age")
         Next
      End Function

</PRE><P><LI>To test the function, type the following in the Debug window, and then
   press ENTER:
<P>
<P><PRE>      CollectionCollection
</PRE><P>
   Note that the contents of the collection appears in the Debug window.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about collections, search the Help Index for
"Collection object.
 
<PRE>Keywords          : PgmColl PgmHowTo PgmObj
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
