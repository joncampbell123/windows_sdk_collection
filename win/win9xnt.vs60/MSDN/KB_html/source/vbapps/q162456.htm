

<HTML>
<HEAD>
<TITLE>ACC97: Can't Access ShortCut Menus CommandBar from Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162456">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1997/01/21">
<META NAME="Keywords" CONTENT="DcmHlp kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; vbapps">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  If you try to reference the Shortcut Menus toolbar using the CommandBars object model in Visual Basic for Applications, you may receive the following error message:     Run-...">
<META NAME="Product" CONTENT="vbapps">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKR,QAF0,QBS0,QAH4,QA1S,QANS,QDN9,QA01,QAVX,QAVW,QAB4,QAY5,QBWS,QAPN,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Can't Access ShortCut Menus CommandBar from Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162456</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
If you try to reference the Shortcut Menus toolbar using the CommandBars
object model in Visual Basic for Applications, you may receive the
following error message:
<P>
<PRE>   Run-time error '5':
   Invalid procedure call or argument

</PRE><h2>CAUSE</h2>
 
<P>
You can't reference the Shortcut Menus toolbar using Visual Basic for
Applications. It is the only toolbar that is not available using Visual
Basic for Applications.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Although you cannot reference the Shortcut Menus toolbar through code, you
can reference any custom shortcut menu through code. If you want to
programmatically modify a custom shortcut menu through code, you will need
to make a reference to the specific shortcut menu you are trying to
change. This article demonstrates how to create a custom shortcut menu and
then how to reference it using Visual Basic for Applications.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
To create and reference a custom shortcut menu using Visual Basic for
Applications, follow these steps:

<OL><P><LI>Open the sample database, Northwind.mdb, and on the View menu, point to
   Toolbars, and click Customize.

<P><LI>In the Customize dialog box, on the Toolbars tab, click New.

<P><LI>In the New Toolbar dialog box, type MyCustomShortCut in the Toolbar
   Name box. Click OK.
<P>
   NOTE: A new toolbar appears in the Customize dialog box.

<P><LI>In the Customize dialog box, on the Toolbars tab, click Properties.

<P><LI>In the Toolbar Properties dialog box, make sure MyCustomShortcut is
   selected in the Selected Toolbar list. In the Type list, click
   Popup. Click OK on the informational message displayed.

<P><LI>Click Close on the Toolbar Properties dialog box. Click Close on the
   Customize dialog box.

<P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure in the module:
<P>
<P><PRE>      Function RefShortcut()
<PRE></PRE>         Dim cb as CommandBar
         Set cb = CommandBars("MyCustomShortcut")
         Msgbox cb.Name
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>      ?RefShortcut()
</PRE><P>
</OL>Note that the message box opens and displays the name of the custom
shortcut menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure in the module:
<P>
<P><PRE>      Function Test()
<PRE></PRE>         Dim cb as CommandBar
         Set cb = CommandBars("Shortcut Menus")
         Msgbox cb.Name
      End Function

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>       ?Test()
</PRE><P>
   Note that you receive the following error message:
<P>
<P><PRE>      Run-time error '5':
      Invalid procedure call or argument
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about custom shortcut menus, search the Help Index
for "shortcut menus, creating," or ask the Microsoft Access 97 Office
Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Word Powerpoint commandbar context command bar bars<BR>
Keywords          : DcmHlp kberrmsg kbprg<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
