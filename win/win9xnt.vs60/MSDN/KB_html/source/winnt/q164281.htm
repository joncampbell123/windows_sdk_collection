

<HTML>
<HEAD>
<TITLE>Application Access Violation Error In Nwscript.exe During Logon </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164281">
<META NAME="KBModify" CONTENT="1997/12/05">
<META NAME="KBCreate" CONTENT="1997/02/26">
<META NAME="Keywords" CONTENT="kbbug4.00 NTINTEROP NTPROTOCOL NTSrvWkst kb3rdparty kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  During the normal Windows NT logon process, when a NetWare login script is run by Client Service for NetWare (CSNW) or Gateway Service for NetWare (GSNW), the following pop-up error message appears:     An application error has occurred and an appl...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWP,QAKP,QAB4,QBW7,QAI5,QA1S,QAAP,QBVV,QAB9,QAY0,QAWM,QAPN,QALZ,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Application Access Violation Error In Nwscript.exe During Logon</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164281</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Windows NT Workstation version 4.0
- Microsoft Windows NT Server version 4.0
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
During the normal Windows NT logon process, when a NetWare login script is
run by Client Service for NetWare (CSNW) or Gateway Service for NetWare
(GSNW), the following pop-up error message appears:
<P>
<PRE>   An application error has occurred and an application error log is being
   generated. NWSCRIPT.exe Exception: access violation (0xc0000005),
   Address: 0x01cae84b

</PRE>This problem occurs when the NetWare server in use is Novell NetWare
version 4.x. It does not matter whether or not the CSNW or GSNW computer is
attaching to the NetWare server as a bindery or NDS user.
<P>
<P><h2>CAUSE</h2>
 
<P>
Windows NT's Nwscript.exe logon script processor cannot interpret the
NetWare login script properly. The most common cause of the problem is the
use of conditional statements using the ELSE statement, when combined with
external DOS commands. External DOS commands may be called from NetWare
login scripts by using the #. For example, the following login script
will cause the problem:
<P>
IF MEMBER "MYGROUP" THEN
<PRE>   #CAPTURE Q=QUEUENAME
</PRE>ELSE
<PRE>   #CAPTURE Q=OTHERQUEUE
</PRE>ENDIF
<P>
NOTE: Capitalization and layout as above is not required, and changes to
capitalization and layout from above will not affect the problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Avoid the use of ELSE statements with external DOS commands in NetWare
login scripts as shown above. Check for any possible syntax problems in
the NetWare login scripts (both in the System Login script and users'
personal logon scripts). If the problem is difficult to track down, try
eliminating a section of the login script at a time to find the problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
 
<PRE>Keywords          : kbbug4.00 NTINTEROP NTPROTOCOL NTSrvWkst kb3rdparty kbnetwork
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
