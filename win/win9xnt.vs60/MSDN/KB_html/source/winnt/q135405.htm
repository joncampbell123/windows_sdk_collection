

<HTML>
<HEAD>
<TITLE>Repairing a Corrupted WINS Database w/ Starting Version Count </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135405">
<META NAME="KBModify" CONTENT="1997/03/25">
<META NAME="KBCreate" CONTENT="1995/08/21">
<META NAME="Keywords" CONTENT="kbnetwork ntregistry NTSrv nttcp">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article explains how you may increase the Starting Version Count within WINS preferences to repair WINS database corruption.  MORE INFORMATION  To repair WINS database corruption, you may modify the Starting Version Count (also called Starting...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIJ,QA4H,QAKC,QAG8,QBWS,QAZV,QBE7,QBE6,QAKD,QAC1,QBC6,QA26,QA2F,QAHE,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Repairing a Corrupted WINS Database w/ Starting Version Count</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135405</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how you may increase the Starting Version Count
within WINS preferences to repair WINS database corruption.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To repair WINS database corruption, you may modify the Starting Version
Count (also called Starting Version ID) within WINS preferences to increase
the Highest Version ID of the Local Database. You may set this Starting
Version ID only to a higher value than the existing Highest Version ID.
After you set it to a higher value you may not lower it without deleting
the databases and reinstalling Windows Internet Naming Service (WINS).
<P>
NOTE: Although the terms Starting Version ID and Highest Version ID contain
the word Version they do not refer to a particular released version of the
product, but to the number of entries in the WINS database. Therefore, you
may use any number that is a higher value than the current Starting Version
ID. For additional information, refer to the EXAMPLES section below.
<P>
To modify the Starting Version ID in the registry:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from the
use of Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Under the subtree HKEY_LOCAL_MACHINE, select the following subkey:
<P>
<P><PRE>      \System\CurrentControlSet\Services\WINS\Parameters
</PRE><P>
   The following parameters for the Starting Version count appear:
<P>
<P><PRE>      VersCounterStartVal_LowWord: REG_DWORD
      VersCounterStartVal_HighWord: REG_DWORD
</PRE>
<P><LI>Select the parameter you want to modify. If you are unsure about which
   parameter to select, read the EXAMPLES section below.

<P><LI>From the Edit menu, choose DWORD.

<P><LI>Type the higher hexadecimal value and choose OK.
<P>
</OL><h3>EXAMPLES</h3>
 
<P>
A Starting Version ID of FF78 hexadecimal (hex) appears as:
<P>
<PRE>   VersCounterStartVal_LowWord: REG_DWORD:0x0000FF78
   VersCounterStartVal_HighWord: REG_DWORD:0x00000000

</PRE></OL>To increment this number, change the VersCounterStartVal_LowWord value to
FF79.
<P>
As the number of database entries grows the VersCounterStartVal_LowWord
value increases until it reaches 0xFFFFFFFF hex that is the maximum number
for a double word hexadecimal value. If you want to increment this number
by one, you need to start using the VersCounterStartVal_HighWord counter.
For the starting Version ID of 100000000 hex, both parameters appear as
follows:
<P>
<PRE>   VersCounterStartVal_LowWord: REG_DWORD:0x00000000
   VersCounterStartVal_HighWord: REG_DWORD:0x00000001

</PRE>A Starting Version ID of 100000001 hex appears as:
<P>
<PRE>   VersCounterStartVal_LowWord: REG_DWORD:0x00000001
   VersCounterStartVal_HighWord: REG_DWORD:0x00000001

</PRE>A Starting Version ID of 12FF6F782B3 hex appears as:
<P>
<PRE>   VersCounterStartVal_LowWord: REG_DWORD:0xF6F782B3
   VersCounterStartVal_HighWord: REG_DWORD:0x0000012F
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt tcp/ip tcpip<BR>
Keywords            : kbnetwork ntregistry NTSrv nttcp<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
