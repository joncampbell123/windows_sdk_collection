

<HTML>
<HEAD>
<TITLE>Error Message When Installing TCP/IP or Adding TCP/IP Service </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151237">
<META NAME="KBModify" CONTENT="1998/02/24">
<META NAME="KBCreate" CONTENT="1996/05/20">
<META NAME="Keywords" CONTENT="nttcp kbnetwork kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you attempt to reinstall TCP/IP or add a TCP/IP service, you may receive one or more of the following error messages:   - Registry service subkey already exists     -or-   - Unable to remove name space provider  RESOLUTION  To correct this pro...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACK,QAEF,QAA1,QAB4,QBWP,QDNT,QBWD,QDI2,QDH6,QA9N,QANJ,QAVV,QDKD,QACI,QBDM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Message When Installing TCP/IP or Adding TCP/IP Service</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 24, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151237</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to reinstall TCP/IP or add a TCP/IP service, you may
receive one or more of the following error messages:

<UL><LI>Registry service subkey already exists
<P>
   -or-

<LI>Unable to remove name space provider
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To correct this problem, ensure all the components of a given TCP/IP
Service are properly removed, and then ensure the following registry
subkeys are also removed before you reboot the computer:
<P>
IMPORTANT: If you have Windows NT 4.0 with Service Pack 2, see the
following article in the Microsoft Knowledge Base before removing any
registry keys:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q162837.htm">Q162837</A></B>
   TITLE     : Replacing TCPIP after SP2 causes STOP 0x00000050

</PRE>WARNING: Using Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from the
use of Registry Editor can be solved. Use this tool at your own risk.
<P>
NOTE:  You may or may not have all of the following Registry entries
Depending on your TCP/IP configuration.
<P>
NOTE: CCS=CurrentControlSet
<P>
HKEY_LOCAL_MACHINE\Software\Microsoft\DhcpMibAgent
HKEY_LOCAL_MACHINE\Software\Microsoft\DhcpServer
HKEY_LOCAL_MACHINE\Software\Microsoft\FTPSVC
HKEY_LOCAL_MACHINE\Software\Microsoft\LPDSVC
HKEY_LOCAL_MACHINE\Software\Microsoft\NetBT
HKEY_LOCAL_MACHINE\Software\Microsoft\RFC1156Agent
HKEY_LOCAL_MACHINE\Software\Microsoft\SNMP
HKEY_LOCAL_MACHINE\Software\Microsoft\SimpTcp
HKEY_LOCAL_MACHINE\Software\Microsoft\Tcpip
HKEY_LOCAL_MACHINE\Software\Microsoft\TcpipCU
HKEY_LOCAL_MACHINE\Software\Microsoft\TcpPrint
HKEY_LOCAL_MACHINE\Software\Microsoft\Wins
HKEY_LOCAL_MACHINE\Software\Microsoft\WinsMibAgent
<P>
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\DHCP
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\DhcpServer
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\FTPSVC
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\Lmhosts
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\LPDSVC
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\NetBT
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\SimpTcp
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\SNMP
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\Tcpip
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\Wins
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\WinSock
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\WinSock2
HKEY_LOCAL_MACHINE\SYSTEM\CCS\Services\'NetDriver'x\Parameters\Tcpip
<PRE>    where NetDriver is the name of network card installed on system and
    where x is the number of the network adapter.

</PRE>It may also be necessary to remove the following keys:
<P>
HKEY_LOCAL_MACHINE\System\CCS\Enum\Root\Legacy_DHCP
HKEY_LOCAL_MACHINE\System\CCS\Enum\Root\Legacy_Lmhosts
HKEY_LOCAL_MACHINE\System\CCS\Enum\Root\Legacy_LPDSVC
HKEY_LOCAL_MACHINE\System\CCS\Enum\Root\Legacy_NetBT
HKEY_LOCAL_MACHINE\System\CCS\Enum\Root\Legacy_TCPIP
HKEY_LOCAL_MACHINE\System\CCS\Services\LanManServer\Linkage\Bind
HKEY_LOCAL_MACHINE\System\CCS\Services\LanManWorkstation\Linkage\Bind
<P>
NOTE: Removing these additional keys requires manipulation of the rights on
those keys. The default rights for Everyone is READ. To change the rights,
log on as Administrator, take ownership of the keys (Legacy_NETBT and
Legacy_TCPIP), and then give Full Control to Everyone (NOTE: You may need
to select Replace permission on existing subkey). After giving Full Control
to Everyone, you can delete the key and continue with the protocol
installation. Reboot the computer so that Registry changes are recognized
by Windows NT.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 remove manual manually regedt32 how to howto<BR>
Keywords          : nttcp kbnetwork kbfaq<BR>
Version           : 3.5 3.51 4.0<BR>
Platform          : winnt<BR>
Issue type        : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 24, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
