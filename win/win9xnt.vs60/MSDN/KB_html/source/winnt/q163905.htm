

<HTML>
<HEAD>
<TITLE>Auditing User Right Assignment Changes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163905">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1997/02/19">
<META NAME="Keywords" CONTENT="ntdomain NTSrvWkst kbenv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Windows NT can audit when a user or group is added to or removed from a User Right. To audit these types of action, choose the auditing category, Security Policy Changes in User Manager under the Policies menu, auditing. This is the only needed aud...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWG,QAAD,QAGU,QAM4,QBWF,QAE8,QDJX,QDIF,QAI5,QA9A,QA4H,QAK7,QAI4,QAU5,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Auditing User Right Assignment Changes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163905</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51,and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows NT can audit when a user or group is added to or removed from a
User Right. To audit these types of action, choose the auditing category,
Security Policy Changes in User Manager under the Policies menu, auditing.
This is the only needed audit category to audit these specific actions.
Only the audit category File and Object Access will add additional security
events, but these events simply show objects being opened and handles being
closed for user account access that populate the Add Users and Groups
dialog boxes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Below is the sample output from the Security Event Log when a user is added
to each of the User Right. Although User Manger does not differentiate
between User Privileges and Rights, in actuality only Privileges are
currently audited. Actions that are not audited are actually "rights."

<OL><P><LI> Access this computer from the network: no events

<P><LI> Act as part of the operating system: (Advanced Right)
<P>
</OL>2/17/97  2:29:19 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeTcbPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI> Add workstations to domain:
<P>
</OL>2/17/97  2:18:11 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeMachineAccountPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI> Back up files and directories:
<P>
</OL>2/17/97  2:19:03 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeBackupPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI> Bypass traverse checking: (Advanced Right)
<P>
</OL>2/17/97  2:30:06 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeChangeNotifyPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI> Change the system time:
<P>
</OL>2/17/97  2:19:57 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeSystemtimePrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI> Create a pagefile: (Advanced Right)
<P>
</OL>2/17/97  2:30:57 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeCreatePagefilePrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI> Create a token object: (Advanced Right)
<P>
</OL>2/17/97  2:31:45 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeCreateTokenPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI> Create permanent shared objects: (Advanced Right)
<P>
</OL>2/17/97  2:32:40 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeCreatePermanentPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Debug programs: (Advanced Right)
<P>
</OL>2/17/97  2:33:41 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeDebugPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Force shutdown from a remote system:
<P>
</OL>2/17/97  2:20:46 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeRemoteShutdownPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Generate security audits: (Advanced Right)
<P>
</OL>2/17/97  2:34:31 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeAuditPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Increase quotas: (Advanced Right)
<P>
</OL>2/17/97  2:35:12 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeIncreaseQuotaPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Increase scheduling priority: (Advanced Right)
<P>
</OL>2/17/97  2:35:52 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeIncreaseBasePriorityPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Load and unload device drivers:
<P>
</OL>2/17/97  2:21:43 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeLoadDriverPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Lock pages in memory: (Advanced Right)
<P>
</OL>2/17/97  2:36:57 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeLockMemoryPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Log on as a batch job: (Advanced Right) no events

<P><LI>Log on as a service: (Advanced Right) no events

<P><LI>Log on locally: no events

<P><LI>Manage auditing and security log:
<P>
</OL>2/17/97  2:25:18 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeSecurityPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Modify firmware environment values: (Advanced Right)
<P>
</OL>2/17/97  2:41:54 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeSystemEnvironmentPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Profile single process: (Advanced Right)
<P>
</OL>2/17/97  3:20:18 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeProfileSingleProcessPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Profile system performance: (Advanced Right)
<P>
</OL>2/17/97  3:21:11 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeSystemProfilePrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Replace a process level token: (Advanced Right)
<P>
</OL>2/17/97  3:21:57 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeAssignPrimaryTokenPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Restore files and directories:
<P>
</OL>2/17/97  2:26:13 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeRestorePrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Shut down the system:
<P>
</OL>2/17/97  2:27:00 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeShutdownPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)

</PRE><P><LI>Take ownership of files or other objects:
<P>
</OL>2/17/97  2:27:41 PM  Security Success Audit  Policy Change  608
<PRE>   randymc  RANDYMC1 User Right Assigned:
   User Right: SeTakeOwnershipPrivilege
   Assigned To:   S-1-5-21-2092848103-1120294241-1737835142-7944
   Assigned By:
   User Name:  randymc
   Domain:     RANDYMCD
   Logon ID:   (0x0,0x1EDC)
</PRE></OL> 
<PRE>Keywords          : ntdomain NTSrvWkst kbenv
Version           : WinNT:3.5,3.51,4.0
Platform          : winnt
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
