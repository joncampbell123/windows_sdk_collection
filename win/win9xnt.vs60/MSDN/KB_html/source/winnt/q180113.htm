

<HTML>
<HEAD>
<TITLE>Problems Printing to German FPNW from NetWare Clients </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180113">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1998/01/28">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAOX,QATX,QAP2,QAKD,QAKP,QAYY,QBVV,QA1O,QAAQ,QAB4,QBSO,QAL0,QACK,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Problems Printing to German FPNW from NetWare Clients</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180113</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Services for NetWare, German version
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using Capture.exe that ships with File and Print Services for NetWare
(FPNW) and printing to a German File and Print Services for NetWare (FPNW)
server using a command similar to the following:
<P>
<PRE>   CAPTURE L=2 S=fpnw-srv Q=printer NT

</PRE>The job does not print although it does show up in the queue for a very
short time.
<P>
<P><h2>CAUSE</h2>
 
<P>
To reflect the options entered when capturing the printer, FPNW uses the
job data types of the Windows NT printing system. Here is how the CAPTURE
options map:
<P>
<PRE>   &lt;no option&gt;: TEXT
   NT NFF: RAW
   NT: RAW [FF appended]
   &lt;other cases&gt;: default data type

</PRE>In German FPNW, RAW [FF appended] is localized to RAW [FF angehaengt] where
ae is a German Umlaut. This string is not localized in the Windows NT
printing system.
<P>
Because the datatype RAW [FF angehaengt] is rejected by the printing
subsystem on the German server,  FPNW cancels the print job and returns the
NCP request with an error message.
<P>
RESOLUTION
 
<P>
WARNING: Using Registry Editor incorrectly can cause serous problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.
<P>
FPNW has registry entries to set the strings for the data types used above.
The path below shows the location of this registry key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FPNW\Parameters.

</PRE>This is the list of entries and their default values for US-English
Windows NT:
<P>
<PRE>   Value name: DefaultTextDatatype
   Data type: REG_SZ
   String: TEXT

   Value name: DefaultRawDatatype
   Data type: REG_SZ
   String: RAW

   Value name: DefaultRawFFDatatype
   Data type: REG_SZ
   String: RAW [FF appended]

</PRE>The entries do not exist and have to be added manually.
<P>
To solve the problem, add a new value DefaultRawFFDatatype with the string
RAW [FF appended] and restart the FPNW service. To do this, perform the
following steps:

<OL><P><LI>Start Registry Editor (Regedt32.exe) and go to the following subkey:
<P>
   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FPNW\Parameters.

<P><LI>From the Edit menu, click Add Value. Type the following information and
   then click OK.
<P>
<P><PRE>      Value name: DefaultRawFFDatatype
      Data Type: REG_SZ
      String: RAW [FF appended]
</PRE>
<P><LI>Quit Registry Editor and restart your computer.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
MORE INFORMATION
 
<P>
The problem occurs if you run NetWare clients with some MS-DOS applications
where you do not want to use tab expansion (description below), but want
the server to append a Form Feed to the print job.
<P>
Using Capture.exe that comes with FPNW, this would be an example command
line:
<P>
<PRE>   CAPTURE L=2 S=fpnw-srv Q=printer NT

</PRE></OL>Windows NT tells the system not to expand tab characters (ASCII 0x09) in
the print job to spaces. It does not matter whether you use Microsoft’s or
Novell’s version of Capture.exe or if you use the Nwuser.exe tool under
Windows to capture the LPT port.
<P>
The problem is that the job does not get printed. It shows up only for a
short time in the Windows NT queue.
<P>
In a network trace you can see a NCP request Create Queue Job Extended sent
to FPNW, but the response frame contains error code 0xD0 (Queue Error).
<P>
Without the Windows NT option or by adding NFF (No Form Feed), the print
jobs get printed but you have side effects like distorted printouts or you
manually have to add a Form Feed.
 
<PRE>Keywords          : kbbug4.00 kbfix4.00
Version           : WinNT:4.0
Issue type        : kbbug
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
