

<HTML>
<HEAD>
<TITLE>DHCP Server Service May Stop Responding </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164821">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1997/03/07">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00 kbfix4.00.sp2 NTSrv nttcp kbbuglist kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Dynamic Host Configuration Protocol (DHCP) server service may stop responding during administrative operations using the DHCP Manager application.  The specific operations that were found to make the service stop responding were adding reservat...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAJZ,QDKY,QDJG,QAY5,QACK,QAGB,QAHO,QBWP,QAGI,QDO3,QARL,QAO4,QAKP,QAXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DHCP Server Service May Stop Responding</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164821</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Dynamic Host Configuration Protocol (DHCP) server service may stop
responding during administrative operations using the DHCP Manager
application.
<P>
The specific operations that were found to make the service stop responding
were adding reservations to active scopes and deleting scopes that had
reservations defined. In each case, the server had to be extremely busy
servicing DHCP client requests at the same time for it to stop responding.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the DHCP server service deadlocks trying to
acquire critical sections that guard access to the registry and the DHCP
Jet database.
<P>
The deadlock occurs because, when a client issues a release request or a
renew request, the DHCP server acquires the Jet database critical section
and holds it while attempting to acquire the registry critical section.
This causes a problem if it occurs at the same time as a DHCP
administrative operation adds reservations in scopes or deletes entire
scopes that contain reservations because these administrative operations
acquire the registry critical section and hold it while attempting to
acquire the Jet database critical section. Because client release or renew
operations hold the Jet database critical section, the administrative
operation cannot acquire it.
<P>
Likewise, because the administrative operation holds the registry critical
section, the client release or renew operation cannot acquire it. This
causes deadlock, and the DHCP server service stops responding.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The DHCP server service was modified so that contentions would not occur
over the registry or Jet database critical sections during administrative
operations.
<P>
To correct this problem, obtain the latest service pack for Windows NT 4.0
or obtain the hotfix mentioned below.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
This problem was corrected in the latest Microsoft Windows NT 4.0 U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hangs hang crash crashes freeze freezes<BR>
Keywords          : kbbug4.00 kbfix4.00 kbfix4.00.sp2 NTSrv nttcp kbbuglist kbfixlist<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbservicepack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
