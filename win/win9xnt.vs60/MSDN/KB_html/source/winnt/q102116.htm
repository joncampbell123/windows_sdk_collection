

<HTML>
<HEAD>
<TITLE>How to Manually Delete Print Shares or Printers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102116">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/07/28">
<META NAME="Keywords" CONTENT="ntprint NTSrvWkst kbprint">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QACT,QBT0,QBWP,QBWD,QAEF,QAA1,QAUJ,QDJP,QAGB,QAB5,QDI2,QDKD,QAC1,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Manually Delete Print Shares or Printers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102116</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system, version 3.1
<LI>Microsoft Windows NT Advanced Server, version 3.1
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server version 3.5, 3.51, and 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you are troubleshooting Windows NT or applications that are running
in Windows NT, you may need to verify that a print share or installed
printer has been completely deleted. The following information shows the
default locations in the registry database for references to installed
printers or print shares in Windows NT versions 3.1, 3.5, 3.51 and 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is rarely necessary to remove a printer by altering the registry. In
most cases, you can remove a printer in Print Manager or the Printer folder
using the Remove or Delete Printer option. This immediately removes the
printer, but internally the spooler marks the printer for deletion and does
not actually delete the printer until the next time that the Spooler
Service starts. Therefore, you should stop and restart the Spooler Service
before attempting to recreate a printer, or before attempting to remove a
printer port that a recently-deleted printer was using. Also, you should
close Print Manager or the Printers folder before restarting the Spooler.
<P>
In summary, if you use the Print Manager or Printers folder to remove a
printer or printer port, then close Print Manager or the Printers folder,
stop and restart the Spooler Service. If you reopen Print Manager or the
Printers folder, and the printer or port is still present, then you should
consider removing the printer or port by altering the registry.
<P>
NOTE: ALL references must be deleted to ensure complete removal of the
print share or installed printer. You must also either Stop and Start the
Spooler Service or shutdown and restart Windows NT for these changes to
take effect.
<P>
<P><h3>Modifying the Registry</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serous problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.
<P>
NOTE: Registry keys in the following procedure may appear on two or more
lines, but are actually one path; they have been wrapped for readability.

<OL><P><LI>Run Registry Editor (regedt32.exe).

<P><LI>Go to the appropriate registry location mentioned below for your version
   of Windows NT.

<P><LI>Delete the registry information for printer(s) and/or server(s) you want
   to remove.
<P>
   NOTE: It is recommended that you first save each registry key before
   deleting it.
<P>
</OL>The following registry paths apply to Intel-based (x86) computers. If you
are running an Alpha-, MIPS-, or PPC-based computer, substitute the x86
portion of the entries below with the correct processor type (Alpha_AXP,
R4000, or PowerPC). Text enclosed in angle brackets (&lt;&gt;) refers to machine-
specific or printer names. "\\&lt;Server Name&gt;\Printer" refers to the
universal naming convention (UNC) path to the specific print share.
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
If the printer is installed locally (My Computer), the printer information
is located in the following registry keys:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Environments
   \Windows NT x86\Drivers\Version-2\&lt;Printer Name&gt;

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers
   \&lt;Printer Name&gt;

</PRE></OL>If the printer is installed as a network printer (Network printer server or
\\&lt;server name&gt;), the printer information is located in the following
registry keys:
<P>
<PRE>   HKEY_CURRENT_USER\Printers\Connections\&lt;Server Name&gt;

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Providers
   \LanMan Print Services\Servers\&lt;Server Name&gt;\Printers\&lt;Printer Name&gt;

</PRE><h3>Windows NT 3.51</h3>
 
<P>
If the printer is installed locally (Create Printer), the printer
information will be located in the following registry keys:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Environments
   \Windows NT x86\Drivers\Version-1\&lt;Printer Name&gt;

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers
   \&lt;Printer Name&gt;

</PRE>If the printer is installed as a network printer (Connect to Printer), the
printer information is located in the following registry keys:
<P>
<PRE>   HKEY_CURRENT_USER\Printers\Connections\&lt;Server Name&gt;

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Providers
   \LanMan Print Services\Servers\&lt;Server Name&gt;\Printers\&lt;Printer Name&gt;

</PRE><h3>Windows NT 3.5</h3>
 
<P>
If the printer was installed from Print Manager using the Connect To
Printer option, the printer information will be located in the following
keys:
<P>
<PRE>   HKEY_USERS\S-&lt;user id number&gt;\Printers\Connections\&lt;Server Name&gt;
   \&lt;Printer Name&gt;

   HKEY_CURRENT_USER\Printers\Connections
   \\&lt;Server Name&gt;\&lt;Printer Name&gt;

   HKEY_CURRENT_USER\Software\Microsoft\Windows NT\Current Version\Devices

   HKEY_CURRENT_USER\Software\Microsoft\Windows NT\Current Version
   \PrinterPorts

</PRE>If the printer was installed from Print Manager using the Create Printer
option, the printer information will be located in the following keys:
<P>
<PRE>   HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\Current Version
   \Print Manager\Printers

   HKEY_USERS\&lt; SID Number &gt;\SOFTWARE\Microsoft\Windows NT
   \Current Version\Print Manager\Printers

   HKEY_CURRENT_USER\Software\Microsoft\Windows NT\Current Version\Devices

   HKEY_CURRENT_USER\Software\Microsoft\Windows NT\Current Version
   \Printer Ports

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers

   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Environments
   \Windows NT x86\Drivers\Version-1

</PRE><h3>Windows NT 3.1</h3>
 
<P>
If the printer was installed from Print Manager using the Connect To
Printer option, the printer information will be located in the following
keys:
<P>
<PRE>   HKEY_USERS\S-&lt;user id number&gt;\Printers\Connections\&lt;Server Name&gt;
   \&lt;Printer Name&gt;

   HKEY_CURRENT_USER\Printers\Connections \\&lt;Server Name&gt;\&lt;Printer Name&gt;

   HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\Current Version\Devices

   HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\Current Version
   \PrinterPorts

</PRE>If the printer was installed from Print Manager using the Create Printer
option, the printer information will be located in the following keys:
<P>
<PRE>   HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\Current Version
   \Print Manager\Printers

   HKEY_USERS\&lt; SID Number &gt;\SOFTWARE\Microsoft\Windows NT
   \Current Version\Print Manager\Printers

   HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\Current Version\Devices

   HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\Current Version
   \Printer Ports

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers

</PRE>There may also be references to printers in other ControlSets, such as
ControlSet001, but because this may be the Control Set for the Last
Known Good Configuration, it should not be modified.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q135406.htm">Q135406</A></B>
   TITLE     : Steps to Manually Remove and Reinstall a Printer Driver
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: troubleshoot trouble shoot tshooter tshoot<BR>
uninstall<BR>
Keywords          : ntprint NTSrvWkst kbprint<BR>
Version           : WinNT:3.1,3.5,3.51,4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
