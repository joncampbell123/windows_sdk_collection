

<HTML>
<HEAD>
<TITLE>How to Allow Poolmon.exe to Run by Setting GlobalFlag Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164933">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1997/03/10">
<META NAME="Keywords" CONTENT="ntconfig NTSrvWkst ntutil kbusage">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWS,QAKD,QANE,QBKX,QDL9,QBWQ,QBWO,QBWN,QBXS,QAL0,QAP2,QDNL,QAYY,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Allow Poolmon.exe to Run by Setting GlobalFlag Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164933</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The utility Poolmon.exe located on the Windows NT CD-ROM can be used to
track memory usage in both paged and nonpaged pools of memory. When
POOLMON is run from the command prompt of Windows NT, the following error
is displayed:
<P>
<PRE>   Query pooltags Failed c0000002

</PRE><h2>CAUSE</h2>
 
<P>
Poolmon.exe uses a global pooltag in the registry located at a value called
GlobalFlag. The default value for GlobalFlag is 0, so Windows NT does not
expend extra overhead in gathering pooltag information.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Not that you should back up the registry before you edit it.
<P>
To allow Windows NT to gather pooltag information, the GlobalFlag value
must be changed using Registry Editor (Regedt32.exe). Before making
changes, write down the current value of GlobalFlag so that it can be reset
once running Poolmon.exe is no longer necessary.
<P>
The following hex values for GlobalFlag will set up memory tagging in
Windows NT for the following versions:
<P>
Windows NT 3.5: 0x01000000
Windows NT 3.51: 0x00000400
Windows NT 4.0: 0x00000400
<P>
If you are running Windows NT version 3.51 or 4.0 but do not have the
Windows NT 4.0 Resource Kit, follow these steps.
<P>
To change the value of the GlobalFlag, you need to modify its value in
the registry.

<OL><P><LI>Start Registry Editor (Regedt32.exe) and locate the following subkey:
<P>
   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager

<P><LI>Double-click on the GlobalFlag Value on the right pane.

<P><LI>In the Data Type field, select REG_DWORD and click OK.

<P><LI>In the Data Field, type in either 01000000 or 00000400, depending
   on the version of Windows NT. Select the Hex option and click OK.
<P>
<PRE>      Range:   0 - 0xFFFFFFFF (not continuous)
      Default: 0

</PRE><P><LI>Quit Registry Editor, shutdown, and restart your computer.
<P>
</OL>If you have a computer running Windows NT 4.0 and you have the resource
kit, there is utility called GFLAGS. GFLAGS is a GUI tool that enables a
developer or system administrator to edit the NtGlobalFlag settings for
Windows NT Server or Windows NT Workstation without having to make manual
changes in the registry.
<P>
To use this utility to enable Pool tagging:

<OL><P><LI>Double-click on the Gflags.exe file in the resource kit directory or
   open a MS-DOS command prompt and type in GFLAGS and press Enter.

<P><LI>After the GFLAGS window opens, set the destination in the upper windows
   to System Registry.

<P><LI>In the lower portion of the window, click to select the "Enable Pool
   Tagging" check box.

<P><LI>The computer running Windows NT will have to be restarted for the change
   to take affect.
<P>
</OL>GFLAGS can also set the flag required for the kernel feature of Oh.exe, a
tool that shows the handles of open windows. For usage information, at a MS-
DOS command prompt type:
<P>
<PRE>   gflags /?

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
GlobalFlag consists of 32 bits that are used as switches to enable or
disable several different advanced internal system diagnostics and
troubleshooting tests. For more information, see the definition of
Ntexapi.h FLG_ in the Win32 Software Development Kit.
<P>
NOTE: In Windows NT versions 3.51 and earlier, changing the value of this
entry to 0x20100000 disabled the OS/2 subsystem and caused OS/2-bound
applications to run in a virtual DOS machine. This does not work in Windows
NT 4.0.
 
<PRE>Keywords          : ntconfig NTSrvWkst ntutil kbusage
Version           : WinNT:3.5,3.51,4.0
Platform          : winnt
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
