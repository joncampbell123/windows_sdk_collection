

<HTML>
<HEAD>
<TITLE>How to Change the IP Address List Order Returned </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171320">
<META NAME="KBModify" CONTENT="1997/12/09">
<META NAME="KBCreate" CONTENT="1997/07/12">
<META NAME="Keywords" CONTENT="NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Windows Sockets gethostbyname() API can be used to retrieve IP addresses assigned to a computer. If the host name sent in the query is NULL, or the local host name of the computer, gethostbyname() will return a list of IP addresses assigned to ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QBWP,QAVZ,QAE1,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Change the IP Address List Order Returned</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171320</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows Sockets gethostbyname() API can be used to retrieve IP
addresses assigned to a computer. If the host name sent in the query is
NULL, or the local host name of the computer, gethostbyname() will return
a list of IP addresses assigned to all network cards installed in the
computer.
<P>
Some third-party device drivers are sensitive about the IP address order
in the list returned by gethostbyname(); the device drivers require that
the IP address to which they are bound do not show up at the top of the
list.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Under Windows NT 3.51, the IP address list is in the same order as the
TCP/IP network card binding order; therefore, altering the TCP/IP network
card binding order will indirectly change the IP address order returned by
gethostbyname().
<P>
Under Windows NT 4.0, that binding order does not influence the IP address
order. Alternatively, a registry value, DependOnService, can be used to
indirectly control the IP address order.
<P>
To influence the order of the IP address list, follow the steps below.
These steps assume that you have two network adapter cards installed in a
Windows NT 4.0 server computer. The driver names for the network adapters
are Netcard1 and Netcard2. The steps below will cause the IP address order
to list Netcard2's IP addresses first.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Start Registry Editor (regedt32.exe) and select the following subkey:
<P>
   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netcard1

<P><LI>From the Edit menu, click Add Value, and type the following
   information:
<P>
   Value Name: DependOnService
   Value Type: REG_MULTI_SZ
<PRE>   Data:       Netcard2

</PRE></OL>NOTE: This workaround only applies to Windows NT 4.0 computers that have
multiple network adapters installed and only when it is querying the local
host name. It has no effect when querying other computers on the network.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: change returned multihomed multi-homed<BR>
Keywords          : NTSrvWkst nttcp kbnetwork<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
