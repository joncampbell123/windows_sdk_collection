

<HTML>
<HEAD>
<TITLE>FPNW Print Jobs Do Not Print or Errors Occur in FPNW Interface </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164438">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1997/02/28">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00 ntprint NTSrv kbprint">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBTX,QBWP,QAUJ,QBWD,QACK,QAR4,QABI,QBWS,QBVV,QAAP,QASR,QARL,QANE,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FPNW Print Jobs Do Not Print or Errors Occur in FPNW Interface</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164438</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft File and Print Services for NetWare version 4.0
<LI>Microsoft Services for NetWare version 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the
registry. Before you edit the registry, make sure you understand how to
restore it if a problem occurs. For information about how to do this,
view the "Restoring the Registry" Help topic in Regedit.exe or the
"Restoring a Registry Key" Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Symptoms for this problem may vary. The following are three possible
symptoms:

<UL><LI>NetWare-compatible clients are unable to see or capture some FPNW print
   queues on a computer running both Windows NT Server and File and Print
   Services for NetWare. These symptoms may vary depending on the type of
   client and specific problem on the FPNW server. Microsoft-compatible
   clients are able to see and use print shares established on the computer
   running Windows NT Server. One symptom from a NetWare-compatible client:
<P>
   The client can see and capture existing print queues, but cannot print
   to captured queues. When you try to send a print job to the captured
   LPT1 port for example, the following error message is displayed at a
   Windows 95 command prompt, or an MS-DOS prompt:
<P>
<P><PRE>      Not ready writing device LPT1
      Abort, Retry, Ignore, Fail?
</PRE><P>
   If new queues are created on the FPNW server (for example, new printers
   are created and shared), those queues are not visible to the NetWare-
   compatible clients, but Microsoft clients can see and access them as
   print shares.

<LI>When you try to select the Default queue other than &lt;NONE&gt; through the
   FPNW utility in Control Panel, the following message is displayed:
<P>
<P><PRE>      The filename, directory name, or volume label syntax is incorrect.
</PRE>
<LI>When you try to add a print queue for a NetWare compatible Print Server
   to service through Server Manager, the following message appears:
<P>
<P><PRE>      The system cannot find the file specified.
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
One or more File and Print Services for NetWare bindery entries within the
Windows NT registry are corrupt.
<P>
This problem can be caused by renaming the FPNW server and immediately
rebooting, rather than stopping and restarting the FPNW first.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, use either of the following methods:
<P>
<P><h3>Method 1</h3>
 
<P>
Obtain the following fix or wait for the next Windows NT service pack.
<P>
This fix should have the following time stamp:
<P>
<PRE>   11/10/97  03:58p               138,272 Fpnwmgr.cpl (Intel)
   11/10/97  03:55p               194,320 Fpnwmgr.cpl (Alpha)

</PRE>After applying the fix, the following steps must be performed:

<OL><P><LI>In Control Panel, FPNW, rename the FPNW server to a temporary name.

<P><LI>In Control Panel, Services, stop the File and Print Services for NetWare
   Service.

<P><LI>Start the File and Print Services for NetWare Service.

<P><LI>In Control Panel, FPNW, rename the FPNW server back to the original
   name.

<P><LI>In Control Panel Services, stop the File and Print Services for NetWare
   Service.

<P><LI>Start the File and Print Services for NetWare Service.
<P>
</OL>Performing these steps will correctly rewrite the registry entries noted
below.
<P>
<P><h3>Method 2</h3>
 
<P>
Manually edit the corrupt registry entries.
<P>
You must know the name of the FPNW server to complete the following
steps. This information can be found by using the FPNW utility in Control
Panel. Use Regedt32.exe to perform these steps.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems
that may require you to reinstall your operating system. Microsoft
cannot guarantee that problems resulting from the incorrect use of
Registry Editor can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys
And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" Help
topics in Regedt32.exe. Note that you should back up the registry
before you edit it.

<OL><P><LI>Run Registry Editor (Regedt32.exe).

<P><LI>Go to the following registry key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FPNW\Bindery
      \Type07\00000002
</PRE><P>
<P><PRE>      NOTE: The above registry key is one path; it has been wrapped for
      readability.
</PRE><P>
  This key should contain a value named Object Name and data type REG_SZ.
  The data should be the name of the FPNW server. Make sure the data is
  correct. If the name listed does not match the current FPNW server name
  or is missing, correct the entry using the following steps:

<P><LI>Double-click the entry.

<P><LI>Replace the text in the string editor with the name of the FPNW server.

<P><LI>Click OK.

<P><LI>Go to the following registry key:
<P>
<P><PRE>     HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FPNW\Bindery
     \Type07\Name
</PRE><P>
<P><PRE>     NOTE: The above registry key is one path; it has been wrapped for
     readability.
</PRE><P>
</OL>It should contain a subkey with the name of the FPNW server. If it does
not, follow these steps to add the subkey and value. To add the subkey:

<OL><P><LI>On the Edit menu, click Add Key to create the following entry.
<P>
<P><PRE>      Key Name: &lt;FPNW server name&gt;
<PRE></PRE>      Class   : &lt;blank&gt;

</PRE><P><LI>Click OK.

<P><LI>Go to the following registry key:
<P>
<P><PRE>     HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FPNW\Bindery
     \Type07\Name\&lt;FPNW Server Name&gt;
</PRE><P>
<P><PRE>     NOTE: The above registry key is one path; it has been wrapped for
     readability.
</PRE><P>
  where &lt;FPNW Server Name&gt; is the name of the FPNW server.
<P>
</OL>If the FPNW server name key already exists, it should contain a value named
Object ID of data type REG_DWORD. The value should be 0x2. If this key
does not exist, it must be created. To create this entry, select the
&lt;FPNW Server Name&gt; and perform the following steps:

<OL><P><LI>On the Edit menu, click Add Value and add the following information.
<P>
<P><PRE>      Value Name : Object ID
      Data Type  : REG_DWORD
<PRE></PRE>      Data       : 2 (Hex is selected by default)

</PRE><P><LI>Click OK.
<P>
</OL>Make sure the new value has been added and appears correct as described
above.
<P>
After the above steps have been completed, stop and restart File and
Print Services for NetWare. If print jobs from NetWare-compatible clients
still do not print when sent to FPNW print queues, remove and re-create the
printer(s) through Print Manager in Windows NT 3.51 or the Printers folder
in Control Panel in Windows NT 4.0.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.11 3.51 95 4.00 sfnw<BR>
Keywords          : kbbug4.00 kbfix4.00 ntprint NTSrv kbprint<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
