

<HTML>
<HEAD>
<TITLE>Troubleshooting SrvAny Using Cmd.exe </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152460">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1996/06/14">
<META NAME="Keywords" CONTENT="ntreskit NTSrvWkst kbnetwork kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  SrvAny is a tool found in the Windows NT Resource Kit that is used for running Windows NT applications as services. It may be necessary in some instances to troubleshoot an application started using the SrvAny service, and one of the best ways of d...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QBWP,QAIJ,QBWS,QACK,QBTX,QACF,QDIV,QBKX,QAY2,QAFX,QAKD,QBJZ,QASR,QAHE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting SrvAny Using Cmd.exe</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152460</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft Windows NT Resource Kit versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SrvAny is a tool found in the Windows NT Resource Kit that is used for
running Windows NT applications as services. It may be necessary in some
instances to troubleshoot an application started using the SrvAny service,
and one of the best ways of doing this is by using Cmd.exe as the
application starts interactively from SrvAny. From the command prompt you
can then start the application in question, watch for errors, check
registry values relative to the service account, and perform other
troubleshooting steps. The following steps show how to set SrvAny to run an
interactive command prompt for such purposes.

<OL><P><LI>Install Srvany.exe as a service by using another tool in the Windows NT
</OL>Resource Kit, Instsrv.exe. For example:
<P>
<PRE>   INSTSRV SrvAny c:\reskit\srvany.exe

</PRE><P><LI>Click Control Panel and then Services. From the list of services that
</OL>appears, select SrvAny, then click the Startup button.
<P>
<PRE>   A. Configure the service for automatic or manual startup type,
      depending on whether your troubleshooting involves an application
      that is started automatically through SrvAny each time the system
      is restarted, or only occasionally.

   B. Select the System account as the service (or Log On As) account
      and enable the Allow Service To Interact With Desktop option. This is
      required for the command prompt to be interactive.

   C. Click the OK button. (It’s fine to leave the Control Panel, Services,
      applet running since it is used later in these instructions.)

</PRE><P><LI>If you require the regular use of the interactive command prompt, skip
   to step 4.
<P>
   A. Start (or switch to) the Control Panel, Services, applet.
<P>
   B. Select SrvAny from the list of services.
<P>
   C. Select the Startup Parameters text entry field.
<P>
   D. Enter the following text (modified to reflect your own Windows NT
<P><PRE>      path):
</PRE><P>
<P><PRE>      c:\\winnt\\system32\\cmd.exe /k
</PRE><P>
   NOTE: Due to the way the startup parameters are parsed, the double
<PRE>         backslashes are required to be interpreted correctly as
         single backslashes.

   E. Click the Start button to start the service.

   F. Perform any necessary troubleshooting steps.

</PRE></OL>You do not need to continue with any of the following steps.

<OL><P><LI>For regular use of the interactive command prompt, first ensure that the
   SrvAny service is configured to start automatically by reviewing step 2
   above.
<P>
</OL>NOTE: Having an interactive command prompt regularly established through
<PRE>      SrvAny as outlined in this article makes this command prompt
      available to all Windows NT users of the computer, and, since this
      command prompt is configured to run under the security context of the
      System account, all Windows NT users of the computer have System
      account access from this command prompt and any applications started
      from it.

   A. Start Registry Editor.

   WARNING: Using Registry Editor incorrectly can cause serious,
   system-wide  problems that may require you to reinstall Windows NT
   to correct them.  Microsoft cannot guarantee that any problems
   resulting from the use of  Registry Editor can be solved. Use this
   tool at your own risk.

   B. Select the following registry key from the window entitled
      "HKEY_LOCAL_MACHINE on Local Machine":

      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SrvAny

      - With the above key selected, choose Add Key from the Edit menu.

      - Enter "Parameters" (without the quotes) for the key name.

      - Click the OK button to create this key.

   C. Select the Parameters key created in step 4B above.

      - Choose Add Value from the Edit menu.

      - Enter "Application" (without the quotes) for the value
        name and leave the data type at the default, REG_SZ.

      - Click the OK button to create this value.

      - In the String Editor window, enter the string value of
        "c:\winnt\system32\cmd.exe" (without the quotes), for example
        (your actual Windows NT path may vary).

      NOTE: In contrast with the format used for the startup parameters in
      the Control Panel, Services, applet, double backslashes are not
      required in the above string to be interpreted correctly by SrvAny.

      - Click the OK button to add this string to the Application value.

   D. Select the Parameters key created in step 4B above.

      - Choose Add Value from the Edit menu.

      - Enter "AppParameters" (without the quotes) for the value
        name and leave the data type at the default, REG_SZ.

      - Click the OK button to create this value.

      - In the String Editor window, enter the string value of
        "/k" (without the quotes).

      - Click the OK button to add this string to the AppParameters
        value.

</PRE><P><LI>Start or switch to the Control Panel, Services, applet.
<P>
   A. Select SrvAny from the list of services.
<P>
   B. Click the Start button to start the service.
<P>
   C. Perform any necessary troubleshooting steps.
<P>
</OL>From this point on, every time you restart Windows NT, the SrvAny service
starts an interactive command prompt.
<P>
For more information on the SrvAny tool, see the Tool Overview Help file in
the Windows NT Resource Kit and the Srvany.wri Write file.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt tshoot<BR>
Keywords          : ntreskit NTSrvWkst kbnetwork kbtshoot<BR>
Version           : 3.5 3.51<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
