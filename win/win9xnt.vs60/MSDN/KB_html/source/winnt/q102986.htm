

<HTML>
<HEAD>
<TITLE>REG: CurrentControlSet Entries PART 3 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102986">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/08/12">
<META NAME="Keywords" CONTENT="kbother ntregistry">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" CURRENTCONTROLSET\CONTROL SUBKEYS ENTRIES  This key contains parameters that control system startup, such as subsystems to load, the size and location of paging files, and so on.  NOTE: The system must be restarted for any changes in the Control key...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABA,QAOE,QAB5,QA7O,QAMN,QAHE,QDL9,QBWO,QBWN,QAKR,QAKD,QBWQ,QAFI,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>REG: CurrentControlSet Entries PART 3</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102986</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Windows NT operating system version 3.1
<LI>Windows NT Advanced Server version 3.1
<P>
</UL>The article contains REGISTRY entries for the CurrentControlSet\Control
Subkeys Part 3:

<UL><LI>Setup
<LI>TimeZoneInformation
<LI>VirtualDeviceDrivers
<LI>Windows
<LI>WOW
<P>
</UL>For listings of the other control subkeys under CurrentControlSet, see the
articles:
<P>
CurrentControlSet Part 1, containing:

<UL><LI>BootVerificationProgram
<LI>ComputerName
<LI>DisplayDriver
<LI>GroupOrderList
<LI>HiveList
<LI>KeyboardLayout
<LI>Lsa
<LI>NetworkProvider
<LI>Nls
<LI>PriorityControl
<LI>ProductOptions
<LI>ServiceGroupOrder
<P>
</UL>CurrentControlSet Part 2: Session Manager, containing entries for Session
Manager.
 
<P>
<P><h2>CURRENTCONTROLSET\CONTROL SUBKEYS ENTRIES</h2>
 
<P>
This key contains parameters that control system startup, such as
subsystems to load, the size and location of paging files, and so on.
<P>
NOTE: The system must be restarted for any changes in the Control key to
take effect.
<P>
<P><h2>SETUP CONTROL ENTRIES</h2>
 
<PRE>Default:   For an x86-based computer:
              keyboard=STANDARD
              pointer=msser
              video=VGA

</PRE>The Setup subkey contains various information used by Windows NT Setup,
under this Registry path:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Setup

</PRE>The values are REG_SZ strings that are meaningful only to Setup, and which
should be maintained by the system.
<P>
<P><h3>TimeZoneInformation Control Entries</h3>
 
<P>
Values in the TimeZoneInformation key should be maintained only by choosing
the Date/Time icon in Control Panel or by applications using the Win32
APIs. Changing this information in the Registry can damage your system’s
local time settings. The information is stored in the following Registry
path.
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\TimeZoneInformation

ActiveTimeBias   REG_DWORD
</PRE> 
<PRE>Default:   0x1a4

</PRE>For example, for the Pacific Time Zone, the value of ActiveTimeBias should
change from 1e0 to 1a4 on the first Sunday in April.
<P>
<P><h3>Bias   REG_DWORD</h3>
 
<PRE>Default:   0x1e0

DaylightBias   REG_DWORD
</PRE> 
<PRE>Default:   0xffffffc4

DaylightName   REG_SZ
</PRE> 
<PRE>Default:   (user selection)

DaylightStart   REG_BINARY
</PRE> 
<P>
<PRE>StandardBias   REG_DWORD
</PRE> 
<P>
<PRE>StandardName   REG_SZ
</PRE> 
<PRE>Default:   (user selection)

StandardStart   REG_BINARY
</PRE> 
<P>
<P><h3>VirtualDeviceDrivers Control Entries</h3>
 
<P>
The VirtualDeviceDriver key contains a list of Win32 DLLs that serve as
virtual device drivers (VDD). Each VDD entry results in loading that VDD
when a virtual MS-DOS machine (VDM) is being created for running an
application created for MS-DOS or 16-bit versions of Microsoft Windows.
This is the Registry path:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\VirtualDeviceDrivers

VDD   REG_MULTI_SZ   Filenames
</PRE> 
Default:  None-the Windows NT VDDs are built into the system.
<P>
Specifies valid Win32 DLLs that are virtual device drivers.
<P>
<P><h3>Windows Startup Control Entries</h3>
 
<P>
This key contains entries that define the system directories for the Win32
subsystem (32-bit Windows) under this path:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Windows

Directory   REG_EXPAND_SZ   Directory name
</PRE> 
Default: %SystemRoot%
<P>
Defines the directory for Windows NT.
<P>
<PRE>SystemDirectory   REG_EXPAND_SZ   Directory name
</PRE> 
Default: %SystemRoot%\system32
<P>
Defines the directory for the Windows NT system files.
<P>
The Registry entries for starting the Win32 subsystem are defined under the
Required and Windows value entries in the Session Manager\Subsystem key, as
described in the article "CurrentControlSet Part 2: Session Manager."
<P>
<P><h3>WOW Startup Control Entries</h3>
 
<P>
The following values control startup parameters that affect MS DOS-based
applications and applications created for 16-bit Windows 3.1. The Registry
path for these values is the following:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WOW

Cmdline   REG_EXPAND_SZ   Path and switches
</PRE> 
<P>
Defines the commmand line that runs when an MS-DOS-based application runs
under Windows NT. This command line continues to run until the related
application is closed. The following switches can be included:
<P>
<PRE>   Switch   Meaning
   ----------------
   -a       Specifies a command to pass to the VDM
   -f       Specifies the directory to find NTVDM.EXE
   -m       Hides the VDM console window
   -w       Specifies the WOW VDN

</PRE>Default: %SystemRoot%\system32\ntvdm -f%SystemRoot%\system32 -a
<P>
<PRE>KnownDLLs   REG_SZ   DLL filenames
</PRE> 
Default: shell.dll commdlg.dll mmsystem.dll olecli.dll olesvr.dll ddeml.dll
win87em.dll toolhelp.dll lanman.drv netapi.dll pmspl.dll wowdeb.exe
<P>
Defines a list of known DLLs for use by the WOW VDM that provide
compatibility for non-Win32 applications. When the system searches for DLLs
to load, it compares the requested DLL with those in the KnownDLLs list and
then loads the matching DLL from the SystemRoot\SYSTEM32 directory.
<P>
If you want to replace a DLL, you must delete the name from this list, so
that the system will search elsewhere for the DLL. The files USER.DLL,
GDI.DLL, and SYSTEM.DRV are not included in this list, because these are
required Windows NT system files and their location cannot be changed.
<P>
<PRE>LPT_timeout   REG_SZ   Number of seconds
</PRE> 
Default: 15
<P>
Defines how many seconds after the LPT port has been used that Windows NT
waits before grabbing the port, closing it, and flushing the output. This
value should only be needed for MS-DOS-based applications that use BIOS and
do not close the port.
<P>
<PRE>Size   REG_SZ   Number in megabytes
</PRE> 
Default: 0
<P>
Defines the amound of memory to be given to each individual MS-DOS VDM. The
default of 0 gives the VDM as uch memory as Windows NT determines is
necessary, depending upon the memory configuration.
<P>
To change this value, change the related value in the PIF file for the
application.
<P>
<PRE>Wowcmdline   REG_EXPAND_SZ   Path and switches
</PRE> 
Default: %SystemRoot%\system32\ntvdm -m -w -f%SystemRoot%\system32
<PRE>   -a %SystemRoot%\system32\krnl386

</PRE>Defines the command line that runs when a 16-bit Windows-based application
is started. The switches instruct Windows NT to start either an MS-DOS VDM
or a WOW VDM. See the definitions for allowable switches under Cmdline.
<P>
<PRE>Wowsize   REG_SZ   Up to 16 megabytes
</PRE> 
Default: Depends on RISC-based computer’s system memory
<P>
For RISC-based computers, defines the amount of memory provided in a VDM
when a WOW session is started.This value is not used on x86-based
computers, where Windows NT allocates the memory needed when it is asked
for.
<P>
The default size chosen for a RISC-based computer depends on the amount of
system memory on the computer. For each MB specified, the system uses 1.25
MB, so setting Wowsize to 4 MB causes the VDM to allocate 5 MB, although
applications can only use 4 MB. You can override the following defaults:
<P>
<PRE>   System memory size        Default VDM size
   ------------------------------------------
   Less than 12 MB (small)   3 MB
   12-16 MB (medium)         6 MB
   More than 16 MB (large)   8 MB

</PRE>CAUTION: Setting Wowsize to a value lower than 3 MB causes most
applications to fail.
<P>
Reference: "The Windows NT Resource Kit for Operating System Version 3.1".
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbother ntregistry<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
