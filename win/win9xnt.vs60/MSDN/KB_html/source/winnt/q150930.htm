

<HTML>
<HEAD>
<TITLE>LPD Server Adds and Prints Control Codes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150930">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1996/05/13">
<META NAME="Keywords" CONTENT="ntprint NTSrvWkst kbnetwork kbprint">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When a formatted job prints from a line printer remote (LPR) client to a Windows NT computer that is running the Line Printing Demon (LPD) services, PCL or PostScript codes are printed instead of a properly formatted document.  RESOLUTION  The LPD ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAOX,QAB5,QA7O,QAOE,QAMN,QAH4,QAY2,QABA,QBWS,QANE,QARL,QAL0,QBJZ,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>LPD Server Adds and Prints Control Codes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150930</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a formatted job prints from a line printer remote (LPR) client to a
Windows NT computer that is running the Line Printing Demon (LPD) services,
PCL or PostScript codes are printed instead of a properly formatted
document.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The LPD service can be reconfigured to ignore the format control command
from the LPR client and always assign the RAW datatype. Use one of the
appropriate sections below to reconfigure the LPD service.
<P>
NOTE: This setting is not available for a single printer. This setting
affects all printers on the Windows NT Server that are receiving print jobs
from LPR clients. Print jobs from non-LPR clients are not affected by this
setting.
<P>
<P><h3>Configuring SimulatePassThrough In Windows NT 4.0</h3>
 
<P>
For Windows NT 4.0 to assign the RAW datatype, regardless of the
control file contents, do the following:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from the
use of Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Run Registry Editor (REGEDT32.EXE).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Services\LPDSVC\Parameters
</PRE>
<P><LI>On the Edit menu, click Add Value.

<P><LI>Add the following:
<P>
<P><PRE>      Value Name: SimulatePassThrough
      Data Type: REG_DWORD
      Data: 1
</PRE><P>
   NOTE: The default value is 0, which informs LPD to assign datatypes
   according to the control commands.
<P>
<P>
</OL><h3>Configuring SimulatePassThrough In Windows NT 3.51</h3>
 
<P>
In Windows NT 3.51 the code looks for a registry setting in the LPD key
instead of the LPDSVC key. You can work around this problem by creating an
LPD key at the same level as the LPDSVC key and then duplicating the
information in the LPDSVC key to the LPD key.
<P>
For Windows NT 3.51 to assign the RAW datatype, regardless of the
control file contents, do the following:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from the
use of Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Run Registry Editor (REGEDT32.EXE).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
       \SYSTEM\CurrentControlSet\Services\LPDSVC\Parameters

<P><LI>On the Edit menu, click Add Value.

<P><LI>Add the following:
<P>
       Value Name: SimulatePassThrough
       Data Type: REG_DWORD
       Data: 1
<P>
    NOTE: The default value is 0, which informs LPD to assign datatypes
    according to the control commands.

<P><LI>To work around the problem mentioned above, create an LPD key at
    the same level of the LPDSVC key.

<P><LI>Click the LPDSVC Key, click Save Key from the Registry menu, and then
    save the file as LPDSVC.KEY.

<P><LI>Click the LPD key created in step 5.

<P><LI>Click Restore on the Registry menu, click the file created in step 6,
    and then click OK.

<P><LI>A warning message appears. Click OK and then quit Registry Editor.

<P><LI>At a command prompt, type:
<P>
       net stop lpdsvc

<P><LI>At a command prompt, type:
<P>
       net start lpdsvc
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The Windows NT LPD Service follows the RFC1179 specification. This states
that the LPR client must tell the LPD server how to handle the print job.
If the client formats the job, it must send the "l" control character to
instruct the LPD server to print the job without any alteration.
<P>
Some LPR clients cannot be configured to send different control characters
and always send an "f". This control character instructs Windows NT to
assign a data type of TEXT and to use the printer driver to create a new
print job that prints the text of the original job on the page. In the case
of a postscript job, the new print job prints the original job's PostScript
code on the page.
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q124735.htm">Q124735</A></B>
   TITLE     : How Windows NT LPD Server Implements LPR Control Characters

   ARTICLE-ID: <B><A href="../winnt/q132460.htm">Q132460</A></B>
   TITLE     : Troubleshooting Windows NT Print Server Alteration of Print
               Jobs
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt unix aix sun solaris<BR>
Keywords          : ntprint NTSrvWkst kbnetwork kbprint<BR>
Version           : 3.5 3.51 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
