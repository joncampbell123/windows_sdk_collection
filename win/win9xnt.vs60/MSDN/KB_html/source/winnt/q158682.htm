

<HTML>
<HEAD>
<TITLE>Shortcuts Created Under Windows NT 4.0 Resolve to UNC Paths </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158682">
<META NAME="KBModify" CONTENT="1998/02/09">
<META NAME="KBCreate" CONTENT="1996/11/04">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00.sp2 NTSrvWkst ntui kbnetwork kbui">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information on how to do this, view the  Restoring the Registry  online Help t...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDJX,QAGU,QAL0,QBWR,QDIF,QDO3,QDL9,QBWO,QBWN,QBVV,QAR4,QAKD,QAE2,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Shortcuts Created Under Windows NT 4.0 Resolve to UNC Paths</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158682</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Windows NT user may click a program's shortcut and be prompted to Enter
Network Password, yet the properties of the shortcut indicate a relative
path to the local computer.
<P>
This problem may become evident where server-based profiles are used and
the user logs onto a computer other than the one where the shortcut was
created.
<P>
<P><h2>CAUSE</h2>
 
<P>
Shortcuts created on a computer automatically embed an UNC (Universal
Naming Convention) such as \\&lt;computer&gt;\admin$ in the .lnk file. The
default shortcut resolution method is to resolve the link to the original
location of the file (the "absolute" path) before looking at another path
of where that file may or may not exist (the secondary or "relative" path).
In this case the UNC path to the original file is always reachable, which
prevents the link from being resolved via a local path. As a result, the
user trying to execute the shortcut is prompted for the administrator's
password of the computer that created the link.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Apply the updated Shell32.dll from the latest Windows NT 4.0 service pack
and then change the registry setting using one of the following methods for
either the computer or the user.  This will change all existing shortcuts
that are showing the UNC path to the local relative path.
<P>
Use System Policy editor to create a policy file that is distributed when
the user logs onto the domain. The advantage of distributing the registry
change using Windows NT Policies is that users receive the change when
roaming.
<P>
If the systems are in a workgroup environment, apply the policy to each
user on a computer. Since the policy change is on a per-user basis and the
policies key requires administrative rights, in order to change the
registry setting the user must have administrative rights.
<P>
Alternately, the Microsoft Windows NT Server Resource Kit Version 4.0,
Supplement One ships with a utility called Shortcut.exe which modifies the
actual shortcut file and disables automatic link tracking of network
shortcuts on a per shortcut basis.
<P>
<P><h3>Distribute the Change Per Computer</h3>
 
<P>
NOTE: These steps require a hotfix (Post SP3) in addition to the latest
service pack. Service Pack 3 must be applied to Windows NT 4.0 prior to
applying this fix.
<P>
This fix should have the following time stamp:
<P>
<PRE>   06/30/97  08:20p             1,864,976 Shell32.dll (Alpha)
   06/30/97  09:20p             1,277,712 Shell32.dll (Intel)

</PRE>NOTE: If you are using Internet Explorer 4.0 and the Active Desktop, do not
install the Shell32.dll because it may cause IE and Windows NT to not
function correctly. However, the registry changes are still available. If
you are using Internet Explorer 4.0 without Active Desktop, install
Shell32.dll as described.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" online Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" online Help
topics in Regedt32.exe. Note that you should back up the registry before
you edit it.
<P>
To change these parameters, use the following procedure:

<OL><P><LI>Run Registry Editor (Regedt32.exe).

<P><LI>From the HKEY_LOCAL_MACHINE subtree, go to the following key:
<P>
<P><PRE>      \Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
</PRE><P>
   NOTE: Add the Explorer subkey, if it does not exist.

<P><LI>Click Add Value on the Edit menu.

<P><LI>Add the following value:
<P>
<P><PRE>      Value Name: LinkResolveIgnoreLinkInfo
      Data Type: REG_DWORD
      Data:  1 (enable)
</PRE>
<P><LI>Click OK.

<P><LI>Exit Registry Editor.

<P><LI>The user most logoff and logon before the change takes place.
<P>
</OL><h3>Distribute Change to Users in the Domain</h3>
 
<P>
In a domain environment, the change can be applied using Windows NT
Policies. Windows NT Service Pack 2 also ships with the appropriate
Winnt.adm file that contains the registry setting to enable the policy
change.

<OL><P><LI>Start System Policy Manager.

<P><LI>Enable: Default User\Windows NT Shell\Restrictins\Disable Link file
   tracking

<P><LI>Consult System Policy Editor Help or the Resource Kit for more
   information on using the System Policy Editor.
<P>
</OL><h3>Change an Individual User</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" online Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" online Help
topics in Regedt32.exe. Note that you should back up the registry before
you edit it.
<P>
To change these parameters, use the following procedure:

<OL><P><LI>Run Registry Editor (Regedt32.exe).

<P><LI>From the HKEY_CURRENT_USER subtree, go to the following key:
<P>
<P><PRE>      \Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
</PRE>
<P><LI>Click Add Value on the Edit menu.

<P><LI>Add the following value:
<P>
<P><PRE>      Value Name: LinkResolveIgnoreLinkInfo
      Data Type: REG_DWORD
      Data:  1 (enable)
</PRE>
<P><LI>Click OK.

<P><LI>Exit Registry Editor.

<P><LI>The user most logoff and logon before the change will take place.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
After the Shell32.dll has been applied, the system resolves the relative
path to the shortcut as expected. If the shortcut does not have a relative
path and contains the UNC name to the executable or file to which the user
does not have rights or cannot connect, the following message is displayed:
<P>
<PRE>   The file or folder "&lt;filename&gt;" that this shortcut refers to cannot be
   found.

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
 
<PRE>Keywords          : kbbug4.00 kbfix4.00.sp2 NTSrvWkst ntui kbnetwork kbui
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
