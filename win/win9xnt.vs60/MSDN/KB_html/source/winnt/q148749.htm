

<HTML>
<HEAD>
<TITLE>Performance Monitor Error after Installing NT 3.51 SP4 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148749">
<META NAME="KBModify" CONTENT="1996/09/23">
<META NAME="KBCreate" CONTENT="1996/03/20">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  After you upgrade to Windows NT 3.51 Service Pack 4 and run Performance Monitor, the following event is logged in Event Viewer:     Event ID: 1008    Source: Perflib    Description: The Open Procedure for service  NwlnkSpx  in DLL     perfctrs.dll ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDO3,QAMR,QAY5,QAU3,QANE,QAIJ,QAAP,QBVV,QAB4,QDNL,QAA1,QBWS,QACK,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Performance Monitor Error after Installing NT 3.51 SP4</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148749</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you upgrade to Windows NT 3.51 Service Pack 4 and run Performance
Monitor, the following event is logged in Event Viewer:
<P>
<PRE>   Event ID: 1008
   Source: Perflib
   Description: The Open Procedure for service "NwlnkSpx" in DLL
   "perfctrs.dll" failed. Performance data for this service will
   not be available. Status code returned is DWORD 0.

</PRE><h2>CAUSE</h2>
 
<P>
When the NWLINK IPX/SPX protocol is installed, an Nwlnkspx.sys key gets
created in the registry, and it has a Performance key under it. When
Performance Monitor loads, it calls the open SPX performance procedure for
Nwlnkspx.sys. The problem is that Nwlnkspx.sys is not started by default
and the error above is logged. Nwlnkspx.sys gets loaded when an SPX-based
application is started or NET START NWLNKSPX is issued from the command
prompt. NWLNKSPX counters do not appear in Performance Monitor until it has
started.
<P>
Changes to Service Pack 4 appear to cause this error. They do not adversely
affect the operating system in any way.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To monitor NWLINK IPX/SPX statistics in Windows NT 3.51 Service Pack 4,
type the following at a command prompt:
<P>
<PRE>   NET START NWLNKSPX

</PRE>NOTE: This loads the NWLNKSPX.SYS file, which is necessary to monitor the
NWLINK IPX/SPX statistics.
<P>
<PRE>   - or -

</PRE>Go into Control Panel, Devices and set all three of the NWLink devices to
startup automatically.  This will prevent the errors from being logged as
the system is first coming up after a reboot.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51
Service Pack 4. This problem was corrected in the latest Windows NT 3.51
U.S. Service Pack. For information on obtaining the Service Pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: ntsetup ntutil<BR>
Additional reference words: 3.51 prodnt sp4 service pack<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
