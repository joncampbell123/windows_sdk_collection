

<HTML>
<HEAD>
<TITLE>How to Troubleshoot TCP/IP Connectivity with Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102908">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1993/08/12">
<META NAME="Keywords" CONTENT="kbnetwork NTSrvWkst nttcp">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The ARP, PING, FTP, NETSTAT, and NBTSTAT utilities can provide useful information when you are trying to determine the cause of TCP/IP networking problems with Windows NT. Below is a list of possible TCP/IP symptoms with recommendations for using t...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QABI,QBWP,QAJQ,QDNT,QAVZ,QBW9,QDIZ,QAI5,QADK,QBVV,QAUJ,QAC2,QAA1,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Troubleshoot TCP/IP Connectivity with Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102908</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ARP, PING, FTP, NETSTAT, and NBTSTAT utilities can provide useful
information when you are trying to determine the cause of TCP/IP
networking problems with Windows NT. Below is a list of possible
TCP/IP symptoms with recommendations for using these utilities to
diagnose the problems. Although this is not a complete list, these are
examples of how you might use these utilities to track down problems
on the network.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Q: How can I determine whether TCP/IP is installed correctly on a
<PRE>   Windows NT system?

</PRE>A: Trying using PING on the local system by typing the IP loopback
<PRE>   address of 127.0.0.1 at the command line:

      ping 127.0.0.1

   The system should respond immediately. If PING is not found, or the
   command fails, check the event log with Event Viewer and look for
   problems reported by Setup or the TCP/IP service. You should also
   attempt to use PING with the IP addresses of your local
   interface(s) to determine whether you configured IP properly.
   Successful use of PING indicates that the IP layer on the target
   system is probably functional.

</PRE>Q: How can I determine if the FTP Server service is installed
<PRE>   correctly on a Windows NT system?

</PRE>A: Try using FTP on the local system by typing the IP loopback
<PRE>   address at the command line:

      ftp 127.0.0.1

   The interaction with the server locally is identical to the
   interaction expected for other Windows NT (and most UNIX) clients.
   This command can also be used to determine whether the directories,
   permissions, and so on of the FTP Server service are configured
   properly.

</PRE>Q: What causes Error 53 when I'm connecting to a Windows NT, Windows
<PRE>   for Workgroups, or Microsoft LAN Manager server?

</PRE>A: Error 53 is returned when the specified computername cannot be
<PRE>   resolved. If the computer is on the local subnet, confirm that the
   name is spelled correctly and that the target system is running
   TCP/IP as well. If the computer is not on the local subnet, make
   sure that its name and IP address mapping are available in the
   LMHOSTS file. If everything appears to be installed properly, try
   using PING with the remote system to make sure that its TCP/IP
   software is functional.

</PRE>Q: After I've added a new mapping to the LMHOSTS file, what can I do
<PRE>   if it takes an unusually long time to connect to the server?

</PRE>A: A large LMHOSTS file with an entry at the end of the file, possibly
<PRE>   following some #INCLUDEs, could cause this behavior. You can do two
   things to speed up the connect time: either mark the entry as a
   preloaded entry by following the mapping with the #PRE tag and use
   the NBTSTAT -R command to update the local name cache immediately,
   or place the mapping higher in the LMHOSTS file.

   The LMHOSTS file is parsed sequentially to locate non #PREloaded
   entries. Therefore, you should place frequently used entries near
   the top of the file and the #PRE entries near the bottom.

</PRE>Q: What should I do if users are having difficulty connecting to a
<PRE>   particular server, even when specifying the same name?

</PRE>A: Use the NBTSTAT -N command to determine (authoritatively) what name
<PRE>   the server registered on the network. The output of this command
   lists several names that the system has registered using NetBIOS
   over TCP/IP. One resembling the system's computername should be
   present. If not, try one of the other unique names displayed. The
   NBTSTAT command can also display the cached entries for remote
   systems either #PREloaded from LMHOSTS or recently resolved names
   due to current network activity. If the name the remote users are
   using is the same, and the other systems are on a remote subnet,
   make sure that they have the system's mapping in their LMHOSTS
   file.

</PRE>Q: What should I do when I cannot connect to foreign systems with
<PRE>   hostnames using TELNET, FTP, and so on, but can only connect using
   IP addresses?

</PRE>A: Using the Network icon in Control Panel, check the hostname
<PRE>   resolution configuration (found under the TCP/IP Connectivity
   option) to be sure that the appropriate HOSTS and DNS setup has
   been configured for the system. If you are using the HOSTS file,
   make sure the remote system is spelled the same way in the file as
   it is being used by the application. If you are using DNS, make
   sure the IP addresses of the DNS servers are correct and in the
   proper order. To determine whether the hostname is being resolved
   properly, try using PING with the remote system by typing both the
   hostname and IP address.

</PRE>Q: The banner displayed when I'm using TELNET with a particular
<PRE>   computer identifies a computer other than the one that I intended
   to connect to, even when I'm specifying the correct IP address.
   How can this be?

</PRE>A: Situations like this usually arise when two systems on the same
<PRE>   network are configured (mistakenly) with the same IP address. The
   Ethernet and IP address mapping is done by the address resolution
   protocol (ARP) module, which believes the first response it
   receives. So the impostor computer's reply sometimes comes back
   before the intended computer's reply. These problems are difficult
   to isolate and track down. The command ARP -g displays the mappings
   in the ARP cache. If you know the Ethernet address for the intended
   remote system, you can easily determine if the two match. If not,
   try using ARP D to delete the entry, then PING the same address
   (forcing a new ARP mapping) and check the Ethernet address in the
   cache again using ARP -g. Chances are that if both systems are on
   the same network, you will eventually get a different response. If
   not, you may need to filter the traffic from the impostor host to
   determine the owner or location of the system.

</PRE>Q: What should I do when a TCP/IP connection to a remote system
<PRE>   appears to be hung?

</PRE>A: The NETSTAT -a command shows the status of all activity on TCP and
<PRE>   UDP ports on the local system. The state of a good TCP connection
   is usually established with 0 bytes in the send and receive queues.
   If data is blocked in either queue or if the state is irregular,
   there is probably a problem with the connection. If not, you are
   probably experiencing network or application delay.

</PRE>Q: What should I do when the TCP/IP configuration dialog box reports:
<PRE>   "Your default gateway does not belong to one of the configured
   interfaces. Do you want to change it?"

</PRE>A: This error indicates that the default gateway is not located on the
<PRE>   same logical network as any of the installed interface(s) on the
   system. This is determined by comparing the net ID portion of the
   default gateway (by computing a bitwise AND operation between the
   subnet mask and the default gateway) and the net ID(s) of any of
   the installed interfaces. For example, a system with a single
   interface configured with an IP address of 102.54.0.1 and a subnet
   mask of 255.255.0.0 would require that the default gateway be of
   the form 102.54.a.b because the net ID portion of the IP interface
   is 102.54.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt tshoot<BR>
Keywords            : kbnetwork NTSrvWkst nttcp<BR>
Version             : 3.1 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
