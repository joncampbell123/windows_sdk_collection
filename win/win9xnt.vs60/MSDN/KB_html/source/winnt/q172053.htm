

<HTML>
<HEAD>
<TITLE>Restoring .lnk File Associations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172053">
<META NAME="KBModify" CONTENT="1997/09/04">
<META NAME="KBCreate" CONTENT="1997/07/28">
<META NAME="Keywords" CONTENT="nthowto ntsetup NTSrvWkst kbfile">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you select programs from the Start menu or shortcuts nothing happens, the  Open with  dialog box is displayed or a specific program runs.  CAUSE =====  The .lnk association is either missing, incorrect or corrupted. Because all shortcuts and P...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QBWS,QAY2,QAIJ,QA2Q,QAL0,QBWP,QAVI,QAG2,QBWR,QA01,QAR4,QAH4,QAHT,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Restoring .lnk File Associations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172053</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you select programs from the Start menu or shortcuts nothing happens,
the "Open with" dialog box is displayed or a specific program runs.
<P>
<P><h2>CAUSE</h2>
 
<P>
The .lnk association is either missing, incorrect or corrupted. Because all
shortcuts and Program Menu items are files with a .lnk extension. Selecting
one either brings up the "Open with" dialog box, a specific application
such as Notepad.exe or Wordpad.exe or doesn't do anything.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can correct this by either restoring the registry key from another
working computer or manually replacing the registry key.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
To restore the registry key from another computer, perform the following
steps:

<OL><P><LI>Start Registry Editor (Regedt32.exe) and select the following subkey:
<P>
   HKEY_CLASSES_ROOT\.lnk

<P><LI>From the Edit menu, click Delete.

<P><LI>On another Windows NT 4.0 computer, start Registry Editor (Regedt32.exe)
   and select the registry key HKEY_CLASSES_ROOT\.lnk.

<P><LI>From the Registry menu, click Save Key.

<P><LI>Copy this file to the computer exhibiting the problem or to a floppy
   disk.

<P><LI>On the computer exhibiting the problem, recreate the registry key by
   selecting HKEY_CLASSES_ROOT and then from the Edit menu, click Add Key.
   Type .lnk for the key name.

<P><LI>Select the new key, click Restore from the Registry menu, and select the
   file from the other computer or floppy disk.

<P><LI>Quit Registry Editor and restart the computer. Test a Program menu item
   or shortcut.
<P>
</OL>To manually enter the information, perform the following steps:

<OL><P><LI>Start Registry Editor (Regedt32.exe), select the HKEY_CLASSES_ROOT
   subkey, and then from the Edit menu, click Add Key.

<P><LI>In the Add Value dialog box, click OK to leave the Value Name blank, and
   the Data Type as REG_SZ.

<P><LI>Type lnkfile in the String Editor dialog box, and then click OK.

<P><LI>From the Edit menu, click Add Key and create the registry key ShellNew
   under HKEY_CLASSES_ROOT\.lnk

<P><LI>Click Add Value from the Edit menu, and type Command for the Data Name
   with a Data Type of REG_SZ. Enter RunDLL32 AppWiz.Cpl,NewLinkHere %1 for
   the string.

<P><LI>Quit Registry Editor and restart the computer.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Howto file types<BR>
Keywords          : nthowto ntsetup NTSrvWkst kbfile<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
