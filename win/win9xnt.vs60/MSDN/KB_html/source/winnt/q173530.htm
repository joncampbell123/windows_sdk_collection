

<HTML>
<HEAD>
<TITLE>How to Determine Whether a Client Is Connected by RAS or LAN </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173530">
<META NAME="KBModify" CONTENT="1997/11/14">
<META NAME="KBCreate" CONTENT="1997/09/08">
<META NAME="Keywords" CONTENT="kbhowto kbinfo ntdomain nthowto NTINTEROP ntnetserv NTSrv kbinterop kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QDNQ,QABI,QABH,QBWE,QBG2,QAGU,QBXE,QBCU,QARL,QADN,QADK,QBW7,QBKX,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Determine Whether a Client Is Connected by RAS or LAN</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173530</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.51 and 4.0
 --------------------------------------------------------------------------
<P>
</UL><h2>SUMMARY</h2>
 
<P>
You may want to know whether a user is connected by Remote Access Service
(RAS) or the local area network (LAN) if you use logon scripts to map
drives or to set environment variables when a user logs on to a domain.
This can be especially helpful if the logon script contains a large number
of commands. This article discusses one method of determining if a user is
connecting by RAS.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Systems Management Server includes a utility, Netspeed.com, that
checks to see if a user has a slow connection. This utility, however, does
not verify that there is an active RAS connection on the client.
<P>
For more information on Netspeed.exe, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sms/q131011.htm">Q131011</A></B>
   TITLE     : SMS: NETSPEED.COM Internals

</PRE>The Backoffice Resource Kit includes Checkras.exe, a utility that checks
for RAS connections on the client instead of trying to determine the link
speed. You can use the Checkras.exe utility in your logon script to check
whether a user is connected by a RAS connection, and then include commands
in your logon script based on the results returned by Checkras.exe.
<P>
The following is a sample Windows NT domain logon script that uses
Checkras.exe:
<P>
<PRE>   echo Beginning of logon script

   echo Checking for existence of Checkras.exe
   if exist %windir%\checkras.exe goto yes
   copy \\server\netlogon\checkras.exe %windir%

   :yes
   echo Checking for RAS connection
   %windir%\checkras
   if errorlevel 1 goto ras
   echo This is not a RAS connection
   pause
   goto end

   :ras
   echo This is a RAS connection
   pause

   :end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sms<BR>
Keywords          : kbhowto kbinfo ntdomain nthowto NTINTEROP ntnetserv NTSrv kbinterop kbnetwork<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
