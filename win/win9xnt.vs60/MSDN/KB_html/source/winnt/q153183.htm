

<HTML>
<HEAD>
<TITLE>How to Restrict Access to NT Registry from a Remote Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153183">
<META NAME="KBModify" CONTENT="1997/04/07">
<META NAME="KBCreate" CONTENT="1996/09/11">
<META NAME="Keywords" CONTENT="kbnetwork ntregistry NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Registry Editor supports remote access to the Windows NT Registry. On Windows NT 3.51 with Service pack 4 or Windows NT version 4.0 you can restrict this access.  MORE INFORMATION  By default on a Windows NT 3.51 system any user can access the regi...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBWP,QBW7,QBWG,QA1S,QAK9,QAKD,QAB5,QBJZ,QA7O,QAOE,QAMN,QANN,QAGU,QAA8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Restrict Access to NT Registry from a Remote Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153183</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Registry Editor supports remote access to the Windows NT Registry. On
Windows NT 3.51 with Service pack 4 or Windows NT version 4.0 you can
restrict this access.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
By default on a Windows NT 3.51 system any user can access the registry
when connecting over the network. On a Windows NT 4.0 system, by default
only members of the Administrators group can access the registry over the
Network.
<P>
NOTE: Some services need access to the registry to function correctly. For
example, if you add this key to a 3.51 system that is running Directory
Replication, it is necessary to grant the Replicator account access to the
registry as described later in this article.
<P>
<P><h3>Restricting Network Access to the Registry</h3>
 
<P>
To restrict network access to the registry, follow the steps listed below
to create the following Registry key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\
   winreg

   Description: REG_SZ
   Value:       Registry Server

</PRE>The Security permissions set on this key define what Users or Groups can
connect to the system for remote Registry access. The default Windows NT
Server 4.0 installation defines this key and sets the Access Control List
to restrict remote registry access as follows:
<P>
<PRE>   Administrators have Full Control

</PRE>The default configuration for Windows NT Server 4.0 permits only
Administrators remote access to the Registry. Changes to this key to allow
users remote registry access require a system reboot to take effect.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
To create the registry key to restrict access to the registry:

<OL><P><LI>Start Registry Editor (Regedt32.exe) and go to the following subkey:
<P>
       HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control

<P><LI>On the Edit menu, click Add Key.

<P><LI>Enter the following values:
<P>
       Key Name: SecurePipeServers
<PRE>       Class:    REG_SZ

</PRE><P><LI>Go to the following subkey:
<P>
       HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\
       SecurePipeServers

<P><LI>On the Edit menu, click Add Key.

<P><LI>Enter the following values:
<P>
       Key Name: winreg
<PRE>       Class:    REG_SZ

</PRE><P><LI>Go to the following subkey:
<P>
       HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\
       SecurePipeServers\winreg

<P><LI>On the Edit menu, click Add Value.

<P><LI>Enter the following values:
<P>
       Value Name: Description
       Data Type:  REG_SZ
<PRE>       String:     Registry Server

</PRE><P><LI>Go to the following subkey.
<P>
       HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\
       SecurePipeServers\winreg

<P><LI>Highlight winreg. Click Security and then click Permissions. Add users
    or groups that you want to grant access.

<P><LI>Exit Registry Editor and restart Windows NT.

<P><LI>If you at a later stage want to change the list of users that can
    access the registry, repeat steps 10-12.
<P>
</OL><h3>Bypassing the Access Restriction</h3>
 
<P>
Some services need remote access to the registry to function correctly.
For example, the Directory Replicator service and the Spooler service when
connecting to a printer over the network require access to the remote
registry.
<P>
You can either add the account name that the service is running under to
the access list of the "winreg" key, or you can configure Windows NT 4.0
to bypass the access restriction to certain keys by listing them in the
Machine or Users value under the AllowedPaths key.
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\
   winreg\AllowedPaths

   Value:        Machine
   Value Type:   REG_MULTI_SZ - Multi string
   Default Data: System\CurrentControlSet\Control\ProductOptions
                 System\CurrentControlSet\Control\Print\Printers
                 System\CurrentControlSet\Services\Eventlog
                 Software\Microsoft\Windows NT\CurrentVersion
                 System\CurrentControlSet\Services\Replicator
   Valid Range:  A valid path to a location in the registry.
   Description:  Allow machines access to listed locations in the
                 registry provided that no explictic access
                 restrictions exists for that location.

   Value:        Users
   Value Type:   REG_MULTI_SZ - Multi string
   Default Data: (None)
   Valid Range:  A valid path to a location in the registry.
   Description:  Allow Users access to listed locations in the
                 registry provided that no explictic access
                 restrictions exists for that location.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbnetwork ntregistry NTSrvWkst<BR>
Version             : 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
