

<HTML>
<HEAD>
<TITLE>Possible to Circumvent ZAK Using Explorer.exe as Embedded Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182367">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1998/03/12">
<META NAME="Keywords" CONTENT="kbbug4.00 NTWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  After you install Windows NT using the Zero Administration Kit (ZAK) with a desktop setup that does not permit users to launch Windows NT Explorer, you can still gain access to Windows NT Explorer when in a Microsoft Office application. This is ach...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDKG,QBIC,QBV9,QAPN,QBWG,QBWS,QAA1,QAEF,QAK7,QBFN,QA49,QAY2,QAGU,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Possible to Circumvent ZAK Using Explorer.exe as Embedded Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182367</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Zero Administration Kit for Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you install Windows NT using the Zero Administration Kit (ZAK) with a
desktop setup that does not permit users to launch Windows NT Explorer, you
can still gain access to Windows NT Explorer when in a Microsoft Office
application. This is achieved by inserting an object into the document and
typing in the path and file name from the import box.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Explorer.exe file has Read &amp; Execute (RX) special permissions, which
enable the folder to be opened from within the application. The file is
first read before it can be run. These permissions are set during the ZAK
install when Acls.cmd is run.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this issue, remove the Read (R) special permission from the
Everyone Group. If the file cannot be read, it cannot be run. However, you
must retain the Execute (X) special permission so that Explorer remains as
the active desktop. Use one of the following methods.
<P>
<P><h3>Method One</h3>
 

<OL><P><LI>Start Explorer and locate Explorer.exe in the %SystemRoot% folder.

<P><LI>Right-click the executable file and select Properties.

<P><LI>Select the Security tab from the Properties window and click the
   Permissions button.

<P><LI>Double-click the Everyone Group and view the Special Access dialog box.

<P><LI>Remove (clear) the Read(R) attribute and confirm the changes.
<P>
</OL><h3>Method Two</h3>
 
<P>
Edit Acls.cmd and change the following line from:
<P>
<PRE>   calcs.exe explorer.exe /t /e /g everyone:r

</PRE></OL>to:
<P>
<PRE>   xcalcs.exe explorer.exe /t /e /p everyone:x

</PRE>where:
<P>
<PRE>   xcacls is used because special permissions are being set
   /p is used to replace existing permissions
   x is used to grant execute permission

</PRE>NOTE: xcacls is a resource kit utility and should be accessible through the
path or referenced explicitly.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q170400.htm">Q170400</A></B>
   TITLE     : Unauthorized Program Can Be Installed and Run on ZAK
               Workstation

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Office Word Excel<BR>
Keywords          : kbbug4.00 NTWkst<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
