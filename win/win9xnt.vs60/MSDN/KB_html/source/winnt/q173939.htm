

<HTML>
<HEAD>
<TITLE>How to Identify User Who Changed Administrator Password </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173939">
<META NAME="KBModify" CONTENT="1997/10/16">
<META NAME="KBCreate" CONTENT="1997/09/16">
<META NAME="Keywords" CONTENT="ntdomain ntregistry ntsecurity NTSrv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Enabling auditing for user and group management will generate audit events when user or group accounts are changed. However, the events will list the security ID (SID) rather than the user name of the user who made the change.  For security purpose...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QAPN,QAH5,QA2Q,QBWS,QBWU,QAO4,QAG2,QABO,QAK7,QAAD,QAY2,QBWF,QAGR,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Identify User Who Changed Administrator Password</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173939</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Enabling auditing for user and group management will generate audit events
when user or group accounts are changed. However, the events will list the
security ID (SID) rather than the user name of the user who made the
change.
<P>
For security purposes, it is often desirable to know the user name of the
user who made the change. This can be accomplished by auditing changes on
the registry key corresponding to the Administrator account.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This procedure should be performed at the console of the primary domain
controller. This procedure should NOT be attempted over a WAN because of
the large number of registry changes involved.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Open User Manager for Domains and select Audit from the Policies menu.

<P><LI>Select Audit These Events and then enable Success and Failure audits for
   File and Object Access events.

<P><LI>Click the OK button and close User Manager for Domains.

<P><LI>Open REGEDT32.

<P><LI>Select the window for the HKEY_LOCAL_MACHINE hive and select the SAM
   key.

<P><LI>Select Permissions from the Security menu.

<P><LI>Select the Change Permissions on Existing Subkeys checkbox.

<P><LI>Change the ACE for the Administrators local group from Special to Full
   Control.

<P><LI>Click OK to change the permissions.

<P><LI>Go to the following key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\000001F4
</PRE>
<P><LI>Select Auditing from the Security menu and select the Audit Permission
   on Existing Subkeys checkbox.

<P><LI>Add the Administrators local group to the list of names.

<P><LI>Select the Administrators local group in the list of names, and enable
   Success and Failure auditing for Set Value events.

<P><LI>Click the OK button and close Registry Editor.
<P>
</OL>If you want to restore the default permissions for the Administrators local
group on the SAM key and its subkeys, give them the Write DAC and Read
Control permissions only.
<P>
When any changes are made to the Administrator account, several events will
be generated. The event indicating the user who made the change will be:
<P>
<PRE>   ID: 560
   Source: Security
   Type: Success Audit
   Category: Object Access

</PRE></OL>This event will indicate the user who made the change, and the date and
time of the change.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: screen saver lock password protect<BR>
Keywords          : ntdomain ntregistry ntsecurity NTSrv<BR>
Version           : WinNT:3.5,3.51,4.0<BR>
Platform          : winnt<BR>
Hardware          : x86<BR>
Issue type        : kbhowto kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
