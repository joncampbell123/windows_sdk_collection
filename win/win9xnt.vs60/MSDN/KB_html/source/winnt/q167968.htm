

<HTML>
<HEAD>
<TITLE>Access Violation Causes 16-Bit Applications to Silently Quit </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167968">
<META NAME="KBModify" CONTENT="1997/10/06">
<META NAME="KBCreate" CONTENT="1997/05/02">
<META NAME="Keywords" CONTENT="nt16ap ntdosap NTSrvWkst kbhelpfile">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  16-bit applications, both DOS and Windows based, run successfully for a period of time and then quit without cause.  RESOLUTION  Verify that VIF and VIP are not turned on at the same time. This problem can be avoided by disabling the Pentium Virtua...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJZ,QBWP,QAGB,QAL0,QBWS,QA1S,QAJH,QBW7,QAKD,QAI5,QAIJ,QDIV,QBJZ,QBWG,QDN9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Access Violation Causes 16-Bit Applications to Silently Quit</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167968</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
16-bit applications, both DOS and Windows based, run successfully for a
period of time and then quit without cause.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Verify that VIF and VIP are not turned on at the same time. This problem
can be avoided by disabling the Pentium Virtual Machine Extensions (VME)
because VIF and VIP are only used by VME support. To disable the use of
VME in Windows NT, add the following value to the registry:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use Registry Editor at your own risk.

<OL><P><LI>Start Registry Editor (Regedt32.exe) and go to the following subkey:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Wow
</PRE>
<P><LI>On the Edit menu, click Add Value. Enter the following:
<P>
<P><PRE>      Value Name: DisableVme
      Data Type: REG_SZ
</PRE><P>
<P><PRE>     (hit OK here)
</PRE><P>
<P><PRE>      Data: 1
</PRE>
<P><LI>Click OK, and then quit Registry Editor.

<P><LI>Shutdown and restart you computer.
<P>
</OL>Once this value is entered and you have restarted your computer, test the
application to verify that the Virtual Dos Machine (VDM) no longer causes
an access violation and causes the application to quit.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you run the application under a debugger such as Ntsd.exe, the
application will break to the debugger instead of quitting. The debugger
shows that the VDM caused an access violation after carrying out an STI
instruction (this indicates that the program currently running does not
have high enough privilege to enable hardware interrupts).
<P>
NTSD: access violation
eax=00010240 ebx=0000000a ecx=00004000 edx=00000010 esi=0001573c
edi=0000000a
eip=000053e0 esp=0000079c ebp=000bea74 iopl=0 vip vif nv up ei pl nz na
ponc
cs=fe2e  ss=00a7  ds=0040  es=0000  fs=0000  gs=0000
efl=001b0206
<PRE>fe2e:53e0 ebf8            jmp    53da

</PRE></OL>0:000&gt;kv
ChildEBP RetAddr  Args to Child
0000ea74 00000000 00000000 00000000 00000000 0x53e0 [Stdcall: 0]
<P>
0:000&gt; u fe2e:53e0-1
<PRE>fe2e:53df fb              sti
fe2e:53e0 ebf8            jmp     53da
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt drops out disappear stop close<BR>
Keywords          : nt16ap ntdosap NTSrvWkst kbhelpfile<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
