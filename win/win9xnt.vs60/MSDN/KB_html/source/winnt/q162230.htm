

<HTML>
<HEAD>
<TITLE>Fragmentation and Performance Issues with PPTP Connections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162230">
<META NAME="KBModify" CONTENT="1998/02/25">
<META NAME="KBCreate" CONTENT="1997/01/16">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00 NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAR4,QAKD,QDJ0,QAY5,QAU3,QAMR,QAL0,QAI5,QDKA,QBG2,QA6A,QAM1,QAYY,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Fragmentation and Performance Issues with PPTP Connections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 25, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162230</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Routing and Remote Access Service Update for Windows NT
   Server 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it
if a problem occurs. For information about how to do this, view the
"Restoring the Registry" Help topic in Regedit.exe or the "Restoring a
Registry Key" Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Performance degradation may occur when you use Point-to-Point Tunneling
Protocol (PPTP) connections.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This hotfix does the following:

<UL><LI>Corrects an issue in TCP/IP that occasionally generates packets larger
   than 1,500 bytes.

<LI>Corrects a resource allocation issue in TCP/IP that causes the stack
   (under heavy load) to drop forwarded packets instead of allocating more
   memory.

<LI>Changes the MTU for IP connections over NDISWan down to 1,400. This
   helps to keep from fragmenting when you are connecting with PPTP
   directly across a LAN.
<P>
</UL>If your PPTP connection is exhibiting any of these types of behavior,
please obtain the following fix or wait for the next Windows NT service
pack.
<P>
This fix should have the following time stamp(s):
<P>
<PRE>   11/05/97  04:44p                57,360  Ndiswan.sys  (Intel)
   11/05/97  04:44p                57,744  Ndiswand.sys (Intel)
   10/22/97  01:26p               140,560  Tcpip.sys    (Intel)

   11/05/97  04:41p               103,248  Ndiswan.sys  (Alpha)
   11/05/97  04:41p               103,984  Ndiswand.sys (Alpha)
   10/22/97  01:23p               258,416  Tcpip.sys    (Alpha)

</PRE>NOTE: Ndiswan.sys is the 40-bit version and Ndiswand.sys is the 128-bit
version of this file. If you are using 128-bit encryption, you will need
to install Ndiswand.sys and rename it to Ndiswan.sys to retain your
encryption.
<P>
After you apply the fix, shut down and restart your computer.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry
Editor can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys
And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" Help topics
in Regedt32.exe. Note that you should back up the registry before you edit
it.
<P>
<P><h3>Registry Change</h3>
 
<P>
The registry change below can be used to increase performance on a
reliable network. If the network is unreliable or congested, this setting
should be set to the default value; otherwise, set this value to 8.
<P>
NOTE: This registry change is not a requirement for the hotfix itself,
but should  be used to gain performance under reliable conditions.

<OL><P><LI>Run Registry Editor (Regedt32.exe).

<P><LI>Go to the following key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Raspptpe
      \Parameters\Configuration
</PRE><P>
   NOTE: The above registry key is one path; it has been wrapped for
   readability.

<P><LI>Click Add Value on the Edit menu.

<P><LI>Add the following value:
<P>
<P><PRE>      Value Name: RxPacketWindow
      Data Type: REG_DWORD
      Data: 2 (default)
</PRE><P>
   Set the data value to 8.

<P><LI>Click OK and then quit Registry Editor.

<P><LI>Shut down and restart Windows NT.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 exchange<BR>
Keywords          : kbbug4.00 kbfix4.00 NTSrvWkst nttcp kbnetwork<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 25, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
