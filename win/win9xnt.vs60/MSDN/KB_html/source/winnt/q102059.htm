

<HTML>
<HEAD>
<TITLE>Registry Entries for NT Virtual DOS Machine (VDM): </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102059">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/07/28">
<META NAME="Keywords" CONTENT="kbprint nt16ap ntdosap ntprint NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article covers the registry entries for Windows NT virtual DOS machines (VDMs).  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet \Control\VirtualDeviceDrivers  This registry entry contains all the virtual device drivers (VDDs) that are loaded in t...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAOX,QAKD,QDL9,QBWQ,QBWO,QBWN,QDH9,QAJH,QAGU,QBW6,QBVV,QABA,QAB5,QDIR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Registry Entries for NT Virtual DOS Machine (VDM):</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102059</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system, version 3.1
<LI>Microsoft Windows NT Advanced Server, version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article covers the registry entries for Windows NT virtual DOS
machines (VDMs).
<P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet
\Control\VirtualDeviceDrivers
 
<P>
This registry entry contains all the virtual device drivers (VDDs)
that are loaded in the VDM at initialization. This is entry is mainly
intended for independent hardware vendors (IHVs) who want to provide
virtual device drivers with their native device drivers. By default,
this entry does not have any VDDs.
<P>
<P><h3>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WOW</h3>
 
<P>
This registry entry supports the following keys:

<UL><LI>cmdline:     The command line which NT uses to create NT virtual
<PRE>                DOS machines (VDMs) for MS-DOS-based applications.
                This entry is not useful for end users in any way.

</PRE><LI>size:        This tells NT what should be total memory size for
<PRE>                the VDM created for MS-DOS-based applications. This
                includes conventional and extended memory. Default
                value is 0, which means NT should choose the size
                depending on the machine configuration. If this value
                is altered, NT uses it rather than determining a value
                itself.

</PRE><LI>wowcmdline:  Same as cmdline described above but used by Windows on
<PRE>                Windows (WOW) VMDs.

</PRE><LI>wowsize:     same as size described above but used by WOW VDMs.

<LI>KnownDLLs:   This is only for WOW applications. If a DLL name is
<PRE>                included in this entry and the application loads it
                without specifying the full path, the WOW subsystem
                loads that DLL from the Windows NT system directory
                (\SYSTEM32). This ensures the Windows NT loads a
                specific version of the WOW DLL rather than the
                application's version of that DLL (since the
                application's version of the DLL may not work under
                Windows NT.

</PRE><LI>LPT_Timeout: This is used by MS-DOS-based applications. There is no
<PRE>                specific call to tell MS-DOS that the print job has
                completed. Under Windows NT (which spools print jobs),
                it is important to close the print job for printing to
                start. NT VDMs uses this timeout value to detect no
                printing activity before closing the print job handle.
                The default value is 15 seconds.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbprint nt16ap ntdosap ntprint NTSrvWkst<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
