

<HTML>
<HEAD>
<TITLE>Using Detailed Logging to Debug SNMP Issues </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149421">
<META NAME="KBModify" CONTENT="1997/03/26">
<META NAME="KBCreate" CONTENT="1996/05/09">
<META NAME="Keywords" CONTENT="kbnetwork NTSrv nttcp">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  You can obtain detailed SNMP debug information on Windows NT systems without attaching a debugger by using the checked build of SNMP.EXE.  MORE INFORMATION  Use the following steps to log detailed debug information to a log file (SNMPDBG.LOG) in th...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QBWP,QAUD,QAPN,QAO4,QBFY,QBXS,QAGI,QDNN,QAUJ,QAKC,QAP2,QAYY,QAVX,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Detailed Logging to Debug SNMP Issues</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149421</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can obtain detailed SNMP debug information on Windows NT systems
without attaching a debugger by using the checked build of SNMP.EXE.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following steps to log detailed debug information to a
log file (SNMPDBG.LOG) in the %SYSTEMROOT%\SYSTEM32 subdirectory,
or to the system event log.

<OL><P><LI>Change to the %SYSTEMROOT\SYSTEM32 subdirectory.

<P><LI>Rename the SNMP.EXE file in your %SYSTEMROOT\SYSTEM32 subdirectory to
   SNMP.FRE.

<P><LI>Copy the checked SNMP.EXE file to your %SYSTEMROOT\SYSTEM32
   subdirectory.

<P><LI>From a command prompt, type the following:
<P>
<P><PRE>      NET START SNMP /loglevel:20/logtype:7
</PRE><P>
  Debug information will be written to %SYSTEMROOT%\SYSTEM32\SNMPDBG.LOG,
  and to the system event log.

<P><LI>You can adjust the output detail by lowering the /loglevel and /logtype
   options to lower numbers.
<P>
</OL><h3>Sample Output Using /loglevel:20 /logtype:7</h3>
 
Service: Debug log type changed to 7.
Service: Begin initializing agent.
agentConfigInit: entered.
regconf: entered.
vcConfig: entered.
vcConfig: RegKey Opened OK.
vcConfig: Calling RegEnumValue.
vcConfig: value found - type :1
vcConfig: value found - name :1
vcConfig: value found - data:pigland
vcConfig: memcpy called
vcConfig: memcpy returned
vcConfig: Calling RegEnumValue again.
vcConfig: RegEnumValue returned NO_MORE_ITEMS
vcConfig: calling RegCloseKey
vcConfig: RegCloseKey returned
vcConfig: exit.
pmConfig: entered.
pmConfig: exit.
eaConfig: entered.
eaConfig: value found (eakey) - type :1
eaConfig: value found (eakey) - name :1
eaConfig: value found (eakey) -
data:SOFTWARE\Microsoft\LANManagerMIB2Agent\CurrentVersion
eaConfig: value found (agent) - type :2
eaConfig: value found (agent) - name :Pathname
eaConfig: value found (agent) - data:%SystemRoot%\System32\lmmib2.dll
eaConfig: Pathname found (agent)
eaConfig: ExpandEnvironmentStrings called %SystemRoot%\System32\lmmib2.dll
eaConfig: ExpandEnvironmentStrings called %SystemRoot%\System32\lmmib2.dll
eaConfig: ExpandEnvironmentStrings returned C:\WINNT35\System32\lmmib2.dll
eaConfig: value found (eakey) - type :1
eaConfig: value found (eakey) - name :2
eaConfig: value found (eakey) -
data:SOFTWARE\Microsoft\RFC1156Agent\CurrentVersion
eaConfig: value found (agent) - type :2
eaConfig: value found (agent) - name :Pathname
eaConfig: value found (agent) - data:%SystemRoot%\System32\inetmib1.dll
eaConfig: Pathname found (agent)
eaConfig: ExpandEnvironmentStrings called
%SystemRoot%\System32\inetmib1.dll
eaConfig: ExpandEnvironmentStrings called
%SystemRoot%\System32\inetmib1.dll
eaConfig: ExpandEnvironmentStrings returned
C:\WINNT35\System32\inetmib1.dll
eaConfig: value found (eakey) - type :1
eaConfig: value found (eakey) - name :3
eaConfig: value found (eakey) -
data:SOFTWARE\Microsoft\DhcpMibAgent\CurrentVersion
eaConfig: value found (agent) - type :2
eaConfig: value found (agent) - name :Pathname
eaConfig: value found (agent) - data:%SystemRoot%\System32\dhcpmib.dll
eaConfig: Pathname found (agent)
eaConfig: ExpandEnvironmentStrings called %SystemRoot%\System32\dhcpmib.dll
eaConfig: ExpandEnvironmentStrings called %SystemRoot%\System32\dhcpmib.dll
eaConfig: ExpandEnvironmentStrings returned C:\WINNT35\System32\dhcpmib.dll
eaConfig: value found (eakey) - type :1
eaConfig: value found (eakey) - name :4
eaConfig: value found (eakey) -
data:SOFTWARE\Microsoft\WinsMibAgent\CurrentVersion
eaConfig: value found (agent) - type :2
eaConfig: value found (agent) - name :Pathname
eaConfig: value found (agent) - data:%SystemRoot%\System32\winsmib.dll
eaConfig: Pathname found (agent)
eaConfig: ExpandEnvironmentStrings called %SystemRoot%\System32\winsmib.dll
eaConfig: ExpandEnvironmentStrings called %SystemRoot%\System32\winsmib.dll
eaConfig: ExpandEnvironmentStrings returned C:\WINNT35\System32\winsmib.dll
eaConfig: exit.
tdConfig: entered.
tdConfig: exit.
regconf: exit.
Init: Read registry parameters.
error on ipx socket 10047
error on GetProcAddress(InitEx) 127
Init: Loaded/initialized 'C:\WINNT35\System32\lmmib2.dll'.
Init: Dupping 4 - 'C:\WINNT35\System32\inetmib1.dll'.
Init: Dupping 5 - 'C:\WINNT35\System32\inetmib1.dll'.
Init: Dupping 6 - 'C:\WINNT35\System32\inetmib1.dll'.
Init: Dupping 7 - 'C:\WINNT35\System32\inetmib1.dll'.
Init: Dupping 8 - 'C:\WINNT35\System32\inetmib1.dll'.
Init: Dupping 9 - 'C:\WINNT35\System32\inetmib1.dll'.
Init: Loaded/initialized 'C:\WINNT35\System32\inetmib1.dll'.
error on GetProcAddress(InitEx) 127
Init: Loaded/initialized 'C:\WINNT35\System32\dhcpmib.dll'.
error on GetProcAddress(InitEx) 127
Init: Loaded/initialized 'C:\WINNT35\System32\winsmib.dll'.
Init: Set-up UDP listen port (SNMP).
error on IPX socket 10047
Init: created agentCommThread tid=0x76.
agentCommThread entered
agentCommThread in select
Init: becoming agentTrapThread.
Service: serviceHandlerFunction(dwControl=4).
trapThread: event 1 set.
trapThread: trap by extension agent 1.
trapThread: trap by extension agent 1.
trapThread: trap by extension agent 1.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
trapThread: event 1 set.
Service: serviceHandlerFunction(dwControl=1).
trapThread: event 0 set.
trapThread: agentTrapThread exiting.
Term: agentTrapThread returned.
Term: comm thread in safe state for termination.
Term: agentCommThread terminated.
Service: Ending execution.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt clever debugging tips<BR>
Keywords            : kbnetwork NTSrv nttcp<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
