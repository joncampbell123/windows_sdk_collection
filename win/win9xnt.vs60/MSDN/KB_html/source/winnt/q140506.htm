

<HTML>
<HEAD>
<TITLE>Print Jobs Sent to SFM Printer Hang in Spooler After Printing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140506">
<META NAME="KBModify" CONTENT="1997/05/19">
<META NAME="KBCreate" CONTENT="1995/11/30">
<META NAME="Keywords" CONTENT="kbfix3.51.sp4 kbprint ntmac ntprint NTSrv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Print jobs sent to Services for Macintosh (SFM) AppleTalk-attached printers may be held in the queue for up to ten minutes after they have printed out before the job is deleted and the next job can be printed. After printing, Print Manager displays...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAGI,QDO9,QAH6,QACT,QAH7,QAD7,QDO3,QBT0,QAJ6,QDJO,QATK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Print Jobs Sent to SFM Printer Hang in Spooler After Printing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140506</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Print jobs sent to Services for Macintosh (SFM) AppleTalk-attached printers
may be held in the queue for up to ten minutes after they have printed out
before the job is deleted and the next job can be printed. After printing,
Print Manager displays the job with a size of zero bytes.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the Services for Macintosh (SFM) print monitor finishes sending data
to a printer, it follows with a printer access protocol (PAP) message with
the end of file (eof) flag set. Most printers will respond with a PAP eof,
but some Apple LaserWriters (e.g. Apple LW 16/xxx) will respond to a PAP
EOF with an AppleTalk Transaction Protocol (ATP) release.
<P>
This causes the SFM print monitor to wait for the timer to expire. The
timer was hard-coded to 10 minutes in 3.51. Thus the print queues were
waiting 10 minutes between print jobs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The timer value has been changed to 30 seconds in Widows NT Service Pack 4,
which should help in most instances.
<P>
For information on obtaining the Service Pack, query on the following word
in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
PAP eof is passed within an ATP request from machine to machine. The
AppleTalk stack then passes the PAP packet on to the SFM Print Monitor.
Since some printers do not respond with a PAP eof, but instead an ATP
release, the AppleTalk stack processes the packet as an ATP request. Since
the packet does not contain additional PAP information the request does not
get passed up to the higher protocol.
<P>
For additional information on AppleTalk printing, please see the following
Microsoft Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q152553.htm">Q152553</A></B> 
   TITLE     : Print Jobs from MAC OTI Clients May Hang in WinNT 
               Print Queue 
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt 3.51<BR>
Keywords            : kbfix3.51.sp4 kbprint ntmac ntprint NTSrv<BR>
Version             : 3.51<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
