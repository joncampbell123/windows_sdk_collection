

<HTML>
<HEAD>
<TITLE>REG: Device Driver Entries, PART 3--Mouse/Keyboard Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102990">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/08/12">
<META NAME="Keywords" CONTENT="kbprint ntprint ntregistry NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" NOTE: You can view current settings for these device drivers by choosing the Devices button in WinMSD.  Microsoft Serial Mouse Port Driver Entries  The value entries for the Microsoft serial mouse are found in this subkey:  HKEY_LOCAL_MACHINE\SYSTEM...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAU9,QAPN,QAW6,QDJP,QAKG,QAQ7,QBDT,QBBI,QABA,QABO,QAKD,QAKC,QBWP,QACK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>REG: Device Driver Entries, PART 3--Mouse/Keyboard Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102990</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Windows NT operating system version 3.1
<LI>Windows NT Advanced Server version 3.1
<P>
</UL>The article contains REGISTRY entries for Mouse and Keyboard Drivers. There
is a second half of this topic, found in the article Device Driver Entries
Part 3.
<P>
These subgroups are included:

<UL><LI>Microsoft Serial Mouse Port Driver
<LI>Mouse Class Driver
<LI>Keyboard Class Driver
<LI>Device Map Entries for the Keyboard and Mouse
<P>
</UL>There are 5 parts to the Device Driver Entries article series:
<P>
Part 1: Device Driver Entries, containing:

<UL><LI>File System Drivers and Recognizers
<LI>Disk, Serial and Parallel Ports
<P>
</UL>Part 2: Mouse and Keyboard Entries, containing:

<UL><LI>Microsoft Bus Mouse Port Driver
<LI>Intel 8042 Port Driver
<LI>Microsoft InPort Bus Mouse Port Driver
<P>
</UL>Part 3: Mouse and Keyboard Entries, cont'd
<P>
Part 4: SCSI Miniport Entries
<P>
Part 5: Sound Card and Video Device Driver Entries
<P>
 
<P>
NOTE: You can view current settings for these device drivers by choosing
the Devices button in WinMSD.
<P>
<P><h2>Microsoft Serial Mouse Port Driver Entries</h2>
 
<P>
The value entries for the Microsoft serial mouse are found in this subkey:
<P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Sermouse\Parameters
<P>
<PRE>MouseDataQueueSize     REG_DWORD     &gt;= 0x1
</PRE>Specifies the number of mouse events to be buffered internally by the
driver, in nonpaged pool. The allocated size, in bytes, of the internal
buffer is this value times the size of the MOUSE_INPUT_DATA structure
(defined in NTDDMOU.H). Consider increasing the size if the System log in
Event Viewer contains the following message from the Sermouse source: "The
ring buffer that stores incoming mouse data has overflowed (buffer size is
configurable via the Registry)."
Default: 0x64 (100)
<P>
<PRE>NumberOfButtons     REG_DWORD     &gt;= 0x1
</PRE>Specifies the number of buttons on the serial mouse. If the number of
buttons detected at startup time and placed in the Registry is incorrect,
this value can be used to override it.
Default: 0x2
<P>
<PRE>OverrideHardwareBitstring     REG_DWORD     0x1 or 0x2
</PRE>This entry is not usually present. When present, it specifies that
regardless of whether it was actually detected, a serial mouse is present
on the system. Add this value to tell the driver to assume the serial mouse
is on COM1 (specified by the value 0x1) or COM2 (specified by the value
0x2). This entry is useful if the serial mouse has not been automatically
detected.
<P>
<PRE>PointerDeviceBaseName     REG_SZ     Base port device name
</PRE>Specifies the base name for the device object(s) created by the serial
mouse device driver. The device driver also writes information about the
device objects into HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap so that the
pointer class driver can locate the pointer port device objects.
Default: PointerPort
<P>
<PRE>SampleRate     REG_DWORD     Mouse sample rate in Hz
</PRE>Specifies the sample rate for the serial mouse. Intended for future use.
This value might have no effect in the first release of Windows NT.
Default: 0x28 (1200 baud)
<P>
<P><h2>Mouse Class Driver Entries</h2>
 
<P>
The value entries for the mouse class driver are found in this subkey:
<P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Mouclass\Parameters
<P>
<PRE>ConnectMultiplePorts     REG_DWORD     0x0 or 0x1
</PRE>Specifies the type of connection between class and port device objects.
This parameter is mainly of interest to device driver writers.
<P>
The value 0x0 specifies a 1:1 relationship between class device objects and
port device objects. (That is, one class device object is created by the
driver and connected to one port device object; the maximum number of
objects created and connected to an associated port object is determined by
the value of MaximumPortsServiced.) The value 0x1 specifies a 1:many
relationship between a single class device object and multiple port device
objects. (That is, one class device object is created by the driver and
then connected to multiple port device objects, up to a maximum specified
by MaximumPortsServiced.)
Default: 0x1 (The events generated by up to the MaximumPortsServiced number
of pointing devices on the system will all be fed to the Windows subsystem
in a single input stream.)
<P>
<PRE>MaximumPortsServiced     REG_DWORD     &gt;= 0x1
</PRE>Specifies the number of port devices the mouse class device driver will
connect to and service. The class device driver handles hardware-
independent operations on a specific class of devices (in this case, the
mouse and other pointing devices). The port drivers manage the hardware-
specific operations.
Default: 0x3 (The class driver will service up to three pointing devices.)
<P>
<PRE>MouseDataQueueSize     REG_DWORD     &gt;= 0x1
</PRE>Specifies the number of mouse events to be buffered internally by the
driver, in nonpaged pool. The allocated size, in bytes, of the internal
buffer is this value times the size of the MOUSE_INPUT_DATA structure
(defined in NTDDMOU.H). Consider increasing the size if the System log in
Event Viewer frequently contains the following message from the Mouclass
source: "The ring buffer that stores incoming mouse data has overflowed
(buffer size is configurable via the Registry)."
Default: 0x64 (100)
<P>
<PRE>PointerDeviceBaseName     REG_SZ     Base class device name
</PRE>Specifies the base name for the device object(s) created by the mouse class
device driver. The device driver also writes information about the device
object into HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap so that the pointer class
device object(s) can be easily located.
Default: PointerClass
<P>
<P><h2>Keyboard Class Driver Entries</h2>
 
<P>
The value entries for the keyboard class driver are found in the following
subkey:
<P>
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Kbdclass\Parameters
<P>
<PRE>ConnectMultiplePorts     REG_DWORD     0x0 or 0x1
</PRE>Specifies the type of connection between class and port device objects.
This parameter is mainly of interest to device driver writers.
<P>
The value 0x0 specifies a 1:1 relationship between class device objects and
port device objects. (That is, one class device object is created by the
driver and connected to one port device object; the maximum number of
objects created and connected to an associated port object is determined by
the value of MaximumPortsServiced.) The value 0x1 specifies a 1:many
relationship between a single class device object and multiple port device
objects (That is, one class device object is created by the driver and then
connected to multiple port device objects, up to a maximum specified by
MaximumPortsServiced.)
Default: 0x0 (The events generated by up to the MaximumPortsServiced number
of keyboard devices on the system will feed separate input streams. In the
first release of Windows NT, the Windows subsystem only reads from a single
keyboard input stream.)
<P>
<PRE>KeyboardDataQueueSize     REG_DWORD     &gt;= 0x1
</PRE>Specifies the number of keyboard events to be buffered internally by the
driver, in nonpaged pool. The allocated size, in bytes, of the internal
buffer is this value times the size of the KEYBOARD_INPUT_DATA structure
(defined in NTDDKBD.H). Consider increasing the size if the System log in
Event Viewer contains the following message from the Kbdclass source: "The
ring buffer that stores incoming keyboard data has overflowed (buffer size
is configurable via the Registry)."
Default: 0x64 (100)
<P>
<PRE>KeyboardDeviceBaseName     REG_SZ     Base class device name
</PRE>Specifies the base name for the keyboard device object(s) created by the
keyboard class device driver. The device driver also writes information
about the device objects into HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap so that
the keyboard class device objects are easily located.
Default: KeyboardClass
<P>
<PRE>MaximumPortsServiced     REG_DWORD     &gt;= 0x1
</PRE>Specifies the number of port devices the keyboard class device driver will
connect to and service. The class device driver handles hardware-
independent operations on a specific class of devices (in this case,
keyboard devices). The port drivers manage the hardware-specific
operations.
Default: 0x3 (The class driver will service up to three keyboard devices.)
<P>
DeviceMap Entries for the Keyboard and Mouse The following DeviceMap
descriptions are for informational purposes only, since the DeviceMap
subkeys are volatile and are recreated each time you start Windows NT.
Administrators cannot modify DeviceMap entries.
<P>
These DeviceMap entries are used by the Windows subsystem to locate the
pointer and keyboard class devices, and by the pointer and keyboard class
drivers to locate the associated pointer and keyboard port devices.
Information is placed in the DeviceMap subkey by the keyboard and pointer
class and port drivers.
<P>
The format for each of these entries is:
<P>
Name of class device object : REG_SZ : Registry path to driver’s Services
<P>
The keyboard class information appears in the Registry path:
<P>
HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap\KeyboardClass
<P>
There can be one or more of these entries. Each entry specifies the name of
a device object created by the keyboard class driver to represent the class
device, followed by the Registry path to the driver’s Services subkey.
Default:
<P>
\Device\KeyboardClass0 : REG_SZ :
\Registry\Machine\System\ControlSet001\Services\Kbdclass
<P>
The keyboard port information appears in the Registry path:
<P>
HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap\KeyboardPort
<P>
There can be one or more of these entries. Each entry specifies the name of
a device object created by the keyboard port driver(s) to represent the
physical keyboard (port) device, followed by the Registry path to the
driver’s Services subkey.
Default:
<P>
\Device\KeyboardPort0 : REG_SZ :
\Registry\Machine\System\ControlSet001\Services\i8042prt
<P>
The mouse class information appears in the Registry path:
<P>
HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap\PointerClass
<P>
There can be one or more of these entries. Each entry specifies the name of
a device object created by the pointer (mouse) class driver to represent
the class device, followed by the Registry path to the driver’s Services
subkey.
Default:
<P>
\Device\PointerClass0 : REG_SZ :
\Registry\Machine\System\ControlSet001\Services\Mouclass
<P>
The mouse port information appears in the Registry path:
<P>
HKEY_LOCAL_MACHINE\HARDWARE\DeviceMap\PointerPort
<P>
There can be one or more of these entries. Each entry specifies the name of
a device object created by the pointer port driver(s) to represent the
physical pointing (port) device, followed by the Registry path to the
driver’s Services subkey.
Default (assumes mouse port, Microsoft InPort, and serial pointing devices
are connected):
<P>
\Device\PointerPort0 : REG_SZ :
<PRE>     \Registry\Machine\System\ControlSet001\Services\i804

</PRE>2prt\Device\PointerPort1 : REG_SZ :
<PRE>     \Registry\Machine\System\ControlSet001\Services\Inport

</PRE>\Device\PointerPort2 : REG_SZ :
<PRE>     \Registry\Machine\System\ControlSet001\Services\Sermouse


</PRE>Reference: "The Windows NT Resource Kit for Operating System Version 3.1".
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbprint ntprint ntregistry NTSrvWkst<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
