

<HTML>
<HEAD>
<TITLE>How to Log On to a Windows NT Domain Using a PPTP Connection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176575">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/11/11">
<META NAME="Keywords" CONTENT="NTPROTOCOL NTRAS kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QBWP,QA9A,QBWS,QAVZ,QBW7,QBXB,QDLU,QDJ0,QDJI,QBG2,QBSO,QBW3,QBWB,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Log On to a Windows NT Domain Using a PPTP Connection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176575</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it
if a problem occurs. For information about how to do this, view the
"Restoring the Registry" Help topic in Regedit.exe or the "Restoring a
Registry Key" Help topic in Regedt32.exe.
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to configure your computer to use the Point-to-
Point Tunneling Protocol (PPTP) to connect and log on to your Windows NT
domain through a connection to your Internet service provider (ISP).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you establish a Dial-Up Networking (DUN) connection using PPTP, you
are required to provide a valid Windows NT user name and password.
However, when you provide this user name and password you are not
automatically logged on to the Windows NT domain. If you are not logged
on to the Windows NT domain, you may not have access to some network
resources. For example, you may be prompted to provide a user name and
password when you attempt to access a network resource. In addition, your
logon script is not processed when you establish the PPTP connection.
<P>
To log on to your Windows NT domain using PPTP, you must log on to the
domain after establishing the PPTP connection. To do so, use the
appropriate method:
<P>
NOTE: These procedures assume all of the following conditions exist:

<UL><LI>You have created a Dial-Up Networking phone book entry to connect
   to your ISP.

<LI>You have created a Dial-Up Networking phone book entry to connect
   to your PPTP server.

<LI>Your computer has a valid machine account on the Windows NT domain.
<P>
</UL>For additional information about configuring PPTP, see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q161410.htm">Q161410</A></B>
   TITLE     : How to Set Up a Private Network Over the Internet Using
               PPTP

   ARTICLE-ID: <B><A href="../winnt/q172227.htm">Q172227</A></B>
   TITLE     : Network Address Translators Can Block Netlogon Traffic


</PRE><h3>If Your Computer Has Not Joined the Windows NT Domain</h3>
 

<OL><P><LI>Log on to your computer using a local user account with administrator
   rights.

<P><LI>Configure your registry so that DUN connections are preserved after
   you log off. To do so, use the following steps.
<P>
   WARNING: Using Registry Editor incorrectly can cause serious problems
   that may require you to reinstall your operating system. Microsoft
   cannot guarantee that problems resulting from the incorrect use of
   Registry Editor can be solved. Use Registry Editor at your own risk.
<P>
   For information about how to edit the registry, view the "Changing Keys
   And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and
   Delete Information in the Registry" and "Edit Registry Data" Help
   topics in Regedt32.exe. Note that you should back up the registry
   before you edit it.
<P>
   a. Add a new string value named KeepRasConnections to the following
<P><PRE>      registry key:
</PRE><P>
<PRE>         HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon

   b. Set the string value for KeepRasConnections to 1.

</PRE><P><LI>Use Dial-Up Networking to connect to your ISP.

<P><LI>Use Dial-Up Networking to connect to your PPTP server.

<P><LI>Click Start, point to Settings, click Control Panel, and then
   double-click Network.

<P><LI>On the Identification tab, click Change, click Domain, type your
   Windows NT domain name in the Domain box, and then click OK.

<P><LI>If you receive a "Welcome" message from the domain, click OK.

<P><LI>Click Close.

<P><LI>When you are prompted to restart your computer, click Yes.

<P><LI>Log on to your computer using a local user account with administrator
   rights.

<P><LI>Use Dial-Up Networking to connect to your ISP.

<P><LI>Click Start, click Shut Down, click "Close all programs and log on as
   a different user," and then click OK. The Dial-Up Networking connection
   to your ISP should remain connected.

<P><LI>When you are prompted, press CTRL+ALT+DELETE to log on.

<P><LI>Type your domain user name and password. In the Domain box, click the
   name of your Windows NT domain. Click the Logon Using Dial-Up
   Networking check box to select it, and then click OK.

<P><LI>In the Phone Book Entry To Dial box, click the phone book entry that
   you use to connect to your PPTP server, and then click Dial. Confirm
   your user name, password, and domain, and then click OK.
<P>
</OL><h3>If Your Computer Has Already Joined the Windows NT Domain</h3>
 

<OL><P><LI>Log on to your computer using a local account with administrator
   rights.

<P><LI>Configure your registry so that DUN connections are preserved after
   you log off. To do so, follow these steps:
<P>
   WARNING: Using Registry Editor incorrectly can cause serious problems
   that may require you to reinstall your operating system. Microsoft
   cannot guarantee that problems resulting from the incorrect use of
   Registry Editor can be solved. Use Registry Editor at your own risk.
<P>
   For information about how to edit the registry, view the "Changing Keys
   And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and
   Delete Information in the Registry" and "Edit Registry Data" Help
   topics in Regedt32.exe. Note that you should back up the registry
   before you edit it.
<P>
   a. Add a new string value named KeepRasConnections to the following
<P><PRE>      registry key:
</PRE><P>
<PRE>         HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon

   b. Set the string value for KeepRasConnections to 1.

</PRE><P><LI>Use Dial-Up Networking to connect to your ISP.

<P><LI>Click Start, click Shut Down, click "Close all programs and log on as
   a different user," and then click OK. The Dial-Up Networking connection
   to your ISP should remain connected.

<P><LI>When you are prompted, press CTRL+ALT+DELETE to log on.

<P><LI>Type your domain user name and password. In the Domain box, click the
   name of your Windows NT domain. Click the Logon Using Dial-Up
   Networking check box to select it, and then click OK.

<P><LI>In the Phone Book Entry To Dial box, click the phone book entry that
   you use to connect to your PPTP server, and then click Dial. Confirm
   your user name, password, and domain, and then click OK.
<P>
<P>
<P>
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: login RAS 4.00<BR>
Keywords          : NTPROTOCOL NTRAS kbnetwork<BR>
Version           : WINNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
