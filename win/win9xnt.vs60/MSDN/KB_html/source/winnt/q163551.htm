

<HTML>
<HEAD>
<TITLE>Troubleshooting Printing Problems in Windows NT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163551">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1997/02/12">
<META NAME="Keywords" CONTENT="ntprint kbfaq kbprint kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article describes how to troubleshoot printing problems in Windows NT 4.0.  MORE INFORMATION  Printing to a Local Device  1. Verify that you can print from a command prompt.     Non-PostScript Printer:     Type  dir &gt; lpt1  (without quotation ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBWP,QACT,QABI,QAKG,QDJP,QBVV,QANE,QAVZ,QADF,QBWD,QABH,QAY2,QAI5,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Printing Problems in Windows NT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163551</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to troubleshoot printing problems in Windows NT
4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Printing to a Local Device</h3>
 

<OL><P><LI>Verify that you can print from a command prompt.
<P>
   Non-PostScript Printer:
<P>
   Type "dir &gt; lpt1" (without quotation marks) at a command prompt.
<P>
   PostScript Printer:
<P>
   For information about printing from a command prompt to a PostScript
   printer, see the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q64859.htm">Q64859</A></B>
<PRE></PRE>      TITLE     : Testing the Connection to a PostScript Printer

   Plotter:

   See the following Web site:

   <B>http://hpcc923.external.hp.com/cposupport/plotters/support_doc/</B>
   bpp02064.html

   This tests to determine whether the parallel port driver and the
   hardware are working correctly. If you do not receive any output, get
   garbled output, or receive an "Unable to write to port" message, check
   the following hardware issues:

    - Check the cable and see if it meets the IEEE 1284 specification. If
      it does, it is marked on the cable itself.

    - Remove any switch boxes.

    - Perform a self test on the printer. If it prints correctly, the
      issue is with Windows NT or the program.

   NOTE: Printing from a command prompt does not work if the printer is a
   PostScript Printer.

</PRE><P><LI>Try printing from WordPad or Notepad.
<P>
   This tests the printer driver. If it prints correctly, the problem lies
   with the program. However, this does not mean that Windows NT is not
   involved. Windows NT may not be running a particular printing command
   that the program requires. See the "Program" section of this article.
<P>
   If it does not print correctly, the problem may be in the printer
   driver. Try the following items:
<P>
<P><PRE>    - If it is a PostScript printer, load the Apple LaserWriter NT driver.
      This is a very basic PostScript driver and using it will determine
      whether the problem is related to the particular PPD file for the
      printer.
</PRE><P>
<P><PRE>    - If the printer is non-PostScript, load the Generic/Text Only printer
      driver. This is a very basic driver and using it will determine
      whether the basic printing stack is working properly.
</PRE><P>
<P><PRE>    - If it is a plotter, load the Hewlett-Packard HP-GL/2 Plotter driver.
</PRE><P>
   If the device does not print with the basic drivers, see the "Printing
   Stack" section of this article. If it does print, see the "Program"
   section.
<P>
</OL><h3>Printing to a Network Device</h3>
 

<OL><P><LI>Verify basic network connectivity.
<P>
   Check user rights, protocols, share names, and so on to determine if
   you can see the server. Copy files to a share on the print server using
   File Manager in Windows NT 3.x or Windows NT Explorer in Windows NT
   4.0. If you cannot access the server, you may not be able to access the
   printer.

<P><LI>Create a local printer and redirect the port to the network server.
<P>
   Create a local printer and in the Ports section, create a new port.
   Click Local, and type the server and printer name for the printer (use
   the \\servername\printername syntax). Use this port for the local
   printer. This determines whether there is a problem with the copying of
   files from the server to the workstation that occurs when you use a
   Connect To setup or click Network Printer in the Add Printer Wizard.

<P><LI>Printing from an MS-DOS-based program.
<P>
   Make sure that the NET USE command has been run to map the LPT port to
   the network share. If it has, delete it and re-map the port. If it then
   works, there may be an issue with ghosted connections. A command may
   need to be run in the login script to remap the port each time you log
   on.
<P>
   If it is still not printing, try typing "dir &gt; LPT&lt;x&gt;" (without
   quotation marks) where &lt;x&gt; is the number of the port being mapped. If
   it still does not print, double-check the networking.
<P>
   NOTE: Printing from MS-DOS-based programs does not work if the printer
   is a Postscript Printer.

<P><LI>If you are using LPR or printing to a JetDirect card using the TCP/IP
   protocol, try these items:
<P>
<P><PRE>    - Ping the IP address. If it fails, check the network connectivity and
      verify IP addresses.
</PRE><P>
<P><PRE>    - Create an LPR port to the printer and then create a local printer
      connected to that port. This is the recommended way to connect to a
      JetDirect printer. Sharing this printer on the network allows the
      computer to act as a print queue for the JetDirect printer.
</PRE><P>
   For additional information, please see the following articles in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../winnt/q124735.htm">Q124735</A></B>
<PRE></PRE>      TITLE     : How Windows NT LPD Server Implements LPR Control
                  Characters

      ARTICLE-ID: <B><A href="../winnt/q124734.htm">Q124734</A></B>
      TITLE     : Text of RFC1179 Standard for Windows NT TCP/IP Printing

</PRE><P><LI>Determine whether you can print locally.
<P>
   If possible, try printing locally. This determines whether it is a
   network or computer-specific problem. Also see the "Program" and "Print
   Stack" sections of this article.
<P>
</OL><h3>Program</h3>
 

<OL><P><LI>Use a simpler file.
<P>
   Try creating a new document with less information in it. This
   determines if it is the program, or something in the document that is
   causing the problem.

<P><LI>Check the available disk space on the system drive.
<P>
   If there is not enough room to spool the job, larger jobs might fail
   where smaller jobs do not.

<P><LI>Try to print from another operating system.
<P>
   If possible, test with another operating system (such as Microsoft
   Windows 95). If it prints correctly, the problem is related to the
   output file.
<P>
</OL><h3>Printing Stack</h3>
 

<OL><P><LI>Verify that the Winprint.dll file is present. For information about how
   to do so, see the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../winnt/q105247.htm">Q105247</A></B>
<PRE></PRE>      TITLE     : Err Msg: There are no Print Processors... Creating a
                  Printer

</PRE><P><LI>Refresh all the printer files. To do so, remove all printers from the
   Printers folder, delete all the files from the Winnt\System32\Spool
   \Drivers\W32x86 folder, and then reinstall the printers.
<P>
   For additional information, please see the following article in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../winnt/q135406.htm">Q135406</A></B>
<PRE></PRE>      TITLE     : Steps to Manually Remove and Reinstall a Printer Driver

   NOTE: If you are using a Service Pack, reinstall the Service Pack
   before reinstalling the printers.

</PRE><P><LI>Check the available space on the hard disk. If there is not enough room
   to spool the job, print jobs may fail.
<P>
</OL><h3>DEC Printserver and DEC Print Monitor</h3>
 
<P>
The Digital Electronics Corporation (DEC) Printserver is a printer with an
Ethernet card installed. It can be accessed with the TCP/IP or DECnet
protocol. DECnet is available only from DEC.
<P>
When the Printserver printer is first turned on, it does not have a TCP/IP
address assigned to it. The Windows NT DEC Print Monitor assigns the IP
address to the Printserver printer by downloading the software and
configuration to the hardware (MAC) address of the Ethernet adapter in the
Printserver.
<P>
For more information about how to set this up, click Help in the Add New
Port section of Print Manager. In Windows NT 4.0, see the Readme.txt file
in the Drvlib\Print\Decmon folder on the Windows NT CD-ROM.
<P>
<P><h3>AutoCAD 13</h3>
 
<P>
If AutoCAD is not correctly configured to print, you may receive the
following error message:
<P>
<PRE>   The system is unable to set port parameters.

</PRE></OL>There is a White Paper on Autodesk's World Wide Web site that describes
how to configure AutoCAD 13 to print correctly in Windows NT. See the
following Web site:
<P>
<PRE>   <B>http://pilot1.autodesk.com/support/techdocs/td13/td130759.htm</B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 prodnt tshoot<BR>
Keywords          : ntprint kbfaq kbprint kbtshoot<BR>
Version           : 4.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
