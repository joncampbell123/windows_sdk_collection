

<HTML>
<HEAD>
<TITLE>Creating a NetDDE Link in Excel on NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128491">
<META NAME="KBModify" CONTENT="1997/04/04">
<META NAME="KBCreate" CONTENT="1995/04/02">
<META NAME="Keywords" CONTENT="kbinterop ntinterop">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Because of changes in the Clip Book format and OLE, Clipbook can no longer be used to create Network DDE Links between Excel Worksheets. This article provides step by step instructions for creating Network DDE Links for Excel using the Network DDE ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAZ2,QA3A,QBWP,QAVZ,QDMF,QAUJ,QAE2,QBXS,QA0K,QAUD,QBWS,QASR,QAJH,QDO5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Creating a NetDDE Link in Excel on NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128491</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Because of changes in the Clip Book format and OLE, Clipbook can no longer
be used to create Network DDE Links between Excel Worksheets. This article
provides step by step instructions for creating Network DDE Links for Excel
using the Network DDE Share Manager.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A Network DDE Link consists of two parts; the DDE server application and
the DDE client application. The DDE server application contains the data to
be shared. The DDE client requests the data from the DDE server, thus
creating a DDE Link. Network DDE requires the server application to make
the data accessible on the network. The server Application creates a
Network DDE share, available over the network, which the client application
can connect to.
<P>
In Windows NT 3.1, Clipbook could be used to create the Network DDE share.
In version Windows NT 3.5, because of changes to the ClipBook and OLE, the
ClipBook can no longer be used to create Network DDE Links for Excel
worksheets.
<P>
To create a Network DDE link under Windows NT 3.5:

<OL><P><LI>Use DDE Share Manager (%SYSTEMROOT%\SYSTEM32\DDESHARE.EXE) to create a
   share on the DDE server:
<P>
   a. Select Add a Share in the SHARES.DDESHARES menu.
<P>
   b. Enter a share name. The share must end with a dollar sign ($),
<P><PRE>      for example SalesData$.
</PRE><P>
<P><PRE>      NOTE: This share is not a directory. You cannot see it in File
      Manager.
</PRE><P>
   c. Under Application Name, enter the following:
<P>
<P><PRE>      Old Style:  Excel
      New Style:  Excel.Sheet.5
      Static:
</PRE><P>
<P><PRE>      NOTE: Leave Static blank.
</PRE><P>
   d.  Under Topic Name, enter the following:
<P>
<PRE>      Old Style:  [SALES.XLS]Sheet1   - This is the File Name and the
                                        Worksheet name
      New Style:  SALES.XLS           - This is the File Name
      Static:

      NOTE: Leave Static blank.

   e. Select Allow Start Application.

   f. Choose Permissions and then set permissions for the share the same
      way you would set permissions on files using File Manager.

   g. Choose OK.

   h. Select the share you just created and choose Trust Share.

   i. Choose Set and then choose OK.

</PRE><P><LI>Launch Excel on the server and create or open a workbook named
   "SALES.XLS," with a sheet named "Sheet1." It does not matter what
   directory SALES.XLS is saved to. Enter something into cell A1 (it
   does not matter what you enter).

<P><LI>Create a link to the share that you just created.
<P>
   This example uses the share name SalesData$ and the DDE server machine
   \\MARLEY. The workbook name is SALES.XLS and the data to be linked is
   in SHEET1, column 1, row 1.
<P>
   a. At the DDE client machine, run Excel.
<P>
   b. Enter the following command into the first cell:
<P>
<PRE>         ='\\MARLEY\NDDE$'|'SalesData$.OLE'!'Sheet1!R1C1'

   NOTE: You may be prompted for a password. If so, enter a valid user
   account and password which exists in the DDE server's domain or a
   trusted domain.

</PRE><P><LI>The linked data should appear in the cell when you press enter.
   If the cell shows "N/A", choose Links from the Edit menu. The link
   should be listed as follows:
<P>
<P><PRE>      Source File:  SalesData$.OLE
<PRE></PRE>      Item:         Sheet1!R1C1
      Type:         \\MARLEY\NDDE$
      Status:       Automatic

   To update the link, select "Update Now". The link should activate and
   the data should be linked to the client workbook.

</PRE></OL>NOTE: With Excel 97, use "Excel.Sheet.8" for the New Style Application
name. Also, with Excel versions 7.0, 7.0a, and Excel 97, check "Start
Application Enable" and "Initiate to Application Enable" check boxes in
the Trusted Share Properties dialog box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbinterop ntinterop<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
