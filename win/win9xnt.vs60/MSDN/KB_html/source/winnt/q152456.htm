

<HTML>
<HEAD>
<TITLE>Automating SMC Adapter Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152456">
<META NAME="KBModify" CONTENT="1997/03/24">
<META NAME="KBCreate" CONTENT="1996/06/14">
<META NAME="Keywords" CONTENT="kbbug3.50 kbbug3.51 kbsetup ntreskit ntsetup NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Unattended Setup and Computer Profile Setup (CPS) fail to install the SMC 9332 EtherPower 10/100 PCI Fast Ethernet Adapter.  Following the instructions on  Profiling systems with OEM netcards  in the Cpsread.txt file in the Windows NT version 3.5 R...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QDIZ,QBKX,QBS8,QBXB,QAY2,QATJ,QAR4,QDNL,QAKP,QAFI,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automating SMC Adapter Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152456</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft Windows NT Resource Kit versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Unattended Setup and Computer Profile Setup (CPS) fail to install the SMC
9332 EtherPower 10/100 PCI Fast Ethernet Adapter.
<P>
Following the instructions on "Profiling systems with OEM netcards" in the
Cpsread.txt file in the Windows NT version 3.5 Resource Kit or the Cps.hlp
file in the Windows NT version 3.51 Resource Kit is not sufficient.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Oemsetup.inf file for the SMC 9332 EtherPower10/100 PCI Fast Ethernet
Adapter is not designed to work with Unattended Setup or Computer Profile
Setup.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, follow the instructions for the kind of Setup you
are doing, either CPS or Unattended.
<P>
<P><h3>Computer Profile Setup</h3>
 

<OL><P><LI>Before you run Uplodprf.exe, modify Cps.ini as described in the
    following note, which is included in both the Cpsread.txt in the
    Windows  NT 3.5 Resource Kit and the Cps.hlp in the Windows NT 3.51
    Resource Kit:
<P>
<P>
      [Registry]
       FindInstalledServicesAt =
       SOFTWARE\Microsoft,SOFTWARE\StandardMicrosystemsCorporation

<P><LI>Run Uplodprf.exe.

<P><LI>After running Uplodprf.exe, on the Distribution System back up
    %Systemroot%\System32\Ntlanman.inf to Ntlanman.bak.
<P>
</OL>WARNING: Modification of Setup files can cause serious, system-wide
problems before and after Setup and may require you to reinstall Windows NT
to correct them. Microsoft cannot guarantee that any problems resulting
from the modification of Setup files can be solved. Make Setup file
modifications at your own risk.

<OL><P><LI>On the Distribution System modify %Systemroot%\System32\Ntlanman.inf:
<P>
   ; Original Line below with exclamation point
<PRE>   ;            set AdapterSrcDir = $(OEMNetDrive)
   ; Corrected syntax with exclamation point
                set AdapterSrcDir = $(!OEMNetDrive)

</PRE><P><LI>On the Distribution system, modify %Systemroot%\System32\Defaults.inf:
<P>
      [NetworkAdapterData]
      !AutoNetOption = SMC9332
      !OEMNetOption = YES
      !OEMNetDrive = C:\SMC\
      !OEMNetInfFile = C:\SMC\oemsetup.inf

<P><LI>On Distribution System, disable the Read-Only attribute on
    %Systemroot%\System32\Oemnad0.inf.

<P><LI>On the Target system, create a directory called SMC on the partition
    where Windows NT will be installed.

<P><LI>Copy the OEM files to the SMC directory created in the previous step.
    These OEM files may be located on the Windows NT compact disc in the
    \DRVLIB\NETCARD directory or may be available from the network card
    manufacturer.

<P><LI>Modify \SMC\Oemsetup.inf to avoid dialog boxes, as shown below in steps
    a and b.
<P>
</OL>WARNING: Modification of Setup files can cause serious, system-wide
problems before and after Setup and may require you to reinstall Windows NT
to correct them. Microsoft cannot guarantee that any problems resulting
from the modification of Setup files can be solved. Make Setup file
modifications at your own risk.
<P>
<PRE> a. First OEMSETUP.INF modification:

   installadapter = +
   ;; The below IF statement was added to avoid setup dialogs during
   CPS/Unattended Setup
   ifstr(i) $(!STF_GUI_UNATTENDED) == "YES"
      goto installproduct
   endif
   ;; The above IF statement was added to avoid setup dialogs during
   CPS/Unattended Setup

 b. Second Oemsetup.inf modification:

    The code fragment below can be found at the end of the installproduct
    section.

</PRE></OL>;; Below lines added to retrieve netcard parameters from answer file during
CPS/Unattended Setup
ifstr(i) $(!STF_GUI_UNATTENDED) == "YES"
<PRE>       Shell $(UtilityInf),AddDefaultNetCardParameters,$(HardParameterKey)
</PRE>endif
;; Above lines added to retrieve netcard parameters from answer file during
CPS/Unattended Setup
<P>
<PRE>         CloseRegKey $(HardNetCardKey)
         CloseRegKey $(HardNetRuleKey)
         CloseRegKey $(HardParameterKey)

    EndForListDo
    EndWait
    goto successful
</PRE>updateparameters =+
<P>
NOTE: Similar modifications should work for the SMC 8432 and 8434 Ethernet
adapters.

<OL><P><LI>Run Winntp.exe
<P>
</OL>For more information, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q143134.htm">Q143134</A></B>
   TITLE     : OEMSETUP.INF Modifications for Automated Windows NT Setup

   ARTICLE-ID: <B><A href="../winnt/q139897.htm">Q139897</A></B>
   TITLE     : Automating Intel EtherExpress Pro Setup

</PRE></OL>You can also refer to the "Programmer's Guide" included in the Windows NT
Device Driver Kit (DDK), or contact Microsoft Consulting Services or a
Microsoft Solution Provider. Microsoft Product Support Services, Corporate
Network Systems, does not support the modification of Oemsetup.inf files.
It is recommended that you perform a test run of Winntp.exe to verify
whether your Oemsetup.inf file supports Unattended or Computer Profile
Setup.
<P>
<P><h3>Unattended Setup</h3>
 

<OL><P><LI>Copy the \I386 directory from the Windows NT compact disc to your hard
   disk drive.

<P><LI>Expand I386\Ntlanman.in_ to Ntlanman.inf. The Expand.exe file is located
   in the %SystemRoot%\System32 directory.

<P><LI>Rename I386\Ntlanman.in_ to Ntlanman.bk_
<P>
</OL>WARNING: Modification of Setup files can cause serious, system-wide
problems before and after Setup and may require you to reinstall Windows NT
to correct them. Microsoft cannot guarantee that any problems resulting
from the modification of Setup files can be solved. Make Setup file
modifications at your own risk.

<OL><P><LI>Modify I386\Ntlanman.inf as follows:
<P>
   ; Original Line below with exclamation point
<PRE>   ;            set AdapterSrcDir = $(OEMNetDrive)
   ; Corrected syntax with exclamation point
                set AdapterSrcDir = $(!OEMNetDrive)

</PRE></OL>NOTE: It is not necessary to rename Ntlanman.inf to Ntlanman.in_. Windows
NT Setup does not require the file to be compressed or named with an .in_
extension.

<OL><P><LI>Modify the [NetworkAdapterData] section in your "Answer File" as
  follows:
<P>
<P><PRE>      [NetworkAdapterData]
      !AutoNetOption = SMC9332
      !OEMNetOption = YES
      !OEMNetDrive = C:\SMC\
      !OEMNetInfFile = C:\SMC\oemsetup.inf
</PRE>
<P><LI>Create a directory called SMC on the partition to which Windows NT will
   be installed.

<P><LI>Copy the OEM files to the SMC directory created in the previous step.
   These OEM files may be located on the Windows NT compact disc in the
   \DRVLIB\NETCARD directory or may be available from the network card
   manufacturer.

<P><LI>Modify \SMC\Oemsetup.inf to avoid dialog boxes as shown in Step 9 in the
   above Computer Profile Setup section.

<P><LI>Run Unattended Setup.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: automate<BR>
Keywords            : kbbug3.50 kbbug3.51 kbsetup ntreskit ntsetup NTSrvWkst<BR>
Version             : 3.5 3.51<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
