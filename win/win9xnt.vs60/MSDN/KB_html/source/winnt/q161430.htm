

<HTML>
<HEAD>
<TITLE>DHCP: Detecting and Flagging Duplicate IP Addresses </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161430">
<META NAME="KBModify" CONTENT="1997/12/22">
<META NAME="KBCreate" CONTENT="1996/12/21">
<META NAME="Keywords" CONTENT="NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Windows NT 4.0 Service Pack 2 (SP2) provides updated code to assist DHCP in detecting and flagging duplicate IP addresses. Functionality has been added both at the client and at the Windows NT DHCP server.  MORE INFORMATION  The following features ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QDJG,QBWP,QAFO,QAC2,QARL,QA5E,QAR5,QAD6,QAD5,QDO3,QBVV,QAY2,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DHCP: Detecting and Flagging Duplicate IP Addresses</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161430</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows NT 4.0 Service Pack 2 (SP2) provides updated code to assist DHCP
in detecting and flagging duplicate IP addresses. Functionality has been
added both at the client and at the Windows NT DHCP server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following features were added to Windows NT 4.0 in SP2 to assist in
detecting and working around duplicate IP addresses:

<UL><LI>The DHCP server has a new configurable option to allow the
   administrator to specify duplicate address detection. To enable this
   feature, run the DHCP Administrator, select a DHCP server, and select
   Server-&gt;Properties. There is a new "Conflict Detection Attempts"
   listbox that allows the server to be configured to attempt to ping each
   IP address before issuing a lease for it.
<P>
   NOTE: This functionality was added to aid in resolving duplicate IP
   address situations resulting from accidental mis-configurations. This
   feature was not intended as a mechanism to allow deployment of
   overlapping scopes and this type of deployment is not supported by
   Microsoft.
<P>
</UL>The number of pings is configurable, and after sending each ping the
server waits two seconds for a reply.  The time required for a client to
obtain a lease will be increased by (the number of pings selected) * 2, so
this value should be chosen carefully.  Normally, a setting of 1 or 2
should be adequate.
<P>
If the DHCP server receives a reply to any of the pings, it will mark the
IP address as a "BAD_ADDRESS" and will attempt to lease the next address
in the scope.  After the offending duplicate address is removed from the
network, the "BAD_ADDRESS" can be returned to the pool by deleting it from
the scope Active Leases dialogue box.
<P>
NOTE: The DHCP server only pings IP addresses that have not been
previously leased successfully.  If a client is being leased an IP address
that it already had, or is requesting a renewal, the DHCP server will not
issue any pings before sending the DHCP OFFER or DHCP ACK.

<UL><LI>Windows NT 4.0 SP2 clients now have support for issuing DHCP DECLINE
   messages. After the client receives a lease from the DHCP server, it
   will send an ARP for the IP address it has been assigned. If any other
   client replies to that ARP, the address is already in use. In this
   case, the client will issue a DHCP DECLINE to the DHCP server. The
   Windows NT 4.0 SP2 server will flag the IP address as a "BAD_ADDRESS"
   and the client will go through the lease process again, receiving the
   next available address in the scope.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dhcp duplicate IP address decline conflict dupe<BR>
Keywords          : NTSrvWkst nttcp kbnetwork<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
