

<HTML>
<HEAD>
<TITLE>Winsock App's Reject Connection Requests with Reset Frames </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113576">
<META NAME="KBModify" CONTENT="1997/11/12">
<META NAME="KBCreate" CONTENT="1994/04/07">
<META NAME="Keywords" CONTENT="kbbug3.10 NTSrvWkst nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" SYMPTOM  If a Windows NT TCP/IP Winsock server application (for example, Microsoft NT SQL Server) is bombarded with multiple simultaneous TCP\IP connection requests, it quickly begins to reject requests by replying with a TCP\IP Reset Frame.  The sy...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAGI,QBG2,QAI5,QDKF,QABN,QDNT,QBXS,QA3S,QAM4,QDO3,QAIB,QAIA,QAHS,QAHR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Winsock App's Reject Connection Requests with Reset Frames</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113576</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SYMPTOM</h2>
 
<P>
If a Windows NT TCP/IP Winsock server application (for example, Microsoft
NT SQL Server) is bombarded with multiple simultaneous TCP\IP connection
requests, it quickly begins to reject requests by replying with a TCP\IP
Reset Frame.
<P>
The symptom may be difficult to detect. If you trace this problem with a
protocol analyzer you will see that the 7th or 8th TCP SYN connection
request frames are replied to with TCP Reset bit set, which tells the
sending station that the frame was received but the server did not have
the resources to process the connection request.
<P>
This might show up as a delayed or slower connection. The client should
attempt the connection again after waiting for a timeout (so you don't
see an error) but this can slow the connection in certain types of systems.
<P>
<P><h2>CAUSE</h2>
 
<P>
A Winsock application accepts connections on a port by calling a Listen()
function, which has a Backlog parameter specifying the maximum length of
the pending-connection queue. The Winsock specification defines the maximum
Listen() backlog at 5 and when this is exceeded, TCP/IP issues a Reset.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In Windows NT 3.1 Service Pack 3 the backlog limit has been increased from
5 to 60, Socket applications now can accept 60 simultaneous connection
requests without issuing a reset.
<P>
In Windows NT 3.5x the backlog limit has been increased to 100. In Windows
NT Server version 4.0 the backlog limit has been increased to 200. In
Windows NT Workstation version 4.0 the backlog limit has been kept at the
Winsock specification of 5.
<P>
NOTE: This fix applies only to the MAXIMUM allowed Listen() Backlog.
Each Winsock application must request its own Listen() Backlog queue
length.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT and Windows NT
Advanced Server version 3.1. This problem has been corrected in the latest
U.S. Service Pack for Windows NT and Windows NT Advanced Server version
3.1. For information on obtaining the Service Pack, query on the following
word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>REFERENCES</h2>
 
<P>
The Winsock specification (available on
<B><A href="ftp://ftp.microsoft.com/bussys/winsock)">ftp://ftp.microsoft.com/bussys/winsock),</A></B> has more information about Winsock
and the listen() function. See Visual C++ documentation as well.
<P>
"Internetworking with TCP\IP" by Comer, has more information about TCP\IP
connections.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords          : kbbug3.10 NTSrvWkst nttcp kbnetwork<BR>
Version           : 3.1<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
