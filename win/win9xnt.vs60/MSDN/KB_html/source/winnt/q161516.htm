

<HTML>
<HEAD>
<TITLE>Troubleshooting Modem Problems Under Windows NT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161516">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1996/12/26">
<META NAME="Keywords" CONTENT="NTRAS NTSrvWkst kbhw kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article describes procedures to help you diagnose and fix problems when you are unable to dial out using your modem in Windows NT 4.0 with Dial-Up Networking (DUN).  MORE INFORMATION  Installing Your Modem  If your modem is not on the Windows ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJ9,QBWP,QABI,QBTX,QAS6,QDJP,QAKG,QAA1,QBWS,QBVV,QDI2,QDIZ,QABA,QBXS,QA7Y V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Modem Problems Under Windows NT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161516</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes procedures to help you diagnose and fix problems
when you are unable to dial out using your modem in Windows NT 4.0 with
Dial-Up Networking (DUN).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Installing Your Modem</h3>
 
<P>
If your modem is not on the Windows NT 4.0 Hardware Compatibility List
(HCL) or is not detected by Windows NT, use one of the following
procedures to install it:

<UL><LI>Obtain from the modem manufacturer an .inf file designed for Windows NT
   4.0. Follow the manufacturer's instructions for installing the modem in
   Windows NT 4.0. Contact the modem manufacturer for assistance with this
   procedure.

<LI>If your modem has an .inf file for Windows 95, you may be able to use
   that file under Windows NT. When you are adding the modem through
   Control Panel, Modems, check the box labeled, "Don't detect my modem; I
   will select it from a list." Choose the "Have Disk" option and insert
   the disk containing the Windows 95 .inf file. Please be aware that not
   all Windows 95 .inf files will work correctly in Windows NT 4.0.

<LI>Install your modem as a standard modem using the following steps:
<P>
   1. In Control Panel, double-click Modems. The Install New Modem Wizard
<P><PRE>      starts automatically if you have not installed a modem before. If
      the wizard does not start automatically, you have installed a modem
      previously and you should click Add to start the wizard.
</PRE><P>
   2. Check the box labeled "Don't detect my modem; I will select it from
<P><PRE>      a list," and then click Next.
</PRE><P>
   3. In the Manufacturers box, click Standard Modem Types. In the
<P><PRE>      Models box, click a model that corresponds to the speed of your
      modem, and then follow the instructions in the Install New Modem
      Wizard.
</PRE><P>
</UL><h3>Verify Your COM Port(s)</h3>
 
<P>
Verify that Windows NT recognizes your COM port(s) by double-clicking the
Ports icon in Control Panel to see if the COM port that the modem is
connected to is listed. If it is, Windows NT recognizes the COM port.
<P>
If the COM port is not recognized in the Control Panel Ports applet, there
is most likely a hardware problem or a configuration problem. Use the
following steps to troubleshoot the problem.

<UL><LI>External Modems
<P>
   1. If the COM port is on the motherboard or is provided by a serial
<P><PRE>      card, make sure the port is not disabled in the BIOS (also called
      the CMOS) setup of the computer. Refer to the documentation for your
      computer to obtain information about configuring options in the BIOS
      setup.
</PRE><P>
   2. Make sure there are no other adapters or devices that are configured
<P><PRE>      for the same Base I/O Address or IRQ as the COM port to which the
      modem is attached.
</PRE><P>
   3. Verify that the serial port is not defective. If the modem and any
<P><PRE>      other serial devices fail on the COM port but work on other COM
      ports, and you have verified the two steps above, the serial port
      may be defective.
</PRE><P>
   4. Verify the serial cable is not defective by using a new standard
<P><PRE>      serial cable.
</PRE>
<LI>Internal Modems
<P>
   1. If the COM port is defined by an internal modem, make sure the
<P><PRE>      jumpers on the modem are configured properly. Internal modems will
      almost always have a jumper on the adapter that configures the modem
      as a particular COM port. There may or may not be jumpers that allow
      you to set the Base I/O Address and IRQ to be used by the modem as
      well.
</PRE><P>
   2. If the modem is configured for a COM port number that is assigned to
<P><PRE>      a COM port on the motherboard or a serial card (physical port), you
      must either set the modem to use a different COM port, or use the
      BIOS setup to disable the COM port with the same number as the
      internal modem. For example, if both the internal modem and the
      physical COM port are set to COM1, you must either set the internal
      modem to a different, unused COM port, or the physical COM1 port
      must be disabled in the BIOS setup.
</PRE><P>
   3. Make sure there are no other adapters or devices that are configured
<P><PRE>      for the same Base I/O Address or IRQ as the internal modem. Usually
      COM3, using an IRQ (or interrupt) of 5, is a good choice for an
      internal modem. However, if you have a sound card, you may need to
      choose a different IRQ than 5 since many sound cards use that
      interrupt.
</PRE><P>
   4. In the Ports component of Control Panel, verify that the IRQ
<P><PRE>      settings and the I/O addresses are correct. Check the System log
      with the Event Viewer for I/O or IRQ conflict errors.
</PRE><P>
<P><PRE>      When possible, use standard settings for COM ports, which are as
      follows:
</PRE><P>
<PRE>         SERIAL 1   COM1:  I/O Address = 3F8h   IRQ = 4
         SERIAL 2   COM2:  I/O Address = 2F8h   IRQ = 3
         SERIAL 3   COM3:  I/O Address = 3E8h,  IRQ = 4
         SERIAL 4   COM4:  I/O Address = 2E8h,  IRQ = 3

   5. You do NOT need to add a new port in the Control Panel Ports applet
      to add support for an internal modem. NTDETECT will detect the
      internal modem and the COM port it is configured to use. If a
      duplicate port was added using the Add button in the Control Panel
      Ports applet, use the Delete button to remove the duplicate port.

   6. Verify that the internal modem is not defective. Also, it is often a
      good idea to check with the vendor of your modem to see if there is
      a flash upgrade available for your modem.

</PRE></UL><h3>Troubleshoot with HyperTerminal</h3>
 
<P>
Verify that Windows NT recognizes your modem and that you can dial out
using the HyperTerminal program. To do so, follow these steps:
<P>
NOTE: Before attempting to use HyperTerminal, verify that the Remote
Access Server service is not running. Double-click the Services icon
in Control Panel and verify that the Status column next to Remote
Access Server is blank. If it displays "Started," click the Stop button
to disable the Remote Access Server service before continuing.

<OL><P><LI>Click Start, point to Programs, point to Accessories, point to
   HyperTerminal, and then click HyperTerminal.

<P><LI>When the New Connection Wizard is displayed, click Cancel.

<P><LI>On the File menu, click Properties, and then click the modem you want
   to test to select it in the Connect Using list.

<P><LI>Click Configure, verify that your modem is set to use the correct port,
   and then click OK.

<P><LI>Type "AT" (without quotation marks) in the HyperTerminal window, and
   then press ENTER.

<P><LI>If "AT" (without quotation marks) is displayed in the HyperTerminal
   window as you type it and "OK" (without quotation marks) is displayed
   after you press ENTER, HyperTerminal recognizes the modem properly.
   If "AT" is not displayed as you type it or if "OK" is not displayed
   after you press ENTER, review the previous steps in this article to
   verify that your modem is installed properly in Windows NT.

<P><LI>Verify that your modem can dial out using HyperTerminal. On the File
   menu, click New Connection, and then follow the instructions on your
   screen.

<P><LI>Click Dial. If the modem's speaker is enabled, you should hear a dial
   tone and the sound of the modem dialing the phone number.
<P>
</OL>For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q131868.htm">Q131868</A></B>
   TITLE     : Troubleshooting PCMCIA Modems in Windows NT 3.51

   ARTICLE-ID: <B><A href="../winnt/q150808.htm">Q150808</A></B>
   TITLE     : Disabling Remote Access Support for Unimodem Modems
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 connecting ras dialin tshoot<BR>
Keywords          : NTRAS NTSrvWkst kbhw kbfaq<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>
Issue type        : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
