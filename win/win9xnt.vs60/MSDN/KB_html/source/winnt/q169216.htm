

<HTML>
<HEAD>
<TITLE>Using Winscl.exe to Remove Corrupt WINS Entries by Version ID </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169216">
<META NAME="KBModify" CONTENT="1998/02/23">
<META NAME="KBCreate" CONTENT="1997/05/28">
<META NAME="Keywords" CONTENT="nthowto ntnetserv ntreskit NTSrv nttcp kbnetwork kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="-   You can use the Winsdmp.exe and Winscl.exe Resource Kit utilities to remove corrupt entries from the Windows Internet Name Service (WINS) database.  This article explains how to use Winsdmp.exe to determine the version ID of the corrupt entries a...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QA5V,QBWD,QA4H,QDH6,QA9N,QANJ,QDKD,QAUJ,QAPF,QAKC,QAA1,QDMR,QBC6,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Winscl.exe to Remove Corrupt WINS Entries by Version ID</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169216</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use the Winsdmp.exe and Winscl.exe Resource Kit utilities to
remove corrupt entries from the Windows Internet Name Service (WINS)
database.
<P>
This article explains how to use Winsdmp.exe to determine the version ID
of the corrupt entries and how to use Winscl.exe to remove those entries.
<P>
In certain cases (such as when names contain extended characters or
spaces) it is necessary to remove entries based on their version ID,
rather than name (using the DN option). The DN option fails when you
attempt to remove these entries with extended characters or spaces. Also,
the DN option only removes single entries, and does not remove ranges of
entries.
<P>
NOTE: The WINS Server must be running when you use Winscl.exe to modify
the WINS database.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Run Winsdmp.exe to dump the WINS database.
<P>
   Example:
<P>
   WINSDMP 130.0.10.1 &gt; Winsdata.txt
<P>
   The following is an example line that information that WINSDMP
   provides:
<P>
<PRE>   130.10.10.10,"TEST           ",0,17,3,0,0,502,0,820870950,1,130.0.25.14

   The following table lists each item in the example above on the left
   side and the corresponding explanation for the example item on the
   right side:

      Example Item        Explanation for Example Item
      ------------        ----------------------------
      130.10.10.10        The IP address of the owner of the entry
      "TEST"              The NetBIOS name of the entry
      0                   The 16th character of the NetBIOS name
      17                  The number of characters in the name
                          (15 for NetBIOS name + 2 for ID)
      3                   Type of Record
      0                   State of Record
      0                   Version ID (High order)
      502                 Version ID (Low order)
      0                   Static Flag
      820870950           Time Stamp
      1                   Number of records in entry
      130.0.25.14         IP Addresses assigned to entry

   The possible Record Type values are defined as:

      UNIQUE        = 0
      NORMAL GROUP  = 1
      SPECIAL GROUP = 2
      MULTIHOMED    = 3

   The possible Record State values are defined as:

      ACTIVE    = 0
      RELEASED  = 1
      TOMBSTONE = 2

</PRE><P><LI>Use the data from the dump to compile a list of entries (or a range of
   entries) to be removed from the WINS database. Then use the Winscl.exe
   utility to delete the individual entry or the range of entries.
<P>
</OL>If you want to remove a range of consecutive entries, enter the minimum
and maximum versions when prompted by WINSCL. If you want to remove
multiple non-consecutive entries, they must be processed individually.
<P>
The example below uses low order bit of the version ID (which is 502 in
the earlier example) and the high order bit (which is 0 in the earlier
example) to remove a single WINS entry.
<P>
<PRE>Example: (with annotations in &lt;&lt;&lt;   &gt;&gt;&gt;)

</PRE></OL>Winscl.exe
<PRE>TCP/IP or named pipe. Enter 1 for TCP/IP – 1   &lt;&lt;&lt;enter 1 here&gt;&gt;&gt;
Address of Nameserver to contact--130.0.10.1   &lt;&lt;&lt;this is the IP address
</PRE>of the WINS server&gt;&gt;&gt;
RN-Register a name
QN-Query a name
DN-Delete a name
GV-Get the current vers. counter value
GM-Get the Owner Id to Max. Vers. No. mappings
GMO-Get the Owner Id to Max. Vers. No. mappings (3.5 WINS)
GST-Get WINS statistics
GSTO-Get WINS statistics (3.5 WINS)
PUSHT-Send a push trigger to another WINS
PULLT-Send a pull trigger to another WINS
SI-Statically initialize the WINS
CC-Initiate consistency check on the WINS - HIGH OVERHEAD OPERATION
SC-Initiate scavenging on the WINS
DRR-Delete all or a range of records
PRR-Pull all or a range of records from another WINS
GRBN-Get records by name
GRBV-Get Records by version numbers
BK-Backup the database
RS-Restore the db
RSO-Restore the db (created by a pre-SUR WINS)
RC-Reset WINS counters
CR-Count the number of recs. in the db
GI-Get Info about WINS
SDB-Search the db
GD-Get domain names
DW-Delete WINS records and info.
CW-Connect Wins
WA-Get Add of current Wins
ME-SHOW MENU
NOME-DONT SHOW MENU
EX-Terminate winscl
Command – DRR  &lt;&lt;&lt;this command deletes a record or range of records&gt;&gt;&gt;
<PRE>Address of Owner Wins -- 130.10.10.10   &lt;&lt;&lt;this is the IP address of the
</PRE>WINS server which owns the entry&gt;&gt;&gt;
<PRE>Min. Vers. No (&lt;high part&gt; &lt;low part&gt; -- 0 502   &lt;&lt;&lt;this is the minimum
</PRE>version ID&gt;&gt;&gt;
<PRE>Max. Vers. No (&lt;high part&gt; &lt;low part&gt; -- 0 502   &lt;&lt;&lt;this is the maximum
</PRE>version ID. In this case, since the min. and max. are the same, only one
registration will be deleted&gt;&gt;&gt;
Status returned is (SUCCESS - 0)
<P>
NOTE: If the Maximum Version Number is different than the Minimum
Version Number it will delete the full range. The version number can also
be obtained from the WINS Manager in the Show Database window under
version ID column. The version ID shown in this window is in HEX. It needs
to be converted to decimal to use with Winscl.exe.  For example, if the
version ID is 201 for the record that needs to be deleted, the Minimum
version number becomes 0 513 when used with WINSCL.
<P>
For more information on using WINSCL.EXE, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q137582.htm">Q137582</A></B>
   TITLE     : Using WINSCL.EXE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: bit doublewide order<BR>
Keywords          : nthowto ntnetserv ntreskit NTSrv nttcp kbnetwork kbhowto<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
