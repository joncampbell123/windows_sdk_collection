

<HTML>
<HEAD>
<TITLE>WINS Fails to Converge </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168076">
<META NAME="KBModify" CONTENT="1997/11/21">
<META NAME="KBCreate" CONTENT="1997/05/05">
<META NAME="Keywords" CONTENT="kbbug3.51 kbbug4.00 kbfix3.51 kbfix4.00 NTSrv nttcp kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  All domain controllers register their domain name with      as the sixteenth character of the NetBIOS name. For each domain, a domain name     record will exist on a Windows Internet Name Service (WINS) server that contains a list of IP addresses o...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBE6,QBE7,QA5V,QAYZ,QA9A,QBWD,QBFY,QBW3,QA4H,QAH5,QAN0,QAFO,QDNT,QAR4,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WINS Fails to Converge</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168076</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
All domain controllers register their domain name with &lt;1c&gt; as the
sixteenth character of the NetBIOS name. For each domain, a domain
name&lt;1C&gt; record will exist on a Windows Internet Name Service (WINS)
server that contains a list of IP addresses of all the domain controllers
in that domain.
<P>
When several domain controllers register the &lt;1C&gt; name with different WINS
servers, a replication problem prevents the replication partners from
having an entire list of IP addresses for this record. This may result in
client logon problems or uneven load on the domain controllers.
<P>
NOTE: This problem happens only when different domain controllers,
<PRE>      belonging to the same domain, register with different WINS servers,
      and the replication model is NOT a hub and spoke model.

</PRE><h2>CAUSE</h2>
 
<P>
By design, WINS cannot increment the version ID of a replica record
(record owned by another WINS server). Only the owner of the record is
allowed to increment the version ID of the record. A stalemate situation
can occur where an updated replica &lt;1C&gt; record may not be replicated
because of the above design rules.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Consider the following scenario:
<P>
<PRE>   WINS1 &lt;--&gt; WINS2 &lt;--&gt; WINS3 &lt;--&gt; WINS4

   Primary Domain Controller (PDC) 1 - x.x.x.221
   Backup Domain Controller (BDC)  1 - x.x.y.60

</PRE><P><LI>PDC registers with WINS1;
<P>
<P><PRE>      WINS1 now has:
      domain&lt;1c&gt; version id 505,
      contains ip x.x.x.221,
      owner is wins1.
</PRE>
<P><LI>BDC registers with WINS4
<P>
<P><PRE>      WINS4 now has:
      domain&lt;1c&gt; version id 254
      contains ip x.x.y.60
      owner is WINS4
</PRE>
<P><LI>WINS1 &lt;--replicates with---&gt;WINS2
<P>
<P><PRE>      both WINS1 and WINS2 now have:
      domain&lt;1c&gt; version id 505
      contains ip x.x.x.221
      owner is WINS1
</PRE>
<P><LI>WINS2 &lt;--replicates with --&gt; WINS3
<P>
<P><PRE>      WINS1 WINS2 and WINS3 now have:
      domain&lt;1c&gt; version id 505
      contains ip x.x.x.221
      owner is WINS1
</PRE>
<P><LI>WINS3 &lt;-replicates-&gt; WINS4
<P>
<P><PRE>      WINS4 now has :
      domain&lt;1c&gt; newer version id 255 (or more)
      contains:  ip x.x.x.221;ip x.x.y.60;
      owner WINS4
</PRE><P>
<P><PRE>      WINS3 now has:
      domain&lt;1c&gt; SAME version id 505
      contains:  ip x.x.x.221;ip x.x.y.60;
      owner WINS1
</PRE><P>
</OL>NOTE: Version number is not incremented for this record because this is a
replica record and is owned by WINS1.

<OL><P><LI>WINS2&lt;--replicates with--&gt;WINS3
<P>
<P><PRE>      domain&lt;1c&gt; record on WINS2 is not
      updated containing only ip x.x.x.221
</PRE><P>
</OL><h2>RESOLUTION</h2>
 
<P>
The resolution is to give ownership to the WINS Server that merges the
&lt;1c&gt; record. In other words, a replication partner can take ownership for
a 1C record, if it receives a replica 1C record from a second replication
partner.
<P>
In the above scenario the behavior will be:
<P>
(Steps 1-4 are the same)

<OL><P><LI>WINS3 &lt;-replicates-&gt; WINS4
<P>
<P><PRE>      WINS4 now has :
      domain&lt;1c&gt; version id 255 (wins4's highest id number)
      contains:  ip x.x.x.221;ip x.x.y.60;
      owner WINS4
</PRE><P>
<P><PRE>      WINS3 now has:
      domain&lt;1c&gt; version id 2000(wins3's highest number)
      contains:  ip x.x.x.221;ip x.x.y.60;
      ****owner WINS3 &lt;&lt;&lt;&lt;&lt;&lt;NOTE
</PRE>
<P><LI>WINS2&lt;--replicates with--&gt;WINS3
<P>
<P><PRE>      WINS2 now has:
      domain&lt;1c&gt; version id  442&lt;&lt;wins2's highest number&gt;
      contains ip x.x.x.221;ip x.x.y.60;
      ***owner WINS2 &lt;&lt;&lt;&lt;&lt;&lt;NOTE
</PRE>
<P><LI>WINS1&lt;--replicates with--&gt;WIN2
<P>
<P><PRE>      WINS1 now has:
      domain&lt;1c&gt; version id  506 &lt;WINS1's highest number at that time&gt;
      contains ip x.x.x.221;ip x.x.y.60;
      owner WINS1
</PRE><P>
</OL><h2>STATUS</h2>
 
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51. A
supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
receive
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt fails 1bh groupname<BR>
Keywords          : kbbug3.51 kbbug4.00 kbfix3.51 kbfix4.00 NTSrv nttcp kbnetwork<BR>
Version           : WinNT:3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
