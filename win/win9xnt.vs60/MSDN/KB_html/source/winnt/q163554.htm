

<HTML>
<HEAD>
<TITLE>Determining NIC Parameters for Setup Using Unattend.txt </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163554">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1997/02/12">
<META NAME="Keywords" CONTENT="ntdriver ntreskit ntsetup kbsetup kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When preparing to deploy Windows NT, you should test the network adapter to determine its functionality. During the testing phase, the network adapter settings will be determined and documented for use with a Windows NT answer file. The following i...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QAHE,QDIZ,QAVZ,QAMB,QAKD,QADK,QDL9,QBWQ,QBWO,QBWN,QADL,QAVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Determining NIC Parameters for Setup Using Unattend.txt</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163554</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When preparing to deploy Windows NT, you should test the network adapter
to determine its functionality. During the testing phase, the network
adapter settings will be determined and documented for use with a Windows
NT answer file. The following information assumes that an installation of
Windows NT with the adapter to be used is available. Just as, in most
cases, manually installing Windows NT requires prior knowledge of the
network adapter configuration, the answer file similarly requires this
information for automation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: Modifications to .inf files incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from
modifications of .inf files can be solved. Use this method at your own
risk.
<P>
Determining an adapter's parameters can be accomplished via the
Regedt32.exe utility supplied with Windows NT 4.0. Every installed network
adapter has two keys in:
<P>
<PRE>   HKLM\SYSTEM\CurrentControlSet\Services\

</PRE>These keys are &lt;ProductName&gt; and &lt;ServiceName&gt;, and they specify the
option name for the card and the instance of the card, respectively.
<P>
To find out the values of &lt;ProductName&gt; and &lt;ServiceName&gt;, check the
following registry values on an already installed computer using the same
adapter that you will be using:
<P>
<PRE>   HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkCards\1

   ProductName: REG_SZ:&lt;adapter_string&gt;
   ServiceName: REG_SZ:&lt;adapter_string&gt;

</PRE>The string assigned to ServiceName is what is needed to locate the
parameters for the instance of the network adapter installed. These
parameters can be located in the registry under:
<P>
<PRE>   HKLM\SYSTEM\CurrentControlSet\Services\&lt;ServiceName&gt;\Parameters

</PRE>All non-string values found in the parameters key for the adapter have to
converted from hexadecimal values to decimal values for the unattend file.
The names of the parameters and non-numeric values can be directly
translated to the unattend file.
<P>
<P><h3>Examples</h3>
 
<P>
NOTE: A semicolon is used to comment a particular line in Unattend.txt.
<P>
<PRE>   [NetWork]
   InstallAdapters = AdaptersList

   [AdaptersList]
   ; DECETHERWORKSTURBO = DECETHERWORKSTURBOParams
   ; EE16 = EE16Params
   ; J2573A = J2573AParams
   IEEPRO = IEEPROParams

   ;[DECETHERWORKSTURBOParams]
   ;InterruptNumber = 5
   ;IOBaseAddress = 768
   ;MemoryMappedBaseAddress = 851968
   ;BusType = 1
   ;BusNumber = 0

   ;[EE16Params]
   ;BusType = 1
   ;Transceiver = 3
   ;BusNumber = 0
   ;IoChannelReady = 2
   ;IoBaseAddress = 784
   ;InterruptNumber = 10

   ;[J2573AParams]
   ;BusNumber = 0
   ;BusType = 1
   ;AdapterType = 0
   ;BusType = 5
   ;MediaType = 1
   ;IoBaseAddress = 768
   ;InterruptNumber = 5

   [IEEPROParams]
   BusNumber = 0
   BustType = 1
   AdapterType = 0
   BusType = 5
   MediaType = 0
   IoBaseAddress = 768
   InterruptNumber = 5

</PRE>For more information, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q155197.htm">Q155197</A></B>
   TITLE     : Unattended Setup Parameters for Unattend.txt File

   ARTICLE-ID: <B><A href="../winnt/q143134.htm">Q143134</A></B>
   TITLE     : Oemsetup.inf Modifications for Automated Windows NT Setup

   ARTICLE-ID: <B><A href="../winnt/q155099.htm">Q155099</A></B>
   TITLE     : Creating Network Component .inf File for Unattended Setup

   ARTICLE-ID: <B><A href="../winnt/q156876.htm">Q156876</A></B>
   TITLE     : Using UDF Files with Windows NT 4.0 Unattended Setup
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : ntdriver ntreskit ntsetup kbsetup kbfaq<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
