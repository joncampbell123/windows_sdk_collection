

<HTML>
<HEAD>
<TITLE>PPP Connection Fails Between Windows NT RAS Server &amp; UNIX Client </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150581">
<META NAME="KBModify" CONTENT="1997/03/26">
<META NAME="KBCreate" CONTENT="1996/09/09">
<META NAME="Keywords" CONTENT="kb3rdparty kbenv kbnetwork ntinterop ntras NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" SYMPTOM  The PPP connection between a UNIX PPP client and the Windows NT PPP Server fails.  CAUSE =====  A possible cause is an inadequate value for MaxReject.  If the PPP client and the PPP server try to negotiate different link attributes, several...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABA,QDJZ,QBWD,QAKC,QBC6,QAG8,QA7O,QAYV,QARL,QDIZ,QBXS,QA7N,QBG2,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PPP Connection Fails Between Windows NT RAS Server &amp; UNIX Client</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150581</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.51 and 4.0
<LI>Microsoft Windows NT Server versions 3.51 and 4.0
</UL> 
<P>
<P><h2>SYMPTOM</h2>
 
<P>
The PPP connection between a UNIX PPP client and the Windows NT PPP Server
fails.
<P>
<P><h2>CAUSE</h2>
 
<P>
A possible cause is an inadequate value for MaxReject.
<P>
If the PPP client and the PPP server try to negotiate different link
attributes, several Configuration Negative Acknowledgments (CNAKs) might be
sent before they are able to decide which attributes to use. By default,
Windows NT terminates the negotiation after five unsuccessful attempts.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you are experiencing problems with a PPP negotiation, try to increase
MaxReject, or even better, configure the PPP client to negotiate to the
same attributes that Windows NT RAS Server tries to negotiate to.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: MaxReject must be configured on both client and server.
<P>
Below is a description of RAS PPP Subkey Entries in the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
<P><h3>RAS PPP Subkey Entries</h3>
 
<P>
Registry path:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM
      \CurrentControlSet
         \Services
            \Rasman
               \PPP

</PRE>ForceEncryptedPassword  REG_DWORD
<PRE>Range:                  Boolean
Default:                1 (enabled)

   This is a server-side parameter only. It is used to force the use of the
   Crypto-Handshake Authentication Protocol while authenticating clients.
   This means that the cleartest password will not get sent on the wire
   during authentication.

MaxConfigure            REG_DWORD
Range:                  Number
Default:                10

   Indicates the number of Configure-Request packets sent without
   receiving a valid Configure-Ack, Configure-Nak, or Configure-Reject,
   before assuming that the peer is unable to respond.

MaxFailure              REG_DWORD
Range:                  Number
Default:                10

   Indicates the number of Configure-Nak packets sent without sending a
   Configure-Ack, before assuming that the configuration is not converging.

MaxReject               REG_DWORD
Range:                  Number
Default:                5

   Indicates the number of Config-Rejects sent before assuming that the PPP
   negotiation will not converge.

MaxTerminate            REG_DWORD
Range:                  Number
Default:                2

   Indicates the number of Terminate-Request packets sent without receiving
   a Terminate-Ack, before assuming that the peer is unable to respond.

</PRE><h3>PPP Link Attributes the Windows NT Server Tries to Negotiate To</h3>
 
<P>
<PRE>MRU            Maximum Receive Unit = 1500
ASYNC-MAP      Async control character map = 0x00000000
AUTH           Authentication = CHAP-Challenge Handshake Authentication
               Protocol
MAGIC          Do Magic number negotiation
PROT.COMP      Do Protocol Compression
ADR/CF.COMP    Do Address-Control Field Compression

</PRE>If possible, try to configure the PPP client to use the same settings as
the Windows NT RAS server default settings.
<P>
<P><h3>Sample Configuration File "ppphosts" from a SCO UNIX System</h3>
 
<P>
In the example below, the UNIX system's values for dialing in to the
Windows NT RAS server has been modified to be as close as possible to what
the Windows NT RAS server will try to negotiate to. This is to minimize the
number of "Configuration Negative Acknowledgment" packages.
<P>
#
#      @(#)ppphosts  4.2.1.3 Lachman System V STREAMS TCP  source
#      SCCS IDENTIFICATION
#  System V STREAMS TCP - Release 5.0
#
#  One tab between fields only
#
# Entries have this format:
# Name tty System [Timer options] [Link options] [IP options] [Other]
# Those fields in brackets ([]) are optional
#
# Entries may continue onto multiple lines by giving a '\' as the
# last character of a line.
#
<PRE># Name      destination host or ppp login name (starting with *)
# tty       tty name for direct connection
#
</PRE># Timer options:
#  "idle=idle_time"  idle_time is the inactivity timeout
<PRE>#          in minutes (default = forever)
#  "tmout=timeout"   timeout per PPP protocol request (default = 3 seconds)
#  "conf=num"    Set the maximum number of times of configure retry
#          (default = 10)
#  "term=num"    Set the maximum number of times of termination retry
#          (default = 2)
#  "nak=num"     Set the maximum number of times of configure-nak
#          retry (default = 10)
#
</PRE># Link options:
<PRE>#  "mru=num".        Set the maximum receive unit (default = 296)
#  "accm=num(hex)"   Set the asyc control character map
#          (default = 0x00000000)
#  "pap"         Do password authentication
#          (default: no password authentication)
#  "nomgc"       disable magic number negotiation
#          (default: enable magic number negotiation)
#  "protcomp"    Do protocol field compression
#          (default: no protocol field compression)
#  "accomp"      Do addrerss-control field compression
#          (default: no addrerss-control field compression)
#
</PRE># IP options
<PRE>#  "ipaddr"      Do IP address negotiation
#          (default: no IP address negotion)
#  "rfc1172addr"     Using RFC1172 IP addresses negotiation
#          (default: RFC1332 IP address negotiation)
#  "VJ"              Do  VJ Compressed TCP/IP
#          (default: no VJ compressed TCP/IP)
#
</PRE># Other
#  "paptmout=tmout"  PPP waits for the peer to password authenticate
<PRE>#          itself for tmout minutes
#          (default = 1)
#  "rtscts"   set the line to use hardware(RTS/CTS) flow control
#          (default: no flow control)
#
</PRE># Examples:
# 1. For outbound PPP connection,
# ice_sl tty00 ice idle=5 tmout=3 conf=10 term=2 nak=10 mru=296
# accm=ffffffff\
#  pap nomgc protcomp accomp ipaddr  rfc1172addr VJ old
#
# 2. For inbound PPP connection,
##################################################################
<P>
192.100.1.1 - englab007 pap mru=1500 accm=0x00000000 protcomp accomp\
<PRE>              idle=5 tmout=5 conf=5 term=7 nak=10 rtscts
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt RAS PPP<BR>
Keywords            : kb3rdparty kbenv kbnetwork ntinterop ntras NTSrvWkst<BR>
Version             : 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
