

<HTML>
<HEAD>
<TITLE>How to Install an OEM Network Adapter Card in WinNT 4.0 Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156823">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1996/10/01">
<META NAME="Keywords" CONTENT="ntdriver ntreskit ntsetup kbsetup kbfaq kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Third-party OEM network adapter cards that are not detected during the setup of Windows NT cannot be made detectable. However, you can automate the process by telling Windows NT setup to install this particular card during an unattended setup.  RES...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QAVZ,QA05,QBWP,QDIZ,QDJV,QAFI,QBWE,QAUJ,QASR,QANE,QAMB,QDJS,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Install an OEM Network Adapter Card in WinNT 4.0 Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156823</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation, version 4.0
<LI>Microsoft Windows NT Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Third-party OEM network adapter cards that are not detected during the
setup of Windows NT cannot be made detectable. However, you can automate
the process by telling Windows NT setup to install this particular card
during an unattended setup.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To perform this operation, use the following steps:

<OL><P><LI>Go to your third-party drivers and look for a file called Oemsetup.inf.
   Using any text editor, open this file and search for the [options]
   section. In this section, you should find the name of your card. It
   should look similar to the following:
<P>
<P><PRE>      [PlatformsSupported]
<PRE></PRE>          ISA
          EISA
          PCI
      [Options]
          AMDPCI
      [FileConstants]
      GenericInfVersion  = " v3.11"

   Make a note of the [Options] name because it will be used in a later
   step.

</PRE><P><LI>While still in the Oemsetup.inf file, look for the [OptionsTextEng]
   section. Search for this value and make a note of it, because it will
   also be used in a later step. This entry will look similar to the
   following:
<P>
<P><PRE>      [OptionsTextEng]
<PRE></PRE>      AMDPCI     = "AMD PCNET Family Ethernet Adapter"

</PRE><P><LI>On the I386, share make a directory under the Drvlib.nic subdirectory
   with the name of your card (for example, AMDCARD). You can call this
   subdirectory any name you want, as long as it is unique. Place all the
   driver files needed for the network adapter card installation in this
   directory. The files usually consist of an .inf file, a .sys file, and
   a .hlp file. Token ring cards may have one or two additional files.

<P><LI>Expand the Oemnadzz.in_ file in your I386 share to Oemnadzz.inf

<P><LI>Open the file with any text editor and add your card into this file.
   The file contains four sections: PCI, MCA, EISA and ISA. Depending on
   your network adapter card type, do the following:
<P>
   A. Using a PCI example, add the name of your network adapter card
<P><PRE>      (found in step 1 above).
</PRE><P>
<PRE>         [PCIOptions]
         AMDPCI   &lt;--- newly added line
         ALANE0
         LEC
         J2585A
         J2585B
         J2973A
         J2970A

   B. In the next section, which should be [PCIFilename], add the
      appropriate path to your .inf file and drivers you created in step 3
      above.

         [PCIFilename]
         drvlib.nic\AMDCARD\Oemsetup.inf  &lt;----- newly added line here
         drvlib.nic\ALANENT\oemsetup.inf
         drvlib.nic\MDGLEC\oemsetup.inf
         drvlib.nic\HPVGP\oemsetup.inf
         drvlib.nic\HPVGP\oemsetup.inf
         drvlib.nic\HPVGP\oemsetup.inf

   C. In the last and final section (which should be [PCIOptionsTextEng]),
      add the appropriate text string preceded by the [options] name. This
      is the value you searched for in Step 2 above.

         [PCIOptionsTextENG]
         AMDPCI     = "AMD PCNET Family Ethernet Adapter"  &lt;-- Newly added
         ALANE0      = "Adaptec ATM LAN Emulation Adapter"
         LEC         = "Madge ATM LAN Emulation Client"
         J2585A      = "HP DeskDirect (J2585A) 10/100 PCI LAN Adapter"
         J2585B      = "HP DeskDirect (J2585B) 10/100 PCI LAN Adapter"
         J2973A      = "HP DeskDirect (J2973A) 10BaseT PCI LAN Adapter"
         J2970A      = "HP DeskDirect (J2970A) 10BaseT/2 PCI LAN Adapter"

</PRE><P><LI>In your Unattend.txt file, make sure the following lines appear:
<P>
<P><PRE>      [NetWork]
      JoinDomain = Mydomain
      CreatComputerAccount = user_name, password
      InstallAdapters = InstallAMDNetcard
      InstallProtocols = ProtocolsList
      InstallServices = SelectedServicesList
</PRE><P>
<P><PRE>      [InstallAMDNetcard]
      AMDPCI = AMDPCIParams
</PRE><P>
<P><PRE>      [AMDPCIParams]
      !AutoNetInterfaceType = "1"
      !AutoNetBusNumber = "0"
      IOBaseAddress = "768"
      DMAChannel = "3"
      InterruptNumber = "5"
</PRE><P>
   NOTE: You can find these parameters one of two places: in the
   Oemsetup.inf file, or in the registry of a computer that already has
   the card installed. The location in registry is:
<P>
<P><PRE>      HKEY_local_machine\system\currentcontrolset\services
      \&lt;%oemnetcardkeyname%&gt;X\parameters).
</PRE>
<P><LI> Run the unattended setup.
<P>
</OL>Using this procedure does not make the card detectable by any means. The
Drvlib.nic directory and all its subdirectories are copied to the local
hard disk, which allows these files to be accessible during GUI mode
setup. You may need to make some modifications to the Oemsetup.inf file
for the OEM network adapter card so that it does not prompt you for any
user input. For some suggestions on this process, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q155099.htm">Q155099</A></B>
   TITLE     : Creating Network Component .inf File for Unattended Setup

</PRE></OL>For installation of the AMD PCNET adapter, please see the following
article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q138630.htm">Q138630</A></B>
   TITLE     : AMD PCNET Family Ethernet Adapter Cannot Be Installed
               Unattended
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : ntdriver ntreskit ntsetup kbsetup kbfaq kbsetup<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
