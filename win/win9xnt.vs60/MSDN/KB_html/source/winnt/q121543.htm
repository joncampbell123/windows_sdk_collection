

<HTML>
<HEAD>
<TITLE>Setting Up for Remote Debugging </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121543">
<META NAME="KBModify" CONTENT="1997/11/07">
<META NAME="KBCreate" CONTENT="1994/10/09">
<META NAME="Keywords" CONTENT="nthowto kbnetwork kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article outlines how to set up for remote debugging.  MORE INFORMATION  To set up to remotely debug another computer, do the following:   - Remove the System, Hidden, * ReadOnly attributes of the BOOT.INI file    and append the following strin...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVX,QBWP,QBXS,QAA1,QDI2,QBFY,QA9N,QABA,QAWN,QAY2,QAUD,QASB,QAPF,QANN,QDJ9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Setting Up for Remote Debugging</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121543</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.50 3.51
WINDOWS
kbnetwork kbtshoot
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article outlines how to set up for remote debugging.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To set up to remotely debug another computer, do the following:

<UL><LI>Remove the System, Hidden, &amp; ReadOnly attributes of the BOOT.INI file
   and append the following strings to the boot line:
<P>
<P><PRE>      /BAUDRATE=9600 /DEBUGPORT=COM#
</PRE><P>
   For example:
<P>
<P><PRE>      [operating systems]
      multi(0)...partition(1)\NT="WinNT/S Ver:3.5" /DEBUGPORT=COM1
      /BAUDRATE=9600
</PRE>
<LI>Run Terminal against the above Com Port with the debug modem attached
   and enter the modem commands which set the following:
<P>
<PRE>     Function                              USRobotics
     -------------------------------------------------
     Set back to Factory Defaults:         AT&amp;F
     Disable Transmit Data Flow Control:   AT&amp;H0
     Disable Receive Data Flow Control:    AT&amp;I0
     Disable Data Compression:             AT&amp;K0
     Disable Error Control:                AT&amp;M0
     Auto Answer On:                       ATS0=1
     Disable Reset Modem on loss of DTR:   AT&amp;D0
     Write to NVRAM:                       AT&amp;W

</PRE><LI>Determine the base build of the remote computer (using WinMSD, WinVer),
<P>
<P><PRE>      511, 528, 807
</PRE><P>
   and copy the corresponding debug files from the base build:
<P>
<P><PRE>      &lt;Compact Disc&gt;\Support\Debug\&lt;platformType&gt;\*.* files to a
      &lt;localDebug&gt;\ directory and the corresponding Kernel &amp; Hal *.DBG
      files from
      &lt;Compact Disc&gt;\Support\Debug\&lt;platformType&gt;\Symbols\EXE and
      &lt;Compact Disc&gt;\Support\Debug\&lt;platformType&gt;\Symbols\DLL respectively.
</PRE><P>
   For example:
<P>
<P><PRE>      XCOPY E:\Support\Debug\i386\*.* C:\WinNT\Debug
      XCOPY E:\Support\Debug\i386\Symbols\EXE\NTKRNLMP.DBG ...
<PRE></PRE>                ... C:\WinNT\Debug\Symbols\EXE /s /e
      XCOPY E:\Support\Debug\i386\Symbols\EXE\NTOSKRNL.DBG ...
                ... C:\WinNT\Debug\Symbols\EXE /s /e
      XCOPY E:\Support\Debug\i386\Symbols\DLL\HAL*.* ...
                ... C:\WinNT\Debug\Symbols\DLL /s /e

   where drive E: is the CD-ROM drive.

   NOTE: Using different (debugger 807 &lt;-&gt; target 528) kernel debuggers may
   prevent debuggers from "Sync"-ing.

</PRE><LI>Determine the Service Pack (SP) version (using WinMSD, WinVer),
<P>
<P><PRE>      SP1, SP2, SP2b
</PRE><P>
   and copy the SP Symbols tree to the &lt;localSymbols&gt; directory. For more
   information on the SP Symbols tree, contact Microsoft Product Support
   Services (Enterprise Technical Support).
<P>
   For example:
<P>
<P><PRE>      XCOPY &lt;Source SP Symbols path&gt; C:\WinNT\Debug\Symbols /s /e
</PRE>
<LI>Determine what Hotfixes, if any, have been installed,
<P>
<P><PRE>      Prb18756, Bug18756
</PRE><P>
   and copy the Hotfix Symbols tree to &lt;localSymbols\&lt;dir&gt;\. For more
   information on the Hotfix Symbols tree, contact Microsoft Product
   Support Services (Enterprise Technical Support).
<P>
   For example:
<P>
<P><PRE>      XCOPY \\CNSSUP1\Fixes\CSD006\Bug18756\i386\Symbols\*.* ...
<PRE></PRE>                ... C:\WinNT\Debug\Symbols /s /e

</PRE><LI>Determine if you are using the Microsoft or third-party MP Kernel. If it
   is Microsoft's MP Kernel, then from &lt;localSymbols&gt;\EXE, copy
   NTKRNLMP.DBG to NTOSKRNL.DBG. If it is a third-party MP Kernel, obtain a
   copy of the symbols and copy it into your
   &lt;localSymbols&gt;\EXE\NTOSKRNL.DBG.

<LI>Determine if you are using the Microsoft Windows NT HAL or a third-party
   HAL. If it is a Microsoft Windows NT HAL, but not the standard
   ISA/EISA HAL, then from &lt;localSymbols&gt;\DLL, copy the appropriate
   HAL*.DBG to HAL.DBG. If it is a third-party HAL, obtain a copy of
   the symbols and copy it into your &lt;localSymbols&gt;\DLL\HAL.DBG.

<LI>Connect the modem to the remote debug target computer using the port
   from above and reboot the target computer.

<LI>Go to the &lt;localDebug&gt; directory and run the following REMDBG.BAT file:
<P>
<P><PRE>      REM Modem String to Disable Flow Control and Compression
      ECHO "UsRobotics Modem string = AT&amp;H0&amp;I0&amp;K0&amp;M0"
</PRE><P>
<P><PRE>      REM Environment Variables:
</PRE><P>
<P><PRE>      REM Specify which com port to use. (Default = com1)
      set _NT_DEBUG_PORT=com1
</PRE><P>
<P><PRE>      REM Specify symbol image path. (Default = x: * NO trailing
<PRE></PRE>         backslash *)
      set _NT_SYMBOL_PATH=%2\Symbols

      REM Specify second symbol image path to be searched after the above.
      set _NT_ALTERNATE_SYMBOL_PATH=%3\Symbols

      REM Specify the baud rate used by debugging serial port.
         (Default = 19200)
      set _NT_DEBUG_BAUD_RATE=9600

      REM If specified, output will be APPENDed to this file.
      set _NT_DEBUG_LOG_FILE_APPEND=DEBUG.LOG

      REM If specified, output will be written to this file from offset 0.
      REM set _NT_DEBUG_LOG_FILE_OPEN=U:\WinNT\DEBUG\DEBUG.LOG

      REM set _NT_DEBUG_CACHE_SIZE=x

      remote /s "%1kd -m %4 %5 %6 %7 %8 %9" debug

      REM Usage: *kd [-?] [-v] [-m] [-r] [-n] [-b] [-x] [[-l
      SymbolFile] [KrnlName]
      REM     where:
      REM             -v      Verbose mode
      REM             -?      Display this help
      REM             -n      No Lazy symbol loading
      REM             -m      Use modem controls
      REM             -b      Break into kernel
      REM                    -c          Resync on Connect

      REM Control Keys:

      REM     . &lt;Ctrl-C&gt; Break into kernel
      REM       &lt;Ctrl-B&gt;&lt;Enter&gt; Quit debugger
      REM     . &lt;Ctrl-R&gt;&lt;Enter&gt; Resynchronize target and host
      REM     . &lt;Ctrl-V&gt;&lt;Enter&gt; Toggle Verbose mode
      REM     . &lt;Ctrl-D&gt;&lt;Enter&gt; Display debugger debugging information

   through the following command:

   [u:\winnt\debug] remdbg &lt;kd&gt; &lt;localSymbols&gt; &lt;baseBuildpath&gt; &lt;addOptions&gt;
                             ^        ^             ^              ^
   Kernel Debugger to use ---+        |             |              |
      Example: i386 | MIPS | Alpha    |             |              |
                                      |             |              |
   localSymbols without Symbols name -+             |              |
      Example: c:\winnt\debug                       |              |
                                                    |              |
   baseBuild (UNC) without Symbols name ------------+              |
      Example: &lt;Symbols server&gt;\528\i386                           |
                                                                   |
   Additional Debug Options ---------------------------------------+
      Example: -b (Break In on Connect) -c (Resync on Connect)

</PRE></UL>Contact Microsoft Product Support Services (Enterprise Technical Support)
for more information on the &lt;Symbols server&gt;.
<P>
<P><h3>Example</h3>
 
<P>
remdbg i386 u:\winnt\debug &lt;Symbols server&gt;\528\i386 -b
"UsRobotics Modem string = AT&amp;H0&amp;I0&amp;K0&amp;M0"
**************************************
<PRE>***********     REMOTE    ************
***********     SERVER    ************
</PRE>**************************************
To Connect: Remote /C MARCM.PORT debug
<P>
Microsoft(R) Windows NT Kernel Debugger
Version 1.00
(C) 1991 Microsoft Corp.
<P>
Symbol search path is: u:\winnt\debug\Symbols;.;
KD: ntoskrnl.exe image based at 80100000
KD: Preloading kernel symbols from u:\winnt\debug\Symbols\exe\ntoskrnl.DBG.
KD: waiting to connect...
KD: No carrier detect - in terminal mode
<P>
&gt;From here, paste in the above Modem String and wait for the modem to
return OK. Then enter the ATDT&lt;Phone number&gt; of the remote target computer
as below:
<P>
AT&amp;H0&amp;I0&amp;K0&amp;M0
AT&amp;H0&amp;I0&amp;K0&amp;M0
<P>
OK
ATDT9,&lt;Phone number&gt;
ATDT9,&lt;Phone number&gt;
<P>
CONNECT 9600
KD: Carrier detect - returning to debugger
<PRE>^R                    \\ Resync's the debuggers
</PRE>KD: Kernel Debugger connection established.  (Initial Breakpoint requested)
NT!_KeUpdateSystemTime+0x109:
<PRE>8015e109 cc               int     3
</PRE>kd&gt;
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbtshoot<BR>
KBSubcategory: nthowto<BR>
Additional reference words: prodnt 3.10 3.50 3.51<BR>
Keywords          : nthowto kbnetwork kbtshoot<BR>
Version           : 3.10 3.50 3.51<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
