

<HTML>
<HEAD>
<TITLE>How to Remove Static WINS Entries from All WINS Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177140">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1997/11/21">
<META NAME="Keywords" CONTENT="nthowto ntnetserv ntregistry NTSrv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information on how to do this, view the  Restoring the Registry  online Help t...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAH5,QAFO,QDKD,QA9N,QBWD,QDH6,QAY2,QAGB,QANJ,QABI,QAA1,QA5V,QAPN,QAN0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Remove Static WINS Entries from All WINS Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177140</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.
<P>
<P><h2>SUMMARY</h2>
 
<P>
Static entries should only be used on your Windows Internet Name Service
(WINS) Servers for non-WINS aware clients that cannot register with a WINS
server, such as UNIX or AS400 hosts.
<P>
There are many methods for removing static entries from a WINS database.
Some of the methods in this article involve stopping all WINS server
replication. Although using the Migrate On feature in WINS Manager does not
require stopping replication, it may not remove all static entries. Another
method that does not require stopping replication involves the use of a
temporary additional WINS server. This method does require a registry
change on all WINS servers.
<P>
For more information on the Migrate On feature, see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q167806.htm">Q167806</A></B>
   TITLE     : Explanation of Advanced Options in WINS Manager

   ARTICLE-ID: <B><A href="../winnt/q171794.htm">Q171794</A></B>
   TITLE     : Migrate On/Off Does Not Allow Static Mappings To Be
               Overwritten

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Methods That Do Not Require WINS Replication to Be Stopped</h3>
 
<P>
There are two methods that do not require you to stop WINS replication on
your network; however, both methods do require a registry change on all
WINS servers.
<P>
Method 1 uses a new, temporary WINS server:
<P>
To remove static entries, use the following steps:

<OL><P><LI>Install a new WINS Server on your network.
<P>
   NOTE: This will not be a production server; in other words, no clients
   will register with this WINS server. This server will only store static
   mappings and allow easy deletion of the static mappings.

<P><LI>Make a note of all of the static entries that you want to delete from
   all of your WINS servers throughout your network. You should note the
   NetBIOS name and the record type, such as Unique, Group, and so on.

<P><LI>Add each of the entries from step 2 as static entries on the new WINS
   server that you created in step 1.

<P><LI>Configure your new WINS server to replicate these static entries to all
   other WINS servers through a central hub WINS server. If the replication
   configuration is not of the hub/spoke model, make certain that
   replication takes place with a WINS server that will reach all other
   downstream WINS servers.

<P><LI>Delete all of the static mappings from Static Mappings at all of the
   WINS servers, except the new WINS server, on the Mappings menu of WINS
   Manager. The original Owners of the static mappings may still retain
   ownership of the mappings they have entered locally and this will remove
   their local copy and ensure a replica copy of the record now resides in
   the local database.

<P><LI>After the static entries have fully replicated, make the following
   registry change to all production WINS Servers:
<P>
   WARNING: Using Registry Editor incorrectly can cause serious problems
   that may require you to reinstall your operating system. Microsoft
   cannot guarantee that problems resulting from the incorrect use of
   Registry Editor can be solved. Use Registry Editor at your own risk.
   
   For information about how to edit the registry, view the "Changing Keys
   And Values" online Help topic in Registry Editor (Regedit.exe) or the
   "Add and Delete Information in the Registry" and "Edit Registry Data"
   online Help topics in Regedt32.exe. Note that you should back up the
   registry before you edit it.
<P>
   a. Start Registry Editor (Regedt32.exe).
<P>
   b. Go to the following subkey and select it:
<P>
<PRE>         HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WINS\Partners

   c. Click Add Value on the Edit menu and use the following information:

         Value Name: PersonaNonGrata
         Data Type : REG_MULTI_SZ
         Data      : IP Address of the new WINS Server created in step 1
         Default   : &lt;none&gt;

      NOTE: This registry value does not go in either the Push or Pull
      subkey of the Partners subkey, but it is entered as a Value in the
      Partners subkey. After enabling the value, stop and restart the WINS
      service.

      This parameter specifies the IP addresses of WINS servers whose
      records are not to be inserted into the local database during
      replication.

      For more information, see the following article in the Microsoft
      Knowledge base:

         ARTICLE-ID: <B><A href="../winnt/q166485.htm">Q166485</A></B>
         TITLE     : Removing Entries in WINS from Other Nonexistent WINS
                     Servers

</PRE><P><LI>After adding the PersonaNonGrata registry value and restarting the WINS
   service, you must perform the following steps on all WINS servers except
   the new WINS server that you created in step 1:
<P>
   a. Using WINS Manager, click Show Database on the Mappings menu.
<P>
   b. Click the new WINS server in the Select Owner list.
<P>
   c. Click Delete Owner to delete all records owned by the new WINS
<P><PRE>      Server.
</PRE><P>
   The registry value will prevent these entries from being replicated back
   before the entries are deleted from every other WINS Server.

<P><LI>You may now remove the WINS server created in step 1 from replication
   and disable or remove the WINS service.
<P>
</OL>Method 2 uses the ConsistencyCheck registry key:
<P>
NOTE: All WINS servers must be running Windows NT Server version 4.0 to use
this method. It is also important to note that this method uses a lot of
bandwidth and is not appropriate to use across slow WAN links.

<OL><P><LI>Delete the static mapping from the owning WINS server.

<P><LI>Prior to the next replication perform a consistency check using
   Winscl.exe from the Windows NT Resource Kit or using the
   ConsistencyCheck registry keys.
<P>
</OL>For more information, see the following articles in the Microsoft Knowledge
base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q154410.htm">Q154410</A></B>
   TITLE     : New WINS Registry Entries In Windows NT 4.0

   ARTICLE-ID: <B><A href="../winnt/q167704.htm">Q167704</A></B>
   TITLE     : Explanation of Windows NT 4.0 WINS Consistency Checking

   ARTICLE-ID: <B><A href="../winnt/q169216.htm">Q169216</A></B>
   TITLE     : Using Winscl.exe to Remove Corrupt WINS Entries by Version
               ID

</PRE></OL><h3>Methods That Require WINS Replication to be Stopped</h3>
 
<P>
All of the methods in this section require you to stop all WINS replication
on your network. To remove static entries from all of your WINS servers,
use the following steps:

<OL><P><LI>Stop all replication in your WINS environment.
<P>
   a. Using WINS Manager, click Replication Partners on the Server menu.
<P>
   b. Clear the Replication Options check boxes for every server in the
<P><PRE>      WINS Server list.
</PRE><P>
   NOTE: This need only be done on one side of a replication pair (a pair
   of WINS servers set to replicate with one another). Make sure you have
   the replication partner settings documented before breaking any
   replication pair. Please note: the partner you are replicating with may
   get event log messages about the missing replication partner.

<P><LI>Remove the static entries using one of the following methods:
<P>
<P><PRE>    - Use Winscl.exe to remove the static entries. Winscl.exe is a utility
      contained in the Microsoft Windows NT Resource Kit.
</PRE><P>
<P><PRE>      For more information, see the following article in the Microsoft
      Knowledge base:
</PRE><P>
<PRE>         ARTICLE-ID: <B><A href="../winnt/q137582.htm">Q137582</A></B>
         TITLE     : Using WINSCL.EXE

      -or-

    - Use the following steps:

      a. Add static entries to each of the replication partners with the
         names and correct IP addresses of the entries that you want to
         remove.

      b. Delete them immediately after you add them.

      -or-

    - Use the Delete Owner function of WINS Manager. This method will
      remove all records owned by a selected WINS server from a WINS
      database. This method is described below through a step-by-step
      example.

</PRE><P><LI>Using WINS Manager, click Replication Partners on the Server menu and
   recreate the replication pairs that you broke in step 1.

<P><LI>Depending on the type of static entries you have removed (COMPUTERNAME,
   DOMAIN, and so on), you may need force certain computers to register
   with WINS at this time.
<P>
</OL><h3>Example of Using the Delete Owner Function of WINS Manager</h3>
 
<P>
To illustrate how to use Delete Owner, assume the following:

<UL><LI>DomainX is the domain name for a domain and the domain controllers in
   this domain register with their WINS server, whose computer name is
   Wins1.

<LI>The domains are Domain1, Domain2, and Domain3.

<LI>The static entry that needs to be removed is Domain3[1Ch] from the WINS
   replication environment.

<LI>The WINS servers are configured using the hub and spoke method of
   replication:
<P>
<P><PRE>    - Wins1 is the hub server that is set up to do a full PUSH/PULL
      operation with both Wins2 and Wins3.
</PRE><P>
<P><PRE>    - Wins2 and Wins3 are configured to PUSH/PULL with WINS1.
</PRE><P>
</UL>For this example, there is a static entry for the Domain3[1Ch] NetBIOS name
in the database of Wins2. This static entry has replicated to both Wins1
and Wins3. The Domain3[1Ch] entry is a Group (or Domain for Windows NT 4.0)
type registration that should contain every IP address for domain
controllers in the Domain3 domain (up to a maximum of 25 IP addresses).
<P>
For more information on NetBIOS names registered with WINS, see the
following articles in the Microsoft Knowledge base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q119495.htm">Q119495</A></B>
   TITLE     : List of Names Registered with WINS Service

   ARTICLE-ID: <B><A href="../winnt/q163409.htm">Q163409</A></B>
   TITLE     : NetBIOS Suffixes (16th Character of the NetBIOS Name)

</PRE></OL>Because there is now a static entry for Domain3[1Ch] in the Wins3 database,
the domain controllers in Domain3 can no longer dynamically register the
Domain3[1Ch] entry with Wins3. The fact that this entry is owned by the
Wins2 server makes no difference here. A static entry always takes
precedence over a dynamic entry, regardless of who is the owner of the
record. You need to remove this static entry so that domain controllers in
Domain3 can once again dynamically register the Domain3[1Ch] entry with
WINS.
<P>
To remove this static entry, use the following steps:

<OL><P><LI>Break all replication:
<P>
   a. From WINS Manager, double-click Wins1 (it may show only the IP
<P><PRE>      address of Wins1). Verify that Wins1 is the currently selected WINS
      server by noting the title in the caption bar. It should display the
      following:
</PRE><P>
<P><PRE>       - WINS Manager - (Wins1)
</PRE><P>
<PRE>         -or-

       - WINS Manager - (Local)

      NOTE: If you are currently logged on locally to Wins1, you will see
      the second title above. The computer name, Wins1, may be replaced
      with the IP address of Wins1.

   b. Click Replication Partners from the Server menu.

   c. Click Wins2 in the WINS Server list of the Replication Partners
      dialog box.

   d. Click to clear the check mark from both the Push Partner and Pull
      Partner check boxes in the Replication Options section of the dialog
      box.

   e. Repeat steps c and d for WINS server Wins2.

   f. Click OK to exit this dialog box and return to the main WINS Manager
      screen.

   g. At this point, you have stopped all replication in your WINS
      environment.

   NOTE: You did not need to go into Wins2 or Wins3 and break replication
   with Wins1 because you have basically done this in the earlier steps in
   the other direction.

</PRE><P><LI>Remove the static entries using Delete Owner:
<P>
   a. From WINS Manager, double-click Wins1 to make it the current WINS
<P><PRE>      server.
</PRE><P>
   b. Click Show Database on the Mappings menu.
<P>
   c. Click Wins2 in the Select Owner list of the Show Database dialog box.
<P><PRE>      Click Delete Owner to remove all records owned by Wins2 from this
      database.
</PRE><P>
   NOTE: In the event that you do not know which WINS server is the owner
   of the static entry, refer to the section, Finding the Owner of a Static
   Entry, below.
<P>
   d. Click Close and repeat steps a through c for all WINS servers that
<P><PRE>      contain the static entry in question.
</PRE>
<P><LI>Recreate all replication pairs that were broken in step 1:
<P>
   a. From WINS Manager, click Replication Partners on the Server menu.
<P>
   b. Click the replication partners you wish to re-add and select the Push
<P><PRE>      Partner and Pull Partner check boxes in the Replication Options
      section of the Replication Partners dialog box.
</PRE>
<P><LI>Force any pertinent computers to reregister with WINS:
<P>
   a. You chose the Delete Owner method, which deleted all records owned by
<P><PRE>      Wins2. You now need to restart Wins2 as well as all workstations and
      servers that register with Wins2.
</PRE><P>
   b. At this point, you may either wait for replication to occur normally
<P><PRE>      or force replication through WINS Manager by clicking Replicate Now
      in the Replication Partners dialog box.
</PRE><P>
</OL><h3>Finding the Owner of a Static Entry</h3>
 
<P>
You may not initially know which WINS server is the owner of a static
mapping, in which case you will need to do a little searching. To
accomplish this, do the following:

<OL><P><LI>In the Show Database dialog box of WINS Manager, click the first server
   in the Select Owner list.

<P><LI>Scroll through the list of names in the Mappings list looking for
   entries with a check mark in the S column. These are static mappings. If
   you do not find the entry for which you are looking, click the next WINS
   server in the Select Owner list and search the names. Continue searching
   each WINS server in the Select Owner list until you find the static
   mapping you want to delete.
<P>
   NOTE: You may use the Filter function of WINS Manager to limit the list
   that you search; however, this function will not display [1Bh] entries.
<P>
   For more information, see the following article in the Microsoft
   Knowledge base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../winnt/q173202.htm">Q173202</A></B>
<PRE></PRE>      TITLE     : 1B Record Missing in WINS Manager with View Filtered for
                  Domain

</PRE><P><LI>Make a note of who is the owner of this record (the currently selected
   WINS Server in the Select Owner list).
</OL> 
<PRE>Keywords          : nthowto ntnetserv ntregistry NTSrv kbnetwork
Version           : WinNT:3.5,3.51,4.0
Platform          : winnt
Issue type        : kbinfo
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
