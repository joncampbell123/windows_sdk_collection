

<HTML>
<HEAD>
<TITLE>File Manager I/O Optimizations Slow other File Transfers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123819">
<META NAME="KBModify" CONTENT="1996/01/23">
<META NAME="KBCreate" CONTENT="1994/12/13">
<META NAME="Keywords" CONTENT="kbnetwork ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The file I/O optimizations in Windows NT File Manager can cause other processes' calls to Raw Write and Raw Read to fail.  RESOLUTION  To correct This problem:   - Always use File Manager to copy or write files. File Manager    will cancel the NTNo...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAGI,QAH5,QAGU,QA5W,QAHT,QDIR,QARL,QAGB,QAGC,QBVV,QA8T,QAR4,QAH6,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>File Manager I/O Optimizations Slow other File Transfers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT operating system version 3.5 and 3.51
<LI>Microsoft Windows NT Server version 3.5 and 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The file I/O optimizations in Windows NT File Manager can cause other
processes' calls to Raw Write and Raw Read to fail.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct This problem:

<UL><LI>Always use File Manager to copy or write files. File Manager
   will cancel the NTNotifyDirectoryChange SMB before submitting
   the RAW read/write operation.

<LI>Modify the Windows NT Registry as follows:
<P>
   WARNING: Using Registry Editor incorrectly can cause serious,
   system-wide problems that may require you to reinstall Windows
   NT to correct them. Microsoft cannot guarantee that any problems
   resulting from the use of Registry Editor can be solved. Use this
   tool at your own risk.
<P>
   1. Run Registry Editor (REGEDT32.EXE).
<P>
   2. From the \HKEY_CURRENT_USER subtree, go to the following key:
<P>
<PRE>         \Software\Microsoft\FileManager\Settings

   3. From the Edit menu, choose Add Value.

   4. Enter the following:

         Value Name: ChangeNotifyTime
         Data Type:  REG_SZ
         String:     0 (disable; 1 for enable)

</PRE></UL><h2>MORE INFORMATION</h2>
 
<P>
Normal CORE mode read and write operations occur in approximately 8K units.
For each 8K the redirector must submit a new SMB (server message block). As
an optimization, Microsoft networks can use RAW mode to send data in 64K
units, requiring one SMB for every 64K. The transport subdivides this
buffer as needed. One stipulation of RAW mode is that the Virtual Circuit
must be tied up while the operation is in progress because the data
frames contain no SMB information to correlate it. No other SMB can be
allowed during this time.
<P>
Windows NT introduced a new SMB called NTNotifyDirectoryChange. This
causes the server to notify the client if directory information changes.
For example, if another client adds a file to a directory, Windows NT
File Manager uses NTNotifyDirectoryChange.
<P>
This SMB is classified as a long term request. The SMB is received by the
server but is not returned until a change occurs (or until the SMB is
canceled by the client). Because the client does not know when the server
will complete the SMB, it cannot tie up the virtual circuit. Therefore, the
client does not use RAW mode when an NTNotifyDirectoryChange is pending.
<P>
When necessary, File Manager cancels the request to take advantage of RAW
mode. However, other processes such as NTVDM
or SETUP are not aware that RAW mode has been disabled.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: prodnt 3.10 3.50 3.51 smb pending<BR>
KBCategory: kbnetwork<BR>
KBSubcategory: ntutil<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
