

<HTML>
<HEAD>
<TITLE>Automating Detection of Logon Failures In a Windows NT Domain </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171148">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1997/07/08">
<META NAME="Keywords" CONTENT="ntdomain nthowto NTSrvWkst ntutil kbtool kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Detecting log on failures or account lockouts in a Windows NT domain with multiple domain controllers and trusting domains may be difficult. To do this manually would require the administrator to load the security event log of multiple domain contr...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI5,QA9A,QBWP,QAPN,QAO4,QAAD,QBW7,QAK7,QBW3,QBKX,QDMH,QAWK,QAVY,QATQ,QAM2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automating Detection of Logon Failures In a Windows NT Domain</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171148</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Detecting log on failures or account lockouts in a Windows NT domain with
multiple domain controllers and trusting domains may be difficult. To do
this manually would require the administrator to load the security event
log of multiple domain controllers and set the filter to find the log on
failure events.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the Dumpel.exe utility from the Windows NT Resource Kit to enable the
domain administrator to automate this procedure.
<P>
By creating a simple batch file to query the security event log of all
of your domain controllers, you can quickly automate the process.
The log on failure events will only be recorded in the log of the primary
domain controller (PDC) or backup domain controller (BDC) that
authenticated the user. When you log on to a trusting domain from the
trusted domain, the event may be recorded in the trusted domain, so you
would need to query the event logs of both domains.
<P>
To automate this procedure, perform the following steps:

<OL><P><LI>Install the Windows NT 4.0 Resource Kit.

<P><LI>For each domain, create a batch file that dumps the event logs of each
   domain controller to a text file, filtering only the log on failure
   event IDs.
<P>
   NOTE: The example below contains wrapped lines.
<P>
<P><PRE>      @echo off
      Dumpel.exe -s pdcname -l security -m security -e 529 539 &gt;
      %temp%\event539.txt
      Dumpel.exe -s bdc1name -l security -m security -e 529 539 &gt;&gt;
      %temp%\event539.txt
      Dumpel.exe -s bdc2name -l security -m security -e 529 539 &gt;&gt;
      %temp%\event539.txt
      Dumpel.exe -s bdc3name -l security -m security -e 529 539 &gt;&gt;
      %temp%\event539.txt
</PRE>
<P><LI>This will append all Event 529s and Event 539s to the event539.txt file
   to be examined for log on problems.
<P>
<P><PRE>      Event ID 529
      Logon Failure
      Reason: Unknown user name or bad password
</PRE><P>
<P><PRE>      Event ID 539
      Logon Failure
      Reason: Account locked out
</PRE><P>
</OL>Common causes for invalid log on events:

<UL><LI>Forgotten passwords, someone is entering the wrong password.

<LI>An unauthorized individual is trying to gain access to the network.

<LI>There is a persistent network connection with an invalid password.

<LI>There is a service using a user account with an invalid password.

<LI>Trust relationship has been broken.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hacker ntreskit log logins lockout<BR>
Keywords          : ntdomain nthowto NTSrvWkst ntutil kbtool kbtshoot<BR>
Version           : WinNT:3.5,3.51,4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
