

<HTML>
<HEAD>
<TITLE>Modifying Setup.log to Expedite File Repair </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161565">
<META NAME="KBModify" CONTENT="1997/03/31">
<META NAME="KBCreate" CONTENT="1996/12/30">
<META NAME="Keywords" CONTENT="kbtool ntconfig NTSrvWkst ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Occasionally it may be necessary to use the emergency repair disk (ERD) to repair a single system file that is known to be bad, or to skip a single file while repairing all others. Unfortunately, if the affected file is not near the top of the list...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAA1,QDI2,QDIZ,QA2Q,QAIB,QBWS,QAMO,QAH7,QAG2,QAGB,QAEF,QDKW,QA9N,QBOJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Modifying Setup.log to Expedite File Repair</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161565</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Occasionally it may be necessary to use the emergency repair disk
(ERD) to repair a single system file that is known to be bad, or to skip a
single file while repairing all others. Unfortunately, if the affected
file is not near the top of the list in the Setup.log file, it may take
considerable time to click through each of the files until the correct file
appears. This article outlines a procedure to work around this issue.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To repair a single bad file or to skip a file while repairing all others,
complete the following steps:

<OL><P><LI>Remove the attributes from the Setup.log file by typing the following at
   the command line:
<P>
<P><PRE>      attrib -r -h -s a:\Setup.log
</PRE>
<P><LI>Copy the Setup.log file from the floppy to a second computer.

<P><LI>Use a text editor such as Notepad to modify Setup.log.

<P><LI>From the Search pull-down menu, use the Find command to locate the
   desired file.

<P><LI>Select the entire line that the file is in, delete the line with the Cut
   command, then Paste it at the top of list, immediately under the
   heading:
<P>
   [Files.WinNT]

<P><LI>Save the modified Setup.log file back to the floppy disk, maintaining
   the original on the second computer so it can be restored if needed.

<P><LI>Run the ERD. The first file that will appear is NTLDR. You may either
   skip (press ESC) or select repair of this file, as desired.
<P>
   The next file to appear will be the file that you moved to the top of
   the list. If this is the only file that must be repaired, select the
   replace option (press ENTER) and then select F3 to exit the repair
   process. The desired file will be repaired leaving all others untouched.
<P>
   If this file is to be skipped and all other files repaired, skip the
   File (press ESC) and then select repair all (press A) to perform repair
   Of all remaining files.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt erd<BR>
Keywords            : kbtool ntconfig NTSrvWkst ntutil<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
