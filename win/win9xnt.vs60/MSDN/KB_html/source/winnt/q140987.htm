

<HTML>
<HEAD>
<TITLE>Errors Removing TCP/IP Registry Keys Using Insight Manager </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140987">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1995/12/10">
<META NAME="Keywords" CONTENT="nthowto NTSrvWkst nttcp kb3rdparty kbnetwork kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  On Compaq file servers that are using versions of Windows NT Server that are installed using the SmartStart compact disc, a user may have difficulties reinstalling TCP/IP or other TCP/IP related services.  Insight Manager is a systems management to...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDNT,QAEF,QBWP,QDI2,QBWD,QAGU,QAH5,QA9N,QDH6,QANJ,QDKD,QAY2,QAB4,QACK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Errors Removing TCP/IP Registry Keys Using Insight Manager</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140987</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.50 3.51
WINDOWS
kb3rdparty kbsetup kbnetwork
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
On Compaq file servers that are using versions of Windows NT Server that
are installed using the SmartStart compact disc, a user may have
difficulties reinstalling TCP/IP or other TCP/IP related services.
<P>
Insight Manager is a systems management tool that provides performance and
configuration management for Compaq servers and desktop clients. However,
Insight Manager can complicate the process that is used to remove all
traces of TCP/IP from the Windows NT registry. This article helps to
identify those Insight Manager entries and prepare Windows NT Server for a
trouble-free, reinstallation of TCP/IP and related components.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are many reasons why a Windows NT Server operator may need to remove
and readd TCP/IP and/or the related components. Because of service
dependencies that exist when these components are removed, the next time
the system is booted and the operator tries to readd these components, the
installation fails nevertheless with one or more of the following error 
messages:

<UL><LI>Registry Service Subkey Already Exists.

<LI>Registry Subkey Already Exists.

<LI>Unable to remove name space provider
<P>
</UL>This error occurs whether the options to add them are grayed out, or
whether the individual check boxes for TCP/IP, Simple TCP/IP Tools, FTP
Server, SNMP, WINS Server, DHCP Server appear.
<P>
If the installed TCP/IP components are from Microsoft installation media
and you want to properly remove all references to the TCP/IP tools, please
see the following articles in the Microsoft Knowledge Base for
instructions:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q122398.htm">Q122398</A></B>
   TITLE     : TCP/IP Internetworking Components Not Available

   ARTICLE-ID: <B><A href="../winnt/q102973.htm">Q102973</A></B>
   TITLE     : REG: TCP/IP Transport Entries, PART 1

   ARTICLE-ID: <B><A href="../winnt/q102974.htm">Q102974</A></B>
   TITLE     : REG: TCP/IP Transport Entries, PART 2

</PRE>NOTE: <B><A href="../winnt/q102973.htm">Q102973</A></B> and <B><A href="../winnt/q102974.htm">Q102974</A></B> go into greater detail regarding the TCP/IP
entries in the registry.
<P>
After you remove the registry entries, reinstall the TCP/IP components
that are needed.
<P>
If Windows NT Server was installed from the Compaq SmartStart compact disc
along with the TCP/IP components, Compaq Insight Manager may also have
been installed.
<P>
If Insight Manager is installed and the operator has tried removing and
readding TCP/IP components, they may have been able to get past the TCP/IP
installation check boxes, but Setup always detects another TCP/IP
component that is already installed and will prompt with "Registry Service
Subkey Already Exists." causing the TCP/IP installation to fail. To
successfully reinstall the TCP/IP components, any Insight Manager entries
will need to be deleted from the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct
them. Microsoft cannot guarantee that any problems resulting from the
use of Registry Editor can be solved. Use this tool at your own risk.
Insight Manager is a Compaq product. If you have questions regarding this
product and the changes that it makes to the Registry, please contact
Compaq Technical Support.

<OL><P><LI>Stop the Compaq Insight Manager Service from the Services Control Panel.

<P><LI>From File Manager, delete the %SYSTEMROOT%\SYSTEM32\CPQMGMT
   subdirectory.

<P><LI>Run Registry Editor (REGEDT32.EXE) and under the
   HKEY_LOCAL_MACHINE\SYSTEM subtree delete the following keys:
<P>
<P><PRE>      \COMPAQ
</PRE><P>
<P><PRE>      \COMPAQPERMANENT
</PRE>
<P><LI>Quit Registry Editor and reboot the server.

<P><LI>Run Control Panel and choose Network and then Add Software.

<P><LI>Choose "TCP/IP and Related Components" from the list of software and
   select the check boxes next to the components that need to be added
   (TCP/IP, Simple TCP/IP, etc.) and click OK.

<P><LI>Insert the Windows NT floppy disk or compact disc when prompted.
<P>
   The install should complete successfully after copying the appropriate
   files and making necessary registry changes.

<P><LI>Reboot the server.

<P><LI>(Optional) If the system requires Insight Manager to be running on the
   server, then go ahead and complete its installation per Compaq
   instructions (typically, this means that the SNMP service under TCP/IP
   must be installed in step 5 and 6).
<P>
</OL>The Compaq products discussed here are manufactured by Compaq Computer
Corp., a vendor independent of Microsoft; we make no warranty, implied
or otherwise, regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kb3rdparty kbsetup kbnetwork<BR>
KBSubcategory: nttcp nthowto NTSrvWkst<BR>
Additional reference words: prodnt 3.50 3.51<BR>
Keywords            : nthowto NTSrvWkst nttcp kb3rdparty kbnetwork kbsetup<BR>
Version             : 3.50 3.51<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
