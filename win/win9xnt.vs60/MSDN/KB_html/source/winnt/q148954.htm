

<HTML>
<HEAD>
<TITLE>How to Set Up a Remote Debug Session Using a Modem </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148954">
<META NAME="KBModify" CONTENT="1997/03/26">
<META NAME="KBCreate" CONTENT="1996/03/26">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDIV,QDJ9,QBXS,QAVX,QAA1,QABA,QDIZ,QAS6,QBV8,QDI2,QDJ3,QANN,QBWS,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Set Up a Remote Debug Session Using a Modem</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148954</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
 -------------------------------------------------------------------------
<P>
</UL><h2>SUMMARY</h2>
 
<P>
This article describes the procedures for preparing an X86 Intel-processor-
based and RISC-processor-based computer running Windows NT Workstation or
Server for a remote debug session.
<P>
<P><h2>MORE INFORMATION</h2>
 

<UL><LI>What Is the Need For the Kernel Debugger
<LI>What Is the Process of Remote Debugging
<LI>Configuring a System for Remote Debugging
<LI>Debugger Options
<LI>Editing the BOOT.INI file for Intel x86 Computers
<LI>Changing Firmware Boot Options for RISC Computers
<LI>Preparing the Modem
<P>
</UL><h2>What Is the Need For the Kernel Debugger</h2>
 
<P>
The kernel debugger that comes with Windows NT will produce information
about the system that is normally not available without the aid of the
debugger. You can enable the kernel debugger from the Windows NT start-up
menu. Enabling the kernel debugger will allow the Windows NT debugger to
output debugging information to a remote debugger for a remote user to
analyze. This is normally done at the request of a Microsoft Customer
Support Engineer for analyzing a fatal error in Windows NT that cannot be
diagnosed from the MEMORY.DMP file or when a MEMORY.DMP file is not
produced.
<P>
<P><h2>What Is the Process of Remote Debugging</h2>
 
<P>
The process of Remote debugging happens when two computers are connected
together via modems over a phone line. The target computer and the host
computer are running the Windows NT kernel debuggers which communicate
using a special debug API and Protocol.
<P>
<P><h2>Configuring a System for Remote Debugging</h2>
 
<P>
Configuring a system for remote debugging involves changing the boot
options to tell Windows NT to load the kernel debugger. On an Intel
x86 based platform this is done by editing the BOOT.INI file. On a RISC
based system (DEC Alpha, MIPS and PPC based processors) this involves
changing the boot options in the firmware menu. You will also need to have
a modem and connect it to the appropriate COM port on the target computer
and connect an inbound phone line to the modem.
<P>
<P><h2>Debugger Options</h2>
 
<P>
There are several boot options which can be used in configuring the system
for debugging. These options are the same on Intel x86 and RISC platforms,
although when used on a RISC platform the / is not required:
<P>
<PRE>/DEBUG      - When this option is used, the kernel debugger will be loaded
              during boot and kept in memory at all times. This means that
              a support engineer can dial into the system being debugged
              and break into the debugger, even when the system is not
              suspended at a Kernel STOP screen.

</PRE>/DEBUGPORT  - Specifies the serial port to be used by the kernel
<PRE>              debugger. If no serial port is specified the debugger will
              default to COM2 on Intel x86 based computers and to
              COM1 on RISC computers.

</PRE>/CRASHDEBUG - This option will cause the kernel debugger to be loaded
<PRE>              during boot but swapped out to the pagefile after boot.
              As a result, a support engineer will not be able to
              break into the debugger unless Windows NT is suspended
              at a Kernel STOP screen.

/BAUDRATE   - Sets the Baud rate that the kernel debugger will use.
              The default baud rate is 19200. A baud of 9600 is the
              normal rate for remote debugging over a modem.

</PRE>Whenever DEBUGPORT or BAUDRATE is used, it is not necessary to use DEBUG,
as Windows NT assumes that you want the computer to load in DEBUG mode. At
least one of the above switches must be used to configure a computer for
remote debugging, otherwise Windows NT will not load the debugger at all.
<P>
<P><h2>Editing the BOOT.INI file for Intel x86 Computers</h2>
 
<P>
To set up the target computer on an Intel x86 based computer, simply edit
the BOOT.INI file in the boot partition and add the appropriate debugger
options. The BOOT.INI is edited using a standard ASCII text editor. The
BOOT.INI file is a file found on the root of the system partition
(generally the C drive) and will have the Hidden, System, and Read-Only
attributes set. These attributes must be changed.
<P>
<P><h3>To Change the Attributes of the BOOT.INI File</h3>
 
<P>
To change the attributes of the BOOT.INI file, follow Procedure I or II:
<P>
Procedure I:

<OL><P><LI>Type the following at a command prompt:
<P>
<P><PRE>      attrib -s -h -r c:\boot.ini
</PRE>
<P><LI>Edit BOOT.INI.
<P>
</OL>To restore the Read-Only, Hidden, and System attributes when you finish
editing the file, type the following at a command prompt:
<P>
<PRE>   attrib +h +r +s c:\boot.ini \

</PRE></OL>Procedure II:

<OL><P><LI>In File Manager, choose By File Type in the View menu, and then
   select the Show Hidden/System Files box in the By File Type dialog
   box, and choose the OK button.

<P><LI>In the File Manager window, select the BOOT.INI file, and then
   choose Properties from the File menu.

<P><LI>In the Properties dialog box, clear the Read Only, Hidden, and System
   attribute box and choose the OK button.

<P><LI>Edit the BOOT.INI using Notepad or another text editor and add the debug
   options as described below.
<P>
</OL><h3>Configuring the Boot Options in the BOOT.INI</h3>
 
<P>
To configure a computer for debugging you must add one of the previous
options to the BOOT.INI. Generally you will want to add /DEBUG and
/BAUDRATE, to lower the baud rate to 9600 and put the computer in debug
mode. You should use /DEBUGPORT=COMX if you cannot use the default COM
port (COM2) for debugging. The following example shows how to add
these options.
<P>
The following is an example of a typical BOOT.INI. Each entry in the
[operating systems] section should correspond to the options listed in the
boot menu during a normal system startup:
<P>
<PRE>   [boot loader]
   timeout=30
   default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS
   [operating systems]
   multi(0)disk(0)rdisk(0)partition(1)\WINDOWS="Windows NT Version 3.5"
   multi(0)disk(0)rdisk(0)partition(1)\WINDOWS="Windows NT Version 3.5"
   [VGA mode]  /BASEVIDEO
   C:\="MS-DOS"

</PRE></OL>To enable the debugger to use COM1 and to communicate at 9600 baud, add the
following or see the example following these step-by-step instructions:

<OL><P><LI>Select the startup option that you normally use and add the /DEBUG
   switch at the end of the line.

<P><LI>To specify the communications port, add the switch /DEBUGPORT=COM1.

<P><LI>To specify the baud rate, add the switch /BAUDRATE=9600.
<P>
</OL>The following shows the above BOOT.INI file after it has been modified by
following steps 1-3 above (NOTE: Line 6 is the rest of line 5 that did not
fit on the same line in this article):
<P>
<PRE>   [boot loader]
   timeout=30
   default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS
   [operating systems]
   multi(0)disk(0)rdisk(0)partition(1)\WINDOWS="Windows NT Version 3.5"
   /debug /debugport=com1 /baudrate=9600
   multi(0)disk(0)rdisk(0)partition(1)\WINDOWS="Windows NT Version 3.5"
   [VGA mode] /BASEVIDEO
   C:\="MS-DOS"

</PRE></OL><h2>Changing Firmware Boot Options for RISC Computers</h2>
 
<P>
Unlike the Intel x86 computers, which use a BOOT.INI file, boot options
on RISC computers are configured through the firmware. The following steps
walk you through configuring the boot options on MIPS-, PPC- and DEC Alpha-
based computers. Be sure to carry out step 10 for all DEC Alpha computers
before a support engineer attempts to dial in and debug the system.

<OL><P><LI>Restart the computer. The ARC System screen appears, displaying the
   main menu from which you can select an action.

<P><LI>On a MIPS and PPC RISC-based system, choose Run Setup to display
   the Setup menu and then choose Manage Startup to display a menu of
   the boot options.
   On a Digital Alpha AXP RISC-based system, choose Supplementary Menu,
   Set Up the System, and Manage Boot Selection Menu to display a menu
   of the boot options.

<P><LI>Choose Change a Boot Selection to display a list of the operating
   systems that are installed on this computer.

<P><LI>Choose the Windows NT operating system. If you have more than one
   version of Windows NT installed, select the one that you want to
   debug. A two-part screen appears for changing the current settings
   of the environment variables used to start the RISC-based computer.
   The environment variable that controls whether or not the RISC-based
   computer starts up in debug mode is the OSLOADOPTIONS variable.

<P><LI>To edit the value for the OSLOADOPTIONS variable, use the arrow keys
   to select it from the list of variables. Once selected, it appears
   in the Name box at the top of the screen.

<P><LI>Press ENTER to display the Value box.

<P><LI>Type the options you want to add in the Value box, separated by
   spaces and press ENTER to save them. For example, if you want to turn on
   DEBUG mode and set the COM port to COM2, you type the following:
<P>
<P><PRE>      OSLOADOPTIONS  debug  debugport=com2
</PRE><P>
   If you do not specify the debug port, the default debug port is set to
   COM1.
<P>
   Since RISC-based computers allow only a default baud rate of 19200, you
   do not need to specify the baud rate.

<P><LI>Press ESC to stop editing.

<P><LI>Based on the type of computer you have, do one of the following:
<P>
<P><PRE>    - On a MIPS or PPC RISC-based system, choose Return To Main Menu and
      then Exit to return to the ARC System screen.
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>    - On a Digital Alpha AXP RISC-based system, choose the option
      Supplementary Menu, save your changes and then choose Boot Menu to
      return to the ARC System screen.
</PRE>
<P><LI>If this is the first time you debug this system you need to carry out
<P><PRE>    additional configuration steps. For these steps, consult the Windows NT
    Resource kit Version 3.51 Update or Update 2, Appendix A.
</PRE>
<P><LI>Restart the computer to run under Windows NT.
<P>
</OL><h2>Preparing the Modem</h2>
 
<P>
To connect to the remote debugger successfully you must connect an external
modem with auto-answer capabilities to the desired COM port. Most modems
have this feature, but it is generally disabled. The modem should be set to
9600 baud. For a proper connection, the kernel debugger requires that
hardware compression as well as error detection and flow control be turned
off. Make sure the modem works correctly before proceeding any further. In
most cases you will need to configure the modem by connecting to a spare
COM port on the target machine or another machine, using TERMINAL.EXE or
some other communication program to send configuration strings to the
modem, then moving the modem to the target machine and COM port without
turning off the modem. This is why an internal modem will not work, as
rebooting the system will generally reset any of the changes you have made
to the modem settings.
<P>
To configure the modem:
<P>
<PRE>   NOTE: You can carry out all these steps on the target computer, using
   the COM port you want to configure as the debug port provided you carry
   them out before configuring the debugger on the target system.

</PRE><P><LI>Connect a modem with auto-answer capabilities to an available COM port
   on the target computer or another computer.
<P>
   NOTE: Be sure you can move the modem to the target COM port without
   removing power from the modem.

<P><LI>Run TERMINAL.EXE or some other communications program and configure it
   to write to the modem.

<P><LI>Set the modem to 9600 baud rate. Consult your modem documentation
   for the correct way to do this.

<P><LI>Turn off all hardware compression, flow control and error detection.
   The exact way to do this will vary widely from modem to modem, so
   consult your modem documentation for the correct strings to send to
   the modem.

<P><LI>Enable auto-answer on the modem. This can usually be done by sending
   it the string ATS0=1 (the “0” is the number 0, not the letter O).
   However, you should consult your modem documentation to verify this.

<P><LI>Without removing power from the modem, move it to the correct COM
   port on the target system.
<P>
</OL><h2>Additional Reading</h2>
 
<P>
For additional information, please see:

<UL><LI>The Windows NT Resource Kit.

<LI>The Microsoft Driver Development Kit.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ntblue prodnt debugref<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : WinNT<BR>
Issue type          : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
