

<HTML>
<HEAD>
<TITLE>Explanation of Jet Database for Windows NT 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165915">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1997/03/26">
<META NAME="Keywords" CONTENT="kbinfo ntnetserv NTSrv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Windows Internet Name Service (WINS) produces J   .log files in the %SystemRoot%\System32\Wins folder to increase the speed and efficiency of storing the WINS data. This article discusses these Jet files and their purpose.  MORE INFORMATION   J   ....">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDMH,QA1S,QDKY,QAHI,QAU5,QBWP,QAZV,QBW5,QAEF,QAKJ,QDKA,QBXB,QA26,QAO4,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Explanation of Jet Database for Windows NT 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165915</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows Internet Name Service (WINS) produces J&lt;n&gt;.log files in the
%SystemRoot%\System32\Wins folder to increase the speed and efficiency of
storing the WINS data. This article discusses these Jet files and their
purpose.
<P>
MORE INFORMATION
<P>
 
<P>
J&lt;n&gt;.log Files
 
<P>
To increase speed and efficiency of data storage, the Jet database writes
current transactions to log files rather than to the database directly.
Therefore, the most current view of the data will be the database plus any
transactions in the log file(s). These files are also used for recovery if
the WINS service is stopped abruptly or in an unexpected manner. If the
service is stopped in an unexpected manner, the log files will
automatically be used to re-create the correct state of the WINS database.
<P>
Log files will always be a certain size; however, they can grow quickly in
number on a very busy WINS Server. It is inevitable that WINS will write
more transactions to a log than the size of the log can accommodate. When a
log file becomes filled, it is renamed to indicate that it is an older log
and not in use. A new transaction log is created with the J&lt;n&gt;.log
filename, where &lt;n&gt; is a decimal number such as J50.log. The naming
format of the previous log file will be JetXXXXX.log, where each X denotes
a hexadecimal number from 0 to f. Previous log files are maintained in the
same folder as the current log files.
<P>
The log files are processed (all log entries written to the database) and
deleted when a successful backup occurs or when the WINS server is shut
down gracefully. Therefore, if many J&lt;n&gt;.log files have accumulated,
frequent backups should be scheduled to maintain the logs.
<P>
After the entries have been processed, it is possible to manually delete
the log files; however, this will prevent a successful recovery of the
database if it should be needed. Because of this, it is important to ensure
that the log files are not manually deleted or removed from the system
until a backup has been performed.
<P>
J&lt;n&gt;.chk Files
 
<P>
Jet maintains a checkpoint file, J&lt;n&gt;.chk, that indicates the location
where the last information was successfully written from the transaction
logs to the database. It is also used for recovery purposes; that is, the
checkpoint file indicates where the recovery or replaying of data should
begin. This checkpoint file is updated every time data is written to the
database file (Wins.mdb).
<P>
<P><h3>Res1.log and Res2.log Files</h3>
 
<P>
Reserved logs (Res1.log and Res2.log) are kept for emergency purposes. More
specifically, they are used in the event that the server runs out of disk
space. If a server attempts to create another transaction log file and
there is insufficient disk space, the server will flush any outstanding
transactions into these reserved log files. The service will then shut down
and log an event to the Event Viewer.
 
<PRE>Keywords          : kbinfo ntnetserv NTSrv
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
