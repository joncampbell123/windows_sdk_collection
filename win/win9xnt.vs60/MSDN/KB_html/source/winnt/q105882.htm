

<HTML>
<HEAD>
<TITLE>Windows 3.1 and Windows NT Can Share Virtual Memory Space </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105882">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1993/10/27">
<META NAME="Keywords" CONTENT="kbother ntgeneral">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The following two methods can be used to save disk space on computers that have both Windows 3.1 and Windows NT installed:   - Sharing the PAGEFILE.SYS file     -or-   - Creating and sharing a dedicated pagefile partition  MORE INFORMATION  Sharing...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QDL9,QBWQ,QBWN,QAIJ,QBWS,QAGQ,QBXS,QBE7,QBE6,QAGB,QBTX,QAC9,QDIV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 3.1 and Windows NT Can Share Virtual Memory Space</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105882</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following two methods can be used to save disk space on computers
that have both Windows 3.1 and Windows NT installed:

<UL><LI>Sharing the PAGEFILE.SYS file
<P>
   -or-

<LI>Creating and sharing a dedicated pagefile partition
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sharing the PAGEFILE.SYS File</h3>
 
<P>
If performance requirements allow running Windows 3.1 with a temporary
swap file, Windows can be configured to use a swap file named
PAGEFILE.SYS. This prevents Windows from creating the default swap
file WIN386.SWP.
<P>
Because Windows (versions 3.0 and 3.1) and Windows NT both delete and
recreate their virtual memory space each time they are loaded, only
one file will ever exist. This method requires a temporary swap file
in Windows 3.1 and that PAGEFILE.SYS be stored on a FAT partition.
<P>
To change the name of Windows 3.1 temporary swap file, do the
following:

<OL><P><LI>Edit the SYSTEM.INI file and find the [386 Enhanced] section.

<P><LI>Update PagingFile=c:\WIN386.SWP to PagingFile=x:\PAGEFILE.SYS,
   where x is the drive letter that contains PAGEFILE.SYS.

<P><LI>Save the file and restart Windows for the changes to take affect.
<P>
</OL><h3>Creating and Sharing a Dedicated Paging Partition</h3>
 
<P>
This method is used when Windows 3.1 needs a permanent swap file,
which consists of the files 386SPART.PAR and SPART.PAR. It has four
requirements:

<UL><LI>A dedicated partition
<LI>A FAT file system
<LI>A batch file (details follow)
<LI>A requirement of exiting Windows 3.1 in the proper manner
<P>
</UL>The steps to implement this method are the following:

<OL><P><LI>Back everything up, if required, and repartition the hard disk
   using the MS-DOS FDISK command.

<P><LI>Create a dedicated partition large enough to hold only the Windows
   swap file, 386SPART.PAR. Because Windows NT can support paging files
   across multiple drives, limiting the size of the drive will not limit
   the size of PAGEFILE.SYS.

<P><LI>Restore files if necessary.

<P><LI>Start Windows NT. In the Control Panel window, choose the System
   icon, choose the Virtual Memory option button, and then change the
   drive where PAGEFILE.SYS is located to the drive of the partition you
   just created. Enter the size available in both the Initial Size and
   Maximum Size fields. Zero out any other drives that may have also been
   designated. Choose Set and OK to save changes. Quit Windows NT.

<P><LI>Start the system into MS-DOS and delete PAGEFILE.SYS from the
   paging partition.

<P><LI>Start Windows 3.1. In the Control Panel window, choose the 386
   Enhanced icon, choose the Virtual Memory option button, and then
   change the drive letter to the drive of the paging partition you just
   created. In the Type box, select Permanent. In the New Size box, enter
   the number shown in the Space Available field. You will receive a
   message stating the number is too large and to change it to a smaller
   number. Accept this number by choosing the OK button. Choose Yes when
   asked if you really want to make this change. Quit Windows 3.1. You
   must now create a custom batch file to start Windows 3.1.

<P><LI>Rename WIN.COM to __WIN.COM so that "WIN" no longer starts Windows.

<P><LI>Create the following batch file using a text editor and call it
   WIN.BAT. This file deletes the Windows NT paging file PAGEFILE.SYS and
   runs the renamed executable file _WIN.COM to start Windows. When
   Windows terminates, WIN.BAT normalizes the swap file files and deletes
   them so they won't take up space when you run Windows NT.
<P>
<P><PRE>      WIN.BAT
      @ECHO OFF
      IF EXIST x:\PAGEFILE.SYS DEL x:\PAGEFILE.SYS
      __WIN
      ATTRIB -r C:\windows\spart.par
      ATTRIB -r -h -s x:\386SPART.PAR
      DEL C:\windows\SPART.PAR
      DEL x:\386SPART.PAR
</PRE><P>
   Where x:\ is the dedicated paging partition drive.
<P>
</OL>Both of these methods also work for Windows for Workgroups.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: wfw wfwg prodnt<BR>
Keywords            : kbother ntgeneral<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
