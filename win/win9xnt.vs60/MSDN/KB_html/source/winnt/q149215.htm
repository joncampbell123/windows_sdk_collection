

<HTML>
<HEAD>
<TITLE>VB 4.0 Apps Can Only Be Scheduled Using System Account </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149215">
<META NAME="KBModify" CONTENT="1997/11/14">
<META NAME="KBCreate" CONTENT="1996/03/28">
<META NAME="Keywords" CONTENT="ntconfig nthowto ntui kbenv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you run a Microsoft Visual Basic 4.0 application using the AT Scheduler service, if the service is configured to use any account other than the system user account, the application will quit, and in Windows NT 3.51 get the following error:    ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBG2,QAL4,QBWP,QAI5,QACK,QBWS,QAJH,QA9W,QAAP,QAB4,QBS0,QABI,QBW7,QDL9,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VB 4.0 Apps Can Only Be Scheduled Using System Account</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149215</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you run a Microsoft Visual Basic 4.0 application using the AT
Scheduler service, if the service is configured to use any account other
than the system user account, the application will quit, and in Windows NT
3.51 get the following error:
<P>
<PRE>   Unexpected error, quitting

</PRE>Under Windows NT 4.0, you will get the following error:
<P>
<PRE>   Application error caused a Stack Fault in Module &lt;unknown&gt; 00c7:4394f
   will close.


</PRE><h2>CAUSE</h2>
 
<P>
Windows applications can be scheduled to run interactively only if the
Scheduler service is running under the system user account (the default
account). If you reconfigure the Scheduler service to run using any other
account, including administrator accounts, then Windows applications cannot
be scheduled to run fully interactively (that is, they cannot make use of
the screen and keyboard). This apparent limitation is designed to avoid
possible security issues.
<P>
If you attempt to schedule a Microsoft Visual Basic 4.0 application under
any account other than the system account, the VB runtime DLL VB40032.dll
will cause a memory access violation because it does not have access rights
to some desktop resources.
<P>
NOTE: If you try to run a VB4 application with scheduler under Windows NT
4.00, you will get the following error regardless of whether you have
scheduler setup for the /INTERACTIVE switch and "Allow Service To Interact
With Desktop":
<P>
<PRE>   Application Error
   Caused a Stack Fault in Module &lt;unknown&gt;00c7:4394|||will close

</PRE>For additional information on this error, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q156735.htm">Q156735</A></B>
   TITLE     : WOW Applications Stack Fault When Launched by a Service

</PRE>NOTE:  If you schedule a VB5 application it will work fine with system
account or a specific user’s account (necessary for network access)
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To get a VB 4.0 application to run under the scheduler service using
Windows NT 3.51, do the following:

<OL><P><LI>Ensure that the Scheduler service is configured to run using the system
   account. To do this, select the Services tool under Control Panel.
   From the list of services, select Schedule and click the
   Startup button. Make sure that you click the Log On As System
   Account button.

<P><LI>When you schedule the application using the AT command line, make sure
   you include the interactive switch.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : ntconfig nthowto ntui kbenv<BR>
Version           : 3.5 3.51 4.0<BR>
Platform          : winnt<BR>
Hardware          : ALPHA x86<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
