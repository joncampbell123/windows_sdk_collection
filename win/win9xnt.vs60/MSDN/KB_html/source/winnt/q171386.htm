

<HTML>
<HEAD>
<TITLE>Connectivity Delay with Multiple Redirectors Installed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171386">
<META NAME="KBModify" CONTENT="1998/03/09">
<META NAME="KBCreate" CONTENT="1997/07/15">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00 NTSrvWkst kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information on how to do this, view the  Restoring the Registry  online Help t...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QA5E,QBG2,QABI,QAI5,QAIM,QADN,QAUD,QAA1,QAY2,QAL0,QBWP,QBWS,QDI2,QBDM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Connectivity Delay with Multiple Redirectors Installed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171386</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may experience a delay when you attempt to connect to network resources
from a system with multiple redirectors installed. This delay only happens
the first time that you attempt the connection.
<P>
<P><h2>CAUSE</h2>
 
<P>
When a non-WNET API initial UNC connection attempt is made to a network
resource from a system with multiple redirectors, the Windows NT system
sends the request to the multiple UNC provider (MUP) to identify which
redirector should handle the request.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
A modification to the MUP has been made such that, if the redirector with
the highest priority is attempted first with a successful response, those
redirectors with lower priorities are then bypassed and the connection is
made through the redirector with the highest priority.
<P>
Enabling this capability requires an updated Mup.sys and a modification to
the registry entry DisableDFS.
<P>
NOTE: If you are not using the IntranetWare client from Novell, you will
need to edit the registry as follows:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" online Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" online Help
topics in Regedt32.exe. Note that you should back up the registry before
you edit it.

<OL><P><LI>Start Registry Editor (Regedit.exe).

<P><LI>Go to the following subkey:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Mup
</PRE>
<P><LI>Create a new value using the following information:
<P>
<P><PRE>      DisableDFS  REG_DWORD
      Range:  0 or 1
      Default:  0 (Enabled)
</PRE><P>
<P><PRE>      Set this key to 1.
</PRE><P>
</OL>NOTE: If you are using the IntranetWare client from Novell, you will need
to follow these steps in addition to the procedures listed above:

<OL><P><LI>Run the registry editor (Regedt32.exe).

<P><LI>Go to the following key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services
      \NetwareWorkstation\NetworkProvider
</PRE><P>
   NOTE: The above registry key is one path; it has been wrapped for
   readability.

<P><LI>Click DeviceName, click Edit, and then click String.

<P><LI>Change \Device\NetwareWorkstation to \Device\NetwareRedirector.

<P><LI>Click OK, exit Registry Editor, and restart the computer.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The MUP first establishes whether Distributed File System (Dfs) is in use
and passes the request to Dfs.
<P>
The MUP then checks its internal cache to see whether the connection had
been made previously (entries in the MUP cache are held for 15 minutes).
The MUP then sends the request to each redirector that handles each request
synchronously and attempts to identify a resource on the network that
matches the request. After all redirectors return, the MUP chooses (based
on response and priority) which redirector the application will use.
<P>
The delays come from two locations: first, the attempt to access the
resource through Dfs and, second, the MUP must wait and accept all
responses from all redirectors before completing the request. Therefore,
even if a resource is readily available and accessible over one redirector,
the request must still be made over the other installed redirectors before
the request completes.
<P>
Depending on the number of redirectors, protocols, and timer configurations
for connectivity, these delays can exceed 13 seconds for each initial
connection.
<P>
The NetWare Redirector will be used as an example.
<P>
The following illustrates an initial UNC connection attempt:

<OL><P><LI>Application makes UNC request.

<P><LI>Dfs is checked and the request is processed if Dfs is enabled.

<P><LI>The MUP then checks the MUP cache for a recent connection.

<P><LI>The MUP then makes a query to the first redirector, NetWare in this
   example, and the redirector responds.
<P>
   NOTE: The return is immediate as NetWare uses only IPX and the calls
   are fast.

<P><LI>The MUP sends the request to the second redirector, Microsoft in this
   example, and the second redirector responds.
<P>
   NOTE: The delay for the Microsoft redirector depends on the protocols
   installed. With TCP/IP, delays exists as the resource name is queried
   through WINS, broadcasts, LMHOSTS file, DNS, and so on. For example, the
   default delay for an h-node client is 13 seconds.

<P><LI>A priority is assigned to each redirector queried so if both
   redirectors return successfully, the priority is used to designate
   which redirector takes the request.

<P><LI>The handle to the resource is returned to the application based on the
   MUP's decision.
<P>
</OL>If the application's request was made for a NetWare resource, the
application would have to wait for the Microsoft redirector to timeout
before returning the handle to the resource.
<P>
The priority for the redirectors can be configured using the following
steps:

<OL><P><LI>Run the Network tool in Control Panel.

<P><LI>Click Services and click Network Access Order.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0.
A supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: redir provider<BR>
Keywords          : kbbug4.00 kbfix4.00 NTSrvWkst kbnetwork<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
