

<HTML>
<HEAD>
<TITLE>Unable to Delete Mapped Drive to User's Home Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165575">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1997/03/21">
<META NAME="Keywords" CONTENT="kbbug3.50 kbbug3.51 kbbug4.00 ntdomain NTSrvWkst kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When a user attempts to disconnect a drive mapped to his or her home directory through the net use /d command from a command prompt, the following error message may be displayed:     The device is being accessed by an active process.     More help ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAI5,QAY2,QAGU,QA8O,QAB4,QBXB,QAVZ,QATJ,QAGB,QAC9,QBV8,QACF,QAFI,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unable to Delete Mapped Drive to User's Home Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165575</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a user attempts to disconnect a drive mapped to his or her home
directory through the net use /d command from a command prompt, the
following error message may be displayed:
<P>
<PRE>   The device is being accessed by an active process.

   More help is available by typing NET HELPMSG 2404.

</PRE>The preceding error message occurs if the drive that is mapped to the
user home directory is set through the Connect To option in the User
Environment Profile dialog box.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the Connect To option for the Home Directory within User Manager is
defined to connect a drive letter to a specified UNC path, this connection
is created using NetDDE Agent, which is part of NetDDE. Because
NetDDE is involved there is an active connection to the server that you
cannot readily break.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are currently three possible workarounds.
<P>
NOTE: Save and close all files you have open that may be affected by the
following workarounds before you continue pursuing them. The three possible
workarounds are:

<UL><LI>Use File Manager (Winfile.exe) to override the lock on the drive
   mapping so you can disconnect it. When you disconnect the
   mapped drive, a message will appear that states "There are currently
   files open on &lt;mapped drive letter&gt;: (connected to \\server\share).
   If you do not close the files before disconnecting from the network
   device, data may be lost. Do you want to disconnect the device
   anyway?" Select YES to override the lock.

<LI>Use a utility such as Pview95 or Pviewer to view the processes
   currently in memory, and unload Nddeagnt from memory. After
   you terminate the NetDDE Agent from memory, NetDDE communication
   that involves the Nddeagnt component, such as Winchat, becomes
   inoperable. Stopping and restarting the NetDDE service(s) does not
   fix the problem. You must reload Nddeagnt.exe into memory by running
   it manually, from a command prompt or, from Start, use the Run option.

<LI>Break the connection (unplug from network) between the workstation
   and the associated server. The connection will timeout after a short
   period. You can then disconnect drive mapping, using the net
   use /d command from a command prompt.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: active process net use home directory map<BR>
Keywords          : kbbug3.50 kbbug3.51 kbbug4.00 ntdomain NTSrvWkst kbnetwork<BR>
Version           : WinNT:3.5,3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
