

<HTML>
<HEAD>
<TITLE>Why 16-Bit Windows Applications Run in Single VDM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100318">
<META NAME="KBModify" CONTENT="1997/05/06">
<META NAME="KBCreate" CONTENT="1993/06/20">
<META NAME="Keywords" CONTENT="kbother nt16ap ntgeneral">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" Windows NT provides a virtual MS-DOS machine (VDM) for all 32-bit Windows-based applications that acts as a complete environment for the application to run in. However, all 16-bit Windows-based applications run in a single VDM, sharing a single Win3...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBWS,QAJH,QDL9,QBWQ,QBWO,QBWN,QBMR,QA9Q,QAH4,QANE,QABE,QBSO,QA3A,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Why 16-Bit Windows Applications Run in Single VDM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100318</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
</UL> 
<P>
Windows NT provides a virtual MS-DOS machine (VDM) for all 32-bit
Windows-based applications that acts as a complete environment for
the application to run in. However, all 16-bit Windows-based
applications run in a single VDM, sharing a single Win32 subsystem
process. There are several reasons for this.
<P>
The VDM for 16-bit applications is actually a multithreaded Win32
application in which each 16-bit application runs in its own thread.
This enables the Win32 subsystem to do sophisticated things like have
a desynchronized message queue for 16-bit applications. This approach
is much more general and portable; it yields excellent performance on
RISC-based platforms and doesn't require any hacks at the device
driver level.
<P>
Also, there are many applications that must run in a single VDM in
order to function properly. Some examples are Microsoft Mail and
Schedule+. They share common code and data structures via dynamic link
libraries (DLLs); if run in separate VDMs they could seriously
malfunction. It is difficult to tell in advance which applications are
likely to break when run in separate VDMs, so this capability could be
dangerous.
<P>
Multiple VDM awareness and the large amount of effort required to use
the more complex and more powerful architecture working have made
separate VDMs for 16-bit Windows applications a low priority, too low
for the first release of Windows NT. However, it is understood, in
limited circumstances, that a relatively sophisticated user could make
very good use of separate 16-bit Windows VDMs. This feature will most
likely be added to the second release of Windows NT. Even so, some of
the problems stated above cannot be solved; there will be no guarantee
that everything will work as it should. OLE (Object Linking and
Embedding) version 2.0 is a good example of this because the 16-bit
Windows implementation requires a great deal of code sharing via DLLs;
this won't necessarily work across VDMs.
<P>
NOTE: As of Windows 3.5, Win16 apps in separate VDMs are supported in
Windows NT version 3.5. The interface is this: If running the item in
Program Manager, check "Run in Separate Memory Space" in the Program Item
Properties dialog box. If you are starting from the command prompt, the
"start" command now supports a /SEPARATE option.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt access database dbase fox<BR>
Keywords            : kbother nt16ap ntgeneral<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
