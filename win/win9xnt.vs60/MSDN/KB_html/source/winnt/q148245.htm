

<HTML>
<HEAD>
<TITLE>Upgrading from Uni- to Multi-Processor Requires Service Pack </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148245">
<META NAME="KBModify" CONTENT="1997/07/08">
<META NAME="KBCreate" CONTENT="1996/03/07">
<META NAME="Keywords" CONTENT="kbsetup ntreskit ntsetup kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article explains how to upgrade a uni-processor computer to a multi- processor computer for Windows NT 3.51. It also explains how to resolve the error message:     System Process - Driver Entry Point Not Found [popup]     The \SystemRoot\Syste...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDO3,QAC1,QBC9,QBC8,QANO,QDI2,QAB4,QAA5,QBKX,QAFI,QAU9,QDNN,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Upgrading from Uni- to Multi-Processor Requires Service Pack</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148245</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
<LI>Microsoft Windows NT Resource Kit version 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to upgrade a uni-processor computer to a multi-
processor computer for Windows NT 3.51. It also explains how to resolve the
error message:
<P>
<PRE>   System Process - Driver Entry Point Not Found [popup]

   The \SystemRoot\System32\drivers\srv.sys device driver could
   not locate the entry point RtllsNameLegalDOS8Dot3 in driver
   NTOSKRNL.EXE?.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Compaq Computers</h3>
 
<P>
If you install Windows NT 3.51 on a Compaq uni-processor computer and you
want to upgrade the computer to support multi-processors, run SETUP.CMD
from the Compaq SSD version 1.17b or later. Select "Upgrade to multi-
processor support" (without quotation marks) to update the HAL.DLL and
NTOSKRNL.EXE to multi-processor versions.
<P>
For NON-COMPAQ machines, use the Windows NT Resource Kit Utility called
UPTOMP.EXE to perform the upgrade.
<P>
The setup program will you for the correct path to the Windows NT
installation directory. This is required to copy additional
support files needed to make Windows NT multi-processor aware.
<P>
The following files are copied and some are modified to support SMP on
Compaq computers:
<P>
<PRE>   HALSP.DLL     (renamed to HAL.DLL)
   WINSRV.DLL
   NTKRNLMP.EXE  (renamed to NTOSKRNL.EXE)
   KERNEL32.DLL
   NTDLL.DLL

</PRE>After you upgrade your processor using Compaq SSD version 1.17b (or later),
it is recommended that you modify SETUP.LOG (this allows future Microsoft
Service Packs to install properly), as follows:

<OL><P><LI>Find SETUP.LOG in the %SystemRoot%\Repair directory. This file has
   hidden and read-only file attributes.

<P><LI>Remove the file attributes using File Manager.

<P><LI>Using a text editor, such as Notepad, modify the [Files.WinNt] section
   to the following:
<P>
<P><PRE>      \&lt;%SystemRoot%&gt;\System32\Kernel32.dll = "KERNEL32.DLL","5d99a"
      \&lt;%SystemRoot%&gt;\System32\Winsrv.dll = "WINSRV.DLL","155a67"
      \&lt;%SystemRoot%&gt;\System32\Ntdll.dll = "NTDLL.DLL","5830f"
      \&lt;%SystemRoot%&gt;\System32\Ntoskrnl.exe = "NTKRNLMP.EXE","cb271"
</PRE>
<P><LI>Save SETUP.LOG.

<P><LI>Update or prompt recreate your Emergency Repair Disk using the RDISK
</OL>utility.
<P>
<P><h3>Possible Problem</h3>
 
<P>
If you are upgrading from single-processor to multi-processor support and
the Windows NT 3.51 Service Pack 3 (SP3) or later has already been applied
to your computer prior to the upgrade, the following error message may
appear:
<P>
<PRE>   System Process - Driver Entry Point Not Found [popup]

   The \SystemRoot\System32\drivers\srv.sys device driver could
   not locate the entry point RtllsNameLegalDOS8Dot3 in driver
   NTOSKRNL.EXE?.

</PRE></OL><h3>Cause</h3>
 
<P>
This problem occurs because the NTOSKRNL.EXE file copied from the Windows
NT compact disc is not compatible with the new SRV.SYS in Windows NT 3.51
Service Pack 3 or later. To correct this problem, run Setup again and
specify the location of the Windows NT files to the Windows NT Service Pack
3 (or later) compact disc.
<P>
<P><h3>Resolution</h3>
 
<P>
To resolve this problem, instead of pointing to the Windows NT 3.51 compact
disc, provide a path to the Windows NT SP3 or later installation directory.
This will allow the upgrade to copy the multi-processor version of the
NTOSKRNL.EXE file that is compatible with the SRV.SYS file that is already
in use.
<P>
If using UPTOMP.EXE make sure each file listed above is in the service pack
directory prior to performing the upgrade.
<P>
If you are currently receiving the above error message:

<OL><P><LI>Rename the file NTOSKRNL.EXE located in the %SystemRoot%\SYSTEM32
   directory.

<P><LI>Copy the NTKRNLMP.EXE (multi-processor kernel) file from the Windows NT
   3.51 Service Pack to the %SystemRoot%\SYSTEM32 directory.

<P><LI>Rename NTKRNLMP.EXE to NTOSKRNL.EXE.

<P><LI>Reboot.
<P>
</OL><h3>Supported Non-Compaq Computers</h3>
 
<P>
For non-Compaq computers, use UPTOMP.EXE in the Windows NT Resource Kit to
upgrade from uni-processor to multi-processor. Ensure that the required HAL
along with the TXTSETUP.SIF file located on the Windows NT 3.51 compact
disc is also copied to the Windows NT 3.51 Service Pack 3 or later source
directory.
<P>
If the "Driver Entry Point Not Found" error message appears again, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q138713.htm">Q138713</A></B>
   TITLE     : Err Msg: Driver Entry Point Not Found After Service Pack
               Upgrade

</PRE><P><LI>Find SETUP.LOG in the %SystemRoot%\Repair directory. This file has
   hidden and read-only file attributes.

<P><LI>Remove the file attributes using File Manager.

<P><LI>Using a text editor, such as Notepad, modify the [Files.WinNt] section
   to the following:
<P>
<P><PRE>      \&lt;%SystemRoot%&gt;\System32\hal.dll = "halmps.dll","18039"
      \&lt;%SystemRoot%&gt;\System32\Kernel32.dll = "KERNEL32.DLL","5d99a"
      \&lt;%SystemRoot%&gt;\System32\Winsrv.dll = "WINSRV.DLL","155a67"
      \&lt;%SystemRoot%&gt;\System32\Ntdll.dll = "NTDLL.DLL","5830f"
      \&lt;%SystemRoot%&gt;\System32\Ntoskrnl.exe = "NTKRNLMP.EXE","cb271"
</PRE>
<P><LI>Save SETUP.LOG.

<P><LI>Update or recreate your Emergency Repair Disk using the RDISK utility.
<P>
</OL>**NOTE: The HAL file may vary depending on Multi-processor machine your
using and may need to modify the 1st line in acordance to the HAL file
name.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt 3.51<BR>
Keywords            : kbsetup ntreskit ntsetup kbsetup<BR>
Version             : 3.51<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
