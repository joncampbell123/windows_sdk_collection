

<HTML>
<HEAD>
<TITLE>Unattended Setup Disables EnableDHCPFlag on Second Adapter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177267">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1997/11/24">
<META NAME="Keywords" CONTENT="kbbug4.00 ntsetup NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you perform an unattended installation on a system that is multihomed and the answer file (Unattend.txt) has the parameter DHCP = YES in the TCP/IP parameters section, only the first adapter will receive an IP address. The second adapter will ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QBWD,QAI4,QAA1,QDJG,QDI2,QDIZ,QANE,QAHE,QDIU,QAV1,QAV0,QALZ,QAH4,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unattended Setup Disables EnableDHCPFlag on Second Adapter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177267</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you perform an unattended installation on a system that is multihomed
and the answer file (Unattend.txt) has the parameter DHCP = YES in the
TCP/IP parameters section, only the first adapter will receive an IP
address. The second adapter will be set to use a static IP address in which
the IP address and subnet mask are blank.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is caused by the EnableDHCPFlag in Oemnxptc.inf being set to 0 (zero),
which means off, for the second adapter.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, modify the Oemnxptc.inf file on the
distribution share so that it checks to see if STF_GUI_UNATTENDED is set to
YES.

<OL><P><LI>On your distribution share, expand the Oemnxptc.in_ file by typing the
   following at the command prompt:
<P>
<P><PRE>      Expand Oemnxptc.in_ Oemnxptc.inf
</PRE>
<P><LI>Rename the compressed Oemnxptc.in_ file to Oemnxptc.sav.
<P>
   This step is required because this not only offers a backup copy of the
   file but the setup program will always use the compressed version of the
   file if both are present.

<P><LI>Use any text editor to modify the following section of the .inf file:
<P>
   Before modifications are made:
<P>
   [InstallOption]
<PRE>      set Option   = $($1)
      set SrcDir   = $($2)
      set AddCopy  = $($3)
      set DoCopy   = $($4)
      set DoConfig = $($5)
      set InstallFromRas = $($6)
      set EnableDHCPFlag = $($7)
      set InstallList = $($8)
      ifstr(i) $(EnableDHCPFlag) == ""
        set EnableDHCPFlag = 0
        Debug-Output "DHCP Phase 1 Flag :"$(EnableDHCPFlag)
        Debug-Output "DHCP Phase 1 Adapter :"$(EnableDHCPForThisAdapter)
      endif
      ifstr(i) $(InstallList) == ""
          set InstallList = {"1","1","0","0","0","0","0","0"}

   After modification are made:

   [InstallOption]
      set Option   = $($1)
      set SrcDir   = $($2)
      set AddCopy  = $($3)
      set DoCopy   = $($4)
      set DoConfig = $($5)
      set InstallFromRas = $($6)
      set EnableDHCPFlag = $($7)
      set InstallList = $($8)
      ifstr(i) $(EnableDHCPFlag) == ""
        set EnableDHCPFlag = 0
   ;**************modified code begins here****************
        Ifstr(i) $(!STF_GUI_UNATTENDED) == YES
            set EnableDHCPFlag = 1
        endif
   ;**************Modifications end here******************
        Debug-Output "DHCP Phase 1 Flag :"$(EnableDHCPFlag)
        Debug-Output "DHCP Phase 1 Adapter :"$(EnableDHCPForThisAdapter)
      endif
      ifstr(i) $(InstallList) == ""
          set InstallList = {"1","1","0","0","0","0","0","0"}

</PRE><P><LI> Save the file and begin your unattended setup.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft Windows NT
version 4.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: unattend two NIC<BR>
Keywords          : kbbug4.00 ntsetup NTSrvWkst kbsetup<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
