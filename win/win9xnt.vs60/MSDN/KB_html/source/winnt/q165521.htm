

<HTML>
<HEAD>
<TITLE>Configuring DNS for Windows NT Domain Validation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165521">
<META NAME="KBModify" CONTENT="1997/12/23">
<META NAME="KBCreate" CONTENT="1997/03/20">
<META NAME="Keywords" CONTENT="NTSrv nttcp kbenv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  In a network environment that uses only Domain Name Service (DNS) for name resolution, clients may not be able to log on to a Windows NT domain if they do not have a domain controller on their TCP/IP segment.  This article explains how to configure...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QA9A,QBWD,QBW3,QA5V,QARL,QAUJ,QAH6,QAPF,QAKR,QDL9,QBWQ,QBWO,QBWN,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Configuring DNS for Windows NT Domain Validation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165521</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In a network environment that uses only Domain Name Service (DNS) for name
resolution, clients may not be able to log on to a Windows NT domain if
they do not have a domain controller on their TCP/IP segment.
<P>
This article explains how to configure Microsoft Windows NT 4.0 DNS Server
so that clients can locate a domain controller and be validated on the
Windows NT Domain. These steps should also work on third-party DNS
servers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Below are examples of how to configure the DNS server and client so they
can perform Windows NT domain validation using DNS only for name
resolution. One advantage to using DNS instead of WINS for validation is
that you can control the Primary Domain Controller (PDC) and Backup Domain
Controller (BDC) server list that DNS will supply to the resolver. This
will prevent a remote BDC or PDC from setting up a secure channel with the
validation client and doing validation over a slow link.
<P>
<P><h3>Example 1</h3>
 
<P>
For the first example, the following names will be used:
<P>
<PRE>   DNS Domain: LEX.COM
   Windows NT Domain: NTDOMAIN

</PRE>To configure your DNS so that clients can locate Windows NT domain
controllers with DNS queries, perform the following steps:

<OL><P><LI>In the LEX.COM domain on the DNS server, create an A record for
   NTDOMAIN. For this A record, enter the IP address of your Windows NT
   domain controller.
<P>
   NOTE: Because you can have multiple A records for the NTDOMAIN
   resource, it is possible to specify certain domain controllers that
   will be returned when the DNS resolvers query the Windows NT domain
   name. To do this, simply create multiple A records for NTDOMAIN. For
   each A record, enter the IP address of the Windows NT domain
   controllers that you want to respond to domain name requests. These
   multiple A records will be given to clients in "round-robin" sequence,
   which will provide load-balancing for logging on to a Windows NT domain
   (and other domain functions) across all listed Windows NT domain
   controllers.

<P><LI>Configure each client's TCP/IP properties with your DNS domain name (in
   this example, LEX.COM). This step is important because, when the DNS
   client (resolver) attempts to resolve the domain name, it does a b-node
   broadcast on its subnet for the NTDOMAIN domain. If it receives no
   reply (because the Windows NT domain controller is on another segment),
   it will do one of the following:
<P>
<P><PRE>    - If a WINS server is specified on the client, the query for the
      &lt;NTDOMAIN&gt;1Ch entry will then go to the WINS server. If the WINS
      server has a &lt;domain name&gt;1Ch entry for the domain controller(s),
      the client uses that server (PDC or BDC) address for Windows NT
      domain validation.
</PRE><P>
<P><PRE>    - If a WINS server is not specified, or cannot be contacted, the
      client sends a query to the DNS server with the Windows NT domain
      name, and appends the DNS domain name to that name. So in this
      example, it sends a query for NTDOMAIN.LEX.COM to the DNS. If step 1
      has been completed, the DNS server will respond with one of the IP
      addresses named NTDOMAIN in the LEX.COM domain. The client receives
      this Windows NT domain controller IP address and sends its request
      for domain logon validation to that Windows NT Domain Controller.
</PRE><P>
</OL><h3>Example 2</h3>
 
<P>
In the special case where the Windows NT domain name has a period (.) in
the name, such as NTDOMAIN.COM, the A record creation is slightly
different. In the following example, substitute your Windows NT domain
name that contains a period where the example uses NTDOMAIN.COM.
<P>
In this example, perform the following steps:

<OL><P><LI>In the LEX.COM domain on the DNS Server, create a subdomain called COM.

<P><LI>In the COM subdomain, create an A record named NTDOMAIN, and enter the
   IP address of your Windows NT domain controller.
<P>
   NOTE: Because you can have multiple A records for the NTDOMAIN
   resource, it is possible to specify certain domain controllers that
   will be returned when the DNS resolvers query the Windows NT domain
   name. To do this, simply create multiple A records for NTDOMAIN. For
   each A record, enter the IP address of the Windows NT domain
   controllers that you want to respond to domain name requests. These
   multiple A records will be given to clients in "round-robin" sequence,
   which will provide load-balancing for logging on to a Windows NT domain
   (and other domain functions) across all listed Windows NT domain
   controllers.

<P><LI>Configure each client's TCP/IP properties with your DNS Domain Name (in
   this example, LEX.COM). This step is important because, when the DNS
   client (resolver) attempts to resolve the domain name, it does a b-node
   broadcast on its subnet for the NTDOMAIN.COM domain. If it receives no
   reply (because the Windows NT domain controller is on another segment),
   it will do one of the following:
<P>
<P><PRE>    - If a WINS server is specified on the client, the query for the the
      &lt;domain name&gt;1Ch entry will then go to the WINS server. If the WINS
      server has a &lt;domain name&gt;1Ch entry for the domain controller(s),
      then the client uses that server (PDC or BDC) address for Windows NT
      domain validation.
</PRE><P>
<P><PRE>    - If a WINS server is not specified, or cannot be contacted, the
      client sends a query to the DNS server with the Windows NT domain
      name and appends the DNS domain name to that name. So, in this
      example, it sends a query for NTDOMAIN.COM.LEX.COM to the DNS. If
      step 1 has been completed, the DNS server will respond with one of
      the IP Addresses named NTDOMAIN in the COM subdomain within the
      LEX.COM domain. The client receives this Windows NT domain
      controller IP address, and sends its request for domain logon
      validation to that Windows NT domain controller.
</OL></PRE> 
<PRE>Keywords          : NTSrv nttcp kbenv
Version           : WinNT:3.5,3.51,4.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
