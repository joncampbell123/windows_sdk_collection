

<HTML>
<HEAD>
<TITLE>REG: Microsoft Mail Entries, PART 1 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102961">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/08/12">
<META NAME="Keywords" CONTENT="kbother ntregistry">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" This is the first of three articles on the MS Mail entries; for the other entries, see  Microsoft Mail Entries, Part 2  and  Microsoft Mail Entries, Part 3 .  REGISTRY ENTRIES FOR MICROSOFT MAIL  The parameters used by the Microsoft Mail application...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QBWP,QAD2,QBXB,QBV8,QAB9,QAUJ,QAF0,QAVI,QAEV,QBV0,QARW,QBBI,QAMB,QATX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>REG: Microsoft Mail Entries, PART 1</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102961</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Windows NT operating system version 3.1
<LI>Windows NT Advanced Server version 3.1
<P>
</UL>The article contains REGISTRY entries for Microsoft Mail, Part 1. These
subgroups are included:

<UL><LI>Address Book Entries for Mail
<LI>Custom Commands Entries for Mail
<LI>Custom Messages Entries for Mail
<LI>Custom Menus Entries for Mail
</UL> 
<P>
This is the first of three articles on the MS Mail entries; for the other
entries, see "Microsoft Mail Entries, Part 2" and "Microsoft Mail Entries,
Part 3".
<P>
<P><h2>REGISTRY ENTRIES FOR MICROSOFT MAIL</h2>
 
<P>
The parameters used by the Microsoft Mail application provided with Windows
NT appear under this subkey:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Mail

</PRE>This key includes the following subkeys:
<P>
<PRE>Subkey             Purpose
</PRE> 
<P>
<PRE>Address Book       Secifies entries used by the Address Book support
                   functions for the Mail program.
Custom Commands    Specifies a custom command that can be installed into
                   one of the Mail menus at run-time.
Custom Messages    Specifies a custom message type that is installed into a
                   Mail menu at run-time.
Custom Menus       Specifies a custom menu name to be added to the Mail
                   menu bar.
Microsoft Mail     Defines the configuration of the Mail program, and the
                   Microsoft Mail transport and name service.
MMF                Affects the automatic compression of the Mail message
                   file.
Mac File Types     Defines the mapping from Macintosh file type and creator
                   tags into eight-plus-three character filename
                   extensions.
</PRE>MS Proofing Tools  Defines settings for the speller.
<PRE>Providers          Defines settings that service providers use Microsoft
                   Mail front-end programs.

</PRE>Many of the entries in these subkeys have default values and won’t be
present in the Mail subkeys. To change the appearance and behavior of the
Mail application, use the Mail menu commands instead of editing the Mail
entries directly. Some of the options that you specify in the Mail
application are stored in your mail message file (.MMF) instead of the Mail
Registry entries.
<P>
These keys are created in HKEY_CURRENT_USER when you first run Mail. If
your system previously contained a Windows for MS-DOS version of
MSMAIL.INI, its contents are migrated to the Registry when you first run
Mail under Windows NT.
<P>
<P><h2>ADDRESS BOOK ENTRIES FOR MAIL</h2>
 
<P>
Entries in this subkey are used by the Address Book support functions in
the Mail program. Most of the entries for this subkey use default values
specified by the Mail program, and the Address Book subkey might not be
present under the Mail key. The entries in this subkey control the default
address directory displayed in the Address Book. Do not change any of these
entries if they appear.
<P>
This is the Registry path for this subkey:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Mail\Address Book

</PRE><h2>CUSTOM COMMANDS ENTRIES FOR MAIL</h2>
 
<P>
Each entry under this key specifies a custom command that can be installed
into one of the Mail menus at run-time. These entries can appear both in
the Microsoft Mail key and in the SHARED32.INI file in the directory
defined under the Microsoft Mail subkey as the value of
SharedExtensionsDir.
<P>
This is the Registry path for this subkey:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Mail\Custom Commands

</PRE>The Custom Commands subkey can contain one or more of the following
entries:
<P>
<P><h3>tag   REG_SZ</h3>
 
<P>
This specifies the descriptive identifier for the command in the
following format:
<P>
<PRE>   tag= version;menu;name;position;DLL name, ordinal;command;
        event map;status text;Help file;help context;

</PRE>For example:
<P>
<PRE>   IC1= 3.0;help;&amp;Out of Office;10;&lt;ExtsDir&gt;BIN-EXT\OOF32.DLL;3;;
        Out of Office Email Notification

Value         Meaning
</PRE> 
<P>
<PRE>version       The version of Mail that the custom command is compatible
              with.
menu          The menu where the custom command is to be added, such as
              File or Help.
name          The command name to appear on the menu. Include an ampersand
              just before the letter that is to serve as an ALT+key
              accelerator.
position      The zero-relative position within its menu where the command
              is to appear. A menu value of -1 places the command at the
              end of the menu.
DLL           Name or path of the DLL where the custom command resides.
              This entry can optionally be followed by a comma and the
              ordinal of the entry point to call (default is ,1).
command       The command string passed as one of the parameters to the
              DLL entry point for the command.
event map     A sequence of up to 16 digits identifying the Mail events
              that the custom command supports. Each can be 0 or 1 to
              indicate if the DLL is to be called for a specific event.
              Currently, three events are defined; the rest are reserved
              and must be zero (or, as in the examples above) this whole
              section can be empty:
                 The first digit means Mails startup.
                 The second digit means Mail exit.
                 The third digit means the arrival of a new message.
status text   Text to be displayed in the Mail status bar when the user
              highlights the command in the menu.
Help file     Windows NT Help file to be invoked when the user presses F1
              while the command is selected. The specified filename is
              passed to the Windows NT Help program. (Optional)
Help          Passed to the Windows NT help program along with context the
              Help file name. Use -1 (Help file index) if there is no
              specific entry in the Help file for this command.
&lt;ExtsDir&gt;     A special token that can appear within certain fields.
              Expands to the value of SharedExtensionsDir in the Microsoft
              Mail key. used to refer to DLLs that are installed in a
              shared network. Valid fo the Dll name, command, and Help
              file subfields.

</PRE><h2>CUSTOM MESSAGES ENTRIES FOR MAIL</h2>
 
<P>
This subkey is similar in many ways to the Custom Commands subkey. Each
entry specifies a custom message type to be installed into a Mail menu at
run-time.
<P>
These entries can appear both in the Microsoft Mail key and in the
SHARED32.INI file in the directory defined by the SharedExtensionsDir entry
under the Microsoft Mail key.
<P>
This is the Registry path for this subkey:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Mail\Custom Messages

</PRE>The Custom Messages subkey can contain one or more of the following
entries.
<P>
<PRE>class   REG_SZ
</PRE> 
<P>
Specifies a string uniquely identifying the message type. Mail places this
string in messages and calls custom message DLLs based on its value. Each
entry is in the following format:
<P>
<PRE>   class = version;menu;name;position;DLL name;command;operation map;
           status text;Help file;help context;

Value        Meaning
</PRE> 
<P>
<PRE>version      the version of Mail that the custom message is compatible
             with.
menu         The menu where the custom command for the message type is to
             be added, such as File or Mail.
name         The command name to appear on the menu. Include an ampersand
             just before the letter that is to serve as an ALT+key
             accelerator.
position     The zero-relative position within its menu where the command
             is to appear. A menu value of -1 places the command at the
             end of the menu.
DLL          Name or path of the DLL where the custom command resides.
             This entry can optionally be followed by a comma and the
             ordinal of the entry point to call (default is ,1).
command      The command string passed as one of the parameters to the DLL
             entry point for the command.
operation    Sequence of up to 16 digits. Each can be 0, 1 or 2, where 0
map          indicates that Mail is to perform its standard operation on
             the custom message. 1 indicates that the DLL is to be called
             to handle the operation. 2 indicates that the operation is to
             be completely disabled. Currently eight operations are
             defined; the rest are reserved and must be zero. In the
             following list, 0 is the leftmost digit.
                0  Compose (menu command defined in this entry)
                1  File.Open
                2  Mail.Reply
                3  Mail.Reply to All
                4  Mail.Forward
                5  File.Print
                6  File.Save as
                7  Arrival of new mail
</PRE>status text  Text to be displayed in the Mail status bar when the user
<PRE>             highlights the command in the menu.
Help file    Windows NT Help file to be invoked when the user presses F1
             while the command is selected. The specified filename is
             passed to the Windows NT Help program. (Optional)
Help         Passed to the Windows NT hlp program along with
context      the Help file name. Use -1 (Help file index) if there is no
             specific entry in the Help file for this command.
&lt;ExtsDir&gt;    A special token that can appear within certain fields.
             Expands to the value of SharedExtensionsDir in the Microsoft
             Mail key. used to refer to DLLs that are installed in a
             shared network. Valid fo the Dll name, command, and Help file
             subfields.

</PRE><h2>CUSTOM MENUS ENTRIES FOR MAIL</h2>
 
<P>
This subkey can contain any number of entries (within reason). You can use
these menus to group custom commands and/or messages under a single,
distinctive menu item.
<P>
This is the Registry path for this subkey:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Mail\Custom Menus

</PRE>The following information can appear both in the Microsoft Mail key and in
SHARED32.INI in the directory defined by SharedExtensionsDir under the
Microsoft Mail key. The SHARED32.INI file is examined
first.
<P>
<P><h3>tag   REG_SZ</h3>
 
<P>
Identifies the menu to someone reading these values but serves no other
purpose. Specifies a menu name to be added to the Mail menu bar. This is
the format:
<P>
<PRE>   Tag=version;name;name to follow;status text

</PRE>For example:
<P>
<PRE>   tools=3.0;&amp;Tools;Window;Useful development toys


Value      Meaning
</PRE> 
<P>
<PRE>version    the version of Mail that the custom message is compatible with;
           3.0 is the current version.
name       The menu name to be added to the menu bar. Include an ampersand
           just before the letter that is to serve as an ALT+key
           accelerator.
name to    Name of an existing menu. The new menu is
follow     added directly before it.
status     Text to be displayed in the Mail status bar
text       when the user highlights the menu name.


</PRE>Reference: "The Windows NT Resource Kit for Operating System, Version 3.1".
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbother ntregistry<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
