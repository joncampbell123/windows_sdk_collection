

<HTML>
<HEAD>
<TITLE>Recovering from Stop 21A Caused by Disk Mirror Sets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139843">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1995/11/16">
<META NAME="Keywords" CONTENT="ntboot ntgeneral NTSrv kbenv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If the Hkey_Local_Machine\System\Disk key gets corrupted or the Windows NT Disk signature on the System drive is removed or changed (and the system drive is part of a Windows NT software level mirror set) you will receive the following error messag...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAC9,QALX,QAB4,QBWS,QDIV,QAIJ,QAGB,QAEF,QBXS,QA5V,QAY2,QABI,QDK2,QBDM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Recovering from Stop 21A Caused by Disk Mirror Sets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139843</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the Hkey_Local_Machine\System\Disk key gets corrupted or the Windows NT
Disk signature on the System drive is removed or changed (and the system
drive is part of a Windows NT software level mirror set) you will receive
the following error message and STOP message upon restart:
<P>
<PRE>   Autochk program not found. Skipping autocheck.

</PRE>Immediately following the error message above, the next error message will
appear:
<P>
<PRE>   STOP: c000021a {Fatal System Error}
   The Session Manager Initialization system process terminated
   unexpectedly with a status of 0xc0000013 (0x00000000 0x00000000).
   The system has shutdown.

</PRE><h2>CAUSE</h2>
 
<P>
This is caused by the File system indicator byte in the master boot record
(MBR) of the boot drive (that is set to Fault tolerant) but the Windows NT
Registry does not contain FT Information about the drive or partition that
is mirrored. This can also be caused by a corrupt Ftdisk.sys device driver.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you have the Windows NT 4.0 Resource Kit, you can use the Disksave.exe
utility to remove the fault tolerant bit in the MBR.
<P>
To remove the fault tolerant bit in the MBR, perform the following steps:

<OL><P><LI>Boot your computer from an MS-DOS version 6.XX Disk.

<P><LI>Run the Disksave.exe utility, and select the F6 option.
<P>
   This will reset the high order bit of the system ID Byte of the active
   partition on disk zero (boot drive only). This will not work if Windows
   NT is installed on a logical drive in an extended partition.

<P><LI>Quit Disksave and restart the computer to Windows NT.

<P><LI>When you enter Windows NT, go to Disk Administrator and break the
   mirror, restart and re-establish the mirror.
<P>
</OL>-or-
<P>
To fix this problem, you will need a third-party disk editor, such as
Norton Diskedit.
<P>
To change this, do the following:
<P>
NOTE: Norton diskedit is used in the following example.

<OL><P><LI>Format a floppy disk with MS-DOS 5.0 or greater using the /s switch to
   make the disk bootable.

<P><LI>Find a copy of Norton Diskedit and place Diskedit.exe on the floppy
   disk.
<P>
</OL>NOTE: Make sure the floppy disk is scanned with the latest virus software
and write protect the disk after formatting. Booting with a floppy disk is
one way that viruses are transferred to the boot drive.

<OL><P><LI>Place the floppy disk in the drive and start the computer. Run Diskedit
   from the floppy disk.
<P>
<P><PRE>      A. From the OBJECT menu, select DRIVE..
</PRE><P>
<P><PRE>      B. Select TYPE - Physical Disk and select Hardisk1.
</PRE><P>
<PRE>         NOTE: The BIOS must be enabled on the SCSI Host Bus adapter to see
         the Physical drive, click OK.

       This will dump you out at Cyl 0 Side 0 Sector 1, this is the Master
       Boot Record of the disk.

      C. Go down to line 000001C0: and find the third byte, this is the
         File System Indicator.

         NOTE: If you have a Compaq computer with an EISA partition, go
         down to line 000001D0.

         It will have one of two values:

            86 = Fat mirror
            87 = NTFS mirror

      D. Change this value to 06 or 07 depending of the type of file
         system on the drive.

      E. From the Edit menu, select Write Changes.

      F. Quit Diskedit and restart the computer to Windows NT. When
         entering Windows NT, go to Disk administrator and break the
         mirror, restart and reestablish the mirror.

         NOTE: If more than one mirror set was on the system, they will
         show up in disk administrator without a drive letter. Just assign
         one in disk administrator.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt fault tolerence ft<BR>
Keywords          : ntboot ntgeneral NTSrv kbenv<BR>
Version           : WinNT:3.1,3.5,3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
