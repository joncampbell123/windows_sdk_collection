

<HTML>
<HEAD>
<TITLE>Automating AFTP Commands Through a Script File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152013">
<META NAME="KBModify" CONTENT="1996/07/25">
<META NAME="KBCreate" CONTENT="1996/05/31">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Microsoft SNA Server 2.11 includes support for the APPC File Transfer Protocol (AFTP), which implements FTP-like commands over an LU6.2 session, as defined by IBM. The SNA Server 2.11 readme file includes information on how to automate the use of A...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QAB9,QBV8,QART,QAH6,QAM2,QBW9,QAUJ,QARL,QAI5,QBWP,QAVI,QAGB,QAYY,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Automating AFTP Commands Through a Script File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 25, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152013</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft SNA Server for Windows NT, version 2.11 and Service Pack 1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft SNA Server 2.11 includes support for the APPC File Transfer
Protocol (AFTP), which implements FTP-like commands over an LU6.2 session,
as defined by IBM. The SNA Server 2.11 readme file includes information on
how to automate the use of AFTP commands by passing an inputfile (attached
below).
<P>
However, if an AFTP command is invoked from a batch (BAT or CMD) file and
the command fails, no ERRORLEVEL value is returned, so batch file error
recovery is not possible.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information is included in the SNA Server 2.11 readme file,
which describes how to automate the use of AFTP.
<P>
 
<P>
D.13. Automating AFTP client sessions
<P>
You can supply a script file to the AFTP client that contains commands for
the AFTP client to carry out. The syntax of the AFTP command when used in
this manner is:
<P>
<PRE>   aftp -f  inputfile

</PRE>where inputfile is the name of the script file.
<P>
When the AFTP client is invoked using the -f command-line parameter, it
executes each line in the specified script as a command and then terminates
when it reaches the end of the file.
<P>
For example, a file named Input.txt contains the following lines:
<P>
<PRE>   open aftprrr
   steved
   pword
   ascii
   get file1.txt
   close

</PRE>The command aftp -f input.txt would do the following:

<OL><P><LI>Connect to a remote LU named aftprrr.

<P><LI>Log on with the user name steved and the password pword.

<P><LI>Select ASCII transfer mode.

<P><LI>Download a file named FILE1.TXT.

<P><LI>Close the connection.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: snaaftp<BR>
Additional reference words: prodsna<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 25, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
