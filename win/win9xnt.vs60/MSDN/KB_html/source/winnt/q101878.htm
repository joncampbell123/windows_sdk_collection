

<HTML>
<HEAD>
<TITLE>Windows NT RAS Server Port Reset </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101878">
<META NAME="KBModify" CONTENT="1997/10/28">
<META NAME="KBCreate" CONTENT="1993/07/26">
<META NAME="Keywords" CONTENT="NTRAS NTSrvWkst kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Windows NT Remote Access Server attempts to reset its serial ports when it detects that the phone line has been hung up. The server detects a disconnect when either Data Carrier Detect (DCD) or Data Set Ready (DSR) signals are dropped by the server...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QBXS,QAS6,QANE,QBXT,QBVV,QA5V,QAIB,QABI,QDJ9,QDJP,QAKG,QAYY,QA1S,QA8O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows NT RAS Server Port Reset</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101878</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows NT Remote Access Server attempts to reset its serial ports
when it detects that the phone line has been hung up. The server
detects a disconnect when either Data Carrier Detect (DCD) or Data Set
Ready (DSR) signals are dropped by the server's modem. After a few
seconds, the server sends an initialization string to the modem,
putting the modem in auto-answer mode, and configures the modem
options. In Windows NT 4.0, the initialization string is pulled from the
particular manufacturer's Mdm*.inf file. In Windows NT versions prior to NT
4.0, the initialization string is pulled from the Modem.inf file for the
particular modem type.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Data Carrier Detect (DCD)</h3>
 
<P>
Pin 8 on a DB 25 serial connector. This line is set high by the server
modem when it is receiving a carrier signal from the remote modem. The
carrier signal is a tone at a specific frequency that, by itself, does
not carry any information. Information is actually conveyed by changes
in the carrier signal's amplitude, frequency, phase, or some
combination. When a phone line is disconnected, the carrier tone is
interrupted. This causes the DCD signal to be dropped.
<P>
<P><h3>Data Set Ready (DSR)</h3>
 
<P>
Pin 6 on a DB 25 serial connector. When this signal is high, it
indicates that the modem is powered on and is ready to receive
commands.
<P>
<P><h3>Troubleshooting</h3>
 
<P>
If you hang up your Remote Access Server (RAS) client and your RAS
server modem does not reset to receive a new call, you may be having
troubles with DSR or DCD. On the server, look at the port status in
the RAS Admin application. If the port status says "Connected, user
authenticated" even though the modem is disconnected, this indicates a
problem. Check your serial cable wiring with the RAS requirements
found in the online help files. If the modem is not wired properly,
the DCD or DSR signals may not be received by the server.
<P>
Some modems allow you to override DSR and DCD with dip switches and
modem commands. Make sure these signals are allowed to function
normally. These problems sometimes show themselves as the server not
resetting the port until the AUTODISCONNECT timer expires. The line
disconnects but the server does not detect it. The server leaves the
line open, waiting for more data. However, more data never arrives.
After the server waits for AUTODISCONNECT time (20 minutes is the
default), it drops the line and sends the initialization strings that
will reset the modem.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt  NTRAS<BR>
Keywords          : NTRAS NTSrvWkst kbnetwork<BR>
Version           : 3.1 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
