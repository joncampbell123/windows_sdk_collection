

<HTML>
<HEAD>
<TITLE>Unattended Windows NT Setup Always Sets Up the Network </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133272">
<META NAME="KBModify" CONTENT="1997/03/21">
<META NAME="KBCreate" CONTENT="1995/07/27">
<META NAME="Keywords" CONTENT="kbbug3.50 kbbug3.51 kbsetup ntsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT=" SYMPTOM  The unattended installation method available with Windows NT Setup sets up the network, even if the !SetupNetwork value in the answer file, UNATTEND.TXT, is changed from YES to NO.  NOTE: The answer file, UNATTEND.TXT, is shipped with the W...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBWP,QDI2,QAYL,QBXS,QAH4,QAAP,QDIZ,QAKD,QAG7,QDNL,QBKX,QAVZ,QAKP,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unattended Windows NT Setup Always Sets Up the Network</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133272</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SYMPTOM</h2>
 
<P>
The unattended installation method available with Windows NT Setup sets up
the network, even if the !SetupNetwork value in the answer file,
UNATTEND.TXT, is changed from YES to NO.
<P>
NOTE: The answer file, UNATTEND.TXT, is shipped with the Windows NT 3.5
Resource Kit.
<P>
<P><h2>CAUSE</h2>
 
<P>
The following two errors in the INITIAL.INF file cause this problem:

<UL><LI>Setup compares the value of the variable $(!STF_NTUPGRADE) in
   INITIAL.INF to the incorrect value YES, without quotes. The comparison
   value should be "YES", with quotes, instead.
<P>
   Here is the code fragment showing the problem in the fourth line:
<P>
   ifstr(i) $(!STF_GUI_UNATTENDED) == "YES"
<PRE>           shell "subroutn.inf" GetDefaultAnswer "GuiUnattended"
   ;;;;;;;;Incorrect String Compare Below;;;;;;;;;;;;;
           ifstr(i) $(!STF_NTUPGRADE) != YES
               ifstr(i) $(!SetupNetWork) == "NO"
                   set !DoNetwork = $(NotChosen)
               endif
               ifstr(i) $(!SetupApplications) == "NO"
                   set !DoAppSetup = $(NotChosen)
               endif
               set !DoPartial = $(NotChosen)
               set !DoPrinter = $(NotChosen)
           else
               set !STF_GUI_UNATTENDED = "NO"
           endif
       endif

</PRE><LI>Setup compares the value of the variable $(DoNetwork) in INITIAL.INF to
   the incorrect variable of $(!Chosen). The comparison variable should be
   $(!NotChosen), instead.
<P>
<P><PRE>      Incorrect code in INITIAL.INF:
<PRE></PRE>         ntlanman = +
         ifstr(i) $(DoNetwork) == $(!Chosen)

      Corrected code:
         ntlanman = +
         ifstr(i) $(DoNetwork) == $(!NotChosen)

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT versions 3.5 and
3.51.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt reskit Resource Kit<BR>
Keywords            : kbbug3.50 kbbug3.51 kbsetup ntsetup<BR>
Version             : 3.5 3.51<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
