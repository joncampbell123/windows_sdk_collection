

<HTML>
<HEAD>
<TITLE>WinNT Err: DHCP Specified Range Overlaps Or Already Exists </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164330">
<META NAME="KBModify" CONTENT="1998/01/13">
<META NAME="KBCreate" CONTENT="1997/02/27">
<META NAME="Keywords" CONTENT="kbhowto NTSrv nttcp ntui kbenv kberrmsg kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When you create a new DHCP scope, one of the following error messages may be displayed:     The specified range either overlaps with an already existing    range or is invalid.     The specified subnet already exists.  CAUSE =====  One possible cau...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QBWD,QAIJ,QBWP,QAR5,QDMR,QBW4,QAJQ,QDJG,QAL3,QAB4,QAJB,QDIV,QBBI,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WinNT Err: DHCP Specified Range Overlaps Or Already Exists</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164330</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you create a new DHCP scope, one of the following error messages may
be displayed:
<P>
<PRE>   The specified range either overlaps with an already existing
   range or is invalid.

   The specified subnet already exists.

</PRE><h2>CAUSE</h2>
 
<P>
One possible cause is documented in the Microsoft Knowledge Base article:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q129122.htm">Q129122</A></B>
   TITLE     : DHCP: Excluding an Address Before Lease Expires Gives Error

</PRE>However, if this is a brand new scope, it is more likely that the scope is
subnetted, and the Start Address and End Address overlap two or more
subnets.
<P>
For example, an Internet Service Provider (ISP) provides a scope of
addresses for a customer, from 205.241.139.160 to 205.241.139.223 and a
subnet mask of 255.255.255.160. Trying to create a single scope with this
starting/ending range, and using the supplied subnet mask prompts the user
with the error message shown above.
<P>
DHCP Manager performs a calculation on the information the user supplies
and detects that the ranges of addresses do not all exist within the same
subnet. The user can verify this themselves by performing an AND-ing
operation against the Start Address and the Subnet Mask and also against
the End Address and the Subnet Mask. Then, the user can compare the two
resulting values, if they do not match, then the starting and ending
addresses are not part of the same subnet.
<P>
<PRE>   NOTE: AND-ing is the process of comparing 2 bits (in this case, each
   bit of the IP address and subnet mask). If both bits are 1, then the
   result becomes 1. If either bit of the IP address OR subnet mask are
   0, then the result is 0. In the result below, where there are 1
   values, you can see that the IP address and subnet mask both have 1
   for that particular bit. Otherwise, the result for that bit is 0.

</PRE>To verify that this is the problem, the user can perform the AND-ing
operation using the following steps:
<P>
<PRE>   NOTE: Windows NT Calculator, in scientific mode, can be used to convert
   decimal values to binary equivalent. Each binary octet should consist
   of eight (8) characters, if the calculator returns a value with only
   seven (7) or fewer characters, then append the appropriate number of
   zeroes (0) to the beginning of each octet so that all octets consist of
   eight (8) characters.

</PRE><P><LI>Convert each octet of the Start Address to binary (in our case, it is
   only the last octet that is different, so we only need to convert the
   last octet, but for the purposes of this article, all four octets are
   converted).
<P>
   This example:  205.241.139.160 = 11001101.11110001.10001011.10100000

<P><LI>Convert each octet of the End Address to binary.
<P>
   This example:  205.241.139.223 = 11001101.11110001.10001011.11011111

<P><LI>Convert each octet of the Subnet Mask to binary.
<P>
   This example:  255.255.255.160 = 11111111.11111111.11111111.10100000

<P><LI>Perform an AND against the Start Address and the Subnet Mask.
<P>
   Start Address:  11001101.11110001.10001011.10100000
<PRE>   Subnet Mask:    11111111.11111111.11111111.10100000
   --------------  -----------------------------------
   Result #1:      11001101.11110001.10001011.10100000

</PRE><P><LI>Perform an AND against the End Address and the Subnet Mask.
<P>
   Start Address:  11001101.11110001.10001011.10100000
<PRE>   Subnet Mask:    11111111.11111111.11111111.11011111
   --------------  -----------------------------------
   Result #2:      11001101.11110001.10001011.10000000

</PRE><P><LI>Compare Result #1 and Result #2 - if they do not match, the scope
   overlaps a sub network.
<P>
<PRE>   Result #1:      11001101.11110001.10001011.10100000
   Result #2:      11001101.11110001.10001011.10000000
   --------------  -----------------------------------
                   same    .same    .same    .different --&gt; different
                                                             subnets

</PRE></OL>This error message will also be displayed if you attempt to create a scope
that has a beginning address that is the same as your network ID (scope
ID).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In the above example, the ISP provided a range of 64 addresses without
indicating that it was a range of addresses for two (2) sub-networks,
consisting of 32 addresses for each subnet. All you did then, was to
divide the range in two, resulting in the following two scopes:
<P>
<PRE>   This example: Scope #1:
                 Start Address - 205.241.139.160
                 End Address   - 205.241.139.191
                 Subnet Mask   - 255.255.255.160

                 Scope #2:
                 Start Address - 205.241.139.192
                 End Address   - 205.241.139.223
                 Subnet Mask   - 255.255.255.160

</PRE>If you calculated the subnets for the DHCP scope, type in a scope
(Starting and Ending Addresses) for each subnet you calculated,
individually. If the subnets were provided by a third party (such as an
ISP), ask them to provide a list of how the subnets are divided, including
the ranges of host IDs within each subnet. Use this list to create your
DHCP scopes.
<P>
<PRE>   NOTE: Versions of Windows NT DHCP server prior to Windows NT 4.0
   Service Pack 2 (SP2) are not capable of assigning addresses from more
   than one scope to a given physical subnet. One workaround for this
   situation is to add additional network interface cards (NICs) to the
   server, and to address each of the NICs to a given logical IP subnet.
   This involves additional and otherwise unnecessary hardware, so a new
   solution was developed and implemented in Windows NT 4.0 SP2. The
   enhanced DHCP server allows the administrator to create different
   scopes (ranges of IP addresses), and then to group those scopes
   together into a superscope. The procedure to create superscopes is
   described in the following Microsoft Knowledge Base article:

      ARTICLE-ID: <B><A href="../winnt/q161571.htm">Q161571</A></B>
      TITLE     : Using DHCP "Superscopes" to Serve Multiple Logical
                  Subnets
</PRE> 
<PRE>Keywords          : kbhowto NTSrv nttcp ntui kbenv kberrmsg kbnetwork
Version           : WinNT:3.5,3.51,4.0
Platform          : winnt
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
