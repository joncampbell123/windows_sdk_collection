

<HTML>
<HEAD>
<TITLE>Troubleshooting AT Command Using /k Switch </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142040">
<META NAME="KBModify" CONTENT="1997/11/14">
<META NAME="KBCreate" CONTENT="1996/01/03">
<META NAME="Keywords" CONTENT="NTSrvWkst ntutil kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  One way to troubleshoot a batch job that is scheduled to run using the AT command is to type the following at the MS-DOS command prompt:     AT         /interactive cmd.exe /k     where         is the time in hours and minutes.  Using the Windows N...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QBV8,QAB9,QAL4,QBWS,QBG2,QBTX,QAI5,QABI,QACK,QAVI,QAVZ,QACF,QAKR,QAHE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting AT Command Using /k Switch</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142040</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
One way to troubleshoot a batch job that is scheduled to run using the AT
command is to type the following at the MS-DOS command prompt:
<P>
<PRE>   AT &lt;xx.xx&gt; /interactive cmd.exe /k

   where &lt;xx.xx&gt; is the time in hours and minutes.

</PRE>Using the Windows NT Resource Kit utility Soon.exe, this command can be
simplified even further to run within the next 5 seconds automatically:
<P>
<PRE>  SOON /interactive cmd.exe /k

</PRE>Both of these commands open the MS-DOS command prompt at a scheduled
time and allow you to manually run the batch job.
<P>
If an MS-DOS command prompt does not open, then launch the Control Panel
Services applet and check to see if the Schedule service is started.
Click the Startup button and make certain that the System account is
selected; only the system account can interact with the desktop. Network
connections made under the System account use a null session for
credentials, so it may be necessary to supply a user name and password for
commands such as NET USE.
<P>
Before running your batch job, type the command "SET" in order to
understand the environment that the command scheduler is running under;
all environmental variables including the user name will be listed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The AT command syntax above allows you to troubleshoot situations where a
batch job runs successfully when it is executed from the command line, but
it does not work when you execute it using the AT command.
<P>
In addition to troubleshooting the batch job, do the following:

<OL><P><LI>Include the ECHO and PAUSE commands in your batch file so that you can
   narrow down the cause of the problem.

<P><LI>When you use the AT command, make sure you are using the correct
   schedule service account. In the Control Panel Services applet, verify
   the "Log On As" account for the Schedule service. This account
   determines whether the task scheduled to run has access to the network
   or the local computer.

<P><LI>Determine if the task requires interaction with the desktop. If so, use
   LocalSystem for the Schedule service. However, this means that network
   connectivity is not available unless you type the following at the
   command line:
<P>
   NET USE \\&lt;server name&gt;\&lt;share name&gt; /U:&lt;domain&gt;\&lt;user name&gt; &lt;password&gt;
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: tshoot scheduler winat<BR>
Keywords          : NTSrvWkst ntutil kbtshoot<BR>
Version           : WinNT:3.5,3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
