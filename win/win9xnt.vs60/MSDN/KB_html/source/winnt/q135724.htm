

<HTML>
<HEAD>
<TITLE>Deleted Disk Space Not Released on Converted NTFS Volume </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135724">
<META NAME="KBModify" CONTENT="1995/10/12">
<META NAME="KBCreate" CONTENT="1995/08/27">
<META NAME="Keywords" CONTENT="kbhw kbbug3.51 kbfix3.51.sp2">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If you copy a large file to a nearly full disk, delete the file, and then copy another large file to the disk, the second copy attempt may fail. This problem occurs even though the system reports adequate disk space is available for the second file...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW5,QBWP,QAIJ,QAYV,QAEF,QDO3,QAC9,QAKP,QAA1,QDIV,QBVV,QBCT,QA9N,QA7T,QAGC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Deleted Disk Space Not Released on Converted NTFS Volume</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 12, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135724</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you copy a large file to a nearly full disk, delete the file, and then
copy another large file to the disk, the second copy attempt may fail. This
problem occurs even though the system reports adequate disk space is
available for the second file.
<P>
This problem only occurs on computers that were upgraded to Windows NT 3.51
from a previous version of Windows NT, and on which the disk volume was
converted to the Windows NT file system (NTFS) during or after the upgrade
process. This problem occurs on uncompressed volumes, and will not occur on
volumes that were formatted for NTFS prior to installing Windows NT 3.51.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you copy then remove a large file from a nearly full NTFS partition,
you may create free space between the beginning of the disk and the Master
File Table (MFT). Because NTFS starts looking for free space at the MFT,
NTFS does not see the free space after the file is deleted.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, install Windows NT 3.51 in a new directory.
<P>
To correct this problem, install the latest U.S. Service Pack for Windows
NT version 3.51.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.51.
This problem has been corrected in the latest U.S. Service Pack for Windows
NT version 3.51. For information on obtaining the Service Pack, query on
the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When NTFS is looking for free space on the disk, it scans through a bitmap
of the disk that identifies the state of each block on the disk (free or in
use). The scanning process starts at the MFT rather than the beginning of
the disk. If free space exists before the MFT, the space is not found
during the scanning process. If the disk was formatted for NTFS, there are
no files between the start of the disk and the MFT. However, if the disk
was converted to NTFS, then files can exist between the beginning of the
disk and the MFT. Once those files are deleted, free space exists between
the start of the disk and the MFT. Because the scanning process starts at
the MFT, free blocks before the MFT are never be allocated to a file.
<P>
For additional information on NTFS and Master File Table, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q101670.htm">Q101670</A></B>
   TITLE     : Transaction Log Supports NTFS Recoverability
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbhw kbbug3.51 kbfix3.51.sp2<BR>
KBSubcategory: ntfilesys<BR>
Additional reference words: 3.51 prodnt diskspace<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 12, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
