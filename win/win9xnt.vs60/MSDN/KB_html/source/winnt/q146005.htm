

<HTML>
<HEAD>
<TITLE>Optimizing Windows NT for Performance </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146005">
<META NAME="KBModify" CONTENT="1996/02/21">
<META NAME="KBCreate" CONTENT="1996/02/12">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  When starting troubleshooting performance problems or when trying to optimize Windows NT, while working with Windows NT Performance Monitor it isn't always easy to choose from the large number of performance monitor objects and counters.  This arti...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALX,QAM9,QABH,QABI,QAPN,QAW6,QAU3,QAMR,QAVZ,QAC9,QAKD,QBWP,QA26,QANY,QAKC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Optimizing Windows NT for Performance</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When starting troubleshooting performance problems or when trying to
optimize Windows NT, while working with Windows NT Performance Monitor it
isn't always easy to choose from the large number of performance monitor
objects and counters.
<P>
This article helps you pick the right counters and objects.
<P>
Below you'll find performance checkpoints for the following possible
bottlenecks:

<UL><LI>Suspected bottleneck: memory
<LI>Suspected bottleneck: processor
<LI>Suspected bottleneck: physical disk
<LI>Suspected bottleneck: network
<LI>Suspected bottleneck: network components
<P>
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Suspected Bottleneck: Memory</h3>
 
<P>
Check:
<P>
<PRE>Object:   Memory
</PRE>Counter: Pages /sec
<P>
<PRE>Object:   Logical Disk (location of the PAGEFILE.SYS)
</PRE>Counter: Avg. Disk sec/Transfer
<P>
If the product of these two counters (equals percentage of the disk access
time used by paging) &gt; 10 % on a sustained basis, the system needs more
memory.
<P>
<P>
Check:
<P>
<PRE>Object:   Memory
</PRE>Counter: Pages /sec
<P>
If counter value is consistently &gt; 5 , suspect memory.
<P>
<P>
Check:
<P>
<PRE>Object:   Server
</PRE>Counter: Pool Nonpaged Failures
<P>
The number of times allocations from nonpaged pool have failed. Indicates
that the computer's physical memory is too small.
<P>
<P>
Check:
<P>
<PRE>Object:   Server
</PRE>Counter: Pool Paged Failures
<P>
Pool Paged Failures indicate that either physical memory or a paging file
is near capacity.
<P>
<P>
Check:
<P>
<PRE>Object:   Server
</PRE>Counter: Pool Nonpaged Peak
<P>
The maximum number of bytes of nonpaged pool the server has had in use at
any one point. Indicates how much physical memory the computer should have.
<P>
<P>
<P><h3>Suspected Bottleneck: Processor</h3>
 
<P>
Check:
<P>
<PRE>Object:   Processor
</PRE>Counter: %Processor Time
<P>
If this value is consistently high (&gt; 80%) and disk and network counter
values are low, suspect the processor.
<P>
<P>
<PRE>Object:   System
</PRE>Counter: %Processor Time (for multi processor systems)
<P>
If this value is consistently high (&gt; 80%) and disk and network counter
values are low, suspect the processor.
<P>
<P>
<PRE>Object:   System
</PRE>Counter: Processor Queue Length
<P>
A sustained processor queue length &gt; 2 , generally indicates a processor
bottleneck.
<P>
<P>
<PRE>Object:   Processor
</PRE>Counter: Interrupts/sec
<P>
A dramatic increase in this counter value without a corresponding increase
in system activity indicates a hardware problem.
<P>
<P>
<PRE>Object:   Processes (_Total)
</PRE>Counter: %Processor Time
<P>
If more than a couple of processes are contending for the majority of
the processor time, then a faster processor or an additional processor
should be considered.
<P>
<P>
<P><h3>Suspected Bottleneck: Physical Disk</h3>
 
<P>
Check:
<P>
<PRE>Object:   Physical Disk
</PRE>Counter: %Disk Time
<P>
If this value is consistently high and disk queue length is greater than 2,
suspect the disk.
<P>
<P>
<PRE>Object:   Physical Disk
</PRE>Counter: Average Disk sec/Transfer
<P>
A high value (values greater than 0.3 seconds) may mean that the disk
controller is continually retrying the disk because of failures.
<P>
<P>
<PRE>Object:   Physical Disk
</PRE>Counter: Disk Queue Length
Counter: Average Disk sec/Transfer
<P>
The Average Queue Time is the average amount of time for a disk
transfer (either reads or writes) to complete. Use the following formula to
find the average disk queue time:
<P>
<PRE>   Avg. Queue Time = Disk Queue Length x Avg. Disk sec/Transfer

</PRE>This information is a relative performance measurement and should be
compared with other hard disk drivers in your system. Compute the figures
for all logical disks in your system. The number of disk commands waiting
in the queue is normally the factor that slows disk performance by
increasing the average disk queue time.
<P>
<P>
<PRE>Object:   Physical Disk
</PRE>Counter: Disk Bytes/sec
<P>
A Disk Bytes/sec count lower than 20K may indicate that an application is
accessing a disk inefficiently.
<P>
<P>
<P><h3>Suspected Bottleneck: Network Components</h3>
 
<P>
Check:
<P>
<PRE>Object:   Redirector
</PRE>Counter: Current commands
<P>
If this number is greater than one per network adapter, the redirector
may be a bottleneck in the system for one or more of the following reasons:
<P>
- the server with which the redirector is communicating is slower than the
<PRE>  redirector.
</PRE>- the network may be experiencing capacity problems.
- the redirector is busier than the adapter can keep up with.
<P>
If network capacity problems are identified, it may be necessary to subnet
the network in an attempt to partition network traffic.
<P>
<P>
Check:
<P>
<PRE>Object:   Redirector
</PRE>Counter: Network Errors/sec
<P>
If any network errors are logged, check the Event Log for more details.
<P>
<P>
Check:
<P>
<PRE>Object:   Redirector
</PRE>Counter: Reads Denieds/sec
Counter: Writes Denieds/sec
<P>
These values indicate if the remote servers are having problems with memory
allocation.
<P>
<P>
Check:
<P>
<PRE>Object:   Server
</PRE>Counter: Work Item Shortage
<P>
An increase in Work Item Shortage should cause a change in the registry
value(s) InitialWorkItems and/or MaximumWorkItems (depending on when the
outage occurred).
<P>
<P>
Check:
<P>
<PRE>Object:   Server
</PRE>Counter: Raw Reads Rejected/sec
Counter: Raw Writes Rejected/sec
<P>
Rejections indicates the exhaustion of RAW work items used when busy doing
large file transfers. The increase of the registry value RawWorkItems can
possibly solve this bottleneck.
<P>
<P>
<P><h3>Suspected Bottleneck: Network</h3>
 
<P>
Check:
<P>
<PRE>Object:   Server
</PRE>Counter: Bytes Total/sec
<P>
If the sum of Bytes Total/sec for all servers is roughly equal to the
maximum transfer rates of your network, you may need to segment the
network.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: nthowto ntconfig<BR>
Additional reference words: prodnt 3.50 3.51<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 21, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
