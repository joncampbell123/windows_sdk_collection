

<HTML>
<HEAD>
<TITLE>TCP/IP Routing Basics for Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140859">
<META NAME="KBModify" CONTENT="1998/02/13">
<META NAME="KBCreate" CONTENT="1995/12/07">
<META NAME="Keywords" CONTENT="NTSrvWkst nttcp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article discusses the Windows NT Routing Table on a single-homed machine and multihomed Windows NT Router with and without Multi Protocol Router (MPR). This background information will help with troubleshooting related to TCP/IP.  MORE INFORMA...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAM5,QBWP,QAC2,QBWD,QAVZ,QABA,QAR5,QAHH,QBVW,QBW4,QDNT,QDL9,QBWO,QBWN,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>TCP/IP Routing Basics for Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140859</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows NT Server versions 3.5, 3.51, and 4.0
<LI>Microsoft Windows for Workgroups version 3.11
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses the Windows NT Routing Table on a single-homed
machine and multihomed Windows NT Router with and without Multi Protocol
Router (MPR). This background information will help with troubleshooting
related to TCP/IP.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>The Route Table</h3>
 
<P>
Even a single-homed TCP/IP host has to make routing decisions. These
routing decisions are controlled by the route table. The route table can
be displayed by typing "route print" at the command prompt. The following
is an example route table from a single-homed machine. This simple route
table is built automatically by Windows NT based on the IP configuration
of your host.
<P>
<PRE>Network Address   Netmask          Gateway Address  Interface       Metric

0.0.0.0           0.0.0.0          157.57.8.1       157.57.11.169      1
127.0.0.0         255.0.0.0        127.0.0.1        127.0.0.1          1
157.57.8.0        255.255.248.0    157.57.11.169    157.57.11.169      1
157.57.11.169     255.255.255.255  127.0.0.1        127.0.0.1          1
157.57.255.255    255.255.255.255  157.57.11.169    157.57.11.169      1
224.0.0.0         224.0.0.0        157.57.11.169    157.57.11.169      1
255.255.255.255   255.255.255.255  157.57.11.169    157.57.11.169      1

</PRE>The titles of each column in the above table are explained in following
text:
<P>
Network Address:
<P>
Network Address is the destination. The Network address column can
contain:

<UL><LI>Host address
<LI>Subnet address
<LI>Network address
<LI>Default gateway
<P>
</UL>The search order is also as above, from the most unique route (host
address) to most generic (default gateway):
<P>
<PRE>0.0.0.0         is the default route
127.0.0.0       is the loopback address
157.57.8.0      is the local subnet address
157.57.11.169   is the network card address
</PRE>157.57.255.255  is the subnet broadcast address
<PRE>224.0.0.0       is the multicast address
</PRE>255.255.255.255 is the limited broadcast address
<P>
<P>
Netmask:
<P>
The Netmask defines what portion of the Network Address must match for
that route to be used. When the mask is written in binary a 1 is
significant (must match) and a 0 need not match. For example, a
255.255.255.255 mask is used for a host entry. The mask of all 255s (all
1s) means that the destination address of the packet to be routed must
exactly match the Network Address for this route to be used. For another
example, the Network Address 157.57.8.0 has a netmask of 255.255.248.0.
This netmask means the first two octets must match exactly, the first 5
bits of the third octet must match (248=11111000) and the last octet does
not matter. Since 8 in the decimal number system is equivalent to 00001000
in binary, a match would have to start with 00001. Thus, any address of
157.57 and the third octet of 8 through 15 (15=00001111) will use this
route. This is a netmask for a subnet route and is therefore called the
subnet mask.
<P>
Gateway Address:
<P>
The Gateway Address is where the packet needs to be sent. This can be the
local network card or a gateway (router) on the local subnet.
<P>
Interface:
<P>
The Interface is the address of the network card over which the packet
should be sent out. 127.0.0.1 is the software loopback address.
<P>
Metric:
<P>
The Metric is the number of hops to the destination. Anything on the local
LAN is one hop and each router crossed after that is an additional hop.
The Metric is used to determine the best route.
<P>
<P><h3>Multihomed Router</h3>
 
<P>
The following is the default Route table of a multihomed Windows NT host.
<P>
<PRE>Network Address   Netmask           Gateway Address   Interface
</PRE>Metric
<P>
<PRE>0.0.0.0           0.0.0.0           157.57.24.1       157.57.24.193     1
0.0.0.0           0.0.0.0           199.199.40.1      199.199.40.139    1
127.0.0.0         255.0.0.0         127.0.0.1         127.0.0.1         1
157.57.24.0       255.255.248.0     157.57.24.193     157.57.24.193     1
157.57.24.193     255.255.255.255   127.0.0.1         127.0.0.1         1
199.199.40.0      255.255.255.0     199.199.40.139    199.199.40.139    1
199.199.40.139    255.255.255.255   127.0.0.1         127.0.0.1         1
199.199.40.255    255.255.255.255   199.199.40.139    199.199.40.139    1
224.0.0.0         224.0.0.0         157.57.24.193     157.57.24.193     1
224.0.0.0         224.0.0.0         199.199.40.139    199.199.40.139    1
255.255.255.255   255.255.255.255   199.199.40.139    199.199.40.139    1

</PRE>Check "Enable IP Routing" in the Advanced TCP/IP configuration to enable
routing. At this point Windows NT will route between these two subnets.
<P>
NOTE - for the Multihomed Router to pass DHCP Discover packets from one
subnet to the other you will need to install the "BootP Relay Agent" that
comes with MPR. MPR is discussed later.
<P>
A note on Default gateways:
<P>
In the TCP/IP configuration, you can add a default route for each network
card. This will create a 0.0.0.0 route for each. However, only one default
route will actually be used. In this case, the 199.199.40.139 is the first
card in the TCP/IP bindings and therefore the default route for this card
will be used. Since only one default gateway will be used you should only
configure one card to have a default gateway. This will reduce confusion
and insure the results you intended.
<P>
For more information, see the following article in the Microsoft Knowledge
base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../urjump.htm">Q157025</A></B>
   TITLE     : Default Gateway Configuration for Multi-Homed Computers

</PRE>If the Windows NT router does not have an interface on a given subnet, it
will need a route to get there. This can be done by adding Static Routes
or by using MPR. MPR is discussed later.
<P>
<P><h3>To Add a Static Route</h3>
 
<P>
The following is an example route.
<P>
<PRE>   Route Add 199.199.41.0 mask 255.255.255.0 199.199.40.1 metric 2

</PRE>NOTE: The metric option is only supported in Windows NT 3.51 with Service
Pack 2 or later installed.
<P>
The route in this example means that to get to the 199.199.41.0 subnet
with a mask of 255.255.255.0 use gateway 199.199.40.1 and that the subnet
is 2 hops away. A static route will also need to be added on the next
router telling it how to get back to subnets reachable by the first
router. With a network of a few routers or more, static routes can become
very complicated.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q141383.htm">Q141383</A></B>
   TITLE     : "P" Switch for Route Command Added in Windows NT

</PRE><h3>Multi Protocol Router (MPR)</h3>
 
<P>
MPR consists of the following:

<UL><LI>Routing Information Protocol (RIP) for TCP/IP.

<LI>BOOTP (Boot Protocol) relay agent for Dynamic Host Configuration
   Protocol (DHCP).

<LI>RIP for IPX.
<P>
</UL>RIP is used by routers to dynamically exchange routing information. RIP
routers broadcast their routing tables every 30 seconds by default. Other
RIP routers will listen for these RIP broadcasts and update their own
route tables.
<P>
MPR is available in Service Pack 2 for Windows NT 3.51.
<P>
For additional information, please see the RIPROUTE.WRI file (available
with Windows NT 3.51 Service Pack 2) for MPR installation instructions or
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q138793.htm">Q138793</A></B>
   TITLE     : Multi-Protocol Router Installation and Configuration
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 3.50 3.51 tcpip win95 win95x<BR>
Keywords          : NTSrvWkst nttcp kbusage<BR>
Version           : 3.5 3.51 4.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
