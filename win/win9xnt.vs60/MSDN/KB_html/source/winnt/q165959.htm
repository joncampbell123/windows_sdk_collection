

<HTML>
<HEAD>
<TITLE>Reading a File Saved with the Event Viewer of Another Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165959">
<META NAME="KBModify" CONTENT="1997/07/24">
<META NAME="KBCreate" CONTENT="1997/03/27">
<META NAME="Keywords" CONTENT="kbnetwork NTSrvWkst">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Event Viewer enables the user to save the event logs in a binary file with the EVT extension. Such a file can be opened with the Event Viewer on any other computer running the same version of Windows NT.  Even though the Event Viewer is able to...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAO4,QAPN,QAEV,QBWP,QBWS,QAYZ,QACK,QAYC,QDIO,QAUR,QDMH,QAJG,QAU7,QATX,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Reading a File Saved with the Event Viewer of Another Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165959</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Event Viewer enables the user to save the event logs in a binary file
with the EVT extension. Such a file can be opened with the Event Viewer on
any other computer running the same version of Windows NT.
<P>
Even though the Event Viewer is able to load such a file, it needs the
messages DLLs for each component described in the source of the events.
<P>
For example, assume that computer A is running Windows NT 4.0 and a service
called "aservice". On this computer, save the system event logs under the
file System_A.evt. Now assume that computer B is also running Windows NT
4.0. The service "aservice" has not been installed on computer B.
<P>
On computer B, you open the file System_A.evt with the Event Viewer. If you
double-click a message with the source set to "aservice," you get the
following error:
<P>
<PRE>   The description for Event ID (xxx) in Source (aservice) could not be
   found. It contains the following insertion string(s): ...

</PRE>Follow the steps in the next section to read the event logs of computer A
while on computer B without having to install the components of computer A
onto computer B.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The EVT files include the event log messages as they are stored by the
system. Each message is composed of an ID (that is, the message itself) and
a number of insertion strings. The IDs are translated into strings through
the use of messages DLLs.
<P>
All the application event logs messages DLLs are defined under the
following registry keys:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\
   Application

</PRE>All the system event logs messages DLLs are defined under the following
registry keys:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\
   System

</PRE>For example, the TCP/IP service's message DLL is defined under the
following registry entry:
<P>
<PRE>   Key   = HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\
           System\TcpIp
   Value = EventMessageFile REG_EXPAND_SZ %SystemRoot%\System32\
           netevent.dll

</PRE>Therefore, all the TCP/IP event log messages are defined in the DLL
netevent.dll.
<P>
When the user double-clicks an event for which the message DLL is not
defined in the registry, the message string cannot be displayed and the
following message is displayed:
<P>
<PRE>   The description for Event ID (51) in Source (aservice) could not be
   found. It contains the following insertion string(s): ...

</PRE>Below is a description of a way to read the system event logs of a computer
with WINS on a computer without WINS. This sample can be adapted for any
application or system component.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
The following operations are required:

<OL><P><LI>On the computer with WINS, run REGEDIT and select the following registry
   key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\
      System\Wins
</PRE>
<P><LI>On the Registry menu, click Export Registry File and select a file
   name (for example, Winsreg.reg).

<P><LI>On the computer without WINS (for example, the one used to read the
   system event logs of the computer with WINS), run REGEDIT. On the
   Registry menu, click Import Registry File and select the file
   Winsreg.reg previously saved on the other computer.

<P><LI>You should now have the following registry entry on the target computer
   (that is, the one without WINS):
<P>
<PRE>      Key   = HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\
              EventLog\System\Wins
      Value = EventMessageFile REG_EXPAND_SZ %SystemRoot%\System32\
              winsevnt.dll

   You now need to copy the file defined in the EventMessageFile registry
   value in your System32 directory. If X: is mapped to
   \\wins_server\admins$, you can run the following command:

      copy x:\System32\winsevnt.dll %SystemRoot%\System32\winsevnt.dll

   Of course, the file may be copied somewhere else, but in this case you
   need to edit the EventMessageFile registry value manually so that it
   points to the directory with the DLL.

</PRE><P><LI>Close all the instances of the Event Viewer and rerun the Event Viewer.
   You should now be able to dump all the WINS events.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbnetwork NTSrvWkst<BR>
Version             : 4.0<BR>
Platform            : WinNT<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
