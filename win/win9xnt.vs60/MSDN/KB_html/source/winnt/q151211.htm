

<HTML>
<HEAD>
<TITLE>Nested Batch Files in Logon Script Hangs at Execution </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151211">
<META NAME="KBModify" CONTENT="1997/11/13">
<META NAME="KBCreate" CONTENT="1996/05/20">
<META NAME="Keywords" CONTENT="ntdomain NTSrv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="-   A DOS window appears on a client computer and shows the logon script executing. The logon script finishes, but the Windows NT logon script (in Windows 95) or the Lan Manager logon script (in Windows for Workgroups) dialog box appears and displays...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWP,QBWO,QAI5,QDL9,QBWN,QAVZ,QAJ8,QAGB,QBW7,QBXT,QA5V,QAIB,QAGC,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Nested Batch Files in Logon Script Hangs at Execution</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151211</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server versions 3.5 and 3.51
<LI>Microsoft Windows for Workgroups version 3.11
<LI>Microsoft Windows 95
</UL> 
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A DOS window appears on a client computer and shows the logon script
executing. The logon script finishes, but the Windows NT logon script (in
Windows 95) or the Lan Manager logon script (in Windows for Workgroups)
dialog box appears and displays the following message:
<P>
<PRE>   Please wait while your logon script executes...

</PRE>The client computer stops responding until you click Cancel.
<P>
CAUSE
 
The Windows NT logon script contains a nested batch file and the current
directory is changed in the nested batch file as shown in the following
logon script example. Assume Test1.bat and test2.bat are located in the
Repl\Imports\Scripts directory and Gandalf is a Windows NT Server 3.51
Primary Domain Controller (PDC) with no service packs installed.
<P>
The logon script contains only one line:
<P>
<PRE>   test1.bat

</PRE>Test1.bat contains the following lines:
<P>
NET USE K: \\Gandalf\Netlogon
k:\test2.bat
<P>
Test2.bat contains the following lines:
<P>
<PRE>   net use P: \\Gandalf\Sms_shr
   net use y: \\Gandalf\Sms_pkgd
   P:
   CD\            &lt;---- line causing the logon script dialog box to hang
                  until you click Cancel
   COPY CL_Dos.txt C:\Temp

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, change the nested batch file code for
Test2.bat so that it avoids using the Change Directory (Cd) command:
<P>
<PRE>   net use P: \\Gandalf\Sms_shr
   net use y: \\Gandalf\Sms_pkgd
   COPY p:\CL_Dos.txt C:\Temp

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version
3.51. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt login scripts nested batch file logon<BR>
scripts<BR>
Keywords          : ntdomain NTSrv kbnetwork<BR>
Version           : WinNT:3.5,3.51 WFW:3.11 Win95<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
