

<HTML>
<HEAD>
<TITLE>Unattended Installation of IBM Auto 16/4 Token Ring Adapter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142904">
<META NAME="KBModify" CONTENT="1996/09/20">
<META NAME="KBCreate" CONTENT="1996/01/22">
<META NAME="Keywords" CONTENT="kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  This article describes how you can perform an unattended installation of the IBM Auto 16/4 token ring adapter in Windows NT.  MORE INFORMATION  NOTE: Before you start the unattended installation of the token ring adapter, please see the following a...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAW1,QAW2,QAA1,QBFY,QAK2,QDI2,QACT,QA9N,QAU9,QASB,QANE,QAIJ,QBXM,QDNL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unattended Installation of IBM Auto 16/4 Token Ring Adapter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 20, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142904</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation versions 3.5 and 3.51
<LI>Microsoft Windows NT Server versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how you can perform an unattended installation of
the IBM Auto 16/4 token ring adapter in Windows NT.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: Before you start the unattended installation of the token ring
adapter, please see the following article in the Microsoft Knowledge Base
regarding the OEMSETUP.INF file for IBMTOK4.SYS:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q137505.htm">Q137505</A></B>
   TITLE     : IBM 16/4 Auto Token Ring Adapter Driver Causes Event ID 7000

</PRE>To perform an unattended installation of the IBM Auto 16/4 token ring
adapter, close all applications and do the following:

<OL><P><LI>Create a directory on your hard disk drive. For example: c:\ibmtok4

<P><LI>Copy all the files in the I386 directory of the Windows NT 3.51
   compact disc to c:\ibmtok4:

<P><LI>Copy IBMTOK4.SYS from the \drvlib\netcard\x86\ibmtok4 directory on the
   Windows NT compact disc to c:\ibmtok4.

<P><LI>Expand the following files in c:\ibmtok4 by typing the following:
<P>
<P><PRE>      expand oemnadtk.in_ oemnadtk.inf
</PRE><P>
<P><PRE>      expand ntlanman.in_ ntlanman.inf
</PRE>
<P><LI>Make a copy of DOSNET.INF by typing the following in c:\ibmtok4:
<P>
<P><PRE>      copy dosnet.inf dosnet.bak
</PRE>
<P><LI>Rename the *.IN_ files in c:\ibmtok4 to *.BAK by typing the following:
<P>
<P><PRE>      ren oemnadtk.in_ oemnadtk.bak
</PRE><P>
<P><PRE>      ren ntlanman.in_ ntlanman.bak
</PRE>
<P><LI>Change a few lines in OEMNADTK.INF to read as follows:
<P>
<PRE>      ProductSoftwareName     = "IbmTok4"
      ProductSoftwareImagePath = "\SystemRoot\System32\drivers\ibmtok4.sys"
      ProductHardwareName     = "IbmTok4"

      [Files-IBMTok]
      19,IBMTOK4.SYS , SIZE=25600

      [OptionsTextENG]
      IBMTOK     = "IBM Auto 16/4 Token-Ring Adapter"
      FunctionTitle   = "IBM Auto 16/4 Token-Ring Adapter Card Setup"
      ProductSoftwareDescription      = "IBM Auto 16/4 Token-Ring Adapter
                                         Driver"
      ProductHardwareDescription      = "IBM Auto 16/4 Token-Ring Adapter"
      ProductSoftwareTitle    = "IBM Auto 16/4 Token-Ring Adapter Driver"
      ProductHardwareTitle    = "IBM Auto 16/4 Token-Ring Adapter"

</PRE><P><LI>In DOSNET.INF, change:
<P>
<P><PRE>      d1,ibmtok.sys
</PRE><P>
<P><PRE>      to
</PRE><P>
<P><PRE>      d1,ibmtok4.sys
</PRE>
<P><LI>Change a line in NTLANMAN.INF to read as follows:
<P>
<P><PRE>      set AdapterSrcDir = $(!OEMNetDrive) - use to read $(OEMNetDrive)
</PRE>
<P><LI>Create an answer file (for example: IBMTOK.TXT) in c:\ibmtok4.
<P><PRE>    You may create the answer file using the Setup Manager included in the
    Windows NT Resource Kit version 3.51. The following is a recommended
    content of IBMTOK.TXT:
</PRE><P>
<P><PRE>       [Unattended]
       Method = express
       ConfirmHardware = no
       NtUpgrade = no
       Win31Upgrade = no
       TargetPath = \WINNT35
</PRE><P>
<P><PRE>       [GuiUnattended]
       !DetachedProgram = ""
       !Arguments = ""
       !SetupNetwork = "YES"
       !SetupApplications = "NO"
       !TimeZone = "(GMT-06:00) Central Time (US &amp; Canada)"
</PRE><P>
<P><PRE>       [UserData]
       !FullName = "Name"
       !OrgName = "Company"
       !ComputerName = "IBMTOK4"
       !ProductId = "xxxxxxxx-xxx"
</PRE><P>
<P><PRE>       ;The NetworkAdapterData and AdapterParameters section for the
       ;configuration of the IBM Auto 16/4 Token Ring Adaper.
</PRE><P>
<P><PRE>       [NetworkAdapterData]
       !AutoNetOption = "IBMTOK"
</PRE><P>
<P><PRE>       [AdapterParameters]
       IoBaseAddress = 1
       MediaType = 2
       NetworkAddress = ""
</PRE><P>
<P><PRE>       [TransportData]
       !InstallNWLink = 1
       !AUTONETIPXFRAMETYPE = 255
       !InstallTCPIP = 0
       !InstallNetBEUI = 1
</PRE><P>
<P><PRE>       [DomainData]
       !AutoWorkGroup = "WORKGROUP"
</PRE>
<P><LI>To start the unattended installation of the IBM Auto 16/4 token ring
<P><PRE>    adapter, type the following at the command prompt (make sure you are
    in c:\ibmtok4):
</PRE><P>
<P><PRE>       winnt /s:x:\ /t:c: /u:x:\ibmtok.txt  /b
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup<BR>
KBSubcategory: ntsetup ntdriver<BR>
Additional reference words: prodnt 3.50 3.51<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 20, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
