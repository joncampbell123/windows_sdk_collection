

<HTML>
<HEAD>
<TITLE>Using Sc.exe and Netsvc.exe to Control Services Remotely </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166819">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1997/04/11">
<META NAME="Keywords" CONTENT="ntreskit NTSrvWkst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  Windows NT Server 4.0 Resource Kit Supplement 1, comes with two new administrative utilities to work remotely with Windows NT services.  The new utilities are:   - Sc.exe: This tool provides a way to communicate with Service Controller    (Services...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIJ,QBWP,QACK,QAL4,QDIV,QBKX,QAB5,QBFY,QBWS,QBXS,QDIK,QA7O,QAOE,QAMN,QANN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Sc.exe and Netsvc.exe to Control Services Remotely</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Workstation version 4.0
<LI>Microsoft Windows NT Server version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows NT Server 4.0 Resource Kit Supplement 1, comes with two new
administrative utilities to work remotely with Windows NT services.
<P>
The new utilities are:

<UL><LI>Sc.exe: This tool provides a way to communicate with Service Controller
   (Services.exe) from the command prompt, to retrieve information
   about services.

<LI>Netsvc.exe: This tool provides a way to remotely start, stop, and query
   the status of services from the command line.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
It is possible to use Sc.exe and Netsvc.exe to switch the start value of a
service, and to remotely start and stop a service.
<P>
Using these resource kit utilities provides the ability to accomplish the
registry change and ensure that the change is registered with the Services
Control Manager. The Services Control Manager database is updated
dynamically when using these utilities, allowing you to change the start
values and stop and restart services remotely. Otherwise, the remote
modification to the registry will require you to restart the remote
computer or to make the change in the Services tool in Control Panel at the
remote computer.
<P>
For a detailed explanation of the working of Service Control Manager,
and the API set used, consult the Windows NT 4.0 Device Driver Kit (DDK),
and the Windows NT 4.0 Software Development Kit (SDK).
<P>
An example of how to remotely change the start value of the Schedule
service to disabled, test it for the disabled option, reset to manual, and
then start the services follows.
<P>
In the example, the computer running the commands is MYMACHINE.
The remote computer is REMOTE1. Administrative rights are required to
perform the following commands on the remote computer:
<P>
<PRE>   C:\&gt;sc \\REMOTE1 config Schedule start= disabled
   [SC] ChangeServiceConfig SUCCESS

   C:\&gt;netsvc /start \\REMOTE1  "Schedule"
   Error code 1058

   C:\net helpmsg 1058

</PRE>The specified service is disabled and cannot be started.
<P>
<PRE>   C:\&gt;sc \\REMOTE1 config Schedule start= demand
   [SC] ChangeServiceConfig SUCCESS

   C:\&gt;netsvc /start \\REMOTE1 "Schedule"
   Service is pending start on \\REMOTE1

   C:\&gt;sc \\REMOTE1 qc Schedule
   [SC] GetServiceConfig SUCCESS

   SERVICE_NAME: Schedule
      TYPE               : 10  WIN32_OWN_PROCESS
      START_TYPE         : 3   DEMAND_START
      ERROR_CONTROL      : 1   NORMAL
      BINARY_PATH_NAME   : C:\WINNT\System32\AtSvc.Exe
      LOAD_ORDER_GROUP   :
      TAG                : 0
      DISPLAY_NAME       : Schedule
      DEPENDENCIES       :
      SERVICE_START_NAME : LocalSystem

</PRE>You can automate the previous example through a batch file.
<P>
<P><h2>ADDITIONAL INFORMATION</h2>
 
<P>
Consult the Windows NT Server 4.0 Resource Kit, Supplement 1, for
<P><h2>additional information on the syntax and use of Sc.exe and Netsvc.exe.</h2>
 
<PRE>Keywords          : ntreskit NTSrvWkst kbsetup
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
