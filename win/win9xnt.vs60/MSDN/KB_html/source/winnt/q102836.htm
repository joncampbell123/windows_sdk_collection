

<HTML>
<HEAD>
<TITLE>Application Error When Installing DLC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102836">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1993/08/11">
<META NAME="Keywords" CONTENT="kbnetwork ntnetserv ntprotocol NTSrv">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  You receive an application error from SPOOLSS.EXE when reinstalling the data link control (DLC) protocol.  CAUSE =====  This error may occur because you still have a printer set up in Print Manager that is printing to a Hewlett-Packard (HP) network...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAEF,QBTX,QDI2,QDH6,QA9N,QANJ,QAB4,QAAP,QAOX,QBT0,QDKD,QDJP,QAVZ,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Application Error When Installing DLC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102836</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You receive an application error from SPOOLSS.EXE when reinstalling
the data link control (DLC) protocol.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error may occur because you still have a printer set up in Print
Manager that is printing to a Hewlett-Packard (HP) network port.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To recover from the application error, do the following:

<OL><P><LI>Choose the End Task button in Task Manager to exit Control Panel.

<P><LI>After exiting Control Panel, the DLC Setup task will appear in Task
   Manager. Choose End Task to exit this as well.

<P><LI>Run Control Panel and choose the Network icon. In the list of
   installed protocols, select DLC and choose Remove (because the
   installation was only partially successful).

<P><LI>Exit Control Panel, but do not restart the system yet.

<P><LI>Start Print Manager and remove the printer that is on the HP
   network port.

<P><LI>Restart the system.

<P><LI>Run Registry Editor (REGEDT32.EXE).
<P>
</OL>WARNING: Using Registry Editor incorrectly can cause
<PRE>    serious, system-wide problems that may require you to
    reinstall Windows NT to correct them. Microsoft cannot
    guarantee that any problems resulting from the use of
    Registry Editor can be solved. Use this tool at your own
    risk.


</PRE><P><LI>Within Registry Editor select the following key
<P>
<P><PRE>     \HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print\Monitors
</PRE><P>
   and remove the following key and all of its subkeys:
<P>
<P><PRE>     \Hewlett-Packard Network Port
</PRE>
<P><LI>Restart the computer.

<P><LI>Run Control Panel and choose the Networks icon. Reinstall DLC.
<P>
</OL>If you have removed DLC without removing the printer but have not yet
tried to reinstall the protocol, start at step 5.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If DLC is currently installed on your system and you have a printer
that is using the protocol to print to an HP network port, to safely
remove the protocol you must first either remove the printer or change
its settings so it no longer prints to the HP network port. Removing
the protocol without removing or changing the printer port will not
immediately cause any errors, and the printer will still appear in
Print Manager. However, any attempt to reinstall the protocol will
give an application error from SPOOLSS.EXE and cause Control Panel to
hang, resulting in a partially installed protocol.
<P>
Once you have removed the protocol, removing the printer will not
allow you to reinstall DLC without receiving an application error. The
error occurs because there are still references in the Registry to the
HP network port that were not removed when the protocol was removed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt<BR>
Keywords            : kbnetwork ntnetserv ntprotocol NTSrv<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
