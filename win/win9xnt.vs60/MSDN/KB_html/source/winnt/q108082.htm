

<HTML>
<HEAD>
<TITLE>Windows NT Cannot Regenerate Stripe Set with Parity </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108082">
<META NAME="KBModify" CONTENT="1997/05/13">
<META NAME="KBCreate" CONTENT="1993/12/05">
<META NAME="Keywords" CONTENT="kbbug3.10 kbother ntfault">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  If you remove a drive from a stripe set with parity, deleting a stripe partition on another computer, when you reinsert the drive back into the stripe set with parity, the stripe set with parity is not allowed to regenerate.  CAUSE =====  Windows N...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAEF,QBGH,QBXS,QBVV,QAC9,QACI,QAA1,QA9N,QDKD,QDH6,QANJ,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows NT Cannot Regenerate Stripe Set with Parity</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108082</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Advanced Server version 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you remove a drive from a stripe set with parity, deleting a stripe
partition on another computer, when you reinsert the drive back into the
stripe set with parity, the stripe set with parity is not allowed to
regenerate.
<P>
<P><h2>CAUSE</h2>
 
<P>
Windows NT places a unique identifier on all drives it uses. When it sees
the identifier previously used in the stripe set with parity, it does not
detect the modifications made to the drive and is misled about the state of
the configuration. Windows NT is not changing this identifier when
partitions are deleted.
<P>
In normal production environments, this situation should not be
encountered. A failed drive is usually replaced with a different one. Even
if a drive is repaired, it is usually low-level formatted in the process
unless a specific request is made to save the data if possible. The low-
level format should remove the identifier Windows NT placed on the drive.
<P>
The most likely situation where this issue may be seen is in a pre-
production testing environment prior to Windows NT implementation. For
example, the tester, wanting to simulate a drive failure, pulls a good
drive out of the system while it is running. Not having an additional drive
available to replace it with, the tester takes the drive to a different
machine and removes the partitions thinking that this will simulate a new
drive.
<P>
Another possibility for causing this would be if a hardware hot-swapable
drive array was not configured in a way to present the array of drives to
the operating system as one drive. In this situation, Windows NT would have
to detect and automatically process a drive that was hot-swapped. This
feature is not available as a part of Windows NT Fault Tolerance. For this
kind of Fault Tolerance to be used, it has to be implemented at the
hardware level.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, do the following:
<P>
If this kind of testing is going to be done, either use a different drive
for replacement or delete the information kept in sector zero of the drive.
A different disk, even if previously used under Windows NT, will contain a
different identifier. This difference will be correctly detected by Windows
NT Fault Tolerance and regeneration of the stripe with parity set will be
possible. A low-level format should remove sector zero information, or a
disk editor program could be used.
<P>
If a drive is repaired and a request is made to save the data, make a tape
backup of the recovered data on the drive. Use the above techniques to
remove the Windows NT identifier before you attempt to reuse the drive in
the Windows NT computer.
<P>
<P><h3>Warnings</h3>
 
<P>
Although techniques such as pulling a drive out of a system while it is
running may be used in testing, they do result in a degree of risk.
Microsoft does not recommend the use of these techniques and will not be
responsible for any negative consequences of doing so.
<P>
Mention of the identifier in sector zero as an implementation detail of
Windows NT Fault Tolerance is only for the purpose of clarifying why
partition removal is an inadequate procedure. Microsoft does not support
the non-Microsoft use of this information. This implementation detail may
be modified or removed at any time if Microsoft deems it to be appropriate
to do so. Microsoft specifically rejects any claim to product support
arising out of the access or use of this implementation detail by a non-
Microsoft process.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT Advanced Server
version 3.1. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Use Disk Administrator to set up a stripe with parity set.

<P><LI>While Windows NT is running, disconnect one drive of the stripe set with
   parity to simulate a drive failure.

<P><LI>Shut down the computer with stripe set with parity.

<P><LI>Take the disconnected drive to another computer and remove all
   partitions on it in an attempt to simulate a new drive.

<P><LI>Place the disconnected drive back in the stripe set with parity
   computer.

<P><LI>Boot Windows NT, log on, then start Disk Administrator.

<P><LI>Select the stripe with parity set, press the CTRL key and select the
   previously disconnected drive.

<P><LI>Select Fault Tolerance.
<P>
</OL>The Regenerate option is unavailable (grayed out).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt recovery raid<BR>
Keywords            : kbbug3.10 kbother ntfault<BR>
Version             : 3.1<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
