

<HTML>
<HEAD>
<TITLE>Modems Do Not Answer as RAS Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157827">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1996/10/18">
<META NAME="Keywords" CONTENT="NTRAS NTSrvWkst kb3rdparty kbhw">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  The Remote Access Service (RAS) server starts and a client rings, but the modem attached to the server does not pick up.  CAUSE =====  Windows NT 4.0 RAS services and Windows 95 Dial-Up Networking do not use the automatic answer mode because these ...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKW,QAS6,QBVV,QBW9,QABA,QBWP,QA5W,QAUR,QAPN,QAHT,QAKP,QAFI,QAAZ,QBTX,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Modems Do Not Answer as RAS Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157827</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Remote Access Service (RAS) server starts and a client rings, but the
modem attached to the server does not pick up.
<P>
<P><h2>CAUSE</h2>
 
<P>
Windows NT 4.0 RAS services and Windows 95 Dial-Up Networking do not use
the automatic answer mode because these services use Telephony Application
Programming Interface (TAPI). They are polling for modem response RING and
sending an ATA to manually answer (immediately pick up). This is necessary
to let more than one application use the modem simultaneously. When you try
to reproduce this procedure manually with a terminal program, an error
results instead of the pick up. Thus, it is a problem with the modem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, you can try either of the two methods
depending on your modem.
<P>
<P><h3>Method One</h3>
 
<P>
To work around this problem with a Hayes modem, you can make changes
like those shown in the following example by modifying an entry in
%SystemRoot%\Inf\Mdmhayes.inf.
<P>
Before you modify the entries, you should copy and save the original .inf
files with another name or to a different folder. You may want to restore
the original files if this workaround does not work well.
<P>
In the [M1806Reg] section, make the following change:
<P>
Change: HKR, Init, 2,, "AT&amp;FE0V0W1&amp;C1&amp;D2S95=47&lt;cr&gt;"
<P>
To: HKR, Init, 2,, "AT&amp;FE0V0W1&amp;C1&amp;D2S95=47S40=6&lt;cr&gt;"
<P>
<P><h3>Method Two</h3>
 
<P>
Another way to work around this problem with US Robotics modems is to make
changes like those shown in the following example. You can modify some
entries in:
<P>
<PRE>   %SystemRoot%\Inf\Mdmusrcr.inf for Courier modems.
   %SystemRoot%\Inf\Mdmusfr.inf for French modems.
   %SystemRoot%\Inf\Mdmusrg.inf for German modems.
   %SystemRoot%\Inf\Mdmusrsp.inf for Sportster modems.

</PRE>Before you modify the entries, you should copy and save the original .inf
files with another name or to a different folder. You may want to restore
the original files if this workaround does not work well.
<P>
In the [USRSP] section of Mdmusrsp.inf or Mdmusrg.inf, or in the
[MfgAddReg] section of Mdmusrcr.inf or Mdmusfr.inf:
<P>
Change: HKR, Hangup, 1,, "ATH&lt;cr&gt;"
<PRE>        HKR, Answer, 1,, "ATA&lt;cr&gt;"
        HKR,, Reset,, "ATZ&lt;cr&gt;"

</PRE>To: HKR, Hangup, 1,, "ATHS0=0&lt;cr&gt;"
<PRE>    HKR, Answer, 1,, "ATS0=1&lt;cr&gt;"
    HKR,, Reset,, "ATS0=0Z&lt;cr&gt;"

</PRE>After these changes are made, remove the modem from the Modems tool in
Control Panel and then re-add the modem. This will write the new .inf
settings to the registry.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The changes for the second workaround will switch the modem to the
automatic answer mode only when the modem is ringing, and back to the
normal mode if the application hangs up or resets the modem. Therefore, the
modem should not have a problem serving more than one application at a
time. However, this workaround does not work with applications that use the
automatic answer mode for themselves.
<P>
For additional information on creating, modifying, and working methods of
Mdmxxx.inf, please see the following Modem Development Kit available on
MSDN (DDK for Windows 95) or the Microsoft anonymous ftp server:
<P>
<PRE>   File Name: Modmdev.exe
   Location : <B><A href="ftp://ftp.microsoft.com/bussys/winnt/winnt-docs/papers/">ftp://ftp.microsoft.com/bussys/winnt/winnt-docs/papers/</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: usr fail<BR>
Keywords          : NTRAS NTSrvWkst kb3rdparty kbhw<BR>
Version           : WinNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
