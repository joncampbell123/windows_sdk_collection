

<HTML>
<HEAD>
<TITLE>Control Panel "Don't Load" Feature Does Not Work </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126972">
<META NAME="KBModify" CONTENT="1997/04/10">
<META NAME="KBCreate" CONTENT="1995/03/08">
<META NAME="Keywords" CONTENT="kbbug3.50 kbusage ntutil">
<META NAME="KBArea" CONTENT="Support; KB; winnt, crossnet, iis">
<META NAME="Description" CONTENT="  You can prevent individual Control Panel components from loading under Windows NT versions 3.1 and 3.5 by modifying the Registry. However, this does not work in Windows NT version 3.5. For example, if you modify the Registry to specify that the Con...">
<META NAME="Product" CONTENT="Windows NT">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTX,QBWP,QBVV,QAB5,QAY2,QAJG,QBT6,QBJZ,QA7O,QAOE,QAMN,QBV4,QDNL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Control Panel "Don't Load" Feature Does Not Work</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126972</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT operating system version 3.1
<LI>Microsoft Windows NT Advanced Server version 3.1
<LI>Microsoft Windows NT Workstation version 3.5
<LI>Microsoft Windows NT Server version 3.5
<LI>Microsoft Windows NT Workstation version 3.51
<LI>Microsoft Windows NT Server version 3.51
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You can prevent individual Control Panel components from loading under
Windows NT versions 3.1 and 3.5 by modifying the Registry. However, this
does not work in Windows NT version 3.5. For example, if you modify the
Registry to specify that the Control Panel Keyboard component should not
load, the component still loads.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Windows NT version 3.5, a cache mechanism is implemented to speed up
the loading of Control Panel components. When you run Control Panel for
the first time, a cache is created that includes information regarding
each component in the Control Panel. Therefore, Registry entries specifying
certain components not to load are not read in Windows NT version 3.5.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, add the /CACHE switch to the Control Panel
Command Line in the Program Manager Program Item Properties dialog box
after you modify the Registry. For example:
<P>
<PRE>   CONTROL.EXE /cache

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 3.5.
We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the following procedure to prevent Control Panel components
from loading.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Run Registry Editor (REGEDT32.EXE).

<P><LI>From the HKEY_CURRENT_USER subtree, go to the following key:
<P>
<P><PRE>      \Control Panel
</PRE>
<P><LI>From the Edit menu, choose Add Key.

<P><LI>Type "Don't Load" (without the quotation marks) in the Key Name text
   box and choose OK.

<P><LI>Select Don't Load.

<P><LI>From the Edit menu, choose Add Value.

<P><LI>Type the following in the appropriate text boxes:
<P>
<P><PRE>      Value Name:  &lt;Control Panel component&gt;
<PRE></PRE>      Data Type:   REG_SZ
      String:      0 or 1 (Either string value will prevent the
                           Control component from loading)

   The default Control Panel component names are:

      Color          International          Desktop
      Fonts          System                 Keyboard
      Ports          Date/Time              Printers
      Mouse          Network                Devices
      Drivers        Sound                  Cursors
      Server         Services               UPS
      Display (Windows NT version 3.5 only)
      MIDI Mapper (Windows NT version 3.1 only)

</PRE><P><LI>Quit Registry Editor and restart Control Panel.
<P>
</OL>NOTE: If you need to modify the Registry again to prevent additional
Control Panel components from loading, do not repeat steps three and four.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prodnt main cpl nkbd<BR>
Keywords            : kbbug3.50 kbusage ntutil<BR>
Version             : 3.1 3.5 3.51<BR>
Platform            : WinNT<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
