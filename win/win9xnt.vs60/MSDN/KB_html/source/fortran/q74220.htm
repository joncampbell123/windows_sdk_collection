

<HTML>
<HEAD>
<TITLE>FIX: F1001: Grammar.c Line 91; Nested DO-Loops with Arrays </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74220 ">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1991/07/14">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Compiling code using Microsoft FORTRAN versions 4.0, 4.01, 4.1, and 5.0 under MS-DOS, and versions 4.1 and 5.0 under OS/2, when that code contains a subroutine with nested DO-loops in which arrays are indexed using a DO variable from an outer DO-lo...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAAP,QAB4,QAH4,QAR4,QAKP,QBF0,QA2B,QAVX,QAVW,QAUD,QACI,QBXT,QA5V,QAJ8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: F1001: Grammar.c Line 91; Nested DO-Loops with Arrays</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74220 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.01 4.10 5.00 | 4.10 5.00
<PRE>MS-DOS              | OS/2
</PRE>kbtool kbfixlist kbbuglist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 4.0, 4.01, 4.1, 5.0
<LI>Microsoft FORTRAN for OS/2, versions 4.1 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Compiling code using Microsoft FORTRAN versions 4.0, 4.01, 4.1, and
5.0 under MS-DOS, and versions 4.1 and 5.0 under OS/2, when that code
contains a subroutine with nested DO-loops in which arrays are indexed
using a DO variable from an outer DO-loop, may generate the following
error:
<P>
<PRE>   fatal error F1001: Internal Compiler Error
    (compiler file '../../../P2/grammar.c', line 91)

</PRE><h2>RESOLUTION</h2>
 
<P>
The error can be suppressed by turning off loop optimization, using a
temporary variable in place of the DO variable from the outer DO-loop,
or by upgrading to FORTRAN 5.1.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft FORTRAN
versions 4.0, 4.01, 4.1, and 5.0 for MS-DOS and versions 4.1 and 5.0
for OS/2. This problem was corrected in Microsoft FORTRAN 5.1.
<P>
<P><h3>MORE INFORMATION</h3>
 
<P>
This error is caused by a problem with loop optimization. The
following code generates the F1001 error:
<P>
<P><h3>Sample code</h3>
 
<P>
<PRE>      subroutine test(a,b,n)

      real*8 a(6,12), b(6,6)

      do 20 i=1,n
        do 10 j=1,n
          a(i,j+n)=b(i,j)
10      continue
</PRE>20    continue
<PRE>      return
      end

</PRE>Compiling with the /Od option or with the /Odct options suppresses the
error. Microsoft FORTRAN version 5.1 will not generate the error.
<P>
If a temporary variable is used in place of the DO variable "i" in the
array subscript, the error will not generated. This allows full
optimization to be used when compiling. The following code
demonstrates this solution:
<P>
<PRE>      subroutine test(a,b,n)

      real*8 a(6,12), b(6,6)

      do 20 i=1,n
        ii = i              ! Temporary variable assigned value of i
        do 10 j=1,n
          a(ii,j+n)=b(ii,j) ! Temporary variable used in place of i
10      continue
</PRE>20    continue
<PRE>      return
      end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.01 4.10 5.00<BR>
KBCategory: kbtool kbfixlist kbbuglist kberrmsg<BR>
KBSubcategory: FLIss<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
