

<HTML>
<HEAD>
<TITLE>DLL with PROGRAM Statement Fails to Load </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131498">
<META NAME="KBModify" CONTENT="1995/07/19">
<META NAME="KBCreate" CONTENT="1995/06/12">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  If a FORTRAN DLL contains a PROGRAM statement or other main section of code, programs calling the DLL fail to load it; they return an error. The error returned depends on the program.   - Visual Basic version 3.0 and Microsoft Word version 6.0 give...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAAP,QAB4,QBFY,QAY5,QAJH,QDNN,QAUD,QAGI,QAB9,QBVV,QAPN,QAFF,QBS0,QAIH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DLL with PROGRAM Statement Fails to Load</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 19, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131498</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN Compiler for MS-DOS, version 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a FORTRAN DLL contains a PROGRAM statement or other main section of
code, programs calling the DLL fail to load it; they return an error. The
error returned depends on the program.

<UL><LI>Visual Basic version 3.0 and Microsoft Word version 6.0 give an "Out of
   memory" error when attempting to call a function or subroutine in the
   DLL.

<LI>Microsoft Excel version 5.0 reports "Run time error '48' Error in
   loading DLL" when attempting to call a function or subroutine in the
   DLL.

<LI>A Windows-based application built in C that uses LoadLibrary() to load
   the DLL returns 0 (System was out of memory, executable file was
   corrupt, or relocations were invalid).

<LI>An application that loads the DLL by linking with the DLL import library
   terminates the application upon loading the DLL. The Visual C++ debugger
   displays the message "Process 0xXXXX Terminated Normally (240)" if the
   program is being debugged. If the program is being executed, the program
   doesn't appear to execute but reports no warnings, errors, or messages.
   The program does not load and no window is displayed.

<LI>A Windows-based application built in FORTRAN gives no warnings, errors,
   or messages. The program does not load and no window is displayed.
<P>
</UL><h2>CAUSE</h2>
 
<P>
A DLL should not have a PROGRAM statement.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code to Demonstrate Behavior</h3>
 
<P>
C  Compile options needed: /Gw /Aw
C
C  DLL functions and subroutines
<PRE>      SUBROUTINE SubroutineOne()
      ...
      END

      INTEGER*4 FUNCTION FunctionOne()
      ...
      END

</PRE>C  The code below is not needed for a DLL
<PRE>      PROGRAM MainProgram
      ...
      END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.50 1.51 1.52 5.10<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FortLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 19, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
