

<HTML>
<HEAD>
<TITLE>Clearing the Coprocessor Status Word from FORTRAN </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q35434 ">
<META NAME="KBModify" CONTENT="1997/07/31">
<META NAME="KBCreate" CONTENT="1988/09/10">
<META NAME="Keywords" CONTENT="FORTLngIss kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Page 17 of the Microsoft FORTRAN  Advanced Topics  manual for version 5.1 includes the following statement:     When one of the floating-point exception conditions given in Table    1.2 above occurs, the appropriate bit in the status word is set.  ...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAUD,QAIH,QAB9,QBWP,QBV8,QBE7,QBE6,QAJX,QAEF,QADR,QBFY,QAGI,QDO7,QAOX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Clearing the Coprocessor Status Word from FORTRAN</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q35434 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.01 4.10 5.00 5.10 1.00 1.00a | 4.10 5.00 5.10 | 1.00 4.00
<PRE>MS-DOS                              | OS/2           | WINDOWS NT
</PRE>kbprg kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 4.0, 4.01, 4.1, 5.0, and 5.1
<LI>Microsoft FORTRAN for OS/2, versions 4.1, 5.0, 5.1
<LI>Microsoft FORTRAN PowerStation for MS-DOS, versions 1.0 and 1.0a
<LI>Microsoft FORTRAN PowerStation 32 for Windows NT, version 1.0 and
   4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Page 17 of the Microsoft FORTRAN "Advanced Topics" manual for version
5.1 includes the following statement:
<P>
<PRE>   When one of the floating-point exception conditions given in Table
   1.2 above occurs, the appropriate bit in the status word is set.
   This flag remains set until you clear it.

</PRE>While the GETSTATUSFPQQ and SSWRQQ subroutines returns the value of the
status word, there is no FORTRAN function or subroutine that will modify
the status word.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Under normal circumstances, when the math coprocessor generates a
floating-point exception, an exception handler is called which can
clear the status word. If it is necessary to reset the control word at
another time, the FORTRAN run-time library provides the C functions
_clear87 and _fpreset which an application can access using an
INTERFACE statement. The _clear87 function returns the value of the
status word before changing the status word; the _fpreset subroutine
resets the status word and returns no value.
<P>
The _clear87 and _fpreset functions might be useful when an
application spawns another application that might perform a floating-
point operation. When the spawned application completes execution,
call the _clear87 or _fpreset function to return the floating-point
environment to its default state. The following code example
demonstrates using the _clear87 and _fpreset functions from FORTRAN.
<P>
NOTE: The sample code below will not link using FORTRAN's 32-bit linker
due to a change in libc.lib. It no longer contains the function __clear87.
Under the 32-bit FORTRAN compilers, the C function __clear87 is replaced by
__clearfp.
<P>
<P><h3>Sample Code</h3>
 
<P>
C Compiler options required: None
<P>
<PRE>      INTERFACE TO SUBROUTINE FPRESET[C, ALIAS:'__FPRESET']
      END
      INTERFACE TO INTEGER*2 FUNCTION CLEAR87[C, ALIAS:'__CLEAR87']
      END

      INTEGER*2 CLEAR87

      PRINT '(1X, A, Z)', 'INITIAL STATUS WORD:         ', CLEAR87()
      X = 1.E-38
      X = X / 100.
      PRINT '(1X, A, Z)', 'STATUS WORD AFTER UNDERFLOW: ', CLEAR87()
      CALL FPRESET
      PRINT '(1X, A, Z)', 'STATUS WORD AFTER _FPRESET:  ', CLEAR87()
      END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 4.00 4.01 4.10 5.00 5.10 8087 80287 80387<BR>
80487 status exception kbinf<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: FORTLngIss<BR>
Keywords          : FORTLngIss kbcode kbprg<BR>
Version           : 4.00 4.01 4.10 5.00 5.10 1.00 1.<BR>
Platform          : MS-DOS NT OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
