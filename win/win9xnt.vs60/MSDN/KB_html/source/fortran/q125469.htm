

<HTML>
<HEAD>
<TITLE>PRB: Run-time Subroutines Do Not Appear to Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125469">
<META NAME="KBModify" CONTENT="1997/03/11">
<META NAME="KBCreate" CONTENT="1995/01/29">
<META NAME="Keywords" CONTENT="FORTLngIss kbprb kbprg">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  The code compiles, links, and runs with no errors, but some of the run-time subroutines do not appear to function correctly. Unexpected results are returned.  CAUSE =====  The subroutine may not have an interface statement or a parameter used in th...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFF,QAOX,QAH4,QBVV,QBFY,QBWP,QAHE,QAGI,QAY5,QAPN,QAB9,QBXT,QA5V,QAMB,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Run-time Subroutines Do Not Appear to Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125469</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00a | 1.00 4.00
MSDOS | WINDOWS NT
kbprg kbprb
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN PowerStation for MS-DOS, versions 1.0 and 1.0a
<LI>Microsoft FORTRAN PowerStation 32 for Windows NT, version 1.0 and
   4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The code compiles, links, and runs with no errors, but some of the run-time
subroutines do not appear to function correctly. Unexpected results are
returned.
<P>
<P><h2>CAUSE</h2>
 
<P>
The subroutine may not have an interface statement or a parameter used in
the subroutine may not be defined.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Include FLIB.FI prior to the PROGRAM statement or as the first line in
any file that uses these subroutines or functions. Also, include FLIB.FD
inside the main program or any subroutine or function that uses the run-
time subroutines.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code sample compiles, links, and runs without generating
an error, but the array is not sorted and the random seed is initialized
with a zero. In the case of the SORTQQ routine, the last argument is a
parameter defined in FLIB.FD. Because that file is not included, the
variable is typed as a REAL and initialized to zero. SORTQQ fails to sort
because the size of the data items to be sorted is zero.
<P>
If the file FLIB.FI is included by changing the first INCLUDE from a
comment into an executed line, you will receive these errors:
<P>
<PRE>   F4016 : SEED : formal argument ARG: type mismatch
   F4016 : SORTQQ : formal argument SIZE: type mismatch

</PRE>If the variables passed to these routines are type compatible and indicate
correct values, the program may run correctly.
<P>
To solve the problem in the sample below, change both include lines from
comments into executable lines.
<P>
Additionally, there may be several run-time subroutines that use parameters
defined in the FLIB.FD file, but the documentation fails to indicate that
you must include FLIB.FD. The following is a partial list of those
subroutines:
<P>
<PRE>   ELLIPSE, ELLIPSE_W
   GETWRITEMODE
   PIE, PIE_W
   REMAPALLPALETTE, REMAPPALETE
   SEED
   SETWRITEMODE

</PRE><h3>Sample Code</h3>
 
<P>
C Compile options needed: none
<P>
C      INCLUDE 'flib.fi'
<PRE>      PROGRAM Test

</PRE>C      INCLUDE 'flib.fd'
<P>
<PRE>      INTEGER maxsize
      INTEGER*4 buf(100)
      INTEGER*4 i
      REAL*4 rdm

      PRINT*, "Enter the number of values (max = 100): "
      READ(*, "(I4)") maxsize
      IF(maxsize .GT. 100 ) maxsize = 100

      CALL SEED(RND$TIMESEED)
      DO i = 1, maxsize
          CALL RANDOM(rdm)

C         Random value from 1 to maxsize
          buf(i) = INT4(rdm * maxsize + 1.0)
      END DO

</PRE>C     Print out the unsorted array
<PRE>      WRITE(*, "(5I6)") (buf(i), i = 1, maxsize)
      PRINT*

</PRE>C     Sort the array
<PRE>      CALL SORTQQ(LOC(buf), maxsize, SRT$INTEGER4)

</PRE>C     Print out the sorted array
<PRE>      WRITE(*, "(5I6)") (buf(i), i = 1, maxsize)
      PRINT*

      END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 1.00a 4.00 fail bomb incorrect bad runtime<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: FORTLngIss<BR>
Keywords            : FORTLngIss kbprb kbprg<BR>
Version             : 1.00a | 1.00 4.00<BR>
Platform            : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
