

<HTML>
<HEAD>
<TITLE>FORTRAN 5.1 Setup Procedure for Typical Installations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112006">
<META NAME="KBModify" CONTENT="1995/07/17">
<META NAME="KBCreate" CONTENT="1994/02/27">
<META NAME="Keywords" CONTENT="kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  This article describes how to install Microsoft FORTRAN for the most common configurations. This article includes information related to the FORTRAN installation program, which is detailed in other Knowledge Base articles. This article also supplem...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBFY,QBXB,QATJ,QAFI,QBVV,QBXS,QAYL,QBHQ,QDL9,QDIZ,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FORTRAN 5.1 Setup Procedure for Typical Installations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112006</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
<P>
- Microsoft FORTRAN for MS-DOS, version 5.1
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to install Microsoft FORTRAN for the most common
configurations. This article includes information related to the FORTRAN
installation program, which is detailed in other Knowledge Base articles.
This article also supplements documents that ship with FORTRAN 5.1.
<P>
NOTE: The SETUP command does not fully install Microsoft FORTRAN. Changes
must be made to the computer's environment to get full functionality from
the FORTRAN compiler. These changes are detailed below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Before Running SETUP.EXE</h3>
 
<P>
To ensure that the setup procedure completes, the TMP environment variable
should be set before running SETUP.EXE. If this is not done, Setup may be
unable to create the libraries. The TMP environment variable tells the
components of FORTRAN where to store temporary data when there is no room
in memory (TEMP is used by MS-DOS and Windows for the same purpose). The
TMP environment variable must be set to a directory that follows two
rules:

<UL><LI>The directory must exist.
<LI>The directory should not contain important files.
<P>
</UL>Microsoft recommends creating a unique directory. At the MS-DOS prompt
type:
<P>
<PRE>   mkdir tmp&lt;ENTER&gt;

</PRE>Set the TMP environment variable to point to that directory by typing the
following command at the MS-DOS prompt (do not add any extra spaces to this
command):
<P>
<PRE>   set tmp=c:\tmp&lt;ENTER&gt;

</PRE><h3>Choices in Running SETUP.EXE</h3>
 
<P>
Before Microsoft FORTRAN is installed on your system, you are asked a
series of questions regarding your preferences for installation. The
following sections make suggestions for your responses to each of the Setup
screens. These suggestions are based on the most typical installation of a
Microsoft FORTRAN development system. Each of the screens should be read
fully before making your selection.
<P>
NOTE: You will have a final chance at the end of the questions to go back
and make changes if you make a mistake or change your mind.
<P>
Host Operating System:
<P>
The first choice is for the host operating system. Notice the asterisk
("*") in front of the "DOS" option. When an asterisk is displayed, you must
press the SPACEBAR key before pressing the ENTER key to change the
selection.
<P>
Target Operating System:
<P>
The next choice is for target operating system. Again, you must press the
SPACEBAR key to change the selection. Pressing the ENTER key without first
pressing the SPACEBAR key will not change the selection.
<P>
Windows DLL Libraries:
<P>
If "DOS and Windows" is chosen, the next question is about DLL libraries.
Answering either YES or NO is fine here.
<P>
Combined Libraries:
<P>
Microsoft recommends that you answer YES to build the combined libraries.
<P>
Math Options:
<P>
When making your choice, keep in mind that Emulator or 80x87 chip math are
equally fast if a math coprocessor is present.
<P>
Memory Models:
<P>
The large memory model is usually the best choice for FORTRAN.
<P>
DOS Graphics Libraries:
<P>
Answering NO on this option will still allow full use of graphics in your
programs. You will just need to explicitly link to the graphics libraries
when you use them.
<P>
Error Text:
<P>
Answering either YES or NO is fine.
<P>
C Compatibility:
<P>
Virtually everyone should choose NO for C compatibility. Choosing C
compatibility will create incomplete libraries that are incapable of
creating FORTRAN programs by themselves (these libraries require linking
with libraries from Microsoft C every time you build a program).
<P>
Delete Component Libraries:
<P>
Microsoft recommends that you answer YES to delete your component libraries
to free up space.
<P>
Rename Default Libraries:
<P>
In most cases, you should choose "Rename DOS libraries".
<P>
Programmer's Workbench:
<P>
Answering either YES or NO is fine here.
<P>
BRIEF Compatibility:
<P>
Note that BRIEF compatibility is never required, and therefore Microsoft
recommends that you not add BRIEF compatibility.
<P>
Mouse Driver:
<P>
There have been several revisions and updates to the Microsoft Mouse driver
since FORTRAN 5.1. You should not install this version of the Microsoft
Mouse driver unless you currently do not have one.
<P>
Floating Point Patch:
<P>
Most people do not need the PC-DOS 3.2 patch. In most cases you should not
install this patch.
<P>
Sample Programs:
<P>
Answering either YES or NO is fine here.
<P>
C Start Up Sources:
<P>
The startup sources are rarely used, and therefore the source files may
needlessly use space. Microsoft recommends that you not install the C
startup sources.
<P>
Help Files:
<P>
Answering either YES or NO is fine here.
<P>
Destination Drive:
<P>
The drives and directories to use are up to you. If you have no
preference, the default selections are good.
<P>
NOTE: If FORTRAN is not hosted on OS/2, then the bound executable files can
be put in the ..\BIN rather than the ..\BINB directory. To do this, simply
shorten BINB to BIN in the suggested directory name. This will simplify the
directory structure allowing a shorter PATH environment variable. This non
standard optimization is not required.
<P>
Confirm Your Choices:
<P>
Examine the selections you have made carefully. After you confirm your
choices, SETUP will create the directory structure and build the libraries.
<P>
<P><h3>After Running SETUP.EXE</h3>
 
<P>
After running the FORTRAN installation program, perform the following three
checks to ensure your system is configured properly for FORTRAN.

<OL><P><LI>Confirm that the CONFIG.SYS file is adequate. CONFIG.SYS should contain
   the following three lines:
<P>
<P><PRE>      DEVICE=C:\DOS\HIMEM.SYS (or DEVICE=C:\WINDOWS\HIMEM.SYS - the latest
<PRE></PRE>                               version of HIMEM.SYS should be used)
      FILES=20     (20 is the minimum)
      BUFFERS=10   (10 is the minimum)

</PRE><P><LI>In the AUTOEXEC.BAT file, add the FORTRAN\BIN (and FORTRAN\BINB)
   directories to the beginning of the PATH environment variable. Add the
   definitions for the environment variables LIB, INCLUDE, INIT, and
   HELPFILES immediately after the PATH statement. If the default
   directories are chosen, the AUTOEXEC.BAT file will look similar to the
   following:
<P>
<P><PRE>      SET PATH=C:\FORTRAN\BIN;C:\FORTRAN\BINB;C:\DOS; and so on ...
      SET LIB=C:\FORTRAN\LIB
      SET INCLUDE=C:\FORTRAN\INCLUDE
      SET INIT=C:\FORTRAN\INIT
      SET HELPFILES=C:\FORTRAN\HELP\*.HLP
      SET TMP=C:\TMP
</PRE><P>
   Remember, the TMP directory must be created by you.
<P>
   NOTE: Your individual PATH statement may be slightly different than the
   example above. The PATH environment variable (but not the others) can be
   set three different ways. These three ways are as follows:
<P>
<P><PRE>      SET PATH=C:\FOR....
      PATH=C:\FOR....
      PATH C:\FOR....
</PRE><P>
   In the AUTOEXEC.BAT file, the following three rules should be followed:
<P>
<P><PRE>    - Shell commands such as the following should be last:
</PRE><P>
<PRE>         WIN
         MENU
         DOSSHELL

    - Do not add any spaces to the SET commands (no space before or after
      the equals sign ("=") or at the end of the line). Do not put a
      semicolon (";") at the end of a line.

    - The PATH and the other environment variables should be defined
      exactly once.

</PRE><P><LI>Change to the FORTRAN\INIT directory. There should be a file called
   TOOLS.PRE, which should be one of the following sizes:
<P>
<P><PRE>      5020 Bytes - FORTRAN installed to target MS-DOS
      5024 Bytes - Installed to target MS-DOS and Windows
      5028 Bytes - Installed to target MS-DOS, Windows, and Windows DLLs
</PRE><P>
   The TOOLS.PRE file may be slightly larger if OS/2 is also being
   targeted. However, if TOOLS.PRE is 4907 bytes, it is incomplete. You
   will need to add the following two lines to the end of TOOLS.PRE:
<P>
<P><PRE>      for_doslibs:default
      [pwb-end]
</PRE><P>
   Make a copy of TOOLS.PRE called TOOLS.INI with the MS-DOS command:
<P>
<P><PRE>      copy tools.pre tools.ini&lt;ENTER&gt;
</PRE><P>
   Reboot the computer to complete the FORTRAN 5.1 installation.
<P>
</OL><h3>Additional Steps for Windows</h3>
 
<P>
NOTE: The following steps are not required to create or run QuickWin
applications.
<P>
If FORTRAN 5.1 is installed with a target of Windows, then a file called
SYSTEM.PRE will be created in the Windows directory. This file contains
obsolete information and should not used. FORTRAN QuickWin applications can
be created and run with no changes to Windows. However, to debug QuickWin
applications the following two lines must be added to the [386Enh] section
of the SYSTEM.INI file located in the Windows directory:
<P>
<PRE>   device=vcv.386
   device=c:\fortran\binb\windebug.386

</PRE></OL>NOTE: Before editing the SYSTEM.INI file, always make a backup copy.
<P>
To create an icon for FORTRAN in the Windows Program Manager do the
following:

<OL><P><LI>Go to Program Manager and choose New from the File menu.

<P><LI>Select Program Item and choose OK. This will bring up the Program Item
   Properties dialog box.

<P><LI>In the Description text box, enter FORTRAN, or something similar.

<P><LI>Enter PWB.COM in the Command Line text box.

<P><LI>The Working Directory text box should contain the directory where you
   will put most of your work. This could be a directory of your own such
   as C:\MYWORK, or it could be C:\FORTRAN. The Working Directory should
   not be C:\FORTRAN\BIN or BINB.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf  5.10<BR>
KBCategory: kbsetup<BR>
KBSubcategory: f51setup<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
