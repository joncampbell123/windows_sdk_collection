

<HTML>
<HEAD>
<TITLE>PRB: QuickWin Termination Routines and QuickWin Graphics </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89909 ">
<META NAME="KBModify" CONTENT="1995/07/18">
<META NAME="KBCreate" CONTENT="1992/10/05">
<META NAME="Keywords" CONTENT="kbprg kberrmsg kbcode kbprb">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Trying to use the REPLACE.BAT batch file from the Microsoft FORTRAN application note HF0450  Alternatives to QuickWin Termination Message Box  on a FORTRAN Windows library that has already been configured for use with QuickWin graphics will cause t...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAB4,QAAP,QA8T,QAPN,QA4Q,QBDM,QBBS,QBVV,QBHQ,QBW7,QAI5,QA4F,QAGB,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: QuickWin Termination Routines and QuickWin Graphics</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89909 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, version 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Trying to use the REPLACE.BAT batch file from the Microsoft FORTRAN
application note HF0450 "Alternatives to QuickWin Termination Message Box"
on a FORTRAN Windows library that has already been configured for use with
QuickWin graphics will cause the library utility to generate the following
errors:
<P>
<PRE>   LIB : error U2155: qwexit : module not in library; ignored

   LIB : error U2155: qwglob : module not in library; ignored

   LIB : error U2155: qwiswin : module not in library; ignored

</PRE>LIB will then generate 44 errors similar to the following:
<P>
<PRE>  qwexmode.obj : warning U4151: '__QWINGetExit' : symbol defined in
  module qwkexmod, redefinition ignored

</PRE><h2>CAUSE</h2>
 
<P>
The application note was created before the release of the the QuickWin
graphics library. Most of the code in the application note is in the
modified QuickWin Windows library, except for an object module,
EXITMODE.OBJ, that contains two "wrapper" routines for accessing the
routines SETEXITQQ and GETEXITQQ without interface statements. The code is
in differently named modules and QWEXIT.OBJ, QWGLOB.OBJ, and QWISWIN.OBJ
have already been removed during modification for QuickWin graphics. When
the code in the object modules from the application note is added to
LLIBFEW.LIB, the symbol redefinition errors occur because the code is
already there.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not run the REPLACE.BAT batch file from the application note. To access
the GETEXITQQ and SETEXITQQ routines, there are two options:

<UL><LI>Add only the object module EXITMODE.OBJ to LLIBFEW.LIB using the
   command:
<P>
<P><PRE>      LIB LLIBFEW.LIB +EXITMODE.OBJ;
</PRE><P>
   In this way, the routines can be accessed using no interface
   statements or by using the interface statements in the FLIB.FI
   file included with the application note.
<P>
   -or-

<LI>Add two interface statements to the FGRAPH.FI file to use the
   ALIAS attribute to access the routines that are already in the
   QuickWin graphics modified LLIBFEW.LIB.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The actual routines that allow modification of the default exit mode
for QuickWin applications are __QWINGetExit() and __QWINSetExit(). The
object module EXITMODE.OBJ (included only with the application note)
has two wrapper routines (GETEXITQQ and SETEXITQQ) that do nothing but
call the __QWIN routines.  They are not required if the necessary
interface statements are included. For ease of use, some additional
information can be added to FGRAPH.FD that allows use of symbolic
constants instead of literal constants. NOTE: the two alias contain two
consecutive leading underline characters. This may not be apparent
in some versions of the text.
<P>
<P><h3>Sample Code #1</h3>
 
<P>
Put the following interface statements in the FGRAPH.FI file:
<P>
<PRE>      interface to integer*2 function setexitqq
     +                       [c,alias:'__QWINSetExit'](exitmode)

      integer*2 exitmode[value]
      end

      interface to integer*2 function getexitqq
     +                       [c,alias:'__QWINGetExit']()
      end


</PRE><h3>Sample Code #2</h3>
 
<P>
Put the following information in the FGRAPH.FD file:
<P>
<PRE>      INTEGER*2 QWIN$EXITPROMPT
      INTEGER*2 QWIN$EXITNOPERSIST
      INTEGER*2 QWIN$EXITPERSIST

      PARAMETER (QWIN$EXITPROMPT    = 1)
      PARAMETER (QWIN$EXITNOPERSIST = 2)
      PARAMETER (QWIN$EXITPERSIST   = 3)

      INTEGER*2 GETEXITQQ[EXTERN]
      INTEGER*2 SETEXITQQ[EXTERN]


</PRE><h3>Sample Code #3</h3>
 
<P>
The following code illustrates accessing the routines after the above
files have been modified:
<P>
<PRE>      include 'fgraph.fi'

      program exitmode

      include 'fgraph.fd'

      integer*2 exmode

      write(*,'(1X,A,/)') 'Please enter the exit mode 1, 2 or 3 '
      read(*,*) exmode

      write(*,'(1X,A,I2)') 'Exit value = ',GETEXITQQ()

      SELECT CASE (exmode)

           CASE (1)
               if( SETEXITQQ( QWIN$EXITPROMPT ) .ne. 0 ) then
                    write(*,*) 'Error returned'
               endif
               write(*,'(1X,A,I2)') 'Exit value = ', GETEXITQQ()

           CASE (2)
               if( SETEXITQQ( QWIN$EXITNOPERSIST ) .ne. 0 ) then
                    write(*,*) 'Error returned'
               endif
               write(*,'(1X,A,I2)') 'Exit value = ', GETEXITQQ()

           CASE (3)
               if( SETEXITQQ( QWIN$EXITPERSIST ) .ne. 0 ) then
                    write(*,*) 'Error returned'
               endif
               write(*,'(1X,A,I2)') 'Exit value = ', GETEXITQQ()

           CASE DEFAULT
               write(*,*) 'Invalid option - checking for bad return'
               if( SETEXITQQ( exmode ) .ne. -1 ) then
                   write(*,*) 'Error not returned'
               else
                   write(*,*) 'Correct error return code'
               endif

      END SELECT

      end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10<BR>
KBCategory: kbprg kberrmsg kbcode kbprb<BR>
KBSubategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
