

<HTML>
<HEAD>
<TITLE>APPNOTE: EXEC Function Appnote Available with FORTRAN 5.x </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75223 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/08/14">
<META NAME="Keywords" CONTENT="kbtool kbappnote kbfile">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  The application note titled  EXEC Function for FORTRAN  contains a function similar to the SPAWNLP function. The SPAWNLP function, included in the Microsoft FORTRAN 5.0 and 5.1 packages, suspends program execution and spawns a child process while l...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QBDM,QAJH,QAH4,QBHQ,QBV8,QAPF,QAB9,QAH6,QAJZ,QBW6,QA5C,QAGI,QBW9,QBJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>APPNOTE: EXEC Function Appnote Available with FORTRAN 5.x</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75223 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 5.0 and 5.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The application note titled "EXEC Function for FORTRAN" contains a
function similar to the SPAWNLP function. The SPAWNLP function,
included in the Microsoft FORTRAN 5.0 and 5.1 packages, suspends
program execution and spawns a child process while leaving the parent
process in memory. When this child process terminates, control returns
to the parent process. On the other hand, the EXEC function terminates
the parent process, taking the parent process out of memory, and then
spawns the child process. Upon termination of the child process, the
program is completed.
<P>
This application note "EXEC Function for FORTRAN" can be obtained by
calling Microsoft Product Support Services.
<P>
This application note is also available in the Microsoft Software Library.
<P>
Download HF0221.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/hf0221.exe">HF0221.EXE</A> <I>(size: 47469 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \softlib\mslfiles directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/hf0221.exe">HF0221.EXE</A> <I>(size: 47469 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The following is the text of the application note:
<P>
 
<PRE>                    HF0221: FORTRAN EXEC Function
</PRE> 
<PRE>                                                   Revision Date: 8/91
 --------------------------------------------------------------------
| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an            |
| Application Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY      |
| KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO    |
| THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A     |
| PARTICULAR PURPOSE. The user assumes the entire risk as to the     |
| accuracy and the use of this Application Note. This Application    |
| Note may be copied and distributed subject to the following        |
| conditions: 1) All text must be copied without modification and    |
| all pages must be included; 2) If software is included, all files  |
| on the disk(s) must be copied without modification [the MS-DOS(R)  |
| utility DISKCOPY is appropriate for this purpose]; 3) All          |
| components of this Application Note must be distributed together;  |
| and 4) This Application Note may not be distributed for profit.    |
|                                                                    |
| Copyright 1991 Microsoft Corporation. All Rights Reserved.         |
| Microsoft, MS-DOS, and the Microsoft logo are registered           |
| trademarks and Windows is a trademark of Microsoft Corporation.    |
 --------------------------------------------------------------------

</PRE>Simulating the P_OVERLAY Function of _spawnlp with the Microsoft
FORTRAN Optimizing Compiler Versions 4.0, 4.01, 4.1, 5.0, and 5.1
<P>
Versions 4.0, 4.01, 4.1, 5.0, and 5.1 of the Microsoft FORTRAN
Optimizing Compiler do not support the option within the _spawnlp
function that allows a second user program to completely overwrite the
space used by the program that initiates it. The programs supplied
with this application note use a slightly different mechanism to
provide this missing functionality. The EXEC function works under the
DOS operating system only.
<P>
The following files are provided on the FORTRAN 4.0, 4.01, 4.1, 5.0,
5.1 EXEC Function disk included with this application note:
<P>
<PRE>   Filename            Description of File
   --------            -------------------

   README.DOC          Text of application note.

   EXEC.INC            A FORTRAN INTERFACE file that must be included
                       in every source file calling EXEC.

   LV40EXEC.LIB        Large memory model library for version 4.0 and
                       4.01 containing the routines necessary to
                       perform an EXEC.

   MV40EXEC.LIB        Medium memory model library for version 4.0 and
                       4.01 containing the routines necessary to
                       perform an EXEC.

   LV41EXEC.LIB        Large memory model library for versions 4.1 and
                       5.0 containing the routines necessary to
                       perform an EXEC.

   MV41EXEC.LIB        Medium memory model library for versions 4.1
                       and 5.0 containing the routines necessary to
                       perform an EXEC.

   LV51EXEC.LIB        Large memory model library for version 5.1
                       containing the routines necessary to perform an
                       EXEC.

   MV51EXEC.LIB        Medium memory model library for version 5.1
                       containing the routines necessary to perform an
                       EXEC.

   TEST1.FOR           Program to test an EXEC. It is more than
                       300,000 bytes in size and will EXEC the TEST2
                       program, which is of similar size. The
                       intention is to show that the two programs,
                       TEST1.FOR and EST2.FOR, which cannot fit in
                       memory at the same time, can be executed
                       individually.

   TEST2.FOR           Program to be executed by TEST1.

</PRE>Link the program that calls EXEC (TEST1 in this case) with the
appropriate library listed above. For example, when using FORTRAN 5.1
for the large memory model, the compile line should look as follows:
<P>
<PRE>   fl test1.for LV51EXEC.LIB

</PRE>This will compile TEST1.FOR and link it with the FORTRAN run-time
library in addition to the EXEC function library specified.
<P>
Note: TEST1 and TEST2 are completely independent of each other. They
can even be compiled with different memory models.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.10 appnote softlib hf0221.exe<BR>
KBCategory: kbtool kbappnote kbfile<BR>
KBSubcategory: TlsMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
