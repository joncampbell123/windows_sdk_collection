

<HTML>
<HEAD>
<TITLE>BUG: Error w/ CHAR() in WRITE of Unformatted or Binary Output </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147756">
<META NAME="KBModify" CONTENT="1996/02/29">
<META NAME="KBCreate" CONTENT="1996/02/29">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Writing unformatted character output to a file with a CHAR expression causes an application error similar to the following:  Under Windows NT version 3.51:     Application Error -  The instruction at 0x0040a9ba referenced    memory at 0x00000041. T...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QAH4,QBWP,QDKW,QBXT,QA5V,QAMB,QAIB,QAKP,QA8T,QA5A,QAYL,QAAP,QAB4,QDKA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error w/ CHAR() in WRITE of Unformatted or Binary Output</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147756</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Fortran PowerStation for Windows 95 and Windows NT,
   version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Writing unformatted character output to a file with a CHAR expression
causes an application error similar to the following:
<P>
Under Windows NT version 3.51:
<P>
<PRE>   Application Error -  The instruction at 0x0040a9ba referenced
   memory at 0x00000041. The memory could not be read

</PRE>Under Windows 95:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>-or-
<P>
Writing binary character output to a file with a CHAR expression causes an
application error similar to the following:
<P>
Under Windows NT version 3.51:
<P>
<PRE>   Application Error - The instruction at 0x0040a773 referenced
   memory at 0x00000041. The memory could not be read.

</PRE>Under Windows 95:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE><h2>RESOLUTION</h2>
 
<P>
Perform intermediate calculations in a temporary variable. Then use it in
the CHAR() expression.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code demonstrates the problem writing unformatted output:
<P>
<P><h3>Sample Code</h3>
 
<P>
C Compile options needed: none
<P>
<PRE>      integer len
      len = 66
      open(1,file='t.out',form='unformatted')

</PRE>C The following line causes an Access violation
<PRE>      write(1) char(len-1) ! Comment this line for workaround

</PRE>C To workaround the problem perform intermediate calculations
C in a temporary variable and use it in the char() expression.
<P>
<PRE>C      i = len - 1         ! Uncomment this line for workaround
C      write(1) char(i)    ! Uncomment this line for workaround

      close(1)
      end

</PRE>The following code demonstrates the problem writing binary output:
<P>
<P><h3>Sample Code</h3>
 
<P>
C Compile options needed: none
<P>
<PRE>      integer len
      len = 66
      open(1,file='t.out',form='binary')

</PRE>C The following line causes an Access violation
<PRE>      write(1) char(len-1) ! Comment this line for workaround

</PRE>C To workaround the problem perform intermediate calculations
C in a temporary variable and use it in the char() expression.
<P>
<PRE>C      i = len - 1         ! Uncomment this line for workaround
C      write(1) char(i)    ! Uncomment this line for workaround

      close(1)
      end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
