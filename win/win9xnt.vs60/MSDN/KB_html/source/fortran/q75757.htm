

<HTML>
<HEAD>
<TITLE>FIX: Record Not Advanced If Branching to ERR= on READ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75757 ">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1991/09/03">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Unexpected or incorrect results may be generated while reading a file.  CAUSE =====  When an error is encountered on a READ statement containing an ERR=label field, the program correctly branches to the error label, and the file pointer remains pos...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QBFN,QAH4,QAAP,QAM4,QAB4,QAVX,QAVW,QAOX,QAKP,QAR4,QAPN,QBC9,QBC8,QA63 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Record Not Advanced If Branching to ERR= on READ</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75757 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.10 | 5.00 5.10
<PRE>MS-DOS    | OS/2
</PRE>kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 5.0 and 5.1
<LI>Microsoft FORTRAN for OS/2, versions 5.0 and 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Unexpected or incorrect results may be generated while reading a file.
<P>
<P><h2>CAUSE</h2>
 
<P>
When an error is encountered on a READ statement containing an ERR=label
field, the program correctly branches to the error label, and the file
pointer remains positioned after the point where the error occurred. Upon
reading the file again, if any data remains on that record, the READ
statement will fill variables with values from that record. Although this
practice may at times appear unintuitive, the ANSI standard is unclear
about where the file pointer should be positioned following an error
branching on the READ statement.
<P>
However, if no variables remain on a record in which an error is branched
to upon a prior READ statement, when reading from the file again, the next
variable is filled with a zero. See the sample code for more information.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Force the file pointer to advance to the next record.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft FORTRAN versions
5.0 and 5.1. This problem was corrected in FORTRAN PowerStation, version
1.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code can be used to reproduce the problem with a test.dat of
<P>
<PRE>   1
   2
   3
   a
   5
   6
   7
   8
   9
   10


</PRE><h3>Sample Code #1</h3>
 
<P>
<PRE>       open(1,file='test.dat')
       do 10 j=1,10
         read(1,'(i3)',err=100,end=200) i
         print*,i
</PRE>10     continue
<PRE>       stop
</PRE>100    print*,'read error'
<PRE>       goto 10
</PRE>200    end
<P>
The above code produces the following results:
<P>
<PRE>          1
          2
          3
</PRE>read error
<PRE>          0                  ! Not advancing to next record at this point
          5
          6
          7
          8
          9
         10

</PRE>The following code forces the file pointer to advance to the next record
when an error is encountered during a READ statement:
<P>
<P><h3>Sample Code #2</h3>
 
<P>
<PRE>          open(1,file='test.dat')
          do 10 j=1,10
            read(1,'(i3)',err=100,end=200) i
            print*,i
   10     continue
          stop
  100     print*,'read error'
          read(1,*) ! advance to next record
          goto 10
  200     end

</PRE>The output for the above code is as follows:
<P>
<PRE>          1
          2
          3
</PRE>read error
<PRE>          5
          6
          7
          8
          9
         10
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.10 buglist5.00 buglist5.10 fixlist1.00<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubCategory: FORTLngIss<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
