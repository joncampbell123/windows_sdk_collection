

<HTML>
<HEAD>
<TITLE>BUG: Incorrect Results or Hanging with INTDOSXQQ() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76669 ">
<META NAME="KBModify" CONTENT="1995/07/12">
<META NAME="KBCreate" CONTENT="1991/09/30">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  A program compiled with Microsoft FORTRAN version 5.1 may generate incorrect results, hang the machine under MS-DOS, or generate a protection violation under OS/2 if the program makes a call to the MS-DOS interrupt function subroutine INTDOSXQQ(). ...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAGI,QAH4,QAYY,QAL3,QDMH,QATX,QAAP,QAEF,QAC2,QAB3,QAIF,QAKP,QA4Q,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Incorrect Results or Hanging with INTDOSXQQ()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 12, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76669 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, version 5.1
<LI>Microsoft FORTRAN for OS/2, version 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A program compiled with Microsoft FORTRAN version 5.1 may generate
incorrect results, hang the machine under MS-DOS, or generate a protection
violation under OS/2 if the program makes a call to the MS-DOS interrupt
function subroutine INTDOSXQQ().
<P>
<P><h2>CAUSE</h2>
 
<P>
The include file FLIB.FI declares the arguments to INTDOSXQQ() to be passed
by value, when they should be passed by reference. This corrupts the stack
causing unpredictable results.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Modify the FLIB.FI file to contain the REFERENCE attribute on the
arguments to INTDOSXQQ(). The lines look like this:
<P>
<PRE>      RECORD /REGS$INFO/ REGS1
      RECORD /REGS$INFO/ REGS2
      RECORD /SREGS$INFO/ SREGS
      END

</PRE>and should be modified to be:
<P>
<PRE>      RECORD /REGS$INFO/ REGS1 [REFERENCE]
      RECORD /REGS$INFO/ REGS2 [REFERENCE]
      RECORD /SREGS$INFO/ SREGS [REFERENCE]
      END

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft FORTRAN version
5.1 for MS-DOS and OS/2.
<P>
This article does not apply to FORTRAN PowerStation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code reproduces the problem:
<P>
<P><h3>Sample code</h3>
 
<P>
<PRE>       include 'flib.fi'
       implicit none
       include 'flib.fd'
       character*64 string[c]
       integer address
       integer*2 addresspart(2)
       record /regs$info/ in,out
       record /sregs$info/ seg
       equivalence (address,addresspart(1))
       address=locfar(string)
       in.wregs.ax=#4700
       in.wregs.bx=#0000
       in.wregs.cx=#0000
       in.wregs.dx=#0000
       in.wregs.si=addresspart(1)
       in.wregs.di=#0000
       in.wregs.cflag=#0000
       seg.es=#0000
       seg.ds=addresspart(2)
       CALL INTDOSxQQ(IN,OUT,seg)   ! this call returns nothing
       WRITE(*,1000) STRING
       STOP
 1000 FORMAT(1x,'THE Current Directory Is: ',A)
       END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 12, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
