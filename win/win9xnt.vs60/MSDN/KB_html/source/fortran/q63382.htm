

<HTML>
<HEAD>
<TITLE>PRB: R6009: "Not Enough Space for Environment" When Heap Full </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q63382 ">
<META NAME="KBModify" CONTENT="1995/07/18">
<META NAME="KBCreate" CONTENT="1990/06/26">
<META NAME="Keywords" CONTENT="kbtool kberrmsg kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  An attempt to run an application fails and the following message appears on the screen:     R6009: Not Enough Space For Environment  CAUSE =====  After the application loads into memory, this error occurs when the application is unable to load a co...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAX1,QAA1,QBVV,QBFY,QBV8,QAY5,QAPN,QAKR,QAB9,QDI2,QAH4,QAJH,QBW6,QBIC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: R6009: "Not Enough Space for Environment" When Heap Full</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q63382 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 4.0, 4.01, 4.1, 5.0, 5.1
<LI>Microsoft FORTRAN for OS/2, version 4.1, 5.0, 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An attempt to run an application fails and the following message
appears on the screen:
<P>
<PRE>   R6009: Not Enough Space For Environment

</PRE><h2>CAUSE</h2>
 
<P>
After the application loads into memory, this error occurs when the
application is unable to load a copy of the environment and the
argument list into the near heap.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, perform one of the following four
steps:

<UL><LI>If the CONFIG.SYS file contains a SHELL statement with the /e:
   parameter, reduce the amount of environment space SHELL
   allocates by reducing the value specified in the /e: parameter.
   The SHELL statement should somewhat resemble the following:
<P>
<P><PRE>      shell=c:\command.com /p /e:xxxx
</PRE><P>
   -or-

<LI>Compile the application with the large memory model. Specify the
   /Gt compiler option switch to remove some global data from the
   DGROUP default data segment and free memory for the environment
   and the argument list. (The /Gt0 compiler option switch removes
   the most data from DGROUP.)
<P>
   -or-

<LI>If the application does not use any command-line arguments,
   rewrite the C function _setargv() to do nothing. If the
   application does not need a copy of its environment, rewrite the
   C function _setenvp(). The code example below demonstrates
   eliminating these two C functions in FORTRAN.
<P>
   -or-

<LI>Reduce the stack size to provide room for the command-line
   arguments and the environment.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
In an application developed in standard Microsoft C, the _setargv()
and _setenvp() functions attempt to set up the argument vector and the
environment vector, respectively. Each of these vectors is allocated
from the near heap. In the near heap is full, or nearly full, the
functions are unable to set up the vectors and the R6009 run-time
error occurs.
<P>
To prevent the error, substitute a null function for the _setargv()
and _setenvp() functions to prevent the near heap allocation from
taking place. The following FORTRAN code example performs this task.
Specify the /NOE linker option switch to prevent the "L2044: symbol
multiply defined" error.
<P>
<P><h3>Sample Code</h3>
 
<P>
C Compile options needed: None
<P>
<PRE>      INTERFACE TO SUBROUTINE SETARGV[C, ALIAS:'__setargv']()
      END
      INTERFACE TO SUBROUTINE SETENVP[C, ALIAS:'__setenvp']()
      END
      SUBROUTINE SETARGV
      RETURN
      END
      SUBROUTINE SETENVP
      RETURN
      END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.01 4.10 5.00 5.10<BR>
KBCategory: kbtool kberrmsg kbprb kbcode<BR>
KBSubcategory: FLIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
