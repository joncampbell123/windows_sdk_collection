

<HTML>
<HEAD>
<TITLE>FIX: Bad Output with Element of Structure in CHAR Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q69002 ">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1991/02/02">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  In FORTRAN 5.0 and 5.1, a program using the CHAR intrinsic function on a structure element within a WRITE or PRINT statement can produce erroneous output when executed under MS-DOS, or result in a protection violation when executed under OS/2.  RES...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAY5,QAYL,QAUJ,QAB9,QAOX,QAAP,QAIC,QA8T,QA5V,QA5A,QAPN,QAL3,QBV8,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Bad Output with Element of Structure in CHAR Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q69002 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.10 | 5.00 5.10
MS-DOS | OS/2
kbtool kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 5.0 and 5.1
<LI>Microsoft FORTRAN for OS/2, versions 5.0 and 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In FORTRAN 5.0 and 5.1, a program using the CHAR intrinsic function
on a structure element within a WRITE or PRINT statement can produce
erroneous output when executed under MS-DOS, or result in a protection
violation when executed under OS/2.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid these problems, remove the intrinsic function from the WRITE
or PRINT statement by assigning the result of the CHAR intrinsic
function to a temporary variable, and then use this variable in the
output statement.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FORTRAN versions 5.0
and 5.1. This problem was corrected in FORTRAN PowerStation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example reproduces the problem:
<P>
<PRE>       structure /a/
         integer*2 i
       end structure

       record /a/ name
       name.i=97                   ! ASCII lowercase a
       write(*,*) char(name.i)
       end

</PRE><P><LI>When the above program is linked for MS-DOS, the resulting executable
   prints the wrong character or no character at all.

<P><LI>When it is linked for OS/2, the resulting executable generates a
   protection violation during runtime.

<P><LI>When it is compiled under MS-DOS with the patched version of F1.EXE
   (used to correct several problems with structures and NAMELIST
   statements) and linked for either DOS or OS/2, the executable
   generates the correct results.

<P><LI>When it is compiled under OS/2 with the patched version of F1.EXE,
   a protection violation is generated during compilation in the F2.EXE
   pass of the compiler.
<P>
</OL>One possible solution is to assign the result of the CHAR intrinsic
function to a temporary variable as illustrated by the following
example:
<P>
<PRE>       structure /a/
         integer*2 i
       end structure

       character c
       record /a/ name
       name.i=97              ! ASCII lowercase a

       c=char(name.i)
       write(*,*) c
       end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.00 5.10<BR>
KBCategory: kbtool kbfixlist kbbuglist<BR>
KBSubcategory: FLIss<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
