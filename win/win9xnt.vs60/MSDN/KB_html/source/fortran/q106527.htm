

<HTML>
<HEAD>
<TITLE>FIX: Error in /FILE$INFO/ in FLIB.FI and FLIB.FD </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106527">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1993/11/10">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Data corruption may occur after a call to GETFILEINFOQQ due to the NAME field of /FILE$INFO/ in FLIB.FI and FLIB.FD being declared character*13 instead of character*255. In some cases the following error:    run-time error F6316: array already allo...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QAYY,QAAP,QAR4,QA7O,QA7N,QAB4,QBJZ,QAKP,QAY2,QAUD,QAWN,QAKE,QARM,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Error in /FILE$INFO/ in FLIB.FI and FLIB.FD</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106527</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
MS-DOS
kbtool kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN PowerStation for MS-DOS, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Data corruption may occur after a call to GETFILEINFOQQ due to the
NAME field of /FILE$INFO/ in FLIB.FI and FLIB.FD being declared
character*13 instead of character*255. In some cases the following
error:
<P>
<PRE>  run-time error F6316: array already allocated

</PRE>may be produced.
<P>
<P>
<P><h2>CAUSE</h2>
 
<P>
Page 313 of the FORTRAN PowerStation "Language Guide" shows the
structure of /FILE$INFO/, which is used to return information about
the file that matches the search criteria. The NAME (of file) field is
declared as character*255. However, the NAME field is declared only as
character*13 in FLIB.FD and FLIB.FI. Therefore, using /FILE$INFO/ from
FLIB.FD with GETFILEINFOQQ will cause data corruption because the
character*13 field overflows.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In F32\INCLUDE\FLIB.FI and F32\INCLUDE\FLIB.FD change
<P>
<PRE>   CHARACTER*13    NAME              ! Filename

</PRE>to the following:
<P>
<PRE>   CHARACTER*255   NAME              ! Filename

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FORTRAN PowerStation
version 1.0. This problem was corrected in FORTRAN PowerStation version
1.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To demonstrate the problem (before making the above correction):

<OL><P><LI>In the Visual Workbench (VWB), build
   F32\SAMPLES\RUNTIME\RUNTIME.FOR with the project in debug mode.

<P><LI>Set a breakpoint on line 166:
<P>
<P><PRE>      length = GETFILEINFOQQ(files, info, handle)
</PRE>
<P><LI>"GO" (F5), and then enter "*.FOR" (without the quotation marks) in
   the "F32 DEBUG" window.

<P><LI>Open the Locals window (choose Locals from the Windows menu). Note
   the values of some integers such as IMIN (should be zero).

<P><LI>Single step (F10). Note that IMIN now equals 8224 (hexadecimal
   2020).

<P><LI>In F32\INCLUDE\FLIB.FI and F32\INCLUDE\FLIB.FD, change NAME from
   CHARACTER*13 to CHARACTER*255.
<P>
</OL>7 Repeat steps 1-5. This time IMIN will remain zero.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 kbdocerr<BR>
KBCategory: kbtool kbfixlist kbbuglist<BR>
KBSubcategory: TlsMisc<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
