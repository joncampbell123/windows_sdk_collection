

<HTML>
<HEAD>
<TITLE>FIX: F1001: omf_ms.c, Line 1093, Variable Used Then Declared </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51608 ">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1989/12/04">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Compiling an application in OS/2 fails and a protection violation occurs. An attempt to compile the same application in  MS-DOS fails and the compiler generates the appropriate message below. For FORTRAN version 5.1:     F1001 : Internal Compiler E...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAYL,QAHE,QAB9,QAUD,QAGI,QAFF,QAAP,QBFY,QAR4,QAOT,QAB4,QAH4,QAKP,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: F1001: omf_ms.c, Line 1093, Variable Used Then Declared</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51608 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.10 5.00 5.10 | 4.10 5.00 5.10
<PRE>MS-DOS         | OS/2
</PRE>kbtool kbfixlist kbbuglist kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS and OS/2, versions 4.1, 5.0, 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Compiling an application in OS/2 fails and a protection violation occurs.
An attempt to compile the same application in  MS-DOS fails and the
compiler generates the appropriate message below. For FORTRAN version 5.1:
<P>
<PRE>   F1001 : Internal Compiler Error
   (compiler file '@(#)omf_ms.c:1.119',line 1093)

</PRE>For FORTRAN versions 4.1 and 5.0:
<P>
<PRE>   F1001 : Internal Compiler Error
   (compiler file '@(#)omf_ms.c:1.118',line 1093)

</PRE><h2>CAUSE</h2>
 
<P>
The application contains an executable statement that refers to a variable
that is used later as a formal parameter in an ENTRY statement but not as a
formal argument in a SUBROUTINE statement. FORTRAN does not support this
practice.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid this error, declare each variable used in an executable statement
as a formal argument in a SUBROUTINE statement.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FORTRAN versions 4.1, 5.0,
and 5.1. This problem was corrected in FORTRAN PowerStation, version 1.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
FORTRAN does not support using a variable in an executable statement
if it does not appear in a SUBROUTINE statement. The fourth paragraph
on page 163 in the Microsoft FORTRAN "Reference" manual for versions
5.0 and 5.1 includes the following statement:
<P>
<PRE>   A formal argument cannot appear in an executable statement that
   occurs before the ENTRY statement containing the formal argument
   unless the formal argument also appears in a FUNCTION, SUBROUTINE,
   or ENTRY statement that precedes the executable statement.

</PRE>The next-to-last paragraph on page 208 of the Microsoft FORTRAN "Language
Reference" manual for version 4.1 contains similar information.
<P>
FORTRAN PowerStation correctly generates the error:
<P>
<PRE>   F2209: illegal as formal argument

</PRE>The following code example demonstrates this problem.
<P>
<P><h3>Sample Code #1</h3>
 
<P>
C Compile options needed: None
<P>
<PRE>      A = 100.0
      CALL SETPT (A)
      CALL FRSTC
      STOP
      END

      SUBROUTINE FRSTC
      WRITE (*, *) B     ! b in an executable statement
      RETURN
      ENTRY SETPT (B)    ! b as formal parameter (for first time)
      RETURN
      END

</PRE>If the application declares "B" as a formal parameter for the FRSTC
subroutine, the program compiles without any errors.
<P>
<P><h3>Sample Code #2</h3>
 
<P>
<PRE>      A = 100.0
      CALL SETPT (A)
      CALL FRSTC (A)
      STOP
      END

      SUBROUTINE FRSTC (B)
      WRITE (*, *) B
      RETURN
      ENTRY SETPT (B)
      RETURN
      END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.10 5.00 5.10 buglist4.10 buglist5.00<BR>
buglist5.10 fixlist1.00<BR>
KBCategory: kbtool kbfixlist kbbuglist kberrmsg<BR>
KBSubcategory: FLIss<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
