

<HTML>
<HEAD>
<TITLE>BUG: Share='DENYNONE' Does Not Grant Full Share Privileges </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106722">
<META NAME="KBModify" CONTENT="1995/07/13">
<META NAME="KBCreate" CONTENT="1993/11/14">
<META NAME="Keywords" CONTENT="kbtool kbbuglist kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Assuming SHARE.EXE is loaded, if a FORTRAN application opens a file with share='DENYNONE', attempting to access that open file from a FORTRAN PowerStation application will generate the following error:     run-time error F6414: OPEN(file_name)    -...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QANE,QA3A,QAAP,QBWS,QBWO,QAB4,QA0K,QAY2,QBW7,QAI5,QACF,QBVV,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Share='DENYNONE' Does Not Grant Full Share Privileges</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 13, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106722</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 4.0, 4.1, 5.0, and 5.1
<LI>Microsoft FORTRAN for OS/2, versions 4.1, 5.0, and 5.1
<LI>Microsoft FORTRAN PowerStation for MS-DOS, versions 1.0 and 1.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Assuming SHARE.EXE is loaded, if a FORTRAN application opens a file
with share='DENYNONE', attempting to access that open file from a
FORTRAN PowerStation application will generate the following error:
<P>
<PRE>   run-time error F6414: OPEN(file_name)
   - access not allowed

</PRE>If the open file is accessed from an MS-DOS prompt or from Windows,
the following error will be generated:
<P>
<PRE>   Sharing violation reading drive C
   Abort, Retry, Fail?

</PRE>(Note that the above error assumes the open file is on drive C.)
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If possible, do not load SHARE.EXE. If SHARE must be used,
applications created with FORTRAN version 5.1 or earlier can
successfully access files opened with share='DENYNONE'.
<P>
If you are using the maintenance release of FORTRAN PowerStation, version
1.0a, the work around is to add the attribute mode='readwrite' in the open
statement, like this:
<P>
<PRE>     character*30 a
       open (2, file='test.for',
</PRE>+mode='readwrite',share='DENYNONE')
<PRE>       read (2,'(A)') a
       print *, a
       read *
       end


</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in FORTRAN PowerStation
versions 1.0 and 1.0a for MS-DOS.
<P>
FORTRAN PowerStation version 1.0 can be differentiated from the
maintenance release version 1.0a by invoking the linker. Typing
"link32 | more" from \F32\BIN directory will show version 2.8 for
FORTRAN PowerStation version 1.0, and it will show version 1.0f for
the maintenance release version 1.0a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To duplicate the error, follow these steps:

<OL><P><LI>Make sure SHARE.EXE is loaded. Note that Windows for Workgroups
   automatically loads SHARE.

<P><LI>Start Windows.

<P><LI>Build the sample code TEST.FOR using the FORTRAN PowerStation.

<P><LI>From a Windows MS-DOS prompt, run TEST.EXE; it will pause after
   displaying one line from TEST.FOR.

<P><LI>Open a second Windows MS-DOS prompt and run TEST.EXE again; the
   following incorrect error will be displayed:
<P>
<P><PRE>      run-time error F6414: OPEN(test.for)
      - access not allowed
</PRE>
<P><LI>In the second prompt, type "TYPE TEST.FOR". The following will be
   displayed:
<P>
<P><PRE>      Sharing violation reading drive C
      Abort, Retry, Fail?
</PRE><P>
</OL>If TEST.FOR is compiled with FORTRAN version 5.1 or earlier, step 5
will not generate the F6414 error, but step 6 will still fail.
<P>
<P><h3>Sample Code (TEST.FOR)</h3>
 
<P>
Compile Options: None
<PRE>       character*30 a
       open (2, file='test.for', share='DENYNONE')
       read (2,'(A)') a
       print *, a
       read *
       end
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 5.10 5.00 4.10 4.00a 4.00<BR>
KBCategory: kbtool kbbuglist kberrmsg<BR>
KBSubCategory: FLIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 13, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
