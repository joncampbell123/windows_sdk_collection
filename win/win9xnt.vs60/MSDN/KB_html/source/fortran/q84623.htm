

<HTML>
<HEAD>
<TITLE>BUG: YIELDQQ and /MW Cause F2616 Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84623 ">
<META NAME="KBModify" CONTENT="1995/07/11">
<META NAME="KBCreate" CONTENT="1992/05/17">
<META NAME="Keywords" CONTENT="kbtool kberrmsg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  Code containing a call to the subroutine YIELDQQ compiled with the /MWn option, where n is not 0, may cause the Microsoft FORTRAN Compiler version 5.1 to generate the following error:     error F2616: YIELDQQ : illegal use of function or subroutine...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAH4,QAY5,QBV8,QAIF,QAAP,QAFF,QAB4,QAB9,QAOT,QBLS,QBFY,QAKP,QBVV,QBBS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: YIELDQQ and /MW Cause F2616 Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84623 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, version 5.1
<LI>Microsoft FORTRAN for OS/2, version 5.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Code containing a call to the subroutine YIELDQQ compiled with the /MWn
option, where n is not 0, may cause the Microsoft FORTRAN Compiler version
5.1 to generate the following error:
<P>
<PRE>   error F2616: YIELDQQ : illegal use of function or subroutine

</PRE><h2>CAUSE</h2>
 
<P>
Compiling QuickWin programs with /MWn (n not equal to 0) causes the
compiler to insert calls to a function YIELDQQ() in different locations
throughout the code depending on the value of n. The compiler sees these
calls to the YIELDQQ function, and thereafter considers the YIELDQQ symbol
to be a reference to a function instead of a subroutine. This is despite
the INTERFACE statement in the file FLIB.FI describing YIELDQQ as a
subroutine. The compiler subsequently reports this perceived inconsistency
with the F2616 error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The easiest solution is to compile with /MW0 to suppress all compiler
generated calls to the YIELDQQ function. Alternatively, all calls to the
subroutine YIELDQQ within the code may be removed or modified to call
YIELDQQ as a function instead of a subroutine. In this case, if the
compiler option /MWn is used (n greater than zero), the INTERFACE statement
in FLIB.FI must be modified to declare YIELDQQ as a function instead of a
subroutine if an explicit function call to YIELDQQ is made before the
compiler inserts a YIELDQQ function call.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft FORTRAN version
5.1.
<P>
This is not an issue in FORTRAN PowerStation because the /MW option is not
supported.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code 1</h3>
 
<P>
c The most common example of a situation that exhibits this F2616 error
c is using the /MW option (which is the same as /MW1) to compile code
c containing a call to YIELDQQ within a DO-loop:
<P>
<PRE>      include 'flib.fi'
      include 'flib.fd'

      do i=1, 10
        call yieldqq
      end do
      end

</PRE><h3>Sample Code 2</h3>
 
<P>
c The following code will not generate the F2616 error if compiled with
c /MW:
<P>
<PRE>      include 'flib.fi'
      include 'flib.fd'

      integer*2 dummy, yieldqq

      do i=1, 10
        dummy = yieldqq()
      end do
      end

</PRE>If a reference to YIELDQQ is made prior to the DO-loop then the F2616
error will again be generated.  To avoid this problem modify the
following entry in FLIB.FI:
<P>
<PRE>       INTERFACE TO SUBROUTINE YIELDQQ()
       END

</PRE>To:
<P>
<PRE>       INTERFACE TO INTEGER*2 FUNCTION YIELDQQ()
       END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10<BR>
KBCategory: kbtool kberrmsg kbbuglist<BR>
KBSubcategory: FLIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
