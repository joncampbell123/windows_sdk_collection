

<HTML>
<HEAD>
<TITLE>Accessing Mixed-Language, External Variables in FORTRAN </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q60076 ">
<META NAME="KBModify" CONTENT="1995/07/17">
<META NAME="KBCreate" CONTENT="1990/03/28">
<META NAME="Keywords" CONTENT="kbprg kbinterop kbcode">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  The following is a sample C and FORTRAN mixed-language program demonstrating how to access external variables from within Microsoft FORTRAN.  FORTRAN Code        SUBROUTINE ASSIGN       INTEGER*2 X [EXTERN, ALIAS:'_extrn']        X = 2       END  C...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAH4,QAGI,QBFY,QAWM,QARM,QDMW,QBE7,QBE6,QA7H,QA4Q,QA3P,QA2P,QAY2,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Accessing Mixed-Language, External Variables in FORTRAN</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q60076 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, versions 4.1, 5.0 and 5.1
<LI>Microsoft FORTRAN for OS/2, versions 4.1, 5.0, and 5.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following is a sample C and FORTRAN mixed-language program
demonstrating how to access external variables from within Microsoft
FORTRAN.
<P>
<P><h3>FORTRAN Code</h3>
 
<P>
<PRE>      SUBROUTINE ASSIGN
      INTEGER*2 X [EXTERN, ALIAS:'_extrn']

      X = 2
      END

</PRE><h3>C Code</h3>
 
<P>
<PRE>#include &lt;stdio.h&gt;

</PRE>extern void fortran assign(void);
<PRE>int extrn;

</PRE>main()
{
<PRE>    extrn = 5;
    printf("Before call to FORTRAN:  %d\n",extrn);
    assign();
    printf(" After call to FORTRAN:  %d\n",extrn);
</PRE>}
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use global variables exported from another language in FORTRAN, the
EXTERN attribute must be used. EXTERN tells the FORTRAN compiler that
the variable is not local to the FORTRAN subroutine or function.
Variables declared EXTERN will instead be resolved by the linker. You
can use the ALIAS attribute to assign a different name to the imported
variable; in this example, it is required because the underscore
prepended by the C compiler is invalid in the FORTRAN naming
convention.
<P>
No modifications should be necessary for the exporting module to allow
FORTRAN to import the global variable(s).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf  4.10 5.00 5.10<BR>
KBCategory: kbprg kbinterop kbcode<BR>
KBSubcategory: FORTLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
