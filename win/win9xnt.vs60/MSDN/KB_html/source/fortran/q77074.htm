

<HTML>
<HEAD>
<TITLE>Appnote Text: FORTRAN 5.1 Setup Program in Batch Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77074 ">
<META NAME="KBModify" CONTENT="1996/02/16">
<META NAME="KBCreate" CONTENT="1991/10/07">
<META NAME="Keywords" CONTENT="kbsetup kbappnote kbfile">
<META NAME="KBArea" CONTENT="Support; KB; fortran">
<META NAME="Description" CONTENT="  An application note is available that consists of the FORTRAN version 5.1 Setup program in batch files. These batch files provide an alternative to the Setup program shipped with FORTRAN 5.1, for customers having problems installing.  To obtain the...">
<META NAME="Product" CONTENT="Fortran">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QBHQ,QBFY,QAFI,QA9N,QAH4,QASB,QBDM,QAJH,QAUJ,QAC9,QBXB,QATJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Appnote Text: FORTRAN 5.1 Setup Program in Batch Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77074 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft FORTRAN for MS-DOS, version 5.1
<LI>Microsoft FORTRAN for OS/2, version 5.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
An application note is available that consists of the FORTRAN version
5.1 Setup program in batch files. These batch files provide an
alternative to the Setup program shipped with FORTRAN 5.1, for
customers having problems installing.
<P>
To obtain the application note, "FORTRAN 5.1 Setup Program in Batch
Files," call Microsoft Product Support Services.
<P>
This application note is also available in the Microsoft Software Library.
Download HF0483.EXE, a self-extracting file, from the Microsoft
Software Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/hf0483.exe">HF0483.EXE</A> <I>(size: 56264 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \softlib\mslfiles directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/hf0483.exe">HF0483.EXE</A> <I>(size: 56264 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The following is the full text of the application note:
<P>
 
<PRE>   Microsoft Product Support Services Application Note (Text File)
           HF0483: FORTRAN 5.1 SETUP PROGRAM IN BATCH FILES
</PRE> 
<PRE>                                                  Revision Date: 10/91
                                                         Disk Included

</PRE>The following information applies to Microsoft FORTRAN version 5.1.
<P>
 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an            |
| Application Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY      |
| KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO    |
| THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A     |
| PARTICULAR PURPOSE. The user assumes the entire risk as to the     |
| accuracy and the use of this Application Note. This Application    |
| Note may be copied and distributed subject to the following        |
| conditions: 1) All text must be copied without modification and    |
| all pages must be included; 2) If software is included, all files  |
| on the disk(s) must be copied without modification [the MS-DOS(R)  |
| utility DISKCOPY is appropriate for this purpose]; 3) All          |
| components of this Application Note must be distributed together;  |
| and 4) This Application Note may not be distributed for profit.    |
|                                                                    |
| Copyright 1991 Microsoft Corporation. All Rights Reserved.         |
| Microsoft, MS-DOS, and the Microsoft logo are registered           |
| trademarks and Windows is a trademark of Microsoft Corporation.    |
 --------------------------------------------------------------------

</PRE>This application note contains information about the Microsoft FORTRAN
5.1 Setup batch program and combined library building utility. The
disk included with this application note contains the following files:
<P>
<PRE>   Filename      Description
   --------      -----------

   BUILDLIB.BAT  DOS program to build libraries
   BUILDLIB.CMD  OS/2 program to build libraries
   SETUP.BAT     DOS Setup program used to install FORTRAN
   SETUP.CMD     OS/2 Setup program used to install FORTRAN
   SETUP1.BAT    First DOS setup batch file called by Setup
   SETUP1.CMD    First OS/2 setup command file called by Setup
   SETUP2.BAT    Second DOS setup batch file called by Setup
   SETUP2.CMD    Second OS/2 setup command file called by Setup


              MICROSOFT FORTRAN 5.1 BATCH SETUP UTILITY
              =========================================

</PRE>The SETUP.BAT batch file copies the files from the Microsoft FORTRAN
5.1 distribution disks to your hard drive.
<P>
To use the batch file, insert the enclosed HF0483 disk in your floppy
disk drive and type "setup" (without the quotation marks) at the
command prompt using the syntax described in the "Usage Syntax"
section below. Setup must be run from the floppy disk drive from which
you intend to install FORTRAN (for example, you cannot run Setup from
drive A and put the FORTRAN disks in drive B).
<P>
<PRE>  NOTE: Do not execute the files SETUP1.BAT or SETUP2.BAT; they
  are companion files that are called from SETUP.BAT.

</PRE>Setup modifies your PATH environment variable while it executes. If
you break out of the batch file, you must reset your PATH. If Setup
completes normally, your PATH will be reset automatically.
<P>
Depending on the option you select, the files copied by Setup will
require the following amount of disk space:
<P>
<PRE>   9.2 MB (megabyte) if all files are copied
   6.1 MB if only DOS files are copied
   6.5 MB if only OS/2 files are copied
   7.1 MB if only DOS and Windows files are copied

</PRE>If you intend to build combined libraries, you will need an additional
300K of disk space for each library you build.
<P>
<P>
<P><h2>USAGE SYNTAX</h2>
 
<P>
<PRE>   setup &lt;TARGET_SYSTEM&gt; &lt;drive_letter&gt; [&lt;directory_path&gt;]

</PRE>You must specify the type of system you are installing for and a drive
letter for Setup to use. The options for the target system are D for
DOS, O for OS/2, W for DOS and Windows, and A for all files.
<P>
<PRE>  NOTE: The target system letter must be an uppercase letter.

</PRE>You also have the option of specifying a base directory path for Setup
to use. Setup will copy files into sub-directories with the default
names recommended by the regular Setup program (such as \BINB, \LIB,
and so on).
<P>
The optional directory path should be specified with the following
syntax:
<P>
<PRE>   &lt;top_level_directory&gt; &lt;next_level_directory&gt; &lt;next_level_directory&gt;

</PRE>Note that only three levels are supported and that there are spaces,
NOT backslash ( \) characters, separating the directory names.
<P>
<P><h3>Examples</h3>
 
<P>
<PRE>   Command                       Result
   -------                       ------

   setup D c fortran             Copies files for a DOS system onto
                                 the hard drive C in a directory
                                 called FORTRAN with subdirectories
                                 C:\FORTRAN\BINB, C:\FORTRAN\LIB, and
                                 so on

   setup A e                     Copies all files onto the hard drive
                                 E in subdirectories E:\BINB, E:\LIB,
                                 and so on

   setup W d mslang fortran f510 Copies files for a DOS and Windows
                                 system onto the hard drive D in a
                                 directory called MSLANG\FORTRAN\F510
                                 with subdirectories
                                 D:\MSLANG\FORTRAN\F510\BINB,
                                 D:\MSLANG\FORTRAN\F510\LIB, and so on


</PRE><h2>AFTER YOU RUN SETUP</h2>
 
<P>
After you run Setup, you must change your AUTOEXEC.BAT file and
CONFIG.SYS file so that FORTRAN will run correctly. Please refer to
pages 21-23 of the "Microsoft FORTRAN Installing and Using the
Professional Development System" guide for information on the required
changes.
<P>
For example, if you install the FORTRAN files on drive C in a
directory named FORTRAN, you should make the following changes to your
AUTOEXEC.BAT file:
<P>
<PRE>   SET PATH=C:\FORTRAN\BINB;C:\FORTRAN\BIN;...&lt;existing PATH&gt;
   SET LIB=C:\FORTRAN\LIB
   SET TMP=C:\FORTRAN\BINB
   SET INIT=C:\FORTRAN\INIT
   SET INCLUDE=C:\FORTRAN\INCLUDE
   SET HELPFILES=C:\FORTRAN\HELP\*.HLP

</PRE>Setup copies the files HIMEM.SYS, RAMDRIVE.SYS, and SMARTDRV.SYS to
the directory specified for DOS executable files.
<P>
HIMEM.SYS allows you to debug programs that approach 640K in size by
using extended memory on machines with 286, 386, or 486 CPUs.
<P>
To avoid possible conflicts, use RAMDRIVE.SYS for memory disk
emulation and SMARTDRV.SYS for disk caching. Other disk emulation and
disk caching programs may conflict with HIMEM.SYS.
<P>
A more detailed explanation of these three device drivers and memory
configuration (expanded versus extended) is located in Chapter 2 of
the "Microsoft FORTRAN Installing and Using the Professional
Development System" guide on pages 24-25.
<P>
<P>
<PRE>       MICROSOFT FORTRAN 5.1 COMBINED LIBRARY BUILDING UTILITY
       =======================================================

</PRE>The BUILDLIB.BAT batch file builds combined libraries for Microsoft
FORTRAN 5.1.
<P>
This file should be run from the \LIB subdirectory for FORTRAN 5.1.
The Setup batch program copies BUILDLIB.BAT to this directory.
<P>
The following assumptions are made:

<OL><P><LI>You have the directory that contains LIB.EXE version 3.18 or later
   in your PATH environment variable.

<P><LI>You used the Setup batch program to copy the required component
   libraries to the \LIB\COMP subdirectory, or you manually copied the
   required components to the \LIB\COMP subdirectory.
<P>
<P>
</OL><h2>USAGE SYNTAX</h2>
 
<P>
<PRE>   buildlib &lt;library_name&gt;

</PRE></OL>Where the library name is of the form:
<P>
<PRE>   mLIBFfsc

</PRE>The letters m, f, s, and c are placeholders for the following values:
<P>
<PRE>   Placeholder  Meaning                      Values
   -----------  -------                      ------

   m            Memory model                 M (medium)
                                             L (large)

   f            Floating-point math library  A (alternate math)
                                             E (emulator)
                                             7 (8087/287/387)

   s            Operating system             R (DOS real mode)
                                             P (OS/2 protected mode)

   c            C compatibility              C (C-compatible library)
                                             [blank] (non-C-compatible
                                               library)

</PRE>This information is similar to the information on pages 19 and 20 of
the "Microsoft FORTRAN Installing and Using the Professional
Development System" guide.
<P>
<PRE>   NOTE: If you build a library with C compatibility, routines that
   are common between the two languages are LEFT OUT of the FORTRAN
   library. This means that you must always link your program with
   both the FORTRAN library and its C counterpart.

</PRE><h3>Library Name Examples</h3>
 
<P>
<PRE>   Name      Meaning
   ----      -------

   LLIBF7R   Large model, coprocessor math library for DOS
   LLIBFER   Large model, emulation math library for DOS
   LLIBFERC  C compatible, large model, emulation math library for DOS
   MLIBF7P   Medium model, coprocessor math library for OS/2

</PRE>(The .LIB extension is assumed for library names and should NOT be
included when running BUILDLIB.BAT.)
<P>
If you are installing for DOS and are unsure what options to choose,
we recommend that you build the LLIBFER library if you do not have a
coprocessor on your machine, or the LLIBF7R library if you do have a
coprocessor.
<P>
<P>
<P><h2>IMPORTANT: RENAMING LIBRARIES</h2>
 
<P>
The FORTRAN compiler uses a default naming convention different from
the BUILDLIB.BAT batch file and the standard Setup program. The
convention is
<P>
<PRE>   mLIBFORf

</PRE>where m and f have the same values as above. The naming convention
does not reflect the operating system the library was created for or
tell whether it is compatible with C. If you install for only one
operating system, and without C compatibility, we recommend that after
you use BUILDLIB.BAT to build a library, you rename the library using
the mLIBFORf convention. For example: LLIBFER.LIB would be renamed
LLIBFORE.LIB.
<P>
You can find more information on library naming conventions and
related compiler options on pages 322-326 in Chapter 7 of the
"Microsoft FORTRAN Reference" manual.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 5.10 softlib appnote HF0483.EXE bernoulli<BR>
KBCategory: kbsetup kbappnote kbfile<BR>
KBSubcategory: f51setup<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
