

<HTML>
<HEAD>
<TITLE>SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135926">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/08/29">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  The File Format Application Programming Interface (FFAPI) access component SMTPPUT.EXE that is provided for the SMTP gateway will return the following 201 error code when the program is unable to successfully deliver a message to a postoffice:     ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAVZ,QBW5,QBVW,QAAP,QAI5,QBW7,QAH4,QAKP,QAEV,QAB4,QAKC,QAHT,QBC6,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135926</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MS-DOS
kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail Gateway to SMTP, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The File Format Application Programming Interface (FFAPI) access component
SMTPPUT.EXE that is provided for the SMTP gateway will return the following
201 error code when the program is unable to successfully deliver a message
to a postoffice:
<P>
<PRE>   SMTPPUT returned 201
   201 - 1 - 140 - Failure submitting message to mail database

   [tx] 552 Error in local delivery

</PRE><h2>CAUSE</h2>
 
<P>
The 201 error code is generated by the FFAPI access component SMTPPUT.EXE.
The error is returned to the gateway when SMTPPUT.EXE is unable to insert
the message into the postoffice database.
<P>
The 201 error code is caused by the following conditions:

<UL><LI>Network file contention.

<LI>Insufficient disk space.

<LI>Postoffice directory structure incomplete or corrupt.

<LI>Insufficient access rights granted to gateway machine.

<LI>Insufficient file handles.

<LI>Network problems accessing the postoffice files.

<LI>Alias address in SMTP gateway larger than 10 characters for
   version 3.0.8.

<LI>Corrupt or incorrect format of the Microsoft Mail File Format(MMFF)
   file.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
<P><h3>Network File Contention</h3>
 
<P>
SMTPPUT.EXE component must access certain files to create a message on a
postoffice. Gateways that service postoffices that receive high volumes of
message transfers and are serviced by the External Mail program should
consider disabling mailer (-md).
<P>
The files accessed by SMTPPUT.EXE with mailer disabled are ACCESS.GLB,
ACCESS2.GLB, MASTER.GLB, C850SORT.GLB, GROUP.GLB, NETWORK.GLB, CONTROL.GLB,
INQUEUE3.KEY, and INQUEUE3.MBG. These files may be locked by other
processes temporarily while in use.
<P>
NOTE: The 201 error has been reproduced by locking the INQUEUE3.MBG file.
<P>
Postoffices located on Novell servers that operate under high-traffic
conditions are recommended to set the postoffice as shareable with a few
exceptions. There are certain conditions that dictate that the CONTROL.GLB,
TID.GLB, FLAG.GLB, and MASTER.GLB should only be accessed by one process at
a time; thus, they should not be shareable.
<P>
For additional information, please see the Microsoft Mail Gateway to SMTP
"Administrator's Guide" and/or the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q99204.htm">Q99204</A></B>
   TITLE     : Doc Err: Setting Attributes for High Traffic Network

</PRE>The most common problem is the INQUEUE3.MBG is being locked by another
external or gateway. This problem can be compounded if the other external
or gateway is operating on a slow machine or over a slow link. The option
-v20 or CompatV20 utilized by the External Mail program will add additional
file locking functionality, increasing the amount of network overhead and
possibly causing additional network file contention. Additional network
file contention can be created by improperly running the External Mail
program from a network drive (see page 233 of the "Administrator's Guide").
<P>
<P><h3>Insufficient Disk Space</h3>
 
<P>
Insufficient disk space will prevent the client from enlarging or creating
postoffice files. Novell NetWare file servers can produce a insufficient
disk space response to the program when the files have become ownerless or
the purge file has used all the available disk space.
<P>
<P><h3>Postoffice Directory Structure</h3>
 
<P>
The postoffice directory structure consists of 19 main subdirectories.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q77926.htm">Q77926</A></B>
   TITLE     : Description of Mail Database Subdirectories

</PRE><h3>Insufficient Access Rights</h3>
 
<P>
The gateway components should be given full network access rights for the
postoffice.
<P>
For additional information, please see the Microsoft Mail Gateway to SMTP
"Administrator's Guide" and/or the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q103380.htm">Q103380</A></B>
   TITLE     : File Scan Rights Required for Novell NetWare

   ARTICLE-ID: <B><A href="../pcmail/q117152.htm">Q117152</A></B>
   TITLE     : MTA Not Report LAN Man User-Level Security Problems

   ARTICLE-ID: 121798
   TITLE     : Err Msg: You Do Not Have the Proper Access...

</PRE><h3>Insufficient File Handles</h3>
 
<P>
Increase the number of file handles to 50 in the CONFIG.SYS file of the
workstation running the gateway.
<P>
<P><h3>Network Problems</h3>
 
<P>
The SMTPPUT.EXE utilizes the network components to effectively perform the
file commands that create and manipulate each file. Network problems that
interfere with the operation of these commands can cause the 201 error to
occur.
<P>
<P><h3>SMTP Alias Address Larger Than 10 Characters</h3>
 
<P>
The SMTP gateway version 3.0.9 resolves an issue that can cause a 201 error
to be logged. The README.TXT file included with version 3.0.9 of the SMTP
gateway discusses the problem when an alias name is larger than 10
character.
<P>
<P><h3>MMFF file problems</h3>
 
<P>
Ensure that the MMFF file TO_NC.API submitted by the gateway follows either
the Basic or Extended Message Format for the SMTPPUT.EXE program to
properly convert (definition begins on page 50 in the FFAPI SDK).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The error displayed may consist of three numbers separated by a hyphen (-);
for example,
<P>
<PRE>   (201 - 1 - 140).

</PRE>The error code number 201 signifies that the error occurred when you tried
to insert the message into the database. The second number, 1, can signify
the number of messages sent per socket connection. It will rarely exceed 2.
The last number refers to the line number of the message indicated by the
second number. It is only valid if the problem was created by a corrupted
or incorrectly formatted MMFF file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kb3rdparty<BR>
KBSubcategory: MailGWSMTP<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
