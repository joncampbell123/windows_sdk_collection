

<HTML>
<HEAD>
<TITLE>PC Adm: How to Strand Attachment if It's too Large for System </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124487">
<META NAME="KBModify" CONTENT="1996/03/27">
<META NAME="KBCreate" CONTENT="1995/01/03">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Sometimes a user will try to send a very large mail message (or a message with a large attachment) from Microsoft Mail for Windows. This can cause some network servers to run out of disk space or it can drastically slow network performance.  MORE I...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAEV,QAGU,QAY2,QBQU,QA5T,QAFI,QBVV,QDL9,QBWQ,QBWO,QBWN,QBV0,QAKC,QBDM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Adm: How to Strand Attachment if It's too Large for System</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124487</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for Windows, versions 3.2 and 3.2a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes a user will try to send a very large mail message (or a message
with a large attachment) from Microsoft Mail for Windows. This can cause
some network servers to run out of disk space or it can drastically slow
network performance.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Only one copy of the message and attachment is kept on the postoffice (in
the MAILDATA directory). When a message is sent to a user, a record goes
into that user's mailbag (.MBG) file. The .MBG file in turn points to the
message (.MAI) file on the postoffice. If there is an attachment, it is
contained in an .ATT file, and the .MAI file contains a pointer that points
to the .ATT file. Once the user reads his or her mail from the Windows
client, all the messages and attachments get moved from the user's .MBG
file into his or her personal Mail message file (.MMF).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If any users have not yet read mail containing the large attachment, a Mail
administrator can prevent those users from reading the message by
"stranding" the .ATT file on the postoffice. This procedure will remove the
pointer to the .ATT file, so that Mail will not be able to download it to
those users' .MMF files.
<P>
To prevent the mail message or attachment from interfering with any users
who have not yet viewed the message from Microsoft Mail for Windows:

<OL><P><LI>Find a user who has not viewed this message in Microsoft Mail for
   Windows.

<P><LI>Log in as that user from the MS-DOS workstation.
<P>
   Make a note of the message text that is listed under the subject of the
   mail message with the large attachment.

<P><LI>Use the LISTUSER.EXE utility (available in Application Note WA0641) to
   get the hexadecimal ID (hexid) number of that user's .MBG file.

<P><LI>Use DEBUG.EXE on the .MBG file and look for the message text from the
   subject line noted in step 2. From the C:\MAILDATA\MBG directory, type
   the following:
<P>
<P><PRE>      debug 00000003.mbg
</PRE><P>
   This command will return a hyphen (-) sign. Type the following and then
   press ENTER.
<P>
<P><PRE>      d
</PRE><P>
   Keep typing "d" until you see the message text. After the message text
   you will see an eight-digit hexadecimal number. This is the number of
   the .MAI file that points to the .ATT file. Type the following to exit
   DEBUG, and then press ENTER:
<P>
<P><PRE>     q
</PRE>
<P><LI>Go to the MAILDATA\MAI subdirectory. There are 16 subdirectories in the
   MAILDATA\MAI directory. The hexadecimal number you obtained in step 4
   corresponds to a &lt;hexid&gt;.MAI file in one of the 16 subdirectories. For
   example, If the hexid number is 00000017, look in the MA7 subdirectory
   for 00000017.MAI. You can use Windows File Manager to search the MA*
   subdirectories for the location of the 00000017.MAI file.

<P><LI>Rename the 00000017.MAI file to some other name, such as BADMSG.OLD.

<P><LI>Have the user log in to the Windows client. From the View menu, choose
   New Messages. Double-click the message. The message will display the
   following error:
<P>
<P><PRE>      ==== MAIL SYSTEM ERROR ====
      Mail could not read the entire message from the postoffice.
      Some parts of the message may be missing.  Ask the sender
      to resend the message.
</PRE><P>
   This error is expected. Anyone who has not yet read the offending
   message will receive this error, which means that the large attachment
   will no longer be circulating around the system.
<P>
</OL>NOTE: You can use the External Mail program MaxLanMailSize option to
restrict the sizes of messages users can send to an external postoffice on
the same LAN. For more information about how to use the MaxLanMailSize
option, please see page 252 of the Microsoft Mail "Administrator's Guide."
<P>
LISTUSER.EXE is available to Mail administrators as part of Application
Note WA0641, "Database Maintenance Utilities."
<P>
You can obtain this Application Note by contacting Microsoft Product
Support Services.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.20 attachment orphan large<BR>
KBCategory:kbenv<BR>
KBSubcategory: MailPCAdm<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
