

<HTML>
<HEAD>
<TITLE>PC DirSync: Microsoft Mail SRVMAIN.EXE Version 3.2.14 Update </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111703">
<META NAME="KBModify" CONTENT="1996/07/20">
<META NAME="KBCreate" CONTENT="1994/02/15">
<META NAME="Keywords" CONTENT="kbtool kbinterop kbfile kbtlc kbbug3.20 kbfix3.20a kbbug3.20a kbfix3.5">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Microsoft provides a replacement for the SRVMAIN.EXE file that is included with versions 3.2 and 3.2a of Microsoft Mail for PC Networks.  For complete information about obtaining and installing the SRVMAIN.EXE file, see the following sections:   - ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAC1,QBD2,QAFI,QBXB,QATJ,QAVZ,QANE,QAA5,QBWS,QAVX,QAVW,QAYC,QA9N,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC DirSync: Microsoft Mail SRVMAIN.EXE Version 3.2.14 Update</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 20, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111703</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.2 and 3.2a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft provides a replacement for the SRVMAIN.EXE file that is included
with versions 3.2 and 3.2a of Microsoft Mail for PC Networks.
<P>
For complete information about obtaining and installing the SRVMAIN.EXE
file, see the following sections:

<UL><LI>To download the updated file
<LI>To update your SRVMAIN.EXE file
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
IMPORTANT: When you update to SRVMAIN.EXE version 3.2.14, you need
to update ADMIN.EXE to version 3.2.13 or later (update included in
ADMUPD.EXE on the MSL) and LISTDS.EXE version 3.2.1 (included with this
update). You MUST also run SCONFIX.EXE (included with this update)
once. This is required for all users updating to SRVMAIN.EXE
version 3.2.14.
<P>
This replacement file includes the following modifications for version 3.2
of Microsoft Mail for PC Networks:

<UL><LI>The Import utility no longer stops responding (hangs) when it
   processes RESYNC.GLB after doing heavy processing. This problem
   occurred because the heap became corrupted when it was under a
   heavy load.
<P>
   NOTE: To resolve this problem, two .EXE files must be updated: the
   SRVMAIN.EXE file (included in this update) and the IMPORT.EXE file
   (update included in IMPUPD.EXE on the MSL).

<LI>The SRVMAIN utility no longer does one-byte reads of the template
   files.

<LI>A Microsoft Mail Connection 3.2 PROXYNET\PROXYPO postoffice address
   list is now propagated to a downstream requestor postoffice when
   the gateway postoffice is also the directory server postoffice. The
   Import utility now copies FFAPI postoffice address lists from the
   directory server to the GLB\RESYNC.GLB file to perform a directory
   synchronization manual import procedure.
<P>
   NOTE: To resolve this problem, two .EXE files must be updated: the
   SRVMAIN.EXE file (included with this update) and the IMPORT.EXE file
   (update included in IMPUPD.EXE on the MSL).
<P>
</UL>This replacement file also includes the following modifications for version
3.2a:

<UL><LI>The directory synchronization (Dir-Sync) server now continues to
   process updates when SRVMAIN.EXE encounters duplicate entries in the
   system mailbag. Previously, under these conditions SRVMAIN.EXE would
   quit without processing any additional updates in the system mailbag,
   and the following entries would be added to the DIRSYNC.LOG file:
<P>
<P><PRE>      Error [115] Failure to read mail from NULL
</PRE><P>
<P><PRE>      Warning [8] Error deleting file: &lt;Network&gt;/&lt;Postoffice&gt;/$SYSTEM.
</PRE>
<LI>Dir-Sync will no longer give error
<P>
<P><PRE>      Error 156 Invalid Dirsync password from PCM:Network/Postoffice
</PRE><P>
   during the T2 cycle. Previously, even if the password for the
   Requestor postoffice was correct, the password of a requestor
   postoffice would be incorrectly compared against other requestor
   postoffices listed in the SRVCONF.GLB. Specifically, this occurred when
   postoffices were registered in a particular order, and the postoffice
   names were similar to or part of other requestor postoffice names.

<LI>If the DSSERVER.LOG on a requestor postoffice is corrupt for some
   reason, the SRVMAIN -r process during Dir-Sync will no longer cause
   a Trap D.

<LI>When the Admin account mailbox is greater than eight characters in
   length, the Keep Updates number will no longer change when you change
   the Administrator's name in Config, DirSync, Server, Options.
<P>
   IMPORTANT: This fix is specifically for users who have an
   Administrator's mailbox name greater than eight characters, and who
   want to receive Dir-Sync status messages.
<P>
   To add the new Administrator's name, you need ADMIN.EXE version 3.2.13
   or later. Run Admin, DirSync, Server, Options. Type in the desired
   mailbox name. If necessary, re-enter the Keep Updates field. This
   modified SRVMAIN requires a new LISTDS.EXE version 3.2.1 or later for
   checking the SRVCONF.GLB file.

<LI>If X.400 addresses are included in the very first Dir-Sync cycle,
   Dir-Sync will no longer fail with a protection violation during the T2
   cycle of the SRVMAIN process.
<P>
</UL><h3>To download the updated file</h3>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/srvupd.exe">SRVUPD.EXE</A> <I>(size: 118556 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/srvupd.exe">SRVUPD.EXE</A> <I>(size: 118556 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/srvupd.exe">SRVUPD.EXE</A> <I>(size: 118556 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location.
      Type "mssupport" (without the quotation marks).
      Double-click the MS Software Library icon.
      Find the appropriate product area.
      Locate and Download SRVUPD.EXE.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/srvupd.exe">SRVUPD.EXE</A> <I>(size: 118556 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>After you download SRVUPD.EXE to a clean directory, run it (by typing
"srvupd" at the MS-DOS command prompt) to extract the contents of the
file. You should receive the following files:
<P>
<PRE>   SRVMAIN.EXE (163,941 bytes, dated 02-07-95, 11:33 A.M.)
   SCONFIX.EXE (  6,887 bytes, dated 01-13-95,  2:48 P.M.)
   LISTDS.EXE  ( 22,495 bytes, dated 01-23-95,  4:35 P.M.)
   README.TXT

</PRE><h3>To replace your SRVMAIN.EXE file</h3>
 

<OL><P><LI>At the MS-DOS command prompt, type the following and press ENTER after
   each line
<P>
<P><PRE>      copy &lt;path&gt;\srvmain.exe &lt;destination&gt;
</PRE><P>
<P><PRE>      copy &lt;path&gt;\listds.exe &lt;destination&gt;
</PRE><P>
   where &lt;path&gt; is the drive and directory where you ran the self-
   extracting SRVUPD.EXE file and &lt;destination&gt; is the drive and
   directory where your SRVMAIN.EXE and LISTDS.EXE (originally
   obtained from the Dir-Sync Application Note WA0725) files currently
   reside. For example, if you ran the self-extracting file from the
   TEST directory on drive D, and your SRVMAIN.EXE and LISTDS.EXE files
   are located in the MAILEXE directory on drive C, type the following
   commands:
<P>
<P><PRE>      copy d:\test\srvmain.exe c:\mailexe
</PRE><P>
<P><PRE>      copy d:\test\listds.exe c:\mailexe
</PRE><P>
   Notes:
   ------
<P>
   - The SRVMAIN.EXE file typically resides on the postoffice
<P><PRE>     server in the Mail executables directory as well as on the machine
     running the Dispatch program and the directory synchronization
     agents. Make sure you update all copies of the SRVMAIN.EXE file.
</PRE><P>
   - Once you update to version 3.2.13 or later of SRVMAIN
<P><PRE>     and ADMIN, use this LISTDS for viewing the SRVCONF.GLB.
</PRE>
<P><LI>At the MS-DOS command prompt, type the following and press ENTER
<P>
<P><PRE>      copy &lt;path&gt;\sconfix.exe &lt;destination&gt;
</PRE><P>
   where &lt;path&gt; is the drive and directory where you ran the self-
   extracting SRVUPD.EXE file and &lt;destination&gt; is the drive and
   directory where your Mail executable files currently reside. For
   example, if you ran the self-extracting file from the TEST directory
   on drive D, and your Mail executable files are located in the MAILEXE
   directory on drive C, type the following command:
<P>
<P><PRE>      copy d:\test\sconfix.exe c:\mailexe
</PRE>
<P><LI>Run the SCONFIX utility from the Mail executables directory
   by running
<P>
<P><PRE>      sconfix -d&lt;drive&gt;
</PRE><P>
   where &lt;drive&gt; is the drive mapped to the Dir-Sync server postoffice
   database.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20 dirsynch<BR>
KBCategory: kbtool kbinterop kbfile kbtlc kbbug3.20 kbfix3.20a kbfix3.50<BR>
KBSubCategory: MailPCDirSync<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 20, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
