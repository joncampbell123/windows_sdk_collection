

<HTML>
<HEAD>
<TITLE>PC NTMMTA: Cannot Run as an Automatic Service w/ Banyan Vines </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135032">
<META NAME="KBModify" CONTENT="1995/10/24">
<META NAME="KBCreate" CONTENT="1995/08/15">
<META NAME="Keywords" CONTENT="kb3rdparty kbnetwork kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you run the Microsoft Windows NT Multitasking MTA (NT MMTA) as a service set to Start up automatically, mail is not delivered. This may occur when the postoffices are located on a Banyan Vines server.  CAUSE =====  The NT MMTA cannot be set up...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QBWP,QA5J,QA5I,QBWB,QAVZ,QAUJ,QAI5,QAH6,QAM5,QAA1,QBV8,QAIF,QAB9,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC NTMMTA: Cannot Run as an Automatic Service w/ Banyan Vines</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135032</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail Multitasking MTA for Windows NT, version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Microsoft Windows NT Multitasking MTA (NT MMTA) as a
service set to Start up automatically, mail is not delivered. This may
occur when the postoffices are located on a Banyan Vines server.
<P>
<P><h2>CAUSE</h2>
 
<P>
The NT MMTA cannot be set up as an automatic service when you use Banyan
Vines Windows NT drivers due to the inability to make Universal Naming
Convention (UNC) connections outside of a Banyan Vines login session.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Run the NT MMTA from the CMD prompt.
<P>
Call Banyan Vines with any further questions on their redirector.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For each additional type of network (Novell NetWare, Banyan Vines, etc.), a
provider must be installed. The provider is the component that allows a
Windows NT computer to communicate with the network.
<P>
From the application's viewpoint, there are two sets of commands that can
cause network traffic UNC commands and WNet (part of the Win32 API)
commands.
<P>
Although, it is enough to specify the servername to list a server's shared
resources, a full UNC name is in the following form:
<P>
<PRE>   \\server\share\subdirectory\filename

</PRE>WNet is specifically designed to allow applications on Windows NT
workstations to connect to multiple networks, browse the resources of
computers on those networks, and transfer data between computers of various
networks. For example, File Manager uses the WNet interface to provide its
network browsing and connection facilities.
<P>
The provider layer spans between kernel and user modes to manage commands
that may cause network traffic. The provider layer also includes two
components to route UNC and WNet requests to the appropriate provider:

<UL><LI>The Multiple UNC Provider (MUP) receives UNC commands and locates the
   redirector that can make a connection to the UNC name.

<LI>The Multiple Provider Router (MPR) receives WNet commands and passes
   the request to each redirector in turn until one is found that can
   satisfy the request.
<P>
</UL>NOTE: I/O calls, such as Open, can contain both a UNC name and WNet calls.
<P>
<P><h3>Multiple UNC Provider</h3>
 
<P>
The MUP is a kernel-mode component that locates UNC names. When an
application sends a command containing UNC names, MUP routes each UNC name
to one of the registered UNC providers, including LanmanWorkstation and any
others that may be installed. When a provider indicates that it can
communicate with the server, MUP sends the remainder of the command to the
provider.
<P>
When applications make I/O calls that contain UNC names, the MUP directs
them to the appropriate redirector file system driver. The call is routed
to its redirector based on the handle on the I/O call.
<P>
<P><h3>Multiple Provider Router</h3>
 
<P>
Through the MPR, Windows NT provides an open interface that enables
consistent access to third-party network file systems. The key to the MPR
is that all file systems, regardless of type and physical location, are
accessible through the same set of file system APIs.
<P>
Applications, including File Manager, make file system requests through the
Windows NT Win32 API. The MPR ensures that requests are directed to the
proper file system. Local file requests are sent to the local disk; remote
requests to Windows-based servers are sent to the proper server by the
Windows redirector, and requests to NetWare-based servers are handled by
the NetWare client for Windows NT and sent to the NetWare server, and so
on.
<P>
Because applications access all types of files through a single set of
APIs, any application can access any kind of server without affecting the
user.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20 3.50 redirecter logon<BR>
KBCategory: kb3rdparty kbnetwork kbtlc<BR>
KBSubcategory: MailPCNTMMTA<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
