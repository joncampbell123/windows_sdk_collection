

<HTML>
<HEAD>
<TITLE>PC WRmt: Multiple Address List Downloads Cause Corruption </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101902">
<META NAME="KBModify" CONTENT="1996/05/31">
<META NAME="KBCreate" CONTENT="1993/07/26">
<META NAME="Keywords" CONTENT="kbusage kbtlc kbbug3.20">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  If you download the postoffice address lists in Mail Remote for Windows two or more times in the same session (that is, without exiting and restarting Mail Remote), the external postoffice address lists on your hard disk may become corrupted.  You ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAC2,QAO0,QAE1,QANN,QAR5,QBWS,QAEV,QAB4,QAVZ,QBWD,QAWM,QAJ4,QDL9,QBW4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC WRmt: Multiple Address List Downloads Cause Corruption</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 31, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101902</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail Remote for Windows, version 3.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you download the postoffice address lists in Mail Remote for Windows two
or more times in the same session (that is, without exiting and restarting
Mail Remote), the external postoffice address lists on your hard disk may
become corrupted.
<P>
You can avoid this problem by only downloading the postoffice address lists
once during a Mail Remote session. If you only use Mail Remote for Windows
(and no other type of Mail) and you leave your computer running
continually, you should exit and sign out of Mail after each session
(especially if you download the address list during that session).
<P>
After the second download of the address list, when you open the Global
Address List (GAL) and request Details on an External user, the following
error message appears:
<P>
<PRE>   A GLB file on your server is corrupt. Contact your system
   administrator.

</PRE>The external postoffice's address list shows no names defined on that
postoffice. This is true for all external postoffices.
<P>
If you send a mail message to the external user by using the GAL for
addressing, no message is sent. The SESSION.LOG file reports the following
messages:
<P>
<PRE>   No mail to send
      Tsk 5, Ec -1,
      ResetModem on error!
      ReversePump on error!

</PRE>NOTE: You must add the following two lines to the [SFS Remote] section of
the workstation's MSMAIL.INI file in order to see the messages shown above.
These settings provide additional diagnostic information that is recorded
in the SESSION.LOG file.
<P>
<PRE>   Verbose=1
   Debuglog=1

</PRE>If the upload is aborted, the message is returned as undeliverable and the
following message appears:
<P>
<PRE>   A message recipient was not supplied. The recipient has been deleted
   or has no e-mail address.

</PRE>If you send mail to both a local postoffice user and an external postoffice
user, the message is only sent to the local user. However, no error message
indicating a failure to deliver to the External user is reported.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the address list is updated only once per session, the corruption does
not occur. The second download of the address list causes the address name
files (*.NME) to be renamed to a higher sequence number; however, the
Windows Remote client is still seeking the original filename. Manually
renaming the files to the correct filename does not work, because the .GLB
files relating to the GAL are also incorrect.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two ways to repair the corrupt address lists:

<UL><LI>Exit and re-enter Mail Remote for Windows and download the address lists
   again. This builds the files with the proper filenames.
<P>
   -or-

<LI>Have the Mail administrator generate a new Data disk and use this disk
   to restore the directories. To do this, choose Options from the Mail
   menu. Choose Server, then specify the disk drive containing the Data
   disk.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in version 3.2 of Microsoft
Mail Remote for Windows. This problem was corrected in MSRMTUI.DLL version
3.2.0.4001. If you do not have version 3.2.0.4001 (or later), you can
download MSRMTUI.EXE, a self-extracting file, on the following services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/msrmtui.exe">MSRMTUI.EXE</A> <I>(size: 95915 bytes)</I> 
                              , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/msrmtui.exe">MSRMTUI.EXE</A> <I>(size: 95915 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location.
      Type "mssupport" (without the quotation marks).
      Double-click the MS Software Library icon.
      Find the appropriate product area.
      Locate and Download MSRMTUI.EXE.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/msrmtui.exe">MSRMTUI.EXE</A> <I>(size: 95915 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>For more information about how to obtain this Application Note, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q103946.htm">Q103946</A></B>
   TITLE     : Mail Remote MSRMTUI.DLL Update
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20<BR>
KBCategory: kbusage kbtlc kbfile kbbug3.20<BR>
KBSubCategory: MailPCWRmt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 31, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
