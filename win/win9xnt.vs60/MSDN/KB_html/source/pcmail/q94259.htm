

<HTML>
<HEAD>
<TITLE>PC DB: Err Msg: Could Not Find Mail System Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94259 ">
<META NAME="KBModify" CONTENT="1995/10/23">
<META NAME="KBCreate" CONTENT="1992/12/31">
<META NAME="Keywords" CONTENT="kbenv kberrmsg kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When Microsoft Mail cannot find the postoffice database that stores the mail messages, one of the following error messages may be displayed:  MS-DOS clients (all versions) and Mail Administrator program version 2.1:     Could not find mail system d...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAFI,QBXB,QATJ,QAZV,QBVV,QAB4,QBV0,QDL9,QBWQ,QBWO,QBWN,QAH5,QAVZ,QBWU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC DB: Err Msg: Could Not Find Mail System Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94259 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 2.1 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When Microsoft Mail cannot find the postoffice database that stores the
mail messages, one of the following error messages may be displayed:
<P>
MS-DOS clients (all versions) and Mail Administrator program version 2.1:
<P>
<PRE>   Could not find mail system database.

</PRE>Mail Administrator program version 3.0:
<P>
<PRE>   Could not find mail system data files on drive 'M:'

</PRE>Windows client version 3.0:
<P>
<PRE>   Mail could not connect to your Mail server. The Mail server path
   in your MSMAIL.INI file is missing or invalid.

</PRE>Windows client version 2.1:
<P>
<PRE>   The mail database cannot be reached. The server that contains the
   database needs to be running, and you need to either connect to it
   on drive M: or state its location in the WIN.INI. Please see your
   network administrator if you need assistance.

</PRE><h2>CAUSE</h2>
 
<P>
The above error messages indicate that the mail program cannot read
the database files. Typically, this occurs because of one or more of
the following five reasons:

<OL><P><LI>A previously installed security feature is overriding other, more
   current settings, or the MAIL.DAT file is not in the WINDOWS\SYSTEM
   directory.

<P><LI>The mail program is looking for the files in the wrong location.

<P><LI>The drive where the mail program is looking does not exist because
   it has not been mapped or mounted.

<P><LI>The person trying to access the postoffice database does not have
   sufficient rights or privileges to the MAILDATA directories.

<P><LI>The MASTER.GLB file does not exist, is hidden, or is locked open.
<P>
</OL><h2>RESOLUTION</h2>
 
<P>
Following are resolutions for each of the five above causes:

<OL><P><LI>Check for the existence of a MAIL.DAT file on both the server and
    the workstation. If you find any occurrences, delete them or
    rename them to MAILDAT.OLD. If any MAIL.DAT files exist, they can
    override all other settings pointing to the postoffice database.
<P>
    To locate any copies of MAIL.DAT from within Windows, use File
    Manager and choose Search from the File menu.
<P>
    To locate any copies of MAIL.DAT from the MS-DOS prompt, run the
    following command from the root directory:
<P>
       attrib mail.dat /s
<P>
    NOTE: For more information on advanced security and the MAIL.DAT
    file, see the "Microsoft Mail 3.0 Administrator's Guide," pages
    14-17, and 51.
<P>
    To re-enable Advanced Security, either rerun setup for that
    workstation and select Advanced Security, or if it had been
    previously renamed (to disable AS), rename the file to MAIL.DAT
    in the WINDOWS\SYSTEM directory.
<P>
</OL>2a. Unless told otherwise, the ADMIN.EXE and MAIL.EXE programs for
<PRE>    MS-DOS assume that the current directory of drive M is the root of
    the database (..\MAILDATA). If the database resides on another
    drive, add the -Dm switch to the command line (where M is the
    alternative drive letter).

    For example, use the following command if the current directory of
    drive R is the root of the database:

       admin -dr

    Note: The current directory of the drive letter used must be the
    root of the database (for example, ..\MAILDATA).

    For example, in the list below, if the directory on the left is
    the current directory when you run a Mail program, the Mail
    program will give you the error message shown on the right:

    Current Directory        Error Message
    -----------------------------------------------------------------

    M:\APPS\MAIL             Could not find mail system database
    M:\APPS\MAIL\EXE         Could not find mail system database
    M:\APPS\MAIL\DATA\LOG    Could not find mail system database

    M:\APPS\MAIL\DATA        (Correct directory -- no error message)

    You can verify that the root of the postoffice database is in the
    current directory of the drive by changing to that drive and
    running the MS-DOS DIR command. If the Mail database is there, you
    will see directories named ATT, GLB, MBG, and so forth.

    Following are examples of the commands used to map to the root of
    the postoffice database for Novell and LAN Manager networks:

    Novell
    ------

    map m:=&lt;servername&gt;/sys:apps\mail\data
    map root r:=&lt;Server&gt;/vol1:maildata

    LAN Manager
    -----------

    net use m: \\&lt;servername&gt;\maildata

</PRE></OL>2b. The Windows workstation software also assumes the database is in
<PRE>    the current directory of drive M unless told otherwise. It does
    not require that the directory be the current directory, but it
    does require that you specify the full path to the postoffice
    database. In Mail for Windows, version 3.0, this is done in the
    MSMAIL.INI file. In Mail for Window, version 2.1, the setting is
    in the WIN.INI file. Usually, you can find MSMAIL.INI and WIN.INI
    in your WINDOWS directory.

    To specify the path to the postoffice database for Mail for
    Windows, version 3.0, include a "ServerPath=" line in the
    [Microsoft Mail] section of MSMAIL.INI. To do the same for Mail
    for Windows, version 2.1, include a "Path=" line in the [Mail]
    section of WIN.INI. Following is an example of each type of entry:

    MSMAIL.INI (Mail for Windows, Version 3.0)
    ------------------------------------------

       [Microsoft Mail]
       ServerPath=m:\apps\mail\data

    WIN.INI (Mail for Windows, Version 2.1)
    ---------------------------------------

       [Mail]
       Path=m:\apps\mail\data

    Note: The system administrator can simplify Windows workstation
    installations by using drive M as everyone's database mapping or
    by editing the MSMAIL.INI file (Mail 3.0) located in the MAILEXE
    directory on the server to include a standard "ServerPath=" line.
    Mail 2.1 administrators can create a WINMAIL.INI file containing a
    "Path=" line (see the "Microsoft Mail 2.1 Administrator's Guide,"
    pages 183-187).

</PRE><P><LI>The settings in an INI file may appear correct, but the drive may
    not exist. It may not have been mapped or mounted, or it may have
    been disconnected. Verify that the drive and path is valid by
    using the MS-DOS DIR command.

<P><LI>Following are examples of the rights needed on different file
    servers.
<P>
    The rights needed for a Novell 3.11 server are as follows:
<P>
<PRE>       Rights       Directory
       ------------------------------------------------------------------

       [ RWCEM  ]   ..\MAILDATA directory
       [ RWCEMF ]   ..\MAILDATA\KEY, \MAILDATA\FOLDERS, and
                      \MAILDATA\CAL directories
       [ R    F ]   ..\MAILEXE directory

       R Read (Open and read files)
       W Write (Open and write to the file)
       C Create (Create a directory)
       E Erase (Delete a directory or file)
       M Modify (Change attributes or rename directory or file)
       F File Scan (See the filename when viewing directory)

    Note: Macintosh and OS/2 clients need File Scan (F) rights to the
    entire database (..\MAILDATA).

    The rights needed for a Novell 2.15 server are as follows:

       Rights        Directory
       ------------------------------------------------------------------

       [ RWOCDM  ]   ..\MAILDATA directory
       [ RW0CDMS ]   ..\MAILDATA\KEY &amp; \MAILDATA\FOLDERS directories
       [ R O   S ]   ..\MAILEXE directory

       R Read
       W Write
       O Open
       C Create
       D Delete
       M Modify
       S Search

    You can set up a Microsoft LAN Manager server with share level
    security or user level security with the following permissions:

       Rights        Directory
       ------------------------------------------------------------------

       RWCDA         ..\MAILDATA directory
       R             ..\MAILEXE directory

       R Read
       W Write
       C Create
       D Delete
       A Attribute

</PRE><P><LI>If the MAILDATA\GLB\MASTER.GLB file does not exist, restore it
    from the latest backup.
<P>
    If it is hidden, make it viewable it by changing to the
    MAILDATA\GLB directory and typing the following MS-DOS 5.0
    command:
<P>
       attrib -h master.glb /s
<P>
    If the file is locked open, close the file using whatever tools
    are available on your network. The following are Novell and LAN
    Manager examples:
<P>
       Novell
       ------
<P>
<PRE>         Console =&gt; Monitor =&gt; File Locking =&gt; Directory =&gt; File

       LAN Manager
       -----------

          Net Admin =&gt; Status =&gt; Open Files =&gt; Select File =&gt; Close
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.10 3.00 permission Mail cannot connect to<BR>
your mail server<BR>
KBCategory: kbenv kberrmsg kbtlc<BR>
KBSubcategory: MailPCDB<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 23, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
