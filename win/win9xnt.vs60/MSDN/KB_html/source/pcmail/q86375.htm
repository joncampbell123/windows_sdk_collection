

<HTML>
<HEAD>
<TITLE>PC DB: Global Address List Definition and Details </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q86375 ">
<META NAME="KBModify" CONTENT="1994/10/27">
<META NAME="KBCreate" CONTENT="1992/07/06">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT=" This article provides information about the following topics:   - What is the Global Address List (GAL)?  - Support for Groups  - Administration  - Installation  - International Issues  - User Agent Modifications  - Global Address List Index  - Perf...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QAC2,QAE1,QAR5,QABO,QAH4,QAYC,QAU3,QAGU,QBWU,QAH5,QBWD,QA5V,QAMR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC DB: Global Address List Definition and Details</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 27, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q86375 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, version 3.0
</UL> 
<P>
This article provides information about the following topics:

<UL><LI>What is the Global Address List (GAL)?
<LI>Support for Groups
<LI>Administration
<LI>Installation
<LI>International Issues
<LI>User Agent Modifications
<LI>Global Address List Index
<LI>Performance
<LI>Search Performance
<LI>Rebuild Performance
<LI>Additional Details
<P>
</UL><h3>What Is the Global Address List (GAL)?</h3>
 
<P>
The GAL is a single flat address list that contains all addresses defined
at a Microsoft Mail postoffice. For Mail users, the GAL's main purpose is
to provide a single list where users can find all the addresses they can
send mail to. Users do not need to know the location (network, postoffice,
or gateway) of the user to whom they want to send mail. The GAL will
accommodate more than 500,000 user names.
<P>
Once it is installed at the postoffice, the GAL is supported by any
Microsoft Mail version 3.0 or later clients. To see the GAL, users require
External Mail privileges. Most users configure the GAL as their primary
address list. Finding an address located in the GAL is very fast because a
binary search algorithm is used.
<P>
The GAL is not administered in the same way as the other lists. Instead, it
is periodically rebuilt from scratch. Between the time the postoffice
administrator makes a change to one of the GAL's constituent lists and the
time the GAL is rebuilt, any change will not be reflected in the GAL. For
example, if the administrator creates a new user at the postoffice, this
user will not appear in the GAL until it is rebuilt.
<P>
If the name services distribution agent (for example, directory
synchronization) is installed at the postoffice, that agent will rebuild
the GAL as part of its normal cycle. This rebuild can occur as frequently
as once per day. Optionally, the postoffice administrator can rebuild the
GAL at any time by running a command-line utility. There is no explicit
support for the GAL planned for the Mail Administrator program.
<P>
<P><h3>Support for Groups</h3>
 
<P>
In the same way external postoffice user lists contain group aliases, so
does the GAL. This means that group names belonging to external postoffices
(or gateways) are not distinguishable from regular aliases except by
inference. Remember, you cannot resolve the members of groups that are
defined at other postoffices.
<P>
Local postoffice groups can be displayed in the GAL but they cannot be
created, modified, or deleted. The postoffice administrator creates,
modifies, and deletes postoffice groups in the postoffice address list
(POL). When the GAL is rebuilt, any newly created local group aliases are
added.
<P>
Currently, postoffice groups can only be created from members of the POL.
Similarly, personal groups can only be created from members of Personal
Address Lists (PALs). From a usability point of view, this means that even
with the GAL installed, it is still difficult for an administrator to
define groups that contain large numbers of members.
<P>
While it would be convenient to be able to create groups arbitrarily from
any set of address lists or, in particular, from members of the GAL, this
capability would require overwhelming changes in both the Mail client's and
administration client's directory interface code. Furthermore, certain
architectural changes would need to take place to solve group mail delivery
problems.
<P>
<P><h3>Administration</h3>
 
<P>
The GAL becomes out of date when the administrator creates or deletes a
local user or group and when the name services distribution agent updates
the postoffice with external address transactions. Rather than maintain the
GAL incrementally, since this is considered inefficient, the GAL is
periodically rebuilt from scratch.
<P>
There are two ways the GAL can be rebuilt:

<UL><LI>The name services distribution agent automatically rebuilds the GAL
   during its normal directory synchronization cycle. In most cases, this
   is done once per day.

<LI>A postoffice administrator can manually run a utility that rebuilds the
   GAL. You can code an Administrator interface that allows the
   administrator to trigger a GAL rebuild from the Administrator program.
<P>
</UL>When the GAL is being built, duplicate full names may be encountered.
Duplicate aliases are supported in the GAL.
<P>
<P><h3>Installation</h3>
 
<P>
Installation of the GAL is part of the server version 3.0
installation/update program. During installation, all the tools needed to
create a GAL are installed, but an actual list is not created. The
Administrator program has an interface that allows the administrator to
enable or disable the GAL. By default, the GAL is disabled unless it is
specifically enabled through the Administrator program.
<P>
<P><h3>International Issues</h3>
 
<P>
Other than normal translation of client and administration screen data,
there are no issues that affect international versions of Mail. If, for
some reason, the GAL's sort order is wrong (that is, clients start using a
different code page), you can resolve the problem by simply rebuilding the
GAL with the correct code page loaded. This means there is no need for the
re-sort utility to support the GAL.
<P>
<P><h3>User Agent Modifications</h3>
 
<P>
All Microsoft Mail user agents need to be modified to support the GAL.
These modifications include code to detect the existence of the GAL and a
binary search mechanism for the alias files. Additional and significant
code changes are required to extend support from 32K users to an unlimited
number of users. Additional code changes will be necessary to support local
group names on the GAL.
<P>
<P><h3>Global Address List Index</h3>
 
<P>
The GAL is the largest address list in the Mail for PC Networks database.
It is sorted on the Full Name field to allow fast access. For Mail for
Windows' Ambiguous Names Resolution feature, it is necessary to support an
index on the GAL because the names being searched for (first, last, and so
on) are not accessible except by linear search.
<P>
The GAL index consists of two parts: a sorted Offset Records list and an
index to the index. The index of the index consists of 52 file offsets into
the GAL index file--one for each letter of the alphabet, uppercase and
lowercase, because these are the most likely characters to start the search
on. The Offset Records list consists of a WORD specifying which word the
index points in the Full Name field and a DWORD pointer to the GAL.NME
file.
<P>
To search the GAL Index file, the following steps are performed:

<OL><P><LI>Open the GAL Index file and the GAL.NME file.

<P><LI>Find the offset of the first letter in the word being searched for in
   the index.

<P><LI>Read in the Offset Record from that position in the file, then read in
   the Alias record from the GAL.NME file and determine if it is before or
   after the word being searched for.

<P><LI>A simple binary search finds the correct alias record.
<P>
</OL>The GAL.NME file should be of size 45*n bytes, where n is the number of
records. If we assume that there are on average 2.5 "words" per Full Name,
then the size of the GAL index file will be 2.5*6*n + 52*4. Therefore, for
an 80,000 user list then the GAL.NME file will be 3,600,000 bytes and the
GALINDEX.GLB file will be 1,200,208 bytes.
<P>
<P><h3>Performance</h3>
 
<P>
Because the GAL is much larger than any other list normally supported at
the Microsoft Mail postoffice, performance is an important concern. Two
issues are important: the time it takes to search for an address using a
client, and the time it takes to rebuild the GAL so that it reflects all
changes in the name service domain. The former issue is important to the
average user and the latter issue is important to administrators.
<P>
<P><h3>Search Performance</h3>
 
<P>
The GAL is searched using a binary search. This is an extremely efficient
method of searching large lists. The theoretical performance is log (base
2) times the number of addresses.
<P>
<P><h3>Rebuild Performance</h3>
 
<P>
The GAL is rebuilt by reading through all the hierarchical address lists
and merging them into a single flat list. The native Microsoft Mail
addresses have their physical addresses duplicated while foreign addresses
reference a single shared physical address record.
<P>
<P><h3>Additional Details</h3>
 

<UL><LI>The GAL can display up to 231 entries.

<LI>You can select entries for the TO or CC recipient lists.

<LI>You can select non-group entries and move them to the Personal Address
   List.

<LI>Custom addressing from the GAL is NOT supported.

<LI>The GAL can be selected as the default address list.

<LI>If the GAL files are missing, the client hides all references to the
   Global Address List and the functionality it provides.

<LI>The address search feature (MS-DOS) will not work with the GAL.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 Admin Dir-Sync DirSync<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCDB<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 27, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
