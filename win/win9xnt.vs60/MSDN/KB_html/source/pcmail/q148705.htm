

<HTML>
<HEAD>
<TITLE>PC DirSync ErrMsg: NSDA -x Terminated Abnormally w/ Exit Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148705">
<META NAME="KBModify" CONTENT="1996/04/03">
<META NAME="KBCreate" CONTENT="1996/03/20">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you run Directory Synchronization (Dir-Sync), you may see the following error on the Dispatch screen or in the Dispatch session log:  INST1  02/02/96  13:18 Checking the process table on NET1\PO1 INST1  02/02/96  13:18 Running NSDA - xx INST1 ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAV1,QAV0,QAGB,QAB4,QAH4,QBVV,QAR4,QABI,QABH,QAGL,QBWG,QBWS,QBCT,QAU3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC DirSync ErrMsg: NSDA -x Terminated Abnormally w/ Exit Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148705</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Directory Synchronization (Dir-Sync), you may see the
following error on the Dispatch screen or in the Dispatch session log:
<P>
INST1  02/02/96  13:18 Checking the process table on NET1\PO1
INST1  02/02/96  13:18 Running NSDA - xx
INST1  02/02/96  13:18 "NSDA - xx" terminated abnormally with exit code 65
<P>
where -xx could be -RT, -S, or -RR.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error will occur if some portion of the NDSA process does not
complete.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The Dir-Sync process, DISPATCH.EXE, consists of three phases: T1, T2, and
T3. The three phases are spawned by NSDA -RT, NSDA -S, and, and NSDA -RR,
respectively. NSDA will in turn spawn another process, as follows:
<P>
<PRE>   T1: NSDA -RT will spawn reqmain.
   T2: NSDA -S will spawn srvmain.
   T3: NSDA -RR will spawn reqmain, import, and rebuild.

</PRE>To determine the source of the exit code 65, use the following steps.

<OL><P><LI>Check several lines above the exit code to find the postoffice
   responsible for the error. Make a note of the time stamp and postoffice
   generating the error.

<P><LI>Go to the postoffice that reported the error, and check the
   DIRSYNC.LOG file. Locate the entries with the same date and time
   stamp. There may be a more specific error listed that will assist in
   locating the problem.
<P>
   For example, if the Mail Administrator program (ADMIN.EXE) is running
   against NET1\PO1, Import will not be able to complete, and you will see
   the following entries in the DIRSYNC.LOG on the DSServer:
<P>
<P><PRE>      02/02/96 13:18 | 1 -1 Microsoft  Mail DirSync Requestor V3.5.12
      02/02/96 13:18 | 1 105 36
      02/02/96 13:18 | 2 91 ADMIN
      02/02/96 13:18 | 2 -1 Mailbox name:  Admin.
      02/02/96 13:18 | 2 -1 Full name:  Administrator.
      02/02/96 13:18 | 2 -1 FLAG.GLB is locked open.
      02/02/96 13:18 | 1 -1 Import is finished
</PRE><P>
</OL>In the DSSERVER.LOG on the requestor, you will see the following entries:
<P>
<PRE>      02/02/96 13:18 | Status Microsoft  Mail DirSync Requestor V3.5.12
      02/02/96 13:18 | Status Requestor updates received: 36
      02/02/96 13:18 | Fatal [91] The database is locked by another
                       process: ADMIN
      02/02/96 13:18 | Fatal [  ]   Mailbox name:  Admin.
      02/02/96 13:18 | Fatal [  ]   Full name:  Administrator.
      02/02/96 13:18 | Fatal [  ]   FLAG.GLB is locked open.
      02/02/96 13:18 | Status Import is finished

</PRE></OL>In this case to correct the problem, close ADMIN.EXE on the problem
postoffice and then let Dir-Sync run again.

<OL><P><LI>If there are no associated error messages in the DIRSYNC.LOG, go
   to the following steps.

<P><LI>Determine which stage the error occurred:
<P>
<PRE>   - NSDA -RT    (T1 time)

   - NSDA -S (T2 time - runs only on DS server)

   - NSDA -RR  (T3 time)

</PRE><P><LI>If the error occurs in T1 (NSDA -RT), check the following:
<P>
   - REQCONF.GLB should be 512 bytes only and accessible.
<P>
   - REQTRANS.GLB  should be accessible (not locked).
<P>
   - REQMAIN.EXE is in the correct location and accessible
<P><PRE>     by DISPATCH.EXE.
</PRE>
<P><LI>If the error occurs in T2 (NSDA -S), check the following:
   NOTE: Only the Dir-Sync server should be running T2.
<P>
   - SRVCONF.GLB should be divisible by 1024 and accessible.
<P>
   - MSTTRANS.GLB  should be accessible.
<P>
   - SYSTEM.KEY  should be 560 bytes only.
<P>
   - SYSTEM.MBG  should be divisible by 116 bytes and accessible.
<P>
   - SRVMAIN.EXE is in the correct location and accessible by DISPATCH.EXE
<P>
   If the two SYSTEM files do not divide evenly, or if the SYSTEM.MBG file
   is very large (quotient larger than 100), you may want to reset the
   two SYSTEM files. Refer to Application Note WA0725 "Directory
   Synchronization (Dir-Sync)" for the resetting procedures.

<P><LI>If the error occurs in T3 (NSDA -RR), check the following:
<P>
   - SRVTRANS.GLB  should be 0 bytes after T3 completion
<P><PRE>     if it is not at 0 bytes, reset the file with
     the following command:
</PRE><P>
<PRE>        TYPE NUL &gt; SRVTRANS.GLB

   - USRTRANS.GLB same conditions as above.

   - NMETRANS.GLB same conditions as above.

   - GWTRANS.GLB same conditions as above.

   - IGWTRANS.GLB should not be present; if it is delete it.

   - INMETRAN.GLB should not be present; if it is delete it.

   - IUSRTRAN.GLB should not be present; if it is delete it.

   - SRVUPDS.GLB should not be present; if it is delete it.

   - REQUPDS.GLB should not be present; if it is delete it.

   - Any SORTxxxx.GLB where xxxx is a number should not be present,
     if so delete it.

   - REQMAIN.EXE is in the correct location and accessible by DISPATCH.EXE.

   - IMPORT.EXE is in the correct location and accessible by DISPATCH.EXE.

   - REBUILD.EXE is in the correct location and accessible by DISPATCH.EXE.

</PRE><P><LI>Because the REBUILD.EXE process in T3 is the most time and resource
   consuming process, the following conditions may also cause the exit
   code 65 error:
<P>
   - Lack of disk space on postoffice server.
<P>
   - Ownerless files (Novell only) on postoffice server.
<P>
   - Lack of available memory on Dispatch computer.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
There may be other factors and possible causes that are not mentioned here.
This article is intended to provide a more defined starting point to begin
troubleshooting this error.
<P>
For additional information, see Chapter 14 in the "Administrator's Guide"
for Microsoft Mail for PC Networks.
<P>
Also see the DIRSYNC.TXT file on Disk 1 of your Microsoft Mail for PC
Networks disks.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50 fatal error 91 fatal 91 nsda - rr nsda<BR>
-rt nsda -s<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCDirSync<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
