

<HTML>
<HEAD>
<TITLE>PC Forms: Using Visual Basic OLE 2.0 Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101539">
<META NAME="KBModify" CONTENT="1995/11/01">
<META NAME="KBCreate" CONTENT="1993/07/15">
<META NAME="Keywords" CONTENT="kbprg kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT=" Microsoft Electronic Forms Designer was designed to be used with version 2.0 or later of Microsoft Visual Basic Professional edition. An OLE (Object Linking and Embedding) 1.0 control that allows applications to exchange data is included with Visual...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QANG,QA7H,QA9Q,QAH4,QAKJ,QAXB,QA7O,QAOE,QAMN,QAB5,QAPN,QBD2,QAC1,QBMR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Forms: Using Visual Basic OLE 2.0 Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101539</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Electronic Forms Designer, version 1.0, running with
   Microsoft Mail for PC Networks, versions 3.0 and 3.2
</UL> 
<P>
Microsoft Electronic Forms Designer was designed to be used with version
2.0 or later of Microsoft Visual Basic Professional edition. An OLE (Object
Linking and Embedding) 1.0 control that allows applications to exchange
data is included with Visual Basic 2.0. The E-Forms Designer was developed
to interface with version 1.0 of the OLE control.
<P>
However, version 3.0 of Microsoft Visual Basic includes support for OLE 2.0
with a new OLE control (MSOLE2.VBX). This new implementation of OLE is not
supported by the Electronic Forms Designer unless the following
modifications are made to the EFORM.BAS and CONSTANT.BAS files.
<P>
<P><h3>Modify Functions in EFORM.BAS</h3>
 
<P>
The OLE 1.0 control type is defined as "OleClient." With OLE 2.0, the
control type is "OLE." Perform the following steps to update the code in
the ReadTaggedControls and WriteTaggedControls functions defined in
EFORM.BAS:

<OL><P><LI>Open your E-Form project in Visual Basic.

<P><LI>From the Project window, select EFORM.BAS. Click the View Code button to
   display the code.

<P><LI>From the Procedures drop-down list box, select the ReadTaggedControls
   function.

<P><LI>Scroll to the code that enumerates the OLE control. In the following
   line of code
<P>
<P><PRE>      ElseIf TypeOf ctrl Is OleClient Then
</PRE><P>
   change "OleClient" to "OLE".

<P><LI>From the Procedures drop-down list box, select the WriteTaggedControls
   function.

<P><LI>Repeat step 4 to modify the type declaration.

<P><LI>From the File menu, choose Save Project.
<P>
</OL><h3>Modify Definitions in CONSTANT.BAS</h3>
 
<P>
In addition to a change to the type definition, OLE 2.0 changed a number of
settings for the Action and OLEType properties, as well as the Updated
Event. These settings are defined in the CONSTANT.BAS file. To update the
settings, do the following:

<OL><P><LI>Open your E-Form project in Visual Basic.

<P><LI>From the Project window, select CONSTANT.BAS. Click the View Code
   button to display the code.

<P><LI>Scroll to the section commented "'OLE Client Control."

<P><LI>Modify the section titled "'Action" as listed below:
<P>
<P><PRE>      'Action
      Global Const OLE_CREATE_NEW = 0
      Global Const OLE_CREATE_FROM_FILE = 1
      Global Const OLE_COPY = 4
      Global Const OLE_PASTE = 5
      Global Const OLE_UPDATE = 6
      Global Const OLE_ACTIVATE = 7
      Global Const OLE_CLOSE = 9
      Global Const OLE_DELETE = 10
      Global Const OLE_SAVE_TO_FILE = 11
      Global Const OLE_READ_FROM_FILE = 12
      Global Const OLE_INSERT_OBJ_DLG = 14
      Global Const OLE_PASTE_SPECIAL_DLG = 15
      Global Const OLE_FETCH_VERBS = 17
      Global Const OLE_SAVE_OLE1 = 18
</PRE>
<P><LI>Update the section titled "'ServerType" to "'OLEType" and make the
   following changes:
<P>
<P><PRE>      'OLEType
      Global Const OLE_LINKED = 0
      Global Const OLE_EMBEDDED = 1
      Global Const OLE_NONE = 2
</PRE>
<P><LI>Change "'Update Event Constants" to "'Updated Event Constants" and make
   the following change:
<P>
<P><PRE>      'Updated Event Constants
      Global Const OLE_CHANGED = 0
      Global Const OLE_SAVED = 1
      Global Const OLE_CLOSED = 2
      Global Const OLE_RENAMED = 3
</PRE>
<P><LI>From the File menu, choose Save Project.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbprg kbtlc<BR>
KBSubcategory: MailPCForms<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 1, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
