

<HTML>
<HEAD>
<TITLE>FAX: Configuring GammaLink GammFax with i3CAS Drivers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138548">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="MailGWFax kbenv kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  You can configure the Mail Gateway to Fax on a machine running the Microsoft MS-DOS operating system and version 1.08 of i3CAS drivers.  NOTE: The i3CAS drivers are provided by Instant Information Inc. as an alternate to the CAS API originally ship...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBVW,QDI2,QAVU,QANE,QAU9,QAFI,QABA,QDIZ,QBWS,QAJG,QBXB,QAY2,QATJ,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FAX: Configuring GammaLink GammFax with i3CAS Drivers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138548</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MS-DOS
kbenv
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail Gateway to FAX, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can configure the Mail Gateway to Fax on a machine running the
Microsoft MS-DOS operating system and version 1.08 of i3CAS drivers.
<P>
NOTE: The i3CAS drivers are provided by Instant Information Inc. as an
alternate to the CAS API originally shipped with GammaLink GammaFax fax
cards.
<P>
The original documentation included with the Fax Gateway contains
instructions on how to configure the gateway with the GammaLink GammaFAX CP
fax card, which is no longer manufactured. When you install the newer
drivers, the Fax Gateway can effectively use the discontinued CP and the
current XP, CPi, and XPi versions of the GammaFax cards.
<P>
When you install the i3CAS drivers, the performance limitations of GCAS.EXE
are replaced with a new level of product stability and features that
include:

<UL><LI>The ability to suppress the cover page.

<LI>The ability to load and unload the i3CAS drivers without logging off the
   gateway server or stopping the services.
<P>
</UL>GammaLink GammaFAX boards are available worldwide. You can find the product
availability and additional information regarding GammaLink boards at the
following locations:

<UL><LI>Dialogic World Headquarters, New Jersey, U.S.A.: (800) 755-4444

<LI>Dialogic Telecom Europe, Brussels, Belgium: (32) 2-715-0890

<LI>Dialogic Latin America and Caribbean, Argentina: (541) 322-3152

<LI>Dialogic Japan and Korea, Tokyo, Japan: (81) 3-5430-3253
<P>
</UL>GAMMALINK GAMMAFAX CPI AND XPI BOARDS
<P>
The GammaFax CPi and XPi boards are microprocessor-based facsimile modems
with their own RAM, CPU, and telephone interface.
<P>
To install the GammaFax CPi and XPi boards:
<P>
NOTE: The GammaFax software version 5.2 must be installed on the local
drive of the dedicated gateway computer.

<OL><P><LI>Turn off the power to the gateway computer. Remove the cover, and
   touch the power supply to dissipate built-up static charge. Install
   the card into an available (preferably 16-bit) slot.

<P><LI>Ensure that the telephone connector on the board is not obstructed. It
   may be necessary to loosen the fax card's mounting screw and reposition
   it if the phone cord jack cannot be easily inserted.
<P>
</OL><h3>To check the telephone line</h3>
 

<OL><P><LI>Locate an available telephone. Remove the cord from the wall and
   insert it into the jack you intend to use for the Fax Gateway. Pick up
   the receiver, and after you check for normal dial-tone, dial the number
   of another fax device. If the remote device answers the telephone, you
   should hear the standard modem handshake. After you receive the
   handshake tone, hang up the telephone.

<P><LI>With the telephone still connected to the Fax Gateway's telephone
   jack, call the fax number from another telephone; if it rings, the
   number for the board is correct.
<P>
</OL>GAMMAFAX SOFTWARE
<P>
When the GammaFax board and telephone connections are properly installed,
you are ready to install the GammaFax software.
<P>
NOTE: Gateway computer must have a hard disk and more than 640 kilobytes of
available memory.
<P>
<P><h3>To install the GammaFax software</h3>
 

<OL><P><LI>Start the gateway computer. Insert the GammaFax Install disk into
   the appropriate disk drive. At the MS-DOS prompt, type the
   following command and press ENTER:
<P>
<P><PRE>      drive: install
</PRE><P>
   On screen instructions will prompt you through the installation
   process. The presence of the GammaFax card will be automatically
   detected. If the board type and initial I/O settings are
   incorrect, you can use the space bar to toggle through the
   available settings.
<P>
   NOTE: The country code asked for during installation can be found
   in Appendix A of the GammaFax "Reference Manual."

<P><LI>After you install the software, verify that your Customer
   Subscriber Identification (CSID) number is correct. This number is
   usually a fax number proceeded by an area code.
<P>
   To verify your CSID number, type the contents of the GFAX.$DC
   configuration file, or view it in your preferred text editor.
<P>
</OL><h3>To check the hardware</h3>
 
<P>
GammaLink provides a utility called GFCPTST.EXE that will allow you to
confirm that the I/O address settings are correct and that the board is
properly installed. This utility will be located in the GammaFax directory
that was created when the GammaFAX software was installed. You run the
GFCPTST.EXE utility from the MS-DOS prompt or a batch file runs a
diagnostic test and displays the board model, channel assignments, ROM
version, and the amount of the RAM on the board.
<P>
CAUTION: Do not run GFCPTST.EXE when the dispatcher is running. The results
from GFCPTST will not be correct; transmissions in progress will be
disrupted, and the system may have to be reset. On the gateway computer,
run the following command to ensuring that GFDCP is not loaded:
<P>
<PRE>   mem /c | more

</PRE></OL>NOTE: You will need to follow the steps to install the GammaFax software in
the previous section before testing the hardware. GFCPTST should be run
after the GammaFax software is installed.
<P>
To check the hardware after you install the GammaFax software:
<P>
At the MS-DOS prompt, change to the local GammaFax install directory, and
type the following command and press ENTER:
<P>
<PRE>   \ gfcptst

</PRE>The displayed settings should be checked against the physical channels and
equivalent I/O addresses listed in the GammaFax CPi/XPi "Installation and
Reference Manual." Modify incorrect settings and repeat this procedure.
<P>
For additional information on installing and configuring the hardware,
refer to the GammaFax "Installation and Reference Manual."
<P>
To verify the GammaFax board I/O address:
<P>
After you have installed the GammaFax software, the utility GFSETUP can be
used to change or verify the physical channel and I/O address of the fax
card. When you run this utility from the MS-DOS command prompt, the
following options will be displayed:

<UL><LI>System setup.

<LI>Board setup.

<LI>Cover setup.
<P>
</UL>You can select the Board Setup option to modify the GammaFax hardware
settings.
<P>
<P><h3>To send a test fax</h3>
 
<P>
To ensure the GammaFax card is operating correctly, send a test fax with
the Fax menu utility program, FAXM.EXE, included with the software. This
utility is called from the batch file named GF.BAT located in the GammaFAX
directory.
<P>
Below are the steps to initialize the GammaFax card, and start the fax menu
utility program:

<OL><P><LI>At the MS-DOS command prompt on the gateway computer, change to
   the GammaFax directory.

<P><LI>Run GFCPTST.EXE to test the current state of the fax card. If the
   card is operating properly, the test should complete with no errors.

<P><LI>Start the GammaFax dispatcher by running the batch file called
   GFQM.BAT that initially sets the environment parameter, SET GFAX=
   to the Fax Queue. Then it runs the dispatcher.

<P><LI>To run the Fax menu utility program, type the following and press
   ENTER:
<P>
<P><PRE>      gf.bat
</PRE><P>
   For more information on sending faxes with the GammaFax Menus
   Utility (FAXM.EXE) or to resolve any problems when you run the
   diagnostics, refer to the GammaFax "Utilities Manual."
<P>
</OL>MICROSOFT MAIL GATEWAY TO FAX (VERSION 3.X)
<P>
You can now Install the Mail Gateway to FAX and Gateway Access components.
The gateway postoffice requires both the Gateway and Gateway Access
component of the Mail Gateway to FAX. A postoffice forwarding and receiving
faxes from a gateway postoffice is considered to be a downstream; thus, it
only requires the Mail Gateway Access to FAX component.
<P>
<P><h3>To install the Mail Gateway to FAX and Access Component</h3>
 
<P>
CAUTION: On the gateway computer, type the following command to ensure that
the GFDCP is not loaded:
<P>
<PRE>   mem/c | more

</PRE></OL>If it is loaded, reboot the gateway computer before you install the gateway
components.

<OL><P><LI>Insert the Gateway Component disk into the disk drive, and run
   the INSTALL.EXE program. Follow the screen prompts to complete
   the installation.

<P><LI>Insert the Gateway Access Component disk into the disk drive, and
   run the INSTALL.EXE program. Follow the screen prompts to complete
   the installation.
<P>
   For more information on configuring or installing Microsoft Mail
   Gateway to FAX or Gateway Access to FAX components, please refer
   to the chapters entitled: "Installing the Gateway" and "Setting
   Up the Gateway" in the "Administrator's Guide" for Microsoft Mail
   Gateway to FAX.
<P>
</OL><h3>To configure Mail Gateway to FAX with PROFILE.EXE</h3>
 
<P>
NOTE: It is crucial to run PROFILE.EXE, and edit a file named PROFILE.GLB
in order to match your network environment.

<OL><P><LI>Type the following command and press ENTER to run the PROFILE.EXE
   from the \MAILEXE directory:
<P>
<P><PRE>      profile -d&lt;m&gt;
</PRE><P>
   where &lt;m&gt; represents the network drive of the postoffice.

<P><LI>Select the 100% CAS-compatible option as the fax board type.
<P>
</OL>For more information on installing the Microsoft Mail Gateway to FAX or
configuring the gateway with PROFILE.EXE, refer to the chapters entitled:
"Installing the Gateway" and "Setting Up the Gateway" in the
"Administrator's Guide" for Microsoft Mail Gateway to FAX.
<P>
OVERVIEW OF I3CAS (VERSION 1.08)
<P>
The i3CAS drivers for GammaFax offer extended features that were not
available when the original GCAS drivers shipped with the Microsoft Mail
Gateway to FAX. Most of these extended features are configured through
settings within the I3CAS.INI file that is read each time the i3CAS drivers
are loaded.
<P>
NOTE: In order to use the extended faxing features provided by using the
i3CAS drivers, all current GammaFAX CAS API calls, GFDCP.EXE or GCAS.EXE,
must be disabled. Use a REMark statement or remove the .EXE programs from
the AUTOEXEC.BAT of the gateway computer.
<P>
For additional information on removing or disabling your current CAS driver
configurations, please refer to your software documentation. If you do not
have the documentation, consult your vendor.
<P>
The i3CAS driver toolkit supports the following GammaFax models: CP, CPi,
XP, XPi, CPMC, CPiMC, XPMC, CPD, CP4/LSI. However, for use with the Fax
Gateway, only the CP, CPi, XP, and XPi drivers should be used.
<P>
<P><h3>To get the i3CAS drivers</h3>
 
<P>
If the current i3CAS drivers were not packaged with your GammaFax hardware,
you can download ICAS.EXE, a self-extracting file, from the GammaLink BBS
at (408) 745-2216.
<P>
The GammLink BBS supports the following communication options:
<P>
<PRE>   Data bits     Parity     Stop Bits     Transfer rates (BPS)
</PRE></OL> 
<PRE>   8             N          1             1200, 2400, 9600, and 14400
   7             E          1             1200, 2400, 9600, and 14400

</PRE><h3>To install the i3CAS drivers</h3>
 

<OL><P><LI>After you download I3CAS.EXE to a clean directory, run it (type
   "i3cas" at the MS-DOS command prompt) to extract the contents of the
   file. You should receive the following files:
<P>
<PRE>      I3CAS.EXE     (339,328 bytes, dated 07-03-95, 4:57 P.M.)
      I3_108.EXE    (325,592 bytes, dated 04-14-95, 3:14 P.M.)
      READ_1ST.TXT  (    274 bytes, dated 04-14-95, 3:14 P.M.)
      READ_2ND.TXT  ( 11,380 bytes, dated 04-14-95, 4:23 P.M.)

</PRE><P><LI>Copy the I3_108.EXE to the same directory as your Microsoft Mail
   for PC Networks or Microsoft Mail Gateway to FAX executables,
   usually the \MAILEXE subdirectory.

<P><LI>From the executables directory, to extract the i3CAS drivers from this
   file, type the following command and press ENTER:
<P>
<P><PRE>      i3_108 -d
</PRE><P>
  where the -d parameter will create a subdirectory.
<P>
</OL>After you extract the I3_108.EXE file, the extracted files should be in a
new subdirectory, \MAILEXE\ICAS.
<P>
Additional directories will appear similar to the directory view below:
<P>
<PRE>   Directory of D:\MAILEXE\ICAS
</PRE></OL> 
<P>
<PRE>   08/07/95  09:13a   &lt;DIR&gt;
   08/07/95  09:13a   &lt;DIR&gt;
   08/07/95  09:13a   &lt;DIR&gt;   BIN
   08/07/95  09:13a   &lt;DIR&gt;   SAMPLES
     4 File(s)  0 bytes
     216,790,528 bytes free

</PRE>Directory of D:\MAILEXE\ICAS\BIN
 
<P>
<PRE>08/07/95  09:13a   &lt;DIR&gt;
08/07/95  09:13a   &lt;DIR&gt;   ....
08/07/95  09:13a   &lt;DIR&gt;   FONTS
08/07/95  09:13a   &lt;DIR&gt;   MODEM
08/07/95  09:13a   &lt;DIR&gt;   QUEUE
   5 File(s)  0 bytes

</PRE><h3>To configure the i3CAS drivers</h3>
 
<P>
Before you try to load the i3CAS drivers, use a text editor to modify
the I3LOAD.INI file to reflect your current directory structure.
<P>
NOTE: In some cases, if the gateway computer was previously configured for
GCAS, older versions of GammaFax software may be configured on the
gateway computer and may be called from the AUTOEXEC.BAT. Replace or
REMark out the following lines, if encountered:
<P>
<PRE>   \GammaFax       in PATH statement
   SET GFAX        = &lt;local drive&gt;:\GammaFax
   GFQM            loads the GammaFax software (dispatcher)
   GF              sets the environment variable, then loads FAXM.EXE

</PRE>EXTENDED FEATURES OF I3CAS
<P>
Users of the Mail Gateway to FAX will be able to benefit from extended
faxing features when you modify specific line settings within the
I3LOAD.INI file.
<P>
Notes:

<UL><LI>The I3LOAD.INI file is read each time the i3CAS drivers are loaded
   to reflect current configuration preferences.

<LI>Each line in this ASCII file cannot exceed 128 characters and must
   end with a carriage return and line feed.
<P>
</UL>Before you can use the gateway, you must first load the i3CAS drivers. It
is recommended that you add an I3LOAD statement to the AUTOEXEC.BAT file of
your gateway computer. This is optional and can be added later, if desired.
<P>
<P><h3>To dynamically load and unload i3CAS drivers</h3>
 
<P>
To load the CAS drivers, type the following on the command line:
<P>
<PRE>   i3load

</PRE>To unload the CAS drivers, type the following command line:
<P>
<PRE>   i3load /u

</PRE>The i3LOAD program can use additional command line switches:
<P>
<PRE>   i3load [/s]  [/f&lt;filespec&gt;] [/d&lt;filespec&gt;] [/u] [ini_file]

</PRE>where:
<PRE>   /s             Suppress all beeps and screen messages, returning
                  only an error class indicating which driver
                  failed to load. Default: Display complete error #s.

   /f&lt;filespec&gt;   Specifies an MS-DOS file to route error information
                  to including drive and path, if desired.

   ini-file       Name of the INI configuration for i3LOAD to use
                  for initialization. If the INI file is not
                  specified, the default search points to the ICAS\BIN
                  subdirectory of \MAILEXE or alternate directory
                  location of executables.

</PRE><h3>To enable/disable the cover/second page</h3>
 
<P>
To globally disable the cover page, change the following setting in the
I3LOAD.INI file:
<P>
<PRE>   [ICANFAX]
   ignore_mail_pages=No

</PRE>NOTE: The default value of this option is No.
<P>
If you change this option to Yes, the gateway can receive the actual faxed
document with no cover or mail window compose pages sent beforehand.
<P>
<P><h3>To control failed transmissions (retry attempts)</h3>
 
<P>
The retry attempts of fax transmissions are necessary when the gateway
encounters send failures.
<P>
To set the number of times the gateway will retry, change the following
setting in the I3LOAD.INI file:
<P>
<PRE>   [ICANFAX]
   failed_send_retry_attempts=3

</PRE>NOTE: The default value of this option is 3.
<P>
You can set this option to any number, or to eliminate the retry attempts
make the option equal 0 (zero).
<P>
Additional .INI file setting in this section are listed below:
<P>
<PRE>   use_ems=Yes
   use_high=Yes
   busy_call_send_retry_seconds=20
   queues_path=c:\mail35xs\ICAS\BIN\QUEUE
   send_all_pages_on_retry=Yes

</PRE>MEMORY CONSIDERATIONS
<P>
After you load the network drivers and i3CAS drivers, at least 350K of
conventional memory will be needed to run the gateway. If the gateway
machine uses a network interface card (NIC) that does not have its own
memory cache, ensure that this amount of memory is actually available.
<P>
I3CAS MAINTENANCE AND TROUBLESHOOTING
<P>
Periodically, it may be necessary to remove files with the following
extensions from the i3CAS Install directory, \…\ICAS\BIN:
<P>
<PRE>   *.CVR     Contains selected cover page.

   *.LST     Contains received fax content.

   *.TCF     Contains incoming TIF image to be converted.

</PRE>These files can accumulate on the hard drive of the gateway computer. The
gateway does not have a menu driven program or automated way to remove
these files. To ensure stable operation of the gateway, periodically delete
these files from the i3CAS install directory. You can also create a batch
file to delete the files.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbenv kbhowto<BR>
KBSubcategory: MailGWFAX<BR>
Keywords          : MailGWFax kbenv kbhowto<BR>
Version           : 3.00<BR>
Platform          : MS-DOS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
