

<HTML>
<HEAD>
<TITLE>PC Adm: Err Msg: Notice 37 Disk Directory Full or Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108840">
<META NAME="KBModify" CONTENT="1995/05/05">
<META NAME="KBCreate" CONTENT="1993/12/19">
<META NAME="Keywords" CONTENT="kbenv kbtool">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  With versions 2.1x, 3.0, 3.0a, and 3.2 of Microsoft Mail for PC Networks, you may encounter the following error when logging into the Mail Administrator (ADMIN.EXE) program:     Notice 37    Disk directory full or error opening file  NOTE: This err...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAFI,QAYC,QACF,QAUD,QAFX,QAGU,QDIR,QAB4,QABO,QDIU,QAML,QAUR,QBDM,QAVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Adm: Err Msg: Notice 37 Disk Directory Full or Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108840</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 2.1x, 3.0, 3.0a, and 3.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
With versions 2.1x, 3.0, 3.0a, and 3.2 of Microsoft Mail for PC Networks,
you may encounter the following error when logging into the Mail
Administrator (ADMIN.EXE) program:
<P>
<PRE>   Notice 37
   Disk directory full or error opening file

</PRE>NOTE: This error will also occur if the operating system or network
operating system has the files in question locked open.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error may occur if any of the following sets of files are inaccessible
(locked open, corrupted, improper rights, etc.):
<P>
<PRE>   ADMIN.NME and ADMINSHD.NME (in the NME directory)
   ADMIN.GRP and ADMINSHD.GRP (in the GRP directory)

</PRE><h2>RESOLUTION</h2>
 
<P>
NOTE: Before re-creating these files, you should check the operating system
or network operating system to ensure that the files are not locked open.
<P>
You have two options:
<P>
<P><h3>Option 1</h3>
 
<P>
NOTE: All users must be logged off of the postoffice before any of the
files are changed.
<P>
Restore the following files from a backup copy:
<P>
<PRE>   ADMIN.NME
   ADMINSHD.NME
   ADMIN.GRP
   ADMINSHD.GRP
   GROUP.GLB

</PRE>Restoring older versions of files can produce inconsistencies in the
Mail system database because you will lose any changes made to these
files after the last backup. This can cause problems such as making it
impossible to send mail to users created after the last backup. To prevent
such errors, restore the following files also:
<P>
<PRE>   ACCESS.GLB
   ACCESS2.GLB
   ACCESS3.GLB

</PRE>If you restore these files, users created after the last backup will not be
able to log in to Mail until you re-create their mailboxes, and they will
not have access to any old mail in their Inbox or private folders.
<P>
Before you re-create the ACCESS files, you should save the user's
mail.
<P>
Microsoft Mail for Windows version 3.0a and 3.2 users can export their
folders using the Export Folder option under the File menu. Microsoft Mail
MS-DOS client users must move all mail from their Inbox into a private
folder and then archive it by selecting Options, Folders, Folders, Archive.
<P>
Once the users have been re-created, Microsoft Mail for Windows 3.0a and
3.2 users can import the folders into their new Mail message files (MMFs)
by choosing Import Folders from the File menu. Microsoft Mail MS-DOS client
users must de-archive their old folders by selecting Options, Folders,
Folders, De-Archive.
<P>
<P><h3>Option 2</h3>
 
<P>
NOTE: All users must be logged off of the postoffice before any of the
files are changed.
<P>
If a recent backup copy is not available, you must re-create the .NME and
.GRP files. These two file groups point to each other, so if you re-create
one of these groups, you also must re-create the other in order to maintain
the consistency of the Mail database.
<P>
You can create the ADMIN.NME file with the ACCTONME.EXE utility, which is
available from Microsoft Product Support Services. ADMINSHD.NME is a copy
of ADMIN.NME.
<P>
Notes:

<UL><LI>Running ACCTONME.EXE does not restore any groups, external postoffice
   users, or gateway users that were present in the Postoffice Address
<P><PRE>    List.
</PRE>
<LI>The resetting of group files can be automated. For additional
   information, please see the following article in the Microsoft
   Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../pcmail/q129500.htm">Q129500</A></B>
<PRE></PRE>      TITLE     : Automating the Resetting of Group Files using GIMPORT

</PRE></UL>After you re-create the ADMIN.NME and ADMINSHD.NME files, re-create the
.GRP files as follows:

<OL><P><LI>Change the directory to the GRP subdirectory of the Mail database.

<P><LI>Run the MS-DOS DEBUG command as follows:
<P>
   a. At the MS-DOS prompt, type:
<P>
<PRE>        debug

   b. At the DEBUG hyphen (-) prompt, type the following and press ENTER
      after each line:

         n admin.grp
         rcx

   c. The following lines are displayed:

         CX 0000
         :

      After the colon (:), type the following and press ENTER:

         8

   d. At the hyphen prompt, type the following and press ENTER:

         f100,107,0

   e. At the hyphen prompt, type the following and press ENTER:

         w

      You will now see:

         writing 00008 bytes

    f. At the hyphen prompt, type the following and press ENTER:

          q

       This returns you to the MS-DOS prompt.

</PRE><P><LI>Copy ADMIN.GRP to ADMINSHD.GRP.

<P><LI>To maintain the consistency of the Mail data files, you must reset the
   GROUP.GLB file in the Microsoft Mail postoffice GLB subdirectory:
<P>
   a. Run the MS-DOS DEBUG command as follows:
<P>
<PRE>         debug group.glb

   b. At the DEBUG hyphen prompt, type the following and press ENTER:

         f,100,103,00

   c. At the DEBUG hyphen prompt, type the following and press ENTER:

         rcx

   d. The following lines are displayed:

         CX 0000
         :

      After the colon, type the following and press ENTER:

         4

   e. At the hyphen prompt, type the following and press ENTER:

         w

      You will now see:

         writing 00004 bytes

   f. At the hyphen prompt, type the following and press ENTER:

         q

      This returns you to the MS-DOS prompt.

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
ACCTONME.EXE is available as part of the Application Note titled "Database
Maintenance Utilities," WA0641. To obtain this application note in the
United States, call Microsoft Product Support Services at (206) 635-7022 or
(900) 555-2100. Outside the United States, contact the Microsoft subsidiary
for your area. To locate your subsidiary, call Microsoft International
Customer Service at (206) 936-8661.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.1x 3.00 3.00a 3.20 admin mmf<BR>
KBCategory: kbenv kbtool<BR>
KBSubcategory: MailPCAdm<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
