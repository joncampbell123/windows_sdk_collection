

<HTML>
<HEAD>
<TITLE>PC Gen: Useful Novell Utilities For Administrators </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137393">
<META NAME="KBModify" CONTENT="1995/10/04">
<META NAME="KBCreate" CONTENT="1995/09/26">
<META NAME="Keywords" CONTENT="kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you maintain or troubleshoot a Microsoft Mail for PC Networks postoffice in a Novell NetWare environment, many Novell utilities can be useful, such as the following:       CHKVOL.EXE  - Displays statistics on the current volume.         FLAG.E...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW5,QAEF,QAGB,QAGU,QBCT,QAGC,QAI5,QBCU,QA7T,QAY2,QAFI,QBWS,QBG2,QADK,QAYC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Gen: Useful Novell Utilities For Administrators</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 4, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137393</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.2, 3.2a, and 3.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you maintain or troubleshoot a Microsoft Mail for PC Networks
postoffice in a Novell NetWare environment, many Novell utilities can be
useful, such as the following:
<P>
<PRE>     CHKVOL.EXE  - Displays statistics on the current volume.

       FLAG.EXE  - Displays and allows modification to NetWare file
                   attributes.

    MONITOR.NLM  - Views open files and releases locked files (launched
                   from the server console only).

       NDIR.EXE  - Displays the size, date, time, and owner of each file in
                   a NetWare directory.

      PURGE.EXE  - Permanently deletes previously erased files in a
                   NetWare directory.

     RIGHTS.EXE  - Displays a user's access rights in the current
                   directory.

    SALVAGE.EXE  - Restores deleted files that are not yet purged.

     SYSCON.EXE  - For network administration (user accounts, server
                   error log, file server information, etc.).

   USERLIST.EXE  - Displays a list of all users currently logged onto the
                   server.

</PRE>NOTE: For best results, make sure you are logged onto the Novell server as
SUPERVISOR or equivalent before you run any of the above utilities.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following is detailed information about the utilities listed above:
<P>
<P><h3>CHKVOL.EXE</h3>
 
<P>
Usage: CHKVOL
<P>
Chkvol will report the following information on the current volume:

<UL><LI>Total volume space
<LI>Space in use by files
<LI>Space in use by deleted files
<LI>Space available from deleted files
<LI>Space remaining on volume
<LI>Space available to &lt;currentuser&gt;
<P>
</UL>Because mail executables do not consider "Space in use by deleted files" as
actual free space, a purge may be needed (see PURGE.EXE below). To
determine the actual amount of free space a mail executable sees, use the
following formula:
<P>
<PRE>   (Space Remaining on Volume) minus (Space in Use by Deleted Files)
   equals (Actual Free Space)

</PRE>This utility is also useful in determining the actual space available to
the user that is currently logged on. This may or may not be less than the
Space Remaining on Volume figure. See the SYSCON section below about
volume/disk restrictions for more information.
<P>
<P><h3>FLAG.EXE</h3>
 
<P>
<PRE>Usage:    FLAG [path [option | [+|-] attribute(s) ] [SUB]]
</PRE>Example:  FLAG M:\MAILDATA\*.* RW SUB
<P>
This will change all file attributes under MAILDATA and subdirectories to
Read/Write. For high-traffic postoffices, you can also add the (S)hareable
attribute to KEY files and GLB files (with the exception of CONTROL.GLB,
TID.GLB, FLAG.GLB, and MASTER.GLB).
<P>
<P><h3>MONITOR.NLM</h3>
 
<P>
Usage: (from the file server console only) LOAD MONITOR. This is a menu
driven utility useful for clearing locked files from stranded connections.
It also provides viewing of file open/lock activity, file server resource
utilization stats, connections, and disk information.
<P>
NOTE: In order to run this utility from a workstation, RSPX.NLM and
REMOTE.NLM must be loaded on the file server, and Remote Console
(RCONSOLE.EXE) must be launched at the workstation. RCONSOLE provides a
direct console connection to the server so that it is possible to run
MONITOR from a desktop machine.
<P>
When a workstation running a mail executable crashes, MAILDATA files may be
left open. Use MONITOR to close the files safely, and clear the connection.

<OL><P><LI>From the Available Options menu, choose Connection Information.

<P><LI>Select the logon ID whose machine has crashed, then press DELETE.

<P><LI>Answer Yes to the Clear Connection? prompt.
<P>
</OL><h3>NDIR.EXE</h3>
 
<P>
<PRE>Usage:    NDIR [path] [/option...]
</PRE></OL>Example:  NDIR M:\MAILDATA\*.* /OW LE " " /SUB
<P>
Displays all ownerless files under MAILDATA and subdirectories along with
the file date/time stamp and size.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q100511.htm">Q100511</A></B>
   TITLE     : Assigning Owners to Files in NetWare 2.x and 3.x

</PRE><h3>PURGE.EXE</h3>
 
<P>
<PRE>Usage:    PURGE [filename | wildcard] [/ALL | /A]
</PRE>Example:  PURGE M:\MAILDATA\*.* /ALL
<P>
Purges all deleted MAILDATA files from the volume. Because mail executables
can not interpret free space from the space used by deleted files, a
periodic purge may be necessary.
<P>
<P><h3>RIGHTS.EXE</h3>
 
<P>
<PRE>Usage:    RIGHTS [path]
</PRE>Example:  RIGHTS M:\MAILDATA
<P>
Rights can contain any of the following:  [SRWCEMFA]
<PRE>      All | Supervisor | Read | Write | Create | Erase
          | Modify |File scan |Access Control

</PRE>Displays the current logon ID's effective rights for the MAILDATA
directory.
<P>
Usually these rights are inherited down into all sub-directories as well,
unless otherwise specified in Trustee Directory Assignments for that user.
It is useful for checking a mail client or a mail message transfer agent's
(MTAs) user rights to MAILDATA.
<P>
<P><h3>SALVAGE.EXE</h3>
 
<P>
<PRE>Usage:   SALVAGE
</PRE>This is a menu driven utility.
<P>
SALVAGE is useful for quickly restoring a recently deleted file. To restore
a deleted MAILDATA file, do the following:

<OL><P><LI>Run SALVAGE in the same volume where MAILDATA resides.

<P><LI>Change the current directory to the MAILDATA directory that contained
   the deleted file.

<P><LI>Select to View\Recover Deleted files, then set the view criteria for *.*

<P><LI>Search for the filename you wish to restore; highlight it, and press
   ENTER.
<P>
</OL>NOTE: If you restore a previous version over an existing file, you will be
prompted to rename the file you are restoring.
<P>
<P><h3>SYSCON.EXE</h3>
 
<P>
<PRE>Usage:    SYSCON
</PRE></OL>This is a menu driven utility.
<P>
SYSCON (short for SYStem CONfiguration) performs most of the system
management functions. Some of the pertinent options are:
<P>
File Server Information:
<PRE>   Allows the viewing of the NetWare versions, revision numbers and
   number of licenses for any on-line Novell server on the network.

</PRE>Supervisor Options:
<PRE>   Contains several functions, including view/edit system AUTOEXEC
   file (to see which modules are being loaded on the server) and
   view the file server's error log.

</PRE>User Information:
<PRE>   Contains all users accounts and associated information, such as
   - Account restrictions (when does the account and/or password expire?).
   - Groups Belonged to (default = EVERYONE).
   - Other Information (last login date/time, disk space in use).
   - Security Equivalencies (either to a group or another user).
   - Station Restrictions (limits the user to logging on from
     only the specified MAC address or addresses).
   - Time Restrictions (time interval specified for allowed logins).
   - Trustee Directory Assignments (access privileges to specified
     directories).
   - Volume/Disk Restrictions (limits the amount of disk space the
     user can actually fill on a volume).

</PRE><h3>USERLIST.EXE</h3>
 
<P>
<PRE>Usage:    USERLIST [fileserver/][name] [/Address | /Object] [Continuous]
</PRE>Example:  USERLIST MAILSRV/ /A
<P>
Displays all currently logged on users on the Novell file server MAILSRV,
as well as each node address and login time. You must be currently logged
on or attached to the server you wish to run USERLIST on. If you do not
specify a server name, USERLIST will default to the server you are
currently logged on to and running the USERLIST utility from.
<P>
Novell is a vendor independent of Microsoft; we make no warranty, implied
or otherwise, regarding this product's performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20 3.20a 3.50<BR>
KBCategory: kb3rdparty<BR>
KBSubcategory: MailPCGen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 4, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
