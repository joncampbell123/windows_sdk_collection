

<HTML>
<HEAD>
<TITLE>PC Win: Mail for Windows MSSFS.DLL 3.2.0.4084 Update </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96694 ">
<META NAME="KBModify" CONTENT="1996/07/29">
<META NAME="KBCreate" CONTENT="1993/03/24">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty kbusage kbfile kbtlc kbbug3.20 kbbug3.20a kbfix3.">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Microsoft provides a replacement for the MSSFS.DLL file that is included with versions 3.0b and 3.2 of Microsoft Mail for Windows. The replacement file provides additional enhancements to the original MSSFS.DLL file.  For complete information about...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QDL9,QBWQ,QBWO,QBWN,QAXB,QAEV,QAY2,QAJQ,QBD2,QAC1,QACE,QAA1,QAFI,QAVZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Win: Mail for Windows MSSFS.DLL 3.2.0.4084 Update</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96694 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for Windows, versions 3.0b, 3.2, and 3.2a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft provides a replacement for the MSSFS.DLL file that is included
with versions 3.0b and 3.2 of Microsoft Mail for Windows. The replacement
file provides additional enhancements to the original MSSFS.DLL file.
<P>
For complete information about obtaining and installing the MSSFS.DLL file,
see the following sections:

<UL><LI>To download the updated file
<LI>To replace your MSSFS.DLL file
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This replacement file resolves the following problems that can occur when
you use version 3.0b of Microsoft Mail for Windows:

<UL><LI>When you send mail to an external postoffice group or gateway group
   that contains extended characters in the address, Mail for Windows
   does not convert from code page 850 to the ANSI code page when it
   reads the records from the NETPO.GLB file or any other gateway
   address file.

<LI>External postoffices, SNADS DGNs, and nodes for PROFS and
   OfficeVision are not displayed in alphabetic order because Mail
   for Windows reads them in one at a time and adds them to the
   hierarchy. With the updated version of MSSFS.DLL, Mail for Windows
   reads them in all at once, sorts them, and adds them to the
   hierarchy.

<LI>An "Unknown user" error may occur when you send a message. Mail for
   Windows caches only the first 8170 bytes of the NETWORK.GLB file
   and loses the rest. Postoffices and gateways that are defined past
   8170 bytes are ignored; therefore, you cannot send messages to the
   users on those postoffices or gateways.

<LI>The simple MAPI command MAPILogon() does a case-sensitive match on
   the user name and password; however, Microsoft Mail is not case
   sensitive. This problem occurs only if a MAPI session was already
   established when MAPILogon() is called.

<LI>Incorrect message dates are displayed. When parsing old A.M./P.M.
   style dates (generated from some gateways), Mail for Windows adds
   12 to the time if it is P.M. However, if the message was sent
   during the noon hour, the time is incorrectly read as 24:xx.
   Because this is an invalid time, the date is set to the
   programmer's birthday (12/16/68).

<LI>Mail for Windows may cause a general protection (GP) fault when it
   encounters a corrupt .XTN file in the database. It does not
   properly handle .XTN files that are an incorrect size.
<P>
</UL>This replacement file also resolves the following problems that can
occur when you use version 3.0b or 3.2 of Microsoft Mail for Windows:

<UL><LI>Mail for Windows cannot view templates of SNADS or PROFS users when
   GALONLY=1 is set in the MSMAIL.INI file.

<LI>When you read a custom message from a shared folder, the wrong date
   is displayed.

<LI>In version 3.0b of Mail for Windows, the time stamp associated with
   resolved addresses is not saved correctly: if the Global Address
   List (GAL) was built twice in the same day, any mail addressed but
   not sent before the second rebuild could be misdirected. This
   problem was partially corrected in version 3.2 of Mail for Windows:
   the time stamp is saved correctly, thus reducing the time frame in
   which this problem could occur from one day to one clock hour.
   However, mail may still be misdirected at sites where GAL rebuilds
   are made within the same clock hour.

<LI>All users running Windows from a shared installation point must use
   the same postoffice when they use Advanced Security. This problem
   occurs because the MAIL.DAT file is saved to the Windows SYSTEM
   subdirectory, which is shared among all users running Windows from
   the same location. The client now checks both the WINDOWS (user's
   local directory) and WINDOWS\SYSTEM directories, in that order, for
   the MAIL.DAT file.
<P>
   NOTE: To resolve this problem when you are installing Mail for
   Windows, two files must be updated: the MSSFS.DLL file (included
   with this update) and the SETUP.EXE file (update included in
   SETUPD.EXE on the MSL).

<LI>Duplicate addresses are added to the Personal Address Book (PAB).
<P>
   NOTE: To resolve this problem, two .DLL files must be updated: the
   MSSFS.DLL file (included with this update) and the PABNSP.DLL file
   (update included in PABNSP.EXE on the MSL).

<LI>If users are running Mail for Windows from a shared installation
   point and the NETBIOS=1 flag is set in the MSMAIL.INI file, Mail
   checks the size, date, and time of the MSMAIL.INI file every 5
   seconds. Because the .INI file is on the network, frames are sent
   to the server to check the size of the file every 5 seconds, thus
   increasing traffic on the network. These checks no longer occur
   with this update.

<LI>When an urgent message is sent to an external user with NetBIOS
   notification in use, Mail for Windows does not send a NetBIOS
   datagram to the External Mail program. This process does work
   correctly when an urgent message is sent to a local user. When
   sending urgent messages, Mail for Windows now sends notifications
   to the External Mail program when NetBIOS notification is in use.

<LI>MACBinary II attachments are not recognized when originating from
   external Mail Systems.

<LI>When sending mail such that the number of recipients is greater
   than 200 (exact number depends on the specific address list), the
   body of the message will be missing.

<LI>When Add Recipients to Personal Address Book is selected, the
   GAL.NME file is locked open each time a global address list (GAL)
<P><PRE>    name is added to a compose note.
</PRE>
<LI>In certain situations, viewing details of an external name from a
   group results in the error message:
<P>
<P><PRE>      A GLB file on your server is corrupt.
</PRE>
<LI>If a message has more than 22 recipients selected from the GAL and
   that message is stored in a shared folder, the message appears to
   be corrupted. Attempting to open the message from the shared folder
   results in the error:
<P>
<P><PRE>      Mail system error, Mail could not read the entire message from
      the Post Office. Some parts of the message may be missing.
      Ask the sender to resend the message.
</PRE>
<LI>Under certain conditions, a general protection (GP) fault can occur
   in MSSFS.DLL when the MAPILogon() function is used to begin a
   session with the messaging system.

<LI>The Check Names function fails to properly resolve partial friendly
   names and returns several selections when a unique resolution is
   possible. This behavior is most obvious when the GAL is selected as
   the default address list and the first and last name of the
   intended recipient begin with the same letter.
<P>
   NOTE: To resolve this problem, two .DLL files must be updated: the
   MSSFS.DLL file (this update) and the MAILMGR.DLL file (update included
   in MAILMGR.EXE on the MSL).
<P>
</UL>This replacement file also resolves the following problems that can occur
when you use version 3.0b, 3.2, or 3.2a of Microsoft Mail for Windows:

<UL><LI>The Windows client stops responding when it receives a message with an
   invalid time; that is, a time greater than 23 hours.

<LI>Templates that were created with extended characters will lose their
   extended characters when they are exported to other postoffices.

<LI>The Windows client cannot display a template field of zero length. These
   are display fields only and cannot be modified.

<LI>Custom forms that did not include their own textize maps could not
   use the provided default print/save functionality.
<P>
   NOTE: To fix this problem, MAPI.DLL version 3.2.4081 (available as
   MAPIUPD.EXE on the MSL) MUST be used with this MSSFS.DLL.

<LI>When you have more than one friendly name for the same PROFS userid,
   and you attempt to get details from the GAL in the Windows client,
   incorrect information is displayed.

<LI>When you add multiple users from the GAL with the same friendly name
   to the PAB or to Personal Groups, only the first entry gets added.
   No errors are reported.
<P>
</UL><h3>To download the updated file</h3>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/mssfs.exe">MSSFS.EXE</A> <I>(size: 154730 bytes)</I> 
                      , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/mssfs.exe">MSSFS.EXE</A> <I>(size: 154730 bytes)</I> 
                            , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/mssfs.exe">MSSFS.EXE</A> <I>(size: 154730 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location.
      Type "mssupport" (without the quotation marks).
      Double-click the MS Software Library icon.
      Find the appropriate product area.
      Locate and Download MSSFS.EXE.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/mssfs.exe">MSSFS.EXE</A> <I>(size: 154730 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>After you download MSSFS.EXE to a clean directory, double-click it to
extract the contents of the file. You should receive the following
files:
<P>
<PRE>   MSSFS.DLL (266,848 bytes, dated 04-04-95, 9:54 P.M.)
   README.TXT

</PRE><h3>To replace your MSSFS.DLL file</h3>
 

<OL><P><LI>At the MS-DOS command prompt, type the following and press ENTER:
<P>
<P><PRE>      copy mssfs.dll &lt;destination&gt;
</PRE><P>
   where &lt;destination&gt; is the drive and directory where your MSSFS.DLL
   file currently resides. For example, if MSSFS.DLL is located in the
   MAILEXE directory on drive C and you ran the self-extracting file from
   the TEST directory on drive D, type the following command:
<P>
<P><PRE>      copy d:\test\mssfs.dll c:\mailexe
</PRE>
<P><LI>At the MS-DOS command prompt, type the following and press ENTER
<P>
<P><PRE>      copy &lt;mailexe&gt;\setup.inf &lt;mailexe&gt;\setupinf.old
</PRE><P>
   where &lt;mailexe&gt; is the complete path to the directory containing
   the Microsoft Mail for Windows SETUP.EXE program. For example, if
   SETUP.EXE is located in the MAILEXE directory on drive C, type the
   following command:
<P>
<P><PRE>      copy c:\mailexe\setup.inf c:\mailexe\setupinf.old
</PRE>
<P><LI>Using any text editor, edit the SETUP.INF file. In the [MSMAIL]
   section, replace the following line
<P>
<P><PRE>      1, mssfs.dll,,,, 1994-11-18, !DECOMPRESS,, OLDER, !READONLY,,,,,
      SHARED, 266752,,,, 3.2.0.4079,
</PRE><P>
   with:
<P>
<P><PRE>      1, mssfs.dll,,,, 1995-04-04, !DECOMPRESS,, OLDER, !READONLY,,,,,
      SHARED, 266848,,,, 3.2.0.4084,
</PRE><P>
   Save the file and close the text editor.
<P>
   NOTE: For these changes to affect the entire network, each existing
   user must run Setup again.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b 3.20 wga<BR>
KBCategory: kbnetwork kb3rdparty kbusage kbfile kbtlc kbbug3.00b kbbug3.20<BR>
kbbug3.20a kbfix3.50<BR>
KBSubCategory: MailPCWin<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
