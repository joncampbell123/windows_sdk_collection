

<HTML>
<HEAD>
<TITLE>PC Adm: Rebuilding the Postoffice Address List </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125252">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1995/01/23">
<META NAME="Keywords" CONTENT="MailPCAdm kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  This article describes how to rebuild a Microsoft Mail Postoffice Address List (POL). This may be necessary when the Postoffice Address List is corrupt and cannot be repaired by other means.  This article requires the Microsoft Mail Database Mainte...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALZ,QABO,QAE1,QAFI,QASR,QAC2,QBSU,QBWS,QAYC,QAFZ,QAJH,QBDM,QAY2,QAH4,QAGR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Adm: Rebuilding the Postoffice Address List</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125252</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.10 3.00 3.20
MS-DOS
kbenv
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 2.1, 3.0, and 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to rebuild a Microsoft Mail Postoffice Address
List (POL). This may be necessary when the Postoffice Address List is
corrupt and cannot be repaired by other means.
<P>
This article requires the Microsoft Mail Database Maintenance Utilities
Application Note, WA0641, which contains utilities used to repair and
maintain the database for Microsoft Mail for PC Networks. The procedures
described in the Application Note apply to versions 2.1 and later of
Microsoft Mail, except where noted.
<P>
To obtain this Application Note in the United States, call Microsoft
Product Support Services at (206) 635-7022 or (900) 555-2100. Outside the
United States, contact the Microsoft subsidiary for your area. To locate
your subsidiary, call Microsoft International Customer Service at (206)
936-8661.  It is also located at:
<PRE>      
         ftp.microsoft.com/bussys/mail/pcmail-public/wa0641

</PRE><h2>MORE INFORMATION</h2>
 
<P>
NOTE: The resetting of group files can be automated. For additional
information, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q129500.htm">Q129500</A></B>
   TITLE     : Automating the Resetting of Group Files using GIMPORT

</PRE>Following are the steps to rebuild the Post Office List.  The steps
assume that all of the programs are run from the same directory(except
ACCTONME.EXE, which must be run from the root of the Post Office).
Also, the steps assume that the M:\ drive is mapped to the affected
Post Office.
<P>
<PRE>  1. Backup your complete Mail postoffice. You do not need to backup
     the MMF directory.

     It is recommended that the following steps be done when there are no
     users logged in or instances of the EXTERNAL.EXE program working
     against your production postoffice, and no changes are made to the
     production postoffice via the ADMIN.EXE program.
 
     The following steps make use of two programs: GIMPORT.EXE and
     ACCTONME.EXE. These programs are part of the Database Maintenance
     Utilities Application Note. Please read the documentation for both of
     these utilities before proceeding. The documentation is part of the
     Application Note.  Also, if GIMPORT.EXE is run from a directory, 
     which contains GROUPS.TXT or GRPUSERS.DAT, remove those files.

  2. GIMPORT ADMIN -Ppassword -Ddrive -FGROUPS.TXT -I -X -Q -LGIMPORT.LOG

     - This will extract group information to two files(GROUPS.TXT and
       GRPUSERS.DAT) to the current directory.

  3. GIMPORT ADMIN -Ppassword -Ddrive -R

     - This will reset the ADMIN.GRP and ADMINSHD.GRP to 8 bytes and GROUP.GLB
       and GRPMEM.GLB to 4 byte files.

  4. REN M:\NME\ADMIN.NME M:\NME\ADMIN.BAK

     - This will backup the Post Office List.

  5. TYPE NUL &gt; M:\NME\ADMIN.NME

     - This will create an empty Post Office List.

  6. ACCTONME.EXE

     - Run this from the root of the PO, so that it sees all 19 Post
       Office subdirectories.  This will create a new version of the
       Post Office List based on information in the local mail accounts
       files(ACCESS*.GLB).

  7. COPY M:\NME\ADMIN.NME M:\NME\ADMINSHD.NME

     - This will copy the Post Office List to its shadow file.

  8. IMPORT ADMIN -Ddrive -Ppassword -FGRPUSERS.DAT -A

     - This will add the extracted external user information
       from the file GRPUSERS.DAT, which was created in the
       second step, back into the Post Office List.

  9. GIMPORT ADMIN -Ddrive -Ppassword -FGROUPS.TXT -LGIMPORT.LOG -V

     - This will add the extracted group information from
       the file GROUPS.TXT, which was created in the second
       step, back into the Post Office List.

  10. Groups on the affected PO must be modified to participate in
      dirsync, regardless of former participation.  This can be done
      by running the Mail Administrator program, selecting the Local
      Admin - Groups - Modify command and selecting Enter through
      each prompt until asked, "Include in group in Directory
      Synchronization?".  Select "Yes".  In order for the Global
      Address List to reflect changes made to the Post Office List,
      REBUILD.EXE -F -Ddrive must be run.  In order for remote users
      to see updated address lists, run ADMIN.EXE and select the
      Remote - Regenerate command.  Remote users must then update
      their address lists.

 </PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.10 3.00 3.20 saving restoring groups pol corrupt<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCAdm<BR>
Keywords          : MailPCAdm kbenv<BR>
Version           : 2.10 3.00 3.20<BR>
Platform          : MS-DOS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
