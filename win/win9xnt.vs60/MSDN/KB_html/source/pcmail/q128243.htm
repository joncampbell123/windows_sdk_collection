

<HTML>
<HEAD>
<TITLE>PC Win: GP Fault with Corrupt .XTN Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128243">
<META NAME="KBModify" CONTENT="1995/10/17">
<META NAME="KBCreate" CONTENT="1995/03/28">
<META NAME="Keywords" CONTENT="kbenv kbbug3.00">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Version 3.0 of Mail for Windows will general protection (GP) fault when you check for new mail or view new messages.  CAUSE =====  This can be caused by irregular .XTN file sizes. If you check the .XTN files to see if they are divide into 698 evenl...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QAKC,QBC6,QA5V,QAEF,QAG8,QAVZ,QAVX,QAHT,QABH,QABI,QAKP,QAYC,QBCT,QAY4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Win: GP Fault with Corrupt .XTN Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128243</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for Windows, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Version 3.0 of Mail for Windows will general protection (GP) fault when you
check for new mail or view new messages.
<P>
<P><h2>CAUSE</h2>
 
<P>
This can be caused by irregular .XTN file sizes. If you check the .XTN
files to see if they are divide into 698 evenly, you can tell if that is
the problem.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This problem is fixed by version 3.06 of IMPORT.EXE and MSSFS.DLL
with a date of 5/9/93 or later.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
All .XTN files should be divisible by 698 into even number. Older versions
of IMPORT.EXE will add extra bytes to end of file. You can use the RCX
command in debug to remove the extra few bytes and make it a number that
divides into 698 evenly. Here are the steps to debug the file:

<OL><P><LI>Identify the problem .XTN. The size of a valid .XTN file
   should be a multiple of 698 bytes.

<P><LI>TYPE NETWORK.GLB in the GLB subdirectory. To the left
   of the 8 digit .XTN file number you will see the Network
   Name for this file.
<P>
</OL>NOTE: At this point you could ignore the rest of the steps and use
ADMIN.EXE to delete and redefine the network that the problem .XTN belongs
to. This means you will also have to redefine all of the external
Postoffices defined on that network.

<OL><P><LI>Using Admin, count the number of external postoffices defined for this
   network name. This will give us a rough approximation of what the file
   size should be. #Postoffices * 698 approximately equals the size of
   the .XTN file.
<P>
</OL>NOTE: The actual size of  the file may be larger by a multiple of
698 since there may be deleted records in the .XTN file.  The only
accurate way to determine the contents of the XTN is to edit the
.XTN file with debug and reset the file size to include all records
up to and including the last record that is not marked as deleted.

<OL><P><LI>Using Debug, reset the file size of the problem .XTN file.  The
</OL>cases that have been seen thus far where additional information has
been appended to the file were calculated by the following formula
to get the actual .XTN file size:
<P>
(Current Size div by 698)
example: (3015 div 698)
<PRE> = 4.3194842 (Where it should divide out to 4)
</PRE></OL>Take 4 x 698=2792
This number has to be converted to HEX
<P>
Debug ????????.XTN
-RCX
:BC7 &lt;-This is the current file size
-AE8 &lt;-This is the number that you calculated as the correct size
-W
-Q
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCWin<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
