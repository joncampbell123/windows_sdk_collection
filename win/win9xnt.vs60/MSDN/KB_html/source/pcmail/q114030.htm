

<HTML>
<HEAD>
<TITLE>PC WRmt: AT&amp;T Credit Card Calling Modem Script </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114030">
<META NAME="KBModify" CONTENT="1994/10/31">
<META NAME="KBCreate" CONTENT="1994/04/24">
<META NAME="Keywords" CONTENT="kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT=" Version 3.2 of Microsoft Mail Remote for Windows allows you to use a credit card modem script to place a call via the AT*T phone system and credit any charges to the AT*T credit card. Below is the CALL section of the script. To use this script, copy...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXJ,QDNQ,QAKC,QDL4,QAGI,QBC6,QAI5,QAUD,QAFR,QAG8,QAS6,QAAZ,QBEG,QBXE,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC WRmt: AT&amp;T Credit Card Calling Modem Script</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 31, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114030</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail Remote for Windows, version 3.2
</UL> 
<P>
Version 3.2 of Microsoft Mail Remote for Windows allows you to use a credit
card modem script to place a call via the AT&amp;T phone system and credit any
charges to the AT&amp;T credit card. Below is the CALL section of the script.
To use this script, copy the information between the BEGIN HERE and STOP
HERE comments and paste it into the same part of the script for the modem
you are using.
<P>
; BEGIN HERE
<P>
<PRE>     $ret = 8               ; Set default ret code to "no answer"

     clearrsp               ; Clear the response buffer

     echo 0                 ; Do not display phone number

</PRE>; If this script is specified in the phone number field, the
; initialize script in the default script file may have turned off the
; speaker. The following commands will turn the speaker back on for
; Hayes compatible modems:
;
<PRE>     sendln "ATM1"           ; Turn speaker on
     waitrsp 1               ; Get the response back from the modem

</PRE>; In order to make credit card dialing work, the modem being used must
; support the ";" dial modifier. This character returns the modem to
; command state after the dial string is sent, allowing us to proceed
; with further processing. The operator is prompted to press a key.
; When he does, send another dial string. This time the dial string is
; the credit card number.
; Remember that the phone number must be in the form:
<PRE>;               0 - area code - number

     ; Standard number to call to get into AT&amp;T
     sendln "ATD" + dial_mode + "9,10-288-0" + ";"

     wait 2

     ; ### = phone number to call, should be EXTERNAL.EXE
     sendln "ATD" + dial_mode + "###-###-####" + ";"

     echo 1                 ; Turn echo back on

     display 'Press any key when you hear the "bong"...'


</PRE>; Wait until a key is struck
operator_wait_loop:
<PRE>     getkey
     if (key = 0)
       goto operator_wait_loop


</PRE>; Now send the credit card number. You will have to replace the number
; used here with your credit card number.
<P>
<PRE>     ; Do not display credit card number
     echo 0

     ; Send the AT&amp;T credit card number
     sendln "ATD" + dial_mode + "$$$-$$$-$$$$-$$$$"

     ; Turn echo back on
     echo 1

     ; Should get "OK" from modem
     waitrsp 2
     if (response != "0^M")
       return $ret

     ; Wait until the modem responds (max 2 minutes)
      waitrsp 120

</PRE>; STOP HERE
<P>
; The section that follows is specific to the modem used. For example,
; this section is from the Multitec modem script, MULTITEC.MDM:
<P>
<PRE>        if ("12" isin response)
          {
          display "&gt;&gt;&gt; CONNECT 9600 &lt;&lt;&lt;"
          $ret = 12
          }
        else if ("11" isin response)
          {
          display "&gt;&gt;&gt; CONNECT 4800 &lt;&lt;&lt;"
          $ret = 11
          }
        else if ("10" isin response)
          {
          display "&gt;&gt;&gt; CONNECT 2400 &lt;&lt;&lt;"
          $ret = 10
          }
        else if ("7" isin response)
          {
          display "&gt;&gt;&gt; BUSY &lt;&lt;&lt;"
          $ret = 7             ; busy
          }
        else if ("5" isin response)
          {
          display "&gt;&gt;&gt; CONNECT 1200 &lt;&lt;&lt;"
          $ret = 5
          }
        else if ("3" isin response)
          {
          display "&gt;&gt;&gt; NO CARRIER &lt;&lt;&lt;"
          $ret = 8             ; no answer or no connect
          }
        else if ("1" isin response)
          {
          display "&gt;&gt;&gt; CONNECT 300 &lt;&lt;&lt;"
          $ret = 1
          }


        if ("R" isin response)
          display "&gt;&gt;&gt; MNP RELIABLE CONNECTION &lt;&lt;&lt;"

        if ("L" isin response)
          display "&gt;&gt;&gt; LAPM RELIABLE CONNECTION &lt;&lt;&lt;"

        if ("C" isin response)
          display "&gt;&gt;&gt; DATA COMPRESSION ENABLED &lt;&lt;&lt;"


        return $ret            ; return connect baud rate to application
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20<BR>
KBCategory: kb3rdparty<BR>
KBSubCategory: MailPCWRmt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 31, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
