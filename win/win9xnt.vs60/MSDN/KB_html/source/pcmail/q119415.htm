

<HTML>
<HEAD>
<TITLE>PC WRmt: How the System Selector Works </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119415">
<META NAME="KBModify" CONTENT="1994/10/31">
<META NAME="KBCreate" CONTENT="1994/08/15">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  The Mail System Selector (MAILDRV.EXE) is a program provided with version 3.2 of Microsoft Mail Remote for Windows. In Windows, the user selects the Mail System Selector icon to switch to a different mail service, such as AT*T. These mail services ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAU9,QDL9,QBWQ,QBWO,QBWN,QBWB,QAEF,QA0B,QA9N,QANJ,QAGU,QAA1,QASC,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC WRmt: How the System Selector Works</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 31, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119415</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail Remote for Windows, version 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Mail System Selector (MAILDRV.EXE) is a program provided with version
3.2 of Microsoft Mail Remote for Windows. In Windows, the user selects the
Mail System Selector icon to switch to a different mail service, such as
AT&amp;T. These mail services are called drivers in the program. You can also
use this program to remove a driver you no longer use.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
What Happens When the User Changes the Current Mail Driver?

<OL><P><LI>The System Selector determines whether any of the mail driver
   DLLs are currently loaded, by examining the entries in the
   [Providers] section of the user's MSMAIL.INI.
<P>
   The System Selector interprets the entries in the [Providers]
   section as module names for driver DLLs. If one or more DLLs are
   loaded, the System Selector assumes a mail-enabled application
   is running.

<P><LI>If a mail-enabled application is running, the System Selector
   asks you if you want to sign out immediately.
<P>
   After your confirmation, the System Selector attempts to sign
   you out. This may fail in some cases if, for example, Mail
   or Schedule+ are displaying  modal dialogs. If sign-out fails,
   the System Selector tells the you that they must be signed off
   before changing the mail driver, and then it displays the main
   dialog.

<P><LI>The System Selector deactivates the current mail driver.
<P>
</OL>NOTE: In this section of the README file, PROVIDER is a placeholder
for the specific mail driver subdirectory name. For example, the
driver subdirectory for Microsoft Mail is \WINDOWS\MSMAIL\MSMAIL.)
<P>
<PRE>   a. If DEACTIVATE= is defined in \WINDOWS\MSMAIL\PROVIDER\FILES.INI,
      the named DLL is loaded and functions in it are called so that
      specific environment changes can be properly cleaned up after
      the provider has run.

   b. Entries are removed from the user's .INI files as follows:

      The INI= entry in the [Transport] section of the
      WINDOWS\MSMAIL\PROVIDER\FILES.INI file determines which .INI
      files will be modified. If this entry is missing, only
      MSMAIL.INI will be modified. The [XXX - Deactivate] sections
      of the .INI files in the WINDOWS\MSMAIL\PROVIDER list which
      entries will be removed from the user's .INI files.

   c. The mail driver's DLLs and other files are returned to
      WINDOWS\MSMAIL\PROVIDER. The Files= entry of the [Transport]
      section in FILES.INI lists which files will be moved.

</PRE><P><LI>The System Selector activates the selected new driver.
<P>
   a. The mail driver's DLLs and other files are moved from
<P><PRE>      WINDOWS\MSMAIL\PROVIDER to WINDOWS\SYSTEM. The new
      driver's FILES.INI file list which files will be moved.
</PRE><P>
   b. Entries are merged into the user's .INI files. The INI= entry
<P><PRE>      in the [Transport] section of WINDOWS\MSMAIL\PROVIDER\FILES.INI
      determines which .INI files will be modified. If this entry is
      missing, only MSMAIL.INI will be modified.
</PRE><P>
<P><PRE>      Sections that do NOT have the " - Deactivate" string as part
      of the section name list which entries will be added.
</PRE><P>
   c. If ACTIVATE= is defined in WINDOWS\MSMAIL\PROVIDER\FILES.INI,
<P><PRE>      the named DLL is loaded and functions in it are called so that
      specific environment changes can be properly set up by the
      provider.
</PRE>
<P><LI>The System Selector updates its display and the contents of
   MSMAILPV.INI to reflect the switch.
<P>
   If there is a failure anywhere along the way, the System
   Selector backs out changes by first undoing whatever steps were
   taken in the activation step, and then re-activating the original
   driver.
<P>
</OL>Please see SWITCHER.TXT for additional information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20<BR>
KBCategory: kbtool<BR>
KBSubCategory: MailPCWRmt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 31, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
