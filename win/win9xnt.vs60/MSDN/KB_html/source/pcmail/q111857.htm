

<HTML>
<HEAD>
<TITLE>SMTP: Missing Attachment Name in Client when Using PMDF Mailer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111857">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1994/02/22">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVV,QA5T,QAF8,QBXT,QA5V,QAY2,QAIB,QAF4,QAYC,QDH9,QAFI,QBCF,QA4S,QA4R,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMTP: Missing Attachment Name in Client when Using PMDF Mailer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111857</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MS-DOS
kb3rdparty
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Upon opening an attachment of a message from SMTP, the attachment name may
not be found if the TCP/IP mail routing host used a PMDF mailer. The
attachment itself is not lost, and is viewable.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem is in the RFC 822 header fields, and the order in which they
appear. When using the PMDF mailer on the TCP/IP mail routing host, the
"X-MS-Attachment" header line is re-ordered to appear before the "Encoding"
header line. The SMTP gateway uses the "Encoding" header to build up a
link list to describe the attachments and then fills in the file attributes
later when it parses the "X-MS-Attachment" lines. If these two lines appear
in the wrong order, the link list does not exist when the "X-MS-Attachment"
header lines are being parsed. The gateway then ignores these lines, losing
the names of any attachments.
<P>
Looking at a log file generated by starting the SMTP gateway with the
"-cd" and "-lacsy" switches, the incorrect header fields appear as:
<P>
13:22:41 - Sending message to Microsoft Mail
13:22:42 - Header: Return-Path: &lt;root@company.com&gt;
13:22:42 - Header: Received: from company.com by smtp-gateway.company.com
13:22:42 - Header: id &lt;2C431991@smtp-gateway.company.com&gt;; Tue, 13
Jul 93 13:22:41 PDT
13:22:42 - Header: Date: Tue, 13 Jul 1993 13:22:00 -0700 (PDT)
13:22:42 - Header: From: Root &lt;root@company.com&gt;
13:22:42 - Header: Subject: Testing word attachment thru SMTPgate
13:22:42 - Header: To: "ROOT (COMPANY)" &lt;root@company.oom&gt;
13:22:42 - Header: X-Mailer: Microsoft Mail V3.0
13:22:42 - Header: X-MS-Attachment: smtptest.doc 1024 07-13-1993 13:20
13:22:42 - Header: Encoding: 2 TEXT, 29 UUENCODE
13:22:42 - Header:
<P>
A correct set of headers should look like this:
<P>
13:22:41 - Sending message to Microsoft Mail
13:22:42 - Header: Return-Path: &lt;root@company.com&gt;
13:22:42 - Header: Received: from company.com by smtp-gateway.company.com
13:22:42 - Header: id &lt;2C431991@smtp-gateway.company.com&gt;; Tue, 13
Jul 93 13:22:41 PDT
13:22:42 - Header: Date: Tue, 13 Jul 1993 13:22:00 -0700 (PDT)
13:22:42 - Header: From: Root &lt;root@company.com&gt;
13:22:42 - Header: Subject: Testing word attachment thru SMTPgate
13:22:42 - Header: To: "ROOT (COMPANY)" &lt;root@company.oom&gt;
13:22:42 - Header: X-Mailer: Microsoft Mail V3.0
13:22:42 - Header: Encoding: 2 TEXT, 29 UUENCODE
13:22:42 - Header: X-MS-Attachment: smtptest.doc 1024 07-13-1993 13:20
13:22:42 - Header:
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Obtain the latest version of PMDF, from Innosoft. The latest version
no longer re-orders the headers.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 attachment pmdf SMTP<BR>
KBCategory: kb3rdparty<BR>
KBSubcategory: MailGWSMTP<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
