

<HTML>
<HEAD>
<TITLE>PC Mac: Cannot See Postoffice on Pathworks Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103199">
<META NAME="KBModify" CONTENT="1995/10/23">
<META NAME="KBCreate" CONTENT="1993/08/18">
<META NAME="Keywords" CONTENT="kb3rdparty kbenv kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  After installing the Macintosh workstation, the user is not able to select the Mail postoffice when the postoffice database files are on a Pathworks server.  The most common symptom of this is when the user sees all the folders (directories) that c...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO9,QAGX,QAFI,QBXB,QATJ,QDIR,QA2S,QARL,QAKP,QAYC,QBVV,QA4B,QABI,QAJG,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Mac: Cannot See Postoffice on Pathworks Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103199</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, Macintosh Workstation, versions 3.0
   and 3.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After installing the Macintosh workstation, the user is not able to
select the Mail postoffice when the postoffice database files are on a
Pathworks server.
<P>
The most common symptom of this is when the user sees all the folders
(directories) that comprise the postoffice, and sees the files within
the folders, but the Macintosh client cannot find the postoffice.
<P>
Usually, when the Macintosh client is first installed, a dialog box
appears with the following text:
<P>
<PRE>   The Preferences file could not be found.
   Where is your postoffice located?

</PRE>Selecting "Find PO" lets the user search for the postoffice data files.
After selecting the drive and the folder where the postoffice data files
are located, the Macintosh client responds with:
<P>
<PRE>   Select &lt;postoffice name&gt;?

</PRE>With the postoffice on the Pathworks server, the Macintosh client may
not recognize the folder with the postoffice as a valid Mail
postoffice, and the dialog box for selecting a drive and the folders
remains active.
<P>
<P><h2>CAUSE</h2>
 
<P>
The README.TXT file on the version 3.0 of Mail for PC Networks Server
disk (paragraph B.5) states the following:
<P>
<PRE>   Using a Non-PC-based Network Operating System

   The Macintosh client assumes that the file path to the postoffice is
   either all uppercase or all lowercase letters. If your network
   operating system uses pathnames that are case sensitive (such as DEC
   Pathworks or NFS), make sure that for the Macintosh client, the path
   to the postoffice does not contain a mixture of uppercase and
   lowercase letters.

</PRE>Another possible difficulty when using a non-PC-based network
operating system is automatic file translation from PC text format to
Macintosh text format by the operating system. File translation must
not occur for any postoffice data file.
<P>
To confirm the problem is in the configuration of the Pathworks
server, verify the following:

<OL><P><LI>The Macintosh can mount the Pathworks share that contains the
   postoffice data files.

<P><LI>The Macintosh views all directory and filenames in UPPERCASE.
   Lowercase or mixed case names are incorrect.

<P><LI>The Macintosh can Get Info on the MASTER.GLB file, and this file's
   size is 176 bytes. If the file is 174 bytes, then invalid file
   translation is occurring.

<P><LI>A file can be copied from the Macintosh to the postoffice directory,
   and this file, when checked at the MS-DOS level, has the same size
   and date stamp that correspond to the Macintosh's Get Info on this
   file. If MS-DOS reports the file as 0 bytes, no date/time stamp, then
   the permissions for the PC are incorrect.
<P>
</OL>If any of these steps fail, then the Pathworks server will need to be
reconfigured.
<P>
NOTE: For more information regarding problem 1 listed above, please
consult your Pathworks manual for Macintosh connectivity.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To reconfigure the Pathworks server for problems 2, 3, and 4, it will
be necessary to do the following:

<UL><LI>Change a filename conversion and the file translation control file.
<P>
   -and-

<LI>Change the permissions for the clients.
<P>
</UL>If the postoffice directories and files are already on the Pathworks
server, then they will need to be copied to an MS-DOS drive and
deleted from the Pathworks server. This is because the changes to the
filename conversion and the translations only affect new files, not
existing files on the Pathworks server.
<P>
<P>
<P><h3>To Change the Filename Conversion (Problem 2)</h3>
 
<P>
The DCL command required to define the filename conversion logical is:
<P>
DEFINE/SYS/EXEC MSAF$SERVER_VMS_NAME_CONVERSION "rule1, rule2"
<P>
Values for rule1:
<P>
<PRE>LOWERCASE     Filename is converted to all lowercase.

MIXEDCASE     Filename is converted to mixed case. First letter
              of each word is capitalized and the remaining letters
              display in lowercase.

UPPERCASE     Filename is converted to uppercase.

</PRE></OL>Values for rule2:
<P>
<PRE>SPACES         Underscores are replaced with spaces.

UNDERSCORES    Underscores are displayed as underscores.

</PRE>Mail for PC Networks, Macintosh client, and version 1.0b of Microsoft
Mail Connection Gateway both require all uppercase and underscores in
the names of the files that they access. The correct logical
definition for this is:
<P>
DEFINE/SYS/EXEC MSAF$SERVER_VMS_NAME_CONVERSION "UPPERCASE,UNDERSCORES"
<P>
<P><h3>For Invalid File Translation (Problem 3)</h3>
 
<P>
The FILE_TYPES.DAT file in the SYS$COMMON:[MSA] directory on the VAX
running Pathworks needs to be edited. The file is a text file and any
text editor can modify it. The file translations defined in
FILE_TYPES.DAT are position-sensitive, meaning only the first
translation that matches the MS-DOS extension is used. The
translations for the postoffice files should, therefore, be placed as
close to the beginning of the file as possible.
<P>
NOTE: MICROSOFT CANNOT ASSIST IN PROBLEMS WITH MODIFICATION TO THE
FILE_TYPES.DAT FILE. It is up to the Administrator to rectify any
problems on the Pathworks Server. If there is a problem with
modification to the file, please refer to your Pathworks support
provider.
<P>
Each file extension used in the Microsoft Mail database must be
defined in the MSAF$FILE_TYPES.DAT file; thus, the entries in the
MSAF$FILE_TYPES.DAT file for the Mail postoffice must look like this:
<P>
<PRE>!Format   Attr   Semantic   "EXT"    Creator   Type    Translation

*         *      *           ATT     mdos      BINA    none
*         *      *           GLB     mdos      BINA    none
*         *      *           GRP     mdos      BINA    none
*         *      *           HLP     mdos      BINA    none
*         *      *           INF     mdos      BINA    none
*         *      *           IDX     mdos      BINA    none
*         *      *           KEY     mdos      BINA    none
*         *      *           MAI     mdos      BINA    none
*         *      *           MBG     mdos      BINA    none
*         *      *           MEM     mdos      BINA    none
*         *      *           NME     mdos      BINA    none
*         *      *           TPL     mdos      BINA    none
*         *      *           USR     mdos      BINA    none
*         *      *           XTN     mdos      BINA    none

</PRE>NOTE: If the Mail Connection Gateway is installed and the Connection
Store directory structure is defined on a Pathworks volume, the
following extension must also be added to the MSAF$FILE_TYPES.DAT
file.
<P>
<PRE>*         *      *           MSG     mdos      BINA    none

</PRE>Any time the filename conversion logical is defined and/or changed, or
the MSAF$FILE_TYPES.DAT file is changed, all file servers in Pathworks
should be stopped and restarted for the changes to take effect.
<P>
To stop and restart the file server, as SYSTEM type:
<P>
<PRE>  ADMIN/MSA FILE_SERVER STOP
  ADMIN/MSA FILE_SERVER START

</PRE><h3>Default Permissions Not Correct for the User (Problem 4)</h3>
 
<P>
The Macintosh is able to read MS-DOS files, but the PC cannot read
Macintosh files. This is NOT a Macintosh file problem but a Pathworks
permissions problem. Use the Pathworks Administrator's Guide to grant
all users of the postoffice share full Read Write permissions to all
levels of the postoffice directory structure and all files within the
directories.
<P>
After all these steps have been accomplished and verified, copy the
postoffice directories back to the Pathworks server, and verify the
Macintosh can correctly view the directories, files, MASTER.GLB, and
can write files the PC can read. Then run the Macintosh client and
connect to the postoffice.
<P>
If problems still occur, delete the database and do all the steps
above again, but instead of restarting the file server, reboot the
Pathworks server by typing as SYSTEM:
<P>
<PRE>   REBOOT

</PRE>Then reinstall the postoffice directories and files.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.20<BR>
KBCategory: kb3rdparty kbenv kbtlc<BR>
KBSubcategory: MailPCMac<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 23, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
