

<HTML>
<HEAD>
<TITLE>PC Gen: Novell NetWare and NCP Calls -- General Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92369 ">
<META NAME="KBModify" CONTENT="1995/05/19">
<META NAME="KBCreate" CONTENT="1992/11/04">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  This article describes how communication with Microsoft Mail for PC Networks works on a Novell NetWare network. Major players in the system are Novell NetWare, the NetWare shell (Netx), the NetWare Core Protocol (NCP) language, and Microsoft Mail. ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAVZ,QBIC,QAHC,QAH6,QDIR,QADN,QAD7,QAH7,QACK,QAC9,QAQW,QA8Y,QAHB,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Gen: Novell NetWare and NCP Calls -- General Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 19, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92369 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how communication with Microsoft Mail for PC
Networks works on a Novell NetWare network. Major players in the
system are Novell NetWare, the NetWare shell (Netx), the NetWare Core
Protocol (NCP) language, and Microsoft Mail.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The NetWare shell (Netx) is responsible for determining if an application's
file request is for the operating system (MS-DOS) or for the network. If a
request is for a network file service, the shell intercepts it and prepares
it for transmission to the appropriate server. Netx works with IPX, which
is NetWare's communication protocol. IPX is bound to the workstation
network interface card (NIC) driver that allows the request to be sent out
over the topology to the server.
<P>
The shell and NetWare communicate using a language called NetWare Core
Protocol (NCP). NCP is used for all client requests for service and for the
responses to those requests. NCP is the single most important application
layer protocol that NetWare provides. Without NCP, none of the file
services offered by NetWare would be possible.
<P>
The definition of NCP is not available to the public. It is proprietary
information.
<P>
NCP manages communications for these services:
<P>
<PRE>  -  Opening files under different modes
  -  Closing open files
  -  Reading data blocks from open files
  -  Writing data blocks to open files

</PRE>In addition, NCP provides high-level connection services and
synchronization operations.
<P>
The shell accomplishes its redirection tasks by hooking several MS-DOS
interrupts. Once loaded, the shell monitors any calls that applications
make to Interrupt 21h and redirects those that require access to a server
or the network.
<P>
To determine if a request is for a local drive or a network drive, the
shell maintains a set of tables that keep track of network drives and
mappings. The shell compares the network drive table to the internal
operating system drive table (A-E, or whatever the LASTDRIVE= setting
is). If the request is for a local drive, the shell passes it to the
operating system. If the request is for a network drive, the shell
passes it to the network.
<P>
When Microsoft Mail makes a file open request for a file located on a
NetWare server, Mail issues an Interrupt 21h. The shell intercepts the
request and finds that the file resides on the server or on a network
drive (for example, drive M). Then the shell creates an IPX packet
with the NCP information. The shell hands this off to the LAN driver,
and the LAN driver passes it to the network. The response from the
server is the same, except in reverse order. The shell reads the NCP
response, and returns the Interrupt 21h request.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3rdParty<BR>
KBCategory: kbnetwork kb3rdparty<BR>
KBSubCategory: MailPCGen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 19, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
