

<HTML>
<HEAD>
<TITLE>PC Gen: Description of Mail Integrity Check MAILINT.EXE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132744">
<META NAME="KBModify" CONTENT="1995/12/20">
<META NAME="KBCreate" CONTENT="1995/07/18">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Version 3.5.0 of the Microsoft Mail for PC Networks Mail Integrity Check (MAILINT.EXE) utility ships in the version 3.5 Microsoft Mail for PC Networks Resource Kit. The utility can be used to check for a variety of missing or corrupt mail database ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QABH,QBXB,QATJ,QAFI,QAYC,QAHD,QBVV,QAB4,QAAP,QDH6,QBCU,QAY2,QANA,QBKX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Gen: Description of Mail Integrity Check MAILINT.EXE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 20, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132744</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, version 3.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Version 3.5.0 of the Microsoft Mail for PC Networks Mail Integrity Check
(MAILINT.EXE) utility ships in the version 3.5 Microsoft Mail for PC
Networks Resource Kit. The utility can be used to check for a variety of
missing or corrupt mail database files and directories. It is a read-only
utility, and it does not attempt to fix any files that fail the integrity
check. This utility can be run while users are working on the postoffice as
it does not open or write to any mail database files.
<P>
MAILINT.EXE consists of the three modules described below: Directory Check,
File Existence Check, and File Integrity Check. This utility is designed
with Microsoft Visual Basic version 3.0 and requires VBRUN300.DLL to run.
<P>
VBRUN300.EXE is available from the Microsoft Download Service (MSDL). For
additional information, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbwin/q99251.htm">Q99251</A></B>
   TITLE     : UPD: GP Fault in KRNL286 When Run EXE on 286 or w/ NT
               on MIPs

</PRE>Also refer to Chapter 5 of the version 3.5 of Microsoft Mail for PC
Networks Resource Kit for other utilities available.
<P>
<P><h3>Directory Check</h3>
 
<P>
Directory Check will verify the existence of 51 total directories. They
include the following directories located under the root directory of
\MAILDATA:
<P>
<PRE>   \XTN        \CAL
   \FOLDERS    \GLB
   \GRP        \HLP
   \INF        \INI
   \KEY        \LOG
   \USR        \MBG
   \MEM        \MMF
   \NME        \P1
   \TPL        \MAI
   \ATT

</PRE>The following directories located under the \ATT directory of \MAILDATA:
<P>
<PRE>   \AT0      \AT1
   \AT2      \AT3
   \AT4      \AT5
   \AT6      \AT7
   \AT8      \AT9
   \ATA      \ATB
   \ATC      \ATD
   \ATE      \ATF

</PRE>And the following directories located under the \MAI directory of
\MAILDATA:
<P>
<PRE>   \MA0      \MA1
   \MA2      \MA3
   \MA4      \MA5
   \MA6      \MA7
   \MA8      \MA9
   \MAA      \MAB
   \MAC      \MAD
   \MAE      \MAF

</PRE><h3>File Existence Check</h3>
 
<P>
The File Existence Check will verify the existence of a core set of Mail
postoffice files. They include the following files located under the \GLB
directory of \MAILDATA:
<P>
<PRE>   ACCESS.GLB       ACCESS2.GLB
   ACCESS3.GLB      CONTROL.GLB
   GLOBAL.GLB       GROUP.GLB
   GRPMEM.GLB       MASTER.GLB
   NETPO.GLB        NETWORK.GLB
   PROCESS.GLB      REQCONF.GLB
   RNETSEM.GLB      SRVCONF.GLB
   TID.GLB

</PRE>As well as the following files located under the \NME directory of
\MAILDATA:
<P>
<PRE>   ADMIN.NME    ADMINSHD.NME

</PRE>The following files located under the \GRP directory of \MAILDATA:
<P>
<PRE>   ADMIN.GRP    ADMINSHD.GRP

</PRE>File Check will verify that each existing .KEY file has a corresponding
.MBG file, and it will verify that each existing .MBG file has a
corresponding .KEY file.
<P>
<P><h3>File Integrity Check</h3>
 
<P>
File Integrity Check will compare (calculate) the file size of the
following files with the correct file size:
<P>
<PRE>   *.GLB     *.GRP
   *.XTN     *.KEY
   *.MBG     *.NME
   *.USR

</PRE>Please reference the On-line Help Database Description for a list of the
files and record sizes within each of those files.
<P>
<P><h3>Error Messages</h3>
 
<P>
Below is a list of errors that the utility will detect, along with a
description for each.

<UL><LI>ADMIN.GRP/ADMINSHD.GRP sizes differ.
<P>
   If the ADMIN.GRP file size differs from the ADMINSHD.GRP, make a
   backup of ADMIN.GRP, and copy the ADMINSHD.GRP over the ADMIN.GRP.

<LI>ADMIN.NME/ADMINSHD.NME sizes differ.
<P>
   If the ADMIN.NME file size differs from the ADMINSHD.NME, make a
   backup of ADMIN.NME, and copy the ADMINSHD.NME over the ADMIN.NME.

<LI>Corrupt File.
<P>
   A file is determined to be corrupt if the file size does not
   divide evenly with the record size for that file. For more
   information on the record sizes, from the Mail menu, choose Help.
   Then select Database Description.
<P>
   Please have the Mail Administrator contact Product Support with
   errors found.

<LI>Directory Is a File.
<P>
   A file exists in the place of a directory. For example, a file with
   the name AT8 exists in the \ATT directory. AT8 should be a
   subdirectory of ATT, not a file.
<P>
   Please have the Mail Administrator contact Product Support with
   errors found.

<LI>Directory Does Not Exist.
<P>
   A directory is missing from the Mail database. Use the MS-DOS
   MKDIR command to create the missing directory.

<LI>File Does Not Exist.
<P>
   The File Does Not Exist error means that one of the core postoffice
   files is missing from the Mail database. A list of the files checked
   are:
<P>
<PRE>      ACCESS.GLB      ACCESS2.GLB
      ACCESS3.GLB     CONTROL.GLB
      GLOBAL.GLB      GROUP.GLB
      GRPMEM.GLB      MASTER.GLB
      NETPO.GLB       NETWORK.GLB
      PROCESS.GLB     REQCONF.GLB
      RNETSEM.GLB     SRVCONF.GLB
      TID.GLB         ADMIN.NME
      ADMINSHD.NME    ADMIN.GRP
      ADMINSHD.GRP

</PRE><LI>File Does Not Exist - RNETSEM.GLB.
<P>
   The file RNETSEM.GLB is 4 bytes and is used for synchronizing the
   generation of RNETWORK.GLB by the External mail program. If this file
   is missing, the first run of External mail program will create this
   file.

<LI>KEY Exists Without MBG.
<P>
   Every user will have a hexid.KEY and hexid.MBG file. This program will
   gather the list of .KEY files and verify a corresponding .MBG file
   exists. This error will appear when the hexid.MBG file is missing from
   the MBG directory.

<LI>MBG Exists Without KEY.
<P>
   Every user will have a hexid.MBG and hexid.KEY file. This program will
   gather the list of .MBG files and verify a corresponding .KEY file
   exists. This error will show when the hexid.KEY file is missing from
   the KEY directory.

<LI>Missing SRVCONF.GLB.
<P>
   This file should exist only if the postoffice is the Directory
   Synchronization (Dir-Sync) server. The SRVCONF.GLB file is the
   Dir-Sync server's configuration file.

<LI>PO Not Found at &lt;location&gt;.
<P>
   If you receive this error after selecting the start button, then the
   program could not find a MASTER.GLB in the GLB directory of the path
   entered into the Location of PO dialog box. Please enter a valid
   directory for the postoffice.
<P>
Additional References: 3.50 diagnostics utilities reskit

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory: MailPCGen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 20, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
