

<HTML>
<HEAD>
<TITLE>PC Forms: Working with Multiple-Selection List Boxes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119562">
<META NAME="KBModify" CONTENT="1994/10/25">
<META NAME="KBCreate" CONTENT="1994/08/18">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you create a custom form using Microsoft Electronic Forms Designer, the selected items in a multiple-selection list box are not automatically written to the electronic form (E-form) package. Therefore, the selected lines do not appear in the l...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAH4,QAE1,QAY5,QANF,QBV8,QBVV,QBFN,QA2Q,QAB9,QACJ,QAKC,QAI2,QAIZ,QBC6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Forms: Working with Multiple-Selection List Boxes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 25, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119562</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Electronic Forms Designer, version 1.0, running with
   Microsoft Mail for PC Networks, version 3.0 or 3.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you create a custom form using Microsoft Electronic Forms Designer,
the selected items in a multiple-selection list box are not automatically
written to the electronic form (E-form) package. Therefore, the selected
lines do not appear in the list box on the Read form.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WriteTaggedControls function does not include code to automatically
package a multiple-selection list box. You can, however, add code to the
WriteMessage and ReadMessage functions so the selected items in a multiple-
selection list box are transferred to the Read form.
<P>
The following example shows the code that should be added to each function.

<OL><P><LI>Add the following code to the WriteMessage function in the EFORM.BAS
   file. Note the comments that describe the various steps.
<P>
<PRE>   'Declare the variables
   Dim n As Integer
   Dim theText As String
   Dim theTotal As Long

   'Process the list, writing each item to the package using a unique
   'itemID,
    ("List0". "List1", etc.)
   theTotal = 0
   For n = 0 To (frmCompose.lstColor.ListCount - 1)
      If frmCompose.lstColor.Selected(n) = True Then
        theText = frmCompose.List1.List(n)
        MEFWriteText gPackage, "List" &amp; Str$(theTotal), theText
        theTotal = theTotal + 1
      End If
   Next

   'Write the number of items to the package
   MEFWriteLong gPackage, "theTotal", theTotal

</PRE><P><LI>Add the following code to the ReadMessage function to unpackage the
   data:
<P>
<PRE>   'Declare variables
   Dim n As Integer
   Dim theTotal As Long

   'Find the number of items in the list by reading the package.
   theTotal = MEFReadLong(gPackage, "theTotal", 0)

   'Read in each of the items and add it to the list using AddItem
   For n = 0 To theTotal
      frmRead.lstColor.AddItem MEFReadText(gPackage, "List" &amp; Str$(n), "")
   Next
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 e-forms eforms multiple selection list box<BR>
multiselect list box<BR>
KBCategory: kbprg<BR>
KBSubcategory: MailPCForms<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 25, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
