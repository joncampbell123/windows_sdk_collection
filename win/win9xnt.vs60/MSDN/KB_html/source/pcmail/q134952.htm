

<HTML>
<HEAD>
<TITLE>FFAPI: COURPUT 201: Failure Submitting Message... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134952">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/08/14">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  The File Format Application Programming Interface (FFAPI) access components SNADPUT.EXE and OSNADPUT.EXE, provided to 3rd party vendors, will return the following error code of 201 when the program is unable to successfully deliver a message to a p...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QBW5,QAAP,QAH4,QAI5,QAYC,QAEV,QAKC,QBW7,QAKP,QBC6,QAB4,QAHT,QAG8,QBWU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FFAPI: COURPUT 201: Failure Submitting Message...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134952</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MS-DOS
kb3rdparty kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail Software Development Kit: FFAPI for Gateways and
   Applications, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The File Format Application Programming Interface (FFAPI) access components
SNADPUT.EXE and OSNADPUT.EXE, provided to 3rd party vendors, will return
the following error code of 201 when the program is unable to successfully
deliver a message to a postoffice.
<P>
<PRE>   COURPUT returned 201
   201 - 1 - 140 - Failure submitting message to mail database

</PRE><h2>CAUSE</h2>
 
<P>
The error is returned to the gateway when either SNADPUT.EXE or
OSNADPUT.EXE are unable to insert the message into the postoffice database.
<P>
The 201 error code can be caused by one of the following conditions:

<UL><LI>Network file contention.

<LI>Insufficient disk space on the postoffice database.

<LI>Postoffice directory structure incomplete or corrupt.

<LI>Insufficient access rights granted to gateway machine.

<LI>Insufficient file handles.

<LI>Network problems accessing the postoffice files.

<LI>Corrupt or incorrect format of Microsoft Mail File Format (MMFF) file.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
<P><h3>Network File Contention</h3>
 
<P>
SNADPUT.EXE or OSNADPUT.EXE must access certain files to create a message
on a postoffice. Gateways that service postoffices that receive high
volumes of message transfers and are serviced by the External program
should consider using the mailer disabler (-md) parameter on the External
command line or in the EXTERNAL.INI file.
<P>
The files accessed by SNADPUT.EXE or OSNADPUT.EXE with the -md option are:
ACCESS.GLB, ACCESS2.GLB, MASTER.GLB, C850SORT.GLB, GROUP.GLB, NETWORK.GLB,
CONTROL.GLB, INQUEUE3.KEY, and INQUEUE3.MBG.
<P>
The 201 error has been reproduced by locking the INQUEUE3.MBG file, and
this may be the most common cause of the error. These files may be locked
by other processes temporarily while in use. Postoffices located on Novell
NetWare servers that operate under high traffic conditions should set the
postoffice as shareable with few exceptions.
<P>
There are certain conditions that dictate that the CONTROL.GLB, TID.GLB,
FLAG.GLB, and MASTER.GLB should only be accessed by one process at a time;
thus, it should not be shareable.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q99204.htm">Q99204</A></B>
   TITLE     : Doc Err: Setting Attributes for High Traffic Network

</PRE>More information can also be found in the versions 3.2 and 3.5 Microsoft
Mail for PC Networks "Administrator's Guide," page 25.
<P>
This problem can be compounded if the other External or Gateway is
operating on a slow machine or over a slow link. The External option
CompatV20 (-v20) will add additional file locking functionality. As a
result, it increases the amount of network overhead and possibly causes
additional network file contention. Additional network file contention can
be created by improperly running the External program from a network drive
(page 233 of the "Administrator's Guide").
<P>
<P><h3>Insufficient Disk Space</h3>
 
<P>
Insufficient disk space on the postoffice database will prevent the client
from enlarging or creating postoffice files. Novell NetWare file servers
can produce an insufficient disk space response to the program when the
files have become ownerless or the purge file has used all available disk
space.
<P>
<P><h3>Postoffice Directory Structure</h3>
 
<P>
The postoffice directory structure should consist of an initial 19 main
subdirectories.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q77926.htm">Q77926</A></B>
   TITLE     : Description of Mail Database Subdirectories

</PRE><h3>Insufficient Access Rights</h3>
 
<P>
The gateway components should be given full network access rights for the
postoffice.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q103380.htm">Q103380</A></B>
   TITLE     : File Scan Rights Required for Novell NetWare

   ARTICLE-ID: <B><A href="../pcmail/q117152.htm">Q117152</A></B>
   TITLE     : MTA Not Report LAN Man User-Level Security Problems

   ARTICLE-ID: <B><A href="../pcmail/q121798.htm">Q121798</A></B>
   TITLE     : Err Msg: You Do Not Have the Proper Access...

</PRE>More information can also be found in the versions 3.2 and 3.5 Microsoft
Mail for PC Networks "Administrator's Guide."
<P>
<P><h3>Insufficient File Handles</h3>
 
<P>
Increase the number of file handles to 50 in the CONFIG.SYS file of the
MS-DOS workstation running the gateway.
<P>
<P><h3>Network Problems</h3>
 
<P>
The SNADPUT.EXE or OSNADPUT.EXE program utilizes the network to effectively
perform the file commands that create and manipulate each file. Network
problems that interfere with the operation of these commands can cause the
above error to occur.
<P>
<P><h3>Microsoft Mail File Format (MMFF) file problems</h3>
 
<P>
Ensure that the MMFF file submitted by the gateway follows either the Basic
or Extended Message Format for the SNADPUT.EXE or OSNADPUT.EXE program to
properly convert (definition beginning on page 50 in the FFAPI SDK).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The error displayed may consist of three numbers separated by a hyphen (-)
(201 - 1 - 140). The error code number 201 signifies that the error
occurred when it attempts to insert the message into the database.
The 1 can signify the number of messages sent per socket connection. The
second number will rarely exceed 2. The last number refers to the line
number of the message indicated by the second number. The last number is
only valid if the problem was created by a corrupt or incorrectly formatted
MMFF file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kb3rdparty kberrmsg<BR>
KBSubcategory: MailGWFFAPI<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
