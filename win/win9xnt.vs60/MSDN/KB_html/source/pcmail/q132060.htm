

<HTML>
<HEAD>
<TITLE>SMTP: SMTP Gateway in Small, Medium, and Large Organizations </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132060">
<META NAME="KBModify" CONTENT="1997/10/20">
<META NAME="KBCreate" CONTENT="1995/07/31">
<META NAME="Keywords" CONTENT="MailGWSMTP kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  You can deploy the Microsoft Mail Gateway to SMTP in several physical ways within an organization. The model you choose depends on both the volume of mail moved to and from SMTP and the external-postoffice routes defined within your Microsoft Mail ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVW,QAYC,QA9N,QAEF,QBF0,QDIZ,QANJ,QAH6,QACI,QAA1,QBNK,QAXC,QA5V,QAY2,QARZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SMTP: SMTP Gateway in Small, Medium, and Large Organizations</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132060</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MS-DOS
kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail Gateway to SMTP, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can deploy the Microsoft Mail Gateway to SMTP in several physical ways
within an organization. The model you choose depends on both the volume of
mail moved to and from SMTP and the external-postoffice routes defined
within your Microsoft Mail for PC Networks postoffice(s).
<P>
This may be an issue for your organization because the Gateway to SMTP will
only move one message in or out of Microsoft Mail at a time. As a result,
it may become a bottleneck for the SMTP mail flow.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q87045.htm">Q87045</A></B>
   TITLE     : SMTP: What the Gateway to SMTP Does

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Single Gateway Solution (Small Organization)</h3>
 
<P>
Typically, the Gateway to SMTP is installed on one Microsoft Mail
postoffice (a gateway postoffice) and other postoffices (downstream
postoffices) will send or receive SMTP mail via the single gateway
postoffice . This solution works well for most organizations. However, when
the volume of an organization exceeds the physical limitations of the SMTP
gateway: roughly 10,000 messages per day (average message size
approximately 8 kilobytes) a bottleneck can occur.
<P>
<PRE>    _______                    _______                   _______
   |Downstm|                 | Gateway |      SMTP      | Smart |
   |  PO   | -&lt;--External--&gt;-|  PO     |-&lt;---Gateway--&gt;-| Host  |
    -------                   ---------                  -------

</PRE>For additional information, please see pages 5 and 17 in the SMTP
"Administrator's Guide."
<P>
<P><h3>Multiple Gateway Solution (Small/Medium/Large)</h3>
 
<P>
One way to workaround the bottleneck described above is to purchase several
copies of the Microsoft Mail Gateway to SMTP and install them on
postoffices within the Microsoft Mail environment. The Microsoft Mail
downstream postoffices may then be logically divided into groups so that
they evenly distribute the traffic of SMTP mail between the multiple
gateways.
<P>
This model is useful for organizations that need to move large volumes of
SMTP mail, and for organizations that have complex external-postoffice
routes defined.
<P>
<PRE>    _______                   _______                   _______
   |Downstm|                 |Gateway|     SMTP        | Smart |
   |  PO   | --&lt;-&gt;-|---&lt;-&gt;---|  PO   |-----Gateway-&lt;-&gt;-|  Host |
    -------        |          -------                   -------
                   |                                     ^
    _______        |                                     |
   |Downstm|       |                                     |
   |  PO   |--&lt;-&gt;--|                                     |
    -------        |                                     |
    _______    External       _______                    |
   |Downstm|       |         |Gateway|     SMTP          |
   |  PO   | -&lt;-&gt;--|---&lt;-&gt;---|  PO   |-----Gateway--&lt;-&gt;---|
    -------        |          -------
                   |
    _______        |
   |Downstm|       |
   |  PO   | -&lt;-&gt;--|
    -------

</PRE><h3>Dedicated Send/Receive Gateways (Medium/Large Organization)</h3>
 
<P>
Another way to workaround the bottleneck issue is to divide the
responsibilities of a single SMTP gateway on to two IBM-compatible
computers. One computer is dedicated for moving mail from Mail to SMTP
(send); the other can be responsible for moving mail from SMTP to Microsoft
Mail (receive).
<P>
Once configured these gateways become independent gateways, each limited
only to its own capacity (refer to article on Theoretical Performance of
the SMTP Gateway). However, this configuration should only be used when
each dedicated gateway has a dedicated gateway postoffice.
<P>
The following is a logical drawing of message routing:
<P>
<PRE>    _______
   |Downstm|
   |  PO   |                    _______      Sending     _______
    ------- --&lt;-&gt;---|          |Gateway|     SMTP       | Smart |
                    |--&gt;----&gt;--|  PO   |--&gt;--Gateway-&gt;--|  Host |
                    |           -------                  -------
    _______         |                                         |
   |Downstm|--&lt;-&gt;---|                                         |
   |  PO   |        |                                         |
    -------      External                                     |
    _______         |                 _______     Receiving   |
   |Downstm|--&lt;-&gt;---|                |Gateway|    SMTP        |
   |  PO   |        |-----&lt;-----&lt;----|  PO   |-&lt;--Gateway--&lt;--|
    -------         |                 -------
                    |
    _______         |
   |Downstm|--&lt;-&gt;---|
   |  PO   |
    -------

</PRE><h3>Configuration Summary</h3>
 
<P>
First configure a single IBM-compatible computer to successfully move SMTP
mail bi-directionally (as if will be the only computer responsible for SMTP
traffic). Once this gateway computer is a functional SMTP gateway, then set
up a second computer with the exact same configuration and batch files,
except using a different TCP/IP number.
<P>
Notes:

<UL><LI>Do not try to load the gateway on both computer simultaneously.

<LI>You do not need to add an Address Record on your Smart Host
   for the second computer.
<P>
</UL>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q101459.htm">Q101459</A></B>
   TITLE     : SMTP: GW0645: Configuring the SMTP Gateway &amp; DNS

</PRE>The first computer will become the gateway responsible for receiving mail
from SMTP.

<OL><P><LI>Copy SMTPGATE.EXE and SMTPPUT.EXE to the local hard drive of this
   computer. This is required.
<P>
   IMPORTANT: Do not copy SMPTGET.EXE to the local drive.

<P><LI>Modify your configuration files to locate the local executable files,
   and remove the server executable location from the path statement.

<P><LI>Modify the gateway command line options to configure it for INBOUND SMTP
   mail.
<P>
   NOTE: When this inbound gateway (SMTPGATE.EXE) cycles through its
   routine, it will try and locate SMTPGET.EXE. It will take approximately
   three (3) seconds to fail before it proceeds back to its designated
   receive mode. This error will be displayed on screen.

<P><LI>Your first computer is now ready to act as a dedicated "Inbound
   SMTP Gateway."
<P>
<P><PRE>      Example Inbound SMTP Command Line:
</PRE><P>
<P><PRE>      SMTPGATE  -w32767 -i63 -md -lascy -ci -gascy
</PRE><P>
</OL>The second computer will become your gateway to send mail to SMTP.

<OL><P><LI>Copy SMTPGATE.EXE and SMTPGET.EXE to the local hard drive of this
   computer. This is required.

<P><LI>Modify your configuration files to locate the local executable files,
   and remove the server executable location from the path statement.
<P>
   IMPORTANT: Do not copy SMTPPUT.EXE to the local drive.

<P><LI>Modify the gateway command line options to configure it for OUTBOUND
   SMTP mail.
<P>
   NOTE: When this outbound gateway cycles through its routine, it will
   try and locate SMTPPUT.EXE. It will take approximately three (3) seconds
   to fail before it proceeds back to its designated receive mode. This
   error will be displayed on screen.

<P><LI>Your second computer is now ready to act as a dedicated "Outbound
   SMTP Gateway."
<P>
<P><PRE>      Example Outbound SMTP Command Line:
</PRE><P>
<P><PRE>      SMTPGATE  -w120 -q180 -063 -md -ln -ci -gascy -ms
</PRE><P>
   NOTE: Because the SMTP Gateway is designed to write all temporary
   files in M:\SMTP\*.*, each dedicated gateway (send or receive) will
   be using the same temporary directory. If a single postoffice is
   used to support both dedicated gateways, it will only be a matter
   of time until the two gateways begin to process each others temporary
   files (that is, message parts).
<P>
   Ultimately, the gateways will lock on a temporary file and halt mail in
   both directions, requiring human intervention: a reboot of both
   gateways.
<P>
</OL><h3>Multiple Dedicated Send/Receive Gateways (Medium/Large Organizations)</h3>
 
<P>
The above can be adapted for an even more intense SMTP Gateway
configuration.
<P>
<PRE>         _______
        |Downstm|
   |-&lt;&gt;-|  PO   |--------|           _______      Sending     _______
   |     -------         |          |Gateway|     SMTP       | Smart |
   |                     |--&gt;----&gt;--|  PO   |--&gt;--Gateway-&gt;--|  Host |
   |                     |           -------                  -------
   |      _______        |                                         |
   |    |Downstm|--------|                                         |
   |-&lt;&gt;-|  PO   |        |                                         |
   |     -------      External                                     |
   |     _______         |                 _______     Receiving   |
   |    |Downstm|------- |                |Gateway|    SMTP        |
   |-&lt;&gt;-|  PO   |        |-----&lt;-----&lt;----|  PO   |-&lt;--Gateway--&lt;--|
   |     ------          |                 -------
   |                     |
   |     _______         |
   |    |Downstm|--------|
   |-&lt;&gt;-|  PO   |
   |     -------
 External
   |     _______
   |    |Downstm|
   |-&lt;&gt;-|  PO   |                    _______      Sending     _______
   |     ------- --------|          |Gateway|     SMTP       | Smart |
   |                     |--&gt;----&gt;--|  PO   |--&gt;--Gateway-&gt;--|  Host |
   |                     |           -------                  -------
   |     _______         |                                         |
   |    |Downstm|--------|                                         |
   |-&lt;&gt;-|  PO   |        |                                         |
   |     -------      External                                     |
   |     _______         |                 _______     Receiving   |
   |    |Downstm|------- |                |Gateway|    SMTP        |
   |-&lt;&gt;-|  PO   |        |-----&lt;-----&lt;----|  PO   |-&lt;--Gateway--&lt;--|
   |     -------         |                 -------
   |                     |
   |     _______         |
   |    |Downstm|--------|
   |-&lt;&gt;-|  PO   |
         -------
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00<BR>
KBCategory: kb3rdparty<BR>
KBSubcategory: MailGWSMTP<BR>
Keywords          : MailGWSMTP kb3rdparty<BR>
Version           : 3.00<BR>
Platform          : MS-DOS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
