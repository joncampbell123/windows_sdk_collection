

<HTML>
<HEAD>
<TITLE>PC DB: How to Reset the .MAI File Counter of MBG Owners </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104423">
<META NAME="KBModify" CONTENT="1995/05/31">
<META NAME="KBCreate" CONTENT="1993/09/15">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  In versions 3.0 and 3.2 of Microsoft Mail for PC Networks database structure, there is an MAI subdirectory. This subdirectory contains many other directories which hold .MAI files. Each MAI file contains a count of how many users still have that me...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALX,QAM9,QBFY,QAGC,QBXS,QAEF,QBF0,QAUD,QAPF,QALG,QAGU,QAI4,QAKJ,QAFI,QAML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC DB: How to Reset the .MAI File Counter of MBG Owners</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 31, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104423</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0 and 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In versions 3.0 and 3.2 of Microsoft Mail for PC Networks database
structure, there is an MAI subdirectory. This subdirectory contains
many other directories which hold .MAI files. Each MAI file contains a
count of how many users still have that message in their MBG file. In
an MAI file that is shared between multiple users, the counter gets
decremented each time a user "deletes" or moves the message out of
their MBGs. When the last remaining user (counter = 1) deletes the MAI
file, it is actually erased.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Before you make any modifications to an active MAI file, make two copies
of the file (*.TMP and *.BAK). Use the .TMP file as a temporary
working file. Use the .BAK file to restore if something goes wrong.
<P>
To view or modify the counter run the following debug procedure on the
specific .MAI temporary file:
<P>
M:\MAILDATA\MAI\MAD &gt;debug 0000013d.tmp
-d10b
<PRE>:0100                                  2C 01 7F 05 32 ,...2
</PRE>:0110 20 02 02 00 7F 05 33 20-02 0A 00 7F 05 37 20 02 .....3 .....7 .
:0120 0A 00 4C 25 01 02 22 5A-65 57 59 0E 50 74 68 6C ..L%.."ZeWY.Pthl
:0130 54 18 65 4A 57 52 6E 48-29 CF C4 D6 DA C3 E0 C9 T.eJWRnH).......
:0140 D3 C8 F8 E7 FA ED DA A2-F3 4C 82 19 C9 05 02 14 .........L......
:0150 5A 65 57 59 0E 50 74 68-6C 54 18 65 38 71 29 7C ZeWY.PthlT.e8q)|
:0160 B4 D5 B3 F8 02 14 5A 65-57 59 0E 50 74 68 6C 54 ......ZeWY.PthlT
:0170 18 65 39 79 28 7D B5 D4-B2 F9 02 14 5A 65 57 59 .e9y(}......ZeWY
<PRE>:0180 0E 50 74 68 6C 54 18 65-39 79 29                .PthlT.e9y)
-

</PRE>If you reverse and concatenate together the first two bytes displayed,
you will get the value the counter is currently set at in Hex. For
example, reversing and concatenating 2C and 01 gives 012C which in
decimal is 300.
<P>
Other Examples:
<P>
<PRE>   Bytes       Hex       Decimal
   -----------------------------
   05 00  ==&gt;  0005  ==&gt;   5
   FF 00  ==&gt;  00FF  ==&gt; 255
   00 01  ==&gt;  0100  ==&gt; 256
   F4 01  ==&gt;  01F4  ==&gt; 500

</PRE>To reset the counter to a different number, reverse the process shown
in the above table and then substitute your own byte values in place
of the ones used in the following example. In the example, the counter
is being reset to 255 (decimal).
<P>
-e10b
<PRE>32B0:010B  2C.FF   01.00
-w
</PRE>Writing 01BF7 bytes
-q
<P>
Actual keystrokes:
E,one,zero,B,enter,F,F,spacebar,zero,zero,enter,W,enter,Q,enter
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.20<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCDB<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 31, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
