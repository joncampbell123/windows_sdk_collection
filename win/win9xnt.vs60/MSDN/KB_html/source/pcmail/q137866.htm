

<HTML>
<HEAD>
<TITLE>PC NTMMTA: Err Msg: Drive Is Either Local, Used or Greater... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137866">
<META NAME="KBModify" CONTENT="1996/06/05">
<META NAME="KBCreate" CONTENT="1995/10/08">
<META NAME="Keywords" CONTENT="kbenv kbinterop kberrmsg kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you run the Windows NT Multitasking MTA (NT MMTA) External Mail program on either the command line or as a service, the following error may occur in a Monitor window or in the SESSION.LOG when you use Dynamic Drive connections:     Drive is ei...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWM,QAYC,QBWP,QAC9,QABI,QAF3,QA4B,QABH,QBWS,QAI5,QAIJ,QACK,QAAP,QBVV,QA59 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC NTMMTA: Err Msg: Drive Is Either Local, Used or Greater...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137866</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail Multitasking MTA for Windows NT, version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Windows NT Multitasking MTA (NT MMTA) External Mail
program on either the command line or as a service, the following error may
occur in a Monitor window or in the SESSION.LOG when you use Dynamic Drive
connections:
<P>
<PRE>   Drive is either local, used or greater than LASTDRIVE
   Initializing data structures. Could not connect to drive

</PRE><h2>CAUSE</h2>
 
<P>
The drive letter used by the External Mail program to dynamically connect
to the postoffice is unavailable for use. The drive letter may be in use by
one of the following processes:

<UL><LI>A hardware device, such as a drive or CD player.

<LI>The substitute drive assignment is in use.

<LI>The LASTDRIVE statement in the CONFIG.SYS is lower than the drive
   letter the External Mail program is trying to use.

<LI>The network drive assignment is in use by the Dispatch Mail program (see
   MORE INFORMATION below).

<LI>You may also get the same error if you run the MS-DOS External.exe from
   Windows NT and using the Dynadmin table. For the NTMMTA, make sure you
   are running the correct version of External.exe, located in the
   Mailexe \External.NT subdirectory.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
Review the current drives used by the system using the Net Use command at
the command prompt to ensure that the device letter selected is not used in
the EXTERNAL.INI file. Check any drives connected to local subdirectories
with the SUBST command.
<P>
Confirm that the LASTDRIVE entry in the CONFIG.SYS is higher than the drive
letters used by the External Mail program. Check the DISPATCH.INI file to
confirm that Dispatch is not trying to use a drive letter that is assigned
to the External Mail program. See the More Information section below for
additional information.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in version 3.5 of the
Microsoft Mail Multitasking MTA for Windows NT. We are researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use dynamic drives, and the External Mail program dynamically
initializes an instance and uses drive E, then pauses until the next cycle
of checking for new mail, it will release its connection to drive E. If
Dispatch initializes in order to check the process table and/or run a
scheduled Directory Synchronization (Dir-Sync) event, it will also use
drive E as the next available drive letter. Dispatch usually releases the
drive before the External instance resumes its cycle; however, the External
Mail program may try to resume before Dispatch is finished with its
process. In this case, the External Mail program will try to use the same
dynamic drive Dispatch is currently using (drive E), resulting in the error
above.
<P>
This can be prevented by initiating all Dispatch instances before
initializing the External instances. If a Dispatch service needs to be
stopped, ensure that all External instances are stopped, and re-start the
Dispatch instance followed by the External instance.
<P>
If the NT MMTA is started through batch files or AT commands, you can
organize the drive letter assignments to ensure that Dispatch should be
assigned the first available drive letters (for example, D, E, F, G, or H).
The External instances should be assigned the available drive letters at
the end of the drive range (for example, U, V, W, X, Y, or Z). This will
reduce the possibility that the drive letters assigned to be used by the
External instances for dynamic connections will be selected as the next
available drive.
<P>
If the NT-MMTA is being run as a service, Dispatch instances will normally
start before External instances, but you can still have this problem if a
dispatch service is stopped and then restarted manually. You can prevent
this by using the Registry Editor (RegEdit) to add all dispatch instances
to the DependendOnService parameter of:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MS Mail External -
   (instance)

</PRE>Key for each External instance. The Dispatch instances must be specified,
as they appear in the Services key name, for example:
<P>
<PRE>   MS Mail Dispatch - (instance)

</PRE>WARNING: Using the Registry Editor incorrectly can cause serious, system-
wide problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
The Windows NT server must be re-booted for these changes to take effect.
You can test the changes after re-booting by:

<OL><P><LI>Stop a dispatch instance, and see if all the External instances are
   automatically stopped.

<P><LI>Restart all External instances and make sure the Dispatch instance
   is automatically restarted when you re-start the first External
   instance.
<P>
</OL>Repeat the above steps for each of the remaining Dispatch instances.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20 3.50 mta<BR>
KBCategory: kbenv kbinterop kberrmsg kbtlc<BR>
KBSubcategory: MailPCNTMMTA<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
