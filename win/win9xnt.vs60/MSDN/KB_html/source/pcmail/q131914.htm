

<HTML>
<HEAD>
<TITLE>PC Gen: Using the DEC Redirector Slows Mail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131914">
<META NAME="KBModify" CONTENT="1995/06/23">
<META NAME="KBCreate" CONTENT="1995/06/22">
<META NAME="Keywords" CONTENT="kb3rdparty kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you use the DEC redirector to connect to a Pathworks server that has the version 3.2 or 3.2a Microsoft Mail for PC Networks database, and the mail message file (MMF) is stored on the server, Microsoft Mail for Windows runs extremely slowly whe...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAYC,QDL9,QBWN,QBWQ,QABT,QA5E,QAA8,QA5F,QAMA,QDMR,QAD7,QAK7,QAJ6,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Gen: Using the DEC Redirector Slows Mail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131914</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.2 and 3.2a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the DEC redirector to connect to a Pathworks server that has
the version 3.2 or 3.2a Microsoft Mail for PC Networks database, and the
mail message file (MMF) is stored on the server, Microsoft Mail for Windows
runs extremely slowly when you send or receive messages.
<P>
<P><h2>CAUSE</h2>
 
<P>
Mail accesses the MMF by using byte range locking, so to send or receive a
message, it attempts to lock a byte range on the MMF, even if it already
has a lock on that byte range. The Pathworks server handles multiple byte
range locks on the same range as a file lock violation, even when the lock
comes from the same workstation. When the server rejects the lock, the
redirector attempts three more times to establish the lock, and succeeds on
the last attempt. This creates a delay while Mail waits for the redirector
to establish the lock.
<P>
The Pathworks server also adds to the delay by increasing the response
delay when multiple file lock violations occurs on a file. Between the
redirector trying four times and the server waiting longer and longer
between these attempts to respond to the workstation, Mail effectively
stops running for 4 to 10 seconds per message.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This is not a problem with Mail but with the underlying network
architecture.
<P>
The resolution can be one of the following:

<UL><LI>Move the MMF files to the local workstation.

<LI>Upgrade the Pathworks server to version 5.0, and use the DEC
   redirector version 5.0 in enhanced mode.

<LI>Upgrade Microsoft Windows version 3.1 to Microsoft Windows for
   Workgroups 3.11, and use the enhanced redirector.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Testing shows that the problem occurs primarily when you use Pathworks
version 4.1, the DEC redirector version 4.1a, and Windows version 3.1; it
can also occur when you run the DEC redirector version 5.0 in basic mode.
<P>
The following table summarizes the results of testing:
<P>
<PRE>Client OS                     Redir    Mode         Server   Result
</PRE> 
<PRE>Windows 3.1                   4.1a     basic        4.1      failed (1)
Windows 3.1                   4.1a     enhanced     4.1      failed (1)
Windows for Workgroups 3.11   4.1a     enhanced     4.1      OK (2)
Windows 3.1                   4.1a     enhanced     NTAS 3.5 OK (3)
Windows 3.1                   5.0      enhanced     4.1      failed (1)
Windows 3.1                   5.0      basic        5.0      failed (1)
Windows 3.1                   5.0      enhanced     5.0      OK (4)
Windows for Workgroups 3.11   5.1      enhanced     5.0      OK (5)
Windows for Workgroups 3.11   5.1      enhanced     5.0      OK (5)

</PRE>Notes:

<UL><LI>(1) 4 lock violations per message
<LI>(2) file lock broken and file relocked, no violation
<LI>(3) 1 lock violation.
<LI>(4) 1 lock violation. Response from server was slow (~520 ms).
<LI>(5) No file locks were made
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.20 slow<BR>
KBCategory: kb3rdparty kbnetwork<BR>
KBSubcategory: MailPCGen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 23, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
