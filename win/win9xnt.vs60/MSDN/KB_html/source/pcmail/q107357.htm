

<HTML>
<HEAD>
<TITLE>PC Forms: Incorrect Data Printed from Subform </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107357">
<META NAME="KBModify" CONTENT="1995/11/01">
<META NAME="KBCreate" CONTENT="1993/11/17">
<META NAME="Keywords" CONTENT="kbusage kbprg kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When you print a custom form created using version 1.0 of Microsoft Electronic Forms Designer, information in subforms may not print as expected. When E-Form Caching is turned on, information from a previous instance of the subform may print instea...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDN7,QAY2,QAOX,QDIV,QBVR,QBWS,QAYY,QAB9,QBFN,QAY5,QAPN,QBV8,QBVV,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Forms: Incorrect Data Printed from Subform</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 1, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107357</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Electronic Forms Designer, version 1.0, running with
   Microsoft Mail for PC Networks, version 3.0 or 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you print a custom form created using version 1.0 of Microsoft
Electronic Forms Designer, information in subforms may not print as
expected. When E-Form Caching is turned on, information from a previous
instance of the subform may print instead of the current data.
<P>
<P><h2>CAUSE</h2>
 
<P>
The instructions listed in the "Adding Modal and Modeless Subforms" section
(pages 98-102) of the Microsoft Electronic Forms Designer "Developer's
Guide" will place code in correct locations for reading subforms. However,
it does not provide instructions for properly handling printing of subforms
when caching is turned on.
<P>
The method outlined in the "Developer's Guide" is for the
ReadTaggedControls function to be called in the Load event of a subform.
When a subform is opened, ReadTaggedControls reads the subform's data from
the MEF package. If a custom message is read and the Print command is
issued before the subform is opened, the Load event for the subform does
not take place. Consequentially, the ReadTaggedControls function is not
called to retrieve the subform's data from the package. When caching is
turned on, the cached data for the subform is used and will print.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, you must read the subform data from the
package when the e-form loads, rather then waiting to read the data when
the subform is opened. To do so, perform the following steps to add code to
the ReadMessage function defined in the EFORM.BAS file:

<OL><P><LI>Open the E-Form project in Microsoft Visual Basic.

<P><LI>Open the EFORM.BAS file.

<P><LI>In the Proc: list box, select ReadMessage.

<P><LI>Add the ReadTaggedControls function for each subform below the comment
   "Add code here to unpackage your data."
<P>
   For example, if there is a subform named frmHardware, add the following
   line of code:
<P>
<P><PRE>      ReadTaggedControls frmHardware, gPackage
</PRE>
<P><LI>Remove the ReadTaggedControls function from the Load event for the
   subform. From the Project window, select the subform and choose the View
   Code button.

<P><LI>From the Object: list box, select Form.

<P><LI>From the Proc: list box, select Load.

<P><LI>Delete the following line of code:
<P>
<P><PRE>      ReadTaggedControls Me, gPackage
</PRE><P>
</OL>The subform's data will now be read from the package when the form is
opened and will be available to the print procedure regardless of when the
subform is read.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 wrong printed sub form<BR>
KBCategory: kbusage kbprg kbtlc<BR>
KBSubcategory: MailPCForms<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 1, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
