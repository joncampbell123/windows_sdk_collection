

<HTML>
<HEAD>
<TITLE>PC MAPI: Simple MAPI Version 3.2.0.4081 Update </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95522 ">
<META NAME="KBModify" CONTENT="1996/07/29">
<META NAME="KBCreate" CONTENT="1993/02/14">
<META NAME="Keywords" CONTENT="kbprg kbfile kbbug3.00b kbbug3.20 kbfix3.50 kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  Microsoft provides replacements for the Simple MAPI files, included with versions 3.0b and 3.2 of Microsoft Mail for PC Networks, for both Microsoft C and Microsoft Visual Basic. The replacement files provide additional enhancements to the original...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAL7,QANE,QAYC,QBFY,QAPF,QAFI,QBXB,QATJ,QAC1,QBS0,QBD2,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC MAPI: Simple MAPI Version 3.2.0.4081 Update</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95522 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for Windows, versions 3.0b and 3.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft provides replacements for the Simple MAPI files, included with
versions 3.0b and 3.2 of Microsoft Mail for PC Networks, for both Microsoft
C and Microsoft Visual Basic. The replacement files provide additional
enhancements to the original Mail technical reference disk.
<P>
For complete information about obtaining and installing the Simple MAPI
files, see the following sections:

<UL><LI>To download the updated files
<LI>To update your technical reference disk
<LI>To use the technical reference manual files
<LI>To update your MAPI.DLL and FRAMEWORK.DLL files
<LI>To use the Autosend application or source code
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This update includes the following files:
<P>
<PRE>  Filename      | Description
</PRE> 
<PRE>  TECHDISK.EXE  | Mail technical reference disk
  TECHDOCS.EXE  | Mail technical reference manual
  MAPI.DLL      | Messaging Application Programming Interface (MAPI)
                | dynamic link library
  FRAMEWRK.DLL  | Framework layer dynamic link library
  SAMPLE.EXE    | Sample Simple MAPI application for sending mail
                | automatically. Source files included.

</PRE>The Simple MAPI files included on the technical reference disk allow
application developers to include messaging capabilities in their
applications' user interfaces. Support is provided for both Microsoft
C and Microsoft Visual Basic.
<P>
This update contains TECHDISK.EXE, a replacement for the Mail technical
reference disk included with versions 3.0b and 3.2 of Microsoft Mail for
Windows. This replacement disk provides additional enhancements to
the original Mail technical reference disk and includes the following
modifications for versions 3.0b and 3.2 of Microsoft Mail for Windows:

<UL><LI>MAPI.H has been modified to be strictly ANSI compatible, and no
   longer causes warnings on Warning Level 4 with the Microsoft C
   version 7.0 compiler.

<LI>The sample Visual Basic Simple MAPI application has been modified
   to compile when you use Microsoft Visual Basic version 2.0.
<P>
</UL>This update also contains TECHDOCS.EXE, an electronic version of the Mail
technical reference manual included with version 3.2 of Microsoft Mail for
Windows.
<P>
This update also includes the latest MAPI.DLL and FRAMEWRK.DLL files, and a
sample Visual Basic program called Autosend (included in the SAMPLE.EXE
file) that sends mail at specific times or intervals. The code for this
application is included to allow additional capabilities such as checking
mail response time between postoffices.
<P>
This update also contains MAPI.DLL, a replacement for the MAPI.DLL file
included with versions 3.0b and 3.2 of Microsoft Mail for Windows. This
replacement file provides additional enhancements to the original MAPI.DLL
file and resolves the following problems that can occur when you are using
versions 3.0b and 3.2 of Microsoft Mail for Windows:

<UL><LI>Deleting a message in a shared folder does not function as
   expected; the message in the folder is deleted, but the header
   still appears. If you select the header to bring up the message,
   Mail for Windows returns a dialog box that says "The message cannot
   be accessed." Also, if you change a message in any way, the message
   becomes inaccessible.

<LI>Reply, Reply All, and Forward commands on customer messages in
   shared folders fail if these commands are called from Mail for
   Windows. This problem occurs because the client hands off the
   temporary message ID of the shared folder, instead of the permanent
   shared-folder message ID.
<P>
   NOTE: For this problem to be resolved, two files must be updated:
   the MAPI.DLL file (included in this update) and the MSMAIL.EXE file
   (update included in MAILUPD.EXE on the MSL).

<LI>To correctly launch e-forms, Microsoft Electronic Forms Designer
   requires that the message type it gives to Simple MAPI be preserved
   in the delivered message. However, the message type is not encoded
   in WINMAIL.DAT by default, so it is lost across gateways.
   Therefore, the message is received and displayed as a note rather
   than as a Microsoft electronic form.

<LI>Custom forms that did not include their own textize maps
   could not use the provided default print/save functionality.
<P>
   NOTE: To fix this problem, MSSFS.DLL (update included in MSSFS.EXE
   on the MSL) version 3.2.4081 or later must be used in conjunction
   with the MAPI.DLL included in this update.
<P>
</UL>This update also contains FRAMEWRK.DLL, a replacement for the FRAMEWRK.DLL
file included with versions 3.0b and 3.2 of Microsoft Mail for Windows.
This replacement file resolves the following problem that can occur when
you use versions 3.0b and 3.2 of Microsoft Mail for Windows:

<UL><LI>When you execute the MAPIAddress() function, an "Out of Memory"
   error can occur. This problem occurs because a second MAPI session
   is being started and closed, and the MAPIAddress() function is then
   executed in the first session.
<P>
</UL><h3>To download the updated files</h3>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/mapiupd.exe">MAPIUPD.EXE</A> <I>(size: 989340 bytes)</I> 
                        , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/mapiupd.exe">MAPIUPD.EXE</A> <I>(size: 989340 bytes)</I> 
                              , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/mapiupd.exe">MAPIUPD.EXE</A> <I>(size: 989340 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location.
      Type "mssupport" (without the quotation marks).
      Double-click the MS Software Library icon.
      Find the appropriate product area.
      Locate and Download MAPIUPD.EXE.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/mapiupd.exe">MAPIUPD.EXE</A> <I>(size: 989340 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>After you download MAPIUPD.EXE to a clean directory, run it (by typing
"mapiupd" at the MS-DOS prompt) to extract the contents of the file.
You should receive the following files:
<P>
<PRE>   MAPI.DLL     ( 54,208 bytes, dated 02/01/95, 2:31 A.M.)
   TECHDISK.EXE (216,727 bytes, dated 09/17/93, 8:00 A.M.)
   TECHDOCS.EXE (289,006 bytes, dated 09/17/93, 8:00 A.M.)
   FRAMEWRK.DLL (221,168 bytes, dated 05/06/93, 7:00 A.M.)
   SAMPLE.EXE   (334,884 bytes, dated 09/17/93, 8:00 A.M.)
   README.TXT

</PRE><h3>To update your technical reference disk</h3>
 

<OL><P><LI>At the MS-DOS command prompt, type the following and press ENTER
<P>
<P><PRE>      copy &lt;drive&gt;:\techref\disk\techdisk.exe &lt;destination&gt;
</PRE><P>
   where &lt;drive&gt; the drive and directory where you ran the self-extracting
   MAPIUPD.EXE file and &lt;destination&gt; is the drive and directory where
   your Simple MAPI files currently reside. For example, if you ran the
   self-extracting file from the TEST directory on drive D, and your
   Simple MAPI files are located in the MAILEXE\TECHREF directory on
   drive C, type the following command:
<P>
<P><PRE>      copy d:\test\techdisk.exe c:\mailexe\techref
</PRE>
<P><LI>At the MS-DOS command prompt, type the following and press ENTER
<P>
<P><PRE>      &lt;destination&gt;\techdisk.exe -d
</PRE><P>
   where &lt;destination&gt; is the drive and directory where your Simple
   MAPI files currently reside. For example, if your Simple MAPI files
   are located in the MAILEXE\TECHREF directory on drive C, type the
   following command:
<P>
<P><PRE>      c:\mailexe\techref\techdisk.exe -d
</PRE>
<P><LI>At the MS-DOS command prompt, type the following and press ENTER
<P>
<P><PRE>      copy &lt;mailexe&gt;\setup.inf &lt;mailexe&gt;\setupinf.old
</PRE><P>
   where &lt;mailexe&gt; is the complete path to the directory containing
   the Microsoft Mail for Windows SETUP.EXE program. For example, if
   SETUP.EXE is located in the MAILEXE directory on drive C, type the
   following command:
<P>
<P><PRE>      copy c:\mailexe\setup.inf c:\mailexe\setupinf.old
</PRE>
<P><LI>Using any text editor, edit the SETUP.INF file. In the [MsMail
   System] section, replace the following line
<P>
<P><PRE>      1, mapi.dll,,,, 1993-05-26, !DECOMPRESS,, OLDER, !READONLY
      ,,,,, SHARED, ,,,,, 54352,,,, 3.2.0.4037,
</PRE><P>
   with:
<P>
<P><PRE>      1, mapi.dll,,,, 1995-02-01, !DECOMPRESS,, OLDER, !READONLY
      ,,,,, SHARED, 54208,,,, 3.2.0.4081
</PRE><P>
   Save the file and close the text editor.
<P>
   NOTE: For these changes to affect the entire network, each existing
   user must run Setup again.
<P>
</OL><h3>To use the technical reference manual files</h3>
 
<P>
At the MS-DOS command prompt, type the following commands and press
ENTER after each line
<P>
<PRE>   md &lt;harddrive&gt;:\&lt;destination&gt;
   copy &lt;drive:&gt;\techref\doc\techdocs.exe &lt;destination&gt;
   &lt;destination&gt;:\techdocs.exe

</PRE></OL>where &lt;harddrive&gt; is the local hard disk or network drive, &lt;drive&gt; is
the drive and directory where you ran the self-extracting MAPIUPD.EXE
file, and &lt;destination&gt; is the path where you want the technical reference
manual files to reside. For example, if you ran the self-extracting file
from the TEST directory on drive D, and you want the files to reside in the
C:\TECHDOCS directory, type the following command:
<P>
<PRE>   md c:\techdocs
   copy d:\test\techdocs.exe c:\techdocs
   c:\techdocs\techdocs.exe

</PRE>The technical reference manual files are in Word for Windows 2.0
format. Read the README.TXT file in the directory where the technical
reference files reside.
<P>
<P><h3>To update your MAPI.DLL and FRAMEWORK.DLL files</h3>
 
<P>
NOTE: To fix the problem with MAPI.DLL version 3.2.4081, you must do one
of the following steps:
<P>
- Recompile all user s custom-form generating applications supplying
<PRE>   the custom form a new message class name.

</PRE>-or-

<UL><LI>To replace the old textize map with a new one, you need to create a
   new mail message file (MMF) for every user.
<P>
</UL>At the MS-DOS command prompt, type the following and press ENTER
<P>
<PRE>   copy&lt; drive&gt;:\*.DLL&lt; destination&gt;

</PRE>where &lt;drive&gt; is the drive and directory where you ran the self-extracting
MAPIUPD.EXE file and &lt;destination&gt; is the drive and directory where your
MAPI.DLL and FRAMEWRK.DLL files currently reside. For example, if you ran
the self-extracting file from the TEST directory on drive D, and your
MAPI.DLL and FRAMEWRK.DLL files are located in the MAILEXE directory on
drive C, type the following command:
<P>
<PRE>   copy d:\test\*.DLL c:\mailexe

</PRE><h3>To use the Autosend application or source code</h3>
 

<OL><P><LI>At the MS-DOS command prompt, type the following commands and press
   ENTER after each line
<P>
<P><PRE>      md &lt;harddrive&gt;:\&lt;destination&gt;
      copy &lt;drive&gt;:\sample\sample.exe &lt;destination&gt;
      &lt;destination&gt;:\sample.exe
</PRE><P>
   where &lt;harddrive&gt; is the local hard disk or network drive, &lt;drive&gt;
   is the drive and directory where you ran the self-extracting
   MAPIUPD.EXE file, and &lt;destination&gt; is the path where you want the
   sample application files to reside. For example, if you ran the self-
   extracting file from the TEST directory on drive D, if you want the
   files to reside in the C:\SAMPLE directory, type the following command:
<P>
<P><PRE>      md c:\sample
      copy d:\test\sample.exe c:\sample
      c:\sample\sample.exe
</PRE>
<P><LI>At the MS-DOS command prompt, type the following commands and press
   ENTER after each line to use the Autosend application
<P>
<P><PRE>      copy &lt;samplepath&gt;:\*.vbx c:\&lt;windir&gt;
      copy &lt;samplepath&gt;:\*.dll c:\&lt;windir&gt;\system
</PRE><P>
   where &lt;samplepath&gt; is the drive and directory where the sample
   application resides and &lt;windir&gt; is the path to the Windows
   directory. For example, if the sample application is in the
   C:\SAMPLE directory and your Windows directory is C:\WINDOWS, type
   the following commands:
<P>
<P><PRE>      copy c:\sample\*.vbx c:\windows
      copy c:\sample\*.dll c:\windows\system
</PRE><P>
   Run the sample application from Windows. To use the source code,
   you must use the Professional Edition of Microsoft Visual Basic
   version 2.0 or later.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00b wga<BR>
KBCategory: kbprg kbfile kbbug3.00b kbbug3.20 kbfix3.20a kbfix3.50 kbtlc<BR>
KBSubCategory: MailPCMAPI<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
