

<HTML>
<HEAD>
<TITLE>PC Gen: Contents of Modem Script File NULLMODM.MDM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80261 ">
<META NAME="KBModify" CONTENT="1996/01/25">
<META NAME="KBCreate" CONTENT="1992/01/23">
<META NAME="Keywords" CONTENT="kbtool kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT=" The following is the contents of the Microsoft Mail version 2.1e modem script file NULLMODM.MDM, which can be compiled with SCRCOMP.EXE:   ;********************************************************************* ; ;                    Microsoft Mail S...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QDNQ,QAI5,QAH4,QAH6,QAGI,QBNS,QAS6,QBXS,QALW,QDJI,QBVV,QAK9,QAI4,QAAZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Gen: Contents of Modem Script File NULLMODM.MDM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 25, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80261 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, version 2.1e
</UL> 
<P>
The following is the contents of the Microsoft Mail version 2.1e
modem script file NULLMODM.MDM, which can be compiled with
SCRCOMP.EXE:
<P>
<P>
;*********************************************************************
;
<PRE>;                    Microsoft Mail Script File
;
;       Filename: nullmodm.mdm
;       Date    : March 21, 1990
       Script  : Standard script file for null-modems
</PRE>;
;     This script file contains the strings used in the calling
;  sequence for null modem connections. Note that this used to be
;  accomplished in version 1.0 and version 2.0 via the -Z option.
;
;     Note that a "proper" null modem is wired in the following way:
;
<PRE>;                       1_____1
;                       2__ __2
;                       3__X__3
;                       4__ __4
;                       5__X__5
;                       7_____7
;                       6_____20
;                       8_/
;                      20_____6
;                           \_8
;
</PRE>;  If your null modem is not wired in this way then you could
;  experience flow control problems and "lost carrier".
;
;     If your null modem connection is via a device which requires
;  some setup strings to be issued to initialized the device then
;  insert the appropriate "send" commands in the INITIALIZE procedure.
;  If the device must be reset after a connection the insert the
;  appropriate "send" commands in the RESET procedure.
;
;  Script procedures defined:
<PRE>;       INITIALIZE
;       RESET
;       CALL
;       ANSWER
;       DISCONNECT
;
</PRE>;  Return codes for External, Transmit, Listen:
<PRE>;       0  - OK
;       1  - CONNECT 300
;       2  - not defined
;       3  - NO CARRIER
;       4  - ERROR
;       5  - CONNECT 1200
;       6  - not defined
;       7  - BUSY
;       8  - NO ANSWER
;       9  - not defined
</PRE>;      10  - CONNECT 2400
;      11  - not defined
;      12  - CONNECT 9600 (high speed connection)
;
;
;*********************************************************************
<P>
<P>
INITIALIZE:
<PRE>        title "Null Modem Script"

        return 0


</PRE>RESET:
<PRE>        return 0


</PRE>CALL:
<PRE>        $ret = 8               ; set default ret code to "no answer"

</PRE>; If you previously used the -Z option with an optional setup string
; then uncomment the following line and insert your setup string
; between the double quote characters.
<PRE>;       eg. send "\17"         ; send XON
;

;       send ""


        sendln "9"             ; send call signal to remote site

        waitrsp 1              ; wait until the modem responds

        if (response = "8^M")  ; has other side answered?
          {
          sendln "8"           ; if he has then send
          display "&gt;&gt;&gt; CONNECT - NULL MODEM &lt;&lt;&lt;"
          $ret = 12
          }
        else
          {
          display "&gt;&gt;&gt; NO ANSWER &lt;&lt;&lt;"
          $ret = 8
          }

        return $ret            ; return connect baud rate to
                               ;    application


</PRE>ANSWER:
<PRE>        $ret = 8               ; set default ret code to "no answer"

        waitrsp 1              ; see if phone is ringing

        if (response = "9^M")  ; 9 means "RING" for nullmodems
            {
            sendln "8"         ; answer the phone

            waitrsp 20          ; wait for return code from modem


            if (response = "8^M")
              {
              display "&gt;&gt;&gt; CONNECT - NULL MODEM &lt;&lt;&lt;"
              $ret = 12
              }
            }

        return $ret            ; return connect baud rate to
                               ;    application


</PRE>DISCONNECT:
<PRE>        dtr 0                  ; drop DTR signal for a few seconds

        clearrsp               ; clear the response buffer

        wait 4                 ; give other side time to recognize
                               ;    lost carrier
        dtr 1                  ; raise it back again
        return 0
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.10 2.1 2.10e<BR>
KBCategory: kbtool kb3rdparty<BR>
KBSubCategory: MailPCGen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 25, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
