

<HTML>
<HEAD>
<TITLE>PC NTMMTA: Err Msg: Fatal [ 7] Error Renaming File... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148811">
<META NAME="KBModify" CONTENT="1996/04/23">
<META NAME="KBCreate" CONTENT="1996/03/22">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  When Import is processing updates, the following error may occur:     09/02/95 05:10:18 | Fatal  [  7] Error renaming file: B:USR\IMPORT.USR  This error is followed by multiple Warning 90 messages that list the transactions that were not processed ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QBWP,QAKP,QBVV,QAUJ,QAGB,QAKD,QAHE,QBJZ,QAXB,QAO4,QAMB,QAL0,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC NTMMTA: Err Msg: Fatal [ 7] Error Renaming File...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 23, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148811</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail Multitasking MTA for Windows NT, version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When Import is processing updates, the following error may occur:
<P>
<PRE>   09/02/95 05:10:18 | Fatal  [  7] Error renaming file: B:USR\IMPORT.USR

</PRE>This error is followed by multiple Warning 90 messages that list the
transactions that were not processed following the error.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs intermittently and is related to cached file closes under
control of the Microsoft Windows NT operating system.
<P>
For additional information on other causes of Fatal 7 errors, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../pcmail/q134228.htm">Q134228</A></B>
   TITLE     : Err Msg: Fatal [ 7] Error Renaming File

</PRE><h2>RESOLUTION</h2>
 
<P>
The following registry entry has been effective in eliminating the
occurrence of the above errors:
<P>
<PRE>   HKey_Local_Machine\System\CurrentControlSet\Services\LanmanWorkstation
   \Parameters
   CacheFileTimeout=0

</PRE>WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.
<P>
To add this entry on the Windows NT Server where the postoffice resides:

<OL><P><LI>Click Add Value on the Edit menu (not the Add key).

<P><LI>Type the Value Name of CacheFileTimeout.

<P><LI>Change the data type to REG_DWORD (default is REG_SZ).

<P><LI>Click the OK button. You will be prompted for the Data.

<P><LI>Type 0, and click the OK button.

<P><LI>Exit the Registry editor; shutdown and restart the Microsoft
   Windows NT computer.
<P>
</OL>NOTE: This value specifies the maximum times that a file will be left in
the cache after the application has closed the file. In this case, the
parameter was set so that the closed files will not be cached.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
CacheFileTimeout option is not directly related to Opportunistic locking.
Even with the CacheFileTimeout value set to 0, the redirector may still
hold up the close of the file. The opportunistic locking has not been shown
to be a cause of this problem and may be left enabled.
<P>
For additional information on the CacheFileTimeout parameter, please see
the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q102469.htm">Q102469</A></B>
   TITLE     : How To Display Network Registry Parameters

   ARTICLE-ID: <B><A href="../winnt/q102981.htm">Q102981</A></B>
   TITLE     : REG: Workstation Service Entries
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50 oplocks<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCNTMMTA<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 23, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
