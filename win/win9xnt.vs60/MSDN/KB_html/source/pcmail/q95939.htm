

<HTML>
<HEAD>
<TITLE>PC Setup: Installing PC Mail 3.0 on a Novell 3.11 Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95939 ">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1993/03/02">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT=" This article describes the steps for installing Microsoft Mail version 3.0 for PC Networks.  INSTALL MICROSOFT MAIL  1. Install all needed software on the server.  2. Set up Novell groups, access rights, and drive mappings.  3. Use the Mail Administ...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAA1,QDI2,QAFI,QBXB,QATJ,QAZV,QARL,QBV0,QAJH,QBWS,QAH4,QAGU,QDL9,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Setup: Installing PC Mail 3.0 on a Novell 3.11 Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95939 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00   | 3.00
MS-DOS | WINDOWS
kbsetup kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, version 3.0
</UL> 
<P>
This article describes the steps for installing Microsoft Mail version 3.0
for PC Networks.
<P>
<P><h2>INSTALL MICROSOFT MAIL</h2>
 

<OL><P><LI>Install all needed software on the server.

<P><LI>Set up Novell groups, access rights, and drive mappings.

<P><LI>Use the Mail Administrator program (ADMIN.EXE) to set the default
   options and create user mailboxes.

<P><LI>Set up individual workstations.
<P>
</OL><h2>INSTALL ALL NEEDED SOFTWARE ON THE SERVER</h2>
 

<OL><P><LI>Log on to Novell as a Supervisor--not as a supervisor equivalent.
   Logging on as a Supervisor causes all files in the Mail system to be
   stamped with Supervisor ownership. This can reduce the future risk
   ownerless files might pose to smooth operation of the mail system.
<P>
   Decide what network (organization) and postoffice names you will use and
   decide where you want to install the executable files (the MAILEXE
   subdirectory) and the Mail database (the MAILDATA subdirectory). Make a
   note of these; you will use this information while installing each set
   of disks.

<P><LI>Run the INSTALL.EXE program from the Server Version - Disk 1 disk.
   Follow the instructions, inserting disks as prompted, until the Mail
   server is installed. For example:
<P>
<P><PRE>      Enter network type (M)Microsoft or (N)Novell &gt; N
      Enter postoffice name &gt; SEATTLE1
      Enter network name &gt; XYZCORP
      Enter location for the Microsoft Mail executable files
       &gt; f:\apps\mail\exe
      Enter location for the Microsoft Mail data files
       &gt; f:\apps\mail\data
</PRE><P>
   NOTE: You should always install the MS-DOS workstation even if all
   your users will be running different workstation software. The MS-DOS
   client installation copies files needed by other Microsoft Mail
   components. It may also be helpful when you need to troubleshoot the
   Mail system.

<P><LI>Run the INSTALL.EXE program from the MS-DOS-based Workstation Version -
   Disk 1 disk. Follow the instructions, inserting disks as prompted, until
   the MS-DOS workstation client is installed. Give the same directories
   for the executable files and the database as you used in the Server disk
   installation in step 2 above. Continuing with the above example:
<P>
<P><PRE>      Enter drive, path to the Microsoft Mail executable files
       &gt; f:\apps\mail\exe
      Enter drive, path to the Microsoft Mail database
       &gt; f:\apps\mail\data
</PRE><P>
   NOTE: At the "Directory is not empty, continue (Y/N)?:" prompt, press
   Y to continue.

<P><LI>If you will be using the Windows or OS/2 Presentation Manager
   workstation client, run the INSTALL.EXE program from the Windows-based
   and OS/2 Presentation Manager-Based Workstation Version - Disk 1 disk.
   Follow the instructions, inserting disks as prompted, until the
   installation program reports that it has finished. Continuing with the
   above example:
<P>
<P><PRE>      Type the name of your organization.
       &gt; The XYZ Corporation
      Type the drive and path to the Microsoft Mail executable files.
       &gt; f:\apps\mail\exe
</PRE>
<P><LI>If you will be accessing the Mail database on the Novell server from
   connected Apple Macintoshes, you do not need to take any additional
   steps at this time.
<P>
<P>
</OL><h2>SET UP NOVELL GROUPS, ACCESS RIGHTS, AND DRIVE MAPPINGS</h2>
 

<OL><P><LI>Create and add users to a Novell PC Mail group with the following
   trustee rights (or give these rights to the group Everyone)
<P>
<P><PRE>      [ RWCEM  ]  ..\MAILDATA directory **
<PRE></PRE>      [ R    F ]  ..\MAILEXE directory

   where:

      R   Read (open and read files)
      W   Write (open and write to the file)
      C   Create (create a directory)
      E   Erase (delete a directory or file)
      M   Modify (change the attributes or rename a directory or file)
      F   File Scan (see the filename when viewing the directory)

   ** Macintosh and OS/2 clients need File Scan (F) rights to the entire
      database (..\MAILDATA).

   Special cases:

    - You need [ RWCEMF ] rights to the MAILDATA\FOLDERS directories if you
      want to be able to change folder sort orders from within any
      Microsoft Mail MS-DOS client or a Microsoft Mail 2.1 Windows client.

    - You need [ RWCEMF ] rights to the MAILDATA\KEY directory if any
      Microsoft Mail 2.1 Windows clients will be accessing the Mail
      database.

</PRE><P><LI>Add mapping statements to the system login script similar to the
   following, but adjusted for your own configuration:
<P>
<P><PRE>      IF MEMBER OF "pcmail" THEN
<PRE></PRE>         MAP M: = Server_Name/SYS:APPS/MAILDATA
         MAP INS S1: = Server_Name/SYS:APPS/MAILEXE
      END

</PRE><P><LI>Unless otherwise specified, all Mail executable programs for MS-DOS
   assume that the current directory of drive M is the root of the database
   (..\MAILDATA). If the database resides on another drive, add a -Dx
   switch to the command line (where x is the alternate drive letter).
<P>
   For example, use the following command if the current directory of
   drive R is the root of the database:
<P>
<P><PRE>      admin -dr
</PRE><P>
   CRITICAL NOTE: The CURRENT directory of the drive letter used must be
   the ROOT of the database (..\MAILDATA).
<P>
   For example, in the list below, if the directory on the left is the
   current directory when you run a Mail program, the Mail program
   gives you the error message shown on the right:
<P>
<PRE>      Current Directory         Error Message
      ----------------------------------------------------------------

      M:\APPS\MAIL              Could not find mail system database
      M:\APPS\MAIL\EXE          Could not find mail system database
      M:\APPS\MAIL\DATA\LOG     Could not find mail system database

      M:\APPS\MAIL\DATA         (Correct directory--no error message)

   You can verify that the root of the postoffice database is the current
   directory of the drive by changing to that drive and running the MS-DOS
   DIR command. If the Mail database is there, you will see directories
   named ATT, GLB, MBG, and so forth.

   Following are examples of the commands used to map to the root of the
   postoffice database for Novell networks:

      map m:=&lt;Server_Name&gt;/sys:apps\mail\data
      map root r:=&lt;Server_Name&gt;/vol1:maildata

   The Windows workstation software also assumes the database is in the
   current directory of drive M unless told otherwise. It does not require
   that the directory be the current directory, but it does require that
   you specify the full path to the postoffice database. In Microsoft Mail
   3.0, this is done in the MSMAIL.INI file. You can find the MSMAIL.INI
   file in your Microsoft Windows directory.

   To specify the path to the postoffice database for Mail 3.0's Windows
   workstation software, include a "ServerPath=" line in the [Microsoft
   Mail] section of MSMAIL.INI.  For example:

      ----- MSMAIL.INI -----
         [Microsoft Mail]
         ServerPath=F:\apps\mail\data

   NOTE: The system administrator can simplify Windows workstation
   installations by using drive M as everyone's database mapping or by
   editing the MSMAIL.INI file located in the MAILEXE directory on the
   server to include a standard "ServerPath=" line.

</PRE><P><LI>If necessary, you can get by without using any new mappings by hard
   coding the path to the executable files by using a command at a
   command-line prompt or in a batch file. This eliminates the need for
   a MAP INSert search path. Two examples:
<P>
<P><PRE>      C:\&gt;  F:\apps\mailexe\ADMIN
      F:\APPS\MAILDATA\&gt;  ..\mailexe\MAIL
</PRE><P>
   From the MAILDATA directory, load the MS-DOS-based MAIL.EXE or ADMIN.EXE
   program using the -D switch. This switch eliminates the need for a
   specific drive mapping to the root of the database (..\MAILDATA). Two
   examples are:
<P>
<P><PRE>      F:\APPS\MAILDATA\&gt;  ..\mailexe\ADMIN -Df
      R:\GRPAPPS\MAIL\DATA\&gt;  \grpapps\mail\exe\MAIL -Dr
</PRE><P>
   Windows users run their executable files from the local hard disk drive
   so they do not need the MAP INSert search path. The "ServerPath=" line
   replaces most additional mappings needed to the Mail database.
<P>
</OL><h2>SET MAIL'S DEFAULT OPTIONS AND CREATE USER MAILBOXES</h2>
 

<OL><P><LI>Load the Mail Administrator program for the first time by typing the
   following at an MS-DOS prompt:
<P>
<P><PRE>      admin admin -ppassword
</PRE><P>
   NOTE: The above command assumes you are using drive M and have a search
   path to the Mail executable files.
<P>
   If you have customized your setup, enter something similar to the
   following, from the root of the database (adjusted for your own drive
   and path settings):
<P>
<P><PRE>      F:\APPS\MAIL\DATA\&gt; ..\exe\ADMIN admin -Ppassword -Df
</PRE>
<P><LI>Once the Mail Administrator program has loaded, select Local-Admin,
   Options. Look at each of the different options carefully to decide what
   settings you want as the default for newly created users. For more
   details, select a menu option and press the Help (F1) key.

<P><LI>After you set your default options, select Local-Admin, Create to add
   users to the mail system. When you have finished adding some users, exit
   the Administrator program and set up a few workstations. Add the rest of
   your users once you are sure everything is set up the way you want it.
<P>
<P>
</OL><h2>SET UP INDIVIDUAL WORKSTATIONS</h2>
 
<P>
<P><h3>MS-DOS Client</h3>
 
<P>
You do not need to take any additional steps to run the MS-DOS workstation,
as long as the workstation has the appropriate rights to the executable
files and database and can find them both through some form of mapping. You
may, however, want to create a batch file or place the appropriate lines
into a menu system. The following are some examples of how to load the
MS-DOS client:
<P>
<PRE>   MAIL
   MAIL mailbox
   MAIL mailbox -Ppassword -Df

   F:\APPS\MAILDATA\&gt;   \apps\mailexe\MAIL george -Df

   ----- MSMAIL.BAT -----
      @Echo Off
   CD R:\apps\mail\DATA
   R:\apps\mail\EXE\MAIL %Mailbox% -Dr

</PRE></OL>NOTE: For the above batch file to work, your mailbox names and Novell login
names must match and a routine similar to the following must be in your
system login script. You must also have set sufficient MS-DOS environment
space to store the variable:
<P>
<PRE>      IF MEMBER OF "pcmail" THEN
         DOS SET Mailbox="%LOGIN_NAME"
      END

</PRE><h3>Windows Client</h3>
 
<P>
In the "Install All Needed Software on the Server" section above, you
installed the Windows client software to the server. Now you need to run
the SETUP.EXE program from each Windows workstation. Mail's SETUP.EXE file
will be in the Mail executable directory (..\MAILEXE). Running the
SETUP.EXE program will copy selected files to the local workstation. It
will also make the necessary changes to your Windows configuration.
<P>
NOTE: Make sure the user has logged back in since you gave him or her
rights to the mail system.
<P>
To run the SETUP.EXE program, double-click it from File Manager or choose
the File Run command.
<P>
When you load the Windows client on a workstation for the first time, a
Login=&lt;Mailbox&gt; line is added to the local MSMAIL.INI file. The Mailbox
value will be the one used to bring up Mail on the workstation for the
first time. For system administrators, this means the administrator should
log into Mail the first time as the local user, and not as an
administrator. Otherwise, the system administrator must edit the MSMAIL.INI
file.
<P>
If the root of the Mail database is not the current directory on drive M,
you may need to add or modify the "ServerPath=" line in the [Microsoft
Mail] group of the local MSMAIL.INI file.
<P>
<P><h3>OS/2 Client</h3>
 
<P>
Except where noted below, the OS/2 client installation is the same as it is
for the Windows client installation described above.
<P>
NOTE: OS/2 clients require [ RWCEMF ] rights to the MAILDATA directory.
<P>
If you are installing Mail on OS/2 version 1.2 or 1.3, run the PMSETUP.EXE
program from the Novell server instead of the SETUP.EXE program. Verify
that MSMAIL.INI and WIN.INI are in the local OS2\DLL directory.
<P>
If you are installing Mail on OS/2 version 2.0, run the SETUP.EXE program
from the Novell server by choosing the Program Manager File Run command.
Verify that MSMAIL.INI and WIN.INI are located on the local workstation in
the OS2\MDOS\WINOS2 directory.
<P>
<P><h3>Macintosh Client</h3>
 
<P>
The following installation process assumes that you are able to mount your
PC postoffice drive from the Macintosh on which you will be installing the
client software.
<P>
NOTE: Macintosh clients require [ RWCEMF ] rights to the MAILDATA
directory.
<P>
Insert the Apple Macintosh Workstation Version for PC Networks disk and
copy the Microsoft Mail Notifier file to your active system Control Panel
folder. Copy the Microsoft Mail file to any location on the hard drive or
desktop. These are all the necessary files for the Macintosh Mail client.
<P>
Mount the volume containing your PC postoffice and choose the Reshare The
Drive At Startup Time and Save My Name And Password options for that
volume. Double-click the Microsoft Mail icon to launch the Mail program.
You will be presented with the following dialog box:
<P>
<PRE>   The Preference file could not be found. Where is your postoffice
   located?

</PRE>Choose the Find PO option and select the mounted volume containing your
Mail database. Type your mailbox name and password to start Mail. Your
network/mail preferences file is successfully created.
<P>
Quit from the Mail program and restart your Macintosh. This initiates the
notify portion of the Macintosh Mail client, which notifies you of new
mail. The Macintosh Mail client is now installed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 mac client appletalk<BR>
KBCategory: kbsetup kb3rdparty<BR>
KBSubCategory: MailPCSetup<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
