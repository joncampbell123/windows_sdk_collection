

<HTML>
<HEAD>
<TITLE>PC DirSync: Err Msg: Fatal [ 7] Error Renaming File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134228">
<META NAME="KBModify" CONTENT="1996/05/28">
<META NAME="KBCreate" CONTENT="1995/08/02">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; pcmail">
<META NAME="Description" CONTENT="  During a postoffice Directory Synchronization (Dir-Sync), the DIRSYNC.LOG may indicate one of the following errors:     06/12/95 16:52:14 | Status       Microsoft (R) Mail Import V3.2a    06/12/95 16:52:23 | Fatal  [  7] Error renaming file: M:INF\...">
<META NAME="Product" CONTENT="PC Mail">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBF0,QAAP,QAUJ,QBWP,QAEQ,QAFI,QAKP,QAYC,QBB0,QA5E,QAHD,QAEF,QADX,QACM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC DirSync: Err Msg: Fatal [ 7] Error Renaming File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134228</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mail for PC Networks, versions 3.0, 3.2, 3.2a, and 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
During a postoffice Directory Synchronization (Dir-Sync), the DIRSYNC.LOG
may indicate one of the following errors:
<P>
<PRE>   06/12/95 16:52:14 | Status       Microsoft (R) Mail Import V3.2a
   06/12/95 16:52:23 | Fatal  [  7] Error renaming file: M:INF\IMPORT.INF

</PRE>or
<P>
<PRE>   06/08/94 02:47:52 | Status       Microsoft (R) Mail Import V3.2.6
   06/08/94 03:13:25 | Fatal  [  7] Error renaming file: M:USR\IMPORT.USR

</PRE><h2>CAUSE</h2>
 
<P>
In general, IMPORT.EXE generates the above error message when it is unable
to rename the temporary IMPORT.* file to the appropriate &lt;hexid&gt;.INF or
&lt;hexid&gt;.USR file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Generally, this inability to properly rename the files is caused by that
particular file (INF or USR) being inaccessible for some reason. These
reasons may include any of the following:

<UL><LI>The INF is locked open.

<LI>The user account logged into the network and running the Dir-Sync
   processes (DISPATCH.EXE) does not have sufficient rights to the
   postoffice or its subdirectories.

<LI>Insufficient file handles in the CONFIG.SYS of the MS-DOS machine
   running the DISPATCH.EXE process.

<LI>One or more INF (or USR) file in the INF subdirectory is marked as
   read-only.

<LI>Anti virus software operating in "real time" on the server.

<LI>Because of oplocks on the Windows NT server, the reads and writes are
   cached. Removing Opportunistic Locking on the Windows NT server
   experiencing the fatal 7 has been known to resolve this issue. To
   remove Oplocks from the server use REGEDT32.EXE, and change the
   following key;
<P>
   WARNING: Using Registry Editor incorrectly can cause
   serious, system-wide problems that may require you to
   reinstall Windows NT to correct them. Microsoft cannot
   guarantee that any problems resulting from the use of
   Registry Editor can be solved. Use this tool at your own risk.
<P>
   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer
   \Parameters
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Any single postoffice refers to each of the externally defined postoffices
by a hexadecimal identifier (hex-id). For example, one particular
postoffice might refer to another postoffice by identifying it with the hex-
id of 00000005. Therefore, the MBG and KEY files for all outbound mail to
this externally defined postoffice will be 00000005.MBG and 00000005.KEY.
The external user list will exist in 00000005.USR, and any template
information will exist in 00000005.TPL and 00000005.INF (the template
format and information files, respectively). Each of these files will
reside in their appropriate subdirectories.
<P>
When IMPORT.EXE processes during the Dir-Sync cycle, it creates temporary
files to store the completed updated files; two examples of these temporary
files are the IMPORT.INF and IMPORT.USR files. Once the process is
complete, IMPORT.EXE attempts to rename the temporary file to the actual
file name. In this case, IMPORT.EXE would try to rename IMPORT.INF to
00000005.INF or IMPORT.USR to 00000005.USR. The previously listed error
messages are generated in the DIRSYNC.LOG if this renaming process can not
be completed.
<P>
NOTE: The Fatal 7 error is often followed by several Warning 90 messages.
<P>
After the Dir-Sync process completes and one of these error messages is
generated, the IMPORT.INF or IMPORT.USR file may exist in the INF or USR
subdirectory. The mail administrator may wish to attempt to complete the
Dir-Sync process manually.
<P>
First, ensure that none of the problems listed above exist on this
postoffice. Next, run a manual Import by typing in the following command
against the problem postoffice:
<P>
<PRE>   IMPORT -D&lt;drive&gt; ADMIN -P&lt;password&gt; -Y -Q

</PRE>If IMPORT.EXE executes without error, then the problem should be resolved
on that postoffice.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.20 3.20a 3.50<BR>
KBCategory: kbenv<BR>
KBSubcategory: MailPCDirSync<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
