

<HTML>
<HEAD>
<TITLE>INFO: Troubleshooting the Visual Studio Service Pack Download </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175869">
<META NAME="KBModify" CONTENT="1997/12/19">
<META NAME="KBCreate" CONTENT="1997/10/28">
<META NAME="Keywords" CONTENT="VS97FixlistSP2 VS97FixlistSP1 VS97FixlistSP3">
<META NAME="KBArea" CONTENT="Support; KB; vstudio">
<META NAME="Description" CONTENT="  This article describes some common problems users may experience when downloading and installing Visual Studio Service Pack 2.  MORE INFORMATION  1. Scenario: Problem Updating Files  After I completed the Service Pack setup, there were no errors, b...">
<META NAME="Product" CONTENT="vstudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAO0,QAA1,QDI2,QAB4,QA56,QA55,QDIZ,QAXB,QBVV,QAC1,QANE,QAAP,QBS0,QBJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Troubleshooting the Visual Studio Service Pack Download</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 19, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175869</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Studio versions 97, 97sp1, 97sp2
<LI>Microsoft Visual C++, 32-bit Editions, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual J++, version 1.1
<LI>Microsoft Visual InterDev, version 1.0
<LI>Microsoft Visual FoxPro for Windows, version 5.0a
<LI>Microsoft Developer Network, versions April 97, July 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes some common problems users may experience when
downloading and installing Visual Studio Service Pack 2.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Scenario: Problem Updating Files
</OL> 
<P>
After I completed the Service Pack setup, there were no errors, but it did
not seem to update all of my files. I checked the versions of the files
listed in the Readme section "Determining the Update History of the
Products Based on File Versions", and not all of the products were updated.
<P>
Diagnosis and Proposed Solution:
<P>
First, check the VS97SP2.log file to see if setup tried to install that
file. If there is a log entry, then it was in the Service Pack download and
the log file should tell you what went wrong. If there is no log entry, it
could mean that the file did not exist in your computer before you ran the
Service Pack (the Service Pack will typically not update files you do not
already have). The other possibility is that the Service Pack download is
incomplete and missing that file.
<P>
There can be several reasons why the download was incomplete. If you expand
the downloaded files by double-clicking vssp2_1.exe (or vssp2.exe for
Visual Basic-only downloads), some error messages will not be visible long
enough to read. To solve this:

<UL><LI>Delete the Vs97_sp2 directory

<LI>Open a command prompt (a DOS window)

<LI>From inside the command prompt, run vssp2_1.exe (or vssp2.exe for Visual
   Basic only downloads)
<P>
</UL>One possible cause for not getting a complete download is running out of
disk space when running Vssp2_1.exe to create the Vs97_sp2 directory tree.

<OL><P><LI>Scenario: Destination File Error
</OL> 
<P>
When I expanded the downloaded files by running vssp2_1.exe, it gave me the
error message:
<P>
<PRE>   ERROR: Error creating destination file VS97_SP2\all\vb\vb\vba5.dll from
   cabinet file VSSP2_1.EXE

</PRE></OL>Diagnosis and Proposed Solution:
<P>
This is probably caused by running out of hard-disk space. The files you
downloaded are compressed and running vssp2_1.exe decompresses them into
the Service Pack installation directory Vs97_sp2. The uncompressed form can
be more than three times as large as the downloaded files. Either free up
more hard-disk space or use the /L option to specify some other drive and
directory to expand the Service Pack files into: vssp2_1.exe /L x:\temp

<OL><P><LI>Scenario: Problem Finding Setup Executable
</OL> 
<P>
When I ran the Service Pack setup, it said it could not find
Vs97_sp2\enu\setup.exe.
<P>
Diagnosis and Proposed Solution:
<P>
The setup routine in the Vs97_sp2 directory is a language-independent
starter. This starter setup simply checks what kind of language should be
used and then starts the actual setup.exe. There are several different
setup routines localized for different languages. The one with English text
is \enu\setup.exe.
<P>
This problem is another symptom of an incomplete download. Follow the steps
in the answer to number 1 above to see the error messages that might help
resolve the problem.

<OL><P><LI>Scenario: Problem Finding Other Files
</OL> 
<P>
When I ran the Service Pack setup, it said it could not find vssp2_2.cab.
<P>
Diagnosis and Proposed Solution:
<P>
The downloads for CORE, FULL, and VC Alpha are all more than just one file.
Be sure to download all of the files for these versions of the Service
Pack. Another cause for this problem is if you downloaded the CAB files to
a different location than vssp2_1.exe. In that case, simply provide the
location of the cab files on the command line where it is displaying the
error.
<P>
<P><h2>REFERENCES</h2>
 
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

   ARTICLE-ID: <B><A href="../vstudio/q172610.htm">Q172610</A></B>
   TITLE     : INFO: Visual Studio 97 Service Pack 2 Readme

   ARTICLE-ID: <B><A href="../vstudio/q170367.htm">Q170367</A></B>
   TITLE     : HOWTO: Determine VS97 Service Pack Updates in a Product
</PRE></OL> 
<PRE>Keywords          : VS97FixlistSP2 VS97FixlistSP1 VS97FixlistSP3
Version           : WINDOWS:1.0,1.1,5.0,5.0a; WINNT:5.0,97,97sp1,97sp2
Platform          : WINDOWS winnt
Issue type        : kbinfo
Solution Type     : kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 19, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
