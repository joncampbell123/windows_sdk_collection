

<HTML>
<HEAD>
<TITLE>FIX: Errors Occur When Getting Property of VB Project: Crashes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169304">
<META NAME="KBModify" CONTENT="1997/12/18">
<META NAME="KBCreate" CONTENT="1997/05/29">
<META NAME="Keywords" CONTENT="VS97FixlistSP2 VS97FixlistSP1 VB5FixlistSP2 vb5all VB5FixlistSP1 VS97FixlistSP3">
<META NAME="KBArea" CONTENT="Support; KB; vstudio">
<META NAME="Description" CONTENT="  Errors occur when getting property of a Visual Basic Project and the program crashes. The random nature of this reproducible scenario is due to the fact that the add-ins are loaded in random order. This behavior may not be reproducible if the sourc...">
<META NAME="Product" CONTENT="vstudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA55,QA56,QAB4,QDKA,QAMA,QA5F,QAAP,QAO4,QDO3,QABI,QAR4,QAPN,QAH4,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Errors Occur When Getting Property of VB Project: Crashes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169304</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Studio 97
<LI>Microsoft Visual Basic Learning, Professional, and Enterprise Editions
   for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Errors occur when getting property of a Visual Basic Project and the
program crashes. The random nature of this reproducible scenario is due to
the fact that the add-ins are loaded in random order. This behavior may not
be reproducible if the source code control add-in is listed before the
repository's add-in.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
At the beginning of this article. This has been fixed with Visual Studio
Service Pack 1.
<P>
For additional information about the Visual Studio 97 Service Pack 1,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Order of Source code control and Repository is important in the event
chain.
<P>
Steps to reproduce:

<OL><P><LI>Edit the VBADDIN.INI and add the following line: Repository.VBAddin=1.

<P><LI>Run Visual Basic 5.0. In the Tools and Add-Ins menus, verify that Visual
   SourceSafe and Repository have been loaded.

<P><LI>Open one of the sample projects, such as:
   "\samples\entrpris\hello\Helo_cli.vbp."

<P><LI>When prompted with "add this project to SourceSafe," answer Yes. Log on
   and make sure all files are selected to be added to Visual SourceSafe.
<P>
</OL>Result:
<P>
<PRE>   "Error message - Microsoft Repository Add-In for Visual Basic.

   An error occurred getting a property of a Visual Basic Project. The
   requested operation cannot be performed because a transaction is not
   currently active.

   Microsoft Repository Add-In for Visual Basic is shutting down."

</PRE></OL>After you press OK on the error dialog box, Visual Basic also shuts down.
<P>
If you re-run Visual Basic and try to re-load the same project, Visual
Basic will ask if you want to get the latest version of the files from
Visual SourceSafe. If you answer Yes, the same error occurs and Visual
Basic shuts down again.
 
<PRE>Keywords          : VS97FixlistSP2 VS97FixlistSP1 VB5FixlistSP2 vb5all VB5FixlistSP1 VS97FixlistSP3
Version           : 5.0 97
Platform          : NT WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
