

<HTML>
<HEAD>
<TITLE>INFO: Visual Studio 97 Service Pack 3 Readme </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176066">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1997/10/31">
<META NAME="Keywords" CONTENT="VS97FixlistSP2 VS97FixlistSP1 VSInfoView VS97FixlistSP3">
<META NAME="KBArea" CONTENT="Support; KB; vstudio">
<META NAME="Description" CONTENT="  This is a copy of the Visual Studio 97 Service Pack 3 Readme (English language version).  MORE INFORMATION  Microsoft Visual Studio 97 Service Pack 3 Readme  The Microsoft Visual Studio 97 Service Pack 3 Readme contains the following sections:   - ...">
<META NAME="Product" CONTENT="vstudio">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QA55,QA56,QAA1,QAR4,QAXB,QDI2,QBS0,QBRJ,QAB5,QBVV,QBV9,QAAP,QAC1,QAM1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Visual Studio 97 Service Pack 3 Readme</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176066</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual Studio versions 97, 97sp1, 97sp2, 97sp3
<LI>Microsoft Visual C++, 32-bit Editions, version 5.0
<LI>Microsoft Visual Basic Professional and Enterprise Editions for
   Windows, version 5.0
<LI>Microsoft Visual J++, version 1.1
<LI>Microsoft Visual FoxPro for Windows, version 5.0a
<LI>Microsoft Visual InterDev, version 1.0
<LI>Microsoft Visual SourceSafe, 32-bit, for Windows, version 5.0
<LI>Microsoft Developer Network April 97
<LI>Microsoft Developer Network July 97
<LI>Microsoft Developer Network October 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This is a copy of the Visual Studio 97 Service Pack 3 Readme (English
language version).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Microsoft Visual Studio 97 Service Pack 3 Readme</h3>
 
<P>
The Microsoft Visual Studio 97 Service Pack 3 Readme contains the following
sections:

<UL><LI>Microsoft Visual Studio 97 Service Pack 3 provides an overview of Visual
   Studio Service Pack 3.

<LI>Installing the Microsoft Visual Studio 97 Service Pack 3 provides
   installation and setup instructions.

<LI>Notes on Fixes in the Visual Studio 97 Service Pack 3 provides overall
   information on the fixes and the interactions with other products.

<LI>Finding More Information on Issues Resolved with This Service Pack
   provides instructions on how to search online for the Knowledge Base
   articles, and a list of the fixes and their summaries.
<P>
</UL><h3>Microsoft Visual Studio 97 Service Pack 3</h3>
 
<P>
The Microsoft Visual Studio 97 Service Pack 3 includes all of the fixes in
Service Pack 1 and 2, and upgrades the following Visual Studio
applications:
<P>
<PRE> Microsoft Visual Studio 97 (Professional and Enterprise Editions)
 Microsoft Visual Basic, version 5.0 (Professional and Enterprise Editions)
 Microsoft Visual C++, version 5.0 (Professional and Enterprise Editions)
 Microsoft Visual InterDev
 Microsoft Visual J++, version 1.1
 Microsoft Visual SourceSafe, version 5.0
 Microsoft Visual FoxPro, version 5.0
 Microsoft Developer Network (MSDN) Library

</PRE>These Visual Studio applications should be shut down before installing this
Service Pack. Install this Service Pack whenever you have updated or
changed any of the applications in Visual Studio to ensure that you have
the latest fixes.
<P>
NOTE: The Visual Studio 97 service packs are not intended for use with the
Learning Edition of Visual C++ 5.0.
<P>
<P><h3>Installing the Microsoft Visual Studio 97 Service Pack 3</h3>
 
<P>
To install the Service Pack, insert the compact disc into your computer's
CD-ROM drive. If you have downloaded and decompressed the Service Pack, or
if the Service Pack Setup does not automatically launch, go to the root
directory of the Service Pack and run Setup. The setup.exe will detect the
language of your computer's operating system and run one of the following
setups:
<P>
<PRE>   \fra\setup (French)
   \deu\setup (German)
   \enu\setup (English)
   \jpn\setup (Japanese)
   \esp\setup (Spanish)
   \kor\setup (Korean)
   \chs\setup (Simplified Chinese)
   \cht\setup (Traditional Chinese)
   \ita\setup (Italian)

</PRE>The Service Pack Setup detects any installed Visual Studio applications and
the specific languages those applications use. (Files are checked for
language, determined by the operating system settings and the individual
file settings.) This Service Pack supports the following languages: Czech,
English, French, German, Italian, Japanese, Korean, Portuguese, Russian,
Simplified Chinese, Spanish, and Traditional Chinese.
<P>
During the installation, the Service Pack displays the files to be
installed or updated based on the installed applications detected. After
updating your installation of any of the Visual Studio applications, the
Service Pack appends any actions to the VS97SP3.log file, which is stored
in the root directory of the drive where Windows is installed. If you run
the Service Pack again, any additional file updates are appended to the end
of the log file.
<P>
<P><h3>Determining the Files That Setup Installs</h3>
 
<P>
Setup does not install all the files included in this Service Pack on your
computer.
<P>
If the file does not exist already on your computer, in most cases Setup
will not install an update for it. Setup does not make any entries in the
log for files that are not present.
<P>
If the file on your computer is a more recent version than the one in the
Service Pack, Setup will not update the file on your computer. The setup
log will state "File is up to date" for each file on your computer that is
the same version or more recent than what is on the Service Pack.
<P>
Some .cab files are included in the Service Pack for redistribution only.
Setup does not install them as part of the product update. You must copy
them from the compact disc as needed.
<P>
<P><h3>Interpreting the Setup Log File</h3>
 
<P>
Setup will perform one of two actions for each file in its file list. If
Setup detects that a file is not installed on your computer and the file is
not required, Setup will neither install it nor create a report in the log.
Otherwise, Setup will report in the log one of the following conditions for
each file in its list:

<UL><LI>"Copied successfully":  The file on your computer was successfully
   updated with the file in Setup's list.

<LI>"Rename on reboot":  The file on your computer was in use during the
   copy process. It will be replaced with the Service Pack copy on the next
   system reboot.

<LI>"File is up to date":  The version information contained in the Service
   Pack file is the same or older than the file on your computer. (Setup
   will also report this message if the date of any file, such as a text
   file, that does not have version information, is later than the date of
   the Service Pack file.)
<P>
</UL>All other errors, such as "Access denied" or "The system cannot find the
path specified," are the operating system's error messages for a particular
problem. These errors indicate that Setup could not update the file.
<P>
Updating Files Previously Modified
 
<P>
The primary way Setup determines which files to replace is by checking the
version information in a file's resources. However, some files, such as
text files and non-binary files, have no resource information. In these
cases, Setup uses the time stamp to determine which files need to be
replaced.
<P>
If you have altered the time stamp on any of the Visual Studio component
text files or files that do not have version information, then Setup may
not replace those files. Source files and header files are examples of some
files you might have changed. Check the setup log to determine which files
have been updated. You must evaluate each of the files that is not updated
to determine whether you should use the Service Pack version.
<P>
<P><h3>Determining the Update History of the Products Based on File Versions</h3>
 
<P>
To determine which updates have been made since the initial release of a
product, you will need to examine the version number in the properties of
one or more files.
<P>
To determine the update status of a product:

<OL><P><LI>Look in the table below to determine which file you want to examine. In
   some cases, you may need to examine more than one file to determine
   fully the product's update history.

<P><LI>For each file, right-click the file in Windows Explorer, then click
   Properties.

<P><LI>Click the Versions tab and compare the version listed with the version
   in the table.
<P>
</OL>The following table lists the developer tools that shipped in 1997 and have
been updated in a Visual Studio 97 Service Pack. It also lists the key
files you should check to ascertain version information:
<P>
<PRE>                         Version on
Product      Files        Release     SP1         SP2         SP3
</PRE></OL> 
<P>
<PRE>Visual       setupwiz.exe 5.00.3716   5.00.3905   5.00.3905   5.00.3905
Basic 5.0    vb5ide.dll   5.00.3724   ---         5.00.4319   5.00.4511
             vba5.dll     5.00.7115   ---         5.00.7717   5.00.7911


Visual       link.exe     5.00.7022   5.02.7132   5.02.7132   5.10.7303
C++ 5.0      eecxx.dll    5.00.7122   ---         5.00.7198   5.00.7198

</PRE>Visual
<PRE>InterDev 1.0 devisws.pkg  5.00.7022   5.00.7087   No update   No update

Visual       devjava.pkg  5.00.7022   5.00.7128   5.00.7128   5.00.7128
J++ 1.1      devdbg.pkg   5.00.7022   5.00.7128   5.00.7198   5.00.7198
             emjav.dll    1.01.7022   ---         ---         1.01.7287

</PRE>Visual
<PRE>SourceSafe   ssscc.dll    5.00.2218   5.00.2219   5.00.2220   5.00.2222
5.0

</PRE>Visual
<PRE>FoxPro 5.0   vfp.exe      Build 402   No update   Build 412   Build 415

</PRE>NOTE: "No update" means that the product has no updates in the Service
Pack. Also note that even for updated products, some of the files did not
change from one Service Pack to the next.
<P>
The InfoViewer tool is used to display online Help for Visual Studio and
MSDN. It has also been updated several times. However, files were not
changed for Service Pack 3:
<P>
<PRE>            Version on
Files       Release     MSDN April  SP1         MSDN July   SP2
</PRE> 
<PRE>ivauto.dll  5.00.7022   5.00.7022   5.00.7055   5.00.7055   5.00.7198
deviv.pkg   5.00.7022   5.00.7022   ---         5.00.7022   5.00.7198

</PRE>References to Service Pack 2 in Visual Basic 5.0 point to files that were
not changed in Service Pack 3.
<P>
After you install Visual Studio 97 Service Pack 3, in Visual Basic 5.0 you
will encounter many references to Service Pack 2. These references are not
bugs. Rather, they indicate that files did not change in this current
Service Pack.
<P>
Installing the correct version of  MFC42.dbg and MSCVCRT.dbg on your
computer:
<P>
You need the Visual Studio 97 Service Pack 3 version of MFC42.dbg and
MSVCRT.dbg to debug dynamically linked retail builds of MFC applications in
Visual C++ 5.0. You might not have the correct version of these files if
you installed Visual C++ 5.0 at a later date.
<P>
To ensure that your computer has the correct version of these files, copy
the Service Pack 3 version of MFC42.dbg and MSVCRT.dbg from the
\All\VC\Debug directory of the Service Pack compact disc or the expanded
image of the Service Pack web download. Place these files in the
\Windows\System directory of your Windows 95 computer or the \WinNT\System
32 directory of your Windows NT computer.
<P>
Replacing the default version of ATL.dll installed by Visual Studio 97
Service Pack 3:
<P>
Setup for Visual Studio 97 Service Pack 3 will install the ANSI version of
ATL.dll by default on both Windows NT and Windows 95 computers. On Windows
NT computers, you may choose to replace this file with the Unicode version
of ATL.dll, also supplied in this Service Pack. To do this, copy the
ATL.dll file from the \all\vc\redist\directory of the Service Pack compact
disk or from the expanded image of the Service Pack 3 web download, as
appropriate.
<P>
<P><h3>Updating the Microsoft Developer Network Installation on Your Computer</h3>
 
<P>
Visual Studio 97 Service Pack 3 recognizes previous releases of the MSDN
Library, but it will not recognize the October release. The MSDN Library's
October release writes an incorrect value to a registry key.
<P>
IMPORTANT: If you plan to install or have installed the October release of
the MSDN Library, and you plan to install Visual Studio 97 Service Pack 3,
do the following before you install the Service Pack:

<OL><P><LI>Click the Start button, then click Run. Type "regedit" to start the
   Registry Editor, and click OK.

<P><LI>Go to the registry key
   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevStudio\5.0\Products\Microsoft
   Developer Network. Note that the October MSDN Library creates a
   ProductDir value of C:\Program Files\DevStudio\MSDN\BIN\MSDN\BIN.

<P><LI>Change the ProductDir value to read
   C:\Program Files\DevStudio\MSDN\BIN.

<P><LI>Close the Registry Editor and run the Service Pack Setup. Verify that
   there is an entry for "Microsoft Developer Network" in the Installed
   Products detected dialog box, which appears just after the license
   agreement.
<P>
</OL><h3>Uninstalling the Visual Studio 97 Service Pack</h3>
 
<P>
The Service Pack cannot be uninstalled independently of the product tools
being updated. To uninstall the Service Pack updates to a Visual Studio 97
tool, such as Visual C++ or Visual Basic, you must uninstall the tool. The
Service Pack updates will be uninstalled with it. Then, reinstall the tools
without the updates.
<P>
Because many interdependent components of the Visual Studio 97 tools are
simultaneously updated by the Service Pack, the products may become
unstable if you roll back of some of the updates, or if you run Setup in
maintenance mode from the original product compact disc. This instability
can occur because of the combination of files that are updated and files
that are not updated.
<P>
To avoid an unstable combination of updated and old files, you must remove
all of the Visual Studio 97 tools completely if you want to remove the
Service Pack updates or if you want to remove parts of the product. If you
had not installed everything in your Visual Studio suite before applying
the Service Pack and you now want to add some of the remaining components,
make the additions first, then apply the Service Pack.
<P>
<P><h3>Notes on Fixes in the Visual Studio Service Pack 3</h3>
 
<P>
Microsoft Visual Studio 97 Service Pack 3 includes all of the fixes in
Service Pack 1 and 2.
<P>
Do Not Use the Microsoft Utility RegClean 4.1 with Visual Studio or Any
Visual Studio Applications.
<P>
If you run RegClean 4.1 (build 97.71), you might find (if you have Visual
C++ Enterprise or Visual Basic Enterprise installed) that the Database
Designer no longer works, or (if you have Visual InterDev installed) the
Database Designer and LinkView tools no longer work. If you have run
RegClean, reinstall the Visual Studio applications, as appropriate.
<P>
<P><h3>Active Server Pages (ASP) Browser Component Does Not Recognize the Browser</h3>
 
<P>
If you are installing a new release of Microsoft Internet Explorer or
Netscape Navigator, the ASP browser component object may not work in Visual
Studio. The string identifying the browser may not be present in the
browsecap.ini file, which is located on the Web server. The solution is to
either manually change the file or download a newer version of the file
from the Internet Information Server (IIS) web site.
<P>
The version of the browsecap.ini file that currently ships with the Visual
InterDev server components does not recognize Microsoft Internet Explorer
3.02 as a valid browser. This results in an error when running an .asp page
using the browser component in Microsoft Internet Explorer 3.02.
<P>
An updated version of the browsecap.ini file as well as a 1.0b updated
version of Active Server Pages is available at:
<B><A href="http://www.microsoft.com/iis/">http://www.microsoft.com/iis/.</A></B> Once there, click the "Get IIS" button and
choose "Other free software," then "Updates for IIS." Choose a new
compressed or uncompressed browsecap.ini file to download.
<P>
A full download of Active Server Pages English 1.0b is available under "Get
IIS" as well. The 1.0b English version provides full DBCS enabling and some
fixes.
<P>
<P><h3>Updates to SQL Server and Visual Database Tools</h3>
 
<P>
You must download SQL Server Service Pack 2 for working with Visual
Database Tools and/or Visual InterDev.
<P>
The SQL Server Service Pack 2 is available at:
<B><A href="http://www.microsoft.com/sql/servicepak.htm">http://www.microsoft.com/sql/ServicePak.htm.</A></B>
<P>
SQL Server Service Pack 2 fixes several issues with the relational engine
of Visual Database Tools including:

<UL><LI>A query with two or more RIGHT/LEFT OUTER JOIN clauses resulted in a
   syntax error.  Now they parse correctly and generate the correct result.

<LI>Some "complex" queries and views with five or more tables would stop the
   server.  This resulted in a TDS Protocol error and a subsequent stop of
   Visual Studio. This issue has been corrected.
<P>
</UL>Visual Database Tools/Visual InterDev still requires, as a minimum, SQL
Server Service Pack 1, but installing SQL Server Service Pack 2 is
recommended.
<P>
<P><h3>Microsoft Internet Explorer Security Options and InfoViewer</h3>
 
<P>
InfoViewer, the integrated online documentation viewer included with MSDN
and Visual Studio, relies on the Microsoft Internet Explorer security
settings for active content. The online documentation included with MSDN
and Visual Studio includes some active content. If you set your Microsoft
Internet Explorer security's maximum security options while browsing the
World Wide Web, some types of hyperlinks in your online documentation will
not work.
<P>
Allowing Microsoft Internet Explorer to download an ActiveX control and
then automatically executing the downloaded code is a legitimate security
concern. However, you can protect against this problem and still use the
online documentation included with MSDN and Visual Studio. To do so,
complete the following steps:

<OL><P><LI>On the View menu in Microsoft Internet Explorer, click Options.

<P><LI>Click Security.

<P><LI>Make the following changes under "Active Content:"
<P>
   a. Clear the "Allow downloading of active content" check box.
<P><PRE>      (This option ensures that no unknown active content will be
      downloaded from a World Wide Web site.)
</PRE><P>
   b. Select the "Enable ActiveX controls and plug-ins" check box.
<P><PRE>      (This option enables local ActiveX controls, such as those supplied
      with MSDN and InfoViewer, to execute.)
</PRE><P>
   c. Select the "Run ActiveX scripts" check box. (This option allows local
<P><PRE>      ActiveX scripts to execute.)
</PRE>
<P><LI>Click OK.

<P><LI>Restart Visual Studio.
<P>
</OL><h3>Special Instructions for Visual C++ for Microsoft Windows CE</h3>
 
<P>
Customers of Visual C++ for Windows CE may experience problems with the
Visual Studio family of products. If you want to install any part of the
Visual Studio Service Pack, uninstall Visual C++ for Windows CE first. If
you encounter any problems using Visual C++ for Windows CE with Visual
Studio, call Visual C++ for Windows CE product support. If further
information becomes available, it will be posted on the web site for Visual
Studio 97 Service Packs (<B><A href="http://www.microsoft.com/vstudio/sp/">http://www.microsoft.com/vstudio/sp/)</A></B> and in the
Knowledge Base (available on the web at <B><A href="http://www.microsoft.com/kb/)">http://www.microsoft.com/kb/).</A></B>
<P>
<P><h3>Updating Visual C++ .map Files</h3>
 
<P>
Visual Studio 97 Service Pack 2 updates the following .map files if you
installed them in your system or system32 directory with Visual C++ 5.0.
If you installed these .map files to a different location, used some
derivative of these files, or used the .map files directly from the Visual
C++ 5.0 compact disc, you will need to update these files manually or
reference them directly from the Service Pack 2 compact disc. You can find
the Service Pack 2 updates to these files in the \all\vc\debug directory on
the Visual Studio Service 97 Pack 2 compact disc.
<P>
<PRE>  Mfc42.map
  Mfc42d.map
  Mfc42u.map
  Mfc42ud.map
  Mfcd42d.map
  Mfcn42d.map
  Mfcn42ud.map
  Mfco42d.map
  Mfco42ud.map

</PRE></OL><h3>Microsoft Transaction Server Updates</h3>
 
<P>
This Service Pack does not include any updates to the Microsoft Transaction
Server. To gain access to the Microsoft Transaction Server service packs
released since it shipped with the Enterprise Editions of Visual Studio 97,
Visual Basic 5.0, and Visual C++ 5.0, go to
<B><A href="http://www.microsoft.com/support/transaction/">http://www.microsoft.com/support/transaction/.</A></B>  This site contains pointers
to Microsoft Transaction Server 1.1 for x86, Service Pack 2 for Digital
Alpha, and the Microsoft Transaction Server SDK beta.
<P>
InstallShield Express for Japanese Visual C++ 5.0
<P>
The additional files required for the custom edition of InstallShield
Express that is included with the Japanese release of Visual C++ 5.0 are
now available. Please refer to \jpn\IShield\readme.txt for details.
<P>
<P><h3>Finding More Information on Issues Resolved with This Service Pack</h3>
 
<P>
The Microsoft Knowledge Base contains articles that provide more in-depth
information about the Visual Studio issues that are fixed in this Service
Pack. To locate these articles, go to <B><A href="http://support.microsoft.com/support/">http://support.microsoft.com/support/</A></B>
and follow the instructions below to build a query.
<P>
To build a Visual Studio Service Pack query:

<OL><P><LI>Choose a product. (In this case, click "Any Products.")
</OL>2. Click on more search options to get choices about how you will search.
3. Specify the type of search. This should be set to "Keyword or Boolean
<PRE>   search."
</PRE></OL>4. Enter the following as your search phrase:
<P>
<PRE>    VS97FixlistSP3

</PRE><P><LI>Click "Find."
<P>
</OL>Knowledge Base articles that contain VS97FixlistSP3, but do not contain
VS97FixlistSP1 or VS97FixlistSP2, describe fixes that were added in Service
Pack 3. Because Service Pack 3 includes all of the fixes in Service Pack 1
and Service Pack 2, all of the articles describing the fixes in Service
Pack 1 will contain all three keywords: VS97FixlistSP1, VS97FixlistSP2, and
VS97FixlistSP3. Articles describing fixes in Service Pack 2 will contain
the VS97FixlistSP1 and VS97FixlistSP2 keywords. To find just those new
items that were fixed in Service Pack 3, search for:
<P>
<PRE>    VS97FixlistSP3 and not VS97FixlistSP2

</PRE></OL>For a file containing all of the text from all of the Knowledge Base
articles, look on the web site for Visual Studio 97 Service Packs:
<B><A href="http://www.microsoft.com/vstudio/sp/">http://www.microsoft.com/vstudio/sp/.</A></B>
<P>
<P><h3>InfoViewer KB Articles</h3>
 
<P>
Service Pack 1 fixes some problems with saving samples to directories that
contain high-ASCII characters in the path.
<P>
<PRE><B><A href="../vstudio/q168264.htm">Q168264</A></B>   Copying Samples to a Dir with High ASCII Stops File I/O
<B><A href="../vstudio/q168265.htm">Q168265</A></B>   Error "Microsoft Jscript error" After Copying Sample

</PRE>Service Pack 2 fixes a bug preventing the download of samples with certain
versions of Microsoft Internet Explorer. It also fixes a search results-
related performance problem in which Developer Studio sometimes uses 100
percent of idle time. The Service Pack fixes a bug that causes repeated
"Merging keywords" for anyone who does not have administrator privileges in
Windows NT. It fixes a limitation on the total number of InfoViewer titles.
<P>
<PRE><B><A href="../vstudio/q171844.htm">Q171844</A></B>   FIX: InfoViewer Cannot Download Samples if IE4.0 is Installed
<B><A href="../vstudio/q171845.htm">Q171845</A></B>   FIX: Results List Uses 100% of CPU on Idle
<B><A href="../vstudio/q171846.htm">Q171846</A></B>   Limit on the Total Number of InfoViewer Titles
<B><A href="../vstudio/q171847.htm">Q171847</A></B>   Merging Keywords for Search Requires Admin Privileges

</PRE>Visual Basic 5.0 KB Articles
<P>
The following is a summary of bug fixes followed by a list of Knowledge
Base articles, arranged by Service Pack.
<P>
Service Pack 1 addresses problems in dbgrid32.ocx, msrdc20.ocx, and
msrdo20.dll related to data-binding and other issues. Also included are
fixes for the incompatibility problems with comctl32.ocx. There is also an
update to the VB5 Setup Kit and some of the .cab files for the ActiveX
component download. These .cab files are not installed by the Visual Studio
Service Pack, but are included on the Service Pack compact disc.
<P>
<PRE><B><A href="../vbwin/q167122.htm">Q167122</A></B>   FindItem Method of ListView Incorrectly Returns an Error
<B><A href="../vbwin/q167123.htm">Q167123</A></B>   COMCTL32.OCX Is Binary Incompatible with Previous Version
<B><A href="../vbwin/q167947.htm">Q167947</A></B>   ODBC CAB File Does Not Install 16-bit ODBC Files
<B><A href="../vbwin/q167948.htm">Q167948</A></B>   Internet Component Download Fails After Using Setup Toolkit
<B><A href="../vbwin/q167950.htm">Q167950</A></B>   DAO Internet Component Download Fails to Install

<B><A href="../vbwin/q167951.htm">Q167951</A></B>   AUTMGR32.EXE Fails After Component Download
<B><A href="../vbwin/q168153.htm">Q168153</A></B>   DBGrid Bound to RDC Displays a Single Row After MoveLast
<B><A href="../vbwin/q168155.htm">Q168155</A></B>   Crash When Resizing Column of Split DBGrid
<B><A href="../vbwin/q168156.htm">Q168156</A></B>   DBGrid Bound to RDC Displays Small ResultSets Incorrectly
<B><A href="../vbwin/q168157.htm">Q168157</A></B>   Problems Binding Multiple Controls to RDC 2.0

<B><A href="../vbwin/q168158.htm">Q168158</A></B>   Can't Close Resultset if DBGrid Bound to RDC
<B><A href="../vbwin/q168159.htm">Q168159</A></B>   DBCombo Updates Incorrectly When Using RDC Bound ListSource
<B><A href="../vbwin/q168160.htm">Q168160</A></B>   Error on Update After AddNew With RDC and Bound Controls
<B><A href="../vbwin/q168161.htm">Q168161</A></B>   Distributed Transaction Fails On Subsequent Runs
<B><A href="../vbwin/q168162.htm">Q168162</A></B>   RDO Move 0 Fails to Refresh Record

<B><A href="../vbwin/q168163.htm">Q168163</A></B>   Memory Leak When Calling UserConnection Query Event
<B><A href="../vstudio/q169302.htm">Q169302</A></B>   Get_Item() Does Not Return Error When Property Not Found
<B><A href="../vstudio/q169303.htm">Q169303</A></B>   Get_Item() Doesn't Find Property Defined on Ancestor Iface
<B><A href="../vstudio/q169304.htm">Q169304</A></B>   Errors Occur When Getting Property of VB Project: Crashes
<B><A href="../vstudio/q169305.htm">Q169305</A></B>   Repository Error after Halting Execution in Break-mode Edit

<B><A href="../vstudio/q169306.htm">Q169306</A></B>   ReComputeRepository GPFs if Passed Non-existent DB Name
<B><A href="../vstudio/q169307.htm">Q169307</A></B>   RepUtil:CompactJetRepository Doesn't Work with DSN Name
<B><A href="../vstudio/q169308.htm">Q169308</A></B>   CompactJetRepository Only Recognizes Lowercase Jet db Names
<B><A href="../vstudio/q169309.htm">Q169309</A></B>   Adding ActiveX Designer/Userconnection Results in Shutdown
<B><A href="../vstudio/q169331.htm">Q169331</A></B>   RecomputeRepos: Won't Work with Database Created by UML.DLL

<B><A href="../vstudio/q169332.htm">Q169332</A></B>   Changing Obj Name Before Saving Results in Repository Error
<B><A href="../vstudio/q169333.htm">Q169333</A></B>   Engine: Collection Not Updated After Removing an Item
<B><A href="../vstudio/q169334.htm">Q169334</A></B>   IRepos::Get_Name() Returns Error if Called on a Property
<B><A href="../vstudio/q169335.htm">Q169335</A></B>   CDatabase::InsRelshipRow Does Not Release Collection Obj
<B><A href="../vstudio/q169336.htm">Q169336</A></B>   Engine Item Method Takes Parameter Type of IntID

<B><A href="../vstudio/q169337.htm">Q169337</A></B>   Unable To Remove a Relationship from Collection with OBJID
<B><A href="../vstudio/q169339.htm">Q169339</A></B>   RepUtil.DLL Doesn't Contain Version or Copyright Information

</PRE>Service Pack 2 updates Visual Basic version 5.0 Professional and Enterprise
editions. It enables apartment-model threading for Visual Basic projects
that contain user interface elements, such as forms and controls. This
apartment-model threading enhancement is explained in vb5sp2.htm
(vb5sp2.wri on some systems), which supplements the online documentation
you received as part of your licensed copy of Visual Basic.
<P>
Service Pack 2 fixes problems with the development environment, the Printer
object, the Internet Transfer control, and many of the other controls and
libraries that ship with Visual Basic 5.0.
<P>
In the development environment, the following issues were resolved: several
stability problems, including crashes that sometimes occurred when moving
the cursor over the toolbox, when setting the Font properties of multiple
controls, and when using the Format menu options to align controls.
<P>
For the Printer object: Setting the Printer object to an item in the
Printers collection will now switch the default printer. You can now set a
user-defined scale mode for the Printer object by changing the ScaleWidth
and ScaleHeight properties. Font attributes are no longer lost when calling
the NewPage method.
<P>
Internet Transfer control: POST now works. Problems with missing or garbled
data are fixed. The control no longer converts file names to upper case
when sending out a request, thus eliminating reported problems accessing
case-sensitive servers.
<P>
Visual Basic 5.0 for Service Pack 2 includes a new master dependency file
(vb5dep.ini), which is installed in the Setupkit directory.  The existing
dependency file is renamed ~vb5dep.sp2.
<P>
<PRE><B><A href="../vbwin/q166908.htm">Q166908</A></B>   ScaleMode for Printer Object Can't Create Custom Scale
<B><A href="../vbwin/q167107.htm">Q167107</A></B>   Missing Controls on the SSTAB Control Tabs
<B><A href="../vbwin/q167165.htm">Q167165</A></B>   Too Many Controls on a Form May Crash Visual Basic IDE
<B><A href="../vbwin/q167213.htm">Q167213</A></B>   Invalid Page Fault When Shutting Down Visual Basic 5.0
<B><A href="../vbwin/q167346.htm">Q167346</A></B>   GPF Occurs When Starting Visual Basic 5.0

<B><A href="../vbwin/q167706.htm">Q167706</A></B>   Internet Transfer Control 5.0 "POST" Request Doesn't Work
<B><A href="../vbwin/q167735.htm">Q167735</A></B>   Setting Printer to Item in the Printers Collection Fails
<B><A href="../vbwin/q168290.htm">Q168290</A></B>   GPF When Setting Font of Multi-selected Controls
<B><A href="../vbwin/q168744.htm">Q168744</A></B>   Printer May Lose Font Attributes
<B><A href="../vbwin/q168766.htm">Q168766</A></B>   Internet Transfer Control Fails on Case-Sensitive Server

<B><A href="../vbwin/q168792.htm">Q168792</A></B>   Statusbar Time Panel May Not Update Properly
<B><A href="../vbwin/q171470.htm">Q171470</A></B>   Resize Event Not Fired When UserControl Copied and Pasted
<B><A href="../vbwin/q171471.htm">Q171471</A></B>   VB-Created Controls Fail to Print with UserControl_Paint
<B><A href="../vbwin/q171472.htm">Q171472</A></B>   Toggling PortOpen w/MSCOMM32.OCX Leaks Memory on Win95
<B><A href="../vbwin/q171473.htm">Q171473</A></B>   MCI32.OCX Does Not Save Recorded .WAV Files

<B><A href="../vbwin/q171474.htm">Q171474</A></B>   Path Problems Using Project on Network Server
<B><A href="../vbwin/q171475.htm">Q171475</A></B>   RichTextBox Cleared When BorderStyle Changes at Run-Time
<B><A href="../vbwin/q171476.htm">Q171476</A></B>   Masked Edit Control Right-Aligned with NT 4.0 SP3
<B><A href="../vbwin/q171477.htm">Q171477</A></B>   Format Menu Options Can Crash Visual Basic 5.0
<B><A href="../vbwin/q171478.htm">Q171478</A></B>   Cannot Set Width/Height of UserControl in Resize Event

<B><A href="../vbwin/q171479.htm">Q171479</A></B>   Mod 0 Causes an IPF or Access Violation
<B><A href="../vbwin/q171480.htm">Q171480</A></B>   Setting SelAlignment Property Does Not Affect RichTextBox
<B><A href="../vbwin/q171481.htm">Q171481</A></B>   Cannot Set the Enabled Property of an UpDown Control
<B><A href="../vbwin/q171482.htm">Q171482</A></B>   Crash When Enum Name Referred to Incorrectly
<B><A href="../vbwin/q171483.htm">Q171483</A></B>   Crash When Rebuilding EXE Containing UserControl

<B><A href="../vbwin/q171484.htm">Q171484</A></B>   Code Module Window Displayed Transparently in SDI
<B><A href="../vbwin/q171485.htm">Q171485</A></B>   Visual Basic 5.0 Title Bar Paints Incorrectly
<B><A href="../vbwin/q171486.htm">Q171486</A></B>   Crash Sometimes Occurs with Cursor over Toolbox
<B><A href="../vbwin/q171487.htm">Q171487</A></B>   Crash When Assigning Uninitialized Object to Tag
<B><A href="../vbwin/q171488.htm">Q171488</A></B>   Val Function Recognizes System Decimal Symbol

<B><A href="../vbwin/q171489.htm">Q171489</A></B>   Use of Implements and Public Constants Crashes Compiler
<B><A href="../vbwin/q171490.htm">Q171490</A></B>   Crash After Toggling Folders in ActiveX EXE Project
<B><A href="../vbwin/q171491.htm">Q171491</A></B>   Mouse Button Value Is Always 4 in MouseUp Event of SSTab
<B><A href="../vbapps/q171492.htm">Q171492</A></B>   ActiveX Control Incorrectly Reports ScaleWidth/ScaleHeight
<B><A href="../vbwin/q171493.htm">Q171493</A></B>   Viewing Property Pages and Exiting Causes Memory Leak

<B><A href="../vbwin/q171494.htm">Q171494</A></B>   MouseUp Event Not Triggered in DblClick w/Comctl32
<B><A href="../vbwin/q171495.htm">Q171495</A></B>   Get Statement Not Working Correctly with Large UDT
<B><A href="../vbwin/q171496.htm">Q171496</A></B>   Bad Filename or Number with Get of UDT
<B><A href="../vbwin/q171497.htm">Q171497</A></B>   ListView in PictureBox on Tabbed Dialog Disappears
<B><A href="../vbwin/q171498.htm">Q171498</A></B>   Screen Turns Black When Compiling

<B><A href="../vbwin/q171499.htm">Q171499</A></B>   IDE Doesn't Show Topics of OCX Help Files Correctly
<B><A href="../vbwin/q171500.htm">Q171500</A></B>   ATL Controls Without IPropertyNotifySink Cause IPF in VB5
<B><A href="../vbwin/q171501.htm">Q171501</A></B>   User Control Moves When Width/Height Is Set in Container
<B><A href="../vbwin/q171502.htm">Q171502</A></B>   Crash with Watch on UserControl When Stop is Encountered
<B><A href="../vbwin/q171504.htm">Q171504</A></B>   Problems Setting PropertyPage Caption Property

<B><A href="../vbwin/q171505.htm">Q171505</A></B>   VB5 IDE Disappears or IPFs When "End" Button Is Pressed
<B><A href="../vbwin/q171506.htm">Q171506</A></B>   OLE Drag/Drop of ListView Control Fa
<B><A href="../vbwin/q171507.htm">Q171507</A></B>   VB GPFs When Selecting Align/Lefts from the Format Menu
<B><A href="../vbwin/q171508.htm">Q171508</A></B>   Add-ins May Cause Menu Corruption When Exiting Visual Basic
<B><A href="../vbwin/q171509.htm">Q171509</A></B>   Access Violation on NT4.0 on Multi-line Textbox

<B><A href="../vbwin/q171510.htm">Q171510</A></B>   Setting Font Property Causes Error 438 with RichTextBox
<B><A href="../vbwin/q171511.htm">Q171511</A></B>   Controls in Frame/PictureBox Do Not Repaint in Design Mode
<B><A href="../vbwin/q171512.htm">Q171512</A></B>   UserControls on Property Pages Do Not Trigger Focus Events
<B><A href="../vbwin/q171513.htm">Q171513</A></B>   Cannot Drag a Nested UserControl with Automatic DragMode
<B><A href="../vbwin/q171514.htm">Q171514</A></B>   Visual Basic 5.0 Crashes When Shutting Down Forms

<B><A href="../vbwin/q171515.htm">Q171515</A></B>   Crash on Customization of Design Environment Menus
<B><A href="../vbwin/q171516.htm">Q171516</A></B>   ActiveX Document DLL Causes GPF When Unloading Modal Form
<B><A href="../vbwin/q171517.htm">Q171517</A></B>   Animation Control Prints Incorrectly at Design-Time
<B><A href="../vbwin/q171518.htm">Q171518</A></B>   Controls May Not Print When Printing Form at Design Time
<B><A href="../vbwin/q171519.htm">Q171519</A></B>   Removing Function Causes Binary Compatibility Error

<B><A href="../vbwin/q171520.htm">Q171520</A></B>   Unable to Set Binary Compatibility with Class Module
<B><A href="../vbwin/q171521.htm">Q171521</A></B>   Non-Creatable Class Causes Loss of Binary Compatibility
<B><A href="../vbwin/q171522.htm">Q171522</A></B>   Enums in Public Procedures Cause Binary Compatibility Error
<B><A href="../vbwin/q171523.htm">Q171523</A></B>   Reference to Missing Member in Enum Definition Causes Crash
<B><A href="../vbwin/q171524.htm">Q171524</A></B>   Ambiguous Names Generate Incorrect Error Message

<B><A href="../vbwin/q171525.htm">Q171525</A></B>   ListView Causes IPF When Accessing ColumnHeaders Property
<B><A href="../vbwin/q171526.htm">Q171526</A></B>   Setting Enabled=False for TreeView Causes Paint Problems
<B><A href="../vbwin/q171527.htm">Q171527</A></B>   Causing a ListView Control to Paint Causes an IPF
<B><A href="../vbwin/q171528.htm">Q171528</A></B>   Using "Unload Me" in a Listbox Causes Crash
<B><A href="../vbwin/q171529.htm">Q171529</A></B>   Can't Open a Project Group from the Root Directory

<B><A href="../vbwin/q171530.htm">Q171530</A></B>   Crash on Data Tip After Enum Name Changed
<B><A href="../vbwin/q171531.htm">Q171531</A></B>   IPF When Changing Project Name With Binary Compatibility
<B><A href="../vbwin/q171532.htm">Q171532</A></B>   Crash Stepping Thru Code After Using Locals/Watch Window
<B><A href="../vbwin/q171533.htm">Q171533</A></B>   ActiveX EXE Crashes VB5 When Set to Binary Compatibility
<B><A href="../vbwin/q171575.htm">Q171575</A></B>   RISC: CByte Doesn't Fail on Negative Values on Native Exe

<B><A href="../vbwin/q171576.htm">Q171576</A></B>   RISC: AddressOf Doesn't Behave Properly in IDE/PCode Exe
<B><A href="../vbwin/q171577.htm">Q171577</A></B>   Using Set for ListItem's SubItem Results in GPF
<B><A href="../vbwin/q171795.htm">Q171795</A></B>   RDC Error Calling UpdateRow After Resultset.AddNew
<B><A href="../vbwin/q171796.htm">Q171796</A></B>   Problems When Running Asynchronous Queries with RDO 2.0
<B><A href="../vbwin/q171797.htm">Q171797</A></B>   VB5 DBCombo May Display Wrong Column for RDC 1.0

<B><A href="../vbwin/q171798.htm">Q171798</A></B>   DBCombo Click Event Fires During Form Load
<B><A href="../vbwin/q171799.htm">Q171799</A></B>   RDO May Incorrectly Handle Locking Conflicts in Transaction
<B><A href="../vbwin/q171800.htm">Q171800</A></B>   Unexpected Shutdown When Using Bound Controls
<B><A href="../vbwin/q171801.htm">Q171801</A></B>   Bound Controls Built in VB5 Do Not Work in VB4 IDE
<B><A href="../vbwin/q171802.htm">Q171802</A></B>   Problems Updating Using DBCombo When ListField = DataField

<B><A href="../vbwin/q171803.htm">Q171803</A></B>   Problems Retrieving VB 5.0 Projects from Visual SourceSafe
<B><A href="../vbwin/q171804.htm">Q171804</A></B>   Change Event Not Fired When Selecting an Item in DBCombo
<B><A href="../vbwin/q171805.htm">Q171805</A></B>   Problems Binding Controls To Nonexistent Data Control
<B><A href="../vbwin/q171806.htm">Q171806</A></B>   Memory Leak When RDC Bound to OLE Container Control
<B><A href="../vbwin/q171807.htm">Q171807</A></B>   Selected Tab Changes After Removing Tab in Tabstrip

<B><A href="../vbwin/q171808.htm">Q171808</A></B>   MDI Child Form Does Not Become Active
<B><A href="../vbwin/q171809.htm">Q171809</A></B>   Memory Leak When Setting the ForeColor of a VB5 Object
<B><A href="../vbwin/q171810.htm">Q171810</A></B>   Invoking the Visual Component Manager Asserts in Exutil
<B><A href="../vbwin/q171811.htm">Q171811</A></B>   Cannot See Relationship Collection on an Interface with Tab
<B><A href="../vbwin/q171812.htm">Q171812</A></B>   Run-Time Error When DataObject Passed As Object

<B><A href="../vbwin/q171813.htm">Q171813</A></B>   IPF in MSO97RT.DLL When Starting Visual Basic
<B><A href="../vbwin/q171814.htm">Q171814</A></B>   System Menu Appears When MouseDown Event Invokes a Drag
<B><A href="../vbwin/q171815.htm">Q171815</A></B>   Printer.TextWidth Returning Inconsistent Results in IDE
<B><A href="../vbwin/q171816.htm">Q171816</A></B>   IPF Opening or Saving Form with Tab Cont
<B><A href="../vbwin/q171817.htm">Q171817</A></B>   UserControl Cannot Read ContainedControls in Visual FoxPro

<B><A href="../vbwin/q171818.htm">Q171818</A></B>   IDE Crashes When Repeatedly Placing a Control on a Form
<B><A href="../vbwin/q171819.htm">Q171819</A></B>   Invalid Enum Value Causes Incompatible Binary Compatible
<B><A href="../vbwin/q171820.htm">Q171820</A></B>   ListView ListItems Don't Refresh When ColumnHeaders Cleared
<B><A href="../vbwin/q171821.htm">Q171821</A></B>   Memory Leak When Repeatedly Changing Toolbar Button Width
<B><A href="../vbwin/q171822.htm">Q171822</A></B>   Adding a Routine to UserControl in Break Mode Causes Crash

<B><A href="../vbwin/q171823.htm">Q171823</A></B>   Application Error When Using Implements on Hyperlink Object
<B><A href="../vbwin/q171824.htm">Q171824</A></B>   Crash in INET Control Downloading Page Multiple Times
<B><A href="../vbwin/q171825.htm">Q171825</A></B>   Tabbing Problems Using ActiveX Document in a Frame
<B><A href="../vbwin/q171826.htm">Q171826</A></B>   Tabbing Problems with Controls Contained with Controls
<B><A href="../vbwin/q171827.htm">Q171827</A></B>   Printing Userdrawn Usercontrol in IE Doesn't Work

<B><A href="../vbwin/q171828.htm">Q171828</A></B>   Using OpenURL Doesn't Download Complete Files
<B><A href="../vbwin/q171829.htm">Q171829</A></B>   GetChunk Freezes Unless Other Events Happening
<B><A href="../vbwin/q171830.htm">Q171830</A></B>   ActiveX Document Menu Changing Places
<B><A href="../vbwin/q171831.htm">Q171831</A></B>   IObjectSafety Implemented in Toolbar and CmDialog Controls
<B><A href="../vbwin/q171832.htm">Q171832</A></B>   Statement Builder Can Cause the Object Browser to Crash

<B><A href="../vbwin/q171833.htm">Q171833</A></B>   Statement Builder Crashes Referencing GlobalMultiUse Server
<B><A href="../vbwin/q171834.htm">Q171834</A></B>   Crash When UserControl Accesses Members of ParentControls
<B><A href="../vbwin/q171835.htm">Q171835</A></B>   Crash When Viewing Data Tips on ParamArray
<B><A href="../vbwin/q171836.htm">Q171836</A></B>   Crash When Viewing API Properties in Object Browser
<B><A href="../vbwin/q171837.htm">Q171837</A></B>   Run-Time Error 6 "Overflow When Compiled to Native Code"

<B><A href="../vbwin/q171838.htm">Q171838</A></B>   Crash Compiling Native Code for Assignment of Variant Array
<B><A href="../vbwin/q171839.htm">Q171839</A></B>   Crash When Compiling a Call to a UserControl Function
<B><A href="../vbwin/q171840.htm">Q171840</A></B>   Corrupt Project Error Opening One Project After Another
<B><A href="../vbwin/q171841.htm">Q171841</A></B>   Dragging Multiple Controls on a Form May Cause Crash
<B><A href="../vbwin/q171842.htm">Q171842</A></B>   GetSetting Function Is Leaking Handles

<B><A href="../vbwin/q171843.htm">Q171843</A></B>   Winsock Control Leaks Memory When Unloaded

</PRE>Service Pack 3 addresses compatibility issues with the Internet Transfer,
Data Bound Grid, Data Bound List, and Data Bound Combo controls. The
Service Pack also fixes a problem where Visual Basic compiles incorrect
type information.
<P>
<PRE><B><A href="../vbwin/q171537.htm">Q171537</A></B>   Bad Error Number Returned If Relationship Doesn't Exist
<B><A href="../vbwin/q171538.htm">Q171538</A></B>   Can't Set Property on Interface That Has Attached Root
<B><A href="../vbwin/q171539.htm">Q171539</A></B>   TypeDef Model Doesn't Have Propagate Delete on Relationship
<B><A href="../vbwin/q171544.htm">Q171544</A></B>   Engine: Collection Object Does Not Access Correctly by Name
<B><A href="../vbwin/q171545.htm">Q171545</A></B>   Error 438 When Using CreateInterface's Optional Default Flag

<B><A href="../vbwin/q171546.htm">Q171546</A></B>   VB4 Apps with Unbound DBGrid Fail with VB5 DBGrid
<B><A href="../vbwin/q171547.htm">Q171547</A></B>   New DBGrid32.OCX Breaks VB4 Apps that Use VB4 Version
<B><A href="../vbwin/q171548.htm">Q171548</A></B>   Binary Compatible Server Causes VB to Hang in the IDE
<B><A href="../vbwin/q171549.htm">Q171549</A></B>   Cached Class Factorys Can Be Released by Illegal Thread
<B><A href="../vbwin/q171550.htm">Q171550</A></B>   Recompiling with SP2 Breaks Binary Compatibility

<B><A href="../vbwin/q171551.htm">Q171551</A></B>   32-Bit DBList/DBCombo May Exhibit Problems When Locked
<B><A href="../vbwin/q174835.htm">Q174835</A></B>   Internet Transfer Control Using Username and Password
<B><A href="../vbwin/q174836.htm">Q174836</A></B>   Problems Shutting Down When Using the Inet Control

</PRE><h3>Visual C++ KB Articles</h3>
 
<P>
The following is a list of feature areas followed by a list of Knowledge
Base articles and the Service Pack in which they were fixed.
<P>
The fixes for the Active Template Library (ATL) shown below address the
most commonly reported issues: MBCS compatibility, container compatibility
issues, and internal coding errors in ATL.
<P>
SP1:
<PRE><B><A href="../visualc/q167340.htm">Q167340</A></B>   ATL Control Causes Access Violation in Visual Basic 5.0
<B><A href="../visualc/q167526.htm">Q167526</A></B>   ATL Control May Cause An Access Violation
<B><A href="../visualc/q167949.htm">Q167949</A></B>   OnWindowMessage Returns BOOL for HRESULT

SP2:
None

SP3:
<B><A href="../visualc/q174635.htm">Q174635</A></B>   _variant_t::operator |Unknown*() Fails to AddRef Interface

</PRE>The compiler fixes shown below address the most commonly reported COM
issues,  including support for VB-created controls, smart pointers, and
reference counting; several code generation problems with global
optimizations (/Og) and floating point optimizations; and fixes to
templates.
<P>
A few global optimization fixes were implemented, but they were too large
to document in Knowledge Base articles.
<P>
SP1:
<PRE><B><A href="../visualc/q151491.htm">Q151491</A></B>   copy() Member of bstrt in COMUTL.H Doesn't Copy
<B><A href="../visualc/q151499.htm">Q151499</A></B>   Compiler Performs Illegal Sign Conversion Optimization
<B><A href="../visualc/q151500.htm">Q151500</A></B>   /Og Causes vfptr Initialization Problems
<B><A href="../visualc/q166282.htm">Q166282</A></B>   C2440 Caused by Template Function with Const Pointer
<B><A href="../visualc/q166718.htm">Q166718</A></B>   C1001 from Conditional Operator in Initializer

<B><A href="../visualc/q166721.htm">Q166721</A></B>   C2784 On &lt; Operator When Instantiating an ATL Container
<B><A href="../visualc/q167967.htm">Q167967</A></B>   /Og Increments the Index of a Loop Too Soon.
<B><A href="../visualc/q167995.htm">Q167995</A></B>   Calling a Function Returning double May Not pop FPU Stack
<B><A href="../visualc/q167996.htm">Q167996</A></B>   /Og Causes Invalid Double Result Returned from Function
<B><A href="../visualc/q168003.htm">Q168003</A></B>   Function Prototypes in comutil.h Missing Calling Convention

<B><A href="../visualc/q168008.htm">Q168008</A></B>   C2166: Incorrect Type Deduction for Template Parameter
<B><A href="../visualc/q168009.htm">Q168009</A></B>    Smartptr Property in Interface Causes C2512 Error
<B><A href="../visualc/q168010.htm">Q168010</A></B>   /Od May Generate Destructor for Unconstructed Temp Object
<B><A href="../visualc/q168011.htm">Q168011</A></B>   C1001, file 'fppeeps.c', line 394, Caused By /Og
<B><A href="../visualc/q168012.htm">Q168012</A></B>   Incorrect Code Generated When Using Floating-Point and /Og

<B><A href="../visualc/q168028.htm">Q168028</A></B>   C2955: Caused By the "using" Declaration
<B><A href="../visualc/q168029.htm">Q168029</A></B>   Global Optimizations (/Og) May Cause the Compiler to Hang
<B><A href="../visualc/q168079.htm">Q168079</A></B>   _com_ptr_t::operator=(const _variant_t&amp;) AddRefs Twice
<B><A href="../visualc/q168111.htm">Q168111</A></B>   #import Does Not Compensate for Gaps in vtable

SP2:
</PRE>None.
<P>
SP3:
<PRE><B><A href="../visualc/q155292.htm">Q155292</A></B>   Destructor Not Called When DEBUG_NEW is Defined
<B><A href="../visualc/q167347.htm">Q167347</A></B>   /Og Causes C1001, main.c, line 379 for Recursive Call
<B><A href="../visualc/q168957.htm">Q168957</A></B>   C1001, file 'msc1.cpp', line 1188, Caused by Name Hiding
<B><A href="../visualc/q171543.htm">Q171543</A></B>   _getmbp CRT Function Does Not Return the Correct Value
<B><A href="../visualc/q172609.htm">Q172609</A></B>   /GX May Cause C1001 When Using Base Class' Operator Delete

<B><A href="../visualc/q172980.htm">Q172980</A></B>   Compiler Incorrectly Causes Default Constructor Reference
<B><A href="../visualc/q172985.htm">Q172985</A></B>   Out of Order Definitions in idl May Cause Compiler Errors
<B><A href="../visualc/q172992.htm">Q172992</A></B>   /Og Causes C1001 While Looping
<B><A href="../visualc/q173025.htm">Q173025</A></B>   /Og Causes C1001 with Member Lookup in an Infinite Loop
<B><A href="../visualc/q173092.htm">Q173092</A></B>   /Og Causes C1001 Traversing Nontrivial List of Pointers

<B><A href="../visualc/q173645.htm">Q173645</A></B>   Access Violation in MSDAER.DLL with _com_error Exceptions
<B><A href="../visualc/q174891.htm">Q174891</A></B>   CComQlPtr operator= Causes an Access Violation

</PRE>The following SP1 articles cover some fixes applied to the SP3 compiler.
Note   Some SP3 issues fall under the scope of existing Knowledge Base
articles, and a few issues have test cases that were too large to document
in a Knowledge Base article.
<P>
<PRE><B><A href="../visualc/q168012.htm">Q168012</A></B>   Incorrect Code Generated When Using Floating-Point and /Og
<B><A href="../visualc/q168029.htm">Q168029</A></B>   Global Optimizations (/Og) May Cause the Compiler to Hang

</PRE>The fixes for the linker and other tools include a linker fix correcting a
reported problem that ICF (Identical COMDAT Folding) was causing severe
build-time losses. The fix also removes limits being imposed on the size of
an executable file and raises the maximum size of the .ilk file used by the
linker to 64 megabytes (MB).
<P>
SP1:
<PRE><B><A href="../utilities/q151501.htm">Q151501</A></B>   Linking Large Projects Can Be Very Slow
<B><A href="../visualc/q167994.htm">Q167994</A></B>   Cvpack INTERNAL ERROR When Linking Large Projects

SP2:
</PRE>None.
<P>
SP3:
None.
<P>
The fixes for the Microsoft Foundation Classes (MFC) listed below deal with
the most commonly reported issues that prevent binary compatibility with
MFC 4.2 (shipped with Visual C++ 4.2). Fixes affect DAO, CToolTips, MFC42
def files, and schema deserialization. The issues include unintended
dependencies on the latest comctl32.dll, the 3.0 version of odbc32.dll,
threading issues, and internal coding errors in MFC.
<P>
SP1:
<PRE><B><A href="../visualc/q164813.htm">Q164813</A></B>   Web Browser Control Hangs in CFormView
<B><A href="../visualc/q167423.htm">Q167423</A></B>   CRecordset Members Not in "Add Member Variable" Dialog Box
<B><A href="../visualc/q167650.htm">Q167650</A></B>   Problems with ToolTips on Windows 95
<B><A href="../visualc/q167692.htm">Q167692</A></B>   Assertion Line 257 in File DlgProp.cpp
<B><A href="../visualc/q167693.htm">Q167693</A></B>   MFC Application Hangs on Multiprocessor Machine

<B><A href="../visualc/q167731.htm">Q167731</A></B>   Access Violation When Connecting in MFC ODBC Application
<B><A href="../visualc/q168004.htm">Q168004</A></B>   "Unable to Initialize DAO/Jet db Engine" Error
<B><A href="../visualc/q169484.htm">Q169484</A></B>   CString::MakeUpper and MakeLower Don't Work with Some Char

SP2:
</PRE>None.
<P>
SP3:
<PRE><B><A href="../visualc/q170257.htm">Q170257</A></B>   CRecordset::AddNew Inserts 32484 into int Fields (RFX_INT)
<B><A href="../visualc/q171316.htm">Q171316</A></B>   Setting a Default Value Using CreateField Gives Wrong Value
<B><A href="../visualc/q172276.htm">Q172276</A></B>   CToolTipCtrl Does Not Display Text After Installing VS SP1
<B><A href="../visualc/q172405.htm">Q172405</A></B>   "Unhandled exception" in MFC DAO App After VC++ 5.0 SP1
<B><A href="../visualc/q173252.htm">Q173252</A></B>   CArchive::GetObjectSchema Returns Incorrect Schema

<B><A href="../visualc/q174403.htm">Q174403</A></B>   Unresolved Externals When Building MFC42 and MFCD42xD

</PRE>The following are debugger fixes. The debugger now evaluates compiler-
generated strings longer than 128 characters (this usually takes place when
you are debugging templates, such as STL) without encountering an access
violation. Also, the debugger now starts smoothly in configurations that
have Visual Test and Visual C++ integrated.
<P>
SP1:
<PRE><B><A href="../visualc/q168007.htm">Q168007</A></B>   Remote Debugging Very Slow in Visual C++ Version 5.0

SP2:
<B><A href="../visualc/q171848.htm">Q171848</A></B>   Source Control Info Not Preserved During Project Conversion
<B><A href="../visualc/q171849.htm">Q171849</A></B>   Debugger Hangs When Very Long STL Symbol in  Watch Window

SP3:
</PRE>None.
<P>
In the development environment, the Service Packs fixed problems that
caused the environment to fail, and a ClassWizard issue in the VC ++ German
version.
<P>
SP1:
<PRE><B><A href="../visualc/q165792.htm">Q165792</A></B>   MSDEV.EXE Application Error When Building an Application
<B><A href="../visualc/q166285.htm">Q166285</A></B>   MSDEV Crashes When Converting VC++ 4.0 Projects
<B><A href="../visualc/q167423.htm">Q167423</A></B>   CRecordset Members Not in "Add Member Variable" Dialog Box
<B><A href="../visualc/q167845.htm">Q167845</A></B>   Class Wizard Deletes Source Files

SP2:
</PRE>None.
<P>
SP3:
<PRE><B><A href="../vstudio/q174809.htm">Q174809</A></B>   Developer Studio Crashes Randomly When Navigating Workspace
<B><A href="../vstudio/q171542.htm">Q171542</A></B>   Menus on Wrong Monitor with Multi-monitor Configuration

</PRE><h3>Visual Database Tools KB Articles</h3>
 
<P>
<PRE><B><A href="../istudio/q168295.htm">Q168295</A></B>   Updating Single Row Replaces Data in All Rows of a Cursor

</PRE><h3>Visual FoxPro KB Articles</h3>
 
<P>
Service Pack 2 fixes the access violation error problem when running a form
with a grid repeatedly under Windows NT 4.0. OLE automation with Word 97
issues have been addressed. Some of the report printing and preview
problems under Windows NT also have been fixed.
<P>
<PRE><B><A href="../foxpro/q156322.htm">Q156322</A></B>   RETURN TO Procedurename Command Doesn't Work in Forms
<B><A href="../foxpro/q156788.htm">Q156788</A></B>   Report Print Preview Illegible Under Windows NT
<B><A href="../foxpro/q168277.htm">Q168277</A></B>   Access Violation Running Form With Grid Repeatedly on NT 4
<B><A href="../foxpro/q168523.htm">Q168523</A></B>   Report Fails When Printing Under Windows NT 4.0
<B><A href="../foxpro/q169565.htm">Q169565</A></B>   Type Mismatch Using OLE Automation to Word 97

</PRE>Service Pack 2 fixes the Anomaly Tracking System (ATS) so that it does not
display the 'Option under construction' message when action items are
selected.
<P>
<PRE><B><A href="../foxpro/q168193.htm">Q168193</A></B>   'Option under construction' Message Appears in ATS

</PRE>The version of Visual FoxPro that ships with Visual Studio 97 Service Pack
3 fixes a memory leak, certain display and printing problems, an IME issue
(in the DBCS versions only), a relative pathing problem with directory
manipulation functions ("..." issues), and an incompatibility with
Microsoft Internet Explorer 4.0.
<P>
<PRE><B><A href="../foxpro/q166377.htm">Q166377</A></B>   Report Designer Changes Font from Wingdings to Default Font
<B><A href="../vstudio/q171540.htm">Q171540</A></B>   VFP Disappears if Project Under SCC Is Opened and Closed
<B><A href="../foxpro/q171553.htm">Q171553</A></B>   VFP May Crash While Running MS Web Browser Control
<B><A href="../foxpro/q172346.htm">Q172346</A></B>   Unable to Disable IME Box in a Grid at Runtime
<B><A href="../foxpro/q173237.htm">Q173237</A></B>   Barcode Font Does Not Display or Print Correctly

<B><A href="../foxpro/q174244.htm">Q174244</A></B>   RESTORE SCREEN Causes Memory Leak in Visual FoxPro 5.0

</PRE><h3>Visual InterDev KB Articles</h3>
 
<P>
Service Pack 1 fixes various wizard problems. The Service Pack also fixes a
bug that destroys data in situations when the FrontPage editor, which comes
with Visual InterDev, is used.
<P>
<PRE><B><A href="../istudio/q165834.htm">Q165834</A></B>   Can't Set Permissions Back to Root Web Permissions
<B><A href="../istudio/q167267.htm">Q167267</A></B>   New Devisws.pkg for 0-Byte File Save Problem
<B><A href="../istudio/q167836.htm">Q167836</A></B>   DataForm Wizard Not Sizing Column Width Properly for DBCS
<B><A href="../istudio/q167846.htm">Q167846</A></B>   Reserved Error When Running DataForm Wizard Against Access
<B><A href="../istudio/q168269.htm">Q168269</A></B>   MSWC BrowserType Control Does Not Recognize IE 3.02

<B><A href="../istudio/q168270.htm">Q168270</A></B>   Update Error When Updating Sybase Table from ASP
<B><A href="../istudio/q168271.htm">Q168271</A></B>   Sybase Cursor Can't Scroll Back in DF Wizard Created Form
<B><A href="../istudio/q168272.htm">Q168272</A></B>   GPF When Refreshing a Project Containing Sybase Connection
<B><A href="../istudio/q168273.htm">Q168273</A></B>   Invalid Operation When Deleting the End Sybase Record
<B><A href="../istudio/q168274.htm">Q168274</A></B>   GPF When Selecting .ALX Files in Template Wizard

<B><A href="../istudio/q168275.htm">Q168275</A></B>   Corrupted Dialog Titles in Japanese Version
<B><A href="../istudio/q168296.htm">Q168296</A></B>   GPF When Expanding Links in Japanese Version of VI
<B><A href="../istudio/q168297.htm">Q168297</A></B>   Data Connection Icons Not Displayed for global.asa

</PRE><h3>Visual J++ KB Articles</h3>
 
<P>
Service Pack 1 contains fixes that will enable customers to debug Java
applets running on Microsoft Internet Explorer 4.0 (but not on Microsoft
Internet Explorer 4.0 Preview Release 1). If you are running Microsoft
Internet Explorer 4.0 Preview Release 1, you should upgrade to Microsoft
Internet Explorer 4.0 Final Version, which is available now on the web site
<B><A href="http://www.microsoft.com/ie/ie40">http://www.microsoft.com/ie/ie40.</A></B>  For multiprocessor machines, Service
Pack 1 fixes a scenario that resulted in a fault. It also fixes an isolated
case in which ClassView did not display any information.
<P>
<PRE><B><A href="../java/q167719.htm">Q167719</A></B>   JavaTLB Gives an Internal Compiler Error with VBCCE Control
<B><A href="../java/q167720.htm">Q167720</A></B>   Saving Java File on Multiprocessor Machine Crashes MSDEV
<B><A href="../java/q167828.htm">Q167828</A></B>   Cannot Access the ClassView Information File Error
<B><A href="../java/q167998.htm">Q167998</A></B>   Cannot Debug Visual J++ Programs on IE 4.0 Pre-Release

</PRE>See Visual C++ KB Articles for Service Pack 2 fixes that may affect Visual
J++ users.
<P>
Service Pack 3 fixes a debugger problem so that Developer Studio does not
crash when the user clicks the X button to close Microsoft Internet
Explorer 4.0.
<P>
<PRE><B><A href="../java/q171541.htm">Q171541</A></B>   Visual J++ Debugger Crashes in EMJAV DLL

</PRE><h3>Visual SourceSafe KB Articles</h3>
 
<P>
Service Pack 1 contains five fixes for Visual SourceSafe: the deployment of
files placed in the parent directory to a UNIX Server; movement of random
characters to the end of the file after SourceSafe editor is used;
incomplete check in of files in Visual Basic or Visual C++ when keyword
expansion is enabled; corruption of Rights.dat after adding rights by
project; and slowdown of analyze and appearance of hanging on large
databases.
<P>
<PRE><B><A href="../ssafe/q165776.htm">Q165776</A></B>   Admin Cannot See Files with Project Security Enabled
<B><A href="../ssafe/q166469.htm">Q166469</A></B>   Multiple Check In Fails with Keyword Expansion
<B><A href="../ssafe/q167273.htm">Q167273</A></B>   VSS Editor/Viewer Removing or Replacing Characters
<B><A href="../ssafe/q167274.htm">Q167274</A></B>   Analyze May Hang or Crash When Running on Large Databases
<B><A href="../ssafe/q167737.htm">Q167737</A></B>   Deploy to a Unix Server Via FTP Fails

</PRE>Service Pack 2 contains Visual SourceSafe fixes for a memory leak in the
Visual Studio integration, and an access violation in Analyze (a developer
tools integration issue where files like Status.dat are needlessly kept
open).
<P>
<PRE><B><A href="../ssafe/q171534.htm">Q171534</A></B>   Source Code Control Integration Holds .dat Files Open
<B><A href="../ssafe/q171535.htm">Q171535</A></B>   ANALYZE Application Error When Directory Not Found

</PRE>Service Pack 3 contains fixes for Visual SourceSafe's Explorer and
Archive/Restore utilities. Also, this Service Pack adds features that
eliminate integration problems and enhance operations in the integrated
environments.
<P>
<PRE><B><A href="../ssafe/q172337.htm">Q172337</A></B>   SSARC &amp; SSRESTOR Do Not Store Macintosh Resource Fork Data
<B><A href="../ssafe/q174873.htm">Q174873</A></B>   Lost Net Connection Causes Source Code Control to Hang
<B><A href="../ssafe/q174874.htm">Q174874</A></B>   Branched Files Restored to New Database Causes Corruption
<B><A href="../ssafe/q174875.htm">Q174875</A></B>   Bogus "File is exclusively checked out" Error
<B><A href="../ssafe/q174876.htm">Q174876</A></B>   Invalid DOS Path to SSADMIUN.INI on Unix

<B><A href="../ssafe/q174877.htm">Q174877</A></B>   Selecting a File in SourceSafe Explorer Causes Refresh
<B><A href="../ssafe/q174878.htm">Q174878</A></B>   Large Buttons When Resetting Toolbar
<B><A href="../ssafe/q174879.htm">Q174879</A></B>   Incorrect Syntax on Keywords May Delete Text

</PRE><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

   ARTICLE-ID: <B><A href="../vstudio/q170367.htm">Q170367</A></B>
   TITLE     : HOWTO: Determine VS97 Service Pack Updates in a Product

   ARTICLE-ID: <B><A href="../vstudio/q175869.htm">Q175869</A></B>
   TITLE     : INFO: Troubleshooting the Visual Studio Service Pack
               Download

</PRE>The equivalent of this article for the Visual Studio 97 Service Packs 1
and 2 are:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170366.htm">Q170366</A></B>
   TITLE     : INFO: Visual Studio 97 Service Pack 1 Readme

   ARTICLE-ID: <B><A href="../vstudio/q172610.htm">Q172610</A></B>
   TITLE     : INFO: Visual Studio 97 Service Pack 2 Readme
</PRE> 
<PRE>Keywords          : VS97FixlistSP2 VS97FixlistSP1 VSInfoView VS97FixlistSP3
Version           : WINDOWS:1.0,1.1,5.0,5.0a,97,97sp1,97sp2,97sp3; WINNT:5.0
Platform          : WINDOWS winnt
Issue type        : kbinfo
Solution Type     : kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
