

<HTML>
<HEAD>
<TITLE>How to Convert All Files on a Server to Microsoft Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170431">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/06/20">
<META NAME="Keywords" CONTENT="xlloadsave xlmhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The Microsoft Excel 97 File Conversion add-in converts all of the files in one folder. This article describes how to use a Visual Basic for Applications macro to convert the files in a folder and all of its subfolders.  MORE INFORMATION  Microsoft ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBS0,QANE,QAH4,QAM9,QALX,QAFI,QAEQ,QAKE,QBVV,QAUR,QAPN,QBWS,QAJH,QAUD P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Convert All Files on a Server to Microsoft Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170431</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Excel 97 File Conversion add-in converts all of the files in
one folder. This article describes how to use a Visual Basic for
Applications macro to convert the files in a folder and all of its
subfolders.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
In Microsoft Excel 97, the Application object now has FileSearch and
FoundFiles properties that return an object containing the list of files
found in the search. These properties can be used to open another file type
and then save it in Microsoft Excel 97 format.
<P>
NOTE: If you do not want to see each workbook that is opened and closed,
add the following line to the beginning of the macro:
<P>
<PRE>   Application.ScreenUpdating = False

</PRE>If you convert a large number of files, this line may cause the macro to
appear to stop responding.
<P>
The following sample Visual Basic for Applications macro converts the files
in a folder and its subfolders:
<P>
<PRE>   Sub Converter()
   
   'Turns off alerts, allows duplicate files to be overwritten without
   prompts
   Application.DisplayAlerts = False
   
   'Initializes conversion conditions.
   SearchDir = InputBox("Input name of directory to start in")
   FileExt = InputBox("Input extension of files to convert in the form
   *.xxx")
   SaveDir = InputBox("Input name of directory to save files to")
   SearchSubs = MsgBox(prompt:="Do you want to include files in
   subdirectories?", Buttons:=vbYesNo)
   
   'Initializes the search.
   With Application.FileSearch
       .NewSearch
       .LookIn = SearchDir
   
   'Determines whether to search subdirectories.
   If SearchSubs = 6 Then
       .SearchSubFolders = True
   Else
       .SearchSubFolders = False
   End If
   
   'Determines file type to convert.
       .FileName = FileExt
       .MatchTextExactly = True
   
   'If the search found files, loops again, opens, and then resaves in the
   'Microsoft Excel workbook format
       If .Execute &gt; 0 Then
           counter = 0
           For i = 1 To .FoundFiles.Count
               counter = counter + 1
               Workbooks.Open FileName:=.FoundFiles(i)
   
   'Builds the new name by deleting the previous extension.
               ActiveWorkbook.SaveAs FileName:=SaveDir &amp; "\" &amp; _
                 Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4), _
                 FileFormat:=xlWorkbookNormal
               ActiveWorkbook.Close savechanges:=False
           Next i
   
   'Returns how many files were converted.
           MsgBox prompt:=counter &amp; " files were converted"
       ElseIf .Execute = 0 then
           MsgBox "No files were found, no files were converted"
       End If
   
   End With
   End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about FileSearch, click the Office Assistant, type
"FileSearch," click Search, and then click to view "FileSearch Object."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Microsoft Help is not installed on your computer,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlloadsave xlmhowto kbcode<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
