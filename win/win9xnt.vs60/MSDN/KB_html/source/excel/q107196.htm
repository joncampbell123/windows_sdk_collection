

<HTML>
<HEAD>
<TITLE>MSQuery: Error Using Date in Criteria Expression in Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107196">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/11/16">
<META NAME="Keywords" CONTENT="kbusage kbprb kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Query, when you use a date in a criteria expression, the date may not be correctly interpreted and you may receive the following error message     Error in predicate:                                                        Incompatible ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QBI0,QAKD,QA7O,QA7N,QACE,QAB4,QAY2,QAB9,QAAP,QBXS,QBWS,QAG2,QAP2,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQuery: Error Using Date in Criteria Expression in Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107196</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Query, when you use a date in a criteria expression, the
date may not be correctly interpreted and you may receive the
following error message
<P>
<PRE>   Error in predicate: &lt;criteria field&gt;&lt;criteria operator&gt;&lt;criteria value&gt;
   Incompatible types in predicate.

</PRE>where &lt;criteria field&gt; is an expression containing a date field,
&lt;criteria operator&gt; is the condition that must be true for the
expression, and &lt;criteria value&gt; is the comparison value for the
expression.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid this error, use number signs (#) around dates in the criteria
value field when you use them as the comparison value for a criteria
expression. Microsoft Query does not interpret the date value
correctly when the criteria field contains a date field in an
expression.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A criteria value such as "1993-10-31" could be interpreted as either
a date or an arithmetic expression. Microsoft Query only interprets
an ambiguous expression to be a date when the criteria field type is
a date. However, when the criteria field itself is an expression,
"Date+3" for example, the date value is not correctly interpreted,
and an error is generated.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Microsoft Query, open an existing query or create a new query
   that retrieves data from a table that contains a field with dates.

<P><LI>If the table containing the dates is not displayed in the table
   pane, do the following to add the table:
<P>
   a. From the table menu, choose Add Tables.
<P>
   b. From the Table Name list, select the table containing the dates
<P><PRE>      and choose Add.
</PRE>
<P><LI>Select the date field from the table and drag it to the data pane.

<P><LI>From the Criteria menu, choose Add Criteria.

<P><LI>In the Field box, enter "Date + 3" (without the quotation marks)
   where "Date" is the name of the field containing the dates.

<P><LI>From the Operators box, select Equals.

<P><LI>Choose Values, and from the Values list, select a date and choose OK.

<P><LI>Choose Add.
<P>
</OL>The following error appears on the screen
<P>
<PRE>   Error in predicate: Date+3=&lt;criteria value&gt;
   Incompatible types in predicate.

</PRE></OL>where &lt;criteria value&gt; is the value selected from the Values list in
step 7.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Query User's Guide," version 5.0, pages 69-70
<P>
For more information about Criteria Expressions (Cue Cards) or
Expressions Overview, choose the Search button in Help and type:
<P>
<PRE>    dates
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbprb kbtool<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
