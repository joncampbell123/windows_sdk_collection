

<HTML>
<HEAD>
<TITLE>XL97: How to Specify Dynamic Web Query Parameters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162051">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/01/10">
<META NAME="Keywords" CONTENT="xlquery xlweb kbtool kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  A Web query is a new feature in Microsoft Excel 97 that allows you to retrieve data stored on your intranet, the Internet, or the World Wide Web. A Web query can use static parameters, dynamic parameters, or a combination of both. Queries with stat...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QA37,QBVP,QAVZ,QBWS,QACF,QA01,QAUD,QAKD,QAYY,QANE,QAWM,QA50,QANX,QBQU P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: How to Specify Dynamic Web Query Parameters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162051</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A Web query is a new feature in Microsoft Excel 97 that allows you to
retrieve data stored on your intranet, the Internet, or the World Wide Web.
A Web query can use static parameters, dynamic parameters, or a combination
of both. Queries with static parameters send a query without any input;
queries with dynamic parameters prompt you for input. Regardless of the
type of parameters in the query, the requested information is pulled from
an Internet or an intranet site, and the results are placed in a worksheet.
<P>
When you use dynamic parameters, you can use the following three methods
for obtaining the parameter values:

<UL><LI>Use a dialog box that prompts you to type the values.

<LI>Specify the values to use.

<LI>Get the values from a worksheet cell.
<P>
</UL>This article provides an sample dynamic Web query and the steps for setting
the parameter values for the query using the three methods.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In each of the examples, the same Web query file is used to generate the
initial results that are returned to a worksheet. After you perform a query
to return data to a worksheet, the Web query file is no longer used to
update the data in the worksheet; the query is stored in the worksheet.
<P>
In some of the examples below, you use the Parameters dialog box to make
changes to the parameters in a query. Note that these changes do not affect
the Web query file you initially use to run the query; any changes you make
to the query parameters are stored in the worksheet.
<P>
NOTE: The examples in this article use a third-party Web site. Microsoft
does not guarantee the examples will work indefinitely; the Web site is not
owned or maintained by Microsoft.
<P>
<P><h3>Running a Sample Query Included with Microsoft Office (Prompt Appears)</h3>
 

<OL><P><LI>Save and close any open workbooks, and then create a new workbook.

<P><LI>On the Data menu, point to Get External Data, and then click Run Web
   Query.

<P><LI>Click "Detailed Stock Quote by PC Quote, Inc.iqy" in the Run Query
   dialog box, and then click Get Data.
<P>
   NOTE: The "Detailed Stock Quote by PC Quote, Inc.iqy" file is in the
   Program Files\Microsoft Office\Queries folder.

<P><LI>Click OK in the "Returning External Data to Microsoft Excel" dialog box.

<P><LI>In the Enter Parameter Value dialog box type "msft" (without the
   quotation marks) in the RefEdit box, and then click OK.
<P>
</OL>A detailed stock quote for Microsoft Corp. (MSFT) is returned to the
worksheet.
<P>
<P><h3>Running Sample Web Query (Worksheet Cell Value)</h3>
 

<OL><P><LI>Switch to Sheet2 in the workbook, and then type "msft" (without the
   quotation marks) in cell A1.

<P><LI>With A2 selected, point to Get External Data on the Data menu, and then
   click Run Web Query.

<P><LI>Click "Detailed Stock Quote by PC Quote, Inc.iqy" in the Run Query
   dialog box, and then click Get Data.

<P><LI>In the "Returning External Data to Microsoft Excel" dialog box, click
   Parameters.
<P>
   The Parameters dialog box appears. Notice the option for this Web query
   uses a prompt for the parameter value.

<P><LI>In the Parameters dialog box, click "Get the value from the following
   cell," click cell A1 to insert the reference "=Sheet2!$a$1" in the
   RefEdit box, and then click OK.

<P><LI>Click OK in the "Returning External Data to Microsoft Excel" dialog box.
<P>
   A detailed stock quote for Microsoft Corp. (MSFT) is returned to the
   worksheet.

<P><LI>Change the contents of cell A1 in Sheet2 to a different (valid) stock
   symbol.

<P><LI>On the External Data toolbar, click Refresh Data.
<P>
</OL>Since the contents of cell A1 changed, a detailed stock quote for the new
stock symbol is returned to the worksheet.
<P>
<P><h3>Running Sample Web Query (Set Parameter Value)</h3>
 

<OL><P><LI>Activate Sheet2 in the workbook, and then type "msft" (without the
   quotation marks) in cell A1.

<P><LI>With A2 selected, point to Get External Data on the Data menu, and then
   click Run Web Query.

<P><LI>Click "Detailed Stock Quote by PC Quote, Inc.iqy" in the Run Query
   dialog box, and then click Get Data.

<P><LI>In the "Returning External Data to Microsoft Excel" dialog box, click
   Parameters.

<P><LI>In the Parameters dialog box, click "Use the following value," type
   "msft" (without the quotation marks) in the box, and then click OK.

<P><LI>Click OK in the "Returning External Data to Microsoft Excel" dialog box.
<P>
   A detailed stock quote for Microsoft Corp. (MSFT) is returned to the
   worksheet.

<P><LI>On the External Data toolbar, click Refresh Data.
<P>
</OL>You are not prompted for any value, and the same results are returned to
your worksheet. However, if you click Refresh Data on another day, an
updated stock quote for Microsoft Corp. is returned to the worksheet.
<P>
<P>
<P><h3>Changing the Parameter Value for a Worksheet</h3>
 
<P>
If you want to use a specific value for a parameter, as in the previous
example, you can change this value in the Parameters dialog box.

<OL><P><LI>Click any cell in the results that are returned to Sheet3.

<P><LI>On the External Data toolbar, click Query Parameters.

<P><LI>In the Parameters dialog box, change the contents of the box below
   "Use the following value" to a different stock symbol, and then click
   OK.

<P><LI>On the External Data toolbar, click Refresh Data.
<P>
</OL>The stock quote in Sheet3 is changed to reflect the new stock symbol you
typed in step 3.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q157482.htm">Q157482</A></B>
   TITLE     : XL97: How to Create Web Query (.iqy) Files

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about Web queries, click the Index tab in Microsoft
Excel Help, type the following text
<P>
<PRE>   web, queries

</PRE>and then double-click the selected text to go to the "Create a Web query"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbusage<BR>
KBSubcategory: xlweb xlquery<BR>
Additional reference words: 97 XL97 www<BR>
Keywords          : xlquery xlweb kbtool kbualink97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
