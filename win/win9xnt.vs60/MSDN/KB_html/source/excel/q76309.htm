

<HTML>
<HEAD>
<TITLE>Send.Keys Macro to Size Window Doesn't Work in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76309 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/09/19">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAH6,QAYV,QBI8,QAUD,QBWS,QA5E,QAJ6,QDO5,QAB9,QBXS,QAY4,QAY2,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Send.Keys Macro to Size Window Doesn't Work in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76309 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The Excel macro shown below uses the SEND.KEYS command to activate
another application (Q+E in this example) and then attempts to resize
the application window. Running this macro may hang your machine.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The body of the following macro contains three Send.Keys commands. The
first statement (A1) activates Q+E. The second statement (A2) chooses
Size from the Control menu and the Sizing Arrow is displayed on the
screen. The third Send.Keys (A3) should then resize the window, but
may instead lock up your machine, causing you to have to reboot.
<P>
Microsoft is researching this problem and will post new information
here as it becomes available.
<P>
NOTE: A workaround follows the "Steps to Reproduce Problem" section.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Q+E by choosing Activate Q+E from the Data menu in Excel. Then
   minimize Q+E.

<P><LI>Enter the following into a macro sheet:
<P>
<P><PRE>      A1:  =SEND.KEYS("^{ESC}Q%S",TRUE)
      A2:  =SEND.KEYS("%( )S",TRUE)
      A3:  =SEND.KEYS("{LEFT}{RIGHT 5}~",TRUE)
      A4:  =RETURN()
</PRE>
<P><LI>Run the macro by selecting cell A1 and choosing Run from the Macro
   menu.
<P>
</OL>Q+E has been brought into a window and the sizing arrow appears in
the middle of the window, but no resizing is done. Your machine may be
locked up. The last keystrokes do not get sent and are never executed.
<P>
This macro works correctly in Excel for OS/2. This macro will also
work if you attempt to use it to resize an Excel worksheet in the same
instance of Excel.
<P>
<P><h3>Workaround</h3>
 
<P>
Combining the second and third statements into one causes the macro to
run properly because all the keystrokes are sent to Q+E at one time:
<P>
<PRE>   A1:  =SEND.KEYS("^{ESC}Q%S",TRUE)
   A2:  =SEND.KEYS("%( )S {LEFT}{RIGHT 5}~",TRUE)
   A3:  =RETURN()

</PRE></OL>Reference(s) :
<P>
"Microsoft Excel Function Reference," version 3.0, page 166
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
