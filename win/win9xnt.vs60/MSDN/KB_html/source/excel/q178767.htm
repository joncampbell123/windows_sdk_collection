

<HTML>
<HEAD>
<TITLE>XL: Grouping a Field in a PivotTable Changes Other PivotTable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178767">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1998/01/02">
<META NAME="Keywords" CONTENT="xlpivot">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, if you group or ungroup a field in a PivotTable, the same field may also be grouped or ungrouped in another PivotTable.  CAUSE =====  This problem will occur if one PivotTa...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVU,QBVP,QABO,QBWS,QA7O,QA7N,QASR,QA2Q,QAHP,QAJQ,QAHT,QAYY,QBQU,QBV4,QAG2 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Grouping a Field in a PivotTable Changes Other PivotTable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178767</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article,
if you group or ungroup a field in a PivotTable, the same field may also be
grouped or ungrouped in another PivotTable.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem will occur if one PivotTable uses another PivotTable as the
source of its data.
<P>
Specifically, this problem occurs because, when you create a PivotTable
that uses another PivotTable as the source of its data, both PivotTables
share a common PivotTable memory cache. This cache contains not only the
data used by both PivotTables, but also the settings for the PivotTables,
including grouping settings. As a result, when you group or ungroup a field
in one PivotTable, the same field is grouped or ungrouped in the other
PivotTable.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, when you create a new PivotTable,
do not use another PivotTable as the source of its data:

<OL><P><LI>On the Data menu, click PivotTable or PivotTable Report.

<P><LI>In the PivotTable Wizard - Step 1 of 4 dialog box, select one of the
   following three option buttons
<P>
<P><PRE>      Microsoft Excel List or Database
      External Data Source
      Multiple Consolidation Ranges
</PRE><P>
   depending on the location of the source data.

<P><LI>Click Next, and proceed through the remainder of the PivotTable
   creation process.
<P>
</OL>If you have already created the new PivotTable, you must delete the
existing PivotTable, and then create another new PivotTable, using the
steps above.
<P>
Note that using this workaround will increase the size of your workbook,
because each PivotTable will have its own PivotTable memory cache.
<P>
Note also that if you create a PivotTable that uses the same source data as
another PivotTable, but you do not use the other PivotTable as the source
of the data, you may receive an alert message similar to the following:
<P>
<PRE>   Your new PivotTable will use less memory if you base it on your
   existing PivotTable [&lt;WorkbookName&gt;]&lt;SheetName&gt;!&lt;PivotTableName&gt;,
   which was created from the same source data. Do you want your new
   PivotTable to be based on the same data as your existing PivotTable?

</PRE></OL>If you click Yes, the new PivotTable will use the old PivotTable as the
source of its data, and the problem described above will occur. If you
click No, the new PivotTable will use its own PivotTable memory cache, and
the problem described above will not occur.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design of the versions of Microsoft Excel listed at the
beginning of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, you can group numeric fields in a PivotTable by
different intervals of time: for example, seconds, minutes, hours, days,
months, quarters, and years. To group a field, follow these steps:

<OL><P><LI>Select a cell in the field in the PivotTable that you want to group.
<P>
   NOTE: Don't select the grey "button" for the field.

<P><LI>On the Data menu, point to Group And Outline, and click Group.

<P><LI>If necessary, change the values in the Starting At and/or Ending At
   edit boxes. In the By list box, select the interval(s) that you want
   to group.

<P><LI>Click OK.
<P>
</OL>The selected field in the PivotTable is grouped using the interval(s) you
selected.
<P>
You can ungroup a field by selecting a cell in the field, clicking the Data
menu, pointing to Group And Outline, and clicking Ungroup.
<P>
The following steps demonstrate the problem described above:

<OL><P><LI>In Microsoft Excel, create a new workbook. In Sheet1, enter the
   following data:
<P>
<PRE>      A1: Start    B1: Sales
      A2: 1/1/98   B2: 4
      A3: 2/1/98   B3: 3
      A4: 3/1/98   B3: 2
      A4: 4/1/98   B4: 1

</PRE><P><LI>Select cell A1. On the Data menu, click PivotTable or PivotTable
   Report.

<P><LI>In the PivotTable Wizard dialog box, follow these steps:
<P>
<P><PRE>    a. In Step 1, click Next.
</PRE><P>
<P><PRE>    b. In Step 2, click Next.
</PRE><P>
<P><PRE>    c. In Step 3, drag the Start field to the ROW area, and drag the Sales
       field to the DATA area. Then, click Next.
</PRE><P>
<P><PRE>    d. In Step 4, enter "Sheet2!A1" (without the quotation marks) in the
       PivotTable Starting Cell edit box. Or, click the Existing Worksheet
       option button, and enter "Sheet2!A1" (without the quotation marks,
       in the edit box.
</PRE><P>
<P><PRE>    e. Click Finish.
</PRE><P>
   A new PivotTable appears in Sheet2.

<P><LI>Activate Sheet3, and select cell A1.

<P><LI>On the Data menu, click PivotTable or PivotTable Report.

<P><LI>In the PivotTable Wizard dialog box, follow these steps:
<P>
<P><PRE>    a. In Step 1, select the Another PivotTable option button. Click Next.
</PRE><P>
<P><PRE>    b. In Step 2, select the PivotTable you created in step 3. Click Next.
</PRE><P>
<P><PRE>    c. In Step 3, drag the Start field to the ROW area, and drag the Sales
       field to the DATA area. Then, click Next.
</PRE><P>
<P><PRE>    d. In Step 4, click Finish.
</PRE><P>
   Another new PivotTable appears in Sheet3.

<P><LI>Select cell A3 in Sheet3. On the Data menu, point to Group And
   Outline, and click Group.

<P><LI>In the By list, select Months. Then, click OK.
<P>
   Note that the PivotTable in Sheet3 is now grouped by month (Jan, Feb,
   Mar, and so on).

<P><LI>Activate Sheet2.
<P>
</OL>The PivotTable in Sheet2 is also grouped by month, even though you did not
group the field in the PivotTable. This occurs because the two PivotTables
share a common PivotTable memory cache.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL5 XL7 XL97<BR>
Keywords          : xlpivot<BR>
Version           : MACINTOSH:5.0,5.0a,98; WINDOWS:5.0,5.0c,7.0,7.0a,97<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
