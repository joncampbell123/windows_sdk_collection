

<HTML>
<HEAD>
<TITLE>XL5: Array Formula Doesn't Recalculate Using Calculate Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130708">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/05/25">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the Calculate method in a Visual Basic procedure to recalculate a range of cells, if the range contains an array formula, one of the following occurs:   - If the array formula is in a single cell, the formula is no ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAPN,QAE5,QAB9,QAVZ,QDMR,QBVV,QBV8,QDNZ,QAY5,QAPF,QBWS,QBS0,QBSO,QBJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Array Formula Doesn't Recalculate Using Calculate Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130708</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the Calculate method in a Visual Basic
procedure to recalculate a range of cells, if the range contains an array
formula, one of the following occurs:

<UL><LI>If the array formula is in a single cell, the formula is no longer an
   array after you run the procedure
<P>
<P><PRE>    -or-
</PRE>
<LI>If the array formula is in a range of cells, the range is not
   recalculated.
<P>
</UL><h2>CAUSE</h2>
 
<P>
This problem occurs when you calculate any array formula using the
Calculate method, whether the formula contains a custom function or
a built-in function.
<P>
Note that this problem does not occur in Microsoft Excel for Windows
version 5.0.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>To recalculate an array formula, use any of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Calculate the entire sheet by using the Calculate method with the
Worksheets object, as in the following example:
<P>
<PRE>   Worksheets(1).Calculate

</PRE><h3>Method 2</h3>
 
<P>
Set the Calculation option to Automatic by following these steps:

<OL><P><LI>On the Tools menu, click Options.

<P><LI>Click the Calculation tab.

<P><LI>Under Calculations, click Automatic, and then click OK.
<P>
</OL>Note that to recalculate a custom function that is entered as an array
using this method, you must then calculate the worksheet. To do this, you
can press F9 to calculate the entire workbook, or press SHIFT+F9 to
calculate only the selected worksheet.
<P>
<P><h3>Method 3</h3>
 
<P>
Calculate the selected range by using the Replace method with the Selection
property, as in the following example:
<P>
<PRE>   Selection.replace What:="=", Replacement:="=", _
   LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False

</PRE></OL>This macro simulates re-entering the formula and does not damage the array
formula.
<P>
NOTE: If you use this method, and you later find errors on your sheet that
are related to array formulas, close the sheet without saving your changes
and use either method 1 or 2.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was fixed in
Microsoft Excel for Windows 95, version 7.0, Microsoft Excel 97, and
Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q118655.htm">Q118655</A></B>
   TITLE     : XL5: Custom Function Doesn't Recalculate with Calculate
               Method

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the "Calculate Method", choose the Search
button in Help and type:
<P>
<PRE>   calculate method
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c broken breaks #value! error XL5<BR>
Version           : WINDOWS:5.00c; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
