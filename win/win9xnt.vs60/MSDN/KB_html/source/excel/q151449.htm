

<HTML>
<HEAD>
<TITLE>XL: How to AutoFilter Records Based on Cell Formatting </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151449">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1996/05/23">
<META NAME="Keywords" CONTENT="xlformat xllist kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article describes how to use the AutoFilter feature of Microsoft Excel to filter records in a database where a particular field has been formatted to a bold font.  MORE INFORMATION  This article contains two examples that describe using the Au...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA5V,QAUJ,QBQU,QDNZ,QAG9,QBJZ,QAUD,QABX,QBWS,QAA1,QBCF,QAE1,QA50,QANX P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to AutoFilter Records Based on Cell Formatting</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151449</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
SUMMARY
 
<P>
This article describes how to use the AutoFilter feature of Microsoft Excel
to filter records in a database where a particular field has been formatted
to a bold font.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article contains two examples that describe using the AutoFilter
command to filter records based on cell formatting in certain fields.
<P>
<P><h3>Filtering Based on a Bold Font</h3>
 
<P>
To set up the example, follow these steps:

<OL><P><LI>In a new worksheet, enter the following data:
<P>
<PRE>       A1: Name      B1: Amount
       A2: Bob       B2: 1
       A3: Sue       B3: 2
       A4: Pat       B4: 3
       A5: Tom       B4: 4

</PRE><P><LI>Format cells A2 and A4 as Bold.

<P><LI>On the Insert menu, point to Name, and then click Define.

<P><LI>In the Define Name dialog box, enter "bold_cell," (without the
    quotation marks) in the Names In Workbook box.

<P><LI>In the Refers To box, enter the following formula:
<P>
       =GET.CELL(20,OFFSET(INDIRECT("A2"),ROW()-2,0))

<P><LI>Click OK.

<P><LI>Enter the following in the same worksheet:
<P>
       C1: Bold?
       C2: =bold_cell

<P><LI>Fill the formula in cell C2 down to cell C5 so that all of the cells
    in the range C2:C5 have the formula "=bold_cell" (without the
    quotation marks.
<P>
    After you fill the formula down, the following data is displayed in
    column C based on the current cell formatting:
<P>
      C1: Bold?
      C2: TRUE
      C3: FALSE
      C4: TRUE
      C5: FALSE

<P><LI>Select cell A1. On the Data menu, point to Filter, and then click
    Auto_Filter.
<P>
    This step puts the Auto_Filter dropdown arrows at the top of each
    field.

<P><LI>Click the dropdown arrow on the "Bold?" field and click True in the
    list.
<P>
</OL>Your list should be filtered so that only the records (row 2 and row 4) in
which the name has been formatted in bold are displayed.
<P>
Note that if you change the cell formatting of cell A3 to bold and remove
the bold formatting from cell A4, you must recalculate the worksheet in
order for the values in column C to be updated.
<P>
<P><h3>Filtering Based on a Red Font</h3>
 
<P>
To set up the example, follow these steps:

<OL><P><LI>In a new worksheet, enter the following data:
<P>
<PRE>       A1: Name    B1: Amount
       A2: Bob     B2: 1
       A3: Sue     B3: 2
       A4: Pat     B4: 3
       A5: Tom     B5: 4

</PRE><P><LI>Format cells A3 and A5 in the red font.

<P><LI>On the Insert menu, point to Name, and then click Define.

<P><LI>In the Define Name dialog box, enter "red_cell" (without the quotation
    marks), in the Names In Workbook box.

<P><LI>In the Refers To box, enter the following formula:
<P>
       =GET.CELL(24,OFFSET(INDIRECT("A2"),ROW()-2,0))

<P><LI>Click OK.

<P><LI>Enter the following in the same worksheet:
<P>
       C1: Red?
       C2: =red_cell

<P><LI>Fill the formula in cell C2 down to cell C5 so that all of the cells
    in the range C2:C5 have the formula "=red_cell" (without the quotation
    marks).
<P>
    After you fill the formula down, the following data is displayed in
    column C based on the current cell formatting:
<P>
       C1: Bold?
       C2: 0
       C3: 3
       C4: 0
       C5: 3
<P>
    Note that cells C3 and C5 return a value of 3 because this is the index
    number of the red font color.

<P><LI>Select cell A1, on the Data menu point to Filter, and then click
    Auto_Filter.
<P>
    This step puts the Auto_Filter dropdown arrows at the top of each
    field.

<P><LI>Click the dropdown arrow on the "Red?" field and click 3 in the list.
<P>
</OL>Your list should be filtered so that only the records (row 3 and row 5) in
which the name has been formatted in red are displayed.
<P>
Note that if you change the cell formatting of cell A2 to red and remove
the red formatting from cell A3, you must recalculate the worksheet by
pressing F9 (in Microsoft Excel for the Macintosh, press COMMAND+=) in
order for the values in column C to be updated.
<P>
Note that in both of the examples, because of the way that the reference in
the defined name is structured, you must put the defined name that uses
this formula in column C and the field in which you are looking for a
particular formatting in column A.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide," version 5.0, Chapter 10, "Creating Formulas
and Links"
<P>
For more information about creating defined names in Microsoft Excel
version 7.0, click Answer Wizard on the Help menu and type:
<P>
<PRE>   how do i create a defined name

</PRE></OL>For more information about creating defined names in Microsoft Excel
version 5.0, click the Search button in Help and type:
<P>
<PRE>   defining, names
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 8.00 97 98 XL98 XL97 XL7 XL5<BR>
Keywords          : xlformat xllist kbualink97<BR>
Version           : WINDOWS:5.0;5.0c,7.0,97;MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
