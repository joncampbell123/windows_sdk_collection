

<HTML>
<HEAD>
<TITLE>XL: Cannot Remove Entries from Add-Ins Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110076">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1994/01/12">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   In Microsoft E...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAEF,QAH0,QA9N,QANJ,QACI,QAY2,QDKD,QDH6,QAGB,QAB4,QAE1,QBJZ,QAA1,QBCT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Cannot Remove Entries from Add-Ins Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110076</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, when you choose Add-Ins from the Tools
menu, you cannot remove an entry from the Add-Ins Available list in the
Add-Ins dialog box.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
<P><h3>Microsoft Excel 5.x for Windows</h3>
 
<P>
To remove an add-in from the Add-Ins Available list, do either of the
following:

<UL><LI>Remove the reference to the add-in from the EXCEL5.INI file
<P>
   NOTE: This option can only be used for custom add-ins. To remove add-ins
   that are shipped with Microsoft Excel 5.0, follow the delete procedure
   in the "To delete or move the add-in file" section, later in this
   article).
<P>
   -or-

<LI>Delete or move the add-in file
<P>
</UL><h3>To remove the reference to the add-in from the EXCEL5.INI file</h3>
 

<OL><P><LI>Open the EXCEL5.INI in any text editor (such as Windows Notepad).

<P><LI>Locate the section of the EXCEL5.INI file that lists the add-in you want
   to remove as follows:
<P>
<P><PRE>    - If the add-in you want to remove was selected in the Add-Ins
      Available list, locate the [Microsoft Excel] section of the
      EXCEL5.INI file. All add-ins that are selected in the Add-Ins
      Available list are listed in this section. The following is an
      example of a listing for the add-in MYADDIN.XLA located in the Excel
      directory:
</PRE><P>
<PRE>         [Microsoft Excel]
         Open1=C:\Excel\myaddin.xla

    - If the add-in was listed but not selected in the Add-Ins Available
      list, locate the [Add-In Manager] section of the EXCEL.INI file. All
      add-ins that are listed but not selected in the Add-Ins Available
      list are listed in this section. The following is an example of an
      add-in listed in the [Add-In Manager] section:

         [Add-In Manager]
         C:\Excel\myaddin.xla=

</PRE><P><LI>Delete the add-in entry, and then save and close the EXCEL5.INI file.
<P>
</OL><h3>To delete or move the add-in file</h3>
 
<P>
To delete or move the add-in file, do the following:

<OL><P><LI>In Microsoft Excel, from the Tools menu, choose Add-Ins. In the Add-Ins
   Available list, clear the check box next to the add-in you want to
   remove and choose OK.

<P><LI>From File Manager or an MS-DOS command prompt, delete the add-in file or
   move it to another directory on your hard disk drive.

<P><LI>Switch to Microsoft Excel, and from the Tools menu, choose Add-Ins. From
   the Add-Ins Available list, choose the add-in you deleted or moved in
   step 2.
<P>
</OL>The following error message appears:
<P>
<PRE>   Cannot find add-in 'C:\Excel\myaddin.xla'. Delete from list?

</PRE><P><LI>Choose OK.
<P>
</OL>The add-in entry will be removed from the Add-Ins Available list.
<P>
NOTE: If you delete or move a custom add-in that was selected in the Add-
Ins Available list while Microsoft Excel is not running, you receive the
following error message each time you start Microsoft Excel:
<P>
<PRE>   Cannot Find C:\Excel\myaddin.xla

</PRE></OL>If you delete or move an add-in that is shipped with Microsoft Excel
5.0, you will not receive the above error until you try to use an
option that accesses that add-in.
<P>
To keep this error message from being displayed, use the first workaround
above to remove the reference to the add-in from EXCEL5.INI.
<P>
<P><h3>Microsoft Excel for Windows 95, version 7.0</h3>
 
<P>
You can remove the item from the list of add-ins by manually removing its
registry entry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
The registry entry that loads the add-in can also be manually removed from
the following registry key:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Excel\7.0\Init Commands

</PRE>a. Exit Microsoft Excel.
<P>
b. On the Windows 95 taskbar, click Start, and then click Run.
<P>
c. In the Run box, type "regedit" (without the quotation marks), and click
<PRE>   OK.

</PRE>d. Locate the following key:
<P>
<PRE>      HKEY_CURRENT_USER\Software\Microsoft\Excel\7.0\Init Commands

</PRE>e. In the right pane, locate the entry for the add-in that you no longer
<PRE>   want listed.

</PRE>f. Click the entry and press the DELETE key. Click Yes when prompted to
<PRE>   confirm the deletion.

</PRE>g. On the Registry menu, click Exit.
<P>
h. Start Microsoft Excel.
<P>
The error message should no longer appear.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q136393.htm">Q136393</A></B>
   TITLE     : How to Modify the Windows Registry

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Add-ins are custom commands or functions that appear to be part of
the Microsoft Excel application.
<P>
To install an add-in:

<OL><P><LI>From the Tools menu, choose Add-ins.

<P><LI>From the Add-ins dialog box, choose Browse, and then select the add-in
   you want to add. (You may need to switch to a different directory
   depending on where your add-in is stored.)
<P>
</OL>Once the add-in appears in the Add-Ins Available list, you cannot
remove it using the Add-In dialog box.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide," version 5.0, page 660
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 5.00c 7.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
