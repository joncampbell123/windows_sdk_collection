

<HTML>
<HEAD>
<TITLE>XL97: Crash When Chart Gallery File Is Password Protected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161438">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/12/23">
<META NAME="Keywords" CONTENT="xlchart xlgpf kberrmsg kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you click Chart Type on the Chart menu, and then click the Custom  Types tab, you may receive the following error message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contact the progr...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDNX,QBWS,QDNG,QAWK,QDKX,QAQG,QAEF,QAH4,QAA1,QDNM,QAUR,QAP2,QDI2,QBCT P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Crash When Chart Gallery File Is Password Protected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161438</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you click Chart Type on the Chart menu, and then click the Custom 
Types tab, you may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, a message similar to the following appears:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at
   0137:300af7a2.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when either of the following conditions is true:

<UL><LI>The Xl8galry.xls file is password protected.
<P>
<P><PRE>    -or-
</PRE>
<LI>The Xlusrgal.xls file is password protected.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, follow these steps to remove the password 
protection from the Xl8galry.xls or the Xlusrgal.xls file: 

<OL><P><LI>Open the appropriate file (Xl8galry.xls or Xlusrgal.xls). 
<P>
   By default, the files are stored in the Program Files\Microsoft 
   Office\Office folder.
<P>
   NOTE: The Xl8galry.xls and Xlusrgal.xls files are chart "autoformat"
   files. These files store custom chart formats.

<P><LI>On the File menu, click Save As, and then click Options.

<P><LI>In the Password To Open box, click the password.

<P><LI>Press DELETE, and then Click OK.

<P><LI>Click Save, and then click Yes when you are prompted to overwrite
   the existing copy of the file.
<P>
</OL>If you do not know the password, you must delete the chart autoformat file
that is password protected.
<P>
If you delete the Xlusrgal.xls file, you lose any custom chart formats that
you created.
<P>
If you delete the Xl8galry.xls file, you can recreate the file only by
using the following steps:

<OL><P><LI>Start the Microsoft Office Setup program.
<P>
   Because you already installed Microsoft Office, the Setup program runs
   in maintenance mode.

<P><LI>In the first dialog box that appears, click Reinstall.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products 
listed at the beginning of this article. We are researching this problem 
and will post new information here in the Microsoft Knowledge Base as it 
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Xl8galry.xls stores custom chart formats that come with Microsoft Excel 97.
Xlusrgal.xls stores any custom chart formats that you create. Microsoft
Excel does not create Xlusrgal.xls until you create a custom chart format.
<P>
For additional information about working with custom chart types in
Microsoft Excel, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q161348.htm">Q161348</A></B>
   TITLE     : XL97: Working With Default and User Defined Chart Formats

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about Chart Autoformats, click the Index tab in
Microsoft Excel Help, type the following text
<P>
<PRE>   chart creation, templates

</PRE>and then double-click the selected text to go to the "Save a custom chart
type to apply to other charts" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlchart xlgpf kberrmsg kbualink97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
