

<HTML>
<HEAD>
<TITLE>XL98: Hard Disk Name Appears in Formula or Defined Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180617">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1998/02/05">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 98 Macintosh Edition, if you copy a worksheet, the following problems may occur.  Case 1 ------  A linking formula may be changed so that the name of the hard disk appears in the formula.  For example, if a formula should appear ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QAUJ,QBJZ,QA9N,QBVP,QBWS,QASB,QAPF,QAUD,QAB9,QA50,QARM,QACI,QBVV,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Hard Disk Name Appears in Formula or Defined Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180617</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, if you copy a worksheet, the
following problems may occur.
<P>
<P><h3>Case 1</h3>
 
<P>
A linking formula may be changed so that the name of the hard disk appears
in the formula.
<P>
For example, if a formula should appear as follows
<P>
<PRE>   =[Workbook1]Sheet1!A1

</PRE>it actually appears as follows:
<P>
<PRE>   ='Freds DiskDes:ktop Folder:[Workbook1]Sheet1'!A1

</PRE>As a result, the formula does not return the correct result.
<P>
<P><h3>Case 2</h3>
 
<P>
Defined names may be changed so that the name of the hard disk appears in
the formula.
<P>
For example, if a defined name should refer to the following
<P>
<PRE>   =[Workbook1]Sheet1!A1

</PRE>it actually refers to the following:
<P>
<PRE>   ='Freds DiskDes:ktop Folder:[Workbook1]Sheet1'!A1

</PRE>To see an example of these problems, please see the "More Information"
section in this article.
<P>
<P><h2>CAUSE</h2>
 
<P>
<P><h3>Case 1</h3>
 
<P>
The first problem (in which a formula is changed) may occur when the
following conditions are true:

<UL><LI>The workbook to which the formulas are linked (for example, Workbook1)
   is stored on a floppy disk drive, hard disk drive, network drive (shared
   disk), or random access memory (RAM) disk, and the disk name is exactly
   ten characters in length, including spaces. For example, the disk is
   named either of the following:
<P>
<P><PRE>      Freds Disk
      MyPowerMac
</PRE><P>
<P><PRE>    -and-
</PRE>
<LI>You copy a worksheet that contains links to the workbook, either by
   clicking Move Or Copy Sheet on the Edit menu or by pressing CONTROL and
   clicking the worksheet tab, and then clicking Move Or Copy on the
   shortcut menu.
<P>
   It does not matter which workbook contains the worksheet you are
   copying. What matters is that the formulas are linked to the
   specific workbook (Workbook1, in this example).
<P>
</UL>NOTE: This problem does not occur when you move a worksheet.
<P>
<P><h3>Case 2</h3>
 
<P>
The second problem, (in which a defined name is changed) may occur when the
following conditions are true:

<UL><LI>The workbook to which the formulas are linked (for example, Workbook1)
   is stored on a floppy disk drive, hard disk drive, network drive, or RAM
   disk, and the disk name is exactly ten characters in length, including
   spaces. For example, the disk is named either of the following:
<P>
<P><PRE>      Freds Disk
      MyPowerMac
</PRE><P>
<P><PRE>    -and-
</PRE>
<LI>You copy a different worksheet in the same workbook that contains the
   defined name.
<P>
   For example, if the defined name refers to a cell in Sheet1, you copy
   Sheet2 or Sheet3, and then copy the worksheet into another workbook.
<P>
</UL>NOTE: This problem does not occur when you move a worksheet.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent these problems from occurring, make sure that the names of your
hard disk drive, floppy drive, or RAM disk are not exactly ten characters
in length.
<P>
If any of your network drives have names that are exactly ten characters in
length, contact your network administrator to see if it is possible to
rename the network drive. Otherwise, store your workbooks on a different
network drive, or on a local hard disk with a name that is not ten
characters in length.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Examples</h3>
 
<P>
<P><h3>Case 1: Linking Formulas Are Changed</h3>
 
<P>
To see an example of this behavior, follow these steps:

<OL><P><LI>Quit all running programs.

<P><LI>In the Finder, select the icon for your hard disk. Click the title
   once. Type "Freds Disk" (without the quotation marks) and press RETURN.

<P><LI>Start Microsoft Excel. Note that the program may take longer than
   usual to start; this is because Microsoft Excel must re-register itself
   after you rename the hard disk.

<P><LI>In Sheet1, enter the value 100 in cell A1.

<P><LI>In Sheet2, enter the following formula in cell A1:
<P>
<P><PRE>      =Sheet1!A1
</PRE>
<P><LI>On the File menu, click Save. Click the Desktop button. Change the
   file name to "Workbook1" (without the quotation marks) and click Save.

<P><LI>Do either of the following:
<P>
<P><PRE>    a. With Sheet2 still active, click Move Or Copy Sheet on the Edit
       menu. Select the Create A Copy checkbox and click OK.
</PRE><P>
<P><PRE>    -or-
</PRE><P>
<P><PRE>    a. Create a new workbook. In Sheet1 of the new workbook, enter the
       following formula in cell A1:
</PRE><P>
<PRE>          =[Workbook1]Sheet1!A1

    b. On the Edit menu, click Move Or Copy Sheet. Select the Create A
       Copy checkbox and click OK.

</PRE></OL>The formula in cell A1 in the new worksheet appears as follows:
<P>
<PRE>   ='Freds DiskDes:ktop Folder:[Workbook1]Sheet1'!A1

</PRE>If you change the value in cell A1 in Sheet1, the formula in Sheet2 is
updated correctly, but the formula in the new worksheet is not.
<P>
<P><h3>Case 2: Defined Names Are Changed</h3>
 
<P>
To see an example of this behavior, follow these steps:

<OL><P><LI>Quit all running programs.

<P><LI>In the Finder, select the icon for your hard disk. Click the title
   once. Type "Freds Disk" (without the quotation marks) and press RETURN.

<P><LI>Start Microsoft Excel. Note that the program may take longer than
   usual to start; this is because Microsoft Excel must re-register itself
   after you rename the hard disk.

<P><LI>In the new workbook, select cell A1 in Sheet1. In the Name box (to the
   left of the formula bar), type "test" (without the quotation marks) and
   press RETURN.

<P><LI>On the File menu, click Save. Click the Desktop button. Change the
   file name to "Workbook1" (without the quotation marks) and click Save.

<P><LI>Select Sheet2. On the Edit menu, click Move Or Copy Sheet. In the list
   box, click "(new book)." Select the Create A Copy check box, and click
   OK.
<P>
   A new workbook is created and activated.

<P><LI>On the Insert menu, point to Name, and then click Define. Click "test"
   in the Names In Workbook list.
<P>
</OL>The Refers To box contains the following:
<P>
<PRE>   ='Freds DiskDes:ktop Folder:[Workbook1]Sheet1'!$A$1
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 volume<BR>
Keywords          : xlformula<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbbug<BR>
Solution Type     : kbnofix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
