

<HTML>
<HEAD>
<TITLE>MXL5: Using FoxPro Index Files with Microsoft Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129074">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/04/18">
<META NAME="Keywords" CONTENT="xlmac xlquery kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="   When you access data from a FoxPro 2.5 or 2.6 data source in Microsoft Query or from a Microsoft Excel 5.0 Visual Basic for Applications macro, the query may seem slow even if an index for the table is being used.  You may also fail to receive any...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QBI0,QAJQ,QDI1,QAB4,QBVP,QAZZ,QAFI,QAUJ,QABM,QAAP,QABI,QBW7,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MXL5: Using FoxPro Index Files with Microsoft Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129074</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Query for the Macintosh, version 1.0
</UL> 
<P>
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you access data from a FoxPro 2.5 or 2.6 data source in Microsoft
Query or from a Microsoft Excel 5.0 Visual Basic for Applications macro,
the query may seem slow even if an index for the table is being used.
<P>
You may also fail to receive any results when you use the SQLRequest and
SQLRetrieve functions in a macro or the SQL.REQUEST function on a worksheet
to access a FoxPro data source. If you are using SQLRequest or SQLRetrieve
in a macro and SQLError is used to trap ODBC errors, you may be able to
trap and generate the following error message
<P>
<PRE>   [Q+E Software][ODBC dBase driver][dBase][Production MDX or CDX file not
   found for table: &lt;path&gt;:&lt;table name&gt;

</PRE>where &lt;path&gt; is the path to the .DBF file and &lt;table name&gt; is the name of
the .DBF file being accessed.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Microsoft FoxPro 2.5 or 2.6, indexes are created as tag names that are
stored in a single .CDX file. The .CDX file has the same base name as the
database file (for example, ORDERS.CDX is the index file for the ORDERS.DBF
database). Microsoft FoxPro uses index files to ensure faster querying and
sorting of database tables.
<P>
If the .CDX file is not located in the same directory as the .DBF file, you
will receive an Error 2042 (#N/A) when retrieving data using the
SQLRequest, SQLRetrieve, or SQL.REQUEST functions. This error occurs
because the .DBF file header created by FoxPro contains a pointer to the
.CDX file. If the .CDX file isn't in the same directory, it will cause the
error message mentioned above.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this error, make sure that an index file has been created for
the .DBF file in question and that the index file is located in the same
folder as the .DBF file.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Microsoft
Excel listed above. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Q+E and Microsoft FoxPro Driver creates a file called QEDBF.INI. This
file contains information about the index files for each table and is
located in the same folder as the .DBF file.
<P>
An index is only useful when a WHERE clause is being used in a SELECT
statement. For example, the following SQL statement does not use an index
to speed up the query:
<P>
<PRE>   SELECT * FROM orders

</PRE>However, you can modify this statement as shown below to take advantage of
using an index file:
<P>
<PRE>   SELECT * FROM orders WHERE (order_id='10000')

</PRE>If the index file uses an index based on the ORDER_ID field, then you will
see a marked improvement in the speed of the query.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on FoxPro index files, search for "indexes" in the Q+E
ODBC FoxPro Driver Help file located in the Microsoft folder.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.0 long time<BR>
Keywords          : xlmac xlquery kbinterop<BR>
Version           : MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
