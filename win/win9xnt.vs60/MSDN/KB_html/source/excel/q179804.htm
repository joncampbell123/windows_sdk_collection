

<HTML>
<HEAD>
<TITLE>XL: References Missing Moving Files from Windows to Macintosh </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179804">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1998/01/23">
<META NAME="Keywords" CONTENT="xlloadsave xlvbainfo kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In either of the programs listed at the beginning of this article, when you open a workbook, references may be listed as missing in the References dialog box in the Visual Basic Editor. The references as listed as missing even though the referenced...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QBWS,QBS0,QAB3,QDL9,QBWO,QBWN,QDO9,QAFI,QDH6,QANA,QBWQ,QAH0,QAUJ P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: References Missing Moving Files from Windows to Macintosh</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179804</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In either of the programs listed at the beginning of this article, when you
open a workbook, references may be listed as missing in the References
dialog box in the Visual Basic Editor. The references as listed as missing
even though the referenced files are stored in the correct location and
have not been moved, renamed, or deleted.
<P>
This may cause problems if you run Visual Basic macros that use the
referenced files.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when the following conditions are true:

<UL><LI>The workbook contains a reference to a file (workbook, add-in, type
   library, and so on) that is stored on a network server that is
   accessible to computers running Microsoft Windows or the Macintosh
   operating system.
<P>
<P><PRE>    -and-
</PRE>
<LI>The referenced file is not stored in the same folder as the workbook.
<P>
<P><PRE>    -and-
</PRE>
<LI>At various times, you open the workbook in both Microsoft Excel 97 for
   Windows and Microsoft Excel 98 Macintosh Edition.
<P>
</UL>Specifically, the problem occurs because the different versions of
Microsoft Excel do not always properly handle the transition from the
Universal Naming Convention (UNC) (for example, \\Server\Files\User001) to
the Macintosh pathing convention (for example, Files:User001). Because of
this problem, references to files may be damaged when you move a workbook
from Microsoft Excel for Windows to Microsoft Excel for the Macintosh or
vice versa.
<P>
To see an example of this problem, see the "More Information" section in
this article.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, store the referenced files in the
same folder as the workbook that references them. If the files and the
workbook are in the same folder, the references are not listed as missing
when you open the workbook.
<P>
Note that if you manually correct the missing references in the References
dialog box, the problem may occur again the next time you open the
workbook.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Example</h3>
 
<P>
For this example, assume the following:

<UL><LI>A network server is accessible by computers running Windows or the
   Macintosh operating system. For example, network server is running
   Microsoft Windows NT Server and is running Services for Macintosh (SFM).
<P>
<P><PRE>    -and-
</PRE>
<LI>The server is named "Server" and contains a share named "Files." The
   share contains a folder named "User001" that contains a folder named
   "Addins." The Addins folder contains an add-in named "Test.xla."
<P>
</UL>To see an example of the problem, follow these steps:

<OL><P><LI>Start Microsoft Excel 97 for Windows and create a new workbook.

<P><LI>Point to Macro on the Tools menu, and click Visual Basic Editor.
   Then, click References on the Tools menu.

<P><LI>Click Browse. In the File Name box, type the following:
<P>
<P><PRE>      \\Server\Files\User001\Addins\Test.xla
</PRE><P>
   Click Open.
<P>
   An entry for the add-in appears in the Available References list.

<P><LI>Click OK. Then, click Close And Return To Microsoft Excel on the File
   menu.

<P><LI>On the File menu, click Save As. In the File Name box, type the
   following:
<P>
<P><PRE>      \\Server\Files\User001\Testwkbk.xls
</PRE><P>
   Click Save. Then, click Close on the File menu.

<P><LI>On your Macintosh computer, use the Chooser to connect to the Files
   share on the server.

<P><LI>Start Microsoft Excel 98 Macintosh Edition. On the File menu, click
   Open. Select Testwkbk.xls, and click Open.

<P><LI>Point to Macro on the Tools menu, and click Visual Basic Editor.
   Then, click References on the Tools menu.
<P>
</OL>In the Available References list, the reference you added is listed as
"MISSING." The location for the add-in resembles the following:
<P>
<PRE>   Files:User001:Addins\Test.xla

</PRE></OL>Note that a backslash (\) appears in place of the colon (:) near the end of
the Location.
<P>
If you save the Testwkbk.xls workbook, close it, and then reopen the
workbook in Microsoft Excel 97 for Windows, the reference is still listed
as "MISSING."
<P>
If you perform the previous steps in reverse (create the workbook, add the
reference in Microsoft Excel 98 Macintosh Edition, and then open the
workbook in Microsoft Excel 97 for Windows), the reference is also listed
as "MISSING."
<P>
For more information about references in Microsoft Excel, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q175863.htm">Q175863</A></B>
   TITLE     : XL97: Reference Incorrectly Listed as "MISSING" in MS
               Excel 97
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 XL98 unc novell netware<BR>
Keywords          : xlloadsave xlvbainfo kbinterop<BR>
Version           : MACINTOSH:98; WINDOWS:97<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
