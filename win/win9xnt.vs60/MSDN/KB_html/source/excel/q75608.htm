

<HTML>
<HEAD>
<TITLE>Excel: Opening File from Finder Doesn't Set Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75608 ">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1991/08/26">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBWS,QBXS,QAY2,QBJZ,QAFI,QAUJ,QAUD,QBXB,QATJ,QAH4,QAG2,QA50,QBTI,QDO5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Opening File from Finder Doesn't Set Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75608 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00
MACINTOSH
kbother
<P>
<P><h2>SUMMARY</h2>
 
<P>
If Microsoft Excel for the Macintosh version 3.0 is being used with
System 7.0, Excel will not set the active directory to the one where
the file is located if the file is opened from the Finder. To avoid
this behavior, open the file from within Excel by choosing the Open
command from the File menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For a solution to this problem, please contact Product Support
directly at 425-635-7080.
<P>
The following macro commands provide a workaround to this problem.
This macro can be used to set the active folder when a file is
double-clicked in order to launch Excel:
<P>
<PRE>   +---+-------------------------------------------------------------+
   |   |               A                                             |
   +---+-------------------------------------------------------------+
   | 1 | Auto_Open                                                   |
   +---+-------------------------------------------------------------+
   | 2 | =ON.WINDOW(,"Set_Directory")                                |
   +---+-------------------------------------------------------------+
   | 3 | =RETURN()                                                   |
   +---+-------------------------------------------------------------+
   | 4 |                                                             |
   +---+-------------------------------------------------------------+
   | 5 | Set_Directory                                               |
   +---+-------------------------------------------------------------+
   | 6 | =IF(ISERROR(FIND(":",GET.DOCUMENT(2))),GET.DOCUMENT(2)&amp;":", |
   |   |  GET.DOCUMENT(2))                                           |
   +---+-------------------------------------------------------------+
   | 7 | =DIRECTORY(A6)                                 |
   +---+-------------------------------------------------------------+
   | 8 | =ON.WINDOW()                                                |
   +---+-------------------------------------------------------------+
   | 9 | =RETURN()                                                   |
   +---+-------------------------------------------------------------+

</PRE><P><LI>Enter these macro commands on a macro sheet.

<P><LI>Select cell A1, and choose Define Name from the Formula menu.

<P><LI>In the Name box, type "auto_open" (without quotation marks). Click
   OK.

<P><LI>Select cell A5, and choose Define Name from the Formula menu.

<P><LI>In the Name box, type "Set_Directory" (without quotation marks).
   Click OK.

<P><LI>From the File menu, choose Save As.

<P><LI>Click the Options button.

<P><LI>From the File Format list, select Add-In. Click OK.

<P><LI>For the file's destination, choose the Excel Startup Folder, give
   the file a name, and click the Save button.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00 incorrect wrong application<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
