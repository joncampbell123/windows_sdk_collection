

<HTML>
<HEAD>
<TITLE>XL97: PivotTable Appears Incorrect If Data Contains Merged Cell </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172990">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/08/21">
<META NAME="Keywords" CONTENT="xlformat xlpivot">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you create a PivotTable in a worksheet in Microsoft Excel 97, the following problems may occur:   - The row fields or column fields contain extra  (blank)  items.   - Most of the data in the PivotTable is aligned with the  (blank)  row or    c...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVU,QBVP,QDNZ,QBWS,QAYY,QA7O,QA7N,QAR4,QAWH,QAE1,QDMF,QBCF,QASR,QAAP,QAKP P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: PivotTable Appears Incorrect If Data Contains Merged Cell</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172990</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you create a PivotTable in a worksheet in Microsoft Excel 97, the
following problems may occur:

<UL><LI>The row fields or column fields contain extra "(blank)" items.

<LI>Most of the data in the PivotTable is aligned with the "(blank)" row or
   column fields instead of with the correct row or column fields.
<P>
</UL><h2>CAUSE</h2>
 
<P>
This problem may occur if the list of data used to create the PivotTable
contains merged cells.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, unmerge any merged cells in the list of
data used to create the PivotTable, fill the unmerged cells with field
data, and update the PivotTable.
<P>
The "More Information" section in this article contains an example of the
problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The problem described in the "Symptoms" section occurs because of the way
that PivotTables in Microsoft Excel 97 retrieve data from cells in a
worksheet. When you create a PivotTable, the PivotTable ignores any merged
cells in the list of data and retrieves information stored in the
individual cells. Because the cells are blank, they appear in the
PivotTable as blank fields.
<P>
<P><h3>Example</h3>
 
<P>
The following steps demonstrate the problem in Microsoft Excel 97:

<OL><P><LI>In Microsoft Excel 97, create a new workbook. In Sheet1, enter the
   following data:
<P>
<PRE>      A1:  Widget Type   B1:  Quarter   C1:  Sales
      A2:  Alpha         B2:  Q1        C2:  1
                         B3:  Q2        C3:  2
                         B4:  Q3        C4:  3
                         B5:  Q4        C5:  4
      A6:  Bravo         B6:  Q1        C6:  5
                         B7:  Q2        C7:  6
                         B8:  Q3        C8:  7
                         B9:  Q4        C9:  8
      A10: Charlie       B10: Q1        C10: 3
                         B11: Q2        C11: 4
                         B12: Q3        C12: 5
                         B13: Q4        C13: 6

   Note that cells A3:A5, A7:A9, and A11:A13 are blank.

</PRE><P><LI>Select cells A2:A5. On the Formatting toolbar, click Merge And
   Center. Repeat this step with the A6:A9 and A10:A13 cell ranges.

<P><LI>Select cell B5. On the Data menu, click PivotTable Report.

<P><LI>In the PivotTable Wizard, do the following:
<P>
<P><PRE>    a. In step 1 of the wizard, click Next.
</PRE><P>
<P><PRE>    b. In step 2 of the wizard, click Next.
</PRE><P>
<P><PRE>    c. In step 3 of the wizard, drag the Widget Type field to the ROW area
       in the diagram. Drag the Quarter field to the COLUMN area in the
       diagram. Drag the Sales field to the DATA area in the diagram. Then,
       click Next.
</PRE><P>
<P><PRE>    d. In step 4 of the wizard, click Existing Worksheet. Select cell A15
       in the worksheet and click Finish.
</PRE><P>
</OL>The following PivotTable appears in the worksheet:
<P>
<PRE>   Sum of Sales   Quarter
   Widget Type    Q1        Q2        Q3        Q4        Grand Total
   Alpha                1                                           1
   Bravo                5                                           5
   Charlie              3                                           3
   (blank)                       12        15        18            45
   Grand Total          9        12        15        18            54

</PRE></OL>Note that all of the items in the PivotTable are grouped in the "(blank)"
Widget Type except items in rows two, six, and ten in the worksheet.
These items are next to the original data in the merged cells so that they
are aligned with the correct Widget Types.
<P>
The items grouped into the "(blank)" Widget Type are in the same rows as
the blank cells in step 1.
<P>
Correcting the Example:
<P>
To correct the problem in the example, do the following:

<OL><P><LI>In the worksheet, click cell A2. On the Format menu, click Cells.
   Click the Alignment tab. Click to clear the Merge Cells check box, and
   then click OK.

<P><LI>Repeat step 1 for cells A6 and A10.

<P><LI>Select cell A2 and fill the value "Alpha" down column A to cell A5.
   Then, fill the value "Bravo" in cell A6 down column A to cell A9 and
   fill the value "Charlie" in cell A10 down column A to cell A13.

<P><LI>Click any cell in the PivotTable.

<P><LI>On the Data menu, click Refresh Data.
<P>
</OL>The following PivotTable appears on the worksheet:
<P>
<PRE>   Sum of Sales   Quarter
   Widget Type    Q1        Q2        Q3        Q4        Grand Total
   Alpha                1         2         3         4            10
   Bravo                5         6         7         8            26
   Charlie              3         4         5         6            18
   Grand Total          9        12        15        18            54

</PRE></OL>This PivotTable contains the correct information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 pivot table wrong order<BR>
Keywords          : xlformat xlpivot<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
