

<HTML>
<HEAD>
<TITLE>XL5: Crash When Using Replace Command with Long Formulas </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148614">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1996/03/15">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, when you use the Replace command (Edit menu) on a spreadsheet or a cell range that contains long formulas, you may receive one of the following error messages, depending on the version of Microsoft Excel you are usin...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAB9,QDO0,QA9N,QAJ6,QDO9,QBWS,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Crash When Using Replace Command with Long Formulas</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148614</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for the Power Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for NT, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, when you use the Replace command (Edit
menu) on a spreadsheet or a cell range that contains long formulas, you may
receive one of the following error messages, depending on the version of
Microsoft Excel you are using:
<P>
<P><h3>If you are using Microsoft Excel for Windows, version 5.0</h3>
 
<P>
<PRE>   Excel caused a General Protection Fault in module EXCEL.EXE at
   009E:1EB9

</PRE><h3>If you are using Microsoft Excel for Windows, version 5.0c</h3>
 
<P>
<PRE>   Excel caused a General Protection Fault in module EXCEL.EXE at
   00A4:1F4B

</PRE><h3>If you are using Microsoft Excel for NT, version 5.0</h3>
 
<P>
<PRE>   Exception: access violation (0xc0000005), Address: 0x4903050f

   -or-

   Exception: access violation (0xc0000005), Address: 0x00049a5a

</PRE><h3>If you are using Microsoft Excel 5.0 or 5.0a for the Macintosh</h3>
 
<P>
<PRE>   The application "unknown" has unexpectedly quit, because an error of
   type xx occurred.

   NOTE: "xx" can be 1 or 15.

</PRE><h3>If you are using Microsoft Excel 5.0 or 5.0a for the Power Macintosh</h3>
 
<P>
<PRE>   Sorry, a system error occurred. "Microsoft Excel" error type 11

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs because Microsoft Excel may replace a portion of long
formulas that have a length of approximately 500 characters or more.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use any of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Manually edit the long formulas to make the changes.
<P>
<P><h3>Method 2</h3>
 
<P>
Split the long formulas into smaller ones that are less than 500 characters
each.
<P>
<P><h3>Method 3</h3>
 
<P>
To replace text in long formulas without having to redesign or split the
formulas up, you can copy the formulas into a word processor or text editor
(such as Microsoft Word or Write) that has replace capabilities, and
replace the text there. (Note that tabs must be preserved when dealing with
more than 1 column of formulas). Then, copy and paste the replaced formulas
back to the spreadsheet. To do this, use the following steps:

<OL><P><LI>On the Tools menu in Microsoft Excel, click Options.

<P><LI>Click the View tab. Select the Formulas check box, and then click OK.

<P><LI>Select the range of cells that contain the long formulas, and on the
   Edit menu, click Copy.

<P><LI>Switch to a text editor or word processor, and paste the formulas into
   the word processor, and perform a replace operation.

<P><LI>Copy the changed formulas back to the Clipboard.

<P><LI>Switch back to Microsoft Excel, and on the Edit menu, click Paste.

<P><LI>On the Tools menu, click Options.

<P><LI>Click the View tab. Clear the Formulas check box, and then click OK.
<P>
</OL>NOTE: Array formulas that are in the modified range will not be preserved.
You will have to re-enter them as array formulas (CTRL+SHIFT+ENTER for
Windows or COMMAND+RETURN for Macintosh).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the above products. This
problem is corrected in Microsoft Excel for Windows 95, version 7.0,
Microsoft Excel 97, and Microsoft Excel 98 Macintosh Edition.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c gpf fault crash freeze hang<BR>
Keywords          : kberrmsg<BR>
Version           : WINDOWS:5.0,5.0c; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
