

<HTML>
<HEAD>
<TITLE>Finding Subtotals with dBASE, Excel, or Text Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75727 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1991/08/29">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBWS,QAG2,QBXS,QA2Q,QBRZ,QBJZ,QDI1,QAY2,QAPF,QA3P,QAUD,QAYY,QA50,QBM2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Finding Subtotals with dBASE, Excel, or Text Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75727 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



Summary:
<P>
The dBASEFile, TextFile, and ExcelFile drivers for Q+E for Microsoft
Excel do not support the COMPUTE BY or GROUP BY clauses required to
find subtotals in a SQL query.
<P>
The information below describes a workaround using the Data Table
command in Microsoft Excel.
<P>
More Information:
<P>
This example uses EMP.DBF, one of the sample files found in the QE
subdirectory in your EXCEL directory. The goal of this example is to
find the total salary of employees in each department.

<OL><P><LI>Import EMP.DBF into Excel.
<P>
   a. Start Excel.
<P>
   b. From the File menu, choose Open, select the QE subdirectory, and
<P><PRE>      select EMP.DBF.
</PRE>
<P><LI>Extract the list of departments.
<P>
   a. Enter "DEPT" (without the quotation marks) in cell J1.
<P>
   b. Select J1:J2.
<P>
   c. From the Data menu, choose Set Criteria.
<P>
   d. Enter "DEPT" (without the quotation marks) in cell K1.
<P>
   e. Select K1.
<P>
   f. From the Data menu, choose Extract.
<P>
   g. When you get the Paste dialog box, select the Unique Records Only
<P><PRE>      check box.
</PRE>
<P><LI>Set up the data table.
<P>
   a. Select cell K1.
<P>
   b. From the Edit menu, choose Clear, select All, and then choose
<P><PRE>      OK.
</PRE><P>
   c. Select cell L1.
<P>
   d. Enter the following:
<P>
<PRE>         =DSUM(Database,"SALARY",Criteria)

   e. Select K1:L5.

   f. From the Data menu, choose Table.

   g. Enter J2 for the Column Input cell and choose OK.

   h. The following is the result:

                  K        L
         1               412450
         2       D101    169900
         3       D050     68900
         4       D202     86750
         5       D190     86900

</PRE></OL>Reference(s):
<P>
"Microsoft Excel User's Guide," version 3.0, pages 265-268
<P>
"Microsoft Excel Reference Guide," version 2.1, pages 153-155
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 2.5 2.50 3.0 3.00 sub totals SQL qpluse<BR>
datatable compute<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
