

<HTML>
<HEAD>
<TITLE>XL: GP Fault Using LINE.PRINT with RightMarg Greater than 256 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122333">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1994/11/02">
<META NAME="Keywords" CONTENT="kbprg kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you run a version 4.0 macro that contains the LINE.PRINT function, you may receive a general protection (GP) fault in module EXCEL.EXE.  CAUSE =====  The LINE.PRINT function is used in the Microsoft Excel version 4.0 Macro ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QANY,QBKN,QBXT,QA5V,QAPN,QAIB,QAY5,QBV8,QAB9,QAHE,QAH4,QBVH,QBJZ,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: GP Fault Using LINE.PRINT with RightMarg Greater than 256</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122333</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you run a version 4.0 macro that contains the
LINE.PRINT function, you may receive a general protection (GP) fault in
module EXCEL.EXE.
<P>
<P><h2>CAUSE</h2>
 
<P>
The LINE.PRINT function is used in the Microsoft Excel version 4.0 Macro
Language to print the active worksheet using methods that are compatible
with those found in Lotus 1-2-3. The following is one syntax of the
LINE.PRINT function:
<P>
<PRE>   LINE.PRINT(command,setup_text,leftmarg,rightmarg,topmarg,botmarg,pglen
   formatted)

</PRE>The rightmarg argument above is the argument that specifies the size of the
right margin measured in characters from the left side of the page. Anytime
you use the LINE.PRINT function with the rightmarg argument set to a value
greater than 256, you may receive a general protection (GP) fault when you
issue the LINE.PRINT function with the command argument set to 1 (Syntax
1).
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid this problem when you use the LINE.PRINT function in a macro, use
any of the following methods.
<P>
Method 1: Use a rightmarg argument value of less than or equal to 256.
<P>
Method 2: In Microsoft Excel version 5.0 and later, define the print area
<PRE>          on the worksheet using the Page Setup command on the File menu,
          instead of using the Define Name dialog box. This problem only
          occurs when you define the name "Print_Area" on your worksheet
          without using the sheet name, such as "$A$1:$Z$1."

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference ," version 4.0 pages 253-254
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbmacro<BR>
KBSubcategory: xlwin
<P>

Additional reference words: 7.00 4.00 5.00 5.00c line print gpf 0002:02DE<BR>
ms<BR>
excel 4.0 macro
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
