

<HTML>
<HEAD>
<TITLE>XL: Order of Precedence Causes Unexpected Positive Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132686">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/07/17">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use a minus sign (-) as a negation operator (for example -1) in a formula, the negation operator has higher precedence than a binary operator; this order of precedence may mean that a formula returns a positive value wh...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKM,QANY,QAKD,QBJF,QAUD,QAOE,QAB9,QAY5 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Order of Precedence Causes Unexpected Positive Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132686</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.x, 4.x, 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use a minus sign (-) as a negation operator
(for example -1) in a formula, the negation operator has higher precedence
than a binary operator; this order of precedence may mean that a formula
returns a positive value when you expect it to return a negative value. For
example, the following formula
<P>
<PRE>   =-2^2

</PRE>is evaluated as
<P>
<PRE>   (-2)^2

</PRE>(that is, with the minus sign evaluated as a negation operator) and returns
a positive value, 4.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs by design of Microsoft Excel. Microsoft Excel uses an
order of calculation to evaluate operators in formulas. The order of
evaluation of operators dictates that a minus sign (-) used as a negation
operator (such as -1) is evaluated before all other operators. Because of
this order, the formula =-1^2 represents the value -1 squared, and returns
the value 1, a positive value.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To preserve the order of operations in a formula, you can specify that the
negative symbol in a formula (such as =-1^2) applies to the entire formula
by inserting parenthesis around the numbers you want to be evaluated first;
as in the following example:
<P>
<PRE>   -(2^2)

</PRE>This formula returns a negative value, -4.
<P>
Note that this has been the standard method for evaluating formulas since
the first version of Microsoft Excel.
<P>
NOTE: This order of operation is different from the order of operation in
Lotus 1-2-3.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information about the order of evaluation of operators,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q25189.htm">Q25189</A></B>
   TITLE     : Excel: Order of Operations in Formulas

</PRE>The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>
<P><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Excel 98 Macintosh Edition</h3>
 
<P>
For more information about operator precedence in Microsoft Excel, click
the Index button in MS Excel Help, type the following text
<P>
<PRE>   operators, order of precedence formulas

</PRE>and then double-click the selected text to go to the "The order in which
Microsoft Excel performs operations in formulas" help topic.
<P>
<P><h3>Microsoft Excel 97</h3>
 
<P>
For more information about operator precedence in Microsoft Excel, click
the Index tab in Microsoft Excel 97 Help, type the following text
<P>
<PRE>   operators, evaluation order in formulas

</PRE>and then double-click the selected text to go to the "The order in which
Microsoft Excel performs operations in formulas" topic.
<P>
<P><h3>Microsoft Excel 7.0</h3>
 
<P>
In Microsoft Excel Help, type the following text
<P>
<PRE>   operators, precedence

</PRE>and then double-click the selected text to go to the "Operator Precedence"
topic.
<P>
<P><h3>Microsoft Excel 5.0</h3>
 
<P>
For more information about "Mathematical Operator Evaluation in Lotus 1.2.3
and Microsoft Excel," click the Search button in Microsoft Excel Help, type
the following, and then click Display:
<P>
<PRE>   operator
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: unary minus XL98 XL97 XL7 XL5 XL4 XL3<BR>
Keywords          : xlformula<BR>
Version           : WINDOS:2.0,3.0,4.0,5.0,5.0c,7.0,97; MACINTOSH:2.0,3.0,4.0,5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
