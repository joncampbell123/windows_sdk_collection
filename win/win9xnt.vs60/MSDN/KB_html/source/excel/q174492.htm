

<HTML>
<HEAD>
<TITLE>XL97: "Method 'Delete' of object..." Running Sample Code in Help </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174492">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/09/30">
<META NAME="Keywords" CONTENT="xltoolbar xlui xlwiz kbcode kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  After you use sample code from the Visual Basic for Applications Help file, you may receive the following error message:     Run time error '-2147467259(80004005)':    Method 'Delete' of object 'CommandBar' failed.  CAUSE =====  This error may occu...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAIK,QBS0,QBJZ,QBWS,QAPN,QAB9,QABI,QBVP,QAVZ,QAH4,QABH,QBV8,QAA1,QBVV P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: "Method 'Delete' of object..." Running Sample Code in Help</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174492</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you use sample code from the Visual Basic for Applications Help file,
you may receive the following error message:
<P>
<PRE>   Run time error '-2147467259(80004005)':
   Method 'Delete' of object 'CommandBar' failed.

</PRE><h2>CAUSE</h2>
 
<P>
This error may occur when the follow conditions are true:

<UL><LI>You run the following sample code from the CommandBars Property Example
   window in the Visual Basic for Applications Help file:
<P>
<P><PRE>      For Each bar In Application.CommandBars
</PRE>   
<PRE>          If Not bar.BuiltIn And Not bar.Visible Then bar.Delete
   
      Next

   This sample code deletes all custom command bars that aren't visible.

    -and-

</PRE><LI>The Wizard shortcut command bar has not been deleted.
<P>
<P><PRE>    -or-
</PRE>
<LI>The Small Business Financial Manager add-in is installed.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/default.asp">http://www.microsoft.com/supportnet/refguide/default.asp</A></B>

</PRE>To workaround this problem, use one of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Delete the Wizard command bar by running a procedure, and then use the code
from the Help file. To remove the command bar, use the following code:
<P>
<PRE>   Sub Remove_Wizard()
   
      Set oToolMenu = CommandBars("Worksheet Menu Bar").Controls("Tools")
      oToolMenu.Controls("Wizard").Delete
   
   End Sub

</PRE><h3>Method 2</h3>
 
<P>
Remove the Wizard command bar by using the Add-Ins dialog box. To do this,
follow these steps:

<OL><P><LI>On the Tools menu, click Add-Ins.

<P><LI>Click to clear the Conditional Sum Wizard, File Conversion Wizard,
   Lookup Wizard, and Web Form Wizard check boxes.
<P>
   NOTE: It's possible that not all of these add-ins are selected. These
   four add-ins are included with Excel. If you installed a new add-in that
   appears on the Wizard command bar, it may be necessary to remove it.

<P><LI>Click OK.
<P>
</OL><h3>Method 3</h3>
 
<P>
Remove the Small Business Financial Manager add-in. To do this, follow
these steps:

<OL><P><LI>On the Tools menu, click Add-Ins.

<P><LI>Click to clear the Small Business Financial Manager check box.

<P><LI>Click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The procedure in the Help file does not work in Excel because the Wizard
shortcut command bar cannot be deleted by using this method.
<P>
<P><h3>Restoring the Wizard Command Bar</h3>
 
<P>
To restore the Wizard command bar, follow these steps. If you removed the
Wizard command bar through the Add-Ins dialog box, skip steps 1 through 3.

<OL><P><LI>On the Tools menu, click Add-Ins.

<P><LI>Click to clear the Conditional Sum Wizard, File Conversion Wizard,
   Lookup Wizard, and Web Form Wizard check boxes.

<P><LI>Click OK.

<P><LI>On the Tools menu, click Add-Ins.

<P><LI>Click the Conditional Sum Wizard, File Conversion Wizard, Lookup Wizard,
   and Web Form Wizard check boxes.

<P><LI>Click OK.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
<P>
For more information about command bars, click the Office Assistant in the
Visual Basic Editor, type "commandbars," click Search, and then click to
view "Using command bars."
<P>
NOTE: If the Assistant is hidden, click the Office Assistant button on the
Standard toolbar. If Visual Basic for Applications Help is not installed on
your computer, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q120802.htm">Q120802</A></B>
   TITLE     : Office: How to Add/Remove a Single Office
               Program or Component
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 addins<BR>
Keywords          : xltoolbar xlui xlwiz kbcode kberrmsg kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug kbdocerr<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
