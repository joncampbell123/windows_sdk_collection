

<HTML>
<HEAD>
<TITLE>Excel: Custom Commands Under Window Menu Change Position </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q57389 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/12/29">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QBV8,QAVI,QBJZ,QBI2,QACI,QBXT,QA5V,QAY5,QAIB,QAJP,QAUD,QAH4,QAF0,QAGB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Custom Commands Under Window Menu Change Position</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q57389 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The ADD.COMMAND function returns the line of the menu on which the
first custom command is placed. When adding commands to the built-in
Window menu, ADD.COMMAND will add the item to the bottom of the menu
(as on other menus). However, if another document is opened or if an
existing document is closed or hidden, the list of opened documents
will move to the bottom of the menu, moving the custom command up.
<P>
This in itself causes no problems in the execution or use of the
command. If, however, the CHECK.COMMAND, ENABLE.COMMAND, or
DELETE.COMMAND function is used in the macro and the function uses the
command position (the position the command occupies on the menu),
either a macro error will occur or the function will be ignored. The
above functions behave normally if the command name is used rather
than its position.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For example, if the Window menu appears as follows
<P>
<PRE>    WINDOW
    Help...
   --------------------
    New Window
    Show Clipboard
    Show Info
    Arrange All
   --------------------
    Hide
    Unhide
   --------------------
   *Macro1
    Worksheet1

</PRE>and after running the following command in cell B1
<P>
<PRE>   =ADD.COMMAND(1,"Window",D1:E1)

</PRE>cells D1:E1 contain the following
<P>
<PRE>   | My Command     |  My_Macro   |

</PRE>cell B1 (which contains the formula) returns a 13, indicating that the
command was added to line 13 of the menu. This is true immediately
after the function is first executed (as shown below):
<P>
<PRE>    WINDOW
    Help...
   --------------------
    New Window
    Show Clipboard
    Show Info
    Arrange All
   --------------------
    Hide
    Unhide
   --------------------
   *Macro1
    Worksheet1
    My Command              &lt;--the custom menu item, line 13

</PRE>However, if another document (worksheet, macro, or chart) is opened,
or an existing one is closed, the list of documents is moved to the
bottom of the menu, as shown below:
<P>
<PRE>    WINDOW
    Help...
   --------------------
    New Window
    Show Clipboard
    Show Info
    Arrange All
   --------------------
    Hide
    Unhide
   --------------------
    My Command              &lt;--the custom menu item, line 11
    Macro1
    Worksheet1
   *Worksheet2

</PRE>The custom command is now on line 11, while the formula in cell B1 of
the macro continues to return the value of the original position of
the command. If either of the following lines are used in the macro, a
macro error occurs:
<P>
<PRE>   =DELETE.COMMAND(1,"Window",B1)

   -or-

   =ENABLE.COMMAND(1,"Window",B1,FALSE)

</PRE>If the following line is used
<P>
<PRE>   =CHECK.COMMAND(1,"Window",B1,TRUE)

</PRE>it will be ignored because, according to the above formulas, the 13th
command (the value contained in B1) in the menu "Window" is to be
altered; however, the 13th command is now a document name, rather than
the custom menu item.
<P>
If the formula uses the command name, rather than its position, the
function will execute without error, as in the following:
<P>
<PRE>   =DELETE.COMMAND(1,"Window","My Command")
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 2.20 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
