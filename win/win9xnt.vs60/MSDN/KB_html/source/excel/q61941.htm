

<HTML>
<HEAD>
<TITLE>XL: Tips for Importing Lotus 1-2-3 Files to Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q61941 ">
<META NAME="KBModify" CONTENT="1998/02/18">
<META NAME="KBCreate" CONTENT="1990/05/16">
<META NAME="Keywords" CONTENT="xl123quattro kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article contains information about potential issues you may encounter when you import Lotus 1-2-3 files into Microsoft Excel.  Opening WK4 Files  To open Lotus 1-2-3 WK4 files in Microsoft Excel version 5.0, you must obtain the Lotus 1-2-3 WK4...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QABM,QAJC,QAH4,QBWS,QAKD P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Tips for Importing Lotus 1-2-3 Files to Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q61941 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains information about potential issues you may encounter
when you import Lotus 1-2-3 files into Microsoft Excel.
<P>
<P><h3>Opening WK4 Files</h3>
 
<P>
To open Lotus 1-2-3 WK4 files in Microsoft Excel version 5.0, you must
obtain the Lotus 1-2-3 WK4 file converter. The Lotus 1-2-3 WK4 file
converter is available in the "Lotus 1-2-3 WK4 File Converter" (WE1130)
Application Note.
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft Technical Support
<LI>Microsoft FastTips Technical Support Library
<P>
</UL>For more information about obtaining the Lotus 1-2-3 WK4 file converter,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q122583.htm">Q122583</A></B>
   TITLE     : WE1130: Lotus 1-2-3 WK4 File Converter

</PRE>For information about using this add-in with Microsoft Excel for Windows
NT, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q148140.htm">Q148140</A></B>
   TITLE     : File Conversion Wizard Does Not Run Under MS Excel for NT

</PRE>NOTE: Microsoft Excel 7.0 and Microsoft Excel 97 include a Wk4 file
converter. The converter included with Microsoft Excel 7.0 allows you to
read the Lotus 1-2-3 Wk4 file format. The converter in Microsoft Excel 97
allows you to read and write the Wk4 format.
<P>
<P><h3>Formatting</h3>
 
<P>
When you open a Lotus 1-2-3 worksheet or workbook, Microsoft Excel applies
the formatting stored in the associated .fmt, .fm3, or .all formatting
file. Be sure that the associated formatting file is stored in the same
folder as the .wk? file. If you resave a Lotus 1-2-3 file in the Microsoft
Excel (.xls) format, Microsoft Excel saves the spreadsheet data and
formatting in a single workbook file.
<P>
<P><h3>Objects</h3>
 
<P>
In Microsoft Excel 5.0, when you open a Lotus 1-2-3 WK4 file, any drawing
objects, such as macro buttons, text boxes, and lines, are not converted.
Additionally, worksheet names are displayed as the Lotus 1-2-3 default: A,
B, C, and so on. The Lotus 1-2-3 WK4 file converter does not convert
drawing objects on a worksheet. This includes any of the following items:
<P>
<PRE>   arc
   arrow
   button
   ellipse
   embedded object
   freehand
   line
   polygon
   polyline
   rectangle
   rounded rectangle
   text

</PRE>NOTE: This problem does not occur in later versions. All objects are
converted when you open them in Microsoft Excel 7.0 and later.
<P>
<P><h3>Charts</h3>
 
<P>
Microsoft Excel 4.0 and Later:
<P>
In Lotus 1-2-3, versions 3.x and later, you can create a graph on a chart
sheet or create the chart as an object on the worksheet. In Lotus 1-2-3,
version 2.x, if you use the WYSIWYG add-in, you can place a graph on a
worksheet.
<P>
By default, Microsoft Excel automatically converts any charts associated
with a Lotus 1-2-3 worksheet. You can use the following setting in the
Excel4.ini and Excel5.ini files to suppress the creation of chart sheets
when you open a Lotus 1-2-3 file:
<P>
<PRE>   Load_Chart_Wnd=0

</PRE>Because Microsoft Excel is able to read Impress (.fm3) files and Allways
(.all) formatting files, you can import a Lotus 1-2-3 worksheet that
contains a chart on the worksheet. The chart appears on the worksheet as it
does in Lotus 1-2-3.
<P>
Microsoft Excel 2.x and 3.x:
<P>
When you import a file that contains a graph, Microsoft Excel 2.x and 3.x
display a prompt for each graph that is stored with the worksheet or
is located on the worksheet. You are prompted whether to convert the file
to a Microsoft Excel chart. If you click Yes, Microsoft Excel creates a new
chart window. In Microsoft Excel 3.x, you can then copy the chart to the
worksheet.
<P>
<P><h3>Databases</h3>
 
<P>
The Database, Criteria, and Extract defined ranges are successfully
imported and function properly. However, database criteria ranges are
evaluated differently when you extract data, find data, and use database
functions. For example, the "John" criteria finds only rows with cells that
contain "John." If you clear the Transition Formula Evaluation check box,
the "John" criteria finds any rows that contain cells with values beginning
with "John"; for example, cells that contain "John," "Johnson," and
"Johnsen" are found.
<P>
<P><h3>Calculations</h3>
 
<P>
Whenever you open a Lotus 1-2-3 file, the Transition Formula Entry check
box is selected. When this feature is selected, Microsoft Excel converts
formulas that are entered with Lotus 1-2-3 syntax to Microsoft Excel syntax
and makes names defined in Microsoft Excel behave as defined names do in
Lotus 1-2-3.
<P>
Microsoft Excel calculates formulas differently from Lotus 1-2-3. When a
cell that contains text is used in a formula, Lotus 1-2-3 assigns a value
of 0 (zero) to the cell. In Microsoft Excel, you cannot combine text and
numeric entries in the same formula. However, when you use a worksheet
function in Microsoft Excel, a value of 0 is assigned to cells that contain
text. For example, if you clear the Transition Formula Evaluation check
box, and you type text in cell A1 and the value 100 in cell B1; the formula
=A1+B1 returns the #VALUE! error value. However, the worksheet formula
=SUM(A1,B1) returns the value 100.
<P>
Lotus 1-2-3 evaluates Boolean expressions to 0 or 1 and displays 0 or 1 in
the cell. For example, in Lotus 1-2-3, the expression 2&lt;3 displays 1 in the
cell to represent True; Microsoft Excel displays True or False in the cell.
If you select the Transition Formula Evaluation check box, Microsoft Excel
displays 0 for False and 1 for True.
<P>
Some functions, including @MOD, @VLOOKUP, and @HLOOKUP, are evaluated
differently. For example, the @VLOOKUP function in Lotus 1-2-3 searches for
an exact match in the first column; the VLOOKUP worksheet function in
Microsoft Excel assumes the first column is sorted and finds the closest
value in the first column that does not exceed the lookup value. The
VLOOKUP and HLOOKUP worksheet functions in Microsoft Excel include a fourth
argument, range_lookup. If you set this argument to False, Microsoft Excel
searches for an exact match.
<P>
To force Microsoft Excel to calculate formulas as Lotus 1-2-3 does, use the
following steps:

<OL><P><LI>On the Tools menu, click Options. Click the Transition tab.

<P><LI>Click Transition Formula Evaluation, and click OK.
<P>
</OL><h3>Calculation Order</h3>
 
<P>
Mathematical Order of Precedence Differences
<P>
This table compares the mathematical operators used by Microsoft Excel
and Lotus 1-2-3.
<P>
<PRE>                     Lotus                 Microsoft
   Operator          1-2-3      Precedence   Excel      Precedence
   ---------------------------------------------------------------
   Exponentiation    ^             1st        ^            2nd
   Positive and      + and -       2nd        + and -      1st
     negative
   Multiplication    * and /       3rd        * and /      3rd
     and division
   Addition and      + and -       4th        + and -      4th
     Subtraction
   Comparison        = &lt; &gt;         5th        = &lt; &gt;        5th
                     &lt;= &gt;=                    &lt;= &gt;=
   Logical NOT       #not#         6th        NOT()        6th
   Logical AND       #and# and     7th        AND() and    7th
     and OR          #or#                     OR()
   String            &amp;             7th        &amp;            7th
     concatenation

</PRE></OL>NOTE: Lotus 1-2-3 evaluates the exponentiation operator (^) before the
negation operator (-). Microsoft Excel evaluates the negation operator
first. For example, in Lotus 1-2-3, the formula =-2^4 returns the value
-16, but returns 16 in Microsoft Excel. To correct this difference, use
parentheses to change the order of evaluation; for example, =-(2^4)
produces -16.
<P>
<P><h3>Links</h3>
 
<P>
In Microsoft Excel, when you open a Lotus 1-2-3 .wk4 file that contains a
link to another file, the cells may be updated with a #REF! error value. To
update an external link in a Lotus 1-2-3 .wk4 file, do the following:

<OL><P><LI>In Microsoft Excel, click Links on the Edit menu.

<P><LI>In the Links dialog box, select the link that you want to update.
   Click Update Now.
<P>
   NOTE: If you want to open the source document, click Open. This
   also updates the external link.
<P>
</OL>To avoid this behavior, save the file in the Microsoft Excel workbook
format.
<P>
<P><h3>Converting Dates</h3>
 
<P>
Microsoft Excel and Lotus 1-2-3 use the same serial date systems. The
serial values in Microsoft Excel 7.0 and earlier range from 0 (1/1/1900) to
65380 (12/31/2078). Serial date values in Lotus 1-2-3 range from 0 to 73050
(12/31/2099). If you import a date from Lotus 1-2-3 that contains a date
function with a year later then 2078, the function returns a #NUM! error
value. If you import a worksheet that contains a formatted date with a year
later than 2078, Microsoft Excel fills the cell with 255 number signs (#).
<P>
NOTE: This problem does not exist in Microsoft Excel 97 because it allows
dates up to the year 9999.
<P>
<P><h3>Macros</h3>
 
<P>
Macros in Lotus 1-2-3 are stored directly on the worksheet. This is
different from how Microsoft Excel stores macros. Microsoft Excel stores
macros on a macro sheet (in Microsoft Excel 4.0) or in a module sheet for
macros written in Visual Basic for Applications for Microsoft Excel 5.0 and
later.
<P>
Microsoft Excel 4.0a and Later:
<P>
Microsoft Excel can run Lotus 1-2-3 macros directly. You do not have to
translate (rewrite) the macro. When you open a Lotus 1-2-3 file that
contains macros, you can see a list of all the available 1-2-3 macros by
looking at the list of defined names for that workbook. To run the
Lotus 1-2-3 macro, press CTRL and the associated letter for the macro. For
example, press CTRL+P.
<P>
Microsoft Excel 4.0 and Ealier:
<P>
To convert (rewrite) Lotus 1-2-3 macros to Microsoft Excel macros, do the
following:

<OL><P><LI>In Microsoft Excel, open the Lotus 1-2-3 worksheet that contains
   the macro.

<P><LI>On the Control menu, click Run. To open the Control menu, press
   ALT+SPACEBAR.

<P><LI>Click Macro Translator, and then click OK.

<P><LI>On the Translate menu, click Lotus 1-2-3. Select the name of the
   worksheet you want to convert.

<P><LI>Select the name of the macro that you want to convert. If you want
   the translator to list the 1-2-3 macro beside the converted Microsoft
   Excel macro, click the Verbose option.
<P>
</OL>Microsoft Excel places the converted macro on a new macro sheet.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about converting Lotus 1-2-3 files, click the Index
tab in Microsoft Excel 97 Help, type the following text
<P>
<PRE>   Lotus 1-2-3, converting files

</PRE></OL>and then double-click the selected text to go to the "Key information for
upgraders and new users" topic.
<P>
For more information about importing worksheets, formulas, references,
and formats from specific versions of Lotus 1-2-3 see "Switching to
Microsoft Excel from Lotus 1-2-3," version 4.0, pages 24-31, 38, or the
"User's Guide," version 3.0, pages 41-64.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: noupd<BR>
Keywords          : xl123quattro kbfasttip<BR>
Version           : WINDOWS:2.0,3.0,4.0,5.0,7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
