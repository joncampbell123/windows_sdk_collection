

<HTML>
<HEAD>
<TITLE>MXL5: Range Method May Fail When Used in Auto_Open Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126045">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/02/13">
<META NAME="Keywords" CONTENT="xlmac kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you open a Microsoft Excel workbook by double-clicking the workbook icon or alias in the Finder, you may receive the following error message:     Run-time error '1004':     Range Method of          Class Failed  CAUSE =====  This error message...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAH4,QDMR,QDNZ,QAB4,QBVP,QAFF,QBWS,QBS0,QAPF,QAJB,QAAP,QA2Q,QAKP,QAVZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MXL5: Range Method May Fail When Used in Auto_Open Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126045</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Excel for the Macintosh, versions 5.0, 5.0a
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a Microsoft Excel workbook by double-clicking the workbook
icon or alias in the Finder, you may receive the following error message:
<P>
<PRE>   Run-time error '1004':

   Range Method of &lt;object&gt; Class Failed

</PRE><h2>CAUSE</h2>
 
<P>
This error message occurs when you open a workbook by double-clicking the
file if the file contains an Auto_Open macro that uses the Range method to
select a specific cell or range of cells. For example, this error message
appears when you open a workbook (by double-clicking the workbook icon in
the Finder) that contains the following Visual Basic macro:
<P>
<PRE>   Sub Auto_Open
      Sheets("Sheet2").Select
      Range("A1").Select
   End Sub

</PRE>The Range method fails when it is used with the Select method in any of the
following situations:

<UL><LI>An Auto_Open macro

<LI>A macro that is called by an Auto_Open macro

<LI>Any macro assigned to a dialog control whose dialog box is displayed by
   an Auto_Open macro
<P>
</UL>Note that the Range method does not fail in these situations if the
workbook is opened from within Microsoft Excel.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>To avoid receiving this error message when you use the Range method in a
Visual Basic macro, use any of the following methods:
<P>
<P><h3>Method 1</h3>
 
<P>
Open the workbook that contains the Auto_Open macro within Microsoft Excel
by clicking Open on the File menu instead of opening the file in the
Finder.
<P>
<P><h3>Method 2</h3>
 
<P>
Use the Cells method instead of the Range method in the situations
described above. For example, the following statement in a Visual Basic
macro
<P>
<PRE>   Range("A1").Select

</PRE>could be changed to the following:
<P>
<PRE>   Cells(1,1).Select

</PRE><h3>Method 3</h3>
 
<P>
Use the Offset method to refer to the cell in terms of its relationship to
the active cell instead of using the Range method.
<P>
For example, to select cell A1 using the Offset method, you can use the
following statement:
<P>
<PRE>   ActiveCell.Offset(-1*Activecell.Row+1, _
      -1*Activecell.Column+1).Select

</PRE>To select cell B5, you can use the following statement:
<P>
<PRE>   ActiveCell.Offset(-1*Activecell.Row+5, _
      -1*Activecell.Column+5).Select

</PRE>Note that you must also use the Cells method or the Offset method instead
of the Range method in all subsequent lines in the Auto_Open macro, or in
any macro called by the Auto_Open macro.
<P>
<P><h3>Method 4</h3>
 
<P>
Use the Resize method to refer to a contiguous range of cells.
<P>
For example, to select cells A1 through C5, you can use the following
statement:
<P>
<PRE>   Cells(1,1).Resize(5,3).Select

</PRE><h3>Method 5</h3>
 
<P>
Use the Union and Cells methods to refer to discontiguous ranges of cells.
<P>
For example, to select cells A1 through C5 and cells E11 through F15, use
the following statement:
<P>
<PRE>   Union(Cells(1,1).Resize(5,3), _
      Cells(11,5).Resize(5,3)).Select

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following are different scenarios in which the Range method returns the
run-time error described above.
<P>
<P><h3>Scenario 1</h3>
 
<P>
If you use the Range method in an Auto_Open macro for a workbook, you may
receive this error. For example, you receive the run-time error when you
double-click a workbook in the Finder that contains the following macro:
<P>
<PRE>   Sub Auto_Open()
      Worksheets(1).Select
      Range("A1").Select
   End Sub

</PRE><h3>Scenario 2</h3>
 
<P>
If you use the Range method in a macro that is called from an Auto_Open
macro in a workbook, you may receive this error. For example, you receive
the run-time error when you double-click a workbook in the Finder that
contains the following macros:
<P>
<PRE>   Sub Auto_Open()
      Macro1
   End Sub

   Sub Macro1()
      Worksheets(1).Select
      Range("A1").Select
   End Sub

</PRE><h3>Scenario 3</h3>
 
<P>
If the Range method is used in any macro that is assigned to a dialog box
control and the dialog box is displayed in an Auto_Open macro, this error
may also occur. For example, if BOOK1 contains a dialog sheet "Dialog1"
that contains a button "Button 1," and "Button 1" is assigned to the macro
"Button1_Click," you receive the run-time error when you double-click BOOK1
in the Finder, and then click "Button 1":
<P>
<PRE>   Sub Auto_Open()
      Dialogsheets("Dialog1").Show
   End Sub

   Sub Button1_Click()
      Worksheets(1).Select
      Range("A1").Select
   End Sub
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a<BR>
Keywords          : xlmac kbcode kbprg<BR>
Version           : MACINTOSH: 5.0,5.0a<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
