

<HTML>
<HEAD>
<TITLE>XL5: Custom Macro Command Duplicated on Tools Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124005">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1994/12/14">
<META NAME="Keywords" CONTENT="kbcode kbmacro kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 5.0, when you write or record a macro, you have the option to run it from a command on the Tools menu. If you move or copy the macro, the command may appear more than once on the Tools menu. Note also that if you delete the macro...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QBVP,QAH4,QAEF,QBV8,QAB9,QA9N,QAB4,QAVI,QANJ,QBWS,QACI,QAY2,QBS0,QDKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Custom Macro Command Duplicated on Tools Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 5.0, when you write or record a macro, you have the
option to run it from a command on the Tools menu. If you move or copy the
macro, the command may appear more than once on the Tools menu. Note also
that if you delete the macro, the command may remain on the Tools menu,
and you will be unable to delete it.
<P>
<P><h2>CAUSES</h2>
 
<P>
You may have duplicate commands on the Tools menu when you do either of the
following:

<UL><LI>You copy the macro to another location in the workbook. When you do
   this, the first command will run the macro from the original location,
   and the second command will run the macro in the new location.
<P>
<P><PRE>    -or-
</PRE>
<LI>You move the macro to a different location in the workbook. When you do
   this, there will be two commands on the Tools menu to run the same
   macro. The first command attempts to run the macro from its original
   location. Choosing this command will result in an error message, because
   Microsoft Excel will be unable to find the macro. The second command
   runs macro from its new location.
<P>
</UL>If you delete the macro and then choose the command, you will receive an
error message. You receive an error message because Microsoft Excel is
unable to find the macro.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid the above problems, use the following guidelines when you assign
macros to commands on the Tools menu:

<UL><LI>Before you add a command to the Tools menu, verify that it is in a
   sensible location (so you won't need to move it later on).
<P>
<P><PRE>    -and-
</PRE>
<LI>BEFORE you move, copy, or delete a macro, follow the procedure below to
   remove its custom command from the tools menu.
<P>
</UL><h3>To remove a macro command from the Tools menu</h3>
 

<OL><P><LI>Verify that the macro is in the workbook where the information has been
   saved. (If the macro has been moved to a different workbook, copy it
   back to the original workbook.)

<P><LI>On the Tools menu, click Macro.

<P><LI>Select the name of the macro that you want to change the options for,
   and click Options.

<P><LI>Clear the Menu Item On Tools Menu check box.
<P>
</OL>NOTE: If you delete the macro before you remove the command from the Tools
menu, the only way to remove the command is to re-create the workbook.
<P>
<P><h2>STATUS</h2>
 
<P>
This is a known problem in the versions of Microsoft Excel listed at the 
beginning of this article. The problem was corrected in Microsoft Excel for 
Windows 95, version 7.0, Microsoft Excel 97, and Microsoft Excel 98 
Macintosh Edition.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Visual Basic User's Guide," version 5.0, Chapter 1, "Setting and
Changing Macro Options"
<P>
"Visual Basic User's Guide," version 5.0, Chapter 12, "Menus and Toolbars"
<P>
For more information about Adding a macro to the Tools
menu, choose the Search button in Help and type:
<P>
<PRE>   commands, adding macros as
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c XL5<BR>
Keywords          : kbcode kbmacro kbprg<BR>
Version           : WINDOWS:5.0,5.0c; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
