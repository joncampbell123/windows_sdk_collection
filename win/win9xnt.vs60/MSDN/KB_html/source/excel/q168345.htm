

<HTML>
<HEAD>
<TITLE>XL97: Contents of Readme.txt for the Updated Html.xla Add-in </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168345">
<META NAME="KBModify" CONTENT="1997/08/12">
<META NAME="KBCreate" CONTENT="1997/05/09">
<META NAME="Keywords" CONTENT="xladdins xlwiz kbappnote kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article contains the contents of the Readme.txt file that contained in the self-extracting file for the updated Internet Assistant Wizard for Microsoft Excel.  To obtain the updated Internet Assistant Wizard for Microsoft Excel, use your Web b...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBUL,QBWA,QBVP,QBBI,QAWP,QAH0,QAIK,QAVZ,QBJZ,QBVV,QAPN,QAH4,QAHT,QAY5,QAYY P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Contents of Readme.txt for the Updated Html.xla Add-in</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168345</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains the contents of the Readme.txt file that contained in
the self-extracting file for the updated Internet Assistant Wizard for
Microsoft Excel.
<P>
To obtain the updated Internet Assistant Wizard for Microsoft Excel, use
your Web browser to go to the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/officefreestuff/download/html.exe">http://www.microsoft.com/OfficeFreeStuff/download/Html.exe</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<PRE> ------------------------------------------------------------------------
   MICROSOFT INTERNET ASSISTANT WIZARD ADD-IN FOR MICROSOFT
                           EXCEL 97
                          March 1997
 ------------------------------------------------------------------------

     (c) 1997 Microsoft Corporation. All rights reserved.

 [To view this readme most effectively in Notepad,
 turn on Word Wrap (Edit menu).]

</PRE>MICROSOFT EXPRESSLY DISCLAIMS ANY WARRANTY FOR THE
INFORMATION IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY
ACCOMPANY THIS DOCUMENT (collectively referred to as an
Application Note). THE APPLICATION NOTE IS PROVIDED "AS IS"
WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED,
INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE. The
entire risk arising out of use or performance of the
APPLICATION NOTE remains with you. This Application Note may
be copied and distributed subject to the following
conditions: 1) All text must be copied without modification
and all pages must be included; 2) If software is included,
all files on the disk(s) must be copied without
modification; 3) All components of this Application Note
must be distributed together; and 4) This Application Note
may not be distributed for profit.
<P>
NO LIABILITY FOR DAMAGES. In no event shall Microsoft or its
suppliers be liable for any damages whatsoever (including,
without limitation, damages for loss of business profits,
business interruption, loss of business information, or any
other pecuniary loss) arising out of the use of or inability
to use the Application Notes, even if Microsoft has been
advised of the possibility of such damages.
<P>
The information contained in this document represents the
current view of Microsoft Corporation on the issues
discussed as of the date of publication. Because Microsoft
must respond to changing marketing conditions, it should not
be interpreted to be a commitment on the part of Microsoft,
and Microsoft cannot guarantee the accuracy of any
information presented after the date of publication.
<P>
<PRE> _______________________________________________
 CONTENTS

 Introduction
 Requirements
 Installing the Internet Assistant Wizard Add-In
 Using the Internet Assistant Wizard Add-In
 HTMLconvert Function Documentation
 _______________________________________________


</PRE><h2>INTRODUCTION</h2>
 
<P>
The Internet Assistant Wizard Add-In program provides
enhanced capabilities for the Microsoft Excel 97 Internet
Assistant Wizard, including programmatic conversion of data
and charts to HTML. The upgraded features of this add-in are
as follows:

<UL><LI>Improved conversion of filtered lists
<P>
   When you convert a range filtered with AutoFilter to
   HTML, the entire list is converted with the filtered
   state of the list maintained. This conversion is done
   automatically; there are no changes to the operation of
   the Internet Assistant Wizard. All filtering options are
   converted except the Custom option; if the range has a
   custom AutoFilter in place, the resulting HTML displays
   the entire unfiltered list.
<P>
   If you subsequently use Microsoft Excel to open a
   converted HTML file that includes a list that was
   filtered with AutoFilter, the entire list is restored,
   with the AutoFilter arrows in place.

<LI>HTMLconvert function for automating conversions.
<P>
   You can use this custom function in Visual Basic for
   Applications to write programs that automatically convert
   worksheet data and charts to HTML. HTMLconvert automates
   all of the capabilities provided by the Internet
   Assistant Wizard. For reference information, see the
   section "HTMLconvert Function Documentation" in this
   readme file.
<P>
<P>
</UL><h2>REQUIREMENTS</h2>
 
<P>
The Internet Assistant Wizard Add-In requires Microsoft
Excel 97. The add-in will not work with earlier versions of
Microsoft Excel.
<P>
<P>
<P><h2>INSTALLING THE INTERNET ASSISTANT WIZARD ADD-IN</h2>
 
<P>
The add-in program includes one add-in file, Html.xla, and
this readme file. To install the Internet Assistant Wizard
Add-In:

<OL><P><LI>Quit Microsoft Excel.

<P><LI>Start Microsoft Excel.

<P><LI>On the Tools menu, click Add-Ins.

<P><LI>Make sure Internet Assistant Wizard is selected. If you
   don't see this add-in listed, click Browse, and use the
   Browse dialog box to locate and select Html.xla. In the
   Add-Ins dialog box, click OK.
<P>
</OL><h2>USING THE INTERNET ASSISTANT WIZARD ADD-IN</h2>
 
<P>
Once installed, you can convert worksheet data and charts to
HTML in either of two ways:

<UL><LI>You can run the Internet Assistant Wizard by clicking
   Save As HTML on the File menu.

<LI>You can use the HTMLconvert function in Visual Basic for
   Applications to perform conversions.
<P>
</UL>In both cases your filtered lists filtered with AutoFilter
are automatically converted in the filtered state, and if
you open the resulting HTML file in Microsoft Excel, the
full list is converted back to Microsoft Excel format with
the filtering intact.
<P>
<P><h2>HTMLCONVERT FUNCTION DOCUMENTATION</h2>
 
<P>
This custom function converts worksheet data and charts to
HTML and then returns an integer constant that indicates
either a successful conversion or the reason for its
failure.
<P>
To use this function, the Html.xla file must be loaded into
memory, either programmatically or by invoking and then
canceling the Internet Assistant Wizard. The Html.xla file
also must be referenced (Tools menu, References command).
<P>
<P><h3>Syntax</h3>
 
<P>
<PRE> HTMLconvert(RangeAndChartToConvert, UseExistingFile,
 UseFrontPageForExistingFile, AddToFrontPageWeb, CodePage,
 HTMLFilePath, [ExistingFilePath], [TitleFullPage],
 [HeaderFullPage],[DescriptionFullPage],
 [LineBeforeTableFullPage], [LineAfterTableFullPage],
 [LastUpdate], [NameFullPage], [EmailFullPage])

</PRE></OL>The HTMLconvert syntax has these named arguments:
<P>
<PRE> RangeAndChartToConvert    Required. A Range or Chart object,
     or an array of Ranges and Chart objects to convert. See
     the sample code below for examples.

 UseExistingFile    Required Boolean. True to insert the
     converted data into the file specified by
     ExistingFilePath. False to create a new file.

 UseFrontPageForExistingFile    Required Boolean. True if the
     file specified by ExistingFilePath is present on the
     currently open FrontPage web. False if the file is on
     the local system or a shared network folder. If False,
     ExistingFilePath must be specified.

 AddToFrontPageWeb    Required Boolean. True to add the file
     to the currently open FrontPage web. If True,
     HTMLFilePath must specify a URL. False to create the
     file on the local system or a shared network folder.

 CodePage    Required Long. The code page to use for the
     HTML. The following code pages are commonly used for
     display on Windows and Macintosh systems.

   Windows
   1250 Eastern Europe
   1251 Cyrillic
   1252 U.S./Western Europe
   1253 Greek
   1254 Turkish

   Macintosh
   10000     Roman (U.S.)
   10001     Japanese
   10006     Greek
   10007     Cyrillic
   10029     Latin 2
   10079     Icelandic
   10081     Turkish

   For more codes and more information about code pages, see
   "Developing International Software for Windows 95 and
   Windows NT" by Nadine Kano, available from Microsoft
   Press at <B><A href="http://www.microsoft.com/mspress/">http://www.microsoft.com/mspress/.</A></B>

 HTMLFilePath    Required String.  Either the path and file
     name or the URL (if AddToFrontPageWeb is True) for the
     converted output file.

 ExistingFilePath    Optional String. Either the path and
     file name or the URL (if UseFrontPageForExistingFile is
     True) for the existing file into which to insert the
     converted data.

 TitleFullPage    Optional String. The HTML window title.

 HeaderFullPage    Optional String. The page header in the
     HTML file.

 DescriptionFullPage    Optional String. Description to
     precede the converted data.

 LineBeforeTableFullPage    Optional Boolean. True to include
     a horizontal rule after the header and description.
     False to omit a rule in this location.

 LineAfterTableFullPage    Optional Boolean. True to include
     a horizontal rule after the converted data and before
     the footer information. False to omit a rule in this
     location.

 LastUpdate    Optional Variant(Date). The date the web page
    was last updated. This date is included at the bottom of
    the HTML page.

 NameFullPage    Optional String. The author's name. This
     name is included at the bottom of the HTML page.

 EmailFullPage    Optional String. The author's e-mail
     address. This address is included at the bottom of the
     HTML page.


</PRE><h3>Return Values</h3>
 
<P>
<PRE>Constant                          Value  Description
--------                          -----  -----------

HTMLCONVERT_SUCCESS                 0    The conversion was
                                         successful.

HTMLCONVERT_ENTIRECOLUMNSELECTED    1    An entire column was
                                         specified for
                                         RangeAndChartToConvert.

HTMLCONVERT_ENTIREROWSELECTED       2    An entire row was specified
                                         for RangeAndChartToConvert.

HTMLCONVERT_PATHEXISTINGFILEMISSING 3    UseExistingFile was True,
                                         and ExistingFilePath was
                                         omitted.

HTMLCONVERT_CANNOTSTARTFRONTPAGE    4    AddToFrontPageWeb was True,
                                         and FrontPage could not be
                                         started.

HTMLCONVERT_FILENOTFOUND            5    UseExistingFile was True,
                                         and the file specified by
                                         ExistingFilePath could not
                                         be found.

HTMLCONVERT_CANNOTUSEEXISTINGFILE   6    UseExistingFile was True,
                                         and the file specified by
                                         ExistingFilePath could not
                                         be used for the conversion.

HTMLCONVERT_XLHTMLNOTINSTALLED      7    The XLHTML.DLL file was not
                                         installed (normally
                                         installed by Setup for
                                         Office or Microsoft Excel).

HTMLCONVERT_CODEPAGEDOESNOTEXIST    8    The code page specified by
                                         CodePage does not exist.

HTMLCONVERT_CANNOTOPENFILE          9    The file specified by
                                         HTMLFilePath could not be
                                         opened.

HTMLCONVERT_OBJECTNOTDEFINED        10   The object specified in
                                         RangeAndChartToConvert
                                         contained worksheet elements
                                         other than Ranges and Chart
                                         objects, or does not exist.

HTMLCONVERT_WEBSERVERNOTOPEN        11   UseFrontPageForExistingFile
                                         was True, or
                                         AddToFrontPageWeb was True,
                                         but the FrontPage Web server
                                         was not running.

HTMLCONVERT_CANNOTFINDXLHTML        13   The XLHTML.DLL file could
                                         not be found (the default
                                         location is C:\Program
                                         Files\Microsoft
                                         Office\Office).

</PRE><h3>Example</h3>
 
<P>
The following example passes an array, Objects, describing
two ranges of data and a chart to be converted. It creates a
new HTML file named MyPage.htm. The file is intended for
display on a U.S. Windows system. The page will have the
header "My Worksheet Data" followed by a horizontal rule and
the converted data. The bottom the page will have the
current date as the time of last update, "MyName" as the
author, and "MyMail@microsoft.com" as the e-mail address.
<P>
<P>
<PRE>Sub CreateMyWebPage()
</PRE>Dim Objects(2) As Variant
<P>
<PRE>      Set Objects(0) = ActiveSheet.Range("A1:C20")
      Set Objects(1) = ActiveSheet.ChartObjects("Chart 1")
      Set Objects(2) = ActiveSheet.Range("E4:H20")
      CreateOK = htmlconvert(Objects, False, False, False, 1252, _
      "c:\MyFolder\MyPage.htm", , , , "My Worksheet Data", _
      True, , Now, "MyName", "MyMail@microsoft.com")
      If CreateOK = 0 Then
           Workbooks.Open "c:\MyFolder\MyPage.htm"
      Else
           MsgBox "Attempt to create page failed."
      End If
End Sub

</PRE> 
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xladdins xlwiz kbappnote kbtool<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbreadme<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
