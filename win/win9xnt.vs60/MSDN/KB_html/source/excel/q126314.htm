

<HTML>
<HEAD>
<TITLE>XL5: Can't Choose Refresh Data Button to Update Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q126314">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/02/20">
<META NAME="Keywords" CONTENT="xlquery kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed above, when you select data on your worksheet that was returned from an external data source, the Refresh Data tool may be unavailable; that is, your computer may beep when you try to choose the Refresh Dat...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAXB,QAYY,QANS,QAF0,QA5D,QAB5,QBJZ,QBWS,QBVU,QAC1,QBXS,QAWM,QAK6,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Can't Choose Refresh Data Button to Update Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q126314</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed above, when you select data on
your worksheet that was returned from an external data source, the Refresh
Data tool may be unavailable; that is, your computer may beep when you try
to choose the Refresh Data tool. Note that the tool still works correctly
when the selected data is contained in a Microsoft Excel PivotTable.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if you choose the Refresh Data toolbar tool on a
toolbar other than the built-in Query And Pivot toolbar.
<P>
The behavior is by design of Microsoft Excel. You can use the Refresh
Data tool any toolbar to retrieve the most current data located in an
external data source that has been used to create a Microsoft Excel
PivotTable. Additionally, you can use the Refresh Data tool on the built-in
Query And Pivot toolbar to refresh data that has been returned to a range
of cells on a Microsoft Excel worksheet.
<P>
You can move or copy toolbar buttons to any existing toolbar in
Microsoft Excel. If you move the Refresh Data button to a toolbar
other than the built-in Query And Pivot toolbar, the button will not
have the additional functionality of refreshing data retrieved from
an external data source to a range of worksheet cells.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem when you add the Refresh Data tool to
another toolbar, you can assign the button to the macro that updates
data returned from an external data source by doing the following:

<OL><P><LI>On the View menu, click Toolbars. In the Toolbars dialog box, click
   Customize.

<P><LI>Click the Refresh Data button on the toolbar to which you added this
   button.

<P><LI>On the Tools menu, click Assign Macro.

<P><LI>In the Macro Name/Reference box, type "XLQUERY.XLA!doRefresh"
   (without the quotation marks) and click OK.
<P>
</OL>The Refresh Data button should now refresh data on your worksheet
that is returned from an external data source.
<P>
<P><h2>STATUS</h2>
 
<P>
This is a known problem in Microsoft Excel version 5.x. The problem was
corrected in Microsoft Excel for Windows 95, version 7.0, Microsoft Excel
97 for Windows, and Microsoft Excel 98 Macintosh Edition.
<P>
REFERENCES
 
<P>
"User's Guide," version 5.0, Chapter 23, "Retrieving Data with
Microsoft Query", page 449
<P>
For more information about the Refresh Data command, choose the
Search button in Help and type:
<P>
<PRE>    Refresh Data command
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c refresh toolbar button XL5<BR>
Keywords          : xlquery kbtool<BR>
Version           : WINDOWS:5.0,5.0c; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
