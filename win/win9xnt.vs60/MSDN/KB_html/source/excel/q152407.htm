

<HTML>
<HEAD>
<TITLE>XL: Using OFFSET, MATCH, and MAX to Return Last Value in Range </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152407">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1996/06/13">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  By using a combination of the OFFSET, MAX, and MATCH functions in a worksheet formula, you can have Microsoft Excel return the value of the last valid cell in a range of cells.  MORE INFORMATION  The following example formula will find the value of...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAHH,QAML,QDNZ,QBCF,QAKU,QBXN,QDMR,QAB9,QAHG,QBCE,QAM3,QAKD,QAUD,QBJZ P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Using OFFSET, MATCH, and MAX to Return Last Value in Range</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152407</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By using a combination of the OFFSET, MAX, and MATCH functions in a
worksheet formula, you can have Microsoft Excel return the value of the
last valid cell in a range of cells.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example formula will find the value of the last valid cell in
a row
<P>
<PRE>     =OFFSET(&lt;StartCell&gt;,0,MATCH(MAX(Range)+1,&lt;Range&gt;,1)-1)

</PRE>where &lt;StartCell&gt; is the address of the first cell of a range, and &lt;Range&gt;
is the address of the cells containing the data.
<P>
The following example formula will find the value of the last valid cell in
a column:
<P>
<PRE>     =OFFSET(&lt;StartCell&gt;,MATCH(MAX(&lt;Range&gt;)+1,Range,1)-1,0)

</PRE>where &lt;StartCell&gt; is the address of the first cell of a range, and &lt;Range&gt;
is the address of the cells containing the data.
<P>
<P><h3>Example 1</h3>
 
<P>
This example demonstrates using both formulas to find the value of the last
valid cell in both a row and a column.

<OL><P><LI>Type the following information into a worksheet:
<P>
<PRE>      A1:  1     B1:        C1:  2      D1:  1      E1:
      A2:        B2:  2     C2:  14     D2:         E2:
      A3:  9     B3:  4     C3:         D3:  10     E3:
      A4:        B4:        C4:  5      D4:         E4:
      A5:        B5:        C5:         D5:         E5:

</PRE><P><LI>In cell E1, type the following formula:
<P>
<P><PRE>      E1: =OFFSET(A1,0,MATCH(MAX(A1:D1)+1,A1:D1,1)-1)
</PRE>
<P><LI>With cell E1 selected, grab the fill handle and fill the formula down
   through cell E4.

<P><LI>In cell A5, type the following formula:
<P>
<P><PRE>      A5: =OFFSET(A1,MATCH(MAX(A1:A4)+1,A1:A4,1)-1,0)
</PRE>
<P><LI>With cell A5 selected, grab the fill handle and fill right the formula
   through cell D5.

<P><LI>The resulting worksheet looks as follows:
<P>
<PRE>      A1:  1     B1:        C1:  2      D1:  1      E1:  1
      A2:        B2:  2     C2:  14     D2:         E2:  14
      A3:  9     B3:  4     C3:         D3:  10     E3:  10
      A4:        B4:        C4:  5      D4:         E4:  5
      A5:  9     B5:  4     C5:  5      D5:  10     E5:

</PRE></OL><h3>Example 2</h3>
 
<P>
This example uses a check book to demonstrate how to always display the
current balance of the check book.

<OL><P><LI>Type the following information into a worksheet:
<P>
<PRE>      A1:          B1:                C1:  Current Balance  D1:
      A2: Date     B2: Transaction    C2:  Description      D2: Balance
      A3: 1/1/96   B3: 125            C3:  Opening Balance  D3:
      A4:          B4:                C4:                   D4:
      A5: 1/5/96   B5: 100            C5:  Deposit          D5:
      A6: 1/6/96   B6: -115           C6:  Payment          D6:
      A7: 1/7/96   B7: 65             C7:  Deposit          D7:
      A8:          B8:                C8:                   D8:
      A9:          B9:                C9:                   D9:
      A10:         B10:               C10:                  D10:

</PRE><P><LI>Type the following formulas into the worksheet:
<P>
<P><PRE>      D3:  =B3
      D4:  =D3+B4
</PRE>
<P><LI>With cell D4 selected, grab the fill handle and fill down the formula
   through cell D7. After filling the formula down, the results will be
   as follows:
<P>
<P><PRE>      D1:
<PRE></PRE>      D2:   Balance
      D3:   125
      D4:   125
      D5:   225
      D6:   110
      D7:   175
      D8:
      D9:
      D10:

</PRE><P><LI>In cell D1, type the following formula to display the current balance:
<P>
<P><PRE>      D1: =OFFSET(A2,MATCH(MAX(A3:A10),A3:A10,0),3)
</PRE><P>
   This formula displays the current balance of 175 in cell D1, which is
   the same value as the value in cell D7.

<P><LI>Type the following information in the following cells:
<P>
<PRE>      A10:  2/1/96    B10:  -125    C10:  Payment     D10:

   With cell D7 selected, grab the fill handle and fill down the formula
   through cell D10. After filling the formula down, the results will be
   as follows:

      D1:   50
      D2:   Balance
      D3:   125
      D4:   125
      D5:   225
      D6:   110
      D7:   175
      D8:   175
      D9:   175
      D10:  50

   Note that the Current Balance in cell D1 now reflects the value in
   cell D10.

</PRE></OL>For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q139574.htm">Q139574</A></B>
   TITLE     : Returning the Address of the Cell with Largest or
               Smallest Value

   ARTICLE-ID: <B><A href="../excel/q142526.htm">Q142526</A></B>
   TITLE     : How to Determine Top and Bottom Used Cells in a Sparse Array

   ARTICLE-ID: <B><A href="../excel/q85234.htm">Q85234</A></B>
   TITLE     : Excel: Formula To Find Last Valid Cell in a Range

</PRE><h2>REFERENCES</h2>
 
<P>
<P><h3>Microsoft Excel 97 and Microsoft Excel 98 Macintosh Edition</h3>
 
<P>
For more information about the OFFSET, MATCH, and MAX functions in
Microsoft Excel 97 and Microsoft Excel 98 Macintosh Edition, click
Microsoft Excel Help on the Help menu and type one of the following:
<P>
<PRE>   Offset
   Match
   Max

</PRE><h3>Microsoft Excel 7.0</h3>
 
<P>
For more information about the OFFSET, MATCH, and MAX functions in
Microsoft Excel version 7.0, click Answer Wizard on the Help menu
and type:
<P>
<PRE>   Offset
   Match
   Max

</PRE><h3>Microsoft Excel 5.0</h3>
 
<P>
For more information about the OFFSET, MATCH, and MAX functions in
Microsoft Excel version 5.0, click the Search button in Help and type:
<P>
<PRE>   Offset
   Match
   Max
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 98 8.00 XL97<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97; MACINTOSH:5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
