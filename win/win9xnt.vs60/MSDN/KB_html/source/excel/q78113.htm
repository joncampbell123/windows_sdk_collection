

<HTML>
<HEAD>
<TITLE>XL: Floating-Point Arithmetic May Give Inaccurate Results </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q78113 ">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1991/11/05">
<META NAME="Keywords" CONTENT="xlformat">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Many combinations of arithmetic operations on floating-point numbers in Microsoft Excel and Microsoft Works may produce results that appear to be incorrect by very small amounts; for example, the expression (.5-.4-.1) may be evaluated to the quanti...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKC,QBC6,QAG8,QBE7,QBE6,QAN2,QAL3,QAAP,QABB,QDL9,QBWQ,QBWO,QBWN,QABA P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Floating-Point Arithmetic May Give Inaccurate Results</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q78113 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.x, 4.x, 5.0,
   5.0a
<LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Works for Windows, versions 2.0, 3.0
<LI>Microsoft Works for Windows 95, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Many combinations of arithmetic operations on floating-point numbers
in Microsoft Excel and Microsoft Works may produce results that appear to
be incorrect by very small amounts; for example, the expression (.5-.4-.1)
may be evaluated to the quantity (2.8E-17), or .000000000000000028.
<P>
This behavior is not a problem in or a limitation of Microsoft Excel or 
Microsoft Works; this behavior occurs because the Institute of Electrical 
and Electronics Engineers, Inc. (IEEE) 754 floating-point standard requires 
that numbers be stored in binary format.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The IEEE 754 standard is a method of storing floating-point numbers in
a compact way that is easy to manipulate. This standard is used by
Intel coprocessors and most PC-based programs that implement
floating-point math.
<P>
IEEE 754 specifies that numbers be stored in binary format to reduce
storage requirements and allow the built-in binary arithmetic
instructions that are available on all microprocessors to process the data 
in a relatively rapid fashion. However, some numbers that are simple,
nonrepeating decimal numbers are converted into repeating binary numbers 
that cannot be stored with perfect accuracy.
<P>
For example, the number 1/10 can be represented in a decimal number
system with a simple decimal, as follows:
<P>
<PRE>   .1

</PRE>However, the same number in binary format becomes the repeating binary
decimal
<P>
<PRE>   .0001100011000111000111 (and so on)

</PRE>and can be repeated as many times as you want. This number cannot be 
represented in a finite amount of space. Therefore, this number is rounded 
down by approximately -2.8E-17 when it is stored.
<P>
If several arithmetic operations are performed to obtain a given result,
these rounding errors may be accumulated.
<P>
In Microsoft Excel, it may be possible in some cases to prevent rounding
errors from affecting your work by using the Precision As Displayed option. 
This option forces the value of each number in the worksheet to be the 
displayed value.
<P>
NOTE: If you use this option, you must format your numbers with a specific 
number format.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q48606.htm">Q48606</A></B>
   TITLE     : Excel: Comparison of Values Does Not Return Correct Result
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 XL97 XL7 XL5 XL4 XL3 7.00 5.00 2.0 2.00 2.01 <BR>
2.1 2.10 2.2 2.20 2.21 3.0 3.00 4.0 4.00 5.00 5.00a 5.00c floating point <BR>
precision math error w_works<BR>
Keywords          : xlformat<BR>
Version           : WINDOWS:2.0,3.0,4.0,5.0,5.0c,7.0,97; MACINTOSH:2.0,3.0,4.0,5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
