

<HTML>
<HEAD>
<TITLE>XL7: Illegal Operation in KERNEL32.DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138886">
<META NAME="KBModify" CONTENT="1997/01/08">
<META NAME="KBCreate" CONTENT="1995/10/30">
<META NAME="Keywords" CONTENT="kbprb kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat).   When you start Microsoft Excel version 7.0, when you click ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBWS,QAB4,QAFI,QDKO,QDKN,QDKM,QDKL,QDKJ,QDKI,QDKH,QAJQ,QBJZ,QDIU,QA50 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: Illegal Operation in KERNEL32.DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138886</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat).
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you start Microsoft Excel version 7.0, when you click details, a
message similar to the following appears:
<P>
<PRE>   Excel caused an invalid page fault in module KERNEL32.DLL
   at 014f:bff858cd.

</PRE><h2>CAUSE</h2>
 
<P>
This error message can be caused by corruption in the initialization files
located in the registry or by setting the "Alternate Startup File Location"
under the Tools menu - Options - General Tab, to the same location where
Excel is installed.
<P>
This problem may also occur if a shortcut to the Microsoft Excel executable
(Excel.exe) is located in the Xlstart directory, or in the "Alternate
Startup File Location" directory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Before attempting to edit the registry, make sure that there are no
shortcuts to the Microsoft Excel executable, Excel.exe, located in the
Xlstart directory (C:\Msoffice\Excel\Xlstart, for example). If there are,
remove them; then, try to launch Microsoft Excel.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
If this error message is encountered with the same memory offset, and you
did set the "Alternate Startup File Location" to the same directory where
Microsoft Excel is installed, use the following steps to resolve the
problem. Be aware that Microsoft Excel will go to into a default state.
That is, any environment settings, add-ins, or alternate startup
directories will need to be reset.

<OL><P><LI>Exit Microsoft Excel.

<P><LI>On the Windows Start menu, click Run.

<P><LI>In the Open box, type "regedit", without quotation marks. Click OK.

<P><LI>Click on the HKEY_CURRENT_USER folder. Click the Software folder,
   then click the Microsoft folder, and then the click the Excel folder.

<P><LI>Use the right mouse button to click the name section of the 7.0 folder.

<P><LI>Choose Rename from the shortcut menu. Rename the folder to 70.old.

<P><LI>On the Registry menu, click Exit.

<P><LI>Restart Microsoft Excel.
<P>
</OL>If the error message occurred after setting the "Alternate Startup File
Location" to where Microsoft Excel is installed, try the following steps.

<OL><P><LI>Exit Microsoft Excel.

<P><LI>On the Windows Start menu, click Run.

<P><LI>In the Open box, type "regedit", without quotation marks. Click OK.

<P><LI>On the Edit menu, click Find. In the "Find What" box, type "AltStartup"
   without quotation marks, and click Find Next. Ensure that the open
   folder in the left pane of the editor says "Microsoft Excel".

<P><LI>Right-click on the label "AltStartup" and click Modify. Clear the
   contents of the Value Data edit box so that it is empty.

<P><LI>Click OK.

<P><LI>On the Registry menu, click Exit.

<P><LI>Restart Microsoft Excel.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb kberrmsg<BR>
KBSubcategory: xlwinsetup
<P>

Additional reference words: 7.00 0137:BFF858CD
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
