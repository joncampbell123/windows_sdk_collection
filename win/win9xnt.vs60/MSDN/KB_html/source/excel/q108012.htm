

<HTML>
<HEAD>
<TITLE>XL5: Visual Basic Procedure to Display Screen Metrics </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108012">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1993/12/01">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following macro allows you to determine the metrics of your video display (that is, horizontal resolution, vertical resolution, number of colors) by using a macro in Microsoft Excel, version 5.0. This information may be helpful in creating macr...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAH4,QBVP,QDK0,QBXT,QA5V,QAYS,QAIB,QA4Q,QAB9,QBVV,QAUD,QAKC,QA01,QBC6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Visual Basic Procedure to Display Screen Metrics</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108012</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00
WINDOWS
kbusage
<P>
 
The information in this article applies to:

<UL><LI> Microsoft Excel for Windows, version 5.0
<LI> Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following macro allows you to determine the metrics of your video
display (that is, horizontal resolution, vertical resolution, number of
colors) by using a macro in Microsoft Excel, version 5.0. This information
may be helpful in creating macros that create variable-sized custom dialog
boxes based on display size or take into account the effect of display
resolution on printed output.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. This Visual Basic procedure
is provided 'as is' and Microsoft does not guarantee that it can be
used in all situations. Microsoft does not support modifications of
this procedure to suit customer requirements for a particular purpose.
Note that a line that is preceded by an apostrophe introduces a
comment in the code--comments are provided to explain what the code is
doing at a particular point in the procedure. Note also that an
underscore character (_) indicates that code continues from one line
to the next. You can type lines that contain this character as one
logical line or you can divide the lines of code and include the line
continuation character. For more information about Visual Basic for
Applications programming style, see the "Programming Style in This
Manual" section in the "Document Conventions" section of the "Visual
Basic User's Guide."
<P>
<PRE>'Each Declare statement should be entered as a single line
Declare Function GetActiveWindow Lib "USER" () As Integer

Declare Function GetDeviceCaps Lib "GDI" (ByVal hDC As Integer, ByVal _
</PRE>nIndex As Integer) As Integer
<P>
<PRE>Declare Function GetDC Lib "USER" (ByVal hWnd As Integer) As Integer

</PRE>Const Horz_res = 8
Const Vert_res = 10
Const Planes = 14
Const BitsPixel = 12
<P>
<PRE>Sub Display_info()
   'Returns the handle of the active window
   Act_Win = GetActiveWindow()
   'Returns the handle to the Device Context
   Dev_Con = GetDC(Act_Win)
   'Displays The Horizontal Video resolution
   MsgBox "Horz Video Resolution = " &amp; GetDeviceCaps(Dev_Con, Horz_res)
   'Displays The Vertical Video resolution
   MsgBox "Vert Video Resolution =" &amp; GetDeviceCaps(Dev_Con, Vert_res)
   'Displays the number of Planes
   MsgBox "Planes = " &amp; GetDeviceCaps(Dev_Con, Planes)
   'Displays the number of Bits per Pixels
   MsgBox "Bits per Pixel = " &amp; GetDeviceCaps(Dev_Con, BitsPixel)
End Sub

</PRE>The above macro displays 4 message boxes showing the following:

<UL><LI>Horizontal video resolution
<LI>Vertical video resolution
<LI>Number of Planes
<LI>Bits per Pixel
<P>
<P>
</UL>NOTE: The macros shown below will not work on systems running Microsoft
Windows NT (all versions). Microsoft Windows NT does not allow applications
to control the operating system in the manner described below. These macros
will run without error but will have no effect.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 5.0 high res mapping screen driver<BR>
Keywords          : kbusage<BR>
Version           : 5.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
