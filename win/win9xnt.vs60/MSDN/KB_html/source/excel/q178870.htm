

<HTML>
<HEAD>
<TITLE>XL98: How to Create Web Query Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178870">
<META NAME="KBModify" CONTENT="1998/02/26">
<META NAME="KBCreate" CONTENT="1998/01/05">
<META NAME="Keywords" CONTENT="xlquery xlweb kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article explains how to create Web query files for use with Microsoft Excel 98 Macintosh Edition.  MORE INFORMATION  In Microsoft Excel 98 Macintosh Edition, Web queries allow you to query data from a specific World Wide Web, Internet, or intr...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QBXT,QA5V,QAIB,QAKD,QAHE,QBVP,QALZ,QAPF,QBWA,QACF,QAQW,QATX,QBRZ,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: How to Create Web Query Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178870</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to create Web query files for use with
Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, Web queries allow you to query
data from a specific World Wide Web, Internet, or intranet site and
retrieve the information directly into a Microsoft Excel worksheet.
Microsoft Excel 98 Macintosh Edition includes some sample Web queries. More
samples are available at Microsoft's Web site at the following location:
<P>
<PRE>   <B><A href="http://www.microsoft.com/msexcel/">http://www.microsoft.com/msexcel/</A></B>

</PRE><h3>Definition of a Web Query File</h3>
 
<P>
A Web query file is a text file that contains from one to four lines of
text where each line of text is separated by a carriage return. Web query
files can be created in any text editor, such as SimpleText. Web query
files are saved in the Microsoft Office 98:Office:Queries folder on your
computer's hard disk.
<P>
<P><h3>Creating a Web Query File</h3>
 
<P>
To create a Web query file, follow these steps:

<OL><P><LI>Start a text editor, such as SimpleText.

<P><LI>Type the four lines of text in the text editor using the following
   information:
<P>
   First Line: Type of Query
<P>
   The first line in the Web query file tells Microsoft Excel what type of
   query the file contains. At this time, the following are the only valid
   query types:
<P>
<P><PRE>      WEB
      &lt;line omitted&gt;
</PRE><P>
   If you omit the line, WEB is the assumed value.
<P>
   Second Line: Version of Query
<P>
   The second line of a Web query file tells Microsoft Excel the version
   of the query that is being executed. At this time, the following are the
   only valid versions:
<P>
<P><PRE>      1
      &lt;line omitted&gt;
</PRE><P>
   NOTE: If you specify the type of query in the first line, you must
   specify a version in the second line. If you omit the type, you must
   also omit the version.
<P>
   Third Line: Uniform Resource Locator (URL)
<P>
   The third line of a Web query file determines the Web document on which
   the query acts. Unless the Web document is a POST type (see the "Fourth
   Line: POST Parameters" section), this information is the only required
   value in the Web query file.
<P>
   Type the URL in one of the following formats.
<P>
<PRE>      File location                   URL format
      -------------------------------------------------------
      Web document                    <B>http://&lt;server&gt;/&lt;file&gt;</B>
      File stored locally             &lt;drive&gt;:&lt;folder&gt;:&lt;file&gt;
      File stored on a network        &lt;drive&gt;:&lt;folder&gt;:&lt;file&gt;

   where &lt;file&gt; is the name of the document, &lt;drive&gt; is the drive that
   contains the file, and &lt;folder&gt; is the folder name that contains the
   file.

   Fourth Line: POST Parameters

   The fourth line of a Web query file contains POST parameters. Note
   that this line is optional and must be included only if the third line
   (the URL) exceeds 200 characters in length as a result of adding
   parameters.

   When you query a Web document for information, the parameters sent to
   the Web document can be sent in one of two ways: GET or POST.

   When you use the GET method, data values are included in the same line
   as the URL. The following example illustrates how to type the line:

      <B>http://&lt;server&gt;/&lt;file&gt;?parameters</B>

   where &lt;server&gt; is the name of the server that contains the Web document,
   and &lt;file&gt; is the name of the document.

   When you use the POST method, data values are sent in a separate line.
   The following example illustrates how to type the line:

      <B>http://&lt;server&gt;/&lt;file&gt;</B>
      parameters

   where &lt;server&gt; is the name of the server that contains the Web document,
   and &lt;file&gt; is the name of the document.

</PRE><P><LI>After you type all the required lines, save the new file as a text file
   in the Microsoft Office 98:Office:Queries folder.

<P><LI>Quit the text editor.
<P>
</OL><h3>Using Static and Dynamic Parameters in a Web Query</h3>
 
<P>
In Web queries, you can use static and/or dynamic parameters. Static
parameters send query data without prompting you for any values. Dynamic
parameters prompt you to type one or more values when the Web query is
executed.
<P>
The syntax for parameters is as follows:
<P>
<PRE>   &lt;parameter&gt;=&lt;value string&gt;

</PRE></OL>where &lt;parameter&gt; is the name of a parameter (for example, stock) and
&lt;value string&gt; is a value.
<P>
The value string can be one of the following values:
<P>
<PRE>   Parameter type   Value string
   -----------------------------------------------------------
   Static           value1
   Dynamic          ["value1","Please enter the first value:"]

</PRE>In the dynamic value string, the first argument (value1) is the name of the
value to be entered. The second argument is the message that appears when
the Web query is executed.
<P>
If multiple parameters are required, separate them with an ampersand
character (&amp;). The following example illustrates the syntax:
<P>
<PRE>   quote1=stock1&amp;quote2=stock2

</PRE>When multiple values are sent for a single parameter, separate them with a
plus sign (+). The following example illustrates the syntax:
<P>
<PRE>   quote1=stock1+stock2&amp;quote2=stock3+stock4

</PRE>You can combine static and dynamic parameters within a single parameter
string. The following example illustrates the syntax:
<P>
<PRE>   quote1=stock1&amp;quote2=["stock2","Please enter the second value:"]

</PRE><h3>Examples of Web Query Files</h3>
 
<P>
The following examples are designed to demonstrate the syntax used by Web
query files in Microsoft Excel 98 Macintosh Edition.
<P>
NOTE: The following examples are not functional Web queries.
<P>
Example One:
<P>
This example sends the value "wyut" to the Client.exe and retrieves a
value. You are not prompted to type any values. The parameter is sent using
the GET method.
<P>
<PRE>   WEB
   1
   <B><A href="http://www.weylandyutani.com/cgi-bin/client.exe?quote=wyut">http://www.weylandyutani.com/cgi-bin/client.exe?quote=wyut</A></B>

</PRE>If you like, you can omit the first two lines and use the following line:
<P>
<PRE>   <B><A href="http://www.weylandyutani.com/cgi-bin/client.exe?quote=wyut">http://www.weylandyutani.com/cgi-bin/client.exe?quote=wyut</A></B>

</PRE>It is acceptable to omit the first two lines when you create the web query
file. This is true for all of the examples shown in this article.
<P>
Example Two:
<P>
This example sends the values "wyut" and "hypd" to the Client2.exe, and
then retrieves values. You are not prompted to type any values. The
parameters are sent using the POST method.
<P>
<PRE>   WEB
   1
   <B><A href="http://www.weylandyutani.com/cgi-bin/client2.exe">http://www.weylandyutani.com/cgi-bin/client2.exe</A></B>
   quote1=wyut&amp;quote2=hypd

</PRE>Example Three:
<P>
This example prompts you to type a stock symbol, sends that symbol to the
Client.exe, and retrieves a value. The parameters are sent using the GET
method.
<P>
NOTE: The third and fourth lines of this example should be typed on a
single line in your text file.
<P>
<PRE>   WEB
   1
   <B><A href="http://www.weylandyutani.com/cgi-bin/client.exe?quote1=">http://www.weylandyutani.com/cgi-bin/client.exe?quote1=</A></B>
      ["stock1","Please enter a stock symbol:"]

</PRE>Example Four:
<P>
This example sends the value "wyut" and a value that you are prompted to
enter to the Client2.exe, and then retrieves the values. The parameters are
sent using the POST method.
<P>
<PRE>   WEB
   1
   <B><A href="http://www.weylandyutani.com/cgi-bin/client2.exe">http://www.weylandyutani.com/cgi-bin/client2.exe</A></B>
   quote1=wyut&amp;quote2=["stock2","Please enter a stock symbol:"]
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98<BR>
Keywords          : xlquery xlweb kbfaq<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
