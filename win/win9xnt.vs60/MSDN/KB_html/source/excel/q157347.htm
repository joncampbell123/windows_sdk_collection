

<HTML>
<HEAD>
<TITLE>XL97: Change in ADD.MENU Macro Position Argument </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157347">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/10/10">
<META NAME="Keywords" CONTENT="xlmhowto xlminfo kbmacro kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you run a Microsoft Excel version 4.0 (XLM) macro that contains the ADD.MENU macro function, the location of the menu you add may be different than in earlier versions of Microsoft Excel.  CAUSE =====  The XLM ADD.MENU macro function has an opti...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QACI,QBJZ,QAF0,QAPN,QAHE,QAH4,QAJP,QAY5,QADZ,QBBI,QAGF,QBWR,QBV8,QAB9 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Change in ADD.MENU Macro Position Argument</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157347</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you run a Microsoft Excel version 4.0 (XLM) macro that contains the
ADD.MENU macro function, the location of the menu you add may be different
than in earlier versions of Microsoft Excel.
<P>
<P><h2>CAUSE</h2>
 
<P>
The XLM ADD.MENU macro function has an optional third argument called
Position. In Microsoft Excel versions 4.0, 5.0 and 7.0, if you do not
specify anything for the Position argument, the ADD.MENU function adds your
custom menu to the left of the Help menu. In Microsoft Excel 97, if you do
not use the Position argument, the function adds your custom menu to the
right of the Help menu.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want your custom menu to appear immediately to the left of the Help
menu in Microsoft Excel 97, you must specify something for the Position
argument. For example, if you have your Menu definition table in a defined
name called "Testmenu" and you want your custom menu to appear on the
Worksheet menu bar, use the following macro command:
<P>
<PRE>   =ADD.MENU(10,Testmenu,"Help")

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ADD.MENU macro function has the following syntax:
<P>
<PRE>   =ADD.MENU(bar_num, menu_ref, Position)

</PRE>with the first two arguments being required.
<P>
<P><h3>Descriptions of the ADD.MENU arguments</h3>
 
<P>
bar_num: the ID number for the menu bar to which you want your menu added.
<P>
menu_ref: the reference on your Macro sheet for your Menu definition table.
<P>
Position: a name (as text) or number of an existing menu. Custom menus are
<PRE>          added to the left of the menu specified with the Position
          argument.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlmhowto xlminfo kbmacro kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
