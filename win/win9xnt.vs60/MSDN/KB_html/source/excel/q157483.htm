

<HTML>
<HEAD>
<TITLE>XL97: Limit of Natural Language Formulas per Worksheet </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157483">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/10/11">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, when you enter a formula in a cell, the formula may disappear unexpectedly, leaving the cell empty. You do not receive an error message.  Or, if you fill a range with formulas, you receive some (or all) of the following error...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO8,QBVP,QAB9,QAB4,QABN,QAUD,QAKC,QAEF,QAJB,QBWI,QBC6,QA5E,QAZA,QAPF,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Limit of Natural Language Formulas per Worksheet</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157483</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Excel 97 for Windows
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, when you enter a formula in a cell, the formula may
disappear unexpectedly, leaving the cell empty. You do not receive an error
message.
<P>
Or, if you fill a range with formulas, you receive some (or all) of the
following error messages:
<P>
<PRE>   Microsoft Excel cannot calculate a formula. There is a circular
   reference in an open workbook, but the references that cause it
   cannot be listed for you. Try editing the last formula you entered
   or removing it with the Undo command (Edit menu).

   -or-

   A fatal exception 0E has occurred at 0137:BFF9A07C.

   -or-

   EXCEL caused an invalid page fault in module KERNEL32.DLL at
   0137:bff858e9.

   -or-

   EXPLORER caused a general protection fault in module KRNL386.EXE at
   0001:00007511.

</PRE>Some of the error messages may appear more than once. Ultimately, you are
forced to restart your computer.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problems may occur if the following conditions are true:

<UL><LI>You are using natural language formulas. For example:
<P>
<P><PRE>      =Value1 Value2
</PRE><P>
   where Value1 and Value2 are labels on a table of information within
   the worksheet.
<P>
<P><PRE>    -and-
</PRE>
<LI>The worksheet contains a very large number of formulas of this type.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
In Microsoft Excel 97, a worksheet can contain up to 32764 natural language
formulas. Once this limit is reached, you cannot add any more natural
language formulas without first removing others.
<P>
Also, if you attempt to add a large number of natural language formulas all
at once (for example, by filling a formula down through a large number of
cells), you may receive the error messages shown above, and Microsoft Excel
may stop responding.
<P>
<P><h2>STATUS</h2>
 
<P>
The limitation of 32764 natural language formulas per worksheet is by
design of Microsoft Excel 97.
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, natural language formulas allow you to refer to
values in tables of information without having to define names or use bulky
INDEX-MATCH style formulas. The following example demonstrates how natural
language formulas work:
<P>
<PRE>   A1:           B1: Romeo   C1: Sierra   D1: Tango   E1: Uniform
   A2: Alpha     B2: 1       C2: 2        D2: 3       E2: 4
   A3: Bravo     B3: 5       C3: 6        D3: 7       E3: 8
   A4: Charlie   B4: 9       C4: 10       D4: 11      E4: 12
   A5: Echo      B5: 13      C5: 14       D5: 15      E5: 16

</PRE>If you enter the above information into a new worksheet, you can find
values within the table, or perform actions on parts of the table, by using
a natural language formula.
<P>
For example, the following formula:
<P>
<PRE>   =Charlie Tango

</PRE>will return the value 11, which is the value at the intersection of the
"Charlie" row and the "Tango" column in the table.
<P>
There is a limit of 32764 natural language formulas per worksheet in
Microsoft Excel 97. Once this limit is reached, if you try to enter one
more natural language formula, the formula is not accepted by Microsoft
Excel. If you attempt to add a large number of natural language formulas
all at once, Microsoft Excel may stop responding.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 8.00 32,764 crash crashed<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
