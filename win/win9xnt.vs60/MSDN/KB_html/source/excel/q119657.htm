

<HTML>
<HEAD>
<TITLE>XL5: Problems Running or Recording Macro to Set Print Title </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119657">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/08/20">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, if you use the Set Print Titles command (with Microsoft Excel 4.0 menus displayed) to set a print title while the macro recorder is running, one of the following occurs:   - You receive a syntax error when you run th...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBXS,QAOX,QAMB,QBS0,QA5V,QBWS,QBKN,QAH4,QAB9,QBVV,QAR3,QAKP,QA01,QALQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Problems Running or Recording Macro to Set Print Title</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119657</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, if you use the Set Print Titles
command (with Microsoft Excel 4.0 menus displayed) to set a print
title while the macro recorder is running, one of the following
occurs:

<UL><LI>You receive a syntax error when you run the recorded macro
<P>
   -or-

<LI>An hourglass pointer appears and Microsoft Excel stops responding when
   you choose OK in the Print Titles dialog box
<P>
   -or-

<LI>You receive a general protection (GP) fault
<P>
</UL><h2>CAUSE</h2>
 
<P>
If you choose Set Print Titles from the Options menu with the
Microsoft Excel 4.0 menus displayed, while the macro recorder is
running, a command similar to the following is recorded:
<P>
<PRE>   ExecuteExcel4Macro "SET.PRINT.TITLES(Rows("1:1"),Columns("C:C"))"

</PRE>You receive a syntax error when you run this procedure.
<P>
If you select a row or column on the worksheet before you choose Set
Print Titles, and you only enter data in the Title For Columns box, an
hourglass pointer appears and Microsoft Excel stops responding when you
choose OK in the Set Print Titles dialog box.
<P>
If you only enter data in the Title For Rows box, you receive a GP
fault when you choose OK in the Set Print Titles dialog box.
<P>
Note that these behaviors do not occur when you record the macro
using the Microsoft Excel 4.0 Macro language.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. This Visual
Basic procedure is provided 'as is' and Microsoft does not guarantee
that it can be used in all situations. Microsoft does not support
modifications of this procedure to suit customer requirements for a
particular purpose.
<P>
To avoid the behaviors described above, use the following Visual
Basic procedure to set print titles on the active worksheet:
<P>
<PRE>   Sub Set_Print()
      With ActiveSheet.PageSetup
        ' Replace $1:$1 with the desired range
        .PrintTitleRows = "$1:$1"
        ' Replace $A:$A with the desired range
        .PrintTitleColumns = "$A:$A"
      End With
   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in a
later version of Microsoft Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Printing Titles On Multiple Pages, choose
the Search button in Help and type:
<P>
<PRE>    titles
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 err msg gpf hang
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
