

<HTML>
<HEAD>
<TITLE>MXL5: Application.Quit in Auto_Open Sub Causes Computer to Hang </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129434">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/04/26">
<META NAME="Keywords" CONTENT="xlmac kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, if you open a workbook that contains an Auto_Open subroutine that contains the following line of code     Application.Quit  Microsoft Excel may stop responding (hang) with ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFF,QBVP,QAB4,QAJH,QAVX,QAAP,QAVW,QDJO,QAVZ,QDO9,QBVV,QAPF,QBWS,QAKP,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MXL5: Application.Quit in Auto_Open Sub Causes Computer to Hang</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129434</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for the Power Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article,
if you open a workbook that contains an Auto_Open subroutine that contains
the following line of code
<P>
<PRE>   Application.Quit

</PRE>Microsoft Excel may stop responding (hang) with either a type 1 error or a
type 11 error, depending on whether you are running Microsoft Excel for the
Macintosh or Microsoft Excel for the Power Macintosh.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do either of the following:

<UL><LI>Do not use Application.Quit in the Auto_Open subroutine
<P>
<P><PRE>    -or-
</PRE>
<LI>Instead of using a single Auto_Open subroutine, include an
   Application.OnTime command in your Auto_Open subroutine. This command
   should be set up in such a way that it executes another subroutine after
   the Auto_Open subroutine has completed execution. This other subroutine
   contains the Application.Quit command.
<P>
<P><PRE>      For example, instead of using this
</PRE><P>
<PRE>         Sub Auto_Open()
             MsgBox "This is a test."
             Application.Quit
         End Sub

      use this:

         Sub Auto_Open()
             Application.OnTime Now + TimeValue("00:00:02"), "QuitMSExcel"
         End Sub

         Sub QuitMSExcel()
             MsgBox "This is a test."
             Application.Quit
         End Sub

   Using Application.OnTime to indirectly call the subroutine containing
   Application.Quit allows you to avoid hanging your computer. If the
   Auto_Open subroutine contains Application.Quit, or if the Auto_Open
   subroutine directly executes a macro that contains the Application.Quit
   command, your computer will hang.

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>The following is an example of an Auto_Open subroutine that will cause
Microsoft Excel 5.0 to hang when the workbook that contains it is opened:
<P>
<PRE>   Sub Auto_Open()
       Application.Quit
   End Sub

</PRE>If you open a workbook that contains this subroutine, you will receive one
of the following error messages:
<P>
<PRE>   The application "unknown" has unexpectedly quit, because an error of
   type 1 occurred.

   -or-

   Sorry, a system error occurred.
   "Microsoft Excel"
      error type 11

</PRE>and the computer will either restart or hang when you select the Restart
button.
<P>
This error will not occur unless the subroutine is an Auto_Open subroutine.
For example, when you run the following subroutine
<P>
<PRE>   Sub Test()
       Application.Quit
   End Sub

</PRE>an error will not occur unless the Test subroutine is directly called by
an Auto_Open subroutine.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a auto open autoopen exit hang lock<BR>
Keywords          : xlmac kbcode kbprg<BR>
Version           : MACINTOSH:5.0<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
