

<HTML>
<HEAD>
<TITLE>XL: Macro Error Using GET.DEF Function to Return Local Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115209">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1994/05/22">
<META NAME="Keywords" CONTENT="kbcode kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the GET.DEF() function to return a local name from a workbook, you receive a macro error message similar to  the following if you include the sheet name in the def_text argument (the  information referenced by the n...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QBVP,QAUD,QAY5,QAHE,QAPN,QAB4,QARM,QAH4,QAB9,QBVV,QAXC,QAAP,QBV8,QAPF P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Macro Error Using GET.DEF Function to Return Local Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115209</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the GET.DEF() function to return a
local name from a workbook, you receive a macro error message similar to 
the following if you include the sheet name in the def_text argument (the 
information referenced by the name):
<P>
<PRE>   Macro error at cell:
   [Book1]Macro1!A1

</PRE><h2>CAUSE</h2>
 
<P>
The macro error occurs when you include the sheet name in the def_text
argument, and you do not include the sheet name in the document_text
argument (the sheet that contains def_text).
<P>
For example, the following function causes a macro error:
<P>
<PRE>   =GET.DEF("Sheet2!R1C1","Book2")

</PRE>This error only occurs when the def_text argument is not on the first
sheet in the workbook. For example, the following does not cause a
macro error:
<P>
<PRE>   =GET.DEF("Sheet1!R1C1","Book2")

</PRE>Note that this problem does not occur when you use the GET.DEF() function
to return a global name.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To work around this problem, do not include the sheet name in the def_text 
argument, even though the reference of the defined name includes the sheet 
name. Instead, include the sheet name, with or without the workbook name, 
in the document_text argument, to specify the name of the sheet that 
contains the referenced information.
<P>
Use the following example if the defined name is contained in the
same workbook as the function:
<P>
<PRE>   =GET.REF("R1C1","Sheet2")

</PRE>Use the following example if the defined name is located in a workbook
other than the workbook that contains the function:
<P>
<PRE>   =GET.DEF("R1C1","[Book2]Sheet2")

</PRE>Microsoft provides programming examples for illustration only, without 
warranty either expressed or implied, including, but not limited to, the 
implied warranties of merchantability and/or fitness for a particular 
purpose. This article assumes that you are familiar with the programming 
language being demonstrated and the tools used to create and debug 
procedures. Microsoft support engineers can help explain the functionality 
of a particular procedure, but they will not modify these examples to 
provide added functionality or construct procedures to meet your specific 
needs. If you have limited programming experience, you may want to contact 
the Microsoft fee-based consulting line at (800) 936-5200. For more 
information about the support options available from Microsoft, please see 
the following page on the World Wide Web: 
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B> 

</PRE><h2>MORE INFORMATION</h2>
 
<P>
You can use the GET.DEF() function to return the name, as text, that is
defined for a particular area, value, or formula in a workbook.
<P>
If there is more than one name defined for the def_text argument, the
first name is returned. A global name that references def_text is
returned before a local name that references def_text.
<P>
If you use the GET.DEF() function, and you do not use the document_text
argument, the document_text argument is assumed to be the active
macro sheet. However, if you specify the workbook name without a
sheet name for the document_text argument, the def_text argument is
assumed to be located on the first worksheet in the workbook.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the GET.DEF function, choose the Search
button in Macro Functions Help and type:
<P>
<PRE>   GET.DEF
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 7.00a 97 98 XL98 XL97 XL7 XL5 <BR>
err msg<BR>
Keywords          : kbcode kberrmsg kbprg<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
