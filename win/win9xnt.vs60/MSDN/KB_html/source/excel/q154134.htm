

<HTML>
<HEAD>
<TITLE>XL97: Functions in Filled Formulas May Not Be Recalculated </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154134">
<META NAME="KBModify" CONTENT="1998/03/19">
<META NAME="KBCreate" CONTENT="1996/07/30">
<META NAME="Keywords" CONTENT="xlformula kbdta kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, some formulas on a worksheet may not be recalculated automatically. This behavior may occur even if you choose to use automatic calculation for formulas in the worksheet.  CAUSE =====  This problem may occur in either of the ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA50,QBJZ,QBWS,QA2Q,QAG2,QAB9,QAE5,QBCF,QAPF,QDMR,QAUD,QAM3,QAKD,QAP2 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Functions in Filled Formulas May Not Be Recalculated</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154134</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, some formulas on a worksheet may not be recalculated
automatically. This behavior may occur even if you choose to use automatic
calculation for formulas in the worksheet.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur in either of the following cases:
<P>
<P><h3>Case 1</h3>
 

<UL><LI>You create a range of formulas that reference data in other cells.
<P>
<P><PRE>    -and-
</PRE>
<LI>You insert a row within the range of formulas.
<P>
<P><PRE>    -and-
</PRE>
<LI>You select the values and the formula in the row beside the new row,
   and then fill the data into the new row.
<P>
<P><PRE>    -and-
</PRE>
<LI>You change the values of the cells that the formulas reference.
<P>
</UL>NOTE: To see an example, see Example 1 in the "More Information" section in
this article.
<P>
<P><h3>Case 2</h3>
 

<UL><LI>You create a range of two or more equivalent formulas that reference
   data in other cells.
<P>
<P><PRE>    -and-
</PRE>
<LI>You create a second range of equivalent formulas, and the second range
   intersects the first range of formulas.
<P>
<P><PRE>    -and-
</PRE>
<LI>You change values in the cells that the first range of formulas
   references.
<P>
</UL>NOTE: To see an example, see Example 2 in the "More Information" section in
this article.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, obtain and install the Excel 97 Auto Recalculation
Patch.
<P>
For information about downloading and installing this patch, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q174868.htm">Q174868</A></B>
   TITLE     : XL97: How to Obtain the Excel 97 Auto Recalculation Patch

</PRE>Or, go to the following Microsoft World Wide Web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/excel/enhancements/xl8p1.asp">http://www.microsoft.com/office/excel/enhancements/xl8p1.asp</A></B>

</PRE>To work around this problem, follow these steps:

<OL><P><LI>On the Edit menu, click Replace.

<P><LI>In the Find What box, type "=" (without the quotation marks). In the
   Replace With box, type "=" (without the quotation marks). Click Replace
   All.
<P>
</OL>The formulas are recalculated correctly after the "=" is replaced in the
cells.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To select automatic recalculation, click Options on the Tools menu, click
the Calculation tab, and then click Automatic.
<P>
<P><h3>Example 1</h3>
 
<P>
To see an example of the problem as described for the first case in the
"Cause" section, follow these steps:

<OL><P><LI>Create a new workbook in Microsoft Excel 97.

<P><LI>Type the following into the workbook:
<P>
<P><PRE>      A1: 1  B1: 2
</PRE>
<P><LI>Select cell C1. Type "=Sum(A1:B1)" (without the quotation marks) and
   press ENTER.

<P><LI>Select A1:C1. Drag the fill handle to C3.

<P><LI>Select Row 3. On the Insert menu, click Rows.

<P><LI>Select A2:C2. Drag the fill handle to C3.

<P><LI>Select B1:B4. Type "5" (without the quotation marks). Press CTRL+ENTER.
<P>
</OL>Note that values in C1:C3 are recalculated correctly but that the value in
C4 is not.
<P>
<P><h3>Example 2</h3>
 
<P>
To see an example of the problem as described in the second case in the
"Cause" section, follow these steps:

<OL><P><LI>Create a new workbook in Microsoft Excel 97.

<P><LI>Select A1:A10. Type "1" (without the quotation marks). Press CTRL+ENTER.

<P><LI>Select B1:B10. Type "2" (without the quotation marks). Press CTRL+ENTER.

<P><LI>Select C1:C10. Type "=sum(a1:b1)" (without the quotation marks). Press
   CTRL+ENTER.

<P><LI>Select C8:I8. Type "=$a$17" (without the quotation marks). Press
   CTRL+ENTER.

<P><LI>Select B1:B10. Type "3" (without the quotation marks). Press CTRL+ENTER.
<P>
</OL>Notice that all values are calculated correctly except for the value in
C10, which is not recalculated.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about automatic recalculation, click Contents And
Index on the Help menu, click the Index tab in Microsoft Excel 97 Help,
type the following text:
<P>
<PRE>   recalculating formulas, calculation methods

</PRE></OL>and then double-click the selected text to go to the "Change the way
Microsoft Excel calculates formulas" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 recalc auto recalculation wrong function<BR>
Keywords          : xlformula kbdta kbfaq<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
