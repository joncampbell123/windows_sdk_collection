

<HTML>
<HEAD>
<TITLE>XL4: Workbook Disappears when Using FORMULA.GOTO() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99701 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/06/06">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 4.0, a workbook may disappear from the workspace if you are using the FORMULA.GOTO() macro function. This behavior usually occurs when the FORMULA.GOTO() function is used to go to a defined range on a worksheet in a second workbo...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QAH4,QBWS,QDNM,QAWA,QAVX,QAVW,QAY5,QAB9,QA2Q,QDMR,QBVV,QAPF,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL4: Workbook Disappears when Using FORMULA.GOTO()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99701 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a
<LI>Microsoft Excel for the Macintosh, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 4.0, a workbook may disappear from the workspace if you
are using the FORMULA.GOTO() macro function. This behavior usually
occurs when the FORMULA.GOTO() function is used to go to a defined
range on a worksheet in a second workbook.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this situation, switch to the second workbook sheet and
select the range of cells with another function such as the
WORKBOOK.ACTIVATE() function.
<P>
For example, use the following macro:
<P>
<PRE>   =ACTIVATE("B.XLW")
   =WORKBOOK.ACTIVATE("[B.XLW]Sheet1",FALSE)
   =FORMULA.GOTO("test")
   =RETURN()

</PRE>Unlike the macro example shown below, the macro above does not go directly
from the Workbook Contents page of the first workbook (A.XLW) to the named 
range on the second workbook (B.XLW). The first line of the macro activates 
the second workbook, B.XLW. The second line of the macro activates Sheet1 
in workbook, B.XLW.  The third line selects the named range, "test", and 
Sheet1.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior does not occur in later versions of Microsoft Excel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example describes a situation in which this behavior
will occur. At the end of this example, a macro example is given to
show how to avoid this problem.
<P>
To demonstrate the behavior described in this article, follow these steps:

<OL><P><LI>Open two workbooks (such as, A.XLW and B.XLW).

<P><LI>Create a sheet in B.XLW called Sheet1 and define a name on the
   sheet called "test" (without the quotation marks).

<P><LI>In a new macro sheet, type the following macro:
<P>
<P><PRE>      =FORMULA.GOTO([B.XLW]Sheet1!test)
      =RETURN()
</PRE>
<P><LI>Click Arrange on the Window menu and then click Tiled. Click OK. This
   displays the two Workbook Contents Pages and the macro sheet. Make sure
   the Workbook Contents pages for both workbooks are displayed.

<P><LI>With A.XLW selected as the active window, click Run on the Macro menu to
   start the macro you created in step 2. Select the name of the macro and
   click OK.
<P>
</OL>When you run the macro, it selects the range "test" that is defined on
Sheet1 in B.XLW. The workbook, A.XLW, will disappear completely,
leaving you with three windows: one containing Sheet1 on B.XLW, one
containing the Workbook Contents page of B.XLW, and the other
containing the macro sheet.
<P>
If you click Unhide on the Window menu, A.XLW does not appear in the list. 
Also, if you click the Window menu, A.XLW does not show at the bottom as an 
open file. However, if you click Open on the File menu and select A.XLW, 
Microsoft Excel asks you if you want to "Revert to Saved 'A.XLW'?", as if 
the workbook is currently open. At this point you can either click Cancel 
or click OK.
<P>
If you try to click A.XLW in the list of four recently opened files on the 
File menu, Microsoft Excel will not open the file and after doing this none 
of the sheets on the workspace are active. Also, if you exit Microsoft 
Excel, you will be asked if you want changes in A.XLW saved, meaning it is 
still open somewhere.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, pages 4, 172, 460-461
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL4 4.00 4.00a closes close gone removed remove<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:4.0,4.0a; MACINTOSH:4.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
