

<HTML>
<HEAD>
<TITLE>XL5: Cut/Paste Formula with Reference Returns #REF! Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127791">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/03/16">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you cut a range of cells that contains both a formula and the cells that it refers to, and you paste the formula and the cells to another worksheet, the reference in the formula is displayed as the #REF! error value.  This er...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9N,QBVP,QAEF,QAB9,QBOJ,QBJZ,QDNZ,QAAP,QAUD,QANJ,QAB4,QAB3,QAKD,QACI,QAHT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Cut/Paste Formula with Reference Returns #REF! Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127791</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you cut a range of cells that contains both a
formula and the cells that it refers to, and you paste the formula and the
cells to another worksheet, the reference in the formula is displayed as
the #REF! error value.
<P>
This error value may cause the resulting formula to return the #REF! error
value as well.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs if you use the Cut command to move a formula from one
worksheet to another worksheet when the formula contains a reference to a
cell on the original worksheet. For example, if you cut the cells A1:A4,
and if cell A4 contains the following formula
<P>
<PRE>   =SUM(A1:A3)

</PRE>if you paste A1:A4 to a cell on another worksheet, the formula appears as
=SUM(#REF!) and returns the #REF! error value on the worksheet.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid receiving the #REF! error value when you move a formula to another
worksheet, use the Copy command instead of the Cut command by doing the
following:

<OL><P><LI>Select the cell that contains the formula that you want to move.

<P><LI>On the Edit menu, click Copy.

<P><LI>Select the worksheet to which you want to move the formula.

<P><LI>Select the destination cell, and click Paste on the Edit menu.
<P>
</OL>NOTE: If the formula uses relative references, its new location must have
at least the same number of cells above it as the original location. For
example, if you copy a formula from cell A4 on Sheet1, and if that formula
references cells A1:A4, the destination location must have at lease four
cells above it.

<OL><P><LI>On the original worksheet, delete the formula that you copied.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel version 5.0a for the Macintosh and Microsoft Excel for
Windows 95, version 7.0.
<P>
NOTE: If you cut a formula that contains relative references to cells on a
worksheet (and you do not cut the cells that the formula refers to) and you
paste that formula to another worksheet, the formula is not adjusted and
you will always receive a #REF! error value. This is a limitation of
Microsoft Excel.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Moving Cells, or the Cut Command (Edit Menu),
choose the Search button in MS Excel Help and type:
<P>
<PRE>   moving cells
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:5.0,5.0c; MACINTOSH:5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
