

<HTML>
<HEAD>
<TITLE>XL5: GP Fault Using INSERT.OBJECT Without All Arguments </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124311">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/12/27">
<META NAME="Keywords" CONTENT="kbprg kbole xlwin">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the INSERT.OBJECT() function to insert an object, and you use the display_icon_logical argument set to the value TRUE, you may receive a general protection (GP) fault when you run the macro that contains this functi...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QAPN,QACI,QA9N,QBVP,QBVV,QAHE,QAW6,QAH4,QAB9,QAY5,QBS0,QAKD,QBFY,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: GP Fault Using INSERT.OBJECT Without All Arguments</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124311</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the INSERT.OBJECT() function to insert
an object, and you use the display_icon_logical argument set to the
value TRUE, you may receive a general protection (GP) fault when you
run the macro that contains this function.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs when you use the INSERT.OBJECT function with a
display_icon_logical argument value of TRUE, and you omit either the
icon_file or the icon_label argument. You do not receive a GP fault
if you omit only the icon_number argument. You also do not receive a
GP fault if you use the Null value, or "" for the value of the
icon_file or icon_label argument.
<P>
Note that if you omit the icon_number argument when you use the
INSERT.OBJECT function, you do not receive a GP fault, but the object
is not inserted.
<P>
The display_icon_logical value of TRUE indicates that you want to
insert an object using the application icon to display the object,
instead of the default display for the object. However, if you do not
include the information about what icon file to use, or the title for
the icon, at least as the Null value "", you receive a GP fault when
you run the macro.
<P>
Note that if you use the OLEObject object in a Visual Basic procedure
to insert an object, and you do not use the icon_file, or icon_label
arguments, you do not receive a GP fault, however, the specified
object is not inserted.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving a GP fault when you use the INSERT.OBJECT function
to insert an object using an icon display, always use the icon_file
and icon_label arguments, even if they are Null, as in the following
examples:
<P>
Microsoft provides macro examples for illustration only, without warranty
either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
This macro is provided 'as is' and Microsoft does not guarantee that the
following code can be used in all situations. Microsoft does not support
modifications of the code to suit customer requirements for a particular
purpose.
<P>
Note that the code following each equal sign should be entered as a
single line.
<P>
<PRE>   =INSERT.OBJECT("Equation.2",,FALSE,TRUE,
      "C:\WIN3\MSAPPS\EQUATION\EQNEDIT.EXE",0,"Microsoft Equation 2.0")

   =INSERT.OBJECT("Equation.2",,FALSE,TRUE,
      "C:\WIN3\MSAPPS\EQUATION\EQNEDIT.EXE",0,"")

   =INSERT.OBJECT("Equation.2",,FALSE,TRUE,"",0,"Microsoft Equation 2.0")

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft
products listed at the beginning of this article. This problem was
corrected in Microsoft Excel version 5.0c.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use the INSERT.OBJECT function in Microsoft Excel version
5.0c, or the OLEObject object in a Visual Basic procedure in
Microsoft Excel version 5.0 or 5.0c, the icon_file, icon_number, and
icon_label arguments are still required to insert an object. However,
you do not receive a GP fault if any of these arguments are omitted.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about INSERT.OBJECT, choose the Search button in
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>    INSERT.OBJECT function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbole<BR>
KBSubcategory: xlwin
<P>

Additional reference words: 5.00 5.00a
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
