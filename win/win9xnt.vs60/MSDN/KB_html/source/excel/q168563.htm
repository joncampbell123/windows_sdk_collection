

<HTML>
<HEAD>
<TITLE>XL97: Problems When Using Different Print Quality for Sheets </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168563">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/05/14">
<META NAME="Keywords" CONTENT="xlprint xlvbahowto xlvbainfo kbprint">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you print multiple worksheets in Microsoft Excel 97, multiple print jobs may be generated. This may cause one or more of the following problems to occur:   - If you are printing to a file, only some of the sheets are printed to    the file; re...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBVP,QBS0,QAJQ,QAH4,QAKP,QABA,QBWS,QBAO,QBJZ,QBJQ P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Problems When Using Different Print Quality for Sheets</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168563</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you print multiple worksheets in Microsoft Excel 97, multiple print
jobs may be generated. This may cause one or more of the following problems
to occur:

<UL><LI>If you are printing to a file, only some of the sheets are printed to
   the file; remaining sheets are printed to your printer.

<LI>If you are printing to a file, you may be prompted to enter the name of
   the output file multiple times.
<P>
   As a result, more than one output file is generated. Each file contains
   part of the complete printout.

<LI>If you are using a Microsoft Visual Basic for Applications macro to 
   print the sheets, the macro may fail because there are multiple requests 
   for names for the output files.

<LI>If you are printing to a network printer that is heavily used, your
   print jobs may be mixed in with other users' print jobs.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems occur if you use different print quality settings to print
the worksheets. When you print multiple worksheets in Microsoft Excel 97,
each change in the print quality setting forces Microsoft Excel to create a
new print job using that print quality setting.
<P>
NOTE: These problems do not occur when you print the same worksheets in
earlier versions of Microsoft Excel.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, make sure that all of the worksheets you are
printing use the same print quality settings. You can do this manually or
you can use a Visual Basic macro to change the print quality.
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>The following Visual Basic macro ensures that all worksheets in a workbook
use the same print quality settings:
<P>
<PRE>   Sub SetPrintQuality()

       For Each xSheet In ActiveWorkbook.Sheets
           xSheet.PageSetup.PrintQuality = 600
       Next xSheet

   End Sub

</PRE>This macro assumes that your printer is capable of printing at 600 dots per
inch (dpi). If your printer cannot print at this resolution, change the
value in the third line of the macro to an appropriate value for your
printer (for example, 150, 300, 600, or 1200).
<P>
After you run this macro, all of the worksheets use the same print quality
setting, and the problem no longer occurs.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97 for 
Windows. This problem was corrected in Microsoft Excel 97 for Windows, 
Service Release 1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps demonstrate the problem:

<OL><P><LI>In Microsoft Excel 97, create a new workbook that contains three
   worksheets, for example, Sheet1, Sheet2, and Sheet3.

<P><LI>In each worksheet, enter the following values:
<P>
<P><PRE>      Sheet1:
</PRE><P>
<PRE>         A1: Sheet1 - 300 DPI

      Sheet2:

         A1: Sheet2 - 600 DPI

      Sheet3:

         A1: Sheet3 - 300 DPI

</PRE><P><LI>Click Sheet1. On the File menu, click Page Setup, and then click the
   Page tab. In the Print Quality list, click "300 dpi" and click OK.

<P><LI>Repeat step 3 for Sheet2 and Sheet3, setting the Print Quality to "600
   dpi" and "300 dpi" respectively.
<P>
   Note that each worksheet uses a different print quality than the
   worksheet that precedes it.

<P><LI>Right-click the sheet tab for Sheet1. On the shortcut menu, click
   Select All Sheets.

<P><LI>On the File menu, click Print. In the Printer section of the Print
   dialog box, click to select the Print To File check box. Then, click OK.
<P>
</OL>One of the following problems occurs:

<UL><LI>If you are using a printer driver that is connected to the FILE: port,
   the Print To File dialog box appears three times.

<LI>If you are using a printer driver that is connected to the LPT1:,
   LPT2:, or any other port that is connected to a printer, the Print To
   File dialog box appears only once for Sheet1. The other worksheets are
   printed to the printer.

<LI>If you use a Visual Basic macro to print the worksheets, the Print To
   File dialog box may appear more than once. If you are using the SendKeys
   method to send the name of the output file to the Print To File dialog
   box, the macro may fail if the dialog box appears more than once.
<P>
</UL>If you change the print quality of Sheet3 to 600 dpi, two print jobs are
generated: one at 300 dpi (Sheet1), and one at 600 dpi (Sheet2 and Sheet3).
If you change the print quality of Sheet1 to 600 dpi, two print jobs are
generated: one at 600 dpi (Sheet1 and Sheet2), and one at 300 dpi (Sheet3).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 worksheets chart sheets charts printtofile<BR>
Keywords          : xlprint xlvbahowto xlvbainfo kbprint<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
