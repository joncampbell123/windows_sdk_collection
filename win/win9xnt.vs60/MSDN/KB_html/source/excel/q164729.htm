

<HTML>
<HEAD>
<TITLE>XL97: New Database Query (.dqy) File Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164729">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/03/06">
<META NAME="Keywords" CONTENT="xlquery kbtool kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Query 97 uses a new database query (.dqy) file format. This article discusses the new format and how to use it with earlier versions of Microsoft Query.  MORE INFORMATION  The database query format is the default file format that is used ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QBVP,QATX,QAUR,QAMB,QACF,QBRZ,QAZV,QBWS,QBVV,QAU7,QDNG,QA28,QATJ,QAHE P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: New Database Query (.dqy) File Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164729</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Query 97 for Windows
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Office 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Query 97 uses a new database query (.dqy) file format. This
article discusses the new format and how to use it with earlier versions
of Microsoft Query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The database query format is the default file format that is used when you
use the Save command in Microsoft Query 97. For backward compatibility,
Microsoft Query 97 continues to support Microsoft Query version 1.0 and
2.0 (.qry) files when you save and load these files. When you open a .qry
file and edit it in Microsoft Query 97, features that cannot be
represented in the .qry file format are not available. For example,
parameterized query functionality is not available because this feature is
not available in earlier versions of Microsoft Query. Also, if you create
a query in Microsoft Query 97 and use features that are not supported in
earlier versions, you cannot to save the .dqy file as a .qry file until
you remove the new functionality.
<P>
The database query format is designed to be small, simple, and efficient.
Note that most of the presentation information that can be saved in .qry
files is not retained in the database query. Defaults are substituted for
some items, such as window, table, and document positions. When you
perform a new query, .qry files are not supported by the Microsoft Excel
Run Query command or the Queries tab in the Choose Data Source dialog box.
<P>
When you save a query in Microsoft Query 97, Microsoft Query saves a text
file with a .dqy file name extension. This text file consists of at least
four lines of text that are each separated by carriage returns and line
feed characters. Note that these characters typically do not appear in a
text editor.
<P>
The format of the Database Query file is as follows:
<P>
<PRE>   XLODBC
   1
   &lt;Connection String&gt;
   &lt;SQL String&gt;
   &lt;Parameter names&gt;
   &lt;Parameter data types&gt;
   &lt;Column Names&gt;

</PRE>where XLODBC is the type, 1 refers to Microsoft Query 97, and the
&lt;Parameter names&gt;, &lt;Parameter data types&gt;, and &lt;Column names&gt; lines are
tab delimited.
<P>
<P><h3>Sample Database Query (.dqy) File</h3>
 
<P>
In the following example, text is wrapped to allow you to view it easily.
In an actual .dqy text file, the connection string and SQL string text is
not wrapped. Each text string appears on an individual line. The following
is a sample .dqy file:
<P>
<PRE>   XLODBC
   1
   CollatingSequence=ASCII;DBQ=C:\office97\Office;DefaultDir=C:\office97\
   Office;Deleted=1;Driver= {Microsoft dBase Driver(*.dbf)};DriverId=277;
   FIL=dBaseIII;ImplicitCommitSync=Yes; MaxBufferSize=512;MaxScanRows=8;
   PageTimeout=600;
   ParadoxNetStyle=3.x;ParadoxUserName=admin;Statistics=0;
   Threads=3;UserCommitSync=Yes;
   SELECT CUSTOMER.CUSTMR_ID, CUSTOMER.COMPANY, CUSTOMER.CITY,
   CUSTOMER.REGION FROM CUSTOMER CUSTOMER
   CUSTMR_ID COMPANY CITY REGION

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using database query (.dqy) files, click the
Index tab in Microsoft Query Help, type the following text
<P>
<PRE>   saving queries

</PRE>and then double-click the selected text to go to the "Save a query" topic.
<P>
For more information about running a query from Microsoft Excel, click the
Index tab in Microsoft Query Help, type the following text
<P>
<PRE>   dqy files

</PRE>and then double-click the selected text to go to the "Run a query" topic.
<P>
For more information about creating a parameter query from Microsoft
Excel, click the Index tab in Microsoft Excel Help, type the following
text
<P>
<PRE>   parameter queries

</PRE>and then double-click the selected text to go to the "Create a query that
prompts for criteria" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.0 XL97<BR>
Keywords          : xlquery kbtool kbualink97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
