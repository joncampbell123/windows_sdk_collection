

<HTML>
<HEAD>
<TITLE>MXL5: AppleScript Close Method Does Not Ask to Save Changes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128748">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/04/10">
<META NAME="Keywords" CONTENT="xlmac kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use AppleScript to control the versions of Microsoft Excel listed above, and you use a command that closes an unsaved document, Microsoft Excel does not display a message asking if changes should be saved.  This situation occurs regardless...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUR,QAGB,QAU7,QAAW,QBVV,QAPF,QAH4,QAGC,QA01,QDO9,QANE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MXL5: AppleScript Close Method Does Not Ask to Save Changes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128748</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use AppleScript to control the versions of Microsoft Excel
listed above, and you use a command that closes an unsaved document,
Microsoft Excel does not display a message asking if changes should be
saved.
<P>
This situation occurs regardless of whether you use the "close" command
specified in the Microsoft Excel AppleScript Dictionary or the Microsoft
Excel 4.0 macro language CLOSE() command as an argument to the "Evaluate"
command.
<P>
NOTE: This problem does NOT occur in Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because of a limitation in the interface between the
versions of Microsoft Excel listed at the beginning of this article and
AppleScript.
<P>
In the two AppleScript examples below, a command is sent to Microsoft Excel
instructing it to close the Active Workbook document. The first example,
which specifies the "saving" parameter, will cause the document to be saved
without prompting.
<P>
NOTE: If the document has not been previously saved, the standard Save
dialog box will appear, requesting a filename and folder location for the
saved file. Also, note that when you use the syntax in example 1, if you
use the "saving" parameter followed by any valid value (such as the words
"yes," "no," "ask," or the values 0, 1, 2 and so on) Microsoft Excel will
attempt to save the document.
<P>
The examples of AppleScript code in this article are provided for
illustration only. This AppleScript code is provided 'as is' and Microsoft
does not guarantee that it can be used in all situations. Microsoft does
not support modifications of this code to suit customer requirements for a
particular purpose. AppleScript is manufactured by Apple Computer, Inc., a
vendor independent of Microsoft; we make no warranty, implied or otherwise,
regarding this product's performance or reliability.
<P>
<P><h3>Example 1</h3>
 
<P>
<PRE>   tell application "Microsoft Excel"
      Activate
      close ActiveWorkbook saving ask
   end tell

</PRE><h3>Example 2</h3>
 
<P>
<PRE>   tell application "Microsoft Excel"
      Activate
      Evaluate "close()"
   end tell

</PRE><h2>WORKAROUND</h2>
 
<P>
If you want Microsoft Excel to prompt you to save changes when you close a
document, you can include a short AppleScript routine that mimics this
functionality. This workaround uses the "Display Dialog" scripting
addition, which is available from Apple Computers, Incorporated.
<P>
The Display Dialog file must be in the following location:
<P>
<PRE>   System Folder:Extensions:Scripting Additions

</PRE><h3>AppleScript Sample Workaround</h3>
 
<P>
<PRE>   tell application "Microsoft Excel"
      Activate
      if (Saved of ActiveWorkbook) then
         Close ActiveWorkbook
      else
         display dialog "Document not saved. Save it now?"
   buttons {"Yes", "No", "Cancel "} default button 1
         if button returned of result is "Yes" then
            Close ActiveWorkbook saving yes
         else if button returned of result is "No" then
            Close ActiveWorkbook
         else
            display dialog "You canceled." buttons "OK"
   default button 1
         end if
      end if
   end tell

</PRE>NOTE: The text string "Cancel " (as used above) contains a trailing space.
Because Display Dialog generates an error condition that causes a script to
terminate when a button named "Cancel" (no trailing space) is pressed, the
addition of the space prevents this error condition.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Microsoft
Excel listed at the beginning of this article. This problem was corrected
in Microsoft Excel 98 Macintosh Edition.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a XL5 apple script close saving ask prompt<BR>
Keywords          : xlmac kb3rdparty<BR>
Version           : MACINTOSH:5.0<BR>
Platform          : MACINTOSH<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
