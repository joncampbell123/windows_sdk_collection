

<HTML>
<HEAD>
<TITLE>XL5: Custom Multiple Select List Box Returns Incorrect Result </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112067">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1994/03/01">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you run a macro that displays a custom dialog box with a multiple selection list box that was created in Microsoft Excel version 3.0 or 4.0, when you select an item or items in the list box and choose OK, the result returned ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QA01,QBVP,QAUJ,QBWS,QA2Q,QAH4,QANX,QDKS,QAUD,QAL3,QAG2,QAKC,QARM,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Custom Multiple Select List Box Returns Incorrect Result</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112067</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00
WINDOWS
kbusage
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you run a macro that displays a custom dialog box
with a multiple selection list box that was created in Microsoft Excel
version 3.0 or 4.0, when you select an item or items in the list box and
choose OK, the result returned for the item selected in the list box is
incorrect.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you select an item from a multiple selection list box in a custom
dialog box, a name is created on the sheet that contains the dialog box
definition table. This name stores the number or numbers that correspond to
the items that you select in the list box. The values are stored as an
array, and the name created to store these values is the name that you
define in the custom dialog box definition table. To specify the name of
this result, type the name in the Init/Result column of the list box line
(item number 15) in the dialog box definition table.
<P>
When the dialog box definition table is not contained on the macro sheet
with the macro that runs it, and you open the files that contain the dialog
definition and the macro that runs the dialog box in Microsoft Excel
version 5.x or 7.0, when you run the dialog box, the name created to store
the values you select is created as a local name, but the values returned
by the macro are those contained in the global name. The values returned
are the values that you selected in the list box the last time you ran the
dialog box.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid having incorrect results returned when you run a macro that
displays a custom dialog box with a multiple selection list box that
was created in Microsoft Excel versions 3.0 or 4.0, do either of the
following:

<UL><LI>Create the dialog definition on the macro sheet that contains the
   macro that runs the custom dialog box.
<P>
   -or-

<LI>In the macro that runs the dialog box, wherever you refer to the name
   that stores the selected items in the list box, use the sheet name in
   the reference to refer to the local name. For example, if you use the
   following line in the macro that runs the dialog box to display the
   number of the selected item
<P>
<P><PRE>      =ALERT(INDEX(DIALOG.XLS!selection,1,i))
</PRE><P>
   where DIALOG.XLS is the name of the file that contains the dialog
   definition, and "selection" is the name of the result, change the line
   to the following
<P>
<P><PRE>      =ALERT(INDEX([DIALOG.XLS]DIALOG!selection,1,i))
</PRE><P>
   where DIALOG is the name of the sheet in the DIALOG.XLS workbook that
   contains the dialog definition.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 5.00c 7.00<BR>
Keywords            : kbusage<BR>
Version             : 5.00 5.00c 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
