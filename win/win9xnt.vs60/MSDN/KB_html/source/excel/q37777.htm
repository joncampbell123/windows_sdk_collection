

<HTML>
<HEAD>
<TITLE>Custom VSEARCH and HSEARCH Macros to Replace VLOOKUP/HLOOKUP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q37777 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1988/11/10">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following is a function macro called VSEARCH that will take the place of VLOOKUP. It has the same syntax as VLOOKUP, but it doesn't require the data to be sorted. It will take advantage of defined names, just like VLOOKUP. HSEARCH is also avail...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAUD,QAHH,QAHE,QAE1,QBVP,QAY5,QAPN,QAGI,QAJQ,QA5V,QAUJ,QAPF,QDMN,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Custom VSEARCH and HSEARCH Macros to Replace VLOOKUP/HLOOKUP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q37777 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0
<LI>Microsoft Excel for OS/2, versions 2.2, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following is a function macro called VSEARCH that will take the place
of VLOOKUP. It has the same syntax as VLOOKUP, but it doesn't require the
data to be sorted. It will take advantage of defined names, just like
VLOOKUP. HSEARCH is also available in place of HLOOKUP. More information on
HSEARCH is located below the examples of calling VSEARCH:
<P>
<P><h3>The VSEARCH Function Macro</h3>
 
<P>
The following is the VSEARCH macro:
<P>
<PRE>   A1: Vsearch
   A2: =ARGUMENT("item")
   A3: =ARGUMENT("data1",8)
   A4: =ARGUMENT("col_num",1)
   A5: ="R"&amp;ROW(data1)&amp;"C"&amp;COLUMN(data1)&amp;":R"&amp;ROW(data1)+
       ROWS(data1)-1&amp;"C"&amp;COLUMN(data1)
   A6: =GET.DOCUMENT(1)
   A7: =INDEX(data1,MATCH(item,TEXTREF(A6&amp;"!"&amp;A5),0),col_num)
   A8: =RETURN(A7)

</PRE>The macro must now be defined as a function macro with the following steps:

<OL><P><LI>Make cell A1 (or the cell that contains the name VSEARCH) the
   active cell on the macro sheet.

<P><LI>From the Formula menu, choose Define Name.

<P><LI>Select the Function radio button or press ALT+F.

<P><LI>Choose OK.
<P>
</OL>As long as the macro is loaded, it can be called from any sheet by using
the normal procedures for calling a function macro.
<P>
<P><h3>Examples of How to Call Vsearch</h3>
 
<P>
The following examples assume that the macro sheet containing the
VSEARCH macro is named VSCH.XLM:

<OL><P><LI>=VSCH.XLM!Vsearch("Smith",database,2)
<P>
   This example looks for the name "Smith" in the database on the
   active sheet and returns the value from the second column of the
   database, just as VLOOKUP would if the database had been sorted.

<P><LI>=VSCH.XLM!Vsearch(A2,B1:G5,3)
<P>
   This example takes the contents of cell A2 on the active sheet and
   searches for it in the array B1 through G5. If it makes a match, it
   returns the value in the third column of that array; in this case,
   column D. If there is no match, #N/A is returned.
<P>
</OL><h3>The HSEARCH Function Macro</h3>
 
<P>
To use HSEARCH instead of HLOOKUP, the macro is as follows:
<P>
<PRE>   B1: Hsearch
   B2: =ARGUMENT("item")
   B3: =ARGUMENT("data1",8)
   B4: =ARGUMENT("row_num",1)
   B5: ="R"&amp;ROW(data1)&amp;"C"&amp;COLUMN(data1)&amp;":R"&amp;ROW(data1)&amp;"C"&amp;
       COLUMN(data1)+COLUMNS(data1)
   B6: =GET.DOCUMENT(1)
   B7: =INDEX(data1,row_num,MATCH(item,TEXTREF(B6&amp;"!"&amp;B5),0))
   B8: =RETURN(B7)

</PRE></OL>HSEARCH has the same parameters as VSEARCH.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21<BR>
3.0 3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
