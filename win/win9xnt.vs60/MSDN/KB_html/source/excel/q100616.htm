

<HTML>
<HEAD>
<TITLE>XL: Controlling How Add-in Macros Are Loaded During Startup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100616">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/06/23">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can use the Add-in Manager to select add-in macros that you want to have available when you start Microsoft Excel.  With the Add-in Manager, you can use add-ins that are supplied with Microsoft Excel or you can use add-ins t...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QAUJ,QAB9,QBV8,QABA,QAGU,QAF0,QBAO,QAVI,QAH5,QAH4,QARM,QACI,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Controlling How Add-in Macros Are Loaded During Startup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100616</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can use the Add-in Manager to select add-in macros
that you want to have available when you start Microsoft Excel.
<P>
With the Add-in Manager, you can use add-ins that are supplied with
Microsoft Excel or you can use add-ins that you've created on your own. The
Add-in Manager sets up the add-in to either load or have its custom
commands and functions available in Microsoft Excel upon startup. In the
latter case, the add-in is not actually loaded until you select one of its
custom commands or functions. This kind of loading saves time and memory
when you start Microsoft Excel.
<P>
The Add-in Manager sets up the way your add-in loads by writing appropriate
commands to the settings file. (In Microsoft Excel for Windows, this is the
EXCEL4.INI or EXCEL5.INI file, depending on the version you use and in
Microsoft Excel for the Macintosh, this is the Excel Settings (4) file.)
The commands that are written to your settings file are determined by
defined names on your add-in macro sheet.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To add your add-in macro sheet to the Add-in Manager so that it is
available when you start Microsoft Excel, choose Add-ins from the Options
menu and select the Add button. Select the add-in filename, choose OK and
then choose Close.
<P>
When you add an add-in to the Add-in Manager, the Add-in Manager checks for
the following defined names and performs the specified action.
<P>
NOTE: The names that are preceded by a double underline; this is how they
should be entered into the Name box in the Define Name dialog box. One or
all of these names can be used on the same add-in macro sheet.
<P>
<P><h3>__DemandLoad</h3>
 
<P>
Use this defined name when your add-in contains custom function macros.
When you add your add-in to the Add-in Manager startup list, an OPEN=
statement containing a /F switch plus the name of your add-in and its path
is written to the Microsoft Excel section of the settings file. For
example, in the following statement
<P>
<PRE>   OPEN=/F C:\EXCEL\ANALYSF.XLA

</PRE>the /F switch places all of the custom functions contained on the add-in
sheet in the Paste Function dialog box and __DemandLoad prevents the add-in
from loading until you recalculate or enter one of its functions. If your
add-in macro also contains command macros, you must use the __Command
and/or __Menu defined names to have your custom commands added to the
appropriate menus.
<P>
<PRE>   NOTE: How you define __DemandLoad in the Refers To box in the
   Define Name dialog box is not important; you can use the Boolean
   value of TRUE, for example. If you use a value of FALSE,
   __DemandLoad behaves the same as if you use a value of TRUE.

</PRE><h3>__Command</h3>
 
<P>
Use this defined name when your add-in contains command macros that you run
using custom menu commands. The custom commands are added to specified
menus when you start Microsoft Excel (although the add-in macro sheet is
not actually loaded until you select one of the commands). This loading
procedure saves time and memory when you start Microsoft Excel.
<P>
The Add-in Manager writes your __Command definition in the appropriate
format to the Init Commands section of your settings file. Entries in the
Init Commands section add custom commands to specified menus. The
definition for __Command must refer to a horizontal array containing the
following information (only the first 4 are required):
<P>
<PRE>    &lt;Menu_Bar_Num&gt;  Menu bar number
    &lt;Menu Name&gt;     Menu the command should be added to
    &lt;Command Name&gt;  Name of the command to be added
    &lt;Macro text&gt;    Name of the macro to run when command is selected
    &lt;Position&gt;      Position of command on the menu
    &lt;Key&gt;           Macro shortcut key
    &lt;Status&gt;        Message to be displayed on the Status bar
    &lt;Help&gt;          Help topic number

</PRE>The array can be a cell range or an array formula. Assume your add-in
contains a SalesRpt macro that runs when you select Create Report from the
Options menu. You can enter the following and define __Command as
=$B$1:$E$1 (placed in the Refers To box in the Define Name dialog box),
<P>
<PRE>    B1: 1   C1: Options   D1: Create Report   E1: SalesRpt

</PRE>or you can enter an array formula in the Refers To box:
<P>
<PRE>    ={1,"Options","Create Report","SalesRpt"}

</PRE>If you have more than one custom command to add, use sequential names
beginning with __Command, then __Command1, __Command2, and so on.
<P>
<P><h3>__Menu</h3>
 
<P>
The __Command defined name must be defined on the add-in sheet for the
__Menu definition to be added to the appropriate section of the settings
file.
<P>
Use this defined name when your add-in creates a custom menu. The Add- in
Manager writes the __Menu definition in the appropriate format to the Init
Menus section of your settings file. Like the definition for __Command,
__Menu must refer to a horizontal cell range or array formula containing
the following information:
<P>
<PRE>   &lt;Menu_Bar_Num&gt;  Number of the bar you want to add the menu to
   &lt;New Menu&gt;      The name of your menu
   &lt;Position&gt;      Position of the menu on the bar

</PRE>For example, if you want to add MyMenu to the right of the File menu on bar
1, you can enter the following and define __Menu as =$B$1:$D$1 (placed in
the Refers To box):
<P>
<PRE>    B1: 1   C1: MyMenu   D1: 2

</PRE>or you can enter an array formula in the Refers To box:
<P>
<PRE>    ={1,"MyMenu",2}

</PRE>Again, if you have more than one custom menu to add, use sequential names
beginning with __Menu, __Menu1, __Menu2, and so on.
<P>
<P><h3>__DeleteCommand</h3>
 
<P>
The __Command defined name must be defined on the add-in sheet for the
__DeleteCommand definition to be added to the appropriate section of the
settings file.
<P>
Use this defined name to specify built-in Microsoft Excel menu commands
that you want to delete. The Add-in Manager writes the __DeleteCommand
definition in the appropriate format to the Delete Commands section of your
settings file. Like __Command and __Menu, the definition must refer to a
horizontal cell range or array containing the following information:
<P>
<PRE>   &lt;Menu_Bar_Num&gt;  Number of the bar containing the menu from which
                   you want to remove the command.
   &lt;Menu&gt;          The name of the menu containing the command you
                   want to remove.
   &lt;Position&gt;      Position of the command on the menu to be removed

</PRE>For example, if you want to remove the New Window command on the Window
menu, you can enter the following and define __DeleteCommand as =$B$1:$D$1
(in the Refers To box):
<P>
<PRE>   B1: 1   C1: Window   D1: 1

</PRE>or you can enter an array formula in the Refers To box:
<P>
<PRE>   ={1,"Window",1}

</PRE>Again, if you have more than one built-in command to delete, use sequential
names beginning with __DeleteCommand, __DeleteCommand1, __DeleteCommand2,
and so on.
<P>
<P><h3>__LongName</h3>
 
<P>
Use this defined name to specify the name you want to see in the Add-in
Manager dialog box when you add your add-in to the startup list. __LongName
can refer to a cell containing the extended name or it can be defined as a
text string. No information is written to the settings file when this name
is on the add-in.
<P>
If you want to see "My Add-in" in the Add-in Manager dialog box, enter My
Add-in in cell B1 and define __LongName as =$B$1, or define __LongName as
="My Add-in".
<P>
<P><h3>__ReadOnly</h3>
 
<P>
This defined name designates that the add-in be read only and prevents you
from changing the original file. The Add-in Manager creates an OPEN= line
for your add-in with an /R switch if your add-in also contains
__DemandLoad. If there is no __DemandLoad name, no information is written
to the settings file. To work correctly, __ReadOnly must be defined as
TRUE.
<P>
Each of these settings, with the exception of __LongName, can be added to
the settings file manually. In the Microsoft Windows operating environment,
you can add OPEN= statements, as well as these other settings, to the
EXCEL4.INI or EXCEL5.INI file using a text editor such as Notepad. See the
EXCELINI.TXT file for additional information. If you are using Microsoft
Excel for the Macintosh, the Add-in Manager adds statements to the Excel
Settings (4) file. To make modifications to the Excel Settings (4) file
manually, you must use the ResEdit utility. ResEdit is available through
Macintosh user groups, or the Apple Programmers and Developers Association
(APDA).
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
"EXCELINI.TXT"
"SDK User's Guide," page 441
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.0 4.00 4.0a 4.00a 5.0 5.00 addin<BR>
Version           : WINDOWS: 4.0,4.0a,5.0; MACINTOSH: 4.0, 5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbref<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
