

<HTML>
<HEAD>
<TITLE>XL97: Printer Name not Listed in Print Dialog Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177442">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/12/01">
<META NAME="Keywords" CONTENT="xlprint">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" WARNING: The information in this article has not been confirmed or tested by Microsoft. Some or all of the information in this article has been taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS AT...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDL9,QBWQ,QBWO,QBWN,QAR4,QAOX,QDI2,QADF,QAUJ,QACT,QA0B,QBVP,QAGU,QAB5 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Printer Name not Listed in Print Dialog Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177442</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
WARNING: The information in this article has not been confirmed or tested
by Microsoft. Some or all of the information in this article has been
taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION
PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this
information "as is" without warranty of any kind, either express or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to print your workbook, the printer name does not appear in
the Name box in the Print dialog box. However, the same printer does appear
in the Print dialog box of other Microsoft Office 97 programs. This may
occur when you have just one or two printers installed.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur if Microsoft Excel cannot read the printer
information when either of the following exists:

<UL><LI>The Devices section of the Win.ini file contains incomplete or incorrect
   information.
<P>
<P><PRE>    -or-
</PRE>
<LI>User information in the Windows registry is corrupted.
<P>
</UL>Note that if you remove the Win.ini file, or if it becomes corrupted, and
you then restart Windows 95, a new Win.ini file is created. However, the
new Win.ini file contains only the Desktop and/or Embedding sections. The
Devices section is missing.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Perform either of the following workarounds to correct this problem.
<P>
<P><h2>Workaround 1: Repair the Win.ini File</h2>
 
<P>
Do any of the following to correct this problem with the Win.ini file:
<P>
<P><h3>Method 1: Reinstall all Printer Drivers</h3>
 
<P>
Because one damaged printer driver can sometimes have damaging side-affects
for the other drivers installed, remove and then reinstall the printer
driver. In some cases you may need to remove all the installed printers and
then reinstall them. This will recreate the required information for the
Devices section as well as write the correct entries for the Ports, Printer
Ports, and Windows sections in the Win.ini file.
<P>
For information on how to install a new printer driver, click the Search
button in Windows 95 Help and type:
<P>
<PRE>   printer drivers, installing

</PRE><h3>Method 2: Correct the Win.ini File</h3>
 
<P>
Locate the Win.ini file and correct the Devices section. To do so, follow
these steps:

<OL><P><LI>Open the Win.ini file in Notepad. The Win.ini file is located in your
   Windows folder.

<P><LI>In the Win.ini file, find the [Devices] section.

<P><LI>The Devices section should list the friendly name of the printer,
   followed by an equal sign, the driver name, a comma, and then the port
   or network path. The following is a sample [Devices] section:
<P>
<P><PRE>      [Devices]
      HP LaserJet 4/4M=HPPCL5MS,LPT1:
      HP LaserJet IIISi=HPPCL5MS,\\Server\Sharename
</PRE><P>
   Remark the line by placing a semi-colon before the printer name as in
   the following example:
<P>
<P><PRE>      ;HP LaserJet 4/4M=HPPCL5MS,LPT1:
</PRE><P>
   Then reinstall the printer driver to create the new entry.
<P>
</OL><h3>Method 3: Create a New Win.ini File</h3>
 
<P>
If neither Method 1 nor Method 2 resolves your problem, you can create a
new Win.ini file with the correct information.
<P>
Rename the Win.ini to Win.old, and reinstall Windows 95. Windows 95
detects that you are reinstalling, and a dialog box will appear with the
title "Run Setup Again?" The dialog box will give you two options. Select
the first option (to restore Windows files that are changed or corrupted)
and reinstall Windows 95.
<P>
This method recreates a new, complete Win.ini file with all of the required
sections.
<P>
<P><h2>Workaround 2: Rebuild the User.dat Registry</h2>
 
<P>
Do the following to correct this problem with the Windows registry file,
User.dat:

<OL><P><LI>Restart Windows in MS-DOS mode. At the MS-DOS prompt, type the
   following
<P>
<P><PRE>      cd\&lt;windows&gt;
      attrib -s -h -r user.dat
</PRE><P>
   where &lt;windows&gt; is the name of your Windows folder.

<P><LI>Type the following line to rename the User.dat file:
<P>
<P><PRE>      ren user.dat user.old
</PRE>
<P><LI>Restart Windows 95 as you normally do.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 missing absent disappear blank empty<BR>
Keywords          : xlprint<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
