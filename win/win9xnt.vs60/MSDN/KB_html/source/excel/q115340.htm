

<HTML>
<HEAD>
<TITLE>MSQuery Err Msg: "Query Can Have Only One Outer Join" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115340">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1994/05/24">
<META NAME="Keywords" CONTENT="xlquery kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Query 1.0, if you attempt to create more than one outer join, you will receive the following error message:     Query can have only one outer join  CAUSE =====  Microsoft Query version 1.0 is limited to one outer join between two table...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBPJ,QDNB,QBI0,QABM,QDI1,QBJZ,QBXS,QAY2,QBWS,QBVP,QAPN,QAZZ,QAG2,QBTI,QBFY P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQuery Err Msg: "Query Can Have Only One Outer Join"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115340</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS
kbusage kberrmsg kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Office 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Query 1.0, if you attempt to create more than one outer join,
you will receive the following error message:
<P>
<PRE>   Query can have only one outer join

</PRE><h2>CAUSE</h2>
 
<P>
Microsoft Query version 1.0 is limited to one outer join between two tables
(Microsoft Query can perform several inner joins and/or a single outer join
in a query).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this limit, you can create multiple outer joins by modifying
the SQL statement containing the single outer join so that it performs
multiple outer joins.
<P>
After you make the modification, Microsoft Query will not be able to
display the multiple outer joins, but it will be able to display the
resulting query.
<P>
WARNING: Your use or modification of the SQL statement provided in
this article is at your own risk. Microsoft provides this SQL
statement "as is" without warranty of any kind, either expressed or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. Microsoft
does not support modifications of the SQL statement to suit specific
customer requirements.
<P>
The following is an example of a double outer join using two related dBASE
tables. In order for the example to work correctly, you must have a data
source installed for the dBASE file format.
<P>
<P><h3>Creating Sample Databases</h3>
 

<OL><P><LI>In Microsoft Excel, create the following table:
<P>
<PRE>      A1: FIRSTNAME     B1: LASTNAME       C1: LETTER
      A2: John          B2: Smith          C2: a
      A3: Sam           B3: Smith          C3:b
      A4: Mike          B4: Smith          C4: c
      A5: Jack          B5: Johnson        C5: d
      A6: John          B6: Johnson        C6: e
      A7: Sam           B7: Johnson        C7: f
      A8: Mike          B8: Johnson        C8: g

</PRE><P><LI>From the File menu, choose Save As. Save the file in the dBASE file
   format, and name it EMPA.DBF.

<P><LI>On a new worksheet, create another table with the following information:
<P>
<PRE>      A1: FIRSTNAME     B1: LASTNAME       C1: COUNT
      A2: Sam           B2: Johnson        C2: 6
      A3: Mike          B3: Johnson        C3: 7
      A4: George        B4: Smith          C4: 1
      A5: Sam           B5: Smith          C5: 2
      A6: Mike          B6: Smith          C6: 3

</PRE><P><LI>From the File menu, choose Save As. Save the file in the dBASE file
   format, and name EMPB.DBF.
<P>
</OL><h3>Creating Two Outer Joins</h3>
 

<OL><P><LI>Start Microsoft Query, and choose New Query from the File menu.

<P><LI>In the Select Data Source dialog box, it choose dBASE files, and choose
</OL>the
<PRE>   Use button.

</PRE><P><LI>In the Add Tables dialog box, add the EMPA.DBF and EMPB.DBF dBASE files
   that you created in the "Creating Sample Databases" section above, and
   then choose Close.

<P><LI>From the Table menu, choose Joins. In the Joins dialog box, choose
   empa.FIRSTNAME from the Left list, choose = from the Operator list, and
   choose empb.FIRSTNAME from the Right list. Select the second option in
   the Join Includes group to specify a LEFT OUTER join, and then choose
   ADD, and then Close.

<P><LI>Double-click the * for the empa table, then double-click the * for
   the empb table.
<P>
   All of the fields will be added to the query.

<P><LI>Click the View SQL button on the toolbar.
<P>
   The following SQL statement will be displayed:
<P>
<P><PRE>      SELECT empa.FIRSTNAME, empa.LASTNAME, empa.LETTER, empb.FIRSTNAME,
      empb.LASTNAME, empb.COUNT FROM {oj c:\wow\empa.dbf empa LEFT OUTER
      JOIN c:\wow\empb.dbf empb ON empa.FIRSTNAME = empb.FIRSTNAME}
</PRE>
<P><LI>Starting from the "ON" portion of the statement, modify the SQL
   statement so that it matches the following statement:
<P>
<P><PRE>      SELECT empa.FIRSTNAME, empa.LASTNAME, empa.LETTER, empb.FIRSTNAME,
      empb.LASTNAME, empb.COUNT FROM {oj c:\wow\empa.dbf empa LEFT OUTER
      JOIN c:\wow\empb.dbf empb ON (empa.FIRSTNAME = empb.FIRSTNAME and
      empa.LASTNAME=empb.LASTNAME.}
</PRE>
<P><LI>In the SQL Statement dialog box, choose OK.

<P><LI>When you get the "SQL Query can't be represented graphically. Continue
   anyway?" message, choose OK.
<P>
</OL>You will then have your double outer join. The results are below:
<P>
<PRE>   FIRSTNAME  LASTNAME   LETTER   FIRSTNAME  LASTNAME  COUNT
   John       Smith       a
   Sam        Smith       b        Sam        Smith     2
   Mike       Smith       c        Mike       Smith     3
   Jack       Johnson     d
   John       Johnson     e
   Sam        Johnson     f        Sam        Johnson   6
   Mike       Johnson     g        Mike       Johnson   7

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
Joins are used in Microsoft Query version 1.0 to associate tables using
common fields. In a two table example, an outer join retrieves all the
records from one table and only those records from the other table for
which values in the joined fields are equal.
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Query User's Guide," pages 102-113
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kberrmsg<BR>
KBSubcategory: xlquery
<P>

Additional reference words: 5.00 howto
<P>

Keywords            : xlquery kberrmsg kbusage<BR>
Version             : 1.00 7.00 97<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
