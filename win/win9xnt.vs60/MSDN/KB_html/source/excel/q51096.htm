

<HTML>
<HEAD>
<TITLE>Excel: Code Resource Does Not Execute or Unexpected Results </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51096 ">
<META NAME="KBModify" CONTENT="1994/11/29">
<META NAME="KBCreate" CONTENT="1989/11/17">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QBVP,QAKD,QAUD,QAIM,QAH6,QBVV,QAH7,QAD7,QABI,QDO5,QABG,QAKC,QALW,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Code Resource Does Not Execute or Unexpected Results</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 29, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51096 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
The information below gives possible solutions to two commonly
encountered problems when using code resources with Microsoft Excel.
<P>
<P><h3>The Code Does Not Execute When Called from Excel</h3>
 
<P>
If the code does not execute when called from Excel (for example,
dialog boxes don't appear as expected or devices are not polled),
there may be a problem in the routine. Try compiling the routine as an
application, rather than as a code resource, and running it as a
stand-alone program. Once you are able to run the code stand alone,
recompile it as a code resource and try calling it from Excel.
<P>
<P><h3>Incorrect/Unexpected Values Are Returned to Excel</h3>
 
<P>
If incorrect or unexpected values are returned to Excel, try compiling
the routine as an application and running it stand alone. You may need
to hard code values that would normally be passed from Excel. Make
sure the routine returns the expected value as an application, and
then recompile as a code resource.
<P>
If the value being passed back to Excel is always the same value, or
is 0 (zero), and the routine returns the correct value when compiled
as an application, the problem is probably due to the handling of
values within the code resource. Any constants used within the code
resource must be cast as their proper types (for example, short
double). If any floating-point manipulations are conducted within the
routine, memory address a0 must be moved to a4 at the beginning of the
routine, and a4 must be returned to its previous value at the end of
the routine. Return values must be declared as their own variables
within the routine and not simply as one of the modified values passed
to the routine.
<P>
Also check the passed and returned argument types in the REGISTER()
command. The number and type of arguments passed must match those
specified in the REGISTER() command, with the type passed back to
Excel appearing first. The argument_types specified in the REGISTER()
command must be enclosed in quotation marks.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: macrosheet 2.2 2.20 3.0 3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 29, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
