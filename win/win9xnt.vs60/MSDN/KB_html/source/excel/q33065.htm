

<HTML>
<HEAD>
<TITLE>Excel: Using the REQUEST Macro Command for System Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q33065 ">
<META NAME="KBModify" CONTENT="1995/07/25">
<META NAME="KBCreate" CONTENT="1988/07/18">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The following article explains how to use the REQUEST command from a Microsoft Excel macro with the topic of  system.  The REQUEST command is supported only with a full version of Microsoft Windows operating system, version 2.03 or later and the OS...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAGI,QAH4,QA28,QATJ,QAUD,QA6A,QBV8,QAB9,QBUG,QBUF,QAKD,QALW,QBXV,QBWA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Using the REQUEST Macro Command for System Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q33065 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 2.x, 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for OS/2 versions 2.2, 2,21, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following article explains how to use the REQUEST command from a
Microsoft Excel macro with the topic of "system." The REQUEST command is
supported only with a full version of Microsoft Windows operating system,
version 2.03 or later and the OS/2 Presentation Manager (PM).
<P>
The sample macro below executes another copy of Microsoft Excel, initiates
a DDE (dynamic data exchange) channel to that copy of Microsoft Excel with
the topic of "system," and uses the REQUEST command for system information.
To understand this article, you should be familiar with the following
information (page numbers refer to the "Microsoft Excel Function
Reference," version 3.0).

<UL><LI>Constructing a command macro
<LI>The EXEC macro command, page 70
<LI>The INITIATE macro command, pages 130-131
<LI>The REQUEST macro command, pages 197- 198
<LI>The TERMINATE macro command, page 234
<LI>The INDEX macro command, pages 127-129
<LI>The text concatenation operator &amp;
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
This example assumes that a second copy of Microsoft Excel is being used as
the used as the second application for the DDE link.
<P>
The macro is as follows (starting in cell A2 of the macro sheet):
<P>
<PRE>   A2: =EXEC("excel")
   A3: =INITIATE("excel"&amp;A2,"system")
   A4: =INDEX(REQUEST(A3,"SysItems"),3)
   A5: =TERMINATE(A3)
   A6: =RETURN()

</PRE>After this macro is executed, the value "Status" is placed in cell A4 of
the macro sheet.
<P>
Please note that the system topic "SysItems" returns a list of available
items in the "System" topic. Any item returned by "SysItems" can be used as
a "system" item and thus could be used in the REQUEST function.
<P>
For Microsoft Excel, the list of available topics includes the following:

<UL><LI>SysItems
<LI>Topics
<LI>Status
<LI>Formats
<LI>Selection
<P>
</UL>Any of these items are legal "system" topics for Microsoft Excel. In the
above example, you could replace your request for "SysItems" with one for
available Clipboard formats:
<P>
<PRE>   =INDEX(REQUEST(A3,"Formats"),1)

</PRE>In this case, the value of "Biff" is returned.
<P>
The INDEX function must be used because topics return a list of values. If
the INDEX function is not used, only the first value of that returned list
will be visible. If an INDEX request is made beyond the range of returned
values, a #REF error is returned.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel User's Guide 2," version 4.0, page 302
"Microsoft Excel User's Guide," version 3.0, page 343
"Microsoft Excel Reference," version 2.x, 265
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 2.1 2.10 3.0 3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 25, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
