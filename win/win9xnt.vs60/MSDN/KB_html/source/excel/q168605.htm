

<HTML>
<HEAD>
<TITLE>XL97: Errors If Module Contains Duplicate Subroutine Names </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168605">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/05/15">
<META NAME="Keywords" CONTENT="xlgpf xlvbainfo kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you open a workbook in Microsoft Excel 97, you may receive the following error message:     Compile error:    Ambiguous name detected:                    If you delete the Visual Basic macro specified by the error message and then attempt to r...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAFF,QAH4,QBVP,QAUJ,QBS0,QAFO,QAGB,QBJZ,QAJQ,QBWS,QAAW,QAUR,QARM,QAKP P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Errors If Module Contains Duplicate Subroutine Names</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168605</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a workbook in Microsoft Excel 97, you may receive the
following error message:
<P>
<PRE>   Compile error:
   Ambiguous name detected: &lt;name of a macro&gt;

</PRE>If you delete the Visual Basic macro specified by the error message and
then attempt to run a macro, compile your Visual Basic project, or save and
close the workbook, you may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to either of the
following:
<P>
<PRE>   EXCEL caused an invalid page fault in module &lt;unknown&gt; at
   0000:00000009.

   EXCEL caused an invalid page fault in module VBA332.DLL at
   0137:651b397a.

</PRE><h2>CAUSE</h2>
 
<P>
The first problem occurs if a module in your workbook contains two or more
subroutines with the same name. You receive the error message when you
attempt to run a subroutine in the workbook, when you close the workbook,
and when you open the workbook.
<P>
The second problem may occur if all of the following conditions are true:

<UL><LI>A module in your workbook contains two or more subroutines with
   the same name. One of the subroutines is the last subroutine in the
   module. For example:
<P>
<PRE>      Sub Alpha()
          '&lt;code goes here&gt;
      End Sub

      Sub Omega()
          '&lt;code goes here&gt;
      End Sub

      Sub Alpha()   'This is the duplicate subroutine.
          '&lt;code goes here&gt;
      End Sub

    -and-

</PRE><LI>You save and close the workbook. (NOTE: When you close the workbook,
   you receive the "Ambiguous name detected" error message.)
<P>
<P><PRE>    -and-
</PRE>
<LI>When you reopen the workbook, you delete the duplicate subroutine.
<P>
<P><PRE>    -and-
</PRE>
<LI>You then attempt to run a subroutine, compile the Visual Basic project
   by clicking Compile on the Debug menu, or save and close the workbook.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To prevent these problems from occurring, you must eliminate the duplicate
subroutine names from the modules in the workbook. Because this process may
cause invalid page faults to occur, it is strongly recommended that you
close all open workbooks before performing these steps.

<OL><P><LI>Open the workbook. If you receive the "Ambiguous name detected" error
   message, proceed to step 2. If you do not receive the error message,
   the workbook does not contain duplicate subroutine names, and you can
   close the workbook.

<P><LI>Click OK to dismiss the error message.

<P><LI>In the Code window, either rename the subroutine with the duplicate
   name or delete it. Repeat until each subroutine in the module has a
   unique name.

<P><LI>Repeat step 3 for each module in the workbook that contains duplicate
   subroutine names.

<P><LI>When you are finished, click Close And Return To Microsoft Excel on the
   File menu. Or, press ALT+F11.

<P><LI>On the File menu, click Save. Then, click Close on the File menu.
<P>
</OL>When you do this, you may receive the "Illegal Operation" error message
described in the "Symptoms" section. If this occurs, you should restart
your computer before attempting to use Microsoft Excel 97 again.
<P>
When you reopen the workbook, you should not receive the "Ambiguous name
detected" error message. If you do, it may be necessary to rename all of
the subroutines in the workbook.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, a workbook can contain multiple subroutines with the
same name. However, if a single Visual Basic module contains two or more
subroutines with the same name, Microsoft Excel cannot distinguish between
the two macros, and you will receive the "Ambiguous name detected" error
message.
<P>
If the problems described in the "Symptoms" and "Cause" sections are
already occurring, use the workaround described in the "Workaround" section
to remove the duplicate subroutine names from the workbook. Note that in
some cases, it may be necessary to rename ALL of the subroutines in your
workbook in order to completely eliminate the problem.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97<BR>
Keywords          : xlgpf xlvbainfo kberrmsg kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
