

<HTML>
<HEAD>
<TITLE>XL: Optimizing PivotTable Performance </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104308">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/09/13">
<META NAME="Keywords" CONTENT="xlpivot xlquery kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you create a PivotTable, Microsoft Excel creates a hidden copy (cache) of the source data that is used to perform aggregations and other PivotTable functions. By using this cache, Microsoft Excel can quickly calculate PivotTables and, at the s...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBVU,QAUR,QAYY,QAK6,QAU7,QAJQ,QAU3,QAMR,QBV8,QBI0,QAL3,QBW6,QBF0,QAIK P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Optimizing PivotTable Performance</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104308</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for the Macintosh, version 5.0
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you create a PivotTable, Microsoft Excel creates a hidden copy
(cache) of the source data that is used to perform aggregations and
other PivotTable functions. By using this cache, Microsoft Excel can
quickly calculate PivotTables and, at the same time, maintain the
integrity of the original data. This cache can affect memory use,
speed, and file size depending on options that you select when you
create your PivotTable.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information outlines the options in Steps 1 and 4 of the
PivotTable Wizard and explains how they affect memory use, speed, and
file size.
<P>
<P><h2>PivotTable Wizard Step 1 - Create Table From Data In</h2>
 
<P>
When the cache for a PivotTable is created, you may have both the
original data and the cached data in memory, depending on the data
source option you selected. If your data source is large or if you are
creating several PivotTables from separate data sources, the multiple
copies of the data in memory may deplete your computer's available
memory, which affects Microsoft Excel's speed and performance. You can
save memory if you use a closed original data source or a single data
source when you create multiple PivotTables. The memory use implications 
for each of the data source options in the PivotTable Wizard Step 1 dialog 
box are described in further detail in this article.
<P>
<P><h3>Microsoft Excel List Or Database</h3>
 
<P><h3>or Multiple Consolidation Ranges</h3>
 
<P>
When you use Microsoft Excel List Or Database or Multiple
Consolidation Ranges as your data source, if this data is in an open
sheet, you will have two copies of the data in memory when the PivotTable 
is created. To conserve memory, close the workbook containing your original 
data and create the PivotTable in a separate workbook. This way, only the 
cached data will be in memory.
<P>
<P><h3>Another PivotTable</h3>
 
<P>
This option is available whenever you have another PivotTable in the
same workbook. When you use this option, Microsoft Excel uses the same
cache that is used by the other PivotTables, which limits the number of 
copies of the source data in memory. Use this option whenever you create 
multiple PivotTables from the same source data. Note that the PivotTables 
must all be in the same workbook to use a single cache.
<P>
<P><h3>External Data Source</h3>
 
<P>
When you use the External Data Source option, there will effectively
be one copy of the source data in memory. Selecting this option in
conjunction with the Get Data button in Step 2 of the PivotTable
Wizard starts Microsoft Query. When you then return a query result
to Microsoft Excel, the data is stored in memory (cached) rather than
returned to a sheet. This constitutes one full copy of the source
data. Although Microsoft Query remains open until you are finished
with the PivotTable Wizard, only the records visible in the data grid
of Microsoft Query are stored in memory. This is often a small
percentage of the entire data source and it remains in memory only
temporarily until the PivotTable Wizard is closed.
<P>
<P><h2>PivotTable Wizard Step 4 - Save Data With Table Layout</h2>
 
<P>
The Save Data With Table Layout option in Step 4 of the PivotTable
Wizard affects the file size of your workbook as well as the time
required to save it and refresh a PivotTable after reloading it. This
option is selected by default; the benefits and tradeoffs for leaving
it selected and clearing it are further described below.
<P>
<P><h3>Selected (On)</h3>
 
<P>
When the Save Data With Table Layout option is selected (on), the
cached data used to create your PivotTable is saved when you save your 
workbook. This may increase the time required to save the workbook because 
more information is saved with it and the file size will be larger. 
However, when you reopen the workbook, the cached data is not loaded until 
you pivot, edit, or refresh an existing PivotTable or create a new one from 
the existing cache. This reserves memory until it is needed.
<P>
<P><h3>Cleared (Off)</h3>
 
<P>
When you clear this option (turn it off), the cached data is not saved
with your workbook. As a result, the amount of time necessary for
saving your file will decrease as will the file size. However, when
you reopen the workbook, you will have a static PivotTable that you
will need to update by choosing Refresh Data from the Data menu prior
to pivoting or editing the PivotTable. This command will recreate a copy of 
the cached data. This process is slower than saving the cache with the
workbook and having it load on demand.
<P>
Turning the option on means slower save time and larger file sizes;
turning the option off means slower refresh time when you reopen the
workbook and smaller file sizes. In either case, the actual time it
takes to open the file will be the same.
<P>
<PRE>     Action      Option On    Option Off
     -----------------------------------

     Saving      Longer       Shorter
     Opening     Same         Same
     Refreshing  Shorter      Longer
     File Size   Larger       Smaller
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 XL97 XL7 XL5<BR>
Keywords          : xlpivot xlquery kbtool<BR>
Version           : WINDOWS:5.0,7.0,97; MACINTOSH:5.0,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
