

<HTML>
<HEAD>
<TITLE>XL: Field Instead of Column Name in MSQUERY Returned to Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121551">
<META NAME="KBModify" CONTENT="1997/09/22">
<META NAME="KBCreate" CONTENT="1994/10/09">
<META NAME="Keywords" CONTENT="xlquery kbualink97 kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you return data from Microsoft Query by using the Get External Data command, or the PivotTable Wizard (using an external data source), any column heading that you have renamed in Microsoft Query displays with the original fie...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QBVP,QAUD,QAUJ,QDMF,QA7O,QA7N,QBVU,QAMB,QAPN,QAB9,QALW,QARM,QAPF,QAE1 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Field Instead of Column Name in MSQUERY Returned to Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121551</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00 97
WINDOWS
kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Query for Windows 95, version 2.0
<LI>Microsoft Query 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you return data from Microsoft Query by using the
Get External Data command, or the PivotTable Wizard (using an external data
source), any column heading that you have renamed in Microsoft Query
displays with the original field name, or as EXPR_x (where x is any number)
when you return the data to Microsoft Excel.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is by design of Microsoft Excel. When you return data from a
query in Microsoft Query to a worksheet, or to the PivotTable Wizard in
Microsoft Excel, the actual names of the columns in your query are used,
instead of the column headings. This is true whether the field heading is
based on a text value or an expression.
<P>
For example, if one of the columns is the sum of a field called Sales, the
column heading in Microsoft Query is Sum(Sales). If you change this heading
to a more descriptive name such as "Sales Totals", the heading displays
with the original name "Sum(Sales)" when you return the data to Microsoft
Excel.
<P>
If you build a query and return the results to the Pivot Table Wizard,
and a field name contains an expression, such as CUSTOMER + SALES, then
the field name is returned in the format EXPR_x, where x is any number.
For example, if two different columns in your query have names that
contain an expression, the first column name is returned as EXPR_1 and
the second as EXPR_2.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To work around this behavior, use one of the following methods:
<P>
<P><h3>Modifying SQL Statement</h3>
 
<P>
Note that you can use this workaround to return data either to a worksheet,
or to the PivotTable wizard.
<P>
Instead of using the Edit Column dialog box to rename a column, you can
modify the SQL SELECT statement using the AS clause which allows you to
return data to Microsoft Excel with any custom field heading you want.
<P>
This method creates a non-graphical query, meaning that only the data set
is displayed in Microsoft Query. When you run the SQL statement using the
AS clause, you receive the following error message in Microsoft Query.
<P>
<PRE>   SQL Query can't be represented graphically. Continue anyway?

</PRE>Use the following syntax for this type of SELECT statement:
<P>
<PRE>   SELECT &lt;field name&gt; AS "&lt;new field heading text&gt;" FROM
   &lt;table name&gt;

</PRE>The following example uses the Sales field example discussed above.

<OL><P><LI>In Microsoft Query, create the query that you want to return to
   Microsoft Excel.

<P><LI>On the View menu, click SQL.

<P><LI>In the SQL Statement box, modify the SELECT statement using the
   syntax provided above. For example, the following SQL statement
   selects all of the records from the Orders table and displays the
   order ID and sum of sales for each unique Order_Id:
<P>
<P><PRE>      SELECT Order_Id AS "ID", Sum(Sales) as "Sales Totals" FROM orders
</PRE><P>
</OL>Note that in the above example, the new field name "ID" does not require
quotation marks because it is a single word, however, it is recommended
that you place quotation marks around the new field heading to provide
consistent results.
<P>
<PRE>   4. Click OK to run the SQL statement.

</PRE></OL>In this example, the field headings are now displayed as ID, and Sales
Totals, instead of as Order_Id and Sum(Sales).
<P>
<P><h3>Worksheet</h3>
 
<P>
To work around this behavior when you return data in Microsoft Query to a
Microsoft Excel worksheet, do not include the field names when you return
the data to the worksheet. Then you can enter your own field names directly
on the worksheet. To avoid including field name, clear the Include Field
Names check box in the Get External Data dialog box that appears when you
return the data to Microsoft Excel.
<P>
<P><h3>Pivot Table</h3>
 
<P>
To rename a field in a Pivot Table, do the following:

<OL><P><LI>In the PivotTable Wizard - Step 3 of 4 dialog box, or in the pivot
   table on your worksheet, double-click the field name to display the
   PivotTable Field dialog box.

<P><LI>In the Name box, enter the new name for field, and choose OK.
<P>
</OL><h3>SQLExecQuery() Function in Visual Basic Module</h3>
 
<P>
<PRE>Sub UseAlias()
   Dim chan As Variant
   Dim result As Variant

   chan = sqlopen("Dsn=NWind")
   result = _
   SQLExecQuery(chan, "SELECT LAST_NAME as ""Last Name"" FROM
</PRE></OL>employee")
<P>
<PRE>   If IsError(result) Then
      MsgBox SQLError()(3)
   End If

   SQLRetrieve chan, ActiveCell, , , True
   SQLClose chan

End Sub


</PRE>Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about The Setup You Need To Retrieve Data With
Microsoft Query, choose the Search button in Help and type:
<P>
<PRE>   Query
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory: xlquery<BR>
Additional reference words: 1.00 2.00 5.00 5.00c 7.00 8.00 97 alias<BR>
wrong<BR>
Keywords          : xlquery kbualink97 kbtool<BR>
Version           : 5.00 5.00c 7.00 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
