

<HTML>
<HEAD>
<TITLE>XL97: Maximum Array Size in Microsoft Excel 97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166342">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/04/03">
<META NAME="Keywords" CONTENT="xlformula xlhelp kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, the  Worksheet and workbook specifications  Help topic states that the maximum size of an array in a worksheet is 6,553 elements. This information is incorrect. This article explains the limitations of arrays in Microsoft Exc...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB9,QAUD,QABN,QAL3,QAE1,QDNZ,QBVV,QAE5,QDMN,QAAP,QAI4 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Maximum Array Size in Microsoft Excel 97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166342</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel 97, the "Worksheet and workbook specifications" Help
topic states that the maximum size of an array in a worksheet is 6,553
elements. This information is incorrect. This article explains the
limitations of arrays in Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, arrays in worksheets are limited by available random
access memory and by the "entire column" rule.
<P>
<P><h3>Available Memory</h3>
 
<P>
Unlike earlier versions of Microsoft Excel, Microsoft Excel 97 does not
impose a limit on the size of worksheet arrays; you are limited only by the
amount of available memory on your computer. Because of this, you can
create very large arrays that contain hundreds of thousands of cells.
<P>
<P><h3>The "Entire Column" Rule</h3>
 
<P>
Although Microsoft Excel 97 allows you to create very large arrays, it does
not allow you to create an array that uses an entire column or multiple
columns of cells. This limitation is designed to prevent you from creating
an array that uses an entire column of cells. Because recalculating an
array formula that uses an entire column of cells (there 65,536 cells in a
column) is somewhat time consuming, Microsoft Excel 97 does not allow you
to create this kind of array in a formula.
<P>
<P><h3>Earlier Versions of Microsoft Excel</h3>
 
<P>
For more information about the limits of worksheet arrays in earlier
versions of Microsoft Excel, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q75376.htm">Q75376</A></B>
   TITLE     : XL: Maximum Array Size in Microsoft Excel

</PRE><h3>Array Formula Examples</h3>
 
<P>
The following is a list of array formula examples:
<P>
<PRE>   A1: =SUM(IF(B1:B65535=0,1,0))
   A2: =SUM(IF(B:B=0,1,0))
   A3: =SUM(IF(B1:J65535=0,1,0))
   A4: =SUM(IF(B:J=0,1,0))
   A5: =SUM(IF(B1:DD65535=0,1,0))

</PRE>NOTE: To use these examples, create a new workbook. Note that you must
enter each formula as an array formula. To do this, type the formula in the
formula bar, and then press CTRL+SHIFT+ENTER to enter the formula.
<P>
Array Formula Results:

<UL><LI>The formula in cell A1 returns the result 65535. This result is correct.

<LI>The formula in cell A2 returns a #NUM! error because the array formula
   refers to an entire column of cells.

<LI>The formula in cell A3 returns the result 589815. This result is
   correct.
<P>
   Note that the formula may take a long time to calculate the result
   because the formula is checking almost 600,000 cells.

<LI>Like the formula in cell A2, the formula in cell A4 returns a #NUM!
   error because the array formula refers to an entire column of cells.

<LI>When you enter the formula in cell A5, you may receive the following
   error messages:
<P>
<P><PRE>      Not enough memory.
      Continue without Undo?
</PRE><P>
<P><PRE>      -and-
</PRE><P>
<P><PRE>      Not enough memory.
</PRE><P>
   In this case, the size of the worksheet array is too large for available
   memory, and the formula cannot be calculated. Also, because your other
   formulas must recalculate their results, Microsoft Excel may appear to
   stop responding for a few minutes. After the results are recalculated,
   Microsoft Excel should respond normally. The formula in cell A5 returns
   the value 0 (zero).
<P>
</UL>Note that none of these formulas work in earlier versions of Microsoft
Excel because the worksheet arrays created by the formulas are all larger
than maximum limits in earlier versions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlformula xlhelp kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
