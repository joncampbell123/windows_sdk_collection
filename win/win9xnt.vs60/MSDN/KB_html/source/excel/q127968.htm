

<HTML>
<HEAD>
<TITLE>XL5: "File Format No Longer Supported" Using Macro Module </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127968">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1995/03/22">
<META NAME="Keywords" CONTENT="off offwin xlwin kb3rdparty kberrmsg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" WARNING: The information in this article has not been confirmed or tested by Microsoft. Some or all of the information in this article has been taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS AT...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA3P,QDL9,QBWO,QBWN,QBWQ,QDIY,QAC9,QAA1,QANE,QBS0,QDI2,QATF,QAH4,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: "File Format No Longer Supported" Using Macro Module</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127968</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows versions 5.0, 5.0c
<LI>Microsoft Project for Windows version 4.0
</UL> 
<P>
WARNING: The information in this article has not been confirmed or tested
by Microsoft. Some or all of the information in this article has been
taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION
PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this
information "as is" without warranty of any kind, either express or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the programs listed at the beginning of this article, when you open a
file that contains a Visual Basic for Applications module, insert a Visual
Basic module sheet into a workbook, or record a new macro using Microsoft
Visual Basic for Applications, you may receive the following error message:
<P>
<PRE>   File format is no longer supported

</PRE>This behavior may also occur in a Microsoft Excel workbook when you click
Get External Data on the Data menu.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior has been reported to occur when you install certain third-
party programs, and then open or create a new Visual Basic module sheet,
record a new macro, or attempt to retrieve external data.
<P>
This behavior has been reported to occur after installing the following
programs:

<UL><LI>Action
<LI>Artisoft Co-session (In-sync)
<LI>Borland C++
<LI>cc:Mail
<LI>Compton's Encyclopedia (on compact disc)
<LI>CPAV (on network)
<LI>Crystal Ball (add-in for Microsoft Excel)
<LI>Design CAD 3D for Windows
<LI>Internet Anywhere (installs a System32 directory)
<LI>JD Edwards Fianancial
<LI>Lawson (on network)
<LI>Lotus 1-2-3 Release 5 for Windows
<LI>Lotus Approach version 3.0
<LI>Lotus Notes Reporter for Windows 1.0
<LI>Microsoft Visual C++
<LI>Netscape Navigator versions 1.1, 1.1B2, and 2.0
<LI>Network MCI Business
<LI>Novell network environment (workstation running local Windows and
   shared Microsoft Excel 5.0)
<LI>Open Database Connectivity (ODBC) Software Development Kit (from
   The Developer Network)
<LI>Microsoft Office for Windows, version 4.3c-CD
<LI>SAS
<LI>Visio 3.0
<LI>Watermark Enterprise Edition
<LI>WordPerfect
<LI>WIN32s operating extension
<LI>WRQ3000
<P>
<P>
</UL>The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You may be able to work around this problem by decompressing or extracting
the original version of the Stdole.tlb file from the appropriate Microsoft
Excel 5.0, Office 4.2, or Office 4.3 disk to the Windows\System directory.
<P>
To decompress or extract the Stdole.tlb file, use the following
appropriate steps:
<P>
<P><h3>Microsoft Excel 5.0c</h3>
 
<P>
Use the Extract utility, Extract.exe, to manually extract the file from
the Microsoft Excel .cab file that is located on the appropriate Microsoft
Excel Setup disk.
<P>
The Stdole.tlb file is located on the following disks in the following
.cab files.
<P>
Microsoft Office:
<P>
The .cab files that contain Stdole.tlb are listed in the following table.
<P>
<PRE>   Version of Office    Disk format  Disk number     File
   -------------------------------------------------------------

   4.3                  DMF          23              Msoff23.cab
   4.3                  Non-DMF      32              Msoff32.cab
   4.2                  DMF          19              Msoff19.cab
   4.2                  Non-DMF      26              Msoff26.cab

</PRE>Microsoft Excel:
<P>
The .cab files that contain Stdole.tlb are listed in the following table.
<P>
<PRE>   Disk type     Disk number     File
   ----------------------------------------

   DMF           1               Excel1.cab
   3.5-inch      1               Excel1.cab
   5.25-inch     1               Excel1.cab
   720k          2               Excel2.cab

</PRE>To extract the file from the disk, use the following steps:

<OL><P><LI>Copy Extract.exe from Setup Disk 1 to the root directory on the local
   hard disk, or to a directory that is located in the PATH statement in
   the Autoexec.bat file.

<P><LI>Insert the Setup disk that contains the Stdole.tlb file in the
   floppy disk drive.

<P><LI>At the MS-DOS prompt, type the following:
<P>
<P><PRE>      extract /y &lt;drive&gt;:\&lt;directory&gt;\&lt;.cab file&gt; /L c:\&lt;windows&gt;\system\
      stdole.tlb
</PRE><P>
   where &lt;drive&gt; is the drive that contains the Setup Disk, &lt;.cab file&gt; is
   the .cab file that contains the Stdole.tlb file that you want to
   extract, and &lt;windows&gt; is the Microsoft Windows directory on drive C.
<P>
   Note that you can use the /y switch to overwrite the existing
   compressed file without prompting. The space before the file name is
   required to properly extract the new file and overwrite the existing
   file.
<P>
</OL><h3>Microsoft Excel 5.0</h3>
 
<P>
If you are using Microsoft Excel 5.0, use the Decomp utility, Decomp.exe,
to manually decompress the file from the appropriate Microsoft Excel Setup
disk. Decomp.exe is available on the Microsoft Excel Setup Disk 1.
<P>
The disks that contain Stdole.tlb are listed in the following table.
<P>
<PRE>   Disk type     Disk number
   -------------------------

   3.5-inch      7
   5.25-inch     9
   720k          9

</PRE></OL>To decompress the file, use the following steps:

<OL><P><LI>Copy Decomp.exe to the root directory of the local hard drive, or to a
   directory that is located in the PATH statement in the Autoexec.bat
   file.

<P><LI>Insert the Microsoft Excel Setup disk that contains the Stdole.tlb file
   in the disk drive.

<P><LI>If you are using the stand-alone version of Microsoft Excel, type the
   following command at the MS-DOS prompt and press ENTER:
<P>
<P><PRE>      decomp -f &lt;drive&gt;:\stdole.tl_ c:\windows\system\stdole.tlb
</PRE><P>
   where &lt;drive&gt; is the drive that contains the Microsoft Excel Setup disk
   that contains the (uncompressed) Stdole.tl_ file.
<P>
   You can use the -f switch to overwrite the existing uncompressed file
   without prompting.
<P>
   If you are using the version of Microsoft Excel that comes with
   Microsoft Office 4.3-CD, type the following command at the MS-DOS
   prompt and press ENTER:
<P>
<P><PRE>      extract /y d:\setup.adm\disk32\msoff32.cab /L c:\windows\system
      stdole.tlb
</PRE><P>
</OL>If you are running Windows from a shared directory on a network, you may
need to copy the Stdole.tlb file to any or all of the following
directories:
<P>
<PRE>   Windows\System (on the network)
   Windows (on the local computer)
   Windows\System (on the local computer; create it if it does not
   already exist)

</PRE></OL>In some cases, you may need to rename and extract Ole2conv.dll,
Ole2disp.dll, Ole2nls.dll, Compobj.dll, and Storage.dll to correct the
problem. You can find these files on the same disk that contains
Stdole.tlb. To extract the files, use the steps in this article.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c add-in solver solver.xla Object<BR>
library registered xl5 file format<BR>
Keywords          : off offwin xlwin kb3rdparty kberrmsg kbprb<BR>
Version           : 5.00 5.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
