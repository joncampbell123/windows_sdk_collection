

<HTML>
<HEAD>
<TITLE>Excel AppNote: Pentium Floating Point Unit Patch (WE1136) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123783">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1994/12/11">
<META NAME="Keywords" CONTENT="xlwin kb3rdparty kbappnote kbfile">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" The  Pentium Floating Point Unit (FPU) Patch  (WE1136) Application Note is now available from Microsoft Product Support Services (PSS). The WE1136 disk included with this application note contains a patch that you can use to test for a faulty FPU an...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAR4,QBDM,QANE,QAJH,QBFY,QAC9,QA9N,QAUD,QBC9,QBC8,QAY2,QANO,QAJ4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel AppNote: Pentium Floating Point Unit Patch (WE1136)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123783</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0, 5.0a, 5.0c
</UL> 
<P>
The "Pentium Floating Point Unit (FPU) Patch" (WE1136) Application Note
is now available from Microsoft Product Support Services (PSS). The WE1136
disk included with this application note contains a patch that you can use
to test for a faulty FPU and to disable the FPU in your computer when you
use Microsoft Excel.
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>The Microsoft Network (MSN)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft FastTips Technical Library
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note"
section at the end of this article.
<P>
<P><h2>THE TEXT OF WE1136</h2>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
          WE1136: PENTIUM(R) FLOATING POINT UNIT (FPU) PATCH
</PRE> 
<PRE>                                                  Revision Date: 12/94
                                                       1 Disk Included

</PRE>The following information applies to Microsoft Excel for Windows(TM),
version 4.0, 4.0a, 5.0, 5.0a, 5.0c.
<P>
<PRE> ---------------------------------------------------------------------
| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY     |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an Application |
| Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER      |
| EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED      |
| WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR       |
| PURPOSE. The user assumes the entire risk as to the accuracy and    |
| the use of this Application Note. This Application Note may be      |
| copied and distributed subject to the following conditions:  1) All |
| text must be copied without modification and all pages must be      |
| included;  2) If software is included, all files on the disk(s)     |
| must be copied without modification (the MS-DOS(R)  utility         |
| diskcopy is appropriate for this purpose);  3) All components of    |
| this Application Note must be distributed together;  and  4) This   |
| Application Note may not be distributed for profit.                 |
|                                                                     |
| Copyright (C) 1994 Microsoft Corporation.  All Rights Reserved.     |
| Microsoft and MS-DOS are registered trademarks and Windows and      |
| Windows NT are trademarks of Microsoft Corporation. Intel and       |
| Pentium are registered trademarks of Intel Corporation.             |
 ---------------------------------------------------------------------

</PRE><h3>Introduction</h3>
 
<P>
If you are using Microsoft Excel on a computer that contains an
Intel(R) Pentium processor, you may receive unexpected results when
you perform mathematical operations that involve dividing certain
combinations of numbers. This problem is caused by an error in the
FPU, a part of the Intel Pentium chip that performs elaborate
calculations. Intel is aware of this problem.
<P>
The disk included with this Application Note contains a patch for use
with Microsoft Excel for Windows version 4.0, 4.0a, 5.0, 5.0a, or
5.0c. The patch allows you to do the following:

<UL><LI>Test whether the FPU in your computer is faulty.

<LI>Prevent Microsoft Excel from using the built-in FPU.
<P>
</UL>After you install the patch, Microsoft Excel will handle all math
operations as though there were no FPU in your computer. Because the
FPU is disabled in Microsoft Excel, any calculation errors that you
received as a result of the FPU will be corrected.
<P>
<PRE>   NOTE: This patch works with Microsoft Excel versions 4.0, 4.0a,
   5.0, 5.0a, and 5.0c (including all non-English language versions).
   The patch does not work with Microsoft Excel version 5.0 for
   Windows NT(TM).

</PRE><h3>To copy the patch to your hard disk drive</h3>
 

<OL><P><LI>Quit Microsoft Excel.

<P><LI>Insert the enclosed WE1136 disk in your floppy disk drive.

<P><LI>At the MS-DOS prompt, type the following and press ENTER
<P>
<P><PRE>      copy &lt;drive&gt;:\p5patch.com &lt;destination&gt;
</PRE><P>
   where &lt;drive&gt; is the floppy disk drive containing the WE1136 disk
   and &lt;destination&gt; is your Microsoft Excel directory. For example,
   if the WE1136 disk is in drive A and your Microsoft Excel directory
   is C:\EXCEL, type the following command and press ENTER:
<P>
<P><PRE>      copy a:\p5patch.com c:\excel
</PRE><P>
</OL><h3>To test for a faulty FPU</h3>
 

<OL><P><LI>At the MS-DOS prompt, change to the drive that contains your
   Microsoft Excel directory. For example, if your Microsoft Excel
   directory is on drive C, type the following command and press
   ENTER:
<P>
<P><PRE>      c:
</PRE>
<P><LI>Change to your Microsoft Excel directory. For example, if your
   Microsoft Excel directory is C:\EXCEL, type the following and press
   ENTER:
<P>
<P><PRE>      cd \excel
</PRE>
<P><LI>Type the following and press ENTER to determine whether your
   Pentium computer has a faulty FPU:
<P>
<P><PRE>      p5patch
</PRE><P>
   The patch will return a message stating whether your Pentium
   computer has a faulty FPU.
<P>
</OL><h3>To run the Pentium FPU patch</h3>
 
<P>
At the MS-DOS prompt, type the following and press ENTER:
<P>
<PRE>   p5patch /p

</PRE></OL>NOTE: The FPU is now disabled for Microsoft Excel. If you want re-enable
the FPU for Microsoft Excel, you can remove the patch. To remove the patch,
type the following and press ENTER:
<P>
<PRE>      p5patch /u

</PRE><h3>To update the formulas on your worksheet</h3>
 
<P>
After you have installed the patch, do either of the following to
update the formulas on your worksheet:

<UL><LI>To force your entire worksheet to be recalculated, press
   CTRL+ALT+F9.
<P>
   -or-

<LI>To recalculate a single cell, or a range of cells on your
   worksheet, do the following:
<P>
   Note that the following method is not recommended if you are using
   array-type formulas. Replacing the equal sign (=) in such formulas
   will require that you re-enter any array formulas as arrays.
<P>
<P><PRE>    1. Select the cell, or cells, on the worksheet that you want to
       update.
</PRE><P>
<P><PRE>    2. In Microsoft Excel 5.0, choose Replace from the Edit menu. In
       Microsoft Excel version 4.0, choose Replace from the Formula
       menu.
</PRE><P>
<P><PRE>    3. In the Find What box, type =. In the Replace With box, type =.
       In Microsoft Excel version 5.0, clear the Find Entire Cells Only
       check box if it is selected. In Microsoft Excel version 4.0,
       under Look At, select the Part option.
</PRE><P>
<P><PRE>    4. To recalculate a single cell, choose the Replace button. To
       recalculate a range of cells, choose the Replace All button.
</PRE><P>
</UL> 
<P>
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
Note that the first three methods listed below are the quickest ways to
obtain the Pentium FPU Patch. The size of the file WE1136.EXE is
approximately 16K.
<P>
The following file(s) are available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/we1136.exe">WE1136.EXE</A> <I>(size: 16359 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>If you are unable to access the source(s) listed above, you can have this
Application Note mailed to you by calling Microsoft Product Support
Services Monday through Friday, 6:00 A.M. to 6:00 P.M. Pacific time at
(425) 635-7070. If you are outside the United States, contact the
Microsoft subsidiary for your area. To locate your subsidiary, see the
Microsoft World Wide Offices Web site at:
<P>
<PRE>   <B><A href="http://www.microsoft.com/worldwide/default.htm">http://www.microsoft.com/worldwide/default.htm</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.00a 5.00 5.00a 5.00c p5 numeric<BR>
coprocessor co-processor processor floating-point math<BR>
Keywords          : xlwin kb3rdparty kbappnote kbfile<BR>
Version           : 4.00 4.00a 5.00 5.00a 5.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
