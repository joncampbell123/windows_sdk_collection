

<HTML>
<HEAD>
<TITLE>XL: Unexpected Results/Error Using SELECT() with Chart Series </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114520">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1994/05/05">
<META NAME="Keywords" CONTENT="kbcode">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel versions 5.x and 7.0, when you use the SELECT() function in a Microsoft Excel 4.0 macro sheet to select a series on a chart, you may receive either an error message or unexpected results when you run the macro.  CAUSE =====  When...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAA7,QA2Q,QBS0,QAG2,QAH4,QBWS,QAB9,QAY5,QBXT,QBV8,QA5V,QAIB,QAPF,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Unexpected Results/Error Using SELECT() with Chart Series</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114520</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel versions 5.x and 7.0, when you use the SELECT() function
in a Microsoft Excel 4.0 macro sheet to select a series on a chart, you
may receive either an error message or unexpected results when you
run the macro.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you use the SELECT() function to select a chart series, for
example SELECT("S1"), the series number is the order in which the
series data appears on the supporting worksheet, not necessarily the
series order that you have given the series data.
<P>
For example, if you create a chart with data series in columns A
through C on a worksheet, and you use the command SELECT("S1")
function in a macro to select the first series on the chart, the
series created from column A is selected, even if you have changed
the series order so that the series in column A is actually the third
series.
<P>
This behavior is different from earlier versions of Microsoft
Excel: in Microsoft Excel version 4.0 and earlier, when you use the
SELECT() command to select a series on a chart, the series order is
used.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you are writing a macro that you need to run in Microsoft Excel
versions 4.0, 5.0, and 7.0, and the syntax that you need to use depends on
the version in which the macro is running. You can use the GET.WORKSPACE()
function to determine the version, and then use the appropriate syntax as
in the following example:
<P>
<PRE>   =IF(GET.WORKSPACE(2)&lt;5, SELECT("S1"), SELECT("S4"))

</PRE>Because the GET.WORKSPACE(2) command returns the version of Microsoft
Excel that you are running, you can use this to take the appropriate
action. In the above macro command, if the version of Microsoft Excel
is less than 5.0, the first series is selected, otherwise, the fourth
series is selected.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Note that if you use the SeriesCollection method with the Select
method in a Visual Basic macro, the series with the series order
number that you specify is returned. For example, the following macro
selects series one on the active chart.
<P>
<PRE>   ActiveChart.SeriesCollection(1).Select

</PRE>Microsoft provides examples of Visual Basic procedures for
illustration only, without warranty either expressed or implied,
including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose. This Visual
Basic procedure is provided 'as is' and Microsoft does not guarantee
that it can be used in all situations. Microsoft does not support
modifications of this procedure to suit customer requirements for a
particular purpose. Note that a line that is preceded by an
apostrophe introduces a comment in the code--comments are provided to
explain what the code is doing at a particular point in the
procedure. Note also that an underscore character (_) indicates that
code continues from one line to the next. You can type lines that
contain this character as one logical line or you can divide the
lines of code and include the line continuation character. For more
information about Visual Basic for Applications programming style,
see the "Programming Style in This Manual" section in the "Document
Conventions" section of the "Visual Basic User's Guide."
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about SELECT, choose the Search button in
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>    SELECT function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbcode<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 5.00c 7.00 PATTERN()
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
