

<HTML>
<HEAD>
<TITLE>XL5: GET.DOCUMENT(4) Returns FALSE After FOR.CELL Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118654">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/07/26">
<META NAME="Keywords" CONTENT="fixlist5.00c kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you use the FOR.CELL() macro function, and you then use the GET.DOCUMENT(4) function without the name_text argument, or with a workbook name, to return a value indicating whether changes have been made to the workbook since y...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QAUD,QBV8,QBVP,QAB9,QAH4,QAXC,QAML,QBVV,QALW,QAUR,QAL2,QAKD,QDNM,QAU7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: GET.DOCUMENT(4) Returns FALSE After FOR.CELL Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118654</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you use the FOR.CELL() macro function, and you
then use the GET.DOCUMENT(4) function without the name_text argument, or
with a workbook name, to return a value indicating whether changes have
been made to the workbook since you saved it last, the value returned by
this function is FALSE.
<P>
<P><h2>CAUSE</h2>
 
<P>
If the name_text argument of the GET.DOCUMENT function is omitted, it is
assumed to be the active document. However, when you use the
GET.DOCUMENT(4) function without the name_text argument, or with the
workbook name, following the FOR.CELL function, FALSE is returned even when
you have made changes to the workbook.
<P>
This behavior occurs only if the macro that contains the FOR.CELL()
function does not make changes to the workbook. For example, if you
save changes to your workbook, and then run the macro that contains
the FOR.CELL function, the GET.DOCUMENT(4) function should return the
value FALSE, because you have not made changes to the workbook since
you saved it last. However, if you then make changes to a worksheet
in the workbook, and run the FOR.CELL function again, the
GET.DOCMENT(4) function returns FALSE, even though you have made
changes to the workbook.
<P>
This behavior occurs because when you use the FOR.CELL() function, in the
process of naming the cell that the function is currently using, the macro
sheet is marked as having changes and is then marked as not having changes.
However, when the macro sheet is marked as not having any changes (when the
function has ended), the workbook is also incorrectly marked as not having
any changes.
<P>
Note that if you make a change to the macro sheet that contains the
FOR.CELL() function, the GET.DOCUMENT(4) function returns the value
TRUE.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about GET.DOCUMENT, choose the Search button in
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>   GET.DOCUMENT function

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 dirty clean
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
