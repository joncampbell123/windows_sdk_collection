

<HTML>
<HEAD>
<TITLE>Excel: Custom Dialog Box Must Have Default Button </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q50095 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/10/20">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QBVP,QABA,QAD7,QAUD,QANX,QAJQ,QA5D,QAPN,QAGB,QDKS,QAJD,QAGC,QBSO,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Custom Dialog Box Must Have Default Button</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q50095 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
When you press the RETURN key (on the main keyboard) in a custom
dialog box that has no default buttons but has a nondefault OK or
Cancel button, Microsoft Excel versions 2.20 and 3.00 close the dialog
box.
<P>
In Excel version 1.50, the same dialog box remains open. Excel 2.20
and 3.00 use the Standard Dialog Manager (SDM), which does not support
dialog boxes not being dismissed when RETURN or ENTER (on the numeric
keypad) is pressed.
<P>
The following method achieves the same effect as Excel 1.50:

<OL><P><LI>Add a line to the dialog box definition table with a default OK
   button. This can be made to have zero height and width to hide the
   button.
<P>
   To do this in the Dialog Editor, create a default OK button. Then
   copy this dialog into your macro sheet. This should appear similar
   to the example below:
<P>
<PRE>         A      B       C       D       E       F
       -------------------------------------------
      |     |       |       |       |       |
      |  1  |       |       |  0    |  0    | &lt;-- (Default OK button)
      |  3  |       |       |       |       |  OK
      |  2  |       |       |       |       |  Cancel
      |  5  |       |       |       |       |  Static Text

   Note: Make sure that the fourth (height) and fifth (width) columns
   of the dialog box definition table for the default OK button
   contain 0 (zero). This makes the default OK button invisible.

</PRE><P><LI>Enter your DIALOG.BOX statement, as follows:
<P>
<P><PRE>       =IF(DIALOG.BOX(dbox)=1,GOTO(ref))
</PRE><P>
   "dbox" refers to the range of the dialog box definition table.
   "ref" refers to the cell containing the IF statement. For example,
   if the IF statement is located in cell A1 of the macro sheet, the
   GOTO statement should read GOTO(A1).
<P>
</OL>Note: The dialog box definition table must contain seven columns.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 1.50 2.20 3.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
