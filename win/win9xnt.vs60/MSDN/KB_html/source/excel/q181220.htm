

<HTML>
<HEAD>
<TITLE>XL98: How to Use Natural Language Formulas in MS Excel 98 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181220">
<META NAME="KBModify" CONTENT="1998/02/18">
<META NAME="KBCreate" CONTENT="1998/02/17">
<META NAME="Keywords" CONTENT="xlformula xllist kbdta">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel 98 Macintosh Edition introduces natural language formulas, which allow you to refer to a cell range in a table by using row or column labels as the reference name. Natural language formulas use the intersection feature that is avail...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAC2,QBVP,QDO8,QAVS,QAB9,QDNZ,QAUJ,QDMR,QAPF,QBJZ,QDMF,QAMY,QDO5,QADK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: How to Use Natural Language Formulas in MS Excel 98</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181220</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel 98 Macintosh Edition introduces natural language formulas,
which allow you to refer to a cell range in a table by using row or
column labels as the reference name. Natural language formulas use the
intersection feature that is available in earlier versions of Microsoft
Excel.
<P>
NOTE: This feature is available by default. To find this feature, click
Preferences on the Tools menu and click the Calculation tab. You can turn
the feature on or off by selecting or clearing the Accept Labels In
Formulas option.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To refer to an intersection in earlier versions of Excel, you must know
the ranges of cells, or you must define range names for the cells before
you refer to the range. If the ranges change, you must also update the
formulas and defined names.
<P>
When you use natural language formulas in Excel 98, it's no longer
necessary to create defined names or determine the cell ranges in advance.
Excel 98 determines the range based on the row and column labels that you
provide in the table on the worksheet. For example, in the following table,
the formula returns the value 100 for "Product A" in the "First Quarter":
<P>
<PRE>   = Product A First Quarter

   A1:              B1: First Quarter  C1: Second Quarter
   A2: Product A    B2: 100            C2: 50
   A3: Product B    B3: 110            C3: 60
   A4: Product C    B4: 120            C4: 70

</PRE><h3>Rules for Labels</h3>
 
<P>
Natural language formulas analyze the row and column headings of all tables
in the current worksheet to determine the validity of the labels. In most
cases, you can use any string as a label. However, there are some
guidelines to follow, including the following:

<UL><LI>You can use any letter of the alphabet, a backslash, or an underscore
   as the starting character.

<LI>You cannot use labels that consist solely of the international decimal
   point, the plus sign, the minus sign, or the letter "e."

<LI>You cannot use labels that appear to be cell references, for example,
   you cannot use "FY97."
<P>
   You can use any string of characters if the string is enclosed in
   apostrophes (single quotation marks). For example, if you want to use
   the following string
<P>
<P><PRE>      =FY97
</PRE><P>
   type the following:
<P>
<P><PRE>      ='FY97'
</PRE>
<LI>Excel ignores leading and trailing spaces in labels.
<P>
   However, spaces are allowed between characters in labels; for example,
   you can use "Tax Rate."

<LI>You can use a number as a label if the number is between 1,900 and
   9,999.

<LI>You can use a date as a label if it uses a built-in date format that
   contains a day; for example, you can use "12/3/96" or "Dec-3-96."

<LI>You cannot use a label that appears to be a function; for example, you
   cannot use "Sum()" or "Average()."

<LI>You cannot use a natural language formula in an array formula.

<LI>If Excel finds both a label and a defined name, the defined name takes
   precedence over the label.
<P>
   To use a reference as a label, enclose the reference in apostrophes
   (single quotation marks).
<P>
   For example, if a defined name called "Sales" exists, and you use the
   formula "=Sales Software," the formula references the defined name.
   However, if you type the following formula
<P>
<P><PRE>      ='Sales' Software
</PRE><P>
   the range referenced by the row or column label is always used.

<LI>If multiple tables on the same worksheet contain identical labels,
   the table Excel uses is determined by the location of the cell that
   contains the formula. In general, the table that is referenced is to
   the left or above the cell that contains the formula.
<P>
   For example, if a worksheet contains a table in cells A1:E10 and a table
   in cells A15:E25, if you type a formula in cell A30, Excel uses the
   labels in the table in cells A15:E25. However, if you type the same
   formula in cell A12, Excel uses the first table in cells A1:E10. If
   Excel cannot determine which table you are referring, it displays the
   Identify Label dialog box. This dialog box prompts you to select the
   cell that contains the label you want to use.
<P>
</UL><h3>Stacked Column Labels</h3>
 
<P>
Tables may contain more than one column or row label heading. You can
create natural language formulas that refer to multiple headings. To do
this, type a space between each of the labels in the formula. The following
sample table and formula use a stacked column label in a formula.
<P>
<PRE>   A1:        B1: 1995   C1:        D1: 1996   E1:
   A2:        B2: North  C2: South  D2: North  E2: South
   A3: Jan    B3: 100    C3: 50     D3: 200    E3: 70
   A4: Feb    B4: 105    C4: 60     D4: 205    E4: 80
   A5: Mar    B5: 110    C5: 70     D5: 210    E5: 90

</PRE>The following formula returns the value 105 for the region "North" in
the year 1995 for the month of February:
<P>
<PRE>   =1995 North Feb

</PRE>NOTE: Cells B1:C1 and D1:E1 in the table are merged. To merge cells, select
the range and click Merge And Center on the Formatting toolbar.
<P>
<P><h3>Error Values</h3>
 
<P>
#NAME?:
<P>
The #NAME? error means that Excel cannot determine the label.
<P>
For example, in the formula "=First Quarter Sales," Excel searches for
the label "First Quarter Sales." If no matching label is found, Excel
searches for the label "First Quarter." If no label is found, Excel
searches defined names. The #NAME? error is returned if all the searches
fail to find the label.
<P>
#NULL!:
<P>
The #NULL! error means that the label is valid but does not refer to a
valid intersection.
<P>
For example, in the formula "=First Quarter Sales," if the label "'First
Quarter'" refers to the range A1:A10, and the label "'Sales'" refers to the
range B5:E5, the ranges do not intersect.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about natural language formulas, click Contents And
Index on the Help menu (or on the Balloon Help menu if you are using a
version of the Macintosh operating system earlier than 8.0), click the
Index button in Microsoft Excel Help, type the following text
<P>
<PRE>   formula, names

</PRE>and then click Show Topics. Select the "About labels and names in formulas"
topic, and click Go To. If you are unable to find the information you need,
ask the Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98 8.00 NLF ELF<BR>
Keywords          : xlformula xllist kbdta<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
