

<HTML>
<HEAD>
<TITLE>XL: "Reference Not Valid" Error When You Create PivotTable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177169">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1997/11/21">
<META NAME="Keywords" CONTENT="xlpivot kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, if you click PivotTable Report on the Data menu, and then click Next to proceed to step 2 of the PivotTable Wizard, the Range reference box may contain the word  Database. ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBVU,QAUJ,QAZV,QBWS,QAYY,QAIK,QBVV,QAB4,QARM,QAKP,QAGB,QADR,QDKW,QBQU P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "Reference Not Valid" Error When You Create PivotTable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177169</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article,
if you click PivotTable Report on the Data menu, and then click Next to
proceed to step 2 of the PivotTable Wizard, the Range reference box may
contain the word "Database."
<P>
If you click Next, you may receive the following error message:
<P>
<PRE>   Reference is not valid.

</PRE><h2>CAUSE</h2>
 
<P>
This problem may occur if the following conditions are true:

<UL><LI>You display the data form in Microsoft Excel by clicking Form
   on the Data menu.
<P>
<P><PRE>    -and-
</PRE>
<LI>You create the PivotTable in the same worksheet in which you
   previously displayed the data form.
<P>
</UL>Specifically, when you display the data form, Microsoft Excel creates an
invisible name called "Database." This invisible name is automatically
detected by the PivotTable Wizard. However, the PivotTable Wizard cannot
correctly use this invisible name; this name is used only by the data form.
<P>
NOTE: This problem does not occur in earlier versions of Microsoft Excel.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, select the range for the list that you want to
use in the PivotTable, and then click Next.
<P>
Or, delete the invisible name Database by following these steps:

<OL><P><LI>Select any cell in the worksheet.

<P><LI>Point to Name on the Insert menu, and then click Define.

<P><LI>In the Names In Workbook box, type "Database" (without the quotation
   marks). Then, click Add.

<P><LI>Click Delete. Then, click Close.
<P>
</OL>If you create a PivotTable, the Database name does not appear in step 2 of
the wizard.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the data form in Microsoft Excel to see, change, add, delete,
and find records in a list or database. To use the data form, select any
cell in a list or database, and then click Form on the Data menu.
<P>
Normally, if the "Database" defined name exists in a worksheet, the
PivotTable Wizard correctly uses the range of cells referenced by the
defined name. However, if "Database" the name was created by the data form,
the name cannot be used by the PivotTable Wizard.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 pivot tables<BR>
Keywords          : xlpivot kberrmsg<BR>
Version           : WINDOWS:97; MACINTOSH:98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
