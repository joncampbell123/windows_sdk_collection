

<HTML>
<HEAD>
<TITLE>Excel: Ranking Number Range with Array Formula </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q65398 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1990/08/30">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, version 4.0, use the RANK function to rank a range of numbers according to their numerical value. To rank the numbers from small to large, where the small number is the first in rank, use the following function:     =RANK(firstc...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDMR,QAKD,QAKC,QAUD,QDNZ,QAB9,QBDO,QBC6,QA5V,QAG8,QAY2,QAJB,QAMN,QAB6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Ranking Number Range with Array Formula</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q65398 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0
<LI>Microsoft Excel for the Macintosh, versions 1.x, 2.2, 3.0, 4.0
<LI>Microsoft Excel for OS/2, versions 2.2 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, version 4.0, use the RANK function to rank a range of
numbers according to their numerical value. To rank the numbers from small
to large, where the small number is the first in rank, use the following
function:
<P>
<PRE>   =RANK(firstcell,range,-1)

</PRE>To rank them from large to small, use the following function:
<P>
<PRE>   =RANK(firstcell,range)

</PRE>In Microsoft Excel versions prior to 4.0, to rank a range of numbers
according to their numerical value from small to large or large to small,
use one of the following array formulas, where "range" is the range of
numbers to be ranked and "firstcell" is the first cell in "range":
<P>
<PRE>   =ROWS(range)-SUM(IF(range&gt;=firstcell,1,0))+1
      (to rank from small to large)

   =ROWS(range)-SUM(IF(range&gt;firstcell,0,1))+1
      (to rank from large to small)

</PRE>To enter the formula, do the following:

<OL><P><LI>Type the formula into a cell that is adjacent to "range."

<P><LI>Press COMMAND+ENTER (in Microsoft Excel for the Macintosh) or
   CONTROL+SHIFT+ENTER (in Microsoft Excel for Windows) to enter the
   formula as an array.

<P><LI>Select the cell with the entered formula along with the same number of
   empty cells that are present in "range." For example, if "range" is A1
   through A5, select B1 through B5, where B1 contains the formula.

<P><LI>From the Edit menu, choose the Fill command appropriate for your
   row or column direction.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The following formulas will return the correct ranking of the numbers in
cells $A$1:$A$5 (the braces {} indicate that the formula was entered as an
array by pressing COMMAND+ENTER in Microsoft Excel for the Macintosh or
CONTROL+SHIFT+ENTER in Microsoft Excel for Windows:
<P>
<PRE>   A1:  50   B1: {=ROWS($A$1:$A$5)-SUM(IF($A$1:$A$5&gt;=A1,1,0))+1}
   A2:  12   B2: {=ROWS($A$1:$A$5)-SUM(IF($A$1:$A$5&gt;=A2,1,0))+1}
   A3:  42   B3: {=ROWS($A$1:$A$5)-SUM(IF($A$1:$A$5&gt;=A3,1,0))+1}
   A4:  31   B4: {=ROWS($A$1:$A$5)-SUM(IF($A$1:$A$5&gt;=A4,1,0))+1}
   A5:   1   B5: {=ROWS($A$1:$A$5)-SUM(IF($A$1:$A$5&gt;=A5,1,0))+1}

</PRE></OL>The values that are returned from the above formulas are as follows:
<P>
<PRE>   A1: 50    B1: 5
   A2: 12    B2: 2
   A3: 42    B3: 4
   A4: 31    B4: 3
   A5:  1    B5: 1
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 1.0 1.00 1.03 1.04 1.06 1.5 1.50 2.0 2.00 2.01<BR>
2.2 2.20 2.21 3.0 3.00 4.0 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
