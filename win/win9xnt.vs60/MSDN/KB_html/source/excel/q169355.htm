

<HTML>
<HEAD>
<TITLE>XL97: Using the MailLogon Method in Microsoft Excel 97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169355">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/05/30">
<META NAME="Keywords" CONTENT="xlhelp xlvbahowto xlvbainfo kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article describes the correct way to use the Visual Basic for Applications MailLogon method in Microsoft Excel 97. It also lists possible problems that you may encounter when you use this method to establish a mail session in Microsoft Excel 9...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBVP,QBS0,QAYC,QAUJ,QDJ2,QAH4,QAB4,QAHE,QBVV,QBFM,QAPF,QAGI,QBXS,QAR4 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Using the MailLogon Method in Microsoft Excel 97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169355</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes the correct way to use the Visual Basic for
Applications MailLogon method in Microsoft Excel 97. It also lists possible
problems that you may encounter when you use this method to establish a
mail session in Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
<P><h3>Using the MailLogon Method</h3>
 
<P>
To properly use the MailLogon method, specify a valid Name argument. For
example, if a mail profile called "John Q. Public" exists on your computer,
the following line of code is valid:
<P>
<PRE>   Application.MailLogon "John Q. Public"

</PRE><h3>Using the MailLogon Method Improperly</h3>
 
<P>
If you do not specify a Name argument in the MailLogon command, for
example, if you use the following line of code
<P>
<PRE>   Application.MailLogon

</PRE>the Choose Profile dialog box may appear and request that you choose a mail
profile. This may be a problem if you want to run the macro without
supervision; if this is the case, specify a valid Name argument.
<P>
If the MailLogon command specifies an invalid Name argument, for example,
if you use the following line of code
<P>
<PRE>   Application.MailLogon "N. O. Body"

</PRE>you may receive the following error message:
<P>
<PRE>   Microsoft Exchange
   The profile name is not valid. Enter a valid profile name.

</PRE>When you click OK, the Choose Profile dialog box is displayed.
<P>
If you click Cancel in either the Choose Profile dialog box or the "Profile
name is not valid" error message dialog box, you receive the following
error message
<P>
<PRE>   Run-time error '1004':
   Method 'MailLogon' of object '_Application' failed

</PRE>and the macro halts.
<P>
<P><h3>Using the Password and DownloadNewMail Arguments</h3>
 
<P>
These arguments are optional; you only need to include them if your mail is
protected by a password or if you want to download new mail messages
immediately. Note that the Password argument is ignored if you are using
Microsoft Exchange or Microsoft Outlook 97.
<P>
<P><h3>Help Information for the MailLogon Method</h3>
 
<P>
The Microsoft Excel Visual Basic Help topic for the MailLogon method states
the following:
<P>
<PRE>   Name  Optional Variant. The mail account name of Microsoft Exchange
   profile name. If this argument is omitted, the default mail account
   name is used.

</PRE>This statement is not entirely correct. If you omit the Name argument from
the MailLogon method, the Choose Profile dialog box may appear and request
that you choose a mail profile.
<P>
For an example of the correct way to use the MailLogon method, see the
MailLogon Method example; the Name, Password, and DownloadNewMail arguments
are all present and valid.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 mapi microsoft mail<BR>
Keywords          : xlhelp xlvbahowto xlvbainfo kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
