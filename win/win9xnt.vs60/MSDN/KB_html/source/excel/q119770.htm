

<HTML>
<HEAD>
<TITLE>XL: Text Import Wizard Maximum Row Limitation of 32767 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119770">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1994/08/23">
<META NAME="Keywords" CONTENT="xlloadsave kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you specify a number in the Start Import At Row box in the Text Import Wizard, and the beginning row number that you specify is a value greater than 32767, you may receive the following error message.     In Microsoft Excel v...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA5V,QBVP,QAMB,QATX,QBWS,QAUR,QAIJ,QAY4,QAEQ,QAIK,QBJQ,QDNM P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Text Import Wizard Maximum Row Limitation of 32767</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119770</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00 7.00a 97
WINDOWS
kbother
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0, 7.0a
<LI>Microsoft Excel 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you specify a number in the Start Import At Row box
in the Text Import Wizard, and the beginning row number that you specify is
a value greater than 32767, you may receive the following error message.
<P>
<PRE>   In Microsoft Excel versions 5.x and 7.x:

      Number is not valid.

   In Microsoft Excel 97:

      Your entry cannot be used. An integer or decimal number may be
      required.

</PRE><h2>WORKAROUNDS</h2>
 
<P>
To work around this problem, follow the appropriate procedure below for
your version of Microsoft Excel.
<P>
<P><h3>Versions 5.x and 7.x -- Importing Text Files with Fewer than 49,151 Rows</h3>
 
<P>
The maximum number of rows in a Microsoft Excel 5.0 or 7.0 worksheet is
16,384. If you open a text file with 16,384 rows or fewer, all rows of the
text file will be imported into one worksheet. However, if you attempt to
import more rows in a text file than are available in the worksheet, only
16,384 rows of the text file will be loaded, and you will receive the
following error:
<P>
<PRE>     File Not Loaded Completely

</PRE>If your worksheet contains more than 16,384 but fewer than 49,151 rows,
you can use the Text Import Wizard to import the text file into multiple
worksheets using the following steps:

<OL><P><LI>Click Open on the File menu, select the text file to open, and click OK.

<P><LI>In the Text Import Wizard, select 1 for "Start Import at Row" and click
   Finish.

<P><LI>The first 16,384 rows of the text file are imported into a worksheet,
   and you receive the error "File Not Loaded Completely." Click OK. Save
   this workbook.

<P><LI>Repeat step 1. In the Text Import Wizard, select 16385 for "Start Import
   at Row," and click Finish.

<P><LI>The next 16,384 rows of the text file are imported into a worksheet, and
   you receive the error "File Not Loaded Completely" (if the text file
   contains more than 32,768 rows). Click OK. Save this workbook.

<P><LI>Repeat step 1. In the Text Import Wizard select 32767 for "Start Import
   at Row," and click Finish.

<P><LI>The last 16,384 rows of the text file are imported into a worksheet.

<P><LI>You can delete the first two rows in this workbook because these rows
   were also imported into the workbook you saved in step 5. Save this
   workbook.
<P>
</OL><h3>Version 97 -- Importing Text Files with Fewer than 98,303 Rows</h3>
 
<P>
The maximum number of rows in a Microsoft Excel 97 worksheet is 65,536. If
you open a text file with 65,536 rows or fewer, all rows of the text file
will be imported into one worksheet. However, if you attempt to import more
rows in a text file than are available in the worksheet, only 65,536 rows
of the text file will be loaded, and you will receive the following error:
<P>
<PRE>     File Not Loaded Completely

</PRE></OL>If your worksheet contains more than 65,536 but fewer than 98,303 rows,
you can use the Text Import Wizard to import the text file into multiple
worksheets using the following steps:

<OL><P><LI>Click Open on the File menu, select the text file to open, and click OK.

<P><LI>In the Text Import Wizard, select 1 for "Start Import at Row," and click
   Finish.

<P><LI>The first 65,536 rows of the text file are imported into a worksheet,
   and you receive the error "File Not Loaded Completely". Click OK. Save
   this workbook.

<P><LI>Repeat step 1. In the Text Import Wizard, select 32767 for "Start Import
   at Row," and click Finish.

<P><LI>Note that 65,536 rows of the text file starting at row 32766 are
   imported into a worksheet. Save this workbook.

<P><LI>You can delete the first 32,770 rows in this workbook because these rows
   were also imported into the workbook you saved in step 5. Save this
   workbook.
<P>
</OL><h3>Importing Larger Text Files</h3>
 
<P>
If your text file is too large to import using the Text Import Wizard as
described earlier, you will need to create a macro to import your text file
that determines the size of the text file and breaks it up into individual
worksheets.
<P>
For an example of a Visual Basic for Applications macro that accomplishes
this, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q120596.htm">Q120596</A></B>
   TITLE     : "XL: Importing Text Files Larger Than 16384 Rows"
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory: xlloadsave
<P>

Additional reference words: xl97 7.00a 7.00 5.00 5.00c<BR>
Keywords            : xlloadsave kbother<BR>
Version             : 5.00 5.00c 7.00 7.00a 97<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
