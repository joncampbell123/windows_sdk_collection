

<HTML>
<HEAD>
<TITLE>XL: How to Use DAO to Append the Records in Two Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141686">
<META NAME="KBModify" CONTENT="1997/02/26">
<META NAME="KBCreate" CONTENT="1995/12/21">
<META NAME="Keywords" CONTENT="xldao xlwin kbhowto kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article, you can use DAO (Data Access Objects) to manipulate data in external databases. This article provides a macro example that demonstrates how you can append the records from ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDNF,QBS0,QAPN,QA1S,QBWS,QAH4,QA2Q,QAL3,QABH,QA6A,QA5V,QAW6,QABM,QDN9 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Use DAO to Append the Records in Two Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141686</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00 97
WINDOWS
kbusage kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this
article, you can use DAO (Data Access Objects) to manipulate data in
external databases. This article provides a macro example that
demonstrates how you can append the records from two different tables
using DAO commands.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures
for illustration only, without warranty either expressed or implied,
including, but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. The Visual Basic procedures in
this article are provided 'as is' and Microsoft does not guarantee that
they can be used in all situations. While Microsoft support engineers
can help explain the functionality of a particular macro, they will not
modify these examples to provide added functionality, nor will they
help you construct macros to meet your specific needs. If you have
limited programming experience, you may want to consult one of the
Microsoft Solution Providers. Solution Providers offer a wide range of
fee-based services, including creating custom macros. For more
information about Microsoft Solution Providers, call Microsoft Customer
Information Service at (800) 426-9400.
<P>
WARNING: Your use or modification of the SQL statement provided in this
article is at your own risk. Microsoft provides this SQL statement "as
is" without warranty of any kind, either expressed or implied,
including but not limited to the implied warranties of merchantability
and/or fitness for a particular purpose. Microsoft does not support
modifications of the SQL statement to suit specific customer
requirements.
<P>
You can merge the results of two or more queries, tables, and SELECT
statements in a single UNION operation. The following example
demonstrates how you can use the UNION operation to append two tables:
<P>
<PRE>Sub AppendTables()

</PRE>Dim db As Database
Dim Results As Recordset
Dim i As Integer
<P>
<PRE>   'Open the dBASE IV database
   Set db = OpenDatabase("c:\my documents", False, False, "dBASE IV;")

   'Create a recordset that is a union of the January table
   'and the February Table
   Set Results = _
      db.OpenRecordset("Select * from January" &amp; _
        "UNION Select * from February")

   'Return the column headers to the first row of Sheet1
    For i = 0 To Results.Fields.Count - 1
      Sheets("Sheet1").Range("A1").Offset(, i) = Results.Fields(i).Name
    Next

   'Return the recordset results to Sheet1
   Sheets("Sheet1").Range("a2").CopyFromRecordset Results

   db.Close

End Sub

</PRE>If the January and February tables used in the AppendTables macro
appear as in the following tables
<P>
<PRE>   January.DBF                         February.DBF
   ------------------------            ------------------------

   DATE      QTY     AMOUNT            DATE      QTY     AMOUNT
   1/3/95     1      66.99             2/6/95     6      44.91
   1/5/95     6      59.11             2/9/95     7      19.13
   1/8/95     4       2.80             2/10/95    2      20.56
   1/8/95     3      11.12             2/10/95    3      69.94
   1/9/95     2      49.71             2/11/95    8      71.67
   1/15/95    3      59.76             2/19/95    1      93.61
   1/23/95    7      93.32             2/24/95    4      57.76
   1/23/95    8      90.96             2/26/95    3      98.13

</PRE>the results returned to Sheet1 using the macro are as follows
<P>
<PRE>   DATE      QTY     AMOUNT
   1/3/95     1      66.99
   1/5/95     6      59.11
   1/8/95     4       2.80
   1/8/95     3      11.12
   1/9/95     2      49.71
   1/15/95    3      59.76
   1/23/95    7      93.32
   1/23/95    8      90.96
   2/6/95     6      44.91
   2/9/95     7      19.13
   2/10/95    2      20.56
   2/10/95    3      69.94
   2/11/95    8      71.67
   2/19/95    1      93.61
   2/24/95    4      57.76
   2/26/95    3      98.13

</PRE>To use the Data Access Object commands in a Microsoft Excel Visual
Basic for Applications macro, the DAO library must be referenced. To
reference the DAO library use the following steps:

<OL><P><LI>Activate the module sheet containing the macro.

<P><LI>On the Tools menu, click References.

<P><LI>In Microsoft Excel 97, select the Microsoft DAO 3.5 Object Library
   check box or in Microsoft Excel version 7.0, select the Microsoft
   DAO 3.0 Object Library check box, and then click OK.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about DAO, click the Index tab in Microsoft Excel
97 Visual Basic Help, type the following text
<P>
<PRE>   DAO, Overview

</PRE></OL>and then double-click the selected text to go to the "Data Access
Objects Overview" topic.
<P>
For more information about Data Access Objects, click the Index tab in
Microsoft Excel 7.0 Help, type the following text
<P>
<PRE>   DAO, Overview

</PRE>and then double-click the selected text to go to the "Data Access
Objects Overview" topic.
<P>
For more information about the UNION sql operation, click the Index tab
in Microsoft Excel Help, type the following text
<P>
<PRE>   UNION Operation

</PRE>and then double-click the selected text to go to the "UNION Operation
(SQL)" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbhowto<BR>
KBSubcategory: xldao xlwin<BR>
Additional reference words: 7.00 8.00 97<BR>
Keywords            : xldao xlwin kbhowto kbusage<BR>
Version             : 7.00 97<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
