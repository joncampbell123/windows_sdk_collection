

<HTML>
<HEAD>
<TITLE>Using External Data with Microsoft Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141227">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/12/13">
<META NAME="Keywords" CONTENT="xlquery kbole kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you use Microsoft Excel, you can access data from an external database in one of three ways:   - Using the Microsoft Query add-in to return data to a worksheet  - Creating a PivotTable that uses external data  - Using the ODBC add-in in a macr...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBI0,QAYY,QBWS,QAWM,QBVU,QAH0,QAUD,QA9E,QA2Q,QAH4,QBJZ,QAG2,QA1S,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using External Data with Microsoft Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141227</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use Microsoft Excel, you can access data from an external database
in one of three ways:

<UL><LI>Using the Microsoft Query add-in to return data to a worksheet
<LI>Creating a PivotTable that uses external data
<LI>Using the ODBC add-in in a macro
<P>
</UL>The "More Information" section of this article describes these methods in
detail.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Using the Microsoft Query Add-In to Return Data to a Worksheet</h3>
 
<P>
With the Microsoft Query add-in (Xlquery.xla) you can bring data directly
from an external data source into Microsoft Excel. This add-in uses Dynamic
Data Exchange (DDE) with Microsoft Query to allow you to interactively
create a query for your external data. You can even the record a macro that
retrieves external data using this add-in. To use this add-in, click Add-
Ins on the Tools menu and select the MS Query Add-In check box.
<P>
When you install the Microsoft Query add-in, the Get External Data command
is added to the Data menu. To return data to Microsoft Excel:

<OL><P><LI>In Microsoft Excel, click Get External Data on the Data menu to start
   Microsoft Query.

<P><LI>Create the query to achieve the result set you need.

<P><LI>On the File menu in Microsoft Query, click Return Data To Microsoft
   Excel.

<P><LI>You will be returned to Microsoft Excel and will be prompted for options
   on how the data should be returned to Microsoft Excel.
<P>
</OL>One of the options that you can select is Keep Query Definition. If you
select this option, the query is saved with the workbook so that the query
can be updated. To update the query results on your worksheet, select any
cell in the result set and click Refresh Data on the Data menu.
<P>
To modify a query that is saved with your worksheet, do any of the
following:

<UL><LI>Double-click any cell in the result set.
<P>
<P><PRE>    -or-
</PRE>
<LI>Select any cell in the result set. Click the Get External Data command
   on the Data menu, and then click the Edit Query button.
<P>
</UL>For more information about "The Setup You Need to Retrieve Data with
Microsoft Query" in Microsoft Excel 5.0, choose the Search button in Help,
and type:
<P>
<PRE>   Query

</PRE></OL>Click the Show Topics button, select the topic, and click Go To.
<P>
For more information about using Microsoft Query to retrieve data from
external databases, click the Index tab in Microsoft Excel 7.0 Help, type
the following text
<P>
<PRE>   Microsoft Query

</PRE>double-click the selected text and then double-click the "Retrieving data
from external databases" topic.
<P>
Creating a PivotTable That Uses External Data
 
<P>
The Microsoft Query add-in also allows you to create a PivotTable with an
external data source. The PivotTable allows you to summarize external data
on your worksheet. To use external data in a PivotTable:

<OL><P><LI>On the Data menu, click PivotTable.

<P><LI>In Step 1 of the PivotTable Wizard, choose External Data Source, and
   click the Next button.

<P><LI>In Step 2 of the PivotTable Wizard, click the Get Data button.

<P><LI>Microsoft Query will be started. Create the query to achieve the result
   set that you need.

<P><LI>On the File menu in Microsoft Query, click Return Data To Microsoft
   Excel.

<P><LI>You will be returned to the PivotTable Wizard in Microsoft Excel.
<P>
</OL>To complete the PivotTable, complete the steps in the wizard.
<P>
To update the query results in the PivotTable, select any cell in the
PivotTable and click Refresh Data on the Data menu.
<P>
To modify the query that is used in the PivotTable, select any cell in the
PivotTable and click the PivotTable command on the Data menu. Click the
Back button in Step 3 of the PivotTable Wizard and then click the Get Data
button in Step 2.
<P>
<P><h3>Using the ODBC Add-in in a Macro</h3>
 
<P>
You can use the ODBC add-in (Xlodbc.xla) to work with external data
programmatically. This add-in allows you to execute queries on the data
source, return information about the database, and return data to the
worksheet. This add-in does not use Microsoft Query to access the data. The
add-in strictly uses the ODBC (open database connectivity) API (application
programming interface) to interact with the ODBC Manager and the external
database.
<P>
To use this add-in a macro, you must reference it from the module sheet. To
reference the add-in, activate your module sheet, click References on the
Data menu, and select XLODBC.XLA.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q124218.htm">Q124218</A></B>
   TITLE     : XL5: Macro Examples Using XLODBC Functions

</PRE></OL><h3>Using DAO (Data Access Object) in a Macro (Microsoft Excel 7.0 only)</h3>
 
<P>
With Microsoft Excel version 7.0, DAO is the preferred method for working
with external data in a macro. In many cases, DAO has much higher
performance than the ODBC add-in, provides more functionality and is easier
to use. Using DAO, you can access Jet databases, ISAM (indexed sequential
access method) databases, and ODBC databases. DAO, like the XLODBC.XLA add-
in, does not use Microsoft Query to access the external data.
<P>
To use DAO, you must reference it from the Module sheet. To reference the
object library, activate your module sheet, click References on the Data
menu, and select Microsoft DAO 3.0 Object Library.
<P>
For more information about DAO, click the Index tab in Microsoft Excel
Help, type the following text
<P>
<PRE>   data access in DAO

</PRE>double-click the selected text and then double-click "Data Access Objects
Overview."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00a 5.00c 7.00 pivot table<BR>
Keywords          : xlquery kbole kbtool<BR>
Version           : WINDOWS:5.0,5.0c,7.0; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
