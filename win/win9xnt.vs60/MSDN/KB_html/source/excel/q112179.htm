

<HTML>
<HEAD>
<TITLE>XL5: NAMES() Returns #N/A If Active Sheet Is Chart or Module </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112179">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/03/02">
<META NAME="Keywords" CONTENT="BUGLIST5.00 fixlist5.00c">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you use the NAMES() function in a Microsoft Excel version 4.0 macro to return defined names on a workbook, the function returns the #N/A error value if the active sheet in the workbook is a chart or a module, even if the acti...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUJ,QBVP,QAH4,QAUD,QARM,QAY5,QAPN,QBWD,QBV8,QAB9,QALW,QA62,QDNM,QAW6,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: NAMES() Returns #N/A If Active Sheet Is Chart or Module</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112179</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, if you use the NAMES() function in a Microsoft
Excel version 4.0 macro to return defined names on a workbook, the
function returns the #N/A error value if the active sheet in the
workbook is a chart or a module, even if the active workbook does
contain workbook-level ("global") defined names.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid having the NAMES() function return the #N/A error value when
the active workbook does contain workbook-level defined names, use the
WORKBOOK.SELECT() function in your macro to select a worksheet in the
workbook before you use the NAMES() function, as in the following
example:
<P>
<PRE>   A1: Count_Names
   A2: =WORKBOOK.SELECT("Sheet1","Sheet1")
   A3: =IF(ISNA(INDEX(NAMES(,3),1)))
   A4: =  ALERT("No names defined")
   A5: =  RETURN()
   A6: =END.IF()
   A7: =ALERT(COLUMNS(NAMES(,3)))
   A8: =RETURN()

</PRE>The above macro selects Sheet1 in the active workbook, uses the NAMES()
function to count the number of workbook-level defined names in the
workbook and sheet-level defined names on Sheet1, and then it displays the
number in a message. Because you would usually define a name to run the
macro, the macro usually displays at least 1 in the message.
<P>
Microsoft provides macro examples for illustration only, without warranty
either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose. This
macro is provided as is and Microsoft in no way guaranties that the
following code can be used in all situations and will not support
modifications of the code to suit specific customer requirements.
<P>
Note that this problem does not occur when you use the Count property
of the Names object, or the Name property of the Name object in a
Microsoft Visual Basic Programming System, Applications Edition
module. However, the Count property of the Names object and the Name
property of the Name object includes both sheet-level and book-level names
from the workbook.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the NAMES() function in a Microsoft Excel version 4.0
macro to return workbook-level defined names in a specified workbook as a
horizontal array of text. Sheet-level names of only the active worksheet
are also included in the array.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about NAMES, choose the Search button in the
Microsoft Excel Macro Functions Help and type:
<P>
<PRE>    NAMES function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
