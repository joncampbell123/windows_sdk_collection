

<HTML>
<HEAD>
<TITLE>XL: Error Messages When Accessing Files from Floppy Disks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110944">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1994/02/01">
<META NAME="Keywords" CONTENT="offwin projwin xlloadsave xlwin kbenv">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you access a file directly from a floppy disk, you may receive an error message if you remove the disk from the drive while the file is still open.  NOTE: The information in this article assumes that you are using a single floppy disk drive. I...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QAB4,QAUR,QBVP,QAY2,QDNO,QBWS,QAU7,QAKC,QACI,QA9N,QDL9,QDJ9,QBWO,QBWN P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Error Messages When Accessing Files from Floppy Disks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110944</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you access a file directly from a floppy disk, you may receive an
error message if you remove the disk from the drive while the file is
still open.
<P>
NOTE: The information in this article assumes that you are using a single
floppy disk drive. If your computer has two or more floppy disk drives,
this information applies only if you remove a disk from a certain disk
drive (for example, drive A) and insert another floppy disk into the same
floppy disk drive.
<P>
<P><h3>Error Messages You May Receive When You Open a File</h3>
 
<P>
In Microsoft Excel, if you attempt to open a file from a floppy disk, you
may receive one of the following error messages
<P>
<PRE>   Cannot access '&lt;drive&gt;:'

    -or-

   A different disk is expected in drive &lt;drive&gt;:

</PRE>where &lt;drive&gt; is your computer's floppy disk drive.
<P>
<P><h3>Error Messages You May Receive When You Save a File</h3>
 
<P>
If you attempt to save the file and the original disk has been removed
from the disk drive and replaced by another, you may receive the error
message:
<P>
<PRE>   Filename is not valid

</PRE>If you include the drive letter in the file name when you save the file,
you receive the following error message
<P>
<PRE>   Cannot access '&lt;drive&gt;:&lt;filename&gt;'

</PRE>where &lt;drive&gt; is your floppy disk drive and &lt;filename&gt; is the name of
your document.
<P>
In Windows 95, if you open a file from a floppy disk, and you insert a
different floppy disk in the disk drive, when you attempt to save the
file to the disk, you receive the following error message
<P>
<PRE>   Error Reading Disk in Drive &lt;drive&gt;
   Please Insert Disk &lt;label&gt;
   With Serial Number &lt;serial number&gt; in Drive &lt;drive&gt;:

</PRE>where &lt;drive&gt; is your computer's floppy disk drive, and &lt;label&gt; and
&lt;serial number&gt; are the label and serial number of the original disk.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Excel for Windows can run only when a file-sharing program,
such as Share.exe or Vshare.386, is running.
<P>
NOTE: Microsoft Windows 95 provides built-in file sharing.
<P>
The error messages occur because of the way in which the file-sharing
program keeps track of open files. When you open a file from a floppy
disk, the serial number (if one exists) of the floppy disk (for example,
2B4A-1ACA), is read into memory. If you attempt to open a file from a
floppy disk that has a different serial number while the first file is
still open, you will receive an error message.
<P>
Note also that a disk formatted with the Format command (included with MS-
DOS versions 5.0 and later) will be assigned a serial number.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
If your files are stored on floppy disks that do not have serial numbers,
you may be able to open files without receiving an error message.
<P>
<P><h3>Opening Files from Floppy Disks</h3>
 
<P>
To avoid receiving an error message when you open files from floppy
disks, copy the files to your hard disk before you open them.
<P>
This is the recommended workaround because opening files from and saving
files to the hard disk drive is faster than using a floppy disk drive; in
addition, saving to the hard disk drive allows you to avoid problems
caused by lack of space on floppy disks.
<P>
In Windows 95, you can work around the save error message by saving the
file to the original floppy disk before inserting a different disk.
<P>
<P><h3>Other Ways to Avoid Getting These Error Messages</h3>
 

<UL><LI>Use a third-party disk formatting program, such as the Sformat (Safe
   Format) program included with Symantec's Norton Utilities, to format
   your floppy disks. These programs often do not place a serial number
   on floppy disks.
<P>
<P><PRE>    -or-
</PRE>
<LI>Format the floppy disks in a computer running MS-DOS 4.0 or earlier.
   Versions 2.x, 3.x, and 4.0 of MS-DOS do not place serial numbers
   on floppy disks when they are formatted.
<P>
</UL><h3>Saving a File to a Different Floppy Disk</h3>
 
<P>
If you open a file from a floppy disk and then remove that floppy disk
from the disk drive before you close the file, you may receive the error
message "Filename is not valid" when you click Save on the File menu.
This error message appears if the path for the new file is not applicable
to the new floppy disk.
<P>
For example, if you open the file A:\Test\Alpha.xls, remove the floppy
disk from drive A, and then insert a new disk into drive A, clicking Save
on the File menu only works if there is a Test folder on drive A.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q118958.htm">Q118958</A></B>
   TITLE     : XL5: Excel 5.0c Setup Program Installs VSHARE.386

   ARTICLE-ID: <B><A href="../excel/q106499.htm">Q106499</A></B>
   TITLE     : XL5 Err Msg: "Must Exit Windows and Load SHARE.EXE..."

   ARTICLE-ID: <B><A href="../zmiscellaneous/q134840.htm">Q134840</A></B>
   TITLE     : PRJ41: "Error Reading Disk" Closing or Saving File
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00 8.00 97 switch switching<BR>
change changing blue screen<BR>
Keywords          : offwin projwin xlloadsave xlwin kbenv<BR>
Version           : WINDOWS:5.0,5.0c,7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
