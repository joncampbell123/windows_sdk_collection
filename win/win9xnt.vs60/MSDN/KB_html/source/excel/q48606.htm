

<HTML>
<HEAD>
<TITLE>XL: Comparison of Values Does Not Return Correct Result </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q48606 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1989/09/01">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, two sums that appear to be equal may return either FALSE when compared (as in an IF statement) or an incorrect value when a calculation is performed based on the two values.  CAUSE =====  This problem occurs because of the preci...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKC,QAK2,QAKD,QABH,QABI,QAG7,QBC6,QAAP,QAL3,QAGN,QAG8,QBWS,QAUD,QBE7 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Comparison of Values Does Not Return Correct Result</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q48606 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for the Macintosh, versions 1.x, 2.x, 3.0, 4.0,
   5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, two sums that appear to be equal may return either
FALSE when compared (as in an IF statement) or an incorrect value when a
calculation is performed based on the two values.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because of the precision of your computer, which must
represent and manipulate numbers in binary. Microsoft Excel compares the
exact binary representation of the numbers rather than their decimal
equivalents, which are displayed on the screen. Therefore, rounding errors
can occur in the binary representation of the numbers that are not evident
when comparing the decimal values visually.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, use any of the following methods.
<P>
<P><h3>Method 1</h3>
 
<P>
Have Microsoft Excel compare the displayed values of the numbers, rather 
than their exact binary value. (Note that this procedure affects only 
directly comparing values that are displayed on the worksheet; it does not 
affect rounding errors that can occur in comparing formulas referring to 
those values.)
<P>
To do this, use the steps appropriate for your version of Microsoft Excel.
<P>
Versions 5.0 and Later:
<P>
Click Options or Preferences on the Tools menu, and click the Calculation 
tab. Under Workbook Options, select the Precision As Displayed check box, 
and then click OK.
<P>
Version 4.0:
<P>
Click Calculation on the Options menu, and then select the Precision As 
Displayed check box. Click OK.
<P>
Versions 2.2 and 3.0:
<P>
Click Calculation on the Options menu, and then select the Precision As 
Displayed check box. For example, to ensure no rounding errors occur in the 
formula
<P>
<PRE>   A1: =IF(B1=B2*-25,TRUE,FALSE)

</PRE>select the Precision As Displayed check box, and break the formula into two 
cells as follows:
<P>
<PRE>             A1: =B2*-25       A2: =IF(B1=A1,TRUE,FALSE)

</PRE><h3>Method 2</h3>
 
<P>
Use the ROUND() function to round the number to the desired number of 
digits. The following example rounds the two values to the second decimal 
place:
<P>
<PRE>   A1: =IF(ROUND(B1,2)=ROUND(B2*-25,2),TRUE,FALSE)

</PRE><h3>Method 3</h3>
 
<P>
Compare the absolute value of the difference between the values to a number 
smaller than the significant difference. For example, the following formula 
checks to see that the two values are within .001 of each other (which is 
insignificant for the numbers used, but greater than a rounding error):
<P>
<PRE>   A1: =IF(ABS(B1-(B2*-25))&lt;.001,TRUE,FALSE)

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q78113.htm">Q78113</A></B>
   TITLE     : XL: Floating-Point Arithmetic May Give Inaccurate Results
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.x 2.2 2.20 3.0 3.00 4.0 4.00 5.00 5.00a 7.00 97 <BR>
98 XL98 XL97 XL7 XL5 XL4 XL3<BR>
Version           : WINDOWS:2.x,3.x,4.x,5.0,5.0c,7.0,7.0a,97; MACINTOSH:1.x,2.x,3.0,4.0,5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
