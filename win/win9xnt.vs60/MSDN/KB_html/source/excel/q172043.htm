

<HTML>
<HEAD>
<TITLE>XL97: "Auto_Open_xlquery_DClick" Error Appears Opening File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172043">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/07/28">
<META NAME="Keywords" CONTENT="xllist xlquery kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you open a file in Microsoft Excel 97 for Windows, you may receive the following error message:     Cannot find Auto_Open_xlquery_DClick, which has been assigned to run    each time [File Name]Sheet Name is opened. Continuing could cause    er...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBJZ,QBWS,QAH4,QAB4,QAAW,QBTI,QBS0,QBQS,QAUJ,QAUD,QAGB,QAUR,QDL9,QBWQ P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: "Auto_Open_xlquery_DClick" Error Appears Opening File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a file in Microsoft Excel 97 for Windows, you may receive
the following error message:
<P>
<PRE>   Cannot find Auto_Open_xlquery_DClick, which has been assigned to run
   each time [File Name]Sheet Name is opened. Continuing could cause
   errors. Cancel opening [File Name]Sheet Name?

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if all of the following conditions are true:

<UL><LI>You create a file with an Auto_Open macro in Excel 97.
<P>
<P><PRE>    -and-
</PRE>
<LI>You create a query in Microsoft Query that returns data to Excel, and
   you store the query in the file.
<P>
<P><PRE>    -and-
</PRE>
<LI>You save the file in the Microsoft Excel 5.0/95 Workbook (*.xls) format.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, follow these steps:

<OL><P><LI>Open the file in Excel 97, press ALT+F11 to start the Visual Basic
    Editor.

<P><LI>In the Project window, click the plus sign (+) next to Modules.
    Click the module that contains the Auto_Open macro to select it.

<P><LI>Locate the Auto_Open macro and rename it. To do this, change the first
    line of the macro.
<P>
    For example, if the first line of the macro is the following
<P>
<PRE>       Sub Auto_Open()

    change it to

       Sub StartupCode()

</PRE><P><LI>On the File menu, click "Close and Return to Microsoft Excel."

<P><LI>On the File menu, click Save As. In the Save As dialog box, change the
    file type to Microsoft Excel Workbook (*.xls).

<P><LI>On the File menu, click Close, and then reopen the file in Excel 97.
    Press ALT+F11 to start the Visual Basic Editor.

<P><LI>In the Project window, click the plus sign (+) next to Modules. Click
    the module that contains the renamed macro to select it.

<P><LI>Rename the macro with the following name:
<P>
<PRE>       Sub Auto_Open().

</PRE><P><LI>On the File menu, click "Close and Return to Microsoft Excel." On the
    File menu, click Save, and then click Close.
<P>
    When you reopen the file, the error message does not appear.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this
problem and will post new information here in the Microsoft Knowledge
Base as it becomes available.
 
<PRE>Keywords          : xllist xlquery kberrmsg kbtool
Version           : WINDOWS:97
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
