

<HTML>
<HEAD>
<TITLE>Recorded Macro Is Interactive If CROSSTAB.CREATE() Is Too Long </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88245 ">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1992/08/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You can record a macro in Microsoft Excel that automatically creates a cross-tabulation table. If the resulting CROSSTAB.CREATE() function is longer than 255 characters, your macro runs the Crosstab ReportWizard instead of building an Excel cross-t...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAY5,QAYL,QDPA,QAHE,QAPN,QAB9,QAUJ,QAH4,QBV8,QA5V,QBXS,QBWS,QDMF,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Recorded Macro Is Interactive If CROSSTAB.CREATE() Is Too Long</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88245 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 4.0
<LI>Microsoft Excel for the Macintosh, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can record a macro in Microsoft Excel that automatically creates a
cross-tabulation table. If the resulting CROSSTAB.CREATE() function is
longer than 255 characters, your macro runs the Crosstab ReportWizard
instead of building an Excel cross-tabulation table automatically.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel enters the CROSSTAB.CREATE() function along with its
arguments in a cell on your macro sheet when you record a macro that
creates a cross-tabulation table.
<P>
If your field names are very lengthy or if you choose multiple fields
for both row and column categories, the resulting CROSSTAB.CREATE()
function may exceed the limit in Microsoft Excel of 255 characters per
cell.
<P>
If the function is longer than 255 characters, Microsoft Excel is
unable to enter the complete form of the function and enters the
interactive form (=RUN(CROSSTAB.CREATE?,FALSE)) instead.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If the CROSSTAB.CREATE() function is too long to fit in the cell, you
can use variables in place of its arguments.
<P>
To use variables in place of arguments,

<OL><P><LI>Activate your macro sheet. If you are using the Global macro sheet,
   choose Unhide from the Window menu.

<P><LI>Create variables to hold the arguments for your CROSSTAB.CREATE()
   function.
<P>
   For information about creating variables, see "To create variables"
   below.

<P><LI>Locate and select the cell containing the cross-tabulation function
   (=RUN(CROSSTAB.CREATE?,FALSE)).

<P><LI>Edit the function to include your variables as arguments. Make sure
   you remove the question mark from the function name. For example,
   the resulting function might look something like the following
<P>
<P><PRE>      =CROSSTAB.CREATE(Row_Array,Col_Array,Val_Array,&lt;optional_args&gt;)
</PRE><P>
   where Row_Array, Col_Array, and Val_Array are the variables you
   created for holding the arguments. &lt;optional_args&gt; are optional
   arguments that you may want to include. For more information on
   this formula, see pages 82-84 of the "Microsoft Excel Function
   Reference," version 4.0.
<P>
</OL>To create variables:

<OL><P><LI>From the Formula menu, choose Define Name.

<P><LI>Type the name you want to use for your variable in the Name box.

<P><LI>Enter the argument array in the Refers To box.

<P><LI>Choose the Add button.

<P><LI>Repeat these steps for each of the category arguments. When you
   have finished, choose the OK button to close the Define Name dialog
   box.
<P>
   Example
   -------
<P>
   To use the variable name Row_Array and the following argument
   settings
<P>
<P><PRE>      Field_name = Sales
      Grouping_index = 3
      From = FALSE
      To = FALSE
      Subtotals = YNNNNNN
</PRE><P>
   type the following in the Name box
<P>
<P><PRE>      Row_Array
</PRE><P>
   and type the following in the Refers to box:
<P>
<P><PRE>      ={"Sales",3,FALSE,FALSE,"YNNNNNN"}
</PRE><P>
</OL>Be sure to include the equals sign (=) and the curly brackets.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, pages 82-84
<P>
"User's Guide 1," version 4.0, pages 346-356
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
