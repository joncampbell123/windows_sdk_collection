

<HTML>
<HEAD>
<TITLE>Excel: SOUND.PLAY() Ignored in Auto_Open Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90786 ">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1992/10/22">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel version 4.0, a SOUND.PLAY() macro statement in an Auto_Open routine that executes while Microsoft Excel is starting may be ignored or the macro may halt.  If Microsoft Excel is already open when the specified Auto_Open routine is...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHR,QAYS,QBVP,QAPN,QAH4,QAHE,QBBI,QAB9,QBWS,QDO9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: SOUND.PLAY() Ignored in Auto_Open Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90786 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, version 4.0
<LI>Microsoft Excel for Windows, versions 4.0, 4.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel version 4.0, a SOUND.PLAY() macro statement in
an Auto_Open routine that executes while Microsoft Excel is starting
may be ignored or the macro may halt.
<P>
If Microsoft Excel is already open when the specified Auto_Open
routine is executed, the function behaves normally.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Auto_Open is a name you define on a worksheet or a macro sheet to
refer to a macro that you want to execute each time you open the file.
In any case where Microsoft Excel and the file containing the
Auto_Open defined name are launched simultaneously, a SOUND.PLAY()
statement contained in the executed Auto_Open macro will, under
certain conditions, be ignored in Microsoft Excel for the Macintosh
and will cause the macro to halt in error in Microsoft Excel for
Windows.
<P>
Microsoft Excel and a document will be started simultaneously when you
have saved the document to the Excel Startup Folder (4) (if you are
using Microsoft Excel for the Macintosh) or the XLSTART directory (if
you are using Microsoft Excel for Windows). Both documents will also
be started simultaneously when you open a document from the Finder (if
you are using Microsoft Excel for the Macintosh), or from Program
Manager or File Manager (if you are using Microsoft Excel for
Windows); in all of these cases, if Microsoft Excel is not already
running in the background, it will be started along with the document.
<P>
<P><h3>Microsoft Excel for the Macintosh</h3>
 
<P>
In Microsoft Excel for the Macintosh, the SOUND.PLAY() statement is
ignored when the cell_ref argument is used to reference a cell note
containing a sound that you want to play. The statement will execute
properly if you use the file_text argument to specify a sound folder.
Specifying file_text without a resource argument will play the first
sound resource in the folder. If you want a specific sound to play,
specify the appropriate sound as the resource argument. Note that the
resource argument is only valid on the Macintosh.
<P>
<P><h3>Workarounds - Macintosh</h3>
 
<P>
There are 3 possible solutions to this problem in Microsoft Excel for
the Macintosh:

<UL><LI>Rather than specifying a cell_ref argument, use the
   file_text argument with or without an accompanying
   resource argument. For example:
<P>
<P><PRE>      =SOUND.PLAY(,"HARD DISK:SOUNDS:SOFT SOUNDS","Chimes")
</PRE><P>
   -or-

<LI>Start Microsoft Excel first and then open the file
   containing the Auto_Open defined name from within the
   application.
<P>
   -or-

<LI>Use the ON.TIME() function to execute a macro that
   contains the SOUND.PLAY() function. This allows
   Microsoft Excel to complete its startup and then
   execute the SOUND.PLAY() statement. The following
   macro is an example of this workaround:
<P>
<P><PRE>      A1:  Auto_Open
      A2:  =ON.TIME(NOW(),"PlaySounds")
      A3:  =RETURN()
      A4:
      A5:  PlaySounds
      A6:  =SOUND.PLAY(B1)
      A7:  =RETURN()
</PRE><P>
</UL>Cell B1 on the macro sheet contains a sound cell note.
<P>
<P><h3>Microsoft Excel for Windows</h3>
 
<P>
In Microsoft Excel for Windows, specifying the cell_ref argument in
the SOUND.PLAY() statement will work correctly when a sheet and
Microsoft Excel are launched simultaneously. If, however, the
file_text argument is specified, the macro will halt in error at the
cell containing the SOUND.PLAY() statement. Note that the resource
argument is not valid in Microsoft Excel for Windows.
<P>
<P><h3>Workarounds - Windows Operating Environment</h3>
 
<P>
There are 3 possible solutions to this problem.

<UL><LI>Do the following to import the sound into a cell note and use the
   cell_ref argument rather than the file_text argument:
<P>
<P><PRE>    1. the Formula menu, Choose Note and choose the Import button.
</PRE><P>
<P><PRE>    2. Select the sound file you want to play and choose the OK button
      twice.
</PRE><P>
<P><PRE>      In the following example, the cell note is in B1 on the macro
      sheet.
</PRE><P>
<PRE>         =SOUND.PLAY(B1)

   -or-

</PRE><LI>Start Microsoft Excel first and then open the document containing
   the Auto_Open defined name from within the application.
<P>
</UL>-or-

<UL><LI>Use the ON.TIME() function to execute a macro that contains the
   SOUND.PLAY() function. This allows Microsoft Excel to complete its
   startup and then execute the SOUND.PLAY() statement. The following
   macro is an example:
<P>
<P><PRE>      A1: Auto_Open
      A2: =ON.TIME(NOW(),"PlaySounds")
      A3: =RETURN()
      A4:
      A5: PlaySounds
      A6: =SOUND.PLAY(,"C:\SOUNDS\SOUND.WAV")
      A7: =RETURN()
</PRE><P>
   This SOUND.PLAY() statement plays the SOUND.WAV file in the SOUNDS
   directory.
<P>
</UL>NOTE: Tolerance, the third argument of the ON.TIME() function,
specifies the time the program will wait in order to execute a macro
if Excel is not in Ready, Copy, Cut, or Find mode at the precise time
specified for macro execution. If this argument is omitted, this
amount of time is assumed to be infinite. The result of this is that
PlaySounds will run at the next available moment.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, pages 305-306, 415-416
<P>
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 4.00a<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
