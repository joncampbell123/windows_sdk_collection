

<HTML>
<HEAD>
<TITLE>XL98: Problems Adding Text Database in Microsoft Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179660">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1998/01/21">
<META NAME="Keywords" CONTENT="xlquery kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you try to query a database in Microsoft Query by using the Text ODBC driver, one of the following problems occur:     Error Adding Table    ------------------     When you try to add the database (table) to Microsoft Query, the    following e...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QBI0,QAMB,QATX,QAGU,QAE1,QBVV,QAB4,QAKP,QBWS,QA01,QADZ,QA5E,QAUJ,QARR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Problems Adding Text Database in Microsoft Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179660</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to query a database in Microsoft Query by using the Text ODBC
driver, one of the following problems occur:
<P>
<PRE>   Error Adding Table
   ------------------

   When you try to add the database (table) to Microsoft Query, the
   following error appears

      Can't access table &lt;database&gt;

   where &lt;database&gt; is the name of the file you are attempting to open
   in Microsoft Query.

   Cannot See Database File
   ------------------------

   When you attempt to create a new data source name (File DSN), some or
   all of the database files do not appear in the "Select a default table
   for your data source (optional)" box in the "Create New Data Source"
   dialog box.

</PRE><h2>CAUSE</h2>
 
<P>
<P><h3>Error Adding Table</h3>
 
<P>
This problem occurs when either of the following cases is true:
<P>
Case 1:

<UL><LI>You create a File DSN without first creating a User DSN that defines
   each of the database files.
<P>
   -and-

<LI>In the Add Tables dialog box, you try to add one of the database files
   that was not defined in the User DSN.
<P>
</UL>Case 2:

<UL><LI>You create a User DSN for a text database and the database file
   contains a file name extension, such as .txt.
<P>
   -and-

<LI>In the Add Tables dialog box, you try to add one of these database
   files.
<P>
</UL><h3>Cannot See Database File</h3>
 
<P>
This problem occurs if you have not defined that database file by creating
a User DSN.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use the following appropriate method.
<P>
<P><h3>Method 1: Error Adding Table</h3>
 
<P>
To use this method, follow these steps:

<OL><P><LI>Create a User DSN by using the Text ODBC driver and define each table
   that you want to use.
<P>
<P><PRE>    a. To define a table, click the Define tab and select your file in
       the list.
</PRE><P>
<P><PRE>    b. If the column names do not appear in the Column Information list,
       click Guess, and then click OK.
</PRE><P>
   If you are using several text database files, you must define each by
   repeating steps a and b.

<P><LI>If your text database file contains a file name extension (such as
   .txt), configure the DSN following these steps:
<P>
<P><PRE>    a. When you define the User DSN, click the option "Use DOS File
       Extensions" in the Mac File Types dialog box.
</PRE><P>
<P><PRE>    b. After you create the User DSN for the Text ODBC driver, create a
       File DSN for the specific text database file.
</PRE><P>
<P><PRE>    c. To add a table to your query, you should use the Query Wizard. If
       you do not use this wizard, the "Cannot Access" error message may
       appear when you attempt to add a text database in the Add Tables
       dialog box.
</PRE><P>
</OL><h3>Method 2: Cannot See Database File</h3>
 
<P>
If the database file does not appear in the list, first define the table.
To define the table when you create the User DSN, follow these steps:

<OL><P><LI>To define a table, in the Microsoft 3.01 Text PPC dialog box, click the
   Define tab, and select the file in the list.

<P><LI>If the column names do not appear in the Column Information list,
   click Guess, and then click OK.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the products listed above.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98<BR>
Keywords          : xlquery kbtool<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
