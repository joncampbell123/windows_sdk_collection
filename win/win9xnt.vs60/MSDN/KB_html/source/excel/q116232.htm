

<HTML>
<HEAD>
<TITLE>XLM: Importing Text Files Larger Than 16384 Rows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116232">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1994/06/14">
<META NAME="Keywords" CONTENT="xlloadsave">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Text files that contain more than 16,384 rows cannot be opened in their entirety in Microsoft Excel. You cannot open these files because a worksheet is limited to 16,384 rows. If you open a file that contains more data than this, the size will prod...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QBVP,QAH4,QBWS,QBJZ,QA5V,QAUJ,QAM9,QALX,QAY4,QBQU,QATX,QAMB,QAUD,QANE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XLM: Importing Text Files Larger Than 16384 Rows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116232</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.x, 4.x, 5.0 5.0c
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0, 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Text files that contain more than 16,384 rows cannot be opened in their
entirety in Microsoft Excel. You cannot open these files because a
worksheet is limited to 16,384 rows. If you open a file that contains more
data than this, the size will produce the following error message
<P>
<PRE>   File not loaded completely

</PRE>and the text file will be truncated at the 16,384th row. However, you can
use a macro to open the file and automatically break the text into multiple
worksheets.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>The following sample macro prompts the user for a text file name, opens the
file into memory, and determines if the number of rows is larger than
16,384. If the number of rows is greater than the Microsoft Excel worksheet
limit, the macro separates the file into multiple worksheets.
<P>
To use this macro, follow these steps:

<OL><P><LI>Create a macro sheet.
<P>
<P><PRE>    Microsoft Excel Version 5.0 or 7.0
    ----------------------------------
</PRE><P>
<P><PRE>    Point to Macro on the Insert menu, and then click "MS Excel 4.0 Macro."
</PRE><P>
<P><PRE>    Microsoft Excel Version 3.0 or 4.0
    ----------------------------------
</PRE><P>
<P><PRE>    a. On the File menu, click New.
</PRE><P>
<P><PRE>    b. Select macro sheet in the New box, and then click OK.

<P><LI>Enter following macro into the macro sheet:
<P>
      A1:  Large_Text_File_Importer
      A2:  filename=INPUT("Please enter the Text File's name",2,"Large Text
<PRE>           File Importer")
      A3:  =IF(filename=FALSE,RETURN())
      A4:  filenum=FOPEN(filename,2)
      A5:  =ECHO(FALSE)
      A6:  =NEW(1)
      A7:  Counter=1
      A8:  =WHILE(FPOS(filenum)&lt;=FSIZE(filenum))
      A9:  =MESSAGE(TRUE,"Importing Row "&amp;Counter&amp;" of text file
            "&amp;filename)
      A10: =FORMULA(FREADLN(filenum))
      A11: =IF(ROW(ACTIVE.CELL())=16384)
      A12: =NEW(1)
      A13: =ELSE()
      A14: =SELECT("R[1]C")
      A15: =END.IF()
      A16: Counter=Counter+1
      A17: =NEXT()
      A18: =FCLOSE(filenum)
      A19: =MESSAGE(FALSE)
      A20: =RETURN()

   Description of macro code:

      A1:  Name of the Macro
      A2:  Prompt user for the Text file's name (with complete path and
           file name extension).
      A3:  If input box cancel button was selected, then end macro.
      A4:  Open the Text file with Read access.
      A5:  Turn screen updating off.
      A6:  Create a new worksheet
      A7:  Initialize the row Counter name to the value of 1.
      A8:  Loop until we reach the end of the file.
      A9:  Display a status message at the bottom of Excel.
      A10: Read a line from the text file and place into the active cell.
      A11: Check to see if the current row is 16384.
      A12: If A12 is True, then create a new sheet.
      A13: If A12 is NOT True, then do the following...
      A14: Select 1 row down from the active cell.
      A15: End the IF block.
      A16: Increment the Counter name by 1.
      A17: Loop back to A9.
      A18: Close the text file (opened in cell A4).
      A19: Turn the status bar back to normal.
      A20: End Macro.

</PRE><P><LI>Next, define a name for the macro.
<P>
    Microsoft Excel Version 5.0 or 7.0
    ----------------------------------
<P>
    a. Point to Name on the Insert menu, and then click Define.
<P>
    b. Type "ImportFile" (without the quotation marks) in the "Names in
       Workbook" box.
<P>
    c. Click Command in the Macro box, and then click OK
<P>
<P>
    Microsoft Excel Version 3.0 or 4.0
    ----------------------------------
<P>
    a. On the Formula Menu, click Define Name.
<P>
    b. Type "ImportFile" (without the quotation marks) in the Name box.
<P>
    c. Click Command in the Macro group box, and then click OK

<P><LI>Run the macro.
<P>
    Microsoft Excel Version 5.0 or 7.0
    ----------------------------------
<P>
    a. On the Tools menu, click Macro.
<P>
    b. Click ImportFile in the "Macro Name/Reference" box, and then
       click OK.
<P>
    Microsoft Excel Version 3.0 or 4.0
    ----------------------------------
<P>
    a. On the Macro menu, click Run.
<P>
    b. Click ImportFile in the Run box, and then click OK.
</PRE><P>
</OL>The text file that you import is broken up into multiple worksheets.
<P>
NOTE: This macro does not parse the data into columns. After you use this
macro, you may also need to do the following:

<UL><LI>If you are using Microsoft Excel 5.0, use the Text To Columns command on
   the Data menu.
<P>
<P><PRE>    -or-
</PRE>
<LI>If you are using Microsoft Excel 3.0, 4.0, or 4.0a, use the Data Parse
   command or the Smart Parse command FLATFILE.XLA add-in macro.
<P>
</UL>Note also that, because this is a macro, it may be significantly slower
than clicking Open on the File menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 4.00 5.00 import ascii<BR>
Keywords          : xlloadsave<BR>
Version           : WINDOWS:3.0,4.0,5.0,5.0c,7.0; MACINTOSH:3.0,4.0,5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
