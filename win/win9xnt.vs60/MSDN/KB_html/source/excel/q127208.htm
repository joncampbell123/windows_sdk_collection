

<HTML>
<HEAD>
<TITLE>XL: How to Custom Sort/Prevent Auto Sort in PivotTable </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q127208">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/03/14">
<META NAME="Keywords" CONTENT="kbcode kbprg kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, data in a PivotTable is automatically sorted. There are no options available to turn this automatic sorting off or to perform a custom sort on your PivotTable data.  To prevent a PivotTable from being sorted, you can create a cu...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVU,QAE1,QBVP,QAB6,QARW,QBWS,QBVV,QBXR,QAYY,QAPF,QAH4,QBS0,QBJZ,QASR,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Custom Sort/Prevent Auto Sort in PivotTable</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q127208</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, data in a PivotTable is automatically sorted.
There are no options available to turn this automatic sorting off or
to perform a custom sort on your PivotTable data.
<P>
To prevent a PivotTable from being sorted, you can create a custom list
using the unsorted source data on the worksheet. To custom sort a
PivotTable, you can first sort the source data as desired on the
worksheet, and then create a custom list using the sorted source data.
<P>
The following examples demonstrate how to use a custom list to
prevent a PivotTable from sorting and to custom sort the data in
your PivotTable.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Similar to when data is sorted on a worksheet, a PivotTable will first use
a custom list to sort if possible. If an appropriate custom list is not
available, then the PivotTable uses default sorting.
<P>
If there is a custom list that exactly matches the source data, then
the PivotTable is sorted using the custom list, which will make the
PivotTable appear to be unsorted.
<P>
Note that a custom list is only used when the PivotTable is created.
If you use a new custom list for sorting, you must recreate the pivot
table (you can't just refresh the PivotTable).
<P>
<P><h3>Example Using a Custom List</h3>
 
<P>
<P><h3>Creating the PivotTable</h3>
 

<OL><P><LI>To create a PivotTable in this example, enter the following on a
   worksheet in a new workbook:
<P>
<PRE>      A1: MyNoSortField   B1: MyValues
      A2: NoSort4         B2: 5
      A3: NoSort2         B3: 3
      A4: NoSort1         B4: 5
      A5: NoSort3         B5: 6
      A6: NoSort4         B6: 4
      A7: NoSort3         B7: 3
      A8: NoSort2         B8: 5
      A9: NoSort3         B9: 7
     A10: NoSort1        B10: 4

</PRE><P><LI>On the Data menu, click PivotTable. In the PivotTable Wizard - Step
   1 of 4 dialog box, click Next. In the PivotTable Wizard - Step 2 of 4
   dialog box, in the Range box, type "$A$1:$B$10" (without the quotation
   marks), and click Next.

<P><LI>In the PivotTable Wizard - Step 3 of 4 dialog box, drag the MyNoSort
   field to the Column area on the PivotTable. Drag the MyValues field to
   the Data area on the PivotTable. Click Next.

<P><LI>In the PivotTable Wizard - Step 4 of 4 dialog box, in the PivotTable
   starting cell box, enter "=$E$1" (without the quotation marks), and
   click Finish.
<P>
   Note the order of the values in the PivotTable.
<P>
</OL><h3>Creating the Custom List</h3>
 
<P>
To create a custom list to affect the way your PivotTable data is
sorted, first make sure that the cells from which you are creating
the list contain text, not formulas or numeric values. If the cells
contain formulas, you must first copy the formulas, and then paste
the values to another location to create text; if the cells contain
numeric values, you will not be able to create a custom list, even if
you format the values as text.

<OL><P><LI>On the Tools menu, click Options, and click the Custom Lists tab.

<P><LI>Click in the Import List From Cells box.

<P><LI>On the worksheet, select the range of cells that contain your custom
   list, (A2:A10 in this example) and click Import. Click OK.

<P><LI>Repeat these steps for each custom list. Then, create your PivotTable.
<P>
</OL><h3>Using the Custom List</h3>
 
<P>
To use this custom list to sort your PivotTable, you must delete the
PivotTable created above, and then create the PivotTable again,
using the steps in the "Creating the PivotTable" procedure.
<P>
NOTES: If you add items to the source data after you create the PivotTable,
and you refresh the PivotTable, the new items are only sorted
correctly if they are included in the original custom list. Items
that are not included in the original custom list are sorted after
the items that are included in the original custom list.
<P>
After you create a PivotTable using a custom list, the PivotTable
no longer uses the custom list for refreshing the data. Because of
this behavior, if you change the custom list that you used to create
the PivotTable, you must delete the PivotTable, and create a new
PivotTable. Additionally, you can delete the original custom list
and the PivotTable will still sort according to the original custom
list.
<P>
<P><h3>Visual Basic Code Example</h3>
 
<P>
The following example shows how to make a PivotTable field appear
not to sort using a Visual Basic macro:

<OL><P><LI>In a new module sheet, enter the following:
<P>
<PRE>      Sub NewPivotNoSort()
         ' Create temporary custom list using PivotTable data
         Application.AddCustomList Range("A2:A10")
         ' Create PivotTable
         ActiveSheet.PivotTableWizard
         ActiveSheet.PivotTables(1).AddFields "MyNoSortField"
         ActiveSheet.PivotTables(1).PivotFields("MyValues").Orientation _
           = xlDataField
         ' Delete custom list
         Application.DeleteCustomList Application.CustomListCount
      End Sub

</PRE><P><LI>On a worksheet in the same workbook, enter the following:
<P>
<PRE>      A1: MyNoSortField   B1: MyValues
      A2: NoSort4         B2: 5
      A3: NoSort2         B3: 3
      A4: NoSort1         B4: 5
      A5: NoSort3         B5: 6
      A6: NoSort4         B6: 4
      A7: NoSort3         B7: 3
      A8: NoSort2         B8: 5
      A9: NoSort3         B9: 7
     A10: NoSort1        B10: 4

</PRE><P><LI>To run the macro, do the following:
<P>
<P><PRE>    a. Select any cell in the range A1:B10 on the worksheet that contains
       the data that you entered above.
</PRE><P>
<P><PRE>    b. On the Tools menu, click Macro.
</PRE><P>
<P><PRE>    c. In the Macro Name/Reference list, click NewPivotNoSort and click
       Run.
</PRE><P>
</OL>In the resulting PivotTable, the MyNoSortField data appears unsorted.
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/supportnet/refguide/">http://www.microsoft.com/supportnet/refguide/</A></B>

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 disable stop sorting 5.00 5.00c<BR>
Keywords          : kbcode kbprg kbualink97<BR>
Version           : WINDOWS:5.0,5.0c,7.0; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
