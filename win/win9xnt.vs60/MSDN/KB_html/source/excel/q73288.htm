

<HTML>
<HEAD>
<TITLE>Executing Stored Procedures with Text Parameters from Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73288 ">
<META NAME="KBModify" CONTENT="1994/11/03">
<META NAME="KBCreate" CONTENT="1991/06/21">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  You can execute SQL Server-stored procedures from Microsoft Excel in a custom macro by using the macro functions provided in the add-in QE.XLA or by sending commands to Q+E via DDE (Dynamic Data Exchange).  Parameters passed to the stored procedure...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA50,QAHH,QAH6,QAY2,QAHE,QAB9,QBUG,QBUF,QA4F,QAUD,QAPF,QAH7,QAD7,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Executing Stored Procedures with Text Parameters from Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 3, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73288 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.1 and 3.0
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can execute SQL Server-stored procedures from Microsoft Excel in a
custom macro by using the macro functions provided in the add-in
QE.XLA or by sending commands to Q+E via DDE (Dynamic Data Exchange).
<P>
Parameters passed to the stored procedure must be placed after the
name of the procedure and separated with a single space.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is important that when you pass a text parameter that you enclose
it in double quotation marks. Because the whole query passed from
Microsoft Excel is in double quotation marks and you may not place a
set of double quotation marks inside another set, you must use two
sets of single quotations marks around the text parameters when
executing a stored procedure from Microsoft Excel.
<P>
The two examples below execute the stored procedure SP_HELPDB to obtain
information on the example database PUBS. The information returned from
the server is pasted to Sheet1.
<P>
The first example uses the macro functions supported by the QE.XLA.
For this to work correctly, you must first open QE.XLA from the
\XLSTART\QEMACRO subdirectory of your Excel directory.
<P>
<P><h3>Example Using Functions Supplied by the QE.XLA</h3>
 
<P>
A1  =INITIATE("qe","system")
A2  =ACTIVATE("sheet1")
A3  =DB.LOGON("SQLServer")
A4  =DB.SQL.QUERY(2,"sp_helpdb ''pubs''",1,FALSE)
A5  =RETURN()
<P>
NOTE: In A4, there are two single quotation marks before the parameter
pubs and two single quotation marks, followed by a double quotation
mark, after pubs.
<P>
<P><h3>Example Using DDE Functions</h3>
 
<P>
A1  chan=INITIATE("qe","system")
A2  =EXECUTE(chan,"[logon('SQLServer')]")
A3  =ACTIVATE("Sheet1")
A4  =EXECUTE(chan,"[open('execute sp_helpdb ''pubs''')]")
A5  =EXECUTE(chan,"[copy.special(true,false,2,1)]")
A6  =PASTE()
A7  =TERMINATE(chan)
A8  =RETURN()
<P>
NOTE: There are two single quotation marks before the parameter pubs
and three single quotation marks after.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide," version 3.0, pages 142-143
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 2.1 2.10 3.0 3.00 qe sql.query<BR>
db.sql.query<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 3, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
