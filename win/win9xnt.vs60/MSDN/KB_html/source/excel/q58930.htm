

<HTML>
<HEAD>
<TITLE>Lotus 1-2-3 Files and the 1904 Date System </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q58930 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1990/02/21">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When (from Microsoft Excel for Windows or OS/2 or from Lotus 1-2-3) you open a previously saved Microsoft Excel file and find that all date entries are four years and one day less than they should be, the problem could have one of two causes:  1. T...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QACE,QAUR,QAR4,QAJC,QABM,QDO9,QAY2,QBV8,QAKC,QDL9,QBWQ,QBWO,QBWN,QAGJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Lotus 1-2-3 Files and the 1904 Date System</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q58930 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for OS/2, versions 2.2, 2.21, 3.0
<LI>Microsoft Excel for the Macintosh, versions 2.x, 3.0, 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When (from Microsoft Excel for Windows or OS/2 or from Lotus 1-2-3)
you open a previously saved Microsoft Excel file and find that all
date entries are four years and one day less than they should be, the
problem could have one of two causes:

<OL><P><LI>The file originated from a version of Microsoft Excel for the
   Macintosh prior to Version 2.20. Prior versions use a date system
   that begins in 1904, rather than 1900 as used by Microsoft Excel for
   Windows, Microsoft Excel for OS/2, and Lotus 1-2-3.
<P>
   To correct the problem in Microsoft Excel, choose Options Calculation
   and check the 1904 Date System option. Lotus 1-2-3 does not have this
   option (see the recalculation procedure below).

<P><LI>You previously saved the file in Microsoft Excel in either the WK1 or
   the WKS format. These formats cause Excel to save the file's dates
   based on the standard translations of the serial values, not the 1904
   Date System translations.
<P>
   To correct the problem, see item 1 above.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The problem most likely occurs when the file originated from a version
of Microsoft Excel for the Macintosh prior to Version 2.20. All
versions of Microsoft Excel use a serial time format and store dates
as a single number. Microsoft Excel for the Macintosh (prior to
Version 2.20) begins counting dates from the number 0, which
corresponds to January 1, 1904. Microsoft Excel for Windows and
Microsoft Excel for OS/2 begin counting dates from the number 1, which
corresponds to January 1, 1900 --- hence the four-year-and-one-day
difference between the Macintosh and IBM-compatible versions.
<P>
Microsoft Excel for Windows and Microsoft Excel for OS/2 have an
option to correct the inconsistency between the programs when
importing Macintosh files to the PC environment: the 1904 Date System
option under Options Calculation. If this option is not selected when
a file from Macintosh Excel is imported, then all dates will be four
years and one day behind the dates entered when the file was used with
Macintosh Excel. When the option is selected, Microsoft Excel for
Windows and OS/2 add four years and one day from the standard
translation it uses from the underlying serial value.
<P>
This option does not change the underlying serial value, however, and
when Excel saves the file in either the WK1 or the WKS format, it
saves the file's dates based on the standard translations of the
serial values, not the 1904 Date System translations. Consequently,
when the file is opened in Lotus 1-2-3, or reopened in Excel for
Windows or OS/2, the dates are four years and one day behind the
values typed into Excel. Although resetting the 1904 Date System
option will correct the problem in Excel, Lotus 1-2-3 has no such
feature.
<P>
For Lotus 1-2-3, the only way to correct the discrepancy (working in
Excel before exporting to Lotus) is to add 1462 to the underlying
serial value in each cell and disable the 1904 Date System option.
(The number 1462 is equal to three years of 365 days each, plus one
leap year of 366 days, plus an extra day to account for the fact that
Macintosh Excel starts counting days at 0, whereas Excel for Windows
starts counting at 1.)
<P>
For a large sequence of dates, this recalculation can be accomplished
quickly by using the following method:

<OL><P><LI>Type the number 1462 into a cell.

<P><LI>Select the cell.

<P><LI>Choose Edit Copy.

<P><LI>Select the range of dates to be converted.

<P><LI>Choose Edit Paste Special, activate the Paste Values and Operation
    Add options and choose OK (or press ENTER).

<P><LI>Repeat Steps 3-5, as necessary, for other date ranges.

<P><LI>Disable the 1904 Date System option under Options Calculation.

<P><LI>Save the file.
<P>
</OL>All dates are now saved in the standard format, and Lotus 1-2-3 should
read them properly.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 2.20 2.21 2.10 3.00 4.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
