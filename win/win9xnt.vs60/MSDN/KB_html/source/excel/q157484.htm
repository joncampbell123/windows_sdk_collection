

<HTML>
<HEAD>
<TITLE>XL97: Error When Using Validation Drop-Down List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157484">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/10/11">
<META NAME="Keywords" CONTENT="xlformula xlui">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, when you select a value in a validation drop-down list box, you may receive the following error message:     The cell or chart you are trying to change is protected and therefore    read-only.  and you are unable to select a ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBV3,QAKR,QA9Z,QBVP,QDNZ,QAKD,QBWS,QAE1,QBJZ,QANX,QBV4,QDMR,QA2Q,QAK7 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error When Using Validation Drop-Down List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157484</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, when you select a value in a validation drop-down
list box, you may receive the following error message:
<P>
<PRE>   The cell or chart you are trying to change is protected and therefore
   read-only.

</PRE>and you are unable to select a value in the list.
<P>
<P><h2>CAUSE</h2>
 
<P>
This will occur if all of the following conditions are true:

<UL><LI>The validation drop-down list box does not refer to a range of cells
   for its values, but instead contains them directly.
<P>
<P><PRE>    -and-
</PRE>
<LI>The cell containing the validation drop-down list is locked.
<P>
<P><PRE>    -and-
</PRE>
<LI>The worksheet containing the cell is protected.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
There are two possible workarounds for this problem: you can either unlock
the cell that contains the validation drop-down list box, or you can set
the validation drop-down list so that it refers to a range of cells, rather
than directly containing its own values.
<P>
<P><h3>Method 1: Unlock the Cell Containing the Drop-Down List Box</h3>
 
<P>
<PRE>          a. If the worksheet in question is currently protected, click the
             Tools menu, point to Protection, and click "Unprotect Sheet".
             If you are prompted for a password, enter it and click OK.

          b. Select the cell that contains the validation drop-down list.
             On the Format menu, click Cells.

          c. Click the Protection tab.

          d. Clear the "Locked" checkbox and click OK.

          e. Repeat steps 2-4 for any other cells in your worksheet that
             contain validation drop-down boxes.

          f. Once all necessary cells have been unlocked, restore the
             protection on your worksheet. Point to Protection on the
             Tools menu, and click Protect Sheet (enter a password if
             necessary).

</PRE><h3>Method 2: Make Your Drop-Down List Box Refer to a Range of Cells</h3>
 
<P>
When you create a validation drop-down list box, you can either input a
list of values:
<P>
<PRE>   One, Two, Three, Four

</PRE>Or, you can set the list box to refer to a range of cells for its values:
<P>
<PRE>   A1: One
   A2: Two
   A3: Three
   A4: Four

</PRE>Validation drop-down list boxes created using this second method do not
experience any problems when used on a protected worksheet.
<P>
To create a validation drop-down list box that refers to a range of cells
for its values, follow these steps:

<OL><P><LI>Select the cell that is to contain a validation drop-down list box.

<P><LI>On the Data menu, click Validation.

<P><LI>Click the Settings tab.

<P><LI>In the Allow list box, click "List". Click in the Source edit box,
   and then either use the mouse to select a range on the worksheet, or
   enter the range manually. The range in the edit box should look
   something like this:
<P>
<P><PRE>      =$A$1:$A$4
</PRE>
<P><LI>Click OK.
<P>
</OL>The new validation drop-down list box will work correctly, even if the
worksheet is protected.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel 97 includes a new feature called validation. You can use
validation to make sure that users only enter specific values, or specific
types of values, into cells in Microsoft Excel.
<P>
One validation option allows you to attach a drop-down list box to a cell
when the cell is selected. If you use this option, users can only enter
values in the cell that are contained within the list box. The list box can
obtain its values from two different sources: the list box can refer to a
range of cells for its values, or it can contain them directly.
<P>
To create a validation drop-down list box that directly contains its own
values, follow these steps:

<OL><P><LI>Select the cell that is to contain a validation drop-down list box.

<P><LI>On the Data menu, click Validation.

<P><LI>Click the Settings tab.

<P><LI>In the Allow list box, click "List". In the Source edit box, type a
   list of values, separated by commas. For example:
<P>
<P><PRE>      One, Two, Three, Four
</PRE>
<P><LI>Click OK.
<P>
</OL>When you select the cell, the drop-down list box appears, and you can
select a value from the list. You cannot manually type a value into the
cell.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about validation drop-down list boxes in Microsoft
Excel, click the Index tab in Microsoft Excel Help, type the following text
<P>
<PRE>   data validation, drop-down

</PRE></OL>and click Display to go to the "Specify the valid entries for cells" help
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00<BR>
Keywords          : xlformula xlui<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
