

<HTML>
<HEAD>
<TITLE>Excel: Resetting Last Cell Address Fixes Memory/Printing Probs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100406">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1993/06/22">
<META NAME="Keywords" CONTENT="kbusage kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can press CTRL+END to select the last cell in a cell table or dependency table. In some cases this cell may be well beyond the actual data in your worksheet. In some cases, this cell may result in memory or printing problems...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAML,QBVP,QBJZ,QBWS,QAEF,QBXS,QA2Q,QAG2,QDNZ,QAJX,QAH4,QADR,QAY2,QAUR,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Resetting Last Cell Address Fixes Memory/Printing Probs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100406</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.x, 4.x, 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can press CTRL+END to select the last cell in a
cell table or dependency table. In some cases this cell may be well beyond
the actual data in your worksheet. In some cases, this cell may result in
memory or printing problems.
<P>
To reset the last cell address, you must clear all information (data and
formatting) from the unused columns and rows of your sheet.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you are working with a large sheet that contains many formulas or a lot
of formatting, you may experience similar memory problems when you attempt
to copy and paste information.
<P>
<P><h2>Workarounds</h2>
 
<P>
To work around this problem, do any of the following:
<P>
<P><h3>Reset the last cell by deleting excess rows and columns</h3>
 

<OL><P><LI>Select all rows and or columns that do not include any data by
   selecting the appropriate row and/or column headings.

<P><LI>From the Edit menu, choose Clear and select the All option.

<P><LI>From the Edit menu, choose Delete.

<P><LI>Repeat steps 1-3 for as many columns or rows as is necessary.

<P><LI>From the File menu, choose Save As and save the file with another
   name.

<P><LI>Close the file and reopen it.
<P>
</OL><h3>Use the following macro to clear blank cells</h3>
 
<P>
WARNING: ANY USE OF THE CODE PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK.
Microsoft provides this macro code "as is" without warranty of any kind,
either expressed or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.

<OL><P><LI>In a macro sheet, enter the following:
<P>
<P><PRE>      A1: ClearCells
      A2: =ERROR(FALSE)
      A3: =ECHO(FALSE)
      A4: =SELECT.LAST.CELL()
      A5: =ROW(ACTIVE.CELL())
      A6: =IF(ISBLANK(ACTIVE.CELL()),CLEAR(1))
      A7: =IF(AND(ROW(ACTIVE.CELL())=1,COLUMN(ACTIVE.CELL())=1),
<PRE></PRE>           RETURN(),IF(ROW(ACTIVE.CELL())=1,SELECT(OFFSET(ACTIVE.CELL(),
           A5-1,-1)),SELECT(OFFSET(ACTIVE.CELL(),-1,0))))
      A8: =GOTO(A6)

</PRE><P><LI>Select cell A1 and choose Define Name from the Formula menu. Select
   the Command button and choose OK.

<P><LI>Activate the worksheet. Choose Run from the Macro menu and run the
   ClearCells macro.
<P>
</OL>After the macro has finished running, save the worksheet, close it, and
then reopen it. Your last cell (the cell you get when you press CTRL+END)
should be the last cell that contains data.
<P>
CAUTION: This macro will delete ALL cell contents (formats, notes, and
defined names) that do not have a physical entry within the cell.
<P>
NOTE: The ERROR(FALSE) and ECHO(FALSE) functions in cells A2:A3 are not
required for this macro to run correctly; however, these functions do
significantly increase performance.
<P>
To create an example to try the above procedures, do the following:

<OL><P><LI>Open a new Sheet.

<P><LI>Create cell entries from A1 to F15.

<P><LI>In cell H25, type a number and then clear the value from that cell.

<P><LI>From the Formula menu, choose Select Special. When you select the
   Last Cell option and choose OK button, cell H25 is selected.
<P>
</OL>If you select row number 25 and choose Delete from the Edit menu, and
select column H and choose Delete from the Edit menu. The cell address
remains H25 until you select a cell in the A1 to F15 range and save the
file.
<P>
NOTE: If you are using Microsoft Excel version 3.0 or earlier, H25 will
remain the last cell address until you close the file and reopen it. In
versions 4.0a and 5.0, you can Clear All and then Save; it is not necessary
to reopen the file.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Function Reference," version 4.0, pages 57, 122, 135, 364
"Function Reference," version 3.0, pages 33, 62, 68, 201
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory: kberrmsg
<P>

Additional reference words: 7.00 3.00 4.00 4.00a erase pointer HOWTO
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
