

<HTML>
<HEAD>
<TITLE>XL: Incorrect Argument with Recorded OpenLinks Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115693">
<META NAME="KBModify" CONTENT="1996/09/13">
<META NAME="KBCreate" CONTENT="1994/06/01">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you use the macro recorder to record a Visual Basic macro, and you choose the Open button in the Links dialog box to open a linked document, the OpenLinks method is recorded with an incorrect ReadOnly argument if the link is ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBVP,QBS0,QAIH,QA5V,QAHE,QAH4,QA9Q,QBWS,QAE2,QBMR,QAUJ,QAB4,QAAP,QAP2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Incorrect Argument with Recorded OpenLinks Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 13, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115693</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you use the macro recorder to record a Visual
Basic macro, and you choose the Open button in the Links dialog box
to open a linked document, the OpenLinks method is recorded with an
incorrect ReadOnly argument if the link is an object linking and
embedding (OLE) link.
<P>
Note that this behavior does not cause an error message to appear
when you run the macro. The recorded macro runs correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you record a Visual Basic macro, where you use the Open button
in the Links dialog box to open an OLE link, the OpenLinks method is
recorded with a ReadOnly argument value of 2. For example, if you use
the macro recorder to open a linked Microsoft Word document,
C:\DOCUMENT\REPORT.DOC, the recorded macro contains the following
command:
<P>
<PRE>   ActiveWorkbook.OpenLinks Name:= _
      "Word.Document.6|C:\DOCUMENT\REPORT.DOC!!DDE_LINK1", ReadOnly:=2

</PRE>This value is incorrect, because the ReadOnly argument should have a
value of True or False (Boolean value). However, the recorded macro
runs correctly, because the recorded argument is accepted as the type
argument. The value 2, used with the type argument, indicates an OLE
type link (xlOLELinks).
<P>
The following is the command that should be recorded when you open
the linked Microsoft Word document, C:\DOCUMENT\REPORT.DOC, using the
Open button in the Links dialog box (although it has the same
behavior as the incorrect code above):
<P>
ActiveWorkbook.OpenLinks Name:= _
<PRE>      "Word.Document.6|C:\DOCUMENT\REPORT.DOC!!DDE_LINK1", Type:=2

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft
products listed at the beginning of this article. We are researching
this problem and will post new information here in the Microsoft
Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the OpenLinks Method in a Visual Basic macro to open a
file that contains information that is linked to your Microsoft Excel
worksheet. The file may be another worksheet, or a document in
another application, such as a Microsoft Word document.
<P>
The OpenLinks method has the following named arguments: name, readOnly, and
type. Name is the only required argument. However, if you only use the name
argument, the link type is assumed to be xlExcelLinks. If you omit the type
argument, and the link type is OLE, you receive a "Cannot find &lt;filename&gt;"
error message and the linked file is not opened.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the OpenLinks Method, choose the Search button
in the Visual Basic Reference and type:
<P>
<PRE>   OpenLinks Method
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 1.00 5.00 5.00a 5.00c 7.00 7.00a
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 13, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
