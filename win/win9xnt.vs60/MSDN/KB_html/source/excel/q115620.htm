

<HTML>
<HEAD>
<TITLE>XL5: Problems with MultiSelect Property of ListBox Class </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115620">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/05/31">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, when you use the MultiSelect property for ListBox objects in a Visual Basic, Applications Edition, macro, you may experience either of the following problems:   - You receive the error message:     Run-time error '10...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBVR,QBVP,QAB4,QAW6,QBS0,QAAP,QBXS,QAKJ,QAHP,QAKP,QBWC,QBV8,QAB9,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Problems with MultiSelect Property of ListBox Class</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115620</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, when you use the MultiSelect property for
ListBox objects in a Visual Basic, Applications Edition, macro, you may
experience either of the following problems:

<UL><LI>You receive the error message:
<P>
   Run-time error '1005':  Unable to set the MultiSelect property of the
   ListBox class
<P>
   -or-

<LI>The MultiSelect property that is actually defined for the list box is
   not the one you expected.
<P>
</UL><h2>CAUSE</h2>
 
<P>
The Microsoft Excel version 5.0 constants xlNone, xlSimple, and xlExtended
are mapped to the wrong values.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
For the MultiSelect property, use the values 1, 2, and 3 in place of the
constants xlNone, xlSimple, and xlExtended (respectively).
<P>
<PRE>   To set the selection mode
   of a list box to this          Use this value
   -----------------------------------------------------

   Single select                  &lt;object&gt;.Multiselect = 1
   Simple multi-select            &lt;object&gt;.MultiSelect = 2
   Extended multi-select          &lt;object&gt;.MultiSelect = 3

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel
version 5.0 for Windows. This problem was corrected in Microsoft Excel for
Windows, version 5.0c.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information about the expected behavior of these constants, choose
the search button in Visual Basic Help, and type:
<P>
<PRE>   Multiselect

</PRE>The following sections describe the ACTUAL behavior of each constant.
<P>
<P><h3>&lt;object&gt;.MultiSelect = xlNone</h3>
 
<P>
This command will produce the following error message:
<P>
<PRE>   Run-time error '1005':
   Unable to set the MultiSelect property of the ListBox class

</PRE><h3>&lt;object&gt;.MultiSelect = xlSimple</h3>
 
<P>
This command will cause the list box to behave as if it had the Single
select (xlNone) property.
<P>
<P><h3>&lt;object&gt;.MultiSelect = xlExtended</h3>
 
<P>
This command will cause the list box to behave as if it had the Simple
multi-select (xlSimple) property .
<P>
-also-
<P>
The help topic for the MultiSelect property in VBA_XL.HLP provides
the example
<P>
<PRE>   ActiveSheet.ListBoxes(1).MultiSelect = True

</PRE>and implies that this command will give the list box the Extended
multi-select (xlExtended) property. However, the actual behavior for this
property is as follows:

<UL><LI>&lt;object&gt;.Multiselect = True: This command will cause the list box to
   behave as if it had the Single select (xlNone) property.

<LI>&lt;object&gt;.Multiselect = False: This command will produce the error
   message:
<P>
<P><PRE>      Run-time error '1005':
      Unable to set the MultiSelect property of the ListBox class
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 5.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
