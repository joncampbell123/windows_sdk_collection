

<HTML>
<HEAD>
<TITLE>Excel: General Protection Fault in Module GENDRV.DLL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89981 ">
<META NAME="KBModify" CONTENT="1997/10/06">
<META NAME="KBCreate" CONTENT="1992/10/06">
<META NAME="Keywords" CONTENT="kbfile kbprint">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you run Microsoft Excel under Microsoft Windows 3.1 or Windows for Workgroups version 3.11, and you print a document or view it in print preview, you may receive a general protection (GP) fault in module Gendrv.dll.  CAUSE =====  This problem ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBVP,QACT,QDL9,QBWN,QAOX,QADF,QBS9,QBJZ,QAUR,QDKW,QDNN,QAJ6,QBWS,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: General Protection Fault in Module GENDRV.DLL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89981 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0
<LI>Microsoft Windows operating system version 3.1
<LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Microsoft Excel under Microsoft Windows 3.1 or Windows for
Workgroups version 3.11, and you print a document or view it in print
preview, you may receive a general protection (GP) fault in module
Gendrv.dll.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when you change the printer driver to Gendrv.dll and
you previously used a different printer driver with the document.
<P>
Microsoft Excel saves printer information with each file. Gendrv.dll and
other printer drivers access some of this information through a print
quality table. Most printer drivers (those that use Unidrv.dll, for
instance) use positive values in this table; however, Gendrv.dll uses
negative values. Because Gendrv.dll does not do any error checking, it
hangs (stops responding) when it encounters the positive values created by
another driver.
<P>
This problem has been reported to occur with the following printers and
printer drivers:
<P>
<PRE>   Canon LBP
   Canon LBP4
   DecLaser 1100
   Epson LQ 1050
   Epson2lq.drv
   Gendrv.dll (dated 8/4/92)
   Gendrv.dll (dated 11/1/93)
   Gendrv.dll (dated 1/4/94)
   Gendrv.dll (dated 12/31/93)
   HP Vectra 486
   IBM 4019 Laser Printer
   IBM 40xx
   IBM Laserprinter 10L
   Okidata 810

</PRE>WARNING: The information in this article has not been confirmed or tested
by Microsoft. Some or all of the information in this article has been taken
from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION
PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this
information "as is" without warranty of any kind, either express or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, copy the Gendrv.dll file dated 7/31/92 to your
Windows\System directory.
<P>
The following file(s) are available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/gendrv.exe">Gendrv.exe</A> <I>(size: 58455 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>WORKAROUNDS</h2>
 
<P>
If you are unable to obtain the Gendrv.dll driver, use any of the following
methods to work around this problem.
<P>
Method 1: Copy all of the data in the worksheet to a new file. The printer
<PRE>          information will not be copied.

          Note that character formatting may be lost when you use this
          workaround.

</PRE>Method 2: Another workaround is to save the file in SYLK format. Close the
<PRE>          file, then open the SYLK file and print it. SYLK format will save
          the printer information.

</PRE>Method 3: Select the entire document, and click Copy on the edit menu. In
<PRE>          the same sheet, click Paste Special on the Edit menu, and select
          Values or Formulas. Then, click Paste Special, and click Formats.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.0 4.00 4.0a 4.00a 5.00 5.00c gp gpf windrvr<BR>
wfw wfwg<BR>
Keywords          : kbfile kbprint<BR>
Version           : 4.00 4.00a 5.00 5.00c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
