

<HTML>
<HEAD>
<TITLE>XL97: Cannot Use Edit Query Button on Sheet With Web Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158247">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/10/25">
<META NAME="Keywords" CONTENT="xlquery xlweb kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you click the  Edit Query  toolbar button on the  External Data  toolbar, you may receive the following error message:     This external data range contains data from a Web query. Web queries    cannot be edited  and your only option is to cli...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAVZ,QACF,QAYY,QBWS,QAQW,QAMB,QDKX,QA5D,QATX,QAY2,QAWM,QAXC,QBQU,QBI0 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Cannot Use Edit Query Button on Sheet With Web Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158247</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you click the "Edit Query" toolbar button on the "External Data"
toolbar, you may receive the following error message:
<P>
<PRE>   This external data range contains data from a Web query. Web queries
   cannot be edited

</PRE>and your only option is to click OK.
<P>
<P><h2>CAUSE</h2>
 
<P>
You cannot edit Web queries from within Microsoft Excel. The Edit Query
button on the External Data toolbar is used to edit queries created in
Microsoft Query.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To edit your Web query, you need to open the .iqy file you created for the
Web query using a text editor like Notepad.
<P>
<P><h2>STATUS</h2>
 
<P>
This is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Like any other data query in Microsoft Excel, a Web query is a tool to
extract information from a Web site and return it back to your worksheet.
<P>
A Web query is performed by doing the following:

<OL><P><LI>Create a Web query file (.iqy extension) with the following structure:
<P>
   Type of Query
   Version of Query
   URL
   Post Parameters (not required for "Get" queries)
<P>
</OL>Microsoft Office installs several sample Web query files in the \Program
Files\Microsoft Office\Queries folder. The following is the text of the
"Dow Jones Stocks by PC Quote, Inc.iqy" file in this folder:
<P>
<PRE>   WEB
   1
   <B>http://webservices.pcquote.com/cgi-bin/exceldow.exe?</B>

</PRE></OL>NOTE: This is a "Get" query because the fourth line of text is not used.

<OL><P><LI>In Microsoft Excel 97 point to "Get External Data" on the Data menu and
   then click "Run Web Query."

<P><LI>In the "Run Query" dialog box, locate and select your .iqy file, and
   then click "Get Data."

<P><LI>Based on the type of Web query file you created, you may have to specify
   some information for the Web query.
<P>
</OL>Your query will be performed and, if successful, the data will be returned
to the location you specified.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q157482.htm">Q157482</A></B>
   TITLE     : XL97: How to Create Web Query (.iqy) Files


</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about Web Queries, click the Index tab in Microsoft
Excel 97 Help, type the following text
<P>
<PRE>   web, queries

</PRE>and then double-click the selected text to go to the "Get data from a Web
source" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 XL97 www http htm internet intranet<BR>
Keywords          : xlquery xlweb kberrmsg kbtool<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
