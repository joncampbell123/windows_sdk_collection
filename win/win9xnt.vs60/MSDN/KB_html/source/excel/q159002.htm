

<HTML>
<HEAD>
<TITLE>XL97: Deleting Sheet and Closing Workbook Causes Crash </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159002">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1996/11/08">
<META NAME="Keywords" CONTENT="xldraw xlloadsave kbualink97">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you close a workbook in Microsoft Excel 97, you receive one of the following error messages:     EXCEL caused an invalid page fault in module EXCEL.EXE at    014f:300a05e7.     -or-     EXCEL caused an invalid page fault in module EXCEL.EXE at...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBPV,QAGB,QAB4,QA9N,QASB,QBJZ,QAPN,QAEF,QAW6,QAAW,QDOO,QBCT,QAUR,QAGC P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Deleting Sheet and Closing Workbook Causes Crash</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159002</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you close a workbook in Microsoft Excel 97, you receive one of the
following error messages:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at
   014f:300a05e7.

   -or-

   EXCEL caused an invalid page fault in module EXCEL.EXE at
   0137:300a05e7.

</PRE>and Microsoft Excel 97 stops responding.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur when all of the following conditions are true:

<UL><LI>One of the sheets in the workbook contains a drawing object or
   AutoShape, and you copy the drawing object or Autoshape by clicking
   Copy on the Edit menu.
<P>
<P><PRE>    -and-
</PRE>
<LI>You delete the sheet that contains the copied object.
<P>
<P><PRE>    -and-
</PRE>
<LI>You closed the workbook without saving it.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, do either of the following:

<UL><LI>Save the workbook before you close it.
<P>
<P><PRE>    -or-
</PRE>
<LI>Clear the copied drawing object or AutoShape from the clipboard. To do
   this, use the following steps:
<P>
<P><PRE>      1. Select any cell in a worksheet.
</PRE><P>
<P><PRE>      2. On the Edit menu, click Copy, and then, press ESC.
</PRE><P>
</UL>After you use either of these methods, you can close the workbook without
receiving any error messages.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you copy a drawing object or Autoshape in Microsoft Excel 97, a
pointer to the copied object is stored in the clipboard. If you delete the
sheet that contains the copied object, and then close the workbook without
saving it, the pointer refers to an object on a nonexistent sheet. This may
cause you to receive either of the error messages.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xldraw xlloadsave kbualink97<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
