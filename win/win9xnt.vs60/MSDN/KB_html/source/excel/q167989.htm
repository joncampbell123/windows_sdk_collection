

<HTML>
<HEAD>
<TITLE>XL97: NLFs that use Restricted Labels Return #VALUE! Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167989">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1997/05/02">
<META NAME="Keywords" CONTENT="kbusage xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you enter a natural language formula in Microsoft Excel 97, the following problems may occur:   - The formula returns a #VALUE! error.     -and-   - One of the words in the formula is displayed completely in upper case,    for example:        ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QAMB,QBVP,QAK9,QAB9,QAUD,QAY5,QAVS,QATQ,QAE6,QAUI,QDO8,QAKD,QAA8,QBVV P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: NLFs that use Restricted Labels Return #VALUE! Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167989</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you enter a natural language formula in Microsoft Excel 97, the
following problems may occur:

<UL><LI>The formula returns a #VALUE! error.
<P>
   -and-

<LI>One of the words in the formula is displayed completely in upper case,
   for example:
<P>
<P><PRE>      =Alpha DELTA
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
This problem occurs if the natural language formula contains any
restricted labels. You can determine whether a label is restricted by
using either of the methods on the "More Information" section.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around these problems, enclose the labels in the natural language
formulas in apostrophes ('). The apostrophes force Microsoft Excel 97 to
evaluate the words as labels not as functions. As a result, the problems
described in this article do not occur.
<P>
For example, instead of using the following formula
<P>
<PRE>   =Alpha Delta

</PRE>use this formula:
<P>
<PRE>   ='Alpha' 'Delta'

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you enter a formula in Microsoft Excel 97, the formula is parsed by
the program so that Microsoft Excel 97 can evaluate the formula. If part of
the formula can be interpreted as a label (for example, when a table using
the label exists on the worksheet) or as a function (for example, when an
add-in that contains a function with that name is open) Microsoft Excel 97
assumes that the formula should use the function, not the label.
<P>
For example, if you enter the following table into a worksheet
<P>
<PRE>               B1: Charlie   C1: Delta
   A2: Alpha   B2: 1         C2: 3
   A3: Bravo   B3: 2         C3: 4

</PRE>and then enter the formula
<P>
<PRE>   =Alpha Delta

</PRE>you may receive a #VALUE! error and the formula may change to
<P>
<PRE>   =Alpha DELTA

</PRE>These problems occur if the Analysis Toolpak add-in is loaded into random
access memory because the add-in contains a function called Delta.
Microsoft Excel 97 assumes that you want the formula to use the Delta
function in the add-in not the Delta label in the worksheet.
<P>
If the add-in that provides the function is not loaded into memory, the
formula should function correctly. However, if you load the add-in, the
formula may stop functioning. Use the workaround in this article to prevent
this problem from occurring.
<P>
<P><h3>Determining Whether a Label is Restricted</h3>
 
<P>
To determine whether a label is restricted, use either of the following
methods.
<P>
Method 1:

<OL><P><LI>In a new worksheet, enter the following values
<P>
<PRE>      A1:         B1: Charlie   C1: &lt;Label&gt;
      A2: Alpha   B2: 1         C2: 3
      A3: Bravo   B3: 2         C3: 4

   where &lt;Label&gt; is the label you want to test.

</PRE><P><LI>Enter the following formula into cell A5:
<P>
<P><PRE>      =Alpha &lt;Label&gt;
</PRE><P>
   If the formula returns 3, the label you entered in C1 is not restricted.
   If the formula returns a #VALUE! error, and the formula in cell A5
   changes to
<P>
<P><PRE>      =Alpha &lt;LABEL&gt;
</PRE><P>
 the label you entered is restricted.
<P>
</OL>Method 2:

<OL><P><LI>Select an empty cell in a worksheet.

<P><LI>On the Standard toolbar, click Paste Function.

<P><LI>In the Function Category list, click All.
<P>
   Names that appear in the Function Name list in Proper format (only the
   first letter is upper case) are restricted.
<P>
</OL>The following words are restricted labels:
<P>
<PRE>   Complex    Imaginary     Workday
   Convert    Lcm           Yield
   Delta      Multinomial
   Disc       Networkdays
   Duration   Quotient
   Effect     Received
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords            : kbusage xlformula<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
