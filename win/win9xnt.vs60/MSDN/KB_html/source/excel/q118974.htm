

<HTML>
<HEAD>
<TITLE>GP Fault Using DDEExecute with Multiple Commands </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118974">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1994/08/03">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you use the dynamic data exchange (DDE) Execute statement to send commands to Microsoft Excel, you receive a general protection (GP) fault if the Execute statement contains multiple commands.  CAUSE =====  This problem occurs because there is a ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBKN,QBJQ,QAB9,QAPN,QAZ2,QBV8,QAH6,QBUG,QBUF,QDL9,QBWQ,QBWO,QBWN,QAIH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>GP Fault Using DDEExecute with Multiple Commands</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118974</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.00a 5.00 5.00c 7.00
WINDOWS
kbinterop
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a, 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you use the dynamic data exchange (DDE) Execute statement to send
commands to Microsoft Excel, you receive a general protection (GP) fault if
the Execute statement contains multiple commands.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because there is a limit to the number of commands you
can send in a single DDEExecute statement. In Microsoft Excel version 4.0,
you receive a GP fault if you send more than 127 commands in one DDE
Execute statement. In Microsoft Excel version 5.0, you receive a GP fault
if you send more than 242 commands in a single DDE Execute statement.
<P>
In Microsoft Excel version 5.0c, you receive a GP fault if you send more
than 459 commands in a single DDE Execute statement.
<P>
In Microsoft Excel for Windows 95, version 7.0, the procedure fails when
195 commands are sent, but you receive a GP fault if you send more than 285
commands.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving a GP fault when you use the DDE Execute statement, do
not send more than 127 commands to Microsoft Excel in a single Execute
statement. Instead, use multiple Execute statements to send the commands.
For example, to run a macro and open a file in Microsoft Excel using DDE
commands in a Microsoft Word for Windows macro, use the following DDE
Execute commands
<P>
<PRE>   DDEExecute channel, "[RUN(" + Chr$(34) + "MACRO1!R1C1" + Chr$(34) + ")]"
   DDEExecute channel, "[OPEN("+ Q$+ "TEST.XLS"+ Q$+")]"

</PRE>where channel is the DDE channel number returned by the DDEInitiate
statement.
<P>
For additional information, see the following article(s) in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q94713.htm">Q94713</A></B>
   TITLE     : Macros to Create DDE Connections Between WinWord and Excel



</PRE>Kbcategory: kbinterop
KBSubcategory:
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 4.00a 5.00 gpf err msg officeinterop<BR>
Version             : 4.00 4.00a 5.00 5.00c 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
