

<HTML>
<HEAD>
<TITLE>Excel: Calling a Code Resource Using CALL/REGISTER Routines </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q51089 ">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1989/11/17">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Microsoft Excel can call routines that have been compiled as code resources (sometimes referred to as dynamic link libraries, or DLLs).  Code resources are called from macros and operate much like function macros.  Before a resource can be called, ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAGI,QAIM,QBV8,QAB9,QAIF,QAHE,QBBI,QAPN,QAD7,QAY2,QAH7,QAH6,QABG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Calling a Code Resource Using CALL/REGISTER Routines</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q51089 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.20
MACINTOSH
<P>
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for the Macintosh, version 2.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Excel can call routines that have been compiled as code
resources (sometimes referred to as dynamic link libraries, or DLLs).
<P>
Code resources are called from macros and operate much like function
macros.
<P>
Before a resource can be called, it must first be registered to
Microsoft Excel using the REGISTER command. The REGISTER command loads
the code resource into memory and defines the parameters that the
resource will accept and return.
<P>
<P><h3>REGISTER Command</h3>
 
<P>
The following is the format of the REGISTER command:
<P>
<PRE>   REGISTER(file_name,resource_name,argument_types)

</PRE>"file_name" is the name of the file containing the code resource.
Microsoft Excel looks in the active directory for the file containing
the code resource, unless a pathname is specified.
<P>
"resource_name" is the name given to the code resource when it is
compiled. You must always specify a resource name, even if there is
only one code resource in the file.
<P>
"argument_types" is a text string specifying the argument type passed
to Microsoft Excel and the argument types passed from Microsoft Excel
to the code resource. Note that the first character specifies the
argument passed from the resource to Microsoft Excel, and the
subsequent characters specify the arguments passed from Microsoft
Excel to the code resource.
<P>
When the resource is successfully registered, the value of the cell
containing the REGISTER command is a text string that is used by the
CALL command. A registered command can be called multiple times.
<P>
Once registered, the code resource is called using the CALL command.
<P>
<P><h3>CALL Command</h3>
 
<P>
The following is the format of the CALL command:
<P>
<PRE>   CALL(call_text,argument1,argument2,...)

</PRE>"call_text" is the value returned by the REGISTER command. It is
almost always a reference to the cell containing the REGISTER command.
<P>
"argument1,argument2,..." is a list of up to 13 arguments passed from
Excel to the code resource. These arguments must match in number and
type the arguments specified in the REGISTER command. For buffers
passed to the resource, a comma is used with no argument.
<P>
When the resource is no longer used, it should be unregistered using
the UNREGISTER command to free memory taken by the resource.
<P>
<P><h3>UNREGISTER Command</h3>
 
<P>
The following is the format of the UNREGISTER command:
<P>
<PRE>   UNREGISTER(call_text)

</PRE>"call_text" is the value returned by the REGISTER command and is
almost always a reference to the cell containing the REGISTER command.
<P>
For more information on calling code resources from Excel, query on
the following words:
<P>
<PRE>   description and creating and code and resource and call and
   register and routine and problems and floating and point and
   decimal

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For more information on the CALL, REGISTER, and UNREGISTER commands,
see pages 201, 266-267, and 289, respectively, in the "Microsoft Excel
Functions and Macros" version 2.2 manual.
<P>
Additional information can be found in the "Microsoft Excel Technical
Reference for the Macintosh," which is available as part of the
Microsoft Excel Development Kit. To obtain this kit, call Microsoft End
User Sales and Services at (800) 426-9400.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 2.2 2.20<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
