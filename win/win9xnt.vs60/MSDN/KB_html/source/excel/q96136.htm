

<HTML>
<HEAD>
<TITLE>XL3/XL4: STDEVP Function Returns #NUM! Error Value </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96136 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/03/09">
<META NAME="Keywords" CONTENT="xlformula">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed at the beginning of this article,  the STDEVP function may return a #NUM! error value instead of a 0 (zero)  when all of the data items are identical.  CAUSE =====  Because the standard deviation is a measu...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QAKD,QAB9,QAKC,QAJQ,QAY5,QAAP,QAB4,QA70,QBQT,QBV8,QBC6,QALW,QBE7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL3/XL4: STDEVP Function Returns #NUM! Error Value</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96136 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0
<LI>Microsoft Excel for OS/2, version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed at the beginning of this article, 
the STDEVP function may return a #NUM! error value instead of a 0 (zero) 
when all of the data items are identical.
<P>
<P><h2>CAUSE</h2>
 
<P>
Because the standard deviation is a measures of how widely values are 
dispersed from the average value, the expected result when all values in 
the population are the same is 0. However, there may be some instances, 
where due to a rounding error, a #NUM! error value will be returned.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To see an example of how to work around this problem, enter the following 
sample data in a worksheet:
<P>
<PRE>   A1: .96   B1: .96
   A2: .96   B2: .96
   A3: .96   B3: .96
   A4: .96   B4: .96
   A5: .96   B5: .96

</PRE>The formula, =STDEVP(A1:B5), will return the #NUM! error value. One
alternative is to use the STDEV function. Using this date, STDEV will 
return 0 (zero) the correct result.
<P>
If the above workaround is not be a viable alternative due to
differences in the two functions, break down the components of the
functions as follows:

<OL><P><LI>Select cell C1 and enter the following formula:
<P>
<P><PRE>      {=10*(SUM(A1:B5^2))}
</PRE><P>
   Note that this formula must be entered as an array. In Microsoft Excel
   for Windows, press CTRL+SHIFT+ENTER; in Microsoft Excel for the
   Macintosh, press COMMAND+RETURN.

<P><LI>Select cell C2 and enter the following formula:
<P>
<P><PRE>      =SUM(A1:B5)^2
</PRE>
<P><LI>Select cell C3 and enter the following formula:
<P>
<P><PRE>      =ABS(C1-C2)
</PRE>
<P><LI>Select cell C4 and enter the following formula:
<P>
<P><PRE>      =SQRT(C3/(10^2))
</PRE><P>
</OL>The result will be zero.
<P>
<P><h2>STATUS</h2>
 
<P>
This is a known problem in the versions of Microsoft Excel listed at the 
beginning of this article. The problem was corrected in Microsoft Excel 5.0 
or later.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The STDEVP function returns the standard deviation of a population given 
the entire population as arguments. The STDEVP function is based on the 
following formula:
<P>
<PRE>   =SQRT(((n*(sum(x^2)))-(sum(x)^2))/n^2)

</PRE></OL>where n=number of values in the population and x=value.
<P>
When each of the x-values is the same, the formulas on either side of
the minus sign, (n*(sum(x^2))) and (sum(x)^2)), should evaluate to the
same value and when subtracted should equal zero. Zero divided by
another number is zero and the square root of zero is also zero.
<P>
If, however, the formula for the second sum is evaluated to a minutely
higher number, the result of the subtraction will be a negative
number. This number divided by n^2 would also be negative and because,
mathematically, the square root of a negative number is impossible, a
#NUM! error value will be returned. Given a population of equal
values, the rounding difference may occur in the course of squaring
and dividing values. If this difference results in a negative
numerator, the #NUM! error value will be returned.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, pages 419-420
"Microsoft Excel Function Reference," version 3.0, page 229
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 4.00 4.00a XL4 XL3<BR>
Keywords          : xlformula<BR>
Version           : WINDOWS:3.0,4.0,4.0a; MACINTOSH:3.0,4.0; os/2:3.0<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
