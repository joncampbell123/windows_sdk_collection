

<HTML>
<HEAD>
<TITLE>XL97: Problems When Macro Opens/Saves Text Files with Dates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171278">
<META NAME="KBModify" CONTENT="1998/01/14">
<META NAME="KBCreate" CONTENT="1997/07/10">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you run a Visual Basic for Applications macro that opens or saves a text file that contains dates, the following problems may occur:   - The month, day, and/or year of the dates may be reversed. For example,    if the text...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBRZ,QACE,QAUR,QATX,QDNE,QAKP,QAMB,QABA,QBAO,QAU7,QAO4,QBS0,QAH4,QBWS P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Problems When Macro Opens/Saves Text Files with Dates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 14, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171278</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you run a Visual Basic for Applications macro
that opens or saves a text file that contains dates, the following problems
may occur:

<UL><LI>The month, day, and/or year of the dates may be reversed. For example,
   if the text file contains the date 5/7/97, the date may be interpreted
   as May 7, 1997 instead of July 5, 1997.

<LI>Some dates may be converted into text strings. This problem may occur
   if the day or year of a date is greater than 12.
<P>
   For example, if the text file contains the date 30/7/97 (July 30, 1997),
   it may be converted into the text string "30/7/97" (without quotation
   marks).
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems may occur if you are using regional settings that use a date
order of day-month-year or year-month-day.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, install Microsoft Excel 97 Service Release 1
(SR-1).
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97. This
problem was corrected in Microsoft Excel 97 SR-1.
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, dates contain three elements: a year, a month, and a
day. The order in which these elements are displayed in a date depends on
the regional settings in use on your computer. These regional settings vary
from country to country. The three main ordering methods used for dates in
Microsoft Excel are listed in the following table.
<P>
<PRE>   Order            July 5, 1997 represented as
   --------------------------------------------

   month-day-year   7/5/97
   day-month-year   5/7/97
   year-month-day   97/7/5

</PRE>The first order, month-day-year, is used in the following regional settings
under Microsoft Windows 95 and Microsoft Windows NT:
<P>
<PRE>   English (United States)
   Spanish (Dominican Republic)
   Spanish (Panama)

</PRE>If your computer uses any of these three regional settings, the problems
described in the "Symptoms" section in this article do not occur.
<P>
However, if you use any other regional settings, you may encounter the
problems described in the "Symptoms" section in this article when you run a
Visual Basic macro that opens or saves a text file that contains dates.
This is because Microsoft Excel 97 may incorrectly use the month-day-year
order for dates. As a result, dates may be converted to the month-day-year
order. The following table contains an example.
<P>
<PRE>   Order            Date                    Converted to this order
   ----------------------------------------------------------------

   Day-month-year   5/7/97 (July 5, 1997)   5/7/97 (May 7, 1997)
   Year-month-day   97/7/5 (July 5, 1997)   97/7/5 (text string)

</PRE>Note that if the converted date is not valid in the month-day-year order,
the date is converted to a text string.
<P>
These problems do not occur if you manually open or save a text file that
contains dates. The problem occurs only when you use a macro to open or
save such a text file.
<P>
This problem does not occur in Microsoft Excel 97 SR-1. This new release of
Microsoft Excel 97 works correctly with all regional settings when you use
a macro to open or save text files that contain dates.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 australian canadian new zealand french german<BR>
italian british norwegian portuguese swedish danish ireland south africa<BR>
argentina chile colombia paraguay uruguay peru mexican costa rica ecuador<BR>
guatemala peru venezuela brazilian swiss icelandic indonesian afrikaans<BR>
basque catalan dutch belgian finnish luxembourg austrian liechtenstein<BR>
caribbean jamaica nynorsk bokmal sr1 y2k year2000<BR>
Keywords          : kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 14, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
