

<HTML>
<HEAD>
<TITLE>MSQuery: "Connection Failed" Error Connecting to SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125399">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/01/25">
<META NAME="Keywords" CONTENT="xlquery kbenv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you connect to an SQL Server data source, such as Microsoft SQL Server or Sybase SQL Server, you may receive the following error message:     Connection Failed:    SQLState: '08001'    SQL Server Error: -1    [Microsoft][ODBC SQL Server Driver...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBI0,QABM,QAB4,QBWP,QBTX,QAA1,QDI2,QAKG,QAI5,QDO9,QBVV,QDNT,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MSQuery: "Connection Failed" Error Connecting to SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125399</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Query for Windows, version 1.0
<LI>Microsoft Query for Windows 95, version 2.0
<LI>Microsoft Query for the Macintosh, version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you connect to an SQL Server data source, such as Microsoft SQL
Server or Sybase SQL Server, you may receive the following error message:
<P>
<PRE>   Connection Failed:
   SQLState: '08001'
   SQL Server Error: -1
   [Microsoft][ODBC SQL Server Driver]Unable to connect to data


</PRE><h2>CAUSE</h2>
 
<P>
This error message usually indicates that the client workstation cannot
find the SQL Server on the network. Possible causes for this problem
include the following:
<P>
<PRE>   If you are using Microsoft Query for Windows or Windows NT
   ----------------------------------------------------------

   - TCP/IP Sockets support has not been enabled on the SQL Server.

   - The client workstation has not been set up to run TCP/IP properly.

   - The SQL Server data source has not been setup with the proper TCP/IP
     address for the server.

   If you are using Microsoft Query for the Macintosh
   -------------------------------------------------

   - You may receive the error message stated above if the MacTCP Control
      Panel device has not been installed.


</PRE><h2>WORKAROUNDS</h2>
 
<P>
<P><h3>If you are using Microsoft Query for Windows or Windows NT</h3>
 
<P>
<P><h3>Method 1: Enable TCP/IP on the SQL Server (Windows NT)</h3>
 
<P>
To do this, follow these steps:

<OL><P><LI>Run the SQL Server Setup program from the SQL Server.

<P><LI>In Options dialog box, click the Change Network Support option, and
   then click Continue.

<P><LI>Make sure the TCP/IP Sockets option is selected, and then click
   OK.

<P><LI>The next two dialog boxes display the Port Number and Network Address.
<P>
   You should not need to change these, but you should verify that they are
   correct.

<P><LI>Return to Windows NT.
<P>
</OL><h3>Method 2: Configure the Client Workstation for TCP/IP Connectivity</h3>
 
<P>
Microsoft Query for the Macintosh:
<P>
In Microsoft Query for the Macintosh, you may receive the error message
described in the "Symptoms" section if the MacTCP Control Panel device has
not been installed. MacTCP is distributed with Apple Macintosh System 7.5.
To add the MacTCP icon to the Control Panels folder, run the Setup program
for System 7.5.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q120254.htm">Q120254</A></B>
   TITLE     : "Configuring MacTCP for ODBC Use"
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.00 2.00 ODBC TCP IP connectivity<BR>
Keywords          : xlquery kbenv kbnetwork<BR>
Version           : WINDOWS:1.0,2.0; MACINTOSH:1.00<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
