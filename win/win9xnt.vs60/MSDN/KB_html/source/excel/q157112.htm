

<HTML>
<HEAD>
<TITLE>XL: Cell References in Copied Formula Incorrect </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157112">
<META NAME="KBModify" CONTENT="1997/10/07">
<META NAME="KBCreate" CONTENT="1996/10/07">
<META NAME="Keywords" CONTENT="xlformula xlui kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you copy a formula in Microsoft Excel and then paste it into another cell, the formula that is pasted may not have the correct cell reference(s).  CAUSE =====  The formula that you paste may have the incorrect cell references if the formula yo...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDNZ,QA9N,QAB9,QAB3,QDMR,QASB,QAAP,QAR4,QAPF,QABA,QDL9,QBWQ,QBWO,QBWN P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Cell References in Copied Formula Incorrect</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157112</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
97
WINDOWS
kbusage
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you copy a formula in Microsoft Excel and then paste it into another
cell, the formula that is pasted may not have the correct cell
reference(s).
<P>
<P><h2>CAUSE</h2>
 
<P>
The formula that you paste may have the incorrect cell references if the
formula you copied is similar to the following example:
<P>
<PRE>   =SUM($B$1:B3)

</PRE>and you paste the formula to the left of the original location of the
formula.
<P>
Microsoft Excel always creates a cell range reference in a top-left to
bottom-right fashion. For example, if the formula is in cell C4 and you
copy and paste it to cell B4, because the first cell reference in the range
uses absolute referencing ($B$1), it will not change. But, the second cell
reference in the range uses relative referencing (B3) and will update
according to the relative location of the destination cell (in this example
it should change to A3 because the pasted cell is one cell to the left of
the copied cell). In this example, because of the referencing in the
original formula, the copied formula would have to be:
<P>
<PRE>   =SUM($B$1:A3)

</PRE>This is contrary (top-right, bottom-left fashion) to the way Microsoft
Excel creates range references in a formula, so it is automatically changed
to:
<P>
<PRE>   =SUM(A$1:$B3)

</PRE>which lists the range in the default top-left, bottom-right fashion.
Note: The cell range is correct, but the absolute references are incorrect.
<P>
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There is no way to work around this behavior in Microsoft Excel if your
ranges are created as in the example and you paste the formulas to the left
of the original formula. If the formula changes as in the example, manually
modify the range reference so the absolute references are correct.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Cell References in Formulas, click the Index tab
in Microsoft Excel 97 Help, type the following text
<P>
<PRE>   formulas, cell references

</PRE>and then double-click the selected text to go to the "About cell and range
references" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory: xlformula xlui<BR>
Additional reference words: XL97 xl<BR>
Keywords          : xlformula xlui kbusage<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
