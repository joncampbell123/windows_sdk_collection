

<HTML>
<HEAD>
<TITLE>XL: Crash Canceling Select Sheet Dialog Box for Change Links </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128422">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/04/02">
<META NAME="Keywords" CONTENT="xlgpf kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you cancel the Select Sheet dialog box that appears when you choose to change the source of a link on a chart in your document, the following may occur:  Microsoft Excel for Windows     You receive a general protection (GP) f...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAK6,QA2Q,QAG2,QAE2,QBWS,QA01,QAGB,QAB4,QBKN,QBVV,QAGC,QAGT,QAJQ,QBXA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Crash Canceling Select Sheet Dialog Box for Change Links</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128422</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you cancel the Select Sheet dialog box that appears
when you choose to change the source of a link on a chart in your document,
the following may occur:
<P>
<P><h3>Microsoft Excel for Windows</h3>
 
<P>
<PRE>   You receive a general protection (GP) fault.

   -or-

   The new source file that you selected in the Change Links dialog box
   appears in the Source File list along with the original source file. If
   you select the new source file and change the source again to this new
   source file, you receive a general protection (GP) fault.

</PRE><h3>Microsoft Excel for the Macintosh</h3>
 
<P>
<PRE>   The new source file that you selected in the Change Links dialog box
   appears in the Source File list along with the original source file. If
   you select the new source file and change the source again to this new
   source file, you receive the following error message:

      Sorry, a system error occurred.
      "Microsoft Excel"
      error type 11

</PRE><h3>Microsoft Excel for Windows NT</h3>
 
<P>
<PRE>   You receive the following error message

      External link is not valid

   and you are not able to change the source of the link to the new file.

</PRE><h2>CAUSE</h2>
 
<P>
This behavior occurs if you change the source of a link on a chart, if the
new source file that you select does not contain a worksheet with the same
name as the source worksheet.
<P>
For example, if your chart data is linked to [BOOK2]Sheet1!A1, the Select
Sheet dialog box appears when you change the source of the link if
BOOK1.XLS does not contain a worksheet with the name Sheet1.
<P>
In Microsoft Excel for Windows, if the chart is embedded on a worksheet,
you receive a GP fault if you choose Cancel in the Select Sheet dialog box.
<P>
In Microsoft Excel for the Macintosh, or Microsoft Excel for Windows with a
chart sheet, if you cancel the Select Sheet dialog box, the new source file
appears in the Source File list, but does not replace the previous source
file.
<P>
Note that this problem only occurs with linked data on a chart; it does not
occur with linked data on a worksheet.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To work around this problem, do not cancel the Select Sheet dialog box when
you change the source file for a link on your chart.
<P>
To change the source file for a link on your chart, you can do the
following:

<OL><P><LI>Open the workbook that you want to use for the new link.

<P><LI>Open the file that contains your chart.

<P><LI>On the chart, select the data point for which you want to change the
   source.

<P><LI>In the formula bar, select the reference to the currently linked
   file.

<P><LI>From the Window menu, choose the new source file.

<P><LI>On the new source worksheet, select the range you want to use as the
   source, and press ENTER.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Select Sheet dialog box appears when you choose a new source workbook
if the new source does not contain a sheet with the same name as the
currently linked sheet. This dialog box allows you to choose the name of
the worksheet to which you want to link.
<P>
Note that if you use the Change Links dialog box to select a new source
workbook that does not contain a worksheet with the same name as the linked
worksheet, you receive the following error message if the new source
workbook is closed:
<P>
<PRE>   External reference is not valid

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about redirecting links to source documents, choose
the Search button in Help and type:
<P>
<PRE>   links, remote, redirecting to moved or renamed
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 0002:0E02 gpf 7.00 ipf<BR>
Keywords          : xlgpf kberrmsg<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a; MACINTOSH:5.0,5.0a<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
