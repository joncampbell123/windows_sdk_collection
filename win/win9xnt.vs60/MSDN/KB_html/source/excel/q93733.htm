

<HTML>
<HEAD>
<TITLE>Excel: How to Calculate Odd and Even Negative Nth Roots </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q93733 ">
<META NAME="KBModify" CONTENT="1994/11/30">
<META NAME="KBCreate" CONTENT="1992/12/20">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you raise a negative value to a fractional exponent in Microsoft Excel, you may receive a #NUM error value. This error value may occur because the solution may not be defined in the real number system. To calculate the nth root of a negative n...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKC,QBVP,QBC6,QAL2,QAVV,QAG8,QBUJ,QAE5,QAB9,QDH9,QAKD,QABE,QAFI,QAWN,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: How to Calculate Odd and Even Negative Nth Roots</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 30, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q93733 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 4.0a, 5.0
<LI>Microsoft Excel for the Macintosh, versions 1.x, 2.x, 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, versions 2.2, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you raise a negative value to a fractional exponent in Microsoft
Excel, you may receive a #NUM error value. This error value may occur
because the solution may not be defined in the real number system. To
calculate the nth root of a negative number, use the appropriate formula
below.
<P>
Note: The formulas are different for even (1/2, 1/4,...) and odd (1/3,
1/5,...) roots.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Calculating Even Roots of Negative Numbers</h3>
 
<P>
Although even roots of negative numbers are undefined in the real number
system, they do have solutions in the complex number system. To calculate
these roots in Microsoft Excel, use complex number functions. The following
example demonstrates how to calculate the complex formula -25^(1/8):
<P>
<PRE> A1: =COMPLEX(-25,0)               B1: convert to a complex number
 A2: =IMSQRT(IMSQRT(IMSQRT(a1)))   B2: same as raising to power of 1/8

</PRE>Cell A2 returns the value 1.381522133 + 0.572245204i.
<P>
Note: This formula only works for roots that are a power of 2 (that is, 2,
4, 8,...).
<P>
For even roots that are not necessarily powers of 2, use the following
formula:
<P>
<PRE>  A1: &lt;Real part&gt;
  A2: &lt;Imaginary part&gt;
  A3: =COMPLEX(A1,A2)
  A4: =IMABS(A3)
  A5: =IMARGUMENT(A3)
  A6: &lt;desired root&gt; (2, 4, 6, 10,...)
  A7: &lt;number of iterations&gt;
  A8: &lt;Constant K&gt; goes from 0,1,...,(root-1)
  A9: =COS(A5/A6+A7)*(A4^(1/A6))
 A10: =SIN(A5/A6+A7)*(A4^(1/A6))
 A11: =COMPLEX(A9,A10)

</PRE>To use the above formula:

<OL><P><LI>Type the real part of you number in cell A1 and type the imaginary
   part of your number in A2 (if your number does not contain any
   imaginary parts, type 0 (zero) in cell A2).

<P><LI>In cell A6, type the desired root.

<P><LI>To get all possible results, enter values for K ranging from 0 to
   the desired root minus 1 (root-1).
<P>
   Note: Each time you enter a new value for K in cell A8, Microsoft
   Excel calculates the result. For this formula to work correctly,
   the Calculation option must be set to automatic (from the Options
   menu, choose Calculation and select the Automatic option under
   Calculation).
<P>
</OL>The result of each iteration appears in cells A9 to A11.
<P>
<P><h3>Calculating Odd Roots of Negative Numbers</h3>
 
<P>
Odd roots do exist in a real number system and can be calculated by taking
the odd root of the absolute value of the negative number and multiplying
the result by -1 (negative one). For example, to calculate the formula -
25^(1/3), follow the steps below:

<OL><P><LI>Find the absolute value of the negative number.

<P><LI>Find the nth root of the absolute value.

<P><LI>Multiply the answer by -1.
<P>
</OL>Your formula should resemble the following example:
<P>
<PRE>   A1: =(ABS(-25)^(1/3))*-1

</PRE></OL>This formula will return -2.92402.
<P>
If you have a column containing mixed positive and negative numbers, and
you want to calculate the nth odd roots for each of them, use the following
formula
<P>
<PRE> =IF(ISERROR(CellRef^(1/3)),(ABS(CellRef)^(1/3)*-1),CellRef^(1/3))

</PRE>where "CellRef" is the reference to the cell that contains the number. In
this formula, CellRef should reference the first cell in your column of
negative and positive numbers. To get results for each of the numbers in
your column of numbers, fill the formula down as needed.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Mathematical Applications," Ronald J. Harshbarger and James J. Reynolds,
D.C. Heath and Company, 1985, Massachusetts.
<P>
"Microsoft Excel Function Reference," version 4.0, pages 60, 228-235.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 1.0 1.00 1.03 1.04 1.06 1.5 1.50 2.0 2.00 2.01<BR>
2.1 2.10 2.2 2.20 2.21 3.0 3.00 4.0 4.00 4.0a 4.00a 5.0 5.00 calculation<BR>
error<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 30, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
