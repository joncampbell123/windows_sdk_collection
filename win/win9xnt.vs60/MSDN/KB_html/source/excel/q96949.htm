

<HTML>
<HEAD>
<TITLE>Excel: DIRECTORIES() Function Returns #N/A </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96949 ">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/04/01">
<META NAME="Keywords" CONTENT="BugList4.00 kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The DIRECTORIES() function in Microsoft Excel for Windows will return a #N/A error value if the specified directory contains more than 62 subdirectories. If the specified directory is your root drive, the limit will be 64 directories. This is a lim...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAFI,QBVP,QBXB,QATJ,QAUD,QABN,QBBI,QAY5,QBV8,QAB9,QALW,QBJQ,QAJB,QAPN,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: DIRECTORIES() Function Returns #N/A</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96949 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The DIRECTORIES() function in Microsoft Excel for Windows will return a
#N/A error value if the specified directory contains more than 62
subdirectories. If the specified directory is your root drive, the limit
will be 64 directories. This is a limitation of this function and as a
result, there is no workaround.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Microsoft
Excel listed above. We are researching this problem, and will post more
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DIRECTORIES() function is available after loading the FILEFNS.XLA add-
in macro and it returns a horizontal array of all of the subdirectories in
the specified path or the current directory. The only argument for the
DIRECTORIES() function is path_text. You use path_text to specify the full
path of the directory for which you want a list of subdirectories. If the
path_text argument is a root drive, as in the following example, the
directory limit will be 64:
<P>
<PRE>   =DIRECTORIES("D:\")

</PRE>If, the path_text argument includes a directory, as in the following
example, the limit will be 62:
<P>
<PRE>   =DIRECTORIES("D:\TEST")

</PRE>In this case, the horizontal array returned includes a dot (.) and a double
dot (..) for the first two entries. These entries limit the number of
actual subdirectories to 62. Following is an example of the first part of
the returned array:
<P>
<PRE>   ={".","..","TEST2","TEST3","TEST4"...}

</PRE><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, page 114
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 3.0 3.00 4.0 4.00 4.0a 4.00a
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
