

<HTML>
<HEAD>
<TITLE>XL97: Error Filling Large Numbers of Array Formulas </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171218">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/07/09">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you fill or copy a very large number of array formulas in a worksheet, the following problems may occur:   - You may receive the following error message:        This program has performed an illegal operation and will be s...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QBJQ,QAB9,QAKP,QAKC,QBCF,QAUD,QAM3,QDNM,QDO3,QAAP,QDNE,QBC6,QBCE P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error Filling Large Numbers of Array Formulas</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171218</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you fill or copy a very large number of array
formulas in a worksheet, the following problems may occur:

<UL><LI>You may receive the following error message:
<P>
<P><PRE>      This program has performed an illegal operation and will be shut
      down. If the problem persists, contact the program vendor.
</PRE><P>
   If you click Details, you receive the following error message:
<P>
<P><PRE>      EXCEL caused an invalid page fault in module EXCEL.EXE at
      0137:3011f337.
</PRE><P>
<P><PRE>    -or-
</PRE>
<LI>Array formulas may not appear after a certain point in the worksheet.
   When entered, filled, or copied, the formulas disappear.
<P>
<P><PRE>    -or-
</PRE>
<LI>An array formula may return a very small value, such as 3.2E-308 or
   3.5E-308.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems may occur if the worksheet contains more than 32,704 array
formulas that refer to another worksheet.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve the first and third problems that are described in the
"Symptoms" section, install Microsoft Excel 97 Service Release 1 (SR-1).
<P>
In Microsoft Excel 97, a single worksheet may contain a maximum of 32,704
array formulas that refer to another worksheet. If you want to use more
formulas, split the data into multiple worksheets so that there are fewer
than 32,704 references to a single worksheet.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97 for
Windows. The first and third problems that are described in the "Symptoms"
section were corrected in Microsoft Excel 97 SR-1.
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE>NOTE: The maximum number of array formulas is still 32,704.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, a single worksheet cannot contain more than 32,704
array formulas that refer to another specific worksheet. For example, in
Sheet1 of a workbook, you can create the following:

<UL><LI>32,704 array formulas that refer to Sheet2
<LI>32,704 array formulas that refer to Sheet3
<LI>32,704 array formulas that refer to Sheet4
<P>
</UL>If you attempt to create more than 32,704 array formulas that refer to a
specific worksheet, you may receive an error message. If you do not receive
an error message, the array formulas that you enter after the 32,704th
formula may disappear when you enter them.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 32700 sr1<BR>
Keywords          : kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
