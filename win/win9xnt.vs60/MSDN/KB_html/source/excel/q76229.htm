

<HTML>
<HEAD>
<TITLE>Executing a Stored Procedure Through Q+E May Cause UAE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76229 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1991/09/17">
<META NAME="Keywords" CONTENT="DB.SQL.QUERY SQL parameter sqlserver kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QA50,QAUD,QAIJ,QBWS,QAB9,QAKP,QAFO,QAFY,QDMW,QDIV,QBXS,QA9N,QA4F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Executing a Stored Procedure Through Q+E May Cause UAE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76229 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h2>SUMMARY</h2>
 
<P>
Executing a Stored Procedure on a SQL Server with two identical
parameters from a macro in Excel 3.0 may cause an Unrecoverable
Application Error (UAE) under Windows or a Protect Mode Violation
under OS/2.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
To duplicate this problem, run the following macro:
<P>
<PRE>   A2:  =ACTIVATE("SHEET1")
   A3:  =DB.LOGON("sqlserver")
   A4:  =DB.SQL.QUERY(2,"use pubs; sp_helpjoins ''publishers'',
           ''authors''",1,false)*
   A5:  =RETURN()

</PRE>QE.XLA must be loaded prior to running this macro. The quotation marks
around the table names in the DB.SQL.QUERY statement are two sets of
single quotation marks. The entire argument is enclosed in one set of
double quotation marks.
<P>
The following macro, which uses the DDE Execute command equivalents,
will also fail. This macro does not require QE.XLA to be loaded.
<P>
<PRE>   A2:  chan=INITIATE("QE","SYSTEM")
   A3:  =EXECUTE(chan,"[LOGON('sqlserver')]")
   A4:  =ACTIVATE("sheet1")
   A5:  =EXECUTE(chan,"[OPEN('use pubs; sp_helpjoins ''publishers'',
        ''authors''')]")
   A6:  =EXECUTE(chan,"[COPY.SPECIAL(TRUE,FALSE,1,2)]")
   A7:  =PASTE()
   A8:  =TERMINATE(chan)
   A9:  =RETURN()

</PRE>When executed, these macros start Q+E and bring up the SQL Server
LOGON dialog box. After logging on, Q+E starts to perform the query
and then generates a UAE.
<P>
This problem has been corrected in the version of Q+E that was
released with Excel 4.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Q+E for Microsoft Excel User's Guide," pages 70, 90-100
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: noupd<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
