

<HTML>
<HEAD>
<TITLE>XL: Value of 15-Digit Numbers May Be Changed Unexpectedly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137527">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1995/09/28">
<META NAME="Keywords" CONTENT="xlformula kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article contains information relating to the  15-digit number  error in Microsoft Excel that was discovered in September 1995. The  More Information  section of this article contains a full description of the problem, as well as information ab...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAKC,QBC6,QAR4,QAG8,QAAP,QAL3,QAWN,QAKP,QAKD,QADX,QA59 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Value of 15-Digit Numbers May Be Changed Unexpectedly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137527</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 3.0a, 4.0, 5.0, 5.0c
<LI>Microsoft Excel for OS/2, version 3.0
<LI>Microsoft Excel for the Macintosh, versions 3.0, 4.0, 5.0, 5.0a
<LI>Microsoft Excel for the Power Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for Windows 95, version 7.0, 7.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains information relating to the "15-digit number"
error in Microsoft Excel that was discovered in September 1995. The
"More Information" section of this article contains a full description
of the problem, as well as information about how to resolve it.
<P>
In the versions of Microsoft Excel listed above, the value of certain 15-
digit numbers may be unexpectedly changed when they are entered in a
worksheet cell or when they are calculated by a formula in a worksheet
cell. The three numbers are as follows:
<P>
<PRE>   140737488355328
   281474976710656
   562949953421312

</PRE>If you enter a variation of these numbers (for example, 1.40737488355328),
or if you calculate a variation of one of these numbers, the number may be
resolved to a different value, such as 0.64 (or some multiple of 0.64).
<P>
Beginning on October 6, 1995, a patch became available for Microsoft Excel
that corrects this problem. See question 11 in the "More Information"
section for information about how to obtain the patch.
<P>
This problem is also corrected in Microsoft Excel 7.0a, Microsoft Excel 97,
and Microsoft Excel 98 Macintosh Edition.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following section addresses common questions regarding the "15-digit
number" problem.

<PRE> 1. Q. I heard that there is a problem where Microsoft Excel incorrectly
       changes the values of some specific numbers. What's the situation?

    A. In Microsoft Excel 5.0 and 7.0, there is an error that causes three
       specific sequences of 15 digits to change their values either
       when you type them as individual entries, or when you derive them
       from specific functions. Microsoft has created a solution in the
       form of a patch that is available online and on floppy disk.

 2. Q. Can you tell me what that means in more common terminology?

    A. What this means is that if you type one of three specific
       15-digit numbers, or derive the number as the result of a
       formula, Microsoft Excel might change the value of the
       number.

 3. Q. What are the chances that I have been affected?

    A. Although it is hard to have an exact number, we believe this
       problem only affects a very small number of customers. In fact,
       based on our internal analysis, the likelihood of any one of these
       sequences of digits appearing in a customer's spreadsheet is
       approximately 1 in 5 billion. Remember, the only way that this
       problem will affect you is if you have one of the three specific
       combinations of 15 digits.

 4. Q. If there is such a small likelihood of this problem occurring, why
       worry about fixing it?

    A. Our customers depend on Microsoft Excel to compute their numbers
       accurately and we want them to feel confident when using the
       product. Even though the probability of one of our customers
       having a problem is low, we can't judge the probability for each
       and every customer. Our approach is to distribute all of the facts
       regarding this problem so that you can determine for yourself if
       you need the patch. The solution is available to all customers who
       own Microsoft Excel or Microsoft Office. This patch is available at
       no charge beginning October 1, 1995 in the U.S.

 5. Q. What are you doing to fix this problem?

    A. We have created a solution that will correct this error. It is
       available in the form of a patch beginning on October 1, 1995 in
       the U.S.

 6. Q. So, what are the numbers that cause this error?

    A. The specific sequences of digits are: 140737488355328,
       281474976710656 and 562949953421312. The decimal point may be in
       different places. In addition, if you are dealing with
       calculations, the result has to be one of these three sequences
       of digits, plus or minus a number less than approximately
       one-half of the next decimal, times a power of 10. This is only a
       problem when you refer to the result in the following functions:
       the INT, CEILING, FLOOR, ROUNDUP, and IF functions. In
       addition, the ROUNDDOWN and MOD functions may be affected.

 7. Q. Why are these specific numbers affected?

    A. The common bond between these numbers is that they happen to be 2
       raised to the 47th, 48th, and 49th power, respectively.

 8. Q. Does this mean I have to check to make sure that any 15-digit
       numbers in my files have been changed by Microsoft Excel?

    A. No. Unless you entered in one of the three specific sequence of
       digits mentioned above, or have used one of the specific formulas
       mentioned above with very long numbers, your numbers should be
       correct. To double-check your numbers, do the following: install
       the patch, open a file, and press CTRL+ALT+F9. When you press this
       key combination, the patch corrects any numbers that were
       incorrectly derived from the functions mentioned in this article.

 9. Q. How did you find out about this problem?

    A. One of our customers found the error while working with a formula
       that derived the number 1.40737488355328. This customer's work
       required that he create a formula in Microsoft Excel that
       explicitly calculated 2 raised to the 47th power, and derive the
       integer portion of it. We were not previously aware of this error
       and are grateful that it was brought to our attention.

10. Q. What versions of Microsoft Excel does this problem affect?

    A. We have found this problem in versions of the product dating back
       to Excel 3.0 for Windows, the Macintosh, and OS/2. Other affected
       versions include Microsoft Excel 4.0 for Windows and the Macintosh,
       Microsoft Excel 5.0 for Windows, Windows NT, and the Macintosh, and
       Microsoft Excel for Windows 95. The patch is available at no charge
       for any of our customers using any of these versions of Microsoft
       Excel.

11. Q. How do I get the patch?

    A. The patch is available as a self-extracting file on the following
       online locations:

          Microsoft's World Wide Web Site on the Internet
          The Internet (anonymous FTP)
          The Microsoft Network
          Microsoft Download Service (MSDL)

       In addition, you can call the Microsoft Order Desk at
       (800) 360-7561 and the patch will be sent to you at no charge.

       For additional information, including information about how to
       obtain the patch, please see the following articles in the
       Microsoft Knowledge Base:

          ARTICLE-ID: <B><A href="../excel/q128650.htm">Q128650</A></B>
          TITLE     : XL7 Patch Available: 15-Digit Number, Linking, and
                      Transpose

          ARTICLE-ID: <B><A href="../excel/q128332.htm">Q128332</A></B>
          TITLE     : WE1254: 15-Digit Number Patch for MS Excel Version
                      5.0c

</PRE>For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../excel/q139803.htm">Q139803</A></B>
   TITLE     : XL: Wrong Value When Values Pasted with Paste Special
               Command
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 3.00a 4.00 5.00 5.00a 5.00c 7.00 7.00a katt<BR>
2^47 2^48 2^49 fifteen fifteen-digit<BR>
Keywords          : xlformula kbfixlist<BR>
Version           : WINDOWS:3.0,4.0,5.0,7.0,7.0a; MACINTOSH:3.0,4.0,5.0,5.0a<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
