

<HTML>
<HEAD>
<TITLE>XL: How to Use the INDIRECT Function to Create References </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151323">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1996/05/21">
<META NAME="Keywords" CONTENT="xlformula kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, the INDIRECT worksheet function returns the contents of the specified reference and displays its contents. The INDIRECT worksheet function can be used to create linked references to other workbooks. Each attribute of the referen...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAM5,QA50,QAB3,QAUD,QAHN,QAB9,QAY5,QAPF,QDNZ,QBV8,QAVX,QAVW,QDNM,QAP2 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Use the INDIRECT Function to Create References</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151323</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows NT, version 5.0
<LI>Microsoft Excel for the Macintosh, versions 5.0, 5.0a
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
SUMMARY
 
<P>
In Microsoft Excel, the INDIRECT worksheet function returns the contents of
the specified reference and displays its contents. The INDIRECT worksheet
function can be used to create linked references to other workbooks. Each
attribute of the reference (workbook name, worksheet name, and cell
reference) can individually be referenced using the INDIRECT function to
create a user-defined dynamic reference using worksheet cell references as
inputs.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The INDIRECT function will only return the result of a reference to an open
file. If a workbook that the INDIRECT function is indirectly referencing is
closed (not open in memory) the function will return a #REF! error.
<P>
The following examples create a reference to a workbook using three
different cell inputs as references for the workbook, worksheet, and cell
link.
<P>
<P><h3>Example 1</h3>
 

<OL><P><LI>In Book1, Sheet1, cell A1 type: "This is a test" (without the quotation
   marks).

<P><LI>In Book2, Sheet1, cell A1 type: "Book1" (without the quotation
   marks).

<P><LI>In Book2, Sheet1, cell A2 type: "Sheet1" (without the quotation marks).

<P><LI>In Book2, Sheet1, cell A3 type: "A1" (without the quotation marks).

<P><LI>Save both workbooks.

<P><LI>In Book2, Sheet1, cell B1 type the following formula:
<P>
<P><PRE>      =INDIRECT("'["&amp;A1&amp;".xls]"&amp;A2&amp;"'!"&amp;A3)
</PRE><P>
   NOTE: In Microsoft Excel for the Macintosh, omit ".xls" from the
   formula, as in the following example:
<P>
<P><PRE>      =INDIRECT("'["&amp;A1&amp;"]"&amp;A2&amp;"'!"&amp;A3)
</PRE><P>
</OL><h3>Example 2</h3>
 
<P>
The formula in Example 1 could alternately be written using multiple
INDIRECT statements as follows:
<P>
<PRE>   =INDIRECT("'["&amp;INDIRECT("A1")&amp;".xls]"&amp;INDIRECT("A2")&amp;"'!"&amp;
      INDIRECT("A3"))

</PRE></OL>NOTE: In Microsoft Excel for the Macintosh, omit ".xls" from the formula,
as in the following example:
<P>
<PRE>   =INDIRECT("'["&amp;INDIRECT("A1")&amp;"]"&amp;INDIRECT("A2")&amp;"'!"&amp;INDIRECT("A3"))

</PRE>Note the difference in referencing the cells. Example 1 references cells
A1, A2, and A3 without using quotation marks, while Example 2 references
the cells using quotation marks around the references.
<P>
In the INDIRECT function, referencing cells without using quotation marks
evaluates the result of the cell reference. For example, if cell A1
contained the text "B1" and B1 contained the word "TEST", the formula
=INDIRECT(A1) would return the result "TEST". Referencing a cell with
quotation marks returns the result of the cell contents. In the example in
the previous sentence the formula would return the text string "B1" and not
the contents of cell B1.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the INDIRECT function, choose the Search button
in Microsoft Excel help reference and type:
<P>
<PRE>   indirect
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 7.00 8.00 97 98 XL98 XL97 XL7 XL5 concatenate<BR>
join link<BR>
Keywords          : xlformula kbfaq<BR>
Version           : WINDOWS:5.0,5.0c,7.0,7.0a,97; MACINTOSH:5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
