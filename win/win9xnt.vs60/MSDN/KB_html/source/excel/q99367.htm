

<HTML>
<HEAD>
<TITLE>XL: Saving and Restoring Workspace Settings </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99367 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1993/05/27">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, the GET.WORKSPACE() function returns information about the workspace settings and can be used to determine if a certain workspace setting is enabled or disabled. However, if you are running a macro that changes the settings in t...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QABA,QBAO,QBWS,QAUR,QASR,QAU7,QAGB,QBWC,QBJZ,QAKJ,QBV8,QBDM,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Saving and Restoring Workspace Settings</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99367 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 3.0, 4.0, 4.0a
<LI>Microsoft Excel for OS/2, versions 3.0
<LI>Microsoft Excel for the Macintosh, versions 3.0 ,4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, the GET.WORKSPACE() function returns information about
the workspace settings and can be used to determine if a certain workspace
setting is enabled or disabled. However, if you are running a macro that
changes the settings in the Workspace Options dialog box, and you would
like to restore the settings to their original values at the end of the
macro, using the GET.WORKSPACE() function is not the best method to use--
there is no argument in the GET.WORKSPACE() function that will test the
status of the Info Window, Note Indicator, or Command Underline (Macintosh
Only).
<P>
In Microsoft Excel version 4.0, you can use a workbook to restore the
original workspace settings. To restore all of the workspace settings,
create a workbook at the beginning of the macro, and then close the
workbook and reopen it at the end of the macro. In Microsoft Excel, version
3.0, use a workspace file.
<P>
Note that in Microsoft Excel version 5.0, in a Visual Basic macro, you can
store any view, edit or general settings (settings available in the Options
dialog box) at the beginning of your macro, and then restore the values at
the end of your macro.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a workbook file is opened in Microsoft Excel version 4.0, the current
settings in the Workspace Options dialog box are replaced with the settings
saved in the workbook. Even though the workbook is then immediately closed,
the workspace settings remain. In Microsoft Excel version 3.0, these
settings are saved in a workspace file.
<P>
To restore the workspace settings after you run your macro, use the
appropriate procedure below.
<P>
<P><h3>In Microsoft Excel 4.0</h3>
 
<P>
All of the settings in the Workspace Options dialog box are saved in a
workbook file. Follow these steps in your macro (or do them manually):

<OL><P><LI>From the File menu, choose New from the File to create a workbook.
   Then save and close the workbook.
<P>
   Note: If you are using a macro, you will probably want to make this
   step an Auto_Open macro so that it will run automatically each time
   you open the macro sheet.

<P><LI>Change the workspace settings and run your macros.

<P><LI>Open the workbook that was created in step 1 and then close it (or
   delete the workbook).
<P>
   Note: If you are using a macro, you will probably want to include
   this step as an Auto_Close macro so it will run automatically when
   you close the macro sheet.
<P>
</OL><h3>In Microsoft Excel 3.0</h3>
 
<P>
All of the settings in the Workspace Options dialog box are saved in a
workspace file with the exception of the Alternate Menu choice,
available in Microsoft Excel for Windows. To determine this setting,
use GET.WORKSPACE(28) in your macro, which returns TRUE if Microsoft
Menus are selected. Follow these general steps in your macro.

<OL><P><LI>Create a workspace file by choosing Save Workspace from the File
   menu. Or, define a variable to store the GET.WORKSPACE(28)
   value.
<P>
   Note: If you are using a macro, you will probably want to make this
   step an Auto_Open macro so that it will run automatically each time
   you open the macro sheet.

<P><LI>Change the workspace settings and run your macros.

<P><LI>Open the workspace file that was created in step 1. Or
   delete the workspace file and restore the Alternate Menu choice
   using the WORKSPACE() command and the variable defined in step 1.
<P>
   Note: If you are using a macro, you will probably want to include
   this step as an Auto_Close macro, so that it will run automatically
   when you close the macro sheet.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"User's Guide", version 3.0, page 550
"User's Guide 1", version 4.0, pages 67-79
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.00 4.00 4.00a<BR>
Keywords          : kbenv<BR>
Version           : WINDOWS:3.0,4.0,4.0a; OS/2:3.0; MACINTOSH:3.0,4.0<BR>
Platform          : MACINTOSH OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
