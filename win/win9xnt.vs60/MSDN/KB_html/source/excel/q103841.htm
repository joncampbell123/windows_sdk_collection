

<HTML>
<HEAD>
<TITLE>Excel AppNote: Generating Smooth Curves in Charts (WE0820) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103841">
<META NAME="KBModify" CONTENT="1997/10/06">
<META NAME="KBCreate" CONTENT="1993/09/01">
<META NAME="Keywords" CONTENT="kbfile kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  The Application Note  Generating Smooth Curves in Charts  (WE0820) includes two add-in macros that use the interpolation method to generate smooth curves in charts.  You can obtain this Application Note from the following sources:  You can obtain t...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANO,QBC9,QBC8,QAVB,QAEM,QAKC,QAKD,QAYY,QAII,QAD7,QBVP,QAUD,QAH6,QABA,QBDM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel AppNote: Generating Smooth Curves in Charts (WE0820)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103841</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Application Note "Generating Smooth Curves in Charts" (WE0820)
includes two add-in macros that use the interpolation method to
generate smooth curves in charts.
<P>
You can obtain this Application Note from the following sources:
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>The Microsoft Network (MSN)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note"
section at the end of this article.
<P>
<P><h2>THE TEXT OF WE0820</h2>
 
<P>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
              WE0820: GENERATING SMOOTH CURVES IN CHARTS
</PRE> 
<PRE>                                                   Revision Date: 8/93
                                                       1 Disk Included

</PRE>The following information applies to Microsoft Excel for Windows(TM),
version 4.0.
<P>
 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY     |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an Application |
| Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER      |
| EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED      |
| WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR       |
| PURPOSE. The user assumes the entire risk as to the accuracy and    |
| the use of this Application Note. This Application Note may be      |
| copied and distributed subject to the following conditions:  1) All |
| text must be copied without modification and all pages must be      |
| included;  2) If software is included, all files on the disk(s)     |
| must be copied without modification (the MS-DOS(R)  utility         |
| diskcopy is appropriate for this purpose);  3) All components of    |
| this Application Note must be distributed together;  and  4) This   |
| Application Note may not be distributed for profit.                 |
|                                                                     |
| Copyright (C) 1993 Microsoft Corporation.  All Rights Reserved.     |
| Microsoft and MS-DOS are registered trademarks and Windows is a     |
| trademark of Microsoft Corporation.                                 |
| ------------------------------------------------------------------- |


</PRE><h2>OVERVIEW</h2>
 
<P>
This Application Note includes two add-in macros that use the
interpolation method to generate smooth curves in charts.
<P>
<P>
<P><h2>INTRODUCTION</h2>
 
<P>
In Microsoft Excel 4.0, when you create an xy (scatter) chart, the
series of xy data points generally do not form a smooth curve. Using a
method called interpolation, you can generate a series of values based
on a set of xy data points that, when plotted, appear as a smooth
curve that connects your xy data points. Interpolation achieves this
smooth-curve effect by joining together several smaller curves called
splines.
<P>
The enclosed WE0820 disk includes two add-in macros, INTERPOL.XLA and
BLEND.XLA, that work together to generate these interpolated values
based on x and y data ranges that you specify. The INTERPOL.XLA macro
uses a custom dialog box to prompt you for your input range
information and allows you to specify how you want your data to be
returned. Based on your specifications, BLEND.XLA calculates and
returns the data points that will generate a smooth curve through the
given arrays of x and y values. You also have the option to create a
chart that displays the new values in a curve and the original values
as data points.
<P>
<PRE>  NOTE: When plotted, your x and y values can be in almost any form
  (for example, your values can form one or more loops or rotate
  through 90 degrees, and so on). In addition, if the original x and y
  values change, the data returned by BLEND.XLA will automatically be
  updated.

</PRE>The following information explains how to install and use these add-in
macros and then discusses their theoretical basis.
<P>
<P>
<P><h2>INSTALLING AND USING THE MACROS</h2>
 
<P>
<P><h3>To install the add-in macro files</h3>
 

<OL><P><LI>In File Manager, copy the BLEND.XLA and INTERPOL.XLA files from the
   enclosed WE0820 disk to the LIBRARY subdirectory on your hard disk
   (this subdirectory is located in the directory where you installed
   Microsoft Excel).

<P><LI>In Microsoft Excel, choose Open from the File menu. Select the
   INTERPOL.XLA file and choose the OK button.
<P>
</OL>When you open the INTERPOL.XLA file, the BLEND.XLA file is
automatically loaded and the Interpolate command is added to the Data
menu.
<P>
<P><h3>To specify options in the Data Interpolate dialog box</h3>
 
<P>
When you choose Interpolate from the Data menu, the Data Interpolate
box appears, prompting you for certain information. In this dialog
box, you are requested to enter information about your existing data,
and you are given options for how you want to present the data that
the macro generates. Once you have entered the appropriate information
in the dialog box, the macro will return a two-column vertical array
of x and y values. These values are the additional data points you'll
need to make a smooth curve.
<P>
The following tables explain what you should enter in each box and
discuss the specific options you can select to control how the new
data is displayed.
<P>
<PRE>   In this box          Enter the range of
   ---------------------------------------

   Known X Values       Your known x values
   Known Y Values       Your known y values

    NOTE: Your data must consist of at least four x values and four y
    values; these values can be in rows or columns.

   In this box          Enter the following
   ----------------------------------------

   Output Reference     Specify the first cell in
                        which the interpolated data
                        will be pasted

    NOTE: If you select a cell that contains data or is located above
    data that will be overwritten, you will receive an alert message.
    When you choose OK in this alert dialog box, you will be returned
    to the Data Interpolate dialog box to make another cell selection.

</PRE></OL>In the Number Of Intermediate Data Points box, you can specify the
number of intermediate points you think you will need to generate a
smooth curve--the initial value displayed for the number of
intermediate points is calculated based on several factors, including
screen resolution, printer resolution, and "smoothness" of the
original data. In most cases, ten intermediate data points should be
enough to generate a smooth curve.
<P>
<PRE>   In this box         Enter the following
   ---------------------------------------

   Number Of           The number of additional
   Intermediate        data points between your
   Data Points         original data points that
                       you will need to generate
                       a smooth curve

</PRE>To control how your data will be displayed, use the options in the
Options section of the dialog box.
<P>
<PRE>   Select this option   To do this
   -------------------------------

   Include Original     Include the xy values on
   Points               which your interpolated
                        data is based

   Create Chart         Create a chart with a
                        smooth curve

</PRE>When you select both of these options, the add-in macros work together
to create a chart with two data series: one for the smooth curve that
has a line style but no data point markers and one for the original
data that has data point markers but no line style.
<P>
<PRE>    NOTE: You can use the BLEND.XLA macro independent of INTERPOL.XLA
    to return data points along your smooth curve. You can use the
    Paste Function command on the Formula menu to paste this data to
    your sheet. The function takes three arguments: the range
    containing your x values, the range containing your y values, and
    the number of intermediate points you want. To enter the formula,
    you must have at least two cells selected (either columns or rows)
    and you must enter it as an array formula by pressing
    CTRL+SHIFT+ENTER.


</PRE><h2>USING THE INTERPOL.XLA AND BLEND.XLA MACROS WITH SAMPLE DATA</h2>
 
<P>
The following sample data
<P>
<PRE>   |   A   |  B
</PRE> 
<PRE>1  |   1      4
2  |   2      2
3  |   3      2
4  |   4      4
5  |   5      3

</PRE>Figure 1-Sample Data
<P>
when plotted in a chart will resemble the following:
<P>
&lt;chart deleted&gt;
Figure 2-Sample Data Plotted in a Chart
<P>
To generate a new xy (scatter) chart with a smooth curve that is based
on the data in cells A1:B5, do the following:

<OL><P><LI>From the Data menu, choose Interpolate. In the startup message box,
   choose OK.

<P><LI>In the dialog box that is displayed, do the following:
<P>
<P><PRE>    a. In the Known X Values box, type "$A$1:$A$5" (without the quotation
      marks).
</PRE><P>
<P><PRE>    b. In the Known Y Values box, type "$B$1:$B$5" (without the quotation
       marks).
</PRE><P>
<P><PRE>    c. In the Output Range box, type "$C$1" (without the quotation marks).
</PRE><P>
<P><PRE>    d. In the Number Of Intermediate Points box, leave the value set to
       10.
</PRE><P>
<P><PRE>    e. Under Options, verify that Include Original Points and Create
       Chart are both selected.
</PRE>
<P><LI>Choose OK.
<P>
</OL>The following table shows the first 15 of 45 rows of the resulting
data (the total number of rows will vary with the number of x and y
values and the number of intermediate points that you specify).
<P>
<PRE>       |     C     |    D     |    E
    -----------------------------------
    1  |         1          4      4
    2  |  1.090909   3.735537
    3  |  1.181818   3.487603
    4  |  1.272727   3.256198
    5  |  1.363636   3.041322
    6  |  1.454545   2.842975
    7  |  1.545455   2.661157
    8  |  1.636364   2.495868
    9  |  1.727273   2.347107
   10  |  1.818182   2.214876
   11  |  1.909091   2.099174
   12  |         2          2      2
   13  |  2.090909   1.917355
   14  |  2.181818    1.85124
   15  |  2.272727   1.801653

</PRE></OL>Figure 3-Table of Intermediate Data Point Values
<P>
Based on these values, INTERPOL.XLA automatically creates the
following chart:
<P>
&lt;chart deleted&gt;
Figure 4-Interpolated Curve
<P>
In Figure 4, the line shows the interpolated curve, and the data point
markers show the original xy values.
<P>
<P><h2>THEORETICAL BASIS FOR THIS METHOD OF CREATING SMOOTH CURVES</h2>
 
<P>
This particular implementation of curve smoothing is defined as the
construction of a smooth curve by the piecewise addition of linearly
blended second order polynomials (Burger and Gilles 1992).
<P>
An explanation of this method is as follows: given any three non-
singular points, it is possible to define a unique parabola that will
pass through all three of them (Burger and Gilles 1992). (See Figure
5.)
<P>
&lt;chart deleted&gt;
Figure 5-A Unique Parabola that Passes Through Three Given Points
<P>
To generate a curve through several points, parabolas are calculated
for each set of three points (see Figure 6).
<P>
&lt;chart deleted&gt;
Figure 6-The Unique Parabolas that Pass Through Each Set of Three
Points
<P>
If the interpolated point we want to find lies to the left of &lt;b&gt;, or
to the right of &lt;e&gt;, then the parabolic equation that passes through
these points is used (See Figure 7).
<P>
&lt;chart deleted&gt;
Figure 7-The End Conditions
<P>
For each intermediate section of the curve, the two parabolas that
pass through each point are added together in proportion to how close
they are to the original points (see Figure 8).
<P>
&lt;chart deleted&gt;
Figure 8-Blending Curves 1 and 2
<P>
For instance, if the desired point lies between &lt;b&gt; and &lt;c&gt;, then the
closer the point is to &lt;b&gt;, the more of curve 1 is used; and
conversely, the closer the point is to &lt;c&gt;, the more of curve 2 is
used. At point &lt;b&gt;, only curve 1 is used; at point &lt;c&gt;, only curve 2
is used; and halfway between &lt;b&gt; and &lt;c&gt;, the interpolated point is
the average of curves 1 and 2.
<P>
Continuing in this way, you can construct a smooth curve (see Figure
9).
<P>
&lt;chart deleted&gt;
Figure 9-The Resulting Smooth Curve
<P>
<P><h2>REFERENCES</h2>
 
<P>
Burger, P., and Gilles, D. "Interactive Computer Graphics, Functional,
Procedural and Device Level Methods," 276-277. Palo Alto: Addison
Wesley, 1992.
<P>
 
<P>
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
The following file(s) are available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/we0820.exe">WE0820.EXE</A> <I>(size: 31738 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>If you are unable to access the source(s) listed above, you can have this
Application Note mailed to you by calling Microsoft Product Support
Services Monday through Friday, 6:00 A.M. to 6:00 P.M. Pacific time at
(425) 635-7070 (Windows) or (425) 635-7080 (Macintosh). If you are
outside the United States, contact the Microsoft subsidiary for your
area. To locate your subsidiary, see the Microsoft World Wide Offices Web
site at:
<P>
<PRE>   <B><A href="http://www.microsoft.com/worldwide/default.htm">http://www.microsoft.com/worldwide/default.htm</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : kbfile kbusage<BR>
Version           : 4.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
