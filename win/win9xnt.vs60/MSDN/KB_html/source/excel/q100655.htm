

<HTML>
<HEAD>
<TITLE>Excel: Using COMMAND() to Send an Excecute String to Q+E </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100655">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/06/24">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  If you are using Microsoft Excel version 2.x, 3.0 or 4.0 and Q+E version 2.5, 3.0, or 3.0a, you can use the Microsoft Excel COMMAND() function to construct large execute commands and send them to Q+E a portion at a time. This function exists becaus...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB9,QBV8,QA50,QATX,QBFY,QAY2,QAH6,QA4N,QDI1,QBXT,QA5V,QAZZ,QAY5,QAUR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: Using COMMAND() to Send an Excecute String to Q+E</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100655</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.1, 2.1c, 2.1d, 3.0, 4.0
<LI>Q+E versions 2.5, 3.0, and 3.0a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you are using Microsoft Excel version 2.x, 3.0 or 4.0 and Q+E version
2.5, 3.0, or 3.0a, you can use the Microsoft Excel COMMAND() function to
construct large execute commands and send them to Q+E a portion at a
time. This function exists because some macro languages, such as the
Microsoft Excel macro language, have limits on the size of character
variables.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The COMMAND() function requires two arguments. The first argument,
op_num, is a number from 1 to 3 that specifies how Q+E receives and
handles the second argument, exec_string.
<P>
Note the following:

<UL><LI>If op_num is 1: Q+E initializes a buffer and saves exec_string
<LI>If op_num is 2: Q+E adds the exec_string to the buffer
<LI>If op_num is 3: Q+E adds the exec_string and executes the buffer
<P>
</UL>exec_string is the string of commands executable by Q+E. The syntax
for these commands is the same format that is used with the DDE
EXECUTE function. Each command must be enclosed in square brackets and
the entire string, including the square brackets, must be enclosed in
quotation marks.
<P>
The following example assumes that Q+E is listed correctly in the PATH
statement and that the file ADDR.DBF is in the subdirectory C:\QE:
<P>
<PRE>   A1:  chan=INITIATE("qe","system")
   A2:  =EXECUTE(chan,"[command(1,'[open(''select * from ')]")
   A3:  =EXECUTE(chan,"[command(2,'dbasefile|')]")
   A4:  =EXECUTE(chan,"[command(3,'c:\qe\addr.dbf'')]')]")
   A5:  =RETURN()

</PRE><LI>The first line initializes the DDE channel.

<LI>The second line causes Q+E to initialize a buffer and save the
   string "'[open(''select * from ", without the double quotation
   marks. Note, there is a space between the word "from" and the
   single quotation mark. Also, the asterisk signifies bringing in all
   fields.

<LI>The third line sends the string "dbasefile|" (without the quotation
   marks), which Q+E concatenates to the buffer.

<LI>The fourth line sends the string "c:\qe\addr.dbf'')]'", (without the
   double quotation marks), which Q+E concatenates to the buffer before
   executing the complete command buffer.
<P>
</UL>The example above is equivalent to the following macro:
<P>
<PRE>   A1:  chan=INITIATE("qe","system")
   A2:  =EXECUTE(chan,"[open(''select * from dbasefile|c:\qe\addr.dbf'')]")
   A3:  =RETURN()
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 2.10 2.10c 2.10d 3.00
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
