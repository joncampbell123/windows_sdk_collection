

<HTML>
<HEAD>
<TITLE>XL: "Merge Handler" Error Message Dragging Files into Briefcase </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174658">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/10/03">
<META NAME="Keywords" CONTENT="xlwin kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry.  Before you edit the registry, make sure you understand how to restore it if  a problem occurs. For information about how to do this, view the  Restoring  the Registry  Help to...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDKX,QAEF,QAA1,QAXB,QA9N,QAB4,QBWS,QDH3,QDI2,QDH6,QBD2,QANJ,QDKD,QDO3 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: "Merge Handler" Error Message Dragging Files into Briefcase</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174658</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry. 
Before you edit the registry, make sure you understand how to restore it if 
a problem occurs. For information about how to do this, view the "Restoring 
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key" 
Help topic in Regedt32.exe. 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you a drag a file that is not a Microsoft Excel version 7.0 or
Microsoft Excel 97 file into a briefcase, you may receive the following
error message:
<P>
<PRE>   Update Briefcase
   '&lt;Filename.xls&gt;' will not be updated because its merge handler cannot
   be loaded.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if both of the following conditions are true:

<UL><LI>If the file you are dragging into the briefcase is opened by default
   in Microsoft Excel 97.
<P>
<P><PRE>    -and-
</PRE>
<LI>The file is not saved in the "Microsoft Excel 5.0/95 Workbook (*.xls)"
   format or the Microsoft Excel 97 workbook format.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To correct this problem, remove Microsoft Office 97 and install Microsoft
Office 97 Service Release 1 (SR-1) Enterprise Update or delete a key from
the Microsoft Windows registry.
<P>
NOTE: If the Microsoft Office 97 SR-1 Patch is installed, it is necessary
to remove a registry key in the registry. To remove the registry key,
follow the steps in Method 2.
<P>
<P><h3>Method 1: Install Microsoft Office SR-1 Enterprise Update</h3>
 
<P>
If you have not updated Office 97 by running the SR-1 Patch, remove Office
97, and then install the Office SR-1 Enterprise Update. To do this, follow
these steps:

<OL><P><LI>On the Start menu, point to Settings, and then click Control Panel.

<P><LI>Double-click Add/Remove Programs. In the list of installed programs,
   click Microsoft Office 97, and then click Add/Remove. If you installed
   Microsoft Office from a CD, you are prompted to insert the first CD.
<P>
   If a dialog box notifies you that programs are running, quit the
   programs, and then click OK.

<P><LI>In the Microsoft Office 97 Setup dialog box, click Remove All.

<P><LI>When you are prompted to remove shared components, click Remove All.
<P>
   If you are prompted to restart the computer after Setup is finished,
   do so.

<P><LI>Install Microsoft Office 97 SR-1 Enterprise Update.
<P>
<P>
</OL><h3>Method 2: Remove the Registry Key</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.
<P>
If you have updated Office 97 by running the SR-1 Patch, follow these
steps:

<OL><P><LI>On the Start menu, click Run. In the Open box, type "regedit"
   (without the quotation marks), and then click OK.

<P><LI>In the Registry window, click the plus sign (+) to the left of the
   following keys, in order:
<P>
<P><PRE>      HKEY_CLASSES_ROOT
      CLSID
      {00020820-0000-0000-C000-000000000046}
      Roles
</PRE><P>
   Then, click the yellow Reconciler folder on the left. The text
   that appears in the status bar should be the following:
<P>
<P><PRE>      \HKEY_CLASSES_ROOT\CLSID\{00020820-0000-0000-C000-000000000046}
      \Roles\Reconciler
</PRE>
<P><LI>On the Edit menu, click Delete, and then click Yes to delete the key.

<P><LI>On the Registry menu, click Exit.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Office 97 for
Windows. This problem was corrected in Microsoft Office 97 SR-1 Enterprise
Update.
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q172475.htm">Q172475</A></B>
   TITLE : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
This problem occurs because the Xlrec.dll file attempts to use the
shared workbooks functionality that is built into Microsoft Excel 7.0 and
Microsoft Excel 97 to share the workbook in the briefcase.  Other file
formats that are opened in Microsoft Excel do not support the shared
workbooks functionality and thus have no merge handle to load.  This
functionality was changed in Microsoft Office 97 SR-1 Enterprise Update so
that all files formats that you open in Microsoft Excel can be shared in a
briefcase.
<P>
For additional information about the error message, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q161445.htm">Q161445</A></B>
   TITLE     : OFF97: Errors Appear When Dragging Files into a Briefcase
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : xlwin kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
