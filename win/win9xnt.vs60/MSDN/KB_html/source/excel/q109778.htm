

<HTML>
<HEAD>
<TITLE>Timer Driver and "Error Occurred Initializing VBA Libraries" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109778">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1994/01/09">
<META NAME="Keywords" CONTENT="xlwin kberrmsg kbfaq kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you start Microsoft Excel, after the Microsoft Excel logo is displayed on the screen, you may receive the following error messages:     An Error Occurred Initializing VBA Libraries     -and/or-     The Timer driver is not installed on this sys...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBWO,QDL9,QBWN,QBWQ,QAU9,QAB4,QABI,QANE,QATK,QBXT,QA5V,QAIB,QAA1,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Timer Driver and "Error Occurred Initializing VBA Libraries"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109778</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Project for Windows 95, version 4.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you start Microsoft Excel, after the Microsoft Excel logo is displayed
on the screen, you may receive the following error messages:
<P>
<PRE>   An Error Occurred Initializing VBA Libraries

   -and/or-

   The Timer driver is not installed on this system. Microsoft Excel
   cannot run without the Timer driver. Choose the help button for
   more information.

</PRE>Note that you may also receive the Timer Driver error message when you
start Windows.
<P>
<P>
<P><h2>CAUSE</h2>
 
<P>
<P><h3>Microsoft Excel version 7.0</h3>
 
<P>
In order to run Microsoft Excel version 7.0, the file MMSYSTEM.DLL must
be on your computer.
<P>
When you start Microsoft Excel version 7.0, you will receive the above
error messages if any of the following is true:

<UL><LI>The MMSYSTEM.DLL file is not loaded on your system or is damaged.
<P>
   -or-

<LI>The SYSTEM.INI file does not contain the correct entry for
   MMSYSTEM.DLL.
<P>
   -or-

<LI>Windows was not successfully installed on your computer.
<P>
   -or-

<LI>You have drivers installed that have created or modified entries in
   the [Boot] section of the SYSTEM.INI file. These entries are causing
   conflicts that return these error messages.
<P>
</UL><h3>Microsoft Excel version 5.0</h3>
 
<P>
In order to run Microsoft Excel version 5.0, the TIMER.DRV, MMSYSTEM.DLL,
and VTDAPI.386 files must be available on your computer.
<P>
NOTE: When the VTDAPI.386 file is missing or damaged or the SYSTEM.INI file
does not contain the correct entry for this file, you will receive a
TIMER.DRV error message when you start Windows.
<P>
When you start Microsoft Excel version 5.0, you will receive the above
error messages if any of the following is true:

<UL><LI>The TIMER.DRV, MMSYSTEM.DLL, or VTDAPI.386 file is not loaded on your
   system or is damaged.
<P>
   -or-

<LI>The SYSTEM.INI file does not contain the correct entries for
   TIMER.DRV, MMSYSTEM.DLL, and VTDAPI.386.
<P>
   -or-

<LI>Windows was not successfully installed on your computer.
<P>
   -or-

<LI>You have drivers installed that have created or modified entries in
   the [Boot], [Drivers], or [386Enh] sections of the SYSTEM.INI file.
   These entries are causing conflicts that return these error messages.
<P>
   -or-

<LI>You are running Microsoft Excel version 5.0 under OS/2.
<P>
</UL>For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q154658.htm">Q154658</A></B>
   TITLE     : PRJ41: "Could Not Initialize VBA", "Timer Driver Not
               Installed"

</PRE><h2>WORKAROUNDS</h2>
 
<P>
<P><h3>If You Are Running Microsoft Excel Under Windows</h3>
 
<P>
Method 1: Use these steps, based upon the version of Microsoft Excel you
<PRE>          are running, to verify that the files are correctly
          installed and that the SYSTEM.INI contains the appropriate
          entries:

          1. Make sure the SYSTEM.INI file contains the correct lines
             for MMSYSTEM.DLL, VTDAPI.386, and TIMER.DRV. The lines are
             as follows:

             NOTE: Make sure that you do not have trailing spaces on any
             of the following lines.

          Microsoft Excel versions 5.0 and 7.0
          ------------------------------------

             a. In the [BOOT] section of the SYSTEM.INI file, the
                following line is  required:

                   drivers=mmsystem.dll

                This line specifies which drivers to load when you start
                Microsoft Windows, so additional drivers may be listed
                on this line. For example, the line may read:

                   drivers=mmsystem.dll pen penwindows

                For additional information about this line, see the
                PJREADME.HLP file that is installed with Microsoft
                Project.

             Microsoft Excel version 5.0
             ---------------------------

             b. In the [386Enh] section of the SYSTEM.INI file, the
                following line is required:

                   device=vtdapi.386

             c. In the [drivers] section of the SYSTEM.INI file, the
                following line is required:

                   timer=timer.drv

          Windows 95
          ----------

          2. Make sure the MMSYSTEM.DLL file is loaded on your computer.
             This file should be located in your \Windows\System
             folder. If the file does not exist on your computer, do
             the following to extract it from your Windows disks:

             a. Copy Extract.exe from the "Disk 1 -Setup" disk to the
                root directory of your hard drive.

             b. On the Start menu point to Programs and then click
                MS-DOS Prompt.

             c. In the MS-DOS Prompt window, change to your root
                directory.

             d. Insert Disk 8 of your Windows 95 disks and type the
                following at the command prompt:

             extract a:\Win95_08.cab /L c:\Windows\System Mmsystem.dll

             e. After the Extract program finishes extracting the file
                to your computer, type the following at the command
                prompt:

                exit

             f. Eject Disk 8 from your floppy drive and restart your
                computer.

          Windows version 3.1, and Windows for Workgroups version 3.11
          ------------------------------------------------------------

          2. Make sure the files TIMER.DRV, MMSYSTEM.DLL, and VTDAPI.386
             are loaded on your computer. All three files should be
             located in your \WINDOWS\SYSTEM directory. If the files do
             not exist on your computer, expand them from your Windows
             disks. Check your computer for duplicate filenames, and
             rename as needed.

             To expand the files, do the following:

             a. Exit windows to the MS-DOS prompt.

             b. Change to the WINDOWS directory.

             c. In drive A, insert the disk that contains the file that
                you want to expand:

                Microsoft Windows version 3.1
                -----------------------------

                TIMER.DRV is located on Disk 3 (Windows 3.1), Disk 5
                (Windows 3.11)

                MMSYSTEM.DLL is located on Disk 4 (Windows 3.1 and 3.11)
                VTDAPI.386 is located on Disk 3 (Windows 3.1), Disk 5
                (Windows 3.11)

                Microsoft Windows for Workgroups, version 3.11
                ----------------------------------------------

                TIMER.DRV is located on Disk 5 (Disk 7 if 5.25-inch
                disks)

                MMSYSTEM.DLL is located on Disk 4

                VTDAPI.386 is located on Disk 5 (Disk 7 if 5.25-inch
                disks)

             d. At the MS-DOS command prompt, do the following to expand
                the files (assuming your Windows disk is in drive A):

                To Expand TIMER.DRV, type the following:

                    Expand a:\timer.dr_ c:\windows\system\timer.drv

                To Expand MMSYSTEM.DLL, type the following:

                    Expand a:\mmsystem.dl_ c:\windows\system\mmsystem.dll

                To Expand VTDAPI.386, type the following:

                    Expand a:\vtdapi.38_ c:\windows\system\vtdapi.386

          Other things to look for:

           - If the SYSTEM.INI file contains the correct lines and
             TIMER.DRV, MMSYSTEM.DLL, and VTDAPI.386 are all on your
             system in the WINDOWS\SYSTEM directory, it may be possible
             that one or all of the files is damaged. In this case,
             delete the existing TIMER.DRV, MMSYSTEM.DLL, and VTDAPI.386
             files and expand them from your Windows disks using the
             instructions from step 2 above.

           - It is possible to have Windows directories on more than one
             drive. This may cause Setup to copy files to the wrong
             directory. In this case, make sure the path is pointing to
             the proper directory, and that the correct files are
             located in the \Windows\System directory.

           - Try commenting out the "LOAD=" and "RUN=" lines in WIN.INI
             by adding a semicolon (;) at the beginning of each line.
             Also, try removing ALL icons from the Program Manager
             Startup group. Once these changes have been made, exit and
             restart Windows.


           - This can also occur if a directory is in the path prior to
             the Windows directory that contains one of these files. A
             Dos search for all instances of "Timer.drv", "mmsystem.dll",
             and "Vtdapi.386" will  assist in the resolution of this issue.
             From a MS-DOS command prompt at the root of "C:", type the
             following:

                  Dir Timer.drv /s

             to search all the  subdirectories. Change your path statement
             and have your Windows directory be first.

</PRE>Method 2: Determine if a driver has created or modified entries in the
<PRE>          [386Enh], [Boot], or [Drivers] sections of the SYSTEM.INI file
          (and that this modification is causing the problem).

          To do this, remark these entries out (type a semicolon at the
          beginning of each driver entry), and make sure that the
          appropriate entries are included in each section of the
          SYSTEM.INI file (for information about these entries, see step 1
          in "Method 1" above).

          Note that commenting these lines out may prevent you from running
          a certain application or utility.

          The following table includes specific examples of drivers that
          may create entries in the [386Enh], [Boot], or [Drivers] sections
          of the SYSTEM.INI and, subsequently, may cause these error
          messages. The table also contains suggestions about how you may
          be able to avoid the error messages.

          For this       Using this
          Product        Driver        Make this modification
          --------------------------------------------------------------
          AceCad         AceCat 2      Check for multiple [Boot] sections.
          Enterprises                  Comment out all but one of these
          program                      sections and ensure that it
                                       contains the appropriate drivers=
                                       entry.
          --------------------------------------------------------------
          Adobe Type     atmsys.drv    Change the following lines in the
          Manager (ATM)                [Boot] section from

                                          system.drv=atmsys.drv
                                          atm.system.drv=system.drv

                                       to:

                                          system.drv=system.drv
          --------------------------------------------------------------
          After Dark     adwrap.drv    Remark out
          3.0
                                          drivers=d:\afterdark\arwrap.drv

                                       and add:

                                          drivers=mmsystem.dll
          --------------------------------------------------------------
          ---------------------------------------------------------------
          Drawing                      Change
          tablet
                                       drivers=pen penwindows

                                       to:

                                       drivers=mmsystem.dll pen penwindows
          ----------------------------------------------------------------
          Explorer on Net              In the [BOOT] section, remark out:
          by FTP, Inc.
                                         drivers=c:\explorer\wcomapi.dll
          -----------------------------------------------------------------
          Kurta's        wtkurta       Change
          Tablet Driver
          version 8.01                    drivers=wtkurta
          or 8.0i
                                       to:

                                          drivers=mmsystem.dll
          --------------------------------------------------------------
          LapLink                      In the [386enh] section, remark out
                                       the lines that contain the
                                       following:

                                          vpd.386 (virtual parallel port)
                                          vcd.386 (virtual serial port)
                                          tsivid.386 (virtual used by TSI
                                                      Products)
          --------------------------------------------------------------
          Quarterdeck QEMM 8.0            Change

                                             drivers=C:\QEMM\mmsystem.dll

                                          to:

                                             drivers=mmsystem.dll
          --------------------------------------------------------------
          Safari 3180    sswincs.dll Change
          Notebook with
          a PCMCIA card              drivers=c:\pcmia2\cardview\sswincs.dll
          slot
                                     to:

                                     drivers=mmsystem.dll
          --------------------------------------------------------------
          Windows Sound                Check to see if the following line
          System                       has been remarked out:

                                          drivers=mmsystem.dll

                                       If it has been remarked out,
                                       remove the semicolon from the
                                       line. You may still receive the
                                       error message, but you will be
                                       able to run Microsoft Excel.
          --------------------------------------------------------------

</PRE>Method 3: If Windows is not installed correctly.
<P>
<PRE>          If you attempted to install Windows version 3.1 over Windows
          version 3.0, and the installation failed, the following line will
          appear in the [Boot] section of the SYSTEM.INI file:

             oldshell=progman.exe

          and this line will appear in the [Drivers] section of the
          SYSTEM.INI file:

             olddrivers=mmsystem.dll

          To correct this problem, edit the SYSTEM.INI file and remove the
          "old" prefix from both of these lines so that they appear as
          follows:

             shell=progman.exe

          and:

             drivers=mmsystem.dll

          Also, make sure that there are no lines in the SYSTEM.INI that
          look like this:

             ;drivers=mmsystem.dll

          If such lines exist, remove them from the SYSTEM.INI file.

</PRE><h3>If You Are Running Microsoft Excel Under OS/2</h3>
 
<P>
If you receive a TIMER.DRV error message and you are running Microsoft
Excel 5.0 under OS/2, you will have to add the TIMER.DRV file to the
system, because it is not installed for the OS/2 Windows emulation by
default. Install the driver in a Windows session, using the Drivers icon in
Control Panel.
<P>
The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00 err library expnotes.exe pc<BR>
world<BR>
Keywords          : xlwin kberrmsg kbfaq kbprb<BR>
Version           : 4.00 4.10 5.00 5.00c 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
