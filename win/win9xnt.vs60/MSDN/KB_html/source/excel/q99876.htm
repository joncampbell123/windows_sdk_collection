

<HTML>
<HEAD>
<TITLE>Excel: GP Fault Running Tutorial with Auto_Close Macro Open </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99876 ">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1993/06/09">
<META NAME="Keywords" CONTENT="kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel versions 4.0 and 4.0a, when you run the Introducing Microsoft Excel or Learning Microsoft Excel tutorials, you may receive a general protection (GP) fault if you have a document open that runs an Auto_Close macro if that Auto_Clo...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBKN,QAH4,QAGB,QBWS,QAAW,QBJZ,QAPN,QAB9,QAY2,QAK5,QAFY,QAUJ,QAHT,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Excel: GP Fault Running Tutorial with Auto_Close Macro Open</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99876 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel versions 4.0 and 4.0a, when you run the Introducing
Microsoft Excel or Learning Microsoft Excel tutorials, you may receive
a general protection (GP) fault if you have a document open that runs
an Auto_Close macro if that Auto_Close macro contains a CLOSE() or
FILE.CLOSE() statement.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Microsoft
Excel listed above. This problem was corrected in version 5.0 of Microsoft
Excel for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you choose one of the Microsoft Excel tutorials from the Help
menu, all open files and workspace settings are saved to a workbook
file, CBT.XLW, which is then closed. When you exit the tutorials,
Microsoft Excel opens the CBT.XLW file to restore your files and
workspace settings. The GP fault appears to occur at the point that
the CBT.XLW file is being created.
<P>
You can designate a macro to run when a document is closed by creating
the defined name Auto_Close for the document and specifying the macro
that you want to run in the Refers To section of the Define Name
dialog box. An Auto_Close macro is activated when you close a file by
choosing Close from the File menu or by executing a CLOSE() or
FILE.CLOSE() statement from another macro (not the Auto_Close macro).
<P>
If you run one of the tutorials while a document containing an
Auto_Close defined name is open, the Auto_Close macro will be run
before the tutorial is launched. If the Auto_Close macro contains a
CLOSE() statement to close the active window, or a FILE.CLOSE()
statement to close the active document, you may receive a GP fault
when you try to run the tutorial.
<P>
<P><h2>Workarounds</h2>
 
<P>
If your macro does not activate another sheet prior to executing the
CLOSE() or FILE.CLOSE() statement:

<UL><LI>Remove the CLOSE() or FILE.CLOSE() statement from the file containing
</UL>the
<PRE>   Auto_Close defined name.

      Note: These statements are unnecessary in the Auto_Close macro
      because, by design, the macro must be activated by choosing
      Close from the File menu or by a CLOSE() or FILE.CLOSE()
      statement in another macro. Therefore, you can remove these
      statements from your macro without any loss of functionality.

</PRE>If your macro activates another sheet prior to executing the CLOSE()
or FILE.CLOSE() statement:

<UL><LI>Close the document containing the Auto_Close defined name before
   you run the tutorial.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
"User's Guide 2," pages 260-261
"Function Reference," pages 55, 145
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 4.00 4.00a
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
