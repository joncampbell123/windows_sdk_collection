

<HTML>
<HEAD>
<TITLE>XL97: Print Area with Merged Cells May Be Set Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170683">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/06/26">
<META NAME="Keywords" CONTENT="kbprint">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  When you set a print area on a worksheet in Microsoft Excel 97, the print area may not be set correctly if the worksheet contains any merged cells. Specifically, only part of a merged cell may be included in the print area. As a result, when you pr...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QBXS,QDNZ,QABI,QBVP,QAH4,QDMR,QAPN,QBQU,QBJZ,QA50,QDME,QANX,QAJB,QBWS P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Print Area with Merged Cells May Be Set Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170683</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you set a print area on a worksheet in Microsoft Excel 97, the print
area may not be set correctly if the worksheet contains any merged cells.
Specifically, only part of a merged cell may be included in the print area.
As a result, when you print the worksheet, the output may not contain all
of the information.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur if you use either of the following methods to set
the print area:

<UL><LI>While a range of cells is selected, you type "print_area" (without
   the quotation marks) in the Name box and press ENTER.
<P>
<P><PRE>    -or-
</PRE>
<LI>In a Visual Basic for Applications macro, you set the print area by
   using a line of code similar to the following:
<P>
<P><PRE>      ActiveSheet.PageSetup.PrintArea = Range("B2").Address
</PRE><P>
   In this example, B2 is the address of a cell that is part of a merged
   cell.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To prevent this problem from occurring, use any of the following methods to
set a print area:

<UL><LI>Instead of typing "print_area" (without the quotation marks) in the Name
   box, point to Print Area on the File menu, and click Set Print Area.
<P>
<P><PRE>    -or-
</PRE>
<LI>If you are using a macro to set the print area, modify the code so
   that it uses the Selection property instead of the Range property. For
   example, if your code currently looks like this
<P>
<P><PRE>      ActiveSheet.PageSetup.PrintArea = Range("B2").Address
</PRE><P>
   change it to the following:
<P>
<P><PRE>      Range("B2").Select
      ActiveSheet.PageSetup.PrintArea = Selection.Address
</PRE><P>
<P><PRE>    -or-
</PRE>
<LI>Make sure that the range referred to by the macro includes all of
   the cells that have been merged, for example:
<P>
<P><PRE>      ActiveSheet.PageSetup.PrintArea = Range("B2:F20").Address
</PRE><P>
</UL>Using any of these methods ensures that the print area is set correctly.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps demonstrate the problem described in this article:

<OL><P><LI>In Microsoft Excel 97, create a new workbook.

<P><LI>In Sheet1 of the new workbook, select the range B2:F20. On the
   Formatting toolbar, click the Merge And Center tool.

<P><LI>Select the merged cell.

<P><LI>In the Name box, type "print_area" (without the quotation marks) and
   press ENTER.
<P>
</OL>Note that the dotted line that borders the print area surrounds only the
original cell B2, not the entire merged cell. If you type a value in cell
B2, and then view the worksheet in print preview, nothing is printed
because the print area covers includes only the original cell B2.
<P>
To properly set the print area, select the merged cell. Then, point to
Print Area on the File menu, and click Set Print Area. Click OK to set the
print area. The print area includes the entire merged cell.
<P>
If you use a macro to set the print area, make sure that the macro uses the
Selection property rather than the Range property. Or, make sure that the
Range property refers to all of the cells that you merged.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97<BR>
Keywords          : kbprint<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
