

<HTML>
<HEAD>
<TITLE>Alternate Method of Autosizing a Database in Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q46458 ">
<META NAME="KBModify" CONTENT="1994/11/02">
<META NAME="KBCreate" CONTENT="1989/07/03">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  Using the Form command from the Data menu, you can redefine a Microsoft Excel database automatically to include new records as they are added. This is the recommended method when using databases with up to 32 fields.  For databases with more than 3...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QBVP,QA5V,QAKC,QBC6,QAY2,QABI,QAG8,QA7O,QA7N,QA28,QAUJ,QATJ,QAPN,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Alternate Method of Autosizing a Database in Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q46458 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 2.x, 3.0, 4.0, 5.0
<LI>Microsoft Excel for OS/2, versions 2.2, 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using the Form command from the Data menu, you can redefine a Microsoft
Excel database automatically to include new records as they are added. This
is the recommended method when using databases with up to 32 fields.
<P>
For databases with more than 32 fields, the method below can be used. This
method is paraphrased with permission from the Cobb Group's journal "The
Expert," (c), Vol. 2 No. 4, April 1989.
<P>
This method uses a defined name that refers to a formula to determine the
lower-right-corner cell of your database.
<P>
To make your database autosizing (that is, to make it redefine itself to
the number of entries in your database), use the definition
<P>
<PRE>   =tl:INDEX(tr:br,COUNTA(t:b))

</PRE>where the following apply:
<P>
<PRE>   tl = top left corner of database
   tr = top right corner of database
   br = reference far below bottom right corner
   t  = cell that contains a field name that indicates a field that
        will have no blank cells
   b  = column from t, row from br

</PRE>Before you enter this definition make sure that Database has been entered
in the Name box of the Formula Define Name command. (If you are using
version 5.0, choose Name from the Insert menu, then select Define.) Type
the formula above into the Refers To box and press ENTER or click OK.
<P>
Note: in Microsoft Excel version 5.0, these steps are not required because
Microsoft Excel automatically highlights your list when you select Sort
from the Data menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The COUNTA function counts the number of nonblank cells in the range
t:b, so all database records should have something in this field; once
a blank cell is reached, that should be the end of the database. This
value, the number of nonempty cells, (that is, the number of records
in the database) is used in the INDEX function to indicate which cell
from tr:br (the rightmost column of the database) to return as the
bottom right cell of the database.
<P>
For example, if your database were in columns A through E, and you had
records defined in rows 2 through 89 (row 1 has the field names), you
would use a database definition similar to the following:
<P>
<PRE>   =$A$1:INDEX($E$1:$E$1000,COUNTA($B$1:$B$1000))

</PRE>Column B is assumed always to have an entry for any record in the
database. Because a limit must be indicated, if the database extends
beyond row 1000, the formula would have to be redefined, substituting
a larger number for 1000 above. The larger the number used, the longer
calculations will take; the smaller the number used, the smaller the
absolute limit on the database size (until redefined).
<P>
Note: Make sure that absolute references are used.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional words: 2.0 2.00 2.01 2.1 2.10 2.2 2.20 2.21 3.0<BR>
3.00 4.0 4.00 5.0 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
