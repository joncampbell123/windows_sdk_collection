

<HTML>
<HEAD>
<TITLE>XL: How to Create a Demand-Loaded Add-in File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120796">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1994/09/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel versions 5.x and 7.0, it is possible to create a   demand-loaded  add-in file. This article describes the method used to  create a demand-loaded add-in file.  MORE INFORMATION  A demand-loaded add-in allows you to see the options...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QBJZ,QBV4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Create a Demand-Loaded Add-in File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120796</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0a, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for the Macintosh, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel versions 5.x and 7.0, it is possible to create a 
"demand-loaded" add-in file. This article describes the method used to 
create a demand-loaded add-in file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A demand-loaded add-in allows you to see the options the add-in provides
without actually loading the add-in: when you use one of the functions
included with the add-in, the add-in is loaded into memory: demand-loaded
add-ins are available in the Function Wizard dialog box even if the add-in
itself has not been loaded into memory.
<P>
To make a demand-loaded add-in file, follow these steps:

<OL><P><LI>Select any Microsoft Excel version 4.0 Macro sheet or worksheet in the
   workbook that you want to save as an add-in file.

<P><LI>On the Insert menu, click Name, and then click Define.

<P><LI>In the Define Name dialog box, enter the following values:
<P>
<P><PRE>      Names in Workbook edit box : __DemandLoad
</PRE><P>
<PRE>      Refers to edit box         : =TRUE

   Note that the word "DemandLoad" is preceded by *two* underscore
   characters.

</PRE><P><LI>Click OK.
<P>
</OL>When you make the workbook into an add-in, by choosing Make Add-In
from the Tools menu, and you then use the Add-Ins dialog box to add the
file to Microsoft Excel, the add-in will not actually be loaded until you
use or recalculate one of the functions, macros, or subroutines defined in
the add-in.
<P>
When you use the Add-Ins dialog box to add a demand-loaded add-in to
Microsoft Excel, a line similar to the following will be added to
your EXCEL5.INI file (if you are using Microsoft Excel for Windows):
<P>
<PRE>   OPEN7=/F C:\EXCEL\MYADDIN.XLA

</PRE></OL>In Microsoft Excel for Windows 95, an entry will be added to your system's
registry; in Microsoft Excel for the Macintosh, a change is made to your
"Excel Settings (5)" file.
<P>
The /F switch signifies to Microsoft Excel that the add-in in question is a
demand-loaded add-in. Microsoft Excel will not yet open the add-in file,
but it will read the available functions from the add-in and make them
available in the Function Wizard dialog box.
<P>
In Microsoft Excel for the Macintosh, the "Excel Settings (5)" file is
stored in a binary format and can only be read or edited by the Microsoft
Excel program.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Developer's Kit," version 5.0, page 382
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 5.00 5.00c 7.00<BR>
Version           : WINDOWS:5.0,5.0c,7.0; MACINTOSH:5.0<BR>
Platform          : MACINTOSH WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
