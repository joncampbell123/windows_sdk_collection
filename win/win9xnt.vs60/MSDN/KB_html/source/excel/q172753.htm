

<HTML>
<HEAD>
<TITLE>XL97: Error Updating or Modifying Link to DDE Server Program </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172753">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/08/14">
<META NAME="Keywords" CONTENT="xlformula xlgpf kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 97, if you click Update Now, Automatic, or Manual in the Links dialog box, you may receive the following error message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contac...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH4,QAXB,QAZ2,QAB4,QBD2,QBWS,QAC1,QAKP,QAIH,QAB9,QBVQ,QA01,QAUD,QAJH P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Error Updating or Modifying Link to DDE Server Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172753</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 97, if you click Update Now, Automatic, or Manual in the
Links dialog box, you may receive the following error message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to any of the
following:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at
   0137:30278a70.

   EXCEL caused an invalid page fault in module KERNEL32.DLL at
   0137:bff7677a.

   EXCEL caused an invalid page fault in module KERNEL32.DLL at
   0137:bff9a5d0.

</PRE>In addition, Microsoft Word 97 or Microsoft PowerPoint 97 may stop
responding.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when the following conditions are true:

<UL><LI>In a Microsoft Excel worksheet, you enter a formula that is linked to a
   dynamic data exchange (DDE) server program.
<P>
   For example, the formula may be similar to the following:
<P>
<P><PRE>      =StockSrv|Prices!MSFT
</PRE><P>
<P><PRE>    -and-
</PRE>
<LI>In the Links dialog box, you attempt to open the DDE server program
   by clicking Open Source.
<P>
   Note that when you do this, you receive the following error message:
<P>
<P><PRE>      Cannot start the source application for this object.
</PRE><P>
<P><PRE>    -and-
</PRE>
<LI>You click Update Now, Automatic, or Manual in the Links dialog box.
<P>
</UL>NOTE: This problem does not occur in earlier versions of Microsoft Excel.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do not click Open Source in the Links dialog
box when the selected source file is a DDE server program.
<P>
If the problem occurs, Microsoft Word 97 or Microsoft PowerPoint 97 may
stop responding. When this happens, press CTRL+ALT+DEL and close any
programs are not responding.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel, you can create a formula that returns information from
a DDE server program. The syntax of such a formula is as follows:
<P>
<PRE>   =&lt;ServerName&gt;|&lt;Topic&gt;!&lt;Value&gt;

</PRE>&lt;ServerName&gt; is usually the name of an .exe file, without the .exe file
name extension, for example, StockSrv. &lt;Topic&gt; and &lt;Value&gt; vary from
program to program.
<P>
When you enter a formula that returns information from a DDE server
program, the formula is updated each time the DDE server program broadcasts
new information.
<P>
When you open a workbook that contains formulas that refer to DDE server
programs, you are prompted whether to update the workbook. If you click No,
the formulas in the workbook that refer to the DDE server program are not
updated properly. If you want the formulas to update properly, follow these
steps:

<OL><P><LI>On the Tools menu, click Options.

<P><LI>Click the Calculation tab.

<P><LI>Click to select the Update Remote References check box. Then, click OK.
<P>
</OL>The formulas are updated properly.
<P>
There is no need to use the Links dialog box when you are working with
formulas that refer to DDE server programs. Attempting to use the Links
dialog box to control the connection to a DDE server program may cause
problems, for example, the problem described in this article.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL97 ipf gpf hang freeze lock up crash<BR>
Keywords          : xlformula xlgpf kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
