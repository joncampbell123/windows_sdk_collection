

<HTML>
<HEAD>
<TITLE>XL97: Change Event for ActiveX Control Runs Unexpectedly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169885">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1997/06/10">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  A change event macro that is assigned to an ActiveX control on a worksheet runs when the worksheet is recalculated instead of running when you change the control value.  CAUSE =====  This problem occurs when you assign the ListFillRange property of...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAY5,QA7O,QAB5,QAOE,QAMN,QAPN,QAHV,QAB9,QAO4,QBV8,QBWS,QAE5,QA28,QATJ P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Change Event for ActiveX Control Runs Unexpectedly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169885</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A change event macro that is assigned to an ActiveX control on a worksheet
runs when the worksheet is recalculated instead of running when you change
the control value.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when you assign the ListFillRange property of the
control to either of the following:

<UL><LI>A defined name that refers to a formula or cell containing a volatile
   function.
<P>
<P><PRE>    -or-
</PRE>
<LI>A cell that contains a formula containing a volatile function.
<P>
</UL>NOTE: A volatile function must be recalculated whenever calculation occurs
in any cells on the worksheet. A nonvolatile function is recalculated only
when the input variables change.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent the change event from running unexpectedly, do not assign its
ListFillRange property to a defined name or to a cell that contains a
function that is calculated whenever the worksheet changes (a volatile
function).
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design of Microsoft Excel 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, you can insert controls, for example a list box,
drop down, and edit box, into a worksheet. The ListFillRange property of
the control can be used to populate the control with information from the
worksheet. However, when you assign a macro to the change event for the
control and the data that populates the control contains a volatile
function, the change event macro may run whenever the worksheet is
recalculated.
<P>
Functions that are recalculated whenever the worksheet changes are volatile
functions. The following functions are volatile:
<P>
<PRE>   AREAS()
   INDEX()
   OFFSET()
   CELL()
   INDIRECT()
   ROWS()
   COLUMNS()
   NOW()
   RAND()

</PRE>For additional information volatile functions, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../vbapps/q81856.htm">Q81856</A></B>
   TITLE     : Excel: Functions Recalculated If New Data or Cells Entered

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about ActiveX controls, click the Index tab in
Microsoft Excel 97 Help, type the following text
<P>
<PRE>   ActiveX

</PRE>and then double-click the selected text to go to the "Add buttons, check
boxes, or other controls to a worksheet" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 XL97 drop down combo box list box text box check<BR>
box option button<BR>
Keywords          : kbprg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
