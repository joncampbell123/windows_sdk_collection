

<HTML>
<HEAD>
<TITLE>XL: Randomize Statement Doesn't Re-initialize Rnd Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120587">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1994/09/15">
<META NAME="Keywords" CONTENT="kbdocerr kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you use the Randomize statement in a Visual Basic procedure to initialize the random-number generator, the Rnd function returns a different series of random numbers each time you use it in the procedure, even if you use the...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QAND,QAB9,QAPN,QAY5,QAJQ,QBVP,QAKC,QBV8,QA5F,QAMA,QBC6,QAKD,QAG8,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Randomize Statement Doesn't Re-initialize Rnd Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120587</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
5.00 5.00c 7.00
WINDOWS
kbprg kbdocerr
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you use the Randomize statement in a Visual
Basic procedure to initialize the random-number generator, the Rnd
function returns a different series of random numbers each time you
use it in the procedure, even if you use the Randomize statement with
the same number value before each Rnd function.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Visual Basic documentation for the Randomize statement states
that the Randomize statement uses the number argument to initialize a
random-number generator, giving it a new seed value.
<P>
This information implies that the Randomize statement re-initializes
the Rnd function, so that when you use the Randomize statement with
the same number value preceding each Rnd function in a procedure,
each Rnd function returns the same pattern of random numbers.
<P>
However, this is incorrect. The current functionality of the
Randomize statement in Visual Basic, Applications Edition, is the
same as in the Basic, Visual Basic, and QuickBasic languages. The
Randomize statement does not reset the seed for the Rnd function.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To re-initialize the random-number generator, use the Rnd function
with a value of -1 to re-initialize the Rnd function, and then use
the Randomize statement with the value you want to use as the seed
value for the Rnd function. The following is an example of using this
method:
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<PRE>   Sub Random_Numbers()
       ' Define variable i as Integer type
       Dim i As Integer
       Workbooks.Add

       ' Initialize the random-number generator
       Rnd (-1)
       Randomize 10

       ' Insert random numbers in column A
       For i = 1 To 100
           Cells(i, 1) = Rnd
       Next

       ' Re-initialize the random-number generator
       Rnd (-1)
       Randomize 10

       ' Insert same series of random numbers in column B
       For i = 1 To 100
           Cells(i, 2) = Rnd
       Next

   End Sub

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft
products listed at the beginning of this article. We are researching
this problem and will post new information here in the Microsoft
Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the Randomize statement to create a seed value for the Rnd
function, or initialize the Rnd function. If Randomize is not used, the
same initial seed is always used to start the sequence.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Randomize Statement, choose the Search
button in the Visual Basic Reference and type:
<P>
<PRE>    Randomize

</PRE>For more information about the Rnd Function, choose the Search button
in the Visual Basic Reference and type:
<P>
<PRE>    Rnd
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbcode<BR>
KBSubcategory: kbdocerr
<P>

Additional reference words: 1.00 5.00 5.00c 7.00<BR>
Keywords            : kbdocerr kbcode kbprg<BR>
Version             : 5.00 5.00c 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
