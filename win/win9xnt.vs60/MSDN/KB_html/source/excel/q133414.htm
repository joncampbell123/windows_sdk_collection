

<HTML>
<HEAD>
<TITLE>XL7: DAO Error Using OpenDatabase on ODBC Sources </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133414">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1995/07/31">
<META NAME="Keywords" CONTENT="kbnetwork xlwin kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, when you attempt to open a database for use with Data Access Objects, you may receive the following error message:     Run Time Error 3423    You cannot use ODBC to attach (link) an external Microsoft Access or    ISAM database ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QBVP,QAZV,QA9E,QAU9,QBS0,QA1S,QAVX,QAVW,QAI5,QBWS,QAAP,QDN9,QBW7,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL7: DAO Error Using OpenDatabase on ODBC Sources</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133414</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Office for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, when you attempt to open a database for use with Data
Access Objects, you may receive the following error message:
<P>
<PRE>   Run Time Error 3423
   You cannot use ODBC to attach (link) an external Microsoft Access or
   ISAM database table to your database.

</PRE><h2>CAUSE</h2>
 
<P>
This error occurs if you are trying to open a database for which an
installable ISAM driver exists, and you are using an ODBC data source to
establish the connection to that database.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In this situation, you must use the ISAM driver to open the database.
<P>
The following two examples demonstrate the syntax for connecting to an
external database using Data Access Objects, using ISAM and ODBC drivers.
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
Before you run either of the following macros, use the following two steps:

<OL><P><LI>In the module sheet that contains the macro, click References and then
   click Tools.

<P><LI>From the list of references, select the Microsoft DAO 3.0 Object
   Library, and click OK.
<P>
   ODBC
   ----
<P>
   NOTE: If you use the dBASE driver in this manner, it will result in the
   error message listed above.
<P>
<PRE>   Sub ODBCMethod()
      Dim db1 As Database

      Set db1 = OpenDatabase("c:\test", False, False, _
          "ODBC;DSN=dBASE Files;DBQ=c:\test")
   End Sub

   ISAM
   ----

   Sub ISAMMethod()
      Dim db1 As Database
      Set db1 = OpenDatabase("c:\test", False, False, "dBASE IV")
   End Sub

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
When you use data access objects in Microsoft Excel for Windows, it is
possible to access an external database using either an installable ISAM
driver or an ODBC driver. The following are two examples of data base types
that can access an external database using either an installable ISAM
driver or an ODBC driver:
<P>
<PRE>   Microsoft Excel files
   Text files

</PRE>When you use these database types, you do not receive the error message
described in the "Symptoms" section of this article .
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00<BR>
Keywords            : kbnetwork xlwin kbnetwork<BR>
Version             : 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
