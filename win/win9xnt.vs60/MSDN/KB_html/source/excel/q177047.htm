

<HTML>
<HEAD>
<TITLE>XL98: Recorded AppleScript Cannot Create Embedded Chart </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177047">
<META NAME="KBModify" CONTENT="1998/02/09">
<META NAME="KBCreate" CONTENT="1997/11/19">
<META NAME="Keywords" CONTENT="xlchart xlvbainfo kbcode kbprg">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel 98 Macintosh Edition, if you create an embedded chart in a worksheet while recording an AppleScript script, the following problems may occur when you run the recorded script:   - The chart is not embedded in the worksheet. Instea...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDNQ,QA5V,QAH4,QDNX,QDO9,QBS0,QBWS,QAPN,QAQG,QAVZ,QBVV,QAB4,QBXR,QA5C V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL98: Recorded AppleScript Cannot Create Embedded Chart</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177047</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel 98 Macintosh Edition, if you create an embedded chart in
a worksheet while recording an AppleScript script, the following problems
may occur when you run the recorded script:

<UL><LI>The chart is not embedded in the worksheet. Instead, it appears as a
   separate chart sheet.

<LI>If you select a cell in the worksheet after creating the chart, you
   receive an error message similar to the following when you run the
   script:
<P>
<P><PRE>      Execution Error
      Microsoft Excel got an error: Range "R10C1" doesn't understand the
      Select message.
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
These problems occur because, when you create an embedded chart while
recording a script, the following code is recorded into the script:
<P>
<PRE>   Create New Chart

</PRE>When this code is run, it automatically creates a new chart sheet, not an
embedded chart.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Microsoft provides programming examples for illustration only, without
warranty either expressed or implied, including, but not limited to, the
implied warranties of merchantability and/or fitness for a particular
purpose. This article assumes that you are familiar with the programming
language being demonstrated and the tools used to create and debug
procedures. Microsoft support engineers can help explain the functionality
of a particular procedure, but they will not modify these examples to
provide added functionality or construct procedures to meet your specific
needs. If you have limited programming experience, you may want to contact
the Microsoft fee-based consulting line at (800) 936-5200. For more
information about the support options available from Microsoft, please see
the following page on the World Wide Web:
<P>
<PRE>   <B><A href="http://www.microsoft.com/support/supportnet/refguide/default.asp">http://www.microsoft.com/support/supportnet/refguide/default.asp</A></B>

</PRE>AppleScript is manufactured by Apple Computer, Inc., a vendor independent
of Microsoft; we make no warranty, implied or otherwise, regarding this
product's performance or reliability.
<P>
If you need an AppleScript script to be able to create an embedded chart,
record or write a Microsoft Visual Basic for Applications macro in
Microsoft Excel 98 Macintosh Edition that performs the required actions.
Then, while you are recording the script, run the macro in Microsoft Excel.
The command to run the macro will be correctly recorded into the script.
<P>
For example, if the macro in Microsoft Excel resembles the following:
<P>
<PRE>   Sub CreateEmbeddedChart()
       Charts.Add
       ActiveChart.ChartType = xlColumnClustered
       ActiveChart.SetSourceData Source:=Sheets("Sheet1").Range("A1:A5")
       ActiveChart.Location Where:=xlLocationAsObject, Name:="Sheet1"
   End Sub

</PRE>and is contained in Workbook1, the recorded script should resemble the
following:
<P>
<PRE>   tell application "Microsoft Excel"
       activate
       Evaluate "Workbook1!CreateEmbeddedChart()"
   end tell

</PRE>You can use other Visual Basic macros to perform other chart-related
actions, such as formatting series, adding labels and legends, and so on.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can use the AppleScript Script Editor to record scripts that interact
with many programs, including Microsoft Excel. When you record such a
script, every action you perform in Microsoft Excel is recorded into the
script. You can then run the script, and Microsoft Excel performs the
recorded actions.
<P>
When you record the creation of an embedded chart, the Script Editor
records code that is valid for Microsoft Excel for the Macintosh, version
5.x. However, because Microsoft Excel 98 Macintosh Edition uses a different
method to create charts, the recorded code does not run properly in
Microsoft Excel 98 Macintosh Edition.
<P>
In addition, because a different sheet is active, worksheet-related actions
in the script may fail when they are executed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XL98<BR>
Keywords          : xlchart xlvbainfo kbcode kbprg<BR>
Version           : MACINTOSH:98<BR>
Platform          : MACINTOSH<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
