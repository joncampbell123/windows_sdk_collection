

<HTML>
<HEAD>
<TITLE>XL: How to Count Unique Elements in a Cell Range </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q90400 ">
<META NAME="KBModify" CONTENT="1998/02/02">
<META NAME="KBCreate" CONTENT="1992/10/14">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel, you can use the FREQUENCY function in an array formula  to count the unique elements in a cell range.  MORE INFORMATION  The following formula counts the number of unique values found in the range A1:A10 and does not count blank...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAG8,QAKC,QAB9,QBJZ,QAUD,QAKH,QBC6,QAHH,QDNZ,QDMR,QAY5,QALB,QAKD,QBV8 P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: How to Count Unique Elements in a Cell Range</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q90400 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 5.0, 5.0c
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for the Macintosh, versions 4.0, 5.0, 5.0a
<LI>Microsoft Excel 98 Macintosh Edition
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Excel, you can use the FREQUENCY function in an array formula 
to count the unique elements in a cell range.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following formula counts the number of unique values found in the
range A1:A10 and does not count blank cells and text entries:
<P>
<PRE>   =SUM(IF(FREQUENCY(A1:A10,A1:A10)&gt;0,1))

</PRE>NOTE: The formula above, and those that follow, are array formulas and
must be entered by pressing COMMAND+ENTER (if you are using Microsoft
Excel for Windows, press CTRL+SHIFT+ENTER).
<P>
The FREQUENCY function returns a range of numbers. For the first
occurrence of a specific value, this function returns a number equal
to the number of occurrences of that value. For each occurrence of
that same value after the first, this function returns a zero. Thus,
this function counts the number of unique values.
<P>
Because the FREQUENCY function works only with numbers, you must add
a level for evaluating unique text entries (or mixed numbers and
text), as in the following example:
<P>
<PRE>   =SUM(IF(FREQUENCY(MATCH(A1:A10,A1:A10,0),MATCH(A1:A10,A1:A10,0))&gt;0,1))

</PRE>The above formula counts the number of unique text and numeric entries
for A1:A10, where A1:A10 contains no blanks cells.
<P>
Adding an additional test allows unique numeric and text elements to
be counted in a range that includes blank cells:
<P>
<PRE>   =SUM(IF(FREQUENCY(IF(LEN(A1:A10)&gt;0,MATCH(A1:A10,A1:A10,0),""),
      IF(LEN(A1:A10)&gt;0,MATCH(A1:A10,A1:A10,0),""))&gt;0,1))

</PRE>By substituting the final a1:a10 for the 1 in the original formula it will
now sum unique values for a range of cells.
<P>
<PRE>   =SUM(IF(FREQUENCY(A1:A10,A1:A10)&gt;0,A1:A10))
   
</PRE>NOTE: These formulas must be entered as array formulas in order to
work correctly.
<P>
For more information regarding SUM(IF()) formulas, use the appropriate
reference below:

<UL><LI>For Microsoft Excel for the Macintosh running System 6.x, click
   Help on the Window menu.

<LI>For Microsoft Excel for the Macintosh running System 7.0 or System
   7.1, click Microsoft Excel Help on the Balloon help menu.

<LI>For Microsoft Excel 5.x for Windows, click Contents on the Help menu,
   select the Product Support option, and select the Answers to Common
   Questions option. The answers to questions 9-11 all use SUM(IF())
   formulas.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
"Microsoft Excel Function Reference," version 4.0, pages 178-179
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.0 4.00 5.00 5.00a 5.00c 7.00 7.00a 97 98 XL98 <BR>
XL97 XL7 XL5 XL4<BR>
Version           : WINDOWS:4.0,5.0,7.0,97; MACINTOSH:4.0,5.0,5.0a,98<BR>
Platform          : MACINTOSH WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
