

<HTML>
<HEAD>
<TITLE>XL: Find and Replace Commands Don't Work with Nonadjacent Cells </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99520 ">
<META NAME="KBModify" CONTENT="1997/08/07">
<META NAME="KBCreate" CONTENT="1993/06/02">
<META NAME="Keywords" CONTENT="kbprb">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel versions 4.0 and 4.0a for Windows, when you use the Find and Replace commands (located on the Formula menu) on nonadjacent selections, you receive the following unexpected results:   - Microsoft Excel may not find ALL of the matc...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO0,QBVP,QDNZ,QA2Q,QAG2,QBXS,QANX,QAHH,QBWS,QBV8,QAB9,QACI,QAJQ,QDMR,QA62 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Find and Replace Commands Don't Work with Nonadjacent Cells</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99520 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00 4.00a
WINDOWS
<P>
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 4.0, 4.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel versions 4.0 and 4.0a for Windows, when you use the
Find and Replace commands (located on the Formula menu) on nonadjacent
selections, you receive the following unexpected results:

<UL><LI>Microsoft Excel may not find ALL of the matching cells in the
   selected range.

<LI>Microsoft Excel may find and replace the contents of cells that are
   not part of the selected ranges.
<P>
</UL>The cells that ARE found will match the specified criteria.
<P>
Note: These commands work correctly in Microsoft Excel versions 3.0
and 4.0 for the Macintosh and in Microsoft Excel version 3.0 for
Windows.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the versions of Microsoft
Excel listed above. This problem was corrected in a later version of
Microsoft Excel.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The incorrect selections will vary depending on which cell is active
in the selection, the option that is selected under Look By in the
Find and Replace dialog boxes, and the relationship of the Nonadjacent
ranges.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, select an adjacent range of cells when
you use the Find or Replace commands on the Formula menu.
<P>
The Replace command fails in the same way as the Find command does
when you are using the Find Next and Replace buttons to individually
change cells. If you use the Replace All button, all of the matching
cells will be correctly found and replaced with the text specified in
the Replace With box. The one instance in which Replace All may fail
is when there is a matching cell between the nonadjacent selections
and, prior to selecting Replace All, you toggled through each of the
matching cells using Find Next.
<P>
<P><h3>Steps to Reproduce the Problem</h3>
 
<P>
Following are examples where the Find and Replace commands do not work
correctly.
<P>
<P><h3>Example 1</h3>
 

<OL><P><LI>Enter the following in cells A1:A5.
<P>
<P><PRE>    A1: a
    A2: b
    A3: a
    A4: b
    A5: a
</PRE>
<P><LI>Select cells A1:A2. Then hold down the CTRL key while selecting
   cells A4:A5. Cell A4 will be the active cell.

<P><LI>From the Formula menu, choose Find. In the Find What box, Type "a"
   (without the quotation marks). Set the Look By option to Rows and
   choose OK.
<P>
   When you choose OK, cell A5 will be selected. Pressing F7 to find
   the next match will correctly choose A1. Pressing F7 once again
   will cause A1:A2 and A4:A5 to be highlighted with no active cell
   appearing to be chosen. Pressing F7 again will correctly select A5.
   Note that the same behavior occurs if you're using the Find Next
   button in the Formula Replace dialog box. If you then choose the
   Replace All button to change occurrences of a to c, the entries in
   cells A1, A3, and A5 will be changed to c. An a should remain in
   cell A3 since it wasn't part of the selected range.
<P>
</OL><h3>Example 2</h3>
 

<OL><P><LI>Enter the following into cells A1:C4.
<P>
<PRE>     A1: a   B1: a   C1: b
     A2: a   B2: b   C2: b
     A3: b   B3:     C3: a
     A4: b   B4:     C4: a

</PRE><P><LI>Select cells A1:A4. Then hold down the CTRL key while selecting
   cells C1:C4. Cell C1 will be the active cell.

<P><LI>From the Formula menu, choose Find. In the Find What box, type "a"
   (without the quotation marks). Set the Look By option to Rows and
   choose OK.
<P>
</OL>When you choose OK, cell C3 will be the active cell. Use the F7 key to
find the next occurrences of a in the selection. Cell A2 is never
selected. When it should be selected, A1:A4 and C1:C4 instead are
highlighted with no apparent active cell. Pressing F7 again will take
you back to cell C3.
<P>
If you begin with cell A1 active by selecting C1:C4 first and then
A1:A4, choosing Find from the Formula menu and pressing F7 will take
you from cell A1 to cell A2 to cell C3 where it stops. Pressing F7
continually selects cell C3 when it should go to cell C4 next and then
back to cell A1.
<P>
Again with A1 the active cell in the Nonadjacent selection, if you
select the Look By Columns option instead of Rows, the Find command
and F7 correctly selects cells A1 and A2. Next C3 and C4 will be
selected but pressing F7 should take you back to A1; C3 is selected
instead.
<P>
Different behavior may occur when the one range is above or below
another and this will vary according to the option you have selected
for the Look By option.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"User's Guide 1," pages 202-204.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 4.00 4.00a noupd<BR>
Keywords          : kbprb<BR>
Version           : 4.00 4.00a<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
