

<HTML>
<HEAD>
<TITLE>XL97: Html.xla Add-in May Delete All Files in a Folder </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167612">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/04/28">
<META NAME="Keywords" CONTENT="xlloadsave xlvbainfo xlweb kbenv kbfile">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  This article contains information that describes a known problem that may occur in Microsoft Excel 97 when you click Save As HTML on the File menu in order to save a file in a folder on a server running Microsoft Windows NT. The  More Information  ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QAUR,QBTI,QAU7,QBVP,QBD2,QAXB,QAKP,QAH0,QBWP,QAFI,QAO4,QAC1,QAGB,QAEF P2 T2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL97: Html.xla Add-in May Delete All Files in a Folder</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167612</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Windows NT, versions 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains information that describes a known problem that may
occur in Microsoft Excel 97 when you click Save As HTML on the File menu in
order to save a file in a folder on a server running Microsoft Windows NT.
The "More Information" section of this article contains a full description
of the problem and information about how to avoid the problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following section addresses common questions regarding the problem with
the Save As HTML command.

<PRE>1. Q. I heard that there is a problem with the Save As HTML command in
      Microsoft Excel 97. What's the situation?

   A. The Save As HTML menu command is provided by the Html.xla add-in
      included with Microsoft Excel 97. There is a problem in the Visual
      Basic for Applications programming system that is "exposed" by the
      code in the Html.xla add-in. Because of this problem, files may be
      deleted when you use the Save As HTML command to save a worksheet
      in the Hypertext Markup Language (HTML) format in a folder on a
      computer running Microosft Windows NT, version 3.51 or 4.0.

2. Q. When does this problem occur?

   A. This problem may occur when the following conditions are both true:

       - You save the HTML file to a network server running Microsoft
         Windows NT Server, version 3.51 or 4.0, or Microsoft Windows NT
         Workstation, version 3.51 or 4.0.

         -and-

       - You save the HTML file to a mapped drive on the network server.

      NOTE: The problem does not occur when you save an HTML file to a
      share on a computer running Microsoft Windows 95. The problem also
      does not occur when you save an HTML file to a share using the
      universal naming convention (UNC).

      For example, if you save an HTML file using the following convention

         \\&lt;Server&gt;\&lt;Share&gt;

      the problem does not occur.

      However, if you save an HTML file to drive D, where drive D is mapped
      to \\&lt;Server&gt;\&lt;Share&gt;, and &lt;Server&gt; is a computer running Windows NT,
      the problem occurs. When you do this, all of the files in the folder
      in which you save the HTML file may be deleted.

3. Q. What does Microsoft plan to do about this problem?

   A. Microsoft works hard to respond to issues raised by our customers.
      We have developed an updated Html.xla that corrects the problem
      described in this article. We will begin distributing this updated
      add-in as soon as possible.

4. Q. When (and where) can I get this updated Html.xla add-in?

   A. The updated Html.xla add-in is available as of May 5, 1997. You can
      download the add-in from the following address on the Internet:

         <B><A href="http://www.microsoft.com/officefreestuff/excel/">http://www.microsoft.com/officefreestuff/excel/</A></B>

      The updated Html.xla is available free of charge to all users of
      Microsoft Excel 97.

      NOTE: Because the Microsoft Web site is constantly updated, the site
      address may change without notice. If this occurs, link to the
      Microsoft home page at the following address:

         <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

5. Q. What can I do to address the problem until the updated Html.xla is
      available?

   A. Until you download and install the updated Html.xla add-in, do NOT
      USE the Save As Html menu command to save HTML files to mapped
      network drives. If you do this, you risk deleting all of the files
      in the folder in which you are saving the HTML file.

      CAUTION: Because Microsoft Windows NT does not allow you to undelete
      files, this problem can result in permanent data loss.

      Instead of saving the file to the server, save the HTML file to a
      folder on a local hard disk. If you must save the HTML files to a
      folder on a computer running Windows NT, make sure that you use the
      universal naming convention to connect to the server instead of a
      mapped drive letter. Or, make sure that the folder in which you are
      saving the HTML file is completely empty.

6. Q. Does the updated Html.xla do anything else besides fix this problem?

   A. Yes, it does. The updated Html.xla add-in also includes the
      following new features:

       - The updated Html.xla allows you to use a Visual Basic for
         Applications macro to save worksheets as HTML files. Without the
         updated add-in, you cannot easily perform this task using a macro.

       - When you save a worksheet in the HTML format, the updated
         Html.xla preserves all data and filters (except custom filters)
         in ranges you specify for an AutoFilter.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 3.51 4.00 XL97 internet assistant wizard<BR>
Keywords          : xlloadsave xlvbainfo xlweb kbenv kbfile<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
