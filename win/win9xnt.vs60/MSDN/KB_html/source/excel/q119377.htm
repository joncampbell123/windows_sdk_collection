

<HTML>
<HEAD>
<TITLE>XL5: GP Fault Evaluating INDIRECT() in Defined Name on Chart </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119377">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/08/15">
<META NAME="Keywords" CONTENT="kbother fixlist5.00c">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In Microsoft Excel version 5.0, if you open a Microsoft Excel version 4.0 chart file, and the chart has a reference that contains the INDIRECT() function in a defined name, you receive a general protection (GP) fault if you evaluate the reference i...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QBKN,QAM5,QAUJ,QAB4,QAY5,QAKD,QAB3,QADK,QABH,QAHN,QDNX,QAB9,QBV8,QARM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: GP Fault Evaluating INDIRECT() in Defined Name on Chart</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119377</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel version 5.0, if you open a Microsoft Excel version 4.0
chart file, and the chart has a reference that contains the INDIRECT()
function in a defined name, you receive a general protection (GP) fault if
you evaluate the reference in the formula bar.
<P>
<P><h2>CAUSE</h2>
 
<P>
When you open a Microsoft Excel version 4.0 file that contains a defined
name, the name is defined as a global name, rather than a local name. If
the name contains the INDIRECT() function, and the reference in the
function does not contain the worksheet name, the INDIRECT() function
evaluates the reference on the current sheet.
<P>
In Microsoft Excel version 5.0, when you open a Microsoft Excel version 4.0
chart, or if you activate a chart contained in a version 4.0 workbook, and
a reference on the chart contains the INDIRECT() function, you receive the
following error message:
<P>
<PRE>   External reference is not valid

</PRE>Note that this same error message appears if you create a chart in
Microsoft Excel version 5.0, and then reference a defined name that
contains the INDIRECT() function.
<P>
If you evaluate the reference to the defined name that contains the
INDIRECT() function on the chart sheet, by selecting the reference, and
pressing F9, you receive a GP fault.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving a GP fault when you evaluate a reference to a defined
name that contains the INDIRECT() formula, include the sheet name in the
INDIRECT() function. For example, use
<P>
<PRE>   =INDIRECT("Sheet1!$A$1")

</PRE>instead of:
<P>
<PRE>   =INDIRECT("$A$1")

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in
Microsoft Excel for Windows version 5.0c.
<P>
In Microsoft Excel version 5.0c, you still receive the "External
reference is not valid" error message when you activate the chart sheet.
However, when you evaluate the reference on the chart, you do not
receive a GP fault. Instead, the reference evaluates to the #REF! Error
value.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about INDIRECT, choose the Search button in Help
and type:
<P>
<PRE>   INDIRECT function
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 gpf
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
