

<HTML>
<HEAD>
<TITLE>XL5: Function Wizard Error When Function Contains Loop </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121940">
<META NAME="KBModify" CONTENT="1996/09/12">
<META NAME="KBCreate" CONTENT="1994/10/24">
<META NAME="Keywords" CONTENT="kbtool kbmacro">
<META NAME="KBArea" CONTENT="Support; KB; excel, convert, crossnet, odbc, winprint, setup">
<META NAME="Description" CONTENT="  In the versions of Microsoft Excel listed in the beginning of the article, if you use the Function Wizard to insert a function that contains a loop, you will receive an error message in the macro.  CAUSE =====  This error occurs because of the way ...">
<META NAME="Product" CONTENT="Excel">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAY5,QAB9,QBV8,QAB4,QAAP,QBS0,QAO4,QAIK,QAH4,QAA7,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL5: Function Wizard Error When Function Contains Loop</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121940</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, versions 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In the versions of Microsoft Excel listed in the beginning of the article,
if you use the Function Wizard to insert a function that contains a loop,
you will receive an error message in the macro.
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs because of the way the Function Wizard calculates the
results of functions when you select them.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To prevent this error from occurring, you can do any one of the following:

<UL><LI>Use a Visual Basic, Applications Edition, subroutine instead of an MS
   Excel 4.0 macro. This error does not occur when using Visual Basic,
   Applications Edition, functions.
<P>
   -or-

<LI>When the Macro Error dialog box is displayed, choose the Halt button.
   This will allow you to proceed normally.
<P>
  -or-

<LI>Upgrade to Microsoft Excel version 5.0c for Windows. The error does
   not occur in this version of Microsoft Excel.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
When you use the Function Wizard to insert a function into a formula in
Microsoft Excel version 5.0, the Function Wizard calculates the result of
the function before it actually places the function in the formula.
<P>
If the function contains a loop, and if the function is written using the
Microsoft Excel 4.0 Macro language, the Function Wizard cannot properly
handle the loop, and a macro error will be reported at the locations in the
macro where the following commands occur:
<P>
<PRE>   =FOR() command
   =NEXT() command
   =WHILE() command

</PRE>If you choose the Continue or Halt button each time the Macro Error dialog
box is displayed, you will be allowed to continue working in the Function
Wizard.
<P>
Note that this error occurs ONLY when you use an MS Excel 4.0 function
macro in Microsoft Excel version 5.0 for Windows.
<P>
This error does not occur when you use a function written in Visual Basic,
Applications Edition, nor does it occur in Microsoft Excel version 5.0 for
the Macintosh or in Microsoft Excel version 5.0c for Windows.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 5.00 function wizard formula
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
