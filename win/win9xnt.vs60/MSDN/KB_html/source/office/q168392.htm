

<HTML>
<HEAD>
<TITLE>OFF97: Limitations of ActiveX Control Support in Office Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168392">
<META NAME="KBModify" CONTENT="1997/05/13">
<META NAME="KBCreate" CONTENT="1997/05/12">
<META NAME="Keywords" CONTENT="kb3rdparty kbinterop kbole kbui kbusage offbinder offinterop offweb">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  This article discusses the limitations that you may encounter when you use an ActiveX control in a document created in a Microsoft Office program.  MORE INFORMATION  The following section describes the limitations for using an ActiveX control in a ...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB5,QA7O,QAOE,QAMN,QAHV,QAIH,QBRJ,QBVV,QBV9,QA1S,QBVQ,QAW6,QBBS,QDKP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Limitations of ActiveX Control Support in Office Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168392</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Access 97
<LI>Microsoft Word 97 for Windows
<LI>Microsoft PowerPoint 97 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses the limitations that you may encounter when you
use an ActiveX control in a document created in a Microsoft Office program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following section describes the limitations for using an ActiveX
control in a Microsoft Office program. The limitations listed in this
article may not apply to all Office programs.
<P>
<P><h3>Some ActiveX Controls Do Not Support IDataObject</h3>
 
<P>
The ActiveX control container implementations in Microsoft Word, Microsoft
Excel, and Microsoft PowerPoint use the IDataObject interface not the
IViewObject interface to draw controls. ActiveX controls that do not
support IDataObject and require IViewObject support in containers do not
work in Word, Microsoft Excel, or PowerPoint documents.
<P>
IViewObject is an interface that is used by some ActiveX control containers
to draw the control inside the window of the container application. Word,
Microsoft Excel, and PowerPoint do not use IViewObject to draw controls
that they contain; they use another interface called IDataObject
exclusively for this purpose. As a result, certain ActiveX controls that do
not support IDataObject do not work inside of Word, Microsoft Excel, and
PowerPoint documents.
<P>
To determine whether an ActiveX control requires support for the
IViewObject interface, contact the control vendor.
<P>
NOTE: Microsoft Access does not have this limitation and can host controls
that do not support IDataObject. UserForms in Word, Microsoft Excel, and
PowerPoint do not have this limitation and can host controls that do not
support IDataObject.
<P>
<P><h3>Container Must Support IViewObject to Properly Display ActiveX Controls</h3>
 
<P>
An ActiveX control may behave unpredictably when displayed in multiple
views of the same document.
<P>
For an ActiveX control to appear and function properly in multiple windows
or panes of the same document, the container application must support the
IViewObject interface. Because Word, Microsoft Excel, and PowerPoint do not
support this interface (as discussed in the previous section), the behavior
of an ActiveX control that is viewed in two different windows or panes of
the same document may be unpredictable.
<P>
NOTE: Microsoft Access does not have this limitation because it supports
the IViewObject interface.
<P>
<P><h3>Some Programs Do Not Support ISimpleFrameSite</h3>
 
<P>
The ActiveX control container implementations in Microsoft Access, Word,
Microsoft Excel, and PowerPoint do not support the ISimpleFrameSite
interface. Simple frame ActiveX controls do not work inside documents
created with these programs.
<P>
A class of ActiveX controls called simple frame controls implement an
interface called ISimpleFrame and work only inside containers that support
the ISimpleFrameSite interface. Microsoft Access, Word, Microsoft Excel,
and PowerPoint do not support ISimpleFrameSite and cannot host these
controls.
<P>
NOTE: UserForms also have this limitation.
<P>
<P><h3>In-Place Editing Limitations in Office Programs</h3>
 
<P>
ActiveX controls in a Microsoft Excel worksheet are disabled when you are
editing in place. For example, the controls are disabled when Microsoft
Excel is activated as an OLE object inside a container application, as an
ActiveX document inside Microsoft Internet Explorer, or in Office Binder.
<P>
This limitation is specific to Microsoft Excel. When you are editing in
place in Microsoft Excel inside a container application, you cannot
activate ActiveX controls in Microsoft Excel worksheets. When you click an
ActiveX control while Microsoft Excel is in in-place editing mode, the
following alert message appears:
<P>
<PRE>   That control can only be used while the worksheet is displayed in a
   separate window. Do you want to open a window for the worksheet?

</PRE>This alert message has Yes and No buttons. Clicking No results in no
action; clicking Yes opens the object in its native Microsoft Excel window.
The control is fully functional in this window.
<P>
Note that in in-place editing mode in a Microsoft Excel worksheet, ActiveX
controls are displayed correctly. You can select them in design mode. You
are restricted only from activating these controls. If it is important that
controls are fully functional when you edit in place in an Microsoft Excel
worksheet, you can use built-in Microsoft Excel controls that are available
on the Forms toolbar.
<P>
When you click an ActiveX control while you are editing in place in a
Microsoft Word document, Microsoft Word menus and toolbars unmerge from
menus and toolbars that belong to the ActiveX document container.
<P>
When you are editing in place in a Microsoft Word document and you activate
an ActiveX control by using the interface, toolbars and menus unmerge from
menus and toolbars that belong to the container application. For example,
this behavior occurs when you click a button control in a Microsoft Word
document that is embedded in Microsoft Internet Explorer. When the focus
returns to the Microsoft Word document, the Microsoft Word toolbars and
menus merge with the menus of the container application. When you work with
an ActiveX control that is in a Microsoft Word document and is activated as
a Binder section or as an ActiveX document inside of Microsoft Internet
Explorer, menus and toolbars may disappear, and then reappear.
<P>
<P><h3>Microsoft Excel Charts Cannot Contain ActiveX Controls</h3>
 
<P>
You cannot insert ActiveX controls into Microsoft Excel charts. You can
insert controls on top of chart objects that are embedded in a worksheet;
however, these controls are not active when you click the chart.
<P>
<P><h3>Word, Microsoft Excel, and PowerPoint Do Not Support Component Categories</h3>
 
<P>
Word, Microsoft Excel, and PowerPoint do not support ActiveX control
categories. The implication is that controls that appear in the user
interface to insert non-Office controls may not necessarily work in these
Office programs. There is no filtering in the user interface based on
component categories. For example, it is possible for an ISimpleFrame
control to appear in the More Controls list for Microsoft Word even though
it does not work.
<P>
Microsoft Access supports component categories. Controls that are
unsupported in Microsoft Access do not appear in the control list.
Component categories are supported if the control vendor builds controls
that support the categories.
<P>
Some ActiveX Controls Are Not Automatically Downloaded
When You Use Microsoft Internet Explorer
 
<P>
When you browse an Intranet web with a mixture of Hypertext Markup Language
(HTML) and Office documents by using Microsoft Internet Explorer 3.0 or
later, ActiveX controls that are embedded in Office documents are not
automatically downloaded to the client computer.
<P>
In HTML pages that contain ActiveX controls, Microsoft Internet Explorer
downloads ActiveX controls automatically. For example, the controls are
downloaded when Office is installed on the client computer and you use only
ActiveX controls that ship with Office in the document in question.
<P>
<P><h3>Miscellaneous limitations</h3>
 
<P>
The following ActiveX control functions are not supported in Microsoft
Access, Word, Microsoft Excel, or PowerPoint:

<UL><LI>Visual Basic style control arrays

<LI>Drag-and-drop events on controls

<LI>Delete events on controls

<LI>Multi-threaded ActiveX controls
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kb3rdparty kbinterop kbole kbui kbusage offbinder offinterop offweb<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
