

<HTML>
<HEAD>
<TITLE>How to Rebuild the Reg.dat File and Re-register Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122964">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1994/11/17">
<META NAME="Keywords" CONTENT="kbole kbusage">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  Windows uses the registration database (Reg.dat) to store information about OLE-compliant applications. Information in the Reg.dat file pertaining to a specific application may be incorrect, or the entire Reg.dat file may become corrupted.  This ar...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDL9,QBWO,QBWN,QAJH,QBWQ,QAA1,QBWS,QDKX,QDI2,QBVQ,QAFI,QAIH,QBJZ,QA2R V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Rebuild the Reg.dat File and Re-register Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122964</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access, version 2.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Office for Windows, versions 4.0, 4.2, 4.3
<LI>Microsoft PowerPoint for Windows, versions 4.0, 4.0a, 4.0c
<LI>Microsoft Publisher for Windows, versions 2.0, 2.0a
<LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Works for Windows, version 3.0
<LI>Microsoft Windows, versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups, versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows uses the registration database (Reg.dat) to store information about
OLE-compliant applications. Information in the Reg.dat file pertaining to a
specific application may be incorrect, or the entire Reg.dat file may
become corrupted.
<P>
This article explains how to rebuild the entire Reg.dat file and how to
re-register individual applications (including specific Microsoft
applications).
<P>
You should rebuild the Reg.dat file only be done when other troubleshooting
measures have proven unsuccessful, and when the nature of the problem
suggests Reg.dat difficulties.
<P>
If the problem affects only one application, re-register an individual
application before rebuilding the entire Reg.dat.
<P>
If the problem you are trying to solve is OLE-related, and other
troubleshooting methods haven't worked, rebuild the entire Reg.dat file.
<P>
It is not clear what causes corrupt Reg.dat files.
<P>
The "More Information" section of this article is divided into the
following subsections:

<UL><LI>How to Rebuild the Reg.dat File Completely
<LI>How to Re-Register Applications
<LI>How to Re-Register Individual Microsoft Applications
<P><PRE>      Microsoft Access 2.0
      Microsoft Excel 5.0
      Microsoft Office 4.2
      Microsoft Office 4.3 Shared Applications
      Microsoft PowerPoint 4.0
      Microsoft Publisher 2.0
      Microsoft Word 6.0
      Microsoft Works 3.0
</PRE><LI>Background: How Applications Register Automatically
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h2>HOW TO REBUILD THE REG.DAT FILE COMPLETELY</h2>
 
<P>
To completely rebuild the Reg.dat file, perform the following steps:

<OL><P><LI>Rename the Reg.dat file in your Windows folder to Regdat.old.

<P><LI>In the Win.ini file, disable each line of the [EMBEDDING] section by
   inserting a semicolon (;) at the beginning of each line. This prevents
   Windows from rebuilding a new Reg.dat file based on this section.
   These remarked lines may be removed once the applications have been
   re-registered (refer to the section below entitled HOW TO RE-REGISTER
   APPLICATIONS).
<P>
   Once all changes have been made, click Save on the File menu. Then,
   click Exit on the File menu.

<P><LI>Quit and then restart Windows.

<P><LI>In Program Manager, click Run on the File menu. In the Command Line
   box, type the following command:
<P>
<P><PRE>      regedit /u c:\windows\system\setup.reg
</PRE><P>
   NOTE: Substitute the correct path to your Windows\System folder if your
   path is different.

<P><LI>Click OK.

<P><LI>Erase the contents of the Command Line box. In it, type the following
   command:
<P>
<P><PRE>      regedit c:\windows\system\ole2.reg
</PRE><P>
   NOTE: Substitute the correct path to your Windows\System folder if
   your path is different.

<P><LI>To begin the troubleshooting portion of this procedure, register only
   the applications that were having problems. Use the steps in the section
   of this article titled "How to Re-register Individual Microsoft
   Applications."
<P>
   If the problems disappear after the Reg.dat file has been rebuilt and
   the concerned applications have been re-registered, you can assume that
   a corrupted Reg.dat file was the problem and that the problem has been
   solved. Continue to re-register the remaining applications.
<P>
</OL><h2>HOW TO RE-REGISTER APPLICATIONS</h2>
 
<P>
The best method for re-registering an application is to reinstall it. Many
applications have a Setup icon in Program Manager in the program group
where
the application icon is located. To reinstall these applications, double-
click each icon and choose the reinstall option. If there is no Setup icon,
insert the first disk of the application's program disks, and run Setup
from the disk. Choose the Reinstall option.
<P>
See the following section for instructions on how to re-register Microsoft
applications.
<P>
<P><h2>HOW TO RE-REGISTER INDIVIDUAL MICROSOFT APPLICATIONS</h2>
 
<P>
<P><h3>Associate .reg Files with Regedit.exe</h3>
 
<P>
For an application to automatically register itself when the .reg file is
double-clicked, files with the .reg extension must be associated with the
REGEDIT program. To ensure that association, use the following steps:

<OL><P><LI>Start File Manager. On the File menu, click Associate.

<P><LI>In the Associate dialog box, type "reg" (without the quotation marks)
   in the Files With Extension box.

<P><LI>Use the scroll bar below the Associate With box to select Registration
   Entries (Regedit.exe). If it is not in the list, click Browse and
   select Regedit.exe from the files in the Windows folder. Click the
   OK button.
<P>
</OL><h3>Microsoft Access 2.0</h3>
 
<P>
To register Microsoft Access, start Microsoft Access. Microsoft Access
registers itself automatically when run, so it is not necessary to merge
its .reg files into the registration database.
<P>
<P><h3>Microsoft Excel 5.0</h3>
 
<P>
To register Microsoft Excel, start Microsoft Excel. Microsoft Excel
registers itself automatically when run, so it is not necessary to merge
its .reg files into the registration database.
<P>
However, if there is no current entry for Microsoft Excel in the registry
and you allow it to self-register, it may include incorrect information
that could cause erratic behavior of the OLE server. To avoid this,
reinstall Microsoft Excel.
<P>
An alternative method involves the following two steps:

<OL><P><LI>Follow the steps in the "Associate .reg files with Regedit.exe" section
   located above. Locate the Excel5.reg file in the Microsoft Excel folder
   and double-click it.

<P><LI>In File Manager, start Excel.exe.
<P>
</OL>Microsoft Excel is now properly registered.
<P>
<P><h3>Microsoft Office 4.2</h3>
 
<P>
Microsoft Office 4.2 and Microsoft Office 4.3 use .reg files that contain
variable path statements for their applications. Depending upon your
directory structure, these may be incorrect. To merge these .reg files,
open them and edit them first.
<P>
You will find the following .reg files in different locations depending on
the media and size. They are on Disk 1 of non-DMF versions, varying disk
numbers of DMF disks and in the Setup.adm\Disk1 folder of the Office 4.2-CD
and 4.3-CD:
<P>
<PRE>   Artgalry.reg
   Eqnedit2.reg
   Graph5.reg
   Orgchart.reg
   Pp4.reg
   Wordart2.reg

</PRE></OL>To use these files to register the applications, follow these steps:

<OL><P><LI>Copy the appropriate .reg file to your hard disk. (You can copy the file
   to any folder that you want.)

<P><LI>Open the .reg file in Notepad or any text editor.

<P><LI>Search the file for all occurrences of the following text string
<P>
<P><PRE>      &lt;Windows Dir&gt;
</PRE><P>
   and change these occurrences to the actual path of the Windows
   directory. For example, if the line as it appears in the .REG file is
<P>
<P><PRE>      HKEY_CLASSES_ROOT\MSOrgChart.1\protocol\StdFileEditing\server =
      &lt;Windows Dir&gt;\MSAPPS\ORGCHART\ORGCHART.EXE
</PRE><P>
   and your Windows directory is D:\WIN31, change the line to read:
<P>
<P><PRE>      HKEY_CLASSES_ROOT\MSOrgChart.1\protocol\StdFileEditing\server =
      D:\WIN31\MSAPPS\ORGCHART\ORGCHART.EXE
</PRE>
<P><LI>If you are running the shared OLE applications from a network server,
   you must include the whole path to the .exe file. (You may use the
   universal naming convention [UNC] for this.) For example, if you are
   running Organization Chart from a server called \\Server1\Share (which
   you routinely map to your W: drive), you should modify the above line
   to read:
<P>
<P><PRE>      HKEY_CLASSES_ROOT\MSOrgChart.1\protocol\StdFileEditing\server =
      W:\MSAPPS\ORGCHART\ORGCHART.EXE
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      HKEY_CLASSES_ROOT\MSOrgChart.1\protocol\StdFileEditing\server =
      \\SERVER1\SHARE\MSAPPS\ORGCHART\ORGCHART.EXE
</PRE>
<P><LI>Save the file. Exit your text editor.

<P><LI>If you have associated .reg files with Regedit.exe (see the steps
   outlined under "Associate .reg files with Regedit.exe" above), you can
   now merge this updated .reg file by double-clicking it in File Manager.
   Alternatively, on the File menu in Program Manager, click Run, type
   the following line and press ENTER:
<P>
<P><PRE>      regedit &lt;path&gt;\&lt;AppName&gt;.reg
</PRE><P>
   This will re-register the server.
<P>
</OL><h3>Microsoft Office 4.3 Shared Applications</h3>
 
<P>
See the instructions for Microsoft Office 4.2 provided above.
<P>
<P><h3>Microsoft PowerPoint 4.0</h3>
 
<P>
To register Microsoft PowerPoint, start Microsoft PowerPoint. Microsoft
PowerPoint registers itself automatically when run, so it is not necessary
to merge its .reg files into the registration database.
<P>
<P><h3>Microsoft Publisher 2.0</h3>
 
<P>
If you have installed any of the Office applications after installing
Publisher, double-click the Mspub.reg file. You may need to first follow
the instructions in the "Associate .reg files with Regedit.exe" section
above.
<P>
To register the other applications, use the method outlined in the "Office
4.2" section above.
<P>
If you did not install Office, double-click each of the following .reg
files:
<P>
<PRE>      Artgalry.reg      Mspub.reg           Wordart2.reg
      Msdraw.reg        Note-it.reg

</PRE></OL><h3>Microsoft Word 6.0</h3>
 
<P>
To register Word, start Word. Word registers itself automatically when run,
so it is not necessary to merge its .reg files into the registration
database.
<P>
<P><h3>Microsoft Works 3.0</h3>
 
<P>
Works for Windows writes valid .reg files to the hard disk if the default
path choices were not changed during installation. These can be used as-is
to register the applications in the Reg.dat file. Follow the steps outlined
under "Microsoft Publisher 2.0" above.
<P>
If Works for Windows is installed to any folder other than the default
folder, or if you have installed any of the Office applications after
Works was installed, you will need to edit the .reg files before merging
them using steps similar to those outlined above.
<P>
For additional information about how to register Works for Windows 3.0,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q111772.htm">Q111772</A></B>
   TITLE     : Manually Registering Works for Windows 3.0

</PRE><h2>BACKGROUND: HOW APPLICATIONS REGISTER AUTOMATICALLY</h2>
 
<P>
Most applications register themselves automatically the first time they
run. Some applications even include a .reg file that you can double-click
or merge in the Registration Editor should you ever want to re-register the
application.
<P>
Some of these .reg files include a placeholder for the Windows folder path.
When you run the application's setup program, the setup program replaces
the placeholder with the correct Windows path. If you double-click or merge
one of these files, the placeholder, and not the actual Windows path, is
placed in the Reg.dat file.
<P>
<P><h3>Registration methods for Microsoft applications</h3>
 
<P>
<P>
<PRE>Application                 .reg file not   .reg file     .reg file may
                            needed (self    has correct   have invalid
                            registering)    path          default path
</PRE> 
<P>
Windows Accessories
<PRE>Paintbrush, Notepad,                        Setup.reg
</PRE>Write, Cardfile, Sound,
Package
<P>
<PRE>OLE files                                   Ole2.reg

</PRE>Office Applications:
<P>
<PRE>Microsoft Access 2.0        Msaccess.exe
Microsoft Excel 5.0         Excel.exe*      Excel5.reg*
Microsoft PowerPoint 4.0    Powerpnt.exe                  Pp4.reg
Microsoft Word 6.0          Winword.exe

</PRE>Office Shared Applications:
<P>
<PRE>ClipArt Gallery             Artgalry.exe                  Artgalry.reg
Draw 2.                                                   Msdraw.reg
Equation Editor 2.0                                       Eqnedit2.reg
Graph 5.0                   Graph5.exe                    Graph5.reg
Media Player                Mplayer.exe
Organization Chart 1.0      Orgchart.exe                  Orgchart.reg
WordArt 2.0                                               Wordart2.reg

</PRE>Home product files:
<P>
<PRE>Works 3.0                                                 Msworks3.reg
   Art Gallery                                            Artgalry.reg
   MS Draw                                                Msdraw.reg
   Note-It                                                Note-it.reg
   WordArt                                                Wordart2.reg

Publisher                                                 Mspub.reg
   Art Gallery                                            Artgalry.reg
   MS Draw                                                Msdraw.reg
   Note-It                                                Note-it.reg

</PRE>* A combination of merging the .reg file and running the application may
be needed to properly install Microsoft Excel 5.0. Refer to the "How To
Re-register Individual Microsoft Applications" section above.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: winword winppt power point powerpt word6 word7<BR>
word95 rebuild pub reregister 2.00 2.00a 3.00 4.00 4.00a 4.00c 4.20 4.30<BR>
5.00 5.00c<BR>
6.00 6.00a 6.00c<BR>
Keywords          : kbole kbusage<BR>
Version           : windows:4.0,4.2,4.3<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
