

<HTML>
<HEAD>
<TITLE>OFF95: "Setup Error 907 Object..." with Workstation Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147127">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1996/02/20">
<META NAME="Keywords" CONTENT="kbnetwork kbsetup kbtool offwin">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you perform a workstation setup of Office 7.0, 7.0a, or 7.0b, you may receive the following error message     Setup Error 907 Object       . Your Setup files may be damaged. Try    restarting the Setup program.  where        is an Object ID nu...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QAPN,QBWU,QBVP,QAB4,QAW6,QAMB,QAAP,QBJZ,QAE1,QBWS,QAUR,QA4H V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF95: "Setup Error 907 Object..." with Workstation Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147127</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office Professional for Windows 95, version 7.0, 7.0a
<LI>Microsoft Excel for Windows 95, version 7.0, 7.0a
<LI>Microsoft PowerPoint for Windows 95, version 7.0, 7.0a, 7.0b
<LI>Microsoft Word for Windows 95, version 7.0, 7.0a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you perform a workstation setup of Office 7.0, 7.0a, or 7.0b, you may
receive the following error message
<P>
<PRE>   Setup Error 907 Object &lt;XXXX&gt;. Your Setup files may be damaged. Try
   restarting the Setup program.

</PRE>where &lt;XXXX&gt; is an Object ID number in the Setup.stf file.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs because the administrative .stf file (Setup.stf,
located on the server) calls a custom action, (ShortPath), which then makes
an application programming interface (API) call to the operating system. If
the operating system does not support the API call, or if the custom action
returns an unexpected value, the Setup program fails.
<P>
This problem occurs when the following conditions are met:

<UL><LI>You are using IBM Lan Server 4.0 network server software.
<P>
   -or-

<LI>You are using IBM OS/2 3.0 network server software.
   -and-

<LI>Your network administrator performs an administrative setup (setup /a)
   of Office 7.0, 7.0a, or 7.0b to a folder on the server.
<P>
   -and-

<LI>You then perform a workstation setup from a workstation.
<P>
</UL>NOTE: This problem is likely to occur if, when asked for the default
location for the MSOffice folder during the administrative setup, your
network administrator types a universal naming convention (UNC) path with a
trailing backslash.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, use one of the following methods:
<P>
Method 1: Your network administrator must replace the Off95_bb.dll file
<PRE>          that setup installs on the administrative installation point
          on the server. To replace the file, the administrator must obtain
          the updated Off95_bb.dll file from Microsoft. The updated .dll
          file, can be obtained by downloading Off95_bb.exe and extracting
          its contents.

          The following file(s) are available for download from the
          Microsoft Software Library:

           ~ Off95_bb.exe

          For more information about downloading files from the Microsoft
          Software Library, please see the following article in the
          Microsoft Knowledge Base:

             ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
             TITLE     : How to Obtain Microsoft Support Files from Online
                         Services

          The network administrator must then copy the file to the
          destination Office folder that was created during the
          administrative setup (setup /a) on the server.

          After the network administrator updates the Off95_bb.dll file,
          you can successfully perform workstation installations.

          NOTE: Microsoft recommends that you also obtain the most
          recent version of Office, version 7.0b.

</PRE>Method 2: Modify the Setup.stf using the Network Installation Wizard
<PRE>          (NIW) version 1.1. This version of the NIW has a "Modify setup
          for LanServer compatibility" option under Office Options that
          will also resolve this problem.

</PRE>Method 3: Modify the Setup.stf using Microsoft Excel for Windows.
<P>
<PRE>          NOTE: Use this method only if you are unable to use the first
          two methods.

          WARNING: This modification may not be supported by Microsoft.
          Microsoft support engineers will support some modifications to
          a BACKUP copy of the SETUP.STF file. Note also that while
          support engineers may help customers modify specific lines of
          an STF, we will not rewrite the entire file in order to
          achieve a desired configuration. As a general rule, support is
          limited to options that can normally be changed by a user
          during a standard installation of the application.

          NOTE: You must have the correct permissions on the server in
          order to modify the Setup.stf file. Please contact your
          network administrator before you attempt to modify any Setup
          file on the server.

          To work around this problem using Method 3, modify the
          DestDir column references that point to all the ShortPath
          custom actions in the Setup.stf file on the server.

          To modify the Setup.stf, use the following steps:

          IMPORTANT: Before you begin this procedure, make a backup copy
          of the Setup.stf file located on the server. (That is, copy
          the Setup.stf file and rename it.)

          a. In Microsoft Excel 5.0 or later, open the Setup.stf file.

          b. In the Text Import Wizard dialog box, click Next until Step
             3 Of 3 appears.

          c. In the Text Import Wizard--Step 3 Of 3 dialog box, under
             Data Preview, drag the vertical scroll bar down until the
             "Object ID" item appears in the Data Preview window. Click
             the first column to select it. Hold down the SHIFT key,
             drag the horizontal scroll bar to the right until the last
             column appears in the Data Preview window, and click the
             last column. All of the columns should be selected.

          d. Under Column Data Format, click the Text option, and then
             click Finish.

          IMPORTANT: If you do not click the Text option at this step,
          Microsoft Excel will incorrectly read some of the entries in
          your edited .stf file. When this occurs, you will receive
          "setup parse errors" during setup.

          e. Select columns A-K. Then, on the Format menu, click Column,
             and click AutoFit Selection.

          f. On the Edit menu, click Find, and search for "ShortPath"
             (without the quotation marks).

          g. For each occurrence of the text string, "ShortPath," write
             down the Object ID number that is in the same row in column
             A. Continue searching for "ShortPath" until you identify
             all the corresponding Object ID numbers.

          h. In column K only, search for all instances of the Object ID
             numbers that you wrote down in step g, and replace the
             numbers with the letter "d" (without the quotation marks).
             For example, if you determine that Object ID 2480
             corresponds to an instance of the text string "ShortPath,"
             search for 2480 in column K and replace the number with
             "d." Note that the Object ID is preceded by a percent sign
             (%) in column K. When you replace the Object ID number with
             "d," do not remove the percent sign. For example, if you
              are replacing 2480, change the Object ID from %2480 to %d.

          i. When you are finished replacing the references in column K,
             save the changes to the Setup.stf.

          To save the Setup.stf file, use the following steps:

          a. On the File menu, click Save.

          b. In the Save File As Type box, click Text (Tab delimited),
             and then click OK.

          c. Run the Setup program to perform a workstation
             installation.

          NOTE: Do not use an MS-DOS Editor to modify the Setup.stf file.
          An MS-DOS Editor replaces tabs with spaces and causes a setup
          error.

          For additional information, please see the following article in
          the Microsoft Knowledge Base:

             ARTICLE-ID: <B><A href="../setup/q111248.htm">Q111248</A></B>
             TITLE     : XL: Saving .STF File in Excel May Cause Setup
                         Error Messages

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. This problem was corrected in the
updated Off95_bb.dll file. This problem was not corrected in Microsoft
Office versions 7.0a and 7.0b, so you must obtain the file to correct the
problem.
<P>
The Network Installation Wizard 1.1 has an option under Office Options for
"Modify setup for LanServer compatibilty" that will also resolve this
problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q119357.htm">Q119357</A></B>
   TITLE     : AppNote: "How to Create a Custom Installation Script"
               (WC1046)

   ARTICLE-ID: <B><A href="../office/q149655.htm">Q149655</A></B>
   TITLE     : OFF95: Contents of Readme.txt for the NIW
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 ObjID localized international
<P>

<BR>
Keywords            : kbnetwork kbsetup kbtool offwin<BR>
Version             : 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
