

<HTML>
<HEAD>
<TITLE>Office: Specifying Working Directory in a Custom Setup Script </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122846">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1994/11/14">
<META NAME="Keywords" CONTENT="kbsetup kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  In Microsoft Office, you can automatically modify the working directory for a program when you run the Setup program by editing the AddProgmanItem line in the Setup.stf file.  NOTE: This applies to Microsoft Office for Windows 95 only under Microso...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAFI,QBXB,QATJ,QAA1,QBVP,QDI2,QDIZ,QDH3,QBI0,QAML,QBWS,QAIB,QBXT,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Office: Specifying Working Directory in a Custom Setup Script</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122846</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows versions 4.2, 4.3
<LI>Microsoft Office for Windows 95, version 7.0
   (under Microsoft Windows NT only)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft Office, you can automatically modify the working directory for
a program when you run the Setup program by editing the AddProgmanItem
line in the Setup.stf file.
<P>
NOTE: This applies to Microsoft Office for Windows 95 only under Microsoft
Windows NT with the standard user interface.
<P>
WARNING: This modification may not be supported by Microsoft Technical
Support (MTS). MTS will support some modifications to a BACKUP copy of the
Setup.stf file. Note also that while MTS may help customers modify specific
lines of an STF, we will not rewrite the entire file in order to achieve a
desired configuration. As a general rule, support is limited to options
that can normally be changed by a user during a standard installation of
the application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The AddProgmanItem line has the following format (note that the headers in
the table below are for illustration purposes only. They do not appear in
the actual .stf file).
<P>
<P><h3>AddProgmanItem Line</h3>
 
<P>
Microsoft Office for Windows 95:
<P>
Office Directory,  Program Directory,  Program File,  Working Directory
 
<P>
<PRE>'MSOffice&lt;Microsoft Office&gt;,MSExcel&lt;Microsoft
</PRE>Excel&gt;,%s\EXCEL.EXE,C:\MyName&lt;C:\MyName&gt;,,,,,,
<P>
NOTE: Long file name directory names are enclosed in angle brackets.
<P>
Microsoft Office 4.x:
<P>
<PRE>AddProgmanItem, Program Group,    Icon Label,       Path to .exe,    Other
</PRE> 
<P>
AddProgmanItem,"Microsoft Office","Microsoft Query","%s\MSQUERY.EXE",""
<P>
<P>
<P><h3>Specifying the Working Directory</h3>
 
<P>
In Microsoft Office for Windows 95, the working directory is the fourth
item in the line. Remember that long file names for directories are
enclosed in angle brackets. If the directory is the same for both the long
and standard length file and directory names, you can place the same
statement inside the brackets, for example:
<P>
<PRE>   C:\Myname&lt;C:\Myname&gt;

</PRE>In Office 4.x, you specify the working directory for a program in the last
parameter (the Other parameter). This parameter can contain several items.
For example, if you want to set the working directory for Microsoft Query
to the x:\User\Data directory, make the following modification to the
AddProgramItem line:
<P>
<P>
<PRE>   AddProgmanItem  "Microsoft Office","Microsoft Query","%s\MSQUERY.EXE",
   ",,,,X:\User\Data"

</PRE><h3>Modifying the Setup.stf File</h3>
 
<P>
To open the Setup.stf file and locate the AddProgmanItem line, use the
following steps:
<P>
CAUTION: Microsoft does not support modifications to the .stf file. Be sure
to make a backup copy of this file before you attempt to modify it.

<OL><P><LI>In Microsoft Excel, open the .stf file that you want to edit.

<P><LI>In the Text Import Wizard dialog box, click Next until step 3 of the
   wizard appears.

<P><LI>In the Text Import Wizard - Step 3 Of 3 dialog box, under Data Preview,
   drag the vertical scrollbar indicator down until Object ID appears in
   the Data Preview window. Click the first column to select it. Hold the
   SHIFT key down, drag the horizontal scrollbar to the right until the
   last column is displayed in the Data Preview window, and then click the
   last column.
<P>
   All of the columns (at least 15 columns) should be selected.

<P><LI>Under Column Data Format, click Text, and then click Finish.
<P>
   CAUTION: If you do not click Text in this step, Microsoft Excel reads
   some of the entries in the edited .stf file incorrectly. When this
   occurs, you receive Setup Parse errors when you run Setup.

<P><LI>Select cell A1, and then click Find on the Edit menu. In the Find What
   box type "AddProgmanItem" (without the quotation marks), and then click
   OK.
<P>
</OL>Microsoft Excel finds the first of several instances where AddProgmanItem
occurs in the Setup.stf file.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q119357.htm">Q119357</A></B>
   TITLE     : AppNote: "How to Create a Custom Installation Script"
               (WC1046)

 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbsetup kbsetup<BR>
Version             : 4.20 4.30 7.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
