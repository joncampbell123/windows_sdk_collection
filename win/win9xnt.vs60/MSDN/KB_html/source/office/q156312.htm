

<HTML>
<HEAD>
<TITLE>OFF97: Page Fault After Using Desktop Themes Control Panel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156312">
<META NAME="KBModify" CONTENT="1998/03/12">
<META NAME="KBCreate" CONTENT="1996/09/20">
<META NAME="Keywords" CONTENT="offvalpak OffWinSetup kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  After you install Microsoft Office 97 for Windows, the following message appears when you use the Desktop Themes Control Panel program:     THEMES caused an invalid page fault in module THEMES.EXE at    014f:0040abc6.  Note that the address of the ...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA6A,QDKX,QBTX,QDL9,QBWO,QBWN,QAA1,QDI2,QBWQ,QBW9,QDH3,QAH4,QBWS,QAKM,QAC9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Page Fault After Using Desktop Themes Control Panel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156312</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Windows 95
<LI>Microsoft Windows NT, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you install Microsoft Office 97 for Windows, the following message
appears when you use the Desktop Themes Control Panel program:
<P>
<PRE>   THEMES caused an invalid page fault in module THEMES.EXE at
   014f:0040abc6.

</PRE>Note that the address of the invalid page fault may vary.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur if the following conditions are true:

<UL><LI>You installed Microsoft Plus! For Windows 95.
<P>
   -and-

<LI>You installed Microsoft Office 97 for Windows.
<P>
   -and-

<LI>In the Control Panel, you used the Desktop Themes control panel.
<P>
</UL>This behavior occurs because the Desktop Themes control panel program,
Themes.exe, is incompatible with the new version of the JPEG (.jpg) file
filter, Jpegim32.flt, that is installed with Microsoft Office 97 for
Windows.
<P>
NOTE: This problem should not occur if you install Microsoft Plus! for
Kids on your computer. Microsoft Plus! for Kids includes a newer version
of Themes.exe, version 4.40.311, that works correctly with the new
Jpegim32.flt file filter.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
<P><h3>Windows 95</h3>
 
<P>
Microsoft Office 97 for Windows includes an updated version of the
Themes.exe program. To resolve the behavior, install the updated version of
Themes.exe.
<P>
To install the updated version of Themes.exe, use the following steps:

<OL><P><LI>Locate the folder on the hard disk that contains the program file,
   Themes.exe. If you installed Microsoft Plus! in the default location,
   Themes.exe is located in the \Program Files\Plus! folder.
<P>
   Otherwise, click Start, point to Find, click "Files or Folders", and
   then search for Themes.exe on the hard disk.

<P><LI>Delete Themes.exe from the hard disk.

<P><LI>Copy Themes.exe from the \Valupack\Patch folder on the Microsoft Office
   97 compact disc to the folder on the hard disk that previously
   contained Themes.exe.
<P>
</OL>NOTE: The Themes.exe included in Microsoft Office 97's ValuPack does not
work in Microsoft Windows NT, version 4.0. It only works in Microsoft
Windows 95.
<P>
<P><h3>Windows NT 4.0</h3>
 
<P>
An updated Themes.exe program is available for download from Microsoft's
FTP site on the Internet. To obtain and install the updated Themes.exe:

<OL><P><LI>Using your Web browser, go to the following address:
<P>
<P><PRE>      <B><A href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/reskit/nt40/themes/">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/reskit/nt40/themes/</A></B>
</PRE>
<P><LI>Click the link for the appropriate processor type (I386 for Intel,
   Alpha, MIPS, etc.).

<P><LI>Click the link for README.TXT. Follow the provided instructions to
   download and install the ThemeFix.exe program.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Desktop Themes, included in Microsoft Plus! For Windows 95, is designed to
work with a JPEG filter called Jpegim32.flt. When you install Microsoft
Office 97 for Windows, a new version of the Jpegim32.flt JPEG filter is
installed, replacing the old Jpegim32.flt.
<P>
Because of the way in which the old Themes.exe program calls the JPEG
filter, Themes.exe causes an invalid page fault if the new Jpegim32.flt
filter is installed. The updated versions of Themes.exe, included with
both Microsoft Office 97 and Microsoft Plus! for Kids and available from
Microsoft's FTP site, are designed to work correctly with the new version
of Jpegim32.flt.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about this behavior, see the Valupk8.hlp Help file,
that is included in the \Valupack folder on the Microsoft Office 97 for
Windows compact disc. To access the information, use the following steps:

<OL><P><LI>In Windows Explorer, double-click the Valupk8.hlp file on the compact
   disc.

<P><LI>Click the Find tab. If you are prompted to build a word list, click
   Next, and then click Finish.

<P><LI>In the "Type the word(s) you want to find" box, type "Themes" (without
   quotation marks).

<P><LI>Double-click "Themes Patch" in the "Click a topic, then click
   Display" box.
<P>
</OL>For additional information about this problem, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q160846.htm">Q160846</A></B>
   TITLE     : "Illegal Operation" Error Message Changing Desktop Themes
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 valuepack valuepak value pack<BR>
Keywords          : offvalpak OffWinSetup kbsetup<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
