

<HTML>
<HEAD>
<TITLE>OFF97 Err Msg: "Vbe.dll Was Unable to Register Itself" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162627">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/24">
<META NAME="Keywords" CONTENT="offlocal OffWinSetup kberrmsg kbusage kbdta kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAA1,QBWS,QDI2,QAH4,QA9N,QDL9,QBWO,QBWN,QA3A,QAFI,QAC9,QAY2,QAB4,QAEF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97 Err Msg: "Vbe.dll Was Unable to Register Itself"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162627</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Excel 97
<LI>Microsoft Access 97
<LI>Microsoft Word 97
<LI>Microsoft PowerPoint 97
<LI>Microsoft Project 98
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run Setup, you may receive the following error message after all
files have been copied to the hard disk on your computer:
<P>
<PRE>   Vbe.dll was unable to register itself in the system registry.

</PRE>When you click OK, you receive the following error message
<P>
<PRE>   Microsoft &lt;program&gt; Setup was not completed successfully.

</PRE>where &lt;program&gt; is the program you are trying to install.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem may occur if all of the following conditions are true for
either of the following cases:
<P>
<P><h3>Case 1</h3>
 

<UL><LI>You perform a Run From CD or Run From Network installation of Microsoft
   Office 97 on your computer.
<P>
<P><PRE>    -and-
</PRE>
<LI>You remove Microsoft Office 97 from your computer by running the
   Setup program in maintenance mode and clicking Remove All.
<P>
<P><PRE>    -and-
</PRE>
<LI>You attempt to perform a Typical or Custom installation of Microsoft
   Office 97 on your computer.
<P>
</UL><h3>Case 2</h3>
 

<UL><LI>You install one of the programs listed at the beginning of this article
   from an administrative installation point on a network server and
   install the shared components so that they run from the network server.
<P>
<P><PRE>    -and-
</PRE>
<LI>You install a second program listed at the beginning of this article.
<P>
</UL>NOTE: When the shared .dll files are being registered in the Microsoft
Windows registry, the location of the shared files cannot be found.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use either of the following two methods:
<P>
<P><h3>Method 1</h3>
 
<P>
Modify the path to point to the shared programs, and then run Setup again.
<P>
NOTE: This modification is required only while you are running Setup. You
can remove the modification to the path statement after you successfully
install the program.
<P>
Under Microsoft Windows NT:
<P>
If you are running Microsoft Windows NT, follow these steps:

<OL><P><LI>First, use Windows Explorer to map a network drive to the location of
   the shared programs on the server. For example, map drive F to the
   following location
<P>
<P><PRE>      \\&lt;server name&gt;\&lt;share name&gt;
</PRE><P>
   where &lt;server name&gt; is the name of the server and &lt;share name&gt; is the
   name of the share in which the shared programs are stored.

<P><LI>On the Start menu, point to Settings and click Control Panel.

<P><LI>Double-click the System icon.

<P><LI>Click the Environment tab.

<P><LI>In the System Variables box, select the Path variable.

<P><LI>At the bottom of the window, click after the Value statement for the
   Path.

<P><LI>Type a semicolon (;), and then type the path to the location to the
   shared programs on the network.
<P>
   For example, type the following:
<P>
<P><PRE>      f:\msapps\os\system
</PRE>
<P><LI>Click Set.

<P><LI>Click OK, and then run Setup for the program you want to install.
<P>
</OL>Under Microsoft Windows 95:
<P>
If you are running Microsoft Windows 95, follow these steps:

<OL><P><LI>On the Start menu, click Run. Type "sysedit" (without the quotation
   marks) in the Open box.

<P><LI>In the Autoexec.bat window, find the Path statement.

<P><LI>Type a semicolon (;), and then type the path to the location of shared
   programs on the network.
<P>
   For example, type the following
<P>
<P><PRE>      \\&lt;servername&gt;\msoffice\msapps\os\system
</PRE><P>
   where &lt;servername&gt; is the name of the server.

<P><LI>On the File menu, click Save.

<P><LI>On the File menu, click Exit.

<P><LI>Restart the computer.

<P><LI>Run Setup for the program you want to install.
<P>
</OL><h3>Method 2</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems
that may require you to reinstall your operating system. Microsoft
cannot guarantee that problems resulting from the incorrect use of Registry
Editor can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys
And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" Help topics
in Regedt32.exe. Note that you should back up the registry before you edit
it.
<P>
To prevent this problem from occurring, follow these steps:

<OL><P><LI>On the Start menu, click Run. In the Open box, type "regedit" (without
   the quotation marks), and then click OK.

<P><LI>In the Registry window, click the plus sign (+) to the left of the
   following keys, in order:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE
      SOFTWARE
      Microsoft
      Shared Tools
</PRE><P>
   Then, click the yellow folder to the left of "Vba332.dll." The text in
   the status bar should be the following:
<P>
<P><PRE>      My Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools
<PRE></PRE>         Vba332.dll

</PRE><P><LI>On the Edit menu, click Delete, and then click Yes to delete the key.

<P><LI>On the Registry menu, click Exit.

<P><LI>Run the Setup program.
<P>
</OL>If the error message appears again, follow these steps:

<OL><P><LI>Using Windows Explorer, manually create the following folders on your
   hard disk drive (usually, drive C):
<P>
<P><PRE>      Program Files\Common Files
      Program Files\Common Files\Microsoft Shared
      Program Files\Common Files\Microsoft Shared\VBA
</PRE><P>
   NOTE: The Program Files folder should already exist on your hard disk.
   If it does not, create it before you create the folders listed in this
   step.

<P><LI>Copy the following files from the OS\System folder on your Microsoft
   Office 97 compact disc:
<P>
<PRE>      Vba332.dll     (file size 1,596,688 bytes, version 3.0.6908, 11/96)
      Vbe.dll        (file size 745,232 bytes, 11/96)

   Paste the files in the Program Files\Common Files\Microsoft
   Shared\VBAfolder on your hard disk.

</PRE><P><LI>In the Windows Explorer, go to the Windows\System folder on your hard
   disk.
<P>
<P><PRE>    a. If the file Oleaut32.dll is present, select it. Right-click the
       file, and click Rename on the shortcut menu. Type
       "Oleaut32.old" (without the quotation marks) and press ENTER.
</PRE><P>
<P><PRE>    b. If the Ole32.dll file is present, select it. Right-click the
       file, and click Rename on the shortcut menu. Type "Ole32.old"
       (without the quotation marks) and press ENTER.
</PRE>
<P><LI>Copy the following file from the OS\System folder on your Microsoft
   Office 97 compact disc:
<P>
<PRE>      Oleaut32.dll   (file size 491,792 bytes, version 2.20.4054,
                     11/96)

   Paste the file in the Windows\System folder on your hard disk.

</PRE><P><LI>Copy the following file from the Office\WMS\Common folder on your
   Microsoft Office 97 compact disc:
<P>
<PRE>      Ole32.dll      (file size 558,704 bytes, version 2.1, 11/96)

   Paste the file in the Windows\System folder on your hard disk.

   NOTE: If any of the four files mentioned in steps 2-4 are in use, you
   may receive an error message when you attempt to copy them to your hard
   disk. If this occurs, you may need to restart your computer in MS-DOS
   mode, copy the files to your hard disk, and then restart your computer
   again.

</PRE><P><LI>Run Microsoft Office 97 Setup.
<P>
</OL>NOTE: After replacing the old copies of Oleaut32.dll and Ole32.dll
with copies from the Microsoft Office 97 compact disc and running
Microsoft Office 97 Setup, other programs that use these files may not
work correctly. In this event, you may need to reinstall the other
programs. Or, you may be able to rename the .old files in the
Windows\Systemfolder to their original file names.
<P>
If none of the above solutions resolve the problem, try following the
steps in the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A href="../office/q158658.htm">Q158658</A></B>
   TITLE     : OFF97: How to Completely Remove Microsoft Office 97

</PRE></OL>Note that a utility that automates the process of removing Office 97 is
available. The following file is available for download from the Microsoft
SoftwareLibrary:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/eraser97.exe">Eraser97.exe</A> <I>(size: 1131232 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q138552.htm">Q138552</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>The FTP location is <B><A href="ftp://ftp.microsoft.com/softlib/mslfiles/">ftp://ftp.microsoft.com/Softlib/MSLFILES/</A></B>
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 8.00 97 OFF97 Vbe<BR>
Keywords          : offlocal OffWinSetup kberrmsg kbusage kbdta kbfaq<BR>
Version           : WINDOWS:97,98<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
