

<HTML>
<HEAD>
<TITLE>OFF97: Data Is Returned Very Slowly from External Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172731">
<META NAME="KBModify" CONTENT="1998/01/21">
<META NAME="KBCreate" CONTENT="1997/08/14">
<META NAME="Keywords" CONTENT="xlquery kbtool">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you return data to Microsoft Excel 97, the process may take twice as long as it does in an earlier version of Microsoft Excel. For example, when you run a query in Excel version 7.0, it takes 30 seconds. When you run the same query in Excel 97...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAUD,QACF,QAYY,QBWS,QDKX,QAWM,QAPW,QALW,QBVV,QAXB,QAUR,QDO3,QDO5,QDNE P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Data Is Returned Very Slowly from External Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 21, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172731</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you return data to Microsoft Excel 97, the process may take twice as
long as it does in an earlier version of Microsoft Excel. For example, when
you run a query in Excel version 7.0, it takes 30 seconds. When you run the
same query in Excel 97, it takes 3 minutes.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs when you return data to the worksheet and you do the
following:

<UL><LI>You create a query to return data from a large database (for example, a
   database with over 1000 records).
<P>
   -and-

<LI>In the External Data Range Properties dialog box, you click both Enable
   Background Refresh and Save Query Definition (to perform asynchronous
   queries).
<P>
   -and-

<LI>After you run the query, you don't perform any tasks in Excel.
<P>
   -or-

<LI>Enable Background Refresh and Save Query Definition are not selected in
   the External Data Range Properties dialog box.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, do either of the following:

<UL><LI>Use asynchronous queries and leave Microsoft Excel active in the
   foreground.
<P>
   -or-

<LI>Use asynchronous queries and position the pointer over the Microsoft
   Excel toolbar if you are not working with Excel in the foreground.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Excel 97 for
Windows. This problem was corrected in Microsoft Excel 97 for Windows,
Service Release 1 (SR-1).
<P>
For additional information about SR-1, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Asynchronous queries are executed more quickly than synchronous queries.
You can make asynchronous queries available when you click Enable
Background Refresh in the External Data Range Properties dialog box. When
you use asynchronous queries, Excel stops fetching data if you do not
perform any tasks in Excel.
<P>
When you use synchronous queries (Enable Background Refresh option is not
selected), the cells are formatted when data is returned. The data is
returned quickly; however, formatting the cells can take up to two or three
times longer than fetching the data.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about running queries in the background, click the
Index tab in Help, type the following text
<P>
<PRE>   queries, background

</PRE>and then double-click the selected text to go to the "Run a query in the
background or while you wait" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 msquery<BR>
Keywords          : xlquery kbtool<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 21, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
