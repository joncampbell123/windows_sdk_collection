

<HTML>
<HEAD>
<TITLE>Modifying the DestDir Column in the MS Office SETUP.STF </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125459">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1995/01/29">
<META NAME="Keywords" CONTENT="offwin kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="                                   SUMMARY                                   =======  A setup script is a set of instructions you can use to control elements of a program's setup. These instructions are contained in a special file called a  setup tab...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAA1,QAPN,QDI2,QAW6,QBFY,QAFI,QABA,QDIZ,QAE1,QDH3,QBXB,QATJ,QDMN,QA2S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Modifying the DestDir Column in the MS Office SETUP.STF</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125459</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.20 4.30 7.00
WINDOWS
kbsetup
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows, versions 4.2, 4.3
<LI>Microsoft Office for Windows 95, version 7.0
</UL> 
<P>
<PRE>                                  SUMMARY
                                  =======

</PRE>A setup script is a set of instructions you can use to control elements of
a program's setup. These instructions are contained in a special file
called a "setup table file" (STF).
<P>
The following are guidelines you can use to determine whether to use a
trailing backslash with items in the SETUP.STF:

<UL><LI>DO use a trailing backslash with the DestDir column

<LI>DO NOT use a trailing backslash in the Object Data column for the
   AppSearch object.
<P>
</UL><h2>MICROSOFT OFFICE VERSION 4.X</h2>
 
<P>
These two methods have different purposes. Changing the DestDir will hard
code a specific destination directory for the Program files. However,
changing the Object Data entry will change the default directory but will
allow the user to change this directory if they are not using the batch
mode for installation.
<P>
<P><h3>DestDir</h3>
 
<P>
If you are modifying the %1 in the DestDir Column (the destination
directory of a specified object) of the SETUP.STF, you need to include the
trailing backslash, as in the following example:
<P>
<PRE>   C:\WORD6\

</PRE><h3>Object Data for AppSearch Object</h3>
 
<P>
If you choose to modify the Object Data column for the AppSearch object,
then you do not use the trailing backslash.
<P>
The row beneath Object Data (cell F24 or F25 if you are editing the STF in
Microsoft Excel) will list the current settings including the default
directory. The default settings in the Object Data column are the
following:
<P>
<PRE>   "C:\WINWORD", "WINWORD.EXE", "6.0.0.2226", 1, "yes", "yes", 2 3 4 5

</PRE>You could change C:\WINWORD to the desired default directory (if you do
this, do not change any other settings in the cell).
<P>
<P><h2>MICROSOFT OFFICE VERSION 7.0</h2>
 
<P>
As a 32-bit operating system, Windows 95 allows you to use long filenames.
Therefore, the Office version 7.0 STF file contains long filename
alternative entries. For example, the first AppSearch entry appears as
follows:
<P>
<PRE>   "C:\MSOffice"&lt;C:\MSOffice&gt;,MSOFFICE.EXE,95.2.3.2,176,,yes,8

</PRE>The path enclosed in angle brackets (&lt;path&gt;) is the long filename
alternative. The preceding path enclosed in quotation marks ("path") is the
standard path.
<P>
<P><h3>Modification</h3>
 
<P>
Modifications to an STF file should be made using a backup copy of the file
and following the procedures outlined in the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../setup/q111248.htm">Q111248</A></B>
   TITLE     : XL: Saving .STF File in Excel May Cause Setup Error
               Messages

</PRE>To set the folder that Office version 7.0 is installed to, modify both
paths in the Object Data and the Destination Directory for Object Id 2 by
using the following procedure:

<OL><P><LI>In the Setup.stf file, locate Object Id 2. This item is located in the
   first column of the STF file under the ObjID heading.

<P><LI>Press the Right Arrow key to move to the sixth column in the STF file
   (Object Data) which contains the following cell contents:
<P>
   "C:\MS_OFF95"&lt;C:\Microsoft Office 95&gt;,MSOFFICE.EXE,95.2.3.2,176,,yes,8
<P>
   Modify the standard path ("C:\MS_OFF95") and/or the long filename path
  (&lt;C:\Microsoft Office 95&gt;).

<P><LI>Press the Right Arrow key again to move to the eleventh column in the
   STF file (Destination Directory). There should be an entry in this
  column similar to the following:
<P>
<P><PRE>      C:\MS_OFF95\&lt;C:\Microsoft Office 95\&gt;
</PRE><P>
   Modify the standard path (C:\MS_OFF95\) and/or the long filename path
  (&lt;C:\Microsoft Office 95\&gt;).
<P>
   Note that the path in this column is followed by a backslash character
   as described in the "Summary" section of this article. If this entry is
   not present, you may enter it using the entry above as an example.
<P>
</OL>After this procedure is completed, save the STF file as a Tab delimited
file. To use this modified STF file, use a command line similar to the
following:
<P>
<PRE>   &lt;path&gt;SETUP /t &lt;path&gt;filename.STF /q

                             MORE INFORMATION
                             ================

</PRE></OL>For more information about customizing the SETUP.STF file, please see the
following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q119357.htm">Q119357</A></B>
   TITLE     : AppNote: "How to Create a Custom Installation Script"
               (WC1046)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup<BR>
KBSubcategory: offwin
<P>

Additional reference words: 4.20 4.30 7.00
<P>

Keywords            : offwin kbsetup<BR>
Version             : 4.20 4.30 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
