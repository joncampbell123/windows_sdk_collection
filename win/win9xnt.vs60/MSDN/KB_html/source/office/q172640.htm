

<HTML>
<HEAD>
<TITLE>OFF97: Workbook Changed by MS Access May Not Be Recalculated </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172640">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1997/08/12">
<META NAME="Keywords" CONTENT="OffInterop xlloadsave xlui kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you open a workbook in Microsoft Excel 97, some formulas in the workbook may not be recalculated properly. For example, if cell B5 in Sheet2 contains the following formula     =Sheet1!A1  the formula may return a value that was previously in S...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA1S,QDN9,QAKD,QDNE,QBVV,QA5V,QDNM,QAE5,QDKW,QAUD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Workbook Changed by MS Access May Not Be Recalculated</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172640</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a workbook in Microsoft Excel 97, some formulas in the
workbook may not be recalculated properly. For example, if cell B5 in
Sheet2 contains the following formula
<P>
<PRE>   =Sheet1!A1

</PRE>the formula may return a value that was previously in Sheet1!A1 instead of
the value that is currently in Sheet1!A1.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occur if all of the following conditions are true:

<UL><LI>In Microsoft Access 97, you create a link table that links to a
   worksheet in a Microsoft Excel workbook.
<P>
   -and-

<LI>By using Microsoft Access 97, you change a value (or values) in the link
   table.
<P>
   -and-

<LI>You open the workbook in Microsoft Excel 97.
<P>
   -and-

<LI>One or more formulas in the workbook refer to the changed values.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To work around this problem, follow these steps:

<OL><P><LI>In Microsoft Excel 97, open the workbook.

<P><LI>Press CTRL+ALT+F9.
<P>
</OL>The values in the workbook are recalculated. If you make additional changes
to the workbook in Microsoft Excel 97, Microsoft Excel continues to
recalculate the values properly. If you use Microsoft Access 97 to make
additional changes to the workbook, you must use the workaround when you
reopen the workbook in Microsoft Excel 97.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97. We are
researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Excel 97, when a workbook must be recalculated, a record named
"RTUNCALCED" is written in the workbook. Microsoft Excel clears this record
when the workbook is recalculated; if the record is not present, Microsoft
Excel 97 does not recalculate the values in workbook.
<P>
When you make a change to a link table in Microsoft Access 97, the change
is written to the table in the external file. However, if the external file
is a Microsoft Excel workbook, Microsoft Access 97 does not write the
RTUNCALCED record in the workbook. As a result, when you open the workbook
in Microsoft Excel 97, the workbook is not automatically recalculated, and
formulas in the workbook may return incorrect values.
<P>
Note that this problem does not occur when you change a link table in
earlier versions of Microsoft Access.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 XL97 AC97<BR>
Keywords          : OffInterop xlloadsave xlui kbinterop<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
