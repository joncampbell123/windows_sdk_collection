

<HTML>
<HEAD>
<TITLE>OFF97: Default Documents Folder Is Not Changed by NIW </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164536">
<META NAME="KBModify" CONTENT="1998/02/10">
<META NAME="KBCreate" CONTENT="1997/03/04">
<META NAME="Keywords" CONTENT="offNIW OffWinSetup kbsetup kbtool">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAFI,QAA1,QDI2,QBWS,QDH3,QAKD,QABA,QDL9,QBWO,QBWN,QDIZ,QAUJ,QAYY,QAUR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Default Documents Folder Is Not Changed by NIW</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164536</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Office 97 Network Installation Wizard
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a
Registry  Key" Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Microsoft Office 97 Setup program, the default folder
that is used to store your documents is not changed. This is true even
when you change the default folder for documents in the Microsoft Office
Network Installation Wizard (NIW).
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because the Microsoft Office 97 Setup program does not
change the default folder for documents if the folder already exists on
the computer or if a registry entry refers to a default documents folder.
<P>
For example, if the current default folder for documents is already set to
C:\My Documents, changing the default folder to C:\Data in the Network
Installation Wizard, and then running Microsoft Office 97 Setup does NOT
change the default folder to C:\Data.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, use version 2.1 of the Network Installation
Wizard and the method that applies to your configuration. To determine
which method to use, see the "Determining Which Method to Use" section. If
you're still unsure of the method to use, use method 1.
<P>
IMPORTANT: Use version 2.1 of the Network Installation Wizard to modify the
Microsoft Office Setup files.
<P>
To access the Network Installation Wizard on the Web, connect to the
following Web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/ork/">http://www.microsoft.com/office/ork/</A></B>

</PRE><h2>DETERMINING WHICH METHOD TO USE</h2>
 
<P>
<P><h3>When to Use Method 1</h3>
 
<P>
Use method 1 if the following conditions are true:

<UL><LI>You are using Microsoft Windows 95 with or without user profiles.
<P>
<P><PRE>    -and-
</PRE>
<LI>The person who uses the Microsoft Office programs is not necessarily the
   same person who runs the Office Setup program.
<P>
 -or-

<LI>You are using Microsoft Windows NT versions 3.51 or 4.0.
<P>
<P><PRE>    -and-
</PRE>
<LI>The person who uses the Microsoft Office programs is not necessarily the
   same person who logs on to the workstation and runs the Office Setup
   program.
<P>
   NOTE: The previous statement applies to the following scenarios:
<P>
   - The person who logs on to the workstation as Local Administrator to
<P><PRE>     install Microsoft Office is not the person who will use Microsoft
     Office on the workstation.
</PRE><P>
   - The person logs on to the workstation as Local Administrator to
<P><PRE>     install Microsoft Office is not necessarily the ONLY person who will
     use Microsoft Office on the workstation.
</PRE><P>
   - Microsoft Office was installed by a service that logs on to the
<P><PRE>     workstation as Local Administrator and runs in background mode. For
     example, Package Command Manager (PCM) in Microsoft System Management
     Server does this.
</PRE><P>
</UL><h3>When to Use Method 2</h3>
 
<P>
Use method 2 if the following conditions are true:

<UL><LI>You are using Microsoft Windows 95 without user profiles.
<P>
<P><PRE>    -and-
</PRE>
<LI>You want all the Office programs to use the same default documents
   folder.
<P>
<P>
</UL><h2>METHOD 1: YOU ARE USING WINDOWS 95 WITH USER PROFILES OR WINDOWS NT</h2>
 
<P>
WARNING: This modification may not be supported by Microsoft. Microsoft
support engineers will support some modifications to a BACKUP copy of the
Setup.stf file. Note also that while support engineers may help customers
modify specific lines of an STF, we will not rewrite the entire file in
order to achieve a desired configuration. As a general rule, support is
limited to options that can normally be changed by a user during a
standard installation of the application.
<P>
NOTE: The following steps work only if you first perform an administrative
installation (setup /a) of Office 97 to a server on your network. If you
are performing a stand-alone installation using the Office 97 compact disc,
you cannot use the steps in this article.
<P>
Before you perform the following steps, make a backup copy of the
Off97pro.stf or Off97std.stf file on your server. Rename the file to
Backup.stf and do not open or edit it for any reason.
<P>
To use method 1, follow these steps:

<OL><P><LI>Start the Network Installation Wizard. Open the LST file that you want
   to use.
<P>
   NOTE: The Network Installation Wizard opens the appropriate STF and INF
   files for editing.

<P><LI>Click Next to continue through the wizard until you reach the Add
   Registry Entries dialog box.

<P><LI>Add the following six keys and the associated values to the registry.
<P>
<P><PRE>      Key 1
      -----
</PRE><P>
<PRE>         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_LOCAL_MACHINE

         Data type:     SZ

         Key:           Software\Microsoft\Office\8.0\New User Settings\
                        Excel\Microsoft Excel

         Value name:    DefaultPath

         Value data:    &lt;folder you want to use for documents&gt;

      Key 2
      -----

         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_LOCAL_MACHINE

         Data type:     SZ

         Key:           Software\Microsoft\Office\8.0\New User Settings\
                        Word\Options

         Value name:    DOC-PATH

         Value data:    &lt;folder you want to use for documents&gt;

      Key 3
      -----

         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_LOCAL_MACHINE

         Data type:     SZ

         Key:           Software\Microsoft\Office\8.0\New User Settings\
                        PowerPoint\Recent Folder List\Default

         Value name:    DefaultPath

         Value data:    &lt;folder you want to use for documents&gt;

      Key 4
      -----

         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_CURRENT_USER

         Data type:     SZ

         Key:           Software\Microsoft\Office\8.0\Excel\Microsoft Excel

         Value name:    DefaultPath

         Value data:    &lt;folder you want to use for documents&gt;

      Key 5
      -----

         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_CURRENT_USER

         Data type:     SZ

         Key:           Software\Microsoft\Office\8.0\Word\Options

         Value name:    DOC-PATH

         Value data:    &lt;folder you want to use for documents&gt;

      Key 6
      -----

         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_CURRENT_USER

         Data type:     SZ

         Key:           Software\Microsoft\Office\8.0\PowerPoint\
                        Recent Folder List\Default

         Value name:    DefaultPath

         Value data:    &lt;folder you want to use for documents&gt;

   NOTE: All settings can use the same folder name for "Value data"
   (for example, H:\Data or H:\Data\Word).

</PRE><P><LI>After you add the entries to the registry, click Next.

<P><LI>In the Select Quiet Mode dialog box, select the Quiet Level that you
   want, and then click Next.

<P><LI>In the Save Changes dialog box, enter the file names for your customized
   Setup files, and then click Finish.
<P>
</OL><h3>Additional Steps for PowerPoint</h3>
 
<P>
Changing the PowerPoint default documents location requires that you make
additional modifications to the STF file. Before you continue with the
steps in this section, see the "Opening the STF for Editing" section in
this article for instructions for opening the STF file.
<P>
To modify the STF file and change the PowerPoint default documents
location, follow these steps:

<OL><P><LI>Use the steps in the "Opening the STF for Editing" section to open the
   STF file.

<P><LI>Scroll to the end of the worksheet to the custom entries you added.
   Search column C for the PowerPoint entry for the HKEY_LOCAL_MACHINE
   entry. Change the entry in column F to the following
<P>
   "LOCAL", "Software\Microsoft\Office\8.0\New User Settings\PowerPoint\
   Recent Folder List\Default", "", &lt;Documents Folder&gt;
<P>
   including the quotations marks. Note that &lt;Documents Folder&gt; is the disk
   drive and folder name. For example, type the following
<P>
<P><PRE>      "H:\Data"
</PRE><P>
<P><PRE>       -or-
</PRE><P>
<P><PRE>      "H:\Data\PowerPoint"
</PRE>
<P><LI>Search column E for the PowerPoint entry for the HKEY_CURRENT_USER
   entry. Change the entry in column F to the following
<P>
<P><PRE>      "CURRENT", "Software\Microsoft\Office\8.0\PowerPoint\Recent Folder
      List\Default", "", &lt;Documents Folder&gt;
</PRE><P>
   including the quotations marks. Note that &lt;Documents Folder&gt; is the disk
   drive and folder name. For example, type the following
<P>
<P><PRE>      "H:\Data"
</PRE><P>
<P><PRE>       -or-
</PRE><P>
<P><PRE>      "H:\Data\PowerPoint"
</PRE>
<P><LI>On the File menu, click Save.
<P>
</OL>After you save the changes in the custom STF file, you can use the STF
file by using the command line parameters in the last dialog box of the
Network Installation Wizard.
<P>
When you run Microsoft Office 97 Setup by using the modified STF file, the
default folder for documents is automatically changed.
<P>
<P><h2>METHOD 2: USING WINDOWS 95 WITHOUT USER PROFILES</h2>
 
<P>
WARNING: This modification may not be supported by Microsoft. Microsoft
support engineers will support some modifications to a BACKUP copy of the
Setup.stf file. Note also that while support engineers may help customers
modify specific lines of an STF, we will not rewrite the entire file in
order to achieve a desired configuration. As a general rule, support is
limited to options that can normally be changed by a user during a
standard installation of the application.
<P>
NOTE: The following steps work only if you first perform an administrative
installation (setup /a) of Office 97 to a server on your network. If you
are performing a stand-alone installation using the Office 97 compact disc,
you cannot use the steps in this article.
<P>
Before you perform the following steps, make a backup copy of the
Off97pro.stf or Off97std.stf file on your server. Rename the file to
Backup.stf and do not open or edit it for any reason.
<P>
To use method 2, follow these steps:

<OL><P><LI>Start the Network Installation Wizard. Open the LST file or STF file
   that you want to modify.

<P><LI>In the Primary Location dialog box, specify the primary location for
   Microsoft Office 97. Note that it is not necessary to change anything
   in this dialog box. Click Next.

<P><LI>In the Documents Folder dialog box, type the name of the default
   folder that you want to use to store documents (for example, C:\Data).
   Then, click Next.

<P><LI>Proceed through the rest of the Network Installation Wizard until you
   reach the Add Registry Entries dialog box.

<P><LI>Add the following three registry keys and the associated values to the
   registry. To add a key, click Add. In the Add dialog box, specify the
   values, and then click OK.
<P>
<P><PRE>      Key 1
      -----
</PRE><P>
<PRE>         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_CURRENT_USER

         Data type:     SZ

         Key:           Software\Microsoft\Windows\CurrentVersion\Explorer\
                        Shell Folders

         Value name:    Personal

         Value data:    &lt;folder you want to use for documents&gt;

      Key 2
      -----

         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_CURRENT_USER

         Data type:     SZ


         Key:           Software\Microsoft\Windows\CurrentVersion\Explorer\
                        User Shell Folders

         Value name:    Personal

         Value data:    &lt;folder you want to use for documents&gt;

      Key 3
      -----

         Item           Value
         ---------------------------------------------------------------

         Root:          HKEY_LOCAL_MACHINE

         Data type:     SZ

         Key:           SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\
                        User Shell Folders

         Value name:    Personal

         Value data:    &lt;folder you want to use for documents&gt;

   Note that all three keys must use the same folder name for "Value data"
   (for example, C:\Data). This is the same name you specify in step 3.

</PRE><P><LI>After you add the three keys to the registry, click Next.

<P><LI>In the Select Quiet Mode dialog box, select the Quiet Level that you
   want, and then click Next.

<P><LI>In the Save Changes dialog box, enter the file names for your customized
   setup files, and then click Finish.
<P>
</OL>After you save the changes in the custom STF file, you can use the STF
file by using the command line parameters provided in the last dialog box
of the Network Installation Wizard.
<P>
When you run Microsoft Office 97 Setup by using the modified STF file, the
default folder for documents is automatically changed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Office Network Installation Wizard version 2.1 allows you to
modify the Setup files (.lst, .stf, and .inf files) that are used in an
administrative installation of Microsoft Office. You can customize many
aspects of the Microsoft Office installation process, including the name of
the default folder that you want to use to store your documents.
In Microsoft Windows 95, the default folder for storing documents is the
My Documents folder. If this folder exists on the computer or a Microsoft
Windows registry key exists that points to a default documents folder, the
Microsoft Office 97 Setup program does not change the setting unless you
use one of the workarounds in this article.
<P>
<P><h3>Opening the STF for Editing</h3>
 
<P>
When you open the Microsoft Office Setup Table File (STF), you must use a
certain process to avoid damaging the integrity of the file. To do this,
follow these steps:

<OL><P><LI>Make a backup copy of the original .stf file.

<P><LI>Open the document in Microsoft Word.

<P><LI>On the Edit menu, click Replace. In the Find What box, type the
    following (without the quotation marks):
<P>
       "^t "
<P>
    Note that there is a space after the letter "t."
<P>
    In the Replace With box, type the following (without the quotation
    marks):
<P>
       "^t"
<P>
    Click Replace All. Click Close.
<P>
    NOTE: You cannot use ^t^w in the Find What box because ^w replaces
    a tab followed by second tab as well as a tab followed by a space. You
    want to replace only tabs followed by spaces (&lt;tab&gt;&lt;space&gt;).

<P><LI>On the File menu, click Save As. In the Save As Type box, select
    Text Only (*.txt). The File Name box should contain either:
<P>
       Off97Pro.stf.txt for the Office 97 Professional Edition
<P>
       -or-
<P>
       Off97Std.stf.txt for the Office 97 Standard Edition
<P>
    Click Save, and then Quit Microsoft Word.

<P><LI>Click Start, point to Programs, and then click Windows Explorer.

<P><LI>On the View menu, click Options, and then click the View tab.

<P><LI>Clear the "Hide file extensions for known file types" box. Click OK.

<P><LI>In the folder in which you saved the .stf file, rename the file to its
    original file name of:
<P>
       Off97Pro.stf (for the Office 97 Professional Edition)
<P>
       -or-
<P>
       Off97Std.stf (for the Office 97 Standard Edition)

<P><LI>In Microsoft Excel, open the .stf file you want to edit.

<P><LI>In the Text Import Wizard dialog box, click Next twice to proceed to
    the Step 3 of 3 dialog box.

<P><LI>In the Text Import Wizard - Step 3 Of 3 dialog box, under Data
    Preview, drag the vertical scroll box all the way down and drag the
    horizontal scroll box all the way to the right. Hold the SHIFT key
    down, and then click the last column. All of the columns should be
    selected.

<P><LI>Under Column Data Format, click Text, and then click Finish.
<P>
</OL>For more information about editing the STF file in Microsoft Excel, please
see the following article in the Microsoft Knowledge Base:
<P>
ARTICLE-ID: <B><A href="../office/q162796.htm">Q162796</A></B>
<PRE>TITLE     : OFF97: Setup Error 932 After Modifying STF File
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 STF file<BR>
Keywords          : offNIW OffWinSetup kbsetup kbtool<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
