

<HTML>
<HEAD>
<TITLE>OFF97: How to Force Installation of All Office Assistants </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162048">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/01/10">
<META NAME="Keywords" CONTENT="offadmin offrfs OffWinSetup kbsetup kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  This article explains how to configure the Microsoft Office 97 Setup program so that the character (.act) files for all of the Office Assistants are copied to your hard disk when you install Microsoft Office 97 from an administrative installation (...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKE,QAA1,QDKX,QDI2,QBVP,QABH,QASR,QBJZ,QDIZ,QA5V,QBWS,QAE1,QDH3,QDMN,QAUR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: How to Force Installation of All Office Assistants</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162048</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, versions 7.0, 7.0a
<LI>Microsoft Excel for Windows, versions 5.0, 5.0a, 5.0c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to configure the Microsoft Office 97 Setup
program so that the character (.act) files for all of the Office Assistants
are copied to your hard disk when you install Microsoft Office 97 from an
administrative installation (Setup /a) on a network server.
<P>
NOTE: These instructions are recommended only for administrators who are
familiar with administrative installations and can edit the setup table
file (.stf). For more information, see Chapter 6, "Customizing Client
Installations," in the Microsoft Office 97 Resource Kit.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you install Microsoft Office 97 from an administrative installation
point on a network server, the following files are copied to the C:\Program
Files\Microsoft Office\Office\Actors folder on your hard disk.
<P>
<PRE>   File           Description
   -------------------------------------------------

   Clippit.act    Office Assistant character file
   Dot.acp        Office Assistant character preview
   Genius.acp     Office Assistant character preview
   Hoverbot.acp   Office Assistant character preview
   Logo.acp       Office Assistant character preview
   Mnature.acp    Office Assistant character preview
   Powerpup.acp   Office Assistant character preview
   Scribble.acp   Office Assistant character preview
   Will.acp       Office Assistant character preview

</PRE>Note that only the character file for Clippit is installed on your hard
disk. When you switch to a different character (for example Power Pup), the
character (.act) file is copied from the original installation source, and
the preview file (.acp file) for that character is removed.
<P>
If, for some reason, the original installation source is not available,
you may not be able to switch to a different character.
<P>
To avoid this problem, configure your Microsoft Office 97 Setup program so
that it copies all of the character files, instead of the preview files, to
your hard disk.
<P>
WARNING: This modification may not be supported by Microsoft. Microsoft
support engineers will support some modifications to a BACKUP copy of the
Setup.stf file. Note also that while support engineers may help customers
modify specific lines of an STF, we will not rewrite the entire file in
order to achieve a desired configuration. As a general rule, support is
limited to options that can normally be changed by a user during a standard
installation of the application.
<P>
NOTE: Before you perform the following steps, make a backup copy of the
Off97pro.stf or Off97std.stf file that is stored on the server. Change the
name of the backup copy to Backup.stf and do not open or edit it for any
reason. If you encounter any problems with the procedure, you will need
this file to restore your previous installation.
<P>
To configure the Microsoft Office 97 Setup program, follow these steps:
<P>
WARNING: You must be careful about the process you use to import the setup
table file or it will become corrupted. The steps used to open an .STF in
an earlier version of Microsoft Office must be altered slightly to work
correctly with the setup table files for Microsoft Office 97. Using the
incorrect steps to open, edit, and save the setup table file results in a
corrupted setup table file.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>      ARTICLE-ID: <B><A href="../office/q162796.htm">Q162796</A></B>
      TITLE     : OFF97: Setup Error 932 After Modifying STF File

  1. Start Microsoft Excel version 5.0, 7.0, or Microsoft Excel 97.

  2. On the File menu, click Open. In the File Name box, type the path to
     the server and share, followed by the name of the setup table file
     that you want to edit. For example, type one of the following:

        \\myserver\myshare\off97pro.stf

        -or-

        \\myserver\myshare\off97std.stf

     and then click Open.

     The Text Import Wizard of Microsoft Excel appears. Follow these steps
     in the wizard:

      a. Click Next twice to proceed to the Step 3 of 3 dialog box.

      b. In the Text Import Wizard - Step 3 Of 3 dialog box, under Data
         Preview, drag the vertical scrollbar indicator down until the
         "Object ID" item appears in the Data Preview window. Click the
         first column to select it. Hold the SHIFT key down, and drag the
         horizontal scrollbar indicator to the right until the last column
         is displayed in the Data Preview window. Click the last column.
         All of the columns (at least 15 columns) should be selected.

      c. Under Column Data Format, click the Text option, and click Finish.

         IMPORTANT: If you do not click the Text option at this step,
         Microsoft Excel will read some of the entries in your edited .STF
         file incorrectly. When this occurs, you will receive "setup parse
         errors" during setup.

  3. When the .STF file is open, click Find on the Edit menu. Type "Office
     Assistant Install Modes" (without the quotation marks) in the Find
     What box, and then click Find Next. Click Close.

  4. Of the five rows that follow the cell, determine which row contains
     "%d\Actors,%d" in column K. The row should appear similar to the
     following:

      Column A      Column B      Column E      Column F      Column K
      -----------------------------------------------------------------
         11805      Yes           Group            11808      %d\Actors,%d


     Make a note of the ObjectID value in column A (or note the row
     number), because you will use the ObjID for this row in a later step.

  5. On the Edit menu, click Find. Type "Logo.act" (without the quotation
     marks) in the Find What box, and then click Find Next. Click Close.

  6. Make a note of the ObjID value in column A of the row.

     You will use the ObjID for this row in a later step.

  7. In the row that you noted in step 4, select the cell in column F.

  8. Append a space, followed by the ObjID value that you noted in step 6,
     to the contents of the cell. For example, the table in step 4 would
     now look like the following:

      Column A      Column B      Column E      Column F      Column K
      -----------------------------------------------------------------
         11805      Yes           Group         11808 11809   %d\Actors,%d

     IMPORTANT: Do NOT change anything else in the line.

  9. On the Edit menu, click Find. Type "Scribble.act" (without the
     quotation marks) in the Find what box, and then click Find Next. Click
     Close.

 10. Make a note of the ObjID value in column A of the row. Note the ObjID
     value of this row and the ObjID values for the next six rows, because
     you will use them in a later step.

     For example, if the ObjID value happens to be 12913, the following
     seven ObjID values will be used in a later step:

        12913 12914 12915 12916 12917 12918 12919

 11. Note the row below the row that contains the ObjID that you noted in
     step 6.

     This row contains a series of eight numbers in column F. These numbers
     reference the ObjID for the corresponding .acp files for the actor
     files. These will be replaced by the ObjIDs that you noted in step 10
     to install the remaining .act files on the local machine.

     WARNING: Make sure that you select the row BELOW the row you noted in
     step 6.

 12. Select the cell in column F of the row you selected in step 11.

 13. Press the DELETE key to clear the contents of the cells, and then type
     the ObjID values you noted in step 10 into the current cell.

     NOTE: Separate the ObjID values by one space. Do NOT change anything
     else in the line.

 14. On the File menu, click Save. After you save the file, click Exit on
     the File menu. If you are prompted save changes again, click No.

     This dialog box appears because the setup table file is not in the
     native Microsoft Excel file format. Do NOT save the file in the
     Microsoft Excel format.

</PRE>When you run the Microsoft Office 97 Setup program, it copies all of the
character (.act) files to your hard disk. You can verify that this is
working correctly by installing Microsoft Office 97 and then checking the
contents of the folder that contains the files. In most cases, the files
are in the C:\Program Files\Microsoft Office\Office\Actors folder. There
should be a total of nine .act files.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97 8.00 OFF97<BR>
Keywords          : offadmin offrfs OffWinSetup kbsetup kbfaq<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
