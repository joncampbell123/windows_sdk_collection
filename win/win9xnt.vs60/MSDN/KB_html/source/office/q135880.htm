

<HTML>
<HEAD>
<TITLE>OFF95: Forcing Office Shortcuts into a Subgroup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135880">
<META NAME="KBModify" CONTENT="1998/01/23">
<META NAME="KBCreate" CONTENT="1995/08/29">
<META NAME="Keywords" CONTENT="offwin kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  This article explains how you can force the Microsoft Office 7.0 Setup program to create shortcuts for the various Microsoft Office applications in a subgroup of the Start menu, rather than directly in the Start menu itself.  MORE INFORMATION  When...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QDH3,QAH4,QBWS,QBWR,QBVP,QAUR,QAA1,QBJZ,QDI2,QAIH,QAE1,QAJH,QBVQ,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF95: Forcing Office Shortcuts into a Subgroup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135880</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
- Microsoft Office for Windows 95, version 7.0
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how you can force the Microsoft Office 7.0 Setup
program to create shortcuts for the various Microsoft Office applications
in a subgroup of the Start menu, rather than directly in the Start menu
itself.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you install Microsoft Office for Windows 95, version 7.0, the Setup
program creates shortcuts for the various Microsoft Office applications
directly in the Start menu. This behavior is different from that used in
earlier versions of Microsoft Office; in earlier versions, icons for the
applications are created in a separate group in Program Manager.
<P>
For example, the default hierarchy used by Microsoft Office 7.0 is as
follows:
<P>
<PRE>   Programs                       &lt;-- main level
      Microsoft Excel             &lt;-- application shortcut
      Microsoft Word
      Microsoft PowerPoint
      Microsoft Access
      Microsoft Schedule+
      Microsoft Binder

</PRE>and so on. The default hierarchy used by earlier versions of Microsoft
Office appears as follows:
<P>
<PRE>   Program Manager                &lt;-- main level
      Microsoft Office            &lt;-- program group
         Microsoft Excel          &lt;-- program icon
         Microsoft Word
         Microsoft PowerPoint
         Microsoft Access

</PRE>It is possible to change the behavior of the Microsoft Office 7.0 Setup
program, so that it creates application shortcuts in a separate subgroup in
the Start menu, rather than in the Start menu itself:
<P>
<PRE>   Programs                       &lt;-- main level
      Microsoft Office 95         &lt;-- menu subgroup
         Microsoft Excel          &lt;-- application shortcut
         Microsoft Word
         Microsoft PowerPoint
         Microsoft Access
         Microsoft Schedule+
         Microsoft Binder

</PRE>By making certain changes to the STF file used by Microsoft Office 7.0
Setup, you can force the Setup application to create the application
shortcuts in any desired subgroup of the Start menu.
<P>
WARNING: This modification may not be supported by Microsoft Product
Support Services (PSS). PSS will support some modifications to a BACKUP
copy of the SETUP.STF file. Note also that while PSS may help customers
modify specific lines of an STF, we will not rewrite the entire file in
order to achieve a desired configuration. As a general rule, support is
limited to options that can normally be changed by a user during a standard
installation of the application.
<P>
For more information about customizing the location of the Office shortcuts
on the Start menu after installing Microsoft Office, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A href="../office/q132979.htm">Q132979</A></B>
   TITLE     : OFF95: Customizing Start Menu to Create Microsoft Office Menu

</PRE><h3>Opening and Saving the STF File</h3>
 
<P>
NOTE: Do NOT make changes to the original SETUP.STF file. Before making any
modifications to an STF file, make a copy of the file and modify the copy.
<P>
After you have made a copy of the STF file, you can open the copy of the
STF file in Microsoft Excel by following these steps:

<OL><P><LI>In Microsoft Excel, click the Open on the File menu, and open the STF
   file that you want to modify.

<P><LI>In the Text Import Wizard dialog box, click the Next button
   repeatedly until "Step 3 of 3" appears.

<P><LI>In the Text Import Wizard - Step 3 Of 3 dialog box, scroll the Data
   Preview box until the word "ObjId" appears in the first column.

<P><LI>Hold down the SHIFT key on your keyboard.

<P><LI>Use the scroll bar to scroll the Data Preview window as far to the
   right as is possible. You should see the words "Install Directory" in
   the rightmost column.

<P><LI>Click once on the last column. All of the columns should be
   highlighted.

<P><LI>Under Column Data Format, click the Text option. Click Finish.
<P>
</OL>After you open the STF file, you can use either of the methods shown below
to make the necessary changes to the STF file. After you make the required
changes, save the STF file by using the following steps:

<OL><P><LI>Select the entire worksheet by pressing CTRL+SHIFT+SPACEBAR.

<P><LI>On the Format menu, click Column, and then click Column AutoFit
   Selection.

<P><LI>On the File menu, click Save As.

<P><LI>In the Save As dialog box, make sure that the Save As Type box
   contains the Text (Tab Delimited) item . The name of the file should
   NOT be "Setup.stf." If it is, change it to a different name that ends
   with the ".stf" extension .

<P><LI>To save the file, click Save or OK.

<P><LI>On the File menu, click Close to close the STF file. If you are prompted
   to save the file, click the No button.
<P>
</OL>To use the customized STF file, use the /T switch when you run the Setup
program. For example, to use the file N:\Office\Custom.stf, use the
following command line:
<P>
<PRE>   Setup /T N:\Office\Custom.stf

</PRE></OL><h3>Manual Modification of the STF File</h3>
 
<P>
In the Microsoft Office 7.0 (Standard Edition) STF file, the following
ObjIDs control the location of the following application shortcuts.
<P>
<PRE>   ObjID   Application Shortcut            Destination (Column K)
   --------------------------------------------------------------
   862     Microsoft Binder                %860,%d
   1454    Microsoft Word                  %1452,%d
   3152    Microsoft Excel                 %3150,%d
   5102    Microsoft Schedule+             %5098,%d
   6268    Microsoft Office Shortcut Bar   %6258,%d
   7658    Microsoft PowerPoint            %7656,%d

   6280    New Office Document             %6260
   6284    Open Office Document            %6260

</PRE>The first six items listed above are, by default, created directly under
the Programs menu. The last two items (New Office Document, Open Office
Document) are created on the Start menu itself.
<P>
By changing the value in the Destination column (column K), you can change
the location where the shortcut will be created. The first part of the
destination (preceding the comma) determines where the shortcut will be
created. You can add additional pathing to the values, changing the
locations that they refer to.
<P>
For example, to create the Microsoft Binder shortcut in a subgroup called
"Microsoft Office 95," you would change the value in column K from
<P>
<PRE>   %860,%d

</PRE>to:
<P>
<PRE>   %860\Microsoft Office 95,%d

</PRE>The "\Microsoft Office 95" changes the path where the shortcut should be
created.
<P>
To install ALL of the shortcuts listed above into a separate subgroup
("Microsoft Office 95", for example) under the Programs menu, make the
following changes to the values in column K:
<P>
<PRE>   ObjID   Destination
   ------------------------------------
   862     %860\Microsoft Office 95,%d
   1454    %1452\Microsoft Office 95,%d
   3152    %3150\Microsoft Office 95,%d
   5102    %5098\Microsoft Office 95,%d
   6268    %6258\Microsoft Office 95,%d
   6280    %860\Microsoft Office 95
   6284    %860\Microsoft Office 95
   7658    %7656\Microsoft Office 95,%d

</PRE>Note that the Destinations for ObjIDs 6280 and 6284 have been changed to
"%860\Microsoft Office 95," instead of "%6260\Microsoft Office 95." This is
necessary in this case because using %6260 would cause a new subgroup to be
created at the top of the Start menu, not within the Programs menu.
<P>
After you have modified the STF file, save the file by following the steps
in the "Opening and Saving an STF File" section above.
<P>
<P><h3>Automated Modification of the STF File</h3>
 
<P>
You can use the following Visual Basic, Applications Edition, macro to make
the necessary modifications to the values in column K of the STF file.
<P>
NOTE: This macro is designed to work with the STF file used by Microsoft
Office version 7.0 for Windows 95, Standard Edition. If you are using a
different version of Microsoft Office 7.0 (the Professional Edition, for
example), you will need to use different values in the ItemArray variable
used in this macro.
<P>
Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<PRE>   Sub ModifyOffice7STF()

      'The values contained in the "ItemArray =" line are specific to
      'the STF file used by Microsoft Office 7.0, Standard Edition. You
      'may need to use different values if you are using a different
      'version of Microsoft Office.
      '
      'If you also want to relocate the New Office Document and Open
      'Office Document shortcuts to the new subgroup, use this line of
      'code instead:
      '
      '   ItemArray = Array(860, 1452, 3150, 5098, 6258, 7656, 6260)
      '
      ItemArray = Array(860, 1452, 3150, 5098, 6258, 7656)

      'Modify this line to contain the desired name of your subgroup.
      SubgroupName = "Microsoft Office 95"

      'Start the loop.
      For X = 0 To UBound(ItemArray, 1)

         'Set the StatusBar so that we can see what's happening.
         Application.StatusBar = "Changing Object ID " &amp; _
            ItemArray(X) &amp; "..."

         'Select a range large enough to contain the entire STF file.
         Range("A1:M10000").Select

         'Change the value in the Destination column.
         Selection.Replace What:="%" &amp; ItemArray(X), _
            Replacement:="%" &amp; ItemArray(0) &amp; "\" &amp; SubgroupName

      Next X

      'Reset the StatusBar.
      Application.StatusBar = False

   End Sub

</PRE>To use this macro, do the following:

<OL><P><LI>On a new module sheet in Microsoft Excel, enter the macro above.

<P><LI>Open the STF file, following the steps shown in the "Opening and
   Saving an STF File" section above.

<P><LI>With the STF file active, click Macro on the Tools menu.

<P><LI>In the list of macros in the Macro dialog box, click ModifyOffice7STF.
   Click Run.

<P><LI>After you run the macro, (the status bar should display the text
   "Ready"), save and close the STF file, using the steps in the
   "Opening and Saving an STF File" section above.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 officeinterop word6 powerpt admin<BR>
Keywords          : offwin kbsetup<BR>
Version           : windows:7.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
