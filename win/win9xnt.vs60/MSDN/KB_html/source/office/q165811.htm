

<HTML>
<HEAD>
<TITLE>OFF95: Cannot Change Drive or Directory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165811">
<META NAME="KBModify" CONTENT="1997/08/25">
<META NAME="KBCreate" CONTENT="1997/03/25">
<META NAME="Keywords" CONTENT="OffWinSetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT=" WARNING: The information in this article has not been confirmed or tested by Microsoft. Some or all of the information in this article has been taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS AT...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QDIY,QDL9,QBWO,QBWN,QAFI,QA3P,QACF,QBWQ,QDNN,QBXM,QAFX,QAUJ,QDLP,QAC9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF95: Cannot Change Drive or Directory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165811</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows 95, version 7.0
</UL> 
<P>
WARNING: The information in this article has not been confirmed or tested
by Microsoft. Some or all of the information in this article has been
taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION
PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK. Microsoft provides this
information "as is" without warranty of any kind, either express or
implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error message may appear when you attempt to change folders
or drives using the Open, Save, or Save As dialog boxes in a Microsoft
Office 95 program:
<P>
<PRE>   The drive C: is invalid

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if either of the following two files are corrupted or
replaced by third-party software:
<P>
<PRE>   User32.dll
   Imm32.dll

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, locate the affected files, rename the files,
and then reinstall them using your Microsoft Windows compact disc or disks.
To do this, use the following steps:

<OL><P><LI>Locate the following files:
<P>
   User32.dll
   Imm32.dll
   Kernel32.dll
   Gdi32.dll
<P>
   These .dll files are usually located in the C:\Windows\System folder.

<P><LI>Quit any open programs and click Shutdown on the Start menu.

<P><LI>Click "Shut down the computer?" and click Yes. When you are prompted,
   turn off your computer.

<P><LI>When the Starting Microsoft Windows message appears on the screen, press
   F8.

<P><LI>Select Command Prompt Only.

<P><LI>At the MS-DOS prompt, type the following, and then press ENTER
<P>
<P><PRE>      cd\&lt;folder&gt;
</PRE><P>
   where &lt;folder&gt; is the name of the folder that contains the .dll file you
   want to rename.

<P><LI>At the MS-DOS prompt, type the following and then press ENTER
<P>
<P><PRE>      ren &lt;filename&gt;.dll &lt;filename&gt;.bak
</PRE><P>
   where &lt;filename&gt; is the .dll file you are renaming. Repeat steps 1-6 for
   each of the four .dll files.
<P>
</OL>For more information about how to perform this task in Windows, see your
Windows printed documentation or online Help.
<P>
<P><h3>Reinstalling the .Dll Files on Your Computer</h3>
 

<OL><P><LI>Insert the Windows 95 compact disc into the CD-ROM drive (this requires
   that you previously loaded the real-mode CD-ROM driver.)

<P><LI>If you installed Windows 95 from a disk, insert the corresponding disk
   in the disk drive. Refer to the following table for the disk number.
<P>
   For additional information about accessing your CD-ROM from the MS-DOS
   Prompt, please see the following article in the Microsoft Knowledge
   Base:
<P>
<P><PRE>      Article-ID: <B><A href="../win95x/q135174.htm">Q135174</A></B>
<PRE></PRE>      TITLE     : Cannot Access CD-ROM Drive from MS-DOS Mode or Command
                  Prompt

</PRE><P><LI>If the name of the folder that contains the .dll file does not appear
   at the MS-DOS prompt, type the following and press ENTER
<P>
<P><PRE>      cd\&lt;folder&gt;
</PRE><P>
   where &lt;folder&gt; is the name of the folder that contains the .dll file.
   This folder is usually windows\system.

<P><LI>If you installed Windows 95 from a compact disc, type the following
   at the MS-DOS prompt
<P>
<P><PRE>      extract &lt;drive&gt;:\win95\win95_&lt;n&gt;.cab &lt;filename&gt;.dll
</PRE><P>
   where &lt;drive&gt; is the letter of your CD-ROM drive, &lt;n&gt; is the cabinet
   file number that contains the .dll, and &lt;filename&gt; is the name of the
   .dll file you want to extract. For example, to extract the file
   Kernel32.dll from CD-ROM drive D, type the following:
<P>
<P><PRE>      extract d:\win95\win95_11.cab kernel32.dll
</PRE><P>
   -or-
<P>
   If you installed Windows 95 from a disk, type the following at the
   MS-DOS prompt
<P>
<P><PRE>      extract &lt;drive&gt;:\win95_0&lt;n&gt;.cab &lt;filename&gt;.dll
</PRE><P>
   where &lt;drive&gt; is the letter of the CD-ROM drive, &lt;n&gt; is the cabinet file
   number that contains the .dll, and &lt;filename&gt; is the name of the .dll
   file you want to extract.

<P><LI>After you extract the file, press CTRL+ALT+DEL to restart your computer.
<P>
</OL>Refer to the following table to locate the .dll file.
<P>
<PRE>                 CD-ROM
   File Name     Cabinet       DMF     File          Non-DMF  File
</PRE></OL> 
<P>
<PRE>   Imm32.dll     Win95_06.cab  Disk6   Win95_06.cab  Disk9    Win95_09.cab
   Gdi32.dll     Win95_11.cab  Disk11  Win95_11.cab  Disk18   Win95_18.cab
   Kernel32.dll  Win95_11.cab  Disk11  Win95_11.cab  Disk18   Win95_18.cab
   User32.dll    Win95_11.cab  Disk11  Win95_11.cab  Disk18   Win95_18.cab

</PRE>The sizes and dates for files that are installed by Microsoft Windows 95
are listed in the following table.
<P>
<PRE>   File Name     Size           Date
   ------------------------------------------
   User32.dll    44,544 bytes   July 11, 1995
   Imm32.dll     6,144 bytes    July 11, 1995
   Kernel32.dll  411,136 bytes  July 11, 1995
   Gdi32.dll     131,072 bytes  July 11, 1995
</PRE> 
<PRE>Keywords          : OffWinSetup
Version           : 7.0
Platform          : WINDOWS
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
