

<HTML>
<HEAD>
<TITLE>OFF95: "Illegal Operation" Error Running Macro in Binder </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133331">
<META NAME="KBModify" CONTENT="1997/03/10">
<META NAME="KBCreate" CONTENT="1995/07/30">
<META NAME="Keywords" CONTENT="offwin xlwin kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  In Office Binder, when you run a macro in a Microsoft Excel worksheet section, you may receive an Illegal Operation error message. If you click Details, information similar to the following appears:     EXCEL caused an invalid page fault in module ...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAB4,QAH4,QA7G,QBWS,QAY5,QBM3,QAAP,QAO1,QADK,QAKP,QAVX,QAVW,QAFF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF95: "Illegal Operation" Error Running Macro in Binder</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00
WINDOWS
kbprg kbole
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Office Binder, when you run a macro in a Microsoft Excel worksheet
section, you may receive an Illegal Operation error message. If you
click Details, information similar to the following appears:
<P>
<PRE>   EXCEL caused an invalid page fault in module VBA32.DLL at
   0137:00b30d7d.

</PRE>When you click Close, you may also receive an illegal operation error
message in Binder.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if the macro that you run returns the following
error message in Microsoft Excel:
<P>
<PRE>   Sub or Function not defined

</PRE>For example, if you create the following macro
<P>
<PRE>   Sub Test()
      msgbxo "test"
   End Sub

</PRE>(note the misspelled "MsgBox" command), when you run the macro in
Microsoft Excel, you receive the "Sub or Function not defined" error
message as expected. However, if you run this same macro from a
Microsoft Excel worksheet section in a Binder, you receive the Illegal
Operation error message.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To avoid this problem when you run a macro in a Microsoft Excel
worksheet section in a Binder, run the macro first from within Microsoft
Excel, before you run the macro in Office Binder. If the macro is
already in a section in a Binder, click View Outside on the Section menu
to view the macro in Microsoft Excel. You can then run the macro, and
modify your code to correct any run-time errors or misspelled commands.
<P>
Note that the only way to view a module sheet in a Microsoft Excel
worksheet section in a Binder is to view the Microsoft Excel worksheet
section outside the Binder by clicking the View Outside command on the
Section menu.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here as it becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about adding a document to a Binder, click the
Index tab in Binder Help, type the following text
<P>
<PRE>   Binder, adding

</PRE>double-click the selected text and then double-click "Add a new document
to a binder" to go to the "Add A New Document To A Binder" topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbole<BR>
KBSubcategory: xlwin offwin
<P>

Additional reference words: 7.00 crash gpf
<P>

Keywords            : offwin xlwin kbole kbprg<BR>
Version             : 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
