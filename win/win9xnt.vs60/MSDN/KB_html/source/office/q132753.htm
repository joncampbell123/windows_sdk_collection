

<HTML>
<HEAD>
<TITLE>OFF95: Illegal Operation Using Binder OLE Automation Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132753">
<META NAME="KBModify" CONTENT="1997/03/27">
<META NAME="KBCreate" CONTENT="1995/07/18">
<META NAME="Keywords" CONTENT="offwin kbcode kbfasttip kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  In Microsoft Excel, if you use a Visual Basic macro to create a Microsoft Office Binder OLE Automation object, you may receive an Illegal Operation error in Microsoft Excel. If you click Details, you may see information similar to the following:   ...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAPN,QAW6,QBS0,QAY5,QA7G,QAH4,QAPF,QAO1,QBWS,QBIX,QA9Q,QA2K,QAAP,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF95: Illegal Operation Using Binder OLE Automation Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132753</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
7.00
WINDOWS
kbprg kbole kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Excel for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel, if you use a Visual Basic macro to create a Microsoft
Office Binder OLE Automation object, you may receive an Illegal Operation
error in Microsoft Excel. If you click Details, you may see information
similar to the following:
<P>
<PRE>   EXCEL caused an invalid page fault in module EXCEL.EXE at
   0137:5000d9fd.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs if you create an Office Binder OLE Automation object,
and you add a Microsoft Excel worksheet section to the Binder without
dimensioning the Microsoft Excel section as an object to hold a pointer in
memory for the object. For example, when you run the following macro, you
receive an Illegal Operation error in Microsoft Excel:
<P>
<PRE>   Sub BinderExample()
      Dim myBinder as Object, y as String
      ' Create Binder object
      Set myBinder = CreateObject("Office.Binder")
      ' Add Microsoft Excel worksheet section
      myBinder.sections.Add Type:="excel.sheet.5"
      y = myBinder.sections(1).Object.Name
      y = myBinder.sections(1).Object.Name
   End Sub

</PRE>When you run the macro above, the myBinder.sections.Add statement correctly
adds a worksheet section to the Binder. However, there is no pointer in
memory for this object. The first reference to this section object occurs
without an error, but the second reference to this object causes Microsoft
Excel to crash.
<P>
Note that the above example is not the only example that causes an Illegal
Operation error in Microsoft Excel. Other examples may include commands
similar to the following:
<P>
<PRE>   myBinder.sections(1).Visible = False
   myBinder.sections(1).Visible = True
   myBinder.Sections(1).Object.Parent.Worksheets.Add
   myBinder.Sections(1).Object.Parent.Worksheets(1).Range("A1").Value = "1"

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this behavior, when you add a Microsoft Excel worksheet
section to a Binder using OLE Automation, dimension the worksheet section
as Object type add so that a pointer in memory is reserved for this object.
For example, to run the above macro without receiving an Illegal Operation
error, modify the macro as follows:
<P>
<PRE>   Sub BinderExample()
      Dim myBinder as Object, XLSec as Object, y as String
      ' Create Binder object
      Set myBinder = CreateObject("Office.Binder")
      ' Add Microsoft Excel worksheet section
      Set XLSec = myBinder.sections.Add(Type:="excel.sheet.5")
      y = myBinder.sections(1).Object.Name
      y = myBinder.sections(1).Visible = True
   End Sub

</PRE>Microsoft provides examples of Visual Basic procedures for illustration
only, without warranty either expressed or implied, including but not
limited to the implied warranties of merchantability and/or fitness for a
particular purpose. This Visual Basic procedure is provided 'as is' and
Microsoft does not guarantee that it can be used in all situations.
Microsoft does not support modifications of this procedure to suit customer
requirements for a particular purpose.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about communicating with other applications in
Microsoft Excel, click the Index tab in Microsoft Excel Help, type the
following text
<P>
<PRE>   CreateObject function

</PRE>double-click the selected text, and then double-click "communicating with
other applications" to go to the "Communicating With Other Applications"
topic.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbole kbcode kbfasttip<BR>
KBSubcategory: offwin
<P>

Additional reference words: 7.00 xl7 gpf crash
<P>

Keywords            : offwin kbcode kbfasttip kbole kbprg<BR>
Version             : 7.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
