

<HTML>
<HEAD>
<TITLE>Page Fault in KERNEL32.DLL When You Open or Create a Document </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146059">
<META NAME="KBModify" CONTENT="1997/10/15">
<META NAME="KBCreate" CONTENT="1996/02/13">
<META NAME="Keywords" CONTENT="offwin kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you use the Office Shortcut Bar or the Start menu to open or to create a Word document, you receive the following message:     This program has performed an illegal operation and will be shut down.    If the problem persists, contact the progr...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXT,QAIH,QBWS,QAIJ,QBJZ,QDO7,QBWR,QBQ9,QDIV,QDKW,QDKX,QBIC,QAH4,QBWA,QDH3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Page Fault in KERNEL32.DLL When You Open or Create a Document</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146059</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Word for Windows 95, version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the Office Shortcut Bar or the Start menu to open or to create
a Word document, you receive the following message:
<P>
<PRE>   This program has performed an illegal operation and will be shut down.
   If the problem persists, contact the program vendor.

</PRE>If you click Details, you receive an error message similar to the
following:
<P>
<PRE>   MSOW caused an invalid page fault in module KERNEL32.DLL at
   0137:bff782ae.

</PRE><h2>CAUSE</h2>
 
<P>
This problem occurs when you do either of the following:

<UL><LI>You click Open Office Document or New Office Document on the Start menu,
   and you then select a Word document.
<P>
   -or-

<LI>You click Open A Document or Start A New Document on the Office Shortcut
   Bar, and you create a new Word document.
<P>
</UL>This behavior occurs after you install any program that inserts a complex
DDEExec command in the following entries in the registry:
<P>
<PRE>   HKEY_LOCAL_MACHINE\Software\Classes\Word.Backup\Shell\Open\DDEEXEC

   -or-

   HKEY_LOCAL_MACHINE\Software\Classes\Word.Backup\Shell\New\DDEEXEC

</PRE>Several programs, including the Microsoft Macro Virus Protection tool (also
called the Scanprot template), modify the DDEEXEC entry in the registry.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct the problem that occurs when you use the Start menu or the
Office Shortcut Bar to open a document or to create a new document, do the
following:

<OL><P><LI>Open Windows Explorer. Locate and double-click the Winword7.reg file to
   re-register Word.

<P><LI>Start Word.

<P><LI>Click Open A Document or Start A New Document on the Office Shortcut
   Bar. This resets the application settings in the Office Shortcut Bar.

<P><LI>Close Word.
<P>
</OL>You can now choose Open A Document or Start A New Document on the Office
Shortcut Bar.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can work around the problem that occurs when you use the Start menu or
the Office Shortcut Bar to open a document; however, no workaround exists
for when you create a new Word document. Instead you must create a new Word
document from within Word.
<P>
To create a new Word document, do the following:

<OL><P><LI>Start Word.

<P><LI>On the File menu, click New, and then double-click a template.
<P>
</OL>To work around the problem that occurs when you open a document, use the
following steps:

<OL><P><LI>Click the Start button, point to Programs, and then click Windows
   Explorer.

<P><LI>On the View menu, click Options, and then click the File Types tab.

<P><LI>Under Registered File Types, click Microsoft Word Document, and then
   click Edit.

<P><LI>In the Edit File Type dialog box under Actions, click Open, and then
   click Edit.

<P><LI>Delete the complex command in the DDE Message box and type the following
   text:
<P>
<P><PRE>      [FileOpen("%1")]
</PRE>
<P><LI>Click OK.

<P><LI>Click Close, and then click Close again to close the Options dialog
   box.
<P>
</OL>NOTE: Word may not run when you open a Word document after you use this
workaround, and the following message may appear
<P>
<PRE>   Word cannot open the document. (&lt;Folder Location&gt;)

</PRE></OL>If you click OK, the following message appears:
<P>
<PRE>   The document name or path is not valid. (&lt;Folder Location&gt;&lt;Document
   Name&gt;).

</PRE>If you click OK again, the document opens successfully.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Office for
Windows 95, version 7.0. This problem was corrected in Microsoft Office for
Windows 95, version 7.0b.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The problem occurs when you use the Office Shortcut Bar or the Start menu
to open or to create a new document. The Msow.exe module controls the Open
and New commands on the Office Shortcut Bar and the Start menu; however,
the Msow.exe does not understand the complex DDEExec message that is
written in the registry.
<P>
For additional information regarding the Microsoft Macro Virus Protection
tool, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../word/q134728.htm">Q134728</A></B>
   TITLE     : AppNote: "Macro Virus Protection Tool" (WD1215)

</PRE>You can successfully open a Word document by using either of the following
methods:

<UL><LI>Click the Start button, point to Documents, and then double-click a
   recently-used document.
<P>
   -or-

<LI>Start Word, and on the File menu, click Open.
<P>
</UL>A complex DDEExec command is a DDEExec command for FileOpen or FileNew that
contains If...Then...Else statements. The following command is the default
FileNew DDEExec command:
<P>
<PRE>   [FileNew("%1")]
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00 OSB OFF7 XL7 scanprot.dot ipf gpf<BR>
Keywords          : offwin kbtool kbusage<BR>
Version           : 7.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
