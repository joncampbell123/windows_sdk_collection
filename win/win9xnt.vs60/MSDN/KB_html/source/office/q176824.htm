

<HTML>
<HEAD>
<TITLE>Off97: Errors or Setup Fails After Using Orphan Finder </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176824">
<META NAME="KBModify" CONTENT="1997/12/10">
<META NAME="KBCreate" CONTENT="1997/11/17">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  When you open a workbook, record a macro, or run a wizard in Microsoft Excel 97, or when you run the Office Setup program, you may receive the following error messages.  Opening a workbook     Error in loading DLL.     -or-     Can't find file Fm20...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QAEF,QDKX,QDI2,QAB4,QBWS,QBCU,QAYH,QAAP,QAKP,QDH3,QDH6,QA9N,QANJ,QDKD P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Off97: Errors or Setup Fails After Using Orphan Finder</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176824</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
<LI>Microsoft Excel 97 for Windows
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you open a workbook, record a macro, or run a wizard in Microsoft
Excel 97, or when you run the Office Setup program, you may receive the
following error messages.
<P>
<P><h3>Opening a workbook</h3>
 
<P>
<PRE>   Error in loading DLL.

   -or-

   Can't find file Fm20.dll.

</PRE><h3>Recording a macro</h3>
 
<P>
<PRE>   Unable to record.

</PRE><h3>Running a Wizard</h3>
 
<P>
<PRE>   Object server did not correctly run.

   -or-

   System Error &amp; H80070485 (-2147023739). One of the library
   files needed to run this application cannot be found.

</PRE><h3>Running Microsoft Office Setup</h3>
 
<P>
<PRE>   Vbe.dll was unable to register itself in the system registry.

</PRE>When you then click OK, the following error message appears:
<P>
<PRE>   Microsoft Office Setup was not completed successfully.

</PRE><h2>CAUSE</h2>
 
<P>
These problems occur when you do all of the following:

<UL><LI>You run Orphan Finder, which is included in Quarterdeck CleanSweep
   versions 3.04 and 3.05, and delete "orphan" dynamic-link library (DLL)
   files.
<P>
  -and-

<LI>You then restore the orphan DLL files with Orphan Finder.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To correct this problem, remove system files and Windows registry entries
that are installed by Microsoft Office 97, and then reinstall Office.
<P>
Because you cannot run Office Setup in maintenance mode to remove your
current installation when this problem occurs, use the Office 97 File and
Registry Eraser Utility to remove problematic files and registry entries.
After you use this utility, you can successfully install Office 97.
<P>
IMPORTANT: This utility modifies the registry. Before you run the utility,
make sure you understand how to restore the registry if a problem occurs.
<P>
For information about how to do this, view the "Restoring the Registry"
Help topic in Regedit.exe or the "Restoring a Registry Key" Help topic in
Regedt32.exe.
<P>
Using the utility incorrectly may cause serious problems that may require
you to reinstall your operating system. Microsoft cannot guarantee that
problems resulting from the incorrect use of this utility can be solved.
<P>
Use the Office 97 File and Registry Eraser Utility at your own risk.
<P>
For information about using and obtaining this utility, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q176823.htm">Q176823</A></B>
   TITLE     : Off97: Utility to Completely Remove Remaining Office 97
               Files

</PRE>For information about removing the files and registry settings that Office
installs, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../office/q158658.htm">Q158658</A></B>
   TITLE     : OFF97: How to Completely Remove Microsoft Office 97

</PRE><h2>STATUS</h2>
 
<P>
This problem occurs when you use the Microsoft products listed at the
beginning of this article, and then use Orphan Finder in Quarterdeck
CleanSweep versions 3.04 or 3.05.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use Orphan Finder, which is included with CleanSweep versions 3.04
or 3.05, to delete DLL files from your computer, some of the system files
that the Microsoft Office programs require may be deleted. However, after
you restore these DLL files by using the Restore feature in CleanSweep,
some components are not properly registered with the program. For example,
when you attempt to use Visual Basic for Applications to create or run a
macro, you may encounter one of the error messages in the "Symptoms"
section of this article. When you try to reinstall Office, the Setup
program fails at the end of the installation. You must remove some of the
system files before you can successfully install Office and use Visual
Basic for Applications.
<P>
For additional information about related problems, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   Article-ID: <B><A href="../office/q162627.htm">Q162627</A></B>
   TITLE     : OFF97 Err Msg: "Vbe.dll Was Unable to Register Itself"

   Article-ID: <B><A href="../office/q174143.htm">Q174143</A></B>
   TITLE     : OFF97: Errors After Using Orphan Finder to Remove

</PRE>CleanSweep is manufactured by Quarterdeck Corporation, a vendor independent
of Microsoft; we make no warranty, implied or otherwise, regarding this
product's performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 warning messages dynamic libraries reinstall<BR>
crash<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
