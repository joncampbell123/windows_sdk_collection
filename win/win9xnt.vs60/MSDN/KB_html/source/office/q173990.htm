

<HTML>
<HEAD>
<TITLE>OFF97: Troubleshooting the Microsoft Office 97 SR-1 Patch </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173990">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1997/09/17">
<META NAME="Keywords" CONTENT="OffWinSetup kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT="  This article contains troubleshooting steps you can use if installing the Office 97 SR-1 Patch fails.  MORE INFORMATION  Check the Log File  The patch records a log file of all the actions it performs. This log file is named 97sr1_0.txt and is crea...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QBWS,QAH4,QAA1,QDO3,QDL9,QBWO,QBWN,QAEF,QBWQ,QABI,QBWP,QABH,QBF0,QDI2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Troubleshooting the Microsoft Office 97 SR-1 Patch</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173990</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows, Service Release 1 (SR-1)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains troubleshooting steps you can use if installing the
Office 97 SR-1 Patch fails.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Check the Log File</h3>
 
<P>
The patch records a log file of all the actions it performs. This log file
is named 97sr1_0.txt and is created in the Office subfolder of the
Microsoft Office folder (the default is Program Files\Microsoft
Office\Office). If you run the patch more than once, additional log files
are created. These files are named 97sr1_1.txt, 97sr1_2.txt, and so on. The
log file lists the files that were successfully patched and the files that
were not successfully patched. You can read this log file by using any text
editor program.
<P>
If an program file (a file with an .exe file name extension) is not
successfully patched, determine which program the file is associated with
and remove and reinstall the program. To do this, follow these steps:

<OL><P><LI>On the Start menu, point to Settings, and then click Control Panel.

<P><LI>Double-click Add/Remove Programs. In the list of installed programs,
    click Microsoft Office 97, and then click Add/Remove. If you installed
    Office from a compact disc, you are prompted to insert the first disc.
<P>
    If a dialog box appears with a message that programs are running,
    quit these programs, and then click OK.

<P><LI>In the Office 97 Setup dialog box, click Add/Remove.
<P>
    A list of the Office 97 components is displayed.

<P><LI>Click to clear the check box for the program that the patch failed to
   update. For example, if the patch failed to update the Excel.exe file,
   clear the check box next to the Microsoft Excel component.
<P>
</OL>If the patch failed to update a file other than a program file, replace the
file on your hard disk with a new copy of the file from the Office 97
compact disc.
<P>
<P><h3>Ensure That System Requirements Are Met</h3>
 
<P>
The Office 97 SR-1 Patch requires the following service packs to be
installed before you run it:

<UL><LI>For computers running Microsoft Windows NT Workstation version 3.51 or
   Windows NT Server 3.51, install service pack 5.

<LI>For computers running Microsoft Windows NT Workstation 4.0 or Windows NT
   Server 4.0, install service pack 2 or later.

<LI>No service pack is required for computers running Microsoft Windows 95.
<P>
</UL>For more information about installing Windows NT service packs, see the
Microsoft Windows NT Server Technical Support page at the following Web
site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/ntserversupport/content/servicepacks">http://www.microsoft.com/ntserversupport/content/servicepacks</A></B>
   /default.htm

</PRE></OL>NOTE: Because the Microsoft Web sites are constantly updated, the site
addresses may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE>The SR-1 Patch requires 32 megabytes (MB) of disk space to run (25 MB if
you run the SR1Off97.exe file from compact disc or floppy disk). The patch
adds up to 8 MB of files to your hard disk. The hard disk space that is
required is listed in the following table.
<P>
<PRE>   These files                             Use this disk space
   -----------------------------------------------------------

   Installer program (Sr1off97.exe)                       7 MB
   Expanded files                                        15 MB
   Temporary files used during installation              10 MB
   Updated Office files that remain after installation    8 MB

</PRE>The expanded and temporary files, which are placed in a Windows temporary
folder, are removed after the patch is finished. The updated Office files
remain on the disk after you restart the computer.
<P>
<P><h3>Start Windows in Safe Mode</h3>
 
<P>
Windows 95 has a built-in troubleshooting mode called Safe mode. It
bypasses startup files and uses only basic system drivers, including basic
networking. When you start Windows in Safe mode, Windows uses only the
mouse, keyboard, and standard video graphics adapter (VGA) device drivers.
This makes Safe mode useful for isolating and resolving error conditions
that are caused by both real-mode and Windows-based drivers. Windows 95
also has troubleshooting features that may help you identify the problem.
To start Windows 95 in Safe mode and make the additional troubleshooting
features available, use the following steps:

<OL><P><LI>In the Control Panel, double-click the System icon, and then click the
   Performance tab.

<P><LI>Click File System, and then click the Troubleshooting tab.

<P><LI>Click the following check boxes to select them:
<P>
<P><PRE>      Disable protect-mode hard disk interrupt handling
      Disable synchronous buffer commits
      Disable all 32-bit protect-mode disk drivers
      Disable write-behind caching for all drive
</PRE>
<P><LI>Click OK, click Close, and then click Yes.

<P><LI>Press F8 when you see the "Starting Windows 95" message.

<P><LI>On the Windows Startup menu, select option 3 (Safe Mode).

<P><LI>After Windows is running again, attempt to apply the Patch again.
<P>
</OL><h3>Check for a Valid Temporary Folder and Excess Temporary Files</h3>
 
<P>
There should be at least 3 MB of free space on the hard disk that contains
the temporary folder. To check for a temporary folder and clear excess
files from that folder, follow these steps:

<OL><P><LI>Restart your computer. Press the F8 key when you see the "Starting
   Windows 95" message, and then choose "Safe mode command prompt only."

<P><LI>Type "set" (without the quotation marks) and press ENTER. Note the
   location of the TEMP variable.

<P><LI>Change to the folder noted in step 2. For example, if TEMP is set
   to C:\WINDOWS\TEMP, type the following line and then press ENTER:
<P>
<P><PRE>      cd\windows\temp
</PRE><P>
   If the folder noted in step 2 does not exist, you must create the
   folder. For example, you can create a temporary folder called win95tmp
   on your hard disk by typing the following line at the command prompt:
<P>
<P><PRE>      md c:\win95tmp
</PRE>
<P><LI>Delete any temporary files in this folder. Temporary files typically
   have a .tmp extension. To delete these files, type the following line
   and then press ENTER:
<P>
<P><PRE>      del *.tmp
</PRE><P>
   NOTE: Do not delete these files from within the Windows 95 graphical
   user interface (that is, when you are running Windows 95) because
   Windows 95 or a Windows program may be using one of these files.
<P>
</OL><h3>Check Permissions on an NT File System</h3>
 
<P>
If you are running the Windows NT 4.0 operating system and you are using
the NT File System (NTFS), you must have administrative permissions to the
computer. Administrative permissions include permissions to read, write,
create, delete, and rename files. For information about changing
permissions under Windows NT, please consult your operating system
documentation.
<P>
<P><h3>Close Unnecessary Memory-Resident Programs</h3>
 
<P>
Programs that run in the background in memory are called terminate-and-
stay-resident programs (TSRs). For example, these programs may be virus
protection software, utility programs, print manager programs, or screen
savers. To determine if a terminate-and-stay-resident program is running,
follow these steps:

<OL><P><LI>Display the Close Program window (the task list) by pressing
   CTRL+ALT+DEL.
<P>
   Only Systray and Explorer should appear in the list.

<P><LI>Close any program other than Systray or Explorer in the Close Program
   list by clicking the program and clicking End Task.

<P><LI>If you close a program and want to close another one, press CTRL+ALT+DEL
   to display the Close Program window again. Repeat steps 1 through 3
   until you close all programs except Systray and Explorer.
<P>
</OL>After all TSRs are closed, run the patch.
<P>
<P><h3>Determine Whether You Are Using the Correct Patch</h3>
 
<P>
Verify that you are using the Office 97 SR-1 Patch; the Office 97 SR-1
Patch installer program is the Sr1off97.exe file.
<P>
Using the incorrect patch version causes an error message to appear. For
example, running the Office 97 SR-1 Patch Update (Sr1offup.exe) before you
run the Office 97 SR-1 Patch causes the following error message to appear
during installation:
<P>
<PRE>   Microsoft Word 97 SR-1
   The patch has determined that your installation of Office cannot be
   updated at this time.  Shut down all running applications and re-run the
   patch, if the problem persists please consult the Microsoft Knowledge
   Base at <B><A href="http://www.microsoft.com/kb">http://www.microsoft.com/kb.</A></B>

</PRE></OL>NOTE: This address has changed to the following:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/default.asp">http://support.microsoft.com/support/default.asp</A></B>

</PRE>If you check the log file (see the "Check the Log File" section in this
article) that is created when you run the patch, the contents of the file
indicate the version that you ran. For example, the version for the SR-1
Patch Update is 1.0.0169. When the error message appears, the contents of
the log file is similar to the following:
<P>
<PRE>   Patch EXE version is:
   Version 1.0.0169
   Office location confirmed
   Office location: D:\office 97\Office
   System Dir: C:\WINNT4\System32
   No office apps currently running

   Checking for Installed Office apps:
   Located Microsoft Word 97 at D:\OFFICE~1\Office
   winword.exe is a different VERSION
   The patch has determined that your installation of Office cannot be
   updated at this time.  Shut down all running applications and re-run the
   patch, if the problem persists please consult the Microsoft Knowledge
   Base at <B><A href="http://www.microsoft.com/kb">http://www.microsoft.com/kb.</A></B>

</PRE>NOTE: This address has changed to the following:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/default.asp">http://support.microsoft.com/support/default.asp</A></B>

</PRE>If you use the correct version of the patch, the version in the log file is
1.1.0167.
<P>
For information on obtaining the correct version of the Office 97 SR-1
Patch, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q172475.htm">Q172475</A></B>
   TITLE     : OFF97: How to Obtain and Install MS Office 97 SR-1

</PRE><h3>Check for Beta Software</h3>
 
<P>
When you use beta software, you use a pre-release version of software
that has not been thoroughly tested by Microsoft. This software may
contain newer versions of untested files that may conflict with the Office
97 SR-1 Patch. Remove all beta software from your computer before you run
the Office 97 SR-1 Patch. For information about removing beta software from
your computer, contact the program vendor for the software.
<P>
If you install the Beta 1 version of Microsoft Internet Explorer 4.0 and
install the Office 97 SR-1 Patch, the following error message appears when
you start the computer:
<P>
<PRE>   Microsoft (R) Windows NT (TM) Version 4.0 (Build 1381: Service Pack 3).
   1 System Processor [32 MB Memory]
   ...
   STOP: c0000221 {Bad Image Checksum}
   The image HLINK.DLL is possibly corrupt. The header checksum does not
   match the computed checksum.

   Restart and set the recovery options in the system control panel or the
   /CRASHDEBUG system start option. If this message reappears, contact
   your system administrator or technical support group.

</PRE>After you receive this error message, you cannot restart Microsoft Windows
NT and use your computer.
<P>
For more information about this problem, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: OFF97: STOP HLINK.DLL Error After Installing SR-1
   TITLE     : <B><A href="../office/q172355.htm">Q172355</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sr1 sr-1 tshoot 97 off97<BR>
Keywords          : OffWinSetup kbsetup<BR>
Version           : WINDOWS:97SR1<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto kbtshoot kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
