

<HTML>
<HEAD>
<TITLE>OFF97: Registry Keys Remain If Mso97.dll Is Loaded During Setup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165757">
<META NAME="KBModify" CONTENT="1997/04/07">
<META NAME="KBCreate" CONTENT="1997/03/25">
<META NAME="Keywords" CONTENT="kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; office, convert, crossnet, odbc, access, word, excel, powerpt, outlook, winprint, setup, exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   After you perf...">
<META NAME="Product" CONTENT="Office">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDKX,QAEF,QBWS,QAA1,QBJ4,QBJZ,QDH3,QDKD,QA9N,QDH6,QANJ,QAGB,QDL9,QDI2,QBWO P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OFF97: Registry Keys Remain If Mso97.dll Is Loaded During Setup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165757</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Office 97 for Windows
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you perform a maintenance mode installation of Microsoft Office 97 
and remove all the Office components, some registry subkeys may remain in 
the registry. Subkeys under HKEY_LOCAL_MACHINE\Software\Microsoft\Office 
that are not removed are the following:
<P>
<PRE>   My Computer\HKLM\SOFTWARE\Microsoft\Office\8.0\BinDirPath

   -and-

   My Computer\HKLM\SOFTWARE\Microsoft\Office\8.0\Common\InstallRoot\
      OfficeBin

</PRE><h2>CAUSE</h2>
 
<P>
This behavior may occur if the file Mso97.dll is loaded into memory when 
you run Microsoft Office Setup. Mso97.dll may be in memory if a Microsoft 
Office program unexpectedly quits.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent this problem from occurring, restart Microsoft Windows to clear
files from memory when a program unexpectedly quits. Restart Windows before
you install or remove any program.
<P>
For information about removing the registry keys manually, see the
"Removing the Two Registry Keys Manually" section in this article.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
<P><h3>Removing the Two Registry Keys Manually</h3>
 

<OL><P><LI>On the Start menu, click Run. In the Open box, type "regedit" (without
   the quotation marks), and then click OK.

<P><LI>In the Registry window, click the plus sign (+) to the left of the
   following keys, in order
<P>
<P><PRE>      HKEY_LOCAL_MACHINE
      SOFTWARE
      Microsoft
      Office
</PRE><P>
   to open the following key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\software\Microsoft\Office
</PRE><P>
   Then, click the folder to the left of 8.0. The following key appears
   in the status bar:
<P>
<P><PRE>      My Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\8.0
</PRE>
<P><LI>To delete the entire 8.0 key, click Delete on the Edit menu, and then
   click Yes to delete the key.
<P>
   To remove the only BinDirPath key, click BinDirPath under the Name
   column on the right side of the window. Then, click Delete on the Edit
   menu, and then click Yes.

<P><LI>In the Registry window, click the plus sign (+) to the left of the
   following keys, in order
<P>
<P><PRE>      HKEY_LOCAL_MACHINE
      SOFTWARE
      Microsoft
      Office
      8.0
      Common
</PRE><P>
   to open the following key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\Software\Microsoft\Office\8.0\Common
</PRE><P>
   Then, click the folder to the left of InstallRoot. The following key
   appears in the status bar:
<P>
<P><PRE>      My Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\8.0\
      Common\InstallRoot
</PRE>
<P><LI>To delete the entire InstallRoot key, click Delete on the Edit menu, and
   then click Yes.
<P>
   To remove only the OfficeBin key, click OfficeBin under the Name column
   on the right side of the window. Click Delete on the Edit menu and click
   Yes.

<P><LI>On the Registry menu, click Exit.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products
listed at the beginning of this article. We are researching this problem
and will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Before this problem occurs, Microsoft Office 97 Setup displays a message
that warns you that Mso97.dll is open and that the file is not removed when
you click Remove All. If you click Ignore, the file is removed but the
registry keys remain.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: OFF97 OFF97<BR>
Keywords            : kbsetup<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
