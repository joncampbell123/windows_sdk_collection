

<HTML>
<HEAD>
<TITLE>HOWTO: Send a Data Recordset Using MSMQ Message Body </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179575">
<META NAME="KBModify" CONTENT="1998/03/11">
<META NAME="KBCreate" CONTENT="1998/01/20">
<META NAME="Keywords" CONTENT="kbcode MQProg">
<META NAME="KBArea" CONTENT="Support; KB; msmq">
<META NAME="Description" CONTENT="  Using Microsoft Message Queue Server (MSMQ) and Microsoft Remote Data Service (RDS), you can send and receive a data recordset using MSMQ message body.   MORE INFORMATION  Follow these steps to run the code example below:  1. Install Remote Data Se...">
<META NAME="Product" CONTENT="msmq">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAEV,QANF,QAVX,QBVX,QBXS,QAYY,QABM,QAYC,QAE1,QAW6,QAPN,QANN,QAH4,QACK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Send a Data Recordset Using MSMQ Message Body</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179575</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Message Queue Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using Microsoft Message Queue Server (MSMQ) and Microsoft Remote Data
Service (RDS), you can send and receive a data recordset using MSMQ message
body.
<P>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Follow these steps to run the code example below:

<OL><P><LI>Install Remote Data Service (RDS) 1.5 from this Web address:
<P>
<P><PRE>      <B><A href="http://www.microsoft.com/data/rds/">http://www.microsoft.com/data/rds/</A></B>
</PRE>
<P><LI>Add references to Microsoft Message Queue Server (MSMQ), the ActiveX
   Data Objects (ADO) 1.5 Object Library, and Remote Data Service (RDS)
   Object Libraries in your Visual Basic project. The sample opens a
   connection to the SQL Server pubs database on your computer. You can
   modify the code to use other databases.
<P>
<P>
<P><PRE>      Private Sub Form_Load()
      Dim rs As ADOR.Recordset
      Dim sql As String
      Dim dataFactory As Object
</PRE><P>
<P><PRE>      Dim qinfo As New MSMQQueueInfo
      Dim mSend As New MSMQMessage
      Dim mReceive As MSMQMessage
      Dim qSend As MSMQQueue
      Dim qReceive As MSMQQueue
</PRE><P>
<P><PRE>      qinfo.PathName = ".\RecordsetQ"
      qinfo.Label = "My Recordset Queue"
      On Error Resume Next  ' ignore if the queue already exists
      qinfo.Create
</PRE><P>
<P><PRE>      Set qSend = qinfo.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)
</PRE><P>
<P><PRE>      Set dataFactory = CreateObject("AdvancedDataFactory")
</PRE><P>
<P><PRE>      sql = "select * from authors"
      Set rs = dataFactory.query("driver={SQL
      Server};SERVER=.;database=pubs;uid=sa;pwd=", sql)
</PRE><P>
<P><PRE>      mSend.Label = "Testing Recordset"
      mSend.Body = rs
      mSend.Send qSend
      qSend.Close
</PRE><P>
<P><PRE>      MsgBox "Message sent with Recordset"
</PRE><P>
<P><PRE>      Set qReceive = qinfo.Open(MQ_RECEIVE_ACCESS, MQ_DENY_NONE)
</PRE><P>
<P><PRE>      Set mReceive = qReceive.Receive
      Set rs = mReceive.Body
      Debug.Print rs(0) ' print column 1
      Debug.Print rs(1) ' print column 2
      Debug.Print rs(2) ' print column 3
      rs.movenext
      Debug.Print rs(0) ' print column 1
      Debug.Print rs(1) ' print column 2
      Debug.Print rs(2) ' print column 3
</PRE><P>
<P><PRE>      End Sub
</PRE><P>
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Message Queue Server SDK Help.
<P>
Remote Data Service (RDS) documentation located at this Web address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/data/rds/">http://www.microsoft.com/data/rds/</A></B>

</PRE></OL> 
<PRE>Keywords          : kbcode MQProg
Version           : WINNT:1.0
Platform          : winnt
Hardware          : ALPHA x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
