

<HTML>
<HEAD>
<TITLE>HOWTO: How to Write an MSMQ Trigger Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173325">
<META NAME="KBModify" CONTENT="1998/01/28">
<META NAME="KBCreate" CONTENT="1997/08/29">
<META NAME="Keywords" CONTENT="kbprg MQProg kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; msmq">
<META NAME="Description" CONTENT="  Microsoft Message Queue Server (MSMQ) does not come with  trigger  functionality for queues. A  trigger  is a software component that monitors a queue for a certain condition and performs some action when that condition is met. Currently, trigger f...">
<META NAME="Product" CONTENT="msmq">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATP,QALX,QAM9,QBWP,QAY5,QAU3,QAMR,QAPF,QAEV,QBS0,QBKX,QBVV,QA8T,QAYC,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: How to Write an MSMQ Trigger Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 28, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173325</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Message Queue Server, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Message Queue Server (MSMQ) does not come with "trigger"
functionality for queues. A "trigger" is a software component that monitors
a queue for a certain condition and performs some action when that
condition is met. Currently, trigger functionality must be implemented in
the application. The MSMQ software development kit (SDK) provides
documentation on how to use notification events to provide asynchronous
handling of messages, which is one kind of trigger functionality. However,
you can also use Performance Monitor counters to monitor for triggering
conditions. This article points you to a sample application that shows you
how to write a trigger using a Performance Monitor counter.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The sample, "MQTrigger," is written in Visual Basic and C++. It uses a
timer event to periodically poll a Performance Monitor counter for a
message count. The sample application displays a dialog box when the
message count in a queue reaches the threshold.
<P>
Note that monitoring through counters limits you to the functionality of
the counters. For example, counters operate locally only, so MQTrigger will
not access the queues on a remote computer. MSMQ Performance Monitor
counters are limited to showing 64 queues. Also, the sample does not run
under Windows 95 because it relies on the Windows NT Performance Monitor
counters.
<P>
Triggering on changes other than those that can be measured through a
counter will require different implementations.
<P>
For more information on asynchronous notification, see the online Help in
the MSMQ SDK.
<P>
The sample application is located at:
<P>
<PRE>   <B><A href="ftp://ftp.microsoft.com/bussys/distapps/msmq/samples/1.0/mqtrigger.exe">ftp://ftp.microsoft.com/bussys/distapps/msmq/samples/1.0/mqtrigger.exe</A></B>

</PRE><h2>REFERENCES</h2>
 
<P>
For more information on Performance Monitor, see the "Optimizing Windows
NT" volume of the Windows NT 3.51 Resource Kit.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Perfmon app<BR>
Keywords          : kbprg MQProg kbfaq<BR>
Version           : WINDOWS NT:1.0<BR>
Platform          : winnt<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 28, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
