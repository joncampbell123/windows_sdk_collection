

<HTML>
<HEAD>
<TITLE>HOWTO: Using MSMQ ActiveX Components from Java </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173340">
<META NAME="KBModify" CONTENT="1998/01/28">
<META NAME="KBCreate" CONTENT="1997/09/01">
<META NAME="Keywords" CONTENT="MQProg kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; msmq">
<META NAME="Description" CONTENT="  Using Microsoft Message Queue Server (MSMQ) ActiveX components from Java is similar to using any other ActiveX objects from the Java environment. Following are the basic  getting started  steps with Java and MSMQ ActiveX components.  MORE INFORMATI...">
<META NAME="Product" CONTENT="msmq">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXF,QAHV,QAY2,QABI,QAPN,QBWA,QA56,QA55,QA5F,QAMA,QBWS,QAT7,QASR,QAIK,QAJG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Using MSMQ ActiveX Components from Java</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 28, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173340</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Message Queue Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using Microsoft Message Queue Server (MSMQ) ActiveX components from Java is
similar to using any other ActiveX objects from the Java environment.
Following are the basic "getting started" steps with Java and MSMQ ActiveX
components.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>How to Use ActiveX Components from Microsoft Visual J++ 1.1</h3>
 
<P>
"Using Java and COM" topic in Visual J++ Books Online describes how to use
COM with Java. Visual J++ 1.1 includes several Java/COM samples.
<P>
<P><h3>What MSMQ ActiveX Components are Available</h3>
 
<P>
Read the information in MSMQ SDK, especially the following topics:

<UL><LI>MSMQ Guide\MSMQ ActiveX Support
<LI>Using MSMQ\Using the ActiveX Components
<P>
</UL><h3>How To Create an MSMQ Application Using Java Applet Wizard</h3>
 
<P>
Here are the basic "getting started" steps with Java and MSMQ ActiveX
components using Microsoft Visual J++ 1.1, which is included with Microsoft
Visual Studio 97. This project shows how to create an MSMQ queue using Java
code:

<OL><P><LI>Create a basic Visual J++ project using Java Applet Wizard. Select "As
   an applet only" in Step 1, "HTML file" in Step 2, "multi-threaded" and
   "no animation" in Step 3, and then click Finish.
<P>
   This creates two source files in the project. One is a .java file for
   the java class and the other is an .html file for VBScript (given
   below):
<P>
<P><PRE>      &lt;html&gt;
      &lt;head&gt;
      &lt;title&gt;MQJava&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
      &lt;hr&gt;
      &lt;applet
<PRE></PRE>          code=MQJava.class
          name=MQJava
          width=320
          height=240 &gt;
      &lt;/applet&gt;
      &lt;hr&gt;
      &lt;a href="mqjava.java"&gt;the source.&lt;/a&gt;
      &lt;/body&gt;
      &lt;/html&gt;

</PRE><P><LI>Run "Java Type Library Wizard" on "Microsoft Message Queue Object
   Library":
<P>
   The MSMQ installation program creates the registry entries for MSMQ
   ActiveX components and interfaces so that the typelib gets registered.
   Before building the project, make sure you run the Java Type Library
   Wizard from the Tools menu in DevStudio IDE. Select "Microsoft Message
   Queue Object Library" from the list, which creates the .class files in
   your Winnt\Java\Trustlib\Mqoa folder. The folder also contains a
   Summary.txt file that contains information about the Java classes
   derived from the information in the typelib. Make sure you use the
   method names given in this file for the interface you are using.

<P><LI>Include the following lines near the top of your .java file created by
   the wizard:
<P>
<P><PRE>      import mqoa.* ;
      import com.ms.com.Variant;
</PRE>
<P><LI>Add the following method to create an MSMQ queue:
<P>
<P><PRE>      public void CreateQueue()
<PRE></PRE>         {
            Variant isTransactional;
            Variant isWorldReadable;
            IMSMQQueueInfo qinfo = (IMSMQQueueInfo)new MSMQQueueInfo();
            qinfo.putPathName(".\\qJava");
            isTransactional = new Variant();
            isTransactional.putBoolean(false);
            isWorldReadable = new Variant();
            isWorldReadable.putBoolean(false);
            qinfo.Create(isWorldReadable, isTransactional);
         }

</PRE></OL>Call the method CreateQueue() from Init() method and run MSMQ Explorer to
verify that the queue has been created. If the queue already exists (if you
run it twice), you will get a Java exception dialog box on the Web page.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, see the following topics in MSMQ SDK:

<UL><LI>"MSMQ Guide'\MSMQ ActiveX Support"
<LI>"Using MSMQ'\'Using the ActiveX Components"
<P>
</UL>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Syed
Yousuf,  Microsoft Corporation
 
<PRE>Keywords          : MQProg kbfaq
Version           : WinNT:1.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 28, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
