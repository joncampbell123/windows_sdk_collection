

<HTML>
<HEAD>
<TITLE>PUB98: Artgalry.dll Is Unable to Register Itself </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182118">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1998/03/05">
<META NAME="Keywords" CONTENT="kbgraphic kbole kbdta kbclip">
<META NAME="KBArea" CONTENT="Support; KB; oleapps">
<META NAME="Description" CONTENT=" WARNING: The information in this article has not been confirmed or tested by Microsoft. Some or all of the information in this article has been taken from unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS AT...">
<META NAME="Product" CONTENT="OLE in Applications">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2R,QAA1,QAH4,QBWS,QASR,QDI2,QAUJ,QAB4,QDIZ,QDNN,QBT9,QBQU,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PUB98: Artgalry.dll Is Unable to Register Itself</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182118</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Publisher 98
<LI>Microsoft Clip Gallery 4.0 for Windows
</UL> 
<P>
WARNING: The information in this article has not been confirmed or tested by
Microsoft. Some or all of the information in this article has been taken from
unconfirmed customer reports. ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS
ARTICLE IS AT YOUR OWN RISK. Microsoft provides this information "as is" without
warranty of any kind, either express or implied, including but not limited to
the implied warranties of merchantability and/or fitness for a particular
purpose.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run the Microsoft Publisher 98 Setup program, you may encounter the
following error near the end of the installation process:
<P>
<PRE>   Artgalry.dll is unable to register itself in the Registry.

</PRE>This message may be followed by:
<P>
<PRE>   Setup did not complete successfully.

</PRE><h2>CAUSE</h2>
 
<P>
This problem may appear in either of the following situations:

<UL><LI>An application or terminate-and-stay-resident (TSR) program was running
   while you ran the Publisher 98 setup program.
<P>
</UL>-or-

<UL><LI>Certain core dynamic link libraries (DLL) files have been replaced by
   versions that are not compatible with the Publisher Setup program.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this behavior, follow these steps.
<P>
NOTE: These steps are ordered so that each step is built upon the previous step.
If step 1 does not resolve the problem, go to step 2 and continue
troubleshooting. After you complete step 2, go back and repeat step 1.
<P>
<P><h3>Step 1: Disable TSRs and Rerun Setup</h3>
 
<P>
Rerun setup after you close any applications or TSR programs, by following these
steps:

<OL><P><LI>Restart Windows 95, by following these steps:
<P>
   a. On the Windows Start menu, click Shut Down.
<P>
   b. Click Restart The Computer and then click OK.

<P><LI>Close any open programs.

<P><LI>Press CTRL+ALT+DEL. This will open the Close Program dialog box.

<P><LI>In the Close Program dialog box, select any item (except Explorer
   and Systray), and click End Task. Repeat steps 3 and 4 until
   Systray and Explorer are the only items listed in the Close Program
   dialog box.
<P>
   NOTE: In some cases Windows may display a dialog box indicating that the
   application is not responding. If you see this dialog box, click End
   Task.

<P><LI>Rerun the Publisher Setup program.
<P>
</OL>If you went through Step 1 and you are still receiving this error while trying
to install Publisher, certain core dynamic link library (dll) files may be
preventing setup from successfully registering the shared ClipArt Gallery
component. The actual DLL that is causing this error may from one computer to
another. Each component is addressed in a separate setup procedure.
<P>
<P><h3>Step 2: Rename the Artgalry.dll File</h3>
 
<P>
Rename the Artgalry.dll file and then rerun the Publisher Setup program.

<OL><P><LI>On the Windows Start menu, point to Programs, and then click Windows
   Explorer.

<P><LI>Click the Artgalry.dll file. By default, ;you can find this file in the
   c:\Program Files\Common Files\Microsoft Shared\Artgalry folder.

<P><LI>On the File menu, click Rename.

<P><LI>Rename the artgalry.dll file to artgalry.old.

<P><LI>Rerun the Publisher Setup program.
<P>
</OL><h3>Step 3: Rename the Msvcrt20.dll File</h3>
 
<P>
Rename the Msvcrt20.dll and rerun the Publisher Setup program.

<OL><P><LI>If any programs are currently running, close them.

<P><LI>Rename the Msvcrt20.dll file using these steps:
<P>
<P><PRE>    a. On the Windows Start menu, point to Find, and then click
       Files Or Folders.
</PRE><P>
<P><PRE>    b. In the Named box, type:
</PRE><P>
<PRE>          Msvcrt20.dll

    c. Click Find Now.

    d. Right-click Msvcrt20.dll and then click Rename. Change the name to
       something like Msvcrt20.old.

       NOTE: If you are running any programs that are using the
       Msvcrt20.dll, you will receive this error message:

          Cannot rename Msvcrt20.dll: Access is denied.

          Make sure the disk is not full or write-protected and that the
          file is not currently in use.

       If you receive this error message, follow these additional steps:

       1) On the Start menu, click Shut Down.

       2) In the Shut Down Windows dialog box, click "Restart in MS-DOS
          mode" and then click Yes. You should see a blank screen with
          an MS-DOS prompt similar to this:

             c:\windows&gt;

       3) Type the following:

             cd system

          and then press ENTER.

       4) Type the following:

             ren msvcrt20.dll msvcrt20.old

          and then press ENTER.

       5) Type the following:

             exit

          and then press ENTER. Windows 95 will restart.

       6) If you receive any kind of "error starting program" or
          "can't find required .dll" error message, click OK to bypass
          them.

</PRE><P><LI>Rerun Publisher setup.
<P>
</OL><h3>Step 4: Rename the Picstore.dll File</h3>
 
<P>
Rename the picstore.dll and rerun setup.

<OL><P><LI>If any programs are currently running, close them.

<P><LI>Rename the picstore.dll file using these steps:
<P>
<P><PRE>    a. On the Windows Start menu, point to Find, and then click
       Files or Folders.
</PRE><P>
<P><PRE>    b. In the Named box, type:
</PRE><P>
<PRE>          picstore.dll

    c. Click Find Now.

    d. Right-click the Picstore.dll file and then click Rename.
       Change the name to something like Picstore.old.

</PRE><P><LI>Rerun Publisher setup.
<P>
</OL>If you still encounter the error, replace the Msvcrt20.dll, Msvcrt40.dll, and
Mfc40.dll files using the procedure described in the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q157146.htm">Q157146</A></B>
   TITLE     : PUB97: ACMSETUP Caused a General Protection Fault in
               Mfc40.dll

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about registering Clip Gallery, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../oleapps/q134863.htm">Q134863</A></B>
   TITLE     : How to Reregister Shared Programs in Office 95 &amp; 97
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: clipart gallery clips cag artgalery 98 pub98 mspub98<BR>
pub_98 5.00 publisher98 pub5 ms_pub98 mspub<BR>
Keywords          : kbgraphic kbole kbdta kbclip<BR>
Version           : WINDOWS:4.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
