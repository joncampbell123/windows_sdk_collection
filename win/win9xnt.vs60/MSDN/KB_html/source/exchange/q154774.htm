

<HTML>
<HEAD>
<TITLE>XCLN: Exchange Client Inbox Assistant Rules FAQ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154774">
<META NAME="KBModify" CONTENT="1997/06/10">
<META NAME="KBCreate" CONTENT="1996/08/14">
<META NAME="Keywords" CONTENT="kbenv kbusage XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Rules are set using either the Inbox Assistant or the Out Of Office Assistant options from the Tools menu in any of the Microsoft Exchange clients for Windows while connected to a Microsoft Exchange Server. Each rule consists of two elements: one o...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QAIB,QDJ2,QBMI,QAEF,QAYC,QAEV,QADB,QAPN,QAGB,QBW4,QBCT,QAGC,QAFI,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Exchange Client Inbox Assistant Rules FAQ</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154774</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 95 client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows NT client, versions 4.0 and 5.0
</UL> 
<P>
SUMMARY
 
<P>
Rules are set using either the Inbox Assistant or the Out Of Office
Assistant options from the Tools menu in any of the Microsoft Exchange
clients for Windows while connected to a Microsoft Exchange Server. Each
rule consists of two elements: one or more conditions that specify which
items the Rule applies to, and one or more actions that specify what to do
with a qualifying item.
<P>
When a rule is created, it is stored on the Microsoft Exchange Server,
including any template messages for replies. When a message arrives, the
Microsoft Exchange Server evaluates the message and determines if it has
fulfilled any rules criteria. If it does, the Microsoft Exchange Server
will then process the message according to the rule action.
<P>
Rules are Microsoft Exchange Server based and are executed on the Microsoft
Exchange Server even if the user is not logged into mail. If the Microsoft
Exchange Server is not able to execute a rule (for example: moving mail to
a local folder when the user is not logged on to the server) a Deferred
Action Message (DAM) is created which is used to complete the action when
the client reconnects to the Microsoft Exchange Server.
<P>
Rules which require deferred actions are determined at the time the rule is
created. When the DAM is received on the client, it is evaluated by the
client and the requested action is performed. The DAM is then deleted. When
a message arrives at the Microsoft Exchange Server it is evaluated
independently against ALL existing Rules before any action is taken. Then
all Rules that apply to the item are executed.
<P>
MORE INFORMATION
 
<P>
Q: Are Inbox rules related to the profile that was used to create them? A:
There are 2 types of Inbox rules: Profile Dependent and Profile
Independent:
<P>
<PRE>   Profile Dependent: Otherwise known as Profile Specific rules. These
                      rules will be executed only when logged into
                      Microsoft Exchange with the profile that created the
                      rule. Any one of the following actions in a rule make
                      that rule Profile Dependent:

                     - Alert With (New Items of Interest  dialog)
                     - Move/Copy To a folder in a Personal Store (PST)
                     - Move/Copy To a Public Folder
                     - Custom Action

</PRE>NOTE: Each Microsoft Exchange profile that is created, no matter what the
<PRE>      name, has a unique ID number assigned to it. If two profiles have the
      same name, they are still unique profiles.

   Profile Independent: Otherwise known as Server Specific rules. These
                        rules are available for editing, appear black, and
                        their actions take place regardless of the profile.
                        Any one of the following actions in a rule make
                        that rule Profile Independent:

                       - Forward To
                       - Reply With Template
                       - Delete
                       - Move/Copy To a Microsoft Exchange Server Private
                         Store folder.

</PRE>Q: What determines whether a particular rule will be Profile Dependent or
<PRE>   Profile Independent?
</PRE>A: It only takes one Profile Dependent action in a rule to make the whole
<PRE>   rule Profile Dependent.

</PRE>Q: Why are some Inbox Rules grayed out or unavailable?
A: Each Profile Dependent rule is stamped with the unique ID of the profile
<PRE>   that created the rule. Profile Dependent rules can only be edited when
   logged in with the same profile that was used to create the rule. Again,
   this is determined by the Unique ID. These rules become inactive and
   uneditable when you log on with a different profile or from another
   computer. They are the rules that appear gray in the Inbox Assistant
   window.

</PRE>Q: How do you edit rules that are grayed out or unavailable?
A: To edit Profile Dependent rules, you must be logged into Microsoft
<PRE>   Exchange with the profile that was used to create the rule.

</PRE>Q: What if a profile gets deleted that has Profile Dependent rules created
<PRE>   against it?
</PRE>A: If you create a Profile Dependent rule and then delete that profile, the
<PRE>   rule becomes deadwood - it can't be activated or edited, just deleted by
   selecting the Show Rules for all Profiles option. Because of this,
   Profile Dependent rules should be deleted if the originating profile is
   deleted or no longer used.

</PRE>Q: Can rules be copied from one profile to another?
A: You can backup profile rules to a separate .PST file, send that PST to
<PRE>   another user, and have them extract the rules in that PST. For
   additional information, please see the following article in the
   Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../exchange/q150303.htm">Q150303</A></B>
      TITLE     : XCLN: How to Backup Profile Rules to a Different .PST

</PRE>Q: How many rules can exist in a single profile?
A: There is a 32k memory limit for creation of rules, not a defined limit
<PRE>   for the maximum number of rules that can be assigned to a folder. On the
   average it is between 40 and 50 rules per folder. For additional
   information, please see the following article in the Microsoft Knowledge
   Base:

      ARTICLE-ID: <B><A href="../exchange/q147298.htm">Q147298</A></B>
      TITLE     : XCLN: Maximum Number of Rules Per Folder

</PRE>Q: What happens to Profile Dependent rules when logging in with a different
<PRE>   profile?
</PRE>A: All rules are stored on the Microsoft Exchange Server and are evaluated
<PRE>   on the Microsoft Exchange Server for each message sent to a user. If a
   Profile Dependent rule cannot be performed by the Microsoft Exchange
   Server, it creates a Deferred Action Message (DAM) to be processed by
   the client. The DAMs are marked with the ID of the profile that was used
   to create them, and are only processed when that profile is used. When
   you logon, all the DAMs are analyzed to see if they have the correct ID
   for the current profile, and, if they do, the DAMs are processed. If
   not, they are left in the folder that stores them, a hidden folder
   called the Deferred Actions Folder (DAF), and are analyzed each time you
   logon until you logon to the profile that created them and they can be
   processed.

</PRE>Q: How long will DAMs remain in the Deferred Action Folder due to an unused
<PRE>   or deleted profile?
</PRE>A: Even though they are gray and inaccessible, the rules are still being
<PRE>   analyzed by the Microsoft Exchange Server and are still creating DAMs
   for use when the correct (or matching) profile is used (where they will
   not be gray and will be editable). And they'll keep being triggered even
   if the profile is destroyed because there is no way for the Microsoft
   Exchange Server to tell if the profile still exists. This can cause a
   large backlog of DAMs that eventually will be removed by the Microsoft
   Exchange Server (after 60 days, when the Microsoft Exchange Server will
   disable the rules and start deleting old DAMs), and, if the backlog is
   large enough, it can impact performance while logging on. So if you end
   up deleting/recreating one of your profiles, or never using it again,
   delete the gray rules associated with it.

</PRE>Q: Where are Microsoft Exchange profiles stored for each of the Microsoft
<PRE>   Exchange clients?
</PRE>A: Microsoft Exchange profiles are stored in your computer's registry, not
<PRE>   on the Microsoft Exchange server. The Microsoft Exchange client for
   Windows 3.x stores them in a special file in the Windows directory.

</PRE>Q: Is a rule configured to move a message to a Public Folder considered
<PRE>   Profile Dependent or Profile Independent?
</PRE>A:  Profile Dependent, meaning that messages that will be moved to a
<PRE>   Public Folder, will require that a user be logged in to complete the
   action. Otherwise a DAM will be created for these actions.

</PRE>Q: If my computer is configured with both Windows 95 and Windows NT, can I
<PRE>   use the same profile for both operating systems?
</PRE>A: No. If you dual-boot two different operating systems, you're using two
<PRE>   different registries and hence two different profiles. The Profile
   Dependent rules you create on one side of the dual-boot won't work on
   the other side.

</PRE>Q: What happens if a single message meets the conditions of 2 or more
<PRE>   rules?
</PRE>A: Multiple rules can act on a single message resulting, in copies of a
<PRE>   message being moved to different folders for example.

</PRE>NOTE: Within the Microsoft Exchange 5.0 client Inbox Assistant, the Do not 
Process Subsequent Rules option has been added to specifically stop rule 
processing after a particular rule has fired.  
<P>
Q: Does the order in which the rules are listed have any effect on the
<PRE>   actions of the qualifying rules?
</PRE>A: Order of the rules doesn't matter except for a delete action. Once the
<PRE>   message is deleted with a delete action, all subsequent rule processing
   on that message stops. So when in doubt, put delete rules at the bottom
   of the rule list.

</PRE>NOTE: Within the Microsoft Exchange 5.0 client Inbox Assistant, the Do not 
Process Subsequent Rules option has been added to specifically stop rule 
processing after a particular rule has fired.  
<P>
Q: Can I use the Inbox Assistant with the MS Mail service installed on my
<PRE>   client?
</PRE>A: No, because rules are Microsoft Exchange Server based, the Inbox
<PRE>   Assistant will not be available without a Microsoft Exchange Server
   service properly installed. If the MS Mail messages are routed through
   an MS Mail Connector to a Microsoft Exchange user, the Inbox Assistant
   will function against those messages.

</PRE>Q: Are there any Boolean logic functions available for rules?
A: Semicolons can be used as an "or" condition in all fields. Put quotes
<PRE>   around each word unless you really mean use this root against all words.
   For example, Subject: cat; tail - this will affect all messages with
   those roots in the subject line such as locate, retail, and so forth. To
   limit this to whole words of cat or tail, place the words in quotes, in
   other words, Subject: "cat";"tail".

</PRE>Examples of rules processing:
<P>
Q: If a message matches a rule in the OOF (Out of Office) Assistant, but
<PRE>   the same messages also matches a Delete rule in the Inbox Assistant,
   will the OOF Assistant rule get processed?

</PRE>A: The Inbox Assistant rules will be processed first. A Delete rule in the
<PRE>   Inbox Assistant will Delete the message and the OOF Assistant rule will
   not be processed.

</PRE>User Bill has a local PST which is configured as the default delivery
point. Bill has rules defined as follows:

<OL><P><LI>If mail is received from JohnDoe, delete it.
</OL>2. If mail is received addressed to "Junk Alias" move it to Folder "Later"
<PRE>   in local PST.
</PRE></OL>3. If mail is received with "Bill" in the Message Body, move it to Folder
<PRE>   "BackItUp" on the Microsoft Exchange Server.
</PRE>4. If mail is received From Joyce addressed directly to Bill Reply with
<PRE>   "I'm working on it."

</PRE>Q: What happens if JohnDoe send a message to the Junk Alias (assuming that
<PRE>   I am on the Junk Alias)?
</PRE>A: The message will be deleted (rule #1) and no further rules will be
<PRE>   processed.

</PRE>Q: What happens if Joyce sends mail to the Junk Alias (assuming that I am
<PRE>   on the Junk Alias)?
</PRE>A: The message will be moved to the Folder "Later" (rule #2) in local PST.
<P>
Q: What happens if Joyce sends mail to the Junk Alias (assuming that I am
<PRE>   on the Junk Alias) with "Bill" in the message body?
</PRE>A: The message will be moved to the Folder "BackItUp" on the Microsoft
<PRE>   Exchange Server (rule #3) and a reply will be sent with "I'm working on
   it" as the message body (rule #4).

</PRE>Q: What happens if I receive 20 messages addressed to "Junk Alias" while my
<PRE>   computer is online?
</PRE>A: Each message will be processed through the list of rules and all actions
<PRE>   will be taken. None of the message will remain in the Inbox because the
   action (rule #2) is a MOVE action not COPY.

</PRE>Q: What happens if I receive 20 messages addressed to "Junk Alias" while my
<PRE>   computer is offline?
</PRE>A: Each message will be processed through the list of rules and DAMs will
<PRE>   be created for each action in the Profile Dependent rules. Any Profile
   Independent rules will complete their actions.

</PRE>Q: What happens if Joyce sends something directly to Bill and it has "Bill"
<PRE>   in the Message Body?
</PRE>A: The message will move it to Folder "BackItUp" (rule #3) on the Microsoft
<PRE>   Exchange Server (no copy will be left in the Inbox) and rule #4 will
   reply with "I'm working on it" as the message body.

</PRE>Q: What happens if the "Junk Alias" friendly name changes to "Junk Yard
<PRE>   Alias"
</PRE>A: The rules are processed on both resolved names (distinguished names have
<PRE>   underline) and text strings in the to: box. You can solve all the rule
   processing scenarios by indicating a distinguished name, a text version
   of the DN, and a text version of the short alias name separated by
   semicolons in the rule's to: box.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: faq<BR>
Keywords            : kbenv kbusage XCLN<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
