

<HTML>
<HEAD>
<TITLE>XCLN: How the Exchange Windows 95 Client Uses Control.glb </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148515">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1996/03/15">
<META NAME="Keywords" CONTENT="kbusage XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When you use the Microsoft Exchange client for Windows 95 to communicate with a Microsoft Mail 3.x postoffice, Control.glb is not incremented after every message sent.  MORE INFORMATION  Control.glb is an eight byte file. The first four bytes are u...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QA7O,QA5T,QAB5,QAOE,QAMN,QAKC,QARL,QAEV,QDL9,QBWQ,QBWO,QBWN,QBC6,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: How the Exchange Windows 95 Client Uses Control.glb</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148515</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange, version 4.0
<LI>Microsoft Mail for PC Networks, version 3.2, 3.5.
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use the Microsoft Exchange client for Windows 95 to communicate
with a Microsoft Mail 3.x postoffice, Control.glb is not incremented after
every message sent.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Control.glb is an eight byte file. The first four bytes are used to store a
hex number that is used to create the unique file prefix used to name all
the database files that are unique to the new user. The second four bytes
are used to store a hex number that is used to generate names for new
messages and attachments as the are created and written to the Postoffice.
<P>
The Microsoft Exchange client for Windows 95 performs a caching function
that opens Control.glb, retrieves five hex-id's, and then increments
Control.glb accordinly. The client then caches the extra hex-ids
anticipating that the user will send more mail during the session. This
process reduces the number of times that the Microsoft Exchange client for
Windows 95 must access Control.glb, thus reducing the possibility of file
contention problems. This process does not expose the mail database to
corruption, however, this will affect utilities such as Traffic.exe that
use the Control.glb counter as a method of tracking the number of messages
and attachments processed by that postoffice.
<P>
The Microsoft Exchange client for Windows 95 also automatically creates an
attachment for every mail message sent in Rich Text Format (RTF). This is a
hidden attachment named Winmail.dat that contains the information needed to
display RTF on another Microsoft Exchange client. Because of this, the
Microsoft Exchange client for Windows 95 will use at least two Control.glb
numbers for each mail message sent; one for the message and one for
Winmail.dat. Each additional attachment uses another distinct Control.glb
number.
<P>
When a message with an attachment is sent, the attachment is created and
stored in the appropriate ATT subdirectory. File names for attachments, or
ATT's, are made up of an 8-digit hex number created from the right 4 bytes
of Control.glb and followed by an AT(#) suffix. For example, 00001b45.att
is an attachment and is stored in the \ATT\AT5 directory. Federal
Information Processing Standard (FIPS) format dictates that the attachments
are owned by the messages. Since the attachment, .ATT, was created first,
the hex-id of the ATT is stored as a field in the message. If there are
many attachments, each hex-id uniquely generated by Control.glb is stored
in the message. The mail message itself follows the same naming and storage
conventions as attachments.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbusage XCLN<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
