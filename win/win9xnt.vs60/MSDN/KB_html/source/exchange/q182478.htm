

<HTML>
<HEAD>
<TITLE>XADM: Information Store Crashes When Attempting to Deliver Messa </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182478">
<META NAME="KBModify" CONTENT="1998/03/16">
<META NAME="KBCreate" CONTENT="1998/03/13">
<META NAME="Keywords" CONTENT="XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Server information store may terminate unexpectedly with a stack dump similar to the following:     FramePtr  RetAddr   Param1   Param2   Param3   Function Name    03fbefcc  0215dd56  022d0690 00000000 0000000d 0x10233a58    ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI4,QBE7,QBE6,QDO3,QBFY,QAH6,QDJO,QA5E,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Information Store Crashes When Attempting to Deliver Messa</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182478</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0 SP1, SP2, SP3, and SP4 and
   version 5.0 SP1 and SP2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Server information store may terminate unexpectedly
with a stack dump similar to the following:
<P>
<PRE>   FramePtr  RetAddr   Param1   Param2   Param3   Function Name
   03fbefcc  0215dd56  022d0690 00000000 0000000d 0x10233a58
   03fbf00c  021b236b  77fbff76 c0000034 00000000
   STORE!OMSG::FSchdpMsgClass+0x126(...)
   03fbf150  021aeb63  03fbf290 00000000 77fbff76
   STORE!EcDoForwardAction+0x7db(0x03FBF290, 0x00000000)
   03fbf2f4  021bc3d1  0294466c 0294ed3c 0f875384
   STORE!EcDoDeliveryRules+0xb43(0x0294466C, 0x0294ED3C, 0x0F875384,
   0x00000409, 0x0F8730A4, 0x03FBF540, 0x03FBF674, 0x03FBF5E8, 0x0F875DD4,
   0x03FBF464)
   03fbf374  0223e515  0294466c 0294ed3c 0f875384
   STORE!EcDoPrivateFolderRules+0x271(0x0294466C, 0x0294ED3C, 0x0F875384,
   0x00000409, 0x0F8730A4, 0x03FBF540, 0x03FBF674, 0x03FBF5E8, 0x03FBF5A4,
   0x03FBF464)
   03fbf68c  02259128  0f8730a4 0294ed3c 00000000
   STORE!EcDoDeliverMessage+0x1525(0x0F8730A4, 0x0294ED3C, 0x00000000,
   0x0294466C, 0x0F8727D4, 0x00000001, 0x00000002, 0x00000002, 0x0000,
   0x00000000, 0x03FBFB04, 0x0F8730F4)
   03fbf7ec  02253ed2  0295fc2c 0f871f2c 03fbf998
   STORE!EcDoLocalDelivery+0x8c8(0x0295FC2C, 0x0F871F2C, 0x03FBF998,
   0x0294F934, 0x03FBFDCC, 0x03FBFB04, 0x0F87226C, 0x0F871E24, 0x0000000c,
   0x0F871E9C, 0x00000000)
   03fbf9cc  02252b81  0295fc2c 03fbfaf4 00000000
   STORE!EcCreateOMSubmit+0x8b2(0x0295FC2C, 0x03FBFAF4, 0x00000000,
   0x002F05C0, 0x03FBFAF0, 0x0294F934, 0x03FBFDCC, 0x03FBFAFC, 0x03FBFB04,
   0x03FBFE04, 0x03FBFADC, 0x03FBFB00)
   03fbfb2c  0225167a  0295fc2c 00000000 002f05c0
   STORE!EcSendMessage+0x1c1(0x0295FC2C, 0x00000000, 0x002F05C0,
   0x0294F934, 0x03FBFDCC, 0x03FBFF10, 0x03FBFE04, 0x03FBFCF4)
   03fbff38  0217b0fb  0294176c 00060004 77fbff76
   STORE!FStartSend+0x105a(0x0294176C, 0x00060004)
   03fbffb8  77f46c2e  00000000 77fbff76 c0000034
   STORE!EcProcessTask+0x2db(0x00000000)
   03fbffec  00000000  00000000 00000000 00000000
   KERNEL32!BaseThreadStart+0x61

</PRE><h2>CAUSE</h2>
 
<P>
This crash occurs when the information store attempts to deliver a message
with an empty message-class attribute. The function
STORE!OMSG::FschdpMsgClass passes a null pointer to _strnicmp, which causes
the crash.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0 SP1, SP2, SP3, and SP4 and version 5.0, SP1 and SP2. A
supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Product Support Services for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: IS<BR>
Keywords          : XADM<BR>
Version           : WinNT:4.0,5.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
