

<HTML>
<HEAD>
<TITLE>XFOR: DXA appends 001 only when needed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166545">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1997/04/08">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00.sp1 XFOR kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  After including Microsoft Exchange Server in the Directory Synchronization process of your  MSMail environment, some Display Names are appended with 001. This behavior can be seen  whether your Microsoft Exchange Server is acting as the DirSync Ser...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJQ,QAUJ,QA3P,QAFI,QBXB,QATJ,QAR4,QBXS,QBVV,QAW6,QAPN,QABH,QADX,QABI,QDO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: DXA appends 001 only when needed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166545</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
<LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After including Microsoft Exchange Server in the Directory Synchronization process of your 
MSMail environment, some Display Names are appended with 001. This behavior can be seen 
whether your Microsoft Exchange Server is acting as the DirSync Server or a DirSync Requester.
<P>
<P><h2>CAUSE</h2>
 
<P>
In any one given MSMail postoffice, all display names (friendly names) must be unique. An 
MSMail postoffice may have multiple display names the same in its Global Address List (GAL). 
For example:
<P>
<PRE>   Bob SmithNET1/PO1/BSMITH
   Bob SmithNET2/PO2/BSMITH

</PRE>The above would be perfectly legal in one MSMail postoffice but the following would not:
<P>
<PRE>   Bob SmithNET1/PO1/BSMITH
   Bob SmithNET1/PO1/BSMITH2

</PRE>The above is illegal. Neither ADMIN.EXE nor IMPORT.EXE would allow the second Bob Smith to 
be created.
<P>
Microsoft Exchange Server on the other hand will allow multiple objects to have the same 
display name. Due to this, the Microsoft Exchange Directory Synchronization Service (DXA) 
must ensure that it does not send the same display name to any one MSMail postoffice.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
A new registry value is now available that will change this behavior as described in the 
MORE INFORMATION section below. The registry value to set is:
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide problems that 
may require you to reinstall Windows NT to correct them. Microsoft cannot guarantee that 
any problems resulting from the use of Registry Editor can be solved. Use this tool at 
your own risk.

<OL><P><LI>Run the Registry Editor(Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Services\MSExchangeDX
</PRE>
<P><LI>Add the following case-sensitive DWORD value of 0:
<P>
<P><PRE>      Unique Display Names
</PRE>
<P><LI>Quit Registry Editor.
<P>
</OL>After setting the registry parameter above, the following steps MUST be performed.

<OL><P><LI>Stop the Microsoft Exchange Directory Synchronization Service

<P><LI>Delete the contents of the DXADATA subdirectory.  Do not delete the directory, only the
   contents of the directory.

<P><LI>If the DXA is acting as the DirSync Server, using the Microsoft Exchange Admin utility, 
   choose each Remote Requester object one by one and check the 'Export on next cycle' 
   checkbox on the general tab. This will force a full DirSync export to be sent to each 
   Remote Requester.
<P>
   If the DXA is acting as a DirSync Requester, using the Microsoft Exchange Admin utility,
   choose the DirSync Requester object and check the 'Export on next cycle' checkbox on the
   settings tab. this will force a full DirSync export to be sent to the DirSync Server.

<P><LI>Start the Microsoft Exchange Directory Synchronization Service
<P>
</OL><h2>STATUS</h2>
 
<P>
For Microsoft Exchange Server version 4.0 servers:
<P>
A supported fix is now available, but has not been fully regression-tested and should be 
applied only to systems experiencing this specific problem. Unless you are severely 
impacted by this specific problem, Microsoft recommends that you wait for the next Service 
Pack that contains this fix. Contact Microsoft  Technical Support for more information. 
<P>
For Microsoft Exchange Server version 5.0 servers:
<P>
This problem has been corrected in the latest U.S. Service Pack for Microsoft Exchange 
Server version 5.0. For information on obtaining the Service Pack, query on the following 
word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
How does the DXA keep track of what it has sent to the MSMail postofffices?
<P>
The DXA keeps what we call a mappings database (XDIR.EDB) in the DXADATA directory of the 
Microsoft Exchange Server. Within this mappings database is kept a list of all transactions 
that have been sent by the DXA. The four values kept for each transaction sent are the 
objects:
<P>
<PRE>   USN-Changed
   Display Name
   Email-Addresss (the one that was sent)
   Obj-Dist-Name

</PRE>Behavior with registry parameter listed above set to 1 or non existant:
<P>
When a new DirSync transaction is about to be sent, the XDIR.EDB is checked to see if it 
has sent this friendly name before. If so, the Obj-Dist-Name of both objects are compared 
to see if this is the same object being sent again. If so, we update the USN-Changed 
value and send the transaction as is else we append the 001 to the friendly name.
<P>
Behavior with registry parameter listed above set to 0.
<P>
When a new DirSync transaction is about to be sent, the XDIR.EDB is checked to see if it has 
sent this friendly name before. If so, is this the same address type (IE, X.400, MS, SMTP
etc.) If so, is the address type MS (MSMail). If not, append the 001. If so, is it the same 
NETWORK/PO name. If so, append the 001 else do not append the 001.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbbug kbhotfix kbusage<BR>
KBSubcategory: Exchange XFOR<BR>
Keywords          : kbbug5.00 kbfix5.00.sp1 XFOR kbusage<BR>
Version           : 5.0 4.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
