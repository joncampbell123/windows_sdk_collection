

<HTML>
<HEAD>
<TITLE>XADM: How to Use the Event Log Tools in BORK Part Two </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178929">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1998/01/07">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This information is designed to assist you in using the Event Log utilities located in the Microsoft BackOffice Resource Kit Part Two. The utilities are used to monitor specific events from Microsoft Exchange Server computers. The two executables d...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAO4,QBBI,QBWS,QDMH,QAB5,QBRZ,QBKX,QA1S,QAU5,QAH8,QBWP,QAG2,QAA1,QBXN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: How to Use the Event Log Tools in BORK Part Two</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178929</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0, 5.0, 5.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This information is designed to assist you in using the Event Log
utilities located in the Microsoft BackOffice Resource Kit Part Two. The
utilities are used to monitor specific events from Microsoft Exchange
Server computers. The two executables discussed are Elf.exe and
Evtscan.exe.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
From the Exchange\&lt;operating system\platform&gt;\EventLog directory on the
Microsoft BackOffice Resource Kit Part Two CD-ROM, copy the files into a
directory on a computer that is running the services you want to monitor.
The files can be installed in several locations, including but not limited
to the root of the drive that contains Exchange, in Exchsrvr\Bin, or in the
same location as the BackOffice Resource Kit.
<P>
Use the Event Log Filter tool (Elf.exe) to specify the servers and events
that you want to monitor. After you specify what you want to monitor, the
tool writes the results to a text file. For the message IDs, make sure to
point the Event Log Filter installed on version 5.0 to 5.0 servers, and
point Event Log Filters installed on 4.0 to 4.0 servers. You can then
monitor events on servers or filter events saved in .Evt files by using the
Windows NT Server Event Viewer.
<P>
NOTE: You can save an event log filter by using the Configuration Add and
Remove buttons.
<P>
<P><h3>To Specify the Servers and Events You Want to Monitor</h3>
 
<P>
Do the following:

<OL><P><LI>Run Elf.exe.
</OL>2. Choose Add and Remove to specify the servers and .Evt files you want to
<PRE>   monitor.
</PRE></OL>3. Specify the name of the output text file.
4. Specify how far back you want to check events.
5. Select the services you want to monitor. Choose Advanced to specify
<PRE>   individual event IDs to ignore for a service.
</PRE>6. Specify the entry types you want to monitor.
7. Select the Unattended box if you want to skip over errors and continue.
8. Select Go to start the filter.
<P>
NOTE:  The output text file created is in the same format as the Windows NT
Server Event Viewer, except that it monitors more than one server and it
adds the text description for events.
<P>
<P><h3>To Monitor for Specific Events</h3>
 
<P>
You can use the Event Log Scan tool (Evtscan.exe) to monitor servers for
specific events. When a specified event is detected, the Event Log Scan
tool can be configured to do the following:
<P>
<PRE>   - Start an application or specify any other command-line directives.
   
   - Send a message by using a selected profile and password.
   
   - Send a network pop-up message to specific computers.
   
   - Restart or stop the service.

</PRE><h3>To Run the Event Log Scan Tool</h3>
 
<P>
Do the following:

<OL><P><LI>Create a configuration file with a .Cfg extension specifying the events
   and actions required. The format is as follows:
<P>
   EventID;Source;Action;Alert list;Mail list;Command line;Comment string;
<P>
   The following is a list of each configuration entry and a description
   for the type of event:
<P>
   Configuration Entry: Description
   --------------------------------
<P>
   Event ID: The numerical event ID (see the Windows NT Event Viewer).
<P>
   Source: The source name for the service to monitor.
<P>
   Action: The action to take; can be Restart or Stop.
<P>
   Alert list: A comma-separated list of computers to send network pop-up
<P><PRE>      messages to when the event is detected.
</PRE><P>
   Mail list: A comma-separated list of e-mail aliases to notify when the
<P><PRE>      event is detected.
</PRE><P>
   Command line: Command line with parameters (can be up to 256 characters
<P><PRE>      in length).
</PRE><P>
   Comment string: A comment that is included in the alert pop-up message
<P><PRE>      and e-mail message when the event occurs.
</PRE>
<P><LI>Run Evtscan.exe by using the following command-line format:
<P>
<P><PRE>      Evtscan -f &lt;config_file&gt; -u &lt;profile_name&gt; [-p &lt;password&gt;]
      [-t &lt;delay_in_seconds&gt;] server_list
</PRE><P>
   where config_file is the name of the configuration file created in step
   1; delay_in_seconds is the time the tool waits between scans (for
   example, typing -t 15 sets the tool to scan for events every 15
   seconds); profile is the name of the Exchange profile to be used;
   password is the password for the profile; and server_list is a comma-
   separated list of the servers to monitor for the events.
<P>
   Here is an example of typical syntax usage for the Event Log Scan tool:
<P>
<P><PRE>      Evtscan -f test.cfg -u scan -t 15 server1,server2,server3
      A single space is used to separate the each parameter.
</PRE>
<P><LI>Leave Evtscan running on your computer desktop. You may want to minimize
   the command prompt window.
<P>
</OL>NOTE: To have Event Scan alert you through e-mail, you must install it on a
computer that has MAPI installed (for example, a Microsoft Exchange Server
computer or a Microsoft Exchange Client computer).
<P>
<P><h3>To Use Microsoft Access to View the Details of Your Logs</h3>
 
<P>
If you have Microsoft Access installed, you can use the Microsoft Access
Elf.mdb file to provide common summaries of the events. Do the following:

<OL><P><LI>Start Microsoft Access.

<P><LI>Open Elf.mdb.

<P><LI>Select Open Event Log and specify the full path to the output file
   created with the Event Log Filter.

<P><LI>Select View Details.
<P>
   The top half of the view window shows the count of each event ID found.
   Click an event to see individual occurrences in the bottom half of the
   window. Note that the Elf.mdb database will grow with use. You need to
   compact this database manually by using the Tools.Database
   Utilities.Compact Database option in Microsoft Access.
<P>
</OL> 
<PRE>Keywords          : XADM kbusage
Version           : WINDOWS:4.0,5.0,5.5
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
