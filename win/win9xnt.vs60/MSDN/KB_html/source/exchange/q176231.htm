

<HTML>
<HEAD>
<TITLE>XADM: TEXT/PLAIN Bodyparts Discarded in Embedded Messages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176231">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/11/04">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00.sp2 XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  After you apply Microsoft Exchange Server version 5.0 Service Pack 1, TEXT/PLAIN bodyparts may be discarded in embedded MIME messages. Messages which may experience this problem will meet the following requirements:  1. There are multiple text/plai...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QAMB,QATX,QAYC,QAIB,QAR4,QDO3,QA4H,QABC,QAM1,QAEF,QBRZ,QADF,QA5T,QAML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: TEXT/PLAIN Bodyparts Discarded in Embedded Messages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176231</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you apply Microsoft Exchange Server version 5.0 Service Pack 1,
TEXT/PLAIN bodyparts may be discarded in embedded MIME messages. Messages
which may experience this problem will meet the following requirements:

<OL><P><LI>There are multiple text/plain bodyparts in a message body without MIME
   encoding to indicate that they are file attachments.
</OL>2. The message body containing the text/plain bodyparts is not the top-
level
<PRE>   message body.

</PRE></OL>All but the last text/plain bodypart may be discarded in non-top level
message
bodies.
<P>
<P><h2>CAUSE</h2>
 
<P>
A logic error was introduced for a fix in Microsoft Exchange Server,
version
5.0 Service Pack 1. The fix is supposed to concatenate text/plain bodyparts
into the message body, but only for top-level messages. The logic error
caused a mishandling of non top-level message bodies with multiple
text/plain
bodyparts.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.0.
This problem has been corrected in the latest U.S. Service Pack for
Microsoft Exchange Server version 5.0. For information on obtaining the
Service Pack, query on the following word in the Microsoft Knowledge
Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Below is an example MIME message, the second MULTIPART/MIXED Content-Type
will
be treated as the the start of an embedded message in this case. Of the two
TEXT/PLAIN Content-Type bodyparts in the embedded message below, only
BodyPart
#2 will be displayed. The text for this bodypart will appear in the message
body of the embedded message.
<P>
<PRE>   Date: Tue, 16 Sep 1997 10:58:00 -0400 (EDT)
   From: "Example"
   Subject: Test Message
   To: Testuser
   Message-id: &lt;01INPI37BQ1M054PIG@COMPANY.COM&gt;
   MIME-version: 1.0
   Content-type: MULTIPART/MIXED; BOUNDARY="Boundary (ID
</PRE>LY4m2yKIDQ2Q9f6dR6UGlg)"
<P>
<PRE>   --Boundary (ID LY4m2yKIDQ2Q9f6dR6UGlg)
   Content-type: TEXT/PLAIN; CHARSET=US-ASCII

</PRE>Enclosed you'll find a message with three bodyparts...
<P>
<PRE>   --Boundary (ID LY4m2yKIDQ2Q9f6dR6UGlg)
   Content-type: MULTIPART/MIXED; BOUNDARY="Boundary (ID
</PRE>P6hOhonnruLpzicTo1sWlw)"
<P>
<PRE>   --Boundary (ID P6hOhonnruLpzicTo1sWlw)
   MIME-version: 1.0
   Content-type: TEXT/PLAIN; CHARSET=US-ASCII

   BodyPart #1

   --Boundary (ID P6hOhonnruLpzicTo1sWlw)
   Content-type: TEXT/PLAIN; CHARSET=US-ASCII

   BodyPart #2

   --Boundary (ID P6hOhonnruLpzicTo1sWlw)--

   --Boundary (ID LY4m2yKIDQ2Q9f6dR6UGlg)--

</PRE>For more information about the fix for SP1, please see the following
article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q153464.htm">Q153464</A></B>
   TITLE: Unexpected Text Attachment in Mail Received from Internet

</PRE>Microsoft has produced a fix which allows <B><A href="../exchange/q153464.htm">Q153464</A></B> to operate as expected
and correctly creates text file attachments for all the non top-level
text/plain bodyparts.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: foriegn 3rd party gateway rfc<BR>
Keywords          : kbbug5.00 kbfix5.00.sp2 XADM<BR>
Version           : 5.0<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
