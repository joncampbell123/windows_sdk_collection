

<HTML>
<HEAD>
<TITLE>XADM: Slow Intra-site Directory Replication Between Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152942">
<META NAME="KBModify" CONTENT="1997/06/05">
<META NAME="KBCreate" CONTENT="1996/06/25">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="-   Microsoft Exchange Server computers, version 4.0, with Microsoft Exchange Service Pack 2 (SP2) loaded might indicate that replication is occurring (through Performance Monitor and Event Viewer logging), but replication never completes or catches ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVV,QAPN,QDO3,QAFO,QAYV,QAKD,QAJQ,QBVX,QBWS,QBXB,QATJ,QAMR,QAFI,QAKC,QA5E V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Slow Intra-site Directory Replication Between Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152942</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Exchange Server computers, version 4.0, with Microsoft Exchange
Service Pack 2 (SP2) loaded might indicate that replication is occurring
(through Performance Monitor and Event Viewer logging), but replication
never completes or catches up between one or more Microsoft Exchange
Servers within the same Microsoft Exchange Site. You might notice this by
not seeing mailboxes, custom recipients, other objects, or modifications to
objects appear in one or more Microsoft Exchange Server Directories.
<P>
<P><h2>CAUSE</h2>
 
<P>
When a target Microsoft Exchange Server computer is busy replicating with
other Microsoft Exchange Server computers, it might not return its UUID
when it refuses a connection from a requesting Microsoft Exchange Server.
This results in the requesting Server incorrectly assigning the wrong UUID
to the "Reps-From" field for the target Server. The next time the
requesting Server attempts replication with the target Server, it "sees" a
different UUID on the target Server, considers it a "new" Server, and
attempts to replicate all objects. This can occur repeatedly if the
requesting Server is refused the connection again at a later time.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0. This problem was corrected in the latest Microsoft Exchange
Service Pack. For information on obtaining the Service Pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>WORKAROUND</h2>
 
<P>
One possible workaround is to increase the following registry value on all
Microsoft Exchange Servers within the Microsoft Exchange Site to a number
equal to or greater than the total number of Servers in the Site. Note
that
modifying this value requires adequate RAM memory resources on all the
computers on which the modification is made. The default for this value is
10 (0xA).
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeDS
                     \Parameters\Replicator maximum concurrent read
</PRE>threads
<P>
WARNING: If this setting is changed, and adequate resources do not exist on
the server, several detrimental side effects may result including: mail
flow failure; and/or Directory, Information Store, or MTA operational
intermittency or failure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is important to confirm that the problem documented here is indeed the
issue BEFORE proceeding with corrective actions. To diagnose this issue,
perform the following:

<OL><P><LI>Determine the UUID for the Directory Synchronization Agent (DSA) on the
   Microsoft Exchange Server which is not sending out updates.
<P>
   Start the Microsoft Exchange Administrator program in raw mode
   (Admin.exe /r) against the Microsoft Exchange Server.
<P>
   Highlight the &lt;sitename&gt;. Configuration.Servers.&lt;this-Server s-
   name&gt;.Directory Service
<P>
   Select, File, Raw Properties..., and Invocation-ID. Note the first and
   last 4 characters listed in the Edit Value string. This is the UUID.

<P><LI>Compare the above UUID with the replication UUID listed on one of the
   Microsoft Exchange Servers that has not received the replicas yet.
<P>
   Start the Microsoft Exchange Administrator program in raw mode against
   the non-replicated Microsoft Exchange Server.
<P>
   Highlight, &lt;sitename&gt;.
<P>
   Select File, Raw Properties...,Reps-From.
<P>
   In the Attributes Value scroll box, move the horizontal scroll bar to
   the far right until the Microsoft Exchange Server names can be seen.
   Scroll through the list until the servername in step 1 is found.
<P>
   Double click on this entry and view Replica link.
<P>
   The value in the UUID: field should be the same UUID noted in step 1.
   If it is not, this indicates the condition documented in this article.
   If the UUIDs match, the problem is not a result of this issue and
   implementing the hotfix or workaround is not recommended.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 1186 event ID<BR>
Keywords            : XADM kbusage<BR>
Version             : 4.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
