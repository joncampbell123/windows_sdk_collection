

<HTML>
<HEAD>
<TITLE>XCLN: WordPad and Exchange Crash When Run on Non-English NT 3.51 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152929">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1996/06/25">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00.sp3 kbusage XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  WordPad might crash and you might not be able to set up a profile for the Microsoft Exchange Windows NT client if you have just upgraded a non- English version of Windows NT from 3.51 to 4.0.  CAUSE =====  The Richedit control is used in both WordP...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QADF,QAEF,QAJZ,QAWP,QAA1,QDL9,QBWQ,QBWO,QBWN,QDNL,QDH6,QBVV,QA9N,QA8T V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: WordPad and Exchange Crash When Run on Non-English NT 3.51</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152929</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
This information applies to:

<UL><LI>Microsoft Exchange Windows NT client, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
WordPad might crash and you might not be able to set up a profile for the
Microsoft Exchange Windows NT client if you have just upgraded a non-
English version of Windows NT from 3.51 to 4.0.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Richedit control is used in both WordPad and the Microsoft Exchange
client. It reads the font substitution information from the registry. The
font substitution information can be in two forms. Windows NT 3.51 used a
simplified form (since it didn't support multiple code pages), Arial
CE=Arial. Windows NT 4.0 (like Windows 95) has the character set numbers
included in the font substitutions, Arial CE,238=Arial,238
<P>
In the past (Windows NT 3.51 and Windows 95), we had either form 1 or form
2, but not both. When Windows NT 3.51 is updated to 4.0, it preserves the
old settings and adds the new ones, thus both forms of substitution strings
are now present. The RichEdit control was not designed to handle both forms
at the same time.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Since the bugs happens due to the old (Windows NT 3.51) font substitution
strings, removing these strings from the registry eliminates the cause of
the bug. To remove these strings, follow these steps:

<OL><P><LI>Start Regedt32.exe.
</OL>2. Go to
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT
                     \CurrentVersion\FontSubstitutes

</PRE><P><LI>Remove all 'type 1' font substitutions that deal with CE, Cyr, and Greek
   fonts and do not have charset numbers.
<P>
   For example, remove:
<P>
<P><PRE>      Arial Greek:Arial
</PRE><P>
   but leave:
<P>
<P><PRE>      Arial Greek,161:Arial,161
</PRE><P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0. This problem was corrected in the latest Microsoft Exchange
Service Pack. For information on obtaining the Service Pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbbug4.00 kbfix4.00.sp3 kbusage XCLN<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
