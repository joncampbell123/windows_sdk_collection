

<HTML>
<HEAD>
<TITLE>XCON: Creating Crash Dump Files when MTA Encounters Fatal Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149422">
<META NAME="KBModify" CONTENT="1998/01/06">
<META NAME="KBCreate" CONTENT="1996/04/02">
<META NAME="Keywords" CONTENT="XCON kbenv kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article describes how to cause the Microsoft Exchange Server message  transfer agent (MTA) to create a crash dump file when a fatal error  occurs instead of stopping unexpectedly.  MORE INFORMATION  When the message transfer agent (MTA) encoun...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAKD,QAAP,QAB4,QBWS,QDJO,QABI,QAO4,QBSO,QAKC,QAIJ,QAD7,QABH,QAJ6,QAP2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Creating Crash Dump Files when MTA Encounters Fatal Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149422</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0, 5.0
</UL>------------------------------------------------------------------------ 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to cause the Microsoft Exchange Server message 
transfer agent (MTA) to create a crash dump file when a fatal error 
occurs instead of stopping unexpectedly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When the message transfer agent (MTA) encounters a fatal error on a 
computer running Microsoft Exchange Server, the MTA normally stops 
unexpectedly. When this occurs, a severity 16 event appears in the event 
log and the Services tool in Control Panel indicates that the 
MSExchangeMTA service has stopped.
<P>
For troubleshooting purposes, you may want to configure Windows NT so 
that the MTA creates a crash dump file when a fatal error occurs instead 
of stopping unexpectedly. To do so, use the following steps.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide 
problems that may require you to reinstall Windows NT to correct them. 
Microsoft cannot guarantee that any problems resulting from the use of 
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Verify that Dr. Watson for Windows NT is configured correctly. To do 
   so, follow these steps:
<P>
   a. Click Start, click Run, type "drwtsn32 -i" (without quotation 
<P><PRE>      marks) in the Open box, and then click OK.
</PRE><P>
   b. Click OK again.
<P>
   c. Click Start, click Run, type "drwtsn32" (without quotation marks) 
<P><PRE>      in the Open box, and then click OK.
</PRE><P>
   d. Verify that the Create Crash Dump File check box is selected.
<P>
   e. Verify that the locations in the Log File Path and Crash Dump boxes 
<P><PRE>      refer to the Windows NT folder. In Dr. Watson for Windows NT, the 
      Windows NT folder is typically represented by the %windir% variable.
</PRE><P>
   f. Click the Visual Notification check box to clear it. This allows 
<P><PRE>      the MTA to create the crash dump file without any input from you. 
      If this check box is selected, a dialog box is displayed when a 
      fatal error occurs and the crash dump file is not created until the 
      dialog box is closed.
</PRE><P>
   g. Click OK to close Dr. Watson for Windows NT.
<P>
   After you perform these steps, the following registry values exist:
<P>
<P><PRE>      Value name: Auto
      Value type: REG_SZ
      Value data: 1
</PRE><P>
<P><PRE>      Value name: Debugger
      Value type: REG_SZ
      Value data: drwtsn32.exe -p %ld -e %ld -g
</PRE><P>
<P><PRE>      Value name: UserDebuggerHotKey
      Value type: REG_DWORD
      Value data: 0
</PRE><P>
   These values are located under the following registry key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\Current Version
      \Aedebug
</PRE><P>
   NOTE: The above registry key is one path; it has been wrapped for 
   readability.

<P><LI>Start Registry Editor (Regedt32.exe or Regedit.exe as appropriate for 
   your version of Windows NT).

<P><LI>Locate the following registry key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\MSExchangeMTA
      \Parameters
</PRE><P>
   NOTE: The above registry key is one path; it has been wrapped for 
   readability.

<P><LI>On the Edit menu, click Add Value, and then add the following registry 
   value:
<P>
<P><PRE>      Value name: Raise exception on fatal error
      Value type: REG_DWORD
      Value data: 1
</PRE><P>
</OL>After you perform these steps, the MTA does not stop unexpectedly when a 
fatal error occurs. Instead, fatal errors generate exceptions and cause a 
crash dump file to be created. The exception generated is 0xE005&lt;xxxx&gt;, 
where &lt;xxxx&gt; is a number that represents the specific error that 
occurred, if appropriate.
 
<PRE>Keywords          : XCON kbenv kbusage
Version           : 4.0 5.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
