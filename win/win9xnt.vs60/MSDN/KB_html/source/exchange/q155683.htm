

<HTML>
<HEAD>
<TITLE>XFOR: Verification of FROM Address in SMTP Messages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155683">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1996/09/05">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix4.00.sp3 XFOR kbusage kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information on how to do this, view the  Restoring the Registry  online Help t...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAEV,QAC2,QAY2,QAKD,QABI,QBJZ,QAR5,QA6A,QAHH,QAVZ,QAYY,QAKP,QBWD,QBXB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Verification of FROM Address in SMTP Messages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155683</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server versions 4.0, 5.0, and 5.5
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it
if a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Messages have an address in the FROM line that is not authentic.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Internet is not a secure network. RFC 822, which defines the Simple
Mail Transport Protocol (SMTP), does not include verification of the
authenticity of the FROM address in a mail message. This means that
unscrupulous Internet users can create messages and impersonate or "spoof"
the FROM address.
<P>
This is done by using Telnet to connect to the mail host on port 25 and
typing RC-821 SMTP commands to simulate the arrival of a new message. When
these messages are received by the Microsoft Exchange Server Internet Mail
Service (or Internet Mail Connector, in version 4.0), the address is
compared to the Microsoft Exchange Directory. If the address matches a
directory entry, it is replaced in the message header. This means that the
spoofed messages look identical to internally sent Exchange Server
messages.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem:

<UL><LI>On the File menu, click Properties. If a Headers tab is present, the
   message was not sent by another Microsoft Exchange Server user in your
   organization.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
versions 4.0 , 5.0 and 5.5. This problem was corrected in the latest
Microsoft Exchange Service Packs. For information on obtaining the Service
Packs, query on the following word in the Microsoft Knowledge Base (without
the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To enable either version of Microsoft Exchange Server to check the From
line, the Exchange Server administrator will need to follow these steps:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" online Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" online Help
topics in Regedt32.exe. Note that you should back up the registry before
you edit it.

<OL><P><LI>On the Microsoft Exchange Server computer, start Regedt32.exe.

<P><LI>Add two values to the IMC registry key under:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/Services/
<PRE></PRE>                         MSExchangeIMC/Parameters

</PRE><P><LI>On the Edit/Add value menu, add the following:
<P>
<P><PRE>      Value Name: TurfDir
      Data Type: REG_SZ
</PRE><P>
<P><PRE>      C:\EXCHSRVR\IMCDATA\TURFDIR
</PRE><P>
   This is the directory where matched messages will be stored.

<P><LI>On the Edit menu, use Add value to add the following:
<P>
<P><PRE>      Value Name: TurfTable
      Data Type: REG_MULTI_SZ
</PRE><P>
<P><PRE>      user1@site.domain
      user2@site.domain
</PRE><P>
   The Turf Table contains a list of e-mail addresses used to verify
   the from address on incoming Internet mail. They should be entered
   one per line with no extra spaces or delimiters. They are case
   insensitive. If a match is found, the message will be saved to the
   directory specified in the TURFDIR value.
   In Exchange 5.5 you can add the domain values instead of adding single
   user names. For example, @site.domain.

<P><LI>Restart the Internet Mail Connector or Internet Mail Service.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: XSRVInCon<BR>
Keywords          : kbbug4.00 kbbug5.00 kbfix4.00.sp3 XFOR kbusage kbusage<BR>
Version           : WinNT:4.0,5.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
