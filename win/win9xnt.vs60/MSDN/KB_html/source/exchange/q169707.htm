

<HTML>
<HEAD>
<TITLE>XADM: AV in Mad.exe w/ 20 or More IP Addresses for NIC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169707">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/06/05">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00.sp2 XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When you have more than 20 IP addresses defined for the network interface card (NIC), the System Attendant may raise a general protection fault (GPF), resulting in a Drwtsn32.log similar to the one below:     Application exception occurred:       A...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAI4,QBFY,QDO3,QBJQ,QAX6,QAYA,QAY5,QAJ6,QDMW,QAY2,QAUJ,QAGI,QBV8,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: AV in Mad.exe w/ 20 or More IP Addresses for NIC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169707</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you have more than 20 IP addresses defined for the network interface
card (NIC), the System Attendant may raise a general protection fault
(GPF), resulting in a Drwtsn32.log similar to the one below:
<P>
<PRE>   Application exception occurred:
      App: mad.dbg (pid=277)
      When: 7/9/1997 @ 14:27:56.867
      Exception number: c0000005 (access violation)

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.0. This problem has been corrected in the latest U.S. Service
Pack for Microsoft Exchange Server version 5.0. For information on
obtaining the service pack, query on the following word in the Microsoft
Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE>MORE INFORMATION
 
<P>
From the Drwatson log
<P>
<PRE>   State Dump for Thread Id 0x121

   eax=00000000 ebx=00000001 ecx=011dffdc edx=00000018 esi=023611f0
   edi=00000000
   eip=77f674e6 esp=011dfee8 ebp=00000000 iopl=0         nv up ei pl zr na
   po
   nc
   cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000
   efl=00000246

   function: RtlLeaveCriticalSection
      77f674e0 8b542404         mov     edx,[esp+0x4]
   ss:020ee8ef=????????
      77f674e4 33c0             xor     eax,eax
   FAULT -&gt;77f674e6 ff4a08           dec     dword ptr [edx+0x8]
   ds:00f0ea1e=????????
      77f674e9 7525             jnz     RtlLeaveCriticalSection+0x30
   (77f67510)
      77f674eb 89420c           mov     [edx+0xc],eax
   ds:00f0ea1e=????????
      77f674ee f0ff4a04         lock   dec dword ptr [edx+0x4]
   ds:00f0ea1f=????????
      77f674f2 7d03             jge     RtlLeaveCriticalSection+0x17
   (77f674f7)
      77f674f4 c20400           ret     0x4
      77f674f7 52               push    edx
      77f674f8 e873580000       call    RtlpUnWaitCriticalSection
   (77f6cd70)
      77f674fd 33c0             xor     eax,eax
      77f674ff c20400           ret     0x4
      77f67502 2e8bc0           mov     eax,cs:eax
      77f67505 2e8bc0           mov     eax,cs:eax

   *----&gt; Stack Back Trace &lt;----*

   FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
   00000000 00000000 00000000 00000000 00000000 00000000
   ntdll!RtlLeaveCriticalSection

</PRE>From the user.dmp:
<P>
<PRE>   kb
   FramePtr  RetAddr   Param1   Param2   Param3   Function Name
   011dfee4  6c0bab9c  00000018 00000000 02361fb0
   NTDLL!RtlLeaveCriticalSection+0x6
   011dff00  6c0baa4e  00000000 02360aec 6c0bd870
   EMSMDB32!CNCT::EcAllocateNotification+0x11c
   011dff0c  6c0bd870  6c0a17e8 0085128c 02360aec
   EMSMDB32!RPC::EcAttemptPush+0xe
   011dff28  6c0bd700  00000006 0085128c 80000008
   EMSMDB32!FOLDOBJ::EcGetTable+0x130
   011dff48  004137cc  02360aec 80000008 0085128c
   EMSMDB32!FOLDOBJ::GetContentsTable+0x70
   011dff88  00412667  000000b4 00851100 00000000
   MAD!CMapiSession::ScInitInbox+0xdc
   011dffa0  0040f6d3  011dffec 00310025 0061004c
   MAD!CMapiSession::ScConnectMailbox+0x47
   011dffb4  0040f649  77f04f2c 00851100 00310025
   MAD!CMapiSession::DwProcessInbox+0x83
   011dffb8  77f04f2c  00851100 00310025 0061004c
   MAD!CMapiSession::DwProcessInboxStatic+0x9
   011dffec  00000000  0040f640 00851100 00000000
   KERNEL32!BaseThreadStart+0x51
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: IIS Crash<BR>
Keywords          : kbbug5.00 kbfix5.00.sp2 XADM kbusage<BR>
Version           : 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
