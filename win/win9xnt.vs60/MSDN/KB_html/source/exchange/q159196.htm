

<HTML>
<HEAD>
<TITLE>XADM: Tasks Controlled by the IS Maintenance Schedule </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159196">
<META NAME="KBModify" CONTENT="1998/01/05">
<META NAME="KBCreate" CONTENT="1997/01/09">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Information Store Maintenance Schedule is a configurable block of time in which common tasks are launched for maintaining the Information Store database. This articles describes the tasks directly controlled by the IS Mainten...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QAL4,QAU3,QAMR,QACE,QAFH,QABA,QAYV,QAOE,QAFI,QBRU,QAPN,QAXB,QAO4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Tasks Controlled by the IS Maintenance Schedule</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159196</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Exchange Information Store Maintenance Schedule is a
configurable block of time in which common tasks are launched for
maintaining the Information Store database. This articles describes the
tasks directly controlled by the IS Maintenance Schedule and the order in
which they start.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The IS Maintenance schedule is set through the IS Maintenance tab within
the properties of the Server object in the Microsoft Exchange site. The IS
maintenance schedule is divided into 15-minute intervals, as are all
schedule pages (NOTE: if you click "Always," this means every 15-minutes).
<P>
At the start of each 15-minute interval the maintenance thread checks to
see if the interval is selected. If it is selected, maintenance is
performed. In starting each task, the minimum time between cleanup is
checked (these values are listed below and controlled by the registry
settings documented only unless otherwise noted) and if the task was last
completed within the minimum time, the task will not be performed in this
maintenance window (the minimum time interval will override the IS
Maintenance schedule). Once IS Maintenance is started it will run to
completion.
<P>
The following tasks are performed at IS Maintenance time:
<P>
<PRE>   Index Aging
   Tombstone Maintenance
   Message Expiration (Public Store Only)
   Age Folder Tombstones (Public Store Only)
   Update Server Versions (Public Store Only)

</PRE>These tasks are described below.
<P>
<P><h3>Index Aging:</h3>
 
<P>
Indexes created in database tables by the client (used for views) that have
not been used for a given time are cleaned up at this time. The following
registry entries are used to control index aging:
<P>
<PRE>   Aging Keep Time: minimum index age (milliseconds) before it is deleted,
   default is 8 days

   Aging Clean Interval: minimum time interval (milliseconds) between index
   age task runs, default is 24 hours

   Reset Views: If this setting exists and it is non-zero, this will force
   all cached indexes to be deleted during the next index aging task run.
   When the index aging is complete, the Reset Views value will be set to
   0.

   For additional information on Index Aging, please see the following
   article in the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../excel/q159157.htm">Q159157</A></B>
      TITLE     : XADM: Controlling Folder Index Aging

</PRE>Event logging for index aging is controlled by the following registry
settings:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\
   Diagnostics\Private\General\Views

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\
   Diagnostics\Public\General\Views

</PRE>The standard event log levels of 0 to 5 apply (5 is most verbose.)
<P>
<P><h3>Tombstone Maintenance:</h3>
 
<P>
This is the process of compacting deleted message information used for
local and Public Folder replication. Minimum time between tombstone
maintenance task execution is 24 hours (not controllable through the
registry).
<P>
There is currently no event logging available for tombstone maintenance.
<P>
<P><h3>Message Expiration (Public Store Only):</h3>
 
<P>
This is the process of expiring messages in Public Folders that are older
than a specified time value. The setup for message expiration is in the
Microsoft Exchange Server Administrator program on the "Age Limits" tab in
the public Information Store container.
<P>
The default minimum time between expiration task execution is 24 hours with
the following registry setting override (in milliseconds).
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\
   ParametersPublic\Replication Expiry

</PRE>Event logging is controlled by the following registry key:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\
   Diagnostics\Public\Replication\Expiry

</PRE>The standard event log levels of 0 to 5 apply (5 is most verbose).
<P>
<P><h3>Age Folder Tombstones (Public Store Only):</h3>
 
<P>
This is the process of removing folder tombstone entries that are older
than a given time (default is 180 days). Folder tombstone information is
used by public folder replication. The aging is required to prevent the
folder tombstone list from growing unbounded. The default value of 180 days
can be overridden with a registry variable (value is in days):
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\
   ParametersPublic\Replication Folder Tombstone Age Limit

</PRE>The default minimum time between folder tombstone aging task execution is
24 hours with no registry override.
<P>
There is currently no event logging available for age folders tombstones.
<P>
<P><h3>Update Server Versions (Public Store Only):</h3>
 
<P>
The Directory Service stores the Microsoft Exchange Server version number
for each server. At regular intervals, this information is read from the
Directory Service and stored in memory for use by the public store. This
information is used to control interoperability between current and older
versions of Microsoft Exchange Server. As servers are upgraded, this info
needs to be updated. Default minimum time between server version updates is
24 hours, with no registry override.
<P>
There is currently no event logging available for updating server versions.
<P>
NOTE: The IS Maintenance tasks all run under the same thread at
THREAD_PRIORITY_BELOW_NORMAL. Each task runs sequentially. The thread is
allocated when IS maintenance is performed, and freed when it is complete.
<P>
NOTE: There are other tasks that can be considered maintenance tasks, but
they are not controlled by the IS Maintenance Schedule.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : XADM kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
