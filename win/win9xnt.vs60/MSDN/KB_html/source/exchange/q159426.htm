

<HTML>
<HEAD>
<TITLE>XCLN: How to Write Listbox Items to an E-form  Package </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159426">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1996/11/13">
<META NAME="Keywords" CONTENT="kbusage XCLN">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When you use the Microsoft Exchange 4.0 Electronic Forms Designer to create a custom E-form that has a listbox, you can set the initial content of the listbox by double-clicking the listbox to open up a Field Properties dialog box, choosing the Ini...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QBS0,QAHP,QA28,QATJ,QAFF,QANF,QAB9,QAE1,QA4Q,QAPN,QAEF,QAA1,QA8T,QARL V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: How to Write Listbox Items to an E-form  Package</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159426</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 95 client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
<LI>Microsoft Exchange Windows NT client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use the Microsoft Exchange 4.0 Electronic Forms Designer to create
a custom E-form that has a listbox, you can set the initial content of the
listbox by double-clicking the listbox to open up a Field Properties dialog
box, choosing the Initial Value tab, and setting the list items for the
listbox.
<P>
But sometimes you may want to have an initially blank listbox and have the
E-form  sender dynamically add or remove the list items. In this case, you
have to modify the Visual Basic code generated by the E-form  Designer to
write the content of the listbox to the E-form  package. Otherwise, the
receiver of the E-form  will receive a blank listbox. This article
illustrates the techniques of writing the listbox items to an E-form
package.
<P>
MORE INFORMATION
 

<OL><P><LI>Use the Microsoft Exchange E-form Designer Wizard to generate an one-
   window electronic form called List.efp. Add a listbox to the E-form.
   Compile and install the form. This will generate a 16-bit Visual Basic
   project called List.vbp.

<P><LI>Load List.vbp into a 16-bit version of Visual Basic.

<P><LI>Add a Command button, Command1, to Window1.Frm. In the click event,
   populate the list box:
<P>
<P><PRE>      Private Sub Command1_Click()
<PRE></PRE>          Dim i As Integer
          For i = 0 To 10
              ListBox1_Ctrl.AddItem "Item " &amp; i
          Next i
      End Sub

</PRE><P><LI>Add a public function to Window1.Frm to write the list items of
   ListBox1_Ctrl into a single Visual Basic Variant type variable:
<P>
<P><PRE>      Public Function CreateVariant() As Variant
<PRE></PRE>          Dim varRet As Variant
          Dim strTemp() As String
          ReDim strTemp(ListBox1_Ctrl.ListCount) As String
          Dim i As Integer
          For i = 0 To ListBox1_Ctrl.ListCount - 1
              strTemp(i) = ListBox1_Ctrl.List(i)
          Next i
          CreateVariant = strTemp 'store an array into a variant
      End Function

</PRE><P><LI>Remove the ListBox1_Ctrl_Click() procedure from the Window1.Frm.

<P><LI>In the Window_Store procedure of the Window1.Frm, add the following
   statement
<P>
<P><PRE>      ListBox1_Ctrl_Val = CreateVariant
</PRE><P>
   before the following statement
<P>
<P><PRE>     Call SetMapiProp(ctlSubject.Text, "MAPI_Subject_Custom",vbString, Msg)
</PRE>
<P><LI>In the Window_Load procedure, comment out the following statement:
<P>
<P><PRE>      If (VarType(varTemp) And vbArray) = vbArray Then varTemp = varTemp(0)
</PRE>
<P><LI>Change the SetListBoxValue subroutine in the Global.bas to the
   following:
<P>
<P><PRE>      Public Sub SetListBoxValue(ByVal var As Variant, ctl As Control, _
<PRE></PRE>         inType As Integer)
          Dim Index As Integer
          Dim lstMost As Integer

          If IsNull(var) Then Exit Sub
          If VarType(var) &lt; vbArray Then Exit Sub
          ctl.Clear
          lstMost = UBound(var)
          For Index = 0 To lstMost - 1
              ctl.AddItem var(Index)
          Next Index
      End Sub

</PRE><P><LI>Rebuild the executable file and install it.
<P>
</OL>To test the newly installed E-form , the sender loads the form using the
Microsoft Exchange client. The sender first clicks the Command1 button to
populate the listbox and then click the Send button. When the receiver
opens up the received form, the list items of the listbox are received.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Eforms VB Eform<BR>
Keywords            : kbusage XCLN<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
