

<HTML>
<HEAD>
<TITLE>XFOR: DXM Access Violation Processing NAMEM Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181500">
<META NAME="KBModify" CONTENT="1998/02/24">
<META NAME="KBCreate" CONTENT="1998/02/20">
<META NAME="Keywords" CONTENT="XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Linkage Directory Exchange Manager version 3.2 may access violate when the NAMEM macro is used in a mapping rule. If Windows NT and Linkage 3.2 symbols are installed and functioning correctly, the resulting stack frame will look similar to the ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI4,QBXB,QATJ,QAR4,QAH4,QAFI,QAUJ,QBWS,QA1S,QA2X,QAUR,QAML,QAIV,QBWP,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: DXM Access Violation Processing NAMEM Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 24, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181500</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0, 5.0, and 5.5
<LI>Linkage Directory Exchange, version 3.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Linkage Directory Exchange Manager version 3.2 may access violate when
the NAMEM macro is used in a mapping rule. If Windows NT and Linkage 3.2
symbols are installed and functioning correctly, the resulting stack frame
will look similar to the following:
<P>
<PRE>FramePtr  RetAddr   Param1   Param2   Param3   Function Name
</PRE>0012b7ac  10004776  0012d43c 0012f078 0012b854 LSMMDAPI!fnNameM+0x185
0012b820  10004064  0012d43c 0012f078 00000001
LSMMDAPI!MFCallFunction+0x76
0012dc40  100038ec  0012f900 0012f078 0012e478
LSMMDAPI!evaluateFunction+0x24b({...})
0012f888  100036ab  006b8752 0012f900 006bb7af
LSMMDAPI!getNextToken+0x1c0({...})
0012f8bc  1000348b  006b8752 0012f900 006bb7af
LSMMDAPI!parseRule+0x45({...})
0012f914  1000325d  006a342f 006b86c7 006bb7af LSMMDAPI!mapOneAttr+0x10e
0012f950  10002b57  006bb7af 00000000 006b7b07 LSMMDAPI!mapAttributes+0x13d
0012f98c  10001fc3  006bb7af 00000007 00000010 LSMMDAPI!mapTransaction+0xb4
0012f9b0  100014b7  006bb7af 00000007 00000010 LSMMDAPI!DXMMapUpdate+0x47
0012f9ec  0040650b  006bb7af 00000000 00000010 LSMMDAPI!MMDWrite+0x153
0012faa8  004053e2  00000003 0012fca4 0012fbf8
LSDXM!processTransaction+0x40
0012fc74  00404c9f  006ba24f 006ba76f 0012fca4 LSDXM!processMessage+0x6c2
0012fd14  00404891  006ba24f 006ba76f 0012fd48 LSDXM!processItem+0x105
0012fe70  0040457b  00000010 00b53578 00b53450
LSDXM!processInbound+0x25c(...)
0012fe90  00403926  00000010 00b53578 00b53450
LSDXM!DXMProcessInbound+0x76(...)
0012fec0  00266d12  00b53578 0012ff44 00020005 LSDXM!process+0x183
0012fee4  00401f75  00b53578 00020005 00000000
LSCPS!?process@EventManager@@UAEGPAVEvent@@@Z+0x242
0012ff44  00401065  00020005 00000000 7ffdf000 LSDXM!runApp+0x7bf(...)
0012ff64  0040a1e3  00000004 00b51d58 00b50d70 LSDXM!main+0x35
0012ffc0  77f1b304  00020005 00000000 7ffdf000
LSDXM!mainCRTStartup+0x113(...)
0012fff0  00000000  0040a0d0 00000000 00000000
KERNEL32!BaseProcessStart+0x40
<P>
Entries in the Linkage event log file will look similar to the following
(Note: This is starting with a Full Reload request from the DXM to the
Exchange Agent):
<P>
<PRE>1998/02/03 07:37:55-                     DXM(01a2) 3 62501:Starting DX work
</PRE>item 327 for agent LINKAGE(DXAMEX): RequestDXAUpdates Full
<PRE> &gt;&gt; dxmpo(417)
1998/02/03 07:37:55-                     DXM(01a2) 3 60277:Opening the MIF
</PRE>read queue dxm.in
<PRE> &gt;&gt; mif(362)
1998/02/03 07:37:55-                     DXM(01a2) 3 60277:Opening the MIF
</PRE>write queue router.in
<PRE> &gt;&gt; mif(362)
</PRE>*********************SOME ENTRIES REMOVED*********************************
&gt;&gt; pcta(4048)
<PRE>1998/02/03 07:38:21-                  DXAMEX(00a9) 4 67130:Completed
</PRE>Outbound processing cycle
<PRE> &gt;&gt; msxdxapo(677)
1998/02/03 07:38:21-                  DXAMEX(00a9) 4 04107:Queue DXAMEX.IN
</PRE>has been opened (physical location is q\DXAMEX.IN)
<PRE> &gt;&gt; qm(1884)
1998/02/03 07:38:21-                  DXAMEX(00a9) 4 04108:Queue DXAMEX.IN
</PRE>has been closed
<PRE> &gt;&gt; qm(2003)
1998/02/03 07:38:21-                  DXAMEX(00a9) 2 67037:Completed
</PRE>Inbound Processing
<PRE> &gt;&gt; msxdxapi(364)
1998/02/03 07:38:25-                     DXM(01a2) 3 60277:Opening the MIF
</PRE>read queue dxm.in
<PRE> &gt;&gt; mif(362)
1998/02/03 07:38:25-                     DXM(01a2) 3 60277:Opening the MIF
</PRE>write queue router.in
<PRE> &gt;&gt; mif(362)
1998/02/03 07:38:25-                     DXM(01a2) 3 62309:Begin Inbound
</PRE>processing
<PRE> &gt;&gt; dxmpi(572)
1998/02/03 07:38:25-                     DXM(01a2) 4 04107:Queue dxm.in has
</PRE>been opened (physical location is q\dxm.in)
<PRE> &gt;&gt; qm(1884)
1998/02/03 07:38:25-                     DXM(01a2) 4 04113:Queue item
</PRE>q\dxm.in\50000017.rdy has been opened in queue dxm.in
<PRE> &gt;&gt; qm(3480)
1998/02/03 07:38:25-                     DXM(01a2) 4 60331:Closing MIF file
'c:\linkage\q\archive\a41296e2.mif', type 'read'
 &gt;&gt; mif(1048)
1998/02/03 07:38:25-                     DXM(01a2) 3 60335:Copying
</PRE>c:\linkage\q\archive\a41296e2.mif to the MIF archive directory
<PRE> &gt;&gt; mifppars(1000)
1998/02/03 07:38:25-                     DXM(01a2) 3 60248:Searching
</PRE>directory c:\linkage\q\archive\ for MIF partition block files
<PRE> &gt;&gt; mifmpb(1648)
1998/02/03 07:38:26-                     DXM(01a2) 3 60289:Opening MIF
</PRE>partition block: message type L, sequence 13, partition 1
<PRE> &gt;&gt; mifmpb(275)
1998/02/03 07:38:26-                     DXM(01a2) 3 60313:Complete
</PRE>processing of an inbound partition
<PRE> &gt;&gt; mifparse(3065)
1998/02/03 07:38:26-                     DXM(01a2) 4 04114:Queue item
</PRE>q\dxm.in\50000017.rdy has been dequeued from queue dxm.in
<PRE> &gt;&gt; qm(3731)
1998/02/03 07:38:26-                     DXM(01a2) 4 04108:Queue dxm.in has
</PRE>been closed
<PRE> &gt;&gt; qm(2003)
1998/02/03 07:38:26-                     DXM(01a2) 4 04107:Queue dxm.in has
</PRE>been opened (physical location is q\dxm.in)
<PRE> &gt;&gt; qm(1884)
1998/02/03 07:38:26-                     DXM(01a2) 3 60308:Reading the next
</PRE>MIF partition
<PRE> &gt;&gt; mifparse(925)
1998/02/03 07:38:26-                     DXM(01a2) 3 62321: This is a MIF
</PRE>Update message
<PRE> &gt;&gt; dxmpi(798)
1998/02/03 07:38:26-                     DXM(01a2) 3 62314: MIF Header
</PRE>Information :
<PRE> &gt;&gt; dxmpi(2309)
1998/02/03 07:38:26-                     DXM(01a2) 3 62315: &gt; Sender:
</PRE>LINKAGE(DXAMEX)
<PRE> &gt;&gt; dxmpi(2310)
1998/02/03 07:38:26-                     DXM(01a2) 3 62316: &gt; Recipient:
</PRE>LINKAGE(DXM)
<PRE> &gt;&gt; dxmpi(2313)
1998/02/03 07:38:26-                     DXM(01a2) 3 62312: &gt; Sequence
</PRE>Number: 13: 1998/2/3 7:37:56.13
<PRE> &gt;&gt; dxmpi(2317)
1998/02/03 07:38:26-                     DXM(01a2) 3 62325: &gt; 5
</PRE>transaction(s) in this message
<PRE> &gt;&gt; dxmpi(2328)
1998/02/03 07:38:26-                     DXM(01a2) 3 60316:Create an
</PRE>acknowledgement for agent 1, sequence 13, partition 1
<PRE> &gt;&gt; mifpbld(476)
1998/02/03 07:38:26-                     DXM(01a2) 3 60330:New
</PRE>acknowledgement is being created for agent 1
<PRE> &gt;&gt; mifbuild(217)
1998/02/03 07:38:26-                     DXM(01a2) 4 04107:Queue router.in
</PRE>has been opened (physical location is q\router.in)
<PRE> &gt;&gt; qm(1884)
1998/02/03 07:38:26-                     DXM(01a2) 3 60326:Creating a new
</PRE>partition in the queue c:\linkage\q\archive\
<PRE> &gt;&gt; mifbuild(591)
1998/02/03 07:38:26-                     DXM(01a2) 3 60284:Writing header
</PRE>with sequence 13, part 1
<PRE> &gt;&gt; mifbuild(1006)
1998/02/03 07:38:26-                     DXM(01a2) 3 60248:Searching
</PRE>directory c:\linkage\q\archive\ for MIF partition block files
<PRE> &gt;&gt; mifmpb(1648)
1998/02/03 07:38:54-                     LDE(018e) 4 10153:Subtask
</PRE>DXM(lsdxm.exe) has ended with return code 0
<P>
In the Linkage Administrator Process Manager window, the Directory Exchange
Manager (DXM) process will be halted (red stop sign).
<P>
<P><h2>CAUSE</h2>
 
<P>
The NAMEM macro is used to extract the Middle Name of the Fullname
attribute, also known as the Display Name. If the NAMEM macro encounters a
Display name in the format: Last, First, Middle, and the First name is
blank, the NAMEM macro will cause an Access Violation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, obtain the following fix or wait for the next
Linkage Directory Exchange service pack. The Linkage Directory Exchange
Manager NAMEM macro has been corrected to handle a null First Name value in
an Exchange Display name using the format: Last, First, Middle.
<P>
This fix should have the following time stamp:
<P>
<PRE>   02/12/98  08:40p               24,576 LSMMDAPI.DLL (Intel)
that

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Linkage Directory Exchange
version 3.2.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
 
<PRE>Keywords          : XFOR
Version           : winnt:4.0,5.0,5.5
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 24, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
