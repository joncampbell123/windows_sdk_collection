

<HTML>
<HEAD>
<TITLE>XADM: High Store.exe CPU Utilization During IS Maintenance </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159297">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1997/01/28">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  A single thread in the Store.exe process is utilizing 90%-100% of the CPU  processor time. This high utilization coincides with the start of Microsoft Exchange Information Store (IS) Maintenance window (as configured by the IS  Maintenance Schedule...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAD2,QAFI,QBXB,QBWS,QAL4,QABI,QBW2,QAY0,QAJP,QABH,QBXD,QDIZ,QBWU,QA2Q,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: High Store.exe CPU Utilization During IS Maintenance</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159297</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A single thread in the Store.exe process is utilizing 90%-100% of the CPU 
processor time. This high utilization coincides with the start of Microsoft
Exchange Information Store (IS) Maintenance window (as configured by the IS 
Maintenance Schedule) and does not stop unless the Information Store Service 
is cycled or the computer itself is cycled.
<P>
<P><h2>CAUSE</h2>
 
<P>
One of the checks during the IS Maintenance schedule is that of Public
Folder expires. During the IS maintenance run, the System (or Site) Folders
are also checked. These include the Offline Address Book, the Schedule+ Free
Busy folder, and the Organization Forms. In particular, the Schedule+ Free
Busy folder has a default 7 day expiry on it so it is checked during the 
expiry period of IS Maintenance. The function performing the expiry check on
the Schedule+ Free/Busy folder encounters a second copy of the folder in the 
deleted folders table and this causes the function to remain in a tight loop 
causing the high CPU utilization.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this issue a rebuild of the Site folders is necessary. To
rebuild the Site folders, follow these steps:

<OL><P><LI> Obtain a copy of the utility Guidgen.exe. This utility is available in
<P><PRE>    the Microsoft Developers Network under the product samples. If you do
    not have access to this utility, Contact Microsoft Product Support
    Services. The Guidgen utility will randomly generate a globally unique
    identifier (UID) that will be used to rebuild the site folders.
</OL></PRE>2.  Run Guidgen and select Option 4, Registry Format.
3.  Click New GUID.
4.  Copy or write down the new GUID number from the RESULT box. This number
<PRE>    will be needed in Step 10.
</PRE></OL>5.  Run the Microsoft Exchange Administrator program in "raw" mode. To do
<PRE>    this, go to the command line, change to the Exchsrvr\Bin directory, and
    type "admin /r".
</PRE>6.  Select the Configuration container of the Site you want to rebuild and
<PRE>    highlight the Information Store Site Configuration object.
</PRE>7.  Select File, Raw Properties.
8.  In the Object Attributes window, scroll down to the Site Folder GUID
<PRE>    attribute and select it.
</PRE>9.  Click Editor.
10. Replace the existing GUID number with the one generated in Step 2 (the
<PRE>    value should be entered in hexadecimal) and then click OK.
</PRE>11. Click the SET button. After doing this, make sure the Edit Value
<PRE>    and Attribute Value are the same.
</PRE>12. Click OK to close the dialog box.
13. Stop and restart the Information Store service with the Networks tool
<PRE>    in Control Panel.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The re-creation of the Site folders will delete any existing content. To
re-populate the Site folders with data see below:
<P>
Repopulating the Site Folders with Data
 
<P>
<P><h3>Offline Address Book</h3>
 
To repopulate the offline address book Site Folder:

<OL><P><LI>Run the Microsoft Exchange Administrator program.
</OL>2. Select the Configuration container and get the Properties on the DS
<PRE>   Site Configuration object.
</PRE></OL>3. Click the Offline Address Book tab and click Generate Offline Address
<PRE>   Book Now.

</PRE><h3>Schedule+ Free Busy Information</h3>
 
The Schedule+ Free Busy Information Site Folder will be repopulated as
users log on to Schedule+ and generate changes. During this period some
users' Free Busy information will be temporarily unavailable.
<P>
<P><h3>Organizational Forms</h3>
 
If there was an Organizational Forms Site Folder, it must be re-created
using the Microsoft Exchange Administrator program.

<OL><P><LI>Run the Microsoft Exchange Administrator program.
</OL>2. Click Tools, click Forms Administrator and click New.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbfaq  spinning<BR>
Keywords          : XADM kbusage<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
