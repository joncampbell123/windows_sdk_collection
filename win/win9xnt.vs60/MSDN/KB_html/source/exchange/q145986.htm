

<HTML>
<HEAD>
<TITLE>XCON: Illegal Country Code in X400 Address Causes MTA to Hang </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145986">
<META NAME="KBModify" CONTENT="1997/09/11">
<META NAME="KBCreate" CONTENT="1996/06/03">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix4.00 kbfix5.00.sp1 XCON kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange message transfer agent (MTA) may stop responding after logging content conversion error messages similar to the following:     message NMI0210: X.400 Service Event, severity 14        (MTA DISP:FANOUT(15) Proc 112) 05-14-97 0...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDO3,QAR4,QA6A,QAK9,QABC,QAKP,QAEV,QAC2,QAA1,QDNN,QDI2,QBE7,QBE6,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Illegal Country Code in X400 Address Causes MTA to Hang</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145986</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange message transfer agent (MTA) may stop responding
after logging content conversion error messages similar to the following:
<P>
<PRE>   message NMI0210: X.400 Service Event, severity 14

      (MTA DISP:FANOUT(15) Proc 112) 05-14-97 08:21:37pm
      Content conversion failed
      Object at fault  06006364
      Conversion error 1029
      MTS Identifier   C=US;A=ABC;P=ABCMAIL;L=ABC+A85E08EENDSCA.TEW.55
      Old content type 56010A00
      New content type 2A864886F7140501

   message NMI0062: X.400 Service Event, severity 12

      (MTA DISP:FANOUT(15) Proc 112) 05-14-97 08:21:37pm
      Delivery failure
      X.400 reason code     unable-to-transfer
      X.400 diagnostic code content-type-not-supported
      Internal qualifier    0
      MTS Identifier C=US;A=ABC;P=ABCMAIL;L=ABC+A85E08EENDSCA.TEW.55

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange versions
4.0 and 5.0.
<P>
A supported fix to this problem in Microsoft Exchange version 4.0 is in
development, but has not been fully regression-tested and should be applied
only to systems experiencing this specific problem. Unless you are severely
impacted by this specific problem, Microsoft recommends that you wait for
the next Service Pack that contains this fix. Contact Microsoft Technical
Support for more information on the availability of this fix.
<P>
This problem was corrected in the latest Microsoft Exchange 5.0 Server U.S.
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This problem occurs when the Exchange MTA receives a message from a foreign
MTA that has an illegally formed X400 address containing a country code
with a single character. All X400 country codes must be either two or three
characters long.
<P>
The MTA hangs when it attempts to perform content conversion on the message
containing the invalid address. The Microsoft Exchange version 4.0 SP1,
SP2, SP3, and SP4 MTA will not log content conversion failures to the
BF0.LOG files if APDU logging is enabled. However, the Microsoft Exchange
version 5.0 MTA will log content conversion errors to the BF0.LOG files if
APDU logging has been enabled. This functionality has also been added for
all 4.0 MTAs starting with build 996.18 which is a post SP4 build. This
feature is extremely desirable since it allows messages that fail content
conversion to be logged to the APDU logs in order to determine the cause of
the failure. APDU logging is enabled by setting APDU logging to maximum and
X.400 Service logging to minimum.
<P>
<P><h3>Notes on Installing the Fix</h3>
 
<P>
MTA Build 996.18 is the official hotfix that resolves this problem
for Microsoft Exchange Server 4.0 . The files included in this hotfix are:
<P>
<PRE>   EMSMTA.EXE
   MTACHECK.EXE
   ADDRESS.DLL
   EMS_RID.DLL
   MMIEXT.DLL
   MTALOG.DLL
   SAALOG.DLL
   P2.XV2
   DCPRODS.CAT
   INFOTLOG.CFG

</PRE>These files are located in the following directories in Microsoft Exchange
Server:
<P>
<PRE>   Exchsrvr\bin
      Emsmta.exe
      Mtacheck.exe
      Address.dll
      Ems_rid.dll
      Mmiext.dll
      Saalog.dll
      P2.xv2
      Dcprods.cat

   Exchsrvr\mtadata
      p2.xv2
      Dcprods.cat
      Infotlog.cfg

   Exchsrvr\Res
      Mtalog.dll

</PRE>The P2.xv2 and Dcprods.cat files should be placed in both the Exchsrvr\Bin
and Exchsrvr\Mtadata directories. The Mmiext.dll needs to be installed in
the same directory as the Microsoft Exchange Server Administrator program.
By default, the Microsoft Exchange Server Administrator program is usually
installed to Exchsrvr\Bin directory, but the administrator may have chosen
to install the Microsoft Exchange Server Administrator program to a
different location. This needs to be verified before the hotfix is
installed. Finally, the Mtalog.dll filename was changed to Mtamsg.dll for
Microsoft Exchange Server 5.0.
 
<PRE>Keywords          : kbbug4.00 kbbug5.00 kbfix4.00 kbfix5.00.sp1 XCON kbusage
Version           : 4.05.0
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
