

<HTML>
<HEAD>
<TITLE>XCLN: ShivaRemote with Exchange (WFW 3.11/WFW TCP/IP or NetBEUI) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158111">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1996/10/23">
<META NAME="Keywords" CONTENT="XCLN kbenv kbsetup kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  A white paper on ShivaRemote is located on Microsoft TechNet and can also be found on the following World Wide Web location:     http://www.microsoft.com/ExchangeSupport/  ShivaRemote 3.59 (which ships with Microsoft Exchange) can be used with the ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAA1,QBWP,QDI2,QBWS,QAVZ,QDL9,QBWQ,QBWN,QDIZ,QAI5,QARL,QAYC,QAD7,QBWD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: ShivaRemote with Exchange (WFW 3.11/WFW TCP/IP or NetBEUI)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158111</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A white paper on ShivaRemote is located on Microsoft TechNet and can also
be found on the following World Wide Web location:
<P>
<PRE>   <B><A href="http://www.microsoft.com/exchangesupport/">http://www.microsoft.com/ExchangeSupport/</A></B>

</PRE>ShivaRemote 3.59 (which ships with Microsoft Exchange) can be used with the
Microsoft Exchange Windows 3.x client to allow users to remotely access a
computer running Microsoft Exchange Server (either through a computer
running Windows NT Server with RAS or Shiva LanRover). This article shows
you how to install and configure the ShivaRemote software to run under
Windows for Workgroups 3.11 with either Microsoft NetBEUI or Microsoft
TCP/IP version 3.11b.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Note that the version of Remote Access Service (RAS) that ships with
Windows for Workgroups can be used to access a computer running Microsoft
Exchange Server; however, the remote mail features of Microsoft Exchange
(offline folders and remote mail) cannot be used with Windows for
Workgroups RAS (Windows for Workgroups RAS does not support the APIs
necessary for remote mail). Also, if you are using Windows for Workgroups
RAS, you must first make a connection with Windows for Workgroups RAS prior
to starting the Microsoft Exchange client.
<P>
The ShivaRemote software that ships with Microsoft Exchange will allow full
remote mail functionality with Microsoft Exchange.
<P>
Attempting to use ShivaRemote in conjunction with other network card
adapter drivers (for example, for users who want to be "docked" and
"undocked" with a laptop) may result in error messages or the computer may
stop responding when starting Windows for Workgroups. This is due to the
fact that Windows for Workgroups loads drivers for all configured network
adapters on startup. If a network adapter is present in the docking station
but not available when the laptop is undocked, this may cause the computer
to stop responding while attempting to locate the non-existent LAN adapter.
<P>
This overall problem has been addressed in Windows 95 and Windows NT 4.0
with the concept of Hardware Profiles. Hardware profiles allow for seamless
docking/undocking for mobile users and will be most appropriate for users
who require this feature.
<P>
For troubleshooting purposes, first follow the procedures in this article
and set up ShivaRemote as the only netcard driver in network setup. Once
this is set up and working, you can attempt to add an additional netcard
driver. If adding the additional driver prevents starting of Windows for
Workgroups or causes problems with ShivaRemote, it may be necessary to
create an MS-DOS multiconfig boot (reference your MS-DOS 6.x manual for
information on creating multiple configurations) and dynamically rename
Protocol.ini and System.ini, depending on the boot option selected.
<P>
NOTE: Whether both the netcard driver and ShivaRemote driver can "coexist"
will depend on the netcard and the netcard driver involved.
<P>
NOTE: With Protocol.ini and System.ini being renamed dynamically on
startup, BOTH files will need to be updated whenever a new application is
installed.
<P>
Depending on your environment, an upgrade to Windows 95 or Windows NT
4.0 may offer a much smoother solution to the above problem.
<P>
NOTE: ShivaRemote is unnecessary for Windows 95 or Windows NT. Microsoft
Exchange will use the built-in Dial-up Networking (Windows 95) or RAS
(Windows NT) features of the operating system in these scenarios).
<P>
(For information about setting up Shiva for use over other
protocols, see the Reference section below).
<P>
To configure ShivaRemote and Microsoft Exchange:

<OL><P><LI>Test the modem connection from Terminal.exe to ensure the modem
   itself is able to dial out and to verify the proper comm port.
<P>
   For more information about using terminal to test your modem, see the
   following article from the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win3x/q105940.htm">Q105940</A></B>
<PRE></PRE>      TITLE     : Troubleshooting Serial Port Problems in Windows

</PRE><P><LI>Install the Microsoft Exchange client software (run Setup from the
   Microsoft Exchange client compact disc or from a sharepoint). Select
   Custom install and verify that the Shiva component is selected. (Setup
   will create a "shivaremote setup" icon in the Microsoft Exchange
   program group.)

<P><LI>If possible, verify a valid Microsoft Exchange mailbox/account exists
   while connected to the LAN. (Start the Microsoft Exchange client,
   create a profile and make sure you can log into your mailbox and send a
   piece of mail to yourself.)

<P><LI>Run "shivaremote setup" from the Microsoft Exchange program group.

<P><LI>When prompted to Install ShivaRemote dial-in software and Update
   Windows for Workgroups files, select both and click OK.

<P><LI>Select the port and your specific modem manufacturer/model.
<P>
   NOTE: <B><A href="http://www.shiva.com/prod/ccl/modemstr.html">http://www.shiva.com/prod/ccl/modemstr.html</A></B> has updated scripts
   for many modems.

<P><LI>At the Protocol Configuration dialog, select "enable netbeui" or
   "enable ip," or both, but NOT "enable IPX."  Microsoft IPX/SPX protocol
   is not compatible with ShivaRemote.
<P>
   Note: TCP 3.11 b can be installed from the Windows NT 3.51 Server
   compact disc under Clients/TCP32WFW/netsetup.

<P><LI>Configuration files will be changed (backups are saved). Click OK to
   each.

<P><LI>Click OK to the message prompting you to configure your network.

<P><LI>Answer "no" to rebooting.

<P><LI>Add the ShivaRemote Dial In Adapter to Windows for Workgroups:
<P>
   a. Open the "Network" group in Windows for Workgroups.
<P>
   b. Click the Network Setup icon, cl;ick the Drivers button, and click
<P><PRE>      the Add Adapter button.
</PRE><P>
   c. Select "unlisted or updated network adapter," and click OK.
<P>
   d. Click "browse," and browse to the directory where the Microsoft
<P><PRE>      Exchange client was installed.
</PRE><P>
   e. Select the Shiva subdirectory and click OK.
<P>
   f. Click OK in the install driver dialog box.
<P>
   g. "ShivaRemote dial-in driver" should then be an option under Network
<P><PRE>      Adapters. Click OK, then "close". (You can safely remove IPX/SPX as a
      protocol and leave only NetBEUI). Click OK.
</PRE><P>
   h. When you are prompted "The files for enhanced mode protocol manager
<P><PRE>      are currently installed on your computer," click "yes to all."
</PRE><P>
   i. Insert the appropriate Windows for Workgroups disks when prompted.
<P>
   j. When prompted "Insert Shivaremote Dial-In Software Disk or a disk
<P><PRE>      with the updated or vendor-provided DialNDIS.exe file,"
      browse to the Exchange_Install_Point/Shiva directory and click OK.
</PRE><P>
   k. Your System and Protocol.ini files will be modified (and backups
<P><PRE>      saved as well).Click OK.
</PRE><P>
   l. Click Restart Computer.

<P><LI>Ensure that the files Ndis2sup.386 and Netbeui.386 are properly
   extracted from the exchange cab files during Setup. The correct dates
   and sizes are:
<P>
<P><PRE>      ndis2sup.386 dated 3/4/96, size 23736
      netbeui.386 dated 3/4/96, size 37043
</PRE><P>
   If these files are NOT updated by Shiva, Windows for Workgroups will
   appear to stop responding for about two minutes when booting. To
   manually update the files, do the following:
<P>
   From the Microsoft Exchange client compact disc (Eng/Win16 dir), carry
   out the following command(from the Eng/win16 directory):
<P>
<P><PRE>      extract /a /l c:\windows_dir\system exchng1.cab netbeui.386
      (where windows_dir is your Windows for Workgroups directory)
      extract /a /l c:\windows_dir\system exchng1.cab ndis2sup.386
</PRE><P>
   You can also use Cabview or another extraction utility to do this.
<P>
   NOTE: Extract.exe is not on the Exchange compact discs; you will have to
   obtain Extract.exe either from a Windows 95 or Microsoft Office install.

<P><LI>Once you have the above setup, reboot and ensure you receive no error
   messages when booting with the newly configured autoexec.bat and
   Config.sys.

<P><LI>Specify a Description, Dial-in-Name (NT account that has been granted
   dial-in access on the server), Password (Password for the NT Account
   you are dialing in on), and Phone number in the Shiva connect utility.

<P><LI>Dial the computer running  RAS. (Microsoft Exchange is supported
   dialing into either a Windows NT RAS server or a Shiva LanRover.)

<P><LI>Once connected, minimize ShivaRemote Connect.

<P><LI>Prior to starting Exchange, verify that you have network connectivity
   over the Shiva connection by attempting to connect to a network share
   on the computer running Microsoft Exchange server from File Manager (if
   using NetBEUI) or attempting to ping the machine name of the computer
   running Microsoft Exchange Server (if using TCP).

<P><LI>If using TCP/IP, edit the local HOSTS file and add the Microsoft
   Exchange Server name and IP address.
<P>
   For more information on the HOSTS file, see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE ID: <B><A href="../winnt/q105997.htm">Q105997</A></B>
<PRE></PRE>      TITLE     : Differences Between the HOSTS and LMHOSTS Files in
                  Windows NT

</PRE><P><LI>Start the Microsoft Exchange Windows 3.x client (online, as a test).
   Type the User Name (Exchange Mailbox Name), the Password (Windows NT
   Domain Password), and the Domain (Windows NT Domain Name of your
   Mailbox Account). Verify you can be properly logged on to Microsoft
   Exchange and send mail to yourself.
<P>
</OL>If the above steps allow you to properly send/receive mail, ShivaRemote and
Microsoft Exchange are configured correctly.
<P>
The Microsoft Exchange client remote capabilities can now be configured
(remote mail or off-line folders). To set up the Microsoft Exchange client
to automatically dial while working offline :

<OL><P><LI>In Control Panel/Mail-Fax, select the properties for Microsoft Exchange
   Server in the profile and on the "dial up networking" tab.

<P><LI>Select the Shiva connection name that was tested in step 1 under "dial
   using the following connection."

<P><LI>Type the user name, password, and domain name in the dialog box.
<P>
</OL>You can start the Microsoft Exchange client offline and click either remote
mail/connect or "sync this folder." ShivaRemote will dial and transmit
necessary information (depending on whether offline folders [.ost files] or
.pst files are being used).
<P>
<P><h2>REFRENCE</h2>
 
<P>
Updated modem scripts for use with ShivaRemote can be found on Shiva's
web page at www.shiva.com under "support"/modem scripts.
<P>
Additional configuration information can also be found in the Config.hlp
file installed with the ShivaRemote software.
<P>
For more information about specific remote options with the Microsoft
Exchange client, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE ID: <B><A href="../exchange/q139934.htm">Q139934</A></B>
   TITLE     : XCLN: The Microsoft Exchange Client and Mobile Users

</PRE></OL>The following articles in the Microsoft Knowledge Base describe additional
supported Shiva configurations for use with Microsoft Exchange:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q158124.htm">Q158124</A></B>
   TITLE     : XCLN: ShivaRemote with Exchange - RAS Considerations

   ARTICLE-ID: <B><A href="../exchange/q158074.htm">Q158074</A></B>
   TITLE     : XCLN: Using ShivaRemote with Exchange (DOS/Real-Mode IPX)

   ARTICLE-ID: <B><A href="../exchange/q157740.htm">Q157740</A></B>
   TITLE     : XCLN: Using ShivaRemote with Exchange (DOS/LanMan TCP/IP)

   ARTICLE-ID: <B><A href="../exchange/q158095.htm">Q158095</A></B>
   TITLE XCLN: ShivaRemote with Exchange (Windows 3.x/LanMan NetBEUI)

   ARTICLE-ID: <B><A href="../exchange/q158077.htm">Q158077</A></B>
   TITLE XCLN: Using ShivaRemote with Exchange (Windows 3.x/Real-Mode IPX)

</PRE>The third-party contact information included in this article is provided to
help you find the technical support you need. This contact information is
subject to change without notice. Microsoft in no way guarantees the
accuracy of this third-party contact information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: remote mail<BR>
Keywords          : XCLN kbenv kbsetup kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
