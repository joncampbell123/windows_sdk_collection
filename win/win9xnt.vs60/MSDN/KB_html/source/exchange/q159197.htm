

<HTML>
<HEAD>
<TITLE>XADM: Controlling Folder Index Aging </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159197">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1997/01/09">
<META NAME="Keywords" CONTENT="kbusage XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Client-created database table indexes (used for views) that have not been used for a given time interval are deleted (they will be re-created as needed). The default index age at which they are purged is eight days. This article shows you how to mo...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKD,QAFH,QBXS,QAL0,QALB,QADN,QAU3,QAMR,QA28,QATJ,QAIJ,QABA,QACE,QADK,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Controlling Folder Index Aging</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159197</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
SUMMARY
 
<P>
Client-created database table indexes (used for views) that have not been
used for a given time interval are deleted (they will be re-created as
needed). The default index age at which they are purged is eight days. This
article shows you how to modify the registry to change the time settings
for index aging.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are three registry entries that can control the index aging. These
tasks are performed during the time allotted by the Information Store
Maintenance Schedule. They are listed here in the order in which they are
performed. These tasks will run until completed.
<P>
WARNING: Using the Registry Editor incorrectly can cause serious problems
that may require you to reinstall Windows NT. Microsoft cannot guarantee
that problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.
<P>
<P><h3>Aging Keep Time</h3>
 
<P>
This is the time (in milliseconds) after which a view is cached even though
it is not currently in use by a client.
<P>
Public Information Store:
<P>
To modify this registry key to change Aging Keep Time for the Public
Information Store:

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeIS\ParametersPublic
</PRE>
<P><LI>Create a value named "Aging Keep Time" of type REG_DWORD.

<P><LI>The default value for Aging Keep Time, without this registry entry, is
   691200000 (8 days in milliseconds - 1000*60*60*24*8). Set the value to
   the new Aging Keep Time in milliseconds.

<P><LI>Quit Registry Editor.
<P>
</OL>Private Information Store:
<P>
To modify this registry key to change Aging Keep Time for the Private
Information Store:

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeIS\ParametersPrivate
</PRE>
<P><LI>Create a value named "Aging Clean Interval" of type REG_DWORD.

<P><LI>The default value for Aging Keep Time, without this registry entry, is
   691200000 (8 days in milliseconds - 1000*60*60*24*8). Set the value to
   the new Aging Keep Time in milliseconds.

<P><LI>Quit the Registry Editor.
<P>
</OL><h3>Aging Clean Interval</h3>
 
<P>
The interval (in milliseconds) at which the store checks to see if anything
needs to be removed from the cache. Default value is 24 hours (or 86400000
milliseconds).
<P>
To modify this registry key to change the Aging Clean Interval for the
Public Information Store:
<P>
Public Information Store:

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeIS\ParametersPublic
</PRE>
<P><LI>Create a value named "Aging Clean Interval" of type REG_DWORD.

<P><LI>The default value of the Aging Clean Interval, without this registry
   entry, is 86400000 (or one day in milliseconds - 1000*60*60*24). Set the
   value to the new Aging Clean Interval in milliseconds.

<P><LI>Quit Registry Editor.
<P>
</OL>Private Information Store:
<P>
To modify this registry key to change the Aging Clean Interval for the
Private Information Store:

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeIS\ParametersPrivate
</PRE>
<P><LI>Create a value named "Aging Clean Interval" of type REG_DWORD.

<P><LI>The default value the Aging Clean Interval, if this registry entry is
   missing, is 86400000 (or one day in milliseconds - 1000*60*60*24).
   Set the value to the new Aging Interval in milliseconds.

<P><LI>Quit the Registry Editor.
<P>
</OL><h3>Reset Views</h3>
 
<P>
If this parameter exists and is set to a non-zero value, the Information
Store deletes all cached restrictions on the next cleaning interval and
resets the value to zero. This could be used to manually dump the
restrictions at each cleaning interval by setting it whenever a new
restriction is created. It will not dump restrictions that are actively
being used by clients.
<P>
Public Information Store:
<P>
To modify this registry key to change the Reset Views for the Public
Information Store:

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeIS\ParametersPublic
</PRE>
<P><LI>Create a value named "Reset Views" of type REG_DWORD.

<P><LI>The default value of the Reset Views, without this registry entry, is 0.
   Set the value to 1.

<P><LI>Quit Registry Editor.
<P>
</OL>Private Information Store:
<P>
To modify this registry key to change the Reset Views for the Public
Information Store:

<OL><P><LI>Start Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      System\CurrentControlSet\Services\MSExchangeIS\ParametersPrivate
</PRE>
<P><LI>Create a value named "Reset Views" of type REG_DWORD.

<P><LI>The default value the Aging Clean Interval, without this registry entry,
   is 0. Set the value to 1.

<P><LI>Quit the Registry Editor.
<P>
</OL><h2>REFERENCE</h2>
 
<P>
For additional information on tasks performed by the IS Maintenance
Schedule, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q159196.htm">Q159196</A></B>
   TITLE     : XADM: Tasks Controlled by the IS Maintenance Schedule

</PRE></OL>For additional information on the Aging Keep Time parameter, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q156970.htm">Q156970</A></B>
   TITLE     : XADM: Improving Performance with Public Folder Views
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: restrictions<BR>
Keywords            : kbusage XADM<BR>
Version             : 4.0 5.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
