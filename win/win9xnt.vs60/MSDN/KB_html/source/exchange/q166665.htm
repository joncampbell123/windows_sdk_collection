

<HTML>
<HEAD>
<TITLE>XCLN: Troubleshooting AppleTalk Connection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166665">
<META NAME="KBModify" CONTENT="1998/03/13">
<META NAME="KBCreate" CONTENT="1997/04/09">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Macintosh client cannot use AppleTalk network protocol to connect to the computer running Microsoft Exchange Server. The following error message may appear:     Your Microsoft Exchange Server is unavailable.  CAUSE =====  Usu...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDO9,QAI5,QABI,QBTX,QABH,QBWS,QBG2,QBVV,QARL,QDIK,QAA1,QAWK,QATQ,QAJG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Troubleshooting AppleTalk Connection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166665</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Macintosh client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Macintosh client cannot use AppleTalk network
protocol to connect to the computer running Microsoft Exchange Server. The
following error message may appear:
<P>
<PRE>   Your Microsoft Exchange Server is unavailable.

</PRE><h2>CAUSE</h2>
 
<P>
Usually, these symptoms mean a connection to the computer running Exchange
Server cannot be made. It could also mean the server is down, AppleTalk is
not being routed between network segments, or the Windows NT Services are
not configured correctly. To determine the cause, answer the
troubleshooting questions below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Troubleshooting</h3>
 

<OL><P><LI>Has AppleTalk been configured on the Macintosh?
<P>
   Go to the Apple Menu, Control Panels, AppleTalk. Make sure the "Connect
   Via" is set to Ethernet (or whatever is applicable for your network).
   The "current zone" should appear in the box below. If this hasn't been
   activated, make sure to activate after selecting connection.

<P><LI>Has Services for Macintosh been installed and configured and is it
   running on the computer running Windows NT Server and Exchange Server?
<P>
   If Services for Macintosh has been installed, you will see this under
   File Service for Macintosh in Control Panel Services. This should be set
   as Automatic, and Status should be Started. If this has not been
   installed, refer to Windows NT documentation for installation
   instructions.
<P>
   For additional information on Services for Macintosh, please see the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../exchange/q149202.htm">Q149202</A></B>
<PRE></PRE>      TITLE     : XCLN: Client for Macintosh Release Notes

   Also see the Windows NT Server documentation on MacFile and Services for
   Macintosh.

</PRE><P><LI>Is the MacFile name the same as the machine name of the computer running
   Windows NT Server and Exchange Server?
<P>
   This name needs to be the same for Exchange to access the Exchange
   server correctly, as detailed in the Exchange Macintosh Release Notes.
<P>
   This assumes the previous steps have been completed. To check the name,
   go to Control Panel MacFile. Click Attributes. This will show the server
   name broadcast over AppleTalk.

<P><LI>Are there any restrictions on the MacFile Connections on the computer
   running Windows NT Server and Exchange Server?
<P>
   Again, go to Control Panel MacFile. Click Attributes. Under Sessions, is
   there a limit? If so, is it high enough to allow all Exchange Macintosh
   clients to connect?

<P><LI>Is there additional security restrictions on the MacFile Connections on
   the Windows NT/Exchange Server?
<P>
   Again, go to Control Panel MacFile. Click on the Attributes button.
   Under "Security," clear all options.
<P>
   NOTE: If you allow Guests to log on, then the Macintosh client may be
   using guest authentication to log on, but that should not be enough to
   log on to an Exchange account. You usually need an NT account (that is,
   Exchange Primary NT account) to log on to Exchange.
<P>
   NOTE: It does not matter whether the Allow Workstations To Change
   Passwords check box is selected. If this is not selected, this will
   force the Macintosh to enter a password when logging in. It is
   recommended that you clear this check box, for tighter security.
<P>
   NOTE: The Require Microsoft Authentication option is used for additional
   security, but requires additional setup on the Macintosh (including
   copying over the AppleShare Folder to the Macintosh). For testing, it is
   best to clear this check box to make sure the Macintosh can connect. If
   a connection is successful without this, you know the Macintosh requires
   additional setup. See Windows NT documentation for details.

<P><LI>Do you know the AppleTalk zone? Or, is there a zone set?
<P>
   NOTE: You do not need to set this up if you only have one network
   segment. Exchange will think the AppleTalk zone is *, if no zone is
   selected.
<P>
   To check the AppleTalk zone:

</OL></UL><LI>On the computer running Windows NT Server and Exchange Server, go to
   Control Panels Network, and click the Services tab (for NT 4.0) to see
   the Properties on Services for Macintosh.

<LI>You can select the "default" zone if you already have AppleTalk routing
   set up.
<P>
</UL>-OR-

<UL><LI>You can use the computer running Windows NT Server as the router by
   "Enable Routing," and select the "Use This Router To Seed The Network"
   check box. However, USE WITH CAUTION! This will increase network
   traffic, and will make Windows NT Server an AppleTalk Router for your
   network. This may also cause problems connecting to the Server.

</UL><OL><P><LI>Can the Macintosh workstation see the Exchange server in the Chooser?
<P>
   If so, can the Macintosh connect to a share? This is for testing the
   connection and Windows NT authentication only. You do NOT have to
   connect to a share in order to launch the Exchange client.
<P>
   To check whether the Macintosh can connect to a share:
<P>
   a. From the Macintosh, go to the Apple menu, and click Chooser.
<P>
   b. Click AppleShare. Select the appropriate AppleTalk zone for the
<P><PRE>      computer running Exchange Server, and see whether the "file server"
      is listed under "Select a File Server." Click OK.
</PRE><P>
   c. Click "Registered User". Enter the name and password of the
<P><PRE>      appropriate Windows NT account. Click OK.
</PRE><P>
<P><PRE>      At minimum, there should be a Microsoft UAM Volume. Just highlight
      and see if you can connect. (Do NOT check the box unless you want to
     log on every time the Macintosh starts up.)
</PRE><P>
   d. To disconnect from the share, drag the Volume icon to the trash.

<P><LI>Password problems?
<P>
  For additional information on password problems, please see the following
   articles in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../winnt/q127943.htm">Q127943</A></B>
<PRE></PRE>      TITLE     : Mac Client Can't Logon Because Password Has Expired

      ARTICLE-ID: <B><A href="../exchange/q152923.htm">Q152923</A></B>
      TITLE     : Can't Change Expired Password From MAC Exchange Client

      ARTICLE-ID: <B><A href="../exchange/q153213.htm">Q153213</A></B>
      TITLE     : XCLN: Can't Change Windows NT 3.51 Password w/AppleTalk

      ARTICLE-ID: <B><A href="../exchange/q156182.htm">Q156182</A></B>
      TITLE     : XCLN: Changing Windows NT 4.0 Password in Microsoft
                   Exchange

</PRE><P><LI>Check for errors in the Event Viewer on the computer running Windows NT
   Server and Exchange Server. Specifically, look for login errors,
   AppleTalk load failures, or MacFile failures.
<P>
   For example, if AppleTalk does not load before the Exchange server, then
   Exchange Server does not create the appropriate server entry for
   AppleTalk clients to connect.

<P><LI>If the problem still cannot be identified, get a Network Monitor trace
   between the Macintosh client, Exchange Server, and any primary domain
   controllers (PDCs) or backup domain controllers (BDCs). For example, if
   there is a router between the Macintosh and Exchange Server, AppleTalk
   routing must be turned on at the Router.

<P><LI>If the server has changed AppleTalk zones, the Macintosh Exchange
   clients must create new Exchange Profiles.
</OL> 
<PRE>Version           : Macintosh:4.0,5.0
Platform          : MACINTOSH
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
