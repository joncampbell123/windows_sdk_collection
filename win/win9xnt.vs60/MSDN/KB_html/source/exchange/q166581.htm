

<HTML>
<HEAD>
<TITLE>XADM: Exchange/cc:Mail Dirsync: CR w/ Corrupted Proxy Addresses </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166581">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/04/08">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00.sp2 XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When a cc:Mail administrator moves a cc:Mail user between cc:Mail post offices, and Exchange Server performs a directory synchronization on this change from the CCMC connector post office, the moved user is created as a custom recipient (CR) in the...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QALZ,QAYC,QAR5,QDMO,QAC2,QDKF,QBVW,QAPP,QAGU,QAE1,QAEF,QAHH,QBWD,QAFZ,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Exchange/cc:Mail Dirsync: CR w/ Corrupted Proxy Addresses</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166581</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to

<UL><LI>Microsoft Exchange Server version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a cc:Mail administrator moves a cc:Mail user between cc:Mail post
offices, and Exchange Server performs a directory synchronization on this
change from the CCMC connector post office, the moved user is created as a
custom recipient (CR) in the Exchange Server directory, but the proxy
addresses generated for the user may be corrupted (appended with a number).
<P>
<P><h2>CAUSE</h2>
 
<P>
When comparing the CCMC connector's post office with the Exchange Server CR
list, "adds" are processed before "deletes." Because the desired proxy
addresses are already in use, new proxies for the adds are generated
(typically as corrupted versions of the desired address).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, manually modify a moved cc:Mail user's proxy
addresses in Exchange Server to match what was previously generated or
established for the user.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.0. This problem has been corrected in the latest U.S. Service
Pack for Microsoft Exchange Server version 5.0. For information on
obtaining the Service Pack, query on the following word in the Microsoft
Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The algorithm for processing the CCMC connector post office's global list
compares the cc:Mail connector post office's global list with the Exchange
Server CR list, adding any cc:Mail addresses that weren't present in the
Exchange CR container. Any Exchange Server CRs that don't have a match in
the cc:Mail global list are subsequently deleted. This is efficient because
it requires only one comparison between lists.
<P>
However, users in cc:Mail may be deleted and re-created or moved to
different cc:Mail post offices. This usually results in the cc:Mail address
on cc:Mail connector postoffice as having the same name, but different post
office specifics. Because Exchange Server processes new cc:Mail addresses
as "adds" first, this new name ends up with corrupted proxy addresses in
Exchange Server, which invalidates the old X.400, SMTP and other addresses
that foreign e-mail users may have previously cached for this cc:Mail user.
<P>
With the fix applied, the algorithm compares the Exchange Server CR list
against the cc:Mail global list on the CCMC connector post office, first
removing any Exchange Server CR that doesn't have a match in the cc:Mail
list, thus freeing up previously assigned proxy addresses for re-use.
Afterwards, the cc:Mail list is compared against the Exchange CR list,
adding entries that exist on the cc:Mail post office that don't exist in
the Exchange CR list. Users whose post office details have changed can have
their previous proxies regenerated for their new address. Because two
comparisons are now made, this algorithm is somewhat less efficient, but
has proved to perform adequately with reasonable hardware.
<P>
NOTE: Exchange CCMC dirsync does not integrate into the cc:Mail dirsync
process. It simply compares its CR list with the global list on the cc:Mail
post office as it exists at the time dirsync runs.
<P>
In the case of maintaining proxy addresses, it is presumed that only one
cc:Mail address will exist at any time for a given user on the CCMC
connector post office. If two addresses exist for a user at the time the
dirsync between Exchange and CCMC runs, the new address will have corrupted
proxies generated.
<P>
Also, if a cc:Mail mailbox is deleted, and then, at a later time a new user
is created in cc:Mail that has the same mailbox name as the former mailbox,
Exchange will generate proxies based on this mailbox name. These proxies
may match a former cc:Mail mailbox address; thus users of foreign mail
systems, who previously e-mailed to the former address, may inadvertently
send mail to the new mailbox.
 
<PRE>Keywords          : kbbug5.00 kbfix5.00.sp2 XADM kbusage
Version           : winnt:5.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
