

<HTML>
<HEAD>
<TITLE>XFOR: DXA Crashing with Event ID 268 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153658">
<META NAME="KBModify" CONTENT="1997/08/26">
<META NAME="KBCreate" CONTENT="1996/07/12">
<META NAME="Keywords" CONTENT="kbbug4.00 XFOR kbusage buglist">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Directory Synchronization Service (DXA) crashes when attempting to process an incoming Directory Synchronization (DirSync) message when running Windows NT version 4.0 Service Pack 2 (SP2) and 128 bit encryption. When you chec...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABA,QA2O,QBWP,QAPN,QAO4,QAAD,QAB4,QAAP,QBW5,QDO3,QDNN,QAK7,QBXB,QATJ,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: DXA Crashing with Event ID 268</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153658</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Exchange Server, version 4.0
<LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Directory Synchronization Service (DXA) crashes when
attempting to process an incoming Directory Synchronization (DirSync)
message when running Windows NT version 4.0 Service Pack 2 (SP2) and 128
bit encryption. When you check the Windows NT Application Event log, you
will find the following error:
<P>
<PRE>   Event ID: 268
   Source: MSExchangeDX
   Description: An error occurred when attempting to open a temporary file
   In the DXADATA directory. Ensure that there is enough disk space to
   Perform this action.

</PRE>NOTE: This error message is misleading because the problem really has
nothing to do with lack of disk space.
<P>
<P><h2>CAUSE</h2>
 
<P>
The 128 bit encryption Security.dll that ships with Windows NT version
4.0 SP2 was rebased to a new address that, when loaded, blocked the DXA
from creating the necessary memory mapped file it needs when processing
DirSync messages.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To find out if the Security.dll files is based correctly, there are two
methods. The first is to perform the following steps:

<OL><P><LI>Start the Windows NT Explorer.
</OL>2. Change to the %systemroot%\system32 directory.
3. Select the Security.dll file.
4. From the File menu, click Quick View.
5. Scan the Quick View window for the string "Image Base".
6. If it shows 46480000, the file is incorrectly based.
<P>
The second method is to use Dumpbin.exe (available in Microsoft Development
Studio).
<P>
Using Dumpbin.exe, verify that the DLL in question is indeed based at
46480000. This can be done with the following command:
<P>
<PRE>   DUMPBIN /HEADERS SECURITY.DLL

</PRE></OL>Scan the output for the OPTIONAL HEADERS SECTION looking for the 'image
base' parameter. The following is a sample output of the incorrectly based
DLL:
<P>
<PRE>   Microsoft (R) COFF Binary File Dumper Version 4.20.6164
   Copyright (C) Microsoft Corp 1992-1996. All rights reserved.

   Dump of file security.dll

   PE signature found

   File Type: DLL

   FILE HEADER VALUES
        14C machine (i386)
          6 number of sections
   3338158D time date stamp Tue Mar 25 10:12:29 1997
          0 file pointer to symbol table
        2D7 number of symbols
         E0 size of optional header
       2302 characteristics
               Executable
               32 bit word machine
               Debug information stripped
               DLL

   OPTIONAL HEADER VALUES
        10B magic #
       3.10 linker version
       7800 size of code
       2E00 size of initialized data
          0 size of uninitialized data
       1000 address of entry point
       1000 base of code
       9000 base of data
            ----- new -----
   46480000 image base&lt;--- This is the parameter in question.

</PRE>The file can be rebased to the original base address (77A80000) by running
Rebase.exe against the DLL with the following command:
<P>
<PRE>   REBASE -b 77A80000 SECURITY.DLL

</PRE>The server in question should be rebooted after this has been rebased.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows NT version 4.0 SP2
with 128 bit encryption. It has been fixed in Windows NT version 4.0 SP3.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Similar symptoms can also occur with Microsoft Exchange Server version 5.0.
The event logged is:
<P>
<PRE>   EventID: 249
   Source: MSExchangeDX
   Type: Error
   Category: Startup
   Description:
   Error -1201 occurred while trying to create a new database.

</PRE>The workaround and status sections apply to version 5.0 as well.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: DXA.DBG DXA.EXE<BR>
Keywords          : kbbug4.00 XFOR kbusage buglist<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
