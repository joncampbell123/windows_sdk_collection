

<HTML>
<HEAD>
<TITLE>XFOR: DXA Appends 001 Only When Needed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146676">
<META NAME="KBModify" CONTENT="1997/09/15">
<META NAME="KBCreate" CONTENT="1996/02/19">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00.sp2 XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  After including Microsoft Exchange Server in the Directory Synchronization process of your Microsoft Mail environment, some Display Names are appended with 001. This behavior can be seen whether your Microsoft Exchange Server computer is acting as ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QAR4,QAUJ,QAJQ,QDO3,QAFI,QBXB,QATJ,QBWP,QAZQ,QABI,QADX,QACK,QAKP,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: DXA Appends 001 Only When Needed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146676</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After including Microsoft Exchange Server in the Directory Synchronization
process of your Microsoft Mail environment, some Display Names are appended
with 001. This behavior can be seen whether your Microsoft Exchange Server
computer is acting as the dirsync server or a dirsync requester.
<P>
<P><h2>CAUSE</h2>
 
<P>
In any one given Microsoft Mail postoffice, all display names (friendly
names) must be unique. A Microsoft Mail postoffice may have multiple
display names the same in its Global Address List (GAL). For example:
<P>
<PRE>   Bob SmithNET1/PO1/BSMITH
   Bob SmithNET2/PO2/BSMITH

</PRE>The above would be perfectly acceptable in one Microsoft Mail postoffice,
but the following would not:
<P>
<PRE>   Bob SmithNET1/PO1/BSMITH
   Bob SmithNET1/PO1/BSMITH2

</PRE>In Microsoft Mail, neither Admin.exe nor Import.exe would allow the second
Bob Smith to be created.
<P>
Microsoft Exchange Server, on the other hand, will allow multiple objects
to have the same display name. Because of this, the Microsoft Exchange
Directory Synchronization Service (DXA) must ensure that it does not send
the same display name to any one Microsoft Mail postoffice.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, edit the registry as shown below and then
follow the rest of the procedure described below.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Start the Registry Editor (Regedt32.exe).

<P><LI>Under the HKEY_LOCAL_MACHINE subtree, go to the following subkey:
<P>
<P><PRE>      \SYSTEM\CurrentControlSet\Services\MSExchangeDX
</PRE>
<P><LI>Add the following case-sensitive DWORD value of 0:
<P>
<P><PRE>      Unique Display Names
</PRE>
<P><LI>Quit Registry Editor.
<P>
</OL>After setting the registry parameter above, the following steps MUST be
performed.

<OL><P><LI>Stop the Microsoft Exchange Directory Synchronization Service

<P><LI>Delete the contents of the DXADATA subdirectory.  Do not delete the
   directory, only the contents of the directory.

<P><LI>Follow step a or step b below, depending on whether the DXA is acting as
   the dirsync server or the dirsync requester.
<P>
   a. If the DXA is acting as the dirsync server, using the Microsoft
<P><PRE>      Exchange Admin utility, choose each Remote Requester object one by
      one and select the "Export on next cycle" check box on the General
      tab. This will force a full dirsync export to be sent to each Remote
      Requester.
</PRE><P>
   b. If the DXA is acting as a dirsync requester, using the Microsoft
<P><PRE>      Exchange Administrator program, choose the dirsync requester object
      and select the "Export on next cycle" check box on the settings.
      This will force a full dirsync export to be sent to the dirsync
      server.
</PRE>
<P><LI>Start the Microsoft Exchange Directory Synchronization Service.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
versions 4.0 and 5.0.
A supported fix is now available for version 4.0, but has not been fully
regression tested and should be applied only to systems experiencing this
specific problem. Unless you are severely impacted by this specific
problem, Microsoft recommends that you wait for the next Service Pack that
contains this fix. Contact Microsoft Technical Support for more
information.
<P>
This problem has been corrected in the latest U.S. Service Pack for
Microsoft Exchange Server version 5.0. For information on obtaining the
Service Pack, query on the following word in the Microsoft Knowledge Base
(without the spaces):
<P>
<PRE>   S E R V P A C K
</PRE></OL> 
<PRE>Keywords          : kbbug4.00 kbfix4.00.sp2 XADM kbusage
Version           : winnt:4.0,5.0
Platform          : WINDOWS winnt
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
