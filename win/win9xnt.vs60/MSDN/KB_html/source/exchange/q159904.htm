

<HTML>
<HEAD>
<TITLE>XCLN: Using ShivaRemote with Exchange (Win 3.x/LanMan TCP/IP) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159904">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1996/11/24">
<META NAME="Keywords" CONTENT="XCLN kbenv kbsetup kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  A white paper on ShivaRemote is located on Microsoft TechNet and can also be found on the following World Wide Web location:     http://www.microsoft.com/ExchangeSupport/  This article explains how to use ShivaRemote with the Microsoft Exchange Win...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QAVZ,QBFY,QARL,QAA1,QAI5,QBWP,QBWS,QBXT,QA5V,QAIB,QDI2,QDIZ,QBWO,QDKI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Using ShivaRemote with Exchange (Win 3.x/LanMan TCP/IP)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159904</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Windows 3.x client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A white paper on ShivaRemote is located on Microsoft TechNet and can also
be found on the following World Wide Web location:
<P>
<PRE>   <B><A href="http://www.microsoft.com/exchangesupport/">http://www.microsoft.com/ExchangeSupport/</A></B>

</PRE>This article explains how to use ShivaRemote with the Microsoft Exchange
Windows 3.x client, with LAN Manager version 2.2c with TCP/IP. Use the
Config.sys, Autoexec.bat, and Protcol.ini files shown at the end of this
article as models.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Server Considerations</h3>
 
<P>
Configure the Remote Access Server (either Windows NT or a Shiva LanRover)
to allow remote clients to request a predetermined IP address. To use this
option in Windows NT:

<OL><P><LI>In Control Panel, double-click the Network icon.

<P><LI>Click RAS, click Network, and click Server Settings.

<P><LI>Click TCP, and select the "Allow remote clients to request a
   predetermined IP address" check box.
<P>
</OL>The following article has additional information on RAS:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q158124.htm">Q158124</A></B>
   TITLE     : XCLN: ShivaRemote with Exchange - RAS Server Considerations

</PRE></OL><h3>Client Configuration</h3>
 
<P>
Install LAN Manager version 2.2c software on the client computer. This is
located on the Windows NT 3.51 Server compact disc in the
Clients\Lanman\Disks\Disk1\Setup directory.
<P>
NOTE: If LAN Manager has already been installed, run Setup.exe from the LAN
Manager installation directory (Lanman.dos by default).

<OL><P><LI>Configure LAN Manager with the following options:
<P>
<P><PRE>    - TCP/IP (only) bound to the network card driver
</PRE><P>
<P><PRE>    - A static IP address, subnet mask, and default gateway
</PRE><P>
<P><PRE>    - DHCP disabled
</PRE>
<P><LI>Manually add entries for the Microsoft Exchange Server computer name
   and IP address in the HOSTS file. This file is located in the
   &lt;drive&gt;:\Lanman.dos\Etc directory, where &lt;drive&gt; is the letter of the
   local hard disk drive where LAN Manager is installed.

<P><LI>Configure LAN Manager with the following options:
<P>
<P><PRE>    - Username and HostName in the Advanced dialog box
</PRE><P>
<P><PRE>    - Windows Sockets enabled in the Advanced dialog box
</PRE><P>
<P><PRE>    - Computername, Username, and Domain in the Workstation Settings
      dialog box
</PRE>
<P><LI>Install the Microsoft Exchange Windows 3.x client.

<P><LI>In the Config.sys file, manually add the following line:
<P>
<P><PRE>      DEVICE=C:\EXCHANGE\DIALNDIS.EXE(after DEVICE=...\PROTMAN.DOS
      /i:C:\LANMAN.DOS)
</PRE>
<P><LI>In the Config.sys file, remark out or remove the line that loads the
   network card driver.

<P><LI>In the \Lanman.Dos\Protocol.ini file, manually edit the following:
<P>
   [TCPIP_XIF]
<PRE>   ;BINDINGS = "LAN Card Driver"     Remark out this line
   BINDINGS = SDIALIN$               Add this line

   [SDIALIN$]                        Add this line
   DriverName = SDIALIN$             Add this line

</PRE></OL>8  Run Connectw.exe to bring up the ShivaRemote Connect window.

<OL><P><LI>On the Tools menu, click Port Setup to configure the modem
   port.

<P><LI>Click the Options button to select the IP protocol and type the static
   IP address of the client computer. For more information on creating
   and saving a connection file, refer to the ShivaRemote Online Guide.

<P><LI>Save the new connection information and quit the Connect.exe
   utility.

<P><LI>Restart the computer. If you receive any errors during startup, resolve
   these before continuing.

<P><LI>Open the connection file you want and click the Connect button. After
   the connection has been established, quit the Connect program. You
   should see the message regarding the static IP address. Make sure this
   is the same IP address which is statically assigned to the client
   computer.

<P><LI>Next, attempt to PING the IP address and host name of the computer
   running Microsoft Exchange Server. The PING.EXE utility is located in
   the \LANMAN.DOS\NETPROG directory. If PINGing the host name fails, but
   PINGing the IP address works, the HOSTS file must be modified (see Step
   2 above). This step is necessary for the Microsoft Exchange client to
   connect to the server.

<P><LI>Start the Microsoft Exchange Windows 3.x client (online, as a test).
   Type the User Name (Exchange Mailbox Name), the Password (Windows NT
   Domain Password), and the Domain (Windows NT Domain Name that your
   account is in) and verify you can be properly logged in.
<P>
</OL>If the above step allows you to properly send/receive mail, ShivaRemote and
Microsoft Exchange are configured correctly.
<P>
The Microsoft Exchange client remote capabilities can now be configured
(remote mail or offline folders).
<P>
To set up the Microsoft Exchange client to automatically dial while working
offline:

<OL><P><LI>In Control Panel Mail-Fax, select the properties for Exchange Server
   in the profile and on the "dial up networking" tab.

<P><LI>Click the Shiva connection name that was tested in step 1 under "dial
   using the following connection."

<P><LI>Type the user name, password, and domain name in the dialog box.
<P>
</OL>Start the Microsoft Exchange client offline and select either the "remote
mail/connect" or the "sync this folder" check box. Shiva will dial and
transmit necessary information (depending on whether off-line folders [.ost
files] or .pst files are being used).
<P>
NOTE: To disconnect, either run Connect.exe again and select Disconnect or
type "connect /d" from the command line.
<P>
<P>
<P><h3>Sample Configuration Files</h3>
 
<P>
Use these Config.sys, Autoexec.bat, and Protocol.ini files as models.
<P>
NOTE: In order to format this article for the Web, some line breaks in this
file sample had to be changed. In the Config.sys file, the following line
should be part of the line that preceded it:
<P>
<PRE>   /i:C:\LANMAN.DOS

</PRE></OL>In the Autoexec.bat file, the following line should be part of the line
that preceded it:
<P>
<PRE>   2.2a

   Config.sys
   ----------

   device=c:\dos\himem.sys /testmem:off
   device=c:\dos\emm386.exe noems
   LASTDRIVE=Z
   DOS=HIGH,UMB
   DEVICEhigh=C:\LANMAN.DOS\DRIVERS\PROTMAN\PROTMAN.DOS /i:C:\LANMAN.DOS
   devicehigh=c:\doscln\dialndis.exe
   DEVICEhigh=C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\tcpdrv.dos
   /i:C:\LANMAN.DOS
   DEVICEhigh=C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\nemm.dos

</PRE><h3>Autoexec.bat</h3>
 
<P>
<PRE>   @REM ==== LANMAN 2.2a == DO NOT MODIFY BETWEEN THESE LINES == LANMAN
   2.2a
   ====
   SET PATH=C:\LANMAN.DOS\NETPROG;%PATH%
   C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\umb.com
   NET START WORKSTATION
   LOAD TCPIP
   SOCKETS
   NET LOGON shivat *
   @REM ==== LANMAN 2.2a == DO NOT MODIFY BETWEEN THESE LINES == LANMAN
   2.2a
   ====
   set shiva=c:\exchange\shiva

</PRE><h3>Protocol.ini</h3>
 
<P>
<PRE>   [PROTMAN]
     DRIVERNAME = PROTMAN$
     DYNAMIC = YES
     PRIORITY = NETBEUI

   [TCPIP_XIF]
     DRIVERNAME      = TCPIP$
     IPADDRESS0 = 200 200 200 201
     SUBNETMASK0 = 255 255 255 0
     DEFAULTGATEWAY0 =
     NBSESSIONS = 6
   ; the following two parameters added after documentation was completed
     TCPSEGMENTSIZE  = 1450
     TCPWINDOWSIZE   = 1450
     LOAD            = tcptsr[c],tinyrfc[c],emsbfr[cr]
     UNLOAD          = "unloadt /notsr[dc]"
   ;  BINDINGS = "DEPCA_NIF"
     BINDINGS = SDIALIN$
     NETFILES = C:\LANMAN.DOS\ETC
     DISABLEDHCP = 1
     LANABASE = 0

   [SDIALIN$]
   DRIVERNAME=SDIALIN$

</PRE><h2>REFRENCE</h2>
 
<P>
Updated modem scripts for use with ShivaRemote can be found on Shiva's
web page at www.shiva.com under "support"/modem scripts.
<P>
Additional configuration information can also be found in the Config.hlp
file installed during installation of the ShivaRemote software.
<P>
For more information about specific remote options with the Microsoft
Exchange client, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q139934.htm">Q139934</A></B>
   TITLE     : XCLN: The Microsoft Exchange Client and Mobile Users

</PRE>For additional information on supported Shiva configurations for use with
the Microsoft Exchange Server, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q158124.htm">Q158124</A></B>
   TITLE     : XCLN: ShivaRemote with Exchange - RAS Server Considerations

   ARTICLE-ID:<B><A href="../exchange/q158095.htm">Q158095</A></B>
   TITLE     : Using ShivaRemote with Exchange (Windows 3.x/LanMan NetBEUI)

   ARTICLE-ID: <B><A href="../exchange/q158077.htm">Q158077</A></B>
   TITLE     : Using ShivaRemote with Exchange (Windows 3.x/real-mode IPX)

   ARTICLE-ID: <B><A href="../exchange/q158111.htm">Q158111</A></B>
   TITLE     : ShivaRemote with Exchange (WFW 3.11/WFW TCP/IP or
               NetBEUI)

</PRE>The third-party contact information included in this article is provided to
help you find the technical support you need. This contact information is
subject to change without notice. Microsoft in no way guarantees the
accuracy of this third-party contact information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: remote deliver now sync all folders<BR>
Keywords          : XCLN kbenv kbsetup kbusage<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
