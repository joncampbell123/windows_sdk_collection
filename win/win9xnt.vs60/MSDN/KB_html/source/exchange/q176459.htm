

<HTML>
<HEAD>
<TITLE>XADM: DirRep Bridgehead Errors Modifying Site Naming Contexts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176459">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/11/07">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00.sp2 XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  A Microsoft Exchange Directory Replication Bridgehead Server may fail to update existing, or replicate in new, Microsoft Exchange Site naming contexts. For the Windows NT Server Event Viewer Application log signature of this problem, please see the...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXB,QATJ,QAAP,QAFI,QAB4,QAUJ,QAPN,QAO4,QAFO,QAKP,QBWP,QA7Y,QAXB,QAJ9,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: DirRep Bridgehead Errors Modifying Site Naming Contexts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176459</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Microsoft Exchange Directory Replication Bridgehead Server may fail to
update existing, or replicate in new, Microsoft Exchange Site naming
contexts. For the Windows NT Server Event Viewer Application log signature
of this problem, please see the MORE INFORMATION section of this article.
<P>
<P><h2>CAUSE</h2>
 
<P>
A jet database transaction was not backed out when a value needed to be
moved to the long value table. Subsequently, when a new jet transaction was
attempted, the jet error, -1109, would be returned, failing the new
transaction attempt.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server,
version 5.0.
This problem has been corrected in the latest U.S. Service Pack for
Microsoft Exchange Server version 5.0. For information on obtaining the
Service Pack, query on the following word in the Microsoft Knowledge Base
(without the spaces):
S E R V P A C K
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With the following Microsoft Exchange Directory Service diagnostic logging
enabled:
<P>
<PRE>     Replication = MAX
     Internal Processing = Min

</PRE>the following 3 symptoms were noted:

<OL><P><LI>The Directory Replication Bridgehead server fails to add new replicas of
   remote Sites, logging the following events:
<P>
<P><PRE>     1063
     Internal event: The directory replication agent (DRA) was asked to
     replicate naming context &lt;site naming context&gt; from directory
</PRE><P>
</OL>&lt;EX:/o=&lt;orgname&gt;/ou=&lt;sitename&gt;/cn=Configuration/cn=Servers/cn=&lt;servernam
<PRE>     e&gt;/cn=Microsoft DSA with options &lt;xxxxx&gt; to another site.

     1171***  &lt;&lt;&lt;&lt; these exception *specifics* indicate "THE" problem
     Exception e0010004 has occured with parameters -1109 and 0 (Internal
</PRE></OL>ID
<PRE>     20a00f8). Please contact Microsoft Product Support Services for
     assistance.

     1059
     Internal error: The directory replication agent (DRA) call returned
     error 22.

     1117
     The consistency checker failed to add a missing replica of naming
</PRE>&lt;site
<PRE>     naming context&gt; from directory

</PRE>EX:/o=&lt;orgname&gt;/ou=&lt;sitename&gt;/cn=Configuration/cn=Servers/cn=&lt;servername
<PRE>     &gt;/cn=Microsoft DSA to directory &lt;servername&gt; with error 22. Run the
     consistency checker on directories

</PRE>EX:/o=&lt;orgname&gt;/ou=&lt;sitename&gt;/cn=Configuration/cn=Servers/cn=&lt;servername
<PRE>     &gt;/cn=Microsoft DSA and &lt;servername&gt;.

</PRE><P><LI>Other Microsoft Exchange Servers within the Site may have stranded
   replicas of one or more of these Sites, thus they request updates for
   these contexts from the Bridgehead, which doesn't have copies of the
   object, resulting in the following event log warnings on the Bridgehead
   server:
<P>
<P><PRE>     1070
     Internal event: Directory &lt;dsa-signature&gt; &lt;servername&gt; asked the
     directory replication agent (DRA) to get changes from naming context
     &lt;site naming context&gt; starting at update sequence number (USN)
</OL></PRE>&lt;xxxxxxx&gt;
<PRE>     with flags 360 and sensitivity 100.

     1059
     Internal error: The directory replication agent (DRA) call returned
     error 6.

</PRE><P><LI>The Microsoft Exchange Server Knowledge Consistency Checker (KCC) fails
   with the generic KCC failure:
<P>
   The knowledge consistency check did not correct directory
   inconsistencies. Be sure the directory service is running, and then try
   again. If the error recurs, try stopping the directory service and
   Administrator program and then restarting them. To view details of the
   error, see the application event log in the Windows NT Event Viewer on
   the Microsoft Exchange computer on which you checked knowledge
   consistency.
<P>
<P><PRE>     Microsoft Exchange Administrator
     ID no: c1030b1e
</OL></PRE> 
<PRE>Keywords          : kbbug5.00 kbfix5.00.sp2 XADM kbusage
Version           : 5.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix kbpatch</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
