

<HTML>
<HEAD>
<TITLE>XCLN: Troubleshooting RPC Problems with Windows 3.x Client </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154268">
<META NAME="KBModify" CONTENT="1997/10/08">
<META NAME="KBCreate" CONTENT="1996/07/31">
<META NAME="Keywords" CONTENT="XCLN kb3rdparty kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  This article lists steps to help you troubleshoot problems when you  attempt to use the Microsoft Exchange Windows 3.x client to connect to a  Microsoft Exchange Server computer using remote procedure call (RPC). The  following problems are discuss...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QARL,QAI5,QAVZ,QABI,QBVV,QBW6,QBTX,QDKW,QBRU,QAJ4,QAKP,QDJ3,QDIZ,QBWS,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Troubleshooting RPC Problems with Windows 3.x Client</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154268</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to: 

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article lists steps to help you troubleshoot problems when you 
attempt to use the Microsoft Exchange Windows 3.x client to connect to a 
Microsoft Exchange Server computer using remote procedure call (RPC). The 
following problems are discussed:

<UL><LI>The client cannot connect to the server on a Microsoft network.
<LI>The client cannot connect to the server on a Novell NetWare network.
<LI>The server cannot connect to the client.
<LI>The client cannot open a public folder on the server.
<LI>The client cannot connect to the server when you are using shared 
   installations of Windows and Microsoft Exchange.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>The Client Cannot Connect to the Server on a Microsoft Network</h3>
 
<P>
If you are unable to connect to a Microsoft Exchange Server computer on a 
Microsoft network, the problem may be caused by any of the following 
situations:

<UL><LI>The server is not available.

<LI>The client or server is connected to a private network.

<LI>The client and server are not using the same network protocols.

<LI>There is a version mismatch between the client and server.

<LI>The client is not configured properly.

<LI>There is not enough free memory.
<P>
</UL>To work around this problem, use the appropriate method:

<UL><LI>Verify that the server is currently available, and then use the 
   Services tool in Control Panel to verify that the appropriate services 
   are running on the server.

<LI>Verify that the client and server are not connected to a private 
   network.

<LI>Use the NET USE command to verify that the client is able to connect 
   to the server from a command prompt. If the client is unable to 
   connect, use the Network tool in Control Panel to verify that at least 
   one common protocol is running on the client and the server. If you 
   are using Microsoft LAN Manager, use the Lmsetup.exe program instead 
   of the Network tool in Control Panel.

<LI>Verify that you are running the appropriate version of the client.

<LI>View the [Exchange Provider] section in the Exchng.ini file on the 
   client and verify that the RPC_Binding_Order line contains an entry 
   for the protocol that is running on both the client and the server. 
   The following table lists the appropriate entry for each protocol:
<P>
<PRE>      Protocol      Entry
      --------------------------
      Named Pipes   ncacn_np
      IPX/SPX       ncacn_spx
      TCP/IP        ncacn_ip_tcp

   In addition, if Microsoft Windows for Workgroups is running on the 
   client and the IPX/SPX protocol is the protocol that is running on 
   both the client and the server, verify that the [Network] section in 
   the System.ini file contains the following line:

      DirectHost=OFF

</PRE><LI>If you receive error messages indicating that there is not enough free 
   memory, increase the amount of free memory on the computer.
<P>
</UL><h3>The Client Cannot Connect to the Server on a Novell Netware Network</h3>
 
<P>
If you are unable to connect to a Microsoft Exchange Server computer on a 
Novell NetWare network, the problem may be caused by any of the following 
situations:

<UL><LI>The server is not configured to support NetWare clients.

<LI>The Nwipxspx.dll or Nwcalls.dll file does not exist on the client or 
   is not located in a folder that is included in the PATH environment 
   variable.

<LI>There is a version mismatch between the client and server.

<LI>There is a frame type mismatch between the client and server.

<LI>There is not enough free conventional memory on the client.

<LI>The client or server is unable to log on to a Service Advertising 
   Protocol (SAP) computer.
<P>
</UL>To work around this problem, use the appropriate method:

<UL><LI>Use the Network tool in Control Panel to verify that the Gateway 
   Services for NetWare service is installed on the server and that the 
   NWLink IPX/SPX Compatible Transport protocol is installed and 
   configured properly.

<LI>Verify that the Nwipxspx.dll and Nwcalls.dll files exist on the client 
   and are located in a folder that is included in the PATH environment 
   variable. If the files are missing, contact Novell for information 
   about how to obtain the files.

<LI>Verify that you are running the appropriate version of the client and 
   server.

<LI>Verify that the client and server are configured to use the same frame 
   type. To determine which frame type the client is configured to use, 
   view the contents of the Net.cfg file. To determine which frame type 
   the server is configured to use, view the properties for the NWLink 
   IPX/SPX Compatible Transport protocol. 
<P>
   In addition, if the server supports more than one frame type, verify 
   that that the internal network number is unique and that the Auto 
   Frame Type Detection check box is not selected.

<LI>Increase the amount of free conventional memory on the client. Note 
   that you may be able to do so by reducing the IPX packet size. To 
   reduce the IPX packet size, add the following line to the Protocol IPX 
   section in the Net.cfg file:
<P>
<P><PRE>      IPX PACKET SIZE LIMIT 1496
</PRE>
<LI>Verify that the client and server are able to log on to a SAP 
   computer. SAP computers are NetWare servers or Microsoft Windows NT 
   servers on which the SAP Agent service is installed. In addition, if 
   the client and server are not on the same network segment, verify that 
   the router between the two segments is configured to transport SAP 
   type 0x640 messages.
<P>
</UL><h3>The Server Cannot Connect to the Client</h3>
 
<P>
If the client is able to connect to the server, but the server is unable 
to connect to the client, the client may not be configured for enough IPX 
sockets or SPX connections.
<P>
To work around this problem, increase the IPX Sockets and SPX Connections 
settings in the Protocol IPXODI section of the Net.cfg file. Both 
settings should be at least 50.
<P>
<P><h3>The Client Cannot Open a Public Folder on the Server</h3>
 
<P>
If the client is able to connect to the server, but it cannot open a 
public folder on the server, the problem may be caused by either of the 
following situations:

<UL><LI>The client is not configured for enough IPX sockets or SPX connections.

<LI>One or more necessary services are not running on the server.
<P>
</UL>To work around the problem, use the appropriate method:

<UL><LI>Increase the IPX Sockets and SPX Connections settings in the Protocol 
   IPXODI section of the Net.cfg file. Both settings should be at least 
   50.

<LI>Verify that all the necessary services are running on the server.
<P>
</UL>The Client Cannot Connect to the Server When You Are Using Shared 
Installations of Windows and Microsoft Exchange
 
<P>
If the client cannot connect to the server and you are using shared 
installations of Windows and Microsoft Exchange, the RPC_REG_DATA_FILE 
setting in the [RPC Runtime Preferences] section in the Win.ini file is 
invalid.
<P>
To work around this problem, modify the RPC_REG_DATA_FILE setting so that 
it includes the full path to a valid Rpcreg.dat file that is not read-
only. In addition, verify that the root folder on the drive on which the 
Rpcreg.dat file is located is not read-only.
<P>
NetWare is manufactured by Novell, a vendor independent of Microsoft; we 
make no warranty, implied or otherwise, regarding this product's 
performance or reliability.
 
<PRE>Keywords          : XCLN kb3rdparty kbnetwork
Version           : 5.0
Platform          : WINDOWS
Issue type        : kbtshoot</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
