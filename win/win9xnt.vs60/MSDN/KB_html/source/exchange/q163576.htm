

<HTML>
<HEAD>
<TITLE>XGEN: Changing the RPC Binding Order </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163576">
<META NAME="KBModify" CONTENT="1998/02/20">
<META NAME="KBCreate" CONTENT="1997/02/12">
<META NAME="Keywords" CONTENT="XGen kbsetup kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  How Microsoft Exchange Server Uses RPC  Microsoft Exchange Server uses RPC built into Windows NT for establishing connections among the Microsoft Exchange Server processes, such as connections between Microsoft Exchange Server Message Transfer Agen...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWP,QARL,QA5E,QDL9,QBWQ,QBWN,QAA1,QAI5,QAB6,QDI2,QDNT,QBWD,QAUJ,QDIK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XGEN: Changing the RPC Binding Order</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163576</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0, 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h3>How Microsoft Exchange Server Uses RPC</h3>
 
<P>
Microsoft Exchange Server uses RPC built into Windows NT for establishing
connections among the Microsoft Exchange Server processes, such as
connections between Microsoft Exchange Server Message Transfer Agents (MTAs),
and for connecting Microsoft Exchange clients and Servers in the network.
Microsoft Exchange Server can use RPC over named pipes, TCP/IP, NetBIOS, 
and IPX/SPX.  When it tries to use RPC, Microsoft Exchange Server proceeds 
through the list of the protocols given above and tries to establish RPC 
binding. The preference order of the transports is defined by the "RPC 
BINDING ORDER" which by default is Local RPC, TCP/IP, SPX, Named Pipes,
and then Netbios in order of preference.
<P>
<P><h3>Changing the RPC Protocol Binding Order</h3>
 
<P>
When a Microsoft Exchange client is installed, it sets the default RPC
protocol binding order. This setting determines the protocol sequence that
it uses to communicate with Microsoft Exchange Server. You can change the RPC 
binding order before or after the client is installed. Performance can be 
improved by changing the RPC binding order if the client uses multiple 
protocols or if the single protocol your client uses is not the first listed 
in the RPC binding order. If the protocol used is last in the sequence, the 
Microsoft Exchange client attempts to bind over the protocols listed before it 
when connecting to the Server. The protocols are represented in the binding 
order, using the following entries. The string ncacn refers to Network 
Computing Architecture Connection.
<P>
<PRE>   Protocol name  RPC protocol string
   ----------------------------------

   Local RPC      ncalrpc
   TCP/IP         ncacn_ip_tcp
   SPX            ncacn_spx
   Named pipes    ncacn_np
   NetBIOS        netbios
   VINES IP       ncacn_vns_spp

</PRE>For example, the following entry attempts to establish connections over
SPX, TCP/IP, and NetBIOS in that order.
<P>
<PRE>   RPC_Binding_Order=ncacn_spx,ncacn_ip_tcp,netbios

</PRE><h3>Clients Running Windows 95, Windows NT Server, and Windows NT Workstation</h3>
 
<P>
By default, the Microsoft Exchange client uses the following RPC binding 
order for Windows 95, Windows NT Server, and Windows NT Workstation when
attempting to connect to a Microsoft Exchange Server.
<P>
<PRE>   1. TCP/IP
   2. SPX
   3. Named pipes
   4. NetBIOS
   5. VINES IP (Windows NT Server and Windows NT Workstation only)

</PRE>You can change the RPC binding order for clients running Windows 95,
Windows NT Workstation, and Windows NT Server before or after you've
installed the Microsoft Exchange Client.
<P>
Before installation:
<P>
In Setup Editor, select the Binding Order property page.
<P>
After installation:
<P>
Use the Registry Editor to modify the binding order in
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Exchange\Exchange Provider. For 
example, the following entry attempts to establish SPX, TCP/IP, and 
NetBIOS connections in the order indicated:
<P>
<PRE>   RPC_Binding_Order=ncacn_spx,ncacn_ip_tcp,netbios

</PRE><h3>Clients Running Windows and Windows for Workgroups</h3>
 
<P>
By default, the Microsoft Exchange client uses the following RPC binding
order for Windows for Workgroups when attempting to connect to a Microsoft
Exchange Server.
<P>
<PRE>   1. Named pipes
   2. SPX
   3. TCP/IP
   4. NetBIOS
   5. VINES IP

</PRE>You can change the RPC binding order for clients running Windows and
Windows for Workgroups before or after you've installed Microsoft Exchange
Client.
<P>
Before installation:
<P>
In Setup Editor, select the Binding Order property page.
<P>
After installation:
<P>
In the Exchng.ini file in the Windows directory, edit the [Exchange
Provider] section. For example, the following entry in the Exchng.ini file
attempts to establish SPX, TCP/IP, and NetBIOS connections in the order
indicated:
<P>
<PRE>   [Exchange Provider]
   RPC_Binding_Order=ncacn_spx,ncacn_ip_tcp,netbios

</PRE><h3>Clients Running MS-DOS</h3>
 
<P>
By default, the Microsoft Exchange client uses the following RPC binding
order for MS-DOS when attempting to connect to a Microsoft Exchange Server.
<P>
<PRE>   1. Local RPC
   2. Named pipes
   3. SPX
   4. TCP/IP
   5. NetBIOS

</PRE>You can change the RPC binding order for clients running MS-DOS after
you've installed MS-DOS. To change the order, edit the RPC_BINDING_ORDER
line in the Mlsetup.ini file. This file is installed automatically on the
client or on a network share. For example, the following entry in the
Mlsetup.ini file attempts to establish local RPC, named pipes, TCP/IP, and
NetBIOS connections in the order indicated:
<P>
<PRE>   RPC_Binding_Order=ncalrpc,ncacn_np,ncacn_ip_tcp,netbios

</PRE><h2>MORE INFORMATION</h2>
 
<P>
There is no need to reboot the computer after modifying the Microsoft 
Exchange binding order. The Microsoft Exchange client will reread the 
binding when restarting. For troubleshooting purposes, simply change the 
binding order in the registry (make sure the key has been fully committed 
to the registry) and then attempt a check names from the properties for 
the Microsoft Exchange Server Service (control panel/mail). It is 
unnecessary even to exit out of regedit when trying different bindings. 
<P>
You MUST use commas between binding order entries or the binding doesn't
get read. If, for instance, you use "ncacn_ip_tcp;netbios" and attempt a 
check names, the following error will immediately be generated: 
<P>
<PRE>   The name could not be resolved. The Microsoft Address Book was unable to
   log on to the Microsoft Exchange Server computer. Contact your system
   administrator if the problem persists. &lt;ok&gt;

</PRE>If the entire RPC_binding_Order subkey is deleted, the Microsoft Exchange 
client will utilize the default binding order. This may be a good quick 
troubleshooting step if there are concerns about incorrect entries in the 
binding order.  
<P>
The information in this article came from the Exchange Server Resource Kit
on TechNet and other sources.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q136516.htm">Q136516</A></B>
   TITLE     : XCLN: Improving Windows Client Startup Times
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Exchange provider EXCHNG.INI XCLN XADM<BR>
Keywords          : XGen kbsetup kbusage<BR>
Version           : 4.0<BR>
Platform          : winnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
