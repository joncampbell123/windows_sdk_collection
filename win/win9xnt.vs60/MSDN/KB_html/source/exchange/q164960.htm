

<HTML>
<HEAD>
<TITLE>XFOR: Exchange Store Stops While Converting SMTP Message </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164960">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/03/10">
<META NAME="Keywords" CONTENT="kbbug5.00 kbfix5.00.sp2 XFOR">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Information Store service may terminate unexpectedly when processing incoming SMTP messages with a transport-neutral encapsulation format (TNEF) body part.  The Drwtsn32.log may show a failure of Store.exe with an entry simil...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI4,QBE7,QBE6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Exchange Store Stops While Converting SMTP Message</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164960</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Information Store service may terminate unexpectedly
when processing incoming SMTP messages with a transport-neutral
encapsulation format (TNEF) body part.
<P>
The Drwtsn32.log may show a failure of Store.exe with an entry similar to
the example in the "More Information" section of this article.
<P>
<P><h2>CAUSE</h2>
 
<P>
This will only occur when processing incoming messages with a TNEF body
part. The TNEF body part may contain invalid named properties.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.0. This problem has been corrected in the latest U.S. Service
Pack for Microsoft Exchange Server version 5.0. For information on
obtaining the Service Pack, query on the following word in the Microsoft
Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Dr Watson log may include information similar to the following example.
<P>
Application exception occurred:
<P>
<PRE>   App: store.dbg (pid=117)
   When: 8/29/1997 @ 16:1:58.640
   Exception number: c0000005 (access violation)

</PRE>Stack trace:
<P>
0b8af33c  0074bfc9  STORE!EcFindJtabNameid+0x44
0b8af364  0074d2ba  STORE!EcGetJtabIDFromName+0x59(0x01422DD4, 0x00000000)
0b8af39c  0074e950  STORE!MDB::EcGetIDsFromNames+0xfa(0x0AD8463C,
0x00000002, 0x00000001, 0x0B8AF4B0, 0x0B8AF414, 0x0B8AF448)
0b8af3d0  0084d777  STORE!OMSG::EcGetIDsFromNames+0x60(0x0AD8463C,
0x00000002, 0x00000001, 0x0B8AF4B0, 0x0B8AF414, 0x0B8AF448)
0b8af418  00855b57  STORE!CVTOMSG::HrGetIDsFromNames+0x37(0x00000002,
0x00000001, 0x0B8AF4B0, 0x0B8AF448)
0b8af44c  00876b9a  STORE!CMDBMessage::GetIDsFromNames+0x87(0x01432E74,
0x00000001, 0x0B8AF4B0, 0x00000002)
0b8af480  00881110  STORE!CMAPIMessage::GetIDsFromNames+0x3a(0x0ADC6204,
0x00000001, 0x0B8AF4B0, 0x00000002)
0b8af4dc  0059fc56  STORE!HrDecodeNamedPropTag+0x220(0xfc40fcf1,
0x0B8AF50C)
0b8af514  005f04bb  STORE!HrDecodePropVal+0xb6(0x00000000, 0x0040A630,
0x00000000, 0x0ADBCDEC, 0x0B8AF5EC, 0x0B8AF578)
0b8af580  005e0c94  STORE!HrDecodeEncapsulation+0xdb(0x00000000,
0x000045fc, 0x00000000, 0x0040A630, 0x0B8AF5EC, 0x0B8AF5FC, 0x0B8AF614,
0x00000000)
0b8af620  005e0473  STORE!HrExtractProperties+0x7d4(0xffffffff, 0x00000000,
0x0040A630, 0x00000000)
0b8af648  005f2ecd  STORE!TNEF_ExtractProps+0x233(0x0ADC62E4, 0x00000002,
0x0040A630, 0x00000000)
0b8af69c  005c5794  STORE!CmnBptMessage::hrExtractTNEF+0x1cd(0x0AD7DF94,
0x0AD7F99C)
0b8af6d8  005a8b35  STORE!CmcvtrBptEnd::hrExtract+0x2e4(0x0AD7DF94,
0x0AD7F99C, 0x0AD70644, 0x00000000, 0x0B8AF708)
0b8af714  005c549c  STORE!CINETextr::hrExtract+0x185(0x0B8AF73C,
0x00000000, 0x0B8AF73C)
0b8af740  005c541c  STORE!CConvertStream::HrFlush+0x3c(...)
0b8af770  005c51c8  STORE!CConvertStream::Commit+0xbc(0x01432754)
0b8af7a0  004f9a5b  STORE!CSTREAM::HrCommit+0x68(0x00000000, 0x00000000)
0b8af7dc  004f98f8  STORE!EcCommitStreamOp+0x12b
0b8af800  00429602  STORE!EcCommitStream+0x78(0x00000001, 0x00000018)
0b8af8c0  00427900  STORE!EcRpc+0x1bf2(0x0B8AF924, 0x00007800)
0b8af928  77e11841  STORE!EcDoRpc+0x90(0x00172E48, 0x0ADB00AC, 0x0017B53A,
0x7800)
0b8af948  77e52265
RPCRT4!?AllocateCCall@WMSG_CASSOCIATION@@QAEJPAPAVWMSG_CCALL@@PAU_RPC_CLIEN
T_INTERFACE@@@Z+0x27
0b8af964  77e52236  RPCRT4!NdrClientCall2+0x265
0b8afc28  77e51f9e  RPCRT4!NdrClientCall2+0x236
0b8afc7c  77e11122  0x77e4ef9e
0b8afcd0  77e112fb
RPCRT4!?ClearThreadSecurityContext@SCONNECTION@@IAEPAVSSECURITY_CONTEXT@@PA
VMUTEX@@@Z+0x2b
0b8afcd0  77e112fb
RPCRT4!?DispatchToStub@RPC_INTERFACE@@QAEJPAU_RPC_MESSAGE@@IPAJ@Z+0x4f
0b8afcf0  77e119cf
RPCRT4!?DispatchToStub@RPC_INTERFACE@@QAEJPAU_RPC_MESSAGE@@IPAJ@Z+0x4f
0b8afd38  77f64b1c
RPCRT4!?FreeCCall@WMSG_CASSOCIATION@@QAEHPAVWMSG_CCALL@@@Z+0xb
0b8afd74  77f7e485  NTDLL!LdrpResolveDllName+0x142
0b8afdf4  77f64d10  NTDLL!CPropertySetStream___PatchSectionOffsets+0x57
 
<PRE>Keywords          : kbbug5.00 kbfix5.00.sp2 XFOR
Version           : WinNT:5.0
Platform          : winnt
Issue type        : kbbug
Solution Type     : kbfix</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
