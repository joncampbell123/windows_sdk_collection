

<HTML>
<HEAD>
<TITLE>XADM: Disabling PF Replication Status Messages on IS Startup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177251">
<META NAME="KBModify" CONTENT="1998/02/12">
<META NAME="KBCreate" CONTENT="1997/11/24">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix5.00.sp2 kbbug5.50">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When the Microsoft Exchange Server information store starts, two public folder (PF) replication status messages are sent. If Replication Outgoing Messages logging is set to max in the Microsoft Exchange Administrator program, you will see the follo...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QBXS,QAYC,QBRU,QAEF,QBVV,QAFO,QAFI,QDIV,QA3W,QAY2,QAV1,QAV0,QABY,QDO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Disabling PF Replication Status Messages on IS Startup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 12, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177251</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
-The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0, 5.0, and 5.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When the Microsoft Exchange Server information store starts, two
public folder (PF) replication status messages are sent. If Replication
Outgoing Messages logging is set to max in the Microsoft Exchange
Administrator program, you will see the following Event IDs in the
Windows NT Event Viewer Application log:
<P>
<PRE>   This is a status message for the public folder hierarchy, it is sent
   from every server with a public store (pub.edb) to every server with a
   public store in the Microsoft Exchange Organization:

   Event ID: 3017
   Source: MSExchangeIS Public
   Type: Information
   Category: Replication
   Description:
   Outgoing Message Type 0x20
   Message ID: 1-1B64 (this will not be the same)
   Folder(s): (1-1) IPM_SUBTREE

   This is a status message for the System Folders (Offline Address Book,
   Schedule+ Free Busy Folder, and so forth) (Note: the numeric
   information in the description will differ from server to server) and
   is sent from every site folder server in a site to any other site
   folder servers in other sites it has knowledge of:

   Event ID: 3019
   Source: MSExchangeIS Public
   Type: Information
   Category: Replication
   Description:
   An outgoing replication message was issued.

   Type: 0x80000002
   Message ID: 1-1B62
   CNSET: 12-1B67,12-1B67
   12-1B69,12-1B69
   , CNSET(FAI): {0}

   RFIs: 2
    1: 2-7,1-4,48
   NON_IPM_SUBTREE\SCHEDULE+ FREE BUSY\EX:/o=ORGNAME/ou=SITENAME
   2: 2-8,1-5,666
   NON_IPM_SUBTREE\OFFLINE ADDRESS BOOK\EX:/o=ORGNAME/ou=SITENAME

   IDCN Deleted:
   {0}

</PRE>In large Exchange organizations where there are many single server sites
connected over slow links and the information stores are stopped each night
for offline backups (in lieu of the preferred online backups), these
messages may cause the Microsoft Exchange message transfer agent (MTA)
queues to back up.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
You can do the following to try to work around this problem:

<OL><P><LI>Remove the public information store from any Exchange Server computer
   possible. This will only be valid in multi-server sites with a dedicated
   public folder server.
</OL>2. Increase the speed of the WAN links where/when possible.
3. Perform ONLINE backups of the information store.
<P>
<P><h2>STATUS</h2>
 
, 5.0, and 5.5 has has implemented a design change to control
this behavior.
<P>
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 4.0.
A supported fix is now available, but has not been fully regression-tested
and should be applied only to systems impacted by this specific behavior.
Unless you are severely impacted by this specific behavior, Microsoft
recommends that you wait for the next Service Pack that contains this
change. Contact Microsoft Technical Support for more information.
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.0.
This problem has been corrected in the latest U.S. Service Pack for
Microsoft Exchange Server version 5.0. For information on obtaining the
Service Pack, query on the following word in the Microsoft Knowledge Base
(without the spaces):
S E R V P A C K
<P>
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
version 5.5.
A supported fix is now available, but has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Technical Support for more information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry Editor
can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it.
<P>
<P>
After applying the updated files, the following registry entry must be
added for the replication status message to be suppressed:
<P>
<PRE>   HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/SERVICES/MSExchangeIS/
   ParametersPublic/Disable Replication Messages At Startup

</PRE></OL>Set the type to DWORD and the default value to 0.
<P>
If this registry entry is not present or present and set to 0, the PF
replication will work as originally designed. In other words, it will send
the replication status messages at startup of the IS.
<P>
If this registry is present and set to 1, the PF Replication will not send
the status messages at startup of the IS.
<P>
If set to 1, two new Event ID's were added to notify the administrator that
the PF replication messages are not being sent out, they will look similar
to the following:
<P>
<PRE>   Event ID: 3094
   Source: MSExchangeIS Public
   Type: Warning
   Category: Replication
   Description:
   The site folder server status message was not sent out.

   This is because the following registry entry has been intentionally set
   to 1 by the system administrator.

      HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/SERVICES/MSExchangeIS/
      ParametersPublic/Disable Replication Messages At Startup

   Event ID: 3093
   Source: MSExchangeIS Public
   Type: Warning
   Category: Replication
   Description:
   The replication startup status message was not sent out.

   This is because the following registry entry has been intentionally set
   to 1 by the system administrator.

      HKEY_LOCAL_MACHINE/SYSTEM/CurrentControlSet/SERVICES/MSExchangeIS/
      ParametersPublic/Disable Replication Messages At Startup.

</PRE>It is strongly recommended that this registry entry only be used in the in
cases described in the Symptoms section. Setting this registry entry and
preventing the status messages from going out on startup has the following
caveats:

<OL><P><LI>If a replication connector between 2 Exchange Sites is torn down, the
   system folders from the foreign Site are marked as removed and they
   will not show up in the Systems Folder hierarchy. If these Sites are
   reconnected, the System folders from the foreign Site will still not
   show up since we are preventing the status message, which is the
   message that causes the marked as removed flag to be reset, from
   reaching the other Site. This registry entry must be set to 0, and
   then the IS re-started to get the System Folders to synch up again.
</OL>2. Public Folder hierarchies may temporarily become out of synch because
<PRE>   changes are only known to other Sites when an actual hierarchy change
   message is received.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: backlog repl WAN<BR>
Keywords          : kbbug4.00 kbbug5.00 kbfix5.00.sp2 kbbug5.50<BR>
Version           : 4.0 5.0 5.5<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 12, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
