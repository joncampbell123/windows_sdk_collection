

<HTML>
<HEAD>
<TITLE>XFOR: Quoted-Printable Encoded Messages Stay in IMC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146993">
<META NAME="KBModify" CONTENT="1997/07/15">
<META NAME="KBCreate" CONTENT="1996/03/06">
<META NAME="Keywords" CONTENT="kbbug4.00 buglist4.00">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Server version 4.0 Internet Mail Connector (IMC) may have problems sending outbound messages that are encoded quoted-printable. In addition, the IMC's performance will gradually degrade until it is no longer capable of delive...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QAYC,QAUD,QAML,QAI4,QAKP,QDJO,QA2F,QAR4,QALG,QABG,QBVV,QAX6,QAH6,QAB7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: Quoted-Printable Encoded Messages Stay in IMC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146993</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Server version 4.0 Internet Mail Connector (IMC) may
have problems sending outbound messages that are encoded quoted-printable.
In addition, the IMC's performance will gradually degrade until it is no
longer capable of delivering additional messages past the message stuck in
the queue.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Messages sent with an attachment that have a Content-Transfer-Encoding type
of quoted-printable get stuck in the outgoing IMC queue indefinitely and
eventually cause the IMC to hang. In order for a message to have a content
encoding type of quoted-printable, a message must be sent with an
attachment that contains the proper ratio of ASCII to extended ASCII
characters.
<P>
The problem occurs because IMAIL is not appending the appropriate "carriage
return line feed" (CR LF) at the end of the message. The IMC appends the
"dot carriage return line feed" (. CR LF) but since this isn't an
appropriate end of message character string, the host keeps waiting for
more data which never arrives.
<P>
All SMTP messages should always end in CRLF.CRLF. The hex representation
for this ending sequence is:
<P>
<PRE>   0D 0A 2E 0D 0A

</PRE>Archived IMC messages can be analyzed using a hex editor tool such as List.
The hex dump below is the end of an actual message that was stuck in an
IMC's outgoing queue:
<P>
<PRE>   00000110 3E 33 3E 3E 59 3E 4E 3E 34 2F 39 37 3E 3E 3E 3E
   00000120 33 3E 0D 0A 3D 31 41 2E 0D 0A

</PRE>Note that the last 5 bytes of the example message above were:
<P>
<PRE>   31 41 2E 0D 0A

</PRE>The first two bytes were actual message data. The last three bytes were
appended to the message by the IMC as part of the ending sequence. However,
the first two bytes (CRLF or 0D 0A in hex) were not appended to the end of
the message by IMAIL. Thus, the ending sequence was invalid and the host
didn't know that the IMC was finished sending data.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange version
4.0. A supported fix is now available, but has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Product Support Services for more information.
<P>
Note: IMC Build 996.15 is the official hotfix that resolves this problem
for Microsoft Exchange version 4.0 Servers. The files included in this
hotfix are:
<P>
<PRE>   MSEXCIMC.EXE
   IMCMSG.DLL

</PRE>These files are located in the following directories on the Microsoft
Exchange Server:
<P>
<PRE>   MSEXCIMC.EXE:  \EXCHSRVR\CONNECT\MSEXCIMC\BIN
   IMCMSG.DLL:    \EXCHSRVR\RES
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug4.00 buglist4.00<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
