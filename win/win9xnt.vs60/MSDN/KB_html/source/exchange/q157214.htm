

<HTML>
<HEAD>
<TITLE>XCON: Deleting a "Bad" Message from the MTA Queue </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157214">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1996/10/08">
<META NAME="Keywords" CONTENT="XCON kbtshoot kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  When a message becomes stuck in the Microsoft Exchange message transfer agent (MTA) queue, it may be necessary to delete the message in order to restore the operability of the MTA.  MORE INFORMATION  When a message becomes stuck in the MTA queue, t...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANE,QAPN,QAEV,QAEF,QAGI,QAAP,QACF,QAO4,QAGB,QAFI,QAB4,QAJQ,QAYC,QAFX,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Deleting a "Bad" Message from the MTA Queue</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157214</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a message becomes stuck in the Microsoft Exchange message transfer
agent (MTA) queue, it may be necessary to delete the message in order
to restore the operability of the MTA.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When a message becomes stuck in the MTA queue, the Windows NT Application
Event Log may display an event similar to the following:
<P>
<PRE>   2171/ExchangeMTA/Processing/An MTA database server error was encountered
   while reading an attribute error code 2171 0x6
   An MTA database server error was encountered while reading an attribute
   called from XAPI Database error code 2171 object at fault 0600006b

</PRE>To delete the message and restore the operability of the MTA:

<OL><P><LI>Stop the MTA:
<P>
<P><PRE>      In Control Panel Services, click Server Manager, then click Computer,
      and then click Services.
</PRE><P>
<P><PRE>      -OR-
</PRE><P>
<P><PRE>      Carry out the following command at an MS-DOS prompt:
</PRE><P>
<PRE>         net stop msexchangemta

</PRE><P><LI>Make a copy of the Mtadata directory. This will provide means for
   restoring the directory in the event an incorrect file was removed.
   Microsoft support engineers may request this directory if you call in
   for further assistance.

<P><LI>After stopping the MTA service, open a command prompt. In the
   Exchsrvr\bin directory, carry out the command for MTACHECK. The minimum
   command line should be:
<P>
<P><PRE>      mtacheck /v /f c:\mta.txt
</PRE><P>
   The output file can be redirected to any drive with any file name.
   Verify that the referenced .dat file in the event error exists in the
   mtacheck log. If this is a .dat file in the MTA Work Queue, ensure that
   it does correspond to that queue (0100002B).

<P><LI>Note the "object at fault." This identifier points to a .dat file in
   the "exchsrvr\mtadata" subdirectory. If the event log does not identify
   the object at fault, it may be possible to identify the problem object
   by correlating the time/date stamp of the message in the MTA queue with
   that of a given .dat file. However, care must be exercised because there
   may be many .dat files with the same time/date stamp. If there are
   multiple files with the same time/date stamp, examination of the files
   with a text editor may reveal the problem .dat file.

<P><LI>Access the "bad" &lt;*.dat&gt; file, and then move or rename the file.

<P><LI>Open the command prompt again and run the MTACHECK utility from an MS-
   DOS prompt.

<P><LI>Start the MTA.

<P><LI>If the event errors still continue, or the MTA will not restart, call
   Microsoft Technical Support for further assistance.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbfaq<BR>
Keywords          : XCON kbtshoot kbusage<BR>
Version           : 4.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
