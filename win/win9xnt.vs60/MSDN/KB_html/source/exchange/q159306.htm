

<HTML>
<HEAD>
<TITLE>XADM: IS Maintenance Tasks Not on IS Schedule </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159306">
<META NAME="KBModify" CONTENT="1997/09/29">
<META NAME="KBCreate" CONTENT="1997/02/10">
<META NAME="Keywords" CONTENT="XADM kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Server Information Store (IS) has many tasks that run in the background and perform maintenance-type operations. This article outlines the maintenance tasks that are NOT controlled by the IS Maintenance schedule. For informat...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAL4,QA5C,QAPW,QBVV,QAZV,QAPN,QAOE,QAKD,QAYY,QBW2,QALB,QBWS,QBW5,QAG0,QBFD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: IS Maintenance Tasks Not on IS Schedule</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159306</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Exchange Server Information Store (IS) has many tasks that
run in the background and perform maintenance-type operations. This article
outlines the maintenance tasks that are NOT controlled by the IS
Maintenance schedule. For information on the tasks controlled by the IS
Maintenance Schedule see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q159196.htm">Q159196</A></B>
   TITLE     : XADM: Tasks Controlled by the IS Maintenance Schedule

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The Information Store process performs the following maintenance tasks:
<P>
<P><h3>Background Cleanup</h3>
 
<P>
Background cleanup is the process of reclaiming empty space used by deleted
folders, messages, and attachments. There is a registry variable that
controls the rate at which this task runs (not exposed in the Microsoft
Administrator program):
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS
   \ParametersPublic\Background Cleanup (value in milliseconds)

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\
   ParametersPrivate\Background Cleanup (value in milliseconds)

</PRE>Event logging is controlled by the following registry settings (also
exposed in the Microsoft Exchange Administrator Program on the Diagnostic
Logging tab for the Private/Public Information Store):
<P>
<PRE>   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS
   \Diagnostics\Private\General\Background Cleanup"

   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS
   \Diagnostics\Public\General\Background Cleanup"

</PRE><h3>Database Compaction</h3>
 
<P>
Database compaction is a function of the JET database engine, and is not
under the stores control. There is some amount of online compaction that
goes on in the background, as needed. This process cleans up the space made
available by background cleanup. There are times that compaction will not
be able to efficiently keep up and it will log the following Event ID in
the application log:
<P>
<PRE>   Event ID = 63
   Source = EDB
   Category = General
   Description = MSExchangeIS ((44)) Background Cleanup skipped pages.
   Database may benefit from defragmentation

</PRE>This Event ID means that an offline defragmentation of the Information
Store database should be scheduled and performed. Offline defragmentation
is performed by using the Edbutil.exe utility with the "/d" option. This
process is performed against each database separately (Priv.edb for the
private store, Pub.edb for the public store). For more information on
performing offline defragmentation, see the Microsoft Exchange Server
Administrator's Guide, Chapter 17.
<P>
<P><h3>Storage Warnings</h3>
 
<P>
There is a schedule page for checking user's storage limits, this is
located in the Site's Configuration Container in the properties of the
Information Store Site Configuration object under the Storage Warnings tab.
A separate background thread that is launched according to the schedule
page and runs until completion performs this check.
<P>
<P><h3>Periodic Background Activities</h3>
 
<P>
This task runs at 10-minute intervals, and has a thread allocated to it for
the duration. It performs a sequential list of tasks much like IS
maintenance.

<UL><LI>Re-read Information Store storage quota values from the Microsoft
   Exchange Directory.

<LI>Flush table row counts to the database.

<LI>Flush cached Exchange Server Directory information.

<LI>Re-read per-user Mailbox storage quota values from the Exchange Server
   Directory.

<LI>Perform other miscellaneous store functions.
<P>
</UL>These tasks, like IS maintenance, do not all run at 10-minute intervals;
each task has its own minimum frequency value, which is usually between 1
and 24 hours, depending on the task.
<P>
A number of other background activities happen at scheduled or regular
intervals, such as public folder replication, flushing of cached per user
read/unread info, expiration of unread messages, and so on. In general,
these functions allocate a thread when the task starts and free it when it
completes.
 
<PRE>Keywords          : XADM kbusage
Version           : WinNT:4.0
Platform          : winnt
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
