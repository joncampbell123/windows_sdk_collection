

<HTML>
<HEAD>
<TITLE>XCLN: Using ShivaRemote w/ Exchange (MS-DOS/LanMan TCP/IP) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157740">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1996/10/17">
<META NAME="Keywords" CONTENT="XCLN kbenv kbsetup kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  A white paper on ShivaRemote is located on Microsoft TechNet and can also be found on the following World Wide Web location:     http://www.microsoft.com/ExchangeSupport/  This article shows you how to use ShivaRemote 3.59 with the Microsoft Exchan...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWD,QBFY,QAVZ,QAA1,QAI5,QARL,QDI2,QBWS,QBXT,QA5V,QAIB,QDIZ,QDKI,QBWP,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCLN: Using ShivaRemote w/ Exchange (MS-DOS/LanMan TCP/IP)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157740</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange MS-DOS client, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A white paper on ShivaRemote is located on Microsoft TechNet and can also
be found on the following World Wide Web location:
<P>
<PRE>   <B><A href="http://www.microsoft.com/exchangesupport/">http://www.microsoft.com/ExchangeSupport/</A></B>

</PRE>This article shows you how to use ShivaRemote 3.59 with the Microsoft
Exchange MS-DOS client and LAN Manager version 2.2c with TCP/IP.
<P>
Note that because the Microsoft Exchange MS-DOS client does not provide
remote functionality, you have to run Connect.exe first to establish the
connection before starting Microsoft Exchange Server or accessing network
resources.
<P>
Conventional memory must be optimized in order for the configuration in
this article to work (with LanMan TCP). This configuration will not work if
Doublespace/Drvspace is implemented, because of the additional conventional
memory requirements for the compression drivers. Use the Config.sys,
Autoexec.bat, and Protcol.ini files shown at the end of this article as
models.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Server Considerations</h3>
 
<P>
Configure the Remote Access Server (either Windows NT or a Shiva LanRover)
to allow remote clients to request a predetermined IP address. To use this
option in Windows NT:

<OL><P><LI>In Control Panel, click the Network icon.

<P><LI>Click RAS, click Network, and click Server Settings.

<P><LI>Click TCP, and select the "Allow remote clients to request a
   predetermined IP address" check box.
<P>
</OL><h3>Client Configuration</h3>
 
<P>
Install LAN Manager version 2.2c software on the client computer. This is
located on the Windows NT 3.51 Server compact disc in the
Clients\Lanman\Disks\Disk1\Setup directory.
<P>
NOTE: If Lanman has already been installed, run Setup.exe from the LanMan
installation directory (Lanman.dos by default).

<OL><P><LI>Configure Lanman with the following options:
<P>
<P><PRE>    - TCP/IP (only) bound to the network card driver
</PRE><P>
<P><PRE>    - A static IP address, subnet mask, and default gateway
</PRE><P>
<P><PRE>    - DHCP disabled
</PRE>
<P><LI>Manually add entries for the Microsoft Exchange Server computer name
   and IP address in the HOSTS file. This file is located in the
   &lt;drive&gt;:\Lanman.dos\Etc directory, where &lt;drive&gt; is the letter of the
   local hard disk drive where LanMan is installed.

<P><LI>Configure Lanman with the following options:
<P>
<P><PRE>    - Username and HostName in the Advanced dialog box
</PRE><P>
<P><PRE>    - Windows Sockets enabled in the Advanced dialog box
</PRE><P>
<P><PRE>    - Computername, Username, and Domain in the Workstation Settings
      dialog box
</PRE>
<P><LI>Install the Microsoft Exchange client for MS-DOS. By default, the
   installation will install the ShivaRemote files in the same directory
   that the Microsoft Exchange client for MS-DOS is installed in.

<P><LI>In the Config.sys file, manually add the following line:
<P>
<P><PRE>      DEVICE=C:\EXCHANGE\DIALNDIS.EXE(after DEVICE=...\PROTMAN.DOS
      /i:C:\LANMAN.DOS)
</PRE>
<P><LI>In the Config.sys file, remark out or remove the line that loads the
   network card driver.

<P><LI>In the \Lanman.Dos\Protocol.ini file, manually edit the following:
<P>
<P><PRE>      [TCPIP_XIF]
<PRE></PRE>      ;BINDINGS = "LAN Card Driver"     Remark out this line
      BINDINGS = SDIALIN$               Add this line

      [SDIALIN$]                        Add this line
      DriverName = SDIALIN$             Add this line

</PRE><P><LI>Restart the computer and press F5 when the "Starting MS-DOS" text
   message is displayed. This will bypass the Config.sys and Autoexec.bat
   files if you are using MS-DOS 6.xx.

<P><LI>Run Connect.exe from the Microsoft Exchange client installation
   directory to bring up the ShivaRemote Connect window.

<P><LI>On the Tools menu, click Port Setup to configure the modem
   port. (You may receive an Out of Memory message if you attempt to
   select a port/modem without first booting with an F5.)

<P><LI>Click the Options button to select the IP protocol and type the static
   IP address of the client computer. For more information on creating
   and saving a connection file, refer to the ShivaRemote Online Guide.

<P><LI>Save the new connection information and quit the Connect.exe
   utility.

<P><LI>Restart the computer again. If you receive any error messages during
   startup, resolve these before continuing.

<P><LI>Open the connection file you want and click the Connect button. After
   the connection has been established, quit the Connect program. You
   should see the message regarding the static IP address. Make sure this
   is the same IP address which is statically assigned to the client
   computer.

<P><LI>Next, attempt to PING the Microsoft Exchange server computer's IP
   address and host name. The PING.EXE utility is located in the
   \LANMAN.DOS\NETPROG directory.  If PINGing the host name fails, but
   PINGing the IP address works, the HOSTS file must be modified (see Step
   2 above). This step is necessary for the Microsoft Exchange client to
   connect to the server.

<P><LI>Start the Microsoft Exchange client.
<P>
</OL>NOTE: To disconnect, either run Connect.exe again and select Disconnect or
type "connect /d" from the command line.
<P>
Updated modem scripts for use with ShivaRemote can be found on Shiva's
web page at www.shiva.com under "support"/modem scripts.
<P>
Additional configuration information can also be found in the Config.hlp
file installed during installation of the ShivaRemote software.
<P>
<P><h3>Sample Configuration Files</h3>
 
<P>
NOTE: In order to format these samples for the Web, some line breaks had to
be changed. In the Config.sys example, the following line should be part of
the line that preceded it (this occurs twice):
<P>
<PRE>   /i:C:\LANMAN.DOS

</PRE></OL>In the Autoexec.bat example, the following line should be part of the line
that preceded it:
<P>
<PRE>   2.2a

</PRE>Use these Config.sys, Autoexec.bat, and Protcol.ini files as models.
<P>
<PRE>   Config.sys
   ----------

   device=c:\dos\himem.sys /testmem:off
   device=c:\dos\emm386.exe noems
   devicehigh=c:\win95\command\drvspace.sys /move
   LASTDRIVE=Z
   DOS=HIGH,UMB
   DEVICEhigh=C:\LANMAN.DOS\DRIVERS\PROTMAN\PROTMAN.DOS /i:C:\LANMAN.DOS
   devicehigh=c:\doscln\dialndis.exe
   rem DEVICE=C:\LANMAN.DOS\DRIVERS\ETHERNET\DEPCA\DEPCA.DOS
   DEVICEhigh=C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\tcpdrv.dos
      /i:C:\LANMAN.DOS
   DEVICEhigh=C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\nemm.dos

   Autoexec.bat
   ------------

   @REM ==== LANMAN 2.2a == DO NOT MODIFY BETWEEN THESE LINES == LANMAN
      2.2a
   ====
   SET PATH=C:\LANMAN.DOS\NETPROG;%PATH%
   C:\LANMAN.DOS\DRIVERS\PROTOCOL\tcpip\umb.com
   NET START WORKSTATION
   LOAD TCPIP
   SOCKETS
   rem NET LOGON shivat *
   @REM ==== LANMAN 2.2a == DO NOT MODIFY BETWEEN THESE LINES == LANMAN
      2.2a
   ====
   set EXCHANGE=C:\DOSCLN
   set RPC_BINDING_ORDER=ncalrpc,ncacn_np,ncacn_spx,ncacn_ip_tcp,netbios

   Protocol.ini
   ------------

   [PROTMAN]
     DRIVERNAME = PROTMAN$
     DYNAMIC = YES
     PRIORITY = NETBEUI

   [TCPIP_XIF]
     DRIVERNAME      = TCPIP$
     IPADDRESS0 = 200 200 200 201
     SUBNETMASK0 = 255 255 255 0
     DEFAULTGATEWAY0 =
     NBSESSIONS = 6
   ; the following two parameters added after documentation was completed
     TCPSEGMENTSIZE  = 1450
     TCPWINDOWSIZE   = 1450
     LOAD            = tcptsr[c],tinyrfc[c],emsbfr[cr]
     UNLOAD          = "unloadt /notsr[dc]"
   ;  BINDINGS = "DEPCA_NIF"
     BINDINGS = SDIALIN$
     NETFILES = C:\LANMAN.DOS\ETC
     DISABLEDHCP = 1
     LANABASE = 0

   [SDIALIN$]
   DRIVERNAME=SDIALIN$

   [DEPCA_NIF]

   ; protocol.ini section for the DEC EtherWORKS (MC, LC, Turbo &amp; DEPCA)
   Adapters

       DriverName  = DEPCA$
       MaxMulticast = 12
       MaxTransmits = 32
       AdapterName  = DE200
       RamAddress   = 0xD000
       Interrupt   = 3
    ;  use Interupt = 5 for turbo board

</PRE><h2>REFERENCE</h2>
 
<P>
For additional information on supported Shiva configurations for use with
the Microsoft Exchange Server, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q158124.htm">Q158124</A></B>
   TITLE     : XCLN: ShivaRemote with Exchange - RAS Server Considerations

   ARTICLE-ID: <B><A href="../exchange/q158074.htm">Q158074</A></B>
   TITLE     : XCLN: Using ShivaRemote with Exchange (DOS/real-mode IPX)

   ARTICLE-ID: <B><A href="../exchange/q158095.htm">Q158095</A></B>
   TITLE     : Using ShivaRemote with Exchange (Windows 3.x/LanMan NetBEUI)

   ARTICLE-ID: <B><A href="../exchange/q158077.htm">Q158077</A></B>
   TITLE     : Using ShivaRemote with Exchange (Windows 3.x/real-mode IPX)

   ARTICLE-ID: <B><A href="../exchange/q158111.htm">Q158111</A></B>
   TITLE     : ShivaRemote with Exchange (WFW 3.11/WFW TCP/IP or
               NetBEUI)

</PRE>The third-party contact information included in this article is provided to
help you find the technical support you need. This contact information is
subject to change without notice. Microsoft in no way guarantees the
accuracy of this third-party contact information.
 
<PRE>Keywords          : XCLN kbenv kbsetup kbusage
Version           : winnt:4.0,5.0
Platform          : MS-DOS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
