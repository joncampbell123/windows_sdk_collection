

<HTML>
<HEAD>
<TITLE>XADM: Calling HRBackupGetDatabaseNames Returns Invalid Parameter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q159170">
<META NAME="KBModify" CONTENT="1997/04/09">
<META NAME="KBCreate" CONTENT="1996/11/11">
<META NAME="Keywords" CONTENT="kbbug4.00 kbfix4.00.sp4 kbusage XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  After installing Microsoft Exchange Server Service Pack 3 (SP3), using the HRBackupGetDatabaseNames call from the Microsoft Exchange Software Developers Kit (SDK) may stop with the following error message:     Return Code: 0x57 - invalid parameter ...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAUD,QAR4,QAGI,QA3W,QBWP,QAB4,QAAP,QAHE,QAKP,QAM1,QAC1,QALW,QAIF,QDIX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Calling HRBackupGetDatabaseNames Returns Invalid Parameter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q159170</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After installing Microsoft Exchange Server Service Pack 3 (SP3), using the
HRBackupGetDatabaseNames call from the Microsoft Exchange Software
Developers Kit (SDK) may stop with the following error message:
<P>
<PRE>   Return Code: 0x57 - invalid parameter

</PRE><h2>CAUSE</h2>
 
<P>
A new version of Edbbcli.dll was included in Service Pack 3 to fix a
problem when using Windows NT4.0 to remotely backup a computer that is
running both Microsoft Exchange Server and Windows NT 3.51.
<P>
Producing this fix introduced an error in the conversion of an ASCII string
to uni-code. NTBackup uses uni-code directly and this error causes the
call to HRBackupGetDatabaseNames to be handled incorrectly and return the
"invalid parameter."
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Replace the SP3 version of Edbbcli.dll in the &lt;winntdir&gt;\System32 directory
with the version shipped in Microsoft Exchange Server Service Pack 2 or
Microsoft Exchange Server version 4.0a.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Obtain the fix referenced below. Edbbcli.dll was updated to properly handle
the ASCII to uni-code conversion.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange version
4.0.
This problem was corrected in the latest Microsoft Exchange 4.0 U.S. Service Pack. For information on obtaining the service pack, query on the following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE>MORE INFORMATION
<P>
 
<P>
This problem is primarily seen by those using Cheyenne's Arcserve backup
and Cheyenne's Exchange Database Agent software after applying Microsoft
Exchange Server Service Pack 3.
<P>
The third-party products discussed here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>
<P><h2>REFERENCE</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q156715.htm">Q156715</A></B>
   TITLE     : XADM: Unable to Back Up Exchange on Remote Server from NT
               4.0
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug4.00 kbfix4.00.sp4 kbusage XADM<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
