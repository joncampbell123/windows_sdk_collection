

<HTML>
<HEAD>
<TITLE>XFOR: How to Remove a Corrupted DXA Message from Exchange MTA </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164506">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/03/03">
<META NAME="Keywords" CONTENT="XFOR kbtshoot kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  Sometimes a directory synchronization (dirsync) message becomes corrupted and cannot be removed from the message transfer agent (MTA) queue, making the dirsync agent (DXA) unable to receive further requestor updates. In order to fix this problem, y...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEF,QAEV,QDH6,QA9N,QANJ,QDKD,QAYC,QAR4,QAA1,QACI,QAM1,QBWS,QASC,QAJP,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XFOR: How to Remove a Corrupted DXA Message from Exchange MTA</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164506</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
<P>
The information in this article applies to:

<UL><LI>Microsoft Exchange Server versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes a directory synchronization (dirsync) message becomes corrupted
and cannot be removed from the message transfer agent (MTA) queue, making
the dirsync agent (DXA) unable to receive further requestor updates. In
order to fix this problem, you need to either find and remove the .dat file
corresponding to the dirysnc message, or remove the DXA queue and rebuild
it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In order fix this problem

<OL><P><LI>Stop the Exchange Server MTA and run MTACHECK with the following
   command:
<P>
<P><PRE>      MTACHECK /V /F logfile.txt
</PRE><P>
   This will generate a log file and allow you to determine which queue the
   DXA owns, and which objects (.dat files) are associated with those
   queues.

<P><LI>Look in the logfile for an entry that looks like this:
<P>
   /O=ORG/OU=SITE/CN=CONFIGURATION/CN=SERVER/CN=MICROSOFT DXA (id 01000045)

<P><LI>Match that ID (01000045) with a Checking object line to determine which
   .dat file is corrupt. For example:
<P>
<P><PRE>      Checking object 0350000FB -OK, on queue 01000045
</PRE><P>
   In this case, the file will be Exchsrvr\MTADATA\DB50000FB.dat. Find the
   entry that is closest to the time and date that the DXA stopped
   receiving dirsync messages and rename the file to *.tmp.

<P><LI>Run MTACHECK and start the Microsoft Exchange MTA.

<P><LI>Do a manual dirsync to see if that fixed the problem; if not, remove the
   next closest .dat file (associated with the DXA) and try again.
<P>
</OL>NOTE: There are two alternative means of cleaning out ALL dirsync
messages:

<UL><LI>Delete the actual DXA .dat file and run MTACHECK twice. This will force
   the deletion of all dirsync messages and re-create a new DXA queue.
<P>
</UL>-OR-

<UL><LI>Use the latest version of MTACHECK and run it with the following
   command:
<P>
<P><PRE>       MTACHECK /RD
</PRE><P>
   This will remove all dirsync messages automatically.
</UL> 
<PRE>Keywords          : XFOR kbtshoot kbusage
Version           : winnt:4.0,5.0
Platform          : winnt
Issue type        : kbprb
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
