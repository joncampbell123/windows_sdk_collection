

<HTML>
<HEAD>
<TITLE>XADM: Chat Fails w/ Invalid Number of Reply/Request Arguments </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178259">
<META NAME="KBModify" CONTENT="1998/01/02">
<META NAME="KBCreate" CONTENT="1997/12/18">
<META NAME="Keywords" CONTENT="XADM kbbug5.50 kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  The Microsoft Exchange Server 5.5 Chat Service stops responding; there is an Access Violation causing the Inetinfo.exe process to terminate.  CAUSE =====  The Exchange Server Chat Service fails to verify that a minimum number of four arguments (inc...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI8,QAYA,QAR4,QAPN,QAKC,QAGI,QAHE,QAI4,QBC6,QAKP,QACK,QAH6,QAG8,QAAY,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Chat Fails w/ Invalid Number of Reply/Request Arguments</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178259</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server version 5.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Microsoft Exchange Server 5.5 Chat Service stops responding; there is
an Access Violation causing the Inetinfo.exe process to terminate.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Exchange Server Chat Service fails to verify that a minimum number of
four arguments (including the command) are being passed to the REQUEST and
REPLY commands. Failure of a Chat client to provide enough arguments can
result in the service failure described here.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Exchange version 5.5. A
supported fix is now available, but has not been fully regression tested
and should be applied only to systems experiencing this specific problem.
Unless you are severely impacted by this specific problem, Microsoft
recommends that you wait for the next Service Pack that contains this fix.
Contact Microsoft Technical Support for more information.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With the fix applied, the Exchange Server Chat Service is modified to check
the number of arguments provided and to reply with an error to a chat
client that does not provide enough arguments.
<P>
When you are experiencing this problem, if you examine the Drwtsn32.log
file generated by a failing process in the %systemroot% directory, you may
see an entry similar to the following:
<P>
<PRE>   Application exception occurred:
        App: exe\inetinfo.dbg (pid=137)
        When: 12/10/1997 @ 9:52:13.279
        Exception number: c0000005 (access violation)

   State Dump for Thread Id 0x1c7

   eax=78040338 ebx=0215415a ecx=00000009 edx=00002000 esi=00000000
   edi=1003a8bc
   eip=7802b225 esp=07bbeb40 ebp=07bbeb4c iopl=0         nv up ei pl zr na
   po nc
   cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000
   efl=00000246

   function: memicmp
        7802b208 7440             jz      memicmp+0x4d (7802b24a)
        7802b20a 8b7508           mov     esi,[ebp+0x8]
        7802b20d 8b7d0c           mov     edi,[ebp+0xc]
        7802b210 8d0538030478    lea eax,[_lc_handle (78040338)]
        7802b216 83780800         cmp    dword ptr [eax+0x8],0x0
        7802b21a 7540             jnz     memicmp+0x5f (7802b25c)
        7802b21c b741             mov     bh,0x41
        7802b21e b35a             mov     bl,0x5a
        7802b220 b620             mov     dh,0x20
        7802b222 2e8bc0           mov     eax,cs:eax
   FAULT -&gt;7802b225 8a26             mov     ah,[esi]
        7802b227 46               inc     esi
        7802b228 8a07             mov     al,[edi]
        7802b22a 47               inc     edi
        7802b22b 38c4             cmp     ah,al
        7802b22d 7418             jz      memicmp+0x4a (7802b247)
        7802b22f 38fc             cmp     ah,bh
        7802b231 7206             jb      memicmp+0x3c (7802b239)
        7802b233 38dc             cmp     ah,bl
        7802b235 7702             ja      memicmp+0x3c (7802b239)
        7802b237 02e6             add     ah,dh
        7802b239 38f8             cmp     al,bh

   *----&gt; Stack Back Trace &lt;----*

   FramePtr ReturnAd Param#1  Param#2  Param#3  Param#4  Function Name
   07bbeb4c 10011156 00000000 1003a8bc 00000009 0000005e msvcrt!memicmp
   07bbecec 1001aa84 07bbed0c 07bbee48 00000002 02151dc0
   ChatSvc!CIrcUser::CommandMessage
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: fail crash hang<BR>
Keywords          : XADM kbbug5.50 kbusage<BR>
Version           : WinNT:5.5<BR>
Platform          : winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpatch<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
