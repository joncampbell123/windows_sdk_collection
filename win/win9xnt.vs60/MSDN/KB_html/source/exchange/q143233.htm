

<HTML>
<HEAD>
<TITLE>XADM: Command-Line Parameters for Edbutil.exe </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143233">
<META NAME="KBModify" CONTENT="1997/12/10">
<META NAME="KBCreate" CONTENT="1996/01/29">
<META NAME="Keywords" CONTENT="XADM kbtool kbusage">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT=" CAUTION: This article contains information about the Microsoft Exchange database utility (edbutil /d /r). Using it incorrectly can cause problems. Before you run this utility, you should first make a backup copy of the database files. Microsoft cann...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAZV,QAHE,QAUJ,QAKR,QBV8,QAFI,QDIU,QABA,QAC1,QBDM,QBCU,QBBI,QA2S,QARM,QANE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Command-Line Parameters for Edbutil.exe</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143233</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
</UL> 
<P>
CAUTION: This article contains information about the Microsoft Exchange
database utility (edbutil /d /r). Using it incorrectly can cause problems.
Before you run this utility, you should first make a backup copy of the
database files. Microsoft cannot guarantee that problems resulting from the
use of the utility can be solved. Use this tool at your own risk.
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article shows the command line parameters for running Edbutil.exe.
Edbutil.exe is used for database repair. It can be used to repair the
following databases
<P>
<PRE>   \Exchsrvr\Dsadata\Dir.edb  -  Directory Database
   \Exchsrvr\Mdbdata\Priv.edb -  Private Folders Database
   \Exchsrvr\Mdbdata\Pub.edb  -  Public Folders Database

</PRE>where \Exchsrvr is the directory where Exchange Server is installed.
<P>
If you are having problems starting the information store, please see the
following article in the Microsoft Knowledge Base before you run the
Edbutil.exe utility:
<P>
<PRE>   ARTICLE-ID: <B><A href="../exchange/q147244.htm">Q147244</A></B>
   TITLE     : XADM: Troubleshooting Information Store Start Up Problems

</PRE><h2>MORE INFORMATION</h2>
 
<P>
To see the command line options for Exchange Server Database Utilities,
open an MS-DOS command prompt on the Exchange Server computer, change to
the \Exchsrvr\Bin directory, and then type
<P>
<PRE>   Edbutil.exe /?

</PRE>at the command prompt.  You will see the following:
<P>
Microsoft(R) Exchange Server Database Utilities
<P>
Version 4.0
<P>
Copyright (C) Microsoft Corporation 1991-1996.  All Rights Reserved.
<P>
<P>
<P>
DESCRIPTION:  Maintenance utilities for Microsoft(R) Exchange Server
databases.
<P>
MODES OF OPERATION:
<PRE>   Defragmentation:  EDBUTIL /d &lt;database name&gt; [options]
          Recovery:  EDBUTIL /r [options]
          Backup:  EDBUTIL /b &lt;backup path&gt; [options]
          Upgrade:  EDBUTIL /u &lt;database name&gt; /d&lt;previous .DLL&gt; [options]
          File Dump:  EDBUTIL /m[mode-modifier] &lt;filename&gt;

</PRE>&lt;&lt;&lt;&lt;&lt;  Press a key for more help  &gt;&gt;&gt;&gt;&gt;
D=Defragmentation, R=Recovery, C=Consistency, U=Upgrade, M=File Dump =&gt;
<P>
Selecting D shows the following options:
<P>
DEFRAGMENTATION/COMPACTION:
<P>
<PRE>    DESCRIPTION:  Performs off-line compaction of a database.
          SYNTAX:  EDBUTIL /d &lt;database name&gt; [options]
          PARAMETERS:  &lt;database name&gt; - filename of database to compact,
                                    or one of /ispriv, /ispub, or /ds (see
                                    NOTES below)
          OPTIONS:  zero or more of the following switches, separated by a
                    space:
                  /l&lt;path&gt; - location of log files (default: current
                             directory)
                  /s&lt;path&gt; - location of system files (eg. checkpoint file)
                             (default: current directory)
                  /r       - repair database while defragmenting
                  /b&lt;db&gt;   - make backup copy under the specified name
                  /t&lt;db&gt;   - set temp. database name (default:
                             TEMPDFRG.EDB)
                             Note: Do not put a space between the switch
                             and the database name.
                  /p       - preserve temporary database (ie. don't
                             instate)
                  /n       - dump defragmentation information to
                             DFRGINFO.TXT
                  /o       - suppress logo
          NOTES:  1) The switches /ispriv, /ispub, and /ds use the Registry
                     to automatically set the database name, log file path,
                     and system file path for the appropriate Exchange
                     store.
                  2) Before defragmentation begins, soft recovery is always
                     performed to ensure the database is in a consistent
                     state.
                  3) If instating is disabled (ie. /p), the original
                     database is preserved uncompacted, and the temporary
                     database will contain the defragmented version of the
                     database.

   Selecting R shows the following options:

 RECOVERY:

          DESCRIPTION:  Performs recovery, bringing all databases to a
                        consistent state.
          SYNTAX:  EDBUTIL /r [options]
          OPTIONS:  zero or more of the following switches, separated by a
                    space:
                  /is or /ds - see NOTES below
                  /l&lt;path&gt;   - location of log files
                               (default: current directory)
                  /s&lt;path&gt;   - location of system files (eg. checkpoint
                               file)
                               (default: current directory)
                  /o         - suppress logo
          NOTES:  1) The special switches /is and /ds use the Registry to
                     automatically set the log file path and system file
                     path for recovery of the appropriate Exchange
                     store(s).

   Selecting C shows the following options:

 CONSISTENCY:

          DESCRIPTION:  Verifies consistency of a database.
          SYNTAX:  EDBUTIL /c &lt;database name&gt; [options]
          PARAMETERS:  &lt;database name&gt; - filename of database to verify, or
                                         one of /ispriv, /ispub, or /ds
                                        (see NOTES below)
          OPTIONS:  zero or more of the following switches, separated by a
                    space:
                  /a       - check all nodes, including deleted ones
                  /k       - generate key usage statistics
                  /p       - generate page usage information
                  /t&lt;name&gt; - performs a check on the specified table only
                             (default: checks all tables in the database)
                             Note: Do not put a space between the switch
                             and the database name.
                  /o       - suppress logo
           NOTES:  1) The consistency-checker performs no recovery and
                      always assumes that the database is in a consistent
                      state, returning an error if this is not the case.
                   2) The special switches /ispriv, /ispub, and /ds use the
                      Registry to automatically set the database name for
                      the appropriate Exchange store.

   Selecting U shows the following options:

 UPGRADE:

          DESCRIPTION:  Upgrades a database (created using a previous
                        release of Microsoft(R) Exchange Server) to the
                        current version.
          SYNTAX:  EDBUTIL /u &lt;database name&gt; /d&lt;previous .DLL&gt; [options]
          PARAMETERS:  &lt;database name&gt;   - filename of the database to
                                           upgrade.
                  /d&lt;previous .DLL&gt; - pathed filename of the .DLL that came
                                      with the release of Microsoft(R)
                                      Exchange Server from which you're
                                      upgrading.
           OPTIONS:  zero or more of the following switches, separated by a
                     space:
                  /b&lt;db&gt; - make backup copy under the specified name
                  /t&lt;db&gt; - set temporary database name (default:
                           TEMPUPGD.EDB)
                           Note: Do not put a space between the switch
                           and the database name.
                  /p     - preserve temporary database (ie. don't instate)
                  /n     - dump upgrade information to UPGDINFO.TXT
                  /o     - suppress logo
          NOTES:  1) This utility should only be used to upgrade a database
                     after an internal database format change has taken
                     place.
                     If necessary, this will usually only coincide with the
                     release of a major, new revision of Microsoft(R)
                     Exchange Server.
                  2) Before upgrading, the database should be in a
                     consistent state. An error will be returned if
                     otherwise.
                  3) If instating is disabled (ie. /p), the original
                     database is preserved unchanged, and the temporary
                     database will contain the upgraded version of the
                     database.

   Selecting M shows the following options:

 FILE DUMP:

          DESCRIPTION:  Generates formatted output of various database file
                        types.
          SYNTAX:  EDBUTIL /m[mode-modifier] &lt;filename&gt;
          PARAMETERS:  [mode-modifier] - an optional letter designating the
                       type of file dump to perform. Valid values are:
                                    h - dump database header (default)
                                    k - dump checkpoint file
                  &lt;filename&gt;  - name of file to dump. The type of the
                                specified file should match the dump type
                                being requested (eg. if using /mh, then
                                &lt;filename&gt; must be the name of a database).
</PRE> 
<PRE>Keywords          : XADM kbtool kbusage
Version           : 4.0 5.0
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
