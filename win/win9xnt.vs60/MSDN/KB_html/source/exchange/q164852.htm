

<HTML>
<HEAD>
<TITLE>XCON: Attachments from HP OpenDesk May Not Open </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164852">
<META NAME="KBModify" CONTENT="1997/07/15">
<META NAME="KBCreate" CONTENT="1997/03/07">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix4.00.sp4 kbfix5.00.sp1 kbusage XCON">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  If you send mail with an attachment from Hewlett Packard (HP) OpenDesk mail to a computer running Microsoft Exchange Server through the X.400 connector (1984), the Microsoft Exchange Server recipient (on the same server as the X.400 connector) rece...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5T,QAYC,QAI4,QAEV,QBVV,QAY2,QAR4,QBWS,QAH6,QBDM,QAB4,QDO3,QDKW,QAUJ,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XCON: Attachments from HP OpenDesk May Not Open</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164852</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0
<LI>Microsoft Exchange Server, version 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you send mail with an attachment from Hewlett Packard (HP) OpenDesk mail
to a computer running Microsoft Exchange Server through the X.400 connector
(1984), the Microsoft Exchange Server recipient (on the same server as
the X.400 connector) receives a message with an attachment of the correct
name. However, when the user clicks the attachment to open it, he or she
may get an error message reporting "This file does not have a program
associated with it." The title bar of the message shows that the file it is
attempting to open is c:\Temp\Att.dat. The error occurs even if you have an
association for the file extension of the attachment.
<P>
<P><h2>CAUSE</h2>
 
<P>
HP OpenDesk message is malformed. It does not include the file name in the
"pathname" attribute, as specified by the Electronic Messaging Association
(see the MORE INFORMATION section of this article). The following is the
incoming message in ASN.1 format:
<P>
ASN.1 Parser Utility
Starting at Node 0ftrp [ id = 2879 ]
<PRE>   3080
   A180     : 0cnty : ContentsType
   A080     : 0doct : DocumentType
   0605     : 0dctn : DocumentTypeName             :  OBJECT ID:
   "0x28C27B0503"
   0000

   0000
   A280     : 0envr : EnvironmentParameter
   A080     : 0aprf : ApplicationReference
   8008     : 0regi : RegisteredIdentifier         :  OBJECT ID:
   "0x2A864886F7140403"
   0000

   A380     : 0usvs : DescriptiveIdentifier
   190C     : 0usrv : GraphicString
   ="0x474E53494E56454E2E584C53"
   0000

   0000
   A480     : 0flat : FileAttributes
   AD80     : 0objs : ObjectSize
   8102     : 0actv : ActualValue                INTEGER 0x6800
   0000

   0000
   0000

</PRE>No PathName is present, so the Microsoft Exchange Server MTA cannot apply a
proper attachment name for display. The fix supplied by Microsoft (see the
STATUS section of this article) treats the user-visible string as the file
name (in the example above, the user-visible string is the
"DescriptiveIdentifier GraphicString" attribute).
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, save the attachments as files before opening
them.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
versions 4.0 and 5.0.
This problem was corrected in the latest Microsoft Exchange Server 4.0 and 5.0
U.S. Service Packs. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The standards reference for File Transfer Body Part (FTBP) usage is from
the Electronic Messaging Association (EMA), Message Attachment Work Group
File Transfer Body Part Feasibility Project Guide, v.1.5.2, June 1996.
<P>
The following is an excerpt from section 5, File Transfer Body Part 15
Profile, describing where the filename is supposed to go :
<P>
<PRE>                               O  R    Notes
   File-Transfer-Body-Part
   FileTransferParameters
   Environment
   user-visible-string            R  M    note 3
   File-Attributes
   pathname                   R  M    note 4

   O - Origination, R - Reception
   R - recommended, M - mandatory

   Notes

   3. User-Visible-String
   This element should be used to convey any additional distinguishing
   information that might be of use to the receiver, eg. for presentation
   to a user or in cases where the application-reference is not recognized
   by the receiving system.

   4. Pathname
   If generated, the incomplete-pathname should be used. The SEQUENCE
   should only consist of a single GRAPHIC-STRING element containing the
   target file/attachment name without any preceding path information.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug4.00 kbbug5.00 kbfix4.00.sp4 kbfix5.00.sp1 kbusage XCON<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
