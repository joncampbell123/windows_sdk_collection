

<HTML>
<HEAD>
<TITLE>XADM: How to Update a Client Install Share with SP4 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131964">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1995/06/25">
<META NAME="Keywords" CONTENT="kbsetup XADM">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT=" The following procedures allow you to update a Microsoft Exchange Server 4.0 Service Pack 2 client installation point with Microsoft Exchange Server Service Pack 4 binary files. If you have already updated your client installation point with Service...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QAA1,QDI2,QARL,QBXB,QATJ,QAXB,QAFI,QBC9,QBC8,QANO,QBWS,QA9N,QA3P,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: How to Update a Client Install Share with SP4</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131964</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, version 4.0 Service Pack 2
</UL> 
<P>
The following procedures allow you to update a Microsoft Exchange Server
4.0 Service Pack 2 client installation point with Microsoft Exchange Server
Service Pack 4 binary files. If you have already updated your client
installation point with Service Pack 3 binaries, you can use this same
procedure to update it to Service Pack 4 by following the second set of
instructions below.
<P>
This allows new users to run the client Setup once and have all the fixes
in Service Pack 4 on their workstation. This also allows an existing
Microsoft Exchange Server 4.0 RTM user to run client Setup just once
(instead of twice) to update the workstation with all of the Service Pack 2
and Service Pack 4 binary files.
<P>
NOTE: Microsoft Exchange Service Pack 4 has cumulative fixes based on
Service Pack 2. Therefore, all fixes in Service Pack 3 are also included in
Service Pack 4.
<P>
These procedures are very detailed and require a lot of editing by the
System Administrator. It is easy to make an editing mistake, so take your
time and double-check your changes. These procedures will work for all
client platforms and languages. Thorough testing is recommended before
making this installation point available to your users.
<P>
To update a Microsoft Exchange Server 4.0 Service Pack 2 Client
installation point with Microsoft Exchange Client Service Pack 4 binary
files:

<OL><P><LI>Create a Microsoft Exchange Server SP2 Client Administration share on
   your network by using setup /a. This provides all the binary files in
   expanded form and eliminates the CAB files. Name the directory Sp2.mod.

<P><LI>Run Setup Editor (if you have done so in the past) and do your normal
   modifications.

<P><LI>In a separate directory on your network, copy the contents of the
   Service Pack 4 client directory that matches the client you set up in
   Step 1. Name the directory Sp4.org.

<P><LI>Copy the Extract.exe and Sp4extrt.bat files from the \Support directory
   of the Service Pack 4 compact disc to the Sp4.org directory.

<P><LI>From the Sp4.org directory, run Sp4extrt.bat. This will create an
   \Sp4.org\Rawsp4 directory and will place all the extracted Service
   Pack 4 binary files there.

<P><LI>Using your favorite text editor, open \Sp2.mod\Exchng.inf and
   \Sp4.org\Rawsp4\Exchng.inf.

<P><LI>For each line listed in \Sp4.org\Rawsp4\Exchng.inf, make the
   corresponding date, size, and version changes in \Sp2.mod\Exchng.inf. If
   the file doesn't exist in \Sp2.mod\Exchng.inf, skip it. Don't do a
   complete line copy; this will break Setup.
<P>
   VERY IMPORTANT! Only change the date, the size (if it changes), and the
   version. Be careful not to delete commas or additional fields.

<P><LI>After your modifications are complete, save it to its original location
<P>
   and close the text editor.

<P><LI>Replace the files in Sp2.mod with the corresponding files in
   \Sp4.org\Rawsp4.

<P><LI>Replace the files in \Sp2.mod\System with the corresponding files
   in \Sp4.org\Rawsp4. This will be most, but not all, of the remaining
   Service Pack 4 files. It may be easiest to do this in File Manager with
   two windows, each sorted by name. To ensure that you are able to see all
   files, do the following:
<P>
<P><PRE>      a. In File Manager, click Options on the View menu.
</PRE><P>
<P><PRE>      b. Click Show All Files and then click OK.
</PRE><P>
<P><PRE>      c. Select the corresponding Service Pack 4 files and drag them to
<PRE></PRE>         the appropriate directory.

</PRE></OL>You are now ready to test your client installation.
<P>
NOTE: Extract.exe is a Win16 utility.
<P>
To update a Microsoft Exchange Server 4.0 Service Pack 3 Client
installation point with Microsoft Exchange Client Service Pack 4 binary
files:

<OL><P><LI>Copy your Service Pack 3 client installation point to a new directory
   called Sp3.mod.

<P><LI>In a separate directory on your network, copy the contents of the SP4
   client directory that matches the client installation you copied in
   step 1. Call the directory Sp4.org.

<P><LI>Copy the Extract.exe and Sp4extrt.bat files from the \Support directory
   of the Service Pack 4 compact disc to the Sp4.org directory.

<P><LI>From the Sp4.org directory, run Sp4extrt.bat. This will create an
   \Sp4.org\Rawsp4 directory and will place all the extracted Service
   Pack 4 binary files there.

<P><LI>Using your favorite text editor, open \Sp3.mod\Exchng.inf and
   \Sp4.org\Rawsp4\Exchng.inf.

<P><LI>For each line listed in \Sp4.org\Rawsp4\Exchng.inf, make the
   corresponding date, size, and version changes in \Sp3.mod\Exchng.inf. If
   the file doesn't exist in \Sp3.mod\Exchng.inf, skip it. Don't do a
   complete line copy; this will break Setup.
<P>
   VERY IMPORTANT! Only change the date, the size (if it changes), and the
   version. Be careful not to delete commas or additional fields.

<P><LI>After your modifications are complete, save it to its original location
   and close the text editor.

<P><LI>Replace the files in Sp3.mod with the corresponding files in
   \Sp4.org\Rawsp4.

<P><LI>Replace the files in \Sp3.mod\System with the corresponding files in
   \Sp4.org\Rawsp4. This will be most, but not all, of the remaining
   Service Pack 4 files. It may be easiest to do this in File Manager with
   two windows, each sorted by name. To ensure that you are able to see all
   files, do the following:
<P>
<P><PRE>      a. In File Manager, click Options on the View menu.
</PRE><P>
<P><PRE>      b. Click Show All Files and then click OK.
</PRE><P>
<P><PRE>      c. Select the corresponding Service Pack 4 files and drag them to
<PRE></PRE>         the appropriate directory.

</PRE></OL>You are now ready to test your client installation.
<P>
NOTE: Extract.exe is a Win16 utility.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbsetup XADM<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
