

<HTML>
<HEAD>
<TITLE>XADM: Access Violation in Store.exe After Upgrading to SP4 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167132">
<META NAME="KBModify" CONTENT="1997/11/13">
<META NAME="KBCreate" CONTENT="1997/04/17">
<META NAME="Keywords" CONTENT="kbbug4.00 kbbug5.00 kbfix5.00.sp1 XADM kbusage buglist">
<META NAME="KBArea" CONTENT="Support; KB; exchange">
<META NAME="Description" CONTENT="  After you upgrade to Microsoft Exchange Server Service Pack 4 or Microsoft Exchange Server version 5.0, the information store may raise a general protection fault (GPF), resulting in a Drwtsn32.log similar to the one below:     Application exceptio...">
<META NAME="Product" CONTENT="Exchange">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI4,QDO3,QBFY,QAR4,QA1S,QAY5,QAYY,QAKP,QDN9,QBW7,QAI5,QAJ6,QAC1,QBWG,QAYZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XADM: Access Violation in Store.exe After Upgrading to SP4</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167132</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Exchange Server, versions 4.0 and 5.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you upgrade to Microsoft Exchange Server Service Pack 4 or Microsoft
Exchange Server version 5.0, the information store may raise a general
protection fault (GPF), resulting in a Drwtsn32.log similar to the one
below:
<P>
<PRE>   Application exception occurred:
           App: Store.DBG (pid=333)
           When: 4/8/1997 @ 15:27:56.295
           Exception number: c0000005 (access violation)

</PRE><h2>CAUSE</h2>
 
<P>
An invalid address for a recipient is sent in a message to the information
store. While processing the message, the information store mishandles the
address and causes the access violation.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Exchange Server
versions 4.0 and 5.0.
A supported fix for Microsoft Exchange 4.0 is now available, but has not
been fully regression-tested and should be applied only to systems
experiencing this specific problem. Unless you are severely impacted by
this specific problem, Microsoft recommends that you wait for the next
Service Pack that contains this fix. Contact Microsoft Technical Support
for more information.
<P>
This problem was corrected in the latest Microsoft Exchange Server 5.0 U.S. 
Service Pack. For information on obtaining the service pack, query on the
following word in the Microsoft Knowledge Base (without the spaces):
<P>
<PRE>   S E R V P A C K

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<PRE>   State Dump for Thread Id 0x107

   EAX=00000000  EBX=00000000  ECX=00000000  EDX=00ef8cec  ESI=fffffffc
   EDI=021340e7
   EIP=0200d01b  ESP=01c3f51c  EBP=01c3f5c8  EFL=00000246
   CS=001b  DS=0023  ES=0023  SS=0023  FS=003b  GS=0000

   Function: CbStrlenWithoutNullW:
           0x0200d015  33c0             xor          eax,eax
           0x0200d017  8b4c2404         mov          ecx,dword ptr [esp+04]
   FAULT--&gt;0x0200d01b  663901           cmp          word ptr [ecx],ax
           0x0200d01e  740c             je           0200d02c
           0x0200d020  83c002           add          eax,02
           0x0200d023  83c102           add          ecx,02
           0x0200d026  66833900         cmp          word ptr [ecx],00
           0x0200d02a  75f4             jne          0200d020
           0x0200d02c  c20400           retn         0004

   *----&gt; Stack Back Trace &lt;----*
   FramePtr ReturnAd Param#1  Param#2  Param#3  Function Name
   01c3f518 02033240 00000000 00000000 00b98ad8
   STORE!CbStrlenWithoutNullW+0x6
   01c3f5c8 02111c79 00f00a4c 00b98ad8 01c3f968
   STORE!EcEntryIdFromORName+0xa0c
   01c3f970 021116ba 00f05b2c 00000000 00000001 STORE!EcDeliverNDR+0x21a
   01c3fb44 0211cee5 00ef1cbc 00eef58c 00ee8edc
   STORE!EcDeliverReport+0x1334
   01c3fd6c 0211c905 00ef1cbc 00ee8edc 00b988cc STORE!EcTferInMessage+0x37a
   01c3ff90 0204ef4c 00000000 00330012 00dbfbe4
   STORE!FStartTransferIn+0x5f5
   01c3ffb8 77f04f4a 00000000 00dbfbe4 c0000034 STORE!EcProcessTask+0x129
   01c3ffec 00000000 00000000 00000000 00000000
   KERNEL32!BaseThreadStart+0x69

   or

   *----&gt; Stack Back Trace &lt;----*
   FramePtr ReturnAd Param#1  Param#2  Param#3  Function Name
   0113f9c8 02033240 00000000 00000000 00f142dc
   STORE!CbStrlenWithoutNullW+0x6
   0113fa78 0203528e 00f00b04 00b9a2f8 0113fad0
   STORE!EcEntryIdFromORName+0xa0c
   0113fad8 02035cb1 00b9a2a4 00f142dc 00000000
   STORE!EcSetOriginatorProps+0x7a
   0113fc88 0204c832 00b988cc 00b94768 00f0a2ec
   STORE!EcDeliverMessage+0x813
   0113ff90 0204ef4c 00f08b54 00030001 00dbfbe4 STORE!FStartReceive+0x6a1
   0113ffb8 77f04f32 00000000 00dbfbe4 c0000034 STORE!EcProcessTask+0x129
   0113ffec 00000000 0204ee23 00000000 00000000
   KERNEL32!BaseThreadStart+0x51
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Crash Corrupt Address sp1 IMC<BR>
Keywords          : kbbug4.00 kbbug5.00 kbfix5.00.sp1 XADM kbusage buglist<BR>
Version           : 4.0 5.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
