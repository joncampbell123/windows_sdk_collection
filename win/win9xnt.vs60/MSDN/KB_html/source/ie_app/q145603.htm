

<HTML>
<HEAD>
<TITLE>Integrating Microsoft Windows 95 Service Pack 1 into Netsetup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145603">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1996/02/04">
<META NAME="Keywords" CONTENT="msiew95 servicepack1 win95 winbatch kbnetwork kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; ie_app">
<META NAME="Description" CONTENT="  This article describes how to integrate Microsoft Windows 95 Service Pack 1 components into an installation of Microsoft Windows 95 in which you used an MSBATCH.INF file.  This article assumes you have already used the Netsetup.exe tool to create a...">
<META NAME="Product" CONTENT="ie_app">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAA1,QDI2,QDIZ,QDO3,QAFI,QAXB,QBWQ,QBWS,QDNF,QDO7,QBD2,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Integrating Microsoft Windows 95 Service Pack 1 into Netsetup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145603</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Internet Explorer version 2.0 for Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to integrate Microsoft Windows 95 Service
Pack 1 components into an installation of Microsoft Windows 95 in which you
used an MSBATCH.INF file.
<P>
This article assumes you have already used the Netsetup.exe tool to
create an administrative installation of Windows 95. This administrative
installation folder is referred to in this article as the Netsetup
distribution folder. This article also refers to using the Infinst.exe
tool to integrate Setup .inf files into an Msbatch.inf file. This tool is
located in the Admin\Nettools\Netsetup folder on the Windows 95 CD, or with
Microsoft Windows 95 Service Pack 1 in the Admin\Tools\Infinst folder.
Refer to the Infinst.txt file for Infinst.exe usage instructions.
<P>
For information about obtaining Microsoft Windows 95 Service Pack 1,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q142794.htm">Q142794</A></B>
   TITLE     : Availability of Microsoft Windows 95 Service Pack 1

</PRE>MORE INFORMATION
 
<P>
To integrate Microsoft Windows 95 Service Pack 1 into a Windows 95
Netsetup installation, follow these steps:
<P>
<P><h3>Installing the File Updates</h3>
 
<P>
To install the Windows 95 updated files, follow these steps:

<OL><P><LI>Start Microsoft Windows Explorer and double-click the INF Installation
   Tool (Infinst.exe) to run it.

<P><LI>Click Set Path and type the path for the Netsetup distribution folder.

<P><LI>Click Install Inf and change to the Admin\Componts\Updates\Netsetup
   folder on the Service Pack CD.

<P><LI>Click the Updates1.inf file and then click OK. This copies and modifies
   the necessary files to integrate the Service Pack with an automated
   installation.
<P>
</OL>Running Infinst.exe updates the following files in the Netsetup
distribution folder.
<P>
<PRE>   File name       Folder
   ----------------------------------------

   Comdlg32.dll    System
   Exchng32.exe    Progra~1\Micros~1
   Lpt.vxd         System
   Mapi.dll        System
   Mapi32.dll      System
   Mapisvc.inf     System
   Msfs32.dll      System
   Mspwl32.dll     System
   Net.exe         Root of Netsetup
   Nwserver.vxd    System
   Ole32.dll       System
   Qfecheck.exe    Root of Netsetup
   Qfecheck.hlp    Help
   Sage.dll        System
   Updates1.inf    Root of Netsetup and INF
   Shell32.dll     System
   Vredir.vxd      System
   Vserver.vxd     System
   Wgpoadmn.dll    System
   Wmsui32.dll     System

</PRE></OL>Running Infinst.exe also adds the following entries to the Custom.inf file,
which is located in the root of the Netsetup distribution folder:
<P>
<PRE>   [Version]
   LayoutFile=layout.inf
   Signature="$CHICAGO$"

   [Custom_Precopy]
   CopyFiles=PrecopyFiles

   [DestinationDirs]
   PrecopyFiles=2

   [PrecopyFiles]
   UPDATES1.INF

   [load_inf]
   UPDATES1.INF

</PRE>The Custom.inf file is used during the Windows 95 Setup process to load the
Updates1.inf file, which makes modifications to the registry and controls
copying the updated files to the workstation running Windows 95.
<P>
NOTE: If you are running shared installations of Windows 95 in which the
source files are run on the server, all users must log off of Windows 95
before installing the updates. If users are not logged off the server,
files that are in use are not updated.
<P>
<P><h3>Installing Word Viewer, Infrared Drivers, Internet Explorer 2.0</h3>
 
<P>
Word Viewer, infrared drivers, and Internet Explorer 2.0 can all be
installed by placing Runonce entries in the Msbatch.inf file. This runs the
Setup program for the update after you first restart the Windows 95 Setup
process. The syntax for Runonce entries is the following:
<P>
<PRE>   [Install]
   Addreg=&lt;Section.Name&gt;

   [&lt;Section.Name&gt;]
   HKLM,Software\Microsoft\Windows\CurrentVersion\RunOnce\Setup,
   "&lt;Description&gt;",,"&lt;Executable&gt;"

</PRE>&lt;Section.Name&gt; should be replaced with an arbitrary name describing the
component you are installing.
<P>
&lt;Description&gt; should be replaced with a description that will be displayed
when the Runonce entries are run. This can be any name or phrase.
<P>
&lt;Executable&gt; should be replaced with a path to the Setup program for the
component you want to install.
<P>
The following table lists the Service Pack components and their associated
Setup programs.
<P>
<PRE>   Component                  Setup program
   -----------------------------------------------------------------

   Word Viewer                \\&lt;Server&gt;\&lt;Share&gt;\Wordview\Setup.exe
   Infrared Driver            \\&lt;Server&gt;\&lt;Share&gt;\Infrared\Setup.exe
   Internet Explorer Update   \\&lt;Server&gt;\&lt;Share&gt;\Internet\Msie20.exe

</PRE>When you install multiple components in one Msbatch.inf file, place each
component section on the "Addreg=" line and separate them with commas, for
example:
<P>
<PRE>   [Install]
   Addreg=Word.Viewer,Infrared,Internet.Explorer

   [Word.Viewer]
   HKLM,Software\Microsoft\Windows\CurrentVersion\RunOnce\Setup, "Install
   WordViewer",,"\\Server\Admin\Componts\Wordview\Setup.exe"

   [Infrared]
   HKLM,Software\Microsoft\Windows\CurrentVersion\RunOnce\Setup, "Install
   Infrared",,"\\Server\Admin\Componts\Infrared\Setup.exe"

   [Internet.Explorer]
   HKLM,Software\Microsoft\Windows\CurrentVersion\RunOnce\Setup, "Install
   Internet Explorer", ,"\\Server\Admin\Componts\Internet\Msie20.exe"

</PRE><h3>Installing SLIP and Dial-Up Scripting</h3>
 
<P>
To install support for serial line Internet protocol (SLIP) and the Dial-Up
Scripting tools, follow these steps:

<OL><P><LI>Run Infinst.exe to integrate the Rnaplus.inf file into your Msbatch.inf
   file. Infinst.exe modifies the Msbatch.inf, Custom.inf, and Layout.inf
   files and copies the appropriate files to the Netsetup distribution
   folder. The Rnaplus.inf file is located in the Admin\Componts\Dscript\
   Netsetup folder of the Service Pack.

<P><LI>Modify the Layout.inf file.
<P>
   The following entries should be removed from the Layout.inf file:
<P>
<P><PRE>      SCRIPTER.EXE=1,%OEM_PROGRAMF%\%OEM_ACCESSOR%,11
      SLIP.SCP=1,%OEM_PROGRAMF%\%OEM_ACCESSOR%,11
      CIS.SCP=1,%OEM_PROGRAMF%\%OEM_ACCESSOR%,11
      PPPMENU.SCP=1,%OEM_PROGRAMF%\%OEM_ACCESSOR%,11
      SLIPMENU.SCP=1,%OEM_PROGRAMF%\%OEM_ACCESSOR%,11
      SCRIPT.DOC=1,%OEM_PROGRAMF%\%OEM_ACCESSOR%,11
</PRE><P>
   The following entries should be added to the Layout.inf file:
<P>
<P><PRE>      SCRIPTER.EXE=1,PROGRA~1\ACCESS~1,11
      SLIP.SCP=1,PROGRA~1\ACCESS~1,11
      CIS.SCP=1,PROGRA~1\ACCESS~1,11
      PPPMENU.SCP=1,PROGRA~1\ACCESS~1,11
      SLIPMENU.SCP=1,PROGRA~1\ACCESS~1,11
      SCRIPT.DOC=1,PROGRA~1\ACCESS~1,11
</PRE><P>
</OL>NOTE: Make sure that all three Layout.inf files are modified. The
Layout.inf file exists in the root of the Netsetup distribution folder,
the Suwin folder, and the Inf folder.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information about .inf file syntax, Netsetup.exe, and
Msbatch.inf usage, refer to Appendixes C and D of the Microsoft Windows 95
Resource Kit.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 push script<BR>
Keywords          : msiew95 servicepack1 win95 winbatch kbnetwork kbsetup<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
