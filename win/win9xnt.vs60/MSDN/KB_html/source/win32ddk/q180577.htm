

<HTML>
<HEAD>
<TITLE>PRB: Windows NT Kernel WinDbg Message "Unable to modify memory" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180577">
<META NAME="KBModify" CONTENT="1998/02/11">
<META NAME="KBCreate" CONTENT="1998/02/05">
<META NAME="Keywords" CONTENT="NTDDKDebug NTDDKKMode kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  When you are using WinDbg to debug a kernel-mode device driver and trying to use the Enter Values (ED, EW, EB, and so on) command to modify memory using a symbolic name, the following error message may appear:     Unable to modify memory  This happ...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYL,QAKD,QAB9,QBWP,QAVX,QBXS,QBW6,QBFY,QA40,QABA,QAEV,QABH,QBV8,QBAO,QANE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Windows NT Kernel WinDbg Message "Unable to modify memory"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180577</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Device Driver Kit (DDK) for Windows NT, versions 3.51,
   4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are using WinDbg to debug a kernel-mode device driver and trying
to use the Enter Values (ED, EW, EB, and so on) command to modify memory
using a symbolic name, the following error message may appear:
<P>
<PRE>   Unable to modify memory

</PRE>This happens when the expression evaluator is set to the wrong type.
<P>
You can modify memory in several different ways. For example, to set the
SCSI debug print level to 3, you can type:
<P>
<PRE>   ed scsiport!scsidebug 3

</PRE>or its equivalent:
<P>
<PRE>  ?scsiport!scsidebug=3

</PRE>These commands change the global variable in Scsiport.sys. If the message
"Unable to modify memory" appears, the expression evaluator settings may be
incorrect.
<P>
<P><h2>CAUSE</h2>
 
<P>
The default Visual C or C++ expression evaluator evaluates expressions as C
expressions. MASM expressions always set the value of a symbol to its
address. When the value is set incorrectly, the "Unable to modify memory"
message may appear.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To configure WinDbg to use MASM expressions, enter the following in the
WinDbg command window:
<P>
<PRE>   .opt masmeval on

</PRE>To check the current setting of the expression evaluator, use:
<P>
<PRE>   .opt masmeval

</PRE>This command displays either "MasmEval off" or "MasmEval on", which
indicates the state of MASM evaluation.
<P>
Save the WinDbg common workspace so that you can maintain this evaluation
setting the next time you use WinDbg.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For the following discussion, type in the text after the KDx86 prompt in
the WinDbg command window. The line immediately following the user input
(if any) is the result of the command.
<P>
<P><h3>Debug Session 1</h3>
 
<P>
This WinDbg session demonstrates how you can modify the value of the
Scsiport debug variable. In this session, the expression evaluator is set
to Visual C or C++, so the attempt to modify memory using the symbolic name
fails until the expression evaluator is changed.

<OL><P><LI>Try to change the value of the Scsiport debug variable as follows:
<P>
<P><PRE>      KDx86&gt; ed scsiport!scsidebug 3
      Unable to modify memory
</PRE>
<P><LI>The Enter Memory command fails, so enable the MASM expression evaluator
   as follows:
<P>
<P><PRE>      KDx86&gt; .opt masmeval on
</PRE>
<P><LI>Again, try to change the value of the Scsiport debug variable as
   follows:
<P>
<P><PRE>      KDx86&gt; ed scsiport!scsidebug 3
</PRE>
<P><LI>The message did not appear, so the memory was changed. Confirm this by
   displaying the value of the variable, which should appear as follows:
<P>
<P><PRE>      KDx86&gt; dd scsiport!scsidebug l1
<PRE></PRE>      0x80260C84  00000003                            ....

</PRE></OL><h3>Debug Session 2</h3>
 
<P>
This debug session demonstrates how the expression evaluator setting might
display a peculiar value when you use symbolic names.

<OL><P><LI>Turn on MASM expression evaluation as follows:
<P>
<P><PRE>      KDx86&gt;  .opt masmeval on
</PRE>
<P><LI>Change the value of the Scsiport debug variable to 0x3 as follows:
<P>
<P><PRE>      KDx86&gt; ed scsiport!scsidebug 3
</PRE>
<P><LI>Display the current value of the Scsiport debug variable. Note that the
   expression "scsiport!scsidebug" is evaluated to address 0x80260C84 as
   follows:
<P>
<P><PRE>      KDx86&gt; dd scsiport!scsidebug l1
<PRE></PRE>      0x80260C84  00000003                            ....

</PRE><P><LI>Change the expression evaluator from MASM to default Visual C or C++ as
   follows:
<P>
<P><PRE>      KDx86&gt;  .opt masmeval off
</PRE>
<P><LI>Try to display the Scsiport variable. Note that now the expression
   "scsiport!scsidebug" is evaluated to 0x00000003. This is actually the
   value stored in location 0x80260C84 (scsiport!scsidebug). When you
   display the memory at address 0x00000003 it shows up as question marks
   because it is an invalid address.
<P>
<P><PRE>      KDx86&gt; dd scsiport!scsidebug l1
<PRE></PRE>      0x00000003  ????????                            ????

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Windows NT DDK: WinDbg
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: debugprint SCSI debug<BR>
Keywords          : NTDDKDebug NTDDKKMode kberrmsg<BR>
Version           : WINNT:3.51,4.0<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>
Solution Type     : kbnofix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
