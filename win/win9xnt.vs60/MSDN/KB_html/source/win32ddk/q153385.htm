

<HTML>
<HEAD>
<TITLE>HOWTO: Disable Plug and Play for a Serial Hardware Device </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153385">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1996/07/08">
<META NAME="Keywords" CONTENT="DdkComm kbcode kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  Certain existing hardware serial devices that have been in use in Windows 3.x and MS-DOS may not behave as desired when the Plug and Play enumeration activates the control lines.  This article provides a sample INF file that installs when the user ...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QDJ9,QAPF,QAA1,QDI2,QDJP,QAKG,QDL9,QBWO,QBWN,QAY4,QAJG,QBXS,QA9N,QA4P V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Disable Plug and Play for a Serial Hardware Device</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153385</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Device Development Kit (DDK) for Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Certain existing hardware serial devices that have been in use in Windows
3.x and MS-DOS may not behave as desired when the Plug and Play enumeration
activates the control lines.
<P>
This article provides a sample INF file that installs when the user
activates the Hardware Wizard on "other device," selects "have disk," and
picks the COM port from the list. It disables the Plug and Play by removing
the enumerating reference from the registry. As an added bonus, this INF
can also create a subdirectory and copy in software as shown. This can be
expanded to multiple files and disks. Note that during power up, this
glitching of the serial control lines can still occur and a redesign of the
hardware may still be necessary in the long run.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<PRE>   ;------------------- START INF SAMPLE ------------------------------
   ;Sample INF for a device that needs to disable Plug and Play enumeration
   ;on a com port &amp; copy an application for the device into new
   ;subdirectory. "SAMPLES, INC." is meant to be a fictitious company name.
   ;The "application" is just a text file SAMPAPPL.TXT to show the copying.
   ;Always save your registry files SYSTEM.DAT and USER.DAT before testing
   ;any INF file.

   [Version]
   Signature=$Chicago$
   Class=OldComDev
   Provider=%StrPro1%

   [DestinationDirs]
   Hrdwr1234.CopyFiles=30,SAMPAPPL

   [Manufacturer]  ;will not show up since there is only one here
   %strman1%=SAMPLE

   [SAMPLE]        ;list of ports for device to be manually selected by
                   ;user
   %StrConfig1%=Hrdwr1.inst,Hrdwr1
   %StrConfig2%=Hrdwr2.inst,Hrdwr2
   %StrConfig3%=Hrdwr3.inst,Hrdwr3
   %StrConfig4%=Hrdwr4.inst,Hrdwr4

   [Hrdwr1.inst]   ;INSTALL section COM1
   DelReg=Hrdwr1.DelReg
   CopyFiles=Hrdwr1234.CopyFiles

   [Hrdwr1.DelReg]
   HKLM,"System\CurrentControlSet\Services\Class\Ports\0000",Enumerator

   [Hrdwr2.inst]   ;INSTALL section COM2
   DelReg=Hrdwr2.DelReg
   CopyFiles=Hrdwr1234.CopyFiles

   [Hrdwr2.DelReg]
   HKLM,"System\CurrentControlSet\Services\Class\Ports\0001",Enumerator

   [Hrdwr3.inst]   ;INSTALL section COM3
   DelReg=Hrdwr3.DelReg
   CopyFiles=Hrdwr1234.CopyFiles

   [Hrdwr3.DelReg]
   HKLM,"System\CurrentControlSet\Services\Class\Ports\0002",Enumerator

   [Hrdwr4.inst]   ;INSTALL section COM4
   DelReg=Hrdwr4.DelReg
   CopyFiles=Hrdwr1234.CopyFiles

   [Hrdwr4.DelReg]
   HKLM,"System\CurrentControlSet\Services\Class\Ports\0003",Enumerator

   [Hrdwr1234.CopyFiles]
   sampappl.txt

   [SourceDisksFiles] ;list disks for files
   sampappl.txt=1

   [SourceDisksNames] ;define disks - only one setup disk
   1="Disk Number ONE",,

   [Strings]
   StrPro1="Samples, Inc."
   StrMan1="Samples, Inc."
   StrConfig1="device plugged into COM1"
   StrConfig2="device plugged into COM2"
   StrConfig3="device plugged into COM3"
   StrConfig4="device plugged into COM4"
   ;------------------- END INF SAMPLE ------------------------------
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : DdkComm kbcode kbprg kbcode<BR>
Version             : 4.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
