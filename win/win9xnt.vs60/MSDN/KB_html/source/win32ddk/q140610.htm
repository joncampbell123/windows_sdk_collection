

<HTML>
<HEAD>
<TITLE>BUG: SCSI Miniport Parms Not Parsed on Multi PCI Bus Systems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140610">
<META NAME="KBModify" CONTENT="1996/01/24">
<META NAME="KBCreate" CONTENT="1995/12/04">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  On systems with more than one PCI bus, the SCSI miniport might not receive the adapter-specific parameters specified in the registry for the adapters on the non-primary PCI bus. This affects the SCSIPORT parameters like DisableTaggedQueuing, Disabl...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJV,QAHE,QAJQ,QBXS,QBVV,QBBI,QAU9,QBWP,QAH7,QAH6,QAD7,QA4P,QATX,QASR,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SCSI Miniport Parms Not Parsed on Multi PCI Bus Systems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 24, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140610</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Device Driver Kit (DDK) version 3.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
On systems with more than one PCI bus, the SCSI miniport might not receive
the adapter-specific parameters specified in the registry for the adapters
on the non-primary PCI bus. This affects the SCSIPORT parameters like
DisableTaggedQueuing, DisableSynchronousTransfers, and DisableDisconnects
as well as others.
<P>
For information on setting parameters for SCSI miniport drivers, please see
the Windows NT DDK documentation.
<P>
<P><h2>STATUS</h2>
 
<P>
This is a limitation on the Scsiport.sys driver when used on a system with
multiple PCI busses and there are no plans to modify the driver. As a work-
around, set the registry as follows:
<P>
For the first PCI adapter, use Device0. If the second PCI adapter is on the
same PCI bus as the first adapter, use Device1. If the second PCI adapter
is on the next PCI bus scanned, use Device2 for the second adapter.
Everytime a new PCI bus is scanned, increment the DeviceX string by two
rather than one.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
SCSIPORT does not correctly handle the SCSI miniport parameters if a system
has more than one PCI bus and there is an adapter on the primary PCI bus
and an adapter on the non-primary PCI bus.
<P>
For example, if you want to disable tagged command queuing on the second
SCSI adapter (Device1). A key similar to the following would be
added to the registry with the value: DisableTaggedQueuing : REG_DWORD :
0x1:
<P>
HKEY_LOCAL_MACHINE
<PRE>  SYSTEM
    CurrentControlSet
      Services
        aic78xx
          Parameters
            Device1

</PRE>The problem is that SCSIPORT never correctly uses the registry parameter
string, so tagged queuing isn't disabled for the second adapter. Note that
if all the SCSI adapters are on the primary PCI bus, the registry
parameters are parsed correctly.  Also, the generic key "Device" can still
be used to pass parameters to all the adapters supported by the specified
miniport.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: ntddkstorage<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 24, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
