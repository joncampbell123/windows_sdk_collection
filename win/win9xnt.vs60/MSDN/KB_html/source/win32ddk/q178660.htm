

<HTML>
<HEAD>
<TITLE>SAMPLE: Dumppci.exe Shows How To Dynamically Load/Unload Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178660">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1997/12/30">
<META NAME="Keywords" CONTENT="NTDDKKMode">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  Dumppci.exe is a sample Win32 application and kernel-mode drive that demonstrates how to dynamically load or unload a driver, scan all the PCI devices in the system, and display the PCI configuration space for each device.  MORE INFORMATION  The fo...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAU9,QDJV,QAB5,QAY2,QAPF,QAJH,QANE,QAJ4,QDIZ,QBXN,QBWP,QAH3,QAYY,QBV8,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Dumppci.exe Shows How To Dynamically Load/Unload Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178660</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
- Microsoft Win32 Device Development Kit (DDK) for Windows NT, versions
<PRE>  3.51, 4.00
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Dumppci.exe is a sample Win32 application and kernel-mode drive that
demonstrates how to dynamically load or unload a driver, scan all the PCI
devices in the system, and display the PCI configuration space for each
device.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/dumppci.exe">Dumppci.exe</A> <I>(size: 33567 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h3>Dumppci.exe and Pcidumpr.sys</h3>
 
<P>
This is a sample driver that demonstrates the following:

<OL><P><LI>How to dynamically load or unload a driver using the Service Control
   Manager APIs. These APIs allow you to load a driver without having
   to modify the registry and reboot the system.

<P><LI>How to scan the PCI slots and locate PCI devices.

<P><LI>How to send data from a kernel-mode driver to a Win32 console mode
   application.
<P>
</OL>To run the sample:

<OL><P><LI>Build the driver and the Win32 application. See the DDK documentation
   for details on creating drivers and Win32 applications from the DDK
   Build Environment.

<P><LI>Insure that the driver (Pcidumpr.sys) and the Win32 application
   (Dumppci.exe) are in the same directory.

<P><LI>From a command prompt, type "dumppci" to see the options supported.
   Currently, you can display the PCI configuration data in either a
   formatted ("-f" option) or raw ("-r" option) manner.
<P>
</OL>When the program runs, the driver is automatically loaded and started. The
Win32 application sends custom IOCTLs to the driver. The driver then scans
all the PCI slots in the system and locates PCI devices. For each PCI
device, the driver retrieves the PCI configuration space information and
places it in the Win32 application's buffer.
<P>
Note that this sample will not work across a network. The driver and Win32
application must reside on the local computer.
 
<PRE>Keywords          : NTDDKKMode
Issue type        : kbfile
Solution Type     : kbsample</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
