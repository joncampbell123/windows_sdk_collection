

<HTML>
<HEAD>
<TITLE>VCOMM Port Drivers EscapeCommFunction and DeviceIOControl </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153384">
<META NAME="KBModify" CONTENT="1996/07/10">
<META NAME="KBCreate" CONTENT="1996/07/08">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  EscapeCommFunction and DeviceIOControl calls to VCOMM are reflected to the port drivers registered with VCOMM. They have default behavior as well as being available to developers as general purpose I/O and control in custom port drivers.  MORE INFO...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJP,QAKG,QAY5,QAUD,QAGI,QABA,QAU9,QAJX,QAH6,QAEF,QADR,QAB5,QDL9,QBXS,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>VCOMM Port Drivers EscapeCommFunction and DeviceIOControl</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 10, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153384</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Device Development Kit (DDK) for Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
EscapeCommFunction and DeviceIOControl calls to VCOMM are reflected to the
port drivers registered with VCOMM. They have default behavior as well as
being available to developers as general purpose I/O and control in custom
port drivers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Calls to port drivers are made by means of the port handle returned when
the port was opened through VCOMM. VCOMM knows to take the port handle and
use it to call the appropriate port function. From VCOMM.INC, they are
listed as pPortEscapeFunction and pPortDeviceIOCtl. Parameter passing is
similar and in fact, in LPT.VXD, the default parallel port driver, they
both end up in the same extended function call. In the default SERIAL.VXD,
the EscapeFunction provides the functions given below, but DeviceIOControl
is NOT implemented. The table entry in the SERIAL sample code simply
appears without comment as "  dd 0 " instead of an address.
<P>
SERIAL.VXD default functions for Escape Function: (from sample comments)
<PRE>0:   Dummy   - Ignored
</PRE>1:   SETXOFF - Exactly as if X-OFF character has been received.
2:   SETXON  - Exactly as if X-ON character has been received.
3:   SETRTS  - Set the RTS signal
4:   CLRRTS  - Clear the RTS signal
5:   SETDTR  - Set the DTR signal
6:   CLRDTR  - Clear the DTR signal
7:   RESETDEV- Yank on reset line if available (LPT devices)
8:   GETLPTMAX - ignored
9:   GETCOMMAX - ignored
10:  GETCOMBASEIRQ - return base and IRQ of COMM port
11:  GETCOMBASEIRQ1 - -do-
12:  SETBREAK - set break condition
13:  CLEARBREAK - clear break condition
<P>
LPT.VXD default functions for Escape Function and DeviceIOControl:
<P>
18:  SETECPADDRESS sends ECP address, as passed in the first byte of
InBuffer 0x00..0x7F. Use GetLastError() to retrieve error code if function
return is false. IE_INVALIDPARAM means address greater than 0x7F not
allowed. IE_HARDWARE means not ECP port or not available in reverse
transfer. Note that this does not imply that VCOMM will support more than
one device on a port.
<P>
17:  GETDEVICEID queries and returns Plug-and-Play string from an LPT port
device. OutBuffer's first four bytes contain the size of the string while
InBuffer will contain the returned string. This is nibble mode only. The
Extensibility Byte is sent as 0x04 to start the process.
<P>
7:   RESETDEV sends a 300ms+ reset pulse, nInit w/nSelectIn asserted.
<P>
<P>
<P><h2>REFERENCES</h2>
 
<P>
Windows 95 DDK, SERIAL.VXD sample, VCOMM.INC/VCOMM.H contains definitions
MSDN Library CD-ROM.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words:<BR>
KBCategory: kbprg<BR>
KBSubcategory: DdkComm
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 10, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
