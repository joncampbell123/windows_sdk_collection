

<HTML>
<HEAD>
<TITLE>DOC: LibraryProcedure DLL Prototype Incorrect </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136681">
<META NAME="KBModify" CONTENT="1997/04/07">
<META NAME="KBCreate" CONTENT="1995/09/12">
<META NAME="Keywords" CONTENT="kbprg NDIS WAN kbdocerr kbdocfix">
<META NAME="KBArea" CONTENT="Support; KB; win32ddk">
<META NAME="Description" CONTENT="  Setup provides LoadLibrary, FreeLibrary, and LibraryProcedure commands to provide a mechanism to add custom procedures to setup scripts.  The LibraryProcedure command provides a way to call an exported function in the specified DLL. This procedure ...">
<META NAME="Product" CONTENT="Win32 DDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAA1,QDI2,QAAP,QAB9,QDNQ,QAPF,QDIZ,QBV8,QAY5,QAR4,QAH6,QAGI,QDMW,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOC: LibraryProcedure DLL Prototype Incorrect</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136681</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.51
WINDOWS NT
kbprg kbdocerr kbdocfix
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Device Driver Kit (DDK), version 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Setup provides LoadLibrary, FreeLibrary, and LibraryProcedure commands to
provide a mechanism to add custom procedures to setup scripts.
<P>
The LibraryProcedure command provides a way to call an exported function in
the specified DLL. This procedure is described in the Windows NT DDK
documentation. Drill down to it by following this outline:
<P>
<PRE>Programmers Guide   (2.3.5.1)
    Setup (part 1)
       Chapter 2 - Driver Installation
          GUI INF Script Language
             Using DLLs and External Programs
                DLLs in Install and Shell Sections

</PRE>The documentation states the DLL function called by LibraryProcedure must
have the following prototype:
<P>
BOOL FunctionName(cArgs, lpszArgs[], *lpszTextOut)
<PRE>            DWORD cArgs;
            LPSTR lpszArgs[];
            LPSTR *lpszTextOut);

</PRE>The correct prototype for this function is:
<P>
BOOL PASCAL FunctionName(cArgs, lpszArgs[], *lpszTextOut)
<PRE>            DWORD cArgs;
            LPSTR lpszArgs[];
            LPSTR *lpszTextOut);

</PRE>This documentation error has been corrected in the Windows NT DDK version
4.0 documentation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbdocerr kbdocfix<BR>
KBSubcategory:  NDIS WAN<BR>
Additional reference words: 3.51 4.00 SETUP LibraryProcedure Miniports<BR>
Keywords            : kbprg NDIS WAN kbdocerr kbdocfix<BR>
Version             : 3.51<BR>
Platform            : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
