

<HTML>
<HEAD>
<TITLE>How Dependent Is Commerce on Physical Location of Store Files? </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154532">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1996/08/08">
<META NAME="Keywords" CONTENT="CommAdmin CommSetup kbinterop kbprg kbusage buglist1.0x kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; commerce">
<META NAME="Description" CONTENT="  Q. How dependent is Commerce Server on the physical location of the store    files? Can I import them to a Web site project using Visual Interdev?  A. Only the Commerce Server Host Administrator and the Store Administration    objects depend on the...">
<META NAME="Product" CONTENT="commerce">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANG,QA7H,QAGI,QBFY,QDH9,QAH5,QBXB,QBWS,QATJ,QAR4,QAH4,QAGB,QAFI,QDNQ,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Dependent Is Commerce on Physical Location of Store Files?</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154532</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Commerce Server, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Q. How dependent is Commerce Server on the physical location of the store
<PRE>   files? Can I import them to a Web site project using Visual Interdev?

</PRE>A. Only the Commerce Server Host Administrator and the Store Administration
<PRE>   objects depend on the store being in the Commerce Server directory
   structure. You can move the files to another directory to use with
   Visual Interdev. After you have done this, you need to correct the
   Internet Information Server (IIS) virtual roots related to the store
   (that is, the store, store_mgr, and store_assets virtual roots) to point
   to the new directory. You also need to edit the store's Shop\Global.asa
   and Manager\Default.asp to correct the path of the Pipeline.pcf file.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
If you move the files to another directory, the store will no longer be
listed in the Commerce Server Host Administrator, and the store's
management page will no longer be able to list the status (open or closed)
of a store or change that status. You can fix the latter by changing the
VBScript code used for this and replace it with your own code that
determines which Global.asa file is in use (the store open Global.asa or
the store closed Global.asa), and switch between the two Global.asa files.
<P>
You must create some sort of a file object and query for Global_opened.asa
or Global_closed.asa files in your store's shop directory. If
Global_closed.asa is found, the store is open, and vice-versa. When the
administrator clicks the Close Store button, you need to rename the
Global.asa file to Global_opened.asa and Global_closed.asa to Global.asa.
Conversely, when the administrator clicks the Open Store button, you must
rename the Global.asa to Global_closed.asa and Global_opened.asa to
Global.asa. Below is a code example that switches the Global_*.asa files
depending on the current store status. You may need to modify the example
to suit your directory structure.
<P>
<P><h3>In Default.ASP Under &lt;yourstore&gt;\Manager</h3>
 
<P>
Dim boolRet
set TempFileObj = Server.CreateObject("Commerce.AdminFiles")
boolRet =
TempFileObj.Exists("C:\inetpub\wwwroot\MSCSTestVI\global_closed.asa")
<PRE>   if boolRet = TRUE then
      status = "Open"
      RevStatus = "Close"
   else
      status = "Closed"
      RevStatus = "Open"
   End if


</PRE>&lt;%
<PRE>         REM -- open/close button
         if status &lt;&gt; "Invalid" then
         %&gt;
            &lt;FORM METHOD="POST" ACTION="&lt;% =
</PRE>mscsPage.SURL("xt_change_status.asp") %&gt;"&gt;
<PRE>               &lt;INPUT TYPE="hidden"
                  NAME="Store"
                  VALUE="&lt;% =Application("StoreName")%&gt;&lt;rem %=
</PRE>CurrStore.Name %&gt;"&gt;
<PRE>               &lt;INPUT TYPE=hidden name=status value="&lt;%= status%&gt;"&gt;
               &lt;INPUT TYPE="SUBMIT"
                  NAME="RevStatus"
                  VALUE="&lt;%= RevStatus %&gt; Store"&gt;
            &lt;/FORM&gt;
         &lt;% else %&gt;
            *****
         &lt;% end if %&gt;

</PRE><h3>In Xt_Change_Status.ASP Under &lt;yourstore&gt;\Manager</h3>
 
<P>
set objAdmin = Server.CreateObject("Commerce.AdminFiles")
<PRE>      If Request.Form("Status")= "Open" then
         call objAdmin.Rename("C:\inetpub\wwwroot\MSCSTestVI\global.asa",
</PRE>"C:\inetpub\wwwroot\MSCSTestVI\global_opened.asa")
<PRE>         call
</PRE>objAdmin.Rename("C:\inetpub\wwwroot\MSCSTestVI\global_closed.asa",
"C:\inetpub\wwwroot\MSCSTestVI\global.asa")
<PRE>         call objAdmin.Touch("C:\inetpub\wwwroot\MSCSTestVI\global.asa")
      Else
         call objAdmin.Rename("C:\inetpub\wwwroot\MSCSTestVI\global.asa",
</PRE>"C:\inetpub\wwwroot\MSCSTestVI\global_closed.asa")
<PRE>         call
</PRE>objAdmin.Rename("C:\inetpub\wwwroot\MSCSTestVI\global_opened.asa",
"C:\inetpub\wwwroot\MSCSTestVI\global.asa")
<PRE>         call objAdmin.Touch("C:\inetpub\wwwroot\MSCSTestVI\global.asa")
       End IF

</PRE>A tighter integration between Commerce Server and Visual Interdev will be
considered for a future release.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: kbfaq VI VID<BR>
Keywords            : CommAdmin CommSetup kbinterop kbprg kbusage buglist1.0x kbfaq<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbinfo<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
