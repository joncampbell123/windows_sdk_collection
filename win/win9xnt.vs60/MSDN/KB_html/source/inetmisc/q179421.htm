

<HTML>
<HEAD>
<TITLE>FIX: WebBrowser Control in CFormView Does Not Repaint Properly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179421">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1998/01/16">
<META NAME="Keywords" CONTENT="AXSDKWebBrowser">
<META NAME="KBArea" CONTENT="Support; KB; inetmisc">
<META NAME="Description" CONTENT="  When you resize the WebBrowser control inside a CFormView, it may not repaint correctly.  You may experience the scroll bars not being redrawn.  CAUSE =====  The WebBrowser control does not handle WM_PAINT messages correctly when it is being resize...">
<META NAME="Product" CONTENT="ActiveX Internet Controls">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRJ,QAB5,QA7O,QAOE,QAMN,QBV9,QBVV,QAR4,QAHV,QARL,QAGI,QDIX,QBCF,QA63,QA4Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: WebBrowser Control in CFormView Does Not Repaint Properly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179421</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), versions 3.0, 3.01, 3.02
<LI>Microsoft ActiveX SDK, version 1.0
<LI>The Microsoft Foundation Classes (MFC) included with:
<P><PRE>    - Microsoft Visual C++, 32-bit Editions, versions 4.2, 4.2b, 5.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you resize the WebBrowser control inside a CFormView, it may not
repaint correctly.
<P>
You may experience the scroll bars not being redrawn.
<P>
<P><h2>CAUSE</h2>
 
<P>
The WebBrowser control does not handle WM_PAINT messages correctly when it
is being resized.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
When the WebBrowser control is resized, update the client area of the
WebBrowser control by calling UpdateWindow().
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Microsoft
Internet Explorer 4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following code shows how the WebBrowser control would normally be
resized when the client window is resized. The call to UpdateWindow()
causes a WM_PAINT message to be sent directly to the window of the control.
<P>
<PRE>   // CMyFormView is derived from CFormView.
   // m_browser is a CWnd-derived class that wraps the webbrowser control.
   void CMyFormView::OnSize(UINT nType, int cx, int cy)
   {
      CFormView::OnSize(nType, cx, cy);
      // Ensure m_browser has valid HWND before doing anything
      if ( m_browser.GetSafeHwnd() )
      {
         // Resize WebBrowser control to fill the client area
         m_browser.MoveWindow(0, 0, cx, cy);
         // Force processing of WM_PAINT
         m_browser.UpdateWindow();
      }
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: web browser shdocvw.dll<BR>
Keywords          : AXSDKWebBrowser<BR>
Technology        : kbInetDev ole<BR>
Version           : WINDOWS:1.0,3.0,3.01,3.02; WINNT:4.2,4.2b,5.0<BR>
Platform          : WINDOWS winnt<BR>
Issue type        : kbbug<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
