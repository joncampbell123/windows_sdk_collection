

<HTML>
<HEAD>
<TITLE>How to Rebuild the Default Windows REG.DAT File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q80393 ">
<META NAME="KBModify" CONTENT="1997/12/11">
<META NAME="KBCreate" CONTENT="1992/01/28">
<META NAME="Keywords" CONTENT="wfw wfwg win31 kberrmsg kbole kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  During installation of Microsoft Windows, the REG.DAT file is not copied from the original distribution disks. Instead, REG.DAT is built using the Windows Registration Information Editor (REGEDIT.EXE) and the SETUP.REG file (located in the Windows ...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QBJZ,QBWS,QAA1,QAJH,QAGU,QA0A,QDI2,QBXS,QAY2,QAH5,QAIH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Rebuild the Default Windows REG.DAT File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q80393 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.11
WINDOWS
kbsetup kbole kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
During installation of Microsoft Windows, the REG.DAT file is not copied
from the original distribution disks. Instead, REG.DAT is built using the
Windows Registration Information Editor (REGEDIT.EXE) and the SETUP.REG
file (located in the Windows SYSTEM subdirectory) during Setup.
<P>
If the REG.DAT file is corrupted, one of the following error messages may
be displayed:
<P>
<PRE>   File Manager cannot open or print the specified file.
   Start the application used to create this file, and open
   or print it from there.

   -or-

   There is no application associated with this file. Choose Associate from
   the File menu to create an association.

   -or-

   There is a problem with REG.DAT. Delete REG.DAT and restart Windows.

   -or-

   Setup had a problem with REG.DAT, SHELL.DLL or disk space.

   -or-

   Windows registration database program is not valid

   -or-

   OLE server initialization failed

   -or-

   Windows registration database is not valid

</PRE>If, for whatever reason, the REG.DAT file is corrupted or deleted, you can
rebuild the file using the information below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The REG.DAT file contains information about file associations and OLE
objects. The Windows 3.1 Setup program calls the Registration Information
Editor to add default associations (for Paintbrush, Notepad, and so on) and
objects (Packager, Paintbrush, and Sound Recorder).
<P>
<P><h3>Rebuilding the REG.DAT File for Applications Included with Windows</h3>
 
<P>
You can manually create a new REG.DAT file or restore the defaults by
following the steps below.
<P>
<P><h3>NOTES</h3>
 

<UL><LI>Be sure to rename your existing REG.DAT file before you try to
   rebuild it.

<LI>These steps assume your Windows directory is on drive C and is named
   WINDOWS.

</UL><OL><P><LI>Run Program Manager or File Manager.

<P><LI>From the File menu, choose Run.

<P><LI>In the dialog box, type the following:
<P>
<P><PRE>     regedit /u c:\windows\system\setup.reg
</PRE><P>
   Note: A message appears to confirm that the information has
   been registered. The database now contains the original
   registration information that was installed with Windows.
   To rebuild the REG.DAT file for other applications, see the
   "Rebuilding the REG.DAT File for Other Applications" section
   below.

<P><LI>Choose OK.
<P>
   Note:  You may need to exit and restart Windows in order to
   see the REG.DAT file displayed in File Manager and execute
   the following step.

<P><LI>In File Manager, select the REG.DAT file found in the Windows
   program directory, then choose Associate from the File menu and
   associate Files with Extension: DAT and REG with REGEDIT.EXE.
<P>
   NOTE: When you removed the old REG.DAT file, you also removed your
   file associations list; therefore, you must choose REGEDIT.EXE using
   the Browse button.

<P><LI>Exit and restart Windows.
<P>
</OL>After you have created a new REG.DAT file or restored the defaults, use the
following steps to renew the list of applications in the Associate dialog
box:

<OL><P><LI>In File Manager, choose Run from the File menu.

<P><LI>In the dialog box, type the following line:
<P>
<P><PRE>      regedit /u c:\windows\system\setup.reg
</PRE><P>
</OL><h3>Rebuilding the REG.DAT File for Other Applications</h3>
 
<P>
For applications other than the Windows-based programs included with
Windows 3.1, the technique varies for rebuilding REG.DAT. Some
applications, such as Microsoft Word 2.0 for Windows, rebuild their entries
every time the application is started. Other applications may register
themselves only during their setup processes.
<P>
NOTE: If you are using Word 2.0 for Windows, make sure to include the path
to the Word for Windows program directory and the WW20.REG file located
there (for example, C:\WINWORD\WW20.REG) so that the registration database
is updated.
<P>
If the application includes an .REG file, you can add that information to
the registration database. To do so, either:

<UL><LI>Choose Merge Registration File from the File menu in the Registration
   Information Editor. Then select the .REG file for the application to be
   added to the database and choose OK.
<P>
   -or-

<LI>Use the same steps described above, substituting the name of the .REG
   file. Otherwise, consult the application's documentation or contact your
   vendor for more information about rebuilding the REG.DAT file.
<P>
   -or-

<LI>Run Windows File Manager and double-click the application's .REG file.
<P>
</UL>If you need to rebuild the registration database for all your applications,
use the following steps:

<OL><P><LI>From the File menu in File Manager, choose Search.

<P><LI>Search for *.REG from C:\. Ensure that the Search All Subdirectories
   check box is selected before you choose OK.

<P><LI>Run SETUP.REG by double-clicking the file icon or by highlighting it
   and then pressing ENTER.

<P><LI>Run every other .REG file brought up by the File Manager search (just as
   you did in step 3).
<P>
</OL>For instructions about registering Microsoft Office version 4.x
applications, query on the following words in the Microsoft Knowledge Base:
<P>
<PRE>   ole and regedit and office

</PRE></OL>Additional information about Registration Information Editor is available
in Windows 3.1 Help.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Windows Resource Kit for Operating System Version 3.1," Chapter
11, page 360
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbole kberrmsg<BR>
KBSubcategory: win31 wfw wfwg<BR>
Additional reference words: gpf 3.10 3.11<BR>
Keywords          : wfw wfwg win31 kberrmsg kbole kbsetup<BR>
Version           : 3.10 3.11<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
