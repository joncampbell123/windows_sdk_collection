

<HTML>
<HEAD>
<TITLE>Sharing Violation with Identical OEMSETUP.INF Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83750 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/04/20">
<META NAME="Keywords" CONTENT="kbsetup kbdisplay kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  When installing third-party display drivers in Microsoft Windows version 3.1, you may receive a Sharing Violation error and then a general protection (GP) fault if multiple OEMx.INF files exist in the Windows\SYSTEM subdirectory. This only occurs w...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAA1,QBWQ,QDI2,QAU9,QDIZ,QBKN,QA3A,QAJQ,QAFI,QDK0,QAYS,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Sharing Violation with Identical OEMSETUP.INF Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83750 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When installing third-party display drivers in Microsoft Windows
version 3.1, you may receive a Sharing Violation error and then a
general protection (GP) fault if multiple OEMx.INF files exist in the
Windows\SYSTEM subdirectory. This only occurs when you run Windows
Setup to make changes or additions to your system (that is, when you
run Setup in maintenance mode).
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs if all of the following conditions are true:

<UL><LI>Windows Setup is run in maintenance mode.

<LI>MS-DOS 5.0 or 6.0 SHARE.EXE is loaded.

<LI>Multiple OEMx.INF (OEM0.INF, OEM1.INF, and so on) files exist that
   contain identical description strings and one of these identical
   descriptions is selected.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To eliminate the error, rename all OEMx.INF files located in the
Windows\SYSTEM directory by typing the following, and then install the
requested video driver from the Windows Driver Library (WDL) or
OEM-supplied disks.
<P>
<PRE>   REN OEM*.INF OEM*.OLD

  (For information about the WDL, query on "Windows Driver Library
  Information" [with the quotation marks])

</PRE>This causes Setup to create a new OEMx.INF file in the Windows\SYSTEM
directory. If you have other drivers listed in the renamed OEMx.INF
files that you later need, you must rename them to a valid OEMx.INF
filename to make the drivers available.
<P>
NOTE: Microsoft  recommends that you install third-party video drivers
using the MS-DOS-based maintenance Setup.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When each third-party video driver is installed into Windows 3.1, its
OEMSETUP.INF file is renamed to OEMx.INF and stored in the
Windows\SYSTEM subdirectory so it can to be read by Windows
maintenance mode Setup. These OEMx.INF files are linked to the Windows
SETUP.INF file, so that all available display options are listed in
one place. If two of the OEMx.INF files have the same video driver
description strings, and one is selected, then the Sharing Error and
GP fault occur.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbdisplay kb3rdparty<BR>
KBSubcategory: win31 gpf windrvr<BR>
Additional reference words: 3.10 isv oem<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
