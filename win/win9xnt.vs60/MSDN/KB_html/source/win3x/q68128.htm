

<HTML>
<HEAD>
<TITLE>Troubleshooting the CONFIG.SYS and AUTOEXEC.BAT Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q68128 ">
<META NAME="KBModify" CONTENT="1996/02/26">
<META NAME="KBCreate" CONTENT="1991/01/08">
<META NAME="Keywords" CONTENT="kbfasttip kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  When you run or install Microsoft Windows, you may encounter the following problems: corrupted or incomplete installation of Windows, insufficient memory or file handles, and/or an inability to use standard and enhanced modes of Windows.  CAUSE ===...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QANE,QBWQ,QAEF,QDKI,QDKH,QAFY,QAB9,QAA1,QABI,QA9N,QACF,QDH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting the CONFIG.SYS and AUTOEXEC.BAT Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 26, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q68128 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:
*
<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a, 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you run or install Microsoft Windows, you may encounter the
following problems: corrupted or incomplete installation of Windows,
insufficient memory or file handles, and/or an inability to use
standard and enhanced modes of Windows.
<P>
<P><h2>CAUSE</h2>
 
<P>
Your CONFIG.SYS and AUTOEXEC.BAT files contain device drivers,
terminate-and-stay-resident (TSR) programs, and other files.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To reduce or eliminate these problems, follow the instructions in the
More Information section of this article to modify the CONFIG.SYS and
AUTOEXEC.BAT files.
<P>
Use a text editor such as MS-DOS EDIT, EDLIN programs, or Windows
Notepad to edit your CONFIG.SYS and AUTOEXEC.BAT files.
<P>
NOTE: Make backup copies of the the AUTOEXEC.BAT and CONFIG.SYS files,
before you make your changes.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>CONFIG.SYS File</h3>
 
<P>
Modify the CONFIG.SYS file as follows:

<OL><P><LI>Remove nonessential device drivers such as keyboard buffers,
   scanner drivers, printer drivers, and country drivers. If you are
   unsure of what a device driver does, do NOT remove it.

<P><LI>Remove FASTOPEN statements and disk caches.

<P><LI>Verify that you have at least 60 FILES, and 20 BUFFERS.

<P><LI>If you are using MS-DOS version 3.3 or later, add a STACKS=0,0 line
   to your CONFIG.SYS file. For MS-DOS version 3.2, the line should
   read STACKS=9,192. For more information on STACKS, query on the
   following words in the Microsoft Knowledge Base:
<P>
<P><PRE>      stacks and explanation and config
</PRE>
<P><LI>If you have a SHELL=COMMAND.COM /P /E:256 statement, increase
   the number following the E: (the environment space) to 2048.
   Verify that the /p switch is used. If you do not have a SHELL
   command, you may want to add one, making sure that the path to
   COMMAND.COM in the SHELL statement matches the COMSPEC statement.
   At the command prompt, type
<P>
<P><PRE>      set
</PRE><P>
   This command will give you the path to which the location COMSPEC
   is pointing.
<P>
</OL><h3>AUTOEXEC.BAT File</h3>
 
<P>
Modify the AUTOEXEC.BAT file as follows:

<OL><P><LI>Remove any nonessential programs such as TSR programs, print
   buffers and APPEND, JOIN, SUBST, PRINT, and GRAPHICS statements.
   If you are unsure of what a program does, do NOT remove it.

<P><LI>Remove all duplicate PATH entries so you only have one PATH line
   in your AUTOEXEC.BAT file. Modify your PATH statement so it uses
   the root, MS-DOS, and Windows directories only.

<P><LI>Verify that you have a valid SET TEMP statement to an existing
   directory. For example, SET TEMP=C:\WINDOWS\TEMP.
<P>
</OL><h3>Additional Troubleshooting Steps</h3>
 

<UL><LI>Verify that the File Allocation Table is valid:
<P>
   1. Exit Windows.
<P>
   2. At the command prompt, type the following:
<P>
<PRE>         chkdsk /f

   Caution: You must Exit Windows BEFORE you type the above command.
   CHKDSK will also check the directory structure.

</PRE><LI>Verify that you are using the proper version of DOS for your
   computer. For example, if you are using a COMPAQ computer, you
   should be using a version of COMPAQ DOS.

<LI>Verify that the path, environment space, and TEMP directory are
   valid. At the command prompt, type:
<P>
<P><PRE>      set
</PRE><P>
</UL>Reinstall Windows after you make the above changes to the CONFIG.SYS
and AUTOEXEC.BAT files.
<P>
NOTE: Before you reinstall Windows, switch your computer off, wait a
few seconds, and switch your computer on again and read the new
CONFIG.SYS and AUTOEXEC.BAT files to verify your changes.

<UL><LI>To determine the function of certain drivers when Windows will not
   run, create a MS-DOS boot floppy disk containing the following
   CONFIG.SYS file and AUTOEXEC.BAT files and boot from the floppy
   disk.
<P>
<PRE>        CONFIG.SYS:             AUTOEXEC.BAT:
        FILES=50                PATH=C:\WINDOWS;C:\DOS
        BUFFERS=20              PROMPT $P$G
        DEVICE=C:\HIMEM.SYS     SET TEMP=C:\WINDOWS\TEMP

   If, after booting, you can access the hard disk properly (CHKDSK
   gives the same output as before) try to run Windows.

   If CHKDSK gives different output, do NOT run CHKDSK /F in this
   state. You may have booted without a driver necessary to access
   the hard drive properly. Remove the floppy and reboot from the
   hard drive.

</PRE></OL>For more information on troubleshooting similar Windows problems,
query on the following word in the Microsoft Knowledge Base:
<P>
<PRE>   tshoot

</PRE></UL><h2>REFERENCES</h2>
 
<P>
"Getting Started with Microsoft Windows," version 3.1, page 100
<P>
"Microsoft Windows User's Guide," version 3.0, page 515
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother kbfasttip kbtshoot<BR>
KBSubcategory: win30 win31<BR>
Additional reference words: 3.00 3.00a 3.10 3.11 clean boot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 26, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
