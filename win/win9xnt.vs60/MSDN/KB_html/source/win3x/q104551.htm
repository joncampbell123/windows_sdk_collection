

<HTML>
<HEAD>
<TITLE>WW0863: Fixing System Hangs with MS-DOS Apps &amp; Novell NetWare </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104551">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1993/09/22">
<META NAME="Keywords" CONTENT="wfw wfwg win31 kb3rdparty kbappnote kbfile kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" If you run Novell NetWare with Microsoft Windows or Windows for Workgroups, your system may stop responding (hang) when you start an MS-DOS-based application or an MS-DOS command prompt. Microsoft has an Application Note,  System Hangs When Running ...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWN,QBWQ,QANE,QAJH,QBDM,QAR4,QAVZ,QAMB,QA9N,QA8Y,QBWS,QAKP,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WW0863: Fixing System Hangs with MS-DOS Apps &amp; Novell NetWare</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104551</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.11
WINDOWS
kbnetwork kbfile kbappnote kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
If you run Novell NetWare with Microsoft Windows or Windows for Workgroups,
your system may stop responding (hang) when you start an MS-DOS-based
application or an MS-DOS command prompt. Microsoft has an Application Note,
"System Hangs When Running MS-DOS-Based Applications with Novell NetWare,"
that provides troubleshooting steps and files that may correct the problem.
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note"
section at the end of this article.
<P>
<P><h3>THE TEXT OF WW0863</h3>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
   WW0863: SYSTEM HANGS WHEN RUNNING MS-DOS-BASED APPLICATIONS WITH
                         NOVELL(R) NETWARE(R)
</PRE> 
<PRE>                                                   Revision Date: 1/94
                                                       1 Disk Included

</PRE>The following information applies to Microsoft Windows(TM), version
3.1.
<P>
 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an Application|
| Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER     |
| EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED     |
| WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR      |
| PURPOSE. The user assumes the entire risk as to the accuracy and   |
| the use of this Application Note. This Application Note may be     |
| copied and distributed subject to the following conditions:  1) All|
| text must be copied without modification and all pages must be     |
| included;  2) If software is included, all files on the disk(s)    |
| must be copied without modification (the MS-DOS utility diskcopy is|
| appropriate for this purpose);  3) All components of this          |
| Application Note must be distributed together;  and  4) This       |
| Application Note may not be distributed for profit.                |
|                                                                    |
| Copyright (C) 1993 Microsoft Corporation.  All Rights Reserved     |
| Microsoft and MS-DOS are registered trademarks and Windows is a    |
| trademark of Microsoft Corporation.                                |
| CompuServe is a registered trademark of CompuServe, Inc.           |
| NetWire is a registered servicemark and NetWare and Novell are     |
| registered trademarks of Novell, Inc.                              |
|--------------------------------------------------------------------|

</PRE><h3>Introduction</h3>
 
<P>
If you are running Novell NetWare when you start an MS-DOS-based
application or an MS-DOS command prompt from Microsoft Windows or
Windows for Workgroups, the screen may turn black and leave the cursor
flashing in the upper-left corner. If you have configured a program
information file (.PIF) so that your MS-DOS-based application starts
in a window, the screen is completely black; the flashing cursor does
not appear when the system stops responding (hangs).
<P>
<P><h3>Cause</h3>
 
<P>
The following factors can contribute to this problem (in order of
probability):

<UL><LI>Third-party device drivers or terminate-and-stay-resident (TSR)
   programs

<LI>An incorrect system configuration

<LI>A problem in VIPX.386

<LI>A problem in the Windows 3.1 virtual timing driver (VTD)
<P>
</UL>This problem is uncommon and is difficult to reproduce since it is
critical interrupt and/or timing dependent and generally occurs only
on large networks with high traffic volumes, which generate many
interrupts.
<P>
<P><h3>Resolution</h3>
 
<P>
To troubleshoot this problem, use the steps below. It is important to
follow these steps in order and leave each change in place, even
though one particular step alone may not correct the problem. Two or
more independent problems may combine to cause the symptoms described
above.

<OL><P><LI>Remove or comment out all unnecessary commands from your CONFIG.SYS
   and AUTOEXEC.BAT files to prevent conflicts with third-party device
   drivers or TSR programs. (To comment out a line, type REM at the
   beginning of the line. After you make these changes, restart your
   machine.) Starting your machine with a minimal configuration is
   called a "clean boot." A clean boot is a basic troubleshooting step
   to test possible conflicts between Windows and various TSR programs
   and device drivers.
<P>
<P><PRE>    NOTE: Once you implement all the steps in this procedure and
    correct the problem, you can begin to undo the changes you made to
    clean boot your system. If the problem recurs, you can isolate the
    device driver, TSR, or application that is causing the problem.
</PRE>
<P><LI>Ensure your Startup group is empty, and comment out the LOAD= and
   RUN= lines in the [windows] section of the WIN.INI file. (To
   comment out a line, place a semicolon [;] at the beginning of the
   line.) After you make these changes, restart Windows.

<P><LI>In the [386Enh] section of the SYSTEM.INI file, set the
   InDOSPolling= setting as follows:
<P>
<P><PRE>      InDOSPolling=FALSE
</PRE>
<P><LI>Remove the TimerCriticalSection= setting from the [386Enh] section
   of the SYSTEM.INI file, then restart your system. If this doesn't
   correct the problem, reinsert the line as follows:
<P>
<P><PRE>      TimerCriticalSection=10000
</PRE>
<P><LI>Upgrade to version 3.32 or later of the Novell shell and Windows
   driver components available on Novell's CompuServe(R) NOVLIB forum
   as DOSUP7.ZIP. These components are also available through
   NetWire(R) and authorized Novell resellers.

<P><LI>Novell has updated and released a new VIPX.386 driver that is
   designed to correct a majority of the critical interrupt problems.
   Upgrade to version 1.15 or later of the Novell VIPX.386 driver,
   which is included with this Application Note. To install the new
   VIPX.386, follow these steps:
<P>
   a. Rename or back up the old VIPX.386 file.
<P>
   b. Copy VIPX.386 from the enclosed WW0863 disk to your Windows
<P><PRE>      SYSTEM subdirectory. For example, if you inserted the WW0863
      disk in drive A and your Windows directory is called WINDOWS and
      is on drive C, type the following command at the MS-DOS command
      prompt and then press ENTER:
</PRE><P>
<PRE>          copy a:\vipx.386 c:\windows\system

   c. If you are using IBM(R) LAN Support, put the network card's IRQ
      in the [VIPX] section of your SYSTEM.INI file.

   d. Reboot the machine, and then load the ODI drivers.

   You should also upgrade to version 2.11 or later of IPXODI.COM and
   version 2.02 or later of LSL.COM. These files are available on
   Novell's CompuServe NOVLIB forum in a self-extracting file called
   BSDUP2.EXE.

</PRE><P><LI>Reboot your system to see if the problem still occurs. If it does,
   go on to step 8.

<P><LI>The VTDA.386 file included with this application note is
   designed to fix a very small percentage of timer-related problems.
   To install VTDA.386, follow these steps:
<P>
   a. Copy VTDA.386 from the enclosed WW0863 disk to your Windows
<P><PRE>      SYSTEM subdirectory. For example, if you inserted the WW0863
      disk in drive A and your Windows directory is called WINDOWS and
      is on drive C, type the following command at the MS-DOS command
      prompt and then press ENTER:
</PRE><P>
<PRE>         copy a:\vtda.386 c:\windows\system

   b. In a text editor, such as Microsoft Windows Notepad, open the
      SYSTEM.INI file (located in your Windows directory).

   c. In the [386Enh] section, change

         device=*vtd

      to:

         device=vtda.386

   d. Save the file.

   e. Quit and then restart Windows.
</PRE></OL> 
<P>
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/ww0863.exe">WW0863.EXE</A> <I>(size: 29735 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/ww0863.exe">WW0863.EXE</A> <I>(size: 29735 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/ww0863.exe">WW0863.EXE</A> <I>(size: 29735 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/ww0863.exe">WW0863.EXE</A> <I>(size: 29735 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>If you are unable to access the source(s) listed above, you can
   have this Application Note mailed to you by calling Microsoft
   Product Support Services Monday through Friday, 6:00 A.M. to 6:00
   P.M. Pacific time at (425) 637-7098. If you are outside the
   United States, contact the Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbfile kbappnote kb3rdparty<BR>
KBSubcategory: win31 wfw wfwg<BR>
Additional reference words: appnote 3.10 3.1 3.11<BR>
Keywords            : wfw wfwg win31 kb3rdparty kbappnote kbfile kbnetwork<BR>
Version             : 3.10 3.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
