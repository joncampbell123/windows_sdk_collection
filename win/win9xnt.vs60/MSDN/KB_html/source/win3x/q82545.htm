

<HTML>
<HEAD>
<TITLE>Serial Device Stops Working After Installing New Serial Device </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82545 ">
<META NAME="KBModify" CONTENT="1998/02/05">
<META NAME="KBCreate" CONTENT="1992/03/31">
<META NAME="Keywords" CONTENT="wfwg win31 win95 wincomm wintapi kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  After you install a new serial device in your computer, an existing serial device may stop responding when you use the new device. For example, you may experience problems with a serial mouse on COM1 after you install an internal modem on COM3.  CA...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJ9,QBWO,QAB5,QDL9,QBWN,QBWQ,QAA1,QBWS,QDI2,QAJZ,QAQ7,QA3A,QDJ3,QDIZ,QAHC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Serial Device Stops Working After Installing New Serial Device</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82545 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.11 95
WINDOWS
kbhw kbenv
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups versions 3.1, 3.11
<LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you install a new serial device in your computer, an existing serial
device may stop responding when you use the new device. For example, you
may experience problems with a serial mouse on COM1 after you install an
internal modem on COM3.
<P>
<P><h2>CAUSE</h2>
 
<P>
Serial ports COM1 and COM3 share a common interrupt request line (IRQ),
IRQ 4, and serial ports COM2 and COM4 share IRQ 3. Because COM1 and COM3
share the same IRQ, the two serial ports cannot be used simultaneously.
<P>
This behavior most often occurs when an internal modem is installed on
COM3 or COM4 with a serial mouse already installed on COM1 or COM2. When
you use the modem, the mouse stops responding (hangs). This is caused by
the modem taking control of the IRQ the mouse uses to communicate with the
computer.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this situation, remove the new serial device from your computer
to determine if the existing serial device regains its functionality. If
the remaining serial device functions correctly, reinstall the new serial
device, but configure the new device to use a different IRQ. For
information about how to configure the new serial device, consult the
documentation included with the new device, or contact the device's
manufacturer.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Some computers and serial port adapters support IRQ sharing. This is
common on Micro Channel Architecture (MCA) bus computers, such as IBM PS/2
computers, and Extended Industry Standard Architecture (EISA) bus
computers, provided the full EISA standard is implemented.
<P>
NOTE: IRQ sharing generally does not work when one of the devices is in
constant use (such as a serial mouse).
<P>
In Windows 3.x, it is possible to configure serial ports to use the same
IRQ (for example, COM1 and COM3 on IRQ 4, and COM2 and COM4 on IRQ 3) one
after the other, but not at the same time unless the serial adapter
supports IRQ sharing. Windows 3.1 and Windows for Workgroups 3.1x support
IRQ sharing for serial adapters. To use the adapters properly, make sure
that the IRQ values are set correctly. To do so, follow these steps:

<OL><P><LI>Double-click Control Panel in Program Manager, and then double-
   click Ports.

<P><LI>Double-click the port you want to configure, and then click Advanced.

<P><LI>In the Interrupt Request Line (IRQ) box, click the correct interrupt.

<P><LI>Click OK, click OK, and then click Close.

<P><LI>Use any text editor (such as Notepad) to open the System.ini file in
   the Windows folder.

<P><LI>Add the following line to the [386Enh] section of the System.ini file:
<P>
<P><PRE>      COMIrqSharing=True
</PRE>
<P><LI>Save and then close the System.ini file.

<P><LI>Restart your computer.
<P>
</OL>For more information about the "COMIrqSharing=" setting and other switches
in the System.ini file for Windows 3.1 and Windows for Workgroups 3.1x,
please see the Sysini.wri file in the Windows folder.
<P>
For more information about the "COMIrqSharing=" setting for Windows 95,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q130533.htm">Q130533</A></B>
   TITLE     : Using Previous Windows Communications Switches in Windows
               95

</PRE></OL>In Windows 95, after you install a modem, the serial port that the modem
is configured to use may not be listed in Device Manager. To determine
which serial port the modem is configured to use, click the modem in
Device Manager, and then click Properties.
<P>
The serial ports of Plug and Play modems do not appear in Device Manager
in the Ports section as you might expect. To view the modem's resources,
click the modem in Device Manager and then click Properties.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbhw kbenv<BR>
KBSubcategory: win95 win31 wfwg wincomm wintapi<BR>
Additional reference words: 3.10 3.11 95 conflict<BR>
Keywords          : wfwg win31 win95 wincomm wintapi kbfaq<BR>
Version           : 3.10 3.11 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
