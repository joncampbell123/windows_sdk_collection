

<HTML>
<HEAD>
<TITLE>OLE: SETUP.REG Can Be Used to Repair REG.DAT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q82650 ">
<META NAME="KBModify" CONTENT="1994/11/23">
<META NAME="KBCreate" CONTENT="1992/03/31">
<META NAME="Keywords" CONTENT="kbenv kbole">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Some object-linking-and-embedding (OLE) servers may provide a text file called SETUP.REG, or a similarly-named file. This file contains information about the particular server application and can be used to repair an application's entry in the Wind...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QDL9,QBWO,QBWN,QBRZ,QBJZ,QAJH,QA9Q,QA0A,QAR4,QBWS,QAYY,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>OLE: SETUP.REG Can Be Used to Repair REG.DAT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 23, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q82650 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Some object-linking-and-embedding (OLE) servers may provide a text
file called SETUP.REG, or a similarly-named file. This file contains
information about the particular server application and can be used to
repair an application's entry in the Windows REG.DAT file. This is
necessary only if you think the entry is incorrect or the REG.DAT file
is corrupted.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The REG.DAT file is the registration database. The database is a
source of information about server applications in a binary format.
Information in REG.DAT includes:

<OL><P><LI>Class name - This describes the type of information contained
   within an object.

<P><LI>The path to the server

<P><LI>Any verbs supported by the server - This includes actions the
   server can take on the object.
<P>
</OL>The information in REG.DAT is used when you open or print a file from
File Manager. This information is also used by applications that
support OLE. The registration database (REG.DAT) is set up and
maintained by Windows and Windows applications. It is located in the
WINDOWS directory. This file should not be moved or deleted. Doing so
may result in loss of functionality in File Manager, Program Manager,
and applications that support OLE.
<P>
SETUP.REG is a text file that contains the same information as REG.DAT
except its format is ASCII instead of binary. SETUP.REG can be merged
with an existing REG.DAT file to repair or update an individual entry
in the REG.DAT file. If REG.DAT or OLESVR.DLL is damaged or corrupted
you may get the following error message.
<P>
<PRE>   Failed to register server.

</PRE></OL><h3>Sample SETUP.REG Entries for PaintBrush</h3>
 
<P>
Note: PaintBrush can only act as a server application.
<P>
HKEY_CLASSES_ROOT\.bmp = PBrush
HKEY_CLASSES_ROOT\.msp = PBrush
HKEY_CLASSES_ROOT\.pcx = PBrush
HKEY_CLASSES_ROOT\PBrush = Paintbrush Picture
HKEY_CLASSES_ROOT\PBrush\shell\print\command = PBRUSH.EXE /P %1
HKEY_CLASSES_ROOT\PBrush\shell\open\command = PBRUSH.EXE %1
HKEY_CLASSES_ROOT\PBrush\protocol\StdFileEditing\verb\0 = Edit
HKEY_CLASSES_ROOT\PBrush\protocol\StdFileEditing\server = PBRUSH.EXE
<P>
Steps to repair REG.DAT with an application's SETUP.REG file:

<OL><P><LI>Open Program Manager. From the File menu, choose Run.

<P><LI>Type REGEDIT.

<P><LI>Choose the OK button.

<P><LI>From the File menu, choose Merge Registration File.

<P><LI>Select the .REG file that needs to be merged into the existing
   REG.DAT file.
<P>
</OL>The Merge Registration File command merges the selected registration
(SETUP.REG) file with the currently displayed database (REG.DAT). The
merged information is not written to the REG.DAT file until you choose
the Save Changes command.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kbole<BR>
KBSubcategory: win31<BR>
Additional reference words: 3.10 3.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 23, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
