

<HTML>
<HEAD>
<TITLE>WW0440: The DrWatson and MSD Diagnostics </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75020 ">
<META NAME="KBModify" CONTENT="1997/07/11">
<META NAME="KBCreate" CONTENT="1991/08/07">
<META NAME="Keywords" CONTENT="win30 kb3rdparty kbappnote kbdisplay kbfile kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" This Application Note,  WW0440: The DrWatson and MSD Diagnostics  contains two programs that aid Microsoft programmers in debugging Windows. When an unrecoverable application error (UAE) occurs, you can send the information collected from these util...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAY2,QAJH,QBWS,QBDM,QAO4,QAYY,QAH4,QAIJ,QAP2,QANE,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WW0440: The DrWatson and MSD Diagnostics</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75020 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a
</UL> 
<P>
This Application Note, "WW0440: The DrWatson and MSD Diagnostics" contains
two programs that aid Microsoft programmers in debugging Windows. When an
unrecoverable application error (UAE) occurs, you can send the information
collected from these utilities to Microsoft.
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note" section
at the end of this article.
<P>
NOTE: The most current version of MSD is included with PSS Application Note
GA0363.
<P>
<P><h2>THE TEXT OF WW0440</h2>
 
<P>
 
<PRE>               WW0440: THE DRWATSON AND MSD DIAGNOSTICS
</PRE> 
<PRE>                                                   Revision Date: 4/94
</PRE> 
<PRE>| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an            |
| Application Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY      |
| KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO    |
| THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A     |
| PARTICULAR PURPOSE. The user assumes the entire risk as to the     |
| accuracy and the use of this Application Note. This Application    |
| Note may be copied and distributed subject to the following        |
| conditions: 1) All text must be copied without modification and    |
| all pages must be included; 2) If software is included, all files  |
| on the disk(s) must be copied without modification [the MS-DOS(R)  |
| utility DISKCOPY is appropriate for this purpose]; 3) All          |
| components of this Application Note must be distributed together;  |
| and 4) This Application Note may not be distributed for profit.    |
|                                                                    |
| Copyright 1991 Microsoft Corporation. All Rights Reserved.         |
| Microsoft and MS-DOS are registered trademarks and Windows is a    |
| trademark of Microsoft Corporation.                                |
| Novell is a registered trademark of Novell, Inc.                   |
 --------------------------------------------------------------------

</PRE><h3>Introduction</h3>
 
<P>
The disk included with this application note contains DrWatson and
MSD, two programs that aid Microsoft programmers in debugging Windows.
DrWatson is a program that logs information about conditions that
exist when an unrecoverable application error (UAE) occurs. MSD
(Microsoft Diagnostics) is a program that identifies system
configuration information.
<P>
This application note explains how to install and use DrWatson and
MSD. For Microsoft to most effectively identify and solve system
problems, we ask that you use these programs and periodically send us
the logs that result. The information in this application note
describes what to do when a UAE occurs and how to send Microsoft the
information that you gather.
<P>
<P><h3>DrWatson</h3>
 
<P>
DrWatson is a debugging tool designed to provide software programmers
with detailed information on the internal state of Windows when a UAE
occurs. DrWatson must be running at the time a UAE occurs to extract
the internal information from the system.
<P>
As DrWatson uses very little memory and does not affect the
performance of Windows, we encourage you to install DrWatson if a UAE
has occurred before. After DrWatson is installed, information is
collected when a UAE occurs and written to a special file
(DRWATSON.LOG) located in the Windows directory.
<P>
DrWatson is a diagnostic tool, not a cure for a problem. Having
DrWatson will not prevent an error from occurring, but the information
in DRWATSON.LOG will help Microsoft developers make the next version
of Windows even better.
<P>
<P><h3>Microsoft Diagnostics (MSD)</h3>
 
<P>
The Microsoft Diagnostics (MSD) program is designed to assist
Microsoft customers and Product Support Services (PSS) technicians in
solving problems with Microsoft products. MSD identifies system
configuration information such as the BIOS, video card type and
manufacturer, installed processor(s), I/O port status, operating
system version, environment settings, hardware devices attached, and
additional software running concurrently with MSD.
<P>
MSD should be used in conjunction with DrWatson to provide valuable
information on hardware configurations and UAEs. Error reports should
include information from both the MSD program and DrWatson. (The
section titled "When a UAE Occurs" on page 2 of this application note
details the procedure for using MSD with DrWatson.)
<P>
<P><h3>Installing DrWatson and MSD</h3>
 
<P>
We recommend that you start DrWatson automatically each time you start
Windows. This will allow you to collect critical information each time
a UAE occurs.
<P>
To install MSD and DrWatson and to start DrWatson automatically when
you start Windows, do the following:

<OL><P><LI>Place the enclosed disk in drive A.

<P><LI>From Windows, start File Manager.

<P><LI>From the File menu, choose Copy. In the From and To boxes, type the
   following:
<P>
<P><PRE>      From:  a:\msd.exe
<PRE></PRE>      To:    c:\

   Choose the Copy button. The MSD program is now copied to your root
   directory (if your root directory is not on drive C, substitute the
   correct drive letter in the To box).

</PRE><P><LI>From the File menu, choose Copy. In the From box, type the
   following:
<P>
<P><PRE>      a:\drwatson.exe a:\toolhelp.dll
</PRE><P>
   In the To box, type in the path to your Windows directory (for
   example: "c:\windows" -- without the quotation marks). Choose the
   Copy button. The DrWatson files are now copied to your Windows
   directory.

<P><LI>From the File menu, choose Copy. Make a backup copy of your WIN.INI
   file. For example, if your Windows directory is called Windows and
   is on drive C, in the From and To boxes, type the following:
<P>
<P><PRE>      From:  c:\windows\win.ini
<PRE></PRE>      To:    c:\windows\win.bak

   Choose the Copy button.

</PRE><P><LI>Exit File Manager and open Notepad or any text editor. Open the
   WIN.INI file, and in the [Windows] section, add DrWatson to the
   LOAD= line. For example:
<P>
<P><PRE>      [windows]
      Beep=yes
      Spooler=yes
      NullPort=None
      LOAD=DRWATSON.EXE
</PRE>
<P><LI>Save the WIN.INI file and exit the text editor.

<P><LI>Exit and then restart Windows.
<P>
</OL>DrWatson should now appear as an icon on your desktop.
<P>
<P><h3>Using DrWatson</h3>
 
<P>
DrWatson adds a file to your Windows directory called DRWATSON.LOG. If
a UAE occurs while DrWatson is running, DrWatson captures data
regarding the internal operations of Windows. In addition, DrWatson
prompts you for details on how the UAE occurred. When you type in your
response, please include information on what you were doing or what
steps created the UAE. This information is recorded in the
DRWATSON.LOG file and will help our software programmers track the
problems.
<P>
At this time, DrWatson does not detect all system errors, so don't be
alarmed if DrWatson does not record information after a particular
system error.
<P>
Each time a UAE occurs, DrWatson appends new data to DRWATSON.LOG. To
prevent this file from growing too large and to aid our processing,
please save DRWATSON.LOG as a different file periodically. (For
example, if five UAEs occur in one day, save DRWATSON.LOG under a
different name before you start Windows again the next day.)
<P>
To save the file under a different name, type the following at the
command prompt before you start Windows:
<P>
<PRE>   rename c:\drwatson.log &lt;newname&gt;

</PRE></OL>where &lt;newname&gt; is any legal MS-DOS filename, such as SEPT06.LOG. If
your root directory is not on drive C, substitute the correct drive
letter.
<P>
<P><h3>When a UAE Occurs</h3>
 

<OL><P><LI>When a UAE occurs, the DrWatson dialog box will appear. Type in a
   description of what you were doing prior to receiving the error.
   Press ENTER.

<P><LI>Exit Windows if possible. If exiting is not possible, restart your
   computer.

<P><LI>Change to the root directory, and at the command prompt, type "msd"
   (without the quotation marks) and press ENTER to run the MSD
   program. (For LCD and monochrome screens, type "msd /b" and press
   ENTER.)

<P><LI>Press R to choose Generate Report. Select the Generate To File
   option. When prompted for a filename, type "msd.log" (without the
   quotation marks and press ENTER. Fill in the information requested.

<P><LI>Exit MSD by pressing X.

<P><LI>Append the MSD log to the DrWatson log by typing the following at
   the command prompt:
<P>
<P><PRE>      type &lt;path&gt;\MSD.LOG &gt;&gt; &lt;path\drwatson&gt;
</PRE><P>
   where &lt;path\drwatson&gt; is the path and filename of the DrWatson log.
   For example, if you named your DrWatson log the default
   DRWATSON.LOG (in the WINDOWS directory on drive C), type the
   following:
<P>
<P><PRE>      type c:\msd.log &gt;&gt; c:\windows\drwatson.log
</PRE>
<P><LI>After you have logged several UAEs, send us the log by following
   the instructions listed on page 4 of this application note.

<P><LI>After sending us the log, delete the MSD and DrWatson logs (for
   example, MSD.LOG and DRWATSON.LOG) from your hard disk.
<P>
</OL><h3>More Information About Using the Microsoft Diagnostics Program</h3>
 
<P>
The MSD program runs with MS-DOS and the DOS compatibility box of
OS/2.
<P>
MSD presents a Main Menu screen split into two sections. The upper
section presents a summary of information that the utility has
gathered from your system. For additional information on any category,
use the quick key commands, or move the highlight bar (using the arrow
keys) to any category and press the ENTER key. A dialog box appears
that presents detailed information for that category. Return to the
Main Menu screen by pressing the ESC key.
<P>
The following is a brief explanation of the categories in the first
section of the MSD program:
<P>
<PRE>   Category           Description
   --------           -----------

   BIOS               Displays the BIOS manufacturer, date, version,
                      and type

   Processor          Displays the processor type and math
                      coprocessor, if installed

   Memory             Displays a map of memory from 768K to 1 MB and
                      information concerning the configuration of RAM
                      and ROM in your computer system

   Video              Shows your video card's manufacturer and model,
                      BIOS version, memory, and current video mode

   Network            Detects whether a network is MS-Net or
                      compatible, or Novell

   Mouse              Shows the DOS mouse driver version number, mouse
                      type, and other information concerning the mouse

   Game Adapter       Dynamically displays game card status for up to
                      two game devices or joysticks

   CD-ROM             Displays the Microsoft CD-ROM Extensions
                      (MSCDEX.EXE) version number and drive letter

   Operating System   Displays the operating system version number and
                      path from which MSD was run

   Parallel Ports     Dynamically displays the status of installed
                      parallel ports and their port addresses

   Serial Ports       Dynamically displays the status of active serial
                      ports and their current configurations

   Disk Drives        Scans all local and logical drives and displays
                      the total and available bytes

   IRQ Status         Shows the current IRQ (hardware interrupt)
                      status

   Environment        Displays environment variables

   AUTOEXEC.BAT       Lists the AUTOEXEC.BAT file

   CONFIG.SYS         Lists the CONFIG.SYS file

</PRE></OL>The lower section of the MSD screen includes additional functions you
can use with your system, as follows:
<P>
<PRE>   Function           Description
   --------           -----------

   Resident Programs  Displays the names of programs loaded in RAM at
                      the time MSD was executed, their locations, and
                      their sizes; programs may be loaded into
                      multiple segments of RAM and have multiple
                      entries in the table

   Device Table       Displays software and hardware device drivers
                      installed; these include default devices, such
                      as COM1 or LPT1, and user-installed devices
                      loaded from the CONFIG.SYS file, such as
                      HIMEM.SYS or EMM386.SYS

   Printer Test       Prints a page to test the connection between the
                      computer and either a TTY or PostScript-type
                      printer

   Generate Report    Prints a "faxable" report to a normal TTY
                      printer or to a file

   File Viewer        Views text files by entering the path and
                      filename

   Memory Browser     Searches selected ROM and RAM areas for search
                      strings such as "Copyright" and "Version"

   About              Displays the MSD version number and copyright
                      information

   Exit               Exits MSD

</PRE><h3>Sending Information Gathered by DrWatson and MSD to Microsoft</h3>
 
<P>
Electronic format is currently the only way we can accept DrWatson log
information. This means we can receive log data by disk, or through
electronic mail. In all cases, we require your company name, address, and
the name and phone number of a person we can contact in the event we need
additional data.
<P>
Send a disk containing the DrWatson log(s) to the following mailing
address:
<P>
<PRE>   Microsoft Corporation
   Attn: Dr. Watson Program
   One Microsoft Way, Building #3
   Redmond, WA 98052-6399

</PRE>After you have sent us the log file(s) by one of the methods described
above, delete all of the log files from your hard disk to free up disk
space.
<P>
Unfortunately, we cannot respond to log contributors, but we will
review every DrWatson file and actively work on solving reported
problems. We thank you in advance for your efforts. Your help will
enable us to keep improving future versions of Windows.
 
<P>
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/ww0440.exe">WW0440.EXE</A> <I>(size: 123920 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/ww0440.exe">WW0440.EXE</A> <I>(size: 123920 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/ww0440.exe">WW0440.EXE</A> <I>(size: 123920 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/ww0440.exe">WW0440.EXE</A> <I>(size: 123920 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>If you are unable to access the source(s) listed above, you can
   have this Application Note mailed to you by calling Microsoft
   Product Support Services Monday through Friday, 6:00 A.M. to 6:00
   P.M. Pacific time at (425) 637-7098. If you are outside the
   United States, contact the Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: appnote 3.00 kbmm<BR>
Keywords            : win30 kb3rdparty kbappnote kbdisplay kbfile kbnetwork<BR>
Version             : 3.00 3.00a<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
