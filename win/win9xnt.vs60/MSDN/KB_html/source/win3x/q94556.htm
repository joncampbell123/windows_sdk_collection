

<HTML>
<HEAD>
<TITLE>Using COMxIrq=-1 for COM4 Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94556 ">
<META NAME="KBModify" CONTENT="1994/11/23">
<META NAME="KBCreate" CONTENT="1993/01/07">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Microsoft Windows 3.1 may not be able to access a serial device whose address refers to a COM port that is located to the right of an absent COM port in the BIOS data address table (BDA). This can often occur if a modem is installed on COM4, and CO...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDJ9,QDL9,QBWN,QBWO,QAC2,QBWQ,QDNQ,QBVV,QAVX,QAR4,QAHC,QBXS,QAYY,QAV1,QAV0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using COMxIrq=-1 for COM4 Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 23, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94556 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Windows 3.1 may not be able to access a serial device whose
address refers to a COM port that is located to the right of an absent
COM port in the BIOS data address table (BDA). This can often occur
if a modem is installed on COM4, and COM3 is not physically present on
the computer.
<P>
The serial communications driver (COMM.DRV) dated 3-10-92 may require
modification of the [386enh] section of the SYSTEM.INI file to
compensate for any conflicts that may arise when the BDA does not
agree with traditional values for certain COM ports.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The COMM.DRV that ships with Windows 3.1 expects certain COM port base
addresses to be located in certain locations in the BDA. If you use
DEBUG on a traditional COM1-COM4 equipped computer, the following data
is displayed for the BDA:
<P>
<PRE>   40:0 F8 03 F8 02 E8 03 E8 02 00 00 ...

</PRE>COM1 (03F8) is displayed in the first available "slot" as F8 03; COM2
(02F8) in the second slot; COM3 (03E8) in the third; and finally COM4
(02E8) in the fourth slot.
<P>
If a COM port is absent on the computer, a higher-numbered COM port's
address may "slide" to the left in the table, which may confuse the
Windows COMM driver.
<P>
A common situation where this may happen is with an internal modem
that is configured to use COM4. Many modem manufactures ship their
modems on COM4 to avoid replacing COM1 or COM2 (which may be in use),
and COM3 is likely to have an IRQ conflict with the mouse. COM1 shares
the physical interrupt (IRQ 4) with COM3 and is a popular location for
a serial mouse. The BDA problem may appear in this situation.
<P>
A DEBUG dump of the BIOS data area looks as follows:
<P>
<PRE>   40:0 F8 03 F8 02 E8 02 00 00 ...

</PRE>Without a physical COM3, the BIOS finds the COM4 device at 02E8, and calls
it COM3 in the BIOS data area. This confuses Windows, which thinks that
there is no COM4, and that COM3 is at 02E8/IRQ4.
<P>
This behavior is normal for many BIOS versions and can be compensated
for by adding a COMxIrq=-1 to the SYSTEM.INI in the [386Enh] section.
For the COM4 example above, the following lines should be added to the
SYSTEM.INI file:
<P>
<PRE>   COM3IRQ=-1      ; disables the false COM3 appearing BIOS data area
   COM4Base=02E8   ; sets correct COM4 address
   COM4IRQ=3       ; sets correct COM4 IRQ

</PRE>This example tells Windows that COM3 does not exist on the computer
and that the BDA value in the third slot is actually for COM4. This
approach may be easier than writing a DEBUG script to pack zero values
into the BDA. However, you may need a DEBUG script to compensate for a
BIOS and other non-COM4 problems.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv<BR>
KBSubcategory: win31<BR>
Additional reference words: 3.10 Enhanced Mode terminal faxmodem<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 23, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
