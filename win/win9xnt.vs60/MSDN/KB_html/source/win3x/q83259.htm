

<HTML>
<HEAD>
<TITLE>WW0525: Troubleshooting 386 Enhanced Mode Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83259 ">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1992/04/07">
<META NAME="Keywords" CONTENT="kbappnote kbdisplay kbfile kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" Microsoft Product Support Services offers an Application Note titled  WW0525: Troubleshoooting 386 Enhanced Mode Problems  that can help you troubleshoot 386 enhanced mode problems. Symptoms of these problems include:   - Windows stopping or returni...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAHE,QAKR,QBW6,QA5W,QANE,QAIJ,QBVV,QBWS,QDIO,QBDM,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WW0525: Troubleshooting 386 Enhanced Mode Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83259 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.11
WINDOWS
kbfile kbdisplay kbtshoot kbappnote
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
Microsoft Product Support Services offers an Application Note titled
"WW0525: Troubleshoooting 386 Enhanced Mode Problems" that can help you
troubleshoot 386 enhanced mode problems. Symptoms of these problems
include:

<UL><LI>Windows stopping or returning to the MS-DOS prompt
<LI>General protection (GP) faults
<LI>Windows defaulting to standard mode when you type "win" (without
   the quotation marks) at the MS-DOS prompt
<P>
</UL>You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft FastTips Technical Library
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note"
section at the end of this article.
<P>
<P><h2>THE TEXT OF WW0525</h2>
 
<P>
 
<PRE>    Microsoft Product Support Services Application Note (Text File)
          WW0525: Troubleshooting 386 Enhanced Mode Problems
</PRE> 
<PRE>                                                   Revision Date: 3/92
                                                      No Disk Included

</PRE>The following information applies to Microsoft Windows version 3.1.
<P>
<PRE> --------------------------------------------------------------------
| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an            |
| Application Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY      |
| KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO    |
| THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A     |
| PARTICULAR PURPOSE. The user assumes the entire risk as to the     |
| accuracy and the use of this Application Note. This Application    |
| Note may be copied and distributed subject to the following        |
| conditions: 1) All text must be copied without modification and    |
| all pages must be included; 2) If software is included, all files  |
| on the disk(s) must be copied without modification [the MS-DOS(R)  |
| utility DISKCOPY is appropriate for this purpose]; 3) All          |
| components of this Application Note must be distributed together;  |
| and 4) This Application Note may not be distributed for profit.    |
|                                                                    |
| Copyright 1992 Microsoft Corporation. All Rights Reserved.         |
| Microsoft, MS-DOS, and the Microsoft logo are registered           |
| trademarks and Windows is a trademark of Microsoft Corporation.    |
 --------------------------------------------------------------------

</PRE><h3>Introduction</h3>
 
<P>
Microsoft Windows version 3.1 has two modes of operation: standard and
386 enhanced modes. 386 enhanced is the highest-level mode of
operation because it utilizes the virtual mode of the 80386i
processor. However, you may experience the following problems when
attempting to run Windows 3.1 in 386 enhanced mode:

<UL><LI>Windows stopping or returning to the MS-DOS prompt
<LI>General protection faults (GPFs)
<LI>Windows defaulting to standard mode when you type "win"
   (without the quotation marks) at the MS-DOS prompt
<P>
</UL><h3>Troubleshooting Procedure</h3>
 
<P>
The following steps may correct or reduce these problems:

<OL><P><LI>Ensure that the system has the minimum configuration required to
    run Windows 3.1 in 386 enhanced mode. These requirements are:
<P>
     - An 80386 or faster processor
     - 200K of free conventional memory
     - 1024K of free extended memory
     - 2 MB of free disk space

<P><LI>Try to force Windows into 386 enhanced mode by typing "win /3"
    (without the quotation marks). If this is successful, the computer
    probably has available less than the 1024K of extended memory
    required for Windows to default to 386 enhanced mode on startup.
    Verify that you are running an extended memory manager (HIMEM.SYS
    is the extended memory manager that comes with Windows 3.1). If
    so, you should free up extended memory so that Windows can default
    to 386 enhanced mode.
<P>
    The best way to accomplish this is to start your computer with
    minimal CONFIG.SYS and AUTOEXEC.BAT files. Using a text editor
    such as Notepad, comment out any lines that load extraneous device
    drivers, terminate-and-stay-resident (TSR) programs, and so forth,
    that are not required to run your machine. To comment out a line,
    type "rem" (without the quotation marks) at the beginning of the
    line.
<P>
       Caution: If you do not know the purpose of a line in your
       CONFIG.SYS or AUTOEXEC.BAT file, leave that line as is.
<P>
    Other things that might help free up extended memory include
    reducing the size of any disk cache, such as SMARTDRV.EXE, or RAM
    drive. Although you can force Windows into enhanced mode if there
    is less than 1024K of extended memory, this is not recommended
    because this condition can adversely affect the performance of
    Windows.

<P><LI>Try starting Windows by typing:
<P>
<PRE>        win /d:xvs

    If this is successful, try each of the following switches
    individually to see which is required:

       WIN /D:X
          This switch excludes the entire upper memory block region
          from A000-FFFF. It is functionally equivalent to adding
          EmmExclude=A000-EFFF to the [386enh] section of the
          SYSTEM.INI file.

             NOTE: If any upper memory block (UMB) provider is
             installed in the CONFIG.SYS file, this switch has no
             effect in the region the UMB provider is using. The UMB
             provider has priority in the UMB area. For this reason,
             you should disable the UMB provider (such as EMM386.EXE),
             restart the system, and then try the WIN /D:X switch.

       WIN /D:V
          This switch is equivalent to adding the line
          VirtualHDIrq=OFF to the [386enh] section of the SYSTEM.INI
          file. For more information about the VirtualHDIrq= setting,
          consult the SYSINI.WRI file in the \WINDOWS directory.

       WIN /D:S
          This switch is equivalent to adding the line
          SystemROMBreakPoint=OFF to the [386enh] section of the
          SYSTEM.INI file.

    After determining which switch, or combination of switches, allows
    Windows 3.1 to successfully start in 386 enhanced mode, use a text
    editor such as Notepad to add the corresponding line, or lines, to
    the [386enh] section of the SYSTEM.INI file.

</PRE><P><LI>Create a BOOTLOG.TXT file by typing "win /b" (without the
    quotation marks) to start Windows. This switch will create a file
    called BOOTLOG.TXT in the \WINDOWS directory. Once this file has
    been created, you can view it using any text editor (such as
    Notepad). In this file, Windows creates a list of the basic
    Windows drivers as they are loaded. If there is a problem with one
    of these drivers loading, a statement will appear in the
    BOOTLOG.TXT file showing which driver could not load. This
    information is valuable in determining which component of Windows
    is not able to function properly.
<P>
       NOTE: This switch will append new information to the end of an
       existing BOOTLOG.TXT file. Therefore, you may want to rename or
       delete any existing BOOTLOG.TXT file in the \WINDOWS directory
       before using the /B switch.
<P>
    The following is a list of error codes that may appear in the
    BOOTLOG.TXT file:
<P>
<PRE>        0   Out of memory
        2   File not found
        3   Path not found
        5   Attempt to dynamically link to a task
        6   Library requires separate data segments for each task
        8   Insufficient memory to start application
       10   Incorrect Windows version
       11   Invalid .EXE file (non-Windows .EXE file or error in .EXE
            file image)
       12   OS/2 application
       13   MS-DOS 4.0 application
       14   Unknown .EXE file type
       15   Attempt in protected (standard or 386 enhanced) mode to
            load an .EXE file created for an earlier version of
            Windows
       16   Attempt to load a second instance of an .EXE file
            containing multiple writeable data segments
       17   Attempt in a large-frame EMS mode to load a second
            instance of an application that links to certain
            nonshareable DLLs already in use
       18   Attempt in real mode to load an application marked for
            protected mode only

</PRE><P><LI>At the MS-DOS prompt, change to the \WINDOWS directory before
    starting Windows. When Windows starts, it reads the .INI files
    that specify the locations of many of the files that Windows needs
    in order to start. When Windows reads the .INI files, it looks for
    the specified files in the following locations:
<P>
    a. The current directory
    b. The \WINDOWS directory
    c. The \WINDOWS\SYSTEM subdirectory
    d. All of the directories listed in the PATH environment variable
       in the AUTOEXEC.BAT file
    e. All of the directories in the list of directories mapped on a
       network
<P>
    For example, if there is an outdated MOUSE.DRV file (the Windows
    Microsoft Mouse driver) in the current directory, Windows may not
    be able to start.

<P><LI>Verify that Windows can run in standard mode by typing "win /s"
    (without the quotation marks) at the MS-DOS prompt. If Windows can
    run in standard mode, you may have installed a mouse, keyboard,
    video, or printer driver designed for a previous version of
    Windows, or you may have made an incorrect selection for your
    hardware.
<P>
    To change the printer driver, start the Control Panel and choose
    the Printers icon. To change the mouse, keyboard, video, or
    network driver, from the Program Manager File menu, choose Run,
    type "setup," (without the quotation marks) and choose the OK
    button. This command brings up the System Information screen; from
    the Options menu, choose Change System Settings.
<P>
    Also, check the "Microsoft Windows Version 3.1 Hardware
    Compatibility List" that ships with Windows to see if your
    computer requires special handling. If it does, exit Windows and
    then reinstall it, using only a minimum of drivers (use no mouse
    or network driver and use the lowest resolution video driver) and
    the SETUP /I switch.
<P>
    Another option is to delete Windows and reinstall it using the
    SETUP /I switch, along with the minimal configuration described
    above. This may be necessary if it is not possible to determine
    which component of Windows is preventing proper operation.

<P><LI>Check your AUTOEXEC.BAT and CONFIG.SYS files for TSR programs,
    sufficient buffers, files, and environment space. Some TSR
    programs are not compatible with Windows 3.1 and may need to be
    commented out during Windows operation. Again, if you do not know
    the purpose of a line, do not comment it out.

<P><LI>Disable the autoswitching or autosensing feature on the video card
    if applicable. Verify that you are using the latest version of the
    BIOS (basic input/output system) for that video card (see step
    13).

<P><LI>Disable system or video ROM shadowing if it is supported by the
    system.

<P><LI>Verify that you are using the correct version of MS-DOS for the
    system. You should be using a version of MS-DOS that is 3.1 or
    later and is designed for the machine. Do NOT use an original
    equipment manufacturer (OEM) version of MS-DOS on a computer that
    was not manufactured by that OEM (for example, do not use COMPAQ
    MS-DOS on an IBM computer).

<P><LI>Ensure that HIMEM.SYS loads successfully. If it does not, or if a
    problem is suspected, try ALL A20 handlers available to the
    version of HIMEM.SYS being used. The DEVICE=C:\HIMEM.SYS line in
    your CONFIG.SYS file should include the /M:x switch, where x
    denotes a handler number. For example, if you are using a PS/2,
    this line should read DEVICE=C:\HIMEM.SYS /M:2.
<P>
    For more information about the /M switch, see pages 543-547 of the
    version 3.1 "Microsoft Windows User's Guide."
<P>
       NOTE: Some A20 handlers may lock up your computer, so it is
       important to have a system MS-DOS floppy disk available that
       contains an ASCII text editor (such as Edlin or Edit) should
       this problem occur.

<P><LI>Install Windows in an empty directory. Do not install Windows
    version 3.1 over a 2.x version, because some files and drivers may
    not be updated properly.

<P><LI>Confirm that you are using a system BIOS that is dated 1988 or
    later. If you are using a BIOS with a date earlier than 1988, you
    may encounter problems when trying to run Windows 3.1 in 386
    enhanced mode. The BIOS date will vary depending on the brand of
    your BIOS and the manufacturer of your machine. The BIOS version
    and date are typically displayed when you first start up the
    system. If the date is not displayed when the system is started,
    or if you have any questions about the compatibility of your BIOS
    with Windows 3.1, you should contact your hardware manufacturer.

<P><LI>Remove any additional hardware from the system (mouse, network
    card, fax board, modem, and so forth). After all the nonessential
    hardware has been removed, restart the system, and run Windows
    3.1. If you can now run in 386 enhanced mode, it is likely that an
    interrupt request line (IRQ) conflict exists. Replace one piece of
    hardware at a time, restarting the machine after each new piece of
    hardware is replaced, and run Windows in 386 enhanced mode. Do
    this until the symptom reoccurs, at which point you've most likely
    found an IRQ conflict. For more information on how to deal with
    IRQ conflicts, contact the manufacturer of the piece of hardware
    in question.

<P><LI>If none of the above steps has corrected the problem, you may want
    to contact your hardware manufacturer for additional information.
<P>
</OL><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/ww0525.exe">WW0525.EXE</A> <I>(size: 17949 bytes)</I> 
                       , a self-extracting file, on the following
</PRE></OL>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/ww0525.exe">WW0525.EXE</A> <I>(size: 17949 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/ww0525.exe">WW0525.EXE</A> <I>(size: 17949 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/ww0525.exe">WW0525.EXE</A> <I>(size: 17949 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>You can have this Application Note mailed or faxed to you from the
   automated Microsoft Windows 3.1 FastTips Technical Library, which you
   can call 24 hours a day, 7 days a week at (800) 936-4200. NOTE: The
   FastTips Technical Library is available only to customers within the
   U.S. and Canada.

<LI>If you are unable to access the source(s) listed above, you can
   have this Application Note mailed or faxed to you by calling
   Microsoft Product Support Services Monday through Friday, 6:00 A.M.
   to 6:00 P.M. Pacific time at (425) 637-7098. If you are outside the
   United States, contact the Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbfile kbdisplay kbtshoot kbappnote<BR>
KBSubcategory:<BR>
Additional reference words: appnote tshoot gpf 3.10 S13365 winmem win31<BR>
Keywords            : kbappnote kbdisplay kbfile kbtshoot<BR>
Version             : 3.10 3.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
