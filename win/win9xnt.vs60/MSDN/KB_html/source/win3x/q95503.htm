

<HTML>
<HEAD>
<TITLE>WG0772: Banyan VINES 5.00 Support </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95503 ">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1993/02/11">
<META NAME="Keywords" CONTENT="wfw kbappnote kbfile kbother">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" Microsoft has an Application Note that explains how to install Banyan VINES support for Windows for Workgroups version 3.1.  The Application Note provides the following information:   - How to install Banyan VINES   - How to use Windows for Workgrou...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAVZ,QAA1,QBWS,QDI2,QAQW,QANE,QBTX,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WG0772: Banyan VINES 5.00 Support</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95503 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10
WINDOWS
kbfile kbappnote
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.1
</UL> 
<P>
Microsoft has an Application Note that explains how to install Banyan
VINES support for Windows for Workgroups version 3.1.
<P>
The Application Note provides the following information:

<UL><LI>How to install Banyan VINES

<LI>How to use Windows for Workgroups on a VINES network

<LI>How to upgrade your workstation to different versions of Banyan
   VINES

<LI>How to solve common network problems
<P>
</UL>You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note"
section at the end of this article.
<P>
<P><h2>THE TEXT OF WG0772</h2>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
                WG0772: BANYAN(R) VINES(R) 5.00 SUPPORT
</PRE> 
<PRE>                                                   Revision Date: 2/93
                                                       1 Disk Included

</PRE>The following information applies to Microsoft Windows for Workgroups
version 3.1.
<P>
<PRE> --------------------------------------------------------------------
| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an            |
| Application Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY      |
| KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO    |
| THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A     |
| PARTICULAR PURPOSE. The user assumes the entire risk as to the     |
| accuracy and the use of this Application Note. This Application    |
| Note may be copied and distributed subject to the following        |
| conditions: 1) All text must be copied without modification and    |
| all pages must be included; 2) If software is included, all files  |
| on the disk(s) must be copied without modification [the MS-DOS(R)  |
| utility DISKCOPY is appropriate for this purpose]; 3) All          |
| components of this Application Note must be distributed together;  |
| and 4) This Application Note may not be distributed for profit.    |
|                                                                    |
| Copyright 1993 Microsoft Corporation. All Rights Reserved.         |
| Microsoft and MS-DOS are registered trademarks and Windows         |
| is a trademark of Microsoft Corporation.                           |
| Banyan and VINES are registered trademarks of Banyan systems, Inc. |
| OS/2(R) is a registered trademark licensed to Microsoft            |
| Corporation.                                                       |
 --------------------------------------------------------------------

</PRE><h2>INSTALLING VINES SUPPORT</h2>
 
<P>
To install VINES support for Windows for Workgroups, first make sure
you have the enclosed WG0772 disk and that it corresponds to your
version of Banyan VINES.
<P>
To support Windows for Workgroups, your VINES network must be running
version 4.11(5), 5.00(5), or 5.50(1) of the network software. If your
network is running an earlier version, such as 4.10, you must first
upgrade to a more recent version. If your network is running 5.00(6),
you must first either reinstall version 5.00(5) or upgrade to 5.50(1).
For more information, refer to the "Upgrading Network Software"
section below.
<P>
The WG0772 disk contains the ADDNETS.EXE file, which you need to run
before you install VINES support for Windows for Workgroups. The
ADDNETS.EXE file modifies the NETWORK.INF file and installs other
network software.
<P>
Before you install VINES network support, you need to install Windows
for Workgroups. Once you've installed Windows for Workgroups, use the
following steps to install VINES support:

<OL><P><LI>If you are running Windows for Workgroups, quit it and return to
   the MS-DOS command prompt.

<P><LI>Use a text editor to open your AUTOEXEC.BAT file and remove any
   VINES-specific commands (such as BAN, Z:LOGIN, and so forth).

<P><LI>Save your modified AUTOEXEC.BAT file.

<P><LI>Insert the WG0772 disk in your floppy disk drive.

<P><LI>At the MS-DOS command prompt, type the following and press enter:
<P>
<P><PRE>      &lt;drive:&gt;addnets [destination]
</PRE><P>
   where &lt;drive:&gt; is your floppy disk drive and [destination] is the
   path for your Windows for Workgroups directory.
<P>
<P><PRE>    NOTE: If Windows for Workgroups is in your PATH environment
    variable, you don't need to specify the destination. Also, if you
    are a network administrator and have installed Windows for
    Workgroups to a server by using Setup with the /A option, you can
    type the path to the shared server directory in place of the
    destination parameter to update that installation.
</PRE><P>
   The Addnets installation program modifies the NETWORK.INF file with
   VINES-specific information and installs some updated driver files
   (WFWNET.DRV and WFWSETUP.CPL).
<P>
</OL>This completes the steps that must be performed at the MS-DOS command
prompt. To add the VINES network to your list of compatible Windows
for Workgroups networks, continue with the following steps:

<OL><P><LI>Start Windows for Workgroups.

<P><LI>In the Main group, choose the Control Panel icon.

<P><LI>In the Control Panel window, choose the Network icon.
<P>
   The Network Settings dialog box appears.

<P><LI>Under Options, choose the Networks button.
<P>
   The Compatible Networks dialog box appears.

<P><LI>Under Available Network Types, select either Banyan VINES
   4.11(5), Banyan VINES 5.00(5), or Banyan VINES 5.50(1) (depending
   on your network version), and then choose the Add button.
<P>
   The VINES network software files are copied to your local hard disk
   drive. If the WG0772 disk is not in your floppy disk drive, the
   system first prompts you to insert it.

<P><LI>Choose the OK button to close the Compatible Networks dialog box.
<P>
   Control Panel displays a message indicating that the AUTOEXEC.BAT,
   PROTOCOL.INI, and SYSTEM.INI files have been modified. VINES-
   specific information has been added to these files. If you want to
   view them, use a text editor.

<P><LI>Choose the OK button again.

<P><LI>Remove the disk from your floppy disk drive, and then restart your
   workstation.
<P>
   You must restart your workstation in order for the changes to take
   effect.
<P>
</OL><h2>USING WINDOWS FOR WORKGROUPS ON A VINES NETWORK</h2>
 
<P>
Some distinctions between using Windows for Workgroups on a Banyan
VINES network and using Windows 3.1 on a Banyan VINES network are
described below.
<P>
<P><h3>PCCONFIG MODIFICATIONS</h3>
 
<P>
Certain VINES files are copied to your Windows for Workgroups
directory, including PCCONFIG.DB. If you have made modifications to
the PCCONFIG.DB file located in your VINES directory, use the PCCONFIG
program to make the same modifications (such as changing the Login
Group Search list) to the PCCONFIG.DB file in your Windows for
Workgroups directory.
<P>
<P><h3>MODIFICATIONS FOR TOKEN-RING LAN MEDIA</h3>
 
<P>
Currently, token-ring LANs are supported in Windows for Workgroups for
VINES 5.50(1). If your network runs an earlier version of VINES, such
as VINES 4.11(5) or 5.00(5), only EtherNet LANs are supported. Updated
releases are being developed to provide support for these versions of
VINES but are not currently available.
<P>
If you are using token-ring media on a network running VINES 5.50(1),
be sure to change the default LAN driver to NDIS Token-Ring. To do
this, modify the PCCONFIG.DB file in your Windows for Workgroups
directory using the PCCONFIG program. (For more information about
PCCONFIG, see the previous section, "PCCONFIG Modifications," or refer
to your Banyan VINES documentation.)
<P>
<PRE>                      UPGRADING NETWORK SOFTWARE

</PRE></OL>This section describes upgrade procedures for different network
versions, modifications made to your AUTOEXEC.BAT file, and other
issues you should be aware of when using Windows for Workgroups on a
Banyan VINES network.
<P>
<P><h3>VINES 4.10 NETWORKS</h3>
 
<P>
If your network runs VINES 4.10, upgrade to VINES 4.11(5) before
installing support for Windows for Workgroups.
<P>
<P><h3>VINES 5.00(6) NETWORKS</h3>
 
<P>
If your network runs VINES 5.00(6), install VINES support for 5.00(5)
according to the installation instructions. When you are prompted to
restart your workstation at the end of the installation procedure, do
so.
<P>
After you restart your workstation, you will use the NEWREV command
from the MS-DOS command prompt to upgrade to VINES 5.00(6). However,
because the NEWREV program overwrites the PROTMAN.DOS and NDISBAN.COM
files located in the Windows for Workgroups directory, you should back
up the PROTMAN.DOS and NDISBAN.COM files to another directory before
running NEWREV. After the upgrade is complete, copy the PROTMAN.DOS
and NDISBAN.COM files back to the Windows for Workgroups directory,
and then reboot your workstation again. This ensures that you are
using the correct versions of these two files.
<P>
<P><h3>UPGRADING YOUR WORKSTATION</h3>
 
<P>
If you've upgraded your network server, use the following steps to
upgrade your workstation:

<OL><P><LI>Start Windows for Workgroups.

<P><LI>In the Main group, choose the Control Panel icon.

<P><LI>In the Control Panel window, choose the Network icon.
<P>
   The Network Settings dialog box appears.

<P><LI>Under Options, choose the Networks button.
<P>
   The Compatible Networks dialog box appears.

<P><LI>Under Available Network Types, select your previous version of
   Banyan VINES, and then choose the Remove button.

<P><LI>Under Available Network Types, select the upgraded version of
   Banyan VINES, and then choose the Add button.

<P><LI>Choose the OK button.
<P>
   You must restart Windows for Workgroups in order for the changes to
   take effect.
<P>
</OL><h3>AUTOEXEC.BAT MODIFICATIONS</h3>
 
<P>
Installing VINES support adds the following lines to the workstation's
AUTOEXEC.BAT file:
<P>
<PRE>   ban /nc
   ndisban
   redirall
   arswait
   z:login

</PRE></OL>These lines should not be moved to other locations in the AUTOEXEC.BAT
file.
<P>
<PRE>   NOTE: If you want to run the VINES LOGIN.EXE program locally, copy
   the file from drive Z, and
   remove the Z:LOGIN line from your AUTOEXEC.BAT file.

</PRE><h3>CONNECTING TO A VINES NETWORK DRIVE OR PRINTER</h3>
 
<P>
When you connect to a network drive or network printer by using File
Manager or Program Manager, a dialog box appears in which you can
select a shared directory or printer in your workgroup. To connect to
a VINES network drive or printer, choose the VINES button. The VINES
Network Connection dialog box then appears.
<P>
<P><h3>RUNNING NAMED PIPES APPLICATIONS</h3>
 
<P>
Applications written to the Named Pipes application programming
interface (API) cannot run with the VINES protocol in the Windows for
Workgroups environment; however, these applications are supported by
the Windows for Workgroups NetBEUI protocol.
<P>
<P><h3>CONNECTING TO OS/2(R)-BASED SQL SERVER MACHINES ON VINES</h3>
 
<P>
SQL Server client applications running with Windows for Workgroups can
connect to OS/2-based SQL Server machines on VINES networks by using
the Network Integration Kit, which is available from Microsoft.
<P>
<P><h3>ROUTING BETWEEN LANS</h3>
 
<P>
Windows for Workgroups workstations must reside on the same physical
LAN segment in order to make use of the Windows for Workgroups mail,
scheduling, file-sharing, and print-sharing features. Windows for
Workgroups does not use VINES routing capabilities.
<P>
<P><h3>LOADING VINES INTO THE HIGH MEMORY AREA</h3>
 
<P>
You can use memory managers to load VINES software components into the
high memory area (HMA). Refer to your specific memory manager
documentation for instructions on how to do this.
<P>
<P>
<P><h2>TROUBLESHOOTING TIPS</h2>
 
<P>
This section provides solutions to some common problems you may
encounter when running Windows for Workgroups on a Banyan VINES
network.
<P>
<P><h3>ENVIRONMENT VARIABLES OVERWRITTEN</h3>
 
<P>
When you install VINES support for Windows for Workgroups, the VINES
LOGIN command is placed near the beginning of your AUTOEXEC.BAT file.
PATH (and other environment variables) in your VINES user profile are
overwritten by the environment variables in your AUTOEXEC.BAT file.
<P>
To work around this problem, either place all environment variables,
including PATH, in your user profile only, or place all environment
variables AFTER the LOGIN command in your AUTOEXEC.BAT file. If you
want to add the user profile PATH environment variable to the PATH
environment variable in your AUTOEXEC.BAT file, type %path% after the
LOGIN command at the end of your AUTOEXEC.BAT file. For example, the
following statement appends the user profile PATH values (%path%) to
the existing PATH values (C:\;C:\WINWG) in the AUTOEXEC.BAT file:
<P>
<PRE>   Path=c:\;c:\winwg;%path%

</PRE><h3>CANNOT ACCESS THE VINES NETWORK</h3>
 
<P>
If you cannot access the VINES network, make sure the SYSTEM.INI file
includes the following lines:
<P>
<PRE>   network.drv=wfwnet.drv
   secondnet.drv=VINES.DRV

</PRE>In a Windows for Workgroups environment, the NETWORK.DRV statement
specifies the Windows for Workgroups network driver (WFWNET.DRV) and
the SECONDNET.DRV statement specifies the VINES network driver
(VINES.DRV).
 
<P>
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/wg0772.exe">WG0772.EXE</A> <I>(size: 583596 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/wg0772.exe">WG0772.EXE</A> <I>(size: 583596 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/wg0772.exe">WG0772.EXE</A> <I>(size: 583596 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/wg0772.exe">WG0772.EXE</A> <I>(size: 583596 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>If you are unable to access the source(s) listed above, you can
   have this Application Note mailed or faxed to you by calling
   Microsoft Product Support Services Monday through Friday, 6:00 A.M.
   to 6:00 P.M. Pacific time at (425) 637-7098. If you are outside the
   United States, contact the Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother kbfile kbappnote<BR>
KBSubcategory: wfw<BR>
Additional reference words: appnote win31 3.10 3.1 wfwg bvines<BR>
Keywords            : wfw kbappnote kbfile kbother<BR>
Version             : 3.10<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
