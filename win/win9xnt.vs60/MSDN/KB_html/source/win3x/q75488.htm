

<HTML>
<HEAD>
<TITLE>Floppy Disk Drive Problems in 386 Enhanced Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75488 ">
<META NAME="KBModify" CONTENT="1995/07/26">
<META NAME="KBCreate" CONTENT="1991/08/22">
<META NAME="Keywords" CONTENT="kbtshoot kbhw kbdisplay">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  If you are experiencing errors reading, writing, or formatting floppy disk drives while running Windows in 386 enhanced mode, follow the steps listed below to troubleshoot and resolve the problem.  WORKAROUND   1. Exit Windows.   2. To determine wh...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QABI,QANE,QAKR,QAHE,QDL9,QBWO,QBWN,QABH,QBWQ,QAEF,QABA,QBXS,QDIO,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Floppy Disk Drive Problems in 386 Enhanced Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 26, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75488 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a, 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you are experiencing errors reading, writing, or formatting floppy disk
drives while running Windows in 386 enhanced mode, follow the steps listed
below to troubleshoot and resolve the problem.
<P>
<P><h2>WORKAROUND</h2>
 

<OL><P><LI>Exit Windows.

<P><LI>To determine whether your system is reading the floppy disk directory,
    insert a disk in drive A, and type the following at the MS-DOS command
    prompt:
<P>
       dir a:
<P>
    NOTE: If you remove the disk from drive A and type "dir a:" (without
    the quotation marks) and the directory lists again, it is an indication
    of an improper CMOS version or incorrect hardware setup (for example, a
    3.5-inch drive on a jumper for an XT computer).

<P><LI>To determine whether your system writes to the floppy disk drive, type
    the following at the MS-DOS command prompt
<P>
       copy &lt;filename&gt; a:
<P>
    where &lt;filename&gt; is any valid file on your hard disk.
<P>
    If the commands in steps 2 and 3 do not work, the problem is at the
    MS-DOS level.

<P><LI>Restart your computer using the minimum information in your
    AUTOEXEC.BAT file and CONFIG.SYS file that your computer needs to start
    up. For more information about how to do this, query on the following
    words in the Microsoft Knowledge Base:
<P>
       troubleshooting and autoexec.bat and config.sys and files
<P>
    NOTE: Anti-Virus software commonly causes this problem.

<P><LI>Does the floppy disk drive read problem go away when you run Windows
    in standard mode or real mode? To test this, start Windows by
    typing the following at the MS-DOS command prompt:
<P>
       win /s
<P>
    If everything works correctly in Windows, you know that the problem
    is related only to running Windows in 386 enhanced mode.
<P>
    If the problem is specifically related to 386 enhanced mode, you may be
    loading SYMEVNT.386 from Norton Utilities 8.0. For more information
    about SYMEVNT.386, query in the Microsoft Knowledge Base on the
    following words:
<P>
       symevnt.386 and norton
<P>
    If the problem is specifically related to 386 enhanced mode but you are
    not loading SYMEVNT.386, using the switches below may lessen the
    problem. Add these switches to the SYSTEM.INI file in the [386Enh]
    section in the order shown. If you find one of the switches works, you
    can try removing previous switches that had no effect. Note that the
    switches listed in item (b) should be added or removed as a pair. (See
    the MORE INFORMATION section of this article for an explanation of
    these switches.)
<P>
    a. IRQ9GLOBAL=YES
<P>
    b. HIGHFLOPPYREADS=NO
       EMMEXCLUDE=E000-EFFF
<P>
    c. VirtualHDIrq=OFF

<P><LI>Insert a semicolon (;) before the Load= and Run= lines in the WIN.INI
    file to ensure that nothing else is being loaded that could cause a
    problem.

<P><LI>Check to see if you can successfully issue commands in Windows at
    the MS-DOS command prompt. If commands work at the MS-DOS level, it
    indicates a BIOS or hard disk drive/floppy controller BIOS problem.

<P><LI>Is the floppy disk drive icon displayed in File Manager? If not, check
    your BIOS version and contact your hardware manufacturer for an update.

<P><LI>Disable any BIOS and video shadowing. Each computer may have a
    different way of disabling its shadowing. You will need to check your
    system documentation and follow the instructions provided there to
    perform this task.

<P><LI>Check for third-party or external floppy disk drivers.

<P><LI>Check the type and version of MS-DOS. MS-DOS versions earlier than
    3.3 do not support 1.44-MB drives.

<P><LI>Check for hardware devices that may be using the same IRQ as the floppy
    disk drive controller. (By default, the floppy disk drive controller
    uses IRQ 6.)

<P><LI>Check to see if an IDE ATIO card is in use. This is an integrated card
    that contains a game port, serial port, parallel port, IDE, and floppy
    disk drive controller. Remove this card and insert a card that has only
    the IDE floppy disk drive controller on it.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The following paragraphs explain the switches used in step 5 above.
<P>
<P><h3>IRQ9Global=&lt;boolean&gt;</h3>
 
<P>
Default:  No
Purpose:  If enabled, this switch converts IRQ9 masks to global. Enable
<PRE>          this setting if your system stops responding (hangs) when
          accessing a floppy disk drive, or make sure your system accesses
          the floppy disk drive before you start Windows.

</PRE></OL><h3>HighFloppyReads=&lt;boolean&gt;</h3>
 
<P>
Default: Yes
Purpose: Normally, Windows turns a DMA verify to the area E000:0000-
<PRE>         EFFF:FFFF into a read. In rare cases, this might cause the system
         to fail because some software might, as a result, write over the
         system's shadow RAM if you have it in this area. If this happens,
         disable this setting and set EMMExclude to E000-EFFF.

</PRE><h3>EMMExclude=&lt;paragraph-range&gt;</h3>
 
<P>
Default:  None
Purpose:  Specifies a range of memory that Windows will not scan to find
<PRE>          unused address space. This has the side effect of turning off the
          RAM and ROM search code for the range. The range (two paragraph
          values separated by a hyphen) must be between A000 and EFFF. This
          scanning can interfere with some adapters that use the same
          memory area. The starting value is rounded down and the ending
          value is rounded up to a multiple of 16K. For example, you could
          set EMMExclude=C800-CFFF to prevent Windows from scanning the
          addresses C800:0000 through CFFF:000F. You can specify more than
          one range by including more than one EMMExclude line.

</PRE><h3>VirtualHDIrq=&lt;boolean&gt;</h3>
 
<P>
Default:  On
<P>
Purpose: If enabled, Windows in 386 enhanced mode can terminate interrupts
<PRE>         from the hard disk controller, bypassing the ROM routine that
         handles these interrupts. Some hard disk drives may require this
         setting to be disabled for interrupts to be processed correctly.
         If this setting is disabled, the ROM routine handles the
         interrupts, which slows down system performance.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtshoot kbhw kbdisplay<BR>
KBSubcategory: win30 win31<BR>
Additional reference words: tshoot 3.00 3.00a 3.10 3.11 central point<BR>
norton format<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 26, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
