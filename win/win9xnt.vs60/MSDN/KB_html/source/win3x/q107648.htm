

<HTML>
<HEAD>
<TITLE>Using Novell's ODINSUP with VLM.EXE and WFWG 3.11 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107648">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1993/11/23">
<META NAME="Keywords" CONTENT="wfw wfwg kb3rdparty kbnetwork kbtlc kbusage">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" This article contains information about using Windows for Workgroups with third-party products or configurations that have not been tested and are not supported by Microsoft.  If the steps or procedures described in this article do not function prop...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBFY,QAVZ,QAU9,QDL9,QBWN,QAIB,QAA1,QBWQ,QDI2,QA8Y,QBXT,QA5V,QAIA,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Novell's ODINSUP with VLM.EXE and WFWG 3.11</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107648</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.11
WINDOWS
kbnetwork kb3rdparty kbusage kbtlc
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
This article contains information about using Windows for Workgroups with
third-party products or configurations that have not been tested and are
not supported by Microsoft.
<P>
If the steps or procedures described in this article do not function
properly, use a supported configuration or contact the manufacturer of the
third-party product for more information.
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Novell ODINSUP driver allows NDIS 2 protocols (such as MS TCP/IP) to
run on top of Novell ODI drivers. This is similar to the behavior of the
MSODISUP driver that comes with Windows for Workgroups 3.11. The difference
is that the MSODISUP driver allows only NDIS 3 protocols to run on top of
it.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following instructions assist you in setting up Windows for Workgroups
3.11 to run on the Novell ODINSUP driver with NetWare clients that are
using Novell's VLM.EXE redirector. By doing this, you can use NDIS 2
protocols (such as MS TCP/IP and MS DLC) to run on top of the Novell ODI
drivers. The steps below outline setting up Windows for Workgroups 3.11
with the MS TCP/IP, NetBEUI, and NWLink protocols in addition to Novell's
real-mode IPX protocol. The network card used throughout this article is
the 3COM1 3c509 Etherlink III.
<P>
<P><h3>Before You Begin</h3>
 
<P>
You should run the Novell NetWare 4.0 client installation program and
have a working NetWare 4.0 client. You should also set up a working
Net.cfg file in the same directory from which you load LSL.COM.
<P>
By default, NetWare 4.0 loads the network drivers in a Startnet.bat file
and then "calls" this file from the Autoexec.bat file. Be sure to back up
this file along with your Autoexec.bat file so that you can restore this
configuration later if necessary.
<P>
<P><h3>Setup Instructions</h3>
 

<OL><P><LI>Install Windows for Workgroups using the Custom Setup option. In the
   Network Setup dialog box, select the Other option button, select
   Novell, and then choose the Drivers button. Select the network card
   driver for your adapter along with both the NetBEUI and the "IPX/SPX
   Compatible Transport with NetBIOS" protocols. (For the examples in this
   article, we chose the Etherlink III network card.) Next, in the same
   Network Drivers dialog box, choose Setup and select Real Mode NDIS
   Driver. This is important because even though you are actually running
   on an ODI driver with ODINSUP, Windows for Workgroups thinks you are
   running an NDIS driver. Choose OK and continue with Setup. Ignore the
   error messages about ODI drivers. After you finish Setup, you reboot
   your computer and start Windows by using the /N switch (WIN /N), then
   install MS TCP/IP according to the directions that come with the
   package.
<P>
   NOTE: If there are any other NDIS 2 protocols (such as MS DLC) you want
   to install, install them now. Also, make sure that you choose which
   protocol you want to be the default protocol in the Network Drivers
   dialog box.

<P><LI>After completing MS TCP/IP setup, edit the System.ini file and remove
   the NDIS 2 driver, &lt;ELNK3.DOS&gt;, from the netcard= line of the [Network
   Drivers] section.
<P>
   NOTE: If you are using a different network card, the NDIS network card
   driver (&lt;ELNK3.DOS&gt; in the above example) will be different.

<P><LI>Edit the Config.sys file and set LASTDRIVE=Z. This allows you to
   connect all available drive letters to both NetWare and Windows for
   Workgroups servers.

<P><LI>If you are using a STARTNET.BAT file, remove the NET START line from
   the Autoexec.bat file and then edit the STARTNET.BAT file so that it
   contains the following network-related lines. If you are not using a
   STARTNET.BAT file, put these lines in your Autoexec.bat file.
<P>
<P><PRE>      SET NWLANGUAGE=ENGLISH
      C:\WINDOWS\NET INIT (This loads protman and NDIS protocols.)
      C:\&lt;PATH&gt;\LSL.COM
      C:\&lt;PATH&gt;\&lt;your network card's ODI MAC driver&gt;.COM
      C:\&lt;PATH&gt;\ODINSUP.COM
      C:\WINDOWS\NET START NETBIND (This binds the protocols to ODINSUP.)
      C:\&lt;PATH&gt;\IPXODI.COM
      C:\&lt;PATH&gt;\VLM.EXE
<PRE></PRE>          (The rest of these files are for MS TCP/IP.)
      C:\WINDOWS\UMB
      C:\WINDOWS\TCPTSR
      C:\WINDOWS\TINYRFC
      C:\WINDOWS\NMTSR.EXE
      C:\WINDOWS\EMSBFR.EXE

</PRE><P><LI>Edit the Net.cfg file and verify that it contains the following lines.
   If these lines don't exist, add them to the appropriate sections of the
   Net.cfg file. If you do not have a Net.cfg file, create one using a
   text editor (such as Microsoft Windows Notepad), and save it in the
   directory from which LSL.COM is executed. Note that some of the lines
   in the Net.cfg file are indented; this indentation must be maintained.
<P>
<P><PRE>      PB BUFFERS 7
      PROTOCOL ODINSUP
<PRE></PRE>         BIND &lt;3c509&gt; (where &lt;3c509&gt; is the filename of your network
                        card's ODI driver)
         BUFFERED
      LINK DRIVER &lt;3c509&gt; (where &lt;3c509&gt; is the filename of your network
                        card's ODI driver)
         INT &lt;n&gt; (where &lt;n&gt; is the one-digit interrupt number)
         MEM &lt;nnnnn&gt; (where &lt;nnnnn&gt; is the five-digit memory address)
         PORT &lt;nnn&gt; (where &lt;nnn&gt; is the three-digit I/O port address)
         FRAME ETHERNET_802.2
         FRAME ETHERNET_802.3
         FRAME ETHERNET_II
         FRAME ETHERNET_SNAP
         PROTOCOL IPX 0 ETHERNET_802.3
   First Network Drive = F

   NOTE: If you've been using ODI to attach to a Novell server at DOS and
   you haven't specified the parameters INT, MEM, PORT, DMA, SLOT, and so
   forth in the Net.cfg file, you probably don't need to add them now.
   However, depending on the ODI MAC driver you are using (Novell refers to
   this as the "MLID"), you may need to place these parameters after the
   FRAME lines. Additionally, list your network's frame type FIRST in the
   list of "FRAME ETHERNET_&lt;xxxx&gt;" entries (where &lt;xxxx&gt; will probably be
   &lt;802.2&gt;, &lt;802.3&gt;, or &lt;II&gt;).

</PRE><P><LI>Edit the Protocol.ini file by replacing the BINDINGS= lines in the
   [NWLINK], [NETBEUI], [MS$NDISHLP], and [TCPIP] sections with the Novell
   ODI MAC driver (MLID) as follows:
<P>
<P><PRE>      [NWLINK]
      ;BINDINGS=&lt;MS$ELNK3&gt; (where &lt;MS$ELNK3&gt; corresponds to your NDIS MAC
<PRE></PRE>                            driver; in this case, ELINK3.DOS. The semicolon
                            comments out this line.)
      BINDINGS=&lt;x3c509&gt; (where &lt;x3c509&gt; corresponds to your ODI MLID;
                         in this case, 3c509.COM. The "x" must be
                         added if the ODI MLID filename begins with a
                         numeral.)

      [NETBEUI]
      ;BINDINGS=&lt;MS$ELNK3&gt; (where &lt;MS$ELNK3&gt; corresponds to your NDIS MAC
                            driver; in this case, ELINK3.DOS. The semicolon
                            comments out this line.)
      BINDINGS=&lt;x3c509&gt; (where &lt;x3c509&gt; corresponds to your ODI MLID;
                        in this case, 3c509.COM. The "x" must be
                         added if the ODI MLID filename begins with a
                         numeral.)
      LANABASE=0
      SESSIONS=10
      NCBS=12
      DriverName=netbeui$

      [MS$NDISHLP]
      DriverName=ndishlp$
      ;BINDINGS=&lt;MS$ELNK3&gt; (where &lt;MS$ELNK3&gt; corresponds to your NDIS MAC
                            driver; in this case, ELINK3.DOS. The semicolon
                            comments out this line.)
      BINDINGS=&lt;x3c509&gt; (where &lt;x3c509&gt; corresponds to your ODI MLID;
                         in this case, 3c509.COM. The "x" must be
                         added if the ODI MLID filename begins with a
                         numeral.)

      [TCPIP]
      IPAddress0=&lt;130 25 40 20&gt; (where &lt;130 25 40 20&gt; corresponds to your
                                 own IP addresses.)
      DefaultGateway0=130 25 0 1
      SubNetMask0=255 255 0 0
      NBSessions=6
      NetFiles=C:\WINDOWS
      DriverName=TCPIP$
      ;BINDINGS=&lt;MS$ELNK3&gt; (where &lt;MS$ELNK3&gt; corresponds to your NDIS MAC
                            driver; in this case, ELINK3.DOS. The semicolon
                            comments out this line.)
      BINDINGS=&lt;x3c509&gt; (where &lt;x3c509&gt; corresponds to your ODI MLID;
                        in this case, 3c509.COM. The "x" must be
                        added if the ODI MLID filename begins with a
                        numeral.)
      LANABASE=2

   NOTE: If you are using the Microsoft 32-bit TCP/IP dated 11/21/94, you
   must change the "bindings=" setting in the network card section of the
   System.ini file to match the ODI MLID name, ensure ethernet_II appears
   in the frame listings in the Net.cfg file, and make the following
   changes to the System.ini file:

   [MS$ELNK3]
   IPMask=0.0.0.0
   IPAddress=0.0.0.0
   Description=3com Etherlink III
   ;BINDINGS=&lt;MS$ELNK3&gt; (where &lt;MS$ELNK3&gt; corresponds to your NDIS MAC
                         driver; in this case, ELINK3.DOS. The semicolon
                         comments out this line.)
   BINDINGS=&lt;x3c509&gt; (where &lt;x3c509&gt; corresponds to your ODI MLID;
                            in this case, 3c509.COM. The "x" must be
                            added if the ODI MLID filename begins with a
                            numeral.)

   IMPORTANT: If the ODI MLID filename begins with a numeral, you must
   preface the filename with an "x" (without the quotation marks) in the
   BINDINGS= statement. For example, the 3COM 3C509 network adapter card
   uses an ODI MLID with the filename 3C509.COM. In the Protocol.ini file,
   the BINDINGS= statements would need to be:

      BINDINGS=x3C509

   WARNING: After you make these modifications, do NOT make any changes in
   the Networks dialog box of Control Panel. If you do, the Autoexec.bat,
   System.ini and Protocol.ini files will be overwritten. You should make
   backup copies of these files in case this occurs.


</PRE></OL><h2>EXAMPLES</h2>
 
<P>
Below are samples of what modified Config.sys, Autoexec.bat, Net.cfg, and
Protocol.ini files look like if you are using Novell's ODINSUP with Windows
for Workgroups 3.11 Setup with the MS TCP/IP, NetBEUI, and "IPX/SPX
Compatible Transport with NetBIOS" protocols.
<P>
<P><h3>Config.sys</h3>
 
<P>
DEVICE=C:\WINDOWS\HIMEM.SYS
DOS=HIGH
BUFFERS=30
FILES=50
DEVICE=C:\DOS\SETVER.EXE
SHELL=C:\DOS\COMMAND.COM C:\DOS\  /p /e:2048
STACKS=9,256
LASTDRIVE=Z
DOS=HIGH
DEVICE=C:\WINDOWS\IFSHLP.SYS
<P>
<P><h3>Autoexec.bat</h3>
 
<P>
C:\WINDOWS\NET INIT
C:\NOVELL\LSL
C:\NOVELL\3C509
C:\NOVELL\ODINSUP
C:\WINDOWS\NET START NETBIND
C:\NOVELL\IPXODI
C:\NOVELL\VLM
C:\WINDOWS\UMB
C:\WINDOWS\TCPTSR
C:\WINDOWS\TINYRFC
C:\WINDOWS\NMTSR.EXE
C:\WINDOWS\EMSBFR.EXE
PATH=C:\WINDOWS;C:\DOS;C:\
SET TEMP=C:\TEMP
C:\WINDOWS\SMARTDRV.EXE /X
<P>
<P><h3>Net.cfg</h3>
 
<P>
SHOWDOTS=ON
PB BUFFERS 7
PROTOCOL ODINSUP
<PRE>   BIND 3c509
   BUFFERED
</PRE>LINK DRIVER 3c509
<PRE>   port 300
   int 5
   frame ethernet_802.3
   frame ethernet_802.2
   frame ethernet_II
   frame ethernet_SNAP
   PROTOCOL IPX 0 ETHERNET_802.3
</PRE>First Network Drive = F
<P>
<P><h3>Protocol.ini</h3>
 
<P>
[network.setup]
version=0x3110
netcard=ms$elnk3,1,MS$ELNK3,1
transport=ms$nwlinknb,NWLINK
transport=ms$netbeui,NETBEUI
transport=ms$ndishlp,MS$NDISHLP
transport=tcpip,TCPIP
lana0=ms$elnk3,1,ms$netbeui
lana1=ms$elnk3,1,ms$nwlinknb
lana2=ms$elnk3,1,ms$ndishlp
lana3=ms$elnk3,1,tcpip
<P>
[MS$ELNK3]
DriverName=ELNK3$
MAXTRANSMITS=6
<P>
[NWLINK]
BINDINGS=x3C509
<P>
[NETBEUI]
BINDINGS=x3C509
LANABASE=0
SESSIONS=10
NCBS=12
DriverName=netbeui$
<P>
[protman]
DriverName=PROTMAN$
PRIORITY=MS$NDISHLP
<P>
[MS$NDISHLP]
DriverName=ndishlp$
BINDINGS=x3C509
<P>
[TCPIP]
DefaultGateway0=130 25 0 1
SubNetMask0=255 255 0 0
IPAddress0=130 25 40 20
NBSessions=6
NetFiles=C:\WINDOWS
DriverName=TCPIP$
BINDINGS=x3C509
LANABASE=2
<P>
For additional information concerning Novell's ODINSUP.COM, contact
Novell Technical Support or on the Novell CompuServe forums.
<P>
The third-party products discussed here are manufactured by a vendor
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kb3rdparty kbusage kbtlc<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: 3.11<BR>
Keywords          : wfw wfwg kb3rdparty kbnetwork kbtlc kbusage<BR>
Version           : 3.11<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
