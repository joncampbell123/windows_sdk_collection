

<HTML>
<HEAD>
<TITLE>How to Troubleshoot WFWG Network Connection Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104322">
<META NAME="KBModify" CONTENT="1995/12/18">
<META NAME="KBCreate" CONTENT="1993/09/13">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty kbtshoot kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  In a Microsoft Windows for Workgroups version 3.1 or 3.11 network, hardware- and software-related problems can cause one or more computers to lose the ability to browse or communicate with other computers. These problems range from no network funct...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAVZ,QA05,QAVW,QAVX,QDIO,QBTX,QABI,QAQW,QAKP,QAIJ,QAA1,QAB4,QDL9,QBWQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Troubleshoot WFWG Network Connection Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104322</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In a Microsoft Windows for Workgroups version 3.1 or 3.11 network, hardware-
and software-related problems can cause one or more computers to lose the
ability to browse or communicate with other computers. These problems range
from no network functionality at all to random errors when transmitting
data across the network.
<P>
This article provides troubleshooting steps that you can use to diagnose
and resolve workstation communication problems in a Windows for Workgroups
network. Note that troubleshooting communication problems is not always a
straight-forward process. If one of the procedures outlined below doesn't
work, go on to the next until the problem is fixed. To increase your
knowledge of the major issues, you may want to read this entire article
before you proceed. (This may also reduce the time needed to solve the
problem.)
<P>
<P><h2>BEFORE YOU BEGIN</h2>
 
<P>
Before proceeding with the troubleshooting steps, consider the
following:

<UL><LI>Has this configuration ever worked before, or did this just start
   happening? If it just started, what has changed between the time this
   configuration was working and the time it stopped working?

<LI>Has new hardware, cabling, or software been added? If this new
   addition is removed, does the problem go away?

<LI>Is this problem occurring on one computer, several, or all of them?
   If the problem is happening on all computers, it may be cabling or
   connector related. If the problem is happening on only one or a few
   computers, it may be software or hardware related.

<LI>Is the connection to the computer active? (If the card has transmit/
   receive data lights, are they blinking?)
<P>
</UL>IMPORTANT: Make backup copies of the following system configuration
files before doing any troubleshooting:
<P>
<PRE>   CONFIG.SYS
   AUTOEXEC.BAT
   PROTOCOL.INI
   SYSTEM.INI
   WIN.INI

</PRE><h2>TROUBLESHOOTING STEPS</h2>
 
<P>
<P><h3>Check Setup and Startup</h3>
 

<OL><P><LI>Check for any error messages while the computer is booting. To
   prevent error messages from scrolling off the screen, place a PAUSE
   statement at the beginning and the end of your AUTOEXEC.BAT file.

<P><LI>Verify that the computer you are trying to view is in 386 enhanced
   mode and has sharing enabled. To check this, open Control Panel,
   choose Network, and make sure the Sharing Enabled box is selected.

<P><LI>If this is a new network (that is, another network was NOT  previously
   used), verify that the network card settings in the Network dialog box
   of Control Panel are correct.
<P>
   If Windows for Workgroups was installed over Windows 3.1 and another
   network (such as Novell NetWare), it is possible that the Windows for
   Workgroups Setup program did not detect the previous network, which may
   be conflicting with Windows for Workgroups. You probably need to remove
   changes the previous network made to Windows configuration files
   (primarily the SYSTEM.INI file).

<P><LI>Run CHKDSK on the drive where Windows is installed. If Windows
   system files are corrupted, Windows is unstable and may need to be
   reinstalled. If CHKDSK shows errors, repair the errors by running
   CHKDSK with the /F parameter or by using a disk utility to repair the
   files on the hard disk drive. If there is data corruption, it may be
   necessary to reinstall Windows for Workgroups.

<P><LI>Clean boot each computer (that is, load only those drivers necessary to
   start the computer). For more information about performing a clean boot,
   query on the following words in the Microsoft Knowledge Base:
<P>
<P><PRE>      wfwg and clean boot
</PRE><P>
</OL><h3>Browse Other Machines</h3>
 
<P>
Attempt to view other computers on the network in File Manager. Choose the
Connect Net Drive button or choose Connect Net Drive from the Disk menu,
and type the computer name preceded by two backslashes, for example
<P>
<PRE>   \\&lt;computername&gt;

</PRE></OL>in the Path box, and then press ENTER.
<P>
If you can view other computers on the network by manually entering
computer names but you cannot view these computers during normal
operations, consider the following possible causes:

<UL><LI>A "browse server" may not have been selected on the network. In
   Windows for Workgroups, a computer that maintains a list of Workgroups
   servers is selected. Sometimes this takes from 5 to 15 minutes to
   establish. If no browse server exists, you cannot browse servers on
   the network. Wait a few minutes and try again.
<P>
   If the local workstation name (but no other computer name) appears in
   the Show Shared Directories On dialog box, the network card is
   probably configured correctly, but the problem may be in the network
   cabling or the other computer's network card configuration.
<P>
</UL>The following possible cause applies to only Windows for Workgroup version
3.1 (all previous and following information applies to Windows for
Workgroup version 3.1 and 3.11):

<UL><LI>The entry for VBROWSE.386 may not be on the network= line in the
   [386Enh] section of the SYSTEM.INI file, or VBROWSE.386 may be missing
   from the Windows SYSTEM directory, or VBROWSE.386 may be corrupted. If
   the network= line is missing, use a text editor (such as Windows
   Notepad) to add the following to the [386Enh] section of the
   SYSTEM.INI:
<P>
<P><PRE>      network=VBROWSE.386
</PRE><P>
   If necessary, reinstall the VBROWSE.386 file in the Windows SYSTEM
   subdirectory.
<P>
</UL><h3>Check Cabling</h3>
 
<P>
Make sure the network cabling is connected to both the computer you are
using AND the computer you are trying to communicate with. Most network
problems are caused by faulty cabling and/or connectors.
<P>
Check the cabling and connectors on each workstation. If the network is
using Thin Ethernet, connect two computers with a single cable, T-
connectors, and terminators that are known to work properly. If the network
is using twisted-pair (RJ-45) cable, you must use a HUB or concentrator.
Windows for Workgroups does not support direct connections of RJ-45 cable
between computers. This check isolates possible cabling and/or connector
problems that may not be clearly visible.
<P>
NOTE: It may also be necessary to reroute network cabling away from sources
of electrical interference (such as fluorescent lights).
<P>
If the network topology is 10Base2 (Thin Ethernet or Thinwire), place a 50
Ohm terminator on the network card. If the local computer name now appears
in the Show Shared Directories On dialog box (but not when the regular
cabling is attached), some type of cabling and/or connector problem exists.
Examples include an electrical short in the cabling, improper termination,
and using the wrong type of cabling. Check to ensure that each computer's T-
connector is secured on each network card, that 50 Ohm terminators are at
each end of the network, and that RG-58 cabling (not RG-59 or RG-62) is
being used.
<P>
If the local computer name does not appear in the Show Shared Directories
On dialog box, the problem is with the local network card's configuration
(either hardware or software). (Refer to "Test the Network Card," later in
this article.)
<P>
If your wiring is 10Base2 (Thin Ethernet), a quick test to see if the
cabling is the problem is to remove the T-connector and place a terminator
directly on the BNC connector on the network card. If doing so causes the
machine to be able to "see itself" in File Manager, the problem is most
likely with the existing cabling.
<P>
If placing a terminator on the network card doesn't identify the problem
(or your cabling is other than 10Base2), try the following steps:

<OL><P><LI>Change the IRQ and/or I/O address that the network card is using.
   To do so with software-configurable network cards:
<P>
   a. Open Control Panel, then choose the Network icon.
<P>
   b. Choose Adapters, then choose Setup.
<P>
   c. Select a different IRQ and/or I/O address. You may need to try
<P><PRE>      several selections if you do not know what your other hardware is
      configured to use.
</PRE>
<P><LI>Reinstall the network card drivers as follows:
<P>
   a. Clean boot your system. To do this, remove the Windows for
<P><PRE>      Workgroups network drivers and any unnecessary entries from the
      CONFIG.SYS and AUTOEXEC.BAT files. For more information about a clean
      boot, query on the following words in the Microsoft Knowledge Base:
</PRE><P>
<PRE>         wfwg and clean boot

   b. Rename the PROTOCOL.INI file, which is usually in the Windows
      directory unless you are using disk-compression software. If disk-
      compression software (such as SuperStor) is used, the PROTOCOL.INI
      file should be in the root directory.

   c. Restart the computer and start Windows for Workgroups. You will
      receive at least one error message about the network drivers being
      loaded; this is to be expected.

   d. In Control Panel, choose Network, then choose Adapters. The list of
      Currently Installed Adapters should be blank. Choose Add and select
      your network card from the list that appears.

      NOTE: If the network card is hardware-configurable (with jumpers or
      DIP switches), the settings on this screen need to match the actual
      settings of the jumpers or switches on the card, unless they say
      "Automatic or unused."

      If the card is software-configurable, you may need to select a
      different IRQ, I/O Address, or RAM Address to resolve a connectivity
      problem. For example, some disk controllers come configured using
      I/O 300h, which is also the default for some network cards.

   e. Restart the computer and attempt to communicate with other
      computers on the network as described in "Browse Other Machines"
      above.

</PRE><P><LI>Check the SYSTEM.INI file for the following lines and remark them
   out if they exist. To remark out a line from the SYSTEM.INI file,
   place a semicolon (;) at the beginning of the line.
<P>
<P><PRE>      InDOSPolling=True
      TimerCriticalSection=&lt;any value&gt;
      V86ModeLanas=&lt;any value&gt;
</PRE>
<P><LI>Rebuild the Windows startup files (WIN.INI and SYSTEM.INI). For
   more information about rebuilding the SYSTEM.INI file, query on the
   following words in the Microsoft Knowledge Base:
<P>
<P><PRE>      system.sr_ and wfw
</PRE><P>
   To rebuild the default WIN.INI file, expand WIN.SR_ from Windows for
   Workgroups Disk 3. To do this, place Disk 3 in a floppy disk drive,
   type the following, and press ENTER:
<P>
<P><PRE>      c:\windows&gt;expand x:win.sr_ -r
</PRE><P>
</OL>If Windows for Workgroups is still not working after you complete the steps
above, and it has worked previously, the next step is to reinstall Windows
for Workgroups in another directory.
<P>
Reinstalling Windows for Workgroups in a clean directory should restore the
configuration to the point at which it was working when first installed.
When you start the Windows for Workgroups Setup program, choose Custom
Setup, and enter a new directory name, such as C:\WFWTEST.
<P>
If Windows for Workgroups still is not working correctly, it is most likely
that some type of problem with your cabling, connectors, or network card
exists.
<P>
<P><h3>Test the Real Mode Redirector</h3>
 
<P>
The following test uses the Windows for Workgroups network components to
generate a NetBIOS name conflict on the network (each computer must have a
unique computer name on the network). To do this test, set two computers to
the same computer name and check to see if an error message is generated.
If an error message is displayed, the computers are communicating. If no
error occurs, a hardware problem exists on the network.

<OL><P><LI>To change the computer name, do one of the following:
<P>
<P><PRE>    - Change the value for Computername in the Network dialog box of
      Control Panel.
</PRE><P>
   -or-
<P>
<P><PRE>    - Edit the SYSTEM.INI file and change the setting for ComputerName=
      in the [Network] section to the name of another computer.
</PRE>
<P><LI>Reboot the computer, then start the real mode redirector by typing the
   following at the MS-DOS command prompt:
<P>
<P><PRE>      net start workstation
</PRE>
<P><LI>The following error should appear:
<P>
<P><PRE>      LANA 0 reported error 52: A duplicate workgroup or computer name
      exists on the network.
      For information about LANA numbers, type NET HELP 3280.
</PRE><P>
   If the error message is displayed, the two computers are communicating.
<P>
   If the error message is not displayed, a hardware problem exists with
   one or more of the following:
<P>
<P><PRE>    - The network card configuration is incorrect on one or more of the
      computers (hardware, input/output, IRQ, UMB conflict, and so on).
</PRE><P>
<P><PRE>    - One or more of the network cards is malfunctioning.
</PRE><P>
<P><PRE>    - There is some problem with the cabling or connectors. This could
      be an electrical short; interference; or a cable, connector, or
      terminator that is not the correct specification for your network.
</PRE><P>
   To troubleshoot shorts and interference problems, either test the
   cabling with a testing device, or replace it with cables and
   connectors that are known to work correctly.
<P>
   For more information about cable and connector specifications,
   query on the following words in the Microsoft Knowledge Base:
<P>
<P><PRE>      wfw and lan and cable and specifications
</PRE>
<P><LI>Change the computer name back to its original, unique name.

<P><LI>Restart the computer. Start the real mode redirector by typing the
   following at the MS-DOS command prompt:
<P>
<P><PRE>      net start workstation
</PRE>
<P><LI>Try to view another computer (which must be in Windows for Workgroups
   386 enhanced mode) by typing the following:
<P>
<P><PRE>      net view \\&lt;computername&gt;
</PRE><P>
   If you can communicate with other computers using the real mode
   redirector, the problem may be related to an upper memory block (UMB)
   conflict, a hardware conflict, or a virtual device driver (VxD) that
   is interfering with Windows for Workgroups.

<P><LI>If you can view another computer's shared resources using the real mode
   redirector, type the following to stop the real mode redirector:
<P>
<P><PRE>      net stop
</PRE><P>
</OL>If the problem still occurs, use the WIN /D:X switch, as described in
the next section.
<P>
<P><h3>Use the WIN /D:X Switch</h3>
 

<OL><P><LI>Start Windows for Workgroups by typing the following at the MS-DOS
   command prompt:
<P>
<P><PRE>      win /d:x
</PRE>
<P><LI>Try to view other computers in File Manager.
<P>
   If using the WIN /D:X switch corrects the problem, the network card's
   memory address needs to be excluded with a UMB provider (such as
   EMM386.EXE) or by adding an "EMMEXCLUDE=memoryaddress" (without the
   quotation marks) to the [386Enh] section of the SYSTEM.INI file. For
   example, if your network uses a UMA address from C800-CFFF, add the
   following line to the [386Enh] section of your SYSTEM.INI file:
<P>
<P><PRE>      EMMExclude=C800-CFFF
</PRE><P>
   If using WIN /D:X doesn't allow you to view any other computers in
   File Manager, but you could view other computers when you quit Windows
   and started the real mode redirector, the problem may be caused by one
   of the following:
<P>
   - An IRQ, DMA channel, I/O, or RAM address conflict exists between
<P><PRE>     the network card and another hardware device.
</PRE><P>
<P><PRE>     -or-
</PRE><P>
   - The settings in the Network dialog box of Control Panel do not match
<P><PRE>     the actual hardware settings on the network card.
</PRE><P>
</OL><h3>Change the Network Card Settings</h3>
 
<P>
To change the IRQ, DMA, I/O, and/or RAM address settings, proceed as
follows:

<OL><P><LI>Open Control Panel, and choose the Network icon.

<P><LI>Choose Adapters, then choose Setup.

<P><LI>Select a different setting (or the actual hardware setting) for your
   network card.

<P><LI>With some network cards, you must also change jumpers or switch
   settings on the card to match the settings in Control Panel. For
   information about configuring jumpers and switches on your network
   card, check the documentation that came with the card, or contact your
   network card manufacturer.

<P><LI>Save your changes and exit Control Panel.
<P>
</OL>NOTE: If you cannot start Windows to open Control Panel, edit the
PROTOCOL.INI file and change the settings for Interrupt=, RamAddress=,
DMAChannel=, and IOBase= to unused values (for software-configurable
cards) or to the actual hardware settings (for hardware-configurable
cards).
<P>
When you change hardware settings (such as IRQ and I/O addresses) on
software-configurable network cards (such as the Intel EtherExpress
16), you must either quit Windows, turn the computer completely off,
and then restart it, or select the Restart Computer option in Windows
for the new settings to take effect.
<P>
<P><h3>Test the Network Card Drivers</h3>
 
<P>
Run the Maintenance Mode of Windows for Workgroups Setup program to
reinstall the network card drivers.
<P>
If reinstalling the network card drivers does not enable the local
computer to "see itself" in File Manager or view other computers on
the network using the real mode redirector, there are several other
possible causes:

<UL><LI>The correct Media Access Control (MAC) network card driver is not
   being used. If the card is emulating another card (such as the
   NE2000), it may be necessary to change jumpers or switches on the
   card to allow the driver to work properly. For more information about
   configuring the network card and obtaining updated drivers, contact
   your network card manufacturer.

<LI>The card may be in a slot that is functioning incorrectly. To verify
   this, try putting the network card in another slot in the computer or
   install the network card in another computer to determine if the card
   itself is defective.

<LI>The network card may be malfunctioning. Try using a different
   network card or run diagnostic tests that may have come with the card.

<LI>The bus speed on the computer may be too fast for the network
   card. Most network cards are designed to work at ISA (8.33 mHz)
   bus speed; setting the bus speed any faster may cause unreliable
   performance.
<P>
   The bus speed setting is usually changed in the computer's CMOS setup.
   Try lowering the computer's bus speed if intermittent problems occur.

<LI>There may be a bad or missing connection. Some network cards, such
   as the Intel EtherExpress 16, come with a utility that checks the
   integrity of wiring and connectors between two computers. If one of
   these utilities is available, use it to determine whether or not the
   two computers are physically connected. (Refer to the "Use a Network
   Card Diagnostic Test" section below.)
<P>
</UL><h3>Use a Network Card Diagnostic Test</h3>
 
<P>
You can run a diagnostic test on the network card to ensure it is
functioning correctly. Some network card diagnostic programs can also
test communication between computers and the network (this tests the
card and the cabling). If this test works, then Windows for Workgroups
should also work, provided the correct drivers are being used. If this
low-level test does not allow two network cards to communicate, some
type of hardware problem exists with a network card, the cabling, or
the connectors. Contact your hardware vendor if either the network
card diagnostic test or the network test fails.
<P>
NOTE: If you have the Windows for Workgroups Resource Kit, you can use
the NETSTAT program included with the kit. This program tests (from
MS-DOS or Windows) the status of a remote network card. This requires
that the correct network card drivers be loaded on each network card
and (at least) the real mode redirector be started on each computer.
<P>
If you have Intel EtherExpress network cards (which come with the
Windows for Workgroups Starter and User Kits), you can use the SOFTSET
utility (available from the Microsoft Download Service [MSDL] or the
Intel bulletin board service [BBS]) to troubleshoot both the network
card, as well as test the integrity of the network cabling (with the
Test Network option).
<P>
If your network card is not on the supported network card list, you
may want to contact the network card manufacturer for information on
the correct emulation or for an updated Media Access Control (MAC)
network card driver. The manufacturer may also have information on
jumpers and switches that may need to be reconfigured for a particular
emulation mode, for example NE2000 emulation.
<P>
For more information about diagnosing problems with your network card or
cabling, contact your hardware vendor.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kb3rdparty kbtshoot kbsetup<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: tshoot 3.10<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
