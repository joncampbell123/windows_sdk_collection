

<HTML>
<HEAD>
<TITLE>Windows Err Msg: Cannot Run This Program... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84042 ">
<META NAME="KBModify" CONTENT="1995/07/18">
<META NAME="KBCreate" CONTENT="1992/04/28">
<META NAME="Keywords" CONTENT="kbsetup kbdisplay kberrmsg kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  When you try to start an application in Microsoft Windows 3.1 or try to run Windows Setup from within Windows, you receive the following error message:     Cannot run this program. The program or one of its components is    compressed. Expand the p...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAFI,QBXB,QATJ,QAGQ,QAA1,QA9N,QDI2,QAB4,QBWS,QASB,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows Err Msg: Cannot Run This Program...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84042 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to start an application in Microsoft Windows 3.1 or try
to run Windows Setup from within Windows, you receive the following
error message:
<P>
<PRE>   Cannot run this program. The program or one of its components is
   compressed. Expand the program files from your Windows setup disks.

</PRE><h2>CAUSE</h2>
 
<P>
You may have old or corrupt Windows .DLL or .MOD files are in your Windows
directory.
<P>
If this error occurs after you install Windows 3.1, it may be caused
by a third-party display driver.
<P>
You may also receive this error if you try to run an MS-DOS-based
application in Windows, even though the application itself is not
compressed; compressed Windows files are actually causing the problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Remove any Windows 3.0 .DLL or .MOD files from your Windows directory.
For more information, see the "Windows 3.0 Files in Your Windows
Directory" section below.
<P>
If the problem is a third-party display driver, reset it to a generic
Microsoft driver, such as VGA.
<P>
If you receive this error while running an uncompressed MS-DOS-based
application, determine if you have compressed Windows files as
explained in the "Compressed Windows Files" discussion later in this
article, then expand the files.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Windows 3.0 Files in Your Windows Directory</h3>
 
<P>
When you upgrade a Windows 3.0 installation to Windows 3.1, system
.DLL files are replaced in the WINDOWS\SYSTEM directory. If there
are duplicate system .DLL files in the Windows directory, they are not
replaced or removed during the upgrade to Windows 3.1. Windows 3.1
Setup looks only in the WINDOWS\SYSTEM directory because that is where
the system .DLL files are installed. If system .DLL files are in the
Windows directory, they were copied or moved to that location
manually.
<P>
If Windows 3.0 versions of .DLL or .MOD files are in the Windows
directory instead of (or in addition to) the Windows 3.1 versions in
the WINDOWS\SYSTEM directory, you may experience a variety of
problems.
<P>
Creating a clean installation of Windows in a new directory can
correct these problems; however, this is not a satisfactory solution
because many Windows-based applications store critical settings in the
WIN.INI file when they are installed. Many of these applications would
need to be reinstalled if Windows 3.1 were installed into a new
directory.
<P>
The only way you can verify that you have the correct files is to
check the file dates. The Windows 3.1 files are dated 3/10/92 or
later. Windows 3.0 files are dated either 5/1/90 or 10/31/90.
<P>
You can search for old Windows files by using the MS-DOS 5.0 DIR
command in conjunction with the /O switch and its options. DIR /ON
gives you a directory listing of files in the current directory listed
alphabetically by name, and DIR /OD lists the files in the current
directory by date. The following example lists all the .DLL files in
the Windows and WINDOWS\SYSTEM directory on the printer instead of the
screen:
<P>
<PRE>   dir c:\windows\*.dll &gt; prn
   dir c:\windows\system\*.dll &gt; prn

</PRE>NOTE: Do not redirect files to PostScript printers using these
commands. There should not be any .DLL or .MOD files in the Windows or
WINDOWS\SYSTEM directory dated 5/1/90 or 10/31/90.
<P>
<P><h3>Compressed Windows Files</h3>
 
<P>
If you receive this error while trying to run an uncompressed MS-DOS-
based application, you can determine if compressed Windows files are
causing the problem by following these steps:

<OL><P><LI>From the File Manager File menu, choose Create Directory and create
   a new directory in your root directory (for example, C:\TEST1).

<P><LI>From the File menu, choose Run, type the following command, and
   press ENTER:
<P>
<P><PRE>      c:\windows\expand c:\windows\*.* c:\test1
</PRE>
<P><LI>If the percentage increase is NOT zero, compressed files did exist.
   You can copy these files back to the Windows directory.
<P>
</OL>You should also try this technique in your WINDOWS\SYSTEM
subdirectory. (If you copy the files back to the WINDOWS\SYSTEM
subdirectory, make sure you don't copy the Windows directory files
there also.)
<P>
NOTE: When you run the EXPAND utility from inside Windows File
Manager, the screen showing the percentage increase disappears very
quickly. When you use the COPY command in File Manager, you may
receive a number of error messages saying that Windows cannot copy
this file because Windows is using it. This is not a problem because
if Windows is using a file, it isn't compressed. It may be easier to
run EXPAND and COPY from an MS-DOS command prompt outside Windows.
(The only advantage to using Windows File Manager is that it doesn't
abort the copy when it tries to copy a read-only file.)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbdisplay kberrmsg kbtshoot<BR>
KBSubcategory: win31<BR>
Additional reference words: 3.10 3.11 missing lzexpand.dll ver.dll<BR>
win87em.dll S3 1.2 800X600 64K Colors 1M tshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
