

<HTML>
<HEAD>
<TITLE>Troubleshooting At Work PC Fax in WFWG 3.11 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122032">
<META NAME="KBModify" CONTENT="1996/04/26">
<META NAME="KBCreate" CONTENT="1994/10/25">
<META NAME="Keywords" CONTENT="kbusage kbdisplay kbatwork kbhw kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  This article contains a step-by-step guide to troubleshooting Microsoft At Work PC Fax in Microsoft Windows for Workgroups 3.11. Additional information about At Work PC Fax is available in the following sources:   - Windows for Workgroups 3.11 Reso...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVU,QBWO,QAA1,QDI2,QAYC,QBXS,QABI,QAS6,QBWS,QAG0,QBVV,QANE,QA3A,QAY2,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting At Work PC Fax in WFWG 3.11</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 26, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122032</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<PRE> The information in this article applies to:

</PRE><LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains a step-by-step guide to troubleshooting Microsoft At
Work PC Fax in Microsoft Windows for Workgroups 3.11. Additional
information about At Work PC Fax is available in the following sources:

<UL><LI>Windows for Workgroups 3.11 Resource Kit, Chapters 4 and 10

<LI>Help (available in the Fax area of Control Panel)

<LI>Additional articles in the Microsoft Knowledge Base. You can have access
   to the Microsoft Knowledge Base through the following services:
<P>
<P><PRE>    - Microsoft TechNet CD
</PRE><P>
<P><PRE>    - The Internet
</PRE><P>
<P><PRE>    - Microsoft FastTips at (800) 936-4200 (Only a selected number of
      Knowledge Base articles are available on the FastTips service.)
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
With Microsoft At Work PC Fax, you can send and receive faxes through your
fax modem. At Work PC Fax works through the Windows for Workgroups Mail
interface. (However, you do not have to be using Mail in order to use At
Work PC Fax.)
<P>
To send a fax, compose a message in Mail, then place the fax number on the
To line of the Mail message using the following formats:
<P>
<PRE>   [fax:1234567]

   -or-

   [fax:name@1234567]

</PRE>Finally, choose Send.
<P>
You can attach files (for example, bitmaps, documents, or spreadsheets) in
the message and fax these documents all from within Mail. In addition, you
have the option of printing to the At Work PC Fax printer driver from
within a Windows-based application.
<P>
If the sending and receiving fax modems are both Class 1 compatible, you
can send binary files through At Work PC Fax. Note that if either fax modem
is not Class 1 compatible, the transmission is in a non-editable facsimile
format (as if you were sending from a fax machine.)
<P>
<P><h3>At Work PC Fax Setup</h3>
 
<P>
To set up At Work PC Fax, open Control Panel and double-click the Fax icon.
The first time you set up At Work PC Fax, you are prompted with a dialog
box for "Email and Fax" or "Fax Only." If you are on a network and use
Microsoft Mail in Windows for Workgroups, choose "Email and Fax." If you do
not use Mail (that is, if you are on a stand-alone system or just do not
use Mail), choose "Fax Only."
<P>
After making this selection, select the appropriate settings for your fax
modem. There should then be a short delay, during which your EFAXPUMP.INI
file is being created, and then you should be prompted for your fax number.
Enter this information. (The country code for the USA is "1").
<P>
If you receive the following message
<P>
<PRE>   A modem was not detected on the selected port. Do you wish to install
   anyway?

</PRE>Choose No. Make sure that you have selected the correct port and that your
fax modem is on (if it is an external modem).
<P>
If the fax modem is properly detected, you are prompted to run Microsoft
Mail if you are not already doing so. Sign into Mail. This create a new
MSMAIL.MMF file. (This is the file that holds mail or fax messages.)
<P>
You should now see a Fax icon that is "idle." (Minimize everything on your
screen if you have difficulty finding the icon.) The Fax icon indicates
that you are properly set up and ready to use the faxing capability. (See
the "At Work PC Fax Usage" section below.)
<P>
<P><h3>Setting Up a Shared Network Fax</h3>
 
<P>
After you have At Work PC Fax set up on one machine, you can then share
this fax modem with other members of the network. (NOTE: You are actually
sharing a directory, not the fax modem itself.) The machine with the fax
modem in it can be considered the fax server. Other members of the network
can then fax from their own machines using this shared fax modem.
<P>
Incoming faxes are received at the server, where they can either be
manually routed to others on the network, or placed in a shared folder in
Microsoft Mail. From the shared folder, others can access the faxes. Faxes
are NOT automatically routed to the intended recipients--they are received
by the fax server only.
<P>
To set up your shared fax modem:

<OL><P><LI>Set up and test the machine with the fax modem installed.

<P><LI>On the fax server, open Control Panel, double-click the Fax icon, and
   choose Shared Network Fax.

<P><LI>Choose Create Directory.

<P><LI>Choose Create Share and change the access type to Full.
<P>
</OL>To set up a Windows for Workgroups 3.11 workstation to use a remote fax
modem:

<OL><P><LI>Open Control Panel and double-click the Fax icon.

<P><LI>Select Fax Only if you are not using Microsoft Mail; select Email And
    Fax if you want to use At Work PC Fax and Microsoft Mail. (You receive
    this message the first time you open the Fax icon only.)

<P><LI>Choose Add.

<P><LI>Select Shared Network Fax.

<P><LI>Choose the Network button.

<P><LI>In the Path box, type the location of the fax server using the
    following format:
<P>
       \\&lt;machinename&gt;\&lt;sharename&gt;
<P>
    NOTE: The default &lt;sharename&gt; is MSFAX.

<P><LI>Choose OK.

<P><LI>Select the connection you have just established and choose OK. If you
    have more than one connection to shared fax modems, you can set one as
    the active modem. (If there is only one connection to a shared fax
    modem, this is not an option.)

<P><LI>Start and sign in to Microsoft Mail.

<P><LI>Assuming the fax server is running Mail and the Fax icon is on the
    desktop, the workstation should also start up At Work PC Fax.
<P>
    NOTE: When the server goes down or the fax modem goes offline, users
    connected to that shared fax modem cannot actually send faxes. However,
    even when the fax modem is offline, you can create faxes and choose
    Send--they will be transmitted when the fax modem is back online.
<P>
</OL><h3>At Work PC Fax Usage</h3>
 
<P>
To use At Work PC Fax, you must have Microsoft Mail running and the fax
modem online. (On the Fax/Mode menu, the Work Off-Line option must not have
a check mark beside it.) If you are attaching to a shared fax modem, both
the fax server and the workstation must be running Microsoft Mail, and the
fax modem must be online.
<P>
To send a fax, use one of the following methods.
<P>
Method #1 - Faxing from Mail:

<OL><P><LI>Open Microsoft Mail and make sure your fax modem is online. (The Fax
   icon appears on the desktop.)

<P><LI>In Mail, choose Compose. Type the body of the mail message, or choose
   Attach and attach any files you want to fax.
<P>
   NOTE: If you attach a file, it must be a printable document with an
   extension that Windows for Workgroups recognizes unless you are sending
   a binary file, in which case any file can be sent. (Class 1 fax modems
   must be available on both ends if you are transferring a binary file.)

<P><LI>On the To: line, type one of the following formats:
<P>
<P><PRE>      [fax:1234567]
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      [fax:John@1234567]
</PRE>
<P><LI>Choose Send.

<P><LI>From the View menu, choose New Messages.
<P>
</OL>Method #2 - Printing from within an application to the At Work PC Fax
printer driver (Microsoft At Work Fax on Fax):

<OL><P><LI>In your Windows-based application, choose Print from the File menu.
   Print with the "Microsoft At Work PC Fax on Fax" printer driver.
<P>
   Microsoft Mail starts. Sign in if necessary.

<P><LI>You are prompted with the Compose dialog box.

<P><LI>On the To: line, use one of the following formats:
<P>
<P><PRE>       [FAX:1234567]
</PRE><P>
<P><PRE>       -or-
</PRE><P>
<P><PRE>       [FAX:John@1234567]
</PRE>
<P><LI>Choose Send.
<P>
</OL><h3>At Work PC Fax Initial Troubleshooting</h3>
 
<P>
If you are having any difficulty with At Work PC Fax installation or usage,
set up your configuration as outlined below for testing. This "clean"
configuration helps to narrow down possible software conflicts and ensure
that the fax modem itself is working properly.

<OL><P><LI>Restart your machine with the following clean configuration:
<P>
<P><PRE>      CONFIG.SYS
      ----------
</PRE><P>
<P><PRE>      DEVICE=C:\WFWG\HIMEM.SYS
      SHELL=C:\DOS\COMMAND.COM /P
      DEVICE=C:\WFWG\IFSHLP.SYS
      (disk-compression drivers if needed)
      (SCSI driver if needed)
</PRE><P>
<P><PRE>      AUTOEXEC.BAT
      ------------
</PRE><P>
<P><PRE>      C:\WFWG\NET START
      PATH=C:\DOS;C:\WFWG
      PROMPT $P$G
      SET TEMP=C:\TEMP
</PRE>
<P><LI>Change to the standard VGA video driver as follows:
<P>
   a. Exit Windows.
<P>
   b. From your Windows for Workgroups directory, type "setup" (without the
<P><PRE>      quotation marks).
</PRE><P>
   c. Change the Display Type to VGA. Replace the files when prompted if
<P><PRE>      the driver already exists on your hard disk.
</PRE>
<P><LI>Modify the following entries in the SYSTEM.INI file to match the values
   listed below.
<P>
<P><PRE>      [boot]
      system.drv=system.drv
      shell=progman.exe
      comm.drv=comm.drv
      display.drv=vga.drv
</PRE>
<P><LI>Remark out the Load= and Run= lines in the [windows] section of your
   WIN.INI. (You can remark out an existing entry by placing a semicolon
   (;) at the beginning of that line.)

<P><LI>Remove any programs that are loading in your StartUp group.

<P><LI>Check to make sure you have the correct Windows for Workgroups
   communications driver. In your Windows SYSTEM subdirectory, check the
   file attributes of COMM.DRV. The file should be dated 11/1/93. The file
   size should be 5968 bytes. If it is not, rename the current COMM.DRV and
   expand the correct one from the original Windows for Workgroups Disk #2.
   To do this, type the following from an MS-DOS command prompt
<P>
<P><PRE>      expand &lt;drive&gt;:\comm.dr_ &lt;destination&gt;:\windows\system\comm.drv
</PRE><P>
   where &lt;drive&gt; is the floppy disk drive containing Windows for Workgroups
   Disk #2 and &lt;destination&gt; is your drive containing Windows.

<P><LI>Determine whether the fax modem works at the MS-DOS command prompt by
   exiting Windows for Workgroups and typing the following command
<P>
<P><PRE>      echo atdt5555555 &gt; com&lt;x&gt;
</PRE><P>
   where &lt;x&gt; is the number of the communications (COM) port.
<P>
   If you do not hear a dial tone, the fax modem may need to be
   reconfigured for the correct port address and interrupt. Also, if you
   have an external fax modem, check the serial cable to ensure a good
   connection and that the proper cable is being used. If you have an
   internal fax modem, check to ensure that the hardware configuration is
   correct. Refer to the fax modem documentation for setup and technical
   support information.

<P><LI>Determine whether the fax modem works in Windows Terminal as follows:
<P>
   In the Accessories group, open Terminal and type the command "atdt"
   (without the quotation marks).
<P>
<P><PRE>    - If the correct COM port is selected for the fax modem, you should
      hear a dial tone and "OK" or zero (0) should be returned to the
      terminal screen. Pressing ENTER should cancel the command to the fax
      modem and the message "NO CARRIER" should be returned to the screen.
</PRE><P>
<P><PRE>    - If you do not hear a dial tone after the ATDT command, choose
      Communications from the Settings menu to make sure the correct COM
      port setting is selected.
</PRE><P>
<P><PRE>    - If you do not see the text echoed back to the screen as you type the
      command, choose Terminal Preferences from the Settings menu and
      select the Local Echo option under Terminal Modes.
</PRE><P>
   If the fax modem does not work in Terminal, the modem may not be
   correctly configured for Windows.
<P>
</OL><h3>Gathering Information About Your Fax Modem</h3>
 
<P>
By entering Terminal and typing some commands, you can gather information
about your fax modem. The following information can be helpful should you
need to contact Microsoft Product Support Services:

<UL><LI>The fax modem manufacturer and model.

<LI>The class of the fax modem. The class can be 1, 2, 2.0, or CAS. At Work
   PC Fax works with all but Class 2.0 fax modems. Some fax modems are both
   Class 1 and Class 2 compatible.
<P>
   To determine the class of fax modem, type the following command in
   Terminal:
<P>
<P><PRE>      at+fclass=?
</PRE><P>
   This should return "0,1" or "0,2" or "0,1,2". This value indicates
   your fax modem is Class 1, Class 2, or both Class 1 and 2 compatible,
   respectively.

<LI>For information about the BIOS of the fax modem, type the following
   command in Terminal:
<P>
<P><PRE>      ati&lt;x&gt;
</PRE><P>
   where &lt;x&gt; is a number 1-9.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage kbdisplay kbatwork kbhw kbtshoot<BR>
KBSubcategory: wfw wincomm awfax wfwg<BR>
Additional reference words: 3.11 tshoot Superguide<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 26, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
