

<HTML>
<HEAD>
<TITLE>Optimizing WFWG 3.11 for Real-Mode NetBIOS Programs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139016">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1995/11/01">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  When you are using a program or tool that relies on the real-mode NetBIOS interface provided by NetBEUI, your network session may be dropped in Windows for Workgroups 3.11. This problem is most likely to occur with programs or tools that load a rea...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QBWS,QA26,QAVZ,QAA1,QDIZ,QDI2,QBBS,QAXB,QAU9,QAIJ,QAKP,QBXS,QBDM,QA5W V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Optimizing WFWG 3.11 for Real-Mode NetBIOS Programs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139016</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are using a program or tool that relies on the real-mode NetBIOS
interface provided by NetBEUI, your network session may be dropped in
Windows for Workgroups 3.11. This problem is most likely to occur with
programs or tools that load a real-mode TSR that interfaces with NetBIOS
and have Windows-based components that communicate with the TSR.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem can be caused by a number of different timing and
optimization problems that can occur when a Windows-based component
uses the protected- mode NetBIOS interface to communicate with a real-
mode TSR running over real-mode NetBEUI.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Disabling the protected-mode NetBEUI component and optimizing the real-
mode NetBEUI protocol may increase the reliability of layered applications
based on a real-mode NetBIOS interface requiring real-mode NetBEUI.
<P>
The instructions in the following sections may help you to resolve the
problem described in this article.
<P>
<P><h3>Remove Protected-Mode NetBEUI/Use Real-Mode NetBEUI Only</h3>
 

<OL><P><LI>In the Network group, double-click the Network Setup icon.

<P><LI>Click Drivers.

<P><LI>Click the network adapter driver, and then click Setup.

<P><LI>In the Driver Type box, click Real Mode NDIS Driver, and then click
   OK until you exit Network Setup.

<P><LI>When you are prompted to restart your computer, click Continue.

<P><LI>Use any text editor (such as Notepad) to open the System.ini file.
   Locate the line that reads
<P>
<P><PRE>      transport=netbeui.386
</PRE><P>
   and change it to:
<P>
<P><PRE>      transport=
</PRE>
<P><LI>Add the following line to the [Network] section of the file:
<P>
<P><PRE>      AutoStart=NETBEUI
</PRE>
<P><LI>Save and then close the System.ini file.
<P>
</OL><h3>Optimize the Real-Mode NetBEUI Protocol</h3>
 

<OL><P><LI>In the Network group, double-click the Network Setup icon.

<P><LI>Click Drivers.

<P><LI>Click the NetBEUI protocol, and then click Set As Default Protocol.

<P><LI>Click Setup, click Sessions, and increase the value to at least 16
   (depending on your results).

<P><LI>Click Set, click NCBS, and increase the value to at least 32
   (depending on your results).

<P><LI>Click Set, and then click OK until you exit Network Setup. When you
   are prompted to restart your computer, click Continue.
<P>
</OL><h3>Optimize the Virtualized Network Interface</h3>
 

<OL><P><LI>Use any text editor (such as Notepad) to open the System.ini file.

<P><LI>Locate the line that reads
<P>
<P><PRE>      NetHeapSize=20
</PRE><P>
   and change it to:
<P>
<P><PRE>      NetHeapSize=32
</PRE><P>
   NOTE: You can use a value greater than 32, depending on your
   results.

<P><LI>Save and then close the System.ini file

<P><LI>Restart your computer.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
You can also obtain and install Application Note WG0970 to help resolve
these problems. For information about obtaining this Application Note,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win3x/q109448.htm">Q109448</A></B>
   TITLE     : WG0970: VNETBIOS.386 Corrects Real-Mode Transport Problems

</PRE></OL>The configuration described in this article was tested and is stable with
the original versions of the Windows for Workgroups 3.11 files. This
configuration was not found to be stable with the updated Windows for
Workgroups 3.11 files included on the Microsoft Windows NT 3.5 and 3.51
Server CD-ROMs or with the updated files included in Application Note
WG1129.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork<BR>
KBSubcategory: wfwg<BR>
Additional reference words: 3.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
