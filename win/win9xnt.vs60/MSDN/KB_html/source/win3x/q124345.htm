

<HTML>
<HEAD>
<TITLE>WW1138: Updated Calculator Accessory for Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124345">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1994/12/28">
<META NAME="Keywords" CONTENT="wfw wfwg win31 kbappnote kbbuglist kbfile kbtlc">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" This Application Note provides an updated version of the Calculator accessory that is shipped with Microsoft Windows 3.1x and Windows for Workgroups 3.1x. Previous versions of Calculator display simple subtraction errors when you subtract two number...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWN,QBWQ,QDMT,QBDM,QAJ4,QAE5,QAJH,QAXB,QAVZ,QAO0,QAH0,QBD2,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WW1138: Updated Calculator Accessory for Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124345</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.11
WINDOWS
kbappnote kbfile kbtlc kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups, versions 3.1, 3.11
</UL> 
<P>
This Application Note provides an updated version of the Calculator
accessory that is shipped with Microsoft Windows 3.1x and Windows for
Workgroups 3.1x. Previous versions of Calculator display simple subtraction
errors when you subtract two numbers that include values to the right of
the decimal point.
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft FastTips Technical Library
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note" section
at the end of this article.
<P>
<P><h2>THE TEXT OF WW1138</h2>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
          WW1138: UPDATED CALCULATOR ACCESSORY FOR WINDOWS(R)
</PRE> 
<PRE>                                                   Revision Date: 1/95
                                                       1 Disk Included

</PRE>The following information applies to Microsoft Windows and Windows for
Workgroups, versions 3.10 and 3.11.
<P>
<PRE> ---------------------------------------------------------------------
| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY     |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an Application |
| Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER      |
| EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED      |
| WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR       |
| PURPOSE. The user assumes the entire risk as to the accuracy and    |
| the use of this Application Note. This Application Note may be      |
| copied and distributed subject to the following conditions:  1) All |
| text must be copied without modification and all pages must be      |
| included;  2) If software is included, all files on the disk(s)     |
| must be copied without modification (the MS-DOS(R)  utility         |
| diskcopy is appropriate for this purpose);  3) All components of    |
| this Application Note must be distributed together;  and  4) This   |
| Application Note may not be distributed for profit.                 |
|                                                                     |
|                                                                     |
| Copyright (C) 1995 Microsoft Corporation.  All Rights Reserved.     |
| Microsoft, MS-DOS, and Windows are registered trademarks of         |
| Microsoft Corporation. Intel and Pentium are registered trademarks  |
| of Intel Corporation.                                               |
 --------------------------------------------------------------------

</PRE><h3>Introduction</h3>
 
<P>
The WW1138 disk included with this Application Note contains an updated
version of the Calculator accessory that is shipped with Microsoft Windows
3.1x and Windows for Workgroups 3.1x. Previous versions of Calculator
display simple subtraction errors when you subtract two numbers that
include values to the right of the decimal point. While Calculator is
determining how to display the solution, it encounters a loss of precision
and shows an incorrect answer.
<P>
<PRE>   NOTE: This rounding error is unrelated to the floating-point unit
   (FPU) in the Intel(R) Pentium(R) chip. This problem occurs only in
   Calculator and does not affect Windows, other components in Windows,
   or other Windows-based applications.

</PRE>In addition to correcting the problem described above, the new rounding
algorithm in Calculator causes it to perform more like most hand-held
calculators. For example, if you enter the following equation in the
updated Calculator accessory or in a hand-held calculator
<P>
<PRE>   [(1/3 + 10 - 10) x 3]

</PRE>the result is 0.9999. The result in previous versions of Calculator is 1.0.
The value 0.9999 is generated because significant digits are lost by adding
and subtracting 10. This is a secondary effect of the changes made in
Calculator to correct the precision errors.
<P>
<P><h3>To install the updated files</h3>
 

<OL><P><LI>Quit Windows, or open an MS-DOS command prompt within Windows.

<P><LI>Rename the existing CALC.EXE file in your Windows directory. For
   example, if Windows is installed in a directory on drive C called
   WINDOWS, type the following commands, pressing ENTER after each
   line:
<P>
<P><PRE>      cd\windows
      ren calc.exe calc.old
</PRE>
<P><LI>If you received a disk with this Application Note, insert the disk
   in the appropriate floppy disk drive.
<P>
   If you downloaded this Application Note from an online service,
   skip to step 4. This procedure assumes that you have already
   downloaded and extracted the compressed file.

<P><LI>At an MS-DOS command prompt, type the following and press ENTER
<P>
<P><PRE>      copy &lt;source&gt;:\calc.exe &lt;location&gt;
</PRE><P>
   where &lt;source&gt; is either the letter of your floppy disk drive or
   the directory containing the file you downloaded from online
   services, and &lt;location&gt; is the path to your Windows directory. For
   example, if you are installing from a floppy disk that you inserted
   in drive A, and C:\WINDOWS is the path to your Windows directory,
   type:
<P>
<P><PRE>      copy a:\calc.exe c:\windows
</PRE><P>
   Or, for example, if you downloaded the WW1138.EXE file from online
   services to C:\DOWNLOAD and C:WINDOWS is the path to your Windows
   directory, type:
<P>
<P><PRE>      copy c:\download\calc.exe c:\windows
</PRE><P>
   You are now ready to restart Windows (if necessary) and run the
   updated Calculator accessory.
<P>
</OL><h3>Steps to Reproduce Problem Using Previous Versions of Calculator</h3>
 

<OL><P><LI>To perform this test, choose two numbers that include values to the
   right of the decimal point (for example, 12.52 and 12.51).

<P><LI>Double-click the Calculator icon in the Accessories group.

<P><LI>Enter the larger number first (for example, 12.52).

<P><LI>Press the MINUS SIGN (-).

<P><LI>Enter the smaller number (for example, 12.51).

<P><LI>Press the EQUAL SIGN (=).
<P>
</OL>Note that in this example you do not receive .01, the expected result.
Instead, you receive one of the following:
<P>
<PRE>   0.00
   0.0099999999
   0.010000001

</PRE></OL>The updated Calculator accessory displays the correct result, which is
.01.
 
<P>
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/ww1138.exe">WW1138.EXE</A> <I>(size: 41480 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/ww1138.exe">WW1138.EXE</A> <I>(size: 41480 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/ww1138.exe">WW1138.EXE</A> <I>(size: 41480 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/ww1138.exe">WW1138.EXE</A> <I>(size: 41480 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>If you are unable to access the source(s) listed above, you can have
   this Application Note mailed to you by calling Microsoft Product Support
   Services Monday through Friday, 6:00 A.M. to 6:00 P.M. Pacific time at
   (425) 637-7098. If you are outside the United States, contact the
   Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbappnote kbfile kbtlc kbbuglist<BR>
KBSubcategory: win31 wfw wfwg<BR>
Additional reference words: 3.10 3.11 ww31tlc wg31tlc wg311tlc<BR>
Keywords            : wfw wfwg win31 kbappnote kbbuglist kbfile kbtlc<BR>
Version             : 3.10 3.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
