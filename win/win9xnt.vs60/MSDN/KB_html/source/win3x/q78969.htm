

<HTML>
<HEAD>
<TITLE>FastTips: Using Windows 3.0 with MS-DOS 5 Questions &amp; Answers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q78969 ">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1991/12/08">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QDIO,QBW6,QDJD,QA5W,QABA,QBWS,QDKI,QAA1,QDIU,QAUR,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FastTips: Using Windows 3.0 with MS-DOS 5 Questions &amp; Answers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q78969 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.00a
WINDOWS
kbref kbfasttip kbdisplay
<P>
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains the complete text of the "Using Windows 3.0 with
MS-DOS 5.0" fax script.
<P>
This fax script is available to customers who call the Microsoft
FastTips Service for Operating Systems at (800) 936-4200.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P>
<PRE>                    Microsoft Windows, Version 3.0
            Automated Product Support Service Fax-Script
       Questions and Answers: Using Windows 3.0 with MS-DOS 5.0
       --------------------------------------------------------

1. Q. After installing the MS-DOS 5.0 Upgrade, there is a file named
      WINA20.386 in the root directory.  What is this file?

   A. When installing on computers capable of running Windows 3.0 in
      386 enhanced mode, the MS-DOS 5.0 Upgrade places a read-only
      file named WINA20.386 in the root directory. DOS 5.0 uses this
      file to provide support for Windows 3.0 running in enhanced
      mode. For more information on this file and instructions on how
      to relocate it to a subdirectory, refer to the README.TXT file
      in your DOS subdirectory.

2. Q. After upgrading to MS-DOS 5.0, when I run Windows in the
      enhanced mode, my fonts are not the same as they used to be.
      What can I do about this?

   A. If your fonts don't look right after installing MS-DOS 5.0,
      there may not be enough file handles to display the screen fonts
      that you were using before.

      The FILES statement in the CONFIG.SYS file sets the number of
      file handles that can be open at one time. During setup, MS-DOS
      5.0 may set the number of file handles to 10 if there is no
      existing FILES statement or if there is no CONFIG.SYS file. For
      Windows 3.0 to run properly in 386 enhanced mode, the FILES
      statement should be set to at least 30.

      There should be a line in your CONFIG.SYS file that reads:

         FILES=30

      Information on the FILES statement can be found on pages 493 and
      494 in your "Microsoft MS-DOS User's Guide and Reference" for
      version 5.0.

3. Q. After upgrading to MS-DOS 5.0, when I run Windows, I get an
      error message telling me I need a file named WINA20.386 in my
      root directory. How can I resolve this?

   A. If you get this error message when starting Windows, carry out
      these steps to correct the problem.

      a. With 5.25-inch disks, place the MS-DOS 5.0 disk 5 in drive A;
         with 3.5-inch disks, use disk 3. There is a file on this disk
         named WINA20.38_.

      b. Expand WINA20.38_ and copy it to your root directory by
         entering this command:

            expand a:\wina20.38_ c:\wina20.3864

         Press ENTER. It is assumed that your DOS Upgrade disk is in
         drive A. If you are using drive B, just change A:\ to B:\.

         With this solution, Windows will no longer give you the "no
         file named WINA20.386" error message and it will start up in
         Windows enhanced mode.

4. Q. Before I installed MS-DOS 5.0, Windows ran in enhanced mode but
      now it only runs in real or standard mode. How can I correct
      this?

   A. You may be encountering a memory limitation. Some DOS 5.0
      features use extra extended memory. To check your computer's
      memory, do the following:

      Reboot your computer. At the DOS prompt, type MEM and press
      ENTER to run the DOS MEM command. If this shows less than 1
      million bytes available XMS memory, the problem may be a lack of
      memory. There are two possible solutions:

      a. If your computer has only 2 megabytes (MB) of memory, you
         will have to free up additional memory for Windows's use by
         not loading DOS high and not loading device drivers high. You
         may want to refer to your "Microsoft MS-DOS User's Guide and
         Reference" for version 5.0 for more information on "loading
         high." The best solution is to add memory to your computer.
         Windows 386 enhanced mode works better on a computer with 4
         MB or more of memory.

      b. If you currently have more than 2 MB of memory but cannot use
         Windows enhanced mode, check to see if software such as RAM
         drives or disk caching utilities are using up this memory.
         Set them to use less memory and Windows should come up in 386
         enhanced mode.

5. Q. After upgrading to MS-DOS 5.0, Windows hangs or returns to the
      DOS prompt when I try to run it. What causes this problem and
      how do I correct it?

   A. If Windows hangs or drops back to DOS when you try to start it,
      there may be a conflict between Windows and a new DOS 5.0
      feature. The solution depends on the configuration of your
      computer.

      a. If you are using a 386 or 486 computer and using the EMM386
         expanded memory manager with the NOEMS option, try changing
         to the RAM option. This will give you expanded memory
         support, but it will give 64K less of upper memory blocks
         (UMBs) for DOS LOADHIGHs. If this solution doesn't work or
         you need the 64K of UMBs, try the next solution.

      b. This solution is also for 386 and 486 computers. Edit the
         Windows SYSTEM.INI file. As a precaution, use the DOS COPY
         command to make a backup copy of your SYSTEM.INI file before
         you make any changes. Name this backup copy with a different
         extension, such as .INK Then, if your edited SYSTEM.INI file
         doesn't work properly, you can use the DOS RENAME command to
         recover and use your backup copy. If you are not sure how to
         do this, you may want to get someone to help who has
         experience editing Windows .INI files.

         1) Start Windows Notepad, and open the SYSTEM.INI file.

         2) Find the line that reads [386ENH].

         3) On a new line below this, enter the following statement:

               EMMEXCLUDE=A000-EFFF

         4) Save your edited SYSTEM.INI and exit Windows.

         The EMMEXCLUDE line tells Windows to not attempt to use
         memory locations that DOS 5.0 uses when it loads device
         drivers high. Restart Windows to see if this solves your
         problem.

      c. With a 286, 386, or 486 computer, you may need to add some
         options to the DEVICE=HIMEM.SYS line in your CONFIG.SYS file.
         Before trying this, make sure you have a DOS 5.0 floppy disk
         you can boot from, if necessary. On some machines, these
         changes can cause HIMEM to lock up and you will need to boot
         from a floppy disk in drive A to edit the CONFIG.SYS file to
         find the correct setting.

         HIMEM.SYS, the Microsoft extended memory manager, has
         settings for different computers. These can be found on page
         611 of your "Microsoft MS-DOS User's Guide and Reference" for
         version 5.0. See if your computer is listed in this
         reference. If so, try the listed HIMEM setting first. If that
         doesn't work or if your computer isn't on the list, try
         settings 1, 11, 12, and 13. Your HIMEM line in the CONFIG.SYS
         file should read:

            DEVICE=HIMEM.SYS /M:1

         To try other HIMEM settings, change only the number at the
         end of the HIMEM line. Save your edited CONFIG.SYS file and
         reboot your computer to test your new HIMEM setting. If it
         doesn't work properly, repeat the procedure to try a
         different HIMEM setting.

         If these procedures do not resolve your problem,
         contact your local computer support person, or call
         Microsoft Windows Product Support at (425) 637-7098.

6. Q. I can't run Microsoft Windows in standard mode. What can I do?

   A. On a 386 or 486 computer, if you are using EMM386.SYS to provide
      UMB support for the DOS LOADHIGH or DEVICEHIGH command, Windows
      must be loaded in real or enhanced mode.

      If you must run Windows in standard mode, edit your CONFIG.SYS
      file  to "remark" the line reading

         DEVICE=EMM386

      to read as follows:

         REM DEVICE=EMM386

      Save your edited CONFIG.SYS file and reboot your computer. To
      load Windows in standard mode, enter WIN/S.

      To re-enable expanded memory and UMB support, re-edit your
      CONFIG.SYS file to remove the "remark," save the change, and
      reboot.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbref kbfasttip kbdisplay<BR>
KBSubcategory: win30<BR>
Additional reference words: 3.00 3.00a 3.0a 3.0 install ivrfax avs<BR>
QWW30<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
