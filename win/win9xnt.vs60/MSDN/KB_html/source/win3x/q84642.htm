

<HTML>
<HEAD>
<TITLE>MS-DOS-Based Application Runs out of Environment Space </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84642 ">
<META NAME="KBModify" CONTENT="1997/10/21">
<META NAME="KBCreate" CONTENT="1992/05/18">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  If you receive the error message  not enough environment space  while running or attempting to run an MS-DOS-based application (also known as an MS-DOS virtual machine [VM]) under Microsoft Windows version 3.0 or 3.1, increase the environment space...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAX1,QDL9,QBWO,QBWN,QA26,QAH4,QAJH,QBWQ,QBW5,QABA,QBWS,QBXT,QBXS,QBFY,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>MS-DOS-Based Application Runs out of Environment Space</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84642 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a, 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you receive the error message "not enough environment space" while
running or attempting to run an MS-DOS-based application (also known
as an MS-DOS virtual machine [VM]) under Microsoft Windows version 3.0
or 3.1, increase the environment space for this application.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When an MS-DOS-based application is executed, its environment space
defaults to the MS-DOS default, which is 256 bytes.
<P>
Under Windows 3.0, the only way to increase the environment space in a
VM is through the MS-DOS-based application's program information file
(PIF). The following is a sample PIF file that does this:
<P>
<PRE>    Field                   Information
    -----                   -----------

    Program Name            COMMAND.COM
    Program Title           My Program
    Optional Parameters     /E:2048 /C C:\MYDIR\MYPROG.EXE
    Startup Directory       C:\MYDIR

</PRE>"/E:2048" is the size of the environment space in bytes; this value can
range from 160 to 32,768.
<P>
"MYDIR" is the name of the directory that contains the executable of
the program.
<P>
"MYPROG.EXE" is the name of the program.
<P>
With Windows 3.1, you can either use the above procedure to increase
the size of the environment, or you can add the following line to the
[NonWindowsApp] section in the SYSTEM.INI file:
<P>
<PRE>   [NonWindowsApp]
   CommandEnvSize=2048

</PRE>The above example sets a VM environment size of 2048 bytes. This value
can range from 160 to 32,768.
<P>
Under Windows 3.1, the Environment size setting in the PIF file will
override the CommandEnvSize= setting in the SYSTEM.INI file.
<P>
NOTE: The CommandEnvSize= line will automatically be placed in the
SYSTEM.INI file when you install Windows 3.1 if there is a SHELL
statement in the CONFIG.SYS. If there is no a SHELL statement, you
will have to add this line to the SYSTEM.INI file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kberrmsg<BR>
KBSubcategory: winmem win31 win30<BR>
Additional reference words: 3.00 3.10 non dos err msg win95 sms<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
