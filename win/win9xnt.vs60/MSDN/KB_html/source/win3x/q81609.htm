

<HTML>
<HEAD>
<TITLE>Err Msg: 'Incorrect System Version' When Starting MS-DOS App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q81609 ">
<META NAME="KBModify" CONTENT="1994/11/23">
<META NAME="KBCreate" CONTENT="1992/03/11">
<META NAME="Keywords" CONTENT="kbother kbdisplay kbtshoot kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  You may receive one of the following error messages when you try to run an MS-DOS-based application under Microsoft Windows or Windows for Workgroups in the 386 enhanced mode:   - Incorrect system version; reinstall the 386 enhanced mode of Windows...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDL9,QBWN,QBWQ,QAFI,QANE,QBXB,QATJ,QAA1,QAGQ,QDIO,QA50,QAFK,QDI2,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Err Msg: 'Incorrect System Version' When Starting MS-DOS App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 23, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q81609 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
<LI>Microsoft Windows for Workgroups versions 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive one of the following error messages when you try to run an
MS-DOS-based application under Microsoft Windows or Windows for Workgroups
in the 386 enhanced mode:

<UL><LI>Incorrect system version; reinstall the 386 enhanced mode of Windows

<LI>Incompatible Version of Operating System
<P>
</UL><h2>CAUSES</h2>
 
<P>
The problem is probably caused by one of the following:

<UL><LI>The video grabber does not match the virtual display device.

<LI>An old WINOA386.MOD file resides in the Windows\SYSTEM subdirectory.

<LI>The machine has a duplicate COMMAND.COM file (dated prior to your
   current version) in the Windows directory.

<LI>You have a WINOA386.MOD file in both the Windows and Windows\SYSTEM
   subdirectory.
<P>
</UL><h2>WORKAROUND</h2>
 
<P>
To correct these problems, see the appropriate section below.
<P>
<P><h3>Wrong Video Grabber</h3>
 
<P>
The SYSTEM.INI file contains three entries that specify which video driver
you use in the 386 enhanced mode of Windows. These are the "386Grabber" and
"display.drv" entries in the [boot] section and the "display" entry in the
[386Enh] section. The error message above usually occurs when one of these
entries is not consistent with the others--usually due to using a Windows
version 3.0 video driver with Windows version 3.1.
<P>
If you are using display drivers not included with Windows 3.1, contact
your display adapter manufacturer to get an updated driver installation
disk.
<P>
In many cases, you can work around this problem by manually installing the
version 3.0 driver files that are included on the Windows 3.1 Setup disks.
If your display driver works in Windows 3.0 using the standard VGA virtual
display device file (specified by "display=*vddvga" in the [386Enh] section
of the SYSTEM.INI file), then do the following:

<OL><P><LI>Copy and expand the VDDVGA30.386 file from the Windows 3.1 Setup
   Disk 1 (5.25-inch or 3.5-inch disk set) into your Windows 3.1
   SYSTEM subdirectory.
<P>
   To expand the VDDVGA30.386 file, use the Expand utility
   (EXPAND.EXE) in the Windows directory. If you are unsure of the
   syntax for using Expand, type "expand /?" (without quotation marks)
   at the MS-DOS command prompt.

<P><LI>Change the line "display=..." in the [386Enh] section of SYSTEM.INI
   to read:
<P>
<P><PRE>      display=VDDVGA30.386
</PRE><P>
</OL>If your display driver works in Windows 3.0 using the standard VGA grabber
file (specified by "386Grabber=VGA.3GR" in the [boot] section of the
SYSTEM.INI file), then do the following:

<OL><P><LI>Copy and expand the VGA30.3GR file from the Windows 3.1 Setup disks
   (Disk 3 for the 5.25-inch disk set and Disk 2 for the 3.5-inch disk
   set) into your Windows 3.1 SYSTEM subdirectory.
<P>
   To expand the VGA30.3GR file, use the Expand utility (EXPAND.EXE)
   in the Windows directory. If you are unsure of the syntax for using
   Expand, type "expand /?" (without quotation marks) at the MS-DOS
   command prompt.

<P><LI>Change the line "386Grabber=" in the [boot] section of the
   SYSTEM.INI file to read:
<P>
<P><PRE>      386Grabber=VGA30.3GR
</PRE><P>
</OL><h3>Old WINOA386.MOD File</h3>
 
<P>
To determine if this is the problem, do the following:

<OL><P><LI>Run File Manager.

<P><LI>Change to the root directory (C:\).

<P><LI>From the File menu, choose Search.

<P><LI>In the Search For box, type "*.MOD" (without quotation marks). Make
   sure the Search All Subdirectories check box is selected, and
   choose the OK button.

<P><LI>When the Search Results window appears, choose All File Details
   from the View menu.

<P><LI>If the WINOA386.MOD file is not in the Windows\SYSTEM directory, or
   if the file is has a date earlier than March 10, 1992, delete it.

<P><LI>If you deleted a file in step 6, copy and expand the WINOA386.MOD
   file from the Windows 3.1 Setup Disk 4 (5.25-inch or 3.5-inch disk
   set) into your Windows 3.1 SYSTEM subdirectory.
<P>
   To expand the WINOA386.MOD file, use the Expand utility
   (EXPAND.EXE) in the Windows directory. If you are unsure of the
   syntax for using Expand, type "expand /?" (without quotation marks)
   at the MS-DOS command prompt.
<P>
</OL><h3>Duplicate COMMAND.COM File</h3>
 
<P>
You should have two COMMAND.COM files on your machine: one in your root
directory and the other in the directory that contains your MS-DOS files
(typically C:\DOS). If you have an extra COMMAND.COM file, it is probably
in your Windows directory and it is probably dated prior to the version of
COMMAND.COM loaded when you booted MS-DOS. You need to delete this file.
<P>
To verify that this is the problem, double-click on the COMMAND.COM file in
the root directory and it will launch a virtual MS-DOS machine.
<P>
<P><h3>Duplicate WINOA386.MOD File</h3>
 
<P>
To work correct this situation, delete the WINOA386.MOD file from the
Windows directory.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbother kbdisplay kbtshoot kberrmsg<BR>
KBSubcategory: wfwg win30 win31 wfw wfwg<BR>
Additional reference words: tshoot 3.10 3.1 3.00 3.0 3.11 applications<BR>
c:\windows<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 23, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
