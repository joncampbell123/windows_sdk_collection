

<HTML>
<HEAD>
<TITLE>Using Novell's ODI Drivers with Windows for Workgroups </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97767 ">
<META NAME="KBModify" CONTENT="1997/02/11">
<META NAME="KBCreate" CONTENT="1993/04/20">
<META NAME="Keywords" CONTENT="kbnetwork kbsetup kb3rdparty kbfasttip">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" The following article contains information about using Windows for Workgroups with third-party products or configurations that have not been tested and are not supported by Microsoft.  If the steps or procedures described in this article do not func...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QA8Y,QDL9,QBWN,QAIB,QAVZ,QAU9,QBFY,QBWQ,QAIA,QDKH,QAA1,QBXT,QA5V,QDIZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Novell's ODI Drivers with Windows for Workgroups</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97767 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.1
</UL> 
<P>
The following article contains information about using Windows for
Workgroups with third-party products or configurations that have not
been tested and are not supported by Microsoft.
<P>
If the steps or procedures described in this article do not function
properly, use a supported configuration or contact the manufacturer of
the third-party product for more information.
<P>
<P><h2>SUMMARY</h2>
 
<P>
Some Novell NetWare network-based applications require the Novell open
data-link interface (ODI) transport/media-access-control drivers to
operate. Windows for Workgroups version 3.1 uses MSIPX to emulate IPX and
does not support Novell's ODI drivers. Novell has developed a workaround
using ODINSUP.COM to enable the ODI drivers with Windows for Workgroups.
<P>
Microsoft can ensure connectivity between Windows for Workgroups version
3.1 and Novell NetWare only while running MSIPX.COM. If Novell's procedure
for enabling the ODI drivers does not work, contact Novell Technical
Support for more information or possible solutions.
<P>
NOTE: Microsoft Windows for Workgroups version 3.11 works well with Novell
NetWare. You must have ODI working first. If you have ODI working and
connecting to your Novell server, all you need to do under Windows for
Workgroups version 3.11 is add ODI support to your Network Setup (no MSIPX
is needed).
<P>
The remainder of this article applies to Windows for Workgroups 3.1 only.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
While the specification of Windows for Workgroups version 3.1 is MSIPX, an
exclusively NDIS-compliant protocol, Novell's ODINSUP.COM, allows NDIS
protocol stacks to run unmodified over the ODI LSL and talk to an ODI
LAN driver. Novell's LSL can be accessed by adding the ODINSUP driver.
Novell makes these files available on its bulletin board service (BBS)
and in the Novell CompuServe forum. The current filename is
DOSUP7.ZIP; however, it may change from time to time. Contact your
Novell service person or the Novell CompuServe forum for more
information on availability.
<P>
Below are the steps to configure Windows for Workgroups 3.1 using an
NE2000 network card with Novell's ODINSUP driver. The modified
configuration files include the following:
<P>
<PRE>   CONFIG.SYS
   AUTOEXEC.BAT
   NET.CFG
   PROTOCOL.INI

</PRE><h3>Before You Begin</h3>
 
<P>
Since this configuration requires the Novell IPXODI drivers, you must
have your machines set up and attached to a Novell server using
IPXODI.COM at MS-DOS before proceeding to the "Setup Instructions"
below.
<P>
Be sure to back up your AUTOEXEC.BAT file so that you can restore this
configuration later if necessary.
<P>
<P><h3>Setup Instructions</h3>
 

<OL><P><LI>Install Windows for Workgroups with your network card and Novell
   NetWare as a secondary network.

<P><LI>Edit the CONFIG.SYS file and remove or remark out the following
   lines:
<P>
<P><PRE>      DEVICE=C:\WINDOWS\&lt;NE2000.DOS&gt;
      DEVICE=C:\WINDOWS\MSIPX.SYS
</PRE><P>
   NOTE: If you are using a different network card, the NDIS network
   card driver (&lt;NE2000.DOS&gt; in the above example) will be different.

<P><LI>Edit the AUTOEXEC.BAT file as follows.
<P>
   a. Remove or remark out the following lines:
<P>
<PRE>         C:\WINDOWS\NET START

      -and-

         C:\WINDOWS\MSIPX.COM

   b. Verify that your AUTOEXEC.BAT contains these lines:

         C:\&lt;PATH&gt;\LSL.COM
         C:\&lt;PATH&gt;\&lt;your netcard's ODI MAC driver&gt;.COM
         C:\&lt;PATH&gt;\ODINSUP.COM
         C:\WINDOWS\Net Start Netbind
         C:\&lt;PATH&gt;\IPXODI.COM
         C:\&lt;PATH&gt;\NETX.EXE

</PRE><P><LI>Edit the NET.CFG file and verify that it contains the following lines.
   If these lines don't exist, add them to the appropriate sections of
   the NET.CFG file. If you do not have a NET.CFG file, create one using
   a text editor (such as Microsoft Windows Notepad), and save it in the
   directory that LSL.COM is executed from.
<P>
<P><PRE>      PROTOCOL ODINSUP
<PRE></PRE>          BIND NE2000
          BUFFERED
      LINK DRIVER NE2000 &lt;== where NE2000 is the filename of your
                                netcard's ODI driver&gt;
          INT n        &lt;== where "n" is the one-digit interrupt number
          MEM nnnnn    &lt;== where "nnnnn" is the five-digit memory address
          PORT ###     &lt;== where "nnn" is the three-digit I/O port address
          FRAME ETHERNET_802.2
          FRAME ETHERNET_802.3
          FRAME ETHERNET_II
          FRAME ETHERNET_SNAP
          PROTOCOL IPX 0 ETHERNET_802.3

   NOTE: if you've been using ODI to attaching to a Novell server at
   DOS and you haven't specified the INT, MEM, PORT, DMA, SLOT, etc.,
   parameters in the NET.CFG file, you probably don't need to add them
   now. However, depending on the ODI MAC driver (Novell refers to
   this as the "MLID") you are using, you may need to place the INT,
   MEM, PORT, etc., lines after the FRAME lines. Additionally, list
   your network's frame type FIRST in the list of "FRAME
   ETHERNET_xxxx" entries. (This probably will be "ETHERNET_802.3"
   or "ETHERNET_II.")

</PRE><P><LI>Edit the PROTOCOL.INI file as follows:
<P>
   Replace the "BINDINGS=" lines in the [MS$NETBEUI] and [IPX$] sections
   with the Novell ODI MAC driver (MLID) as follows:
<P>
<P><PRE>      [MS$NETBEUI]
      DRIVERNAME=NETBEUI$
      SESSIONS=10
      NCBS=32
      ;BINDINGS=MS$NE2000  &lt;== NDIS MAC driver, NE2000.DOS
<PRE></PRE>      BINDINGS=NE2000      &lt;== ODI MLID, NE2000.COM
      LANABASE=1

      [IPX$]
      DRIVERNAME=IPX$
      MEDIATYPE=NOVELL/ETHERNET
      ;BINDINGS=MS$NE2000  &lt;== NDIS MAC driver, NE2000.DOS
      BINDINGS=NE2000      &lt;== ODI MLID, NE2000.COM

</PRE></OL>IMPORTANT: If the ODI MLID filename begins with a numeral, you must
preface the filename with an "X" (without the quotation marks) in the
"BINDINGS=" statement. For example, 3COM's 3C509 network adapter card
uses an ODI MLID with a filename of "3C509.COM." In the PROTOCOL.INI
file, the "BINDINGS=" statements would need to be
<P>
<PRE>   BINDINGS=x3C509

</PRE>WARNING: After you make these modifications, do NOT make any changes
in the Networks dialog box of Control Panel. If you do, the
CONFIG.SYS, AUTOEXEC.BAT, and PROTOCOL.INI files will be overwritten.
<P>
<P><h2>EXAMPLES</h2>
 
<P>
Below are samples of what modified CONFIG.SYS, AUTOEXEC.BAT, NET.CFG,
and PROTOCOL.INI files look like if you are using Novell's ODINSUP
driver.
<P>
<P><h3>CONFIG.SYS</h3>
 
<P>
FILES=30
BUFFERS=30
DEVICE=C:\WINDOWS\PROTMAN.DOS /I:C:\WINDOWS
DEVICE=C:\WINDOWS\WORKGRP.SYS
LASTDRIVE=P
DEVICE=C:\WINDOWS\HIMEM.SYS
STACKS=9,256
<P>
<P><h3>AUTOEXEC.BAT</h3>
 
<P>
PATH=C:\WINDOWS
C:\WINDOWS\SMARTDRV.EXE
LSL
NE2000
ODINSUP
C:\WINDOWS\NET START NETBIND
IPXODI
NETX
SET TEMP=C:\WINDOWS\TEMP
Q:
LOGIN SUPERVISOR
<P>
<P><h3>NET.CFG</h3>
 
<P>
PROTOCOL ODINSUP
BIND NE2000
BUFFERED
LINK DRIVER NE2000
;The following 4 lines are required with ODINSUP and ethernet cards.
<PRE>   FRAME ETHERNET_802.3
   FRAME ETHERNET_802.2
   FRAME ETHERNET_II
   FRAME ETHERNET_SNAP

</PRE><h3>PROTOCOL.INI</h3>
 
<P>
[NETWORK.SETUP]
VERSION=0X3100
NETCARD=NE2000,1,NE2000
TRANSPORT=MS$NETBEUI,MS$NETBEUI
TRANSPORT=IPX,IPX
LANA0=NE2000,1,IPX
LANA1=NE2000,1,MS$NETBEUI
[PROTMAN]
DRIVERNAME=PROTMAN$
PRIORITY=MS$NETBEUI
[NE2000]
DRIVERNAME=NE2000
IOBASE=0X300
INTERRUPT=3
[MS$NETBEUI]
DRIVERNAME=NETBEUI$
SESSIONS=10
NCBS=32
BINDINGS=NE2000
LANABASE=1
[IPX]
DRIVERNAME=IPX
MEDIATYPE=NOVELL/ETHERNET
BINDINGS=NE2000
<P>
For additional information concerning Novell's ODINSUP.COM, contact
Novell Technical Support at (800) 638-9273.
<P>
Novell NetWare and ODINSUP.COM are manufactured by Novell, a vendor
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbsetup kb3rdparty kbfasttip<BR>
KBSubcategory: wfw wfwg<BR>
Additional reference words: 3.10 3.1 tcp/ip lsl.com<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
