

<HTML>
<HEAD>
<TITLE>WW0653: Using Automated Setup: Setup /H </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92448 ">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1992/11/05">
<META NAME="Keywords" CONTENT="kbappnote kbdisplay kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT=" Microsoft has an Application Note titled  Using Automated Setup: Setup /h  (WW0653) that describes the Windows 3.1 Automated Setup option, SETUP /H (also called Batch Mode Setup). You can use Automated Setup to set up either a shared or nonshared co...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QDL9,QBWO,QBWN,QBWQ,QBBI,QAVZ,QABA,QBAO,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>WW0653: Using Automated Setup: Setup /H</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92448 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.11
WINDOWS
kbfile kbdisplay kbappnote
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
Microsoft has an Application Note titled "Using Automated Setup: Setup /h"
(WW0653) that describes the Windows 3.1 Automated Setup option, SETUP /H
(also called Batch Mode Setup). You can use Automated Setup to set up
either a shared or nonshared copy of Windows, and you can use it whether
you are setting up Windows from a network drive or from the Windows Setup
disks.
<P>
You can obtain this Application Note from the following sources:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<LI>The Internet (Microsoft anonymous ftp server)
<LI>Microsoft Download Service (MSDL)
<LI>Microsoft Product Support Services
<P>
</UL>For complete information, see the "To Obtain This Application Note"
section at the end of this article.
<P>
<P><h2>THE TEXT OF WW0653</h2>
 
<P>
 
<PRE>  Microsoft(R) Product Support Services Application Note (Text File)
                WW0653: USING AUTOMATED SETUP: SETUP /H
</PRE> 
<PRE>                                                  Revision Date: 10/92
                                                      No Disk Included

</PRE>The following information applies to Microsoft Windows(TM) version
3.1.
<P>
<PRE> --------------------------------------------------------------------
| INFORMATION PROVIDED IN THIS DOCUMENT AND ANY SOFTWARE THAT MAY    |
| ACCOMPANY THIS DOCUMENT (collectively referred to as an            |
| Application Note) IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY      |
| KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO    |
| THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A     |
| PARTICULAR PURPOSE. The user assumes the entire risk as to the     |
| accuracy and the use of this Application Note. This Application    |
| Note may be copied and distributed subject to the following        |
| conditions: 1) All text must be copied without modification and    |
| all pages must be included; 2) If software is included, all files  |
| on the disk(s) must be copied without modification [the MS-DOS(R)  |
| utility DISKCOPY is appropriate for this purpose]; 3) All          |
| components of this Application Note must be distributed together;  |
| and 4) This Application Note may not be distributed for profit.    |
|                                                                    |
| Copyright 1992 Microsoft Corporation. All Rights Reserved.         |
| Microsoft and MS-DOS are registered trademarks and Windows         |
| is a trademark of Microsoft Corporation.                           |
| HP and LaserJet are registered trademarks of Hewlett-Packard       |
| Company.                                                           |
 --------------------------------------------------------------------

                    USING AUTOMATED SETUP: SETUP /H
                    ===============================

</PRE>The Microsoft Windows operating system version 3.1 Automated Setup
option (also called Batch Mode Setup) uses information that you define
in a system settings file to install Windows quickly and easily, with
little or no user interaction. Automated Setup is useful if you have
to set up many workstations or if you want users to be able to set up
Windows on their own workstations without having to make any system
configuration choices, such as hardware components and printers, or
choices about which optional Windows components to install.
<P>
You can use Automated Setup to set up either a shared or nonshared
copy of Windows, and you can use it whether you are setting up Windows
from a network drive or from the Windows Setup disks.
<P>
<PRE>  NOTE: Before you run the Setup program, turn off any network
  messaging services or terminate-and-stay-resident programs (TSRs)
  that allow the network or another user to send a message to your
  screen. These pop-up programs can cause Windows Setup to fail if a
  message is received while Windows is being installed.

</PRE><h2>TO USE THE AUTOMATED SETUP OPTION:</h2>
 

<OL><P><LI>Create a system settings file for each workstation configuration.
<P>
   For details, see the following section, "Creating the System
   Settings File."

<P><LI>Place the system settings file(s) in a directory where users have
   rights to open and read files. You can also copy the settings file
   to a user's local drive or to a bootable floppy disk.

<P><LI>If you are setting up Windows from a network, connect to the
   network drive and change to the directory where the Windows Setup
   files are located. If you are setting up Windows from the Windows
   Setup disks, change to the floppy disk drive. You can also set up
   Windows from the user's workstation.

<P><LI>If you want to run a shared copy of Windows from the network, type
<P>
<P><PRE>     setup /h:[&lt;path&gt;]&lt;filename&gt; /n
</PRE><P>
   where &lt;filename&gt; is the name of the system settings file that
   contains details about the system configuration. Include a path if
   the system settings file is not in the directory where you are
   setting up Windows.
<P>
   For example, connect to the network drive and directory where the
   Windows Setup files are located. Create a system settings file
   named SETUPVGA.SHH in the same directory as the Setup program. At
   the command prompt, type "setup /h:setupvga.shh /n" (without the
   quotation marks) and press ENTER.
<P>
   If you want to run a nonshared copy of Windows from a local drive
   or a network drive, type:
<P>
<P><PRE>     setup /h:[&lt;path&gt;]&lt;filename&gt;
</PRE><P>
   For example, create a system settings file named SETUPVGA.SHH in
   the same directory as the Setup program. At the command prompt type
   "setup /h:setupvga.shh" (without the quotation marks) and press
   ENTER.
<P>
</OL><h2>CREATING THE SYSTEM SETTINGS FILE</h2>
 
<P>
Windows comes with a system settings template file called SETUP.SHH,
which you can copy or modify to create a custom system settings file.
The SETUP.SHH file is located on Microsoft Windows 3.1 Disk 1 and is
copied to the shared Windows directory when you use SETUP /A. You can
modify this file with any text editor (such as Notepad) that can save
unformatted text (ASCII) files.
<P>
<PRE>  NOTE: When you create the .SHH file, use only ANSI characters;
  characters that may be included in any other code page character set
  currently installed on your system are not supported.

</PRE></OL>The sections in the system settings file are summarized in the
following table. Valid entries for each section are described after
this table.
<P>
<PRE>  Section         Purpose
  ------------------------------------------------------------------

  [sysinfo]       Species whether the System Information screen is
                  displayed during Setup

  [configuration] Specifies the various devices on the user's system

  [windir]        Specifies where to put Windows files

  [userinfo]      Specifies the user and company name

  [dontinstall]   Specifies components that should not be installed

  [options]       Specifies various Setup options such as viewing
                  README files, setting up existing applications, and
                  starting the Windows tutorial

  [printers]      Specifies printers to set up

  [endinstall]    Specifies whether Setup modifies the CONFIG.SYS and
                  AUTOEXEC.BAT files and whether the system is
                  rebooted after Windows is installed

</PRE>Many of the entries require values from the Windows SETUP.INF,
CONTROL.INF, and WIN.INI files. When you use SETUP /A to place Windows
files on a network server, the SETUP.INF, CONTROL.INF, and WIN.INI
files are copied to the shared Windows directory. The master WIN.INI
and SYSTEM.INI files are called WIN.SRC and SYSTEM.SRC in this
directory. You can also find SETUP.INF on Microsoft Windows 3.1 Disk
1. You can print or view all of these text files with any text editor.
<P>
<P><h3>[sysinfo]</h3>
 
<P>
The System Information screen gives users the option of confirming or
changing system configuration settings before continuing with Setup.
Specify showsysinfo=yes to display the screen, or showsysinfo=no if
you don't want to display the screen. (The default is no.)
<P>
<P><h3>[configuration]</h3>
 
<P>
If an entry for a device is not included in this section, Windows will
use the detected or default device. The following table describes
valid device settings. Each of these settings requires information
from the SETUP.INF file.
<P>
<PRE>  Use            To
  -----------------------------------------------------------------

  machine=       Specify the type of machine by using a profile
                 string from the [machine] section of SETUP.INF.
                 Example: machine=ibm_compatible.

  display=       Specify the type of display by using a profile
                 string from the [display] section of SETUP.INF.
                 Example: display=vga.

  mouse=         Specify the type of pointing device by using a
                 profile string from the [pointing.device] section
                 of SETUP.INF. Example: mouse=ps2mouse.

  network=       Specify the type of network and the version number.
                 Use a profile string from the [network] section of
                 SETUP.INF to specify the network . Example:
                 network=lanman.

                 If there is a [&lt;network_version&gt;] section in
                 SETUP.INF--for example, [lanman.versions]--use a
                 number from that section to specify the version for
                 your network. Separate the version number from the
                 network type with a slash (/). Example:
                 network=lanman/01020000 sets up Microsoft LAN
                 Manager version 2.0 Enhanced.

                 If you do not specify a version number and your
                 network software is loaded when you run Setup,
                 Windows sets up the version that it detects.

  keyboard=      Specify the type of keyboard by using a profile
                 string from the [keyboard.types] section of
                 SETUP.INF. Example: keyboard=t4s0enha.

  language=      Specify the language by using a profile string from
                 the [language] section of SETUP.INF. Example:
                 language=enu.

  kblayout=      Specify the keyboard layout by using a profile
                 string from the [keyboard.tables] section of
                 SETUP.INF. Example: kblayout=nodll.

</PRE>If you are updating Windows, Setup ignores some of these entries and
uses the devices that are already installed. If you want to override
an installed device, precede the machine=, display=, mouse=, and
network= values with an exclamation point (!)--for example,
display=!vga. Any keyboard=, language=, or kblayout= values specified
will automatically override and update the currently installed device.
<P>
<P><h3>[windir]</h3>
 
<P>
This section specifies where to place the user's Windows files. If
Windows is already installed in the directory specified here, Setup
updates the Windows files. For example, if you want to install Windows
in the WINDOWS directory on drive C, specify "c:\windows" (without the
quotation marks) in this section. This setting overrides the value of
defdir= in the [data] section of SETUP.INF. If you do not specify a
directory here, or if the directory you specify is not valid, a dialog
box appears during Setup asking for the directory where you want to
set up Windows.
<P>
<P><h3>[userinfo]</h3>
 
<P>
This section specifies the user and company name. The first line
specifies the user name. This line is required unless you are setting
up a shared copy of Windows by using SETUP /N (see "Note," below). The
second line specifies the company name and is optional. Each name can
be up to 30 characters long and must be enclosed in double quotation
marks (" ") if it includes blank spaces. For example:
<P>
<PRE>   "Susan Smith"
   "My Company"

</PRE>If you do not specify a user name, a dialog box appears during Setup
to ask for the name.
<P>
<PRE>  NOTE: If you use SETUP /N to set up a shared copy of Windows, the
  [userinfo] section is ignored because the information was supplied
  when you used SETUP /A to copy Windows files to the server.

</PRE><h3>[dontinstall]</h3>
 
<P>
This section specifies optional Windows components that you do not
want Windows to set up. If this section is not present or is empty,
all optional components are set up. You can choose not to install the
components listed in the following table:
<P>
<PRE>  Specify        If you do not want Windows to install
  --------------------------------------------------------

  readmes        Readme files.

  accessories    Accessories (however, WRITE.EXE is always
                 installed).

  games          Games.

  screensavers   Screen savers.

  bitmaps        Background wallpapers.

</PRE><h3>[options]</h3>
 
<P>
This section specifies whether a user can set up applications during
Setup and whether to start the Windows Tutorial at the end of Setup.
If you don't want any of these options, omit this section. Valid
entries for this section are shown in the following table:
<P>
<PRE>  Specify        To
  ------------------------------------------------------------------

  setupapps      Set up applications interactively during Setup. The
                 Add/Remove File dialog box appears during Setup so
                 the user can choose which applications to install.

  autosetupapps  Automatically set up all applications found on the
                 user's hard disk.

  tutorial       Start the Windows Tutorial at the end of Setup.

</PRE>You should not specify both setupapps and autosetupapps, but if you
do, Windows sets up all applications it finds on the hard disk.
<P>
<P><h3>[printers]</h3>
 
<P>
This section specifies which printers to install during Setup. To
install a printer, specify a printer name and a port. Use one of the
descriptive strings found in the [io.device] section of the
CONTROL.INF file to specify the printer name. The printer name must be
enclosed in double quotation marks (" ") if it contains blank spaces.
Use one of the values found in the [ports] section of the WIN.INI file
to specify the port. The printer name and the port must be separated
by a comma. For example, to specify the HP(R) LaserJet(R) III printer
connected to port LPT1, include this entry:
<P>
<PRE>   "HP LaserJet III",LPT1:

</PRE>If you don't want to install any printers during Setup, omit this
section.
<P>
<P><h3>[endinstall]</h3>
 
<P>
This section specifies what should happen after Windows is
successfully installed. You can specify whether Setup should modify
the CONFIG.SYS and AUTOEXEC.BAT files, and then whether to exit to MS-
DOS, restart Windows, or restart the system.
<P>
<PRE>  Specify             If you want Setup to
  -----------------------------------------------------------------------

  configfiles=modify  Make all changes to CONFIG.SYS and AUTOEXEC.BAT.
                      When Setup changes these files, the previous
                      CONFIG.SYS and AUTOEXEC.BAT files are saved as
                      CONFIG.OLD and AUTOEXEC.OLD in the root directory.
                      (If CONFIG.OLD or AUTOEXEC.OLD are already present,
                      the previous file will be renamed CONFIG.000 or
                      AUTOEXEC.000, or the next number that does not
                      conflict with an existing file.) If you are setting
                      up Windows on a diskless workstation, Setup
                      disregards this entry.

  configfiles=save    Save proposed changes to CONFIG.SYS and
                      AUTOEXEC.BAT in alternate files (CONFIG.WIN and
                      AUTOEXEC.WIN) stored in the Windows directory. The
                      CONFIG.SYS and AUTOEXEC.BAT files are not changed;
                      you must make these changes later. (If CONFIG.WIN
                      or AUTOEXEC.WIN are already present, the previous
                      file will be renamed CONFIG.000 or AUTOEXEC.000, or
                      the next number that does not conflict with an
                      existing file.)

  endopt=exit         Return to MS-DOS on completion of Setup.

  endopt=restart      Restart Windows on completion of Setup.

  endopt=reboot       Restart the user's system on completion of Setup.
                      If this setting is specified and the user uses
                      SETUP /N to install Windows, Setup will return to
                      MS-DOS without rebooting after completing the
                      installation.

</PRE><h2>SAMPLE SYSTEM SETTINGS FILE</h2>
 
<P>
The following system settings file installs Windows on a PC-compatible
computer with these characteristics:
<P>
<PRE>    - The system includes a VGA display, a Microsoft Mouse, LAN
      Manager 2.0 Enhanced local area network software, and a 101-key
      U.S. keyboard.

    - The System Information screen is displayed for confirmation, and
      Windows files are placed in the C:\WINDOWS directory.

    - The games are not installed.

    - An HP LaserJet III printer is installed on LPT1.

    - The CONFIG.SYS and AUTOEXEC.BAT files are modified by Setup.

    - After Setup is complete, Windows is restarted.

   [sysinfo]
   showsysinfo=yes

   [configuration]
   machine=ibm_compatible
   display=vga
   mouse=ps2mouse
   network=lanman/01020000
   keyboard=t4s0enha
   language=enu
   kblayout=nodll

   [windir]
   c:\windows

   [userinfo]
   "user's name"
   "company name"

   [dontinstall]
   games

   [options]

   [printers]
   "HP LaserJet III",LPT1:

   [endinstall]
   configfiles=modify
   endopt=restart

</PRE> 
<P><h2>TO OBTAIN THIS APPLICATION NOTE</h2>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/ww0653.exe">WW0653.EXE</A> <I>(size: 21096 bytes)</I> 
                       , a self-extracting file, on the following
</PRE>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/ww0653.exe">WW0653.EXE</A> <I>(size: 21096 bytes)</I> 
                             , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/ww0653.exe">WW0653.EXE</A> <I>(size: 21096 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/ww0653.exe">WW0653.EXE</A> <I>(size: 21096 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE><LI>If you are unable to access the source(s) listed above, you can
   have this Application Note mailed or faxed to you by calling
   Microsoft Product Support Services Monday through Friday, 6:00 A.M.
   to 6:00 P.M. Pacific time at (425) 637-7098. If you are outside the
   United States, contact the Microsoft subsidiary for your area.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbfile kbdisplay kbappnote<BR>
KBSubcategory:<BR>
Additional reference words: appnote win31 3.10<BR>
Keywords            : kbappnote kbdisplay kbfile<BR>
Version             : 3.10 3.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
