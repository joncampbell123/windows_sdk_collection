

<HTML>
<HEAD>
<TITLE>Contents of IPX.WRI included with the WRK </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q84259 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/05/06">
<META NAME="Keywords" CONTENT="kbnetwork kb3rdparty kbref">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  The following information was taken from the Microsoft Windows operating system version 3.1 Windows Resource Kit's IPX.WRI file.  MORE INFORMATION  The Microsoft IPX Upgrade Utility (NEWIPX.EXE) is designed to help network administrators who need t...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBCU,QAA1,QAC1,QDL9,QBWO,QBWN,QAGU,QDNQ,QBWS,QAA5,QBXB,QATJ,QBWQ,QAY2,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Contents of IPX.WRI included with the WRK</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q84259 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following information was taken from the Microsoft Windows
operating system version 3.1 Windows Resource Kit's IPX.WRI file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft IPX Upgrade Utility (NEWIPX.EXE) is designed to help
network administrators who need to update the version of Novell
NetWare on their client workstations in order to run Windows 3.1.
<P>
The Windows 3.1 components provided by Novell require the workstation
to be running recent versions of the NetWare client software: the
NetWare shell, IPX, and(if you are running ODI model) LSL. Updated
versions of these components are included with Windows 3.1 and
copied to the user's Windows System directory when Setup detects
NetWare. They are also copied to a shared Windows directory when an
installed using Administrative Setup (SETUP /A).
<P>
Instructions for upgrading a workstation are provided in the Windows
NETWORKS.WRI on-line document. The NetWare shell and the ODI-model
IPXODI.COM and LSL.COM are quite easy to install. However, to\177
upgrade a dedicated-model IPX.COM requires the administrator to use a
whole set of NetWare utilities to link a new version of IPX.COM and
manually configure its hardware options.
<P>
The Microsoft IPX Upgrade Utility is designed to automate this
time-consuming process, allowing new versions of IPX.COM to be built
and properly configured without human intervention.
<P>
The utility can be run from a shared network drive or from a floppy
disk. It can be run by the end user, by an administrator, or from of
the user's login script or AUTOEXEC.BAT file. When run in an
automated fashion, the batch file or login script can determine what
action was taken and perform any appropriate action.
<P>
<P>
Using the Upgrade Utility
<P>
Before people run the upgrade utility, the system admin must set up a
directory from which users will run the utility. This directory can
be on a server or on a floppy diskette, although we recommend it be
the server's PUBLIC directory. The administrator must copy into this
directory the following files:
<P>
<PRE>  1. The Microsoft IPX Upgrade Utility
  2. The version of IPX.OBJ provided with Windows 3.1 (also in the
     IPX directory on the Windows Resource Kit disk)
  3. The NetWare NLINK utility (NLINK.EXE)
  4. The network card driver .OBJ files required for their
   workstations.

</PRE>In order to upgrade a workstation, the user or technician will:
<P>
<PRE>  1. Start the network and log in, giving them access to the PUBLIC
     directory. (Or, alternatively, insert a floppy containing the
     utility and other required files.)
  2. start the utility, specifying the location of their IPX.COM file.

</PRE>Functional Overview
<P>
The utility is invoked with the location of the user's current
IPX.COM. All other files are expected to be in the same
location as the utility itself.
<P>
It will first compare the version of the user's current IPX.COM with
the IPX.OBJ provided. If the IPX.OBJ is newer, it will upgrade the
user's workstations.  It will automatically locate the proper NIC
driver .OBJ file and link it with the updated IPX.OBJ to form a new
IPX.COM. It will then copy any hardware configuration options from
the original file to the new one. There is no need to run the Novell
SHGEN, WSGEN, DCONFIG, ECONFIG, or JUMPERS utilities.
<P>
Finally, it will rename the original IPX.COM to a unique backup
filename (such as IPX.BAK) and rename the new version
to IPX.COM. If for any reason you need to revert back to the original
version, you can simply rename the files once again.
<P>
Command Line Syntax
<P>
Syntax: NEWIPX NetWare-Dir [/?]
<P>
<PRE>        The NetWare-Dir parameter specifies the location of the
        workstation's current IPX.COM.

        The /? switch displays a brief description of the
        utility and ts syntax.

</PRE>For example, if the utility and other required files are located in
the PUBLIC directory which is on the user's PATH, and the
workstation's IPX.COM is located in the NOVELL directory on the C:
drive, the user would enter the following command:
<P>
<PRE>        NEWIPX C:\NOVELL

</PRE>Or, if the utility is being run from a NetWare login script, you would
use a line such as the following:
<P>
<PRE>        #Z:\NEWIPX C:\NOVELL

</PRE>Note: If you are running NEWIPX from a NetWare Login Script, you must
specify its location using a fully-qualified path. This is required
because of the way the NetWare Login utility starts applications under
some circumstances. If you do not use the fully-qualfied pathname,
and the utility is located on a network drive, you may receive
incorrect error messages or files may not get updated when they
should.
<P>
Handling success and failure cases.
<P>
The upgrade utility will always exit with an MS-DOS status code
indicating whether or not it attempted to upgrade the workstation, and
whether that operation was successful.
<P>
<PRE>        Value           Meaning
        0               The IPX.COM does not need to be upgraded.
        1               The IPX.COM has been successfully upgraded.
        2 or higher     An error occurred that prevented the IPX.COM
                        from being upgraded.

</PRE>These status codes can be used in both batch files and in login
scripts. Here is a sample fragment which demonstrates how
a login script could handle these status codes:
<P>
<PRE>        #z:\newipx c:\novell
        if "%ERROR_LEVEL"&gt;"1" then begin fire phasers
        write "Warning: your workstation software could not
        be upgraded." write "Please report this to your system
        administrator."
        pause
        end

        if "%ERROR_LEVEL"="1" then begin
        fire phasers
        write "Your workstation software has been modified."
        write "You should restart your workstation before continuing."
        pause
        end if

</PRE>The following sample fragment which demonstrates how an AUTOEXEC.BAT
file could handle these status codes:
<P>
<PRE>        z:\newipx c:\novell
        if errorlevel 2 goto ipx_err
        if errorlevel 1 goto ipx_new
        goto ipx_ok

        :ipx_err
        echo Warning: your workstation software could not be upgraded.
        echo Please inform your system admininistrator.
        pause
        goto ipx_ok

        :ipx_new
        echo Your workstation software has been modified.
        echo You should restart your workstation before continuing.
        pause
        goto ipx_ok

        :ipx_ok

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kb3rdparty kbref<BR>
KBSubcategory:<BR>
Additional reference words: 3.10 Network win 31 Shell<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
