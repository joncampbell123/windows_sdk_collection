

<HTML>
<HEAD>
<TITLE>Unable to Print to LPT1/LPT2 on Novell NetWare 3.11 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83549 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/04/15">
<META NAME="Keywords" CONTENT="kbprint kb3rdparty kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  Microsoft Windows operating system versions 3.0 and 3.1 may not be able to print to either LPT1 and LPT1.OS2 or LPT2 and LPT2.OS2 on a Novell network.  CAUSE =====  Novell has confirmed that when using Novell NetWare 3.11 in conjunction with NETx.C...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC2,QDNQ,QDL9,QBWO,QBWN,QA8Y,QAH4,QAUR,QAOX,QABA,QAR5,QDIR,QBFY,QAYY,QAVZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Unable to Print to LPT1/LPT2 on Novell NetWare 3.11</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83549 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.0, 3.0a, 3.1, 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Windows operating system versions 3.0 and 3.1 may not be
able to print to either LPT1 and LPT1.OS2 or LPT2 and LPT2.OS2 on a
Novell network.
<P>
<P><h2>CAUSE</h2>
 
<P>
Novell has confirmed that when using Novell NetWare 3.11 in
conjunction with NETx.COM on Intel 80286 microprocessor-based
computers, LPT1 parallel port address 0378h may be overwritten with
03BCh. LPT2 and LPT3 default addresses may also be overwritten on
INTEL 80386 and 80486 microprocessor-based computers with the same
address (03BCh).
<P>
NETx.COM changes the address in the BIOS that defines where to send
data for LPT1 from the default (0378h) to 03BCh. When programs are
printed to the parallel port through MS-DOS, the BIOS sends the data
to 03BCh and the boards never see the data through their default
addresses.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
<P><h3>Sending Data to LPT1</h3>
 
<P>
For LPT1 to work properly, its default address must be restored. Two
methods for restoring the LPT1 address are listed as follows:

<UL><LI>Program the following in C (using any standard C Compiler):
<P>
<P><PRE>      int far *pt;
      pt=MK_FP (0,0x408);
      *pt=0x378h;
</PRE><P>
   Save the file as C:\FIXLPT1.COM and add the program to the
   AUTOEXEC.BAT file after NETx.COM, but before the LOGIN program, as
   follows:
<P>
<P><PRE>      NETx.COM
      FIXLPT1.COM
      NET LOGIN
</PRE><P>
   -or-

<LI>Use Windows Notepad to create the following Debug script for LPT1:
<P>
<P><PRE>      E40:8
      78 03
      q (Press the ENTER key)
</PRE><P>
   NOTE: Do NOT include the parenthetical statement in script.

</UL><OL><P><LI>Save the file as C:\FIXLPT1.DEB and add the Debug script to the
   AUTOEXEC.BAT file after NETx.COM, but before the LOGIN program as
   follows:
<P>
<P><PRE>      NETx.COM
      DEBUG &lt; FIXLPT1.DEB
      NET LOGIN
</PRE>
<P><LI>Save the AUTOEXEC.BAT file and restart the machine.
<P>
</OL>These programs insert the value 0378h into the BIOS data area address
0000:0408h.
<P>
<P><h3>Sending Data to LPT2</h3>
 
<P>
If data output should be sent to LPT2, use the value 040Ah in the C
program (see step 1, above) by replacing
<P>
<PRE>   (0,0x408);

   with:

   (0,0x40A);

</PRE></OL>In the Debug script (see step 2, above), change E40:8 to E40:A. The
address default 0278h may also be used for either LPT1 or LPT2.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For further information concerning problems printing to parallel ports
over a Novell network, contact Novell Technical Support.
<P>
The products included here are manufactured by vendors independent of
Microsoft; we make no warranty, implied or otherwise, regarding these
products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprint kb3rdparty kbnetwork<BR>
KBSubcategory: win31<BR>
Additional reference words: 3.00 3.00a 3.10 5.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
