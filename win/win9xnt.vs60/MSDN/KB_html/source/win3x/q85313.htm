

<HTML>
<HEAD>
<TITLE>Procedure for Network Installation of Windows Driver Library </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q85313 ">
<META NAME="KBModify" CONTENT="1994/11/21">
<META NAME="KBCreate" CONTENT="1992/06/07">
<META NAME="Keywords" CONTENT="kbnetwork kbdisplay kb3rdparty kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  When installing an updated driver from the Windows Driver Library (WDL), you must first expand the driver from the .EXE file, and then copy the driver to the Windows 3.1 Shared network directory.  If you update a driver for an individual workstatio...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBXB,QATJ,QBWQ,QAFI,QAA1,QAU9,QDI2,QA3A,QAB4,QAVZ,QAY2,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Procedure for Network Installation of Windows Driver Library</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 21, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q85313 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows operating system versions 3.1, 3.11
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When installing an updated driver from the Windows Driver Library (WDL),
you must first expand the driver from the .EXE file, and then copy the
driver to the Windows 3.1 Shared network directory.
<P>
If you update a driver for an individual workstation running Windows from a
network drive, the updated drivers do not get copied to the Windows Shared
or User directory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Errors Encountered when Drivers Are Not Installed Correctly</h3>
 
<P>
When Setup /N is run from the MS-DOS command prompt and you configure
Windows to use a driver that resides in a directory other than the Shared
or User directory (by choosing "Other"), Setup appears to work correctly.
However when Windows is started, various error messages may appear,
depending upon the driver that is being used. The error message usually
includes:
<P>
<PRE>   Invalid Vxd dynamic link call to device 000A, service 0007.
   Your Windows configuration is invalid. Run Setup again to correct
   this problem.

</PRE>When Setup is run from a shared installation of Windows, a system setting
is changed to "Other", Windows will display the following error within
Windows as soon as the change is made:
<P>
<PRE>  The filename FILENAME.EXT, needed to install this driver, is not
  available on the network. Your system does not have permission to
  copy the file to the network. See your system administrator for
  assistance. To continue installing the driver, choose OK. To quit
  driver installation, choose Cancel.

</PRE>Choosing Cancel at this point leaves the system unchanged. Choosing OK
produces two more of the above messages (referring to two different
files). When Windows is restarted, the "Invalid Vxd dynamic link
call..." error message noted above will be displayed.
<P>
<P><h3>Steps for Installing WDL files on a Shared Network Drive</h3>
 

<OL><P><LI>Connect to the Windows 3.1 Shared network directory and a User
    directory. You must have read, write, and create privileges on
    the Shared directory and the User directory. Make sure both
    Shared and User directories are in the MS-DOS path.

<P><LI>Create a new temporary directory on a local or network drive.
    You will be expanding the individual driver files into this
    directory.

<P><LI>Copy the updated driver file (for example, TSENG1.EXE) into the
    directory you created in step 2.

<P><LI>Change to the directory created in step 2.

<P><LI>Run the file you copied, by typing the file's executable name
    (for example, type "TSENG1" [without the quotation marks] for the
    step 3 example). This will extract the individual files from the
    .EXE file.

<P><LI>Delete the .EXE file from the temporary directory that was created
    in step 2.

<P><LI>Check the Windows Shared directory for any OEM*.INF files (such as
    OEM0.INF) and rename the OEMSETUP.INF file in the temporary
    directory to the next sequential OEM*.INF file.
<P>
       Example 1: If the Windows Shared directory contains OEM0.INF
       and OEM1.INF, rename the OEMSETUP.INF in the temporary directory
       to OEM2.INF.
<P>
       Example 2: There is no OEM0.INF in the Windows Shared directory.
       Rename the OEMSETUP.INF file OEM0.INF in the temporary directory.

<P><LI>At the MS-DOS command prompt, type
<P>
       expand -r *.*
<P>
   in the temporary directory created in step 2.

<P><LI>The Expand utility will then ask for a destination directory.
    Choose the Windows Shared directory on the network (such as
    X:\WINSHARE). This will expand the individual files to a usable
    state and copy them to the correct location (the Windows Shared
    drive).

<P><LI>Copy all the OEM*.INF files from the Windows Shared drive to the
    User directory. (The Expand *.* command has already copied the
    OEM*.INF files to the Windows Shared directory.)

<P><LI>Run Setup /N from the User directory or double-click the Setup
    icon on the workstation. You will now be able to install and use
    the new drivers.
<P>
</OL>For information on "Installing drivers not supplied with Windows 3.1",
please see Chapter 15 of the "Microsoft Windows User's Guide" for
version 3.1.
<P>
For a complete listing of the WDL's contents and instructions for
obtaining the WDL, query on "<B><A href="../win3x/q82006.htm">Q82006</A></B>" in the Microsoft Knowledge Base.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbdisplay kb3rdparty kbsetup<BR>
KBSubcategory: win31<BR>
Additional reference words: winshare Novell Pathworks Lantastic LanMan 3Com<BR>
Banyan video 3.10 3.1 3.11<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 21, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
