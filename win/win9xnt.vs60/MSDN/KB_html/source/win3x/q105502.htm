

<HTML>
<HEAD>
<TITLE>CAS Modem Fails to Receive Faxes with WFWG 3.11 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105502">
<META NAME="KBModify" CONTENT="1994/11/22">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="kbtool kbfasttip kbatwork kb3rdparty kbhw">
<META NAME="KBArea" CONTENT="Support; KB; win3x, crossnet">
<META NAME="Description" CONTENT="  If you are using Microsoft Windows for Workgroups version 3.11 with 32-bit file access enabled and you have an Intel CAS fax modem, your modem may fail to receive faxes.  CAUSE =====  Intel CAS fax modems require a driver called CASMGR.EXE, which c...">
<META NAME="Product" CONTENT="Windows 3.1 and Windows for Workgroups">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QAVU,QAY2,QDL9,QBWN,QAJZ,QAKP,QAEF,QDKW,QAS6,QBWQ,QDKH,QBW7,QANE,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>CAS Modem Fails to Receive Faxes with WFWG 3.11</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 22, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105502</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows for Workgroups version 3.11
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you are using Microsoft Windows for Workgroups version 3.11 with
32-bit file access enabled and you have an Intel CAS fax modem, your
modem may fail to receive faxes.
<P>
<P><h2>CAUSE</h2>
 
<P>
Intel CAS fax modems require a driver called CASMGR.EXE, which can be
run from the AUTOEXEC.BAT file or from the MS-DOS command prompt. This
driver is responsible for communicating API calls from fax
applications to the CAS modem and for sending information from the fax
modem to the fax applications. When the CAS fax modem receives a fax,
CASMGR.EXE spools this information to the hard disk drive. CASMGR.EXE
opens the file in a virtual machine (VM) and obtains a handle. It then
uses the handle to write to the file as data comes in from the fax
board (often at interrupt time).
<P>
The problem occurs if a second VM is active at the same time. The
second VM is using a handle that is only valid for the first VM.
<P>
NOTE: By default, Windows for Workgroups 3.11 starts a second VM to
run the server; therefore, this problem is likely to occur.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, you can either:

<UL><LI>Disable 32-bit file access in Windows for Workgroups.
<P>
   -or-

<LI>Remove the CASMGR.EXE line from your AUTOEXEC.BAT file, and add it
   to your WINSTART.BAT file. To create a WINSTART.BAT file, use a text
   editor, such as Notepad, to create a file with that name; type the
   CASMGR.EXE line that you cut from your AUTOEXEC.BAT file into the new
   WINSTART.BAT file; save the WINSTART.BAT file in your Windows
   directory, and restart your system. WINSTART.BAT loads the CASMGR.EXE
   file into the system VM only, and ensures that all its file input/
   output occurs from that VM.
<P>
   NOTE: This workaround prevents any MS-DOS-based applications that
   require CASMGR.EXE from accessing the fax modem.
<P>
   WARNING: If you use a WINSTART.BAT file with Microsoft Windows version
   3.1 in 386 enhanced mode, the system may stop responding (hang) when
   you exit Windows. The only solution to this problem is to delete or
   rename WINSTART.BAT and load the programs in WINSTART.BAT from the
   AUTOEXEC.BAT file.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
For more information on WINSTART.BAT, refer to page 531 of the
Microsoft Windows "User's Guide" for version 3.1.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Windows for Workgroups
version 3.11. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes
available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kbfasttip kbatwork kb3rdparty kbhw<BR>
KBSubcategory: wfw wfwg wincomm awfax<BR>
Additional reference words: wincomm 3.11 VFAT EFAX<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 22, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
