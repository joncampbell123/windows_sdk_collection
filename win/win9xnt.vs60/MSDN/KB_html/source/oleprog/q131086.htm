

<HTML>
<HEAD>
<TITLE>SAMPLE: SAFEARAY: Use of Safe Arrays in Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131086">
<META NAME="KBModify" CONTENT="1997/06/25">
<META NAME="KBCreate" CONTENT="1995/06/02">
<META NAME="Keywords" CONTENT="kbfile kbprg LeTwoAt kbfile kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  SAFEARAY is an OLE Automation server application that demonstrates the use of safe arrays.  You can find SAFEARAY.EXE, a self-extracting file, on these services:  The following file is available from the Microsoft Software Library:   ~ Safearay.exe...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAUD,QAJ4,QAI5,QA9Q,QA2K,QAY2,QAPN,QAPF,QAB6,QBW7,QBHQ,QBWG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: SAFEARAY: Use of Safe Arrays in Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131086</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries for Windows and Win32s, version 2.03
<LI>Microsoft OLE libraries included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SAFEARAY is an OLE Automation server application that demonstrates the
use of safe arrays.
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/safearay.exe">SAFEARAY.EXE</A> <I>(size: 42352 bytes)</I> 
                         , a self-extracting file, on these services:

</PRE>The following file is available from the Microsoft Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/safearay.exe">Safearay.exe</A> <I>(size: 42352 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TILE      : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
SAFEARAY implements the following methods (in addition to the standard
application object methods).
<P>
SlowSort: Sorts an input safearray of BSTRs and returns the sorted array
and the time required for the sort. The array is passed by reference
because it needs to be modified by the sort. SlowSort uses
SafeArrayGetElement and SafeArrayPutElement to access the array
elements.
<P>
FastSort: Has the same functionality as SlowSort but uses
SafeArrayAccessData to get a pointer to the array elements. This allows
array elements to be accessed directly instead of using
SafeArrayGetElement and SafeArrayPutElement. This accounts for the speed
improvement over SlowSort.
<P>
Average: Finds the average of an input safe array of integers. The array
is not passed by reference.
<P>
GetArray: Creates and returns a safe array of BSTRs.
<P>
See the README.TXT included for instructions to compile and run this
sample.
<P>
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbfile kbprg LeTwoAt kbfile kbhowto kbprg<BR>
Version             : 2.03 4.0 | 3.5 3.51<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>
Resolution Type     : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
