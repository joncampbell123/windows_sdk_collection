

<HTML>
<HEAD>
<TITLE>PRB: Property or Method Name Not Recognized on Some Machines </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131053">
<META NAME="KBModify" CONTENT="1995/06/06">
<META NAME="KBCreate" CONTENT="1995/06/02">
<META NAME="Keywords" CONTENT="kbprg kbole kbprb">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  If the sLangage and iCountry fields in the [intl] section of WIN.INI are missing or have incorrect entries, IDispatch::GetIDsOfNames fails (it returns the DISP_E_UNKNOWNNAME error) if it is implemented using DispGetIDsOfNames or CreateStdDispatch a...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QA7N,QBHQ,QAH4,QBTX,QA4C,QAAP,QAKP,QAB5,QAWP,QDH6,QBVV,QAY5,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Property or Method Name Not Recognized on Some Machines</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131053</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries for Windows and Win32s, version 2.03
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the sLangage and iCountry fields in the [intl] section of WIN.INI are
missing or have incorrect entries, IDispatch::GetIDsOfNames fails (it
returns the DISP_E_UNKNOWNNAME error) if it is implemented using
DispGetIDsOfNames or CreateStdDispatch and a typeinfo created using an
INTERFACEDATA structure.
<P>
<P><h2>CAUSE</h2>
 
<P>
If an automation server's IDispatch is implemented using a typeinfo created
from the INTERFACEDATA structure, access of properties or methods may fail
on some computers. These computers may have missing or incorrect sLanguage
and iCountry fields in the [intl] section of WIN.INI. These fields are used
by DispGetIDsOfNames and CreateStdDispatch's IDispatch::GetIDsOfNames to
obtain locale information. These functions fail (DISP_E_UNKNOWNNAME) if the
locale information cannot be obtained.
<P>
RESOLUTION
 
<P>
To solve this problem, modify the fields in WIN.INI to look similar to
this:
<P>
<PRE>   [intl]
   sLanguage=enu
   iCountry=1

</PRE>Where:

<UL><LI>enu means U.S. English.
<LI>iCountry specifies the country code. This number matches the country's
   international telephone code, except for Canada, which is 2. The default
   is 1.
<P>
</UL>You can also change these fields by using the International Control Panel
applet by selecting the appropriate Country and Language.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design. This problem doesn't occur with typeinfos
obtained from type libraries. Microsoft strongly recommends that type
libraries be used for the implementation of IDispatch. The INTERFACEDATA
approach was a temporary solution to create typeinfos while type libraries
were in Beta.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.0 2.00<BR>
KBCategory: kbprg kbole kbprb<BR>
KBSubcategory: LeTwoAto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
