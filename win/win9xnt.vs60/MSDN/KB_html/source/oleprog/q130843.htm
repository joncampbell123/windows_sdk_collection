

<HTML>
<HEAD>
<TITLE>SAMPLE: MFCINP16: Inproc 16-bit MFC Automation Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130843">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1995/05/30">
<META NAME="Keywords" CONTENT="LeTwoAto kbfile kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  MFC's App Wizard will not generate an inproc OLE Automation server. This article gives you the steps to follow to create an inproc automation server using MFC. MFCINP16, a sample available in the Microsoft Software Library, is a 16-bit inproc autom...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QAPN,QA2K,QBJZ,QAY2,QAB5,QBXS,QAG2,QAW6,QAPF,QAVZ,QA2Q,QAJ4,QAJN,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: MFCINP16: Inproc 16-bit MFC Automation Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130843</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.03 1.52
WINDOWS
kbole kbprg kbfile
<P>
 
The information in this article applies to:

<UL><LI>Microsoft OLE version 2.03
<LI>Microsoft Foundation Classes (MFC) included with
   Microsoft Visual C++ for Windows, version 1.52
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
MFC's App Wizard will not generate an inproc OLE Automation server. This
article gives you the steps to follow to create an inproc automation server
using MFC. MFCINP16, a sample available in the Microsoft Software Library,
is a 16-bit inproc automation object that was created using the steps in
this article.
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/mfcinp16.exe">MFCINP16.EXE</A> <I>(size: 48563 bytes)</I> 
                         , a self-extracting file, on these services:

</PRE><LI>Microsoft's World Wide Web site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon
      Click Knowledge Base, and select the product
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/mfcinp16.exe">MFCINP16.EXE</A> <I>(size: 48563 bytes)</I> 
                               , and click GO!
      Open the article, and click the button to download the file

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder
      Get <A href="http://support.microsoft.com/download/support/mslfiles/mfcinp16.exe">MFCINP16.EXE</A> <I>(size: 48563 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location
      Type "mssupport" (without the quotation marks)
      Double-click the MS Software Library icon
      Find the appropriate product area
      Locate and Download MFCINP16.EXE
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/mfcinp16.exe">MFCINP16.EXE</A> <I>(size: 48563 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
MFC's App Wizard doesn't generate inproc (DLL) OLE servers because it is
not possible for MFC to fully implement one that can open into a separate
window. MFC needs to hook into the client's main message retrieval loop to
translate accelerators of the separate window and to implement idle-time
processing. OLE doesn't provide such a mechansim. It is entirely possible
to implement an inproc server in MFC with no user interface or with a very
simple user interface. This article shows you how.
<P>
<P><h3>Steps to Create a 16-Bit Inproc Automation Object in MFC</h3>
 
<P>
It is assumed that Visual C++ version 1.51 or greater and the Control
Development Kit have been installed.

<OL><P><LI>Use INPROC.CPP, INPROC.H, and STDAFX.H from the sample as the starting
   point. Copy these into a new directory. The names INPROC.CPP and
   INPROC.H can be changed to something more appropriate for your project.

<P><LI>Create a new project by choosing New from the Project menu and selecting
   the Windows dynamic-link library as the type. Add INPROC.CPP to this
   project. (The sample uses inproc for the project name.)

<P><LI>From the Options menu, choose Project and select Compiler. Add the
   following in the C/C++ CompilerOptions dialog box under the
   CustomOptions category in the OtherOptions edit control:
<P>
   /D "_USRDLL"
<P>
   From the Options menu, choose Project and select Linker. Add the
   following libraries in the LinkerOptions dialog box under the Input
   category in the Libraries edit control:
<P>
   ole2, compobj, ole2disp, typelib, ole2nls, mfcoleui, storage

<P><LI>Choose ClassWizard from the Project menu. ClassWizard will complain that
   the .CLW file does not exist. It will ask you to rebuild the .CLW file
   by opening the project in App Studio and running ClassWizard.

<P><LI>Open AppStudio by choosing it from the Tools menu. Save the resource
   file, and run ClassWizard from AppStudio by choosing ClassWizard from
   the Resource menu. The CLW file will now be built after you choose OK in
   the SelectSourceFiles dialog box. Complet the following steps:
<P>
   a. Select the OLE Automation tab in the MFC ClassWizard dialog.
<P>
   b. Choose the AddClass button, and add a class of type CCmdTarget.
<P>
   c. Select the OLEAutomation check box.
<P>
   d. Select the OLECreatable check box, and provide an ExternalName
<P><PRE>      (progID) if this is a top-level automation object. This external name
      will be used by the automation controller/client to create the
      object. (The sample creates a class called TestObject, which has an
      external name Inproc.TestObject.)
</PRE>
<P><LI>Add the required automation properties and methods to the newly
   created class. (The sample creates a method called TestMethod that
   returns void and has no parameters. The method calls MessageBeep.)

<P><LI>Attempt to build the project. Visual C++ will ask if you want to
   create a default .DEF file. Edit the default .DEF file to export the
   following:
<P>
   DllGetClassObject
   DllCanUnloadNow
   DllRegisterServer

<P><LI>Build the project. Register the inproc Automation object by choosing
   RegisterControl from the Tools menu.

<P><LI>VB.MAK and VB.FRM in the sample are Visual Basic version 3.0 files that
   you can use to control the object.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.03 1.52<BR>
KBCategory: kbole kbprg kbfile<BR>
KBSubcategory: LeTwoAto<BR>
Keywords          : LeTwoAto kbfile kbole kbprg<BR>
Technology        : kbMfc<BR>
Version           : 2.03 1.52<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
