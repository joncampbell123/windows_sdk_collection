

<HTML>
<HEAD>
<TITLE>SAMPLE: Multilingual OLE Automation Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q107698">
<META NAME="KBModify" CONTENT="1996/06/03">
<META NAME="KBCreate" CONTENT="1993/11/24">
<META NAME="Keywords" CONTENT="kbole kbfile">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  MULTLING demonstrates how to create an OLE automation object that supports multiple languages. This allows the controller of an automation object to access properties and methods using any of the languages that are supported.  You can find MULTLING...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QA2K,QAAQ,QBWS,QAVZ,QBHQ,QA9Q,QAJ4,QBWI,QDL9,QBWO,QBWN,QAO0,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Multilingual OLE Automation Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q107698</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries for Windows and Win32s, version 2.0
<LI>Microsoft OLE Libraries, included with:
<P><PRE>    - Microsoft Windows NT, versions 3.5 and 3.51
    - Microsoft Windows 95
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
MULTLING demonstrates how to create an OLE automation object that supports
multiple languages. This allows the controller of an automation object to
access properties and methods using any of the languages that are
supported.
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/multling.exe">MULTLING.EXE</A> <I>(size: 29766 bytes)</I> 
                         , a self-extracting file, on these services:

</PRE><LI>Microsoft's World Wide Web site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon
      Click Knowledge Base, and select the product
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/multling.exe">MULTLING.EXE</A> <I>(size: 29766 bytes)</I> 
                               , and click GO!
      Open the article, and click the button to download the file

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder
      Get <A href="http://support.microsoft.com/download/support/mslfiles/multling.exe">MULTLING.EXE</A> <I>(size: 29766 bytes)</I> 
</PRE>
<LI>The Microsoft Network
<P><PRE>      On the Edit menu, click Go To, and then click Other Location
      Type "mssupport" (without the quotation marks)
      Double-click the MS Software Library icon
      Find the appropriate product area
      Locate and Download MULTLING.EXE
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/multling.exe">MULTLING.EXE</A> <I>(size: 29766 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services


</PRE><h2>MORE INFORMATION</h2>
 
<P>
This multilingual OLE automation object sample checks the Locale ID (LCID)
passed methods of the IDispatch interface to determine the language being
used by the automation controller. The object supports access of properties
and methods in English, French, and German.
<P>
<P><h3>One Type Library Per Language</h3>
 
<P>
The automation object registers three different type libraries in the
registration database--one for each supported language. The type libraries
have the same UUIDs but different locale attributes. Each type library is
loaded at object creation and the ITypeInfo interface is obtained from each
as follows (see LoadTypeInfo in MAIN.CPP):
<P>
<PRE>   LoadRegTypeLib(LIBID_Hello, 1, 0, lcid, &amp;ptlib);
   ptlib-&gt;GetTypeInfoOfGuid(IID_IHello, &amp;ptinfo);

</PRE>Also see ENGLISH.ODL, FRENCH.ODL, GERMAN.ODL, and HELLO.REG.
<P>
<P><h3>Interpret LCID in IDispatch Methods</h3>
 
<P>
The implementation of IDispatch::GetTypeInfo, GetIDsOfNames, and Invoke
checks the value of the lcid parameter to determine the locale ID and uses
the appropriate ITypeInfo for that language (See CHello::GetTypeInfo,
GetIDsOfNames, and Invoke in HELLO.CPP).
<P>
<P><h3>To Run</h3>
 
<P>
The multilingual automation object exposes one VT_BSTR property
(HelloMessage) and one method (SayHello).
<P>
<PRE>ProgID                  :  HelloMultiLingual.Hello

</PRE>Method and Property Names:
<P>
<PRE>English         French         German          Action
</PRE> 
<P>
<PRE>HelloMessage    SalutMessage   HalloNachricht  Sets or gets the
                                               HelloMessage string.
SayHello        DitSalut       SagHallo        Displays the HelloMessage
                                               in an edit control.

</PRE>Use the AUTOCTRL sample to control the multilingual automation object. The
AUTOCTRL automation controller allows the locale ID to be specified.
<P>
Update the path in HELLO.REG to the current location of the object and the
type libraries.
<P>
<P><h3>To Compile</h3>
 
<P>
Requires OLE 2.01 or later.
<P>
Include device=vmb.386 in the [386Enh] section of SYSTEM.INI.
Note that vmb.386 can be found in \OLE2\BIN.
Run the WXSERVER.EXE from \OLE2\BIN before running the makefile.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00 3.50 4.00 multi-lingual softlib<BR>
MULTLING.EXE<BR>
KBCategory: kbole kbfile<BR>
KBSubcategory: LeTwoAto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
