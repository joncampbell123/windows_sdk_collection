

<HTML>
<HEAD>
<TITLE>Using OLE in Services in Windows NT 3.51 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149571">
<META NAME="KBModify" CONTENT="1996/04/05">
<META NAME="KBCreate" CONTENT="1996/04/04">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  OLE cannot be used between processes running in different security contexts in Windows NT 3.51 and earlier versions. It can be used between processes running in the same security context. For example, OLE cannot be used between a process running in...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QACK,QBWS,QA9Q,QBWP,QAJQ,QAAD,QBG2,QAYV,QAI5,QARL,QAGU,QAB5,QAW6,QAPN,QAK7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using OLE in Services in Windows NT 3.51</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149571</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE libraries included with
   Microsoft Windows NT version 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
OLE cannot be used between processes running in different security contexts
in Windows NT 3.51 and earlier versions. It can be used between processes
running in the same security context. For example, OLE cannot be used
between a process running in a user's account and a service logged on the
LocalSystem account (even if the service interacts with the desktop).
However OLE can be used between a process running in a user's account and a
service logged on to the same account.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A service can easily implement an OLE client because any OLE server that it
launches will run in the same security context as the client. However a
service that implements an OLE client will not be able to bind to a running
server in a different security context. The service will be able to bind to
a running server in the same security context using the Running Object
Table.
<P>
A service that implements an OLE server must run in the same security
context as the client that uses it. If the client is a process that runs in
a user's account, the service must also log on to that user's account. This
can be done by using the Services control-panel application as follows:

<UL><LI>Select the service and select the StartUp button. This will bring up
   the Service dialog.

<LI>Select 'Log On As This Account' and specify the user account name in
   the form of "DomainName\Username" and the password of that user
   account.
<P>
</UL>Or this can be done programatically by specifying the appropriate values
for the lpServiceStartName and lpPassword parameters of CreateService().
Make sure that the service lists the OLE service as a dependency. The
service can be configured to run automatically when the machine boots, or
it can be launched manually. The client can create a new object in the
service by using CoCreateInstance if the service is running and if it has
registered a multiple-use class factory. OLE will not launch the service,
so the service must be running before CoCreateInstance is called. The
client can bind to a running object in the service by using
IRunningObjectTable::GetObject or GetActiveObject if the service has
registered the object in the Running Object Table.
<P>
The next version of Windows NT will allow processes in different security
contexts to communicate using OLE.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2 OLE2 2.0 2.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: LeTwoArc
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
