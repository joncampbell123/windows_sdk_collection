

<HTML>
<HEAD>
<TITLE>SAMPLE: MFCARRAY Using Safe Arrays in MFC Automation </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140202">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1995/11/27">
<META NAME="Keywords" CONTENT="LeTwoAt">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  MFCARRAY is an MFC OLE Automation server application that demonstrates the use of safe arrays. The array is passed to and returned from automation methods in a VARIANT.  Microsoft Visual C++ 5.0 was used to create the automation server. Vb.vbp and ...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAD7,QA2K,QAH7,QAH6,QDL9,QBWO,QBWN,QAUD,QAPF,QBWP,QAY2,QAB6,QBS0,QAJ4,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: MFCARRAY Using Safe Arrays in MFC Automation</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140202</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, versions 4.0, 5.0
<LI>Microsoft OLE libraries included with:
   - Microsoft Windows NT versions 3.5, 4.0
   - Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
MFCARRAY is an MFC OLE Automation server application that demonstrates the
use of safe arrays. The array is passed to and returned from automation
methods in a VARIANT.
<P>
Microsoft Visual C++ 5.0 was used to create the automation server. Vb.vbp
and Vb.frm in the sample are Visual Basic 5.0 files that can be used to
control the automation server.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/mfcarray.exe">Mfcarray.exe</A> <I>(size: 44187 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>After downloading the file, use the following command to extract the sample
and build the appropriate directory structure:
<P>
<PRE>   MFCARRAY.EXE -d

</PRE><h2>MORE INFORMATION</h2>
 
<P>
MFCARRAY implements the following methods:

<UL><LI>SlowSort: Sorts an input safearray of BSTRs and returns the sorted array
   and the time required for the sort. The array is passed by reference
   because it needs to be modified by the sort. SlowSort uses
   SafeArrayGetElement and SafeArrayPutElement to gain access to the array
   elements.

<LI>FastSort: Sorts an input safearray of BSTRs as does SlowSort but uses
   SafeArrayAccessData to get a pointer to the array elements. This allows
   direct access to the array elements instead of using SafeArrayGetElement
   and SafeArrayPutElement. This accounts for the speed improvement over
   SlowSort.

<LI>Average: Finds the average of an input safe array of integers. The array
   is not passed by reference.

<LI>GetArray: Creates and returns a safe array of BSTRs.
<P>
</UL>REFERENCE
 
<P>
For an example of referencing the values that are in a VARIANT that
contains a SAFEARRAY in an MFC client, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../visualc/q167668.htm">Q167668</A></B>
   TITLE     : HOWTO: Pass a SafeArray of Strings in a VARIANT*
</PRE> 
<PRE>Keywords          : LeTwoAt
Technology        : kbole
Version           : WINDOWS:4.0; WINDOWS NT:5.0,4.0,3.5;
Platform          : NT WINDOWS
Issue type        : kbfile
Solution Type     : kbsample</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
