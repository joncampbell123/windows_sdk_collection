

<HTML>
<HEAD>
<TITLE>BUG: Local COM Connections Timeout After Six Minutes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167133">
<META NAME="KBModify" CONTENT="1997/04/24">
<META NAME="KBCreate" CONTENT="1997/04/17">
<META NAME="Keywords" CONTENT="LeTwoCom kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  COM objects created locally are subject to the same  pinging  that remote objects are (see  Distributed Component Object Model Protocol -- DCOM/1.0  internet-draft, section 2.5 and 2.5.1 for a specification of this  pinging  mechanism in COM). This...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW9,QAKP,QAJQ,QAW6,QAPN,QBTX,QBWP,QBG2,QAVZ,QARL,QAI5,QAQW,QDKW,QACE,QAA1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Local COM Connections Timeout After Six Minutes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167133</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft OLE Libraries included with:
   - Microsoft Windows NT version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
COM objects created locally are subject to the same "pinging" that remote
objects are (see "Distributed Component Object Model Protocol -- DCOM/1.0"
internet-draft, section 2.5 and 2.5.1 for a specification of this "pinging"
mechanism in COM). This pinging currently includes three pings at two-
minute intervals for a total of six minutes of waiting before an
unresponsive client causes COM to release dead references on the server.
<P>
There is also a problem that manifests itself in the same timeout behavior,
but it is apparently unjustified. In this problem scenario, the server and
client are both active and responsive. However, the connection is
terminated after six minutes for no apparent reason.
<P>
<P><h2>CAUSE</h2>
 
<P>
The problem resides in the COM subsystem and is triggered by the lack of
networking software installed on the Windows platform.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, install and activate a networking protocol via
the Control Panel's Network applet. Once this is done, the timeout should
not occur unless the client has actually died.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Microsoft COM Libraries.
The problem is fixed in Service Pack 2 of Windows NT 4.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
The "Distributed Component Object Model Protocol -- DCOM/1.0" internet-
draft is available at the following addresses:
<P>
<PRE>  <B><A href="ftp://is.co.za/internet-drafts&gt;">ftp://is.co.za/internet-drafts</A></B> (Africa),<BR>
  <B><A href="ftp://nic.nordu.net/internet-drafts&gt;">ftp://nic.nordu.net/internet-drafts</A></B> (Europe)<BR>
  <B><A href="ftp://munnari.oz.au/internet-drafts&gt;">ftp://munnari.oz.au/internet-drafts</A></B> (Pacific Rim)<BR>
  <B><A href="ftp://ds.internic.net/internet-drafts&gt;">ftp://ds.internic.net/internet-drafts</A></B> (US East Coast)<BR>
  <B><A href="ftp://ftp.isi.edu/internet-drafts&gt;">ftp://ftp.isi.edu/internet-drafts</A></B> (US West Coast)<BR>
 
</PRE>
	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : LeTwoCom kbbuglist<BR>
Technology          : kbole<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
