

<HTML>
<HEAD>
<TITLE>Keeping the OleActivate Function from Failing </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83553 ">
<META NAME="KBModify" CONTENT="1995/02/17">
<META NAME="KBCreate" CONTENT="1992/04/15">
<META NAME="Keywords" CONTENT="kbole kbprg">
<META NAME="KBArea" CONTENT="Support; KB; oleprog">
<META NAME="Description" CONTENT="  The OleActivate function will fail to launch an object linking and embedding (OLE) server application for two reasons:   - The server is not installed in a directory listed in the MS-DOS    PATH environment variable or in the Windows directory.   -...">
<META NAME="Product" CONTENT="OLE (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="OLE ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9Q,QAGI,QAY5,QAJH,QBPG,QBMR,QAB9,QBVV,QBV8,QBXS,QBVX,QAUD,QAPN,QAHE,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Keeping the OleActivate Function from Failing</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 17, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83553 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft OLE version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The OleActivate function will fail to launch an object linking and
embedding (OLE) server application for two reasons:

<UL><LI>The server is not installed in a directory listed in the MS-DOS
   PATH environment variable or in the Windows directory.

<LI>The server for a particular class of object is not registered
   properly or is not available.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
When a server application is invoked to edit a linked object, the
server must read the specified file as quickly as possible and as an
uninterrupted operation (without yielding control of the processor).
If the server yields control before it has read the linked object file
and registered it, the OleActivate function can fail.
<P>
If the server application must yield the processor while reading the
file, it must first register both itself and the unread file with the
OLE library. The OleRegisterServer and OleRegisterServerDoc functions
are provided for this purpose. Once the server is registered, the
server calls the OleBlockServer function to prevent the OLE library
from calling the server until the file has been read. Calling the
OleUnblockServer function signals that the file has been read and that
the server is ready. For more information on blocking and unblocking
OLE server applications, query on the following words in the Microsoft
Knowledge Base:
<P>
<PRE>   blocking server

</PRE>Another way to handle yielding within the server is to set an internal
global flag that indicates whether or not the server application is
busy. If the server is busy, it returns the OLE_BUSY value from all
method callback functions. To implement this technique, the server
registers itself and the document (as indicated above), and sets the
internal flag. When the OLE library calls the OLESERVER, OLESERVERDOC,
or OLEOBJECT method, the server checks the global flag. If the flag is
set, the server returns OLE_BUSY. Once the file is loaded, the server
resets the global flag. Then the OLESERVER, OLESERVERDOC, and
OLEOBJECT methods can perform their regular processing.
<P>
Implementing blocking and unblocking is completely transparent to the
user and to the client application. The function calls of the client
will succeed when a server application is blocked. The OLE libraries
queue all requests to the server application until the server unblocks
itself.
<P>
Returning OLE_BUSY allows the client application to inform the user
that the server is not ready to process the request. This allows the
client application to determine whether the user wants to cancel the
application or to try again.
<P>
Either procedure is acceptable. The author of the server application
can choose the procedure deemed most appropriate.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00<BR>
KBCategory: kbole kbprg<BR>
KBSubcategory: LeOneSvr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 17, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
