

<HTML>
<HEAD>
<TITLE>How to Digitally Sign and Encrypt Messages in Outlook Express </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168726">
<META NAME="KBModify" CONTENT="1998/01/07">
<META NAME="KBCreate" CONTENT="1997/05/20">
<META NAME="Keywords" CONTENT="outexnt outexw95">
<META NAME="KBArea" CONTENT="Support; KB; ierelease">
<META NAME="Description" CONTENT="  This article describes how to configure and use the security features in Outlook Express to digitally sign and encrypt messages.  The following topics are discussed:   - Configuring security features in Outlook Express  - Digitally signing a messag...">
<META NAME="Product" CONTENT="ierelease">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAYC,QAEV,QAD2,QBXB,QAK7,QBWS,QABG,QBJZ,QBVV,QAAD,QAH6,QBXD,QBVO,QABI,QAKJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Digitally Sign and Encrypt Messages in Outlook Express</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 7, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168726</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Outlook Express version 4.0 for Windows 95
<LI>Microsoft Outlook Express version 4.0 for Windows NT 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to configure and use the security features in
Outlook Express to digitally sign and encrypt messages.
<P>
The following topics are discussed:

<UL><LI>Configuring security features in Outlook Express
<LI>Digitally signing a message
<LI>Verifying a digitally signed message
<LI>Adding a certificate to the address book
<LI>Encrypting a message
<LI>Errors received when sending encrypted messages
<LI>Additional notes
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Configuring Security Features in Outlook Express</h3>
 
<P>
To use any of the security features in Outlook Express, you must first
configure the program to use your digital ID (certificate). This article
does not outline the procedure for obtaining a certificate. For
information about obtaining a digital ID certificate, visit VeriSign's
digital ID Web page.
<P>
After you have your private key (digital ID) installed, you need to
configure Outlook Express to use the certificate by following these steps:

<OL><P><LI>On the Tools menu, click Accounts.

<P><LI>Click the Mail tab, click the mail account in which you want to use a
   digital ID, and then click Properties.

<P><LI>On the Security tab, click the "Use a digital ID when sending secure
   messages from &lt;e-mail address&gt;" check box to select it, and then click
   Digital ID.

<P><LI>Click the appropriate certificate, click OK, click OK, and then click
   Close.

<P><LI>On the Tools menu, click Options.

<P><LI>On the Security tab, click Advanced Settings.

<P><LI>If you want to send your certificate (public key) with all messages,
   click the "Include my certificate with signed messages" check box to
   select it. This allows the recipients of your messages to easily
   verify your message with your public key. For more information, see
   the "Adding a Certificate to the Address Book" section in this article.

<P><LI>If you want to specify an encryption algorithm other than RC4 40-bit,
   click the appropriate option.

<P><LI>Click OK.

<P><LI>If you want to automatically digitally sign all outgoing messages,
   click the "Add digital signature to all outgoing messages" check box
   to select it.

<P><LI>If you want to automatically encrypt all outgoing messages, click the
   "Encrypt contents and attachments for all outgoing messages" check
   box to select it.

<P><LI>Click OK, and then click OK again.
<P>
</OL><h3>Digitally Signing a Message</h3>
 
<P>
To digitally sign a message, you can use either of the following methods:

<UL><LI>Have Outlook Express automatically sign all messages each time you
   compose, reply to, or forward a message (see step 7 in the section
   titled "Configuring Security Features in Outlook Express").

<LI>Click the Digitally Sign Message button. This button displays an
   envelope with a red ribbon. You can also click Digitally Sign on the
   Tools menu.
<P>
</UL>When a message is digitally signed, a round gray icon with a white ribbon
appears to the right of the Subject line. When you click send, Outlook
Express signs the message using your private key and sends the message.
<P>
If you do not have your private key installed on your computer, Outlook
Express displays the following message:
<P>
<PRE>   The message could not be sent.

   You cannot send digitally signed messages because you do not have any
   certificates. (OK)

</PRE></OL>The recipient must have your public key to verify that the digital
signature on your message is trustworthy. Others cannot use your public
key to send messages with your digital signature.
<P>
You can include your public key with the message (see step 4 in the
section titled "Configuring Security Features in Outlook Express") or
you can send your certificate files as an attachment. If the recipient's
e-mail client is not S/MIME aware, the public key certificate appears as
a file attachment with a .p7s extension. If the e-mail client is S/MIME
aware, there is no visible enclosure.
<P>
<P><h3>Verifying a Digitally Signed Message</h3>
 
<P>
The recipient must have your public key to verify that the digital
signature on your message is trustworthy. Others cannot use your public
key to send messages with your digital signature.
<P>
When you view a digitally signed message and you have the sender's
certificate (public key) imported into your address book and marked as
Trusted By Me, the message can be viewed as expected.
<P>
If you do not have the sender's certificate (public key) imported into
your address book, Outlook Express displays the following security warning
message:
<P>
<PRE>   The certificate used to sign this message is either not listed in your
   Address Book or marked as not trusted by you.

   Continue to open this message?

</PRE>If you have the sender's public key imported into your address book and
the certificate is marked as Not Trusted By Me, Outlook Express displays
the following security warning message:
<P>
<PRE>   You do not trust the certificate used to sign this message.

   Continue to open this message?

</PRE><h3>Adding a Certificate to the Address Book</h3>
 
<P>
To be able to verify a sender's digital signature or to send encrypted
mail, you must obtain the other person's certificate (public key) and
import it into your address book.
<P>
There are two ways to obtain a public key:

<UL><LI>Look up the other person's public key by visiting VeriSign's
   Web site.

<LI>You receive a digitally signed message that includes the
   sender's certificate (public key).
<P>
</UL>This article does not describe how to obtain and install a public key from
VeriSign (method 1). For information about this method, visit VeriSign's
digital ID Web page.
<P>
To add a person's certificate to your address book from a signed message
you receive (method 2), follow these steps:

<OL><P><LI>Click the message to select it.

<P><LI>On the File menu, click Properties, and then click the Security tab.

<P><LI>Click "Add the certificate to the address book."

<P><LI>Click OK
<P>
</OL>The default trust relationship for new certificates is Not Trust. To use
the certificate, change the trust relationship by following these steps:

<OL><P><LI>On the Tools menu, click Address Book.

<P><LI>Click the person's entry to select it, and then click Properties.

<P><LI>Click the Certificates tab.

<P><LI>Click the certificate, and then click Properties.

<P><LI>On the General tab, click Trusted By Me in the Trusted box.

<P><LI>Click OK, click OK, and then click Close on the File menu to close
   the Address Book.
<P>
</OL><h3>Encrypting a Message</h3>
 
<P>
To encrypt a message so that only the recipient can decrypt the message,
you need the recipient's certificate (public key) in your address book and
the trust relationship set to Trusted By Me. See the section titled
"Adding a Certificate to the Address Book" for information about these
items.
<P>
One way to encrypt a message is to have Outlook Express automatically
encrypt all messages each time you compose, reply to, or forward a message
(see step 8 in the section titled "Configuring Security Features in
Outlook Express").
<P>
Another way is to click the Encrypt Message button on the toolbar. This
button displays an envelope with a padlock. You can also click Encrypt on
the Tools menu.
<P>
When a message is encrypted, a round gray icon with a white padlock
appears to the right of the Subject line. When you click send, Outlook
Express encrypts the message using a secret key, encrypts that key with
the recipient's public key, and sends the message.
<P>
<P><h3>Errors Received When Sending Encrypted Messages</h3>
 
<P>
If you send an encrypted message and you do not have the public key for
one or many of the recipients (including yourself, the sender), Outlook
Express displays the following security warning message:
<P>
<PRE>   You do not have a certificate. If you send this message, it will be
   sent properly, but you will not be able to read it in your sent items
   folder. Send anyway? (Yes/No)

</PRE></OL>If you try to read a message when you do not have the private key for one
of the recipients (including yourself, the sender), Outlook Express
displays the following message:
<P>
<PRE>   Your certificate is not listed among those that can decrypt this
   message. You cannot read it.

</PRE>When you click OK, Outlook Express displays one of the following
messages:

<UL><LI>This message failed to display correctly in the Preview Pane.

<LI>One or more of the messages could not be opened.
<P>
</UL>If you do not have the recipient's public key in your address book,
Outlook Express displays the following message:
<P>
<PRE>   You do not have valid certificates in the Address Book for the
   following recipients:

   &lt;list of recipients&gt;

   You must resolve the certificate problems listed above before you can
   send this message (Try Again).

</PRE><h3>Additional Notes</h3>
 
<P>
Each time you view a message that has been altered since it was sent, you
receive a warning notification. The option to not notify you again applies
to the current message only.
<P>
Some mail servers rewrite messages before sending them out. These messages
are displayed as altered when received; it does not mean that someone has
maliciously altered the message. If you receive many altered messages,
check with your mail administrator to see if your mail server is causing
the problem.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For information about how to contact VeriSign, Inc., see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../urjump.htm">Q125217</A></B>
   TITLE     : World Wide Web and FTP Servers for Computer-Related Vendors
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 s-mime pkcs7<BR>
Keywords          : outexnt outexw95<BR>
Version           : 4.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 7, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
