

<HTML>
<HEAD>
<TITLE>Limit Access to Local Computer with Internet Explorer 4.01 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179221">
<META NAME="KBModify" CONTENT="1998/01/13">
<META NAME="KBCreate" CONTENT="1998/01/13">
<META NAME="Keywords" CONTENT="kbenv kbui msiew95">
<META NAME="KBArea" CONTENT="Support; KB; ierelease">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   This article d...">
<META NAME="Product" CONTENT="ierelease">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAKD,QBXS,QDO3,QA4P,QBWQ,QABN,QAKC,QBV9,QBFY,QAMN,QDIU,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Limit Access to Local Computer with Internet Explorer 4.01</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179221</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer version 4.01 for Windows 95
<LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release 1
<LI>Microsoft Windows 95 OEM Service Release 2
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to limit access to hard disks on computers
running Internet Explorer 4.01 with Windows 95, Windows 95 with Service
Pack 1, Windows 95 OEM Service Release 1, or Windows 95 OEM Service
Release 2.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems
that may require you to reinstall Windows 95. Microsoft cannot guarantee
that problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.
<P>
NOTE: For information about how to edit the registry, view the Changing
Keys And Values online Help topic in Registry Editor (Regedit.exe). Note
that you should make a backup copy of the registry files (System.dat and
User.dat) before you edit the registry.
<P>
To limit access to the local workstation, set the DWORD value NoRun to the
value 0x1 in the following registry key:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\
      Explorer

</PRE>Setting this value disables viewing local files by typing a file address,
or URL, (for example, "file://c:\") in the Address box. This registry
setting disables using the Run command on the Start menu as well.
<P>
Setting this value also disables the ability to browse to the local file
system using an embedded HTML link. For example, you cannot browse a file
by clicking the HTML link provided by the &lt;a href="file://c:\"&gt;my File
System&lt;/a&gt; tag when this registry setting is used.
<P>
If you want to disable access to a drive altogether, set the DWORD value
NoDrives as indicated in the following table:
<P>
<PRE>   Drive   DWORD value
   -------------------
   A       0x1
   B       0x2
   C       0x4
   D       0x8

</PRE>Set this DWORD value in the following registry key:
<P>
<PRE>   HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\
      Explorer

</PRE>NOTE: All values are in hexadecimal.
<P>
This logic uses a bitwise left shift to decide which drive to use. For
example, if you want to disable viewing drive C, set the DWORD value to
binary 0100. The code takes the return value from the function, subtracts
"A" from the value, and shifts the binary value left by that number of
bits.
<P>
For example, drive C - drive A = 2. 0001 shifted to the left twice is
0100. Binary 0100 has the hexadecimal equivalent of 0x4. This is how you
calculate the drive to disable.
<P>
As another example, if you want to disable drive N, use the following
method to calculate the hexadecimal value to place in the registry:

<OL><P><LI>Determine the numerical placement value for the letter N. If A=1, B=2,
   C=3, and so on, then N=14.

<P><LI>Subtract the numerical placement value for A from N (14-1=13).

<P><LI>Left shift binary 0001 by 13. This becomes a binary number with 13
   zeros following a 1 (0010 0000 0000 0000).

<P><LI>Convert to hexadecimal: 0x2000.
<P>
</OL>To disable multiple drives, take each of the individual hexadecimal drive
values and add them together for a composite hexadecimal value for the
registry. For example, to disable drives C, D, and N, add 0x4 + 0x8 +
0x2000 to equal 0x200C.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : kbenv kbui msiew95<BR>
Version           : WINDOWS:4.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
