

<HTML>
<HEAD>
<TITLE>Error Message: Unable to Install Java Packages... </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175133">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1997/10/14">
<META NAME="Keywords" CONTENT="kberrmsg kbsetup msient msiew95">
<META NAME="KBArea" CONTENT="Support; KB; ierelease">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="ierelease">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBV9,QAB4,QAVZ,QAEF,QA6A,QBRJ,QBWS,QBIC,QBXF,QDL9,QBWO,QBWN,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Error Message: Unable to Install Java Packages...</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175133</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer version 4.0 for Windows 95
<LI>Microsoft Internet Explorer version 4.0 for Windows NT 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it
if a problem occurs. For information about how to do this, view the
"Restoring the Registry" Help topic in Regedit.exe or the "Restoring a
Registry Key" Help topic in Regedt32.exe.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you install Internet Explorer 4.0, you may receive the following
error messages:

<UL><LI>Unable to install Java Packages from c:\windows\java\classes\Xmldso.cab
   Access is denied.

<LI>Unable to install Java Packages from c:\windows\system\Iejava.cab
   Access is denied.

<LI>Unable to install Java Packages from c:\windows\Dajava.cab
   Access is denied.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These error messages can occur for any of the following reasons:

<UL><LI>There is a copy of the Imagehlp.dll file in the Windows folder.
   Internet Explorer installs an updated copy of the Imagehlp.dll file in
   the Windows\System or Winnt\System32 folder.

<LI>You are trying to install Internet Explorer 4.0 over a pre-released
   version of Internet Explorer 4.0 that includes the Microsoft Virtual
   Machine (VM) for Java.

<LI>There is an invalid certificate on the hard disk when you install
   Internet Explorer 4.0.

<LI>The Active Content security options are disabled in Internet Explorer
   3.02 before you upgrade to Internet Explorer 4.0.
<P>
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this issue, use the appropriate method:
<P>
<P><h3>Rename the Imagehlp.dll File in the Windows Folder</h3>
 
<P>
For information about how to rename a file, click Start, click Help, click
the Index tab, type "renaming" (without quotation marks), and then double-
click the "Renaming files" topic.
<P>
NOTE: You must reinstall Internet Explorer 4.0 after you rename the
Imagehlp.dll file.
<P>
<P><h3>Remove Java Before Reinstalling Internet Explorer 4.0</h3>
 
<P>
NOTE: You should always uninstall beta versions of software before
installing the release version.
<P>
If these error messages occur when you install over a pre-released version
of Internet Explorer 4.0, uninstall the previous version before installing
Internet Explorer 4.0. To do this, follow these steps:

<OL><P><LI>Uninstall your previous version of Internet Explorer 4.0. For
   information about uninstalling Internet Explorer 4.0, see the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID : <B><A href="../ierelease/q174265.htm">Q174265</A></B>
<PRE></PRE>      TITLE      : How to Uninstall Internet Explorer 4.0

   NOTE: Do not remove the Microsoft Java VM if you are installing over
   the Internet. If you receive the following prompt, click No to keep the
   Microsoft VM for Java:

      Microsoft VM Uninstall
      If this component is uninstalled. Microsoft Internet Explorer 4.0
      will not be able to download files from the World Wide Web. Do you
      want to uninstall the Microsoft VM for Java?

</PRE><P><LI>Delete the following folder:
<P>
<P><PRE>       &lt;windir&gt;\Java\Packages
</PRE><P>
   where &lt;windir&gt; is the folder where Windows is installed.
<P>
   For information about how to delete a folder, click Start, click Help,
   click the Index tab, type "deleting" (without quotation marks), and
   then double-click the "folders" topic.

<P><LI>If you have an invalid or beta certificate for Java, follow these
   steps:
<P>
   a. On the View menu, click Internet Options.
<P>
   b. On the Content tab under View, click Publishers.
<P>
   c. Click the certificate you want to remove, and then click Remove.
<P>
   d. Click OK, and then click OK again.
<P>
   NOTE: Beta versions of Internet Explorer used Internet Explorer BETA
   Publishing Division instead of Microsoft Corporation. This certificate
   should be removed when you Uninstall the beta version of Internet
   Explorer 4.0. If it is not removed, the final version of Internet
   Explorer 4.0 will report "Access Denied" when installing the Java VM.

<P><LI>Install Internet Explorer 4.0.
<P>
   For information about installing Internet Explorer 4.0, see the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID : <B><A href="../ierelease/q170993.htm">Q170993</A></B>
<PRE></PRE>      TITLE      : How to Install Internet Explorer and Troubleshoot Setup
                   Problems

</PRE></OL>Note that after you uninstall Internet Explorer 4.0, any certificates
obtained after you installed Internet Explorer 4.0 are removed.
<P>
For information about certificates in Internet Explorer 4.0, see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID : <B><A href="../ierelease/q174920.htm">Q174920</A></B>
   TITLE      : Uninstalling Internet Explorer 4.0 Removes Certificates

</PRE>Enable Active Content Before You Install Internet Explorer 4.0
 
<P>
If these error messages occur when you install over Internet Explorer
3.02, uninstall Internet Explorer 4.0 then enable the Active Content in
Internet Explorer 3.02. To enable Active Content, follow these steps:

<OL><P><LI>In Internet Explorer 3.02, on the View menu, click Options.

<P><LI>Click the Security Tab.

<P><LI>Under Active Content, click the check box for the following options to
   select them:
<P>
<P><PRE>    - Allow Downloading Of Active Content
    - Enable ActiveX Controls And Plug-Ins
    - Run ActiveX Scripts
    - Enable Java Programs
</PRE>
<P><LI>Click OK.

<P><LI>Install Internet Explorer 4.0.
<P>
   For information about installing Internet Explorer 4.0, see the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID : <B><A href="../ierelease/q170993.htm">Q170993</A></B>
<PRE></PRE>      TITLE      : How to Install Internet Explorer and Troubleshoot Setup
                   Problems

</PRE></OL>If Internet Explorer 4.0 is already installed and these error messages
occur, use the following steps to properly install Java:
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems
that may require you to reinstall Windows 95. Microsoft cannot guarantee
that problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.
<P>
NOTE: For information about how to edit the registry, view the Changing
Keys And Values online Help topic in Registry Editor (Regedit.exe). Note
that you should make a backup copy of the registry files (System.dat and
User.dat) before you edit the registry.

<OL><P><LI>Delete the Code Download data name under the following registry key:
<P>
<P><PRE>      HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\
      Internet Settings
</PRE>
<P><LI>Reinstall the Microsoft VM For Java add-on from the Internet Explorer
   Component Download Web page.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
For more information about the Java VM in Internet Explorer, see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID : <B><A href="../ierelease/q174311.htm">Q174311</A></B>
   TITLE      : Internet Explorer Plus 4.0 Readme.txt File

   ARTICLE-ID : <B><A href="../zmiscellaneous/q154604.htm">Q154604</A></B>
   TITLE      : Description of Java Support for Internet Explorer

   ARTICLE-ID : <B><A href="../ie_dev/q172437.htm">Q172437</A></B>
   TITLE      : INFO: IE4 PP2 Win32 Virtual Machine for Java File List

   ARTICLE-ID : <B><A href="../java/q168941.htm">Q168941</A></B>
   TITLE      : INFO: Frequently Asked Questions for CAB Files

   ARTICLE-ID : <B><A href="../java/q169805.htm">Q169805</A></B>
   TITLE      : INFO: Known Issues with Microsoft Win32 Virtual Machine
                for Java
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00<BR>
Keywords          : kberrmsg kbsetup msient msiew95<BR>
Version           : WINDOWS:4.0<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
