

<HTML>
<HEAD>
<TITLE>How to Exclude Temporary Internet Files from a Roaming Profile </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182310">
<META NAME="KBModify" CONTENT="1998/03/11">
<META NAME="KBCreate" CONTENT="1998/03/11">
<META NAME="Keywords" CONTENT="kbenv msient msiew95 win98">
<META NAME="KBArea" CONTENT="Support; KB; ierelease">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, make sure you understand how to restore it if a problem occurs. For information about how to do this, view the  Restoring the Registry  Help topic...">
<META NAME="Product" CONTENT="ierelease">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBF0,QDL9,QBWO,QBWN,QAVZ,QBV9,QA6A,QA47,QABA,QBAO,QAYY,QBRJ,QBWP,QDJ2,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Exclude Temporary Internet Files from a Roaming Profile</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 11, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182310</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
********************************************************************
<PRE>     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA

     This article discusses a Beta release of a Microsoft
     product. The information in this article is provided as-is
     and is subject to change without notice.

     No formal product support is available from Microsoft for
     this Beta product. For information about obtaining support
     for a Beta release, please see the documentation included
     with the Beta product files, or check the Web location
     from which you downloaded the release.

     BETA INFORMATION  BETA INFORMATION  BETA INFORMATION  BETA
</PRE>********************************************************************
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 98
<LI>Microsoft Internet Explorer version 4.01 for Windows 95
<LI>Microsoft Internet Explorer version 4.01 for Windows NT 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it
if a problem occurs. For information about how to do this, view the
"Restoring the Registry" Help topic in Regedit.exe or the "Restoring a
Registry  Key" Help topic in Regedt32.exe.
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to exclude temporary Internet files from your
roaming profile on a network that enables roaming profiles.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can configure Internet Explorer to keep temporary Internet files on
your local computer using one of the following methods:

<UL><LI>Modify your Internet properties to configure your temporary Internet
   file settings.

<LI>Create a set of registry (.reg) files that contain the local temporary
   Internet file settings to import into the local. registry

<LI>Disable the per-user cache and force all users to share the same local
   cache.
<P>
</UL><h3>Modify Internet Properties</h3>
 
<P>
You can set the location for the Temporary Internet Files folder in the
Internet Options dialog box. To do so, follow these steps:

<OL><P><LI>Right-click Internet Explorer on the desktop, and then click
   Properties.

<P><LI>On the General tab, click Settings, and then click Move Folder.

<P><LI>Click Yes if you are prompted "Moving the location of Temporary
   Internet Files folder will delete all your subscription data. Do you
   wish to continue?"

<P><LI>Browse to the local folder location you want to use, and then click OK.

<P><LI>Click OK.
<P>
</OL><h3>Use a .reg File</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry
Editor can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys
And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" Help topics
in Regedt32.exe. Note that you should back up the registry before you edit
it.
<P>
Modify the following keys in the registry to point to the local Temporary
Internet Files folders:
<P>
<PRE>   HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet
      Settings\Cache\Paths\path1\CachePath

   HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet
      Settings\Cache\Paths\path2\CachePath

   HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet
      Settings\Cache\Paths\path3\CachePath

   HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet
      Settings\Cache\Paths\path4\CachePath

   HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell
      Folders\Cache

   HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell
      Folders\Cache

</PRE></OL>If you want to implement these changes as part of a network distribution,
export these keys as .reg files and import the .reg files as part of the
installation of Internet Explorer. You can also add these keys as part of
an unattended Setup of Windows NT. For more information about how to
automate the installation of programs as part of an unattended Setup of
Windows NT, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../winnt/q158447.htm">Q158447</A></B>
   TITLE     : How to Run a Program Only Once After Unattended Setup of
               WinNT

</PRE><h3>Disable Per-User Cache</h3>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall your operating system. Microsoft cannot
guarantee that problems resulting from the incorrect use of Registry
Editor can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the "Changing Keys
And Values" Help topic in Registry Editor (Regedit.exe) or the "Add and
Delete Information in the Registry" and "Edit Registry Data" Help topics
in Regedt32.exe. Note that you should back up the registry before you edit
it.
<P>
Add the following key in the registry and set the value to "00" (without
quotation marks):
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet
      Settings\Cache\User Profiles

</PRE>Note that this setting does not disable the caching of temporary Internet
files.
<P>
A roaming profile keeps your personalized settings on a network server.
These settings are copied to each computer as you log into the network.
When you browse the Internet with Internet Explorer, all the files on each
Web page are copied to the Temporary Internet Files folder on your
computer. When you are set to use a roaming profile, these files become
part of the information copied to your home directory (which stores your
personalized information). When you log in to the network from a different
computer, these temporary files are copied to the local computer. Each
time you browse new Web pages, the number of files increases. Having more
temporary files can increase the time it takes to log in to each local
computer.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: poor slow performance boot<BR>
Keywords          : kbenv msient msiew95 win98<BR>
Version           : WINDOWS:4.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 11, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
