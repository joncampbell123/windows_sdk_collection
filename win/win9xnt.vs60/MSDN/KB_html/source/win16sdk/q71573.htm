

<HTML>
<HEAD>
<TITLE>Keeping a Window on Top of All Other Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71573 ">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1991/04/25">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  By using a timer, a pop-up window can be made to behave like a  topmost  window, a window that remains on top of all other windows in the system. Such a window is brought to the top of all other windows whenever a WM_TIMER message is sent to its wi...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGQ,QA5X,QDL9,QBWO,QBWN,QBWQ,QAHT,QAEF,QAGI,QACI,QAY5,QATK,QANJ,QAEV,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Keeping a Window on Top of All Other Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71573 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By using a timer, a pop-up window can be made to behave like a
"topmost" window, a window that remains on top of all other windows
in the system. Such a window is brought to the top of all other
windows whenever a WM_TIMER message is sent to its window function.
<P>
NOTE: In Windows version 3.1, if you have a non-child window then the
extended window style WS_EX_TOPMOST is a better method for keeping it
topmost. CreateWindowEx() can create a window with the extended style and
SetWindowPos() can set or clear the style for a already created window.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a topmost window, first register a new window class. Using
that new class, create a pop-up window without a parent. The window is
created without a parent so that it is independent of the main
overlapped window created for each application in the system. This
will ensure that the topmost window remains open on the desktop even
if the main window is minimized.
<P>
After creating this pop-up window, create a timer with the SetTimer()
function and associate it with the window. Set the elapsed time to 100
milliseconds. The window function for the topmost window will process
the WM_TIMER message and call SetWindowPos() to place the topmost
window on top of all other windows. The code that processes the timer
message may be similar to the following:
<P>
<PRE>   case WM_TIMER:
       GetWindowRect(hWnd, &amp;rect);

       SetWindowPos(hWnd,
                    NULL,
                    rect.left,
                    rect.top,
                    0,
                    0,
                    SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE);
       break;

</PRE>The window coordinates returned by GetWindowRect() are used in the
call to SetWindowPos(). Doing this allows the user to move the topmost
window (if it has a caption bar) and it will remain on top.
<P>
The wFlags parameter for SetWindowPos() also contains the
SWP_NOACTIVATE flag. This is required so that the window can remain on
top without moving the focus to that window. Failing to do this will
disable all other applications in the system.
<P>
When the application that installed the topmost window is terminated,
the timer should be removed using the KillTimer() function. This call
can be placed in the processing of the WM_DESTROY message in the
topmost window's window procedure.
<P>
With this implementation, when a menu is activated, the screen will
flash as the menu is painted and then the topmost window is painted
over the menu. Menu selections can be made normally. However,
depending upon the topmost window's position, not all menu items will
be properly visible.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: UsrTim<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
