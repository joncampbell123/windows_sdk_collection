

<HTML>
<HEAD>
<TITLE>SAMPLE: Printing Text Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q69078 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/02/06">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The sample program REPMKR in the Microsoft Software Library demonstrates the code required to print a report. The report generator prints plain-text reports in monospace fonts either on a printer or in a print-preview window. The code to handle pri...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVV,QAOX,QAH4,QDL9,QBWO,QBWN,QA01,QAMB,QA5V,QAJX,QADR,QAEF,QBXV,QAPF,QBW9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Printing Text Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q69078 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The sample program REPMKR in the Microsoft Software Library demonstrates
the code required to print a report. The report generator prints plain-text
reports in monospace fonts either on a printer or in a print-preview
window. The code to handle printer display contexts is encapsulated in the
report generator code. The interface does not require the host program to
work with printing code.
<P>
NOTE: This sample was originally written for Windows 3.0. Applications
targeted for Windows 3.1 should modify this sample's code to utilize the
Common Dialog boxes.
<P>
Download REPMKR.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/repmkr.exe">REPMKR.EXE</A> <I>(size: 40057 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/repmkr.exe">REPMKR.EXE</A> <I>(size: 40057 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The three functions of the report generator are as follows:
<P>
<PRE>   Function                        Description
   --------                        -----------

   PrinterSetupDialog(void)        Brings up the standard Printer
                                   Setup dialog box

   PrinterSelectDialog(void)       Allows the user to select a printer
                                   for use by the report generator

   PrinterControl(int iCommand,    Controls page layout
      int iParam, LPSTR szParam)

</PRE>The following is the table of specific commands:
<P>
<PRE>   iCommand         iParam                 szParam
   --------         ------                 -------

   PC_SETCOLS       # of columns/page      Not used

   PC_SETROWS       # of rows/page         Not used

   PC_PRINT         Not used               Not used

   PC_CLEARALL      Not used               Not used

   PC_ADDLINE       -1 for next line,      LPSTR to line of text
                    (n) for line # to add

   PC_ADDBAR        -1 for width of page   LPSTR to character
                    (n) for bar width      (NULL will print '-')

   PC_SETPAGENUM    Page number            Not used

   PC_SETHEADERn    Not used               LPSTR to header,
                                           NULL will clear

   PC_ADDHEADERn    Not used               Not used

   PC_SETFOOTER1    Not used               LPSTR to header,
                                           NULL will clear

   PC_ADDFOOTER1    Not used               Not used

   PC_STARTJOB      Not used               Not used

   PC_ENDJOB        TRUE = OK,             Not used
                    FALSE = Abort

   PC_SETTITLE      Not used               LPSTR to title
                                           of print job

   PC_SETPRINTMODE  PC_CODE_PRINT or       Not used
                    PC_CODE_PREVIEW


</PRE>In the REPMKR archive file is a sample program BASE that demonstrates
how to use these functions.
<P>
Each header is printed on every page, unless it is set to NULL. Each
footer is printed on every page, unless it is set to NULL. The title
of the print job is displayed in the "printing" message box.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib REPMKR.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: GdiPrn<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
