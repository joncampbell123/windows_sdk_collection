

<HTML>
<HEAD>
<TITLE>SAMPLE: Writing a Windows Application Using MASM 6.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77256 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/10/10">
<META NAME="Keywords" CONTENT="kbtool kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Using the high-level language features of the Microsoft Macro Assembler (MASM) version 6.0, it is now much simpler to write a complete Windows program in MASM than with previous versions of the program.  A program called MASMWIN in the Microsoft So...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QDL9,QBWO,QBWN,QBWQ,QAY5,QBV8,QAGQ,QAJH,QAH6,QAB9,QBW9,QABG,QBXN,QBB3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Writing a Windows Application Using MASM 6.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77256 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using the high-level language features of the Microsoft Macro
Assembler (MASM) version 6.0, it is now much simpler to write a
complete Windows program in MASM than with previous versions of the
program.
<P>
A program called MASMWIN in the Microsoft Software Library demonstrates
what is required to write a complete Windows program using MASM 6.0.
<P>
Download MASMWIN.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/masmwin.exe">MASMWIN.EXE</A> <I>(size: 44105 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/masmwin.exe">MASMWIN.EXE</A> <I>(size: 44105 bytes)</I> 
</PRE><P>
</UL>MASMWIN demonstrates a number of features of MASM 6.0. It demonstrates
the use of alternate PROLOGUE and EPILOGUE code generation. It also
demonstrates function prototyping and the use of the INVOKE feature.
<P>
While MASM provides a complete programming environment with high-level
language features, applications written in MASM will be much more
difficult to transfer to future versions of Windows that run on non-
Intel platforms.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Using the OPTION:PROLOGUE and OPTION:EPILOGUE directives in MASM 6.0,
an application can cause MASM 6.0 to generate any type of prologue or
epilogue code desired. For this program, it creates the appropriate
Windows code. The macros to perform this task are contained in the
file WINPRO.INC. The two declarations, ?WINDOWS=1 and ?PMODE=1, affect
the generation of the prologue and epilogue code.
<P>
The ?WINDOWS=1 declaration will cause Windows prologue and epilogue
code to be generated for all FAR functions. All other functions are
declared with the normal function stack frame.
<P>
The ?PMODE=1 declaration causes the Windows prologue and epilogue code
to be generated only for FAR functions declared as EXPORT. This code
takes advantage of the fact that in protected mode, Windows does not
walk the stack.
<P>
The program includes a WINDOWS.INC file that is different from the one
included in Windows Software Development Kit (SDK) version 3.0. This
WINDOWS.INC file was created by running WINDOWS.H through the H2INC
utility provided with MASM 6.0. This provides prototypes for all of
the Windows functions and also translates C structures to
corresponding MASM structures. This file allows the INVOKE feature of
MASM 6.0 to be used to call Windows functions. The INVOKE function
handles all the parameter passing and stack clean up. To use this
file, it is necessary to include the following line in the source code
before the line that includes the new WINDOWS.INC:
<P>
<PRE>   OPTION CASEMAP:NONE

</PRE>This causes the assembler to maintain case sensitivity when dealing
with symbols.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib MASMWIN.EXE<BR>
KBCategory: kbtool kbfile<BR>
KBSubcategory: TlsMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
