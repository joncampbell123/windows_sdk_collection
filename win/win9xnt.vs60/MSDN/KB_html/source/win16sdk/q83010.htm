

<HTML>
<HEAD>
<TITLE>SAMPLE: Navigating a Windows Help File Topic Hierarchy </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q83010 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1992/04/01">
<META NAME="Keywords" CONTENT="kbtool kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  In many cases, a Windows Help file presents its information in a hierarchy of topics. For example, the initial screen of a Help file is a listing of the major topics in the file. Selecting a major topic brings up a list of detail topics. Selecting ...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWA,QA6A,QANS,QBS8,QAH4,QA5D,QDL9,QBWO,QBWN,QAA2,QAJD,QBWQ,QAMB,QAGI,QAGY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Navigating a Windows Help File Topic Hierarchy</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q83010 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In many cases, a Windows Help file presents its information in a
hierarchy of topics. For example, the initial screen of a Help file is
a listing of the major topics in the file. Selecting a major topic
brings up a list of detail topics. Selecting a detail topic displays
its corresponding screen of information. The following diagram
illustrates a hierarchical table of contents:
<P>
<PRE>                          Table_of_Contents
                                  |
                /-----------------+-----------------\
          Major_Topic_1     Major_Topic_2     Major_Topic_3
          /     |     \        /       \         /       \
    topic_1 topic_2 topic_3  topic_4 topic_5  topic_6 topic_7

</PRE>An "Up" button in a Windows Help file provides a convenient method for
the user to move up the hierarchy. In a major topic, the Up button
displays the table of contents. In a detail topic, the Up button
displays the corresponding major topic. In the table of contents, the
Up button is disabled because the table of contents is the highest
point in the hierarchy.
<P>
An Up button and a "Back" button each perform different functions.
While the Up button displays the topic on the next higher level of the
hierarchy, the Back button returns to the topic previously viewed. In
the topic hierarchy, the previous topic can be above, below, or on the
same level.
<P>
UPHELP is a file in the Microsoft Software Library that contains the files
required to build a Help file that implements an Up button. The file
contains a graphic image of its title hierarchy. As the user navigates
through the file using topic jumps and browse sequences, the graphic
changes to indicate the position in the file.
<P>
Download UPHELP.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/uphelp.exe">UPHELP.EXE</A> <I>(size: 26674 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/uphelp.exe">UPHELP.EXE</A> <I>(size: 26674 bytes)</I> 
</PRE><P>
</UL>This article details the steps required to implement an Up button in a
Windows Help file to help navigate up the topic hierarchy.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are two major steps to implementing an Up button:

<OL><P><LI>Placing a button on the button bar.

<P><LI>Programming the button to perform the required jump.
<P>
<P>
</OL><h3>Placing an Up Button on the Button Bar</h3>
 
<P>
A Help file adds a button to the button bar with the CreateButton
macro. Once a button is created, it will remain on the button bar
until a corresponding call is made to the DestroyButton macro. A file
can call macros in a topic footnote (which is described below) or in
the [CONFIG] section of the Help project (.HPJ) file. The following
code adds a button to the button bar:
<P>
<PRE>   [CONFIG]
   CreateButton("Up_Button","&amp;Up","JI(`uphelp.hlp',`Table_of_Contents')")

</PRE></OL>The added button has the identifier "Up_Button" and text "Up." When
the user presses this button, Help displays the "Table_of_Contents"
topic in the UPHELP.HLP file.
<P>
For more information on the CreateButton macro and on the [CONFIG]
section of the HPJ file, please consult the Windows Software
Development Kit (SDK) documentation for version 3.1.
<P>
<P><h3>Programming the Up Button</h3>
 
<P>
At the entry to each topic, it is necessary to change the topic that
Help displays when the user presses the Up button. Author an
exclamation point (!) footnote into each topic of the Help file. Help
executes the macros of an exclamation point footnote before it
displays a topic.
<P>
The macro for the table of contents topic is different from those in
the remainder of the Help file. Because the table of contents is the
top of the topic hierarchy, the Up button is disabled in the table of
contents topic. The text of the exclamation point footnote for the
table of contents topic contains the DisableButton macro.
<P>
The exclamation point footnote in the other topics in the Help file
contain two macros:

<UL><LI>EnableButton, which is required because the topic previously
   displayed might have been the table of contents. (The user can use
   the Search feature to jump directly to a topic, bypassing the topic
   hierarchy.)

<LI>ChangeButtonBinding, which changes the action of the button.
<P>
</UL>Separate the text of the two macros with a semicolon (;).
<P>
The following text provides an example of an exclamation point
footnote. Note that in an actual Help file, the text below would not
contain any line breaks.
<P>
<PRE>   ! EnableButton("Up_Button");
   ChangeButtonBinding("Up_Button",
                       "JI(`uphelp.hlp',`Table_of_Contents')")

</PRE>The ChangeButtonBinding macro requires two parameters:

<UL><LI>This first parameter is the button identifier, in this case
  "Up_Button".

<LI>The second parameter specifies the action of the button, in this
   case to call the JumpId (JI) macro. JumpID displays a specified topic
   in a specified Help file.
<P>
</UL>The Windows SDK documentation, version 3.1, provides additional
information about the following Help macros:

<UL><LI>ChangeButtonBinding
<LI>CreateButton
<LI>DisableButton
<LI>EnableButton
<LI>JumpId (JI)
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 softlib UPHELP.EXE<BR>
KBCategory: kbtool kbfile<BR>
KBSubcategory: TlsHlp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
