

<HTML>
<HEAD>
<TITLE>Verifying the Printer Connection </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q77467 ">
<META NAME="KBModify" CONTENT="1997/08/12">
<META NAME="KBCreate" CONTENT="1991/10/16">
<META NAME="Keywords" CONTENT="GdiPrn kb16bitonly kbcode kbfasttip kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT=" The PC ROM BIOS printer services function Get Printer Status (INT 17H Function 2H) can be used to determine if a printer is connected to a specific port. To save time and potential data loss, an application can use INT 17H Function 2H to determine i...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAOX,QACT,QAY5,QAH4,QDL9,QBWO,QBWN,QAI5,QBV8,QAB9,QA4Q,QAI4,QBWQ,QBXE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Verifying the Printer Connection</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q77467 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
The PC ROM BIOS printer services function Get Printer Status (INT 17H
Function 2H) can be used to determine if a printer is connected to a
specific port. To save time and potential data loss, an application
can use INT 17H Function 2H to determine if a printer is present
before entering the application's printing code. This article contains
code to make this determination.
<P>
NOTE: This same functionality may be obtained in Windows 3.1 using the
OpenComm(), WriteComm(), and GetCommError() functions.
<P>
<P><h3>Sample Code</h3>
 
<P>
The following code defines a function IsPrinter():
<P>
<PRE> /***************************************************************
  *                                                             *
  *  Name:     IsPrinter - tests if printer is connected        *
  *                                                             *
  *  Parameters:   AX = 02h                                     *
  *                DX = printer number (LPT1 = 0)               *
  *                                                             *
  *  Return    AH = status bits                                 *
  *                 01h    time out                             *
  *                 02h    unused                               *
  *                 04h    unused                               *
  *                 08h    I/O error                            *
  *                 10h    printer selected                     *
  *                 20h    out of paper                         *
  *                 40h    printer acknowledgment               *
  *                 80h    printer not busy                     *
  *                                                             *
  * Function returns 1 if printer connected                     *
  *          returns 0 otherwise                                *
  *                                                             *
  ***************************************************************/

int IsPrinter(void)
</PRE>{
<PRE>   unsigned char iRetVal = 0;

   _asm
      {
         mov   ah, 02h
         mov   dx, 0            /* 0 is number for LPT1: */
         int   17h
         mov   iRetVal, ah
      }

   if (iRetVal == 0x90)
      return (1);
   else
      return (0);
</PRE>}
<P>
For more information, please refer to "The MS-DOS Encyclopedia"
(Microsoft Press). Pages 163 and 164 contain an example of interrupt
driven communication with the printer. Appendix O details the ROM BIOS
functions and their parameters.
 
<PRE>Keywords          : GdiPrn kb16bitonly kbcode kbfasttip kbhowto
Version           : 3.0 3.1
Platform          : WINDOWS
Issue type        : kbhowto
Solution Type     : kbcode</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
