

<HTML>
<HEAD>
<TITLE>SAMPLE: Code to Provide Time and Date Information </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q70070 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/03/09">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The information below describes a set of functions available in the Microsoft Software Library for formatting time and date strings using the international settings in the Windows Control Panel.  WINTIME is a file in the Microsoft Software Library ...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBTX,QACE,QAU3,QAMR,QAHE,QAFH,QDNG,QBBI,QAY5,QBQU,QBAO,QABA,QAPF,QAWI,QANG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Code to Provide Time and Date Information</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q70070 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The information below describes a set of functions available in the
Microsoft Software Library for formatting time and date strings using the
international settings in the Windows Control Panel.
<P>
WINTIME is a file in the Microsoft Software Library that formats time and
date strings according to the Control Panel settings.
<P>
Download WINTIME.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/wintime.exe">WINTIME.EXE</A> <I>(size: 30332 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/wintime.exe">WINTIME.EXE</A> <I>(size: 30332 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Windows allows the user to specify, with the Control Panel, the appropriate
format for the date and time in the user's country. The Windows API
provides no function to format strings of date and time information
according to the Control Panel's settings. The sample code module WINTIME.C
provides C source code for five functions that an application can use to
format the date and time.
<P>
WINTIME.C is designed to be as flexible and portable as possible. The
module can be used in an application or in a dynamic-link library (DLL)
without modification.
<P>
Included with the WINTIME.C file is a sample application that demonstrates
how to use the functions.
<P>
The five functions provided by WINTIME are documented below:

<OL><P><LI>LPSTR FAR PASCAL TimeGetCurDate(LPSTR lpszDate, WORD wFlags)
<P>
   Description:
<P><PRE>     TimeGetCurDate() returns the current date, formatted as specified
     by the user in the Control Panel.
</PRE><P>
   Arguments:
<P><PRE>     Type/Name
<PRE></PRE>              Description

     LPSTR lpszDate
              Points to a buffer that is to receive the date. Must be
              large enough to hold the longest date possible (64 bytes
              should be large enough).
     struct tm *lpTM
              Pointer to a "tm" structure (from TIME.H) that contains
              the time and date to be formatted.

     WORD wFlags
              Specifies flags that modify the behavior of the function.
              May be any of the following:

        Flag              Meaning
        ----              -------
        0                 The date will be formatted exactly the way
                          Control Panel does it, using Windows's
                          international settings. The date will be in
                          the long date format (Sunday, January 1,
                          1991).

        DATE_SHORTDATE    Forces the date to be formatted using the
                          short date format (1/01/91).

        DATE_NODAYOFWEEK  The date will be formatted without the day
                          of week. This flag may not be used with the
                          DATE_SHORTDATE flag (that is, January 1,
                          1991).

</PRE><P><LI>LPSTR FAR PASCAL TimeGetCurTime(LPSTR lpszTime, WORD wFlags)
<P>
   Description:
<P><PRE>     TimeGetCurTime() returns the current time, formatted as specified
     by the user in the Control Panel.
</PRE><P>
   Arguments:
<P><PRE>     Type/Name
<PRE></PRE>              Description

     LPSTR lpszTime
              Points to a buffer that is to receive the formatted
              time. Must be large enough to hold the longest date
              possible (64 bytes should be large enough).

     WORD wFlags
              Specifies flags that modify the behavior of the function.
              May be any of the following:

        Flag              Meaning
        ----              -------
        0                 The time will be formatted exactly the way
                          Control Panel does it, using Windows's
                          international settings (for example,
                          1:00:00 AM).

        TIME_12HOUR       The time will be formatted in 12 hour format
                          regardless of the WIN.INI international
                          settings. This flag may not be used with the
                          TIME_24HOUR flag (for example, 2:32:10 PM).

        TIME_24HOUR       The time will be formatted in 24 hour format
                          regardless of the WIN.INI international
                          settings. This flag may not be used with the
                          TIME_12HOUR flag (for example, 14:32:10).

        TIME_NOSECONDS    The time will be formatted without seconds
                          (for example, 2:32 PM).


</PRE><P><LI>LPSTR FAR PASCAL TimeFormatDate(LPSTR lpszDate,
<PRE>                                   struct tm FAR *lpTM,
                                   WORD wFlags)

   Description:
     TimeFormatDate() returns the date, specified in the tm structure,
     formatted as specified by the user in the Control Panel.

   Arguments:
     Type/Name
              Description

     LPSTR lpszDate
              Points to a buffer that is to receive the date. Must be
              large enough to hold the longest date possible (64 bytes
              should be large enough).

     struct tm *lpTM
              Pointer to a "tm" structure (from TIME.H) that contains
              the time and date to be formatted.

     WORD wFlags
              Specifies flags that modify the behavior of the function.
              May be any of the following:

        Flag              Meaning
        ----              -------
        0                 The date will be formatted exactly the way
                          Control Panel does it, using Windows's
                          international settings. The date will be in
                          the long date format (Sunday, January 1,
                          1991).

        DATE_SHORTDATE    Forces the date to be formatted using the
                          short date format (1/01/91).

        DATE_NODAYOFWEEK  The date will be formatted without the day
                          of week. This flag may not be used with the
                          DATE_SHORTDATE flag (for example, January 1,
                          1991).


</PRE><P><LI>LPSTR FAR PASCAL TimeFormatTime(LPSTR lpszTime,
<PRE>                                   struct tm FAR *lpTM,
                                   WORD wFlags)

   Description:
     Function returns the time, specified in the tm structure,
     formatted as specified by the user in the Control Panel.

   Arguments:
     Type/Name
              Description

     LPSTR lpszTime
              Points to a buffer that is to receive the formatted
              time. Must be large enough to hold the longest date
              possible (64 bytes should be large enough).

     struct tm *lpTM
              Pointer to a "tm" structure (from TIME.H) that contains
              the time and date to be formatted.

     WORD wFlags
              Specifies flags that modify the behavior of the function.
              May be any of the following:

        Flag              Meaning
        ----              -------
        0                 The time will be formatted exactly the way
                          Control Panel does it, using Windows's
                          international settings (for example,
                          1:00:00 AM).

        TIME_12HOUR       The time will be formatted in 12 hour format
                          regardless of the WIN.INI international
                          settings. This flag may not be used with the
                          TIME_24HOUR flag (for example, 2:32:10 PM).

        TIME_24HOUR       The time will be formatted in 24 hour format
                          regardless of the WIN.INI international
                          settings. This flag may not be used with the
                          TIME_12HOUR flag (for example, 14:32:10).

        TIME_NOSECONDS    The time will be formatted without seconds
                          (for example, 2:32 PM).


</PRE><P><LI>void FAR PASCAL TimeResetInternational(void)
<P>
   Description:
<P><PRE>     This function sets some local static variables to Windows's
     current time and date format settings.
</PRE><P>
<P><PRE>     This function should be called every time a WM_WININICHANGE
     message is sent for the [intl] section and when the DLL or
     application using these functions is invoked.
</PRE><P>
<P><PRE>     These variables are in the DLL data segment. Therefore, if one
     application changes this information, the others will see the
     change.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib WINTIME.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrSys<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
