

<HTML>
<HEAD>
<TITLE>PC Hangs While Running a Communications Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119853">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1994/08/25">
<META NAME="Keywords" CONTENT="kb16bitonly kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  This article provides information about a problem that has appeared on recently manufactured IBM PCs and PC compatibles. Many of these machines incorporate the Peripheral Component Interface (PCI) bus, giving the impression that the problem may be ...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QDJ9,QDL9,QBWN,QAU9,QAKP,QDKW,QBXS,QBWQ,QAC1,QA4P,QBVV,QDIO,QDJP,QAKG V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PC Hangs While Running a Communications Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119853</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.11
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows,
   version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides information about a problem that has appeared on
recently manufactured IBM PCs and PC compatibles. Many of these machines
incorporate the Peripheral Component Interface (PCI) bus, giving the
impression that the problem may be somehow related to this bus. The
problem, however, can occur on machines with other bus architectures. An
obvious symptom of this problem is that when a comm port is opened and
closed a couple of times, the machine hangs, forcing the user to reboot
the PC.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There is a problem with a Super I/O chip (SMC '665) that many OEMs used to
provide serial ports on their latest generation (typically PCI-bus-based)
PCs. This problem can (and has) shown up on PCs that do not have a PCI bus.
Having the bad chip is all that is needed to cause this problem.
<P>
The problem is that if you reset the first in, first out algorithm (FIFO)
by clearing and then enabling it when the port is initializing, and there
is already a character in the receive FIFO, the comm driver gets an
indication that a new character has been received. The driver, of course,
tries to get this character. Unfortunately, the driver keeps finding that a
new character is available even if no more characters have been received.
In this case, you can do nothing short of a cold reboot to get rid of this
indication. Any workaround should, therefore, avoid this situation
altogether.
<P>
A workaround involving a driver is to disable the FIFO, read a character,
then reenable it. A workaround if you do not have access to a driver is to
disable the FIFO feature of the 16550 UART. You can accomplish this by
editing (adding the entry if it does not exist) the COMxFIFO key (x = 1, 2,
etc. for COM1, COM2, etc.) of the [386Enh] section in the SYSTEM.INI file.
For example, the FIFO for COM2 can be disabled with the following entry:
<P>
<PRE>   [386Enh]
   COMXFIFO=0

</PRE>NOTE: Disabling a comm port's FIFO reduces its data throughput.
<P>
The COMM.DRV communications driver shipped with Windows version 3.x and
SERIAL.386 shipped with Microsoft Windows For Workgroups version 3.11 do
not offer a workaround for this problem. Users of Windows for Workgroups
version 3.11, however, can download an upgrade to SERIAL.386; this upgrade
works around the problem. Users of Windows version 3.x have to obtain a
third-party communications driver that implements a workaround (or
explicitly disables the FIFO) to solve the problem.
<P>
<P><h2>REFERENCES</h2>
 
<P>
The updated SERIAL.386 file for Windows for Workgroups version 3.11 is
included with PSS Application Note WG1001, "Updated SERIAL.386 Driver for
Windows for Workgroups" (also found in KB article <B><A href="../win3x/q112300.htm">Q112300</A></B>).
<P>
For more information about WG1001, query on the following word in the
Microsoft Knowledge Base:
<P>
<PRE>   WG1001
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 WfW 3.11 COM freeze OpenComm<BR>
CloseComm hung frozen<BR>
KBCategory: kbprg<BR>
KBSubCategory: KrCommapi<BR>
Keywords            : kb16bitonly kbprg<BR>
Version             : 3.10 3.11<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
