

<HTML>
<HEAD>
<TITLE>SAMPLE: Customizing the MDI Window Menu </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99803 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1993/06/08">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The MDIWINMN sample in the Microsoft Software Library demonstrates how to customize the Window menu of a multiple document interface (MDI) frame window. MDIWINMN shows how to limit the number of listed MDI children in the Window menu to any number ...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBJZ,QDL9,QBWO,QBWN,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Customizing the MDI Window Menu</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99803 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The MDIWINMN sample in the Microsoft Software Library demonstrates how to
customize the Window menu of a multiple document interface (MDI) frame
window. MDIWINMN shows how to limit the number of listed MDI children in
the Window menu to any number and how to bring up a customized dialog box
when the More Windows menu item is selected. This sample also shows how to
list all the MDI children in the Window menu without using a More Windows
menu item.
<P>
Download MDIWINMN.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/mdiwinmn.exe">MDIWINMN.EXE</A> <I>(size: 26251 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/mdiwinmn.exe">MDIWINMN.EXE</A> <I>(size: 26251 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
To compile, type NMAKE to build the sample; this sample limits the number
of MDI child windows listed in the Window menu and brings up the customized
dialog box when the More Windows menu item is selected. Type NMAKE
MENU=NOLIMIT to build the sample that lists all the the MDI children in the
Window menu without using a More Windows menu item.
<P>
The following code changes must be made in the window procedure of the
MDI frame window to customize the Window menu:

<OL><P><LI>Specify NULL as the Window menu handle when creating the MDI client,
   because the application handles all the processing of the Window
   menu:
<P>
<P><PRE>      CLIENTCREATESTRUCT ccs;
      ccs.hWindowMenu  = NULL;
      ccs.idFirstChild = IDM_FIRSTCHILD;
</PRE>
<P><LI>Update the Window menu using ChangeWindowMenu() when the frame window
   receives WM_INITMENUPOPUP. ChangeWindowMenu() is implemented in the
   sample code:
<P>
<P><PRE>     case WM_INITMENUPOPUP:
<PRE></PRE>          if ((HMENU)wParam == hMenuWindow)
             ChangeWindowMenu(hMenuWindow);
          break;

</PRE><P><LI>Call ProcessWindowMenu() in the default processing of WM_COMMAND
   received by the frame window. ProcessWindowMenu() is implemented in the
   sample code:
<P>
<P><PRE>     case WM_COMMAND:
      {
<PRE></PRE>          switch (wParam)
          {
              :
              :
           default:
              if (ProcessWindowMenu(wParam))
                    return 0L;
              else return DefFrameProc(hwnd, g_hwndMDIClient,
                                      msg, wParam, lParam);
           }
      }

</PRE></OL>ChangeWindowMenu() removes the old listing of MDI children from the Window
menu. It then enumerates the MDI child windows and adds their names to the
Window menu so the Window menu reflects the current state when shown.
<P>
ProcessWindowMenu() processes WM_COMMAND messages that result from menu
selections of MDI children in the Window menu. It also brings up a
customized dialog box when the More Windows menu item is selected.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib MDIWINMN.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrMdi<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
