

<HTML>
<HEAD>
<TITLE>Steps to Send a Document to a Printer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75339 ">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1991/08/18">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  If code simplicity is more desirable than printing efficiency, an application can implement printing with almost no additional code. For this discussion, the application defines a DrawStuff procedure that renders text and/or graphics into a specifi...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAGI,QDL9,QBWO,QBWN,QAGB,QAUD,QAH4,QBWQ,QAIF,QASR,QAI4,QAX6,QANC,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Steps to Send a Document to a Printer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75339 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If code simplicity is more desirable than printing efficiency, an
application can implement printing with almost no additional code. For
this discussion, the application defines a DrawStuff procedure that renders
text and/or graphics into a specified display context. The application can
render the image to the screen by getting a screen display context and
passing its handle to DrawStuff(). Printing is more involved; the seven
steps required are detailed below.

<OL><P><LI>Use GetProfileString() to get the printer driver name and port to print
   to from the WIN.INI file. Specify "windows" as the application and
   "device" as the key name.

<P><LI>Call the CreateDC() to get a display context for the printer.
<P>
</OL>The following code demonstrates these two steps:
<P>
<PRE>     //
     // HDC GetPrinterDC(void)
     //
     // Return a DC to the currently selected printer.
     // Returns NULL on error.
     //

     HDC GetPrinterDC(void)
     {
        static char szPrinter[64];
               char *szDevice, *szDriver, *szOutput;

        GetProfileString("windows", "device", "", szPrinter, 64);

        if ((szDevice = strtok(szPrinter, "," ))
              &amp;&amp; (szDriver = strtok(NULL, ", "))
              &amp;&amp; (szOutput = strtok(NULL, ", ")))
           return CreateDC(szDriver, szDevice, szOutput, NULL);

        return NULL;
     }

</PRE><P><LI>Use the STARTDOC Escape to start a print job. [In Windows 3.1 and later,
   call the StartDoc() function rather than the STARTDOC escape.]
<P>
<P><PRE>     szJobName = "&lt;job name&gt;";
     Escape(hDC, STARTDOC, lstrlen(szJobName), szJobName, NULL);
</PRE><P>
   [3.5. In Windows 3.1 and later, call StartPage() to begin a page.]

<P><LI>Draw the page by calling DrawStuff(hDC).

<P><LI>Use the NEWFRAME Escape to start the next page. [In Windows 3.1 and
   later, call the EndPage() function rather than the NEWFRAME escape.]
<P>
<P><PRE>     Escape(hDC, NEWFRAME, 0, 0L, 0L);
</PRE><P>
   (If more than one page is printed, repeat steps 4 and 5 for each page.)

<P><LI>Use the ENDDOC Escape to end the print job. [In Windows 3.1 and
   later, call the EndDoc() function rather than the ENDDOC escape.]
<P>
<P><PRE>     Escape(hDC, ENDDOC, 0, 0L, 0L);
</PRE>
<P><LI>Call DeleteDC() to free the printer display context.
<P>
<P><PRE>     DeleteDC(hDC);
</PRE><P>
</OL>Printing requires little extra work if the drawing code is modular. The
drawback to the approach above is that it can require more memory and
printing time than may otherwise be necessary. For more information on
speeding the printing process, query on the following words in the
Microsoft Knowledge Base:
<P>
<PRE>   prod(winsdk) and printing and banding
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiPrn<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
