

<HTML>
<HEAD>
<TITLE>Basics of Banding Printing in Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75471 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1991/08/21">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  Banding is a technique used to implement the full functionality of the Windows graphics device interface (GDI) in printer drivers that can only print bitmaps for graphics. An application that is aware of the banding process can enhance its printing...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAGI,QADF,QAB5,QACT,QDL9,QBWO,QBWN,QAU9,QBWQ,QAK4,QAIF,QAJH,QAY4,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Basics of Banding Printing in Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75471 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Banding is a technique used to implement the full functionality of the
Windows graphics device interface (GDI) in printer drivers that can
only print bitmaps for graphics. An application that is aware of the
banding process can enhance its printing performance.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Most dot-matrix printers and many laser printers cannot print graphics
such as polygons and lines. They can print only bitmaps and text.
These printers require special support in GDI to implement the full
range of GDI functionality.
<P>
When an application prints to such a device, the printer driver does
not send output directly to the printer. Rather, the printer driver
generates a bitmap in memory. When all graphics have been rendered
into the bitmap, the bitmap itself is printed.
<P>
For most printers, the bitmap can be very large. For example, a 300
dots-per-inch (dpi) laser printer requires nearly a megabyte to render
a single letter-size page. To reduce memory requirements, the image is
broken into a sequence of smaller rectangles, called bands, which
cover the page. Each of these individual rectangles is rendered and
downloaded to the printer separately.
<P>
There are two ways that the graphics calls can be duplicated on each
band. If the application is unaware of the banding process, GDI will
capture all graphics calls for a page into a metafile. When the
application calls the NEWFRAME (next page) escape, GDI plays the
entire metafile into each band. Alternatively, the application may
request a band from the printer driver and produce the output itself.
A significant optimization results since GDI will not need to create,
write, and reread a disk-based metafile.
<P>
Whether GDI or the application requests the band from the driver, the
process is very similar. Banding printer drivers implement an escape
called NEXTBAND. The escape causes the printer driver to download the
previous band to the printer (if any) and to initialize itself to
render the new band. It also returns a rectangle defining the bounds
of the band bitmap relative to the whole page. Output calls made to
the driver's device context (DC) after NEXTBAND go directly to the
printer driver.
<P>
GDI, or the banding application, calls NEXTBAND after each band is
rendered to download the band and also to retrieve the next band from
the driver. When all bands have been printed, NEXTBAND causes the
printer driver to eject the page and return an empty rectangle to
indicate the end of a page.
<P>
For more information on how to implement banding, query on the
following words:
<P>
<PRE>   prod(winsdk) and banding
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiPrn<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
