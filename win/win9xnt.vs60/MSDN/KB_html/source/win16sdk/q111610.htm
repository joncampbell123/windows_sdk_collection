

<HTML>
<HEAD>
<TITLE>Suppressing "Cannot Find MYDLL.DLL" Error Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111610">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1994/02/14">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  When explicitly loading a dynamic-link library (DLL) using LoadLibrary(), Windows will display a  file error  message box with the error     Cannot find MYDLL.DLL  where MYDLL.DLL is the name of the DLL specified in LoadLibrary() before returning f...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QA01,QDL9,QBWO,QBWN,QBWQ,QAKP,QABI,QDNN,QAUD,QAH4,QAEV,QBVV,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Suppressing "Cannot Find MYDLL.DLL" Error Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111610</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information is this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When explicitly loading a dynamic-link library (DLL) using LoadLibrary(),
Windows will display a "file error" message box with the error
<P>
<PRE>   Cannot find MYDLL.DLL

</PRE>where MYDLL.DLL is the name of the DLL specified in LoadLibrary() before
returning from LoadLibrary() if the DLL does not exist in the Windows path.
For more information about the Windows path, see the Windows search order
described in the documentation for LoadLibrary().
<P>
It is possible to suppress this error message so that a custom error
message or other error handling may be implemented without this system
error box. To do so, call SetErrorMode() with SEM_NOOPENFILEERRORBOX before
the call to LoadLibrary(). LoadLibrary() will return error code 2 meaning
"File was not found."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
SetErrorMode() only affects the error mode of the current task and does not
affect the entire system. The return value may be used to toggle the error
mode in different portions of an application.
<P>
For an implicitly loaded DLL that may be missing, the system will display
the aforementioned error box if the application is run from Program
Manager. After clicking the OK button, the following message appears:
<P>
<PRE>   Cannot find file d:\path\myexe.exe (or one of its components).
   Check to ensure the path and filename are correct and that
   all required libraries are available.

</PRE>From File Manager, no "file error" message box appears, but the following
message is displayed instead:
<P>
<PRE>   File manager cannot find the specified file (or one of its
   components).

   Make sure the path and filename are correct and that all required
   libraries are available.

</PRE>Because these error messages appear before the WinMain() of the application
executes, SetErrorMode() cannot suppress the error message boxes for
implicitly linked DLLs. Furthermore, there is no way to configure Program
Manager to suppress the "file error" message box.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE> {
 HINSTANCE hDLL;
 UINT uOldErrorMode;

 uOldErrorMode = SetErrorMode(SEM_NOOPENFILEERRORBOX);

 // Try to load DLL.
 hDLL = LoadLibrary("MYDLL.DLL");

 if (hDLL == 2)
    MessageBox(NULL, "MYDLL.DLL does not exist", "ERROR", MB_OK);
 else if (hDLL &lt;= HINSTANCE_ERROR)
    MessageBox(NULL, "Other problems loading MYDLL.DLL, "ERROR", MB_OK);
 else
 {
    MessageBox(NULL, "MYDLL.DLL exists", "SUCCESS", MB_OK);
    FreeLibrary(hDLL);
 }

 SetErrorMode(uOldErrorMode);  // Can restore error mode if desired.
 }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: KrDll<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
