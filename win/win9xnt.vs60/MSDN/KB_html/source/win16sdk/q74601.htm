

<HTML>
<HEAD>
<TITLE>Using GetDIBits() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74601 ">
<META NAME="KBModify" CONTENT="1995/06/12">
<META NAME="KBCreate" CONTENT="1991/07/24">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  GetDIBits() retrieves the bits of a specified bitmap and copies them, in device-independent format, into the buffer that is specified in the lpBits parameter. If the lpBits parameter is NULL, GetDIBits fills in the BITMAPINFO data structure to whic...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QDL9,QBWO,QBWN,QBBI,QAYY,QAIC,QBCF,QDNG,QBFM,QAGI,QAHE,QBWQ,QAB5,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using GetDIBits()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 12, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74601 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
GetDIBits() retrieves the bits of a specified bitmap and copies them, in
device-independent format, into the buffer that is specified in the lpBits
parameter. If the lpBits parameter is NULL, GetDIBits fills in the
BITMAPINFO data structure to which the lpBitsInfo parameter points, but
does not retrieve bits from the bitmap. The application must ensure that
the BITMAPINFO data structure passed in the GetDIBits call contains valid
data before making the GetDIBits call. This article describes how Windows
verifies that the data in the BITMAPINFO structure is valid.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P>
When NULL is specified as the lpBits parameter of GetDIBits, the function
will ensure that the structure passed in to it contains valid data. Then,
the function sets the biSizeImage field of the BITMAPINFOHEADER structure
and the bmiColors field of the BITMAPINFO structure.
<P>
To validate the BITMAPINFO structure, the following list outlines the
checks that are made:
<P>
<PRE>   biSize == sizeof(BITMAPINFOHEADER)
   biHeight: high word is 0
   biWidth: high word is 0
   biPlanes == 1
   biBitCount == 1, 4, 8, or 24
   biCompression: high word is 0
   biCompression: low word is 0, BI_RLE8, or BI_RLE4
   if biCompression == BI_RLE8: biBitCount == 8
   if biCompression == BI_RLE4: biBitCount == 4

</PRE>NOTE: For Windows 95 and Windows NT, the following line
<P>
<PRE>   biBitCount == 1, 4, 8, or 24

</PRE>should be changed to:
<P>
<PRE>   biBitCount == 1, 4, 8, 16, 24, or 32

</PRE>All these conditions must be true if GetDIBits is to function correctly and
return valid data (either by setting the biSizeImage field or by returning
the DIB's bits).
<P>
If any of these conditions is not true, the header is invalid, and
GetDIBits returns 0 (zero).
<P>
GetDIBits is performed on the device driver level. Because different
devices may use different formats to store data, only the device knows its
particular format. Thus, it is the responsibility of the driver to convert
the device format to a device-independent format. If the device driver is
not completely reliable, then GetDIBits may return erroneous information.
This should be considered when using GetDIBits.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiBmp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 12, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
