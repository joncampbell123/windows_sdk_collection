

<HTML>
<HEAD>
<TITLE>PRB: BS_GROUPBOX-Style Child Window Background Painting Wrong </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79982 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/01/14">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  When a BS_GROUPBOX style window is created, its background does not erase correctly.  CAUSE =====  The parent window of the BS_GROUPBOX style window has the WS_CLIPCHILDREN style, which prevents the parent window from erasing the group box's backgr...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAEF,QAGB,QAH4,QAPW,QDL9,QBWO,QBWN,QANX,QAGQ,QBWQ,QBVV,QAK3,QA9N,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: BS_GROUPBOX-Style Child Window Background Painting Wrong</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79982 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg kbprb kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a BS_GROUPBOX style window is created, its background does not
erase correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
The parent window of the BS_GROUPBOX style window has the
WS_CLIPCHILDREN style, which prevents the parent window from
erasing the group box's background.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Subclass the group box window to process the WM_ERASEBKGND message
by erasing its background. Listed below is a code fragment to
demonstrate this procedure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The WS_CLIPCHILDREN style causes a window to exclude the areas
occupied by child windows when the window paints its client area.
However, a BS_GROUPBOX style window is a static control that never
erases its background. Erasing the background removes any controls or
buttons that appear within the group box.
<P>
Therefore, when another child window is dropped over a group box and
subsequently dragged away, portions of that child window remain
visible in the group box's background. This problem does not occur
when the parent window does not have the WS_CLIPCHILDREN style.
<P>
The following code fragment should be placed in the group box's
subclass procedure. This code erases the background of the group box.
<P>
<PRE>   case WM_ERASEBKGND:
       {
       HBRUSH  hBrush, hOldBrush;
       HPEN    hPen, hOldPen;
       RECT    rect;
       HDC     hDC;

       hDC = GetDC(hWnd);

       // Obtain a handle to the parent window's background brush.
       hBrush = GetClassWord(ghWnd, GCW_HBRBACKGROUND);
       hOldBrush = SelectObject(hDC, hBrush);

       // Create a background-colored pen to draw the rectangle
       // borders, where gWindowColor is some globally defined
       // COLORREF variable used to paint the window's background
       hPen = CreatePen(PS_SOLID, 1, gWindowColor);
       hOldPen = SelectObject(hDC, hPen);

       // Erase the group box's background.
       GetClientRect(hWnd, &amp;rect);
       Rectangle(hDC, rect.left, rect.top, rect.right, rect.bottom);

       // Restore the original objects before releasing the DC.
       SelectObject(hDC, hOldPen);
       SelectObject(hDC, hOldBrush);

       // Delete the created object.
       DeleteObject(hPen);

       ReleaseDC(hWnd, hDC);

       // Instruct Windows to paint the group box text and frame.
       InvalidateRect(hWnd, NULL, FALSE);

       // Insert code here to instruct the contents of the group box
       // to repaint as well.

       return TRUE; // Background has been erased.
       }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg kbprb kbcode<BR>
KBSubcategory: UsrDlgs<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
