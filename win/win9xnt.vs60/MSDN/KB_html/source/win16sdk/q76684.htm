

<HTML>
<HEAD>
<TITLE>SAMPLE: Code Replaces sscanf in Windows DLLs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q76684 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/09/30">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The Microsoft C run-time library function sscanf is not compatible for use with a dynamic-link library (DLL) for the Microsoft Windows graphical environment.  WSSCANF is a file in the Software Library that can serve as a limited replacement for thi...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QAY5,QDL9,QBWO,QBWN,QBV8,QAB9,QBVV,QBHQ,QAHE,QBWQ,QBC9,QBC8,QANO,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Code Replaces sscanf in Windows DLLs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q76684 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft C run-time library function sscanf is not compatible for use
with a dynamic-link library (DLL) for the Microsoft Windows graphical
environment.
<P>
WSSCANF is a file in the Software Library that can serve as a limited
replacement for this function.
<P>
Download WSSCANF.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/wsscanf.exe">WSSCANF.EXE</A> <I>(size: 21212 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/wsscanf.exe">WSSCANF.EXE</A> <I>(size: 21212 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The sscanf(), fprintf(), and scanf() functions are not available for
Windows DLLs.
<P>
There are two factors that cause these functions to be incompatible:

<OL><P><LI>These functions rely on near pointers.

<P><LI>These functions expect SS == DS.
<P>
</OL>Because neither of these conditions is true when a function in a DLL
uses data from an application, these functions are not available.
<P>
The WSSCANF file in the Software Library contains the source code to a
wsscanf() function that can serve as a limited replacement for the sscanf
function. It does not support floating point. The wsscanf() code is based
on the sscanf() source code in the Microsoft C 6.0a run-time library. The
source code has been modified to work correctly in a DLL, and requires that
all parameters are specified as FAR pointers. The following code
demonstrates using the wsscanf() function:
<P>
<PRE>   char   szBuf[] = "1 3 b000:0200";
   int    nValue1, nValue2;
   LPSTR  lpPtr;

   wsscanf(szBuf, "%d %d %p", (int FAR *)&amp;nValue1,
            (int FAR *)&amp;nValue2, (LPSTR FAR *)&amp;lpPtr);

</PRE></OL>NOTE: The first two parameters are not explicitly typecast in the function
call. The function prototype typecasts the first two parameters
automatically; however, the application must typecast each subsequent
parameter. If the application does not typecast each parameter, when the
application calls wsscanf an unrecoverable application error (UAE) occurs.
<P>
The wsscanf() function does not support floating point numbers (the %f,
%g, and %e format specifiers).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib WSSCANF.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: TlsMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
