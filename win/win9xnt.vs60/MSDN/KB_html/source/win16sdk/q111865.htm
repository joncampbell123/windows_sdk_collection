

<HTML>
<HEAD>
<TITLE>BUG: StretchBlt()/StretchDIBits() Fail with Very Large Stretch </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111865">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1994/02/22">
<META NAME="Keywords" CONTENT="kbprg kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  If the stretching factor is large, for example, when stretching from a very small to a large height, StretchDIBits() and StretchBlt() may return 0 (zero) and display nothing. The same bitmap with a smaller stretch is displayed correctly.  CAUSE ===...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANY,QAW9,QDL9,QBWO,QBWN,QAKP,QAGI,QBSO,QBJQ,QBWQ,QBVV,QAY2,QAU4,QALZ,QAK6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: StretchBlt()/StretchDIBits() Fail with Very Large Stretch</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111865</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If the stretching factor is large, for example, when stretching from a very
small to a large height, StretchDIBits() and StretchBlt() may return 0
(zero) and display nothing. The same bitmap with a smaller stretch is
displayed correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
Most display drivers do not implement their own StretchBlt() or
StretchDIBits() so GDI must simulate these calls. Part of the GDI
simulation involves allocating temporary work buffers, which are limited to
64K. If the size of the work buffer is calculated to be greater than 64K,
then the height of the source and destination rectangles are halved until
they are less than 64K. The problem is that if GDI must continue to divide
the height by two (2) to get a buffer less than 64K, the source or
destination height could eventually reach one scan line. At this point, the
call fails because it cannot break up a scan line into subunits.
<P>
StretchBlt() and StretchDIBits() are not designed to provide unlimited
stretching. However, they may fail a bit more prematurely than their design
limitation.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If StretchBlt() or StretchDIBits() fails on a large stretch, an application
can divide up the source bitmap, stretch the pieces individually, and
position them correctly once stretched. Another alternative is to do a
smaller stretch. There is no formula to determine exactly what bitmaps will
fail at what stretch size.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in Windows versions 3.0 and
3.1. We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To reproduce the problem, create a bitmap approximately 2048 pixels wide by
16 pixels high. Then, display the bitmap with the DIBVIEW sample from the
Windows 3.1 SDK. Choose Stretch To Window from DIBVIEW's Options menu, so
that the bitmap is stretched according to the size of the client window.
When the height is more than about 200 pixels, the bitmap will not be
displayed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: buglist3.00 buglist3.10 3.00 3.10 fail zoom<BR>
KBCategory: kbprg kbbuglist<BR>
KBSubcategory: GdiBmp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
