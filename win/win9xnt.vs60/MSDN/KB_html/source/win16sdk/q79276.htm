

<HTML>
<HEAD>
<TITLE>Subclassing the Desktop and Windows of Other Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q79276 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1991/12/17">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The code to subclass the desktop window, or windows that belong to other applications, must be placed in a dynamic-link library (DLL).  MORE INFORMATION  In most cases, the desktop window uses the stack segment (SS) of the currently scheduled task....">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAL4,QAH4,QA0J,QBWQ,QAHT,QAB9,QBBI,QATO,QAGI,QAJH,QAGQ,QAOT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Subclassing the Desktop and Windows of Other Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q79276 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The code to subclass the desktop window, or windows that belong to
other applications, must be placed in a dynamic-link library (DLL).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In most cases, the desktop window uses the stack segment (SS) of the
currently scheduled task. This is done for performance reasons because
it reduces the number of task switches that take place when the
desktop receives paint or mouse messages. In some cases, the desktop
cannot be switched immediately to the currently scheduled task. In
this situation, it will temporarily use the SS of the previously
scheduled task.
<P>
When the desktop is subclassed, the data segment (DS) that the
subclass procedure uses is specified by the hInstance used in a
MakeProcInstance() call. However, the subclass procedure's SS depends
on the currently scheduled task, as described earlier. Because the
currently scheduled task may not be the task that subclassed the
desktop, it is possible that SS != DS when the subclass procedure is
executed. Therefore, the subclass procedure cannot assume that SS ==
DS. For this reason, the code to subclass the desktop must reside in a
DLL where it is assumed that SS != DS.
<P>
When a window belonging to another application is subclassed, the DS
that the subclass procedure uses is specified by the hInstance used in
the MakeProcInstance() call. The SS used by the subclass procedure is
the SS of the application that owns the window. Therefore, the
subclass procedure cannot assume that SS == DS. For this reason, the
code to subclass another application's window must reside in a DLL
where it is assumed that SS != DS.
<P>
The DLL in which the subclass procedure is placed should be compiled
with the Microsoft C Compiler's -Aw option, which tells the compiler
that SS != DS. Using this option causes the compiler to generate a
warning message when it detects the improper creation of a near
pointer to an automatic variable.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: UsrWndw<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
