

<HTML>
<HEAD>
<TITLE>SAMPLE: WINCAP Captures Screens Using DIB API </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97193 ">
<META NAME="KBModify" CONTENT="1996/08/05">
<META NAME="KBCreate" CONTENT="1993/04/11">
<META NAME="Keywords" CONTENT="kbprg kbfile kbwebcontent">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  WINCAP demonstrates how to capture, save, and print the entire screen, portions of the screen, or specific windows. The program also defines routines that accomplish common device-independent bitmap (DIB) functions; these routines form the DIB appl...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH2,QAOX,QAY5,QAFR,QDL9,QBWO,QBWN,QAUR,QAA8,QDIT,QAY2,QA1O,QAPF,QADF,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: WINCAP Captures Screens Using DIB API</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97193 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
WINCAP demonstrates how to capture, save, and print the entire screen,
portions of the screen, or specific windows. The program also defines
routines that accomplish common device-independent bitmap (DIB)
functions; these routines form the DIB application programming
interface (API). WINCAP uses the DIB API functions for most of the
screen capture, printing, and saving work. See the DIBAPI.TXT file for
a description of the DIB API functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WINCAP illustrates the following techniques:

<UL><LI>Capturing the screen (or a specific window) into a DIB

<LI>Capturing the screen to a device-dependent bitmap (DDB)

<LI>Printing a DIB using banding

<LI>Loading and saving a DIB to a disk file (.BMP file)

<LI>Converting between DIBs and DDBs

<LI>Displaying the captured screen DDB
<P>
</UL>All of these techniques call the DIB API. WINCAP includes the source
code for these functions. You can call these functions easily from a
different application by simply compiling the enclosed DIBAPI.DLL, and
linking with the DIBAPI.LIB import library.
<P>
The preferred way to capture a screen in Microsoft(R) Windows(TM) is
to copy the screen pixels into a DIB, and then to use this DIB in
subsequent operations (for example, to save the bitmap to a file or
print the bitmap).
<P>
If you do not use a DIB in the intermediate step, the results of the
screen print may be less than desirable. If you use a DIB to hold the
screen image, device-dependent information is removed from the bitmap.
This simplifies the process of displaying the image on devices with
different display capabilities. For example, capturing a screen from
a 24-bit display adapter and printing it on a 1-bit (monochrome)
printer can produce exceptional results if DIBs are used.
Additionally, many printer drivers implement gray-scale dithering; the
output on these printers is also excellent when DIBs are used.
<P>
NOTE: Because bitmaps are device-dependent, you should avoid the
BitBlt function when printing bitmaps. The type of bitmaps that the
BitBlt function requires are normally in the format of the display
driver rather than the printer driver. Depending on the drivers
involved, the results of using BitBlt to print a bitmap can vary from
extremely poor output quality to no output at all.
<P>
Although all printer drivers are able to BitBlt a monochrome bitmap to
the printer, this technique generally produces poor results because
the printer cannot apply gray-scaling to the image.
<P>
This technique of using a DIB to convert a bitmap between display
devices with different capabilities can also be used to convert
bitmaps while preserving the original color information (for example,
loading a 256-color bitmap from a .BMP file and printing it to a
3-color printer or displaying it on a 24-bit display).
<P>
The file DIBAPI.TXT contains more information on function parameters
and usage. A Windows Help file for the DIB APIs is also included.
<P>
Download WINCAP.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/wincap.exe">WINCAP.EXE</A> <I>(size: 105212 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/wincap.exe">WINCAP.EXE</A> <I>(size: 105212 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 printscreen 3.10 softlib WINCAP.EXE<BR>
KBCategory: kbprg kbfile kbwebcontent<BR>
KBSubcategory: GdiBmp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
