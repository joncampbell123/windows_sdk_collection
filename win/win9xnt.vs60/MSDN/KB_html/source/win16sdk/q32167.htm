

<HTML>
<HEAD>
<TITLE>SAMPLE: Code to Demonstrate Superclassing Available </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q32167 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1988/06/27">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  There is a sample application available in the Microsoft Software Library that demonstrates the concept of superclassing control windows. Superclassing provides the same capabilities as subclassing; however, it can be much more convenient to use an...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAH4,QAGI,QAD7,QAHP,QAH6,QAJQ,QAJH,QDL9,QBWO,QBWN,QAH7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Code to Demonstrate Superclassing Available</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q32167 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There is a sample application available in the Microsoft Software Library
that demonstrates the concept of superclassing control windows.
Superclassing provides the same capabilities as subclassing; however, it
can be much more convenient to use and produces smaller code if there are
multiple controls to be altered in the same fashion.
<P>
Download SUPERCLS.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/supercls.exe">SUPERCLS.EXE</A> <I>(size: 24247 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/supercls.exe">SUPERCLS.EXE</A> <I>(size: 24247 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
To superclass, create a new class that uses the control window procedure
instead of the default window procedure. This enables the application to
process the appropriate messages and to pass the others along to the
default procedure where the messages will be processed correctly based on
the control type.
<P>
To implement superclassing, create a window of the type to superclass.
Query all available information about the control and use this information
when the new window is created, substituting the class name and window
procedure. When this window procedure is called, process the desired
messages and pass the others to the standard control procedure (determined
in the query phase).
<P>
By registering a new class, the application can create superclassed
controls using the application resource (RC) file or CreateWindow()
function without any further work, which can eliminate a number of
SetWindowLong() calls if many controls are to be modified in the same
manner.
<P>
In the SUPERCLS example, the application creates a new control class called
"SuperEdit", which is identical to a regular edit control but refuses to
accept the "b" character.
<P>
Look for the string "SuperEdit" in the .C, .RC, and .DEF files to see the
affected areas of the code.
<P>
This example shows superclassed Windows controls. Because the class name
has been changed and the application's instance is used in the class
registration, all controls will be created with this application's DS. This
causes no problems for controls. However, this does not work if an attempt
is made to superclass something other than a control. In that case, it is
desirable to use the application's instance with the class so that it will
be destroyed when the application exits. However, it is necessary to
perform some additional work before the call to CallWindowProc() to set the
DS for the subclassed window procedure. The hInstance passed to
CreateWindow() determines which DS the superclassing procedure uses; to
have the superclassed procedure use a different DS, it is necessary to
change the DS value. For more information, see the notes near the call to
CallWindowProc().
<P>
Each edit control created using DialogBox(), CreateDialog(), or through an
RC file normally has its own DS. When the application changes the class
name, the code within Windows that handles edit controls is not activated.
Instead, the control uses the application's DS as if it were created using
CreateWindow(). This does not cause any difficulties except that when the
code for the superclassed edit control calls LocalAlloc(), it consumes
space in the application's local heap. This should not cause problems in
most cases.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 sub class subclass control softlib<BR>
SUPERCLS.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
