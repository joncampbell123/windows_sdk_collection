

<HTML>
<HEAD>
<TITLE>Reasons for Failure of Bitmap Functions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92529 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/11/09">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The bitmap functions (all) can fail for several reasons. Different functions return different values to indicate failure. Read the documentation for information about each function. This article combines the causes of failure for all functions and ...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY5,QBV8,QAB9,QAL3,QAB5,QAWI,QAH2,QBXS,QAK6,QAJ6,QBW6,QABA,QBVV,QDL9,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Reasons for Failure of Bitmap Functions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92529 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The bitmap functions (all) can fail for several reasons. Different
functions return different values to indicate failure. Read the
documentation for information about each function. This article combines
the causes of failure for all functions and provides a resolution or
explanation. A list of affected functions follows each cause. The causes
are:

<OL><P><LI>Invalid parameters.

<P><LI>The device knows how to deal with a DIB (device-independent bitmap).
    Failure within that driver, as it works on the DIB, is propagated to
    GDI (graphics device interface).

<P><LI>GDI is simulating the DIB operation. Bitmap is 64K or larger.

<P><LI>A scan line (DWORD aligned) is 64K or larger.

<P><LI>Insufficient global memory.

<P><LI>CBM_INIT is set in the dwInit field of CreateDIBitmap. GDI is setting
   the bits obtained from the DIB. The simulation fails if GDI cannot
   create a memory-based DC (device context) and select the bitmap into it.

<P><LI>The source and destination DCs represent different physical devices.

<P><LI>The source rectangle extends beyond the source bitmap.

<P><LI>The point lies outside of the clipping region.

<P><LI>The bitmap dimensions were not set by SetBitmapDimension.

<P><LI>The bitmap resource could not be found (FindResource) or loaded
    (LoadResource) or locked (LockResource) in memory.

<P><LI>A memory DC was passed when a device DC was expected.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Cause 1: Invalid parameters.
<P>
Explanation 1: DCs, DIB headers, bitmap handles, starting scan line, and
other parameters should be valid.
<P>
Affected Functions: All functions.
<P>
Cause 2: The device knows how to deal with a DIB. Failure within that
driver, as it works on the DIB, is propagated to GDI.
<P>
Explanation 2: Low memory (within the device and/or global memory) and bugs
are the common sources of device driver failures. For more information,
search the Microsoft Knowledge Base or contact the device driver vendor.
<P>
Affected Functions: CreateDIBitmap, GetDIBits, SetBitmapBits, SetDIBits,
SetDIBitsToDevice, StretchDIBits.
<P>
Cause 3: GDI is simulating the DIB operation. Bitmap is 64K or larger.
<P>
Explanation 3: GDI's simulation of GetDIBits does not support bitmaps that
are 64K or larger.
<P>
Affected Functions: GetDIBits.
<P>
Cause 4: Each scan line (DWORD aligned) is 64K or larger.
<P>
Explanation 4: A scan line is one row of pixels in a bitmap.
<P>
Affected Functions: CreateBitmap, CreateCompatibleBitmap, CreateDIBitmap,
CreateDiscardableBitmap.
<P>
Cause 5: Insufficient global memory.
<P>
Explanation 5: GDI needs global memory to create bitmaps and to support
intermediate objects as it performs operations such as stretching, getting
bits from DIBs, and setting bits in DIBs.
<P>
Affected Functions: BitBlt, CreateBitmap, CreateBitmapIndirect,
CreateCompatibleBitmap, CreateDIBitmap, CreateDiscardableBitmap, GetDIBits,
LoadBitmap, SetDIBits, SetDiBitsToDevice, StretchBlt, StretchDIBits.
<P>
Cause 6: CBM_INIT is set in the dwInit field of CreateDIBitmap. GDI is
setting the bits obtained from the DIB. The simulation fails if GDI cannot
create a memory based DC and select the bitmap into it.
<P>
Affected Functions: CreateDIBitmap.
<P>
Cause 7: The source and destination DCs represent different physical
devices.
<P>
Explanation 7: The format for device-dependent bitmaps varies from one
device to another. Transferring bits directly between them is not allowed.
<P>
Affected Functions: BitBlt, PatBlt, StretchBlt.
<P>
Cause 8: The source rectangle extends beyond the source bitmap.
<P>
Explanation 8: These functions operate on a rectangular area in the bitmap
selected into the source DC. This rectangular area cannot extend beyond the
boundaries of the bitmap.
<P>
Affected Functions: BitBlt, StretchBlt.
<P>
Cause 9: The point lies outside of the clipping region.
<P>
Resolution 9: You may get another DC for the same window. The default
clipping region includes the entire visible client area.
<P>
Affected Functions: GetPixel, SetPixel.
<P>
Cause 10: The bitmap dimensions were not set by SetBitmapDimension.
<P>
Explanation 10: GetBitmapDimension retrieves the values set using
SetBitmapDimension.
<P>
Affected Functions: GetBitmapDimension.
<P>
Cause 11: The bitmap resource could not be found (FindResource) or loaded
(LoadResource) or locked (LockResource) in memory.
<P>
Resolution 11: Ensure that the bitmap resource exists and that the hInst
parameter refers to the correct hInstance. Try increasing the number of
file handles using SetHandleCount and increasing available global memory by
closing some applications. For more information about the causes of failure
of resource functions, query the Microsoft Knowledge Base on the following
keywords:
<P>
<PRE>   prod(winsdk) and failure and LoadResource and FindResource and
   LockResource

</PRE></OL>Affected Functions: LoadBitmap, SetBitmapBits.
<P>
Cause 12: A memory DC was passed when a device DC was expected.
<P>
Explanation 12: SetDIBitsToDevice only works on device DCs.
<P>
Affected Functions: SetDIBitsToDevice.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 fails SetBitmapDimensionEx<BR>
GetBitmapDimensionEx<BR>
KBCategory: kbprg<BR>
KBSubcategory: GdiBmp<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
