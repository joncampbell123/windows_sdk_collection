

<HTML>
<HEAD>
<TITLE>Preventing an MDI Child Window from Changing Size </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71669 ">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1991/04/30">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  In an application using the Windows multiple document interface (MDI), MDI child windows are always created with a maximize button, a minimize button, and a thick  sizing  border. Currently, it is not possible to modify this default behavior.  Howe...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBW1,QA4P,QDL9,QBWO,QBWN,QBVV,QBWQ,QBXS,QAGX,QAY2,QAUD,QAKR,QAIB,QAHE,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Preventing an MDI Child Window from Changing Size</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71669 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In an application using the Windows multiple document interface (MDI), MDI
child windows are always created with a maximize button, a minimize button,
and a thick "sizing" border. Currently, it is not possible to modify this
default behavior.
<P>
However, it is possible to prevent an MDI child from being maximized,
minimized, or sized. This can be done by performing two steps:

<OL><P><LI>Disable the Maximize, Minimize, and Size options on the child
   window's system menu.

<P><LI>Trap the appropriate WM_SYSCOMMAND messages in the MDI child
   window's window procedure.
<P>
</OL>This article contains a sample MDI child window procedure that
illustrates this technique.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample MDI child window procedure can be used to
implement an MDI child that can not be maximized, minimized or sized:
<P>
LONG FAR PASCAL SampleMDIChildWndProc(hWnd, msg, wParam, lParam)
<P>
<PRE>HWND    hWnd;
WORD    msg;
WORD    wParam;
LONG    lParam;

// This sample MDI child window procedure can be used to prevent the
// MDI child from being maximized, minimized, or sized.
//
// Note that the child will still have a maximize button, a minimize
// button, and a thick "sizing" border. Currently, there is no way to
// prevent Windows from creating MDI children with these default
// styles.
//
// We can, however, disable the maximizing, minimizing, and sizing
// functionality by:
//
// 1. Disabling system menu options
// 2. Trapping WM_SYSCOMMAND messages

</PRE></OL>{
<PRE>    HMENU    hSystemMenu;    // the MDI child's system menu

    switch (msg)
        {
    case WM_INITMENU:
        // Disable and gray the Maximize, Minimize, and Size items
        // on the MDI child's system menu
        hSystemMenu = GetSystemMenu(hWnd, FALSE);
        EnableMenuItem(hSystemMenu, SC_MAXIMIZE, MF_GRAYED |
             MF_BYCOMMAND);
        EnableMenuItem(hSystemMenu, SC_MINIMIZE, MF_GRAYED |
             MF_BYCOMMAND);
        EnableMenuItem(hSystemMenu, SC_SIZE, MF_GRAYED |
             MF_BYCOMMAND);
        break;

    case WM_SYSCOMMAND:
        // "Eat" these system commands to disable maximizing,
        // minimizing, and sizing functionality.
        // Note that wParam must be combined with 0xFFF0, using
        // the C bitwise AND (&amp;) operator, when processing
        // the WM_SYSCOMMAND message.
        switch (wParam &amp; 0xFFF0)
            {
        case SC_MAXIMIZE:
        case SC_MINIMIZE:
        case SC_SIZE:
             return 1L;

        default:
             break;
            }
        break;

    default:
        break;
        }

    return DefMDIChildProc(hWnd, msg, wParam, lParam);
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: UsrMdi<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
