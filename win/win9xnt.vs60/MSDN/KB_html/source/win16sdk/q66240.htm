

<HTML>
<HEAD>
<TITLE>Aligning Columns in a Windows 3.x List Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q66240 ">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1990/10/16">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  To align columns of text in a list box in an application running under Windows version 3.0, the suggested approach is to use the proportional system font and to use tab characters to align the text. For tabs to work properly, you must specify the L...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QADF,QBVR,QBWQ,QAH4,QAR4,QAEB,QAB5,QAGQ,QBE7,QBE6,QA7O,QAOE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Aligning Columns in a Windows 3.x List Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q66240 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To align columns of text in a list box in an application running under
Windows version 3.0, the suggested approach is to use the proportional
system font and to use tab characters to align the text. For tabs to work
properly, you must specify the LBS_USETABSTOPS style when you create the
list box.
<P>
Code that depends on space characters for correct alignment of text does
not work correctly with the Windows proportional system font. This is a
common problem when migrating applications written for Windows 2.x and
earlier to Windows 3.0. This problem can be corrected by using tabs, or by
using a fixed-pitch font in the list box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
One particular fixed-pitch font is always available as a system resource.
This font, identified as the SYSTEM_FIXED_FONT, is used by applications
developed for previous versions of Windows that have not been marked for
Windows 3.0 font compatibility.
<P>
To use a fixed font in a dialog box, you must send each control a
WM_SETFONT message as part of the dialog box's initialization process. The
handle to the font is passed in wParam for the message. When lParam
contains a nonzero value, the control redraws itself using the new font. An
lParam of zero omits the redraw. Below is a small code fragment that
demonstrates the processing of the WM_INITDIALOG message. ID_CONTROL
represents the control ID of the list box (or other control).
<P>
<PRE>  HFONT   hFixedFont;
  ...
  case WM_INITDIALOG:
          hFixedFont = GetStockObject(SYSTEM_FIXED_FONT);
          SendDlgItemMessage(hDlg, ID_CONTROL, WM_SETFONT,
                             hFixedFont, 0L);
          ... /* possibly other processing */
          break;

</PRE>The following code fragment selects a fixed font into a device context
(DC):
<P>
<PRE>  HFONT   hFixedFont;
  ...
  hFixedFont = GetStockObject(SYSTEM_FIXED_FONT);
  hOldFont   = SelectObject (hDC, hFixedFont);
  ...
  /* before calling DeleteDC() or ReleaseDC(),
   * restore original font */
  SelectObject(hDC, hOldFont);
  ...

</PRE>More information on this and other subjects related to Windows
programming is contained in the file TIPS.TXT. The SDK installation
program places this file in the WINDEV directory, with the other SDK
files. TIPS.TXT contains a set of notes provided by Microsoft Product
Support Services to help answer some of the most commonly asked
questions by developers of Windows 3.0 applications. The notes are
addressed to new Windows developers as well as to those moving Windows
2.x applications to Windows 3.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10<BR>
KBCategory: kbprg<BR>
KBSubcategory: UsrCtl<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
