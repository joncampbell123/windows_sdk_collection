

<HTML>
<HEAD>
<TITLE>SAMPLE: Owner-Draw Menu Item Width Includes a Check Mark Width </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q71061 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/04/04">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  When an application creates an owner-draw menu item with the MF_OWNERDRAW style, the application receives a WM_MEASUREITEM message for that item. The application is required to fill the MEASUREITEMSTRUCT pointed to by the lParam of this message.  T...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVI,QABH,QABI,QDL9,QBWO,QBWN,QBCF,QAM3,QBW9,QAVS,QBQU,QBWQ,QBCE,QAPF,QALQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Owner-Draw Menu Item Width Includes a Check Mark Width</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q71061 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When an application creates an owner-draw menu item with the MF_OWNERDRAW
style, the application receives a WM_MEASUREITEM message for that item. The
application is required to fill the MEASUREITEMSTRUCT pointed to by the
lParam of this message.
<P>
The itemWidth field of the MEASUREITEMSTRUCT is normally filled with the
actual width of the item. However, when Windows displays that menu item,
the width is increased by the width of a check mark; that is, Windows
automatically expands the item to leave space for a check mark.
<P>
To make the menu item only as wide as the actual item, fill the itemWidth
field with the width of the item, minus the width of a check mark, as
returned by GetMenuCheckMarkDimensions().
<P>
The Microsoft Software Library contains an example, MENUBMP, of owner-draw
menus with bitmaps where each item is only as large as the bitmap.
<P>
Download MENUBMP.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/menubmp.exe">MENUBMP.EXE</A> <I>(size: 25065 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/menubmp.exe">MENUBMP.EXE</A> <I>(size: 25065 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The following code fragment demonstrates processing a WM_MEASUREITEM
message that results in a menu item only as wide as the actual item. In
this case, the menu is being made with bitmaps. The handle to the bitmap is
stored as part of the item data.
<P>
<PRE>   // Local variables.
   LPMEASUREITEMSTRUCT     lpItem;
   HBITMAP                 hBitmap;
   BITMAP                  bm;
   WORD                    cxCheck;

   ...

   case WM_MEASUREITEM:
       // lParam is a pointer to the structure.
       lpItem = (LPMEASUREITEMSTRUCT)lParam;

       // A bitmap handle was stored in the item data.
       hBitmap = LOWORD(lpItem-&gt;itemData);

       /*
        * The width of a check mark is automatically added to
        * menu items so we need to subtract it to make the
        * menu the minimum size.
        */
       cxCheck = LOWORD(GetMenuCheckMarkDimensions());

       // Get the bitmap dimensions
       GetObject(hBitmap, sizeof(BITMAP), (LPVOID)&amp;bm);

       // Set the width to the width of the bitmap - cxCheck
       lpItem-&gt;itemWidth = bm.bmWidth - cxCheck;

       // Add one to the bitmap height for some spacing.
       lpItem-&gt;itemHeight = bm.bmHeight + 1;

       break;

   ...
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 softlib MENUBMP.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrMen<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
