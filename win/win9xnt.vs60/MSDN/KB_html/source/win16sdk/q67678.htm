

<HTML>
<HEAD>
<TITLE>List Box and Combo Box Capacity Limits </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q67678 ">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1990/12/08">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  In the Microsoft Windows graphical environment, the storage capacity of a list box or combo box is limited by the total amount of text. Each item is stored in memory as a NULL-terminated string.  The maximum amount of memory that a list box or comb...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QDL9,QBWO,QBWN,QATX,QAMB,QABN,QBQU,QBV3,QBWQ,QANX,QAHP,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>List Box and Combo Box Capacity Limits</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q67678 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.00 3.10
WINDOWS
kbprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.0 and 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In the Microsoft Windows graphical environment, the storage capacity of a
list box or combo box is limited by the total amount of text. Each item is
stored in memory as a NULL-terminated string.
<P>
The maximum amount of memory that a list box or combo box can use to store
text depends on the version of Windows in use. In Windows versions 2.x, the
amount of free memory in the user module's data segment limits available
storage.
<P>
Beginning with Windows 3.0, each list box or combo box has its own data
segment, which allows it to store 64K of text. If a list box or combo box
in an application must store more text, the application can store up to
8160 items in an owner-draw list box or combo box that does not have the
LBS_HASSTRINGS list box or CBS_HASSTRINGS combo box style. In this case,
the application stores and manages the item text separately.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An owner-draw list box or owner-draw combo box is limited to 64K of data
storage, as are regular (nonowner draw) list boxes and combo boxes. Because
the application manages the text when the list box or combo box do not have
the LBS_HASSTRINGS or CBS_HASSTRINGS styles, each item in an owner-draw
list box or owner-draw combo box require 8 bytes, 4 of which store the
application-supplied 32-bit item-identifier value.
<P>
The list box (or combo box) uses 256 bytes of the 64K segment for internal
storage, and uses the rest for items. This yields room for 8160 items, as
follows:
<P>
<PRE>   (64K segment - 256 bytes) / (8 bytes per item)

</PRE>NOTE: In a list box with the LBS_HASSTRINGS style or combo box with the
CBS_HASSTRINGS style, the text pointed to by the pointer passed in the
lParam of LB_ADDSTRING or CB_ADDSTRING (or LB_INSERTSTRING or
CB_INSERTSTRING) is stored in the list box's or combo box's storage area.
An additional 32-bit storage value can be associated with each item with
the LB_SETITEMDATA or CB_SETITEMDATA styles.
<P>
When the LBS_HASSTRINGS or CBS_HASSTRINGS styles are not present, Windows
no longer stores text for the list box or combo box. Instead of storing the
text pointed to by the lParam of LB_ADDSTRING or CB_ADDSTRING (or
LB_INSERTSTRING or CB_INSERTSTRING), only the 32-bit value itself is
stored, thus dramatically reducing the needed storage. When the owner-draw
list box or owner-draw combo box receive the WM_DRAWITEM message, it is up
to the drawing routine to interpret the 32-bit value.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 listbox combobox list-box combo-box<BR>
KBCategory: kbprg<BR>
KBSubcategory: UsrCtl<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
