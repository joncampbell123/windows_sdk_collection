

<HTML>
<HEAD>
<TITLE>SAMPLE: Code Sample Manages Printing Reports in Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q75110 ">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1991/08/12">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  REPMGR is a file in the Software Library that contains source code for a Windows module that manages the generating of reports from an application. The following seven services are provided:  1. Printing textual data in a fixed-pitch font  2. Numbe...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVV,QAH4,QAOX,QAI4,QA5V,QAPF,QAH6,QDL9,QBXT,QBWO,QBWN,QAIB,QACK,QA4Q,QAJX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Code Sample Manages Printing Reports in Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q75110 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
REPMGR is a file in the Software Library that contains source code
for a Windows module that manages the generating of reports from an
application. The following seven services are provided:

<OL><P><LI>Printing textual data in a fixed-pitch font

<P><LI>Numbering each page of the report

<P><LI>Printing headers and footers and the date on each page

<P><LI>Activating the appropriate printer-setup dialog box

<P><LI>Activating a printer selection dialog box

<P><LI>Printing some very simple graphics

<P><LI>Providing a basic Print Preview operation
<P>
</OL>The following is a list of three enhancements that one might add to
provide additional functionality:

<OL><P><LI>Provide support for proportional fonts with tabs

<P><LI>Print bitmap graphics

<P><LI>Format the text
<P>
</OL>This article discusses the services that this module provides and
contains a code fragment that demonstrates using some of the services
to print a simple report.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The interface to the report generator is as follows:
<P>
<PRE>   BOOL PrinterControl(int iCommand, int iParam, LPSTR szParam);

</PRE></OL>Functions:
<P>
<PRE>   iCommand         iParam                 szParam
   --------         ------                 -------

   PC_SETCOLS       # of columns           Not used
   PC_SETROWS       # of rows              Not used
   PC_PRINT         Not used               Not used
   PC_CLEARALL      Not used               Not used
   PC_ADDLINE       -1 for next line,
                    (n) for line # to add  LPSTR to line
   PC_ADDBAR        -1 for width of page,  LPSTR to character
                    (n) for bar width      (NULL = '-')
   PC_SETPAGENUM    Page number            Not used
   PC_SETHEADERn    Not used               LPSTR to header, NULL = clear
   PC_ADDHEADERn    Not used               Not used
   PC_SETFOOTER1    Not used               LPSTR to header, NULL = clear
   PC_ADDFOOTER1    Not used               Not used
   PC_STARTJOB      Not used               Not used
   PC_ENDJOB        TRUE = OK,
                    FALSE = Abort          Not used
   PC_SETTITLE      Not used               LPSTR to title
   PC_SETPRINTMODE  PC_CODE_PRINT or
                    PC_CODE_PREVIEW        Not used
   PC_GRAPHICS      Not used               LPGRAPHPARAMBLOCK


</PRE>The following code prints a sample report:
<P>
<PRE>void DoSampleReport (int iMode)
</PRE>{
<PRE>    int  i;
    char szText[80];

    PrinterControl(PC_SETPRINTMODE, iMode, 0L);
    PrinterControl(PC_SETCOLS, 80, 0L);
    PrinterControl(PC_SETROWS, 55, 0L);

    PrinterControl(PC_SETHEADER1, 0, "Header #1");
    PrinterControl(PC_SETHEADER2, 0, "Header #2");
    PrinterControl(PC_SETHEADER3, 0, "Header #3");

    PrinterControl(PC_SETTITLE, 0, "Sample Report");
    PrinterControl(PC_STARTJOB, 0, 0L);
    PrinterControl(PC_CLEARALL, 0, 0L);

    PrinterControl(PC_ADDBAR, -1, "=");
    PrinterControl(PC_ADDLINE, -1, "Added line");

    for (i = 0; i &lt; 100; i++)
      {
      wsprintf(szText, "Loop Added Line #%d", i + 1);
      PrinterControl(PC_ADDLINE, -1, szText);
      }

    PrinterControl(PC_ADDBAR, -1, "=");
    PrinterControl(PC_PRINT, CUR_PRINT_MODE, NULL);

    PrinterControl(PC_ENDJOB, HARDCOPYONLY, NULL);
</PRE>}
<P>
The following functions are provided to set up and select the printer:
<P>
<PRE>   PrinterSetupDialog();
   PrinterSelectDialog();

</PRE>Download REPMGR.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/repmgr.exe">REPMGR.EXE</A> <I>(size: 27591 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/repmgr.exe">REPMGR.EXE</A> <I>(size: 27591 bytes)</I> 
<P></BLOCKQUOTE>
</UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 softlib REPMGR.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: GdiPrn<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
