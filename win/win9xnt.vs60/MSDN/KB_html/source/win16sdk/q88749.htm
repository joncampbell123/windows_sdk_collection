

<HTML>
<HEAD>
<TITLE>Details of Setup Toolkit Function GetCopyListCost() </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88749 ">
<META NAME="KBModify" CONTENT="1997/07/23">
<META NAME="KBCreate" CONTENT="1992/08/30">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  The Microsoft Setup Toolkit for Windows GetCopyListCost() function can be used to compute the cost needed to install the files in the copy list to the target. The syntax for GetCopyListCost() is:     Long*=GetCopyListCost(szExtras$,szCosts$,szNeede...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEN,QDMP,QA9N,QASB,QAHD,QAPN,QAHT,QAE1,QAA1,QDL9,QBWO,QBWN,QAK6,QAE5,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Details of Setup Toolkit Function GetCopyListCost()</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88749 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10
WINDOWS
kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows version
   3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Setup Toolkit for Windows GetCopyListCost() function can
be used to compute the cost needed to install the files in the copy
list to the target. The syntax for GetCopyListCost() is:
<P>
<PRE>   Long&amp;=GetCopyListCost(szExtras$,szCosts$,szNeededs$)

</PRE>szExtras$ is an input parameter to GetCopyListCost(), and szCosts$ and
szNeededs$ are output parameters. All three parameters are symbols
whose values are lists of up to 26 integers. The nth integer in the
list will have the information about the nth alphabetic drive, where
the drives are A-Z.
<P>
If there will be extra costs beyond the cost of copying and
decompressing the files in the copy list, these costs should be
included in szExtras$. For example, to specify an extra cost of 5000
bytes on the Windows drive, the code might resemble the following:
<P>
<PRE>   WinDrive$ = MID$(GetWindowsDir, 1, 1)
   ndrive% = ASC (ucase$(WinDrive$)) - ASC ("A")
   for i% = 1 to ndrive% step 1
       AddListItem "ExtraCosts", "0"
   next i%
   AddListItem "ExtraCosts", "5000"

   need&amp; = GetCopyListCost ("ExtraCosts", "costs", "needs")

</PRE>If there are no extra costs, "" can be passed for szExtras$.
<P>
On return, the value of szCosts$ will be a list of 26 integers, which
are the total costs for drives A-Z of copying the files in the copy
list and of the costs in szExtras$. The value of szNeededs$ will be a
list of 26 integers, which are the total costs for each drive--the
amount of free space on the drive. For any drive that will not be
affected by the extra costs or by copying the copy list, szNeededs$
will report 0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In computing szCosts$ and szNeededs$, all files sizes, as well as the
costs in szExtras$, are rounded up to the nearest cluster. The
integers in the lists will always be some multiple of the cluster size
for the appropriate drive. The cluster sizes in bytes for various
disks are as follows:
<P>
<PRE>   Single-sided floppy disk    512
   Double-sided floppy disk   1024
   PC/AT fixed disk           2048
   PC/XT fixed disk           4096
   Other fixed disks          8192 &amp; 16384

</PRE>The cost of each file on the copy list is calculated as follows. The
properties mentioned are from the file's property list in the .INF
file:
<P>
if the file does not exist at the install target
<PRE>   if the source file has the REMOVE property
      file cost=0
   else
      file cost=size of source file
</PRE>else // the file does exist at the install target
{
<PRE>   if the source file has the REMOVE property
      file cost=-size of existing file at target
   else if the file has the NEVER overwrite property
      file cost=0
   else if the existing target file is read only and the source file
               has the UNPROTECTED overwrite property
      file cost=0
   else if the file has the OLDER overwrite property and
               the existing target file is newer
      file cost=0
   else if the file has the OLDER overwrite property and
           the existing target file is exactly the same (i.e. no copy)
      file cost=size of source file (for temporary copy used for
                                           language version check
   else // file will be copied
   {
      file cost=size of source file - size of existing target file
      if existing dest file is to be backed up (source file has
                 BACKUP property)
         file cost=file cost+size of existing target file
   }

}

</PRE>Note that GetCopyListCost() computes the copy cost incorrectly for split
files that already exist at the target. It erroneously reports that
most of the space used by the file will be freed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 MSSETUP tool kit<BR>
KBCategory: kbtool<BR>
KBSubcategory: TlsMss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
