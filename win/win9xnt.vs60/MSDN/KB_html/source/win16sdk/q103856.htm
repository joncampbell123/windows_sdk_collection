

<HTML>
<HEAD>
<TITLE>SAMPLE: Subclassing VBX Controls with MFC 2.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103856">
<META NAME="KBModify" CONTENT="1996/02/15">
<META NAME="KBCreate" CONTENT="1993/09/01">
<META NAME="Keywords" CONTENT="kbprg kbfile">
<META NAME="KBArea" CONTENT="Support; KB; win16sdk">
<META NAME="Description" CONTENT="  SUBVBX is a sample application that does Windows subclassing on a VBX control using the Microsoft Foundation Class (MFC) Libraries version 2.0. The sample subclasses the grid control, overrides the OnDlgCode() message handler, and returns the DLGS_...">
<META NAME="Product" CONTENT="Win16 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOE,QA7O,QAB5,QAMN,QDL9,QBWO,QBWN,QBWQ,QAY5,QAHV,QAPF,QAW6,QAPN,QAB9,QAH7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: Subclassing VBX Controls with MFC 2.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 15, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103856</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   version 3.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SUBVBX is a sample application that does Windows subclassing on a VBX
control using the Microsoft Foundation Class (MFC) Libraries version 2.0.
The sample subclasses the grid control, overrides the OnDlgCode() message
handler, and returns the DLGS_WANTARROWS code. Normally Windows uses the
arrow keys to move between controls in a dialog box, and does not pass the
arrow keys to the control. Subclassing the grid control and overriding the
OnDlgCode() message handler causes Windows to pass the arrow keys to the
grid control so that it can use the keys to move between cells in the
control.
<P>
Download SUBVBX.EXE, a self-extracting file, from the Microsoft Software
Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/subvbx.exe">SUBVBX.EXE</A> <I>(size: 90235 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the \SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/subvbx.exe">SUBVBX.EXE</A> <I>(size: 90235 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Windows controls, such as an edit control or a list box control, can be
subclassed in MFC using the CWnd::SubclassWindow() and
CWnd::SubclassDlgItem() functions. These functions do not work for VBX
controls. These functions rely on the fact that each window control has its
own Windows procedure. This way it is possible for an MFC object to chain
to the control's original Windows procedure. However, Visual Basic (VB)
controls under MFC 2.0 are managed by MFC objects, and therefore VB
controls use the same Windows procedure as all other MFC objects.
<P>
To subclass a VB control in MFC 2.0, it is necessary to copy the data from
the original control object into the object that you want to use to
subclass the original control. After the original object has been copied,
it can be detached and deleted, and the new control object can be attached.
<P>
This sample defines the CVBClone class that contains the function
SubclassVBControl(). This function does the copying, attaching, and
detaching that is described above. To use this class, derive a new class
from the CVBClone class and new message handling functions to the message
map. This class can then be used to subclass a VB control in a dialog box
by calling the SubclassVBControl() function in the OnInitDialog() or
OnInitialUpdate() function of the dialog box or form view that contains the
control.
<P>
This sample subclasses a grid control in a form view. The sample defines
the CMyGrid class from CVBControl, which it uses to subclass the control.
The sample also calls SubclassVBControl in the OnInitialUpdate() of the
form view to subclass the control in the form view.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 softlib SUBVBX.EXE<BR>
KBCategory: kbprg kbfile<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 15, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
