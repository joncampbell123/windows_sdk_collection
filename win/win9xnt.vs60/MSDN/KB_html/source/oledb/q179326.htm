

<HTML>
<HEAD>
<TITLE>FILE: Idxadovb.exe: Using Index Server OLE DB Provider and ADO i </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179326">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1998/01/14">
<META NAME="Keywords" CONTENT="oledbMisc">
<META NAME="KBArea" CONTENT="Support; KB; oledb">
<META NAME="Description" CONTENT="  The Idxadovb.exe sample demonstrates how to use an ActiveX Data Objects (ADO) recordset with the OLE DB Provider for Index Server (MSIDXS) in a Visual Basic application to query Index Server 2.0.  MORE INFORMATION  The following file is available f...">
<META NAME="Product" CONTENT="oledb">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QBS0,QBWB,QA9Q,QAPF,QAY2,QABM,QBT6,QBPM,QAJ4,QBWS,QBV4,QAB6,QBWP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Idxadovb.exe: Using Index Server OLE DB Provider and ADO i</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179326</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft OLE DB Provider for Index Server 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Idxadovb.exe sample demonstrates how to use an ActiveX Data Objects
(ADO) recordset with the OLE DB Provider for Index Server (MSIDXS) in a
Visual Basic application to query Index Server 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
~ Idxadovb.exe
<P>
For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>This sample lets a user specify a query string, scope, and sort order. The
sample shows the filename, path, size and last write-time for all documents
in the result set. Results can be sorted by rank (default), filename, path,
size or write-time based on the current selection in Sort dialog box.
<P>
The following code opens an ADO recordset and submits a query to the Index
Server using the OLE DB provider:
<P>
<PRE>   Dim RS As New ADODB.Recordset
   Const adOpenForwardOnly = 0
   Connect = "provider=msidxs"
   CommandText = "SELECT Filename, Path, Size, Write FROM Scope('" +
   Chr(34) + Scope.Text + Chr(34) + "') WHERE " + QueryText.Text + "
   ORDER BY " + Sort.Text

   ' Print SQL text in debug window.
   Debug.Print CommandText
   RS.Open CommandText, Connect, adOpenForwardOnly

</PRE>Run the sample and type the query in the Query text box. Select a scope
(the folder containing the documents to search) and click GO. Either the
search results will be displayed or the "No matches found..." message. The
sample also prints the current SQL statement sent by the application in the
debug (immediate) window in Visual Basic 5.0 IDE.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on Index Server, refer to Index Server documentation
in the Windows NT Option Pack documentation. The chapter "SQL Access to
Index Server Data" is the best reference for SQL query syntax for Index
Server.
<P>
 
<PRE>Keywords          : oledbMisc
Technology        : ole
Version           : WINDOWS:2.0
Platform          : WINDOWS
Issue type        : kbfile</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
