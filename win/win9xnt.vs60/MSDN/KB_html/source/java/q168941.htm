

<HTML>
<HEAD>
<TITLE>INFO: Frequently Asked Questions for CAB Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168941">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/05/22">
<META NAME="Keywords" CONTENT="kberrmsg CmdLnUtils UtilPkg VJMisc kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  This article covers some of the Frequently Asked Questions (FAQ) about CAB files. For other Java related FAQs search the Web at http://support.microsoft.com/support for  JAVA  and  FAQ.   MORE INFORMATION  Q. 1. Why do I receive the error Microsoft...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIY,QBXF,QBVV,QAK7,QAVX,QAVW,QAH4,QAY2,QDOP,QAVZ,QBXL,QA3N,QAYZ,QAKR,QAB5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Frequently Asked Questions for CAB Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168941</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Virtual Machine for Java
<LI>Microsoft Visual J++, versions 1.0, 1.1
<LI>SDK for Java, version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article covers some of the Frequently Asked Questions (FAQ) about CAB
files. For other Java related FAQs search the Web at
<B><A href="http://support.microsoft.com/support">http://support.microsoft.com/support</A></B> for "JAVA" and "FAQ."
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Q. 1. Why do I receive the error Microsoft JScript runtime error [Line: 15]
Object doesn't support this property or method when navigating to a page
that contains a CAB file with Internet Explorer 3.02?
<P>
A. The file Extrac32.exe is not part of the Internet Explorer 3.02
distribution. The new release of the Microsoft VM for Java, build 1518, now
includes the extrac32.exe utility. This file is required for proper CAB
operation in Internet Explorer. If you have previously installed a version
of IE 3.x earlier than 3.02 or have installed build 1518 of the Microsoft
VM for Java, by clicking the "Java VM update" link from
<B><A href="http://www.microsoft.com/java">http://www.microsoft.com/java,</A></B> Extrac32.exe will be on your system.
<P>
Q. 2. Where do I get the Code Sign Kit?
<P>
A. You can find the Code Sign Kit on the Visual J++ CD, the ActiveX SDK, or
the Java signing tools in the SDK for Java 2.0 Beta 2 or newer. The ActiveX
SDK is available at <B><A href="http://www.microsoft.com/intdev/sdk/">http://www.microsoft.com/INTDEV/sdk/.</A></B> The SDK for Java
2.0 Beta 2 is available at <B><A href="http://www.microsoft.com/java/">http://www.microsoft.com/java/.</A></B>
<P>
Q. 3. Where can I get the CAB Developers Kit or the CAB Resource Kit and
what are they used for?
<P>
A. The CABDEVKIT has been incorporated into the SDK for Java, which is
available at <B><A href="http://www.microsoft.com/java/sdk">http://www.microsoft.com/java/sdk,</A></B> and it's also available
standalone from <B><A href="http://www.microsoft.com/workshop/prog/cab/default.htm">http://www.microsoft.com/workshop/prog/cab/default.htm.</A></B>  It
will give you all of the tools you need to build cabinets. The latest
version includes cabarc.exe, a new tool that makes it easier to create
cabinets -directly from the command line.
<P>
The CAB Resource Kit will provide the information necessary to help the
tool development community understand and work with cabinets. It includes
the compression and decompression APIs, documentation on their interfaces,
and sample applications using these APIs. Soon, we will add more
information on the cabinet file format. The updates provided on January 13,
1997 featured multi-thread and multi-context support, and allow use in MFC-
based applications.
<P>
Q. 4. When programmatically creating a CAB file from a Java application,
can I reserve space in a CAB for signing?
<P>
A. The Java CAB API currently does not support the creation of reserved
areas. The command line tools, Cabarc.exe and Diamond.exe support this
functionality. The latest version of the Signcode.exe utility that is
available in the SDK for Java 2.0 Beta 2 and newer, does not require space
to be reserved in the CAB file for a digital signature. It will
automatically create space in the CAB when it is signed.
<P>
Q. 5. Can I sign a Java class file for use with Internet Explorer?
<P>
A. Although it is possible to digitally sign a Java class file and verify
the signature using the ChkTrust utility, Internet Explorer does not
recognize the class as signed and present a certificate to the user at
runtime, furthermore, the class is not considered trusted by the Microsoft
VM for Java. Presently, you need to place the classes within a CAB file,
which can then be signed.
<P>
Q. 6. Will the Microsoft Virtual Machine for Java support the JAR file
format?
<P>
A. JAR support is the same as ZIP. JAR = ZIP + manifest. So we will support
uncompressed and compressed JAR, but not signed JAR. If you need Java
security (beyond sandbox), on Internet Explorer 4.0 you need to use a
signed CAB file. This applies to all fine grained Java security (including
running in a sandbox on the local machine using the package manager).
<P>
Q. 7. Can my applet, which is inside a CAB file, use class files from
outside the CAB, which are not installed in the local machine's CLASSPATH?
<P>
A. Class files from a Web server cannot be used by classes in a CAB file
with the Microsoft VM for Java, build 1517 and earlier. With build 2057 of
the VM, from the SDK for Java 2.0 Preview, you can use classes from outside
of CAB file.
<P>
Q. 8. Why doesn't Internet Explorer display the test certificate from my
signed CAB file?
<P>
A. If you are using a test certificate to sign your cab file, you must
enable test certificates for the machine otherwise the signature is not
considered valid. You can do this by running Setreg.exe from the SDK for
Java 2.x (SDK\BIN\PACKSIGN) as follows:
<PRE>   setreg 1 true

</PRE>or the Wvtston.reg file included with the code signing kit.
<P>
Q. 9. When I run signcode.exe on my CAB file, I get the following error:
<P>
<PRE>   q1. Unable to sign the program &lt;cabfile&gt;. (80004005)

   a. You did not reserve space in your CAB file. Recreate the CAB file
      using the -s 6144 option to cabarc.exe. This space must be reserved
      in the CAB file to allow room for the digital signature.  Note, it is
      not necessary to use the -s switch with the signing tools included
      with the SDK for Java 2.0 Beta2 or newer.  The signcode.exe utility
      will now create the necessary space for the certificate at the time
      the CAB is signed.

   q2. Unable to sign the program &lt;cabfile&gt;. (80030070)

   a. You did not reserve enough space in your CAB file. Recreate the CAB
      file using the -s 6144 option to cabarc.exe. NOTE: It is not
      necessary to use the -s switch with the signing tools included with
      the SDK for Java 2.0 Beta2 or newer.  The signcode.exe utility will
      now create the necessary space for the certificate at the time the
      CAB is signed.

   q3. Unable to sign the program &lt;cabfile&gt;. (80070005)

   a. Your cabfile is marked read-only.

   q4. Unable to sign the program &lt;cabfile&gt;. (80070057)

   a. Your cabfile is corrupt.

</PRE>Q. 10. When do I use the -s option for cabarc.exe?
<P>
A. The -s 6144 option reserves unnecessary space in most situations. With
the 'test' certificate, you can typically get by with 1K of reserved space
in the cab. A good estimate of the space required is slightly larger than
the size of the .SPC file you are signing with. Also note, it is possible
that the certificate will require more than 6144 bytes.
<P>
NOTE: It is not necessary to use the -s switch with the signing tools
included with the SDK for Java 2.0 Beta2 or newer.  The signcode.exe
utility will now create the necessary space for the certificate at the time
the CAB is signed.
<P>
Q. 11. When do I use the -i option for cabarc.exe?
<P>
A. The -i switch is used to insert a version number, SET ID, into a CAB
file. The version number will be displayed when viewing a cab file with the
following command line statement: cabarc L &lt;cabfile&gt;. Diamond.exe uses the
ID number when spanning multiple CAB files.
<P>
Q. 12. How do I install a Java package on the user's machine?
<P>
A. You can use a setup information (.INF) file in a CAB to install Java
libraries and packages on the local machine. The INF file defines which
files to extract from the CAB and where to place them on the user's system.
There is an example INF file called master.inf included in the SDK for
Java. Place all the Java libraries and packages in a CAB file. In a second
signed CAB file, place the unsigned CAB file and the .INF file. Reference
the signed CAB file with an &lt;OBJECT&gt; tag in your HTML page.
<P>
Q. 13. For distributing trusted applets on my Intranet, is there a more
elegant solution than using a test certificate?
<P>
A. Currently, the only solution is to relax the security in Internet
Explorer by placing the classes on the user's machine in the CLASSPATH or
distributing the files in a signed CAB file. You can obtain a certificate
for use within the company or use the test certificate and have the users
run the wvtston.reg file to enable test certificates on their machines.
<P>
Q. 14. Can I include GIF, JPG, or AU files used by my applet in a CAB file?
<P>
A. Yes, the CAB file serves as a single, compressed repository for all
.CLASS, audio and image files required by the applet. When creating the CAB
file, be sure to use the -r and -p options to cabarc.exe to recurse and
preserve directory structure if any of the files in the CAB are in
subdirectories. The cabarc.exe command L can be used to confirm the
directory structure was preserved.
<P>
Image and audio clips stored in the cab can be retrieved by the applet code
via the java.lang.Applet.getImage and java.lang.applet.getAudioClip
methods. Note that in order for Internet Explorer to find an image file or
audio clip from within the cab file, the URLs passed to these methods must
be based upon the applet's codebase. For example, if the following code is
found within an applet loaded from a cab file, the image file picture1.gif,
and the audio clip sound1.au will be loaded from the cab file (assuming
that they are in the cab).
<P>
<PRE>   .
   .
   .

   Image img = getImage(getCodeBase(),"picture1.gif");
   AudioClip clip = getAudioClip(getCodeBase(),"sound1.au");
   .
   .
   .

</PRE>NOTE:  If an image or audio clip file is not within the cab, then Internet
Explorer will look for them on the server.
<P>
Q. 15. Why doesn't Internet Explorer display the certificate from a signed
CAB on some machines?
<P>
A. The three most common reasons for this behavior are the following:
<PRE>   1. If the cab file was signed using a test certificate, you must enable
      test certificates for the local machine otherwise the signature is
      not considered valid. You can do this by running the wvtston.reg
      file included with the code signing kit.

   2. You have accepted a software publisher as 'always trusted'. To
      verify this, in Internet Explorer, go to
      view.Options.Security.Publishers to ensure the publisher does not
      appear in the listbox. If so, you can use this dialog to remove it.

   3. If the client machine is running Microsoft Windows NT, the current
      user must have administrator privileges or have 'Full Control'
      access to the following registry keys: (and existing subkeys)

   -HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography
   -HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates
   -HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\SharedDlls
   -HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WinTrust

      These privileges can be granted by a user on the machine who has
      administrator privileges  using regedt32.exe. This requirement will
      be addressed in future versions of Internet Explorer.

      Note: If the certificate does not appear or you answer 'no' to the
      certificate, the applet will still load but will not be trusted.

</PRE><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A href="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Rafael M. Munoz, Microsoft Corporation
 
<PRE>Keywords          : kberrmsg CmdLnUtils UtilPkg VJMisc kbfaq
Technology        : kbInetDev
Version           : 1.0 1.1
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
