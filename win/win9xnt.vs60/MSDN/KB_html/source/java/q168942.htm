

<HTML>
<HEAD>
<TITLE>INFO: Frequently Ask Questions About the SDK for Java </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168942">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/05/22">
<META NAME="Keywords" CONTENT="kbcode kberrmsg CmdLnUtils JCOM JDB JVM UtilPkg VMJIT kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  This article covers some of the Frequently Asked Questions (FAQ) about the SDK for Java. For other Java related FAQs search the Web at http://support.microsoft.com/support for 'JAVA' and 'FAQ'.  MORE INFORMATION  Q. 1. When running the JDBC sample ...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXF,QAT7,QAPN,QABO,QAGI,QAUD,QABH,QAVZ,QAY2,QAPF,QDNQ,QDOP,QAW6,QAMB,QBWA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Frequently Ask Questions About the SDK for Java</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168942</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Virtual Machine for Java
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article covers some of the Frequently Asked Questions (FAQ) about
the SDK for Java. For other Java related FAQs search the Web at
<B><A href="http://support.microsoft.com/support">http://support.microsoft.com/support</A></B> for 'JAVA' and 'FAQ'.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Q. 1. When running the JDBC sample I get java.sql.SQLException: -7ffbfeee
(80040112h).
<P>
A. Download the two files located under the "ActiveX Data Objects (ADO)
version 1.0" section of
<B><A href="http://www.microsoft.com/oledb/download/download.htm">http://www.microsoft.com/oledb/download/download.htm.</A></B>

<UL><LI>Microsoft ActiveX Data Objects 1.0 DLL (221k)
<LI>Microsoft ActiveX Data Objects 1.0 Supporting Error DLL (16k)
<P>
</UL>Q. 2. How does the Msdev.exe, in Visual J++, relax the security in Internet
Explorer so that my applet can run outside the Java sandbox, despite the
fact that it is not in a signed .cab file?
<P>
A. In the Microsoft VM for Java, that is included with Internet Explorer
3.x, only trusted class files can access resources outside the Java
sandbox.  Class files from digitally signed .cab files are trusted.  If the
HTML file is run from Microsoft Developer Studio (MSDEV), the class files
are also trusted. This can be very helpful during applet development.
However, to deliver your applet to other users, you must place them in a
signed CAB file.
<P>
When executing or debugging a Java Applet from MSDEV, the security
restrictions in Internet Explorer are relaxed for quick and easy testing.
MSDEV prepends the project path to the CLASSPATH environment variable that
is used by Internet Explorer. This gives the classes trusted status.
<P>
Q. 3. Why does InetAddress.getLocalHost() return localhost/127.0.0.1 in my
Applet?
<P>
A. An untrusted applet isn't allowed to get the real localhost IP address
because it opens various types of network attacks.  If the Java libs detect
an untrusted applet, then it will return the loopback address (127.0.0.1).
<P>
JDK 1.02's/1.1's appletviewer will do the same thing unless you've changed
the "network access" property in the appletviewer to "unrestricted".
<P>
Q. 4. Is it possible for an applet to read a file from my Web server? If
so, how?
<P>
A. The class below shows how to read a text file named poem.txt from the
server. Note: place the .htm and .class files in the same directory on the
Web server along with a text file named poem.txt with at least one line of
text.
<P>
<PRE>   import java.io.*;
   import java.net.*;
   import java.applet.*;
   import java.awt.*;

   class ReadFile extends Applet {
      public void start () {
         try {
            URL u2 = new URL(getCodeBase(),"poem.txt");
            DataInputStream d = new DataInputStream(u2.openStream());
            String s5 = d.readLine();
            add(new Label(s5));
         }
         catch (Exception e) {
            System.out.println("Error: " + e.toString());
         }
      }
   }

</PRE>Q. 5. What are common causes of the "Failed to create object" message when
trying to instantiate a COM object written in Java?
<P>
A. Here are some common causes:
<P>
<PRE>    - Failing to have the Java class in the CLASSPATH.
    - Failing to declare your Java method as 'public'.
    - Failing to register the class file (using javareg.exe)
    - Using an old version of the Microsoft VM for Java in some cases
      (for example, if you are attempting to use CreateObject). Install
      the latest Microsoft VM for Java from <B><A href="http://www.microsoft.com/java">http://www.microsoft.com/java.</A></B>
    - Missing required steps in the process. Follow the steps in the
      Visual J++ sample named COMCALLINGJAVA.

</PRE>Q. 6. When I have an applet in a &lt;FORM&gt; it doesn't submit any information
to the server. How can I get the applet to submit its information?
<P>
A. The applet doesn't submit any information because the information a user
would want to submit is specific to the applet. For example, an applet that
shows images may want to submit the currently displayed image number, while
an applet that displays a clock may want to submit the GMT time. It is up
to the programmer to write the methods to submit the applet. The five steps
below show one way you might implement submitting an applet.
<P>
<PRE>   1. Create an applet with a public function that returns the
      information you want to submit. (For the first example above, you
      would return the image number.)

         public int getCurrentImage() {
            return m_nCurrImage;
         }

   2. Create a Web page with an applet inside your form.

   3. Create a hidden field in the &lt;FORM&gt;, where your applet will
      submit its data.

   4. Write a script function, like processApplet() in the example
      below, to populate the hidden field by calling public functions of
      your applet.

   5. Set your submit button's onClick function to call the script
      function you wrote in step 4.

      Here is the finished product:

      &lt;form action="/scripts/info.dll" method=GET name="myForm" &gt;
      &lt;applet code=AppletInForm.class id=myapplet
       width=320 height=240 &gt;
      &lt;/applet&gt;
      &lt;input type=hidden name="appletImage"&gt;
      &lt;script language=JScript&gt;
        function processApplet() {
</PRE>parent.myForm.appletImage.value=document.myForm.myapplet.getCurrentImage();
<PRE>        alert("Sending form: image="+parent.myForm.appletImage.value+"
</PRE>user="+parent.myForm.Username.value);
<PRE>        }
      &lt;/script&gt;
      &lt;br&gt;
      Username:&lt;input type=text name="Username"&gt;&lt;br&gt;
      &lt;input type=submit value="Please send me the above picture."
       language="JScript" onClick="processApplet();"&gt;
      &lt;/form&gt;

</PRE>Q. 7. How can I get showDocument() to display a URL, when the URL protocol
isn't supported by Java (for example FTP)?
<P>
A. The URL class verifies Java protocol support by calling the protocol's
Handler class. The four steps below show how to add a protocol and
demonstrates how to make the call to showDocument.
<P>
<PRE>   1. Create a package to implement the protocol, for example:

        .\sun\net\www\protocol\ftp

   2. Implement the Handler class in the
      sun.net.www.protocol.{protocol-name} package. For example:

      .\sun\net\www\protocol\ftp\Handler.java.

      package sun.net.www.protocol.FTP;
      import java.net.URL;
      import java.net.URLConnection;
      import java.net.URLStreamHandler;
      public class Handler extends URLStreamHandler {
         public synchronized URLConnection openConnection(URL u) {
       return new FTPURLConnection(u);
         }
      }

   3. Implement any functions your Handler class uses.

      package sun.net.www.protocol.FTP;
      import java.io.IOException;
      public class FTPURLConnection extends sun.net.www.URLConnection {
         FTPURLConnection(java.net.URL u) {
            super(u);
         }
         public void connect() throws IOException {
            throw new IOException("FTP doesn't support connect().");
         }
      }

   4. Create the URL and call the showDocument function.

      import java.net.*;
      public class FTPTest extends java.applet.Applet {
         public void init() {
            add(new java.awt.Button("Click to open FTP session."));
         }
         public boolean action(java.awt.Event  evt, Object  what) {
            try {
               URL u=new URL("<B><A href="ftp://ftp.microsoft.com">ftp://ftp.microsoft.com</A></B>");
               getAppletContext().showDocument(u,"FTPFrame");
            } catch (Exception e) {
               showStatus(e.toString());
               e.printStackTrace();
            }
       return true;
         }
      }

</PRE>Q. 8. What steps must be followed to use a Java class from an Active Server
Page?
<P>
A. First, you must install build 1257 or later of the Microsoft VM for Java
or else install the SDK for Java 1.5. Then follow these steps:
<P>
<PRE>   1. Create your Java class. For example, here is a class in a file
      called simple.java:

      class Simple
      {
         int SimpleFn ( int x )
         {
            return x * 2;
         }
      }

   2. From the command line or from MSDEV, compile the .JAVA file into
      a .CLASS file such as:

      jvc simple.java

   3. Copy the resulting .CLASS file into your java\trustlib directory,
      such as:

      copy simple.class \winnt\java\trustlib

   4. Register your Java class as a COM object using JavaReg, such as:

      javareg /register /class:simple /progid:Simple

      /class: argument is the name of the .class file in your trustlib
       directory.
      /progid: is the name that you will use to create your COM object.

      Now your Java class is registered as a COM object and ready to use
      from ASP.

   5. Create a .ASP file in a HTTP shared directory on your machine.
      Be sure that the directory the file is in has EXECUTE access. You
      can check this in the "Microsoft Internet Service Manager." A simple
      ASP file would look like:

      &lt;html&gt;
      &lt;body&gt;
      &lt;h1&gt;Simple Test&lt;/h1&gt;
      The result from SIMPLE is:
      &lt;% Set SimpleObj = Server.CreateObject("Simple") %&gt;
      &lt;% = SimpleObj.SimpleFn(5) %&gt;
      &lt;hr&gt;
      &lt;/body&gt;
      &lt;/html&gt;

      That's it! Open your Web browser and point it at
      YOUR_MACHINE/simple.asp.

</PRE>Q. 9. How do I redirect output from jview or wjview?
<P>
A. Unfortunately, there is not an option or registry setting for jview or
wjview that enables Java logging. However, you can redirect the output when
invoking an application like the following example:
<P>
<PRE>   jview main &gt; javalog.txt

</PRE>This works for both jview and wjview. Or, you could programmatically direct
the output to a file or pipe by reassigning System.out. The following code,
which works for jview/wjview and Internet Explorer, shows how this can be
done:
<P>
<PRE>   if
</PRE>("true".equalsIgnoreCase(System.getProperty("com.ms.applet.enable.logging")
)) {
<PRE>   try {
      String logdir = System.getProperty("java.home");
      PrintStream ps = new PrintStream(new BufferedOutputStream(new
                           FileOutputStream(new File(logdir,
                                            "javalog.txt"))), true);
      System.out = ps;           // comment line if using SDK 2.0 Preview
//    System.setOut(ps);         // uncomment line if using SDK 2.0 Preview
      System.err = ps;           // comment line if using SDK 2.0 Preview
//    System.setErr(ps);         // uncomment line if using SDK 2.0 Preview
   } catch (Exception e) {
      }
   }

</PRE>The ability to alter the value of System.out and other system streams may
be removed or changed in the future.
<P>
Q. 10. When I create an ActiveX control in Java and then call its methods I
get a java.lang.UnsatisfiedLinkError exception. Why can't I call the
methods?
<P>
A. For the Microsoft VM for Java build 1518:
<P>
<PRE>     The problem is that Applets aren't ActiveX containers and therefore
     cannot host ActiveX controls. The call to "new myActiveXControl();"
     doesn't make sense because there is no container to host the control.
     You should use an &lt;OBJECT&gt; tag in your HTML file, and then pass this
     object reference to your Applet. For an example of how this is done,
     see the "OLEControls" sample in the Microsoft Visual J++ samples
     documentation.

   For the Microsoft VM for Java build 2057: (SDK2.0 Preview)

     You need to use the AXComponent class, located in the com.ms.activeX
     package, to host your ActiveX control.


</PRE>Q. 11. How do I get the SampleSelect JDBC-ODBC sample to work with the
Northwind database that comes with Access?
<P>
A. An updated jdbcrel.htm has been placed in the sample pack that details
the steps necessary to connect to the Northwind database. The sample pack
can be obtained at <B><A href="http://www.microsoft.com/java">http://www.microsoft.com/java</A></B>
<P>
Q. 12. When I call show() on a modal dialog, the Microsoft VM for Java
continues executing the code after the show() call even though I haven't
dismissed the dialog yet. Is this a known bug?
<P>
A. This is a bug and has been fixed in the Microsoft VM for Java that is
provided in the SDK2.0 Preview (build 2057 of the Microsoft VM for Java)
<P>
Q. 13. Why does System.getProperty("user.name") return null?
<P>
A. This is a bug and has been fixed in the Microsoft VM for Java that is
provided in the SDK2.0 Preview (build 2057 of the Microsoft VM for Java)
<P>
Q. 14. How do I tell from my Java applet or application what version of the
Microsoft VM for Java is installed on the system?
<P>
A. Use the SystemVersionManager.getVMVersion() static method in com.ms.util
package to find the version number of the installed Microsoft VM for Java.
The BuildIncrement property will indicate the version the Microsoft VM for
Java.
<P>
<PRE>   String build;
   build=SystemVersionManager.getVMVersion().getProperty("BuildIncrement");
   System.out.println("Using build "+build);

</PRE>Q. 15. I am getting the error message "Security Exception: Couldn't connect
to with origin from file ***" in my javalog.txt file.
<P>
A. This could be caused by changes to the AppletSecurity class, some of
these restrictions have been loosened in build 1517 of the VM. You can
obtain build 1517 of the VM by navigating to <B><A href="http://www.microsoft.com/java">http://www.microsoft.com/java</A></B>
and click Downloads.
<P>
Q. 16. How can I execute JVIEW.EXE without displaying a DOS BOX?
<P>
A. Use WJVIEW.EXE instead of JVIEW.EXE. WJVIEW can be found in the SDK for
Java.
<P>
Q. 17. How can I combine all of my Java application's classes into one
executable file?
<P>
A. Use JEXEGEN.EXE to convert your Java classes into a Win32 application.
The Win32 application will still require the Microsoft Win32 Virtual
Machine for Java to be installed on the local machine.
<P>
Q. 18. Has the support for SafeArray been updated in the VM?
<P>
A. Yes, see the documentation for the SDK for Java 2.0 at
<B><A href="http://www.microsoft.com/java/pre-sdk">http://www.microsoft.com/java/pre-sdk</A></B> and follow the link from Packages and
Classes to the com.ms.com package then to Class Variant or Class SafeArray.
<P>
Q. 19. How do I install the developer version of classes.zip for the
SDK2.0?
<P>
A. Run the ClassD.exe from the bin directory of the SDK 2.0 Preview, then
run javasrc.exe (installed by Visual J++ in the %windir%\java\classes
directory) to extract the Java files. If you do not have Visual J++, use a
program that can unzip the *.JAVA files from the classes.zip file. Note:
You may have to delete your old classes.zip first.
<P>
Q. 20. How can I see messages that are printed using System.out.println. In
Netscape Navigator I can see these in the Java Console?
<P>
<P>
A. For the answer to this question, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../java/q177177.htm">Q177177</A></B>
   TITLE     : HOWTO: Enabling Messages Printed Using System.out.printIn

</PRE>Q. 21. How can I enable the Java JIT compiler for my application?
<P>
A. If you have enabled JIT in Internet Explorer, your applications will
also run in JIT compiler mode. To enable JIT in Internet Explorer choose
View, Options, Advanced, Enable Java JIT compiler.
<P>
In the registry JIT can be enabled by setting the following to 0x00000001:
<P>
<PRE>   HKEY_Current_User\Software\Microsoft\Java VM\EnableJIT

</PRE><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A href="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>

</PRE>(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by
Rafael M. Munoz, Microsoft Corporation
 
<PRE>Keywords          : kbcode kberrmsg CmdLnUtils JCOM JDB JVM UtilPkg VMJIT kbfaq
Technology        : kbInetDev kbole
Platform          : WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
