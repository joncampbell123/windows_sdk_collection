

<HTML>
<HEAD>
<TITLE>PRB: NoClassDefFoundError Accessing a COM Object Through Java </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178560">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/12/29">
<META NAME="Keywords" CONTENT="JCOM">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  When executing a Java Application that calls a COM object like an ATL Server, you may sometimes get the following error message on the COM object:     error: java.lang.NoClassDefFoundError:  The error occurs on the line where you create a new COM o...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QAVX,QAVW,QBXF,QAYZ,QAB4,QBWS,QAAP,QA56,QA55,QA2Q,QAXC,QAUJ,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: NoClassDefFoundError Accessing a COM Object Through Java</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178560</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual J++, versions 1.0, 1.1
<LI>Microsoft Win32 Virtual Machine for Java
<LI>SDK for Java, versions 2.0, 2.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When executing a Java Application that calls a COM object like an ATL
Server, you may sometimes get the following error message on the COM
object:
<P>
<PRE>   error: java.lang.NoClassDefFoundError:

</PRE>The error occurs on the line where you create a new COM object in the Java
Class.
<P>
<P><h2>CAUSE</h2>
 
<P>
One reason why you may get this error could be related to missing parameter
attributes for the methods in the COM object's IDL file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Check your methods in the IDL file so that they have the right attributes
like [in],[out],[retval] and so on. Once modifying the IDL file, rebuild
your COM Server, and rerun JavaTLB or JACTIVEX on the COM Object's Type
Library so that the changes gets reflected.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a default ATL COM object using VC5.0. Name it AtlServ.

<P><LI>Add a new ATL COM object to the above project. This can be done by
   right-clicking in Class View and selecting New ATL Object. This will
   bring up the ATL Object Wizard. Select Simple Object in it and click
   Next. Now select the Names Tab and name the object as Test.

<P><LI>Add a method to the IDL file as follows:
<P>
<P><PRE>      ........
      interface ITest : IDispatch
      {
<PRE></PRE>         [id(1), helpstring("Hello")] HRESULT TestMethod(BSTR* strGUID);
      };
      ..........

</PRE><P><LI> Add declaration/implementation to this method in the .cpp and .h
<P><PRE>    files of your Test ATL COM Object as follows. Declare this method in
    the Test.h file as follows:
</PRE><P>
<P><PRE>      .............
      public:
      STDMETHOD(TestMethod)(BSTR* a);
</PRE><P>
   Following is its implementation:
<P>
<P><PRE>      // Test.cpp : Implementation of CTes
      ..................
      STDMETHODIMP CTest::TestMethod(BSTR* a)
      {
<PRE></PRE>         USES_CONVERSION;
         *a = SysAllocString(T2OLE("This is a test!"));
         return S_OK;
      }

</PRE><P><LI>Now build the ATL Server object, which should also register it.

<P><LI>Run JAVATLB or JACTIVEX on the server you created in Step 1. If you are
   using JACTIVEX, then you will have to use JVC version 4337 or
   greater that ships with the SDK2.0 and 2.01 for Java in order to build
   your Java applet.

<P><LI>Create a new Java project using Visual J++ 1.1 and create a new class as
   follows:
<P>
<PRE>      import atlserv.*;      //This is your ATl Server Object created in
                             //Step 1.

      public class Main
      {
         public static void main(String args[])
        {
            ITest a = (ITest) new Test();
        }
     }

</PRE><P><LI>Build the class and copy it to &lt;windir&gt;/java/lib.
   where &lt;windir = WINNT or WIN95&gt;.

<P><LI>When running this application using JVIEW you will get the
   NoClassDefFoundError in the Command-Prompt window.

<P><LI>To fix this problem, specify the [out] attribute to the method in the
   IDL file as follows:
<P>
<P><PRE>      interface ITest : IDispatch
      {
<PRE></PRE>         [id(1), helpstring("Hello")] HRESULT TestMethod([out]BSTR*
          strGUID);
      };

</PRE><P><LI>Now rebuild your ATL server, and rerun JAVATLB or JACTIVEX on the ATL
   Server's Type Library so that the changes gets reflected.

<P><LI>You should now be able to run your Java application without any
   problems.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A href="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: NoClassDefFoundError atl server com
<P>

Keywords          : JCOM<BR>
Technology        : kbInetDev internet<BR>
Version           : WINDOWS:1.0,1.1,2.0,2.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
