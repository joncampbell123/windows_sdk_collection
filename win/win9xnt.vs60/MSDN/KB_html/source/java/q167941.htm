

<HTML>
<HEAD>
<TITLE>HOWTO: Using a Java Class with Active Server Pages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167941">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/05/02">
<META NAME="Keywords" CONTENT="JCOM">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  This article demonstrates how one can use a Java class as an ActiveX server side object with Microsoft Active Server Pages (ASP).  MORE INFORMATION  The following steps show how to use a Java Server Object with ASP:  1. Install the Microsoft VM for...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXF,QAX3,QAPN,QDNQ,QAW6,QAVZ,QABO,QBWA,QBXB,QA3N,QATJ,QABI,QDH9,QAFI,QABH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Using a Java Class with Active Server Pages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167941</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Virtual Machine for Java, version 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how one can use a Java class as an ActiveX server
side object with Microsoft Active Server Pages (ASP).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps show how to use a Java Server Object with ASP:

<OL><P><LI>Install the Microsoft VM for Java build 1518 or newer (Visual J++ 1.1
   comes with a build 1513). You can check the version of the Msjava.dll in
   your windows/system or winnt/system32 directory to verify what build of
   the Microsoft Virtual Machine you have in your system. You can download
   the latest Virtual Machine from <B><A href="http://www.microsoft.com/java">http://www.microsoft.com/java.</A></B>

<P><LI>Create your Java class, which will be created as a COM object.
   For example:
<P>
<P><PRE>      // SIMPLE.JAVA-------------
      public class Simple
      {
<PRE></PRE>         public int SimpleFn ( int x )
         {
            return x * 2;
         }
      }

</PRE><P><LI>Compile the .java file into a .class file, that is:
<P>
<P><PRE>     jvc simple.java
</PRE><P>
 NOTE: This does not require that you use the Microsoft compiler for Java,
<P><PRE>       JAVAC works just fine.
</PRE>
<P><LI>Copy the resulting .class file into the %windir%\java\trustlib or
   %windir%\java\lib directory of the server machine. Note that you may
   have to restart the Virtual Machine if you copy over a preexisting class
   file. To restart the Virtual Machine on the server side; go to Microsoft
   Internet Service Manager and stop and then restart all three IIS
   services (that is, www, gopher, ftp).
<P>
<P><PRE>      copy simple.class \winnt\java\trustlib
</PRE>
<P><LI>Register your Java class as a COM object on the server machine using the
   JavaReg utility (available with VJ++ or the Microsoft SDK for Java).
   This can also be done manually or by a setup program, "javareg
   /register" is only creating registry entries:
<P>
<P><PRE>      javareg /register /class:Simple /progid:Simple
</PRE><P>
   The /class: argument is the name of the .class file in your trustlib or
   lib directory. The /progid: is the name that you will use in
   CreateObject() to create your COM object.
<P>
   Now your Java class is registered as a COM object and ready to use from
   Active Server Pages.

<P><LI>Create an .asp file in an HTTP shared directory on your computer. Be
   sure that the directory the file is in has EXECUTE access. You can check
   this in the "Microsoft Internet Service Manager." A simple ASP file
   would look like:
<P>
<P><PRE>      SIMPLE.ASP-------------
      &lt;html&gt;&lt;body&gt;
      &lt;h1&gt;Simple Test&lt;/h1&gt;
</PRE><P>
   The result from SIMPLE is:
<P>
<P><PRE>      &lt;% Set SimpleObj = Server.CreateObject("Simple") %&gt;
      &lt;% = SimpleObj.SimpleFn(5) %&gt;
      &lt;hr&gt;
      &lt;/body&gt;&lt;/html&gt;
      ------------------------
</PRE>
<P><LI>Open your web browser and point to YOUR_MACHINE/simple.asp.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For additional information on how to find the latest Microsoft Virtual
Machine, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../java/q163637.htm">Q163637</A></B>
   TITLE     : Availability of Current Build of Microsoft VM for Java

</PRE></OL>Additional information and Active Server Pages samples can be found at
<B><A href="http://www.microsoft.com/iis/usingiis/developing/samples/">http://www.microsoft.com/IIS/UsingIIS/Developing/Samples/</A></B>
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A href="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ASP java server com CreateObject
<P>

Keywords          : JCOM<BR>
Technology        : kbInetDev kbole<BR>
Version           : 1.0 1.1<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
