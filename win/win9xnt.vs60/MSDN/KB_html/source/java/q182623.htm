

<HTML>
<HEAD>
<TITLE>BUG: PrintJob Output is Incorrect After First Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182623">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1998/03/17">
<META NAME="Keywords" CONTENT="JVM">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  When printing text or graphics from Java using java.awt.PrintJob, the output has different font sizes, line thickness', and other Graphics attributes on different pages even when the same Graphic attributes and fonts are used on all pages.  Also, s...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QADF,QBWA,QBXF,QAIJ,QAG9,QAGI,QAOX,QAJQ,QBXS,QA5A,QATX,QALZ,QAKP,QDIX,QAI4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: PrintJob Output is Incorrect After First Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182623</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>SDK for Java, versions 2.0, 2.01
<LI>Microsoft Win32 Virtual Machine for Java
<LI>Microsoft Visual J++, version 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When printing text or graphics from Java using java.awt.PrintJob, the
output has different font sizes, line thickness', and other Graphics
attributes on different pages even when the same Graphic attributes and
fonts are used on all pages.
<P>
Also, subsequent pages do not reset the offset from a previous translate()
call. For example, if your paint() routine calls gr.translate(10,10), then
the first page printed starts at origin (10,10), the second page starts at
origin (20,20) and so on.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem happens with some printer drivers depending on whether the
driver resets state between pages.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce the Font and Graphic Attribute Issue</h3>
 
<P>
Create a Java Application and include the following class:
<P>
<PRE>   import java.awt.*;
   import com.ms.ui.*;

   public class PrintFont extends UIFrame
   {
      public PrintFont()
      {
         PrintJob pj = getToolkit().getPrintJob(null, "Printer", null);
         if (pj != null)
         {
            for (int i=1; i&lt;=3; i++)
            {
               Graphics pg = pj.getGraphics();
               if (pg != null)
               {
                  pg.setFont(new Font("TimesRoman", Font.PLAIN, 16));
                  pg.setColor(Color.black);
                  pg.drawRect(100, 100, 100, 100);
                  pg.drawString("Page " + i, 600, 900);
                  pg.drawString("TimesRoman", 500, 900);
               }
               System.out.println("Dispose");
               pg.dispose();
            }
            pj.end();
            System.out.println("End");
         }
       }
       public static void main(String args[])
      {
          UIFrame f = new PrintFont();
         System.exit(0);
      }
   }

</PRE>A workaround for this problem is to select a different attribute
(font/color) and do a drawString of an empty string, then select back in
the desired attribute.
<P>
A workaround for the translation accumulation issue is to get your current
translation and set the translation to the inverted values:
<P>
<PRE>   try {
      com.ms.awt.GraphicsX gx = (com.ms.awt.GraphicsX) printGraphics;
      Point pt = gx.getTranslation();
      gx.translate(-pt.x, -pt.y);
   } catch (Exception e) {
 }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: print font<BR>
Keywords          : JVM<BR>
Technology        : kbInetDev internet<BR>
Version           : WINDOWS:1.1,2.0,2.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
