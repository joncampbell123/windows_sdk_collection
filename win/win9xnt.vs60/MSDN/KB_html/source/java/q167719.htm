

<HTML>
<HEAD>
<TITLE>FIX: JavaTLB Gives an Internal Compiler Error with VBCCE Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167719">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1997/04/29">
<META NAME="Keywords" CONTENT="VS97FixlistSP2 VS97FixlistSP1 CmdLnUtils JCOM VS97FixlistSP3">
<META NAME="KBArea" CONTENT="Support; KB; java">
<META NAME="Description" CONTENT="  Running the Visual J++ Java Type Library Wizard, or the Javatlb.exe command line tool on a type library generates the following error:     fatal error J0001: Internal Compiler Error  CAUSE =====  This bug can be caused when JavaTLB encounters a met...">
<META NAME="Product" CONTENT="java">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDO3,QA55,QA56,QAAP,QAB4,QAUJ,QBHQ,QBS0,QAKP,QAR4,QAPN,QAP2,QAHE,QAHV,QA7Y V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: JavaTLB Gives an Internal Compiler Error with VBCCE Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167719</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual J++, versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Running the Visual J++ Java Type Library Wizard, or the Javatlb.exe command
line tool on a type library generates the following error:
<P>
<PRE>   fatal error J0001: Internal Compiler Error

</PRE><h2>CAUSE</h2>
 
<P>
This bug can be caused when JavaTLB encounters a method in the type library
with one or more unnamed parameters. One tool known to create unnamed
parameters in type libraries is Visual Basic 5.0. Creating an ActiveX DLL
in VB 5.0 may generate type libraries with unnamed parameters that cause
JavaTLB to fail with the J0001 error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This bug can be fixed by installing the Service Pack 1 of Visual Studio 97.
The Service Pack can be applied to both the Visual J++ 1.1 shipped with
Visual Studio 97 as well as the Visual J++ 1.1 that is sold as a standalone
product.
<P>
Note that installing the Service Pack 1 on the Visual J++ 1.1 free Trial
Edition is not a configuration that has been tested by Microsoft. While
there are no expected problems with applying the Service Pack to the free
Trial Edition, it has not been tested and is therefore not recommended.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This bug has been corrected in Visual
Studio 97 Service Pack 1.
<P>
For additional information about the Visual Studio 97 Service Pack 1,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vstudio/q170365.htm">Q170365</A></B>
   TITLE     : INFO: Visual Studio 97 Service Packs - What, Where, and Why

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following code can be used in Visual Basic 5.0 to generate an ActiveX
DLL that demonstrates the problem:
<P>
<PRE>   Public Property Get Name() As String
      Name = m_Name
   End Property

   Public Property Let Name(n As String)
      m_Name = n
   End Property

</PRE>Create a new ActiveX DLL project in VB 5.0 and add the preceding code to
the (General) section. Build the ActiveX DLL (Project1.dll for this
example).
<P>
You can then run the Java Type Library Wizard in Visual J++ and select
"Project1" from the list box of items to be converted. The Wizard will fail
with the following:
<P>
<PRE>   c:\Project1.dll(0,0) : fatal error J0001: Internal Compiler Error

</PRE>Alternatively, you can run Javatlb.exe from a Command Prompt session,
passing in the DLL containing the following type library information:
<P>
<PRE>   JavaTLB Project1.dll

</PRE>This will generate the same J0001 error.
<P>
The Visual Studio 97 Service Pack 1 updates Javatlb.exe to version
1.01.7048 (as opposed to version 1.01.7022 that ships with VJ++ 1.1), which
will inject parameter names into the methods that contain unnamed
parameters.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For the latest Knowledge Base articles and other support information on
Visual J++ and the SDK for Java, see the following page on the Microsoft
Technical Support site:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/visualj/">http://support.microsoft.com/support/visualj/</A></B>
   <B><A href="http://support.microsoft.com/support/java/">http://support.microsoft.com/support/java/</A></B>

</PRE> 
<PRE>Keywords          : VS97FixlistSP2 VS97FixlistSP1 CmdLnUtils JCOM VS97FixlistSP3
Technology        : kbInetDev
Version           : 1.0 1.1
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbfix kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
