

<HTML>
<HEAD>
<TITLE>HOWTO: Use FileOpen Common Dialog w/OFN_ALLOWMULTIPLESELECT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q130761">
<META NAME="KBModify" CONTENT="1998/01/15">
<META NAME="KBCreate" CONTENT="1995/05/25">
<META NAME="Keywords" CONTENT="UsrCmnDlg kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  This article covers the format of file names returned by the FileOpen common dialog with the OFN_ALLOWMULTISELECT style.  The FileOpen common dialog can be used to specify the location (drive and directory) and name of a file or a set of files. One...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QAFI,QATX,QAUJ,QAI4,QDL9,QBXB,QBWO,QBWN,QA2S,QATJ,QAHE,QAGB,QA2Q,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Use FileOpen Common Dialog w/OFN_ALLOWMULTIPLESELECT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q130761</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article covers the format of file names returned by the FileOpen
common dialog with the OFN_ALLOWMULTISELECT style.
<P>
The FileOpen common dialog can be used to specify the location (drive and
directory) and name of a file or a set of files. One of the flags needed to
provide mulitple-file selection from the FileOpen common dialog is the
OFN_ALLOWMULTISELECT flag. When this flag is used, and the user makes a
valid selection, the file or files chosen by the user are returned in the
lpstrFile member of the OPENFILENAME structure. The format of the string
returned in the lpstrFile member depends on how many files (single or
multiple) the user selected. This article assumes that the OFN_EXPLORER
Style is set for the file open dialog.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If multiple files were selected, the string is of this form:
<P>
<PRE>   Drive: \Directory Name\0FileName 1\0FileName 2\0FileName n\0\0.

</PRE>The Directory Name is listed first. Then each file that was selected is
listed with a terminating NULL Character, except for the last filename,
which is terminated with two NULL characters. The two NULL characters
signal the end of the string.
<P>
If a single file was selected, the string is of this form:
<P>
<PRE>   Drive: \Directory Name\FileName\0\0.

</PRE>The Directory Name in this case is not terminated by a NULL character, and
the file name is terminated with two NULL characters.
<P>
<P>
Applications must parse the string returned in the lsptrFile member. In
doing so, they should make provisions in the parsing code to have a case
where the user can make a single selection (even though the
OFN_ALLOWMULTISELECT flag is set) or multiple selections.
<P>
NOTE: When using OFN_ALLOWMULTISELECT under Windows 95, you need to use
the OFN_EXPLORER flag to get the explorer style dialog and NULL terminated
strings. If you don't use OFN_EXPLORER with OFN_ALLOWMULTISELECT, you
get the old style dialog and space-delimited strings.
 
<PRE>Keywords          : UsrCmnDlg kbui
Platform          : WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
