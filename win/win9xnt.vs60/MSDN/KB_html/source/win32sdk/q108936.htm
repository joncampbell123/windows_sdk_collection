

<HTML>
<HEAD>
<TITLE>Using a Dialog Box as the Main Window of an Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108936">
<META NAME="KBModify" CONTENT="1996/04/05">
<META NAME="KBCreate" CONTENT="1993/12/20">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Dialog boxes might be used as the main window of an application for several reasons. When an application uses a dialog box as the main window, the following should be taken into consideration while designing such an application:   - The dialog box ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QANX,QAUD,QAMA,QDL9,QBWO,QBWN,QAJH,QAK3,QAGI,QBE5,QAGX,QAGQ,QBW1,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using a Dialog Box as the Main Window of an Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 5, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108936</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Dialog boxes might be used as the main window of an application for several
reasons. When an application uses a dialog box as the main window, the
following should be taken into consideration while designing such an
application:

<UL><LI>The dialog box that acts as the main window of an application can be
   created without an owner.

<LI>If a modal dialog box is created as a main window,
   TranslateAccelerator() cannot be used.

<LI>The icon for the dialog box should be drawn manually when the dialog
   box is minimized.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
You can create a modal or modeless dialog box as the main window of an
application. In doing so, there is no need to have an overlapped window
that acts as the owner of the dialog box. Memory for edit controls
created with the DS_LOCALEDIT flag set, and static controls, will come from
the heap represented by the hInstance passed to the CreateDialog() or
DialogBox() call.
<P>
When modal dialog boxes are chosen for this purpose, and accelerator keys
are defined in an application, Windows enters a modal message loop that
does not process accelerators, unless a WH_MSGFILTER hook is installed and
TranslateAccelerator() is called from the hook callback function.
<P>
One easy way to avoid this limitation is to create a modeless dialog box
and call TranslateAccelerator() from the main message loop.
<P>
The icon for a window is stored in its class information. Because a dialog
box is a window of global class that all applications in the system are
using, changing the icon for this application will change the icon for all
dialog boxes in the system. Below is one workaround for drawing the icon
manually when the dialog box is minimized:
<P>
<P><h3>Sample Code</h3>
 
<P>
BOOL WINAPI GenericDlgProc (HWND hwnd, UINT msg,
<PRE>                            WPARAM wParam,  LPARAM lParam)
 {

   RECT rect ;
   switch (msg) {

       case WM_INITDIALOG:
        hIcon = LoadIcon(); // Load the icon that is to be displayed
                            // when minimized.
        return TRUE ;

       case WM_ERASEBKGND:
            if (IsIconic(hwnd) &amp;&amp; hIcon) {
              SendMessage( hwnd, WM_ICONERASEBKGND, wParam, 0L );
              return TRUE;
             }
        break;

       case WM_QUERYDRAGICON:
            return (hIcon);

        case WM_PAINT: {
            PAINTSTRUCT ps;

            BeginPaint( hwnd, &amp;ps );

            if (IsIconic(hwnd))   //*** If iconic, paint the icon.
            {
              if (hIcon) {

                //center the icon correctly...
              GetClientRect(hwnd, &amp;rect) ;
              rect.left = (rect.right - GetSystemMetrics(SM_CXICON)) &gt;&gt; 1;
              rect.top = (rect.bottom - GetSystemMetrics(SM_CYICON)) &gt;&gt; 1;
              DrawIcon( ps.hdc, rect.left, rect.top, hIcon );
                  }
            }
            EndPaint( hwnd, &amp;ps );
        }
        break;
    }
    return FALSE;

</PRE>} //*** GenericDlgProc
<P>
The workaround described above assumes that the dialog box belongs to the
predefined dialog class. For private dialog box classes, there is no need
to manually draw the icon for the dialog box when it is minimized. You can
specify the icon while registering the dialog box class. Remember to set
the cbWndExtra field to DLGWINDOWEXTRA. When the dialog box is minimized,
the icon will be painted automatically.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 3.51 4.00 95  DLGMAIN<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrDlgs<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 5, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
