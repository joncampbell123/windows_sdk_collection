

<HTML>
<HEAD>
<TITLE>INFO: Implementing Internet Pings Using Icmp.dll </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170591">
<META NAME="KBModify" CONTENT="1997/06/25">
<META NAME="KBCreate" CONTENT="1997/06/24">
<META NAME="Keywords" CONTENT="NtwkMisc NtwkTcpip NtwkWinsock">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Icmp.dll provides functionality that allows developers to write Internet ping applications on Windows systems without Winsock 2 support. The .h and .lib files needed in order to use Icmp.dll were provided with previous versions of Win 32 SDK in the...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAY5,QDKF,QAH6,QDNN,QBV8,QAB9,QBBI,QBWD,QDL9,QDIT,QBWQ,QBWO,QBWN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Implementing Internet Pings Using Icmp.dll</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170591</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Icmp.dll provides functionality that allows developers to write Internet
ping applications on Windows systems without Winsock 2 support. The .h and
.lib files needed in order to use Icmp.dll were provided with previous
versions of Win 32 SDK in the MSTOOLS\ICMP directory. The current Platform
SDK release includes only the icmp.lib file. A Readme.txt (copied below)
and the .h files from previous versions of the Win 32 SDK were, and still
are, the only documentation available.
<P>
If you are writing new code intended for platforms that support Winsock 2.0
or better, you should use the Winsock 2 raw sockets support demonstrated in
the Platform SDK sample titled "Ping: SOCK_RAW in Winsock 2.0" available in
MSSDK\samples\win32\winsock2\ping. As noted in the Readme.txt, Icmp.dll may
be removed from future versions of Windows.
<P>
Support of Icmp.dll is limited to providing the information in this article
and the .h files that accompany Icmp.dll.
<P>
Note that the Winsock 1.1 WSAStartup function must be called prior to using
the functions exposed by ICMP.DLL. If you do not do this, the first call to
IcmpSendEcho will fail with error 10091 (WSASYSNOTREADY).
<P>
<P>
------------ ICMP README.TXT ---------------
[DISCLAIMER]
<P>
We have had requests in the past to expose the functions exported from
icmp.dll.  The files in this directory are provided for your convenience
in building applications which make use of ICMPSendEcho().
<P>
Notice that the functions in icmp.dll are not considered part of the
Win32 API and will not be supported in future releases.  Once we have
a more complete solution in the operating system, this DLL, and the
functions it exports, will be dropped.
<P>
<P>
[DOCUMENTATION]
<P>
The ICMPSendEcho() function sends an ICMP echo request to the specified
destination IP address and returns any replies received within the timeout
specified. The API is synchronous, requiring the process to spawn a thread
before calling the API to avoid blocking. An open IcmpHandle is required
for the request to complete. IcmpCreateFile() and IcmpCloseHandle()
functions
are used to create and destroy the context handle.
<P>
See also icmpapi.h.
 
<PRE>Keywords          : NtwkMisc NtwkTcpip NtwkWinsock
Platform          : NT WINDOWS
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
