

<HTML>
<HEAD>
<TITLE>HOWTO: Hiding the "Connected to" Dialog Box When Using RasDial </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166292">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1997/04/02">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When you establish a successful RAS connection using the RasDial API, the  Connected to...  dialog box is displayed when you run it on Windows 95. This behavior is by design and there is no programmatic way to prevent Windows 95 from generating thi...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QA01,QDL9,QBWO,QBWN,QAI5,QAUJ,QBXE,QBWQ,QDIT,QAUQ,QAD7,QANX,QAIF,QAH7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Hiding the "Connected to" Dialog Box When Using RasDial</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166292</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you establish a successful RAS connection using the RasDial API, the
"Connected to..." dialog box is displayed when you run it on Windows 95.
This behavior is by design and there is no programmatic way to prevent
Windows 95 from generating this dialog box. Neither Windows NT 4.0 nor
Windows 95 OSR 2 is subject to this issue and this behavior is also by
design. However, you can write code to hide this dialog box after it
momentarily appears.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
On Windows 95, you can hide this dialog box, after it momentarily appears,
by using the FindWindow and ShowWindow APIs in a worker thread.

<OL><P><LI>Create a worker thread immediately before you call the RasDial API.

<P><LI>Have the worker thread periodically call the FindWindow API (perhaps
   every few seconds), passing into it the name of the "Connected to ..."
   dialog box. This name is the concatentation of the string
   "Connected to " and "MyConnection", where "MyConnection" is the RAS
   phonebook entry name for the phone number being dialed via RasDial.
   Assuming a RAS phonebook entry named XXX, the call to FindWindow would
   look like the following:
<P>
<P><PRE>      hRasWnd = FindWindow(NULL, "Connected to XXX");
</PRE>
<P><LI>When FindWindow successfully returns a window handle, pass that window
   handle into ShowWindow and specify the SW_HIDE parameter to hide the
   dialog box. For example, assuming hRasWnd is a valid window handle
   returned from a successful call to the FindWindow API, the call to the
   ShowWindow API would look like the following:
<P>
<P><PRE>      fStatus = ShowWindow(hRasWnd, SW_HIDE);
</PRE>
<P><LI>Exit the worker thread.
<P>
</OL>Note that appropriate precautions must be made to exit the worker thread
for the case when the connection is never established.
<P>
Also, if the name of the phonebook entry is too long, the dialog box will
truncate it. In this case you can either rename the entry to a shorter name
or use a completely different technique of enumerating all windows and
searching for the window that matches the beginning of the title.
<P>
(c) Microsoft Corporation 1997, All Rights Reserved.
Contributions by Leon Braginski, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : kbnetwork<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
