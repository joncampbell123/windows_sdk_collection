

<HTML>
<HEAD>
<TITLE>Showing the Beginning of an Edit Control after EM_SETSEL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q64758 ">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1990/08/09">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  In a single-line edit control created with the ES_AUTOHSCROLL style, when the EM_SETSEL message is used to select the entire contents of the control, the text in the control is scrolled to the left and the caret is placed at the end of the text. Th...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QACI,QA7O,QAOE,QAMN,QAB5,QATX,QAMB,QAJP,QBBI,QDL9,QBWO,QBWN,QA2Q,QAIJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Showing the Beginning of an Edit Control after EM_SETSEL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q64758 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.0 and 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In a single-line edit control created with the ES_AUTOHSCROLL style,
when the EM_SETSEL message is used to select the entire contents of
the control, the text in the control is scrolled to the left and the
caret is placed at the end of the text. This occurs when the control
contains more text than can be displayed at one time. The order of the
starting and ending positions specified in the lParam of the EM_SETSEL
message makes no difference.
<P>
If your application needs to have the entire contents selected and the
beginning of the string in view, create the edit control using the
ES_MULTILINE style. The order of the starting and ending positions in
the EM_SETSEL message is respected by multiline edit controls.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Consider the following example, which sets and then selects the text
in a single-line edit control created with the ES_AUTOHSCROLL style:
<P>
<PRE>   //hEdit and szText defined elsewhere
   SetWindowText(hEdit, szText);
   SendMessage(hEdit, EM_SETSEL, 0, MAKELONG(0x7FFF, 0));

</PRE>According to the documentation for the EM_SETSEL message, the
low-order word of lParam specifies the starting position of the
selection and the high-order word specifies the ending position.
However, a single-line edit control ignores this ordering and always
selects the text from the lower position to the higher position.
<P>
If the content of the edit control is longer than the control can
display, the text is scrolled to the end of the selection, and the
caret is positioned there. In some situations, it is necessary to show
the beginning of the text after the selection is made with EM_SETSEL.
In Windows 3.00, there is no documented method to accomplish this
positioning using a single-line edit control.
<P>
A multiline edit control, sized to display only one line and created
without the ES_AUTOVSCROLL style, will appear to the user as a
single-line control. However, this control will respect the order of
the start and end positions in the EM_SETSEL message.
<P>
In the sample code above, a multiline edit control will select the
text from the specified starting position to the specified ending
position, regardless of which position is higher. In this example, the
text is scrolled to the beginning and the caret is placed there. The
beginning of the selected text is visible in the control.
<P>
NOTE: A multiline edit control uses up slightly more memory in the
USER heap than a single-line edit control.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 3.51 4.00 95<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
