

<HTML>
<HEAD>
<TITLE>Using the WM_VKEYTOITEM Message Correctly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108941">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1993/12/20">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The WM_VKEYTOITEM message is sent by a list box with the LBS_WANTKEYBOARDINPUT style to its owner in response to a WM_KEYDOWN message. The return value from this message specifies the action that the application performed in response to the message...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVR,QAEV,QAUD,QAYC,QDL9,QBWO,QBWN,QBSV,QABA,QAJH,QBVV,QALW,QBXQ,QBAD,QAKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using the WM_VKEYTOITEM Message Correctly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108941</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The WM_VKEYTOITEM message is sent by a list box with the
LBS_WANTKEYBOARDINPUT style to its owner in response to a WM_KEYDOWN
message. The return value from this message specifies the action that the
application performed in response to the message. A return value of -2
indicates that the application handled all aspects of selecting the item
and requires no further action by the list box.
<P>
This is true only for certain keys such as the UP ARROW (VK_UP), DOWN ARROW
(VK_DOWN), PAGE DOWN (VK_NEXT) and PAGE UP (VK_PREVIOUS) keys. All other
keys are handled in the normal way by the list box, regardless of the
return value from the WM_VKEYTOITEM message.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The documentation for the WM_VKEYTOITEM message indicates that the owner of
a list box control can trap the WM_VKEYTOITEM message that is generated in
response to a WM_KEYDOWN message and return -2 if the application does not
want the default list box window procedure to take further action.
<P>
This is valid only for keys that are not translated into a character by the
list box control in Windows. If the WM_KEYDOWN message translates to a
WM_CHAR message and the application processes the WM_VKEYTOITEM message
generated as a result of the keydown, the list box ignores the return value
(it will go ahead and do the default processing for that character).
<P>
WM_KEYDOWN messages generated by keys such as VK_UP (UP ARROW), VK_DOWN
(DOWN ARROW), VK_NEXT (PAGE DOWN) and VK_PREVIOUS (PAGE UP) are not
translated to WM_CHAR messages. In such cases, trapping the WM_VKEYTOITEM
message and returning a -2 prevents the list box from doing the default
processing for that key.
<P>
For example, if an application traps the DOWN ARROW key and does some
nondefault processing (such as moving the selection to the item two indexes
below the currently selected item) and then returns -2, the list box
control will not do any more processing with this message.
<P>
Alternatively, if the application trapped the "A" key, does some nondefault
processing, and returns -2, the list box code will still do the default
processing. The list box will select an item in the list box that starts
with an "A" (if one is present).
<P>
To trap keys that generate a char message and do special processing, the
application must subclass the list box and trap both the WM_KEYDOWN and
WM_CHAR messages, and process the messages appropriately in the subclass
procedure.
<P>
NOTE: This discussion is for regular list boxes that are created with the
LBS_WANTKEYBOARDINPUT style. If the list box is owner draw, the application
must process the WM_CHARTOITEM message. For more information on the
WM_CHARTOITEM message, refer to the SDK documentation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 3.51 4.00 95 listbox<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
