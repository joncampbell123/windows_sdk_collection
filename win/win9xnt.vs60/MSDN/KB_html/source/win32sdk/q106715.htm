

<HTML>
<HEAD>
<TITLE>How to Troubleshoot Win32s Installation Problems </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106715">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1993/11/14">
<META NAME="Keywords" CONTENT="W32s kbsetup kbtshoot kbwebcontent">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The installation guide for Win32s that is included in the Win32 SDK recommends running Freecell to verify that the installation was successful. This article discusses some of the errors that may occur when trying to run Freecell on an unsuccessful ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QABI,QBVV,QAEF,QAU9,QAB4,QAAP,QBWO,QBSO,QAKP,QBWS,QBFY,QAMB,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Troubleshoot Win32s Installation Problems</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106715</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.25a 1.30 1.30a 1.30c
WINDOWS
kbsetup kbtshoot kbwebcontent
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32s versions 1.25a, 1.30, 1.30a, and 1.30c
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The installation guide for Win32s that is included in the Win32 SDK
recommends running Freecell to verify that the installation was successful.
This article discusses some of the errors that may occur when trying to run
Freecell on an unsuccessful installation. The article also contains a list
of corrective actions to help you reinstall Win32s.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Possible Symptoms</h3>
 
<P>
One of the following symptoms may occur when running Freecell if the
installation is not successful:

<UL><LI>File Error: Cannot find Olecli.dll
<P>
   -or-

<LI>Win32s - Error:
   Improper installation. Win32s requires Win32s.exe and Win32s16.dll to
   run. Reinstall Win32s.
<P>
   -or-

<LI>Win32s - Error:
   Improper installation.  Windows requires W32s.386 in order to run.
   Reinstall Win32s.
<P>
   -or-

<LI>Error: Cannot find file Freecell.exe (or one of its components)...
<P>
   -or-

<LI>The display is corrupted as soon as you run FreeCell.
<P>
   -or-

<LI>Win32s Error:
   One of the System Components is out of date. Please re-install the
   application.
<P>
</UL><h3>Possible Step-by-Step Solution</h3>
 
<P>
Use the following steps when Win32s does not install correctly:

<OL><P><LI>If you are having video problems, check to see if you have an S3 video
   card. Certain S3 drivers do not work with Win32s. Either use the generic
   drivers shipped with Windows or contact your video card manufacturer for
   an updated driver. For additional information on the S3 driver and
   Win32s, please see the following article in the Microsoft Knowledge
   base:
<P>
   ARTICLE-ID: <B><A href="../win32sdk/q117153.htm">Q117153</A></B>
<PRE>   TITLE     : PRB: Display Problems with Win32s and the S3 Driver

</PRE><P><LI>Make sure the following line is in your System.ini file:
<P>
   device=*vmcpd
<P>
   Without this line in the SYSTEM.INI file, Win32s displays the following
   error when you launch FreeCell or any 32-bit application:
<P>
   - Win32s - Error:
<P><PRE>     Improper installation. Windows requires W32s.386 in order to run.
     Reinstall Win32s.
</PRE><P>
   Windows Setup installs the VMCPD VxD to handle floating point
   exceptions, but it is possible that another driver was installed
   replacing the VMCPD VxD. Win32s only needs the VMCPD driver to handle
   floating point exceptions if a coprocessor is present. But the Win32s
   setup program checks for this driver unconditionally.

<P><LI>If you have a printer driver by LaserMaster, delete it or change it into
   a comment; it interferes with installing Win32s. Then reboot the
   computer so the changes will take effect. After you successfully
   reinstall Win32s, reinstall the driver or remove the comment characters.
<P>
   The driver interferes with installing Win32s because the LaserMaster
   drivers create a WINSPOOL device. The extension is ignored when the file
   name portion of a path matches a device name. As a result, when Setup
   tries to write to Winspool.drv, it fails. It fails because it attempts
   to write to WINSPOOL. In fact, any Win32-based application that tries to
   link to Winspool.drv also fails; however, most Win32-based applications
   that print under Win32s do not use the WINSPOOL application programming
   interfaces (APIs) because they are not supported in Win32s. As a result,
   you can usually just disable this driver while installing Win32s, and
   then re-enable it afterwards. To disable the driver, you need to turn
   the following three lines in the [386ENH] of the System.ini file into
   comments.
<P>
<P><PRE>      device = lmharold.386
      device = lmmi
      device = lmcap
</PRE>
<P><LI>Delete the \Win32s directory, the \Win32app directory, W32sys.dll,
   w32s16.dll, and Win32s.exe from your hard drive before installing.
   Although it is possible to install Win32s on top of an old installation
   of Win32s, it is better to remove the old files before installing the
   new ones.
<P>
   Edit the Win32s.ini file on your hard drive. Change SETUP = 1 to read
   SETUP = 0. Reboot your computer and reinstall Win32s.
<P>
   For more information on how to delete the previous version of Win32s
   from your computer, please see the following Knowledge Base article:
<P>
   ARTICLE-ID: <B><A href="../win32sdk/q120486.htm">Q120486</A></B>
<PRE>   TITLE     : How to Remove Win32s

</PRE><P><LI>Make sure that paging is enabled. From the Control Panel, select the 386
   Enhanced icon, choose Virtual Memory, and choose Change. Verify that the
   drive type is not set to none. The type can be set to either temporary
   or permanent.

<P><LI>If you are using SHARE (not Vshare.386, which Windows for Workgroups
   uses), make sure that SHARE is enabled. Edit the Autoexec.bat file, and
   add the following line if it is not already there:
<P>
   C:\Dos\Share.exe
<P>
</OL><h3>What to Do If the Previous Steps Don't Solve the Problem</h3>
 
<P>
If you still receive errors when running Freecell, compare the binaries on
your hard drive with those on the CD-ROM. Use the MS-DOS program
Filecomp.exe, Comp.exe, or Fc.exe and do a binary compare. For example, if
you have the Win32 SDK CD-ROM, type the following:
<P>
<PRE>   fc /b &lt;system&gt;\win32s\w32s.386 &lt;cd&gt;:\mstools\win32s\nodebug\w32s.386

</PRE><P><LI>If you have the 32-bit Visual C++ CD-ROM, type the following:
<P>
   fc /b &lt;system&gt;\win32s\w32s.386 &lt;cd&gt;:\msvc32s\win32s\retail\w32s.386
<P>
   The results of the compare will be "FC: no differences encountered" if
   the binaries were correctly installed. If the binaries are not the same,
   you might have a bad copy of the files or a bad compact disc.

<P><LI>You can try reinstalling Win32s that shipped in the Visual C++ 32-bit
   edition. There seems to be a slight difference between the Setup.exe
   program on the Win32 SDK CD-ROM and the Setup.exe on the Visual C++ CD-
   ROM. If you try installing from the 32-bit Visual C++ CD-ROM, don't
   remove the \Win32app or \Freecell directory or any of the Freecell
   files. The Visual C++ CD-ROM does not contain Freecell.

<P><LI>Using Freecell Help will generate errors, including "Routine Not Found"
   or "Help Topic Does Not Exist." The generation of these errors has
   nothing to do with whether or not Win32s is installed correctly.
<P>
   Freecell.hlp was meant to be used with Winhlp32.exe. Freecell.hlp uses
   the advanced features of WINHLP32 for full-text searching. Winhelp.exe,
   which runs under Windows version 3.1, does not support this. As a
   result, each time Freecell.hlp tries to bind the Find button to the
   full-text searching APIs, it fails, and Windows Help displays the
   message box. You can still read the information in the help file, and
   you can use the Search button to do keyword searches.

<P><LI>If you are getting the Win32s Error "One of the System Components is out
   of date. Please re-install the application," please refer to the
   following Knowledge Base article:
<P>
  ARTICLE ID: <B><A href="../win32sdk/q159263.htm">Q159263</A></B>
  PRB: "One of your System Components is out of date" Error
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbtshoot kbwebcontent<BR>
KBSubcategory: W32s<BR>
Additional reference words: 1.25a 1.30 1.30a 1.30c setup install<BR>
tshoot help appnote pw1118<BR>
Keywords          : W32s kbsetup kbtshoot kbwebcontent<BR>
Version           : 1.25a 1.30 1.30a 1.30c<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
