

<HTML>
<HEAD>
<TITLE>Windows 95 Support for Net Function Calls </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125700">
<META NAME="KBModify" CONTENT="1996/10/21">
<META NAME="KBCreate" CONTENT="1995/02/01">
<META NAME="Keywords" CONTENT="kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT=" Windows 95 supports a subset of Net function calls. This is a list of the supported functions:    NetAccessAdd   NetAccessCheck   NetAccessDel   NetAccessEnum   NetAccessGetInfo   NetAccessGetUserPerms   NetAccessSetInfo   NetConnectionEnum   NetFil...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDL9,QBWQ,QBWN,QBWO,QAY5,QAGI,QAVZ,QDNF,QABI,QBV8,QAB9,QAGQ,QA3P,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 95 Support for Net Function Calls</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125700</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK)
</UL> 
<P>
Windows 95 supports a subset of Net function calls. This is a list of the
supported functions:
<P>
<PRE>  NetAccessAdd
  NetAccessCheck
  NetAccessDel
  NetAccessEnum
  NetAccessGetInfo
  NetAccessGetUserPerms
  NetAccessSetInfo
  NetConnectionEnum
  NetFileClose2
  NetFileEnum
  NetSecurityGetInfo
  NetServerGetInfo
  NetServerSetInfo
  NetSessionDel
  NetSessionEnum
  NetSessionGetInfo
  NetShareAdd
  NetShareDel
  NetShareEnum
  NetShareGetInfo
  NetShareSetInfo

</PRE>Windows 95 support for these functions differs from Windows NT in two
ways. First, because Windows 95 doesn't support Unicode, these functions
require ANSI strings. Second, Windows 95 exports the Net functions from
SVRAPI.DLL instead of NETAPI32.DLL. If an attempt is made to run a native
Windows NT application on Windows 95, the following error will result:
<P>
<PRE>  "The &lt;application&gt; file is linked to missing export NETAPI32.DLL
   &lt;Net...API&gt;"

</PRE>To handle these differences, applications targeted to both Windows NT
and Windows 95 should do the following:

<OL><P><LI>Avoid importing Net functions from NETAPI32.DLL at link time.
   Instead, applications should do a run time version check and
   dynamically link to NETAPI32.DLL for Windows NT or SVRAPI.DLL for
   Windows 95.
<P>
   For additional information on version checking, please see the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID:<B><A href="../win32sdk/q92395.htm">Q92395</A></B>
<PRE></PRE>      TITLE     :Determining System Version from a Win32-based Application

</PRE><P><LI>Make sure the application doesn't depend on the presence of unsupported
   API's.

<P><LI>When calling Net functions, pass strings using a character set
   appropriate for the host operating system. Use Unicode strings for
   Windows NT and ANSI strings for Windows 95.
<P>
</OL>If you are only targeting Windows 95 and wish to use SVRAPI.DLL, SVRAPI.H
and SVRAPI.LIB are included in the Windows 95 DDK. NOTE: The formal
parameter lists for the Net function calls may be slightly different
between the header files for Windows NT and Windows 95.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 95<BR>
KBCategory: kbnetwork<BR>
KBSubcategory: NtwkLmapi<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
