

<HTML>
<HEAD>
<TITLE>PRB: RestoreDC() Fails Across Printer Pages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139005">
<META NAME="KBModify" CONTENT="1995/11/12">
<META NAME="KBCreate" CONTENT="1995/11/01">
<META NAME="Keywords" CONTENT="kbprint kbgraphic kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The RestoreDC() function returns failure when attempting to restore a printer Device Context (DC) that was saved by calling the SaveDC() function in Windows 95 version 4.0.  NOTE: This occurs only for applications marked as 4.0 applications.  CAUSE...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGI,QAY5,QDL9,QBWO,QBWN,QBJC,QAOX,QAIF,QALS,QBV8,QAB9,QACT,QBWQ,QAUR,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: RestoreDC() Fails Across Printer Pages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139005</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API)
   included with Microsoft Windows 95 version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The RestoreDC() function returns failure when attempting to restore a
printer Device Context (DC) that was saved by calling the SaveDC() function
in Windows 95 version 4.0.
<P>
NOTE: This occurs only for applications marked as 4.0 applications.
<P>
<P><h2>CAUSE</h2>
 
<P>
RestoreDC() fails if the specified state instance does not exist on the GDI
instance stack. Specifically, RestoreDC() fails on a printer DC if the
StartPage() function is called between a call to the SaveDC() and a call to
RestoreDC(). The RestoreDC() function fails because the StartPage()
function in Windows 95 deletes any DC state instances that have been saved
for that DC.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Applications use the StartPage() and EndPage() functions to indicate page
separations on printer DCs. It is therefore necessary for applications
written for Windows 95 to reinitialize a printer DC by selecting GDI
objects and resetting mapping modes and other DC and GDI object attributes
after every call to StartPage().
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When Windows 95-based applications print, they spool to Enhanced Metafile
(EMF) spool files by default. Spooling to an EMF requires a clean DC so
that each call to the StartPage() function restores the printer DC to its
default state.
<P>
In addition to restoring the default state of the DC, Windows 95 also
empties the stack of DC states that may have been saved by calling the
SaveDC() function. This prevents applications from setting up a DC prior to
a call to StartPage() and restoring the selected objects and attributes
after the call to StartPage() with RestoreDC(). However, as long as the
SaveDC() and RestoreDC() functions are called between StartPage()/EndPage()
pairs, they will succeed and properly save and restore DC states for the
printer DC.
<P>
Typically, applications should allocate GDI resources prior to the start of
a document or page and reuse these resources to initialize a printer DC at
the start of every page in a document.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 Windows 95 difference blank page output<BR>
KBCategory: kbprint kbgraphic kbprb<BR>
KBSubcategory: GdiDc GdiPrn<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
