

<HTML>
<HEAD>
<TITLE>GDI Objects and Windows 95 Heaps </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125699">
<META NAME="KBModify" CONTENT="1995/09/29">
<META NAME="KBCreate" CONTENT="1995/02/01">
<META NAME="Keywords" CONTENT="kbgraphic">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT=" Under Windows version 3.1, GDI allocates all resources from a single 64K heap. This limit has caused many applications to run out of GDI resources, especially when using objects that can really take up a lot of the heap, like elliptical regions. Thi...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAIM,QAYZ,QAW6,QAPN,QABO,QAJH,QABN,QDNF,QAGQ,QANY,QAJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>GDI Objects and Windows 95 Heaps</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125699</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
Under Windows version 3.1, GDI allocates all resources from a single 64K
heap. This limit has caused many applications to run out of GDI resources,
especially when using objects that can really take up a lot of the heap,
like elliptical regions. This caused GDI resources to be dangerously low
when executing several applications at once.
<P>
Windows 95 has now introduced a combination of a 16-bit heap and an
additional 32-bit heap. The 16-bit heap is still limited to 64K but the
32-bit heap can grow as large as available memory.
<P>
As in Windows version 3.1, the 16-bit GDI.EXE of Windows 95 continues to
have a 16-bit DGROUP segment with a local heap within it, and most logical
objects are still stored in this local heap. The data structures that
describe brushes, bitmap headers, and pens, for example, stay in the 16-bit
heap. All physical objects, like fonts and bitmaps, are now stored in the
32-bit heap. GDI regions have also been moved to the 32-bit heap. Moving
these GDI resources to the 32-bit heap takes the pressure off of the 64K
16-bit heap.
<P>
Regions can take up a large amount of resources and were the main source of
problems with GDI memory in Windows version 3.1. This will not be a
limitation in Windows 95 because regions are stored in the 32-bit heap.
Applications will be able to use much more complex regions, and regions
will be more useful now that they are not limited to a local 64K heap.
<P>
Windows 95, like Windows NT, will free all GDI resources owned by a 32-bit
process when that process terminates. Windows 95 will also clean up any GDI
resources of 16-bit processes marked as a 4.0 application. Because GDI
objects were sharable between applications in Windows version 3.1, Windows
95 will not immediately clean up GDI resources for 16-bit applications
marked with a version less than 4.0. However, when all 16-bit applications
have finished running, all GDI resources allocated by previous 16-bit
applications will be cleaned up.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 Heaps<BR>
KBCategory: kbgraphic<BR>
KBSubcategory: GdiGeneral<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
