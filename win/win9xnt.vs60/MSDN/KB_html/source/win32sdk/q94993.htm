

<HTML>
<HEAD>
<TITLE>Global Quota for Registry Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94993 ">
<META NAME="KBModify" CONTENT="1997/02/04">
<META NAME="KBCreate" CONTENT="1993/01/28">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Window NT includes a  global quota  on the amount of memory that may be allocated in the registry. This prevents a broken or malicious application from effectively crashing the system by filling paged pool with registry data; however, it does NOT p...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBXS,QBVV,QANY,QABA,QABN,QAGU,QBWP,QA7H,QA3U,QANG,QAKD,QDJ2,QBAO,QAYY,QAL3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Global Quota for Registry Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94993 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.1, 3.5, 3.51, 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Window NT includes a "global quota" on the amount of memory that may be
allocated in the registry. This prevents a broken or malicious application
from effectively crashing the system by filling paged pool with registry
data; however, it does NOT prevent such an application from using up all
available registry space. Similar to the file systems, the registry does
not support per process/user quotas.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The total amount of memory that may be consumed by registry data (the
hives) is limited by the registry size limit (RSL). The RSL works as a
"global quota" for registry space, both in the paged pool and on disk.
<P>
By default, the RSL is 25 percent of the size of the paged pool (the paged
pool is the memory that may be swapped to disk; all user memory is part of
the paged pool). Changing the size of the paged pool also affects the size
of the RSL. See
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\
      CurrentControlSet\
      Control\
      SessionManager\
      MemoryManagement\
      PagedPoolSize

</PRE>in the registry.
<P>
The RSL may also be manually set. The value in bytes may be specified
by setting the value entry for the key
<P>
<PRE>   HKEY_LOCAL_MACHINE\System\
      CurrentControlSet\
      Control\
      RegistrySizeLimit.

</PRE>This key must have a type of REG_DWORD and a data length of 4 bytes, or it
will be ignored.
<P>
If the value entry RegistrySizeLimit is less than 4 megabytes (MB), it will
be forced up to 4 MB. If it is greater than about 80 percent of the size of
the paged pool, it will be set down to 80 percent of the size of the paged
pool. (It is assumed that paged pool is always larger than 5 MB.)
<P>
The system must be rebooted for changes in the RSL to take effect.
<P>
To ensure that the user can always at least boot and edit the registry if
they somehow set the RSL wrong, the quota is not enforced until after the
first successful loading of a hive (that is, loading of a user profile.)
<P>
Note that the RSL sets a maximum, not an allocation (unlike some other such
limits in the system). Setting a large RSL does NOT cause the system to set
aside that much space unless it is actually needed by the registry. It also
does NOT guarantee that that much space will be available for use in the
registry.
<P>
Setting the value entry RegistrySizeLimit to 0xffffffff effectively sets
RSL to be as large as paged pool allows (80 percent of paged pool size).
<P>
In the initial release of Windows NT, the paged pool defaults to 32 MB, so
the default RSL is 8 MB (enough to support approximately 5000 users). The
paged pool can be set to a maximum of 128 MB, so the RSL can be no larger
than about 102 MB, supporting about 80,000 users (surpassing the realistic
limitations of other parts of the system).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory: BseRegistry<BR>
Additional reference words: 3.10
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
