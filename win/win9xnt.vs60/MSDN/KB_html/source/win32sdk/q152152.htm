

<HTML>
<HEAD>
<TITLE>SAMPLE: FRMWRK32.EXE: Updated Generic.xll Template for Excel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152152">
<META NAME="KBModify" CONTENT="1997/08/15">
<META NAME="KBCreate" CONTENT="1996/06/05">
<META NAME="Keywords" CONTENT="kbsample kbusage kbfile kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The sample code provided contains a template that can used for writing 32-bit Microsoft Excel XLLs for Windows. This code demonstrates many of the features of the Microsoft Excel C API. This sample was updated from the Microsoft Excel Developer's K...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QAH0,QAH4,QAY5,QBSO,QBWS,QAY2,QAB9,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: FRMWRK32.EXE: Updated Generic.xll Template for Excel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152152</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Excel Software Development Kit 5.0 for:
   - Microsoft Excel 5.0 for NT
   - Microsoft Excel 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The sample code provided contains a template that can used for writing
32-bit Microsoft Excel XLLs for Windows. This code demonstrates many of the
features of the Microsoft Excel C API. This sample was updated from the
Microsoft Excel Developer's Kit, version 5.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/frmwrk32.exe">Frmwrk32.exe</A> <I>(size: 101510 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from
               Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Creating Stand-alone DLLs (XLLs)</h3>
 
<P>
Microsoft Excel supports stand-alone DLLs. These are DLLs (or code
resources) that the user opens by choosing Open from the File menu and
selecting a DLL file or by using the Microsoft Excel Add-In Manager. The
user can also put DLL files in the Microsoft Excel Startup directory so
that they are opened at run time. By convention, stand-alone DLLs are
called XLLs. After the DLL is built, the DLL should be given a filename
with the extension .XLL. When using an XLL, the user never sees a macro
sheet or Add-In sheet. Therefore, an XLL must be able to do everything an
XLA (Add-In) can do. In particular, XLLs need a way to provide functions
that run automatically at open time, close time, and so on. When developing
an XLL, you need to:

<UL><LI>Define the interface to Microsoft Excel. An XLL should export a few
   functions that are called by Microsoft Excel and the Microsoft Excel
   Add-In Manager.

<LI>Define the user interface to the XLL. Does the XLL use pull-down menus,
   toolbars, or shortcut keys? Or does it only provide additional functions
   for use on worksheets?
<P>
</UL><h3>The Generic Template for XLLs</h3>
 
<P>
The sample code provided contains a template you can use for writing your
own 32-bit Microsoft Excel XLLs. This code demonstrates many of the
features of the Microsoft Excel C API. To see the generic Add-In code, open
GENERIC.C from the sample. When the compiled generic Add-In, GENERIC.XLL,
is opened in Microsoft Excel, it creates a new Generic menu with the four
Commands listed in the following table:
<P>
<PRE>   Command            Action
   -------------------------------------------------------------------

   Dialog             Displays a Microsoft Excel dialog box
   Dance              Moves the selection around until you press ESC
   Native Dialog      Displays a Windows dialog box that was created
                      using the Windows API
   Exit               Closes GENERIC.XLL and removes the menu

</PRE>The generic Add-In also provides two functions, Func1 and FuncSum, that can
be used whenever the generic Add-In is open. These functions appear in the
Generic Add-In category in the Function Wizard. Also, these functions can
be registered without loading all of the generic Add-In. To do this, use
the following formulas:
<P>
<PRE>   =REGISTER("GENERIC.XLL","FUNC1")
   =REGISTER("GENERIC.XLL","FUNCSUM")

</PRE><h3>To Build</h3>
 
<P>
This project must be built as a 32-bit application. NMAKE can be used with
the attached makefile to build this project.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Excel Developer's Kit, version 5.
 
<PRE>Keywords          : kbsample kbusage kbfile kbprg
Version           : 4.0 3.5 3.51
Platform          : NT WINDOWS
Solution Type     : kbfile</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
