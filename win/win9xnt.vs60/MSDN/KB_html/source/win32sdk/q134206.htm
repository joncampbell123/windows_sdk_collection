

<HTML>
<HEAD>
<TITLE>SAMPLE: How to Create an Application Desktop Toolbar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134206">
<META NAME="KBModify" CONTENT="1997/06/11">
<META NAME="KBCreate" CONTENT="1995/08/02">
<META NAME="Keywords" CONTENT="kbcode kbfile kbsample kbui UsrShell">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Windows 95 shell allows an application to register an application desktop toolbar that behaves with the same look and feel as the Windows 95 taskbar. The application desktop toolbar is always attached to one of the outside edges of the screen a...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWZ,QAJH,QDL9,QBWO,QBWN,QBWQ,QAXT,QA0J,QAJQ,QDNF,QA39,QAW9,QANS,QBSO,QAJ4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: How to Create an Application Desktop Toolbar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134206</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows 95 shell allows an application to register an application
desktop toolbar that behaves with the same look and feel as the Windows 95
taskbar. The application desktop toolbar is always attached to one of the
outside edges of the screen and can cause the size of the desktop to be
reduced so that other applications do not overlap the application desktop
toolbar.
<P>
The APPBAR sample code demonstrates how to implement an application desktop
toolbar that is resizable, can attach to any side of the screen, and allows
itself to be hidden in the same way the Windows 95 taskbar automatically
hides.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/appbar.exe">Appbar.exe</A> <I>(size: 47261 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The application desktop toolbar interface for Windows 95 provides an easy
way for an application to attach windows to the edge of the screen so that
they don't overlap the Windows 95 desktop or other applications. The
ability to do this is especially useful in an application-launching program
such as the Microsoft Office Manager (MOM) utility or in an application
that needs to provide status information to the user as it runs in the
background.
<P>
The application creates its window normally and then registers itself with
the system as an application desktop toolbar (appbar). Once registered as
an appbar, any time the window moves it must negotiate with the system for
screen space by sending the requested rectangle to the system as part of an
ABM_QUERYSETPOS message. The system then checks to see if any other appbars
are using that space and adjusts the rectangle requested so as not to
overlap. When the appbar is moved, the system resizes the desktop and moves
any currently running applications so they do not overlap the appbar.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information on the application desktop toolbar interface, please
see the Chapter "Extending the Windows 95 Shell : Application Desktop
Toolbars" in the "Programmer's Guide to Windows 95."  The guide is
available in the Win32 SDK Help file under "Guides."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Windows 95<BR>
Keywords            : kbcode kbfile kbsample kbui UsrShell<BR>
Platform            : Win95<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
