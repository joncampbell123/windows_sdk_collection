

<HTML>
<HEAD>
<TITLE>HOWTO: Pass Arguments to a Service </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171143">
<META NAME="KBModify" CONTENT="1997/07/11">
<META NAME="KBCreate" CONTENT="1997/07/08">
<META NAME="Keywords" CONTENT="BseService kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  A Windows NT service can receive arguments. A demand-started service may receive arguments (also known as service arguments) through the StartService API. The service receives the arguments via it's Service_Main(), which can be defined as follows: ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAD7,QAH7,QAH6,QAHE,QACK,QAPN,QAZB,QBC9,QBC8,QANO,QDIT,QATX,QAMA,QBWP,QAXC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Pass Arguments to a Service</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171143</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
   - Microsoft Windows NT versions 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A Windows NT service can receive arguments. A demand-started service may
receive arguments (also known as service arguments) through the
StartService API. The service receives the arguments via it's
Service_Main(), which can be defined as follows:
<P>
<PRE>   void Service_Main(DWORD dwArgc, LPTSTR *lpszArgv)

</PRE>NOTE: The Service_Main() entry point is user defined through the
SERVICE_TABLE_ENTRY structure. The first argument passed to the
Service_Main() indicates the number of parameters passed to the service
while the second parameter contains an array of strings containing the
arguments. The first string in the array will always be the name of the
service. Any additional strings in the array will contain the arguments
passed to the service through the StartService API.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Sometimes an auto-started service may want to receive arguments.
Unfortunately, there is no method to pass arguments to a service through
it's Service_Main(). These arguments can only be passed to a service
through it's main(). (This entry point is defined by the user via the
compiler. The default entry point is named main().) You can setup the
arguments when you install the service through the CreateService API. For
example, to pass the arguments "franki" and "hosun" to an auto-started
service, you would pass the following string as the lpBinaryPathName
parameter of CreateService():
<P>
<PRE>   "d:\\foo\\foo.exe franki hosun"

</PRE>When the service starts, it can obtain these arguments via it's main()
through argc and argv. To modify the arguments to a service, you call the
ChangeServiceConfig API and modify the lpBinaryPathName parameter.
<P>
If you have configured your service to run as a shared service, each
service originating from the service process will receive the same
arguments when it is auto-started. You cannot pass unique arguments to each
of the services using main(). The services will either have to create a
file or registry key to pass unique arguments to each of the services being
shared.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : BseService kbprg<BR>
Version             : 3.51 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
