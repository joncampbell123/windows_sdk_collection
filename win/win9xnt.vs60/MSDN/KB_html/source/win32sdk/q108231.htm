

<HTML>
<HEAD>
<TITLE>CreateFileMapping() SEC_* Flags </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108231">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1993/12/07">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The definition of CreateFileMapping() is as follows:     HANDLE CreateFileMapping(hFile, lpsa, fdwProtect, dwMaximumSizeHigh,       dwMaximumSizeLow, lpszMapName)     HANDLE hFile;    LPSECURITY_ATTRIBUTES lpsa;    DWORD fdwProtect;    DWORD dwMaxi...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QBWP,QDL9,QBWO,QBWN,QALQ,QBBI,QBWQ,QBWA,QBQU,QBXS,QBW6,QALM,QAH4,QAJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>CreateFileMapping() SEC_* Flags</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108231</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.1, 3.5, and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The definition of CreateFileMapping() is as follows:
<P>
<PRE>   HANDLE CreateFileMapping(hFile, lpsa, fdwProtect, dwMaximumSizeHigh,
      dwMaximumSizeLow, lpszMapName)

   HANDLE hFile;
   LPSECURITY_ATTRIBUTES lpsa;
   DWORD fdwProtect;
   DWORD dwMaximumSizeHigh;
   DWORD dwMaximumSizeLow;
   LPCTSTR lpszMapName;

</PRE>The following flags are four possible values for the parameter fdwProtect:
<P>
<PRE>   SEC_COMMIT
      All pages of a section are to be set to the commit state.
   SEC_IMAGE
      The file specified for a section's file mapping is an executable
      image file.
   SEC_NOCACHE
      All pages of a section are to be set as noncacheable.
   SEC_RESERVE
      All pages of a section are to be set to the reserved state.

</PRE>If none of these flags are specified, SEC_COMMIT is the default. This
behaves the same way as MEM_COMMIT in VirtualAlloc().
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Windows NT</h3>
 
<P>
The SEC_RESERVE flag is intended for file mappings that are backed by the
paging file, and therefore use SEC_RESERVE only when hFile is -1. The pages
are reserved just as they are when the MEM_RESERVE flag is used in
VirtualAlloc(). The pages can be committed by subsequently using the
VirtualAlloc() application programming interface (API), specifying
MEM_COMMIT. Once committed, these pages cannot be decommitted.
<P>
The SEC_NOCACHE flag is intended for architectures that require various
locking structures to be located in memory that is not ever fetched into
the CPU cache. On x86 and MIPS machines, use of this flag just slows down
the performance because the hardware keeps the cache coherent. Certain
device drivers may require noncached data so that programs can write
through to the physical memory. SEC_NOCACHE requires that either
SEC_RESERVE or SEC_COMMIT be used in addition to SEC_NOCACHE.
<P>
The SEC_IMAGE flag indicates that the file handle points to an executable
file, and it should be loaded as such. The mapping information and file
protection are taken from the image file, and therefore no other options
are allowed when SEC_IMAGE is used.
<P>
<P><h3>Windows 95</h3>
 
<P>
Under Windows NT, the Win32 loader simply sits on top of the memory mapped
file subsystem, and so when the loader needs to load a PE executable, it
simply calls down into the existing memory mapped file code. Therefore, it
is extremely easy for to support SEC_IMAGE in CreateFileMapping() under
Windows NT.
<P>
In Windows 95, the loader is more complex and the memory mapped files are
simple and only support the bare minimum of functionality to make the
existing MapViewOfFile() work. Therefore, Windows 95 does not support
SEC_IMAGE. There is support for SEC_NOCACHE, SEC_RESERVE and SEC_COMMIT.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 4.00<BR>
KBCategory: kbprg<BR>
KBSubcategory: BseMm<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
