

<HTML>
<HEAD>
<TITLE>How to Implement Context-Sensitive Help in Windows 95 Dialogs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125670">
<META NAME="KBModify" CONTENT="1995/09/29">
<META NAME="KBCreate" CONTENT="1995/02/01">
<META NAME="Keywords" CONTENT="kbui kbcode">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  In Windows versions 3.x, applications implement context-sensitive help for dialog boxes by installing either a message filter hook, or a task-specific keyboard hook that monitors the WM_KEYDOWN message and responds to F1 key presses.  Windows 95 ma...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QDL9,QBWO,QBWN,QAEV,QA01,QBWQ,QBTC,QAKJ,QAYC,QA7O,QAOE,QAMN,QAH6,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Implement Context-Sensitive Help in Windows 95 Dialogs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 29, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125670</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Windows versions 3.x, applications implement context-sensitive help for
dialog boxes by installing either a message filter hook, or a task-specific
keyboard hook that monitors the WM_KEYDOWN message and responds to F1 key
presses.
<P>
Windows 95 makes it easier because it provides a new WM_HELP message that
gets sent each time the user presses the F1 key, giving the application
a chance to bring up help information on the control that has the keyboard
focus or on the dialog box itself. This new WM_HELP message is not limited
to dialog boxes alone, as it gets sent to any window that has keyboard
focus or to the currently active window.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows 95 also provides a new dialog style, DS_CONTEXTHELP that adds a
question mark button to the dialog box's caption bar. This button, when
clicked, changes the cursor to a question mark with a pointer. When the
user clicks any control in the dialog box, Windows 95 sends a WM_HELP
message for that control. The dialog procedure should process the WM_HELP
message as follows:
<P>
<PRE>   // Define an array of dword pairs,
   // where the first of each pair is the control ID,
   // and the second is the context ID for a help topic,
   // which is used in the help file.
   static const DWORD aMenuHelpIDs[] =
   {
      edt1, IDH_EDT1 ,
      lst1, IDH_LST1 ,
      lst2, IDH_LST2 ,
      0,    0
   };

   case WM_HELP:
   {
      LPHELPINFO lphi;

      lphi = (LPHELPINFO)lparam;
      if (lphi-&gt;iContextType == HELPINFO_WINDOW)   // must be for a control
      {
         WinHelp (lphi-&gt;hItemHandle,
                  "GEN32.HLP",
                  HELP_WM_HELP,
                  (DWORD)(LPVOID)aMenuHelpIDs);
      }
      return TRUE;
   }


</PRE>Calling WinHelp() with the HELP_WM_HELP parameter as demonstrated above
displays the help topic in a pop-up window.
<P>
In addition to the WM_HELP message, Windows 95 provides a new
WM_CONTEXTMENU message that gets sent each time the user right-clicks a
window. Typically this message is processed by displaying a context menu
using the TrackPopupMenu() function. However, this message can be processed
to bring up help information by calling the WinHelp() function to display
the help topic in a pop-up window, as in this example:
<P>
<PRE>   case WM_CONTEXTMENU:
   {
      WinHelp ((HWND)wparam,
               "GEN32.HLP",
                HELP_CONTEXTMENU,
               (DWORD)(LPVOID)aSampleMenuHelpIDs);
      return TRUE;
   }

</PRE>NOTE: Look at the third parameter (HELP_CONTEXTMENU) passed to WinHelp()
this time. This causes a pop-up menu to come up that displays "What's
This?" text. It then displays the help topic in a pop-up window when the
menu item is selected.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00<BR>
KBCategory: kbui kbcode<BR>
KBSubcategory: UsrDlgs<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 29, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
