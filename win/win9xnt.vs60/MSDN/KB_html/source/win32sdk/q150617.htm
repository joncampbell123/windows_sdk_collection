

<HTML>
<HEAD>
<TITLE>PRB: 16-Bit Resource Table Limitation Under Win32s </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150617">
<META NAME="KBModify" CONTENT="1996/05/16">
<META NAME="KBCreate" CONTENT="1996/05/03">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When a 32-bit application is initialized or a DLL file is loaded, Win32s dynamically creates a 16-bit resource table. Because some of the 32-bit functions that handle resources, such as LoadIcon and LoadMenu, are thunked to the 16-bit side, Windows...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIM,QABN,QANY,QAKC,QAYY,QAG8,QDL9,QBWQ,QBWO,QBWN,QBC6,QATX,QARR,QDKW,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 16-Bit Resource Table Limitation Under Win32s</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150617</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32s versions 1.30 and later
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a 32-bit application is initialized or a DLL file is loaded, Win32s
dynamically creates a 16-bit resource table. Because some of the 32-bit
functions that handle resources, such as LoadIcon and LoadMenu, are thunked
to the 16-bit side, Windows 3.1 uses this table to handle the resources.
This table contains information on all the 32-bit resources that have been
converted to the 16-bit form for use by Windows.
<P>
<P><h2>CAUSE</h2>
 
<P>
There is a limitation in Windows 3.1 that the 16-bit resource table created
by Win32s cannot exceed 32K. If this 16-bit table limit is exceeded, the
debug version of Win32s generates the following assertion failure when the
application is initialized.
<P>
<PRE>   "OFFSETOF(pResWrite) &lt; 0xfffc"   or   "OFFSETOF(pResWrite) &lt; 0xfffe"

</PRE><h2>WORKAROUND</h2>
 
<P>
A workaround is to split the resources to more than one module.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Note that the limitation discussed in this article is the size of the 16-
bit resource table created by Win32s and not the size of the resource data
section. In Win32s version 1.15a and earlier, there is a limitation on the
resource data section to be less than 64K, but that limit is eliminated in
Win32s versions 1.20 and later.
<P>
The size of the resource data section is determined by using the DUMPBIN
tool on the 32-bit side. The following line appears:
<P>
<PRE>      xxxx .rsrc

</PRE>where xxxx is the size of the resource data section. However, this does not
provide any information on the 16-bit resource table described earlier.
<P>
The resource table size can be calculated as follows (in bytes):
<P>
<PRE>      2 + (N1 * 8) + (N2 * 16) + N3 + N4

   N1 = Number of resource types (icon, menu, etc.)
   N2 = Number of resources (all resource types)
   N3 = Sum of the lengths of all string IDs (including resource types
                                              that have string IDs)
   N4 = Number of string IDs

</PRE>The result of the calculation should be less than 32K. If a resource is
specified in several languages, count it only once in N2.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.30 win32s<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: APrgOther
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
