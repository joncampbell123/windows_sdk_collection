

<HTML>
<HEAD>
<TITLE>Reasons Why RegisterClass() and CreateWindow() Fail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q65257 ">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1990/08/28">
<META NAME="Keywords" CONTENT="kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The RegisterClass() and CreateWindow() functions fail when the system resources are used up. The percentage of free system resources reflects the amount of available space in the USER and GDI heaps within Windows. The smaller amount of free space i...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAGU,QAIM,QAGB,QABI,QBWP,QBCF,QAJH,QBVV,QAUD,QAH4,QAGQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Reasons Why RegisterClass() and CreateWindow() Fail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q65257 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) versions 3.0 and 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The RegisterClass() and CreateWindow() functions fail when the system
resources are used up. The percentage of free system resources
reflects the amount of available space in the USER and GDI heaps
within Windows. The smaller amount of free space is reported in the
Program Manager's About box because if either heap fills up, functions
fail.
<P>
Under Windows NT, the USER and GDI heap resources are practically
unlimited. Under Windows 95, the USER and GDI heap resources are greater
than Windows 3.1, but not as great as under Windows NT.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the amount of free system resources remains low after the
application is exited, it is more likely that the GDI heap is filling.
The main reason for the GDI heap filling is that GDI objects that are
created by the application are not deleted or destroyed when they are
no longer needed, or when the program terminates. Windows does not
delete GDI objects (pens, brushes, fonts, regions, and bitmaps) when
the program exits. Objects must be properly deleted or destroyed.
<P>
NOTE: Win32-based applications cannot cause the USER or GDI heaps to
overflow when they terminate, because the system will release the resources
to maximize available resources.
<P>
The following are two situations that can cause the USER heap to get
full:

<OL><P><LI>Memory is allocated for "extra bytes" associated with window
   classes and windows themselves. Make sure that the cbClsExtra and
   cbWndExtra fields in the WNDCLASS structure are set to 0 (zero),
   unless they really are being used.

<P><LI>Menus are stored in the USER heap. If menus are added but are not
   destroyed when they are no longer needed, or when the application
   terminates, system resources will go down.
<P>
</OL>CreateWindow() will also fail under the following conditions:

<OL><P><LI>Windows cannot find the window procedure listed in the
   CreateWindow() call. Avoid this by ensuring that each window
   procedure is listed in the EXPORTS section of the program's DEF
   file.

<P><LI>CreateWindow() cannot find the specified window class.

<P><LI>The hwndparent is incorrect (make sure to use debug Windows to see
   the RIPs).

<P><LI>CreateWindow() cannot allocate memory for internal structures in
   USER heap.

<P><LI>The application returns 0 (zero) to the WM_NCCREATE message.

<P><LI>The application returns -1 to the WM_CREATE message.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 4.00<BR>
KBCategory: kbui<BR>
KBSubcategory: UsrWndw<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
