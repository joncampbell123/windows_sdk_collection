

<HTML>
<HEAD>
<TITLE>BUG: App Paths Registry Not Fully Effective For 16-bit Apps </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178883">
<META NAME="KBModify" CONTENT="1998/03/10">
<META NAME="KBCreate" CONTENT="1998/01/06">
<META NAME="Keywords" CONTENT="BseDll BseProcThrd">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When you start a 16-bit Windows application the system, the following error message may appear:     Cannot find              . Windows needs this file to run                   CAUSE =====  The DLL that is implicitly linked to the .exe resides in a ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJH,QAFI,QDL9,QBWO,QBWN,QBXB,QATJ,QBVV,QAYL,QAJQ,QAX1,QAUJ,QAK1,QBWQ,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: App Paths Registry Not Fully Effective For 16-bit Apps</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 10, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178883</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included
   with:
<P>
   - Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you start a 16-bit Windows application the system, the following
error message may appear:
<P>
<PRE>   Cannot find &lt;DLLNAME.DLL&gt;. Windows needs this file to run
   &lt;APPNAME.EXE&gt;

</PRE><h2>CAUSE</h2>
 
<P>
The DLL that is implicitly linked to the .exe resides in a directory
registered in the App Paths registry entry, and not in the same
directory as the .exe.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Place the DLLs for an application in the same directory as the .exe.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products
listed at the beginning of this article. We are researching this bug and
will post new information here in the Microsoft Knowledge Base as it
becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Applications use the App Paths registry entry so that an application's
PATH environment variable will be added to the beginning of some
application-specific directories that are set globally. This applies to
both 16-bit and 32-bit applications.
<P>
The App Paths registry entry is found in the following:
<P>
<PRE>   HKEY_LOCAL_MACHINE
      \SOFTWARE
      \Microsoft
      \Windows
      \CurrentVersion
      \App Paths

</PRE>Each particular application that uses App Paths will have a key name
that is the base name and extension of the application. For example,
NotePad.exe. The application key contains two REG_SZ values. The default
string is the full path to the application name. The other string is a
value named "Path" with one or more directory path names separated by a
semicolon, similar to the format of the PATH= statement in the
AutoExec.bat file.
<P>
This entry is effective for most general uses of the PATH environment in
an application. However, it will not be effective for any implicitly
linked DLLs that reside in a directory listed in the App Paths registry.
Implicitly linked DLLs are loaded before the task is fully created and
receives the modified PATH environment variable. At that time the system
uses the Kernel's environment. The DLL will not be found by the system
if it does not reside in the usual places where it may find DLLs. See
the comments for LoadLibrary in the Windows 3.1 SDK Function Reference
for more information.
<P>
However, once the application is fully loaded, it can call LoadLibrary
to load DLLs that reside in a directory listed in the App Paths
registry. Any functions that use the PATH environment variable will then
be able to take advantage of the modified PATH supplied by the App Paths
registry.
 
<PRE>Keywords          : BseDll BseProcThrd
Version           : WINNT:3.5,4.0;
Platform          : winnt
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 10, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
