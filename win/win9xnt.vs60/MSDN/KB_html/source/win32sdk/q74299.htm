

<HTML>
<HEAD>
<TITLE>Calculating The Logical Height and Point Size of a Font </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74299 ">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1991/07/15">
<META NAME="Keywords" CONTENT="kbgraphic">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  To create a font in the Microsoft Windows graphical environment given only the required point size, an application must calculate the logical height of the font because the CreateFont() and CreateFontIndirect() functions use logical units to specif...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANO,QBC9,QBC8,QDL9,QBWO,QBWN,QADF,QAE5,QAB9,QBCG,QA7Y,QAMV,QAJ9,QAII,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Calculating The Logical Height and Point Size of a Font</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74299 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   versions 3.1 and 3.0

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To create a font in the Microsoft Windows graphical environment given only
the required point size, an application must calculate the logical height
of the font because the CreateFont() and CreateFontIndirect() functions use
logical units to specify height.
<P>
To describe a font to the user, an application can calculate a font's point
size, given its height. This article provides the formulas required to
perform these calculations for the MM_TEXT mapping mode. You will have to
derive a new equation to calculate the font size in another mapping mode.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To calculate the logical height, use the following formula:
<P>
<PRE>                                Point Size * LOGPIXELSY
   height = Internal Leading + -------------------------
                                           72

</PRE>LOGPIXELSY is the number of pixels contained in a logical inch on the
device. This value is obtained by calling the GetDeviceCaps() function with
the LOGPIXELSY index. The value 72 is significant because one inch contains
72 points.
<P>
The problem with this calculation is that there is no method to determine
the internal leading for the font because it has not yet been created. To
work around this difficulty, use the following variation of the formula:
<P>
<PRE>            -(Point Size * LOGPIXELSY)
   height = --------------------------
                         72

</PRE>This formula may also be written as follows:
<P>
<PRE>   plf-&gt;lfHeight = -MulDiv (nPtSize, GetDeviceCaps (hdc, LOGPIXELSY), 72);

</PRE>When an application calls the CreateFont() or CreateFontIndirect()
functions and specifies a negative value for the height parameter, the font
mapper provides the closest match for the character height rather than the
cell height. The difference between the cell height and the character
height is the internal leading, as demonstrated by the following diagram:
<P>
<PRE>   ----------  &lt;------------------------------
   |        |           |- Internal Leading  |
   | |   |  |  &lt;---------                    |
   | |   |  |        |                       |- Cell Height
   | |---|  |        |- Character Height     |
   | |   |  |        |                       |
   | |   |  |        |                       |
   ----------  &lt;------------------------------

</PRE>The following formula computes the point size of a font:
<P>
<PRE>                (Height - Internal Leading) * 72
   Point Size = --------------------------------
                           LOGPIXELSY

</PRE>The Height and Internal Leading values are obtained from the
TEXTMETRIC data structure. The LOGPIXELSY value is obtained from the
GetDeviceCaps function as outlined above.
<P>
Round the calculated point size to the nearest integer. The Windows
MulDiv() function rounds its result and is an excellent choice to
perform the above calculation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.00 3.10 3.50 4.00 95<BR>
KBCategory: kbgraphic<BR>
KBSubcategory: GdiFnt<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
