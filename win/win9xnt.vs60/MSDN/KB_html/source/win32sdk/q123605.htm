

<HTML>
<HEAD>
<TITLE>SAMPLE: RESIZE App Shows How to Resize a Window in Jumps </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123605">
<META NAME="KBModify" CONTENT="1997/10/10">
<META NAME="KBCreate" CONTENT="1994/12/05">
<META NAME="Keywords" CONTENT="UsrWndw kbcode kbfile kbui">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Sometimes it's useful to have a window that can only be certain sizes. For example, Microsoft Word and Microsoft Visual C++ have toolbars that are resizable only to particular sizes that best fit the controls in the toolbar. When you do this, it's ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QACI,QDL9,QBWO,QBWN,QAH4,QAJH,QAQ7,QAYC,QAH6,QBWQ,QABH,QABI,QAGQ,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>SAMPLE: RESIZE App Shows How to Resize a Window in Jumps</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123605</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 3.50  | 4.00
WINDOWS NT | WINDOWS
kbui kbcode kbfile
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.1 and 3.5
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Sometimes it's useful to have a window that can only be certain sizes. For
example, Microsoft Word and Microsoft Visual C++ have toolbars that are
resizable only to particular sizes that best fit the controls in the
toolbar. When you do this, it's a good idea to give the user visual cues
about the available window sizes. The RESIZE sample code shows by example
how to modify the way Windows resizes a window so that when a user uses the
mouse to resize the window the border jumps automatically to the next
available size.
<P>
To obtain the RESIZE sample code, download RESIZE.EXE, a self-extracting
file, from the Microsoft Software Library (MSL) on the following services:

<UL><LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (206) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/resize.exe">RESIZE.EXE</A> <I>(size: 33190 bytes)</I> 
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the SOFTLIB\MSLFILES directory
      Get <A href="http://support.microsoft.com/download/support/mslfiles/resize.exe">RESIZE.EXE</A> <I>(size: 33190 bytes)</I> 
</PRE><P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
When a user clicks the resizing border of a window, Windows enters a
PeekMessage loop to capture all the mouse messages that occur until the
left mouse button is released. While inside this loop, every time the mouse
moves it moves the rectangle that shows the new window size to provide a
visual cue to the user as to what the new window size will be.
<P>
The RESIZE sample code modifies the resizing operation by entering it's own
message loop to capture the mouse messages until the left button is
released. Instead of updating the rectangle every time a mouse move is
received, the RESIZE code checks to see if the current mouse position would
make the window size one of the possible window width and height sizes as
defined by the application. By doing this, the RESIZE application provides
more accurate visual cues about what the resizing operation will do.
<P>
The resizing operation is triggered by the WM_NCLBUTTONDOWN message both
for Windows and the RESIZE application. When this message is received, a
message loop is entered to filter out all the mouse messages except for
two, WM_MOUSEMOVE and WM_LBUTTONUP. When the WM_MOUSEMOVE message is
received, the RESIZE application checks to see if the current mouse
position would make the window larger or smaller. If the window would be
smaller, the resizing rectangle is moved to the next smaller dimension
defined by the application. If the window would be larger, the program
checks to see if the new size would be large enough for the next possible
dimension and updates the rectangle accordingly. When the WM_LBUTTONUP
message is received, the resizing operation is completed by updating the
window size to the current position defined by the mouse and the rectangle
is removed.
<P>
The RESIZE application also takes advantage of some of the flexibility
provided by processing the WM_NCHITTEST message. Windows sends this message
to an application with a mouse position and expects the application to
describe which part of the window that mouse position covers. Frequently,
applications pass this message on to DefWindowProc() and let the default
calculations take care of telling the system what the mouse is on top of.
The RESIZE application allows DefWindowProc() to process the message, but
then checks to see if the mouse is over one of the resizing corners or in
the client area. To simplify the resizing operation, RESIZE doesn't let the
user resize from a window corner, so the application overrides the
HTBOTTOMLEFT, HTBOTTOMRIGHT, HTTOPLEFT, and HTTOPRIGHT hit test codes and
returns HTBOTTOM or HTTOP. By doing this, the mouse cursor accurately
reflects the direction of the resize. When the HTCLIENT hit test code is
returned, RESIZE changes this to HTCAPTION to allow the window to be moved
even though it doesn't have a title bar.
<P>
Although this technique will work in Windows 95, it is not necessary.
Windows 95 provides a new message WM_SIZING that will enable the program to
do exactly the same thing without processing the WM_NCxxx messages or
entering a PeekMessage() loop.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 4.00<BR>
KBCategory: kbui kbcode kbfile<BR>
KBSubcategory: UsrWndw<BR>
Keywords          : UsrWndw kbcode kbfile kbui<BR>
Version           : 3.10 3.50 | 4.00<BR>
Platform          : NT WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
