

<HTML>
<HEAD>
<TITLE>How to Calculate the Height of Edit Control to Resize It </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124315">
<META NAME="KBModify" CONTENT="1996/03/21">
<META NAME="KBCreate" CONTENT="1994/12/28">
<META NAME="Keywords" CONTENT="kbprg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When a program changes the font of an edit control, it must calculate the new height of the control so that text is displayed correctly. When an edit control contains a border, the control automatically adds white space around the text so the text ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHP,QADF,QA7O,QAMN,QAB5,QAOE,QAE5,QATX,QAMB,QAIB,QAH4,QDL9,QBWO,QBWN,QAHV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Calculate the Height of Edit Control to Resize It</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 21, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124315</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK), version 3.1
<LI>Microsoft Win32 Software Development Kit (SDK), versions 3.5 and 3.51
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a program changes the font of an edit control, it must calculate the
new height of the control so that text is displayed correctly. When an edit
control contains a border, the control automatically adds white space
around the text so the text won't interfere with the border.
<P>
This article shows by example how a program can modify the height of an
edit control so that text displayed in the control looks right after the
program changes the font.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The height of the control on creation is calculated as the height of the
control's font plus half of the smaller of the height of the control's font
or the height of the system font. You can use a function similar to the one
below to calculate the new height of an edit control when the font in the
control is changed.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>void ResizeEdit(HWND hwndEdit, HFONT hNewFont)
</PRE>{
<PRE>   HFONT       hSysFont,
               hOldFont;
   HDC         hdc;
   TEXTMETRIC  tmNew,
               tmSys;
   RECT        rc;
   int         nTemp;

   //get the DC for the edit control
   hdc = GetDC(hwndEdit);

   //get the metrics for the system font
   hSysFont = GetStockObject(SYSTEM_FONT);
   hOldFont = SelectObject(hdc, hSysFont);
   GetTextMetrics(hdc, &amp;tmSys);

   //get the metrics for the new font
   SelectObject(hdc, hNewFont);
   GetTextMetrics(hdc, &amp;tmNew);

   //select the original font back into the DC and release the DC
   SelectObject(hdc, hOldFont);
   DeleteObject(hSysFont);
   ReleaseDC(hwndEdit, hdc);

   //calculate the new height for the edit control
   nTemp = tmNew.tmHeight + (min(tmNew.tmHeight, tmSys.tmHeight)/2) +
   (GetSystemMetrics(SM_CYEDGE) * 2);

   //re-size the edit control
   GetWindowRect(hwndEdit, &amp;rc);
   MapWindowPoints(HWND_DESKTOP, GetParent(hwndEdit), (LPPOINT)&amp;rc, 2);
   MoveWindow( hwndEdit,
               rc.left,
               rc.top,
               rc.right - rc.left,
               nTemp,
               TRUE);
}
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 win16sdk<BR>
KBCategory: kbprg kbcode<BR>
KBSubcategory: UsrCtl<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 21, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
