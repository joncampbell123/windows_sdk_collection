

<HTML>
<HEAD>
<TITLE>Handling COMMDLG File Open Network Button Under Win32s </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117825">
<META NAME="KBModify" CONTENT="1995/01/05">
<META NAME="KBCreate" CONTENT="1994/07/10">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT=" When you run a Win32-based application under Win32s on top of Windows 3.1 without a network, the File Open common dialog box still has a Network button.  Under Windows NT, the File Open common dialog box that appears when you call GetOpenFileName() ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QAV1,QAV0,QBWO,QA5D,QDL9,QBWQ,QBWN,QAQW,QA36,QBWP,QBVV,QAJD,QBWS,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Handling COMMDLG File Open Network Button Under Win32s</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 5, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117825</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32s versions 1.1, 1.15, and 1.2
</UL> 
<P>
When you run a Win32-based application under Win32s on top of Windows 3.1
without a network, the File Open common dialog box still has a Network
button.
<P>
Under Windows NT, the File Open common dialog box that appears when you
call GetOpenFileName() has a Network button only when a network is present.
The API (application programming interface) will either use the Network
button in the dialog box template if it exists or dynamically add the
button if it is not in the template and there is a network present. If
there is no network present but the template contains a Network button, the
button will be hidden.
<P>
The dialog box template that is included with the Windows Software
Development Kit (SDK) does not have a Network button because Windows does
not include a network. When the 16-bit Windows-based application is
executed under Windows for Workgroups or under Windows NT, the Network
button is dynamically added, because these operating systems have built-in
networking.
<P>
The template that is included with the Win32 SDK has a Network button. If
the Win32-based application is run under a non-networked Windows 3.1, the
Network button is shown; however it is nonfunctional because there is no
network. This happens because the COMMDLG.DLL that provides Windows 3.1
with the common dialog boxes does not recognize networks. Therefore,
GetOpenFileName() does not remove the Network button from the template if
there is no network.
<P>
One solution is to leave the button in the template, determine when you are
running under Win32s, and include OFN_NONETWORKBUTTON in the OPENFILENAME
structure when Win32s is present but there is no network present. Define a
hook function that during WM_INITDIALOG checks the Flags field of the
OPENFILENAME struct that lParam is pointing to. If OFN_NONETWORKBUTTON is
used, call ShowWindow(GetDlgItem(hWnd, psh14), SW_HIDE).
<P>
Alternatively, if your application will most likely run on networked
Windows 3.1 machines, you can install the COMMDLG.DLL that ships with
Windows for Workgroups 3.11 on all machines, because it is a
redistributable dynamic-link library (DLL). This DLL checks to see if a
network is present and removes the Network button for you if it is not.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.10 1.15 1.20<BR>
KBCategory: kbprg<BR>
KBSubcategory: W32s<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 5, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
