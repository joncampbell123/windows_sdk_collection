

<HTML>
<HEAD>
<TITLE>Adding Categories for Events </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115947">
<META NAME="KBModify" CONTENT="1995/09/25">
<META NAME="KBCreate" CONTENT="1994/06/07">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The ReportEvent() API accepts a category ID as one of the arguments. The  Microsoft Win32 Programmer's Reference  states that you can add your own categories for events. This article shows you how to add categories that will be recognized by the Ev...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAEV,QAPN,QAYC,QAO4,QABO,QBBI,QA4H,QAPF,QDMH,QAKC,QAP2,QADZ,QBXS,QBC6,QAK6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Adding Categories for Events</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 25, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115947</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.1, 3.5, and 3.51
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The ReportEvent() API accepts a category ID as one of the arguments. The
"Microsoft Win32 Programmer's Reference" states that you can add your own
categories for events. This article shows you how to add categories that
will be recognized by the Event Viewer; however, the article assumes that
you already know how to create a message file and add an event source to
the registry. For information about basic event logging, please see the
logging sample in the Q_A\SAMPLES\logging directory on the "Win32 SDK" CD.
<P>
NOTE: The logging example that comes with Visual C++ 2.0 does not bind the
MESSAGES.RC to the MESSAGES.DLL unlike the logging example that accompanies
the Win32 SDK or NSDN Level 2. Binding MESSAGES.RC to the MESSAGES.DLL can
be accomplished by adding MESSAGES.RC to MESSAGES.MAK.
<P>
NOTE: If you notice that there are some entries that have a .DLL name and a
driver name while you are attempting to read messages from the event log,
this means that the event message source has more than one message file.
This means you need to parse the string and load each message file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Just like events, category IDs are simply IDs in message file resources.
However, in order to use categories, the following two requirements must be
met:

<UL><LI>The category IDs must be sequentially numbered, starting with a
   message ID of 1.

<LI>The event source entry in the registry must specify the category
   message file and the number of categories in the message file.
<P>
</UL>The first requirement is simply a matter of setting the MessageID entries
in the message file for the categories. If all of your categories are
listed at the top of the message file, you can assign the ID of 1 to the
first message. Each message after that automatically gets the next ID value
unless you specify otherwise in the MessageID entry.
<P>
The category entries in the registry are made by adding values to your
event key. Normally, your event log application key already contains
EventMessageFile and TypesSupported entries. You should add the following
two entries:

<UL><LI>CategoryMessageFile

<LI>CategoryCount
<P>
</UL>The CategoryMessageFile entry is of type REG_EXPAND_SZ. It should be set to
the full path to the message file that contains the categories.
<P>
The CategoryCount entry is a REG_DWORD type. You should set this entry to
the number of categories in the message file specified in
CategoryMessageFile.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft Win32 Programmer's Reference," Microsoft Corporation.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50<BR>
KBCategory: kbprg<BR>
KBSubcategory: BseMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 25, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
