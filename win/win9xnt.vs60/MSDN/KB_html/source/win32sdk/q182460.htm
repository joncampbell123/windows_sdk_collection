

<HTML>
<HEAD>
<TITLE>PRB: Project in PDK MMC Sample Does Not Build SnapIn Properly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182460">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1998/03/13">
<META NAME="Keywords" CONTENT="kbMmc">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The project file for the Microsoft Management Console (MMC) Sample located in the Platform SDK does not build and register the SnapIn properly. This article outlines steps you can take to modify the sample so that it will build and execute properly...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QDNQ,QAOG,QBVV,QAJH,QBWA,QBWS,QBSO,QBWP,QA6A,QALZ,QAJN,QAD7,QA0B,QAGR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Project in PDK MMC Sample Does Not Build SnapIn Properly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182460</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Management Console, version 1.0 on the following platforms:
<P>
   - Windows NT
   - x86
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The project file for the Microsoft Management Console (MMC) Sample located
in the Platform SDK does not build and register the SnapIn properly. This
article outlines steps you can take to modify the sample so that it will
build and execute properly.
<P>
<P><h2>CAUSE</h2>
 
<P>
The sample is incomplete. The SnapIn that is created does not properly
register itself.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You need to take the key values described in the .ini files and convert
them to registry script files. To do this, modify the project file as
follows:

<OL><P><LI>Add the About.Cpp file to the file list.

<P><LI>Change the options on the About.Cpp file so that it does not try to
   compile the precompiled headers file. Stdfx.Cpp is the file that insures
   that these headers are properly handled. Change this option as follows:
<P>
   a. Click Projects, and then Settings.
<P>
   b. Expand the Source Files folder.
<P>
   c. Highlight the About.Cpp file.
<P>
   d. Click the C++ Property Page.
<P>
   e. Set the Category to Precompiled Headers.
<P>
   f. Click Use Precompiled Header File.
<P>
   g. Type "stdafx.h" in the edit control for Through Header:.
<P>
   h. Click the SnapIn Icon at the top.
<P>
   i. Select the General Property Page.
<P>
   j. Use the MFC libraries. It does not matter if you statically link to
<P><PRE>      them or use them as a shared DLL.
</PRE><P>
   k. Click OK.

<P><LI>If you are working with the debug configuration, you need to copy the
   debug versions of the MFC DLLs and libraries in the appropriate
   directories on your system.

<P><LI>Register the SnapIn. The *.ini files included in the sample contain the
   appropriate key values. These files need to be converted to Registry
   script files. The contents of the registry script files are included in
   the MORE INFORMATION section of this article.

<P><LI>Once the SnapIn is properly registered, it should appear in the Add
   Remove SnapIn box.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Extension.ini Converted to a registry script file:
<P>
<PRE>   REGEDIT4

   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{27E5EC4E-9F2D-11D0-
    A7D6-00C04FD909DD}]
   "NameString" =  "Extension"
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{27E5EC4E-9F2D-11D0-
    A7D6-00C04FD909DD}\StandAlone]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{27E5EC4E-9F2D-11D0-
    A7D6-00C04FD909DD}\NodeTypes]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{27E5EC4E-9F2D-11D0-
    A7D6-00C04FD909DD}\NodeTypes\{65ca8054-9f4d-11d0-a7d6-00c04fd909dd}]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{27E5EC4E-9F2D-11D0-
    A7D6-00C04FD909DD}\NodeTypes\{e5092d22-1d7e-11d0-a29b-00c04fd909dd}]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{27E5EC4E-9F2D-11D0-
    A7D6-00C04FD909DD}\NodeTypes\{e6092d22-1d7e-11d0-a29b-00c04fd909dd}]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\NodeTypes\{44092d22-1d7e-
    11d0-a29b-00c04fd909dd}]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\NodeTypes\{44092d22-1d7e-
    11d0-a29b-00c04fd909dd}\Extensions]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\NodeTypes\{44092d22-1d7e-
    11d0-a29b-00c04fd909dd}\Extensions\NameSpace]
   "{27E5EC4E-9F2D-11D0-A7D6-00C04FD909DD}" = "Sample extension snapin"
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\NodeTypes\{44092d22-1d7e-
    11d0-a29b-00c04fd909dd}\Extensions\PropertySheet]
   "{27E5EC4E-9F2D-11D0-A7D6-00C04FD909DD}" = "Sample extension snapin"

</PRE></OL>Sample.ini converted to a Registry script File:
<P>
<PRE>   REGEDIT4

   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{18731372-1D79-11D0-
    A29B-00C04FD909DD}]      = REG_SZ "PDC Sample Snapin"
           "NameString" = "Sample"
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{18731372-1D79-11D0-
    A29B-00C04FD909DD}\About] = "{F0A1B9BE-A172-11D0-A7D7-00C04FD909DD}"
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{18731372-1D79-11D0-
    A29B-00C04FD909DD}\StandAlone]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{18731372-1D79-11D0-
    A29B-00C04FD909DD}\NodeTypes]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{18731372-1D79-11D0-
    A29B-00C04FD909DD}\NodeTypes{44092d22-1d7e-11d0-a29b-00c04fd909dd}]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{18731372-1D79-11D0-
    A29B-00C04FD909DD}\NodeTypes{55092d22-1d7e-11d0-a29b-00c04fd909dd}]
   [HKEY_LOCAL_MACHINE\Software\Microsoft\MMC\SnapIns\{18731372-1D79-11D0-
    A29B-00C04FD909DD}\NodeTypes{66092d22-1d7e-11d0-a29b-00c04fd909dd}]

</PRE><h2>REFERENCES</h2>
 
<P>
HTTP://www.microsoft.com/management, Microsoft Management Console Web pages
Microsoft Management Console Overview Document
Microsoft Management Console PDK Samples
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MMC, sample, extension<BR>
Keywords          : kbMmc<BR>
Version           : WINDOWS:1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
