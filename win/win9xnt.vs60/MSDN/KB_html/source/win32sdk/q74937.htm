

<HTML>
<HEAD>
<TITLE>Authoring Windows Help Files for Performance </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q74937 ">
<META NAME="KBModify" CONTENT="1995/11/02">
<META NAME="KBCreate" CONTENT="1991/08/05">
<META NAME="Keywords" CONTENT="kbtool">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Windows Help Compiler allows an application developer to create hypertext documentation, richly annotated with color and graphics. This article discusses methods to author help files to achieve maximum performance when the file is used. These c...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA6A,QAU3,QAMR,QAE2,QBVV,QAYY,QDLP,QAY5,QDL9,QBWO,QBWN,QALQ,QANY,QAN0,QAMB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Authoring Windows Help Files for Performance</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 2, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q74937 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) version 3.1
<LI>Microsoft Win32 SDK, versions 3.5, 3.51, and 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Windows Help Compiler allows an application developer to create
hypertext documentation, richly annotated with color and graphics.
This article discusses methods to author help files to achieve maximum
performance when the file is used. These comments apply to Windows
Help versions 3.06 and later.
<P>
This information is subject to change in future versions of the Help
Compiler and of the Help application as new technology is incorporated
into these products.
<P>
There are four major suggestions:

<OL><P><LI>Use OPTCDROM=1 for all files destined for CD-ROM (compact-disk
   read-only memory), and potentially on files where up to an
   additional 10K of size is not significant.

<P><LI>Use bitmaps placed with data for small bitmaps that are referenced
   only once or infrequently in the help file.

<P><LI>Use bitmaps not placed with data for large bitmaps, all bitmaps
   referenced frequently, or bitmaps referenced by two or more topics
   that generally will be viewed in succession.

<P><LI>Use segmented hypergraphics to generate graphics with multiple hot
   spots, rather than several bitmaps positioned next to each other.
<P>
</OL>Coincidentally, suggestions 2, 3, and 4 are also generally space-saving
techniques as well.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Use OPTCDROM=1 for files destined for CD-ROM.
<P>
   When OPTCDROM is placed in the [OPTIONS] section of the .HPJ file,
   the topic information in the help file is aligned on 2K boundaries.
   This option is aimed at maximizing performance on CD-ROM drives,
   where reading aligned information can be significantly faster.
<P>
   Estimates indicate that sequential reads from CD-ROM can be up to
   twice as fast when aligned. While reads are not always sequential,
   a high percentage can be, depending on how the help file is
   authored. Minor improvements have also been noted on magnetic
   media.
<P>
   This option can cause up to 10K of additional file space to be
   used.

<P><LI>Store small bitmaps with data.
<P>
   Placing bitmaps with data keeps the graphical and textual
   information in the same location in the help file. This avoids
   reading from different locations on disk to display a topic. Seeks
   to different locations are exceptionally time consuming on CD-ROM,
   and can be time consuming on magnetic media. Bitmaps with data also
   help maximize the effects of the OPTCDROM option.
<P>
   Up to 12K of compressed topic text is buffered in memory. Since
   bitmaps are kept with the topic text, they take advantage of this
   buffering. Thus, topics under 12K in compressed size generally do
   not need to be reread when the window is resized or redrawn.
<P>
   Note that large bitmaps kept with data may cause performance to
   become worse. Topics may be laid out twice as part of scroll bar
   removal. Topics over 12K in size will be read, laid out, and then
   reread as they are laid out a second time before display. Bitmaps
   are often the cause of exceeding the 12K size. Bitmaps NOT kept
   with data are buffered elsewhere (see #3 below), and if the
   remaining textual data is less than 12K, the topic will be read
   from disk only once.
<P>
   Bitmaps with data cost space only when the same bitmap is used more
   than once in the help file. If a bitmap is used frequently, not
   placing it "with data" may be more appropriate, unless the
   performance benefit is determined to outweigh the size hit.

<P><LI>Store large and frequently accessed bitmaps separately.
<P>
   The 50 most recently accessed bitmaps not stored with data are
   cached in memory. This means that the bitmap may have to be read
   from disk only once if two successively displayed help topics
   reference it. Unlike bitmaps stored with data, these cached bitmaps
   only have to be reread if they are bumped out of the cache by the
   subsequent display of 50 more bitmaps, or by low memory conditions.
<P>
   Cached bitmaps not stored with data cost some speed when they are
   typically displayed by the user only once in a session. Since they
   are stored in a different portion of the help file from the topic
   text, an additional seek is required to locate them. This cost, if
   incurred, is generally negligible on disk, and high on CD-ROM.
   Note, however, that this cost MAY be less than the cost of reading
   the topic twice, if the topic is laid out twice as a result of not
   needing scroll bars, and is larger than 12K.

<P><LI>Use segmented hypergraphics.
<P>
   Segmented hypergraphics is the term used to describe the ability to
   take a single bitmap, and define several regions that are hot
   spots. Hot spots can overlap, and can each perform different
   actions.
<P>
   The primary benefit of using segmented hypergraphics is that a
   single bitmap can be used. Previous techniques utilizing several
   bitmaps carefully placed in the topic text to generate a single
   image have the drawback of requiring several bitmap-locating
   operations at display time, which can translate to several disk
   seeks and reads. On CD-ROM, especially, this can be quite
   significant.
<P>
   The only cost involved in using segmented hypergraphics is that the
   segmented hypergraphics editor must be used to define the hot spots
   within the bitmaps.
<P>
</OL>In summary, there are a few simple authoring techniques that can
improve performance of help files. While especially significant for
CD-ROM hosted help files, they are of benefit to disk-based help files.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 4.00 95<BR>
KBCategory: kbtool<BR>
KBSubcategory: TlsHlp<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 2, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
