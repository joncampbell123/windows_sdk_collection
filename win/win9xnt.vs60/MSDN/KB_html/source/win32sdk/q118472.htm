

<HTML>
<HEAD>
<TITLE>PRB: SelectClipRgn() Cannot Grow Clip Region in WM_PAINT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q118472">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1994/07/19">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Setting a smaller clipping region in WM_PAINT by using SelectClipRgn() works fine; however, setting a larger clipping region seems to have no effect. GetClipBox() can be used to verify this after calling SelectClipRgn().  CAUSE =====  When you call...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAXB,QDL9,QBWO,QBWN,QAC1,QBWP,QBD2,QAGI,QBWQ,QAGQ,QBXS,QA6F,QAA5,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SelectClipRgn() Cannot Grow Clip Region in WM_PAINT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q118472</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.10 4.00 | 3.50 3.51
<PRE>WINDOWS   | WINDOWS NT
</PRE>kbgraphic kbprb docerr
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows Software Development Kit (SDK) for Windows
   version 3.1

<LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.5 and 3.51
    - Microsoft Windows 95 version 4.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Setting a smaller clipping region in WM_PAINT by using SelectClipRgn()
works fine; however, setting a larger clipping region seems to have no
effect. GetClipBox() can be used to verify this after calling
SelectClipRgn().
<P>
<P><h2>CAUSE</h2>
 
<P>
When you call SelectClipRgn() within a BeginPaint()/EndPaint() block in an
application's WM_PAINT case, the maximum size to which you can set your
clipping region is the size of the update region of your paint structure.
This is because the resulting clip region is the intersection of the update
region and the region specified in the call to SelectClipRgn(). In other
words, you can use SelectClipRgn() to shrink your update region, but not to
grow it. This behavior is by design.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Invalidate the clipping region area you want before calling BeginPaint().
For example:
<P>
case WM_PAINT:
<PRE>   InvalidateRect(hWnd, ....); // Invalidate the size you'll want
                               // for the clip region.
   BeginPaint()
   SelectClipRgn();
   ... paint away ...
   EndPaint();
   break;

</PRE>Something similar could be done in the Microsoft Foundation Classes (MFC),
such as:
<P>
<PRE>void CMyView::OnPaint()
</PRE>{
<PRE>   InvalidateRect(...); // Invalidate the size you'll want.
   CPaintDC dc(this);   // CPaintDC wraps BeginPaint()/EndPaint().
   // Do drawing here...
</PRE>}
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This is addressed in the documentation for the Windows NT SDK version 3.1
[Section 20.1.5, "Window Regions" in Chapter 20, "Painting and Drawing" in
the "Microsoft Win32 Programmer's Reference, Volume 1" or in the Win32 API
Reference online help (search on "Window Regions")] which states:
<P>
<PRE>   In addition to the update region, every window has a visible region that
   defines the window portion visible to the user. The system changes the
   visible region for the window whenever the window changes size or
   whenever another window is moved such that it obscures or exposes a
   portion of the window. Applications cannot change the visible region
   directly, but Windows automatically uses the visible region to create
   the clipping region for any display DC retrieved for the window.

   The clipping region determines where the system permits drawing. When
   the application retrieves a display DC using the BeginPaint, GetDC, or
   GetDCEx function, the system sets the clipping region for the DC to the
   intersection of the visible region and the update region. Applications
   can change the clipping region by using functions such as SelectClipPath
   and SelectClipRgn, to further limit drawing to a particular portion of
   the update area.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 4.00 SelectClipRegion big small large<BR>
KBCategory: kbgraphic kbprb<BR>
KBSubcategory: GdiMisc<BR>
Technology          : kbMfc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
