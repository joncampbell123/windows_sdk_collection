

<HTML>
<HEAD>
<TITLE>How to Test Autorun.inf Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136214">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1995/09/04">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  AutoPlay is enabled by the new 32-bit, protected-mode driver architecture in Windows 95. Because the operating system can now detect the insertion of media in a CD-ROM drive, it has the opportunity to do some intelligent processing whenever this oc...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVW,QAVX,QAC9,QDL9,QBWO,QBWN,QBIC,QBXS,QBWQ,QDLP,QABA,QBXM,QA9N,QALG,QAK2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Test Autorun.inf Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136214</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbmm
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
AutoPlay is enabled by the new 32-bit, protected-mode driver architecture
in Windows 95. Because the operating system can now detect the insertion of
media in a CD-ROM drive, it has the opportunity to do some intelligent
processing whenever this occurs.
<P>
By default, Windows 95 only checks for an Autorun.inf file when a CD-ROM
disc is inserted into the CD-ROM drive. However, you may want to test for
syntax and logic errors before burning a CD-ROM disc. This article explains
how.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Windows 95, whenever a CD-ROM disc is inserted, the shell immediately
checks to see if the CD-ROM disc has a PC filesystem. If it does, Windows
95 looks for a file named Autorun.inf. If the file exists, Windows 95
follows the instructions contained in the file, which usually
involves running a setup application of some sort.
<P>
However, by changing a setting in the Windows 95 registry, you can have the
Shell use AutoPlay on any media, including shared network drives and floppy
disks.
<P>
The registry key that needs to be modified is:
<P>
HKEY_CURRENT_USER\
<PRE>   Software\
      Microsoft\
         Windows\
            CurrentVersion\
               Policies\
                  Explorer\
                     "NoDriveTypeAutoRun"

</PRE>This key, which is of type REG_BINARY, consists of four bytes. The first
byte is a bitmask defining which drive types should be AutoRun. The
other three bytes should be set to zero (0).
<P>
The bits in the bitmask correspond to these constants:
<P>
<PRE>Type                Bit
</PRE> 
<PRE>DRIVE_UNKNOWN       0
DRIVE_NO_ROOT_DIR   1
DRIVE_REMOVABLE     2
DRIVE_FIXED         3
DRIVE_REMOTE        4
DRIVE_CDROM         5
DRIVE_RAMDISK       6

</PRE>Setting a bit in the bitmask prevents you from using AutoPlay with the
corresponding drive type. By default, the value in the registry is 0x95.
Bits 0, 2, 4 and 7 are therefore set, which means that drive types
DRIVE_UNKNOWN, DRIVE_REMOVEABLE, and DRIVE_REMOTE don't use AutoPlay
information. (Bit 7 is set to cover future device types.) Altering this
registry value thus allows you to test Autorun.inf files from a floppy disk
(DRIVE_REMOVEABLE), network drive (DRIVE_REMOTE), and so on. For example,
to be able to test AutoPlay from a floppy disk, set the value of the first
byte to 0x91 to enable AutoPlay for floppy disks.
<P>
NOTE: Most floppy disk drive controllers do not currently recognize when a
floppy disk has been inserted. To test AutoPlay on a floppy disk, first
alter the registry setting so that bit DRIVE_REMOVEABLE is not set, start
the Windows Explorer, insert the floppy disk, and press the F5 key to
refresh the display.
<P>
To test the Autorun.inf file on a given disk, using the right mouse button,
click the icon for the drive in the Windows Explorer. The effects of the
Autorun.inf file should be visible in the context menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00<BR>
KBCategory: kbmm<BR>
KBSubcategory: MMCDROM<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
