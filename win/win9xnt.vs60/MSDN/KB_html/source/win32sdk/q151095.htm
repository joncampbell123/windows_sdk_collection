

<HTML>
<HEAD>
<TITLE>How To Disable Initial RAS Wizard for Phonebook Extensions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151095">
<META NAME="KBModify" CONTENT="1997/08/13">
<META NAME="KBCreate" CONTENT="1996/05/16">
<META NAME="Keywords" CONTENT="kbhowto kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  By using Remote Access Service (RAS) phonebook extensions, it is possible to programmatically create phonebook entries for Windows 95's dial-up networking applet. However, these APIs do not allow you to disable the automatic Windows 95 phonebook En...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWQ,QBWO,QAIK,QBXC,QBXS,QAH4,QAUD,QDLU,QDJI,QA4P,QA1S,QAVZ,QDNF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How To Disable Initial RAS Wizard for Phonebook Extensions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151095</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.00
WINDOWS
kbprg kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Remote Access Service for Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
By using Remote Access Service (RAS) phonebook extensions, it is possible
to programmatically create phonebook entries for Windows 95's dial-up
networking applet. However, these APIs do not allow you to disable the
automatic Windows 95 phonebook Entry Wizard. If you do not want Windows 95
to invoke the Connection Wizard to create the first phonebook entry, your
application must modify the registry.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
On a fresh installation of Windows 95 with Dial-Up Networking installed,
the RAS phonebook has no entries. When a user opens the Dial-Up Networking
applet for the first time, a Wizard appears, instructing the user to create
the first phonebook entry "My Connection." The Wizard appears even if
another application already created the first phonebook entry.
<P>
To disable the initial Connection Wizard on Windows 95 manually, you can
run REGEDIT.EXE and set HKEY_CURRENT_USER\RemoteAccess\Wizard to the
following series of bytes: 80 00 00 00.
<P>
The code below shows how to disable the Dial-Up Networking Connection
Wizard programmatically. However, these registry modifications only apply
to Windows 95. Your application must determine the operating system you are
running on. All other versions of Windows and Windows NT, both current and
future, will not support this registry entry. For more information on
version checking, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win32sdk/q92395.htm">Q92395</A></B>
   TITLE     : Determining System Version from a Win32-based Application

</PRE><h3>Sample Code</h3>
 
<P>
<PRE>   #include &lt;windows.h&gt;
   #include &lt;stdio.h&gt;

   void main (void)
       {
       LONG rc;
       HKEY hKey;
       DWORD dwVal;

       printf ("Setting HKEY_CURRENT_USER\\RemoteAccess\\Wizard to"
               " 0x00000080.\n This will stop the wizard from appearing "
              "when the dial-up\nnetworking applet is opened.\n");

       //
       // Open the registry key
       //
       rc = RegOpenKeyEx (HKEY_CURRENT_USER, "RemoteAccess",
                          0, KEY_SET_VALUE, &amp;hKey);

       if (rc != ERROR_SUCCESS)
           {
           printf ("RegOpenKeyEx failed with return code %i\n", rc);
           return;
           }

       //
       // Modify the key
       //
       dwVal = 0x00000080;
       rc = RegSetValueEx (hKey, "wizard", 0, REG_BINARY,
                           (LPVOID) &amp;dwVal, sizeof (dwVal));

       if (rc != ERROR_SUCCESS)
           printf ("RegSetValueEx failed with return code %i\n", rc);

       //
       // Cleanup
       //
       RegCloseKey (hKey);
       }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 win95 ras wizard registry remote access<BR>
KBCategory: kbprg kbhowto<BR>
KBSubcategory: NtwkRAS<BR>
Keywords          : kbhowto kbprg<BR>
Version           : 4.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
