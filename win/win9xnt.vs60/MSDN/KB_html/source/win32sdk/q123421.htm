

<HTML>
<HEAD>
<TITLE>PRB: Inconsistencies in GDI APIs Between Win32s and Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q123421">
<META NAME="KBModify" CONTENT="1994/12/01">
<META NAME="KBCreate" CONTENT="1994/12/01">
<META NAME="Keywords" CONTENT="kbprg kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The StretchBlt() and StretchDIBits()/SetDIBits() GDI APIs do not behave consistently under Win32s and Windows NT.  StretchBlt()  If the source width and height specified in the call to StretchBlt() are greater than the actual bitmap width and heigh...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDKW,QAGI,QBBI,QAIM,QBW6,QDL9,QBWQ,QBWO,QBWN,QAKP,QBFN,QA8T,QAYV,QAHE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Inconsistencies in GDI APIs Between Win32s and Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1994</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q123421</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32s version 1.2
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The StretchBlt() and StretchDIBits()/SetDIBits() GDI APIs do not behave
consistently under Win32s and Windows NT.
<P>
<P><h3>StretchBlt()</h3>
 
<P>
If the source width and height specified in the call to StretchBlt() are
greater than the actual bitmap width and height, StretchBlt() fails. The
same call to StretchBlt() succeeds under Windows NT.
<P>
<P><h3>StretchDIBits()/SetDIBits()</h3>
 
<P>
If the memory pointed to by the lpBits parameter is read-only, the call to
StretchDIBits()/SetDIBits() fails.
<P>
NOTE: When a Win32-based application uses the memory returned from
LockResource() as a parameter to SetDIBits(), by default, it's using
read-only memory, because the resource section is defined by default as
read-only.
<P>
<P><h2>CAUSE</h2>
 
<P>
These problems are due to bugs in Windows. In the case of StretchDIBits()
and SetDIBits(), Windows mistakenly verifies that the buffer is writable.
This problem does not show up in a 16-bit Windows-based application running
under Windows because resources are loaded into read/write (global) memory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In Win32s version 1.25, Win32s will always make the resource section
read/write, regardless of what is specified in the section attributes. This
will work around the problem. In the meantime, use the following
resolutions:
<P>
<P><h3>StretchBlt()</h3>
 
<P>
To work around the problem, specify the proper width and height for the
source bitmap.
<P>
<P><h3>StretchDIBits()/SetDIBits()</h3>
 
<P>
To work around the problem, do one of the following:

<UL><LI>Copy the memory to a temporary read/write buffer.
<P>
   -or-

<LI>Use the linker switch /SECTION:.rsrc,rw to make the resource section
   read/write. Windows NT will allocate separate resource sections for
   each copy of the application.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.20<BR>
KBCategory: kbprg kbprb<BR>
KBSubcategory: W32s<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1994</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
