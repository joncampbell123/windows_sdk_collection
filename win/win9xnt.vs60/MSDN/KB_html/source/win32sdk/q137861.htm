

<HTML>
<HEAD>
<TITLE>How to Allow OS/2 Programs to Run Across Logons </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137861">
<META NAME="KBModify" CONTENT="1996/12/16">
<META NAME="KBCreate" CONTENT="1995/10/05">
<META NAME="Keywords" CONTENT="kbprg kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When you launch an OS/2 application from a service in Windows NT, the OS/2 application terminates when the current user logs off. If you want the application to continue running after the user logs off, you can:   - Run the OS/2 application from th...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QBWP,QAJH,QACK,QBFY,QAGU,QBKX,QABI,QBXT,QA5V,QAY2,QAV1,QAV0,QAK0,QAIB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Allow OS/2 Programs to Run Across Logons</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137861</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT versions 3.51 and 4.00
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you launch an OS/2 application from a service in Windows NT, the OS/2
application terminates when the current user logs off. If you want the
application to continue running after the user logs off, you can:

<UL><LI>Run the OS/2 application from the Windows NT Resource Kit utility
   called SRVANY.
<P>
   -or-

<LI>Launch Os2.exe directly from the service, and pass the /S switch. The
   syntax of the call would be:
<P>
   CreateProcess (
<P><PRE>      NULL,
      "OS2.EXE /S /P &lt;full path to exe&gt; /C &lt;command line&gt;",
      . . .
      );
</PRE><P>
   The &lt;command line&gt; includes the name of the executable. For example:
<P>
<P><PRE>      CreateProcess (
<PRE></PRE>         NULL,
         "OS2.EXE /S /P C:\\OS2BINS\\LS.EXE /C LS *.c",
         . . .
         );

</PRE></UL>In either case, you must make sure that the first OS/2 application started
after booting your system is the one you want to run as a service.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The OS/2 Subsystem automatically shuts down when a user logs off. Using the
/S switch on the Os2.exe command line tells the OS/2 Subsystem that it is
running in the context of a service. The Subsystem then continues to run
across logons.
<P>
The reason the application must be the first OS/2 executable launched is
that if an OS/2 Subsystem server is present, it will be used rather than
starting a new one to run as a service.
<P>
Any OS/2 applications launched by the interactive user will still be
terminated upon logoff.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg kbhowto<BR>
KBSubcategory: BseService<BR>
Additional reference words: 3.50 4.00 os2 os2ss service<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
