

<HTML>
<HEAD>
<TITLE>PRB: Speech.h Does Not Work with the Borland C++ Compiler </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147123">
<META NAME="KBModify" CONTENT="1996/02/22">
<META NAME="KBCreate" CONTENT="1996/02/20">
<META NAME="Keywords" CONTENT="kb3rdparty kbmm kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Speech.h header file required to build applications written with the Microsoft Speech SDK version 1.0 is not compatible with the Borland C\C++ compiler at this time. However, it is compatible with Microsoft Visual C++ versions 2.2 and 4.0, as w...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVV,QAOT,QBH9,QBFY,QAVX,QAVW,QAWP,QAL3,QAY5,QAU3,QAMR,QAIC,QAJQ,QAJH,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Speech.h Does Not Work with the Borland C++ Compiler</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 22, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147123</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Speech Software Development Kit (SDK) version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Speech.h header file required to build applications written with the
Microsoft Speech SDK version 1.0 is not compatible with the Borland C\C++
compiler at this time. However, it is compatible with Microsoft Visual C++
versions 2.2 and 4.0, as well as the Symantec C++ version 7.2 compiler.
<P>
NOTE: Some products mentioned in this article are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft compilers support a 64-bit integer type, _int64. Borland does not
support this type. Also, Borland's compiler does not allow zero-length
arrays, which are used in the speech-recognition APIs.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
_int64 issue:
<P>
A workaround has been tried, which does seem to work, though its
effectiveness has not been rigorously verified.  To implement the
workaround, change the following line in Speech.h:
<P>
<PRE>   typedef unsigned _int64 QWORD, * PQWORD;

</PRE>to:
<P>
<PRE>   #ifdef __BORLANDC__
   typedef struct _tagQWORD {BYTE abData[8];} QWORD *PQWORD;
   #else
   typedef unsigned _int64 QWORD, *PQWORD;
   #endif //__BORLANDC__

</PRE>Zero length array issue:
<P>
Here's an example of the use of a zero length array as used in the
speech-recognition APIs:
<P>
<PRE>   typedef struct {
      DWORD    dwSize;
      DWORD    dwUniqueID;
      BYTE     abData[0];
   } SRCFGRULE, * PSRCFGRULE;

</PRE>This is not an absolutely blocking problem. Borland's compiler will compile
Speech.h if abData[0] is changed to abData[]. However, whether or not this
generates the same data structures as Microsoft compilers is unknown at
this time, so it is only a solution that is safe for making Speech.h
compile. Microsoft has not tested the structures beyond simple build tests
and can make no warranties about their effectiveness. The affected
structures include: SRCFGRULE, SRCFGIMPRULEW, SRCFGIMPRULEA, SRCFGXRULEW,
SRCFGXRULEA, SRCFGLISTW, SRCFGLISTA, SRWORDW, SRWORDA, SRPHRASEW,
SRPHRASEA, and SRCHUNK.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior demonstrates a design incompatibility between the two
products.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
These problems only affect the speech-recognition and text-to-speech APIs.
Voice-command and voice-text applications do not use QWORDs or the above-
named structures. Therefore, users of the voice-command and voice-text APIs
may make these changes, compile, and not worry about the results. If you
use the speech-recognition and text-to-speech APIs, you must test the
functions that use QWORDS rigorously to be sure that the values are coming
out properly, and you must check carefully to ensure that the structures
are being properly interpreted.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 SAPI VCMD VTXT SR TTS<BR>
KBCategory: kb3rdparty kbmm kbprb<BR>
KBSubcategory: MMSpeech<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 22, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
