

<HTML>
<HEAD>
<TITLE>FIX: Corruption of the Perflib Registry Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128404">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1995/04/02">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The Performance Monitoring tool can be affected by a corruption problem in the Perflib key. The following symptoms are evidence of this corruption problem:   - The explain text is not displayed.     -or-   - The objects and counters are not display...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAML,QAM9,QALX,QAUR,QAR4,QAPN,QAKD,QAKP,QALW,QBVV,QA5E,QAW6,QAVX,QAVW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Corruption of the Perflib Registry Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128404</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
3.50
WINDOWS NT
kbprg kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P>
<P><PRE>    - Microsoft Windows NT version 3.5
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Performance Monitoring tool can be affected by a corruption problem in
the Perflib key. The following symptoms are evidence of this corruption
problem:

<UL><LI>The explain text is not displayed.
<P>
   -or-

<LI>The objects and counters are not displayed.
<P>
   -or-

<LI>The explain text, objects, and counters are not displayed.
<P>
</UL><h2>CAUSE</h2>
 
<P>
When an .INI file, which contains an extra language entry not associated
with any specific objects and counters, is passed as a parameter to
LODCTR.EXE, the values of 'Last Counter' and 'Last Help' are set to zero.
This in turn causes the Performance Monitoring tool to fail.
<P>
The following is an example of a problem-causing .INI file:
<P>
<PRE>     [info]
     drivername=SampPerf
     symbolfile=sampperf.h

     [languages]
     009=English
     011=OtherLanguage  &lt;-- problem area

     [text]
     SampObj_009_Name=SampPerf
     SampObj_009_Help=A sample performance object.

     Count_1_009_Name=Tests/sec
     Count_1_009_Help=The number of tests completed.

</PRE>A further complication arises when a user attempts to rectify the situation
by executing UNLODCTR.EXE. At this point, because Last Counter and Last
Help are set to zero, UNLODCTR.EXE only resets '\009\HELP' and
<PRE>'\009\COUNTER' to NULL.

</PRE><h2>RESOLUTION</h2>
 
<P>
To resolve this corruption problem, you must restore the Registry to its
former state by using one of the following five methods:

<UL><LI>Backup and restore the local copy of the Registry by using Windows NT
   Backup.
<P>
   -or-

<LI>Copy and restore the data located in the %WINNT%\SYSTEM32\CONFIG
   directory. This can be done only if Windows NT was installed on a FAT
   partition.
<P>
   -or-

<LI>Save and restore the SOFTWARE registry hive.
<P>
   -or-

<LI>Save and restore the Registry values First Counter, First Help, Last
   Counter, and Last Help.
<P>
   -or-

<LI>Save and restore the Registry by using REGBACK.EXE and REGREST.EXE. Both
   programs are available with the Windows NT Resource Kit (RESKIT).
<P>
</UL>If the user ran UNLODCTR.EXE to attempt to fix the problem, you will also
need to restore \009\HELP and \009\COUNTER, which you can do by simply
rebooting the computer running Windows NT.
<P>
WARNING: The Registry is a vital part of Windows NT; improper modification
of its keys and values can cause Windows NT to malfunction.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. This problem was corrected in Windows NT
3.51.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.50<BR>
KBCategory: kbprg kbfixlist kbbuglist<BR>
KBSubcategory: BseMisc<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
