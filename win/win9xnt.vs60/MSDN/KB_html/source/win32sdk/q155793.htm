

<HTML>
<HEAD>
<TITLE>PRB: If Network Drive is not Available DLL Can't be Loaded </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q155793">
<META NAME="KBModify" CONTENT="1997/01/11">
<META NAME="KBCreate" CONTENT="1996/09/09">
<META NAME="Keywords" CONTENT="kbenv kbprb">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  The location of a dynamic-link library (DLL) is specified in the Path environment variable. In the Path environment variable, if a network path is defined before the path that contains the DLL, the following problem can occur.  For example, if you ...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIR,QAYL,QAVZ,QBW7,QAI5,QDNN,QBBI,QAB4,QAGI,QBWG,QAFI,QA1S,QAX1,QAAP,QAIF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: If Network Drive is not Available DLL Can't be Loaded</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q155793</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit for
<P><PRE>    - Microsoft Windows NT, versions 3.51 and 4.0
</UL></PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The location of a dynamic-link library (DLL) is specified in the Path
environment variable. In the Path environment variable, if a network path
is defined before the path that contains the DLL, the following problem can
occur.
<P>
For example, if you use the following path command, where  S:  is a network
drive:
<P>
Path=S:\;D:\Mydll or Path=\\franki\public;d:\Mydll
<P>
The process which loads the DLL does not have security access to the
network drive specified in the Path environment variable. When the
operating system searches for the DLL and comes across the inaccessible
network drive, the search ends instead of moving on to the next specified
path in the Path environment variable.
<P>
If the application is implicitly loading the DLL, you get the following
error message:
<P>
<PRE>   The application failed to initialize properly (0xc0000022). Click on
   OK to terminate the application.

</PRE>If the DLL is being explicitly loaded via the LoadLibrary or LoadLibraryEx
API call, the call fails with an error code 5 or Access denied.
<P>
<P><h2>CAUSE</h2>
 
<P>
When the operating system reaches the path environment variable, it
concatenates the DLL name to the path. For example, if the path is
<PRE> D:\Mydll  and the name of the DLL is Mydll.dll, the operating system tries
</PRE>to open up the file  D:\Mydll\Mydll.dll.  The CreateFile API call which is
used to open the file cannot distinguish between an Access denied error
caused by a process which cannot access a file versus a process which
cannot access the network drive that contains the file. Because this
distinction cannot be made, the operating system assumes that the file
exists but cannot be accessed by the process. This error causes the
operating system to discontinue the search for the DLL and assume that the
DLL cannot be accessed even though the DLL is located in one of paths
defined after the network drive.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbenv kbprb<BR>
KBSubcategory: BseDll BseSecurity<BR>
Additional reference words: 3.51 4.00 kbdss
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
