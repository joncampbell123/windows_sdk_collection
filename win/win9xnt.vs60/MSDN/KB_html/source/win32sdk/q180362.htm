

<HTML>
<HEAD>
<TITLE>INFO: Services and Redirected Drives </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180362">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1998/02/02">
<META NAME="Keywords" CONTENT="BseFileio BseSecurity BseService">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  A service should not use the WNetXXXXXXX APIs to remove or query any redirected drives not established by it. Although the WNetXXXXXXX APIs may return successfully, the results will be incorrect. Redirected drives are tracked by the system on a per...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGU,QBWP,QAM5,QAC9,QAI5,QAJQ,QAHN,QA5E,QAAD,QBW7,QA3Q,QAUD,QAHT,QACK,QA4B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Services and Redirected Drives</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180362</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Application Programming Interface (API) included with:
<P><PRE>    - Microsoft Windows NT version 4.0
</UL></PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A service should not use the WNetXXXXXXX APIs to remove or query any
redirected drives not established by it. Although the WNetXXXXXXX APIs may
return successfully, the results will be incorrect. Redirected drives are
tracked by the system on a per-user basis based on the user's Logon
Security Identifier (SID). Instead, processes running in different security
contexts that must share a remote resource should use the Universal Naming
Convention (UNC) name.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When the system establishes a redirected drive, it is stored on a per-user
basis. Only the user himself will be able to manipulate the redirected
drive. The system keeps track of redirected drives based on the user's
Logon SID. The Logon SID is a unique identifier for the user's Logon
Session. It is possible to have the same user logged on to the same
computer but have different logon sessions.
<P>
Drive letters are global to the system. All users on the system share the
letters A-Z. Each user does not get his or her own set of drive letters.
This means a user can access the redirected drives of another user as long
as he or she has proper security access.
<P>
If a user attempts to redirect a drive letter used by another user, such as
WNetAddConnection2(), the error ERROR_ALREADY_ASSIGNED will be returned.
Although the redirected drive is global to all users, only the user who
established it can manipulate it. Another example is if a user attempts to
remove or query information on a redirected drive established by a
different user. The APIs WNetGetConnection() and WNetCancelConnection2()
will return ERROR_NOT_CONNECTED.
<P>
If a user attempts to enumerate the list of redirected drives through
WNetOpenEnum() and WNetEnumResource(), the APIs only list redirected drives
established by that user. Drives redirected by other users will not be
visible.
<P>
Windows NT File Manager and Windows NT Explorer can see all the redirected
drives because they call GetDriveType() on each drive and they display an
icon for each drive found. Windows NT File Manager and Windows NT Explorer
create an icon for redirected drives created by all users because drive
letters are global to the system. However, the interactive user cannot use
Windows NT File Manager or Windows NT Explorer to disconnect the drive
because the drive was created by a different user.
<P>
If a service is running in the LocalSystem security context only that
Service or another process running in the LocalSystem account can call
WNetCancelConnection2() to disconnect the drive. Note that all processes
running in the LocalSystem account are running in the same logon session.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: mapped<BR>
Keywords          : BseFileio BseSecurity BseService<BR>
Version           : WINNT:4.0<BR>
Platform          : winnt<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
