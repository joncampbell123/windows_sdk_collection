

<HTML>
<HEAD>
<TITLE>PRB: ListView with LVS_NOSCROLL Won't Display Header </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137520">
<META NAME="KBModify" CONTENT="1995/09/30">
<META NAME="KBCreate" CONTENT="1995/09/28">
<META NAME="Keywords" CONTENT="kbprg kbui kbprb kbcode">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  In report view, the header control is not displayed for a ListView control created with the LVS_NOSCROLL style.  CAUSE =====  The ListView control positions the header control when the scrolling is updated. When the LVS_NOSCROLL style is specified,...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QA7O,QAOE,QAMN,QAY5,QAGI,QADK,QBV8,QAHV,QACI,QAB9,QBXR,QAIF,QAG4,QAF8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: ListView with LVS_NOSCROLL Won't Display Header</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137520</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) versions 3.51, 4.0
<LI>Microsoft Win32s version 1.3
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In report view, the header control is not displayed for a ListView control
created with the LVS_NOSCROLL style.
<P>
<P><h2>CAUSE</h2>
 
<P>
The ListView control positions the header control when the scrolling is
updated. When the LVS_NOSCROLL style is specified, the control is never
scrolled, so the header control is not positioned.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Call following function at the appropriate time to position the header
control properly. To use the function, create the ListView without the
LVS_NOSCROLL style, and then call this function whenever the ListView is
created, resized, the view is changed, or the parent window receives the
WM_SYSPARAMETERCHANGE message. Creating the control without the
LVS_NOSCROLL style will ensure that the first item in the list won't be
obscured by the header control. The function will automatically detect
which view is currently set and act appropriately.
<P>
<P>
<PRE>/***********************************************************************

   PositionHeader

   Call this function when the ListView is created, resized, the
   view is changed, or a WM_SYSPARAMETERCHANGE message is recieved

</PRE>***********************************************************************/
<P>
<PRE>void PositionHeader(HWND hwndListView)
</PRE>{
HWND  hwndHeader = GetWindow(hwndListView, GW_CHILD);
DWORD dwStyle = GetWindowLong(hwndListView, GWL_STYLE);
<P>
<PRE>/*
   To ensure that the first item will be visible, create the control
   without the LVS_NOSCROLL style and then add it here.
*/
</PRE>dwStyle |= LVS_NOSCROLL;
SetWindowLong(hwndListView, GWL_STYLE, dwStyle);
<P>
<PRE>/*
   Only do this if the ListView is in report view and you were able to
   get the header hWnd.
*/
</PRE>if(((dwStyle &amp; LVS_TYPEMASK) == LVS_REPORT) &amp;&amp; hwndHeader)
<PRE>   {
   RECT        rc;
   HD_LAYOUT   hdLayout;
   WINDOWPOS   wpos;

   GetClientRect(hwndListView, &amp;rc);
   hdLayout.prc = &amp;rc;
   hdLayout.pwpos = &amp;wpos;

   Header_Layout(hwndHeader, &amp;hdLayout);

   SetWindowPos(  hwndHeader,
                  wpos.hwndInsertAfter,
                  wpos.x,
                  wpos.y,
                  wpos.cx,
                  wpos.cy,
                  wpos.flags | SWP_SHOWWINDOW);

   ListView_EnsureVisible(hwndListView, 0, FALSE);
   }
</PRE>}
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 4.00 1.30<BR>
KBCategory: kbprg kbui kbprb kbcode<BR>
KBSubcategory: UsrCtl
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
