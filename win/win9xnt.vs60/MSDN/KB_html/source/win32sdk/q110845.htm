

<HTML>
<HEAD>
<TITLE>How Win32-Based Applications Are Loaded Under Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110845">
<META NAME="KBModify" CONTENT="1997/01/15">
<META NAME="KBCreate" CONTENT="1994/01/31">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Microsoft Win32s is an operating system extension that allows Win32-based applications to be run on Windows 3.1. Win32s consists of a VxD and a set of dynamic-link libraries (DLLs).  It is possible to distinguish whether an executable was built for...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QDL9,QBWQ,QAGI,QBWO,QBWN,QAJH,QAJQ,QDIV,QAC2,QAIJ,QBWS,QAIF,QAY5,QAML V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How Win32-Based Applications Are Loaded Under Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110845</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32s versions 1.0, 1.1, 1.2, 1.3
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Win32s is an operating system extension that allows Win32-based
applications to be run on Windows 3.1. Win32s consists of a VxD and a set
of dynamic-link libraries (DLLs).
<P>
It is possible to distinguish whether an executable was built for Win32 or
Win16. Win32 executables use the Portable Executable (PE) format, while
Win16 executables use the New Executable (NE) format.
<P>
The Windows 3.1 loader was designed to be aware that Win32-based
applications would potentially be loaded. When the user starts a
Win32-based application, the Windows 3.1 loader tries to load the
Win32-based application via WinExec(). WinExec() calls LoadModule(), which
will fail with an error indicating that it was passed an .EXE with the PE
format. At this point, WinExec() calls a special function to start up
Win32s. This function loads W32SYS.DLL (16-bit DLL) via LoadModule(). If
W32SYS determines that the EXE is indeed a valid PE file, it calls
LoadModule() on WIN32S.EXE (16-bit EXE) (it is similar to WinOldApp for MS-
DOS-based programs running in Windows). WIN32S.EXE contains the task
database, PSP, task queue, and module database. WIN32S.EXE calls its only
function to load the Win32s 16-bit translator DLL, W32S16.DLL, which does
work as a translator between the Win32-based application and the 16-bit
world that it is running in.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Win32-based applications are loaded in the upper 2 gigabytes (GB) of the 4
GB address space under Win32s, whereas Windows NT loads them in the lower 2
GBs. This is because W32S.386, a VxD, allocates the memory, and VxDs get
memory in the 2 GB to 4 GB range. The first 64K and the last 64K cannot be
read or written to (similar to a null page on other architectures).
<P>
On Windows 3.1, all applications, even the Win32-based applications, share
the same address space, unlike Windows NT where each Win32-based
application gets its own address space. Each Windows-based application may
be given its own address space, starting with Windows NT 3.5.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbprg<BR>
KBSubcategory: W32s<BR>
Additional reference words: 1.00 1.10 1.20 1.30 G byte<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
