

<HTML>
<HEAD>
<TITLE>INFO: Running a Windows-Based Application in its Own VDM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115235">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1994/05/22">
<META NAME="Keywords" CONTENT="BseProcThrd kbprg Subsys">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Under Windows NT, 16-bit Windows-based applications run as separate threads under a special environment called WOW (Windows on Win32). Under Windows NT version 3.1 and earlier, WOW supports running all 16-bit Windows-based applications in one virtu...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAJH,QBWS,QAIJ,QAM7,QAC2,QANE,QDL9,QBWQ,QBWO,QBWN,QBW5,QDIV,QBBI,QA3A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Running a Windows-Based Application in its Own VDM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115235</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) for Windows NT,
   versions 3.5, 3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Under Windows NT, 16-bit Windows-based applications run as separate threads
under a special environment called WOW (Windows on Win32). Under Windows NT
version 3.1 and earlier, WOW supports running all 16-bit Windows-based
applications in one virtual machine (VM). These applications share an
address space, just as they do on Windows. But under Windows NT version 3.5
through 4.0, WOW supports running a Windows-based application in its own
VM, which gives the application its own address space.
<P>
To programmatically start a Windows-based application in its own
VM, start the application with CreateProcess() and then specify the flag
CREATE_SEPARATE_WOW_VDM.
<P>
To specify a Win16 application started from the command prompt to run in
its own address space, use the following syntax:
<P>
<PRE>   start /SEPARATE &lt;filename&gt;

</PRE>To specify a shortcut in its own address space for a 16-bit application
started from the Program Manager, select the "Run in Separate Memory Space"
check box in the Shortcut tab of the Properties for the application. For
versions of Windows NT previous to 4.0, the same option is available in the
Properties for applications in Program Manager.
<P>
NOTE: This option is not the default, nor is there any way to make it
the default.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Allowing a 16-bit Windows-based application to run in a separate address
space provides for more robust operation, because the application is
isolated from other Windows-based applications. However, the downside is
twofold:

<UL><LI>WOW VMs require approximately 2500K of private memory on x86 machines.

<LI>There is no shared memory between WOW VMs. Therefore, 16-bit Windows-
   based applications that rely on shared memory cannot be run in separate
   VMs. As an alternative, use DDE or OLE, because they can be used by an
   application in one VM to communicate with an application in another VM.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: start ntvdm win31 sharing<BR>
Keywords            : BseProcThrd kbprg Subsys<BR>
Version             : 3.5 3.51 4.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
