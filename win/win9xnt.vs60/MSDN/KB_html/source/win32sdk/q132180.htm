

<HTML>
<HEAD>
<TITLE>Using Tabs with Initialization File APIs </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132180">
<META NAME="KBModify" CONTENT="1996/03/12">
<META NAME="KBCreate" CONTENT="1995/07/02">
<META NAME="Keywords" CONTENT="kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  Windows 95 does not support the use of the tab (that is, \t) character as part of the lpszString parameter of WritePrivateProfileString or WriteProfileString. In addition, GetPrivateProfileString does not return any characters in a key that occur a...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAVX,QAVW,QAGI,QARP,QBVV,QATX,QAH4,QBWP,QAY5,QAMB,QALW,QAYY,QDMW,QBBI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using Tabs with Initialization File APIs</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132180</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
This information applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Windows 95 does not support the use of the tab (that is, \t) character as
part of the lpszString parameter of WritePrivateProfileString or
WriteProfileString. In addition, GetPrivateProfileString does not return
any characters in a key that occur after a tab character.
<P>
This behavior is for backward compatibility with applications that assume
that comments are separated from entries by tabs.
<P>
NOTE: Windows NT does support the use of the tab character.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If a call made to either WritePrivateProfileString or WriteProfileString
that contains the tab character as part of the lpszString parameter, the
desired effect will not occur. Both of these functions will return TRUE
(that is, successful completion); however, any data that was to follow the
tab character will be missing. The newly created or modified key of the
.INI file will indicate the loss of data.
<P>
When using the GetPrivateProfileString API to retrieve a string from
a specified section in an .INI file, if the string is in the form:
<P>
<PRE>   lpszKey=ValuePart1 &lt;tab&gt; ValuePart2

</PRE>then GetPrivateProfileString returns ValuePart1, but does not return
ValuePart2 because of the tab.
<P>
<P><h3>Code to Demonstrate Behavior</h3>
 
<P>
The following code demonstrates this loss of data after a call to
WritePrivateProfileString:
<P>
<PRE>void main()
</PRE>{
<PRE>     char szBuf[200];

     if ( !WritePrivateProfileString("TEST",
           "TESTKEY",
           "Test String \t more text",
           "TEST.INI")  )
     {
           FormatMessage(
                FORMAT_MESSAGE_FROM_SYSTEM,
                NULL,
                GetLastError(),
                MAKELANGID(LANG_ENGLISH, SUBLANG_ENGLISH_US),
                szBuf,
                199,
                NULL );

           MessageBox(NULL, szBuf,
                 "Error calling WritePrivateProfileString",
                 MB_OK);
     }
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 95 4.00<BR>
KBCategory: kbenv<BR>
KBSubcategory: KrMisc<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
