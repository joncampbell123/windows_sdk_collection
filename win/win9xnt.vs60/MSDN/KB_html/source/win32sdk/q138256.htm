

<HTML>
<HEAD>
<TITLE>How to Reference Colors in a DIB Section by Index </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138256">
<META NAME="KBModify" CONTENT="1996/03/08">
<META NAME="KBCreate" CONTENT="1995/10/16">
<META NAME="Keywords" CONTENT="kbprg kbhowto kbcode">
<META NAME="KBArea" CONTENT="Support; KB; win32sdk">
<META NAME="Description" CONTENT="  When using the GDI with DIB sections (HBITMAPs returned by a call to CreateDIBSection()), you may need a way to reference the colors in the color table of the DIB section by index rather than by RGB value. This article shows you how.  MORE INFORMAT...">
<META NAME="Product" CONTENT="Win32 SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPG,QA28,QATJ,QAG9,QAH2,QAUD,QAKD,QBBI,QAD7,QAB3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Reference Colors in a DIB Section by Index</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 8, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138256</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Win32 Software Development Kit (SDK) versions 3.1, 3.5,
   3.51, 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using the GDI with DIB sections (HBITMAPs returned by a call to
CreateDIBSection()), you may need a way to reference the colors in the
color table of the DIB section by index rather than by RGB value. This
article shows you how.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To reference a color table value by index, use the DIBINDEX macro defined
in Mmsystem.h. It allows you to index the colors in the color table of a
DIB section in a manner similar to the way PALETTEINDEX indexes a color in
a logical palette. In other words, you can create COLORREFs that reference
a DIB section's color table rather than the logical palette in the DC that
the DIB section is selected into. Because DIBINDEX references values in a
color table, it only works on DCs where you have a DIB section selected.
<P>
The DIBINDEX macro accepts an index to a color table entry and returns a
color table specifier consisting of a 32-bit COLORREF value that specifies
the color associated with the given index. An application using a display
context with a DIB section selected into it can pass this specifier,
instead of an explicit red, green, blue (RGB) value, to GDI functions that
expect a color. This allows the function to use the color at the specified
color table index.
<P>
LONG DIBINDEX(
<PRE>    WORD  wColorTableIndex    // index to color table entry
   );

</PRE>Parameters
<PRE>  wColorTableIndex - Specifies an index to the palette entry containing
                     the color to be used for a graphics operation.

</PRE>Return Value
<PRE>  The return value is a color table index specifier.

</PRE>Remarks
<PRE>  DIBINDEX is defined as:

  #define DIBINDEX(n)     MAKELONG((n),0x10FF)

</PRE>NOTE: DIBINDEX also works with 16-bit WinGBitmaps and WinGDCs.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 3.10 3.50 4.00 Windows 95 COLORTABLE HBITMAP<BR>
BRUSH COLORREF PEN  DIBSECTION<BR>
KBCategory: kbprg kbhowto kbcode<BR>
KBSubcategory: W32<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 8, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
