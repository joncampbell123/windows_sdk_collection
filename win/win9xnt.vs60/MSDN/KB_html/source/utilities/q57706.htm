

<HTML>
<HEAD>
<TITLE>LINK Uses Library Sequence to Resolve External References </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q57706 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1990/01/12">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  The  MS-DOS Encyclopedia  (Microsoft Press) includes the following statement on pages 407 and 408:     When a public symbol required to resolve an external reference is    declared more than once among the object modules in the input    libraries, ...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBHQ,QBE6,QBE7,QAH4,QAGI,QBFY,QAB3,QAE2,QAB7,QAIF,QAWM,QAPN,QAE5,QAX6,QBXA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>LINK Uses Library Sequence to Resolve External References</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q57706 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.x 3.x 4.x 5.0x 5.1x 5.2x 5.3x 5.50 5.60 | 5.0x 5.10 5.11 5.13 5.15
<PRE>MS-DOS                                    | OS/2
</PRE>kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft LINK for MS-DOS, versions 2.x, 3.x, 4.x, 5.0x, 5.1x,
   5.2x, 5.3x, 5.5, and 5.6
<LI>Microsoft LINK for OS/2, versions 5.0x, 5.1, 5.11, 5.13, and 5.15
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "MS-DOS Encyclopedia" (Microsoft Press) includes the following
statement on pages 407 and 408:
<P>
<PRE>   When a public symbol required to resolve an external reference is
   declared more than once among the object modules in the input
   libraries, LINK uses the first object module that contains the
   public symbol. This means that the actual executable code or data
   associated with a particular external reference can be varied by
   changing the order in which LINK processes its input libraries...

   Each individual library is searched repeatedly (from first library
   to last, in the sequence in which they are input to LINK) until no
   further external references can be resolved.

</PRE>The text below provides additional information about this process.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
As an example, consider the application illustrated by the diagram
below:
<P>
<PRE>   Module MAIN   Library A     Library B1    Library C     Library B2
   +---------+  +----------+  +----------+  +----------+  +----------+
   | calls A |  | contains |  | contains |  | contains |  | contains |
   +---------+  |    A,    |  |    B     |  |    C,    |  |    B     |
                | calls  C |  +----------+  | calls  B |  +----------+
                +----------+                +----------+

</PRE>Microsoft LINK determines which copy of Module B the application uses
depending on the sequence in which the user specifies the libraries on
the linker command line. For example, calling the linker with the
following command line selects Module B from Library B2:
<P>
<PRE>   LINK MAIN,,,A B1 C B2;

</PRE>The linker searches Library C first. If it cannot resolve the
reference, it continues on to search Library B2. If it still cannot
resolve the reference, it returns only then to search Library A and
Library B1 to finally resolve the reference.
<P>
For a slightly more complex situation, consider the case in which
Library contains Module A and Module B, as the diagram below
illustrates:
<P>
<PRE>   Module MAIN   Library A    (remove B1)   Library C     Library B2
   +---------+  +----------+               +----------+  +----------+
   | calls A |  | contains |               | contains |  | contains |
   +---------+  |    A,    |               |    C,    |  |    B     |
                | calls  C |               | calls  B |  +----------+
                +----------+               +----------+
                | contains |
                |    B     |
                +----------+

</PRE>With the following command line, the linker selects Module B from
Library A:
<P>
<PRE>   LINK MAIN,,,A C B2;

</PRE>Even though the linker always resolves module names using the same
rules, as the cases become more complex, it becomes increasingly
difficult to determine which version of a module the linker selects.
Where feasible, you can avoid this problem by placing the appropriate
version of a module into an OBJ file instead of a library. The linker
resolves references in OBJ files before it resolves references in
libraries.
<P>
For more information, please refer to article 20 in the "MS-DOS
Encyclopedia," "The Microsoft Object Linker" in the "Object Module Order"
section, pages 703-706. Note, however, that this book is currently out of
print.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.08 1.10 2.00 2.01 2.10 2.40 2.41 2.44<BR>
2.50 3.00 3.01 3.02 3.04 3.05 3.06 3.51 3.55 3.60 3.61 3.64 3.65 3.69<BR>
4.06 4.07 4.10 5.01.20 5.01.21 5.02 5.03 5.05 5.10 5.11 5.13 5.15 5.20<BR>
5.30 5.31.009 5.50 library search order<BR>
KBCategory: kbtool<BR>
KBSubcategory: LinkIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
