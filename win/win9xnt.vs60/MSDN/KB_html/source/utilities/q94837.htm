

<HTML>
<HEAD>
<TITLE>PWB Extension Converts Selected Text to Uppercase Letters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94837 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1993/01/19">
<META NAME="Keywords" CONTENT="kb16bitonly">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT="  The text below demonstrates the process to create a Programmer's WorkBench (PWB) extension to convert one selected line of text to uppercase. Note that nothing appears to happen if the cursor is on a different line than the selected line.  MORE INF...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAGX,QA4B,QALX,QAGC,QA2Q,QATX,QAHE,QAI4,QBXT,QA5V,QAOG,QAMB,QAIB,QAH4,QALW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PWB Extension Converts Selected Text to Uppercase Letters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94837 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.10 2.00 | 1.00 1.10
<PRE>MS-DOS         | OS/2
</PRE>kbtool kbcode
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Programmer's WorkBench for MS-DOS, versions 1.0, 1.1, 2.0
<LI>Microsoft Programmer's WorkBench for OS/2, versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The text below demonstrates the process to create a Programmer's WorkBench
(PWB) extension to convert one selected line of text to uppercase. Note
that nothing appears to happen if the cursor is on a different line than
the selected line.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To load and use the extension, perform the following five steps:

<OL><P><LI>Copy REVERSE.MXT into the same directory as PWB. By default on an MS-DOS
   system, this is the BIN subdirectory. By default on an OS/2 system, this
   is the BINP subdirectory.

<P><LI>Modify the TOOLS.INI file to place a load command in the [PWB] section.
   For example,
<P>
<P><PRE>      [pwb]
<PRE></PRE>          load:[path\]reverse

</PRE><P><LI>Start the PWB editor.

<P><LI>Select the text to convert to uppercase letters. The selection must be
   on one line.

<P><LI>From the Case menu, select Lower to Upper.
<P>
</OL>The source code for this PWB extension is as follows.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>/*
 * Compile options needed:  cl /c /Gs /ACw reverse.c
 *                          link exthdr test, reverse.mxt;
 */

#define  BUF_LEN  250
#define  TRUE     1
#define  FALSE    0

#include &lt;ext.h&gt;
#include &lt;string.h&gt;
#include &lt;ctype.h&gt;


</PRE></OL>PWBFUNC ToUpper(unsigned argData, ARG _far *pArg, flagType fMeta);
struct swiDesc swiTable[] =
{
<PRE>   {"ToUpper", toPIF(ToUpper), SWI_BOOLEAN},
   { NULL, NULL, 0}
</PRE>};
<P>
struct cmdDesc cmdTable[] =
{
<PRE>   {"ToUpper", ToUpper, 0, STREAMARG},
   {NULL, NULL, 0, 0}
</PRE>};
<P>
<PRE>void EXTERNAL WhenLoaded(void)
</PRE>{
<PRE>   int hmatch;
   hmatch = AddMenu("~Case", "xxxx", "", TRUE);
   AddMenuItem(hmatch, "~Lower to Upper", "Case switch", NULL, "ToUpper");
</PRE>}
<P>
PWBFUNC ToUpper(unsigned argData, ARG _far *pArg, flagType fMeta)
{
<PRE>   LINE    ycurr, ystart, yend;
   COL     xcurr, xstart, xend;
   char    buf[BUF_LEN + 1];
   PFILE   pfile;
   int     i;
   int     maxlines;

   switch (pArg-&gt;argType)
      {
   case STREAMARG:
      // The following code retrieves the corners
      // of the stream for future use
      ystart = pArg-&gt;arg.streamarg.yStart;
      yend = pArg-&gt;arg.streamarg.yEnd;
      xstart = pArg-&gt;arg.streamarg.xStart;
      xend = pArg-&gt;arg.streamarg.xEnd;
      pfile = FileNameToHandle("", "");
      maxlines = FileLength(pfile);
      ycurr = ystart;
      xcurr = xstart;

      // Read the argument
      pfile = FileNameToHandle("","");
      GetLine(ystart, buf, pfile);

      // Convert to uppercase letters
      for ( ; xcurr &lt; xend ; xcurr++)
         buf[xcurr] = toupper(buf[xcurr]);

      // Output converted argument
      PutLine(ystart, buf, pfile);
      break;

   default:
      DoMessageBox("Default", buf, NULL, MBOX_OK, 0);
      break;
      }
</PRE>}
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 1.00 1.10 2.00  PWBIss<BR>
KBCategory: kbtool kbcode<BR>
KBSubcategory: PWBIss<BR>
Keywords            : kb16bitonly<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
