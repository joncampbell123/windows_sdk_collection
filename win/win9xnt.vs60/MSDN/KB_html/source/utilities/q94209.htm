

<HTML>
<HEAD>
<TITLE>Profiling an Application in Microsoft Windows </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94209 ">
<META NAME="KBModify" CONTENT="1997/07/17">
<META NAME="KBCreate" CONTENT="1992/12/29">
<META NAME="Keywords" CONTENT="kb16bitonly TlsMisc kbtool">
<META NAME="KBArea" CONTENT="Support; KB; utilities">
<META NAME="Description" CONTENT=" The information in this article is included in the documentation starting with Visual C++ 5.0. Look there for future revisions.   Version 1.2 of the Microsoft Source Profiles includes two executable files: PROFILE.EXE and PROFILEW.EXE. PROFILEW.EXE ...">
<META NAME="Product" CONTENT="Programming Utilities">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QANE,QBWS,QAB9,QBV8,QDJ2,QAJH,QAK6,QAH4,QAY5,QBJZ,QBXB,QBFY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Profiling an Application in Microsoft Windows</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94209 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00 1.20 1.30
WINDOWS
kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Source Profiler for Windows, versions 1.0, 1.2, and 1.3
</UL> 
<P>
The information in this article is included in the documentation starting
with Visual C++ 5.0. Look there for future revisions.
<P>
<P><h2>SUMMARY</h2>
 
<P>
Version 1.2 of the Microsoft Source Profiles includes two executable
files: PROFILE.EXE and PROFILEW.EXE. PROFILEW.EXE is a Microsoft
Windows-hosted source profile utility that can run from the command
line or from an icon in the Microsoft Windows operating system. The
names of batch files used to profile a Windows-based application end
with the letter "W." Run these batch files from the MS-DOS prompt
because each one starts Windows. You also can profile a Windows-based
application in Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The text below provides the steps to profile function timing in the
GENERIC sample application provided with the Microsoft Windows
Software Development Kit (SDK). The explanation assumes that the
GENERIC sample is installed in the C:\WINDEV\GUIDE\GENERIC directory
and that the Source Profiler is installed in the C:\PROFILER\BIN
directory. The procedure has three main steps, as follows:

<OL><P><LI>Create the PCF file and run PREP.
</OL>2. Create an icon for profiling and profile the application.
3. Create an output file with PREP and PLIST.
<P>
<P><h3>Create the PCF and Run PREP</h3>
 
<P>
The PCF (Profiler Command File) provides greater control to select the
parts of the executable program to profile. The PCF is optional and is
not necessary to collect statistics about all functions of the
application.
<P>
With the following PCF, the profiler collects statistics only for the
main window procedure and for the About dialog box procedure in
GENERIC. For more information on PCFs, see chapter 4 of the Source
Profiler "User's Guide." Place the following text into the GENERIC.PCF
file:
<P>
<PRE>   FPROFILE TIME
   PROGRAM  GENERIC.EXE DELETE
   OBJECT   GENERIC.OBJ
   FUNCTION MainWndProc ADD  # Note: function names are case sensitive
   FUNCTION About ADD

</PRE></OL>To use this file, perform the following three steps:

<OL><P><LI>Place the GENERIC.PCF file into the same directory as the source
   code for the GENERIC sample.

<P><LI>Build the GENERIC sample with debugging information (specify the
   /Zi compiler option switch and the /CO linker option switch).

<P><LI>Use the following command line to run the PREP utility:
<P>
<P><PRE>      PREP /P GENERIC.EXE /OT GENERIC.PBT /OI GENERIC.PBI GENERIC.PCF
</PRE><P>
</OL>For more information about the PREP utility, see Appendix A of the
Source Profiler "User's Guide."
<P>
You can place the PREP command into the makefile that builds profiling
versions of your application. Run the PREP utility after building the
executable file.
<P>
<P>
<P><h3>Create an Icon for Profiling and Profile the Application</h3>
 
<P>
Perform the following seven steps:

<OL><P><LI>In the Microsoft Windows Program Manager, activate a program group.

<P><LI>Choose New from the File menu.

<P><LI>Choose OK to create a new program item.

<P><LI>In the Properties dialog box, enter the following text in the
   Command Line field:
<P>
<P><PRE>      PROFILEW C:\WINDEV\GUIDE\GENERIC\GENERIC.EXE
</PRE><P>
   Note: This command line assumes that the PBI and PBO files are
   named GENERIC.PBI and GENERIC.PBO, respectively, and that each
   resides in the C:\WINDEV\GUIDE\GENERIC directory.

<P><LI>In the Working Directory field, enter the path to the PROFILEW.EXE
   file. In this example, the correct directory is C:\PROFILEW\BIN.

<P><LI>Choose OK to create the program icon.

<P><LI>To run and profile GENERIC, either double-click the icon or select
   the icon and choose Run from the File menu. Close GENERIC to
   complete profiling.
<P>
<P>
</OL><h3>Create an output File with PREP and PLIST</h3>
 
<P>
Perform the following two steps:

<OL><P><LI>At the MS-DOS prompt, enter the following command to update the PBT
   file:
<P>
<P><PRE>      PREP /IT GENERIC.PBT /IO GENERIC.PBO /OT GENERIC.PBT
</PRE>
<P><LI>At the MS-DOS prompt, enter the following command to create an
   output text file:
<P><PRE>      PLIST GENERIC.PBT &gt; GENERIC.TXT
</PRE><P>
</OL>For more information about the PLIST utility, see Appendix A of the
Source Profiler "User's Guide."
<P>
Even though GENERIC.TXT lists all the functions in the GENERIC
application, it contains timing and hit statistics for only the
About() and MainWndProc() functions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory: TlsMisc<BR>
Additional reference words: 1.00 1.20 1.30<BR>
Keywords            : kb16bitonly TlsMisc kbtool<BR>
Version             : 1.00 1.20 1.30<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
