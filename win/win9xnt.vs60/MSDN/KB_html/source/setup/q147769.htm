

<HTML>
<HEAD>
<TITLE>INFO: RegClean 4.1a Description and General Issues </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147769">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1996/02/29">
<META NAME="Keywords" CONTENT="APrgOther vb432 vb4all">
<META NAME="KBArea" CONTENT="Support; KB; setup">
<META NAME="Description" CONTENT="  When you install, uninstall, and reinstall programs on your computer, registry keys are created, modified, or deleted. Over time, your computer's registry may begin to contain corrupted, unused, and unnecessary registry keys, especially if keys are...">
<META NAME="Product" CONTENT="Setup">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDOM,QAR4,QAGC,QA01,QAA1,QBWS,QBXS,QAKP,QAXB,QAC1,QAAP,QDL9,QBWO,QBWN,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: RegClean 4.1a Description and General Issues</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147769</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows NT Workstation and NT Server, version 3.51 (SP 5)
   and higher
<LI>Microsoft Exchange, all versions
<LI>Microsoft Internet Explorer, version 3.0 and higher
<LI>Microsoft Office, all versions
<LI>Microsoft Outlook, all versions
<LI>Microsoft Word for Windows, all versions
<LI>Microsoft FrontPage, all versions
<LI>Microsoft Excel, all versions
<LI>Microsoft Access, all versions
<LI>Microsoft Visual C++, all versions
<LI>Microsoft Visual Basic, version 4.0 and higher
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you install, uninstall, and reinstall programs on your computer,
registry keys are created, modified, or deleted. Over time, your computer's
registry may begin to contain corrupted, unused, and unnecessary registry
keys, especially if keys are not removed when you uninstall a program. As a
result, you may begin to experience problems when using OLE to embed
objects or Automation to control other programs.
<P>
The RegClean utility is designed to clean up unnecessary registry entries
in your registry.
<P>
The RegClean utility that was originally supplied with Microsoft Visual
Basic, version 4.0 for Windows and the Microsoft Office 97 Resource Kit
hasbeen updated. The current version is 4.1a.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P>
<P><h3>How To Install</h3>
 
<P>
Copy version 4.1a build 7364.1 of RegClean.exe to any folder on your
machine.
<P>
<P><h3>How To Run</h3>
 

<OL><P><LI>Double-click the RegClean icon. RegClean starts by displaying a progress
   dialog box. While this is shown, it RegClean loads a copy of the parts
   of the registry that it is going to check, and perform the actual
   scanning. Depending on how much information is in the registry and the
   speed of your CPU, this will take anywhere from about 30 seconds to 30
   minutes.
<P>
   If you have many entries in your registry, there may be times when
   RegClean appears to have stopped working. In fact, RegClean may appear
   completely halted whenever it is checking remote or removable drives.

<P><LI>Once these progress meters are gone, you will be prompted for the next
   action. You can do two things at this point:
<P>
   - Exit RegClean. If RegClean did not find any errors in your registry,
<P><PRE>     or, if you do not want RegClean to fix the errors that it found, click
     the Cancel button.
</PRE><P>
   - Allow RegClean to fix the errors that it found. Clicking the Fix
<P><PRE>     Errors button causes RegClean to remove the entries containing errors
     that RegClean found in the registry. You will see a progress meter
     while RegClean does this. Sometimes, the progress meter may stop
     momentarily, but it should resume after a few seconds. When the meter
     is gone, RegClean is done. Click Exit to end RegClean.
</PRE><P>
</OL>Clicking the Fix Errors button also creates an Undo.reg file in the folder
where RegClean was run. The file will be titled “UNDO computer
yyyymmddhhmmss.REG,” where computer is the name of your machine, yyyymmdd
is the date, and hhmmss is the time. If at any point you would like to
"undo," or put back what RegClean removed from your registry, double-click
the Undo.reg file.
<P>
The RegClean utility is available for downloading free of charge.
<P>
The following file is available for download from the Microsoft Software
Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/regclean.exe">RegClean.exe</A> <I>(size: 837632 bytes)</I> 

</PRE></OL>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>  ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
  TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h3>What RegClean Does</h3>
 
<P>
RegClean analyzes Windows Registry keys that are stored in a common
location in the Windows Registry. It finds keys that contain erroneous
values, and after recording those entries in an UNDO.REG file, it removes
them from the Windows Registry.
<P>
<P><h3>What RegClean Does Not Do</h3>
 
<P>
RegClean does not fix every known problem with the registry. It does not
fix a "corrupt" registry; it fixes only problems with some of the entries
that are in a normal registry.
<P>
It is very possible that RegClean will not correct a problem that you have
encountered. RegClean will leave any entries in the registry that it does
not understand or could possibly be correct.
<P>
<P>
<P><h3>General Issues</h3>
 

<UL><LI>Oleaut32.dll
<LI>Doesn't solve problems/makes new problems
<LI>Cannot undo the reg file
<P>
</UL><h2>FIX: REQUIRES UPDATED OLEAUT32</h2>
 
<P>
This error occurred with an earlier version of RegClean. In order for
RegClean to work, you must have the updated version of the OLEAUT32.dll. If
your system has Internet Explorer version 2.0 or lower, installing Internet
Explorer version 3.0 or higher will update the OLEAUT32.dll. If you are
using Microsoft Windows NT 3.51 with SP 4 or lower, you will need to
install SP 5 in order to update the OLEAUT32.dll. These files are also
available for download below. If you experience the below symptoms when
using RegClean 4.1a, please follow the resolution instructions.
<P>
<P><h3>Symptoms</h3>
 
<P>
Two messages boxes appear. One box says the following:
<P>
<PRE>   RegClean.exe is linked to missing export OLEAUT32.DLL:421

</PRE>The next message box says the following:
<P>
<PRE>   A device attached to the system is not correctly functioning

</PRE><h3>Resolution</h3>
 
<P>
You need to install the update to the OLE Automation system libraries.
These files are contained in the executable Oadist.exe, which is included
in the download. (NOTE: If you are using Window NT 3.51, you must use
Oadist2z.exe instead; read the Knowledge Base article mentioned below.)
<P>
Alternately, you can find these files at either of the following locations:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/kb/articles/q164/5/29.asp">http://support.microsoft.com/support/kb/articles/Q164/5/29.asp</A></B>

   -or-

   <B><A href="ftp://ftp.microsoft.com/softlib/mslfiles/oadist.exe">ftp://ftp.microsoft.com/Softlib/MSLFILES/oadist.exe</A></B>
   <B><A href="ftp://ftp.microsoft.com/softlib/mslfiles/oadist2z.exe">ftp://ftp.microsoft.com/Softlib/MSLFILES/oadist2z.exe</A></B>

</PRE>You can use most Web browsers to download this file from either location.
This file is also on the Microsoft Download Library BBS.
<P>
<P><h3>More Information</h3>
 
<P>
Oadist.exe is a self-extracting Cabinet that will install the Automation
libraries on your system. You just need to download the file Oadist.exe and
double-click to run it. It will prompt you to be sure that you want to
proceed. Answering "yes" will update the Automation libraries on your
computer.
<P>
This self-extracting Cabinet only works on Windows NT 4.0 and Windows 95.
If you are on Windows NT 3.51, you will need to get Oadist2z.exe instead,
which is still being published. Both contain the same files.  However, the
Oadist2z.exe is a self- extracting ZIP file with a Readme.txt file that
contains installation instructions.

<UL><LI>Oadist.exe is 490096 bytes.
<LI>Oadist2z.exe is 559499 bytes.
<P>
</UL>PROBLEM: IT DOESN'T SOLVE MY REGISTRY PROBLEMS
OR IT JUST CREATES MORE PROBLEMS
 
<P>
(status updated: December 30, 1997)
<P>
Running RegClean may, in a few cases, cause other problems, such as causing
part of the Microsoft Network viewer to stop functioning, or causing other
programs to stop functioning. If this happens to you, simply Undo the
changes RegClean made, by double-clicking on the last UNDO.REG file.
<P>
These types of problems are very rare, but it's a good idea to keep your
last UNDO.REG file for a few days or so.
<P>
Microsoft will continue improving RegClean to reduce the frequency of
problems like these.
<P>
<P>
<P><h2>PROBLEM: CANNOT UNDO THE UNDO.REG FILE</h2>
 
<P>
(status updated: March 18, 1997)
<P>
<P><h3>Symptom</h3>
 
<P>
Windows displays several error message boxes when you try to double-click
the Undo.reg file to undo the changes RegClean made.
<P>
<P><h3>Resolution</h3>
 
<P>
This problem is unrelated to RegClean.  It's a problem with the Associated
Program for .reg files.
<P>
Use the following steps to correct this problem:

<OL><P><LI>Go to any Explorer window, click the View menu, and select
   Options.

<P><LI>In the Options dialog box, select the File Types tab.

<P><LI>Scroll down in the "Registered file types:" list until you find the
   entry called "Registration Entries."

<P><LI>Double-click this item or click on the Edit button.

<P><LI>In the Edit File Type dialog box, select the "Merge" entry, and either
   double-click this item or click on the Edit button.

<P><LI>In the "Editing action for type: Registration Entries" dialog box, make
   sure that the text in the "Application used to perform action:" field
   has the following entry, including the double quotes:
<P>
<P><PRE>      regedit.exe "%1"
</PRE>
<P><LI>Click the OK buttons to dismiss all three dialog boxes.

<P><LI>You should be able to double-click on the Undo.reg file now.
<P>
<P>
</OL>Thanks for using RegClean! We hope you find this utility useful.

<UL><LI>The RegClean Team
<P>
</UL> 
<P>
REGCLEAN IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND. MICROSOFT
DISCLAIMS ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR ANY
DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL, CONSEQUENTIAL,
LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF MICROSOFT CORPORATION
OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. SOME
STATES DO NOT ALLOW THE EXCLUSION OR LIMITATION OF LIABILITY FOR
CONSEQUENTIAL OR INCIDENTAL DAMAGES SO THE FOREGOING LIMITATION MAY NOT
APPLY.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: registry clean update<BR>
Keywords          : APrgOther vb432 vb4all<BR>
Technology        : kbole<BR>
Version           : 4.1a build 7364.1<BR>
Platform          : NT WINDOWS<BR>
Issue type        : kbinfo<BR>
Solution Type     : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
