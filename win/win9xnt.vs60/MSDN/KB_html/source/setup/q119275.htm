

<HTML>
<HEAD>
<TITLE>Setup Error: Setup Cannot Update an Installation in Batch Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119275">
<META NAME="KBModify" CONTENT="1996/12/16">
<META NAME="KBCreate" CONTENT="1994/08/11">
<META NAME="Keywords" CONTENT="kbsetup kbnetwork kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; setup">
<META NAME="Description" CONTENT="...">
<META NAME="Product" CONTENT="Setup">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QDIZ,QAB4,QDNQ,QDKX,QAXB,QAEF,QBWS,QAJH,QDL9,QBWQ,QBWO,QBWN,QA5W V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Setup Error: Setup Cannot Update an Installation in Batch Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119275</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Office for Windows, versions 4.2, 4.3
<LI>Microsoft PowerPoint for Windows, versions 4.0, 4.0a
<LI>Microsoft Word for Windows, version 6.0
<LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Access for Windows, version 2.0
<LI>Microsoft Project for Windows, version 4.0
 ---------------------------------------------------------------------
<P>
</UL><h2>SYMPTOMS</h2>
 
<P>
When you perform a "silent" installation (by using the SETUP /Q command) of
any of the applications listed at the beginning of this article, the
following error message is displayed
<P>
<PRE>   Setup cannot update an installation in batch mode (/Q)

</PRE>or
<P>
<PRE>   Setup cannot update an installation interactively in quiet mode

</PRE>followed by:
<P>
<PRE>   Processing Top Level information failed

</PRE>When you choose OK, the following message may be displayed
<P>
<PRE>   &lt;application&gt; Setup was not completed successfully

</PRE>where &lt;application&gt; is the name of the application for which you attempted
to run a silent installation.
<P>
<P><h2>CAUSE</h2>
 
<P>
You can use the /Q switch only when you perform a new installation of an
application. That is, you will receive the above error messages if you
attempt to perform a silent mode installation of an application if that
application is already installed on the workstation.
<P>
<P><h2>WORKAROUNDS</h2>
 
<P>
To avoid receiving these error messages, follow the appropriate procedure
below.
<P>
Method 1: To perform a maintenance-mode installation such that you can
<PRE>          manually select the components you want to add or remove, do the
          following:

          a. From the File menu in Program Manager, choose Run.

          b. In the Command Line box, type the following

                &lt;x&gt;:\setup

             where &lt;x&gt; is the drive containing the Setup program for the
             application from which you want to remove or to which you want
             to add components.

</PRE>Method 2: To run a maintenance-mode installation based on a script:
<P>
<PRE>          a. Run the Installation Maintenance program and select Remove All
             to remove the application from your system.

          b. Run Setup again using a script.

</PRE>Method 3: To perform a new installation on a system which has one
<PRE>          of the applications above already installed, do the following:

          a. Make a backup copy of the WIN.INI file.

          b. Open WIN.INI in a text editor.

          c. Search for the section that contains the word "ACME".
             The title of the section is [MS Setup (ACME) Table Files].

          d. This section contains a path to the SETUP.STF file for
             the application. Remark out the line that refers to
             SETUP.STF by placing a ";" (semi-colon) at the beginning
             of the line. Change the line:

             MSOFFICE.EXE@v4.3.0.1027(1033)=C:\MSOFFICE\SETUP\SETUP.STF

             -to-

             ;MSOFFICE.EXE@v4.3.0.1027(1033)=C:\MSOFFICE\setup\setup.stf

          e. Save the WIN.INI file and exit your text editor.

          f. Restart SETUP.


</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>PowerPoint</h3>
 
<P>
Page 212 of the PowerPoint "User's Guide," version 4.0, lists the different
types of installations with which you can use a "silent" installation:
Typical, Complete/Custom, Laptop, and Workstation. If you run SETUP /Q,
Setup uses whichever of these four types of installation is designated as
the default in the SETUP.STF file.
<P>
A fifth type of installation, Installation Maintenance, is not included
because it is designed to interact with the user to reconfigure the
installed components. After you have installed PowerPoint 4.0, all
subsequent installations on the same system are Installation Maintenance
installations.
<P>
<P><h3>How the WIN.INI is Involved</h3>
 
<P>
When Setup is run, it looks in the [MS Setup (ACME) Table Files] section of
the WIN.INI to see if there is a path to an STF. If it finds one, it enters
the existing STF at the Maintenance Mode Root ID and you get maintenance
mode setup. If it does not find an entry, or it can't find the resulting
STF file, it creates a new STF and enters from the appropriate (non-
maintenance) Root ID.
<P>
<P><h3>General Information</h3>
 
<P>
For more information about custom installation scripts, order Application
Note WC1046, "How to Create a Custom Installation Script." For additional
information, please see the following article(s) in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q119357.htm">Q119357</A></B>
   TITLE     : AppNote: "How to Create a Custom Installation Script"
               (WC1046)
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbnetwork kberrmsg<BR>
KBSubcategory:
<P>

Additional reference words: 1.0 1.00 2.00 4.00 4.00a 4.20 4.30 5.00 6.00<BR>
quiet powerpoint powerpt office word excel acmsetup.exe maintenance mode
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
