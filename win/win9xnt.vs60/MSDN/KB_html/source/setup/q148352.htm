

<HTML>
<HEAD>
<TITLE>General Troubleshooting Steps to Use If Installation Fails </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148352">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1996/03/11">
<META NAME="Keywords" CONTENT="kbsetup kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; setup">
<META NAME="Description" CONTENT="  This article contains troubleshooting steps you can use if Setup fails when you run the Setup program from a floppy disk or Compact Disc.  MORE INFORMATION  TEST FOR DAMAGED DISK  To test for a damaged disk or malfunction of the disk drive, use the...">
<META NAME="Product" CONTENT="Setup">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QBWO,QDI2,QDL9,QBWN,QBWQ,QBFY,QANE,QAFI,QAC9,QABI,QAB4,QDIZ,QBWS,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>General Troubleshooting Steps to Use If Installation Fails</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148352</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Excel for Windows, version 5.0
<LI>Microsoft Office for Windows, versions 4.0, 4.2, 4.3
<LI>Microsoft PowerPoint for Windows, version 4.0
<LI>Microsoft Word for Windows, versions 6.0, 6.0a
<LI>Microsoft Access for Windows, version 2.0
<LI>Microsoft Project for Windows, version 4.0
<LI>Microsoft Works for Windows, version 3.0
<LI>Microsoft Golf, version 2.0
<P>
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article contains troubleshooting steps you can use if Setup fails when
you run the Setup program from a floppy disk or Compact Disc.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h2>TEST FOR DAMAGED DISK</h2>
 
<P>
To test for a damaged disk or malfunction of the disk drive, use the
information given in the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../setup/q110622.htm">Q110622</A></B>
   TITLE     : "Insufficient Memory..." Error Message on Disk 1
               During Setup

</PRE><h2>KNOWN SETUP ERROR MESSAGES</h2>
 
<P>
For procedures to correct specific error messages, refer to the article(s)
listed for that error:

<UL><LI>For the "Insufficient Memory To Run Application" error message, use the
   information given in the following article in the Microsoft Knowledge
   Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../office/q118457.htm">Q118457</A></B>
<PRE></PRE>      TITLE     : Office Err Msg: "Insufficient Memory to Run Application"

</PRE><LI>For the "Cannot Find CTL3D.DLL" error message, use the information given
   in the following article in the Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A href="../office/q113432.htm">Q113432</A></B>
<PRE>   TITLE     : Office Error Msg: "Cannot Find CTL3D.DLL" During
               Installation

</PRE></UL>Any time an error occurs when you attempt to run the Setup program, check
for errors on the hard disk, and optimize the drive if possible. This will
help to insure that the volume that Setup is installing to is in good
order.
<P>
<P><h3>To check for Hard Disk Errors and to Optimize the Drive</h3>
 

<UL><LI>For versions of MS-DOS 5.x and earlier, use the checkdisk utility to
   check the disk for errors. Type "chkdsk" (without the quotation marks)
   at the MS- DOS prompt, as in the following example:
<P>
<P><PRE>      c:\&gt;chkdsk
</PRE>
<LI>If you are using MS-DOS 6.2 or later, you can use the scandisk utility.
   To use it, exit Windows and type "scandisk" (without the quotation
   marks) at the MS-DOS prompt, as in the following example:
<P>
<P><PRE>      c:\&gt;scandisk
</PRE><P>
   NOTE: IBM PC-DOS does not include scandisk. Contact IBM or refer to your
   documentation for the appropriate utility to accomplish these steps.

<LI>If you are using MS-DOS 6.2x or later, you may use the defrag utility to
   defragment your hard disk. To use the defrag utility, exit Windows and
   type "defrag" (without the quotation marks) at the MS-DOS prompt, as in
   the following example:
<P>
<P><PRE>      c:\&gt;defrag
</PRE><P>
</UL><h2>THE CLEAN BOOT PROCESS</h2>
 
<P>
Many device drivers and terminate-and-stay-resident (TSR) utilities cause
conflicts with the set up process. You must remove all device drivers and
TSRs that are not absolutely necessary to boot the system and run the Setup
program. This can be done in several ways.
<P>
Method 1: Create a bootable floppy disk and create a new Autoexec.bat and
<PRE>          Config.sys file on this disk. You can make a bootable disk by
          typing either of the following at the MS-DOS prompt:

             format a: /s

             -or-

             sys a:

</PRE>Method 2: Rename the Autoexec.bat and Config.sys files and create new ones
<PRE>          on the root directory of the hard disk.

          If you are using MS-DOS 6.2 or later, you can use the F8 boot
          procedure.

          You can create the new Autoexec.bat file using the MS-DOS editor
          by typing "edit" (without the quotation marks) at the MS-DOS
          prompt or you can use Windows Notepad.

</PRE><h2>THE CONFIG.SYS AND AUTOEXEC.BAT FILES</h2>
 
<P>
The following sections list the basic entries in the Config.sys file that
are necessary to run Setup. If the Config.sys file contains the line
device=c:\dos\setver.exe, you can remove it (this line is optional).
<P>
These Config.sys and Autoexec.bat files make the following assumptions:

<UL><LI>Windows is installed in the c:\windows folder (directory)

<LI>MS-DOS is installed in the c:\dos folder

<LI>The c:\temp directory does exist.
<P>
</UL><h3>Windows 3.0 or 3.1 with MS-DOS versions earlier than 5.0</h3>
 
<P>
<PRE>   Config.sys:

   device=c:\windows\himem.sys
   Files=60
   buffers =20
   stacks=9,256

   Autoexec.bat file:

   prompt $p$g
   path=c:\windows;c:\dos;c:\
   set temp=c:\temp
   set tmp=c:\temp

</PRE><h3>MS-DOS versions 5.0 and later</h3>
 
<P>
<PRE>   Config.sys file:

   device=c:\dos\setver.exe
   device=c:\windows\himem.sys
   Files=60
   buffers =20
   stacks=9,256
   shell=c:\dos\command.com c:\dos\ /p /e:512

   Autoexec.bat file:

   prompt $p$g
   path=c:\windows;c:\dos;c:\
   set temp=c:\temp
   set tmp=c:\temp
   c:\dos\share.exe /l:500 /f:5100

   **(any disk compression managers)
   **(if installing from a network include any network drivers necessary
      to install from the network)
   **(if installing from compact disc include compact disc driver)

</PRE><h3>Windows for Workgroups 3.11</h3>
 
<P>
<PRE>   Config.sys file:

   device=c:\dos\setver.exe
   device=c:\windows\himem.sys
   Files=60
   buffers =20
   stacks=9,256
   shell=c:\dos\command.com c:\dos\ /p /e:1024
   device=c:\windows\ifshlp.sys

   Autoexec.bat file:

   prompt $p$g
   path=c:\windows;c:\dos;c:\
   set temp=c:\temp
   set tmp=c:\temp

   **(include any disk compression managers if necessary to access drive)
   **(if installing from a network include any network drivers necessary
      to install from the network)
   **(if installing from compact disc include compact disc driver)

</PRE>Always remove the following:
<P>
<PRE>   dos=high,umb
   logimenu,click
   anti-virus programs (vsafe, f-prot, nav, and so on)
   install=fastopen
   memory managers(emm386.sys, qemm.sys, and so on)
   unnecessary drivers(sound, modem, fax, scanners, game ports, networks**,
   COMPACT DISCs**, and so on)
   MS-DOS level mouse/keyboard drivers
   smartdrv.exe

</PRE><h2>VIDEO DRIVER CONFLICTS</h2>
 
<P>
When an error occurs, set the video display to the standard VGA display.
This uses the generic VGA driver that ships with Windows and is known to
function correctly with Windows. To change the display, use the following
steps:

<OL><P><LI>In Program Manager, select the Windows Setup icon.
<P>
   This icon is normally found in the Main program group. If this icon
   cannot be located, an alternative method to run Windows Setup is to
   click Run on the File menu in Program Manager or File Manager. This will
   bring you to the Windows Setup dialog box.

<P><LI>Note the current driver that appears next to the Display option so
   that you will know what driver to switch it back to.

<P><LI>On the Options menu, click Change System Setting.

<P><LI>Scroll the list to locate the VGA display entry, and select that
   display.
<P>
   CAUTION: Do not the select the VGA 3.0 driver. This is a different
   driver from the VGA driver, and it may not work correctly on all
   systems. You will then be prompted and given a choice to use the current
   driver or to install a new driver. Select to use the current driver.
<P>
   NOTE: If you do not have a current copy of the VGA driver on your
   system, you will be prompted to insert the Windows Installation Disk in
   your floppy disk drive. Place the requested disk in the drive and press
   ENTER.

<P><LI>Select to Restart Windows.

<P><LI>Hold down the Shift key to disable the Startup group programs.
<P>
</OL><h2>THE SYSTEM.INI AND WIN.INI FILES</h2>
 
<P>
The Win.ini file has two lines that automatically start programs when
Windows is started. These two lines are in the [Windows] section and are
the load= and run= lines. If there is anything being loaded in these lines,
remark these lines out by placing a semicolon at the very beginning of the
line.
<P>
In the System.ini file, check the following lines in the [boot] section. If
they contain something other than what is listed here, change them to the
following:
<P>
<PRE>   shell=progman.exe
   comm.drv=comm.drv
   system.drv=system.drv
   drivers=mmsystem.dll

</PRE></OL>If one of these lines is not present, add it. If any changes are made to
the Win.ini or the System.ini files, save the changes and restart Windows.
<P>
Make sure there are blank lines between the section headings in the Win.ini
and System.ini files. The section headings are designated by the braces.
There should be a blank line directly before each section heading. This
line should not contain any characters (including the space character), the
tab character, or any other non-printing characters. Also, eliminate blank
lines in the body of a section.
<P>
Make sure there is a valid temp directory. Confirm that the "set temp="
line points to an existing folder. When you use DMF disks, it is important
to set a TMP variable as well as the TEMP variable. This variable can be
set to the same folder as the TEMP variable. You can suggest, for example,
c:\temp as the temp folder (using a folder named "Temp" makes it easy to
clean up old files that are left there).
<P>
Check to make sure the path statement in the Autoexec.bat file is correctly
typed. Make sure each folder has the following

<UL><LI>a drive letter
<LI>a colon (not a semicolon) after the drive letter
<LI>a backslash after the colon in the drive specification
<LI>a semicolon (not a colon) after each folder path
<P>
</UL>and that each folder listed is a valid folder, as in the following example:
<P>
<PRE>   path=c:\windows;c:\dos;c:\

</PRE>Check to make sure that Windows is starting from the Windows folder. To
check where Windows is starting from type "set" at the MS-DOS prompt and
press ENTER. This will display a list of environment variables. The ones to
pay particular attention to include:
<P>
<PRE>      path=&lt;search path&gt;
      temp=&lt;temp folder&gt;
      windir=c:\&lt;windows folder&gt;

</PRE>The windir variable should refer to the valid Windows folder. If it
references only the root drive or a folder other than the one containing
Windows, refer to the following articles to correct this problem:
<P>
<PRE>   ARTICLE ID: <B><A href="../setup/q100836.htm">Q100836</A></B>
   TITLE     : Setup Error Message: "While Registering OLE Servers..."

</PRE>The temp variable must refer to a valid folder. If it references the
root directory, the MS-DOS folder, or the Windows folder, change it in the
Autoexec.bat to a valid temp directory. If the temp directory does not
exist, you should create it.
<P>
If the path statement contains any invalid folders or has typographical
errors, edit the path statement in the Autoexec.bat file to correct the
mistakes.
<P>
<P><h2>VIRUSES</h2>
 
<P>
Viruses are a major issue with failed setups. If you are having trouble
with the disk errors or read/write errors, be sure to check for viruses.
The file names on the DMF disks should indicate the product name and disk
number, and have a ".cab" extension. Some examples of these files are:
<P>
<PRE>   Microsoft Excel Setup Disk 2 contains the file "Excel2.cab"
   Office Setup Disk 10 contains the file "Msoff10.cab"

</PRE>If these are not the file names you have (on DMF disks only), or if the
file sizes are 0, the likely cause is a virus. A particular file name to
look for is one containing "EMSDMF.3.2". This name is known to be caused by
a boot sector virus. The virus will need to be cleaned out of the boot
sector and the entire hard disk should be cleaned. Likewise, clean any of
the setup disks that where infected.
<P>
For more information on detecting and cleaning viruses refer to the
following articles:
<P>
<PRE>   ARTICLE ID: <B><A href="../zmiscellaneous/q49500.htm">Q49500</A></B>
   TITLE     : List of Anti-Virus Software Vendors

   ARTICLE ID: <B><A href="../zmiscellaneous/q82923.htm">Q82923</A></B>
   TITLE     : Methods to Detect a Boot Sector Virus

   ARTICLE ID: <B><A href="../win3x/q88410.htm">Q88410</A></B>
   TITLE     : Windows Err Msg: The Microsoft Windows 32-Bit Disk...

   ARTICLE ID: <B><A href="../zmiscellaneous/q72796.htm">Q72796</A></B>
   TITLE     : Common Ways of Detecting a Virus in MS-DOS

</PRE><h2>MAINTENANCE MODE INSTALLATION</h2>
 
<P>
If you run Setup and it starts up in maintenance mode (the options to
Add/Remove, Reinstall, or Remove All indicate that you are in maintenance
mode), try running the Setup program from the floppy disk drive. In
general, Setup is started in maintenance mode when you run it from any of
the following sources:

<UL><LI>the Office Setup icon
<LI>the Office Manager menu
<LI>the Setup.exe file on the hard disk
<P>
</UL>To run Setup from the floppy disk drive, put Disk 1 of the Office
Setup disks into the floppy disk drive (usually the A or B drive). In
Program Manager, click Run on the File Menu, and type "&lt;drive&gt;:\setup.exe"
(for example, if your disk is in drive A, type a:\setup.exe).
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 1.00 1.10 2.00 3.00 4.00 4.20 4.30 5.00 5.00<BR>
6.00 6.00a tshoot<BR>
Keywords          : kbsetup kbtshoot<BR>
Version           : 1.00 1.10<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
