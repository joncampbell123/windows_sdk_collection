

<HTML>
<HEAD>
<TITLE>Workstation Setup Installs MSAPPS Files Locally </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111687">
<META NAME="KBModify" CONTENT="1996/09/10">
<META NAME="KBCreate" CONTENT="1994/02/15">
<META NAME="Keywords" CONTENT="kbsetup kbnetwork kbprb">
<META NAME="KBArea" CONTENT="Support; KB; setup">
<META NAME="Description" CONTENT="  When you do a workstation installation of Microsoft Office, the Setup program may copy the MSAPPS files to your local hard drive even if (during the administrative install) you had specified that they should be run from the server.  You do not rece...">
<META NAME="Product" CONTENT="Setup">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QBWO,QDIZ,QBFY,QDL9,QBWQ,QBWN,QBQU,QAEF,QAVZ,QA3A,QAY2,QAFI,QA5J V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Workstation Setup Installs MSAPPS Files Locally</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 10, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111687</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P>
 
The information in this article applies to:

<UL><LI>Microsoft Office for Windows, versions 4.0, 4.2, 4.2c, 4.3, 4.3c
<LI>Microsoft PowerPoint for Windows, versions 4.0, 4.0c
<LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Access, version 2.0
<LI>Microsoft Works for Windows, version 3.0
<LI>Microsoft Project for Windows, version 4.0
<P>
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you do a workstation installation of Microsoft Office, the Setup
program may copy the MSAPPS files to your local hard drive even if (during
the administrative install) you had specified that they should be run from
the server.
<P>
You do not receive a message informing you that these files are being
installed locally, and after Office is installed, it functions correctly.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs primarily in the following situations:

<UL><LI>You are using network software that does not support the Universal
   Naming Convention (UNC), or UNC support is not functioning correctly.
<P>
   -or-

<LI>Your local REG.DAT and/or WIN.INI files already has entries pointing to
   previous MSAPPS files on your local hard drive, in which case setup will
   update the MSAPPS in place.
<P>
   -or-

<LI>The server, share, and directory name of the MSAPPS directory on
   the server exceed 63 characters.
<P>
   -or-

<LI>The Administrative Setup (SETUP/A) was performed locally on a
   Non-Dedicated Server. Note, an administrative setup should always
   be performed from a workstation connected to the server.
<P>
   -or-

<LI>The Network Server or Network Path is incorrect in the SETUP.STF file.
<P>
</UL>NOTE: This problem may also occur in other situations. The situations
described here are those that have been confirmed.
<P>
<P><h2>RESOLUTIONS</h2>
 
<P>
To resolve this problem, follow the procedure below appropriate to your
situation.
<P>
You Are Using Network Software That Does Not
<P><h3>Support the Universal Naming Convention (UNC)</h3>
 
<P>
If Setup cannot establish a persistent UNC connection to the MSAPPS network
server, the MSAPPS files are installed to your local hard drive. This can
occur if your network does not support UNC, if UNC support is broken, or if
the network administrator has changed the UNC path in the network server
confirmation dialog box to a non-existant path or to a logical path (using
a drive letter).
<P>
If you cannot enable UNC support, you may be able to work around the
problem by doing the following:
<P>
<PRE>   1. Perform a Workstation install of Office. (This will copy the MSAPPS
      files to your local hard drive.)

   2. Make a backup of your WIN.INI file.

   3. Run Office Setup again in maintenance mode, and choose the Remove
      All button to remove Office (including all of the shared
      applications).

   4. Exit Windows and delete your WIN.INI file. Rename the backup of your
      WIN.INI file to WIN.INI. Start Windows again.

   5. In a text editor, such as Notepad, open your WIN.INI file. Locate the
      [MSAPPS] section. This section should appear similar to the
      following:

         [MSAPPS]
         MSAPPS=C:\WINDOWS\MSAPPS
         GRPHFLT=C:\WINDOWS\MSAPPS\GRPHFLT
         PROOF=C:\WINDOWS\MSAPPS\PROOF
         MSINFO=C:\WINDOWS\MSAPPS\MSINFO
         MSQUERY=C:\WINDOWS\MSAPPS\MSQUERY
         WORDART=C:\WINDOWS\MSAPPS\WORDART
         TEXTCONV=C:\WINDOWS\MSAPPS\TEXTCONV
         EQUATION=C:\WINDOWS\MSAPPS\EQUATION
         ARTGALRY=C:\WINDOWS\MSAPPS\ARTGALRY
         MSGRAPH=C:\WINDOWS\MSAPPS\MSGRAPH
         ORGCHART=C:\WINDOWS\MSAPPS\ORGCHART
         MSGRAPH5=C:\WINDOWS\MSAPPS\MSGRAPH5
         SHEETCNV=C:\WINDOWS\MSAPPS\SHEETCNV

   6. Change the path to each of the applications in this section to point
      to the correct server location for the MSAPPS applications.
      NOTE: Use a logical path (drive letter).

   7. Search your WIN.INI file for the following sections and change the
      path to any shared application to point to the server as described
      above:

         [embedding]
         [MS Text Converters]
         [MS Spreadsheet Converters]
         [MS Graphic Import Filters]
         [MS Proofing Tools]
         [extensions]

   8. Run Office Setup again, and perform a Workstation installation.

   Because the paths in the WIN.INI file are pointing to the server, Setup
   updates the applications in place, that it, Setup will configure your
   computer to run the shared applications from the server.

</PRE>If Your Local REG.DAT and/or WIN.INI Has Entries
<P><h3>Pointing to Previous MSAPPS Files on Your Local Hard Drive</h3>
 
<P>
If an MSAPPS directory already exists under your local Windows
installation, the Setup program will probably install the shared components
there, instead of installing them to the MSAPPS directory on the server.
<P>
To avoid this problem, do the following to remove any existing references
to the MSAPPS directory from your WIN.INI and REG.DAT files, and then run
Setup again:
<P>
CAUTION: Changes you make to the registration database are not supported by
Microsoft. Be sure to make a back up copy of REG.DAT before you modify this
file.

<OL><P><LI>Make a backup copy of both the WIN.INI and REG.DAT files.

<P><LI>In the WIN.INI file, search for the following sections, and comment out
   (place a semicolon in front of) the lines in this section which include
   paths to any of the shared applications:
<P>
<P><PRE>      [embedding]
      [MS Text Converters]
      [MS Spreadsheet Converters]
      [MS Graphic Import Filters]
      [MS Proofing Tools]
      [extensions]
</PRE>
<P><LI>In the REG.DAT file, do the following to delete the MSAPPS references:
<P>
   a. In Program Manager, choose the Run command from the File menu.
<P>
   b. In the Command Line box, type "Regedit /v" (without the quotation
<P><PRE>      marks), and choose OK.
</PRE><P>
<P><PRE>      This command will start Registration Info Editor.
</PRE><P>
   c. In Registration Info Editor, choose Find Key from the Search menu and
<P><PRE>      type "MSWordArt" in the Find What box.
</PRE><P>
   d. When MSWordArt is selected, choose Delete Key from the Edit menu.
<P>
<P><PRE>      Repeat steps c and d to search for and delete the rest of the MSAPPS
      keys from the registration database. To determine which keys to
      delete, look at the entries in the [Embedding] section of your
      WIN.INI file. Find the entries that are installed to MSAPPS. The word
      to the left of the equal sign in the WIN.INI entry is the key name
      you should delete. The key names you should delete may include any of
      the following:
</PRE><P>
<PRE>         DefaultIcon
         Equation.1
         Equation.2
         Localserver
         MS_ClipArt_Gallery
         MSDraw
         MSGraph.3
         MSGraph.Chart.5
         MSOrgChart.1
         MSWordArt.2
         Server
         WordArt

   e. After you delete the appropriate keys, choose Save Changes from the
      File menu, and choose Exit.

</PRE><P><LI>Run Office Setup again.
<P>
</OL>The shared applications should now be installed to the MSAPPS directory on
the specified network server.
<P>
For additional information, please see the following article(s) in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q122964.htm">Q122964</A></B>
   TITLE     : How to Rebuild the Reg.Date File and Re-Register
                Applications

</PRE></OL>The Server, Share, and Directory Name of the
<P><h3>MSAPPS Directory on the Server Exceeds 63 Characters</h3>
 
<P>
If the Universal Naming Convention (UNC) path is longer than 63 characters,
the Setup program will install the shared components to an MSAPPS directory
on the local hard drive instead of on the server. The UNC path includes the
following:
<P>
<PRE>   \\servername\sharename\directoryname

</PRE>To avoid this problem, make sure your UNC path does not exceed 63
characters.
<P>
The Administrative Setup (SETUP/A) Was
<P><h3>Done Locally on a Non-Dedicated Server</h3>
 
<P>
If you do a SETUP/A to the local hard drive on a non-dedicated server, (as
in Windows for Workgroups), the Setup program defaults to the following
location:
<P>
<PRE>   MSAPPS Network Server C:

</PRE>If the Network Server is referred to simply as "C:" this causes the
workstation setup procedure, when run from other machines, to install
shared components to their local C drives instead of to the server.
<P>
However, if you try to do a SETUP/A to your own hard drive and try to
specify its server and share name as the MSAPPS Network Server, you will
receive an error message indicating that the server and share cannot be
found on the network.
<P>
To avoid this problem, do the administrative installation to the non-
dedicated server from another computer instead of locally. When you do the
SETUP/A from another machine, you can specify the server and share name
correctly, as follows:
<P>
<PRE>   MSAPPS Network Server   \\servername\sharename

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbnetwork kbprb<BR>
KBSubcategory:
<P>

Additional reference words: 1.0 1.00 4.00 administrative administrator<BR>
shared work station net winword xl5 projwin xlwin offwin StpNet power point<BR>
wkssetup
<P>


<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 10, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
