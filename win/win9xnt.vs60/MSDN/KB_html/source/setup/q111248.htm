

<HTML>
<HEAD>
<TITLE>XL: Opening/Saving STF File in Excel May Cause Setup Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q111248">
<META NAME="KBModify" CONTENT="1997/11/07">
<META NAME="KBCreate" CONTENT="1994/02/08">
<META NAME="Keywords" CONTENT="kb3rdparty kberrmsg kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; setup">
<META NAME="Description" CONTENT="  In Microsoft Excel versions 5.0 and later, if you edit a custom setup script (an .STF file), and then run the Setup program for your Microsoft application, you may receive one or more of the following error messages:     Admin Mode Root Object ID O...">
<META NAME="Product" CONTENT="Setup">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QDKX,QAA1,QDL9,QBWO,QBWN,QDI2,QDIZ,QBWS,QBWQ,QAB4,QAIH,QAMB,QATX,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>XL: Opening/Saving STF File in Excel May Cause Setup Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q111248</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Excel 97 for Windows
<LI>Microsoft Excel for Windows 95, version 7.0
<LI>Microsoft Excel for Windows, versions 5.0, 5.0c
<LI>Microsoft Office 97 for Windows
<LI>Microsoft Office for Windows 95, version 7.0
<LI>Microsoft Office for Windows, versions 4.0, 4.2
<LI>Microsoft Office Professional for Windows, version 4.3
<LI>Microsoft PowerPoint 97 for Windows
<LI>Microsoft PowerPoint for Windows 95, version 7.0
<LI>Microsoft PowerPoint for Windows, versions 4.0, 4.0a, 4.0c
<LI>Microsoft Project 98 for Windows
<LI>Microsoft Word 97 for Windows
<LI>Microsoft Word for Windows 95, version 7.0
<LI>Microsoft Word for Windows, versions 6.0, 6.0a, 6.0c
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In Microsoft Excel versions 5.0 and later, if you edit a custom setup
script (an .STF file), and then run the Setup program for your Microsoft
application, you may receive one or more of the following error messages:
<P>
<PRE>   Admin Mode Root Object ID Object
   Your Setup files may be damaged. Try restarting the Setup Program

   Object 1856
   Your Setup files may be damaged. Try restarting the Setup Program

   The Processing of top-level information has failed

   Object ID 0:Syntax Error in List of Obj ID

   Microsoft Office Setup was not completed successfully

</PRE>Note that if you run the Setup program with the /q parameter (quiet mode),
you only receive the last error message.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Microsoft Excel versions 5.0 and later, the Text Import Wizard may
interpret a value in the .STF file as a time value, or as a number value,
and incorrectly convert the value.
<P>
For example, assuming the correct syntax for line 15 in the Microsoft
Office SETUP.STF is:
<P>
<PRE>   Admin Mode Root Object ID 41:1

</PRE>When you open this file in Microsoft Excel, the Text Import Wizard
interprets the value 41:1 in column two as a time value and converts the
line to the following:
<P>
<PRE>   Admin Mode Root Object ID 41:01:00

</PRE>If you save the .STF file in Microsoft Excel with this value, you receive
one or more of the error messages listed above when you run a Setup program
that uses this .STF file.
<P>
When you open an .STF file for a Microsoft Windows 95 application in
Microsoft Excel versions 5.0 and later, the Text Import Wizard also
interprets numbers separated by a comma as a single number, and converts
the value to a number with commas inserted as the thousands marker.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft provides examples of Visual Basic for Applications procedures for
illustration only, without warranty either expressed or implied, including,
but not limited to the implied warranties of merchantability and/or fitness
for a particular purpose. The Visual Basic procedures in this article are
provided 'as is' and Microsoft does not guarantee that they can be used in
all situations. While Microsoft support engineers can help explain the
functionality of a particular macro, they will not modify these examples to
provide added functionality, nor will they help you construct macros to
meet your specific needs. If you have limited programming experience, you
may want to consult one of the Microsoft Solution Providers. Solution
Providers offer a wide range of fee-based services, including creating
custom macros. For more information about Microsoft Solution Providers,
call Microsoft Customer Information Service at (800) 426-9400.
<P>
To work around this problem, perform any of the following:

<UL><LI>Edit the .STF file in a text editor such as Microsoft Word, Wordpad
   (Windows 95 only), or Notepad. Text editors convert values from one
   format to another.
<P>
   NOTE: MS-DOS Editor should NOT be used to modify the SETUP.STF file. MS-
   DOS Editor replaces tabs with spaces and will cause the same error.
   Other text editors that are known to replace tabs with spaces (and are
   thus unsuitable for modifying the .STF file) are Xtree Gold 2.0 by
   Executive Systems and QEdit by SemWare Inc.
<P>
<P><PRE>    -or-
</PRE>
<LI>Do the following to open the file in Microsoft Excel versions 5.0 or
   later:
<P>
<P><PRE>    1. In Microsoft Excel, open the .STF file you want to edit.
</PRE><P>
<P><PRE>    2. In the Text Import Wizard dialog box, click Next twice to proceed to
       the Step 3 of 3 dialog box.
</PRE><P>
<P><PRE>    3. In the Text Import Wizard - Step 3 Of 3 dialog box, under Data
       Preview, drag the vertical scrollbar indicator down until the
       "Object ID" item appears in the Data Preview window. Click the first
       column to select it. Hold the SHIFT key down, and drag the
       horizontal scrollbar indicator to the right until the last column is
       displayed in the Data Preview window. Click the last column. All of
       the columns (at least 15 columns) should be selected.
</PRE><P>
<P><PRE>    4. Under Column Data Format, click the Text option, and click Finish.
</PRE><P>
<P><PRE>       IMPORTANT: If you do not click the Text option at this step,
       Microsoft Excel will read some of the entries in your edited .STF
       file incorrectly. When this occurs, you will receive "setup parse
       errors" during setup.
</PRE><P>
<P><PRE>       NOTE: If you are opening an .STF file that belongs to Microsoft
       Office 97, you must perform the steps listed in the following
       article in the Microsoft Knowledge Base immediately after opening
       the .STF file:
</PRE><P>
<PRE>          ARTICLE-ID: <B><A href="../office/q162796.htm">Q162796</A></B>
          TITLE     : OFF97: Setup Error 932 After Modifying STF File

    -or-

</PRE><LI>If you want to open an .STF file that belongs to Microsoft Office 97,
   run the following Visual Basic macro to open the .STF file. The macro
   performs all of the same actions as steps 1-4, shown above, as well as
   the actions listed in Microsoft Knowledge Base article <B><A href="../office/q162796.htm">Q162796</A></B>:
<P>
<PRE>      Sub OpenSTF()
         STFName = Application.GetOpenFilename("Setup Table File " &amp; _
            "(*.STF),*.STF")
         If STFName = False Then End
         Application.StatusBar = "Opening " &amp; STFName
         Workbooks.OpenText FileName:=STFName, DataType:=xlDelimited, _
            TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, _
            Tab:=True, Semicolon:=False, Comma:=False, Space:=False, _
            Other:=False, FieldInfo:=Array(Array(1, 2), Array(2, 2), _
            Array(3, 2), Array(4, 2), Array(5, 2), Array(6, 2), _
            Array(7, 2), Array(8, 2), Array(9, 2), Array(10, 2), _
            Array(11, 2), Array(12, 2), Array(13, 2))
         Application.StatusBar = "Please be patient... preparing " &amp; _
            STFName &amp; " for editing."
         Application.ScreenUpdating = False
         Cells.AutoFilter Field:=6, Criteria1:="= ""*", Operator:=xlAnd
      Set TrimRange = _
      ActiveSheet.UsedRange.Columns("F:F").SpecialCells(xlCellTypeVisible)
         TrimRange.Replace What:="""""", Replacement:=""""
         For Each A In TrimRange.Areas
            For Each C In A.Cells
               C.Formula = Mid(LTrim(C.Text), 2)
            Next C
         Next A
         TrimRange.Replace What:=""" """, Replacement:=""""""
         TrimRange.Replace What:="""""""", Replacement:=""""""
         Cells.AutoFilter
         Application.StatusBar = False
      End Sub

</PRE></UL>IMPORTANT: You must perform a best fit on column F before you save the
file. If you do not, items in that column will appear as pound signs.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The TextWizard in Microsoft Excel allows you to choose how you want text to
be distributed across columns and how the data in each column should be
formatted when you open a text file.
<P>
For more information about using the TextWizard, choose the Search button
in Help and type:
<P>
<PRE>   TextWizard

</PRE>The third party products mentioned here are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kberrmsg kb3rdparty<BR>
KBSubcategory:<BR>
Additional reference words: 1.00 1.10 1.20 4.00 4.00a 4.00c 4.20 4.20c 4.30<BR>
4.30c 5.00 5.00c 6.00 6.00a 6.00c 7.00 8.00 97 officeinterop 908 938 723<BR>
ppt95 ppt97<BR>
Keywords          : kb3rdparty kberrmsg kbsetup<BR>
Version           : 1.00 1.10 1.20<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
