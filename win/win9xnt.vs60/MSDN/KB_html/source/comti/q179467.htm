

<HTML>
<HEAD>
<TITLE>PRB: Inappropriate Use of Trailing FILLER with an Array </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179467">
<META NAME="KBModify" CONTENT="1998/03/02">
<META NAME="KBCreate" CONTENT="1998/01/16">
<META NAME="Keywords" CONTENT="CTICB CTIData CTIProg">
<META NAME="KBArea" CONTENT="Support; KB; comti">
<META NAME="Description" CONTENT="  A parameter with trailing bytes of FILLER specified is declared as an array. The specified amount of FILLER follows the array as a whole, rather than each element of the array, as might be expected. This can be demonstrated by exporting COBOL state...">
<META NAME="Product" CONTENT="comti">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBBI,QAHE,QBE7,QBE6,QAH2,QAY2,QAPN,QAO4,QALG,QAJG,QACJ,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Inappropriate Use of Trailing FILLER with an Array</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 2, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179467</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft COM Transaction Integrator for CICS and IMS 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A parameter with trailing bytes of FILLER specified is declared as an
array. The specified amount of FILLER follows the array as a whole, rather
than each element of the array, as might be expected. This can be
demonstrated by exporting COBOL statements from this component.
<P>
<P><h2>CAUSE</h2>
 
<P>
You can use Component Builder (CB) to specify that a parameter, declared as
an array, has trailing bytes of FILLER. Trailing FILLER is declared with
the COBOL Definition tab of the parameter's Properties page. (Arrays are
declared with the Arrays tab.) The number of bytes of FILLER to be
transmitted From Host or To Host (or both) are also specified. This implies
that a COMTI run-time version would treat it like the following example in
COBOL:
<P>
<PRE>   10 GROUP-ARRAY OCCURS y TIMES.
      15 ELEMENT PIC x.
      15 FILLER  PIC x.

</PRE>However, run-time version actually treats it as the following COBOL:
<P>
<PRE>   10 ELEMENT PIC x OCCURS y TIMES.
   10 FILLER  PIC x.

</PRE>In other words, the FILLER will trail the array, rather than each element
of the array.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you do have an array and each element has FILLER following it, then the
item description must be treated as a recordset with one column. Declare a
recordset with the element and its trailing FILLER. Declare the parameter
with the recordset as its data type. Then set the parameter's array
properties.
<P>
You can also use the COBOL Import Wizard, which correctly handles importing
either of the above COBOL samples.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be an issue in Microsoft COM Transaction
Integrator for CICS and IMS, version 1.0. It is not a bug. You must be
aware of the circumstances under which this behavior occurs because it
relates to the accurate disposition of data both to and from the mainframe
server application.
 
<PRE>Keywords          : CTICB CTIData CTIProg
Version           : WINDOWS:1.0
Platform          : WINDOWS
Hardware          : ALPHA x86
Issue type        : kbprb
Solution Type     : kbpending</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 2, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
