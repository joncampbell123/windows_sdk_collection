

<HTML>
<HEAD>
<TITLE>PRB: Permission Denied Accessing Web Browser Control in HTML </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176789">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/11/14">
<META NAME="Keywords" CONTENT="AXSDKWebBrowser kbcode">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  When scripting a WebBrowser control that has been embedded in an HTML page, attempts to use any standard WebBrowser Control methods or properties fail with a  Permission Denied  scripting error.  CAUSE =====  Because of cross-frame security restric...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QDNQ,QAB5,QA7O,QAOE,QAMN,QAPN,QAUJ,QAKD,QAFF,QAVZ,QAMB,QA01,QBWG,QAK7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Permission Denied Accessing Web Browser Control in HTML</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176789</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, versions 4.0, 4.01
<LI>Microsoft Internet Explorer (Programming), versions 4.0, 4.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When scripting a WebBrowser control that has been embedded in an HTML page,
attempts to use any standard WebBrowser Control methods or properties fail
with a "Permission Denied" scripting error.
<P>
<P><h2>CAUSE</h2>
 
<P>
Because of cross-frame security restrictions, any attempt to access the
WebBrowser control from script automatically fails after the control has
been set to browse a page in a different security context from the page
hosting the control.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Replace any references to the WebBrowser control with an IFRAME tag. The
IFRAME, for all intents and purposes, functions in the same manner as the
WebBrowser control and can be positioned on a page. See the MORE
INFORMATION below for an example of how to do this.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Please note that this article discusses only the use of the WebBrowser
control directly in an HTML page with the &lt;OBJECT&gt; tag and script.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following HTML page reproduces this problem:
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;SCRIPT LANGUAGE="VBScript"&gt;
   &lt;!--
   Sub window_onload()
      WebBrowser1.Navigate "<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>"
   end sub

   Sub document_onmousedown()
      WebBrowser1.Navigate "<B>http://testserver1</B>"
   end sub
   --&gt;
   &lt;/SCRIPT&gt;
   &lt;TITLE&gt;WebBrowser Control in HTML&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;
      &lt;OBJECT ID="WebBrowser1" WIDTH=332 HEIGHT=276
         CLASSID="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"&gt;
         &lt;PARAM NAME="ExtentX" VALUE="8784"&gt;
         &lt;PARAM NAME="ExtentY" VALUE="7303"&gt;
         &lt;PARAM NAME="ViewMode" VALUE="1"&gt;
         &lt;PARAM NAME="Offline" VALUE="0"&gt;
         &lt;PARAM NAME="Silent" VALUE="0"&gt;
         &lt;PARAM NAME="RegisterAsBrowser" VALUE="0"&gt;
         &lt;PARAM NAME="RegisterAsDropTarget" VALUE="0"&gt;
         &lt;PARAM NAME="AutoArrange" VALUE="1"&gt;
         &lt;PARAM NAME="NoClientEdge" VALUE="1"&gt;
         &lt;PARAM NAME="AlignLeft" VALUE="0"&gt;
      &lt;/OBJECT&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>When this example page is loaded in Internet Explorer 4.0 (IE4), the
"window_onload" event handler navigates the embedded WebBrowser control to
"<B><A href="http://www.microsoft.com">http://www.microsoft.com.</A></B>" Assuming that this example page is stored on
the local system and is accessed via "file://," the embedded WebBrowser
control is now hosting a document from a domain and protocol that is
different than the parent page. This is analogous to a using an IFRAME
inside an HTML page, where the IFRAME src property points to a document on
another domain.
<P>
At this point, unlike with an IFRAME, any and all script access to the
"WebBrowser1" object fails with the "Permission Denied" message box. With
an IFRAME, certain properties and methods are safe to use in a cross-frame
security situation. If the "document_onmousedown" event is fired in the
above example by clicking the mouse button on the page, Internet Explorer
4.0 displays a "Permission Denied" message box.
<P>
Here is the preferred substitute HTML page that is roughly equivalent to
the example above:
<P>
<PRE>   &lt;HTML&gt;
   &lt;HEAD&gt;
   &lt;SCRIPT LANGUAGE="VBScript"&gt;
   &lt;!--
   Sub window_onload()
      window.frames(0).location.href = "<b><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>"
   end sub

   Sub document_onmousedown()
      window.frames(0).location.href = "<b>http://testserver1</B>"
   end sub
   --&gt;
   &lt;/SCRIPT&gt;
   &lt;TITLE&gt;WebBrowser Control in HTML&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY&gt;
      &lt;IFRAME ID="TestFrame1" WIDTH=332 HEIGHT=276&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>In this example, the event handler for "document_onmousedown" succeeds
because cross-frame security permits setting the src property but not
reading it.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information about Cross-Frame Security, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../ie_dev/q167796.htm">Q167796</A></B>
   TITLE     : PRB: "Permission Denied" When Scripting Across Frames

</PRE> 
<PRE>Keywords          : AXSDKWebBrowser kbcode
Technology        : kbInetDev
Version           : WINDOWS:4.0,4.01
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
