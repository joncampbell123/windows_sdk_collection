

<HTML>
<HEAD>
<TITLE>HOWTO: Submitting Data from an ActiveX Control in a Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172064">
<META NAME="KBModify" CONTENT="1997/10/31">
<META NAME="KBCreate" CONTENT="1997/07/28">
<META NAME="Keywords" CONTENT="vbsEnvtIE kbcode">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  In Internet Exlorer 4.0 (IE4) the default property of an ActiveX control in a form can be submitted with the form.  If the control does not have a default property or the HTML page is viewed in Internet Explorer 3.x (IE3), the contents of the Activ...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA7O,QAB5,QAOE,QAMN,QAGE,QBWA,QAHV,QDNQ,QAUJ,QAW6,QBVV,QAKD,QAGI,QABC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Submitting Data from an ActiveX Control in a Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 31, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172064</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ActiveX SDK, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Internet Exlorer 4.0 (IE4) the default property of an ActiveX control in
a form can be submitted with the form.
<P>
If the control does not have a default property or the HTML page is viewed
in Internet Explorer 3.x (IE3), the contents of the ActiveX control in a
form will not be included when the form is submitted. This article
discusses how to submit the contents by using a hidden input field on the
form.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In IE4 the contents of an ActiveX control in a form can be submitted with
the form. The NAME is the identifier of the object tag (that is, &lt;OBJECT
NAME=MyControl CLASSID=...&gt;), and the VALUE is the value of the default
property of the control (if it exists). However, if any of the following
cases are true, the contents of the control will not be included in the
submit string:
<P>
<PRE>   The object did not instantiate
   The object does not have an identifier
   The object does not have a default property
   The default property cannot be coerced into a string

</PRE>For other controls, or for controls viewed in IE3, you can submit the value
from an ActiveX control in a form to the server by using an &lt;INPUT&gt; tag
whose type is "hidden." In response to the user selecting the "submit"
button of the form, you can execute JavaScript code that will assign the
value of the control to the hidden input field before it is sent to the
server.
<P>
The following is a complete HTML example that demonstrates using the
default property method with the Microsoft Forms 2.0 Textbox Control and
the "hidden" input method with the Microsoft Calendar Control.
<P>
<PRE>   &lt;HTML&gt;
   &lt;BODY&gt;
   &lt;FORM NAME="MyForm" ACTION="<B>http://server/scripts/GetInfo.asp</B>"
       METHOD="post" onSubmit="MyFunc()"&gt;

   &lt;OBJECT ID="TextBox1" NAME="TextBox1" WIDTH=300 HEIGHT=60
      CLASSID="CLSID: 8BD21D10-EC42-11CE-9E0D-00AA006002F3"&gt;
      &lt;PARAM NAME="TextAlign" VALUE="2"&gt;
      &lt;PARAM NAME="Text" VALUE="TextBox"&gt;

   &lt;/OBJECT&gt;
   &lt;BR&gt;

   &lt;OBJECT ID="Calendar1" WIDTH=288 HEIGHT=192
      CLASSID="CLSID:8E27C92B-1264-101C-8A2F-040224009C02"
</PRE>DATA="DATA:application/x-
oleobject;BASE64,K8knjmQSHBCKLwQCJACcAgAACADEHQAA2BMAAM0HBQAMAA8AAIAAAAAAAA
Cg
ABAAAIAAAKAAAQABAAIAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAC8AkRCAQAFQXJp
YWwBAAAAkAFEQgEABUFyaWFsAQAAALwCwNQBAAVBcmlhbAyg
<PRE>   "&gt;
   &lt;/OBJECT&gt;
   &lt;BR&gt;
   USERNAME: &lt;INPUT TYPE="text" NAME="Username" SIZE="20"&gt;&lt;BR&gt;
   PASSWORD: &lt;INPUT TYPE="password" NAME="Password" SIZE="20"&gt;&lt;BR&gt;
   &lt;INPUT TYPE="hidden" NAME="RichText"&gt;
   &lt;INPUT TYPE="hidden" NAME="Cal"&gt;
   &lt;INPUT TYPE="submit" VALUE="Submit"&gt;
   &lt;INPUT TYPE="reset"&gt;
   &lt;p&gt;
   &lt;/FORM&gt;

   &lt;SCRIPT LANGUAGE="JavaScript"&gt;
   &lt;!--
      function MyFunc()
      {
         MyForm.RichText.Value = MyForm.RichTextBox1.TextRTF;
         MyForm.Cal.Value = MyForm.Calendar1.Value
      }
   --&gt;
   &lt;/SCRIPT&gt;

   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>Using Active Server Pages on the server to receive this information would
look like this:
<P>
<PRE>   &lt;%@ LANGUAGE="VBSCRIPT" %&gt;
   &lt;HTML&gt;
   &lt;BODY&gt;
   The User Name is &lt;%Response.Write Request.form("UserName")%&gt;&lt;br&gt;
   The Password is &lt;%Response.Write Request.form("Password")%&gt;&lt;br&gt;
   The TextBox is &lt;%Response.Write Request.form("RichText")%&gt;&lt;br&gt;
   The Calendar date is &lt;%Response.Write Request.form("Cal")%&gt;&lt;br&gt;
   &lt;/BODY&gt;
   &lt;/HTML&gt;

</PRE>In IE3, the value of TextBox1 would not be submitted with the form, and
thus would not appear in the output from the ASP page.
<P>
 
<PRE>Keywords          : vbsEnvtIE kbcode
Technology        : kbInetDev
Version           : 1.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 31, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
