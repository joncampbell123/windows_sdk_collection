

<HTML>
<HEAD>
<TITLE>HOWTO: Creating Personalized Channels using ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174687">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/10/05">
<META NAME="Keywords" CONTENT="InetSDKInfoDev">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  Internet Explorer 4.0 introduces the concept of Active Channels as a means to deliver personalized and up-to-date information to subscribed users, through the use of Channel Definition Format (CDF) files. Using Active Server Pages (ASP) with Micros...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBII,QBWA,QBV9,QAVZ,QAMB,QDNQ,QAJH,QADF,QAP2,QA3N,QARL,QAQW,QAYY,QAPF,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Creating Personalized Channels using ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174687</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, versions 4.0, 4.01
<LI>Microsoft Internet Explorer (Programming), versions 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Internet Explorer 4.0 introduces the concept of Active Channels as a means
to deliver personalized and up-to-date information to subscribed users,
through the use of Channel Definition Format (CDF) files. Using Active
Server Pages (ASP) with Microsoft Internet Information Server (IIS), a
content provider on the Internet can dynamically generate a custom CDF file
to deliver personalized information to users, based on user preferences.
This article discusses a sample scenario where a personalized channel could
be used using ASP, including the details of implementation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A software company could provide an active channel that will allow users to
receive the latest information on software products, including support
information on these products. In order to be effective, a personalized
channel could be employed so that a user gets information only on products
he or she is interested in, not every product manufactured by that company.
<P>
The following are the steps to illustrate how a software company, such as
Microsoft, could create a personalized channel for this purpose, using ASP:

<OL><P><LI>First create an .htm page that will allow users to select the Microsoft
   products they would be interested in getting information on. (For
   simplicity, this example includes only two of the major Microsoft
   products currently available.) Save the file as Products.htm.
<P>
   Note that this .htm page includes a FORM, with a Subscribe button that,
   when clicked, invokes the file Gencdf.asp, which you will create in step
   2 below.
<P>
<P><PRE>      &lt;HTML&gt;
      &lt;TITLE&gt;Microsoft Custom Subscription List&lt;/TITLE&gt;
</PRE><P>
<P><PRE>      &lt;FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"&gt;
      &lt;H1&gt;Microsoft Custom Product Subscription List&lt;/H1&gt;
      Subscribe to your favorite Microsoft Internet product/s below
      to get the latest product information and access to support:
</PRE><P>
<P><PRE>      &lt;FONT FACE="courier" SIZE="3"&gt;
      &lt;PRE&gt;
<PRE></PRE>        &lt;FORM METHOD="GET" ACTION="GenCDF.asp"&gt;
        &lt;input Type="checkbox" Name="IE4"     VALUE="1"&gt;Internet Explorer
        &lt;input Type="checkbox" Name="InetSDK" VALUE="1"&gt;Internet Client SDK
      &lt;/Pre&gt;
      &lt;/FONT&gt;

      &lt;input Type=SUBMIT Value="Subscribe" Name="Validate" &gt;
      &lt;/FORM&gt;
      &lt;/HTML&gt;

</PRE><P><LI>Create the .asp file that uses the information generated from
   Products.htm above to dynamically generate the personalized CDF file.
   Save this file as Gencdf.asp.
<P>
<P><PRE>      &lt;%@ LANGUAGE=VBScript %&gt;
      &lt;%
<PRE></PRE>         IE4     = Request ("IE4")
         InetSDK = Request ("InetSDK")
      %&gt;

      &lt;% Response.ContentType = "application/x-cdf" %&gt;

      &lt;?XML VERSION="1.0"?&gt;
      &lt;CHANNEL href="<b><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>"&gt;
         &lt;TITLE&gt;Sample MS Custom Channel&lt;/TITLE&gt;
         &lt;ABSTRACT&gt;Demo Channel on how to get a customized subscription
          using ASPs&lt;/ABSTRACT&gt;

         &lt;SCHEDULE&gt;
            &lt;INTERVALTIME DAY ="1" /&gt;
            &lt;EARLIESTTIME HOUR="1" /&gt;
            &lt;LATESTTIME   HOUR="5" /&gt;
         &lt;/SCHEDULE&gt;

      &lt;% If Not IE4 = 0 Then %&gt;
         &lt;CHANNEL href="<b><A href="http://www.microsoft.com/ie/ie40">http://www.microsoft.com/ie/ie40</A></B>"&gt;
            &lt;TITLE&gt;IE4&lt;/TITLE&gt;
            &lt;ABSTRACT&gt;IE4 Product Page&lt;/ABSTRACT&gt;
            &lt;ITEM href="<b><A href="http://www.microsoft.com/iesupport">http://www.microsoft.com/iesupport</A></B>"&gt;
               &lt;TITLE&gt;IE4 Support Page&lt;/TITLE&gt;
               &lt;ABSTRACT&gt;This is where you can get all your questions on
                IE4 answered. :)&lt;/ABSTRACT&gt;
            &lt;/ITEM&gt;
         &lt;/CHANNEL&gt;
      &lt;% End if %&gt;

      &lt;% If Not InetSDK = 0 Then %&gt;
         &lt;CHANNEL href="<b><A href="http://www.microsoft.com/workshop/prog/inetsdk">http://www.microsoft.com/workshop/prog/inetsdk</A></B>"&gt;
            &lt;TITLE&gt;Internet Client SDK&lt;/TITLE&gt;
            &lt;ABSTRACT&gt;Internet Client SDK Product Page&lt;/ABSTRACT&gt;
            &lt;ITEM href="<b><A href="http://www.microsoft.com/support/inetsdk">http://www.microsoft.com/support/inetsdk</A></B>"&gt;
               &lt;TITLE&gt;Internet Client SDK Support Page&lt;/TITLE&gt;
               &lt;ABSTRACT&gt;This is where you can get all your questions on
                IE4 programmability answered. :)&lt;/ABSTRACT&gt;
             &lt;/ITEM&gt;
         &lt;/CHANNEL&gt;
      &lt;% End if %&gt;
      &lt;/CHANNEL&gt;

   CDF files that are dynamically generated through Active Server Pages
   should have the following line inserted at the top of the CDF file
   (before any CDF lines):

      &lt;% Response.ContentType = "application/x-cdf" %&gt;

   This ensures that servers return the MIME/content type
   "application/x-cdf." Problems with CDF files being displayed inside the
   browser as HTML text rather than presenting a subscription wizard are
   very likely caused by the server returning an incorrect MIME type of
   "text/html."

   Note: As an alternative for IIS 4.0 site authors, the CDF file can be
   created with a .cdx extension instead of .asp, and the MIME content type
   line above can be omitted.

   For simplicity, the &lt;LOGO&gt; tags have been omitted in the sample CDF
   file. As a result, the default satellite dish logo is displayed in the
   desktop channel bar and in the channel pane.

</PRE><P><LI>To try it, put these two files (Products.htm and Gencdf.asp) on the same
   directory on an IIS Server. From the Internet Explorer address bar, type
   in the http address to Products.htm
   (<B>http://&lt;server</B> location&gt;/Products.htm), and select the products you're
   interested in. (Note that simply clicking on Products.htm
   from Windows Explorer--that is, launching the file locally--will not
   work, as this will cause the GenCDF.ASP to get launched using the file
   protocol which does not work for ASP files.)

<P><LI>Click Subscribe. This should launch the "Add Channel" wizard. If all is
   well, you should see the "Sample MS Custom Channel" appear on the
   channel pane, as well as at the bottom of the desktop channel bar.
   Clicking on the "Sample MS Custom Channel" from the desktop channel bar
   should bring up the Microsoft home page, as well as subchannels for the
   selected products. (If no products were selected, no subchannels should
   appear.)
<P>
</OL><h2>REFERENCES</h2>
 
<P>
"Creating Active Channels" section of the Internet Client SDK documentation
CDF Reference in the Internet Client SDK documentation
<P>
 
<PRE>Keywords          : InetSDKInfoDev
Technology        : kbInetDev
Version           : WINDOWS:4.0,4.01
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
