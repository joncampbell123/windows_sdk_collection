

<HTML>
<HEAD>
<TITLE>FILE: IEZOOM.EXE Changes the Font Size of WebBrowser Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156693">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1996/09/29">
<META NAME="Keywords" CONTENT="AXSDKWebBrowser kbgraphic">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  IEZOOM demonstrates how to change the font size of the text displayed in a Web Browser control embedded in an MFC container application.  The following file is available for download from the Microsoft Software Library:   ~ Iezoom.exe  For more inf...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV9,QBRJ,QAVZ,QAY2,QAB5,QADF,QBV8,QA7O,QAPF,QAMN,QBJZ,QAB9,QBBS,QAOE,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: IEZOOM.EXE Changes the Font Size of WebBrowser Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156693</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ActiveX SDK, version 1.0
<LI>Internet Client SDK, version 4.0, 4.01
<LI>Microsoft Internet Explorer 3.0, 3.01, 3.02, 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
IEZOOM demonstrates how to change the font size of the text displayed in a
Web Browser control embedded in an MFC container application.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/iezoom.exe">Iezoom.exe</A> <I>(size: 51155 bytes)</I> 

</PRE>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Internet Explorer (IE) obtains much of its functionality
from COM objects implemented in Shdocvw.dll, Mshtml.dll, and Urlmon.dll.
The IE application itself is a thin wrapper that aggregates the
functionality of these components. Developers who wish to tap directly into
the functionality of these underlying components are frequently interested
in mimicking the functionality of IE. While many IE features are exposed
through the Web Browser (SHDOCVW) control's automation model, other
features available on the IE menus, including changing the font size of
the text of the current page, are not exposed this way. This sample
demonstrates how to use the IOleCommandTarget interface to change the font
size of the text of the current page displayed by a WebBrowser control.
<P>
The IOleCommandTarget interface consists of two methods, QueryStatus and
Exec, in addition to the IUnknown methods. QueryStatus allows the client to
determine if an object supports a particular command. If QueryStatus
indicates that the specified command is enabled, the client can call Exec
to execute or show Help for the command. The list of standard command
identifiers is defined in the OLECMDID enumeration in the header file
DOCOBJ.H. For more information on the IOleCommandTarget interface, see the
Internet Client SDK online documentation.
<P>
The sample is a Microsoft Foundation Classes (MFC) 4.2 SDI application that
mimics the functionality of the Fonts pop-up under IE's View menu. Both
the sample and IE provide the user with five scaling factors: largest,
large, medium, small, smallest. While a page is displayed in medium by
default, choosing any of the other options scales the text of the page up
and down respectively. The following code taken from the sample shows how
to accomplish this using the IOleCommandTarget interface:
<P>
<PRE>   void CIezoomView::ChangeScale(IEScaleSize scaleSize)
   {
      HRESULT hr;

      LPDISPATCH pDisp = NULL;
      LPOLECOMMANDTARGET pCmdTarg = NULL;

      if (!m_wb.m_hWnd)
      {
         TRACE("Web Browser Control not yet created.\n")
         return;
      }

      pDisp = m_wb.GetDocument();

      if (!pDisp)
      {
         TRACE("Unable to get document from Web Browser.\n");
         return;
      }

      // The document controls the availability of commands items,
      // so get the OLE command target interface from the document
      hr = pDisp-&gt;QueryInterface(IID_IOleCommandTarget,
   (LPVOID*)&amp;pCmdTarg);
      if (pCmdTarg)
      {
         // Now use the command target to do something useful
         // like (un-)zoom the page
         OLECMD rgCmd[1] = {{OLECMDID_ZOOM, 0}};
         // Is the command available for execution?
         hr = pCmdTarg-&gt;QueryStatus(NULL, 1, rgCmd, NULL);
         if (SUCCEEDED(hr) &amp;&amp; OLECMDF_ENABLED == rgCmd[0].cmdf)
         {
            TRACE("Zoom enabled.\n");
            VARIANT vaZoomFactor;   // Input arguments
            VariantInit(&amp;vaZoomFactor);
            V_VT(&amp;vaZoomFactor) = VT_I4;
            V_I4(&amp;vaZoomFactor) = fontSize;
            hr = pCmdTarg-&gt;Exec(NULL, OLECMDID_ZOOM,
                     OLECMDEXECOPT_DONTPROMPTUSER,
                     &amp;vaZoomFactor, NULL);
            VariantClear(&amp;vaZoomFactor);
         }
         else
         {
            TRACE("Unable to query for status of command ;
            (OLECMDID_ZOOM).\n");
         }
      }
      else
      {
         TRACE("Unable to get command target from Web Browser ;
         document.\n");
      }

      if (pCmdTarg) pCmdTarg-&gt;Release(); // release document's command
                                            target

      if (pDisp) pDisp-&gt;Release(); // release document's dispatch interface
   }

</PRE><h3>Steps To Run</h3>
 

<OL><P><LI>Build the IEZoom sample.

<P><LI>Run the IEZoom sample.
<P>
</OL>If you are connected to the Internet, the ActiveX page on www.microsoft.com
will be displayed. If you do not have an Internet connection, modify the
Navigate() call in CIezoomView::OnCreate() by passing a different URL.

<OL><P><LI>From the View Menu, choose a different font selection.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SCALE SCALING WEBBROWSER<BR>
Keywords          : AXSDKWebBrowser kbgraphic<BR>
Technology        : kbMfc<BR>
Version           : 1.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbfile<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
