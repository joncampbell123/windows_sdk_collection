

<HTML>
<HEAD>
<TITLE>HOWTO: Print from the Microsoft Web Browser Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156732">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1996/09/30">
<META NAME="Keywords" CONTENT="MfcOLE kbprint kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  The Web Browser component of Internet Explorer 3.x and 4.x does not support a Print method. You can still print the contents of the Web Browser control using one of these methods:   - Set focus to the Web Browser control and send a key combination ...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QAOX,QA7O,QAB5,QAOE,QAMN,QAI4,QAPN,QAGI,QADO,QAUD,QAQW,QA6A,QARL,QAK9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Print from the Microsoft Web Browser Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156732</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Visual C++, 32-bit Edition, version 5.0
<LI>Internet Explorer 3.0, 3.01, 3.02, 4.0, 4.01
<LI>Internet Client SDK, version 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Web Browser component of Internet Explorer 3.x and 4.x does not support
a Print method. You can still print the contents of the Web Browser
control using one of these methods:

<UL><LI>Set focus to the Web Browser control and send a key combination of
   CTRL+P.
<P>
   -or-

<LI>Call the GetDocument() method that returns an IDispatch*. Using
   the IDispatch*, call QueryInterface() on IID_IOleCommandTarget.
   With the object pointer returned, call Exec(NULL, OLECMDID_PRINT,
   0, NULL,NULL).
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The following code can be used to cause the Web Browser control to
print its contents. In this example, m_ctlWebBrowser is an instance of
the wrapper class generated by Class Wizard for the control.
m_ctlWebBrowser is contained in a dialog and initialized in the
OnInitDialog function. A "Print" button on the dialog is wired to an
OnPrint function. The "Print" button is enabled in response to the
NavigateComplete event of the Web Browser control.
<P>
<P>
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>   BOOL CAboutDlg::OnInitDialog()
   {
       CDialog::OnInitDialog();

       m_ctlWebBrowser.Navigate(_T("<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>"),
                                NULL, NULL, NULL, NULL);
       return TRUE;
   }

</PRE><h3>Method #1</h3>
 
<P>
<PRE>   void CAboutDlg::OnPrint()
   {
       CWnd* pWnd = GetFocus ();

       m_ctlWebBrowser.SetFocus ();
       // send Ctrl-P
       keybd_event (VK_CONTROL, 0, 0, 0);
       keybd_event ('P', 0, 0, 0);

       // set focus to control that previously had focus
       if (pWnd);
           pWnd-&gt;SetFocus ();
   }

</PRE><h3>Method #2</h3>
 
<P>
<PRE>   // DOCOBJ.H comes with the Internet Client SDK and is installed by
   // default in the "\INetSDK\Include" directory
   #include &lt;docobj.h&gt;

   void CAboutDlg::OnPrint()
   {
       LPDISPATCH lpDispatch = NULL;
       LPOLECOMMANDTARGET lpOleCommandTarget = NULL;

       lpDispatch = m_ctlWebBrowser.GetDocument();
       ASSERT(lpDispatch);

       lpDispatch-&gt;QueryInterface(IID_IOleCommandTarget,
                                  (void**)&amp;lpOleCommandTarget);
       ASSERT(lpOleCommandTarget);

       lpDispatch-&gt;Release();

       // print contents of web browser control
       lpOleCommandTarget-&gt;Exec(NULL, OLECMDID_PRINT, 0, NULL,NULL);

       lpOleCommandTarget-&gt;Release();
   }

</PRE><h2>REFERENCES</h2>
 
<P>
Internet Client SDK Online documentation.
 
<PRE>Keywords          : MfcOLE kbprint kbhowto
Technology        : kbole kbmfc
Version           : 4.2
Platform          : NT WINDOWS</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
