

<HTML>
<HEAD>
<TITLE>DOCERR: FtpGetFile &amp; FtpOpenFile Flags Documented Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157607">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1996/10/15">
<META NAME="Keywords" CONTENT="AXSDKWinInet kbdsi">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  Early editions of the ActiveX SDK documentation for the Win32 Internet API FtpGetFile incorrectly specify the fifth parameter dwFlagsAndAttributes. This parameter should be used only for file attributes. All flags should instead be specified in the...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAAP,QBBI,QAGI,QAY2,QBSO,QAHV,QAR4,QAPF,QAKJ,QAIF,QAG2,QDMW,QBVV,QBGO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DOCERR: FtpGetFile &amp; FtpOpenFile Flags Documented Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157607</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ActiveX SDK 1.0
<LI>Microsoft Internet Client SDK, versions 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Early editions of the ActiveX SDK documentation for the Win32 Internet API
FtpGetFile incorrectly specify the fifth parameter dwFlagsAndAttributes.
This parameter should be used only for file attributes. All flags should
instead be specified in the sixth parameter, dwFlags.
<P>
In addition, these editions of the documentation for FtpOpenFile does not
state clearly that you can specify other flags in the fourth parameter,
dwFlags.
<P>
These errors have been corrected in later editions of the documentation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ActiveX SDK FtpGetFile documentation defines the fifth parameter
dwFlagsAndAttributes as follows:
<P>
<PRE>   "File attributes and flags for the new file. Can be any combination of
   FILE_ATTRIBUTE_* and INTERNET_FLAG_* file attributes. See CreateFile for
   further information on FILE_ATTRIBUTE_* attributes, and see
   InternetOpenUrl for further information on INTERNET_FLAG_* flags."

</PRE>This is incorrect. The fifth parameter should be used only for
FILE_ATTRIBUTE_* settings applicable to the file written by FtpGetFile. For
INTERNET_FLAG_* flags, these should instead be used in the sixth parameter,
dwFlags.
<P>
For example, FtpGetFile calls that use INTERNET_FLAG_RELOAD to indicate
that FTP files should always be received from the wire and not from the
cache work incorrectly if this flag is OR'ed into the fifth parameter.
<P>
Here is a correct example of where to specify the INTERNET_FLAG_RELOAD
flag:
<P>
<PRE>// A valid FtpGetFile call that always reads from the wire
</PRE>BOOL result = FtpGetFile(hMyFtpSession, // hFtpSession
<PRE>   _T("ILoveTheInformationSuperhighway.tla"), // lpszRemoteFile
   _T("C:\\Temp\\HereItIs.tla"), // lpszNewFile
   FALSE, // fFailIfExists
   FILE_ATTRIBUTE_NORMAL, // so-called "dwFlagsAndAttributes"
   FTP_TRANSFER_TYPE_BINARY | INTERNET_FLAG_RELOAD, // dwFlags
   dwMyFtpContext); // dwContext

</PRE>Similarly, the FtpOpenFile documentation should indicate that the fourth
parameter, dwFlags, can be used to specify any combination of the cache
control flags and one of the FTP_TRANSFER_TYPE_* flags. For example, it is
legal to do the following:
<P>
<PRE>// A valid FtpOpenFile call that always reads from the wire
</PRE>BOOL result = FtpOpenFile(hMyFtpSession, // hFtpSession
<PRE>                          _T("LoneStarReview.doc"), // lpszFileName
                          GENERIC_READ, // fdwAccess
            FTP_TRANSFER_TYPE_BINARY | INTERNET_FLAG_RELOAD, // dwFlags
                          dwMyFtpContext); // dwContext
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: cache caching<BR>
Keywords          : AXSDKWinInet kbdsi<BR>
Version           : 1.0,4.0,4.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
