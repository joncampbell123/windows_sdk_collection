

<HTML>
<HEAD>
<TITLE>PRB: &lt;USAGE VALUE="Email"&gt; in a CDF Does Not Send E-mail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174546">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/10/01">
<META NAME="Keywords" CONTENT="AXSDKMisc InetSDKInfoDev">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  Despite the fact that                       has been specified for a parent ITEM element in a CDF file, the subscribed user never receives the e-mail when a content update occurs.  CAUSE =====  Two things may cause this problem to occur: either the...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBII,QAYC,QBWA,QBWD,QAXB,QBBI,QBWS,QBD2,QAC1,QAG2,QBXS,QA6A,QAY2,QAYZ,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: &lt;USAGE VALUE="Email"&gt; in a CDF Does Not Send E-mail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174546</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, versions 4.0, 4.01
<LI>Microsoft Internet Explorer (Programming), versions 4.0, 4.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Despite the fact that &lt;USAGE VALUE="Email"&gt; has been specified for a parent
ITEM element in a CDF file, the subscribed user never receives the e-mail
when a content update occurs.
<P>
<P><h2>CAUSE</h2>
 
<P>
Two things may cause this problem to occur: either the user did not
specifically ask to receive e-mail notifications for content update when he
or she subscribed to the channel, or the SMTP server was not specified
correctly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In order for channel email notifications to get sent, all three conditions
have to be met:

<OL><P><LI>Specify &lt;USAGE VALUE="Email"&gt; in your CDF file, as in this example:
<P>
<P><PRE>      &lt;CHANNEL href="<b><A href="http://example.microsoft.com">http://example.microsoft.com</A></B>"&gt;
<PRE></PRE>         &lt;ITEM href="<b><A href="http://example.microsoft.com/emailthis.htm&gt;">http://example.microsoft.com/emailthis.htm&gt;</A></B>
            &lt;USAGE VALUE="Email" /&gt;
         &lt;/ITEM&gt;
      &lt;/CHANNEL&gt;

</PRE><P><LI>When subscribing to the channel, click the Customize button
   and select YES when asked if you want to be notified in an e-mail
   message when the page has changed. (This was added as a pre-requisite
   to receiving e-mail in response to user complaints about receiving
   unwanted e-mail from sites they subscribed to. Therefore, unless the
   user chooses to be notified, no e-mail will be sent.)

<P><LI>When prompted for an e-mail address, click the Change Address button and
   specify the right SMTP server name. If you do not know, ask your ISP
   (Internet Service Provider) what server name to specify.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If all three conditions above are met, an e-mail notification is sent to
the subscribed user in this format:
<P>
<PRE>   Subject:   Internet Explorer Notice: &lt;web site title&gt;
   Message:   &lt;site URL&gt; Your subscription to &lt;web site title&gt; has been
              updated.
              To view the subscription offline, click here: &lt;site URL&gt;

                             This message was sent by the Internet Explorer
4.0
              Information Delivery Agent.

</PRE></OL>If your e-mail client is HTML-aware, then the e-mail received is the actual
Web page specified in the &lt;ITEM&gt; tag in the CDF file.
<P>
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a simple .cdf file with the following text. Save the file as
   Simple.CDF, and make it available on your HTTP server:
<P>
<P><PRE>      &lt;channel href="<b>http://&lt;server</B> name&gt;/test.htm"&gt;
<PRE></PRE>         &lt;ITEM href="<b>http://&lt;server</B> name&gt;/mailme.htm"&gt;
            &lt;USAGE VALUE="Email" /&gt;
         &lt;/ITEM&gt;
      &lt;/channel&gt;

</PRE><P><LI>Run Simple.CDF through Xmlint.exe and Cdftest.exe (available in
   the Internet Client SDK under \inetsdk\bin\XMLint and
   \inetsdk\bin\cdftest, respectively).
<P>
   Verify that no errors are found in your .CDF file.

<P><LI>Subscribe to <B>http://&lt;your</B> server name&gt;/simple.cdf.

<P><LI>From the "Add Channel" wizard, click the Customize button, and when
   asked if you would like to get notified in an e-mail message when the
   page changes, select YES, click on the "Change Address" button and
   specify the correct e-mail address and SMTP server name to be used.
   Click the Finish button, and click OK to exit the Channel wizard.

<P><LI>The page you just subscribed to should come up full-screen in a channel
   window. (In the example above, Test.htm comes up full-screen.)

<P><LI>Modify the .cdf file to simulate a content update.

<P><LI>From the desktop channel bar, right-click on your newly added
   Simple.cdf channel, and select Update Now. This should cause your
   files to get downloaded again. And if changes were detected, should
   display a red gleam on the upper left hand corner of your channel logo.
<P>
   Or from Manage Subscriptions, right-click on your page, and choose
   Update Now. Verify that changes were detected, with the gleam on your
   icon, and Status set to "Updated."
<P>
   Note that if any of the HTMs specified as &lt;ITEM&gt; tags in the CDF are
   modified in step 6 above, instead of the CDF file, no changes are
   detected (that is, Status set to "Updated: No changes detected"), and
   therefore no gleam is displayed.

<P><LI>If new content is found, and assuming you specified the correct e-mail
   address and SMTP name, you should get an e-mail notification in your
   mailbox.
<P>
</OL>The information in this article also applies to e-mail notifications being
sent when a user subscribes to a favorite site directly (that is, from
Internet Explorer, navigating to your favorite site, and from the menu,
choosing to Add to Favorites). The only time an e-mail notification is sent
is if the user specifically clicks on the Customize button and asks to get
notified in e-mail when content is updated.
<P>
To subscribe to a Web page directly:

<UL><LI>Navigate to the page (preferably one you can change, so that you'll be
   able to see how when the page is updated, you get notified).

<LI>Select Favorites/Add to Favorites. Choose to Subscribe to the page,
   either  to tell you when page is updated, or to download the page for
   offline viewing.

<LI>Click on Customize and when prompted to receive notifications via e-
   mail, say Yes, and click on Change Address button and specify an e-mail
   address and SMTP names correctly. These are important to specify here.
   Otherwise, no e-mail will be received.

<LI>Click Finish, and click OK out of the Add Favorites wizard.

<LI>Now make a change to the .htm page you just subscribed to.

<LI>From Internet Explorer's Favorites menu, select Manage subscriptions.
   Select the site you subscribed to from the list, right-click on it and
   choose to "Update now."

<LI>Verify that your changes were detected by noticing a gleam on the upper-
   left hand corner of the icon next to your page name on the Manage
   Subscriptions list, and Status set to "Site changed."

<LI>Check your e-mail client and look for a mail message with subject line
   "Internet Explorer Notice: &lt;site URL&gt;"...same as above
<P>
</UL><h2>REFERENCES</h2>
 
<P>
Internet Client SDK documentation
<P>
 
<PRE>Keywords          : AXSDKMisc InetSDKInfoDev
Technology        : kbInetDev
Version           : WINDOWS:4.0,4.01
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
