

<HTML>
<HEAD>
<TITLE>HOWTO: Determining Whether a User Is Subscribed to a Channel </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175504">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/10/22">
<META NAME="Keywords" CONTENT="iegeneral kbcode">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  With the introduction of Active Channels in Internet Explorer 4.0, it may be desirable to determine whether a user is already subscribed to a channel, so that a Web page or an application does not redundantly offer users the ability to subscribe to...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBS0,QBII,QAH4,QAVX,QAVW,QBW2,QBRJ,QAGU,QBWA,QBV9,QBVV,QAVZ,QABH,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Determining Whether a User Is Subscribed to a Channel</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175504</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, versions 4.0, 4.01
<LI>Microsoft Internet Explorer (Programming), versions 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With the introduction of Active Channels in Internet Explorer 4.0, it may
be desirable to determine whether a user is already subscribed to a
channel, so that a Web page or an application does not redundantly offer
users the ability to subscribe to a channel they've already subscribed to.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article describes how to check a subscription from C++, Visual Basic,
and script.
<P>
<P><h3>C++ - using ISubscriptionMgr::IsSubscribed</h3>
 
<P>
The code below demonstrates how this can be done using C++,
from a console application:
<P>
<PRE>   #include &lt;windows.h&gt;
   #include &lt;tchar.h&gt;
   #include &lt;iostream.h&gt;
   #include &lt;subsmgr.h&gt;
   #include &lt;stdio.h&gt;

   void main()
   {
      ISubscriptionMgr *pSubscriptionMgr;
      CoInitialize(NULL);

      HRESULT hr = CoCreateInstance(CLSID_SubscriptionMgr,
                                    NULL,
                                    CLSCTX_INPROC_SERVER,
                                    IID_ISubscriptionMgr,
                                    (void**)&amp;pSubscriptionMgr);
      if (SUCCEEDED(hr))
      {
         BOOL Bool;
         BSTR bstrURL =
           SysAllocString(L"<B><A href="http://test.microsoft.com/tst.cdf">http://test.microsoft.com/tst.cdf</A></B>");
         hr = pSubscriptionMgr-&gt;IsSubscribed(bstrURL, &amp;Bool);

         pSubscriptionMgr-&gt;Release();

         char szBuffer[250];
         TCHAR szURL[200];
         WideCharToMultiByte(CP_ACP, 0, bstrURL, -1, szURL, 200, NULL,
                             NULL);
         if (Bool)
             wsprintf (szBuffer,"YES, you are subscribed to %s\n",szURL);
         else
             wsprintf (szBuffer,"NOPE, you are NOT subscribed to %s\n",
                        szURL);
         cout &lt;&lt; szBuffer;
         SysFreeString (bstrURL);
      }

      CoUninitialize();
   }

</PRE>Visual Basic - Using the ShellUIHelper Object
 
<P>
The code below demonstrates how this can be done in a standard Visual Basic
application. To use the ShellUIHelper object, use Project-&gt;References to
add a reference to "Microsoft Internet Controls."
<P>
<PRE>   Private Sub Form_Load()
       Dim ShlHlpr As ShellUIHelper

       Set ShlHlpr = New ShellUIHelper

       If ShlHlpr.IsSubscribed("<B><A href="http://test.microsoft.com/tst.cdf">http://test.microsoft.com/tst.cdf</A></B>") Then
           MsgBox "You're Subscribed!"
       Else
           MsgBox "You're not Subscribed!"
       End If
   End Sub

</PRE><h3>Script - Using window.external.isSubscribed</h3>
 
<P>
The code below demonstrates how this can be done, using JavaScript
in an .htm page:
<P>
<PRE>   &lt;SCRIPT&gt;
     if (window.external.isSubscribed("<B><A href="http://test.microsoft.com/tst.cdf">http://test.microsoft.com/tst.cdf</A></B>"))
        alert ("You are subscribed!");
     else
        alert ("You are NOT subscribed!");
   &lt;/SCRIPT&gt;

</PRE>Cross-frame security rules apply to this script call. Script in a document
can only check to see if the user is subscribed to sites on the same
domain.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Internet Client SDK documentation
<P>
 
<PRE>Keywords          : iegeneral kbcode
Technology        : kbInetDev
Version           : WINDOWS:4.0,4.01
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
