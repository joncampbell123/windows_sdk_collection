

<HTML>
<HEAD>
<TITLE>HOWTO: Invoke the "Add to Favorites" Dialog Box in IE4 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q182034">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1998/03/04">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; axsdk">
<META NAME="Description" CONTENT="  The  Add to Favorites  dialog box provides a user interface for the user to save a Web page as a favorite. The ShellUIHelper::AddFavorite method can be used to invoke this dialog box from a Visual C++ or Visual Basic application or from script on a...">
<META NAME="Product" CONTENT="ActiveX SDK">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ActiveX ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QDNQ,QBWA,QAVZ,QBTI,QBV9,QA56,QA55,QBFY,QA01,QAB0,QBRJ,QBB3,QA3N,QBWR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Invoke the "Add to Favorites" Dialog Box in IE4</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q182034</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Internet Client SDK, version 4.0
<LI>Microsoft Internet Explorer (Programming), versions 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "Add to Favorites" dialog box provides a user interface for the user to
save a Web page as a favorite. The ShellUIHelper::AddFavorite method can be
used to invoke this dialog box from a Visual C++ or Visual Basic
application or from script on a Web page.
<P>
Please note that you must install the Internet Client SDK before you can
implement this code in Visual C++.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The AddFavorite method takes two parameters. The first parameter is the URL
of the Web page to save as a favorite. The second parameter is the title to
be used for this favorite (optional).
<P>
When specifying the URL to save as a favorite, you must specify the
protocol type (<B>http://,</B> file://, and so forth) If you do not specify the
protocol, AddFavorite will return E_FAIL (0x80004005) in Visual C++, and a
run-time error in Visual Basic or script.
<P>
<P><h3>Scripting</h3>
 
<P>
<PRE>   &lt;OBJECT ID="ShellUIHelper" WIDTH=0 HEIGHT=0
      CLASSID="CLSID:64AB4BB7-111E-11d1-8F79-00C04FC2FBE1"&gt;
   &lt;/OBJECT&gt;

   &lt;SCRIPT LANGUAGE=VBSCRIPT&gt;
      ShellUIHelper.AddFavorite "<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>", "Microsoft"
   &lt;/SCRIPT&gt;

</PRE><h3>Visual C++</h3>
 
<P>
To invoke the "Add to Favorites" dialog box from a Visual C++ application
that is hosting the WebBrowser control, insert the following code in your
application:
<P>
<PRE>   #include "ExDisp.h"

   IShellUIHelper* pShell = NULL;
   HRESULT hr = CoCreateInstance(CLSID_ShellUIHelper, NULL, CLSCTX_SERVER,
                                 IID_IShellUIHelper, (void**)&amp;pShell);
   if (hr == S_OK)
   {
      COleVariant vtTitle("Microsoft");
      pShell-&gt;AddFavorite(OLESTR("<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>"), &amp;vtTitle);
      pShell-&gt;Release();
   }

</PRE>NOTE: The \Inetsdk\Include directory must be listed first in the
Directories tab of the settings for the project.
<P>
<P><h3>Visual Basic</h3>
 
<P>
To invoke this dialog box in a Visual Basic application, add a reference to
Shdocvw.dll to your project if your application is not hosting the
WebBrowser control:
<P>
<PRE>   Dim shellHelper As New ShellUIHelper
   shellHelper.AddFavorite "<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>", "Microsoft"

</PRE><h2>REFERENCES</h2>
 
<P>
Internet Client SDK Help:
<P>
<PRE>   <B><A href="http://www.microsoft.com/msdn/sdk/inetsdk/help/">http://www.microsoft.com/msdn/sdk/inetsdk/help/</A></B>

</PRE>(c) Microsoft Corporation 1998, All Rights Reserved. Contributions by Scott
Roberts, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: IShellUIHelper AddFavorite<BR>
Technology        : kbInetDev<BR>
Version           : WINDOWS:4.0,4.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
