

<HTML>
<HEAD>
<TITLE>Troubleshooting H/PC-to-Desktop Computer Connectivity </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162116">
<META NAME="KBModify" CONTENT="1997/04/14">
<META NAME="KBCreate" CONTENT="1997/01/14">
<META NAME="Keywords" CONTENT="handheld wince kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; handheld, hw">
<META NAME="Description" CONTENT="  This article describes steps to help you troubleshoot problems connecting your Handheld PC (H/PC) to your desktop computer.  MORE INFORMATION  The following resources provide information for troubleshooting connectivity problems between your H/PC a...">
<META NAME="Product" CONTENT="Handheld PC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAI5,QBWQ,QAIJ,QBWS,QBG2,QAA1,QDI4,QBXT,QA5V,QAIB,QDIO,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting H/PC-to-Desktop Computer Connectivity</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162116</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows CE version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes steps to help you troubleshoot problems connecting
your Handheld PC (H/PC) to your desktop computer.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following resources provide information for troubleshooting
connectivity problems between your H/PC and your desktop computer using
H/PC Explorer:

<UL><LI>Chapter 14, "Fine-Tuning And Troubleshooting," in the "Handheld PC
   User's Guide."

<LI>The "Communication Troubleshooter" and "I have trouble connecting after
   my desktop computer wakes up from Suspend (or Sleep) mode" topics in
   H/PC Explorer Help.
<P>
</UL>If you continue to experience connectivity problems after following the
instructions in these resources, perform the following steps. After
performing each step, check to see if the problem has been resolved.
<P>
NOTE: These instructions assume that Windows 95 is installed in the
Windows folder on drive C. If you are using a different drive or folder,
adjust the following instructions accordingly.

<OL><P><LI>You may experience connectivity problems if there is not enough
    available program memory. To resolve this issue, follow these steps:
<P>
    a. Tap the Start button, tap Settings, and then double-tap System.
<P>
    b. Tap the Memory tab, move the slider to the left to free at least
       135K of program memory, and then tap OK.
<P>
    c. Close all running programs, and then press the Reset button on your
       H/PC.

<P><LI>On your desktop computer, remove all the communications ports listed
    in Device Manager, and then restart your computer. If your computer
    does not redetect the communication ports when Windows 95 starts, run
    the Add New Hardware wizard to redetect the ports.

<P><LI>On your desktop computer, remove H/PC Explorer and Direct Cable
    Connection using the Add/Remove Programs tool in Control Panel, remove
    all networking components, and then restart your computer. When your
    computer restarts, reinstall H/PC Explorer, which will reinstall the
    TCP/IP protocol, the Dial-Up adapter, and Direct Cable Connection.

<P><LI>Check for multiple copies of the Winsock.dll and Wsock32.dll files on
    your desktop computer's hard disk. The Winsock.dll file should be
    located in the Windows folder with a size of 42,080 bytes and a date
    of 07-11-95. The Wsock32.dll file should be located in the Windows\
    System folder with a size of 66,560 bytes and a date of 07-11-95.
    Rename any other copies of the files.

<P><LI>Lower the baud rate. To do so, follow these steps.
<P>
    NOTE: These instructions require that your H/PC serial cable is
    connected to COM1 on your desktop computer.
<P>
    a. On your H/PC, tap the Start button, tap Programs, double-tap
       Communication, and then double-tap Remote Networking.
<P>
    b. Double-tap Make New Connection, type a name for the new connection
       in the "Type a name for the connection" box, tap Direct Connection,
       and then tap Next.
<P>
    c. In the "Select the device that you want to use" box, tap Serial
       Cable On COM1, and then tap Configure.
<P>
    d. In the Baud Rate box, tap a speed less than 19,200, tap OK, and
       then tap Finish.
<P>
    e. In Control Panel, double-tap Communications, tap the PC Connection
       tab, and then tap Change.
<P>
    f. In the Connect To Desktop Computer Using box, tap the name of the
       Remote Networking connection you created in step B, tap OK,
       and then tap OK again.
<P>
    g. On your desktop computer, double-click System in Control Panel, and
       then click the Device Manager tab.
<P>
    h. Double-click the Modems branch to expand it.
<P>
    i. Double-click Serial Cable On COM1 to open the Serial Cable On COM1
       properties, and then click the Modem tab.
<P>
    j. In the Maximum Speed box, click the same speed (or baud rate) that
       you selected in step D, click OK, and then click OK again.
<P>
    k. Restart your computer.

<P><LI>Low battery power may result in connectivity problems. If your H/PC is
    equipped with an AC adapter, try to connect your H/PC and desktop
    computer while the H/PC is powered by the AC adapter. If your
    H/PC is battery-powered only, install new batteries and then
    try to connect.

<P><LI>If your desktop computer has more than one serial port, connect the
    cable to a different 9-pin serial port.

<P><LI>Try to connect using a different H/PC serial cable.

<P><LI>Disable all lines in the [386Enh] section of the System.ini file that
    have either of the following forms:
<P>
     - device=&lt;filename&gt;.386
     - com&lt;number&gt;=irq&lt;number&gt;
<P>
    To disable a line, place a semicolon (;) at the beginning of the line.
    After disabling all such lines, restart the computer. If this resolves
    the problem, use the following process to determine which lines cause
    the problem:
<P>
    a. Re-enable one disabled line, and then restart the computer.
<P>
    b. If you do not experience connectivity problems, leave the line
       enabled. If you do experience connectivity problems, disable the
       line again.
<P>
    c. Repeat steps A-B until you have tested each line.

<P><LI>Disable the "load=" and "run=" lines in the [Windows] section of the
    Win.ini file by placing a semicolon at the beginning of each line,
    remove any programs from the Startup folder, and then restart the
    computer. If this resolves the problem, test each program on the
    "load=" and "run=" lines to determine which program causes the
    problem.

<P><LI>To eliminate the possibility of real-mode terminate-and-stay-resident
    programs (TSRs) and device drivers causing a problem, restart your
    computer. When you see the "Starting Windows 95" message, press the F8
    key, choose Step-By-Step Confirmation from the Startup menu, and then
    load the following items when you are prompted:
<P>
     - Dblspace driver (if the hard disk is compressed).
     - Do not process the Config.sys file.
     - Himem.sys.
     - Ifshlp.sys.
     - Dblbuff.sys (if you are prompted).
     - Do not process the Autoexec.bat file.
     - Load the Windows 95 graphical user interface (GUI), choosing to
       load all Windows drivers.
<P>
    If this resolves the problem, isolate the conflict with a TSR or real-
    mode device driver using the step-by-step confirmation function.

<P><LI>To create a new System.ini file that does not load third-party
    device drivers, follow these steps:
<P>
    a. Restart your computer to a command prompt. To do so, restart your
       computer, press the F8 key when you see the "Starting Windows 95"
       message, and then choose Command Prompt Only from the Startup
       menu.
<P>
    b. Type the following lines, pressing ENTER after each line:
<P>
<PRE>          cd \windows
          ren system.ini system.xxx
          copy system.cb system.ini
          edit system.ini

    c. Add the following lines at the top of the System.ini file:

          [boot]
          mouse.drv=mouse.drv
          drivers=mmsystem.dll

    d. Add the following line in the [386Enh] section of the file:

          mouse=*vmouse

    e. Save the System.ini file and then quit the editor.

    f. Type "win" (without quotation marks) to start Windows 95.

       NOTE: If your mouse does not work when Windows 95 starts, it is
       likely that it is not supported by the standard Windows 95 mouse
       driver. You can install the Windows 3.1 driver included with your
       mouse to regain mouse functionality. For information about
       installing the driver, consult the documentation included with the
       mouse.

</PRE><P><LI>Restore the registry files. For information about troubleshooting the
    registry files, see the "Using System.1st" and "Reinstalling Windows
    95" sections in the following article in the Microsoft Knowledge Base:
<P>
       ARTICLE-ID: <B><A href="../win95x/q131431.htm">Q131431</A></B>
<PRE>       TITLE     : How to Troubleshoot Registry Errors

</PRE><P><LI>Reinstall Windows 95 to a new folder. This step helps to establish
    whether the problem is related to a remnant of the previous operating
    system (such as a configuration setting) or a hardware problem. For
    information about reinstalling Windows to a new folder, see the
    following article in the Microsoft Knowledge Base:
<P>
       ARTICLE-ID: <B><A href="../win95x/q142096.htm">Q142096</A></B>
<PRE>       TITLE     : How to Reinstall Windows 95 to a New Folder

</PRE><P><LI>Install H/PC Explorer on a different desktop computer, and then
    connect your H/PC to the new computer. If you can successfully connect
    your H/PC to a different desktop computer, there may be a hardware
    problem with the serial port(s) on your desktop computer. If you
    cannot successfully connect to the new computer, perform steps 1-14
    on the new desktop computer.
<P>
</OL>If you still cannot connect your H/PC to a desktop computer, the
connectivity problem may be the result of a hardware issue such as a
malfunctioning serial cable or H/PC. Contact the manufacturer of your
H/PC.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hand held<BR>
Keywords            : handheld wince kbtshoot<BR>
Version             : 1.00<BR>
Platform            : WINDOWS<BR>
Issue type          : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
