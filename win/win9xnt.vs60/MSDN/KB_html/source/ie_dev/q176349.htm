

<HTML>
<HEAD>
<TITLE>BUG: GP Fault in Comctl32.dll with IE 4.0 Installed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176349">
<META NAME="KBModify" CONTENT="1998/02/18">
<META NAME="KBCreate" CONTENT="1997/11/05">
<META NAME="Keywords" CONTENT="msiexplore kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  You may receive the following GP Fault when updating toolbar buttons in any application. This seems to happen most likely when removing a button by dragging it off the toolbar.  The instruction at  70dc2ad4  referenced memory at  0x0000008.  The me...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBKN,QAR4,QBV9,QBRJ,QA5D,QBWP,QDO3,QAH4,QAM1,QAA1,QANS,QAEV,QAEF,QDIX,QBW9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: GP Fault in Comctl32.dll with IE 4.0 Installed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176349</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer, version 4.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive the following GP Fault when updating toolbar buttons in any
application. This seems to happen most likely when removing a button by
dragging it off the toolbar.
<P>
The instruction at "70dc2ad4" referenced memory at "0x0000008." The memory
could not be "read."
<P>
-or-
<P>
&lt;Application Name&gt; caused an exception 03H in module KERNEL32.DLL at
0137:BF767D8.
<P>
<P><h2>CAUSE</h2>
 
<P>
When dragging a button off the toolbar, you'll want to delete the button
since it will no longer appear. When the button is released, a ButtonUp
Message is handled by COMCTL32. You issue an EndDrag message and then
continue processing the Button Up Message. Your EndDrag routine should be
where the Delete Button code exists so once it returns to the ButtonUp
Message code, you do not have a button object anymore. The NULL button then
tries to get de-referenced and this causes the GP Fault.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Obtain the following fix or wait for the next Microsoft Internet Explorer
version 4.0 service pack.
<P>
This fix should have the following timestamp:
<P>
<PRE>   For Windows NT 4.0 users:
      11/17/97 4.72.2106.4 462,608 bytes  COMCTL32.DLL

   For Windows 95 users:
      11/17/97 4.72.2106.4 449,296 bytes  COMCTL32.DLL

</PRE>This hotfix has been posted to the following Internet location:
<P>
<PRE>   <B><A href="ftp://ftp.microsoft.com/softlib/mslfiles">ftp://ftp.microsoft.com/softlib/mslfiles</A></B>

</PRE>Both Comctl32.dll files have been combined in a self-installing archive at
this FTP location. Simply download the following file and execute it to
install the correct Comctl32.dll automatically on the operating system
you're using:
<P>
<PRE>   11/30/97 4.71.0603.0 503,824 bytes  40COMUPD.EXE

</PRE>NOTE: Service Pack 3 must be applied to Windows NT 4.0 prior to applying
this fix.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Internet Explorer version
4.0. A supported fix is now available, but has not been fully regression-
tested and should be applied only to systems experiencing this specific
problem. Unless you are severely impacted by this specific problem,
Microsoft recommends that you wait for the next Service Pack that contains
this fix. Contact Microsoft Technical Support for more information.
<P>
 
<PRE>Keywords          : msiexplore kberrmsg
Technology        : kbInetDev
Version           : 4.0
Platform          : WINDOWS
Issue type        : kbbug</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
