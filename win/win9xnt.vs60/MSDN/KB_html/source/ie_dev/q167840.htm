

<HTML>
<HEAD>
<TITLE>PRB: Unable to Update Installed Component with Newer Version </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167840">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="AXSDKCompDownload AXSDKControls kbprg">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  When you navigate between two pages that refer to different versions of the same component, Internet Explorer 3.x may use the version of the component first loaded, for both pages. While Internet Explorer appears to download the new version of the ...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAJG,QBWA,QBE7,QBE6,QBV9,QAC1,QAA1,QAO0,QDI2,QAH0,QAJQ,QAVZ,QBRJ,QAXB,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Unable to Update Installed Component with Newer Version</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167840</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), versions 3.0, 3.01, 3.02
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you navigate between two pages that refer to different versions of the
same component, Internet Explorer 3.x may use the version of the component
first loaded, for both pages. While Internet Explorer appears to download
the new version of the component, it may continue to use the older version.
<P>
<P><h2>CAUSE</h2>
 
<P>
In an attempt to optimize back and forth navigation between pages, Internet
Explorer 3.x may maintain a most-recently-used memory cache of up to 4
viewed pages. This cache includes all the components contained in those 4
pages. The problem described in this article is a negative side effect of
this caching mechanism. When the newer component is installed,
DllRegisterServer (exported by the component) is called to register the
component. Unfortunately, if Internet Explorer has the older component in
memory (in the memory cache), DllRegisterServer is called on the component
already in memory, essentially re-registering the old component.
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../ie_dev/q167230.htm">Q167230</A></B>
   TITLE     : INF: How To Detect when IE holds Controls and Pages in
               Memory

</PRE><h2>RESOLUTION</h2>
 
<P>
In Internet Explorer 3.x, one workaround is to close the browser and
revisit the page. Doing this will cause the newer version of the component
to display on the page as expected.
<P>
If restarting Internet Explorer 3.x is not an option, another workaround
may be to assign a new CLASSID to the newer version of the component. This
forces IE 3.x to treat the component as an entirely new component not
already installed in the system, thereby causing it to download the new
version of the component and display it on the page.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Using Internet Explorer 3.x, visit a page that uses Version 1.0 of a
   component, say Circ3.OCX:
<P>
   &lt;OBJECT ID="Circ31" WIDTH=100 HEIGHT=51
<P><PRE>     CLASSID="CLSID:9DBAFCCF-592F-101B-85CE-00608CEC297B"
     CODEBASE = "<B><A href="http://example.microsoft.com/circ3.cab#version=1,0,0,0">http://example.microsoft.com/circ3.cab#Version=1,0,0,0</A></B>"&gt;
     &lt;PARAM NAME="_Version" VALUE="65536"&gt;
     &lt;PARAM NAME="_ExtentX" VALUE="2646"&gt;
     &lt;PARAM NAME="_ExtentY" VALUE="1323"&gt;
     &lt;PARAM NAME="_StockProps" VALUE="15"&gt;
     &lt;PARAM NAME="BackColor" VALUE="16711808"&gt;
</PRE>   &lt;/OBJECT&gt;

<P><LI>Visit another page (PAGE2.HTM) that uses Version 2.0 of the same
   component, that is its CODEBASE tag should look something like
   CODEBASE="<B><A href="http://example.microsoft.com/circ3.cab#version=2,0,0,0">http://example.microsoft.com/circ3.cab#Version=2,0,0,0</A></B>"&gt;

<P><LI>Observe as Internet Explorer 3.x attempts to download the .CAB, as
   specified in the CODEBASE tag. It brings up the digital certificate,
   prompting the user to install version 2.0 of the component.

<P><LI>Click Yes to install the newer version, and although Internet Explorer
   3.x appears to download the .CAB to disk, it is unable to do so, because
   the component is still loaded in memory. (This can be misleading because
   Internet Explorer 3.x does not notify the user of this failure to
   download the control; however, if you verify the version of the control
   in the registry, or in the OCCACHE directory, it still indicates
   version 1.0.)

<P><LI>When the second page is finally loaded, Internet Explorer 3.x continues
   to use version 1.0 of the component, instead of the specified version
   2.0.

<P><LI>Restart Internet Explorer and revisit Page2.HTM. Internet Explorer 3.x
   prompts the user to download version 2.0 of the control again (remember
   that it was not able to successfully do this in #4 above).

<P><LI>Click Yes and the page is finally loaded with the correct version
   (version 2.0) of the component.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
ActiveX SDK Internet Component Download documentation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: &lt;OBJECT&gt; object tag ie4sweep<BR>
Keywords            : AXSDKCompDownload AXSDKControls kbprg<BR>
Version             : 3.0 3.01 3.02<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
