

<HTML>
<HEAD>
<TITLE>HOWTO: Debugging ActiveX Controls in IE 4.0 Browser </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167715">
<META NAME="KBModify" CONTENT="1997/11/26">
<META NAME="KBCreate" CONTENT="1997/04/29">
<META NAME="Keywords" CONTENT="AXSDKControls">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  In Internet Explorer 4.0 Integrated Browser Mode, the Windows shell and the Web browser run in the same process space. This poses a challenge to programmers who are attempting to debug their controls. This article lists a series of steps you can fo...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRT,QBWS,QAMN,QBJZ,QBIC,QBV9,QBS0,QA2Q,QA56,QA55,QAVX,QAG2,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Debugging ActiveX Controls in IE 4.0 Browser</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167715</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), version 4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Internet Explorer 4.0 Integrated Browser Mode, the Windows shell and the
Web browser run in the same process space. This poses a challenge to
programmers who are attempting to debug their controls. This article lists
a series of steps you can follow to reliably debug your ActiveX controls in
the Visual C++ debugger running in Integrated Browser Mode.
<P>
This article covers debugging both Visual C++ and Visual Basic-created
components.
<P>
NOTE: Alternatively, you can specify "Browse in a new process." To do this,
click "Internet Options" from the View menu. Click the Advanced tab. Next,
select "Browse in a new process."
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Given an ActiveX control project for which debug symbols and source are
   available, load the corresponding project into the Visual C++ debugger.
<P>
</OL>For components written in Visual Basic, ensure that the component contains
debug information:
<P>
<PRE>   a. Load the project into Visual Basic 5.0.
   b. From the File menu, select Make &lt;YourProject&gt;.ocx.
   c. Click the Options button and select the Compile tab.
   d. Select "Compile to Native Code" and check the option to
      "Create Symbolic Debug Info"
   e. Click OK to compile your component with debug symbols.
   f. To load the project into the Visual C++ debugger, select
      Open Workspace  from the Visual C++ File menu, setting "Files
      of Type" to All Files (*.*), and then select your
      compiled component.

   For more information, please see the following article in
   the Microsoft Knowledge Base:

      ARTICLE-ID: <B><A href="../vbwin/q166275.htm">Q166275</A></B>
      TITLE     : HOWTO: Debug a Native Code Visual Basic
                  Component in VC++

</PRE><P><LI>Set breakpoints in your control's code appropriately.

<P><LI>Specify Explorer.exe as the executable to be used for debugging. In
   Visual C++ version 5.0, this can be set from the Project menu, by
   clicking Settings, and selecting the Debug tab. Under "Executable for
   Debug Session," specify Explorer.Exe or click on the arrow and select
   "Default Web Browser."

<P><LI>From the Windows Start menu on the taskbar, select Shutdown.

<P><LI>When the "Shutdown Windows" dialog box appears, click Close all programs
   and logon as a different user," hold down the CTRL+ALT+SHIFT keys, and
   click No. The Windows Shell including the taskbar will shut down, but
   the Windows session will not end. To toggle between applications use the
   ALT+TAB keys. To launch additional applications, use the Task Manager,
   accessible via CTRL+ALT+DELETE.

<P><LI>Once the Windows Shell has shut down completely, launch the debugging
   session, ignoring the warning that debugging symbols for Explorer.exe
   are not available.

<P><LI>Open a browser or Explorer window and specify the address of the HTML
   page that contains a reference to the control. Once the page is loaded,
   focus will jump to the debugger, which will be suspended on the first
   breakpoint set.
<P>
</OL>When you're finished debugging the control, the shell may need to be
restarted using the Task Manager.

<OL><P><LI>Under Windows 95, double-click anywhere on the desktop to bring up the
   Task Manager. Under Windows NT, press CTRL+ALT+DELETE and click the
   Task Manager button.

<P><LI>From the Task Manager's File Menu, select Run and enter the path to
   Explorer.exe to restart the shell.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
In the Visual C++ 5.0 Books Online navigate to
<PRE>   Platform, SDK and DDK Documentation\Platform SDK\
      User Interface Services\Shell\Shell Extensions\
      About Shell Extensions\Installing Handlers on Windows NT\
      Debugging Tips
</PRE></OL> 
<PRE>Keywords          : AXSDKControls
Version           : Win:4.0
Platform          : WINDOWS
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
