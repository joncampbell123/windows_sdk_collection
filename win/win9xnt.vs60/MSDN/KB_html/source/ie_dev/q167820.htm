

<HTML>
<HEAD>
<TITLE>HOWTO: Determining Browser Version from a Script </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167820">
<META NAME="KBModify" CONTENT="1997/11/10">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="msiexplore kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  With the new features that Internet Explorer 4.0 provides, it may be desirable for both client-side and server-side scripts to determine the browser version, so that a web application can either take advantage of new functionality, or degrade grace...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBV9,QAUD,QBRJ,QBWA,QAKC,QAY2,QABH,QABI,QAC1,QBC6,QAVZ,QAY5,QATX,QAG8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>HOWTO: Determining Browser Version from a Script</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167820</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), versions 3.0, 3.01, 3.02,
   4.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With the new features that Internet Explorer 4.0 provides, it may be
desirable for both client-side and server-side scripts to determine
the browser version, so that a web application can either take advantage of
new functionality, or degrade gracefully, depending on the version of the
currently-running browser.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>From a Client-Side Script</h3>
 
<P>
The JScript function below can be used to determine the version of the
browser it is running on from a client-side script. The function runs on
the large majority of browsers currently available and returns the major
version number for any Microsoft Internet Explorer browser, and zero (0)
for others. Use of this function assures that the script will be compatible
with future versions of the Internet Explorer.
<P>
<PRE>   // This function returns Internet Explorer's major version number,
   // or 0 for others. It works by finding the "MSIE " string and
   // extracting the version number following the space, up to the decimal
   // point, ignoring the minor version number
   &lt;SCRIPT LANGUAGE="JavaSCRIPT"&gt;
   function msieversion()
   {
      var ua = window.navigator.userAgent
      var msie = ua.indexOf ( "MSIE " )

      if ( msie &gt; 0 )      // If IE, return version number
         return parseInt (ua.substring (msie+5, ua.indexOf (".", msie )))
      else                 // If another browser, return 0
         return 0
   }
   &lt;/SCRIPT&gt;


</PRE>When checking version numbers, scripts should always use the &gt;= operator,
instead of the = operator to ensure compatibility with future versions.
Existing scripts that specifically check for userAgent equal to "MSIE 3,"
for instance, should be changed to use the &gt;= operator so that the scripts
recognize Internet Explorer 4.0 as well.
<P>
The following example demonstrates how to detect the browser version from a
client-side script. Note that this example does not specifically check for
platform version, such as Windows 95, Windows NT, Windows 3.1, etc., which
require a separate userAgent substring check when applicable:
<P>
<PRE>   &lt;SCRIPT LANGUAGE="javascript"&gt;
   if ( msieversion() &gt;= 4 )
      document.write ( "This is IE4 or later" );

   else if ( msieversion() &gt;= 3 )
      document.write ( "This is IE3" );

   else
      document.write ( "This is another browser" );
   &lt;/SCRIPT&gt;

</PRE><h3>From a Server-Side Script</h3>
 
<P>
The Browser Capability component that comes with Active Server Pages (ASP)
provides your scripts with a description of the capabilities of the
client’s Web browser by comparing the User-Agent HTTP Header with the
entries in the BROWSCAP.INI file. In order for an ASP application to detect
the browser's support for the new Internet Explorer 4.0 features, copy the
latest BROWSCAP.INI from
<B><A href="http://www.microsoft.com/iis/usingiis/developing/updates.htm">http://www.microsoft.com/iis/usingiis/developing/updates.htm</A></B> to your
%windows%\system32\inetsrv\asp\cmpnts directory and execute a server-side
script similar to the example below.
<P>
This example specifically takes advantage of new Dynamic HTML functionality
if the current browser is IE 4.0 or later:
<P>
&lt;HTML&gt;
&lt;BODY&gt;
<PRE>   &lt;%  Set bc = Server.CreateObject("MSWC.BrowserType") %&gt;
   &lt;table border=0 cellspacing="0" cellpadding="5"&gt;
      &lt;tr&gt;

         &lt;% If bc.browser = "IE" and bc.version &gt;= 4 Then %&gt;
         &lt;td&gt;&lt;a href="chocolate.htm" TARGET="_TEXT"
              onmouseover="this.style.color='red'"
              onmouseout="this.style.color='purple'"&gt;chocolate&lt;/a&gt;
         &lt;/td&gt;

         &lt;% Else %&gt;
            &lt;td&gt;&lt;a href="chocolate.htm" TARGET="_TEXT"&gt;chocolate&lt;/a&gt;&lt;/td&gt;
         &lt;% End If %&gt;

         &lt;td&gt;|&lt;/td&gt;

         &lt;% If bc.browser = "IE" and bc.version &gt;= 4 Then %&gt;
         &lt;td&gt;&lt;a href="vanilla.htm" TARGET="_TEXT"
              onmouseover="this.style.color='red'"
              onmouseout="this.style.color='purple'"&gt;vanilla&lt;/a&gt;
         &lt;/td&gt;

         &lt;% Else %&gt;
            &lt;td&gt;&lt;a href="vanilla.htm" TARGET="_TEXT"&gt;vanilla&lt;/a&gt;&lt;/td&gt;
         &lt;% End If %&gt;

      &lt;/tr&gt;
   &lt;/table&gt;

</PRE>&lt;/BODY&gt;
&lt;/HTML&gt;
<P>
<P><h2>REFERENCES</h2>
 
<P>
Components Reference in the Active Server Pages (ASP) Roadmap
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: detect verify check<BR>
Keywords          : msiexplore kbhowto<BR>
Version           : 3.0 3.01 3.02 4.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
