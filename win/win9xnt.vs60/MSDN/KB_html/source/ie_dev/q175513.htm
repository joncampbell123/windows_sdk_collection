

<HTML>
<HEAD>
<TITLE>FILE: Invoke Find, View Source, Options dialogs for WebBrowser </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175513">
<META NAME="KBModify" CONTENT="1998/01/19">
<META NAME="KBCreate" CONTENT="1997/10/22">
<META NAME="Keywords" CONTENT="AXSDKWebBrowser">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  This article illustrates how to invoke the Internet Explorer Find, Internet Options, and View Source dialog boxes from within an application that is hosting the WebBrowser control.  The following file is available for download from the Microsoft So...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB5,QAI4,QA7O,QAOE,QAMN,QBRJ,QBV9,QBB3,QBV8,QAVZ,QAPF,QAK6,QAH4,QADK,QA01 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FILE: Invoke Find, View Source, Options dialogs for WebBrowser</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175513</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), versions 3.0, 3.01, 3.02,
   4.0, 4.01
<LI>ActiveX SDK, version 1.0
<LI>Internet Client SDK, versions 4.0, 4.01
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article illustrates how to invoke the Internet Explorer Find, Internet
Options, and View Source dialog boxes from within an application that is
hosting the WebBrowser control.
<P>
The following file is available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/wbsampl.exe">wbsampl.exe</A> <I>(size: 47557 bytes)</I> 

</PRE><h2>MORE INFORMATION</h2>
 
<P>
WARNING: This sample uses an undocumented command group GUID that is
subject to change in the future. Although this sample has been tested to
work correctly with Internet Explorer 3.0 and 4.0, there is no guarantee
that these techniques will continue to work successfully in future
versions. Please use caution when adding this code to an application.
<P>
The WBSampl example is a mini-browser application that illustrates how to
create an application in Microsoft Visual C++ that uses the WebBrowser
control. This example provides code to invoke the Find, Internet Options,
and View Source items that are part of the WebBrowser control but are not
exposed as methods.
<P>
In order to implement the items listed above, the following steps should be
followed.

<OL><P><LI>Define the command group GUID for the WebBrowser control as follows:
<P>
<P><PRE>      DEFINE_GUID(CGID_IWebBrowser,0xED016940L,0xBD5B,0x11cf,0xBA,
      0x4E,0x00,0xC0,0x4F,0xD7,0x08,0x16);
</PRE>
<P><LI>Define the CommandTarget ids for menu driving as follows:
<P>
<P><PRE>      #define HTMLID_FIND 1
      #define HTMLID_VIEWSOURCE 2
      #define HTMLID_OPTIONS 3
</PRE>
<P><LI>Execute a CommandTarget id as follows:
<P>
<P><PRE>      HRESULT CMainFrame::ExecCmdTarget(DWORD nCmdID)
      {
<PRE></PRE>         LPDISPATCH lpDispatch = NULL;
         LPOLECOMMANDTARGET lpOleCommandTarget = NULL;

         lpDispatch =
            ((CWebSurferView*)GetActiveView())-&gt;m_webBrowser.GetDocument();
         ASSERT(lpDispatch);

         // Get an IDispatch pointer for the IOleCommandTarget interface.
         lpDispatch-&gt;QueryInterface(IID_IOleCommandTarget,
      (void**)&amp;lpOleCommandTarget);
         ASSERT(lpOleCommandTarget);

         lpDispatch-&gt;Release();

         // Invoke the given command id for the WebBrowser control
         return lpOleCommandTarget-&gt;Exec(CGID_IWebBrowser, nCmdID, 0,
                                         NULL, NULL);
      }

</PRE></OL>Note that m_webBrowser is an instance of the WebBrowser control and is
defined in the CView-derived class for this project.  Also, nCmdID is one
of the IDs defined in step 2.
<P>
(c) Microsoft Corporation 1997, All Rights Reserved. Contributions by Scott
Roberts, Microsoft Corporation
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: WebBrowser WBSampl Find Source Options Internet<BR>
Explorer IE<BR>
Keywords          : AXSDKWebBrowser<BR>
Technology        : kbInetDev kbole<BR>
Version           : WINDOWS:3.0,3.01,3.02,4.0,4.01<BR>
Platform          : WINDOWS<BR>
Issue type        : kbfile<BR>
Solution Type     : kbsample<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
