

<HTML>
<HEAD>
<TITLE>PRB: "Permission Denied" When Scripting Across Frames </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167796">
<META NAME="KBModify" CONTENT="1998/03/05">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="AXSDKIESripting kbprb">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  Script code that attempts to access a script or object in a different frame may get the following script error message:      Permission denied: 'Parent.RemoteFrame.RemoteObject'  CAUSE =====  Internet Explorer 4.0 implements cross-frame security. A...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QBWA,QAIB,QATQ,QAIA,QAAD,QAVZ,QAPN,QAK7,QA3N,QAPF,QAJQ,QAW6,QAI5,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: "Permission Denied" When Scripting Across Frames</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 5, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167796</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), versions 4.0, 4.01
<LI>Internet Client SDK, version 4.0, 4.01
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Script code that attempts to access a script or object in a different frame
may get the following script error message:
<P>
<PRE>    Permission denied: 'Parent.RemoteFrame.RemoteObject'

</PRE><h2>CAUSE</h2>
 
<P>
Internet Explorer 4.0 implements cross-frame security. A script or object
in one frame is not allowed to access scripts or objects in another frame
when the documents referenced by the frames' SRC attribute specify Web
servers in different second-level domains. This corresponds to the "domain-
name.XXX" portion of the full server name syntax "server.domain-name.XXX".
<P>
The Internet Explorer 4.0 Dynamic HTML object model allows a certain subset
of safe actions to be scripted. For example, the window.location property
of a remote server's frame can be set to allow navigation, but it cannot be
read to prevent one frame from snooping on the contents of another frame.
<P>
For example, it is valid for a document retrieved from
"<B><A href="http://test.microsoft.com">http://test.microsoft.com</A></B>" to manipulate another document retrieved from
"<B><A href="http://test.microsoft.com">http://test.microsoft.com.</A></B>" It is not valid for a document retrieved from
"<B>http://server1.some-domain-name.org</B>" to manipulate a document located
retrieved from "<B><A href="http://server2">http://server2</A></B>" or "<B><A href="http://server3.microsoft.com">http://server3.microsoft.com.</A></B>"
<P>
The intention of cross-frame security is to prevent one Web page designer
from potentially misusing or snooping on the trusted objects authored by a
different Web page designer. Only those pages hosted in the same domain can
be trusted to safely script the contents of a particular page. This should
also prevent unwanted communication between documents on opposite sides of
a corporate firewall.
<P>
Please refer to the Internet Client SDK for more information.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent this error, documents that interact with each other must be
hosted by servers on the same domain.
<P>
To allow two documents hosted on the same second-level domain to interact,
both documents must set the document.domain property to their shared second-
level domain. For example, one document on "<B><A href="http://example.microsoft.com">http://example.microsoft.com</A></B>"
could script and access another document on "<B><A href="http://test.microsoft.com">http://test.microsoft.com</A></B>" if
both documents used the following line of script code:
<P>
<PRE>   &lt;SCRIPT LANGUAGE="VBScript"&gt;
       document.domain = "microsoft.com"
   &lt;/SCRIPT&gt;

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For example, given the following FRAMESET:
<P>
<PRE>   &lt;FRAMESET COLS="50%, *" FRAMEBORDER=1&gt;
      &lt;FRAME src="<b>http://server1/server1.html</B>" ID="Server1Frame"&gt;
      &lt;FRAME src="<b>http://server2/server2.html</B>" ID="Server2Frame"&gt;
   &lt;/FRAMESET&gt;

</PRE>Script in the "Server1Frame" frame is not permitted to access script or
objects in the "Server2Frame" frame, and vice versa.
<P>
The following example script code in server1.html causes the "Permission
Denied" error, given that RemoteTextBox is an object created on the
server2.html document:
<P>
<PRE>   &lt;!-- From server1.html --&gt;
   &lt;SCRIPT LANGUAGE="VBScript"&gt;
       Sub CommandButtonLocal_Click()
           Parent.Server2Frame.RemoteTextBox.Text = "Changed Text"
                  'Server2Frame has SRC on different server
       end sub
   &lt;/SCRIPT&gt;

</PRE>Cross-Frame Security uses the concept of a "security context" to make cross-
frame scripting decisions. Security context takes into account the
protocol, domain, and zone of Internet documents. Any differences in these
three between the document containing the script and the document in
another frame or window that the script is trying to manipulate causes a
cross-frame security violation. For example, HTTP documents cannot script
HTTPS documents, and sites in the Restricted Sites zone cannot script sites
in the Local intranet zone.
<P>
Internet Explorer 4.0 ultimately appeals to the Security Manager when
script attempts to access another document. Technically, Internet Explorer
4.0 uses the IInternetSecurityManager::GetSecurityId() function to help it
make security context decisions. The security identification returned must
match exactly for both URLs in a cross-frame situation. Please refer to the
Internet Client SDK documentation for more information on the Internet
Security Manager.
<P>
<P><h2>REFERENCES</h2>
 

<UL><LI>Internet Client SDK: Dynamic HTML; Document Object Model; Cross-Frame
   Scripting and Security
<LI>RFC 1591: "Domain Name System Structure and Delegation"
<LI>RFC 1034: "DOMAIN NAMES - CONCEPTS AND FACILITIES"
<LI>Internet Client SDK: Internet Tools &amp; Technologies; Monikers, URLs,
   Security Zones, and Pluggable Protocols
<P>
</UL> 
<PRE>Keywords          : AXSDKIESripting kbprb
Version           : 4.0
Platform          : WINDOWS
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 5, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
