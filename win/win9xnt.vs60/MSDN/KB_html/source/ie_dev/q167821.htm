

<HTML>
<HEAD>
<TITLE>BUG: Unable to Communicate to Multiple IE 3.x Threads via DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167821">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="msiexplore kbbug">
<META NAME="KBArea" CONTENT="Support; KB; ie_dev">
<META NAME="Description" CONTENT="  An application can successfully establish a DDE communication with every Internet Explorer 3.x process, but not to subsequent IE 3.x threads spawned from that process.  CAUSE =====  Internet Explorer 3.x's DDE implementation does not support multip...">
<META NAME="Product" CONTENT="Internet Explorer (Programming)">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBV9,QBE6,QBE7,QAVZ,QAY2,QAUQ,QAKJ,QBIC,QAZ2,QBRJ,QBVV,QA3Q,QATL,QAIF,QAQW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Unable to Communicate to Multiple IE 3.x Threads via DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167821</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Internet Explorer (Programming), versions 3.0, 3.01, 3.02
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An application can successfully establish a DDE communication with every
Internet Explorer 3.x process, but not to subsequent IE 3.x threads spawned
from that process.
<P>
<P><h2>CAUSE</h2>
 
<P>
Internet Explorer 3.x's DDE implementation does not support multiple
threads.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a bug in the Microsoft products listed
at the beginning of this article. We are researching this bug and will post
new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A distinction needs to be made between an Internet Explorer 3.x process and
an Internet Explorer 3.x thread. A new Internet Explorer 3.x process is
launched every time Internet Explorer 3.x is launched from the Windows
shell. On the other hand, a new Internet Explorer 3.x thread is spawned
from the same process every time a user selects File.New Window from the
Internet Explorer menu.
<P>
Internet Explorer 3.x's DDE implementation calls DdeInitialize() once per
process, not per thread. The application instance identifier returned in
the pidInst parameter of the DdeInitialize function is local to the calling
thread.
<P>
Because of this, no DDE conversation is established with subsequent threads
spawned from an Internet Explorer 3.x process.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Launch an instance of Internet Explorer 3.x from the Windows shell
   by double-clicking on the Internet Explorer icon on the Windows desktop.

<P><LI>From an application, for example GENERIC, establish a DDE conversation
   with Internet Explorer 3.x, using:
<P>
   application Name = iexplore,
<P>
   -and-
<P>
<PRE>   topic Name       = WWW_RegisterUrlEcho

   so that GENERIC can be notified of URLEcho events whenever a URL gets
   loaded in Internet Explorer 3.x.

</PRE><P><LI>Note that GENERIC gets notified whenever the Internet Explorer navigates
   to a URL.

<P><LI>Spawn a new Internet Explorer thread by selecting "New Window" from the
   File menu. Observe a new Internet Explorer window appear on the screen.

<P><LI>From this newly-spawned thread, navigate to a different URL, for example
   "<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>". Observe that GENERIC does not get notified
   of URLEcho events as this new thread loads a different URL.

<P><LI>Activate the original Internet Explorer window, and navigate to a
   different URL, for example "<B><A href="http://www.microsoft.com/ie/default.asp">http://www.microsoft.com/ie/default.asp,</A></B>"
   and watch GENERIC get notified of URLEcho events as this instance of
   Internet Explorer navigated to the new URL.
<P>
</OL>The DDE connection is established only with Internet Explorer's primary
thread, but not with subsequently-spawned threads.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win32sdk/q94091.htm">Q94091</A></B>
   TITLE     : DDEML Application-Instance IDs Are Thread Local
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : msiexplore kbbug<BR>
Version             : 3.0 3.01 3.02<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
