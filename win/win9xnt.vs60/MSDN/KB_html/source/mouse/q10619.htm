

<HTML>
<HEAD>
<TITLE>Light Pen Won't Work with Mouse Installed </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q10619 ">
<META NAME="KBModify" CONTENT="1996/09/16">
<META NAME="KBCreate" CONTENT="1987/12/09">
<META NAME="Keywords" CONTENT="kbhw">
<META NAME="KBArea" CONTENT="Support; KB; mouse, hw, win95x, winnt, hwother, win3x, msdos">
<META NAME="Description" CONTENT="  If you have both a mouse and a light pen installed, you may get conflicts between the two. This is because the Microsoft Mouse can be used to emulate a light pen.  When installed, the mouse driver is initialized with  light pen emulation mode  turn...">
<META NAME="Product" CONTENT="Mouse">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBHF,QAQ7,QAGI,QAF1,QBE7,QBE6,QAA1,QDI2,QAU9,QDIV,QA5W,QAY5,QAIF,QBXS,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Light Pen Won't Work with Mouse Installed</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q10619 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mouse Driver for MS-DOS, versions 1.x, 2.x, 3.x, 4.x,
   5.x, 6.x, 7.x, 8.x, and 9.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
If you have both a mouse and a light pen installed, you may get
conflicts between the two. This is because the Microsoft Mouse can be
used to emulate a light pen.
<P>
When installed, the mouse driver is initialized with "light pen
emulation mode" turned on. Pressing both mouse buttons simultaneously
indicates pen touching the screen; releasing the buttons indicates pen
off the screen.
<P>
If a light pen is installed with the mouse driver in the above
condition, the light pen cannot function correctly. Light pen
information is collected using an INT 10h DOS call, code 4. With the
mouse's pen emulation mode turned on, the pen does not appear to work
properly because the mouse driver is pointing that interrupt's vector
to its own routine instead of to the regular light pen handler.
<P>
For the pen to work properly with the mouse driver installed, mouse
function 14 must be called to turn pen emulation mode off. Once
disabled, emulation mode is reenabled by calling mouse function 13.
See the Microsoft Mouse Programmer's Reference for documentation of
the mouse function calls.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following is a short BASIC program you can run to disable or
enable the mouse's light pen emulation mode:
<P>
10 INPUT "(1) Disable or (2) Enable light pen emulation";P%
20 IF P% &lt;&gt; 1 AND P% &lt;&gt; 2 THEN PRINT "WRONG RESPONSE, TRY AGAIN":GOTO
<PRE>   10
</PRE>25 DEF SEG =0
30 MSEG = 256 * PEEK(51*4+3) + PEEK(51*4+2)
40 MOUSE = 256 * PEEK(51*4+1) + PEEK(51*4)+2
50 IF MSEG AND MOUSE THEN 70
60 PRINT "MOUSE DRIVER NOT FOUND":END
70 DEF SEG = MSEG
80 IF P% = 1 THEN M1% = 14 ELSE M1% = 13
90 CALL MOUSE(M1%,M2%,M3%,M4%)
<PRE>100 DEF SEG          'restore segment to BASIC's data segment

</PRE>Line 90 contains Mx% because the mouse function calls are expecting
four parameters to be passed, even if no value is assigned to one or
more of them.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbhw<BR>
KBSubcategory:<BR>
Additional reference words: 7.00 7.04 7.05 8.00 8.10 8.20 9.00<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
