

<HTML>
<HEAD>
<TITLE>Pascal Example in Programmer's Guide Won't Compile </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q68881 ">
<META NAME="KBModify" CONTENT="1996/09/16">
<META NAME="KBCreate" CONTENT="1991/01/31">
<META NAME="Keywords" CONTENT="kbhw kb3rdparty kbdocerr">
<META NAME="KBArea" CONTENT="Support; KB; mouse, hw, win95x, winnt, hwother, win3x, msdos">
<META NAME="Description" CONTENT="  The  Making Calls from Borland Turbo Pascal Programs  sample in Appendix E of the  Microsoft Mouse Programmer's Reference  does not compile with Turbo Pascal versions 5.0 and 6.0.  MORE INFORMATION  The CpuReg data structure needs to be defined as ...">
<META NAME="Product" CONTENT="Mouse">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABK,QBE7,QBE6,QAGI,QAB9,QAUD,QAPF,QAFF,QAEF,QA7M,QAY5,QAY4,QAY2,QAQ7,QAD7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Pascal Example in Programmer's Guide Won't Compile</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q68881 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Mouse Driver for MS-DOS, versions 6.x, 7.x, 8.x,
   and 9.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The "Making Calls from Borland Turbo Pascal Programs" sample in
Appendix E of the "Microsoft Mouse Programmer's Reference" does not
compile with Turbo Pascal versions 5.0 and 6.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The CpuReg data structure needs to be defined as "Registers"
variables. The semicolons need to be removed from the END lines that
immediately precede ELSE. Finally, finding the segment and offset of
the pointer of the address of the user array or subroutine (functions
9,12,20,22,23,and 24) needs to be done outside of this procedure.
Passing the first element of the array or the start point of the
subroutine into the procedure, then calling the "ofs" and "seg"
functions in the procedure doesn't seem to work. This is due to how
the variables get dereferenced when passed into a procedure.
<P>
The following example compiles in both Turbo Pascal version
6.0 and Quick Pascal version 1.00:
<P>
Procedure Mouse (Var m1, m2, m3, m4, m5 : integer );
<P>
Var
<PRE>   CpuReg: Registers;

</PRE>begin {mouse}
<P>
<PRE>   if m1 &gt;= 0 then
      begin
     CpuReg.AX := m1;        { Load Parameters       }
     CpuReg.BX := m2;        { into appropriate      }
     CpuReg.CX := m3;        { registers             }

     if (m1 = 9) or (m1 = 12) or (m1 = 20)
        or (m1 = 22) or (m1 = 23) or (m1 = 24) then
        begin
          CpuReg.DX  :=  m4;    {m4 = offset,         }
          CpuReg.ES  :=  m5;    { and m5 = segment    }
        end                       { of the user array }
                         { or subroutine     }

      else
      if  m1 = 16  then
       begin
         CpuReg.CX  := m2;           {Left  x coordinate }
         CpuReg.DX  := m3;           {Upper y coordinate }
         CpuReg.SI  := m4;           {Right x coordinate }
         CpuReg.DI  := m5;           {Lower y coordinate }
       end
     else
         CpuReg.DX  := m4;

     Intr($33, CpuReg);              {Call mouse driver  }
                            { at Interrupt 33H  }

     m1 := CpuReg.AX;                {Return values back }
     m2 := CpuReg.BX;                { to parameters     }
     m3 := CpuReg.CX;
     m4 := CpuReg.DX;

     if (m1 = 20) then               {special returns    }
        m2 := CpuReg.ES              { from subroutines  }
   end;
</PRE>end; {mouse}
<P>
The Borland product included here is manufactured by a vendor
independent of Microsoft; we make no warranty, implied or otherwise,
regarding this product's performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbhw kb3rdparty kbdocerr<BR>
KBSubcategory:<BR>
Additional reference words: 3rdparty Programming docerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
