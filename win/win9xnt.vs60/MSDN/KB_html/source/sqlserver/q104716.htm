

<HTML>
<HEAD>
<TITLE>INF: Using DB-Library with Visual C++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104716">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1993/09/27">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Using DB-Library for MS-DOS, Windows, and Windows NT with Visual C++ and Visual C++ for Windows NT requires a few steps to configure correctly.  MORE INFORMATION  Follow these steps to create a Visual C++ project for a DB-Library application:  1. F...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBFY,QBVR,QBWP,QAG2,QBXS,QBWS,QA2Q,QDL9,QBWQ,QBWO,QBWN,QABM,QAFI,QAPF,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using DB-Library with Visual C++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104716</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server Programmer's Toolkit, version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Using DB-Library for MS-DOS, Windows, and Windows NT with Visual C++ and
Visual C++ for Windows NT requires a few steps to configure correctly.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Follow these steps to create a Visual C++ project for a DB-Library
application:

<OL><P><LI>From the Options menu, choose Directories. Include the directory
   where the DB-Library .H header files are located (C:\SQL\DBLIB\INCLUDE
   by default) in the Include Files Path box. Include the directory where
   the DB-Library .LIB library files are located (C:\SQL\DBLIB\LIB by
   default) in the Library Files Path box.

<P><LI>Select the Project menu and choose New. Choose an appropriate Project
   Name, using the Browse button to specify the directory where the
   application's C/C++ source code files reside. Choose the appropriate
   Project Type from the list box:
<P>
   a. For Windows, select Windows application (.EXE) or Windows
<P><PRE>      dynamic-link library (.DLL)
</PRE><P>
   b. For Windows NT, select Windows application (.EXE), Console
<P><PRE>      application (.EXE), or Dynamic-link library (.DLL)
</PRE><P>
   c. For MS-DOS, select MS-DOS application (.EXE)

<P><LI>In the File Name box of the project Edit dialog box, type the
   directory (C:\SQL\DBLIB\LIB by default) and file name of the
   appropriate DB-Library .LIB library file:
<P>
   a. For Windows, use W3DBLIB.LIB
<P>
   b. For Windows NT, use NTWDBLIB.LIB
<P>
   c. For medium model MS-DOS, use RMDBLIB.LIB
<P>
   d. For large model MS-DOS, use RLDBLIB.LIB
<P>
   then use the Add button to include the file in the project. Ensure
   that the appropriate .LIB file is now listed in the Files in Project
   list box.

<P><LI>Include the C/C++ application's source code files in the project.

<P><LI>For MS-DOS, select the Options menu and choose Project. Choose the
   Compiler button. Select the Common to Both radio button. From the
   Category list box, choose Memory Model, then select the appropriate
   memory model from the Model drop down list box:
<P>
   a. For medium model MS-DOS, select Medium
<P>
   b. For large model MS-DOS, select Large

<P><LI>For Windows, select the Options menu and choose Project. Choose the
   Compiler button. From the Category list box, choose Windows
   Prolog/Epilog, and note that Protected Mode Application Functions
   (/GA for applications, /GD for DLLs) is the default.
<P>
   To use this compiler option, the application's DB-Library error and
   message handlers must be declared using the Visual C++ '__export'
   keyword. Failure to do can result in a general protection fault
   (GP fault) inside the application's DB-Library error or message handler.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dblib<BR>
Keywords            : kbprg SSrvDB_Lib<BR>
Version             : 4.2.5 | 4.2<BR>
Platform            : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
