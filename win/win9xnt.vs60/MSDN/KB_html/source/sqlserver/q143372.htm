

<HTML>
<HEAD>
<TITLE>INF: Using Banyan VINES Common Login with SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143372">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1996/02/01">
<META NAME="Keywords" CONTENT="kb3rdparty kbinterop kbnetwork SSrvLan">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  In order to use the Banyan network library with SQL Server, you must login to the Banyan VINES network before you start SQL Server. One of the ways to start SQL Server as a Windows NT service and use the Banyan net-library is to use the Banyan Comm...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QACK,QAIJ,QABI,QBG2,QBW7,QDIZ,QAA1,QDIV,QAVZ,QBWS,QBVX,QAI5,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using Banyan VINES Common Login with SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143372</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21a, 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In order to use the Banyan network library with SQL Server, you must login
to the Banyan VINES network before you start SQL Server. One of the ways to
start SQL Server as a Windows NT service and use the Banyan net-library is
to use the Banyan Common Login feature.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Banyan Common Login is configured using the Workstation icon under the
VINES setup group on the Windows NT server. When you double-click the
Workstation icon, the "VINES Workstation Configuration" window is started.
To use the Banyan Common Login, under the label Login Options, make sure
that the "Use Windows NT Logon for VINES (common login)" check box is
selected (refer to VINES documentation for details on how to configure the
Banyan Enterprise Client for Windows NT).
<P>
Once you have configured the VINES software to use the Common Login
feature, you must have a Windows NT user account that matches the Banyan
login that is used to login to the Banyan network. If you have created the
Banyan login SQLUSER@SQL@MICROSOFT, then you must have a Windows NT (domain
or local server) user account with the name SQLUSER. In addition, the
Banyan login must have the same password as the corresponding Windows NT
account and the VINES login search list must have SQL@MICROSOFT specified.
You also need to make sure that the Windows NT user account belongs to the
Local Administrator group of the local Windows NT server.
<P>
By default, SQL Server is set up to run as a Windows NT service under the
computer's LocalSystem account. To login to the Banyan VINES network
automatically when SQL Server starts as a Windows NT service, you must
assign the Common Login account (in our example, this would be SQLUSER) to
be used with SQL Server service instead of the LocalSystem account. For SQL
Server 4.21a, SQL Server's service name is SQLServer; for SQL Server 6.0,
SQL Server's service name is MSSQLServer.
<P>
After you have changed the SQL Server service to use the Common login, you
should change the SQL Server service to depend on the VinesWorkstation
service so that the SQL Server service will not start until the VINES
network services are running. To setup this dependency, use the
Regedt32.exe program to add the DependOnService (type REG_MULTI_SZ) entry
with the value VinesWorkstation to the followng Registry location:
<P>
For SQL Server 4.21a:
<PRE>   \HKEY_LOCAL_MACHINE
           \SYSTEM
                \CurrentControlSet
                        \Services
                             \SQLServer

</PRE>For SQL Server 6.0:
<PRE>   \HKEY_LOCAL_MACHINE
           \SYSTEM
              \CurrentControlSet
                      \Services
                           \MSSQLServer

    \HKEY_LOCAL_MACHINE
           \SYSTEM
               \CurrentControlSet
                      \Services
                           \SQLExecutive

</PRE>You can use the same Common Login to start SQLMonitor service for SQL
Server 4.21a or the SQLExecutive service for SQL Server 6.0. Because the
SQLMonitor service already depends on the SQLServer service, there is no
need to add the DependOnService entry for the SQLMonitor service.
<P>
You can find additional information on assigning service accounts to SQL
Server and SQL Executive in the Microsoft SQL Server "Administrator's
Companion" for SQL Server 6.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6<BR>
Keywords            : kb3rdparty kbinterop kbnetwork SSrvLan<BR>
Version             : 4.21a 6.0<BR>
Platform            : NT WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
