

<HTML>
<HEAD>
<TITLE>INF: How to Debug SQL Server Connectivity Problems Over RAS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139061">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="kbnetwork SSrvLan">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  You can use Microsoft Remote Access Service (RAS) to connect to Microsoft SQL Server from Windows NT, Windows 95, or Windows for Workgroups clients. Because SQL Server communicates with its clients using high-level InterProcess Communication (IPC) ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QARL,QAVZ,QBWO,QAI5,QABA,QA2O,QAVX,QAJQ,QBVV,QBG2,QABI,QDNT,QBWD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Debug SQL Server Connectivity Problems Over RAS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139061</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21 and 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can use Microsoft Remote Access Service (RAS) to connect to Microsoft
SQL Server from Windows NT, Windows 95, or Windows for Workgroups clients.
Because SQL Server communicates with its clients using high-level
InterProcess Communication (IPC) APIs only, such as named pipes, TCP/IP
sockets, and IPX/SPX sockets, the support for RAS is transparent, which
means that SQL Server does not care whether this is a RAS connection as
long as the RAS service supports the appropriate IPCs used by the SQL
Server clients. SQL Server can run either on the same computer where the
RAS server service is running or on a different computer that is connected
to the RAS server through a LAN. The key to troubleshooting connectivity
problems through RAS is to isolate the problems to either Windows
NT/network/RAS issues or SQL Server connectivity issues.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Windows NT RAS supports TCP/IP, IPX/SPX, and NetBEUI LAN protocols. When
you install the RAS service, you can choose to enable one or all of these
protocols, which in turn provides support for IPCs including named pipes,
TCP/IP sockets, and IPX/SPX. Although it is recommended that NetBEUI be
enabled for named pipes communication, you can use any one of those
protocols for named pipes connections to SQL Server, as long as the SQL
Server computer has the same protocol installed. Depending on the clients
you use, you may or may not have all of the IPCs available. If the clients
are Windows NT or Windows 95, all of the IPCs above are available. For
Windows 3.1 or Windows for Workgroups 3.11 clients, only the named pipes
IPC is available.
<P>
Depending on the IPCs used, the troubleshooting techniques are different:

<OL><P><LI>Named pipes: If you are using named pipes as the IPC, you can run
   the easy makepipe/readpipe test. This pair of utilities comes with
   all versions of SQL Server. Please consult the SQL Server documentation
   if you need any help using these utilities.
<P>
   If the pipe test fails, it indicates this is a Windows NT/Network/RAS
   problem. You should note the return status of the READPIPE, and contact
   your primary Windows NT/Network support provider if you do not know how
   to diagnose the problem based on the return status.

<P><LI>TCP/IP sockets: If you are using TCP/IP sockets through RAS, the first
   test you should run is the PING utility. If the PING fails from either
   the client or server side, it indicates a problem with Windows
   NT/Network/RAS, and again you should contact your primary Windows
   NT/Network support provider for help.
<P>
   If the PING test succeeds, this may not be a RAS specific issue. To
   verify, you can try connecting from a regular LAN client or from the
   local server through TCP/IP sockets. For more information about
   troubleshooting SQL Server connections via TCP/IP, see Knowledge Base
   article <B><A href="../sqlserver/q107647.htm">Q107647</A></B> ("INF: Connecting to SQL Server from TCP/IP Sockets
   Clients).

<P><LI>IPX/SPX sockets: If your RAS client can not connect to SQL Server via
   IPX/SPX, check the following:
<P>
<P><PRE>    - Verify this is a RAS-specific issue by plugging this RAS client
      into the LAN and use the Network Interface Card (NIC) to connect. If
      it still fails, it is not a RAS-specific issue. See Knowledge Base
      article <B><A href="../sqlserver/q107494.htm">Q107494</A></B> ("INF: Connecting to SQL Server from NetWare
      Clients") for information about how to troubleshoot IPX/SPX clients
      in general.
</PRE><P>
<P><PRE>    - Verify that RAS is working properly by attaching this RAS client to
      a NetWare file server on the network. If it fails, it means the RAS
      client or server is not installed correctly, and you should contact
      your primary Windows NT/Network/RAS support provider for further
      help.
</PRE><P>
<P><PRE>    - Use "ISQL /L" or "List Servers" in other SQL Server utilities to
      verify that this RAS client can see the SQL Server as listed. If SQL
      Server is not shown in the list, it means this client is attached to
      a NetWare file server which does not contain the SQL Server service
      object in its bindery. If this is a Win32 SQL client, please see
      Knowledge Base article <B><A href="../sqlserver/q130744.htm">Q130744</A></B> ("PRB: Connection Problems from
      Clients via IPX/SPX").
</PRE><P>
<P><PRE>    - If "ISQL /L" or "List Servers" does not display the SQL Server, you
      can also use a direct connection to SQL Server through hardcoding the
      IPX address of the server computer. See Knowledge Base article
      <B><A href="../sqlserver/q138716.htm">Q138716</A></B> ("INF: How to Debug Direct Connections to SQL Over IPX/SPX")
      for more information.
</PRE><P>
<P><PRE>    - If SQL Server and RAS server are running on the same computer, you
      need to make sure that you set the "internal network number" with a
      non-zero number that is unique among all network segment numbers for
      the NWLink IPX/SPX Compatible transport. This is needed because the
      computer would behave like one with multiple NICs when the RAS server
      is running on the same computer. See Knowledge Base article <B><A href="../sqlserver/q137787.htm">Q137787</A></B>
      ("INF: How to Configure NWLink to Run SQL Srv with Multiple NICs")
      for more information.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 dialup dial-up win95 phone modem wint<BR>
Keywords            : kbnetwork SSrvLan<BR>
Version             : 4.21 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
