

<HTML>
<HEAD>
<TITLE>PRB: Replication Tasks Don't Print Full Info on Error/Deadlock </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q152290">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1996/06/10">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When a replication task runs into an error or deadlock, it reports the error/deadlock message and returns back without providing any information about any committed transactions. The task might have successfully committed some transactions before t...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAAP,QAH6,QAB4,QAL4,QAG0,QABI,QABH,QAEV,QABM,QAYY,QAFO,QAZV,QAX6,QALQ,QAYC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Replication Tasks Don't Print Full Info on Error/Deadlock</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q152290</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a replication task runs into an error or deadlock, it reports the
error/deadlock message and returns back without providing any information
about any committed transactions. The task might have successfully
committed some transactions before the error or deadlock occurred, but
these transactions are going unreported.
<P>
<P><h2>CAUSE</h2>
 
<P>
The replication tasks maintain information that is to be logged in the task
history after the task completes successfully. But when the task encounters
an error/deadlock, this information is ignored and only the error/deadlock
message is logged in the task history.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There is no way to get information on the exact number of transactions that
were committed before the error/deadlock was encountered. This is generally
not an issue since the tasks, by default, do not log any information when
they are in "auto-start" mode. Generally, the only information of interest
is the error/deadlock message. Note that the subscriber has some of the
modifications even though the distribution task reports the error/deadlock
message. And any error condition will have to be corrected by the
administrator; deadlock conditions are usually taken care of, since the
task is automatically set to retry.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You may notice that some of the changes were visible at the subscriber
while the distribution process reported the "deadlock" message. There are
two different cases where this can happen with tasks related to
replication:

<OL><P><LI>Tasks with different jobbatchsize and commitbatchsize.
<P>
   Suppose the distribution task has a jobbatchsize of 100 and a
   commitbatchsize of 10. After 50 jobs are distributed, a deadlock is
   encountered. You see the deadlock message, but there is no indication
   that 50 jobs were committed. This may also apply to the logreader, since
   the transbatchsize and commitbatchsize can be configured for different
   values.

<P><LI>Tasks that are auto-start or scheduled.
<P>
   Auto-start replication tasks (logreader, distribution) read from one
   database/transaction log and write to another database. Say the
   distribution task reads jobbatchsize rows out of distribution database
   tables and writes to the subscriber in commitbatchsize batches; when the
   task is done with the jobbatchsize rows, it checks back with the
   distribution database to see if there are more rows to distribute (this
   is also the case with scheduled tasks, where the check is to see if
   there are more jobs to be distributed, based on the jobbatchsize and
   commitbatchsize). Assuming both jobbatchsize and commitbatchsize are
   100, the task reads 100 jobs, writes these 100 jobs as a single
   transaction, and checks back to see if there are more jobs. Now, after a
   few such attempts, and after having inserted a few hundred jobs, the
   task runs into deadlock; it just reports that the process encountered a
   deadlock and gives no information about the committed jobs. This also
   applies to the logreader, since it is designed to check the transaction
   log for new replicated transactions.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: deadlock missing committed transaction info<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
