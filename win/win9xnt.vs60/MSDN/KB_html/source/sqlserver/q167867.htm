

<HTML>
<HEAD>
<TITLE>BUG: SQL-DMO BulkCopy Object IncludeIdentityValues Property Fail </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167867">
<META NAME="KBModify" CONTENT="1997/10/09">
<META NAME="KBCreate" CONTENT="1997/05/01">
<META NAME="Keywords" CONTENT="kbbug6.50 SSrvAdmin SSrvDMO SSrvErr_Log SSrvGen kbenv kbhw">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 1319 (Starfighter65)   When inserting into a SQL Server table using the SQL Server Distributed Management Object's (SQL-DMO's) BulkCopy object, automatically incremented values are inserted into the table's identity column based on the identit...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAPN,QAW6,QAE1,QA9N,QAY4,QDMN,QA4H,QAKD,QACI,QABA,QBXS,QAKP,QA2O,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SQL-DMO BulkCopy Object IncludeIdentityValues Property Fail</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167867</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
BUG #: 1319 (Starfighter65)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When inserting into a SQL Server table using the SQL Server Distributed
Management Object's (SQL-DMO's) BulkCopy object, automatically incremented
values are inserted into the table's identity column based on the identity
column's seed. The values in the source file are not inserted into the
identity column. This occurs even when BulkCopy's IncludeIdentityValues
property is set to True.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.5. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The BulkCopy object's IncludeIdentityValues property activates
IDENTITY_INSERT so that a source file's values that map to an identity
column in the destination table can be explicitly inserted into the
identity column of a table. Records import properly, but the literal values
in the source file are not inserted into the identity column; rather, new,
incremented values, based on the initial property column's seed, are
inserted.
<P>
SQLTrace reveals that IncludeIdentityValues property runs a SET
IDENTITY_INSERT &lt;tablename&gt; ON in a different connection to SQL Server than
the connection that runs the ImportData method. The SET command only
applies to the current batch or connection.
<P>
For example, suppose you have a table with an identity column called Id,
whose seed is 1, and a char column called MyChar:
<P>
<PRE>   Id   MyChar
   --   ------

   1     A
   2     B

</PRE>Setting the IncludeIdentityValues to True should import the following data
<P>
<PRE>   Id   MyChar
   --   ----

   100   H
   101   I

</PRE>into the SQL table like so:
<P>
<PRE>   Id   MyChar
   --   ------

   1     A
   2     B
   100   H
   101   I

</PRE>However, it fails to work properly, and actually inserts the data as:
<P>
<PRE>   Id   MyChar
   --   ------

   1     A
   2     B
   3     H
   4     I

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about the BulkCopy object's IncludeIdentityValues
property, query on "IncludeIdentityValues" in SQL Server Books Online.
<P>
For sample code using the BulkCopy object, see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q152801.htm">Q152801</A></B>
   TITLE     : INF: Examples of Sp_OA Procedure Use and SQLOLE.Transfer
               Object
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: error message DMO<BR>
Keywords          : kbbug6.50 SSrvAdmin SSrvDMO SSrvErr_Log SSrvGen kbenv kbhw<BR>
Version           : 6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
