

<HTML>
<HEAD>
<TITLE>PRB: Procedures May Fail w/ Msg 2821 After v.6.0 Upgrade </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134749">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="kbsetup SSrvInst SSrvStProc">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  After you upgrade to Microsoft SQL Server version 6.0, you may encounter Msg 2821 when you try to access a stored procedure, trigger, or view:     You must drop and recreate procedure %.*s.  CAUSE =====  When you upgrade a database to SQL Server ve...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAC1,QAA1,QAA5,QA5E,QATP,QAB9,QAZV,QAB4,QBW7,QAI5,QADK,QAAP,QBBI,QAW6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Procedures May Fail w/ Msg 2821 After v.6.0 Upgrade</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134749</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you upgrade to Microsoft SQL Server version 6.0, you may encounter
Msg 2821 when you try to access a stored procedure, trigger, or view:
<P>
<PRE>   You must drop and recreate procedure %.*s.

</PRE><h2>CAUSE</h2>
 
<P>
When you upgrade a database to SQL Server version 6.0, all procedures,
triggers, and views are recreated from the text definition stored in
syscomments. If any of these objects fail this process during the upgrade,
any attempt to access the object fails with Msg 2821. The upgrade process
continues to check each object within a database, even if one fails.
<P>
Any attempt to execute a procedure fails with Msg 2821 specifying
the procedure name. Any attempt to access a view results in Msg 2821 and
Msg 4401. Additionally, any attempt to execute a command that causes a
trigger to fire results in Msg 2821 with no procedure name specified in the
error message.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
After you upgrade to SQL Server version 6.0, you should scan the
UPGRADE.OUT file found in the SQL60\INSTALL directory for any errors
reported while upgrading user databases. Pay close attention to the section
titled "Upgrading procedures, triggers, views....". Once the cause of the
error is found and corrected, run the sp_db_upgrade procedure in the
database that failed during the upgrade. This ensures the database has been
properly upgraded for version 6.0.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 sysprocedures syscomments<BR>
Keywords            : kbsetup SSrvInst SSrvStProc<BR>
Version             : 4.21a 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
