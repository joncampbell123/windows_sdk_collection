

<HTML>
<HEAD>
<TITLE>INF: SQL Server May Not Be Detected as Windows NT Version </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121023">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1994/09/25">
<META NAME="Keywords" CONTENT="kbtool SSrvSQL_Admin SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  SQL Server for Windows NT may not always be identified to the SQL Server tools as a Windows NT version of SQL Server if the installation SQL scripts are not run in the proper sequence.  MORE INFORMATION  When SQL Server Setup is building the master...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QDNQ,QBVV,QABH,QABI,QBWS,QATJ,QAA1,QDI2,QDIU,QA3W,QA28,QAZV,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: SQL Server May Not Be Detected as Windows NT Version</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121023</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server, version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SQL Server for Windows NT may not always be identified to the SQL Server
tools as a Windows NT version of SQL Server if the installation SQL scripts
are not run in the proper sequence.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When SQL Server Setup is building the master database, it runs several
scripts to build the system objects used by SQL Server and its tools. These
scripts are stored in the c:\sql\install directory:
<P>
<PRE>   Instmstr.Sql, Instcat.Sql, Instnt.Sql, Admin2.Sql, Object2.Sql

</PRE>The operations performed by these scripts are discussed on page 8 of the
Microsoft SQL Server "Configuration Guide."
<P>
Sometimes sites may run one or more of these scripts to restore system
objects. Users wanting to restore all of the system objects in their master
database should run the scripts in the order specified.
<P>
Any time the script INSTMSTR.SQL is run against a SQL Server for Windows NT
system, users must also run the INSTNT.SQL script. Failure to also run the
INSTNT.SQL script will lead to the following behavior:
<P>
<PRE>   Transfer manager will not connect to the server as a
   destination server, saying it is not a Windows NT server.

   The maximum allowed value for sp_configure memory will be only
   32000 instead of the normal value of 1048576.

</PRE>SQL Administrator 4.21 will exhibit the following behavior (the 4.20
version of SQL Administrator does not):
<P>
<PRE>   The Truncate Only and No_log options will be greyed out on
   the scheduled backups add event window.

</PRE>The following options will be greyed out on the System/Manage/Consistency
Check window.
<P>
<PRE>   Checkdb:     Do not check indexes
   Checkalloc:  Do not check indexes and
                Continue after error
   Check Text Allocations: All options

</PRE>The Database\Backup Restore\Tape directory and the Database\Backup
Restore\Backup Restore window tape functions will be greyed out or
disabled.
<P>
Any site experiencing these symptoms can resolve them by simply running the
INSTNT.SQL script:
<P>
<PRE>   cd \sql\install
   isql /Usa /P&lt;password&gt; /iinstnt.sql /oinstnt.out

</PRE>These symptoms could also occur if a site copied an OS/2 SQL Server
MASTER.DAT over to a Windows NT server and then ran SQL Server for Windows
NT without first running INSTNT.SQL as documented in the section titled
"Before Upgrading from Version 4.2 for OS/2" in the Server Installation'
chapter of the Microsoft SQL Server "Configuration Guide."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Windows NT grayed<BR>
Keywords            : kbtool SSrvSQL_Admin SSrvWinNT<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
