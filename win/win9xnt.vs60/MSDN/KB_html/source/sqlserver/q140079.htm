

<HTML>
<HEAD>
<TITLE>BUG: Can't Access Table Created w/ SP in Another Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140079">
<META NAME="KBModify" CONTENT="1997/03/18">
<META NAME="KBCreate" CONTENT="1995/11/21">
<META NAME="Keywords" CONTENT="SSrvProg SSrvStProc kbbuglist">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT=" BUG# NT: 11943 (4.21a)   After you create a table in database  C  from a stored procedure in database  A,  you can not access this table from a stored procedure in database C.  WORKAROUND  Create the procedure PROC1 as this one:  Create Procedure PR...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAS1,QABM,QA2Q,QAZV,QAY2,QA9N,QACI,QAG2,QBXR,QBWS,QA1S,QAY4,QAKP,QAKD,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Can't Access Table Created w/ SP in Another Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140079</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.21a 6.00
WINDOWS
kbprg kbbug4.21a kbbug6.00
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21a and 6.0
</UL> 
<P>
BUG# NT: 11943 (4.21a)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After you create a table in database "C" from a stored procedure in
database "A," you can not access this table from a stored procedure in
database C.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Create the procedure PROC1 as this one:
<P>
Create Procedure PROC1 @Param char(1) as
declare @tablename varchar(30)
select @tablename = 'baseC..TABLE2'
<PRE>   if @Param = '1'
      Select * into baseC..TABLE2 from TABLE1
        else
       Begin
      EXEC ("select * from " + @tablename )
      EXEC ("Drop Table " + @tablename )
       End

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This script demonstrates the problem:
<PRE>/*************************/
</PRE>use master
go
create database baseA on testdb
go
create database baseB on testdb
go
create database baseC on testdb
go
sp_dboption baseC,'select into/bulkcopy',true
go
use baseC
go
checkpoint
go
<PRE>/*************************/
</PRE>use baseA
go
create table TABLE1 (ind int,name char(10))
go
insert TABLE1 values (1,'toto11')
insert TABLE1 values (2,'toto12')
go
<PRE>/*************************/
</PRE>use baseB
go
create table TABLE1 (ind int,name char(10))
go
insert TABLE1 values (1,'toto21')
insert TABLE1 values (2,'toto22')
go
<PRE>/*************************/
</PRE>use baseA
go
Create Procedure PROC1 @Param char(1) as
<PRE>   if @Param = '1'
      Select * into baseC..TABLE2 from TABLE1
        else
       Begin
      select * from baseC..TABLE2
      Drop Table baseC..TABLE2
       End
</PRE>go
<PRE>/*************************/
</PRE>use baseB
go
Create Procedure PROC1 @Param char(1) as
<PRE>   if @Param = '1'
      Select * into baseC..TABLE2 from TABLE1
        else
       Begin
      select * from baseC..TABLE2
      Drop Table baseC..TABLE2
       End
</PRE>go
<PRE>/*************************/
</PRE>use baseA
go
exec baseA..PROC1 '1'
go
<PRE>/*********** Here is the problem **************/
</PRE>exec baseB..PROC1 '2'
go
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: SQL6 6.00 procedure sp sproc<BR>
KBCategory: kbprog kbbug4.21a kbbug6.00<BR>
KBSubcategory: SSrvStProc SSrvProg<BR>
Keywords            : SSrvProg SSrvStProc kbbuglist<BR>
Version             : 4.21a 6.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
