

<HTML>
<HEAD>
<TITLE>INF: Setting Up SQL Srv to Listen on Banyan VINES Net-Library </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142584">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1996/01/16">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork SSrvLan SSrvNet_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article details the steps required for setting up SQL Server to listen on Banyan VINES server-side net-library:  1.  Determine what Banyan StreetTalk group you would like to use with SQL     Server. This can be an existing group or a new group...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAA1,QDI2,QAB4,QABO,QAUJ,QAAP,QBWP,QABA,QBVV,QAHS,QAHR,QABI,QA2O,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Setting Up SQL Srv to Listen on Banyan VINES Net-Library</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142584</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21a and 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article details the steps required for setting up SQL Server to listen
on Banyan VINES server-side net-library:

<OL><P><LI> Determine what Banyan StreetTalk group you would like to use with SQL
<P><PRE>    Server. This can be an existing group or a new group. For a new group,
    use the MGROUP program included with VINES software to add a new group
    for your organization. Let's say you have decided to use "SQL" as your
    group and the organization is "MICROSOFT."
</PRE>
<P><LI> Create a StreetTalk PC-Based Service on the Banyan server in the form
<P><PRE>    of servicename@group@org (notice that servicename by default is the
    Windows NT computer name when setting up SQL Server network support for
    Banyan VINES net-library). This can be done by using MSERVICE included
    with the VINES software. Let's say you have decided to create this PC-
    Based Service: MYSERVER@SQL@MICROSOFT.
</PRE>
<P><LI> Create a Banyan user login by using the MUSER program included with the
<P><PRE>    VINES software. Let's say you have decided to create this Banyan login:
    SQLUSER@SQL@MICROSOFT.
</PRE>
<P><LI> Using the MGROUP program included with the VINES software, manage the
<P><PRE>    group SQL and place the login SQLUSER in the "AdminList" of this group.
    This gives the Banyan login SQLUSER administrative control over the PC-
    Based Service MYSERVER@SQL@MICROSOFT.
</PRE>
<P><LI> Install "Banyan Enterprise Client for Window NT" (available from
<P><PRE>    Banyan) on the Windows NT server where SQL Server is installed if you
    have not already done so.
</PRE>
<P><LI> On the Windows NT computer where SQL Server is installed, run the SQL
<P><PRE>    Setup program and choose Change Network Support. Choose Banyan VINES
    net-library and when it asks for the PC-Based Service Name, enter the
    name created in step 1 (in our example, it would be
    MYSERVER@SQL@MICROSOFT or just simply MYSERVER if SQL@MICROSOFT is in
    your Banyan default search group). Save the new configuration.
</PRE>
<P><LI> Shut down SQL Server if it is running.

<P><LI> Log in to Banyan using the Banyan login created in step 2. SQL Server
<P><PRE>    would not be able to listen on Banyan VINES net library if you have not
    already logged in to the Banyan Server before SQL Server starts.
</PRE>
<P><LI> Start SQL Server.

<P><LI>Verify whether SQL Server is listening on the Banyan net-library
<P><PRE>    correctly. Check the SQL Server errorlog to see if it contains a line
    indicating the particular server-side Banyan net-library DLL SQL Server
    is using.
</PRE><P>
</OL>For SQL Server 4.21a, the line looks like this:
<P>
<PRE>   Using 'SSMSVINN' version '4.21.0.1' to listen on 'MYSERVER'

</PRE></OL>For SQL Server 6.0, it is:
<P>
<PRE>   Using 'SSMSVI60' version '6.1.0.0' to listen on 'MYSERVER'

</PRE>If SQL Server cannot successfully listen on the Banyan VINES net-library,
there will be one or more error messages after the "using" message shown
above. Please reference Knowledge Base article <B><A href="../sqlserver/q126262.htm">Q126262</A></B>, "PRB: Resolving SQL
Server Server-side Vines Connectivity Errors" to help you troubleshoot and
correct the error. In addition, the operating system error message
generated by the server side net-library for Banyan is equal to the VINES
error number plus 10000. In other words, OS Error 11016 is the same as
VINES error number 1016. You can then use the VNSERR program included with
the VINES software to find out the VINES error text.
<P>
For example, if you type "VNSERR 1016", the follow message would be
generated:
<P>
<PRE>   STK1016 - NAME IS NOT A STREETTALK NAME.

   The name you specified is not a name that StreetTalk knows
   about.  Either you typed the name incorrectly or the name
   did not exist in the network.  Retype the name.


</PRE><h2>MORE INFORMATION</h2>
 
<P>
Once you have verified that SQL Server is listening on the Banyan VINES net-
library correctly and you still have problems connecting to it using the
client side Banyan VINES net-library, use Knowledge Base article <B><A href="../sqlserver/q126445.htm">Q126445</A></B>
"INF: Resolving SQL Server Client-Side Vines Connectivity Errors" to help
you troubleshoot the problem. You should pay attention to the "OS Error"
number, because it will give you more specific information regarding why
you are unable to connect. Please make sure that you are logged in to the
Banyan server before you attempt to connect to SQL Server from a Banyan
client. The Banyan login in this case does not have to be in the AdminList
of the group.
<P>
You can find additional information on how to setup Banyan VINES clients
from the SQL Server 4.21a Release Notes and the Microsoft SQL Server
"Administrator's Companion" for SQL Server 6.0.
<P>
For additional information on how to use the VINES software MSERVICE,
MUSER, VNSERR, and MGROUP, please refer to you VINES documentation. When
appropriate, you may need to work with your Banyan network administrator to
create the PC-Based service Name and the Banyan Login.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 Banyan network setup<BR>
Keywords            : kbinterop kbnetwork SSrvLan SSrvNet_Lib<BR>
Version             : 4.21a 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
