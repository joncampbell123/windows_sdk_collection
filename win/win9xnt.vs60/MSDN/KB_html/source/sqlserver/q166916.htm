

<HTML>
<HEAD>
<TITLE>BUG: Dynamic Execution with Long Comments May Fail with AV </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166916">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1997/04/15">
<META NAME="Keywords" CONTENT="kbbug6.00 kbusage SSrvStProc SSrvTran_SQL">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 15706   Dynamic execution of a Transact-SQL command with comments from a stored procedure may fail with an access violation (AV). You will receive the following error message at the client:     language_exec: Process # generated access violati...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAMB,QBVV,QAN0,QAB4,QAI5,QAKP,QBW7,QAI4,QDKW,QBWG,QAY2,QAVQ,QALZ,QAAP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Dynamic Execution with Long Comments May Fail with AV</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166916</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
BUG #: 15706
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Dynamic execution of a Transact-SQL command with comments from a stored
procedure may fail with an access violation (AV). You will receive the
following error message at the client:
<P>
<PRE>   language_exec: Process # generated access violation;
   SQL Server is terminating this process
   DB-Library Process Dead - Connection Broken

</PRE>You will find the following error message in the error log on the server,
followed by the stack dump information:
<P>
<PRE>   Error : 0, Severity: 19, State: 0
   language_exec: Process 11 generated access violation;
   SQL Server is terminating this process

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, either move the comments around or shorten the
comments.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following two sample scripts demonstrate the problem:
<P>
<PRE>   CREATE PROCEDURE sp_updateAuthors
   AS
   EXEC("
   UPDATE authors
   SET n.au_fname = o.au_fname,
      n.au_lname = o.au_lname,
      n.au_id = o.au_id,
      n.phone = o.phone,
      n.address = o.address,
      n.city = o.city,
      n.state = o.state
   FROM authors o, authors n
   /*12345678901234567890123456789012345678901234567890
     12345678901234567890123456789012345678901234567890
     12345678901234567890123456789012345678901234567890
     12345678901234567890123456789012345678901234567890
     12345678901234567890*/
   ")
   GO

   CREATE PROCEDURE sp_selectAuthors
   AS
   EXEC("
   SELECT *
   FROM authors a
   WHERE a.au_id IS NOT NULL and
         a.au_fname IS NOT NULL and
         a.au_lname IS NOT NULL and
         a.au_id IS NOT NULL and
         a.phone IS NOT NULL and
         a.address IS NOT NULL and
         a.city IS NOT NULL and
         a.state IS NOT NULL
   /*12345678901234567890123456789012345678901234567890
     12345678901234567890123456789012345678901234567890
     1234567890123456789012345678901234567890123456
   */
   ")
   GO
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug6.00 kbusage SSrvStProc SSrvTran_SQL<BR>
Version             : 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
