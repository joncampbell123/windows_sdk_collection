

<HTML>
<HEAD>
<TITLE>INF: Data Conversion Sample Program in Embedded SQL for COBOL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q66752 ">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1990/11/07">
<META NAME="Keywords" CONTENT="kbprg SSrvCobol SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The code listed below demonstrates several data conversion methods for bringing down SQL Server data and displaying it in a Microsoft Embedded SQL for COBOL program.  MORE INFORMATION  This example selects a varchar(80) field, a money field, an int...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAYL,QAEN,QAH4,QBC9,QBC8,QANO,QAMB,QAH2,QA9N,QA7O,QA7N,QACI,QANJ,QAEF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Data Conversion Sample Program in Embedded SQL for COBOL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q66752 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:
<P>
<PRE>  - Microsoft Embedded SQL version 4.2 for COBOL
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The code listed below demonstrates several data conversion methods for
bringing down SQL Server data and displaying it in a Microsoft
Embedded SQL for COBOL program.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This example selects a varchar(80) field, a money field, an int field,
and a datetime file into COBOL program variables and displays them.
<P>
The title field is straightforward. Price is brought down using a "v"
in the picture clause representing the assumed decimal place, and is
moved to a variable with a decimal point (.) to actually print the
decimal point. The reason for this is that the decimal point is not
accepted in the picture clause of a host variable.
<P>
Ytd-sales is also straightforward, except that it is moved into
another program variable so that the plus (+) sign and preceding 0
(zero) would not be displayed. The pubdate field is converted on the
SQL Server end and just returns the month, day, and year.
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>    WORKING-STORAGE SECTION.

    EXEC SQL INCLUDE SQLCA END-EXEC

    EXEC SQL BEGIN DECLARE SECTION END-EXEC
    01  title            pic x(80).
    01  price            pic s9(9)v9(9) comp-3.
    01  ytd-sales        pic s9(4) comp-3.
    01  pubdate          pic x(11).
    EXEC SQL END DECLARE SECTION END-EXEC

    01 price-convert     pic z(3).9(2).
    01 ytd-sales-convert pic z(4).

    PROCEDURE DIVISION.

    EXEC SQL
      select title, price, ytd_sales, convert(char(11),pubdate)
      into :title, :price, :ytd-sales, :pubdate
      from titles
      where title_id = "BU1111"
    END-EXEC
   * Ignore any warnings, sqlcode = 1. *
    if sqlcode = 0 or sqlcode = 1
      move price to price-convert
      move ytd-sales to ytd-sales-convert
    display title
      display "Has sold " ytd-sales-convert " copies this year, at
               $"price-convert " a copy."
      display "It was published on " pubdate
    else
      perform sql-error
    end-if
    stop run.

    sql-error.
    display "SQL error SQLCODE=" sqlcode.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbprg SSrvCobol SSrvProg<BR>
Version             : 4.2 | 4.2<BR>
Platform            : MS-DOS OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
