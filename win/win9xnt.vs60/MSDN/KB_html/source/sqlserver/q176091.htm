

<HTML>
<HEAD>
<TITLE>BUG: SQL 6.5 SEM Transfer UsingTCP/IP Registered Servers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176091">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1997/11/03">
<META NAME="Keywords" CONTENT="kbbug6.50 SSrvEntMan SSrvGen SSrvTrans">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 16065 (WINDOWS: 6.5)   You can use Microsoft SQL Server Enterprise Manager (SEM) with registered server names that contain a period ( . ) or a hyphen ( - ) in the name. For example, 157.57.8.256 (a TCP/IP Address) or Test-1 (a named pipe Advan...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWD,QASP,QAH6,QAUJ,QAZV,QAB4,QAK6,QASC,QALY,QAYY,QAKG,QBVX,QAY2,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SQL 6.5 SEM Transfer UsingTCP/IP Registered Servers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176091</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
BUG #: 16065 (WINDOWS: 6.5)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You can use Microsoft SQL Server Enterprise Manager (SEM) with registered
server names that contain a period (".") or a hyphen ("-") in the name. For
example, 157.57.8.256 (a TCP/IP Address) or Test-1 (a named pipe Advanced
configuration entry) and either a default Network Library of TCP/IP Sockets
or Named Pipes on the source server. However, when you transfer a database
from the source server to the destination server, you will lose of all data
in all tables from the source server and no data is transferred to the
destination server. This only occurs when the transfer is scripted at the
same physical computer as the source server.
<P>
When you use a named pipe without a period or hyphen
(\\ServerName\Pipe\Sql\Query, for example) to register servers and the
default Network Library of Named Pipes on the source server, and attempt to
transfer a database from the source server to the destination server, no
data or structures are transferred to the destination and the source data
is preserved.
<P>
<P>
<P><h2>WORKAROUND</h2>
 
<P>
In SQL Server version 6.5, use SEM to register SQL Servers with the machine
name, for example ServerName, to transfer databases.
<P>
You can also work around this problem by using Advanced Client entries the
SQL Client Configuration Utility if there is no period or hyphen in the
server name. Consider transferring from the destination server and pulling
data from the source server.
<P>
Another alternative is to use a Scheduled Transfer. You can use
Xfragnet.exe to set up a scheduled task that automatically executes on the
destination server. For additional information about using Xfragent.exe,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q172012.htm">Q172012</A></B>
   TITLE     : INF: How Scheduled Data Transfer Works

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.5. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Please note that you cannot use a period or hyphen in a server name. This
is clearly documented in SQL Server Books Online; see the "Registering
Servers" topic. You should not use IP addresses as the server names when
you register SQL Servers either. Also note that the use of internet domain
names can also cause the same problem because a domain name contains
periods (for example, myserver.microsoft.com").
<P>
When using the SEM with registered servers that contain a period or hyphen
in the server name of the source server, the database and all table
structures exist but with no data. On the destination server the database
exists, but no table structures are created and there is, therefore, no
data. The transfer completes with the message
<P>
<P>
<PRE>   The Transfer was completed Successfully

</PRE>or warning messages that user id's passwords are null if user id's were
transferred.
<P>
If you are logged on to the destination server and transfer the database
from the source server to the destination server using registered servers
with a period or hyphen, database structures and all data are transferred
completely.
<P>
This is not a problem when you use SQL Transfer Manager on the destination
server because the transfer function is unable to process periods or
hyphens in the server name, and thus makes a connection to the local pipe.
In this instance, this happens to be the correct server to connect to
because the local server is the destination server.
<P>
If you attempt the transfer using Windows 95 SEM with TCP/IP address
registered servers, the transfer fails with Error 10004 and you receive the
following error message:
<P>
<PRE>  Transfer not completed.

</PRE>The transfer may also fail (if SQL Server version 6.5 is installed on a
clean computer) with the following error message:
<P>
<PRE>   Transfer not complete. Please look at the error files for details.
   Error 21770: The name '&lt;destination database name&gt;' was not found
   in the database collection.

</PRE>The database is not transferred and there is no loss of data from the
source database. However, no additional information is included in the
error files and the &lt;destination database name&gt; is included and available
in the database collection.
<P>
If you are using named registered servers (without a period or hyphen in
the name) in the HOSTS or LMHOSTS files, the database structures and all
data are transferred completely. Also, if you are using non-machine name
advance entries for either TCP/IP or named pipes, the database structures
and all data is transferred completely.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Transfer Manager dot<BR>
Keywords          : kbbug6.50 SSrvEntMan SSrvGen SSrvTrans<BR>
Version           : Windows:6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
