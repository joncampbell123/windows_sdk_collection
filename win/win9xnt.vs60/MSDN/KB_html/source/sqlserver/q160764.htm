

<HTML>
<HEAD>
<TITLE>INF: ODBC ODS DSN &amp; Gateway Setup on Windows NT Server 4.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160764">
<META NAME="KBModify" CONTENT="1997/04/10">
<META NAME="KBCreate" CONTENT="1996/12/09">
<META NAME="Keywords" CONTENT="kbenv kbinterop kbusage SSrvODS">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article describes a quick method of setting up the ODBC Open Data Services (ODS) Data Source and the Gateway sample application on a computer running Windows NT Server 4.0 that is also running SQL Server 6.5. This article assumes that you have...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVW,QABM,QA9E,QBWP,QAA1,QDIK,QBWS,QAKD,QALM,QAIJ,QDI2,QAUJ,QAFI,QDIZ,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: ODBC ODS DSN &amp; Gateway Setup on Windows NT Server 4.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160764</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
<LI>Microsoft SQL Server Programmer's Toolkit, version 6.5
<LI>Microsoft Open Database Connectivity, versions 2.5 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes a quick method of setting up the ODBC Open Data
Services (ODS) Data Source and the Gateway sample application on a
computer
running Windows NT Server 4.0 that is also running SQL Server 6.5. This
article assumes that you have installed and successfully compiled the ODS
Sample applications provided in the Programmers Tool Kit (PTK),
specifically the Gateway.exe and the Odssamp.dll files. SQL Server must
also be configured to use named pipes, and the console should have named
pipes as the default network library. This example is based on the Intel
processor version.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Copy the Odsgt32.dll file from the PTK\I386 directory to the
   Winnt\System32 directory. Copy the Odssamp.dll file that was built from
   the Samples\Ods\Odsodbc project to the Winnt\System32 directory.

<P><LI>Start Regedt32 and go to HKey_Local_Machine on Local Machine to the
   Software\Microsoft\Mssqlserver\Mssqlserver key. Save this key as
   Gateway.key. On the Edit menu, click Add Key. Add a key called
   Software\Microsoft\Mssqlserver\Gateway, but leave the class blank.
   Select the Gateway key and restore the contents of Gateway.key into it.
   Answer Yes to the warning about overwriting the key with the values of
   the file.

<P><LI>Remove the Software\Microsoft\Mssqlserver\Gateway\CurrentVersion,
   Software\Microsoft\Mssqlserver\Gateway\Parameters and
   Software\Microsoft\Mssqlserver\Gateway\RPCNetLib keys. Open the
   Software\Microsoft\Mssqlserver\Gateway folder, and remove all the key's
   values, except the ListenOn value. Double-click the ListenOn value and
   change it to the following server-side library and pipe:
<P>
<P><PRE>      ListenOn: Reg_Multi_SZ:SSNMPN60,\\.\pipe\gateway\query
</PRE>
<P><LI>Using the Client Configuration Utility, select the Advanced section and
   enter the following:
<P>
<P><PRE>      Server: GATEWAY
      DLL Name: Named Pipes
      Connection String: \\.\pipe\gateway\query
</PRE><P>
   Click Add/Modify and use Regedt32 to verify that the settings in the
   Software\Microsoft\Mssqlserver\Client\Connectto key are as follows:
<P>
<P><PRE>      GATEWAY: REG_SZ: dbnmpntw,\\.\pipe\gateway\query
</PRE>
<P><LI>In Regedt32, go to HKEY_LOCAL_MACHINE\Software\Odbc\Odbc.ini on Local
   Machine. Add the following value to the ODBC Data Sources folder:
<P>
<P><PRE>      GATEWAY: REG_SZ: GATEWAY
</PRE><P>
   Next, add a key named "GATEWAY" to the HKEY_LOCAL_MACHINE\Software\
   Odbc\Odbc.ini key. This new key can be populated by the LocalServer
</OL>key.
<PRE>   Save it, and then restore the resulting file in the GATEWAY Key. The
   following key values that are not marked are not required. Those values
   that are required are marked below:

                         Database: REG_SZ: pubs
                      Description: REG_SZ:
      Required ----------&gt; Driver: REG_SZ: C:\WINNT40\System32\odsgt32.dll
      Required -&gt; GatewayResource: REG_SZ: C:\WINNT40\System32\
       (you must add it)           Odssamp.dll
                         Language: REG_SZ:
                         LastUser: REG_SZ: sa
      Required -------&gt; OEMTOANSI: REG_SZ: No
      Required ----------&gt; Server: REG_SZ: GATEWAY
               Trusted_Connection: REG_SZ:
                UseProcForPrepare: REG_SZ: No

</PRE><P><LI>Start SQL Server. Start the gateway application from a console window
   as follows:
<P>
<P><PRE>      gateway -RGATEWAY -SMyServerName
</PRE>
<P><LI>Using either MSQuery or ODBCTest, connect using the defined DSN. In the
   Gateway console window, verify that the connection has been made.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbenv kbinterop kbusage SSrvODS<BR>
Version             : 2.5 3.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
