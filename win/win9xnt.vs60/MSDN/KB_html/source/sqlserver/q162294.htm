

<HTML>
<HEAD>
<TITLE>INF: How to Schedule Backup &amp; DBCC Commands Using AT Scheduler </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162294">
<META NAME="KBModify" CONTENT="1997/07/21">
<META NAME="KBCreate" CONTENT="1997/01/17">
<META NAME="Keywords" CONTENT="kbinterop kbtool kbusage SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  There are times when you want jobs to be scheduled through the Windows NT Server AT scheduler rather than scheduled through the task scheduling manager used by the SQL Executive service. For example, you may want to schedule a job to stop SQL Serve...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAL4,QAIJ,QANE,QABM,QAGB,QAH8,QDIV,QBWS,QBRZ,QAUR,QACF,QDIU,QA9W,QA3W,QACK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Schedule Backup &amp; DBCC Commands Using AT Scheduler</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162294</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.2, 6.0, and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There are times when you want jobs to be scheduled through the Windows NT
Server AT scheduler rather than scheduled through the task scheduling
manager used by the SQL Executive service. For example, you may want to
schedule a job to stop SQL Server so that you can do a Windows NT Server
backup of all the SQL Server device files, and then schedule a job to
restart SQL Server once the backup is complete.
<P>
This article gives examples on using the AT scheduler to schedule jobs.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>To Schedule Database Dumps or DBCC Commands Through the AT Scheduler</h3>
 

<OL><P><LI>Open the Services Control Panel. Select the Schedule service and click
   Startup. Change the Startup Type to Automatic. Click OK and then click
   Close. If the Schedule service is not already started, start it now.

<P><LI>Create a text file with the dump commands and/or DBCC commands that you
   want to schedule, with the 'go' command between each statement and at
   the end of the file (you may want to manually test each command by going
   to the query window before you schedule this text file to run in
   production).
<P>
   NOTE: You can view all the options that are available through the AT
   scheduler by going to a command prompt and typing the following:
<P>
<P><PRE>      AT /? |MORE
</PRE>
<P><LI>Schedule your file to run. For example, if you want your file to run
   every day at 4:00 P.M. and you want the results to be saved to an output
   file, then you would type the following at a command prompt:
<P>
<P><PRE>      AT 16:00 /every:M,T,W,TH,F,S,SU "isql /Usa /P &lt;SA password&gt; /S
      &lt;server name&gt; /i c:\&lt;input file name&gt; /o c:\&lt;output file name&gt;"
</PRE><P>
   NOTE: If you want to view what jobs you have scheduled, type "AT" at the
   command prompt.
<P>
   NOTE: If you want to delete a specific job, type "AT" at the command
   prompt and write down the ID of the job you want to delete. Then type
   the following at the command prompt:
<P>
<P><PRE>      AT &lt;ID&gt;/delete
</PRE>
<P><LI>Turn off any other scheduled tasks scheduled through SQL Server that you
   have already scheduled through the AT scheduler.
<P>
</OL>To Stop or Start SQL Server Through the AT Scheduler at Specific Times, to
Perform Backups of the SQL Server Device Files
 

<OL><P><LI>Create two text files using a text editor such as Notepad. You may want
   to name the files Users\Default\Stop.bat and Users\Default\Start.bat.
<P>
   In SQL Server version 6.0 or 6.5, the services are MSSQLSERVER,
   SQLEXECUTIVE, and optionally MSDTC. In SQL Server version 4.2x, the
   services are SQLSERVER and SQLMONITOR.
<P>
   Add the following lines to the Stop.bat file:
<P>
<P><PRE>      net stop mssqlserver
      net stop sqlexecutive
</PRE><P>
   Add the following lines to the Start.bat file:
<P>
<P><PRE>      net start mssqlserver
      net start sqlexecutive
</PRE>
<P><LI>Schedule your Stop.bat file to run.
   NOTE: It may be easier if you can combine the Stop.bat, tape backup, and
   Start.bat all in one batch file.
<P>
   For example, if you want to stop the SQL Server services at 8:00 P.M.
   every night, type the following:
<P>
<P><PRE>      AT 20:00 /every:M,T,W,TH,F,S,SU"c:\users\default\stop.bat"
</PRE>
<P><LI>Once SQL Server is stopped, you can use whatever tape backup utility you
   want to make backups of the SQL Server device files.

<P><LI>Once the device files have been copied to tape, you should restart SQL
   Server. For example, if you want to start the SQL Server services at
   11:00 P.M. every night, type the following:
<P>
<P><PRE>      AT 23:00 /every:M,T,W,TH,F,S,SU"c:\users\default\start.bat"
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: checkdb newalloc dat log data database<BR>
Keywords            : kbinterop kbtool kbusage SSrvGen<BR>
Version             : 4.2 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
