

<HTML>
<HEAD>
<TITLE>BUG: Confusing Error Message w/ CREATE UNIQUE NONCLUSTERED INDEX </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168659">
<META NAME="KBModify" CONTENT="1997/09/23">
<META NAME="KBCreate" CONTENT="1997/05/19">
<META NAME="Keywords" CONTENT="kbbug6.50 SSrvTran_SQL kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 15660 (NT: 6.5)   In SQL Server 6.5, you will receive a message 1505 when duplicate values exist in a column and you attempt to create a unique index on that column. In versions of SQL Server 6.5 earlier than Service Pack 3, the message was a ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA28,QATJ,QAFO,QDO3,QAKH,QAB4,QBVX,QBXR,QAN6,QAKD,QAGB,QAKP,QAEV,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Confusing Error Message w/ CREATE UNIQUE NONCLUSTERED INDEX</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168659</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
BUG #: 15660 (NT: 6.5)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
In SQL Server 6.5, you will receive a message 1505 when duplicate values
exist in a column and you attempt to create a unique index on that column.
In versions of SQL Server 6.5 earlier than Service Pack 3, the message was
a bit confusing:
<P>
<PRE>   Msg. 1505, Level 16, State 1
   Create unique index aborted on duplicate key.  Primary key is 'type 3c,
   len 8'

</PRE>However, beginning in SQL Server 6.5 Service Pack 3, SQL Server indicates
the duplicate value that the CREATE INDEX command aborted on:
<P>
<PRE>   Msg 1505, Level 16, State 1
   Create unique index aborted on duplicate key.  Primary key is '12'

</PRE><h2>WORKAROUND</h2>
 
<P>
Identify the duplicate column values that make up the index and remove them
before issuing the CREATE UNIQUE NONCLUSTERED INDEX statement.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server version 6.5.
This problem has been fixed in Service Pack 3 for Microsoft SQL Server
version 6.5. You can download Service Pack 3 from the Web site at
<B><A href="http://www.microsoft.com/sql/servicepak.htm">http://www.microsoft.com/sql/ServicePak.htm.</A></B>
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
For more information, see the CREATE INDEX statement in the T-SQL Reference
Manual or the SQL Server Books Online.
 
<PRE>Keywords          : kbbug6.50 SSrvTran_SQL kbusage
Version           : 6.5
Platform          : WINDOWS
Issue type        : kbbug
Solution Type     : kbservicepack</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
