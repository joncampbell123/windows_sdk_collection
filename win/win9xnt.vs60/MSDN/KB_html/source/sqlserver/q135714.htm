

<HTML>
<HEAD>
<TITLE>FIX: Updating a Text Column Results in a Table Scan </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135714">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1995/08/27">
<META NAME="Keywords" CONTENT="kbbug2.50.0121 kbbug6.00 kbprg SSrvProg SSrvTran_SQL">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# NT: 10959 (6.00)   When you use the SQL Server ODBC driver version 2.50.0121 to update a text column, a table scan is performed and the update may take a very long time depending on the number of rows.  CAUSE =====  Applications that use ODBC ty...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QABM,QAC1,QBD2,QATX,QAMB,QA9E,QAR4,QBXN,QAUJ,QAH3,QAE1,QDIX,QDMN,QAU9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Updating a Text Column Results in a Table Scan</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135714</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Open Data Base Connectivity, version 2.5
<LI>Microsoft SQL Server, version 6.0
</UL> 
BUG# NT: 10959 (6.00)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the SQL Server ODBC driver version 2.50.0121 to update a text
column, a table scan is performed and the update may take a very long time
depending on the number of rows.
<P>
<P><h2>CAUSE</h2>
 
<P>
Applications that use ODBC typically call the SQLPutData API to update
text and image columns. With the new SQL Server driver, SQLPutData
internally issues the following statements to the SQL Server:
<P>
<PRE>   BEGIN TRAN
   SET TEXTSIZE 2147483646
   UPDATE &lt;table-name&gt; SET &lt;text-column name&gt;='#odbc#xxxxx' WHERE
   &lt;search condition&gt;
   SELECT TEXTPTR(&lt;text-column name&gt;) from &lt;table-name&gt; WHERE
   &lt;text-column name&gt; LIKE '#odbc#xxxxx'
   WRITETEXT BULK&lt;table-name&gt;.&lt;text-column name&gt; 0xxxxxxx WITH LOG
   COMMIT TRAN

</PRE>The SELECT statement uses a LIKE on the text column to get the text
pointer. This causes a table scan, and if the table has a significant
number of rows, takes a considerable amount of time. The overall effect is
a slower UPDATE.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the 2.50.0121 version
of the SQL Server ODBC driver. This problem was corrected in Service Pack 1
for SQL Server version 6.0. For more information, contact your primary
support provider.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 mfc<BR>
Keywords            : kbbug2.50.0121 kbbug6.00 kbprg SSrvProg SSrvTran_SQL<BR>
Version             : 2.5.0121 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
