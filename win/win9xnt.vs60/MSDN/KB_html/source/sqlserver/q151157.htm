

<HTML>
<HEAD>
<TITLE>INF: Max Number of Concurrent DB-Library Tasks in SQLExec </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151157">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1996/05/18">
<META NAME="Keywords" CONTENT="kbusage SSrvAdmin SSrvRep">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  In Microsoft SQL Server 6.5, the default number of maximum concurrent SQLExec tasks using a DB-Library connection has been increased to 61. This value is also configurable via a registry entry.  MORE INFORMATION  The limitation can be adjusted by a...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAL4,QAKC,QAI5,QBG2,QAG0,QBC6,QAH6,QAKD,QAIJ,QABA,QBWS,QAG8,QAL2,QAJZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Max Number of Concurrent DB-Library Tasks in SQLExec</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151157</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In Microsoft SQL Server 6.5, the default number of maximum concurrent
SQLExec tasks using a DB-Library connection has been increased to 61. This
value is also configurable via a registry entry.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The limitation can be adjusted by adding the MaxDBProcesses Value Name to
the following registry entry:
<P>
<PRE>   HKEY_LOCAL_MACHINE: SOFTWARE\Microsoft\MSSQLServer\SQLExecutive

</PRE>The value should be added as a Data Type of REG_DWORD. Possible values are
from 10 to 255 (Decimal). Please note that the actual number of concurrent
tasks allowed will be two less (three less for SQL Server 6.5) than the
number you specify in the registry value to allow for SQLExecutive
overhead.
<P>
In Microsoft SQL Server version 6.0, this limitation defaults to 23 and is
not configurable. Any task that is executed using DB-Library above this
number will typically fail with a standard "Unable to connect to &lt;server&gt;"
message written to the Task History.
<P>
<P>
A Transact-SQL task requires one DB-Library connection while LogReader and
SYNC tasks each require two separate DB-Library connections. A Distribution
task will only require one DB-Library connection when processing a "SYNC"
job to a SQL Server subscriber. "SYNC" jobs occur because of an initial
automatic synchronization or scheduled table refresh event. If a LogReader
task is configured to run as "AutoStart" it will keep open its DB-Library
connection(s) until the task is shutdown or fails. The Distribution task
will only keep its DB-Library connection open when processing a "SYNC" job
until the job completes even if it is scheduled as "AutoStart".
<P>
See Knowledge Base article <B><A href="../sqlserver/q89937.htm">Q89937</A></B>, "INF: Getting Started with Microsoft SQL
Server Replication," for more information about replication tasks.
<P>
If you encounter this problem on a distribution server using SQL Server 6.0
replication, use the following techniques:

<OL><P><LI>Schedule replication tasks so that the limit will not be reached keeping
   in mind the above description of how many DB-Library connections each
   task can consume.

<P><LI>Spread the load of replication tasks across separate distribution
   servers. This can be accomplished by selectively grouping publishing
   servers with several different distribution servers instead of using
   one dedicated distribution server.
<P>
</OL>CmdExec tasks are not included in this calculation even if they execute a
program that uses DB-Library (like ISQL.EXE) because a separate process is
spawned to run this type of task.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dbsetmaxprocs<BR>
Keywords            : kbusage SSrvAdmin SSrvRep<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
