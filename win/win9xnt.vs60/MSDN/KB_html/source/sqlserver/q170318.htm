

<HTML>
<HEAD>
<TITLE>BUG: Error When Inserting NULL into Timestamp with ANSI_NULLS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170318">
<META NAME="KBModify" CONTENT="1997/07/08">
<META NAME="KBCreate" CONTENT="1997/06/18">
<META NAME="Keywords" CONTENT="kbbug6.50 kbinterop kbusage SSrvGen SSrvTran_SQL">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 15818 (NT: 6.50)   When attempting to insert the value 'NULL' into a timestamp column with ANSI_NULLS enabled, error 273 is returned:     The user can't INSERT a non-null value into a TIMESTAMP column.    Use INSERT with a column list or with ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA9N,QACI,QAE1,QDKW,QAKP,QAY4,QAS1,QAKD,QDMN,QBXS,QA5E,QALZ,QAIK,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Error When Inserting NULL into Timestamp with ANSI_NULLS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170318</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
BUG #: 15818 (NT: 6.50)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When attempting to insert the value 'NULL' into a timestamp column with
ANSI_NULLS enabled, error 273 is returned:
<P>
<PRE>   The user can't INSERT a non-null value into a TIMESTAMP column.
   Use INSERT with a column list or with a default of NULL for the
   TIMESTAMP column.

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do either of the following:

<UL><LI>Disable ANSI_NULLS before inserting NULL into a timestamp column, as in
   the following example:
<P>
<P><PRE>      create table tblNull ( iId int, timestamp )
      go
</PRE><P>
<P><PRE>      set ansi_nulls off
      go
</PRE><P>
<P><PRE>      insert tblNull values (1, NULL)
      go
</PRE><P>
   -or-

<LI>Use a column list on the INSERT statement and omit the timestamp, as in
   the following example:
<P>
<P><PRE>      insert tblNull (iId) values (1)
      go
</PRE><P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.5. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You may encounter this problem when you attempt to use the Microsoft FoxPro
Upsizing Wizard. The current version of the Upsizing Wizard does not allow
you to disable the 'Add Timestamp' feature. For a technique to work around
this problem, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../foxpro/q139757.htm">Q139757</A></B>
   TITLE     : FIX: Upsize Wizard Falsely Creates Timestamp Field on
               SQL 6.0
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 6.50.201<BR>
Keywords            : kbbug6.50 kbinterop kbusage SSrvGen SSrvTran_SQL<BR>
Version             : 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
