

<HTML>
<HEAD>
<TITLE>PRB: Double Quotation Mark Params Error w/ Quoted Identifiers </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135531">
<META NAME="KBModify" CONTENT="1998/02/19">
<META NAME="KBCreate" CONTENT="1995/08/23">
<META NAME="Keywords" CONTENT="SSrvProg SSrvTran_SQL kbprg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  If you enclose a character string in double quotation marks that is over 30 bytes long, the application may receive the error:     Msg 103, Level 15, State 2    The identifier that starts with 'a' is too long. Maximum length is 30.  CAUSE =====  SQ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA50,QAHH,QA9E,QBXS,QAHE,QAB9,QAFO,QAKD,QAB4,QAAP,QAU9,QAGI,QANY,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Double Quotation Mark Params Error w/ Quoted Identifiers</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 19, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135531</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you enclose a character string in double quotation marks that is over 30
bytes long, the application may receive the error:
<P>
<PRE>   Msg 103, Level 15, State 2
   The identifier that starts with 'a' is too long. Maximum length is 30.

</PRE><h2>CAUSE</h2>
 
<P>
SQL Server version 6.0 does not always flag stored procedure parameters
enclosed in double quotation marks if the SET QUOTED_IDENTIFIER ON option
has been issued.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Change the procedure call to enclose the parameter values in single
quotation marks:
<P>
<PRE>   execute myproc 1, 'abcdefghijklmn'

</PRE>ODBC applications can also use bound parameter markers instead of
providing the values directly using either proprietary Transact-SQL
syntax:
<P>
<PRE>   SQLExecDirect(hstmt, "execute myproc ?,?", SQL_NTS);

</PRE>or, the ODBC standard syntax:
<P>
<PRE>   SQLExecDirect(hstmt, "{ call myproc (?,?)}", SQL_NTS);

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Microsoft SQL Server version 6.0 introduces the concept of quoted
identifiers. As described in the "Transact-SQL Reference," when the
QUOTED_IDENTIFIERS option is set on (SET QUOTED_IDENTIFIERS ON), SQL Server
expects quoted identifiers to be enclosed in double quotation marks (") and
data values to be enclosed in single quotation marks ('). In the case of
character parameters of stored procedures, data values enclosed in double
quotation marks are accepted by SQL Server if the character string is less
than 30 bytes long. They should be considered syntax errors by SQL Server
and generate an error.
<P>
You can also see this in ODBC applications using the Microsoft ODBC SQL
Server driver version 2.50.0121. This driver sets QUOTED_IDENTIFIERS
ON when it runs against a SQL Server version 6.0 server so that the
driver's behavior more closely matches the ANSI and ODBC standards. ODBC
applications which use double quotation marks for parameter values may see
this behavior after you upgrade to SQL Server version 6.0 and the ODBC
2.50.0121 driver.
<P>
This behavior has been seen when using stored procedures that contain
nested stored procedure execution with parameters delimited in double-
quotes (such as xp_cmdshell) from ODBC applications such as Internet
Information Server.
<P>
In these cases, you may be able to workaround the problem by placing a
SET QUOTED_IDENTIFIER OFF statement at the beginning of the stored
procedure. This setting will only be in effect for the scope of the stored
procedure and not affect other statement execution outside of the stored
procedure.
<P>
Example:
<P>
create procedure iisproc
as
begin
declare @stmt varchar(255)
set quoted_identifier off
select @stmt = 'xp_cmdshell "c:\myprog xxxxxxxxxxxxxxxxxxxxxxxx"'
exec (@stmt)
end
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 delimiters string constants<BR>
Keywords          : SSrvProg SSrvTran_SQL kbprg<BR>
Version           : WINNT:6.0,6.5<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 19, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
