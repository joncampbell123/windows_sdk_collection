

<HTML>
<HEAD>
<TITLE>FIX: ODBC Only Uses Named Pipes if Non-Admin Win NT Account </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141086">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1995/12/11">
<META NAME="Keywords" CONTENT="kbbug6.00 kbinterop kbnetwork SSrvLan SSrvNet_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# NT: 12169 (6.00)   When running under a non-Administrator NT account, the Microsoft SQL Server ODBC Driver and ODS ODBC Driver may only make named pipe connections.  STATUS ======  Microsoft has confirmed this to be a problem in the Microsoft SQ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QAI5,QBG2,QA9E,QAUJ,QAU9,QAR4,QARL,QAA1,QALQ,QDI2,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: ODBC Only Uses Named Pipes if Non-Admin Win NT Account</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141086</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
BUG# NT: 12169 (6.00)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When running under a non-Administrator NT account, the Microsoft SQL Server
ODBC Driver and ODS ODBC Driver may only make named pipe connections.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in the Microsoft SQL Server
ODBC Driver version 2.50.0121. This problem has been corrected in Microsoft
ODBC Driver version 2.65.0201.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft SQL Server ODBC Driver and ODBC ODS Driver may not correctly
read the SQL Server advanced client connection entries when running under a
Windows NT account that is not in an administrators group. In these
circumstances, the drivers can only make named pipe connections. Non-
administrative clients can connect if the following conditions are met:

<OL><P><LI>The SQL Server they are connecting to is listening on named pipes.

<P><LI>The client is set up to support named pipe connections to the server.
   Named pipes will map down over protocol stacks such as the NWLink stack
   or Microsoft's TCP/IP stack, and netbeui. See the SQL Server 6.0 "Setup"
   and "Administrator's Companion" manuals for further information.

<P><LI>The ODBC data source has the name of the Windows NT server running SQL
   Server in the SERVER entry, or on a SQLDriverConnect the SERVER=
   parameter names the Windows NT server running SQL Server.
<P>
</OL><h2>WORKAROUND</h2>
 
<P>
Log on to the client using an NT Admin account. Using RegEdit, focus on the
key:
<P>
HKEY_LOCAL_MACHINE
<PRE>  SOFTWARE
    Microsoft
      MSSQLServer
        Client
          ConnectTo

</PRE></OL>Using the Security/Permissions menu, either give the Everyone account Full
Control of the key, or add the non-Admin account to the permissions list
with Full Control of the key.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 SQLExecDirect SQLExecute iis internet server<BR>
idc .idc socket sockets connector<BR>
Keywords            : kbbug6.00 kbinterop kbnetwork SSrvLan SSrvNet_Lib<BR>
Version             : 2.5 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
