

<HTML>
<HEAD>
<TITLE>BUG: CmdExec May Cause Exception Violation on Scheduled Tasks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171323">
<META NAME="KBModify" CONTENT="1997/08/15">
<META NAME="KBCreate" CONTENT="1997/07/14">
<META NAME="Keywords" CONTENT="kbbug6.50 SSrvEntMan SSrvGPF kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 17090   Scheduled tasks of type CmdExec may cause an exception violation. A message similar to the following will appear in the Event Viewer:     EventID: 212    Source: SQLExecutive    User: N/A    Type: Error    Category: Task Engine     Tas...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QABM,QAL4,QABI,QANE,QAB4,QABH,QAKP,QAZV,QAU3,QAMR,QAI4,QAFH,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: CmdExec May Cause Exception Violation on Scheduled Tasks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171323</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
BUG #: 17090
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Scheduled tasks of type CmdExec may cause an exception violation. A message
similar to the following will appear in the Event Viewer:
<P>
<PRE>   EventID: 212
   Source: SQLExecutive
   User: N/A
   Type: Error
   Category: Task Engine

   Task &lt;task no&gt;, '&lt;task name&gt;' has caused an exception violation in the
   CmdExec subsystem, and has been terminated.

</PRE>Even if the scheduled task, (that is, SQLMaint), completes successfully, it
shows a Last Run Status of "Failed" in the Manage Scheduled Tasks screen
within SQL Enterprise Manager. The Task History screen does not display any
error message to explain the failure.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior is a result of a problem with the CmdExec utility. While
running, Cmdexec.dll creates a temporary file that holds the redirected
stdio and stderr output for the task. If the number of bytes within this
file happens to be within certain ranges, an exception violation is
generated.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, adjust the size of the output written to stdio
and stderr by the CmdExec task being scheduled. If you are unsure about
what output is being generated, try running the task at a command prompt
and observing the results written to the screen. Increase or reduce the
number of bytes written by at least two bytes to avoid exposure to this
problem.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.5. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The nature of this problem is such that there is only a small chance that a
given CmdExec task will be affected.
<P>
An example would be if you scheduled SQLMaint to perform routine database
maintenance and noticed that the database maintenance report shows
successful completion but the task reports failure in the Task Manager
screen in SQL Enterprise Manager.
<P>
Because the output produced is saved to the report (.rpt) file, there is no
need to run this from the command prompt to view the stdio and stderr
listings. An example of a SQLMaint report file is shown below.
<P>
By reviewing this output, you can decide on the most appropriate means of
causing the byte-count to be increased or reduced by at least two (for
example, by changing the dump file name in paragraph 7 or by ensuring that
the database is in single user mode so that the WARNING in paragraph 2 is
suppressed).
<P>
The following is a sample SQLMaint report:
<P>
Microsoft (R) SQLMaint Utility, Version 6.50.240
Copyright (C) Microsoft Corporation, 1995 - 1996
<P>
Logged on to SQL Server 'MYSERVER' as 'sa' (trusted)
Starting maintenance of database 'pubs' on Wed Jul 09 13:28:32 1997
<P>
[1] Check Data and Index Linkage...
<P>
<PRE>    ** Execution Time: 0 hrs, 0 mins, 3 secs **

</PRE>[2] Check Data and Index Allocation...
<PRE>    WARNING: Database pubs is currently being used by 4 user(s).
             This may cause spurious problems to be reported.

    ** Execution Time: 0 hrs, 0 mins, 2 secs **

</PRE>[3] Check Text/Image Data Allocation...
<P>
<PRE>    ** Execution Time: 0 hrs, 0 mins, 1 secs **

</PRE>[4] Check System Data...
<P>
<PRE>    ** Execution Time: 0 hrs, 0 mins, 1 secs **

</PRE>[5] Update Statistics...
<P>
<PRE>    ** Execution Time: 0 hrs, 0 mins, 27 secs **

</PRE>[6] Index Rebuild (leaving 10% free space)...
<P>
<PRE>    Rebuilding indexes for table 'authors'
    Rebuilding indexes for table 'discounts'
    Rebuilding indexes for table 'employee'
    Rebuilding indexes for table 'pub_info'
    Rebuilding indexes for table 'publishers'
    Rebuilding indexes for table 'roysched'
    Rebuilding indexes for table 'sales'
    Rebuilding indexes for table 'stores'
    Rebuilding indexes for table 'testing'
    Rebuilding indexes for table 'titleauthor'
    Rebuilding indexes for table 'titles'

    ** Execution Time: 0 hrs, 0 mins, 7 secs **

</PRE>[7] Database Backup...
<PRE>    Destination: 'D:\MSSQL\BACKUP\pubs_db_dump.199707091329'

    ** Execution Time: 0 hrs, 0 mins, 4 secs **

</PRE>[8] Delete Old Backup Files...
<PRE>    0 file(s) deleted.

</PRE>End of maintenance for database 'pubs' on Wed Jul 09 13:29:15 1997
<P>
SQLMAINT.EXE Process Exit Code: 0 (Success)
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: error err message access application<BR>
Keywords          : kbbug6.50 SSrvEntMan SSrvGPF kbusage<BR>
Version           : 6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
