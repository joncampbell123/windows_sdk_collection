

<HTML>
<HEAD>
<TITLE>INF: Using BCP When Data Is Within Quotation Marks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q73182 ">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1991/06/18">
<META NAME="Keywords" CONTENT="kbtool SSrvBCP">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article describes how to customize the bulk copy program (BCP) format file to strip off unwanted quotation marks around the character strings in the data file.  MORE INFORMATION  It is possible to customize the BCP format file to strip off quo...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA50,QABM,QDNG,QAEF,QAI4,QBXT,QA5V,QAIB,QAYY,QAKC,QBC6,QA9N,QA7O,QA7N,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using BCP When Data Is Within Quotation Marks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q73182 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server versions 4.2 for OS/2
  - Microsoft SQL Server versions 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to customize the bulk copy program (BCP)
format file to strip off unwanted quotation marks around the character
strings in the data file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
It is possible to customize the BCP format file to strip off quotation
marks that surround character strings in the user's ASCII data file.
This process requires modifying the terminators to include a
backslash+quotation mark (\") to interpret the quotation mark as a
literal. If the first field in the data file is within quotation marks,
you must add a new line to the BCP format file to dispose of the first
quotation mark.
<P>
This example explains how to use BCP in the data file to exclude
the quotation marks:
<P>
<P><h3>Data File</h3>
 
"John","Doe",33,"New York"
"Jane","Doe",31,"Seattle"
<P>
<P><h3>Format File</h3>
 
4.0
4
<PRE>1    SYBCHAR   0    12   ","       1    F_NAME
2    SYBCHAR   0    12   ","       2    L_NAME
3    SYBCHAR   0    4    ","       3    AGE
4    SYBCHAR   0    12   "\r\n"    4    BIRTH_PLACE

</PRE>Perform the numbered steps below to modify the format file to
remove the quotation marks:

<OL><P><LI>Increment the data field counter (line two of the format file) and
   the field number designators (numbers just below) by one. Then add
   a new first data description line to remove the first quotation mark:
<P>
<P><PRE>      4.0
      4+1
<PRE></PRE>      1    SYBCHAR   0    1    ""        0    FIRST_QUOTE &lt;== NEW LINE
      1+1  SYBCHAR   0    12   ","       1    F_NAME
      2+1  ...

</PRE><P><LI>Next, modify the terminators to include quotation marks:
<P>
<PRE>      Data           Terminator     Appearance in Format File
      ----           ----------     --------------------------

      abc","abc      ","            "\",\""
      abc",123       ",             "\","
      123,"abc       ,"             ",\""
      abc"           "&lt;EOL&gt;         "\"\r\n"

</PRE></OL>The final version of the BCP format file will resemble the following:
<P>
<PRE>   4.0
   5
   1    SYBCHAR   0    1    ""        0    FIRST_QUOTE
   2    SYBCHAR   0    12   "\",\""   1    F_NAME
   3    SYBCHAR   0    12   "\","     2    L_NAME
   4    SYBCHAR   0    4    ",\""     3    AGE
   5    SYBCHAR   0    12   "\"\r\n"  4    BIRTH_PLACE

</PRE>NOTE: The first line of the BCP.FMT refers to the version of the
program. When running the version 1.1 or 1.11 of BCP this value is
4.0. In SQL Server 4.2 this value is 4.2.
<P>
For similar examples with Microsoft SQL Server version 4.21a, 6.0 and
6.5, please see the following article(s) in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q132463.htm">Q132463</A></B>
   TITLE     : INF: Using BCP When Data is in Quotation Marks
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.20 quotes Windows NT<BR>
Keywords            : kbtool SSrvBCP<BR>
Version             : 4.2<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
