

<HTML>
<HEAD>
<TITLE>BUG: Improper Load of Master Hangs SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119912">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1994/08/29">
<META NAME="Keywords" CONTENT="kbbug4.20 kbother SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# NT: 866 (4.2)   If you load an outdated dump of the master database, it may cause Microsoft SQL Server to not restart.  Bug number 866 covers a specific case of the problems that can occur if an incorrect dump of master is loaded. If you drop a ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAOE,QAMA,QAZV,QA5E,QAIJ,QAJQ,QDK2,QAXB,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Improper Load of Master Hangs SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119912</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2
</PRE> 
BUG# NT: 866 (4.2)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you load an outdated dump of the master database, it may cause
Microsoft SQL Server to not restart.
<P>
Bug number 866 covers a specific case of the problems that can occur if an
incorrect dump of master is loaded. If you drop a database and
recreate it so that it gets the same database id, and the log of the new
database maps back into the same area on the same device that held the old
database, then SQL Server will not restart if a dump of master is loaded
that contains the old mapping for the database.
<P>
SQL Server version 4.2 generates a Dr. Watson window on the restart
which reads:
<P>
<PRE>   SQLSERVR.EXE had a stack overflow (0xc00000fd), address:0x0041f27f.

</PRE>SQL Server version 4.21 will appear to start successfully, but all attempts
to connect will time out, including even a local isql connection attempt.
SQL Server cannot be stopped with the stoplight application or net stop,
and the server must be rebooted.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you have a copy of the MASTER.DAT from just before the load, restore
it and restart SQL Server. If you have another dump of master that is
good, restart SQL Server from the command line as follows:
<P>
<PRE>   sqlservr -T3608

</PRE>Then, connect as sa and load the proper dump of the master. If neither of
these options is available, contact your SQL Server support provider. An
attempt could be made to rebuild the master database as per Example 4 on
page 316 of the "System Administrator's Guide," but this is a time
consuming process that is best performed under the guidance of your SQL
Server support provider.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 4.2. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
This problem does not occur in Microsoft SQL Server version 6.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
As mentioned in the SQL Server "System Administrator's Guide," you should
always dump your master database whenever any of the system information in
the database changes, and any attempt to load the master database must be
made from this most current dump. Page 309 of the "System Administrator's
Guide" lists the most common commands which alter system information in the
master database.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Windows NT<BR>
Keywords            : kbbug4.20 kbother SSrvWinNT<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
