

<HTML>
<HEAD>
<TITLE>PRB: Error Attempting to Insert Explicit Values w/ Append Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175624">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1997/10/24">
<META NAME="Keywords" CONTENT="SSrvGen kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  An append query from a Microsoft Access 97, Access 95, or Access 2.0 database to a table in SQL Server 6.0 or SQL Server 6.5 may generate the following message:     Attempting to insert explicit value for identity column in                when iden...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAKD,QAE1,QACI,QA9N,QDMN,QA5V,QA1S,QAY4,QAY2,QAGN,QAB4,QAI4,QDN9,QBVV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error Attempting to Insert Explicit Values w/ Append Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175624</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
An append query from a Microsoft Access 97, Access 95, or Access 2.0
database to a table in SQL Server 6.0 or SQL Server 6.5 may generate the
following message:
<P>
<PRE>   Attempting to insert explicit value for identity column in &lt;tablename&gt;
   when identity_insert is set to off.

</PRE>This message appears if both of the following conditions are true:

<UL><LI>The append query tries to insert a record from the source table that has
   NULLs for all the columns, or the selected data from the source table
   has rows that have NULLs for all the columns.
<P>
   -and-

<LI>The destination table in the SQL Server database has a column with the
   IDENTITY property.
<P>
</UL>Note that this problem occurs even if explicit values for the identity
column are not specified.
<P>
<P><h2>CAUSE</h2>
 
<P>
Jet handles the append query request in a different way for rows when all
the columns contain NULL values. For an example, see the MORE INFORMATION
section of this article.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, make sure that the rows from the source table
being inserted into the destination table do not have all NULL values. You
can do this by adding the criteria "IS NOT NULL" for any particular column
in the append query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Suppose you have the following two tables:
<P>
<PRE>Source table     : TABLE_S with columns col1, col2, col3 allowing NULLs.
</PRE>Destination table: TABLE_D with columns colA, colB, colC, colD with colA
being an IDENTITY column and the rest allowing null values.
<P>
Col1 and col2 from TABLE_S are being selected and appended to TABLE_D with
colB and colC as the corresponding columns.
<P>
In the normal case, when either col1 or col2 for a particular row has a non-
NULL value, the SQL statement that would go into SQL Server would be:
<P>
<PRE>   Insert into &lt;owner&gt;.TABLE_D (colB, colC) values (val1,val2)

</PRE>When both col1 and col2 are null for a particular row, the SQL statement
that goes into SQL Server would include all the columns in the destination
table, thereby trying to insert NULL values into every column, as in the
following:
<P>
<PRE>   Insert into &lt;owner&gt;.TABLE_D (colA,colB,colC,colD) values
   (NULL,NULL,NULL,NULL)

</PRE>This happens even though colA and colD are not specified in the append
query.
<P>
Because colA in TABLE_D has an IDENTITY property, SQL Server returns the
following error message and the append query fails:
<P>
<PRE>   Attempting to insert explicit value for identity column in &lt;tablename&gt;
   when identity_insert is set to off.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: col<BR>
Keywords          : SSrvGen kbinterop<BR>
Version           : WINNT:6.0 6.5<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
