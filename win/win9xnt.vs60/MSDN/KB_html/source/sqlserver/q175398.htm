

<HTML>
<HEAD>
<TITLE>PRB: SQL Server May Appear to Stop Responding Upon Startup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175398">
<META NAME="KBModify" CONTENT="1997/10/21">
<META NAME="KBCreate" CONTENT="1997/10/20">
<META NAME="Keywords" CONTENT="SSrvGen SSrvStProc kbenv kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  SQL Server starts successfully, but any attempt to connect to it is unsuccessful. It appears as if the server has stopped responding.  CAUSE =====  The automatically executed sp_sqlregister stored procedure calls the xp_sqlregister extended stored ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QABM,QDIV,QAGB,QABY,QANE,QAIJ,QAB4,QDKW,QAB9,QBFY,QAJQ,QAD7,QACK,QDNN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SQL Server May Appear to Stop Responding Upon Startup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175398</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SQL Server starts successfully, but any attempt to connect to it is
unsuccessful. It appears as if the server has stopped responding.
<P>
<P><h2>CAUSE</h2>
 
<P>
The automatically executed sp_sqlregister stored procedure calls the
xp_sqlregister extended stored procedure. The DLL that contains this
extended stored procedure has additional functions that depend on Open
Database Connectivity (ODBC). If the versions of Odbcint.dll and Odbc32.dll
on the computer are different, the ODBC Driver Manager produces the
following message:
<P>
<PRE>   The ODBC resource DLL(C:\WINNT\System32\odbcint.dll) is a different
   version than the ODBC driver manager (C:\WINNT\System32\ODBC32.dll).

   You need to reinstall the ODBC components to ensure proper operation.

   PRESS OK to proceed, CANCEL to abort.

</PRE>The problem occurs when SQL Server is running as a service without the
"Allow Service to Interact with Desktop" check box enabled. If this is the
case, the warning dialog box described above goes to the virtual desktop,
so you never see it. Because you can't see it, you can never press OK to
continue, so it appears that the server has stopped responding.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To permanently resolve this problem, update your ODBC components so that
they all have the same file versions.
<P>
To temporarily work around this problem, do any one of the following:

<UL><LI>Enable trace flag 4022 (-T4022) in the startup parameters, to bypass the
   startup stored procedures.

<LI>Change the startup account to system account with the "Allow Service To
   Interact With Desktop" option enabled so that you can get the warning
   message and press OK to continue.

<LI>Start SQL Server from a command prompt with the -c option.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hang hung xproc sproc stproc autoexec startup<BR>
Keywords          : SSrvGen SSrvStProc kbenv kbinterop<BR>
Version           : WINNT:6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
