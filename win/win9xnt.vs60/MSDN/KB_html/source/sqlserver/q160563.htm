

<HTML>
<HEAD>
<TITLE>INF: Replication and Windows NT Server Network Configuration </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160563">
<META NAME="KBModify" CONTENT="1997/04/09">
<META NAME="KBCreate" CONTENT="1996/12/05">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork kbusage SSrvLan SSrvRep">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  As explained in the  Administrator's Companion,  replication can be set up between two computers running SQL Server, regardless of the Windows NT Server configuration. This article addresses different configurations with respect to Windows NT Serve...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QA9A,QDIK,QAA1,QABM,QDI2,QAJQ,QDIZ,QBW3,QAVZ,QATQ,QBG2,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Replication and Windows NT Server Network Configuration</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160563</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
As explained in the "Administrator's Companion," replication can be set up
between two computers running SQL Server, regardless of the Windows NT
Server configuration. This article addresses different configurations with
respect to Windows NT Server domains, and describes recommended
configurations.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article explains the different Windows NT Server dependencies with
respect to SQL Server replication, such as remote procedure calls (RPCs),
the SQL Executive Startup Account, Network Setup, and Windows NT Server
Domain Setup.
<P>
<P><h3>Replication and Remote Procedure Calls</h3>
 
<P>
SQL Server runs under Windows NT Server and makes use of RPCs to accomplish
replication-related tasks. Replication uses RPCs for both setup and
replicating transactions. Additionally, any server (publisher, distributor
or subscriber) can invoke the RPC to run on any other server. Because it
uses the Windows NT Server RPC mechanism, this functionality relies on
network name resolution for the successful execution of the RPC. For
network name resolution to succeed, the SQL Server name and Windows NT
Server name must match. In SQL Server 6.5, if the names are different, an
advanced configuration entry can be made for the RPCs to work. For more
information, see the "Replication and Invalid SQL Server Names" section of
"What's New in SQL Server 6.5."
<P>
<P><h3>Replication and the SQL Executive Account</h3>
 
<P>
Replication setup requires that the SQL Executive service be started under
an account other than "LocalSystemAccount." This account can be either a
local account on the computer running Windows NT Server, or a domain
account (if this server is a member of a Windows NT Server domain). If the
servers participating in replication are in different domains, domain trust
relationships should be established to start SQL Executive service on a
server that is a member of one domain under a user account from a different
domain.
<P>
If the account on the distributor that starts the SQL Executive service has
administrative privileges on the subscriber, the distribution process uses
a trusted connection (integrated security) to connect to the subscriber and
gets system administrator (SA) privileges on the subscriber. If a user
account from one domain must be given privileges on a server participating
in a different domain, then that domain must trust the domain on which the
user account exists.
<P>
If the account on the distributor that starts the SQL Executive service
does NOT have administrative privileges on the subscriber, the distribution
task uses a SQL Server logon called "repl_publisher" to connect to
subscriber. This account is aliased to the database owner (DBO) on the
subscribing database during replication setup. In order for this procedure
to work successfully, the servers must be able to see each other at the
network level.
<P>
<P><h3>Replication and Network Setup</h3>
 
<P>
Because SQL Server replication uses trusted connections, it requires a
secure Network Library such as named pipes or multi-protocol. Because
replication-related tasks run on the distribution server under the context
of the SQL Executive service, the default network in the Client
Configuration Utility on the server must be either named pipes or multi-
protocol.
<P>
<P><h3>Windows NT Server Setup</h3>
 
<P>
Computers running Windows NT Server that run SQL Server participating in
replication can be workgroup servers, members of a Windows NT Server domain
(either the same domain or different domains) or any combination. The
configuration of Windows NT Server dictates how network name resolution
will work. The following sections discuss the different requirements,
mechanisms, and problems related to setting up replication.
<P>
<P><h3>Workgroup Servers</h3>
 
<P>
I. Computers are in the same workgroup:
<P>
If the computers running Windows NT Server that run SQL Server
participating in replication belong to the same workgroup, replication can
be set up normally. Because the computers running Windows NT Server belong
to the same workgroup, the network name resolution happens through
broadcast, and is reliable (if done within the local subnet). If any
routers are involved, name resolution should be forced using either LMHosts
lookup or WINS. See the Windows NT Server documentation for details on
LMHosts or WINS setup, and determine the best approach.
<P>
II. Computers are in different workgroups:
<P>
If the computers running Windows NT Server belong to different workgroups,
they may not be aware of other servers at the network level. In such cases,
network name resolution should be forced, using either LMHosts lookup or
WINS.
<P>
<P><h3>Servers Participating in a Domain</h3>
 
<P>
I. Computers are in the same domain:
<P>
If both servers are members of the same domain, network name resolution is
guaranteed, and this takes care of the replication requirements of RPCs.
This configuration ensures that the publisher, distributor and subscriber
know the each other's network addresses, and ensures that any server can
invoke an RPC on any other server. Also, with this configuration, the
account under which SQL Executive is started on the distributor can easily
be given administrative privileges on all servers because it is a member of
the same domain. Therefore, the replication tasks will use integrated
security and get SA access to the publisher and subscriber.
<P>
II. Computers are members of different domains:
<P>
Bidirectional trust relationships are recommended if the servers
participating in replication belong to different domains. This ensures that
network name resolution will work. The following diagram illustrates a
bidirectional trust relationship:
<P>
<PRE>               trusts                      trusts
</PRE>Publisher  &lt;-------------&gt; Distributor &lt;------------&gt; Subscriber
<P>
If bidirectional trust relationships cannot be established, it is a good
idea to at least set up a one-way trust. The subscribing domain should
trust the distributing domain. If the publishing domain is different from
the distributor domain, the publisher domain should trust the distributor
domain. Most of the RPCs are initiated at the publisher or distributor.
Some are initiated at the subscriber and run at the distributor or
publisher server (hence the trust direction). The following diagram
illustrates the appropriate one-way trust relationship
<P>
<PRE>              trusts                      trusts
</PRE>Publisher  -------------&gt; Distributor &lt;------------ Subscriber
<P>
If no trusts can be established, replication can still be installed and
will work properly as long as network name resolution is assured. This can
be accomplished by using LMHosts lookup, DNS or WINS. For details on DNS or
WINS or LMHosts setup, see your Windows NT Server documentation.
<P>
<P><h3>Workgroup/Domain Combination</h3>
 
<P>
If one server is a workgroup server and another is a member of a domain,
force network name resolution using LMHosts lookup, WINS, or DNS (if the
publisher server is a member of a domain).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: repl netbios<BR>
Keywords            : kbinterop kbnetwork kbusage SSrvLan SSrvRep<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
