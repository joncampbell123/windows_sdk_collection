

<HTML>
<HEAD>
<TITLE>BUG: SQL Enterprise Manager May Show Incorrect Permissions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166203">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1997/04/01">
<META NAME="Keywords" CONTENT="kbbug6.00 kbbug6.50 kbusage SSrvEntMan">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 16745   The SQL Enterprise Manager (SEM) may display incorrect permissions if objects are created under the same name but by different owners. The following procedure demonstrates the problem:  1. Create user1, user2, and user3.  2. Grant the ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAGU,QBWG,QAN0,QAJQ,QA2Q,QAAP,QAY2,QAK7,QADK,QAG2,QAKP,QAW6,QAPN,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: SQL Enterprise Manager May Show Incorrect Permissions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166203</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
BUG #: 16745
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SQL Enterprise Manager (SEM) may display incorrect permissions if
objects are created under the same name but by different owners. The
following procedure demonstrates the problem:

<OL><P><LI>Create user1, user2, and user3.

<P><LI>Grant the appropriate permissions to these three users so that they can
   all select from authors.

<P><LI>Have user1 log on and create the following view:
<P><PRE>      CREATE VIEW view_authors_names
      AS
      SELECT au_fname, au_lname
      FROM authors
</PRE>
<P><LI>Have user2 log on and create the following view:
<P><PRE>      CREATE VIEW view_authors_names
      AS
      SELECT au_fname, au_lname
      FROM authors
</PRE>
<P><LI>Grant user3 both select permissions for user1.view_authors_names and
   user2.view_authors_names.

<P><LI>Go to SEM and select one of objects in view from the pubs database.

<P><LI>Right-click the mouse and look at the permission by user; you should see
   the incorrect permissions result.
<P>
</OL>You may observe similar incorrect behavior with different objects, such as
tables. For example, two tables created under the same name but different
users also have the incorrect permission problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, use Transact-SQL instead. The following sample
script illustrates how query permissions can be distinguished by a user's
logon:
<P>
<PRE>   USE databaseName
   GO

   SELECT object = (u.name + '.' + o.name),
          permission = spt.name
   FROM   sysprotects p,
          sysobjects o,
          sysusers u,
          master..spt_values spt
   WHERE  p.uid = user_id('user's login') AND
          p.id = o.id AND
          o.uid = u.uid AND
          spt.number = p.action AND
          spt.name &lt;&gt; NULL
   GO

</PRE></OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
versions 6.0 and 6.5. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbbug6.00 kbbug6.50 kbusage SSrvEntMan<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
