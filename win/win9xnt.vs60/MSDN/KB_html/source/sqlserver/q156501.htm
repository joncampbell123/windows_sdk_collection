

<HTML>
<HEAD>
<TITLE>INF: QUOTED_IDENTIFIER and Strings with Single Quotation Marks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156501">
<META NAME="KBModify" CONTENT="1997/10/09">
<META NAME="KBCreate" CONTENT="1996/09/24">
<META NAME="Keywords" CONTENT="SSrvGen kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  SQL Server 6.0 introduced support for the ANSI SQL rules regarding the use of single and double quotation marks. This article describes how to process single and double quotation marks in an ANSI environment.  MORE INFORMATION  Starting with SQL Se...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA50,QABM,QATX,QAHH,QA9E,QATZ,QATY,QAPF,QAN0,QAFO,QBSO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: QUOTED_IDENTIFIER and Strings with Single Quotation Marks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156501</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
<LI>Microsoft Open Database Connectivity driver, version 2.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SQL Server 6.0 introduced support for the ANSI SQL rules regarding the use
of single and double quotation marks. This article describes how to process
single and double quotation marks in an ANSI environment.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Starting with SQL Server 6.0, you can use SET QUOTED_IDENTIFIER ON to have
SQL Server start enforcing the ANSI SQL rules regarding quotation marks.
According to the ANSI rules, double quotation marks are reserved for
delimiting identifiers (such as database, table, or column names), while
single quotation marks are reserved for delimiting character strings being
used as data. For example, consider the following statement:
<P>
<PRE>   select * from "authors" where "au_lname" = 'White'

</PRE>With this option enabled, it is not legal to enclose the character string
<PRE>'White' in double quotation marks. ANSI SQL interprets "White" as an
</PRE>identifier, not a character string.
<P>
According to ANSI SQL, when a character string includes a single quotation
mark or an apostrophe, it should be represented by two single quotes, as in
the following example:
<P>
<PRE>   select * from authors where au_lname = 'O''Brien'

</PRE>This means that applications must parse character strings for single
quotation marks before building the strings into SQL commands, and add a
second single quotation mark.
<P>
ODBC can be used in a way that eliminates the need to first parse character
strings for single quotation marks. When an ODBC application uses
SQLBindParameter() to bind character program variables to parameter markers
in SQL commands, the character strings are not enclosed in either single or
double quotation marks. There is no need for the application to have to
parse the strings for single quotation marks. The following is an example:
<P>
<PRE>   UCHAR *szCol1[41]="";
   SDWORD pcbVal1 = SQL_NTS;

   SQLPrepare(hstmt,
          (UCHAR *)"select * from authors where au_lname = ?",
          SQL_NTS);
   SQLBindParameter(hstmt1,
                 1,
                 SQL_PARAM_INPUT,
                 SQL_C_CHAR,
                 SQL_CHAR,
                 40,
                 0,
                 szCol1,
                 sizeof(szCol1),
                 &amp;pcbVal1);
   strcpy(szCol1, "O'Brien");
   SQLExecute(hstmt1);

</PRE>Note that while the strcpy command contains the string "O'Brien," C only
puts the characters O'Brien in the variable szCol1. The double quotation
marks in this case are the string delimiters for C, and have nothing to do
with SQL.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: embedded<BR>
Keywords          : SSrvGen kbusage<BR>
Version           : 2.5 6.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
