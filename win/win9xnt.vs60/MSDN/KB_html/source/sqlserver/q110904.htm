

<HTML>
<HEAD>
<TITLE>INF: How to Set Up SQL Performance Monitor Database Alerts </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110904">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1994/02/01">
<META NAME="Keywords" CONTENT="kbother SSrvAdmin kbother kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  With SQL Server for Windows NT, the NT SQL System Administrator has the advantage of having the additional functionality provided by the Windows NT Performance Monitor. This additional functionality provides the ability to monitor various activitie...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABM,QBJZ,QAB4,QA2Q,QAY5,QAU3,QAMR,QBWS,QDIV,QAY2,QAA1,QBV4,QAG2,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Set Up SQL Performance Monitor Database Alerts</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110904</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With SQL Server for Windows NT, the NT SQL System Administrator has the
advantage of having the additional functionality provided by the Windows NT
Performance Monitor. This additional functionality provides the ability to
monitor various activities with NT SQL Server as it is performing its
tasks. One valuable function is the ability to "Alert" selected
clients/workstations that certain conditions on the NT SQL Server exist.
<P>
This article will illustrate how to setup the SQL Performance Monitor so
that a predefined Alert will automatically be loaded during startup after
an Administrator logs on to the Windows NT server. The Alert that will be
used in this example will be the PERCENT OF LOG SPACE USED for a selected
database. First some background information is needed in order to
understand how this will be done.
<P>
<P><h3>Background Information</h3>
 
<P>
There are two slightly different forms of Performance Monitor available
from the Windows NT Program Manager. The Windows NT Performance Monitor can
be found in the Administrative Tools Group, while the SQL Performance
Monitor exists in the SQL Server for Windows NT Group. The primary
difference between the two program items is that when the SQL Performance
Monitor starts up, a file called SQLCTRS.PMC, located in the C:\SQL\BINN
directory, is called and passed as a parameter to PERFMON.EXE (both program
items call PERFMON.EXE). SQLCTRS.PMC has the initial default SQL Server
Performance Monitor settings. A feature of PERFMON.EXE is that it allows
you to configure your view of the system and save this snapshot in a file
for later use.
<P>
The two configuration files that you can setup and save are the Alerts file
and the "Workspace" file. The Workspace file, which contains PERFMON chart
settings and alerts, is saved with a default extension of "PMW." The Alert
file containing the user configured alerts is saved with a default
extension of "PMA."
<P>
The example listed under the More Information section describes the
creation and use of a Workspace file that will be passed as a parameter to
PERFMON.EXE allowing it to automatically start with a user configured SQL
Server Database Log Alert.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following description will step you through the process of
creating the Workspace file to creating an icon in the Program
Manager Startup Group.
<P>
The first thing to do is to create a workspace file that has an
alert. (The following should be done as the System Administrator
or as a member of the Administrators group.)

<OL><P><LI>Start up the SQL Performance Monitor.

<P><LI>From the View menu select Alert or type CTRL+A.

<P><LI>From the Edit menu select Add to Alert... or type CTRL+I.

<P><LI>Enter the appropriate SQL NT Server for the computer.

<P><LI>From the Object drop down list box select SQLServer-log.

<P><LI>From the Counter list box select Logspace Used(%).

<P><LI>Go down to the Alert If frame box and select the radio button
    Over, and in the single line edit box enter 75.

<P><LI>Go to the Run Program on Alert frame. This is where you can
    enter the name of a *.cmd or *.bat file, or any other executable
    file that can be triggered when the alert activates. There is also
    the option of triggering your program once or more than once.
    Leave it blank. (See the Additional Information section.)

<P><LI>Select the database from the Instance list box.

<P><LI>Click on the Add button, the Cancel button will change to Done.

<P><LI>Click on the Done button.
<P>
    You will now notice that your new entry has been added to the
    under Alert legend in the Alert workspace.

<P><LI>Change to the Chart workspace by selecting the View menu and
    then Chart or using CTRL+C from the keyboard.

<P><LI>Go to the File menu and select Save Workspace or use CTRL+W.

<P><LI>You will be prompted for a file name with a .PMW extension.

<P><LI>Enter a valid filename and then click the OK button.

<P><LI>Exit from SQL Performance Monitor.
<P>
</OL>Now there is a workspace file in the directory you selected. The
next step is to create an icon and put it into the Startup Group.

<OL><P><LI>Open the Startup Group.

<P><LI>From the File menu in the Program Manager select New.

<P><LI>Select Program Item from the New frame box.

<P><LI>Select the OK button.

<P><LI>Enter a name for the Icon in the Description single line edit box.

<P><LI>Enter the following in the Command Line single line edit box:
<P>
<P><PRE>      perfmon.exe c:\path_to\your_fil.pmw
</PRE>
<P><LI>Click the OK button.
<P>
</OL>The new icon will exist in your Startup Group. Next you need to verify that
the icon works.

<OL><P><LI>Double-click on your icon and verify that the alert that you
   have setup exists in your new instance of Performance Monitor

<P><LI>Exit from the program.

<P><LI>Logout of Windows NT.

<P><LI>Log back in.
<P>
</OL>The new instance of the Performance Monitor should be up and running.
<P>
<P><h3>Additional Information</h3>
 
<P>
Another article <B><A href="../sqlserver/q110565.htm">Q110565</A></B>, titled "Automatic Transaction Log Dumping via
PERFMON" discusses exactly how to execute a batch script that will truncate
a user database log when a correctly configured alert fires.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.20 Windows NT<BR>
Keywords            : kbother SSrvAdmin kbother kbtshoot<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
