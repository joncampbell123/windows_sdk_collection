

<HTML>
<HEAD>
<TITLE>BUG: Load Master DB Can Fail After Master.Dat is Rebuilt </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146116">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1996/02/13">
<META NAME="Keywords" CONTENT="kbbug6.00 kbusage SSrvErr_Log">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# NT: 12391 (6.00)   When a database dump of master taken from the master database that was upgraded from version 4.21a to 6.0 (with a size of 23 MB) and subsequently loaded into a master from a rebuilt MASTER.DAT (with a size of 25 MB), SQL Serve...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAOE,QAMA,QDNF,QAZV,QAI4,QDIV,QAKP,QBPM,QANY,QAA1,QAWP,QAY2,QAV1,QAV0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Load Master DB Can Fail After Master.Dat is Rebuilt</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146116</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21a and 6.0
</UL> 
BUG# NT: 12391 (6.00)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a database dump of master taken from the master database that was
upgraded from version 4.21a to 6.0 (with a size of 23 MB) and subsequently
loaded into a master from a rebuilt MASTER.DAT (with a size of 25 MB), SQL
Server will fail to start and the following (or similar entries) will be
present in the errorlog:
<P>
<PRE>95/12/03 18:47:43.94 kernel   Microsoft SQL Server 6.0 - 6.00.121 (Intel
X86)
        Jun 13 1995 11:32:40
        Copyright (c) 1988-1995 Microsoft Corporation

95/12/03 18:47:43.94 kernel   Copyright (C) 1988-1994 Microsoft
</PRE>Corporation.
<PRE>95/12/03 18:47:43.94 kernel   All rights reserved.
95/12/03 18:47:43.95 kernel   Logging SQL Server messages in file
'D:\SQL\LOG\ERRORLOG'
95/12/03 18:47:43.96 kernel   initconfig: number of user connections
</PRE>limited to 20
<PRE>95/12/03 18:47:43.96 kernel   SQL Server is starting at priority class
'normal' with dataserver serialization turned on.

95/12/03 18:47:44.04 kernel   initializing virtual device 0,
</PRE>D:\SQL\DATA\MASTER.DAT
<PRE>95/12/03 18:47:44.05 kernel   Opening Master Database ...
95/12/03 18:47:44.17 spid1    Loading SQL Server's  default sort order and
</PRE>character set
<PRE>95/12/03 18:47:44.18 spid1    Getpage: bstat=0x1008/0, sstat=0, copy=0
95/12/03 18:47:44.18 spid1      pageno is/should be:    objid is/should be:
95/12/03 18:47:44.19 spid1      0x205(517)              0x3(3)
95/12/03 18:47:44.19 spid1      0x205(517)              0x2d(45)
95/12/03 18:47:44.19 spid1    ... extent objid 0x3, mask 0xff/0,
</PRE>next/prev=0x370/0x298
<P>
<P><h2>CAUSE</h2>
 
<P>
A MASTER.DAT that is created under version 4.21a with the default size of
15 MB and is subsequently upgraded to version 6.0 will have a final size of
23 MB. A new installation of SQL Server 6.0 will generate a MASTER.DAT with
a size of 25 MB. During a situation where the MASTER.DAT must be rebuilt,
SQL Setup is used and the resulting file size for MASTER.DAT is 25 MB. It
is not possible to create a MASTER.DAT that is less than 25 MB.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The only options once the MASTER.DAT is lost are to perform either of the
following procedures:
<P>
a. Use a rebuilt MASTER.DAT. This will mean that the current database
<PRE>   device files must be reestablished in the master database by using Disk
   Reinit and Disk Refit commands. The user login accounts will have to be
   recreated as well.

</PRE>b. The other alternative is to create a SQL Server 4.21a MASTER.DAT with
<PRE>   the correct size, then upgrade this MASTER.DAT to SQL Server 6.0. Once
   this is accomplished, follow the steps in the "Administrator's
   Companion" listed for loading a master database dump.

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.0. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 dump database master<BR>
Keywords            : kbbug6.00 kbusage SSrvErr_Log<BR>
Version             : 4.21a 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
