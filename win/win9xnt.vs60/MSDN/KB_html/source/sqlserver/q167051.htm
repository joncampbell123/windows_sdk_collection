

<HTML>
<HEAD>
<TITLE>PRB: Problems When DBCS Code Page Is Missing in Windows NT </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167051">
<META NAME="KBModify" CONTENT="1997/04/16">
<META NAME="KBCreate" CONTENT="1997/04/16">
<META NAME="Keywords" CONTENT="kbenv kbinterop SSrvGen SSrvInst">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  If SQL Server was installed with a double-byte character set (DBCS) code page (such as cp-932, cp-936, cp-949, or cp-950) and you used a dictionary order case-insensitive sort order, you may experience either of the following problems when running ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWP,QBWP,QDIK,QAH4,QABM,QDL9,QBWQ,QBWO,QBWN,QBWS,QBJZ,QAUJ,QAKD,QAIJ,QAAQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Problems When DBCS Code Page Is Missing in Windows NT</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167051</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If SQL Server was installed with a double-byte character set (DBCS) code
page (such as cp-932, cp-936, cp-949, or cp-950) and you used a dictionary
order case-insensitive sort order, you may experience either of the
following problems when running "use PUBS" or other case-sensitive
operations:

<UL><LI>Msg 911, Level 16, State 2
   Attempt to locate entry in Sysdatabases for database 'PUBS' by name
   failed - no entry found under that name. Make sure that name is entered
   properly.
<P>
   -or-

<LI>An "Unknown Character Set" error when running "sp_helpsort."
<P>
</UL><h2>CAUSE</h2>
 
<P>
This problem occurs when the specific DBCS code page is not installed on
the computer running Windows NT Server.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
There are two possible workarounds for this problem.
<P>
Method One: If you are using Windows NT Server 3.51 or Windows NT
Server 4.0, you can add the code page manually.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Log on to Windows NT Server to an account with Administrator privilege.

<P><LI>Copy the code page file to the %SystemRoot%\System32 directory.

<P><LI>Start the Registry Editor (Regedt32.exe) and locate the following
   HKEY_LOCAL_MACHINE subtree:
<P>
<P><PRE>      System\CurrentControlSet\Control\Nls\CodePage
</PRE>
<P><LI>On the Edit menu, click Add Value.

<P><LI>Enter the following values:
<P>
<P><PRE>      Value Name: &lt;code page number&gt; (for example, 950)
      Data Type: REG_SZ
      String: &lt;code page file name&gt; (for example, C_950.NLS)
</PRE>
<P><LI>Locate the following HKEY_LOCAL_MACHINE subtree:
<P>
<P><PRE>      System\CurrentControlSet\Control\Nls\Language
</PRE>
<P><LI>On the Edit menu, click Add Value.

<P><LI>Enter the following values:
<P>
<P><PRE>      Value Name: &lt;locale-specific code page ID&gt; (for example, 0404 for
      code page 950; see the MORE INFORMATION section of this article)
      Data Type: REG_SZ
      String: l_intl.nls
</PRE>
<P><LI>Quit Registry Editor.

<P><LI>Shut down and restart the computer running Windows NT Server.

<P><LI>Rebuild the SQL Server master database with the desired DBCS code page.
<P>
</OL>Method Two: If you are using Windows NT Server 4.0, you can add a code page
by using an .inf script.

<OL><P><LI>Log on to Windows NT Server to an account with Administrator privilege.

<P><LI>Start the Windows NT Explorer.

<P><LI>Insert the Windows NT Server 4.0 compact disc.

<P><LI>In the Langpack directory, locate the .inf file named appropriately for
   the language.

<P><LI>Right-click the .inf file that you want to add support for.

<P><LI>Click Install on the context menu.

<P><LI>Shut down and restart the computer running Windows NT Server when it has
   completed adding the language.

<P><LI>Rebuild the SQL Server master database with the desired DBCS code page.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The following is the locale-specific code page information that is required
in method one above:
<P>
<PRE>Locale                   LCID    Code Page
</PRE></OL> 
<P>
<PRE>Chinese (PRC)           0x0804     936
Chinese (Taiwan)        0x0404     950
Chinese (Hong Kong)     0x0c04     950
Chinese (Singapore)     0x1004     936
Japanese                0x0411     932
Korean                  0x0412     949
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: JIS Wansung Johab Hangul KB BIG-5<BR>
Keywords            : kbenv kbinterop SSrvGen SSrvInst<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
