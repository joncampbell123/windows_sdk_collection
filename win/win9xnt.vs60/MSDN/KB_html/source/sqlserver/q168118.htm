

<HTML>
<HEAD>
<TITLE>INF: Using SQL Server Web Assistant's "When Data Changes" Option </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q168118">
<META NAME="KBModify" CONTENT="1997/05/15">
<META NAME="KBCreate" CONTENT="1997/05/07">
<META NAME="Keywords" CONTENT="kbcode kbusage SSrvStProc SSrvWeb">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article describes how the SQL Server Web Assistant handles HTML page generation using the  When Data Changes  scheduling option.  MORE INFORMATION  With the SQL Server Web Assistant, you can generate an HTML file whenever the data changes for ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATP,QABM,QAVZ,QA9N,QAXB,QACI,QA2Q,QAKE,QAGC,QAGB,QAYY,QAW6,QAPN,QAN0 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using SQL Server Web Assistant's "When Data Changes" Option</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q168118</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how the SQL Server Web Assistant handles HTML page
generation using the "When Data Changes" scheduling option.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
With the SQL Server Web Assistant, you can generate an HTML file whenever
the data changes for one or more tables, by using the Scheduling screen and
selecting the "When Data Changes" option. This is accomplished by building
an INSERT, UPDATE, and DELETE trigger for each of the tables selected by
the user. Any existing triggers will be automatically detected by the Web
Assistant and retained.
<P>
A "Trigger Found" dialog box will be raised for each of the existing
triggers for all of the tables referenced in the Scheduling screen. The
user has the option of editing the trigger code and clicking OK to accept
the proposed changes, or clicking Cancel to leave the trigger intact.
<P>
The trigger object built by the SQL Web Assistant will have a name
generated according to the following:
<P>
<PRE>   Web_tableObjectId_1 -&gt; INSERT trigger
   Web_tableObjectId_2 -&gt; UPDATE trigger
   Web_tableObjectId_3 -&gt; DELETE trigger

</PRE>For example, if the "authors" table from the pubs database is selected as
one of the tables to be considered when the data changes, the three
triggers generated by the Web assistant will be: Web_16003088_1,
Web_16003088_2 and Web_16003088_3 for the INSERT, UPDATE, and DELETE
respectively (where 16003088 is the object ID corresponding to the authors
table in the pubs database).
<P>
Please note that "sp_depends" does not enlist any of the Web Assistant
generated triggers for a given table. You may want to create an enhanced
version of "sp_depends" to enlist the Web Assistant generated triggers as
discussed in the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q167135.htm">Q167135</A></B>
   TITLE     : A Stored Procedure to Display Trigger Information

</PRE>Use the following steps to drop any of the triggers generated by the Web
Assistant:

<OL><P><LI>Identify the object ID for the table in question:
<P>
<P><PRE>      select tabObjId=object_id('tabName')
</PRE><P>
   You can also use the sp_helptriggers stored procedure, as discussed in
   article <B><A href="../sqlserver/q167135.htm">Q167135</A></B>, mentioned above.

<P><LI>List all the triggers for this table object:
<P>
<P><PRE>      select * from sysobjects where name like 'Web_tabObjId%'
</PRE>
<P><LI>Run the Drop Trigger command for each of the triggers you want to drop:
<P>
<P><PRE>      drop trigger &lt;Webtriggername&gt;
 </BLOCKQUOTE>


	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbcode kbusage SSrvStProc SSrvWeb<BR>
Version             : 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
