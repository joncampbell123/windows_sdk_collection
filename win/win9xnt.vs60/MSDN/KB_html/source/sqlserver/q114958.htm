

<HTML>
<HEAD>
<TITLE>INF: Improper Usage of dbclose() Can Cause Disconnect Message </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114958">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/05/17">
<META NAME="Keywords" CONTENT="kbprg SSrvDB_Lib">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Improper usage of the dbclose() function in a DB-Library (DB-Lib) program can result in several disconnection messages written to the error log and event viewer (SQL Server for Windows NT only). If a DB-Library program calls dbclose() before proces...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB4,QAAP,QBWP,QAGI,QAEV,QDMH,QA8O,QA6V,QAYC,QAPN,QAO4,QAL3,QAI5,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Improper Usage of dbclose() Can Cause Disconnect Message</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114958</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server Programmer's Toolkit, version 4.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Improper usage of the dbclose() function in a DB-Library (DB-Lib) program
can result in several disconnection messages written to the error log and
event viewer (SQL Server for Windows NT only). If a DB-Library program
calls dbclose() before processing of results is complete, messages 17824,
232, and 109 will appear in the SQL Server for Windows NT error log and
event viewer.
<P>
When clients are connected to an OS/2 server, the error log simply contains
the message:
<P>
<PRE>   Cannot send, host process disconnected.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When dbclose() is called after dbsqlexec() and before dbresults() or before
all processing is complete using dbresults(), the following error is logged
in the NT event viewer as eventID 17058 (the error will also appear in the
SQL Server error log):
<P>
<PRE>   Error: 17824, Severity 10, State 0
   Unable to write to ListenOn connection
   "\\.\pipe\sql\query',loginame 'sa',hostname''.
   OS Error: 232, The pipe is being closed

</PRE>If the client is connected to an OS/2 server, the error log will
contain the following entry:
<P>
<PRE>   kernel Cannot send, host process disconnected: &lt;a negative integer&gt;
</PRE>spid:
1
<P>
A properly developed DB-Library program should call dbcancel() before
dbclose() if results do not need to be processed. Note that this
behavior will appear when using DB-Library versions 4.21 or 4.20.50.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dbclose client 17824 232 109 dblib<BR>
Keywords            : kbprg SSrvDB_Lib<BR>
Version             : 4.2.5 4.21 | 4.2.5<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
