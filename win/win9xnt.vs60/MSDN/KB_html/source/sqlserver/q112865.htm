

<HTML>
<HEAD>
<TITLE>BUG: OBJECT2.SQL May Fail to Execute the Last Statement </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q112865">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/03/22">
<META NAME="Keywords" CONTENT="kbbug4.20 kbprg SSrvSQL_Admin">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# 9906 (4.2)   The OBJECT2.SQL script for SQL Object Manager may fail to execute the last statement if one of the stored procedures is not created  WORKAROUND  Identify the problem that causes the stored procedure creation to fail, correct the pro...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QAML,QAB9,QAPN,QABM,QAB4,QAKP,QBVV,QAGU,QDNQ,QA0K,QAA1,QAFY,QBWG,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: OBJECT2.SQL May Fail to Execute the Last Statement</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q112865</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server Programmer's Toolkit, version 4.2
</PRE> 
BUG# 9906 (4.2)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The OBJECT2.SQL script for SQL Object Manager may fail to execute the last
statement if one of the stored procedures is not created
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Identify the problem that causes the stored procedure creation to fail,
correct the problem, and re-run OBJECT2.SQL if possible.
<P>
For example, the current SQL Transfer Manager requires OBJECT2.SQL to be
installed on the source server if the user does not have CREATE PROCEDURE
permission. However, since there are no reserved, used, rows columns in
sysindexes on Sybase version 4.8 or later, one of the stored procedures
sp_MStable_properties which refers to these columns will always fail.
<P>
Running OBJECT2.SQL on Sybase will not print the error message indicating
that it has failed. To workaround this particular problem, grant the user
Create Procedure permission or explicitly grant execute permission to the
stored procedures that have been created successfully
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Object Manager version
4.2 for Windows NT and Windows. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The last statement in OBJECT2.SQL checks to see if  all the stored
procedures are created. If not, it will print out an error message and drop
sp_MSOM_version; otherwise, it will grant the execution permissions on
these stored procedures to public and print out a message indicating the
script has been successfully installed.
<P>
The last statement is as follows:
<P>
<PRE>   if exists (select * from #spmissing)
   begin
      print ""
      print ""
      print " =====================  ERRORS!  ===================="
      print "       The following objects were not created."
      print " Sql Object Manager will not run against this server."
      print ""
      select * from #spmissing
      drop procedure sp_MSOM_version
   end
   else
   begin
      print ""
      print "Granting execute permissions on procedures"
      grant execute on sp_MScheck_OM to public
      grant execute on sp_MSuser_info to public
      grant execute on sp_MStable_properties to public
      grant execute on sp_MScolumn_properties to public
      grant execute on sp_MSobject_list to public
      grant execute on sp_MSobjecttype_name to public
      grant execute on sp_MStable_permissions to public
      grant execute on sp_MSobject_dependencies to public
      grant execute on sp_MSOM_version to public
      print ""
      print ""
      print " Successful installation."
      exec sp_MSOM_version
   end
   go

</PRE>However, when there is one stored procedure missing, the whole IF...ELSE
statement will fail with a syntax error, thus neither of the parts get
executed. The user will not receive any message indicating that the
installation of the script has failed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbbug4.20 kbprg SSrvSQL_Admin<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
