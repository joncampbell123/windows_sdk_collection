

<HTML>
<HEAD>
<TITLE>INF: How to Benefit From Autoexec Stored Procedures </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151366">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1996/05/21">
<META NAME="Keywords" CONTENT="kbusage SSrvStProc SSrvTran_SQL">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article explains how to benefit from auto executing stored procedures to perform certain system administration tasks.  MORE INFORMATION  In versions 6.0 and 6.5, you can have one or more stored procedures execute automatically when SQL Server ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAXB,QAB9,QA28,QATJ,QDIV,QAC1,QBD2,QAY2,QASS,QAIJ,QAD2,QAYY,QAZV,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Benefit From Autoexec Stored Procedures</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151366</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article explains how to benefit from auto executing stored procedures
to perform certain system administration tasks.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In versions 6.0 and 6.5, you can have one or more stored procedures execute
automatically when SQL Server starts. The stored procedures must be created
by the system administrator (SA) and will execute under the SA account as a
background process.
<P>
During start-up, SQL Server checks for stored procedures in the master
database that have been marked for start-up, launches the exception handler
to handle any exception raised during the execution of the stored
procedures and then writes an entry into the SQL Server errorlog. Execution
of the stored procedures starts when the last database has been recovered
at startup.
<P>
The following are some system administration tasks that can benefit from
this feature:

<OL><P><LI>Correct the page count discrepancy in the SYSLOGS table.
<P>
   See the following Knowledge Base article for more information:
<P><PRE>      <B><A href="../sqlserver/q39113.htm">Q39113</A></B>, PRB: DBCC Reports Page Count Discrepancy on SYSLOGS Table
</PRE>
<P><LI>Update the statistics on the distribution of the key values in the
   indexes.
<P>
   This can be done with the UPDATE STATISTICS statement which creates or
   updates information about the distribution of the key values in the
   indexes. This helps SQL Server determine which indexes to use when
   processing a query. You should use this statement when a large amount of
   data in an indexed column has been added, changed, or deleted. Please
   refer to Update Statistics command in the "Transact-SQL Reference"
   manual for additional information.
<P>
</OL>Also refer to the "Transact-SQL Reference" manual for information on how to
create, delete, gather information, and disable auto execution stored
procedures.
<P>
SQL Server 6.5 users can use the Database Maintenance Plan Wizard to
perform the above mentioned system administration tasks.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sp_unmakestartup sp_makestartup sp_helpstartup<BR>
Keywords            : kbusage SSrvStProc SSrvTran_SQL<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
