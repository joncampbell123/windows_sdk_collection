

<HTML>
<HEAD>
<TITLE>INF: ODBC SQL Server Driver Network Messages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137634">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1995/11/07">
<META NAME="Keywords" CONTENT="kbother SSrvErr_Log SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article discusses the meaning of the various pieces of information returned to SQLError if the Microsoft ODBC SQL Server driver encounters a network error when communicating with SQL Server, and how this information can offer insight into the ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAH4,QAVZ,QAUD,QAAP,QAB4,QAU9,QA9E,QDIT,QAY2,QAGI,QAY5,QALW,QAKP,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: ODBC SQL Server Driver Network Messages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137634</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses the meaning of the various pieces of information
returned to SQLError if the Microsoft ODBC SQL Server driver encounters a
network error when communicating with SQL Server, and how this information
can offer insight into the cause of the problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the Microsoft ODBC SQL Server driver encounters a network problem when
communicating with SQL Server, it will return SQL_ERROR to the ODBC
function call. If the application then calls SQLError, the driver will
return information similar to the following:
<P>
<PRE>   szSqlState = "01000"
   pfNativeError = 2
   szErrorMsg = "[Microsoft][ODBC SQL Server Driver][dbnmpntw]
                ConnectionOpen (CreateFile())"

</PRE>The pfNative code and szErrorMsg string contain information that can
give you clues about the nature of the underlying network problem.
<P>
The szErrorMsg string breaks down as follows:
<P>
<PRE>   "[Microsoft][ODBC SQL Server Driver]"
      This is the standard header for szErrorMsg strings coming from the
      Microsoft SQL Server driver, it indicates the error was detected in
      the driver itself.

   "[dbnmpntw]"
      This is the name of the Microsoft Network library, and
      will be one of the following:

         dbnmpntw - Win32 Named Pipes
         dbmssocn - Win32 Winsock TCP/IP
         dbmsspxn - Win32 SPX/IPX
         dbmsvinn - Win32 Banyan Vines
         dbmsrpcn - Win32 Multi-Protocol (Windows RPC)
         dbnmp3   - Win16 Named Pipes
         dbmssoc3 - Win16 Winsock TCP/IP
         dbmsspx3 - Win16 SPX/IPX
         dbmsvin3 - Win16 Banyan Vines
         dbmsrpc3 - Win16 Multi-Protocol (Windows RPC)

   "ConnectionOpen"
      A network library internal function name. The network
      library takes generic requests for network services from
      the Microsoft ODBC SQL Server driver and maps it down to
      a particular network protocol API call (or calls).

   "(CreateFile())"
      The function in the network API that returned the error.
      These functions are documented in the programmer's
      references for the underlying network.

</PRE>The most important part of the szErrorMsg is the name of the network
library. This indicates what network protocol is being used, and
therefore how the network error code should be interpreted.
<P>
The Microsoft SQL Server driver returns the error code it received from the
underlying network in the pfNative parameter. Users can look up the error
codes for the network protocol to see what type of error is indicated by
the pfNative value. The network protocol error codes are documented in
different places:
<P>
<PRE>   dbnmpntw, dbnmp3
   ----------------

      The codes returned from the named pipe API are consistent across
      Windows, Windows NT, and OS/2. They are codes listed in the
      Operating System Error Codes in Microsoft Knowledge Base Article
      <B><A href="../sqlserver/q116401.htm">Q116401</A></B>.

   dbmssocn, dbmssoc3
   ------------------

      The codes returned by the Winsock API are listed in Appendix
      A, Error Codes, of the Windows Sockets Specification 1.1.
      The Windows Sockets Specification can be found on the
      MSDN CD.

   dbmsspxn, dbmsspx3
   ------------------

      The codes returned from Novell can be found in the Novell
      NetWare Client Protocol Transport API for C under the
      section for the API function listed in the szErrorMsg.
      For example, if the pfNative is 253, and szErrorMsg lists
      SPXListenForSequencedPacket as the function, the reference
      manual states a 0xFD (253) return is a 'Packet Overflow.'

   dbmsvinn, dbmsvin3
   ------------------

      The codes returned from Banyan Vines are listed in Appendix
      A of the Vines Client Developers Guide.

   dbmsrpcn, dbmsrpc3
   ------------------

      The codes returned by the RPC API are listed in the RPC
      section of WINERROR.H.

</PRE>To assist you in deciphering the messages returned, the following examples
explain how to interpret the information returned on SQLError() if you
attempt to connect with some of the network libraries to a SQL Server that
is shut down:
<P>
dbnmpntw:
<P>
<PRE>   szSqlState = "01000"
   pfNativeError = 2
   szErrorMsg = "[Microsoft][ODBC SQL Server Driver][dbnmpntw]
                ConnectionOpen (CreateFile())"

   This indicates that the network error was received from the named pipe
   API function CreateFile. If you reference Knowledge Base article
   <B><A href="../sqlserver/q116401.htm">Q116401</A></B>, you will see that this indicates the pfNative value of 2 is a
   'File not found' error.

</PRE>dbmsrpcn:
<P>
<PRE>   szSqlState = "01000"
   pfNativeError = 1753
   szErrorMsg = "[Microsoft][ODBC SQL Server Driver][dbmsrpcn]
                ConnectionOpen (RpcEpResolveBinding())"

   This indicates that the network error was received from the RPC API
   function RpcEpResolveBinding. If you reference WINERROR.H, you will see
   that this indicates the pfNative value of 1753 is an
   EPT_S_NOT_REGISTERED, or an 'Endpoint not registered' error.

</PRE>dbmssocn:
<P>
<PRE>   szSqlState = "01000"
   pfNativeError = 10061
   szErrorMsg = "[Microsoft][ODBC SQL Server Driver][dbmssocn]
                ConnectionOpen (connect())"

   This indicates that the network error was received from
   the Winsock API function connect. If you reference the Windows Socket
   Specification, you will see that this indicates the pfNative value of
   10061 is an WSAECONNREFUSED, or a 'Connection Refused' error.

</PRE>As you can see from these examples, the error codes returned are not
always clear pointers to the underlying problems, but in many cases
they are enough to give a network administrator or support engineer some
clues as to what may be wrong.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 2.5  sql6 windows nt<BR>
Keywords            : kbother SSrvErr_Log SSrvProg<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
