

<HTML>
<HEAD>
<TITLE>BUG: bcp_init() Fails if DBBUFFER Is Set Too Low </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113081">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/03/24">
<META NAME="Keywords" CONTENT="kbbug4.20 kbtool SSrvBCP SSrvDB_Lib SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# 9920 (4.2)   A call to the DB-Library (DB-Lib) function bcp_init() fails with no error messages generated.  CAUSE =====  Bcp_init will fail to process correctly if the DBBUFFER value, set by calling dbsetopt(), was set to a value equal to or les...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QANY,QBXS,QAKD,QAKP,QABM,QAGI,QAKC,QA4Q,QALZ,QAB4,QAJ6,QBVV,QBC6,QAVX,QAVW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: bcp_init() Fails if DBBUFFER Is Set Too Low</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113081</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server Programmer's Toolkit, version 4.2
</UL> 
BUG# 9920 (4.2)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A call to the DB-Library (DB-Lib) function bcp_init() fails with no error
messages generated.
<P>
<P><h2>CAUSE</h2>
 
<P>
Bcp_init will fail to process correctly if the DBBUFFER value,
set by calling dbsetopt(), was set to a value equal to or less
than the number of columns in the table that bcp_init is
referencing.
<P>
For example, assume you have a table defined as:
<P>
<PRE>   CREATE TABLE test (col1 int, col2 int, col3 int)

</PRE>bcp_init() will fail if the following call to dbsetopt() was
made in the application:
<P>
<PRE>   dbsetopt (dbproc, DBBUFFER, "3");

</PRE><h2>WORKAROUND</h2>
 
<P>
This problem can be avoided by either increasing the DBBUFFER
value to a value greater than the number of columns, using the
example above setting the value to 4 would resolve the
problem:
<P>
<PRE>   dbsetopt (dbproc, DBBUFFER, "4");

</PRE>Another option is to simply not set the DBBUFFER value as it
is not used in DB-Library applications that are writing to
the BCP API.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in DB-Library version 4.20.00.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: bulk-copy dblib<BR>
Keywords            : kbbug4.20 kbtool SSrvBCP SSrvDB_Lib SSrvProg<BR>
Version             : 4.2 | 4.2<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
