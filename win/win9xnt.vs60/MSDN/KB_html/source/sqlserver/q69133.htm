

<HTML>
<HEAD>
<TITLE>INF: Converting SQL CHAR Values into DATETIME Values </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q69133 ">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1991/02/07">
<META NAME="Keywords" CONTENT="kbprg SSrvTran_SQL SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The following information discusses how to convert CHAR values into DATETIME values so that a SMALLINT value can be subtracted and a START_TIME value can be obtained.  MORE INFORMATION  To begin with, the character date and time must be converted i...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAKD,QACE,QAY4,QAUI,QAKC,QDNG,QAU3,QAMR,QAFH,QAB9,QDMW,QA2Q,QAUJ,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Converting SQL CHAR Values into DATETIME Values</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q69133 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
  - Microsoft SQL Server version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following information discusses how to convert CHAR values into
DATETIME values so that a SMALLINT value can be subtracted and a
START_TIME value can be obtained.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To begin with, the character date and time must be converted into the
SQL Server datetime format. Then the SMALLINT value can be subtracted
to obtain START_TIME. Both tasks can be performed in a single SQL
expression; however, it is easier to understand the process if both
tasks are considered separately.
<P>
For example, if the time value is stored in a column named "term_time"
with a format of HHMMSS, and the date value is stored in a column
named "term_date" with a format of YYMMDD, these values can be
converted to the SQL Server datetime with the following call:
<P>
<PRE>   convert(datetime,term_date+" "+
             substring(term_time,1,2)+":"+
          substring(term_time,3,2)+":"+
          substring(term_time,5,2)   )

</PRE>Given a date in SQL Server datetime format, it is easy to add or
subtract a given amount of seconds, minutes, days, and so forth. For
example, assuming the SMALLINT value ("@delta") is in seconds, the
following function will return the start date/time:
<P>
<PRE>   dateadd(ss,-(@delta),???)

</PRE>The entire expression can be put into the following select statement
so it is executed for each row in the input table. "@delta" is assumed
to be an input parameter. If "@delta" is in units other than seconds,
the first parameter of dateadd must be changed to reflect the correct
units (minutes, days, and so forth).
<P>
<PRE>   select  dateadd( ss, -(@delta), convert(datetime,term_date+" "+
               substring(term_time,1,2)+":"+
               substring(term_time,3,2)+":"+
               substring(term_time,5,2)   )
     from t1
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Transact-SQL Windows NT<BR>
Keywords            : kbprg SSrvTran_SQL SSrvWinNT<BR>
Version             : 4.20 | 4.20<BR>
Platform            : OS/2 Windows<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
