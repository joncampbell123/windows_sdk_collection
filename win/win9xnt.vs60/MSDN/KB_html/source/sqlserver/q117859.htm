

<HTML>
<HEAD>
<TITLE>INF: Handling sp_server_info Language Events in ODS Apps </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117859">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/07/11">
<META NAME="Keywords" CONTENT="kbinterop kbtool SSrvGen SSrvODS">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Microsoft SQL Server DB-Library (DB-Lib) clients use ANSI-to-OEM conversion if the DB-Library option DBANSItoOEM is set using dbsetopt() or if the  Automatic Ansi to OEM  option is set using the Client Configuration Utility. When connecting, a DB-L...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QAWP,QAGI,QBWI,QARL,QATZ,QATY,QAPN,QAO4,QBXS,QDJS,QDIZ,QBVX,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Handling sp_server_info Language Events in ODS Apps</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117859</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 4.2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft SQL Server DB-Library (DB-Lib) clients use ANSI-to-OEM conversion
if the DB-Library option DBANSItoOEM is set using dbsetopt() or if the
"Automatic Ansi to OEM" option is set using the Client Configuration
Utility. When connecting, a DB-Library client using ANSI-to-OEM conversion
determines which character set is in use at the server by issuing the query
"exec sp_server_info 18" against the server.
<P>
SQL Server for Windows NT uses DB-Library to issue RPC requests to remote
servers. Thus, if the "Automatic Ansi to OEM" option is set on the computer
running SQL Server for Windows NT, the SQL Server (as the DB-Library
client) issues the "exec sp_server_info 18" language request when issuing
an RPC to a remote server. This can cause unexpected language events to be
triggered in Open Data Services (ODS) servers accepting RPC requests from
NT SQL Servers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the ODS server is configured to accept language events, the "exec
sp_server_info 18" language request can be safely ignored by using the
following code fragment:
<P>
<PRE>   #define SERVER_INFO_QUERY   "exec sp_server_info 18"
   query = srv_langptr(srvproc);

   if (!strncmp(query, SERVER_INFO_QUERY, strlen(SERVER_INFO_QUERY)))

           srv_senddone(srvproc, SRV_DONE_FINAL, 0, 0);
   }

</PRE>This causes the DB-Library client to perform data conversions under the
assumption that the ODS server is NOT using the ANSI codepage.
<P>
In order to keep this query from being sent by SQL Server for Windows NT
and other Windows NT DB-Library applications, start the SQL Client
Configuration Utility and ensure that the "Automatic Ansi to OEM" checkbox
is cleared.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Windows NT oemtoansi ansitooem<BR>
Keywords            : kbinterop kbtool SSrvGen SSrvODS<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
