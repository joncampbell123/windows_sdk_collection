

<HTML>
<HEAD>
<TITLE>FIX: Taking tempdb Out of RAM Can Cause Error 1808 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q108664">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1993/12/15">
<META NAME="Keywords" CONTENT="kbbug4.20 kbfix6.00 kbother SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# NT: 583 (4.2)   Taking tempdb out of RAM when no default device exists causes attempts to start SQL Server to fail with an error 1808.  When tempdb is taken out of RAM, page 91 of the SQL Server for Windows NT  Configuration Guide  says a 2-MB t...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB5,QAMA,QABA,QAS1,QAOE,QAEF,QAIJ,QBW5,QA5E,QAR4,QAKP,QAAP,QBW6,QDKA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Taking tempdb Out of RAM Can Cause Error 1808</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q108664</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 4.2
</UL> 
BUG# NT: 583 (4.2)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Taking tempdb out of RAM when no default device exists causes attempts
to start SQL Server to fail with an error 1808.
<P>
When tempdb is taken out of RAM, page 91 of the SQL Server for Windows NT
"Configuration Guide" says a 2-MB tempdb is placed on the master device.
SQL Server actually places the 2-MB tempdb onto a default device, so page
91 is true only if the master device is also a default device.
<P>
After installation, master is the only default device. However, you can
change this by using sp_diskdefault. If the sa issues:
<P>
<PRE>   sp_diskdefault master,defaultoff
   go
   sp_diskdefault other_dev,defaulton
   go

</PRE>then the master database is no longer a default device. If the sa takes
tempdb out of RAM, the 2-MB tempdb is not be placed on the master device,
but is placed on other_dev, provided other_dev has 2 MB of free space
available.
<P>
If the sa removes all default devices in a system where tempdb is in RAM,
and then issues:
<P>
<PRE>   sp_configure 'tempdb in ram',0
   go
   reconfigure
   go

</PRE>Any subsequent attempt to start SQL Server fails with error 1808:
<P>
<PRE>   Crdb_disk : default disk not found. Cannot complete
   create/alter database command
   Problem creating Temporary Database - if out of space,
   please extend and reboot. If some other problem, please
   contact Technical Support. Failed to create temp db

</PRE><h2>WORKAROUND</h2>
 
<P>
Restart SQL Server in recover master only mode and add a default device.
You should backup your system up prior to attempting this procedure.
<P>
Restart SQL Server from the command line as follows:
<P>
<PRE>   sqlservr -dc:\sql\data\master.dat -ec:\sql\log\fix1808.log -T3608

</PRE>After SQL Server initializes, either make a device known to contain at
least 2 MB of free space on a default device:
<P>
<PRE>   sp_diskdefault master, defaulton
   go
   shutdown
   go

</PRE>Or, add a new device with at least 2 MB and make it a default device:
<P>
<PRE>   disk init
   name='tempdev',physname='c:\sql\data\tempdev.dat',
             vdevno=X,size=1024
   go
   sp_diskdefault tempdev, defaulton
   go
   shutdown
   go

</PRE>where X is a known free device number. After SQL Server shuts down from
either of these methods, it should be able to restart normally.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 4.2. This problem was corrected in SQL Server version 6.0. For more
information, contact your primary support provider.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 sp_configure tempdb Windows NT<BR>
Keywords            : kbbug4.20 kbfix6.00 kbother SSrvWinNT<BR>
Version             : 4.2 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
