

<HTML>
<HEAD>
<TITLE>INF: Listening on Multi-Protocol Fails on Startup </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160871">
<META NAME="KBModify" CONTENT="1997/04/09">
<META NAME="KBCreate" CONTENT="1996/12/11">
<META NAME="Keywords" CONTENT="kbenv kbinterop kbnetwork kbusage SSrvGen SSrvLan">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When a computer running SQL Server is configured to listen only on the multi-protocol network protocol, the MSSQLServer service may fail on the startup of Windows NT Server. This problem may occur when Windows NT Server is starting and the remote p...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABM,QAIJ,QACK,QBWS,QDIV,QDIK,QAB4,QAAP,QAA1,QAKP,QAL0,QDI2,QBJZ,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Listening on Multi-Protocol Fails on Startup</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160871</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When a computer running SQL Server is configured to listen only on the
multi-protocol network protocol, the MSSQLServer service may fail on the
startup of Windows NT Server. This problem may occur when Windows NT Server
is starting and the remote procedure call (RPC) service has not completed
initializing before SQL Server starts the server-side RPC Net-Library. You
will find the following errors in the SQL Server errorlog:

<UL><LI>Using 'SSMSRP60.DLL' version '6.5.0.0' to listen on ''.
   Error : 17826, Severity: 18, State: 0

<LI>Unable to set up ListenOn connection ''.
   OS Error : 1899, The endpoint mapper database could not be created.
   conn_hdlr: Unable to initialize Communication Layer
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
Configure the computer running SQL Server to listen on either another
network protocol or another protocol in addition to multi-protocol.
<P>
One other way to resolve this problem is to modify the Windows NT Server
registry to force the MSSQLServer service to depend on the RPC service,
requiring that the RPC service be initialized before MSSQLServer service
attempts to start.
<P>
WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows NT to correct them.
Microsoft cannot guarantee that any problems resulting from the use of
Registry Editor can be solved. Use this tool at your own risk.

<OL><P><LI>Start the Registry Editor (Regedt32.exe) and navigate to the following
   key:
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\MSSQLServer
</PRE>
<P><LI>Click the MSSQLServer subkey. On the Edit menu, click Add Value.

<P><LI>Enter the following:
<P>
<P><PRE>      Value Name: DependOnService
      Data Type:  REG_MULTI_SZ
<PRE></PRE>      Data:       RpcSs

</PRE><P><LI>Click OK and quit Registry Editor.

<P><LI>Shut down and restart the computer running Windows NT Server.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Multiprotocol<BR>
Keywords            : kbenv kbinterop kbnetwork kbusage SSrvGen SSrvLan<BR>
Version             : 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
