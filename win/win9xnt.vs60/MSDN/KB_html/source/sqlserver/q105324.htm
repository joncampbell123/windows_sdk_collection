

<HTML>
<HEAD>
<TITLE>BUG: ESQL: SQLD Is Set Incorrectly with Some Prepared Queries </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105324">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1993/10/17">
<META NAME="Keywords" CONTENT="kbbug4.20a kbbug4.21 kbprg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# 9292 (4.21)   The PREPARE statement may incorrectly set SQLD to zero if the prepared statement is a SELECT query with ORDER BY, or UNIONed with another SELECT query.  In the case of ORDER BY, the problem will occur if the ORDER BY is on a column...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOI,QBXS,QA28,QA2Q,QATJ,QAAP,QAG2,QBVV,QAUD,QAPN,QAN0,QAKP,QABM,QBWS,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: ESQL: SQLD Is Set Incorrectly with Some Prepared Queries</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105324</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Embedded SQL version 4.21 for COBOL
</UL> 
BUG# 9292 (4.21)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The PREPARE statement may incorrectly set SQLD to zero if the prepared
statement is a SELECT query with ORDER BY, or UNIONed with another SELECT
query.
<P>
In the case of ORDER BY, the problem will occur if the ORDER BY is on a
column that does not have any clustered indexes. For example:
<P>
<PRE>   select * from authors order by au_lname

</PRE>will cause this problem, but
<P>
<PRE>   select * from authors order by au_id

</PRE>will not. There is a clustered index defined on au_id, but not
on au_lname.
<P>
In case of UNION, any two SELECT statements that are UNIONed together
will have SQLD set incorrectly.
<P>
This SQLD is supposed to be set to the number of columns the prepared
SELECT query returns, and to zero if the prepared query does not return
any results.
<P>
<P><h2>CAUSE</h2>
 
<P>
SQL Server Embedded SQL for COBOL incorrectly set the SQLD value if the
prepared statement contains ORDER BY on a column without a clustered index,
or if UNION is used in the query.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Embedded SQL version 4.21
for COBOL. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbbug4.20a kbbug4.21 kbprg<BR>
Version             : 4.21 | 4.21<BR>
Platform            : MS-DOS OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
