

<HTML>
<HEAD>
<TITLE>INF: Interpreting BINARY Data w/ Visual Basic Library for SQL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94181 ">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1992/12/29">
<META NAME="Keywords" CONTENT="kbinterop SSrvProg SSrvVisB">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Special handling is necessary when using the Visual Basic Library for SQL in order to form an ASCII representation of BINARY or VARBINARY data retrieved from SQL Server. The SQLData$ function returns character string representations of most datatyp...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBS0,QAYY,QBE7,QBE6,QAY5,QAUD,QATX,QAH4,QBV8,QBHQ,QAVK,QAB9,QALW,QDMW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Interpreting BINARY Data w/ Visual Basic Library for SQL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94181 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server Programmer's Toolkit, version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Special handling is necessary when using the Visual Basic Library for SQL
in order to form an ASCII representation of BINARY or VARBINARY data
retrieved from SQL Server. The SQLData$ function returns character string
representations of most datatypes; however, BINARY, VARBINARY, and IMAGE
data are returned as strings of binary data. That is, the string returned
from SQLData$ represents the actual data stored in SQL Server.
<P>
Character string representation of BINARY data might be necessary in
applications making use of TIMESTAMP data (represented by VARBINARY(8)
within SQL Server) when evaluating SQL Server global variables such as
@@DBTS, or when implementing a robust ad-hoc query processor.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code fragment below describes how to incorporate processing within a
SQL results handler in order to form an ASCII representation of BINARY
data. The PadLeft$() function is necessary to ensure that each hexadecimal
number is translated into a two-character ASCII representation.
<P>
<PRE>' code fragment for processing binary data

    coltype% = SQLColType%(sqlconn%, X%)
    colvalue$ = SqlData(sqlconn%, X%)
   ' coltype 45 = BINARY DATA
    If coltype% = 45 Then
        buffer$ = "0x"
        For yy = 1 To Len(colvalue$)
    buffer$ = buffer$ + PadLeft$(Hex$(Asc(Mid$(colvalue$, yy, 1))), 2, "0")
         Next yy
         colvalue$ = buffer$
    End If

' zero padding function

</PRE>Function PadLeft$ (ByVal ST$, ByVal NUM%, ByVal padchar$)
<PRE>    ST$ = Trim(ST)
    PD$ = ""

    If (Len(ST) &lt; NUM) Then
        For X = 1 To NUM - Len(ST)
            PD$ = PD$ + padchar$
        Next X
    End If

    PadLeft$ = PD$ + ST$

</PRE>End Function
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: vb<BR>
Keywords            : kbinterop SSrvProg SSrvVisB<BR>
Version             : 4.2 | 4.2<BR>
Platform            : MS-DOS WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
