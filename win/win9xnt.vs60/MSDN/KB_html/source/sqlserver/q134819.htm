

<HTML>
<HEAD>
<TITLE>INF: Common SQL-DMO C/C++ Programming Issues </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134819">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1995/08/10">
<META NAME="Keywords" CONTENT="kbprg SSrvDMO SSrvErr_Log SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article provides information regarding some of the more common errors you may encounter when you attempt to develop a Microsoft SQL Server version 6.0 distributed management objects (SQL-DMO) application.  MORE INFORMATION  1. Problem:     OUT...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAPN,QABI,QBVV,QA5E,QAKP,QAGI,QAB4,QAAP,QABH,QBFY,QAY5,QAKD,QBSO,QAX6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Common SQL-DMO C/C++ Programming Issues</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides information regarding some of the more common errors
you may encounter when you attempt to develop a Microsoft SQL Server
version 6.0 distributed management objects (SQL-DMO) application.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Problem:
<P>
   OUT OF MEMORY error returned from CoCreateInstance().
<P>
   Cause:
<P>
   You can encounter this error in a couple of ways. The first is an actual
   out of memory situation. The second and more common is caused by a
   missing DLL or invalid SQL-DMO environment.
<P>
   Resolution:
<P>
   Make sure you do not have a physical memory error. Also ensure that the
   SQL-DMO environment was properly installed. You must have the
   SQLSVC32.DLL and the SQLOLE32.DLL files available and in the
   applications search path. You also need to have used the SQLOLE.REG file
   to properly register the SQL-DMO objects.

<P><LI>Problem:
<P>
   Ordinal 164 could not be located.
<P>
   Cause:
<P>
   An attempt is made to use a SQL-DMO application without the SQL
   Server version 6.0 DBLIBRARY DLL file.
<P>
   Resolution:
<P>
   Install the SQL Server version 6.0 version of the DBLIBRARY, such as
   NTWDBLIB.DLL.

<P><LI>Problem:
<P>
   if(hResult) does not evaluate as expected
<P>
   Cause:
<P>
   S_OK is equal to zero, so statements such as the following can cause
   unexpected behavior:
<P>
<P><PRE>      if(S_OK &amp; hResult)
</PRE><P>
<P><PRE>      -OR-
</PRE><P>
<P><PRE>      if(hResult)
</PRE><P>
   Resolution:
<P>
   Since S_OK is equal to zero, it does not evaluate to a non-zero value,
   so it evaluates to false and takes the else branch.
<P>
   Change statements to look like the following:
<P>
<P><PRE>      if(S_OK == hResult)
</PRE><P>
   Or, use the SUCCEED macro to check the status.

<P><LI>Problem:
<P>
   CoInitialize() returns S_FALSE in an MFC application.
<P>
   Cause:
<P>
   By default, if you build an MFC project enabled for OLE support, the
   AfxInitOle() function is called in the CWinApp derived class.
<P>
   Resolution:
<P>
   Continue to call the CoInitialize function. This will always ensure the
   initialization has taken place. For instance if the CoUnInitialize()
   function is invoked and you want to do another CoCreateInstance(), then
   you must call the CoInitialize() the second time to reinitialize.

<P><LI>Problem:
<P>
   Error C2039: 'xxx' : is not a member of 'IASQLOLEServer'
<P>
   Cause:
<P>
   The specific code line has attempted to directly access an object
   property.
<P>
   Resolution:
<P>
   Use the Set and Get methods to access the data.
<P>
<PRE>         pSQLServer-&gt;SetApplicationName("SQL_DMO Test");
         pSQLServer-&gt;SetHostName("Sample");

</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 programming ole 32-bit<BR>
Keywords            : kbprg SSrvDMO SSrvErr_Log SSrvProg<BR>
Version             : 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
