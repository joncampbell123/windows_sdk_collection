

<HTML>
<HEAD>
<TITLE>INF: Diagnostic Tips for the Microsoft SQL Server ODBC Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140895">
<META NAME="KBModify" CONTENT="1997/06/25">
<META NAME="KBCreate" CONTENT="1995/12/07">
<META NAME="Keywords" CONTENT="kbinterop SSrvDB_Lib SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article discusses how to diagnose issues that sometimes arise when using the Microsoft SQL Server ODBC Driver.  MORE INFORMATION  Diagnosing connection errors:  1. A connection attempt using an ODBC data source fails and a    call to SQLError(...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA9E,QAU9,QADK,QA6A,QABI,QAAP,QAUD,QAB4,QAVZ,QBWP,QBG2,QBWO,QA5E,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Diagnostic Tips for the Microsoft SQL Server ODBC Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140895</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
<LI>Microsoft Open Database Connectivity
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article discusses how to diagnose issues that sometimes arise when
using the Microsoft SQL Server ODBC Driver.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Diagnosing connection errors:

<OL><P><LI>A connection attempt using an ODBC data source fails and a
   call to SQLError() returns:
<P>
<P><PRE>      szSqlState = "IM002", *pfNativeError = 0,
      szErrorMsg="[Microsoft][ODBC Driver Manager] Data source name
<PRE></PRE>               not found and no default driver specified"

   The ODBC driver manager could not find the ODBC data source. Make sure
   the data source name was given correctly. Also make sure the data source
   name was defined using the same Windows NT account the application is
   running under, or it is an ODBC 2.5 system data source. If the
   application is running as a Windows NT service, the data source must be
   a system data source.

   For additional information, please see the following article in the
   Microsoft Knowledge Base:

   ARTICLE-ID: <B><A href="../odbc/q136481.htm">Q136481</A></B>
   TITLE     : INF: Running ODBC Applications as Windows NT Services

</PRE><P><LI>If a connection attempt fails and a call to SQLError() returns:
<P>
<P><PRE>      szSqlState = "IM003", *pfNativeError = 0,
      szErrorMsg="[Microsoft][ODBC Driver Manager] Specified driver
<PRE></PRE>               could not be loaded"

   the driver manager could not successfully load the driver DLL,
   SQLSRVR.DLL for Win16 or SQLSRV32.DLL for Win32. Make sure valid
   versions of these DLLs are in the client's path. Note that for the
   Microsoft ODBC ODS driver, the corresponding DLLS are ODSGATE.DLL
   (Win16) and ODSGT32.DLL (Win32).

</PRE><P><LI>If a connection attempt fails and a call to SQLError() returns:
<P>
<P><PRE>      szSqlState = "S1000", *pfNativeError = 126,
      szErrorMsg="[Microsoft][ODBC SQL Server Driver] Unable to load
<PRE></PRE>               communication module.  Driver has not been
               correctly installed."

   The SQL Server driver could not load the SQL Server client side
   network library. Verify the ODBC data source against Knowledge Base
   article <B><A href="../sqlserver/q137635.htm">Q137635</A></B> (INF: ODBC SQL Server Connection Parameters) to ensure
   a proper network library name was given. Verify that a valid version of
   the network library DLL is in the client's path. This can also sometimes
   occur if the DLLs and files making up the underlying network components,
   such as Novell's SPX/IPX, or a TCP/IP stack, are not properly installed.
   Verify the components with the network administrator, or reinstall the
   client network components.

</PRE><P><LI>SQLError() returns:
<P>
<P><PRE>      szErrorMsg = "[Microsoft][ODBC SQL Server Driver]TDS buffer
<PRE></PRE>                 length too large(#0)"

   This error generally occurs when attempting a named pipe connection from
   a Windows for Workgroups 3.11 client to a Windows NT 3.5 or later server
   in a Novell network. The Windows for Workgroups client needs to have
   some of its network files updated.

   For additional information, please see the following article in the
   Microsoft Knowledge Base:

   ARTICLE-ID: <B><A href="../sqlserver/q121258.htm">Q121258</A></B>
   TITLE     : PRB: Connect to SQL on NT 3.5 from WFW 3.11 via Named Pipes

</PRE><P><LI>Attempts to connect with the 2.50.0121 version of the Win16 SQLSRVR.DLL
   using the Win16 DBMSSPX3 network library fail and SQLError() returns:
<P>
<P><PRE>      szSqlState="01000", pfNativeError = 253,
      szErrorMsg="[Microsoft][ODBC SQL Server driver][DBMSSPX3]
<PRE></PRE>               ConnectionRead(SPXListenForSequencedpacket())."

   You can get an updated driver that resolves the problem in SQL Server
   6.0 Service Pack 1. See article <B><A href="../urjump.htm">Q137781</A></B> ("INF: How to Obtain SQL Server
   v6.0 Service Pack 1) for the location of the Service Pack. You can also
   reset your sp_configure network packet size in SQL Server to 512 to
   eliminate the problem until you obtain the service pack.

   For additional information, please see the following article in the
   Microsoft Knowledge Base:

   ARTICLE-ID: <B><A href="../sqlserver/q136575.htm">Q136575</A></B>
   TITLE     : FIX: SQL Server 6.0 Service Pack 1 Fixlist

</PRE><P><LI>For other network connectivity errors, SQLError() will generally
   return errors as defined in article <B><A href="../sqlserver/q137634.htm">Q137634</A></B> (INF: ODBC SQL Server
   Driver Network Messages). Review this article for information on
   dealing with the connectivity/network errors. You can also review
   article <B><A href="../sqlserver/q138541.htm">Q138541</A></B> (INF: ODBCPING.EXE to Verify ODBC Connectivity to SQL
   Server) on using the ODBCPing utility to test connections.
<P>
</OL>Diagnosing general errors:

<OL><P><LI>If the szErrorMsg string returned by SQLError() starts with:
<P>
<P><PRE>      "[Microsoft][ODBC SQL Server driver][DBMSxxxx]"
</PRE><P>
   where DBMSxxxx is one of the network library names listed in
   article <B><A href="../sqlserver/q137634.htm">Q137634</A></B> (previously referenced), the problem is a connectivity
   or network problem, so you should go back up to step 6.

<P><LI>If the szErrorMsg string returned by SQLError() starts with:
<P>
<P><PRE>      "[Microsoft][ODBC SQL Server driver][SQL Server]"
</PRE><P>
   The error is coming from SQL Server itself. The pfNative variable
   returned by SQLError() is the SQL Server error code. Follow the
   directions for this error number in either the SQL Server 4.2
   "Troubleshooting Guide" or in Chapter 25 of the SQL Server 6.0
   "Administrator's Companion." Also, you should review the problem with
   the database administrator, and attempt to replicate the problem in
   ISQL/w after setting the options discussed in article <B><A href="../sqlserver/q135533.htm">Q135533</A></B> (INF:
   Differences in SQL Behavior Between ODBC and ISQL).

<P><LI>If you are experiencing difficulties with stored procedures that
   reference temporary tables on SQL Server 6.0 or later, make sure that
   the CREATE TABLE statements for the temporary tables specify NULL or
   NOT NULL for each column.
<P>
   For additional information, please see the following article in the
   Microsoft Knowledge Base:
<P>
   ARTICLE-ID: <B><A href="../sqlserver/q138761.htm">Q138761</A></B>
<PRE>   TITLE     : INF: Differences in Column Nullability

</PRE><P><LI>If you are experiencing differences in behavior between DB-Library
<P><PRE>    and ODBC clients, review articles <B><A href="../sqlserver/q135533.htm">Q135533</A></B> (referenced earlier),
    <B><A href="../sqlserver/q135532.htm">Q135532</A></B> (INF: SQL Server 6.0 ODBC Driver Changes Tempdb Usage), and
    <B><A href="../sqlserver/q149921.htm">Q149921</A></B> (INF: ODBC ANSI upgrade changes from SQL Server 6.0 to 6.5).
</PRE>
<P><LI>If you are experiencing differences in behavior when you upgrade from
<P><PRE>    SQL Server 4.2x to SQL Server 6.0, review articles <B><A href="../sqlserver/q133177.htm">Q133177</A></B> (INF:
    Changes to SQL Server 6.0 That May Affect 4.2x Apps), <B><A href="../sqlserver/q135532.htm">Q135532</A></B> (INF: SQL
    Server 6.0 ODBC Driver Changes Tempdb Usage), <B><A href="../sqlserver/q135533.htm">Q135533</A></B> (INF: Differences
    in SQL Behavior Between ODBC and ISQL), and <B><A href="../sqlserver/q138761.htm">Q138761</A></B> (INF: Differences
    in Column Nullability).
</PRE>
<P><LI>If you are experiencing differences in behavior when you upgrade from
<P><PRE>    SQL Server 6.0 to SQL Server 6.5, review article <B><A href="../sqlserver/q149921.htm">Q149921</A></B> (INF: ODBC
    ANSI Upgrade Changes from SQL Server 6.0 to 6.5). Sites upgrading
    from SQL Server 4.21a to SQL Server 6.5 should also review the
    articles listed in step 10 above.
</PRE>
<P><LI>If you are experiencing Microsoft Access conformance errors, or if
<P><PRE>    calls to the ODBC catalog API functions are failing, ensure the right
    version of INSTCAT.SQL has been run in the target server. See articles
    <B><A href="../sqlserver/q137636.htm">Q137636</A></B> (INF: Relationship of the ODBC Driver to INSTCAT.SQL), and
    <B><A href="../sqlserver/q137633.htm">Q137633</A></B> (INF: Addressing Access Conformance Errors in the SQL ODBC
    Drvr) for additional diagnostics on Microsoft Access conformance
    errors.
</PRE>
<P><LI>If you are experiencing an increased use of tempdb in SQL Server 6.0,
<P><PRE>    review article <B><A href="../sqlserver/q135532.htm">Q135532</A></B> (referenced earlier in step 10).
</PRE>
<P><LI>If you are experiencing syntax errors from either SQL Server itself:
<P>
<P><PRE>      szSqlState = "37000", *pfNativeError = 170,
      szErrorMsg="[Microsoft][ODBC SQL Server Driver][SQL Server]
<PRE></PRE>               Line 1: Incorrect syntax near '*'."

    or from the ODBC SQL Server Driver, review article <B><A href="../sqlserver/q139655.htm">Q139655</A></B> (INF:
    Tracing SQL Generated by MS SQL Server ODBC Driver) for information on
    the options to trace the SQL commands in an ODBC environment. In
    general, if you are using a front-end product which generates ODBC SQL
    and you need to verify that the generated SQL is correct, you can
    use either the ODBC Administrator trace or the ODBCSpy utility. If you
    need to verify that the Transact-SQL being generated by the driver is
    correct, you can use the SQL Server 4032 trace flag.

</PRE></OL>If you encounter problems not listed above, do a keyword search of the
Microsoft TechNet compact disc (or your preferred source for the Microsoft
Knowledge Base) for articles that mention similar symptoms.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 debug tshoot troubleshoot diagnostic<BR>
dblib<BR>
Keywords            : kbinterop SSrvDB_Lib SSrvGen<BR>
Version             : 2.5 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
