

<HTML>
<HEAD>
<TITLE>INF: ODBCPING.EXE to Verify ODBC Connectivity to SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138541">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1995/10/23">
<META NAME="Keywords" CONTENT="kbinterop kbtool SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Microsoft SQL Server versions 6.0 and 6.5 contain a 32-bit utility called ODBCPING.EXE that you can use to verify connectivity to MS SQL Server through Microsoft ODBC SQL Server drivers.  MORE INFORMATION  The Odbcping.Exe utility is used to check ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA9E,QAB4,QAU9,QAHE,QBCU,QAI5,QAKR,QAAP,QBBI,QBG2,QAK6,QBVV,QAVX,QAVW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: ODBCPING.EXE to Verify ODBC Connectivity to SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138541</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft SQL Server versions 6.0 and 6.5 contain a 32-bit
utility called ODBCPING.EXE that you can use to verify
connectivity to MS SQL Server through Microsoft ODBC SQL
Server drivers.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Odbcping.Exe utility is used to check whether ODBC and
the Microsoft SQL Server driver are properly installed by
connecting to a server using the ODBC SQL Server Driver.
<P>
The command syntax to use the utility is:
<P>
odbcping {/Sservername | /Ddatasource} /Ulogin_id /Ppassword
<P>
where /U and /P are the SQL Server login ID and password, /S
is the network name of the server running SQL Server, and /D
is the name of an ODBC data source. Users must specify
either /S or /D, but not both. The version of ODBCPING that
ships with SQL Server 6.0 will only accept the /S, /U, and
/P switches, it will not accept the /D parameter. Note that
the switches are case sensitive. The 6.0 version of the
utility is documented in the ODBC SQL Server Driver help
file Drvssrvr.Hlp, which comes with SQL Server versions 6.0
and 6.5, in the section "Connecting to a Data Source." It is
also in the SQL Server Books Online "Administrator's
Companion," Part 6, Chapter 15, Troubleshooting and
Recovery.
<P>
The utility can be used against SQL Server versions 4.21a or
later. ODBCPING can be used from Windows NT and Windows 95
clients. If the /D switch is used, the utility can be used
against any ODBC data source for the Win32 version(s) of the
Microsoft SQL Server Driver (SQLSRV32.DLL). If /D is
specified for a data source using a Win32 non-SQL Server
driver, ODBCPING will connect through the data source, but
may encounter difficulties when it attempts to find the SQL
Server version string. The utility does not work with Win16
ODBC drivers.
<P>
The following example demonstrates how to use this utility
and how to verify the information it provides.
<P>
If you execute the following from the command line (abc is
the server name):
<P>
<PRE>   c:\mssql\binn&gt;odbcping -Sabc -Usa -Pxyz

</PRE>ODBCPING will return the following information on a
successful connection:
<P>
<PRE>   CONNECTED TO SQL SERVER

   ODBC SQL Server Driver Version: 02.65.0201

   SQL Server Version: SQL Server for Windows NT 6.50 -
   6.50.201 (Intel X86)
      Apr 3 1996 02:55:53
      Copyright (c) 1988-1996 Microsoft Corporation

</PRE>The utility gives you SQL Server and driver version number
information.
<P>
ODBCPING was written with the assumption it would be used to
test SQL Server driver data sources. If the /D switch is
used to connect to a non-SQL Server driver ODBC data source,
ODBCPING will print out the ODBC driver version, but will
not print correct server information. If errors are
encountered on the connect attempt, ODBCPING will correctly
report the errors encountered. For example, issuing the
following on a client that has the ODBC SDK sample
applications installed:
<P>
<PRE>   c:\mssql\binn&gt;odbcping -Dsdk21-Access32 -Usa -Pxyz

</PRE>if a successful connect, results in the following output:
<P>
<PRE>   CONNECTED TO SQL SERVER

   ODBC SQL Server Driver Version: 3.40.2505
   SQL Server Version: |^w

</PRE>When the /S switch is specified, ODBCPING, will use the
default network library specified in the SQL Client
Configuration Utility. When the /D switch is specified,
ODBCPING will use the network library defined in the data
source. Users wanting to quickly test the basic setup of
multiple network libraries can use the SQL Client
Configuration Utility to set different network libraries as
the default protocol, and test them using ODBCPING with the
/S switch.
<P>
For additional information regarding ODBC SQL Server
Connection Parameters, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q137635.htm">Q137635</A></B>
   TITLE     : INF: ODBC SQL Server Connection Parameters

</PRE>The utility serves as an alternative to the ODBC Test
utility in the ODBC SDK package. It helps in loading
different network libraries and testing the connectivity
through ODBC. It also helps in verifying that the ODBC
modules are installed and configured correctly. The
limitation, however, is that it cannot be run in a Win16
(for example, Windows 3.1 or Windows for Workgroups) client
environment.
<P>
There is a limitation in using the 6.0 version of the
ODBCPING utility to interpret connectivity errors. For
example, if the ODBCPING utility is used to try to connect
to a server which does not exist in the network, then the
pfNative error does not get displayed, so you cannot
interpret the actual source of the problem.
<P>
For more information on interpreting pfNative code reported
by connectivity errors, please see the following article in
the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q137634.htm">Q137634</A></B>
   TITLE     : INF: ODBC SQL Server Network Messages

</PRE>The scenario can be illustrated by the following example:
<P>
Using the 6.0 ODBCPING utility on an unsuccessful connection
with named pipes reports the following error:
<P>
<PRE>   C:\utils&gt;odbcping -Sxyz -Usa -P

   COULD NOT CONNECT TO SQL SERVER

   SQLState: 01000
   Error Message: [Microsoft][ODBC SQL Server
   Driver][dbnmpntw]
                         ConnectionOpen (CreateFile()).

   SQLState: 08001
   Error Message: [Microsoft][ODBC SQL Server Driver]
                          Unable to connect to data source.

</PRE>While the same error in the 6.5 ODBCPING returns the
following information:
<P>
<PRE>     C:\utils&gt;odbcping -Sxyz -Usa -P

   COULD NOT CONNECT TO SQL SERVER

   SQLState: 01000  Native Error: 2
   Error Message: [Microsoft][ODBC SQL Server
   Driver][dbnmpntw]
                          ConnectionOpen (CreateFile()).

   SQLState: 08001  Native Error: 6
   Error Message: [Microsoft][ODBC SQL Server
   Driver][dbnmpntw]
                         Specified SQL Server not found.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 2.50 odbc windows nt err code<BR>
Keywords            : kbinterop kbtool SSrvGen<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
