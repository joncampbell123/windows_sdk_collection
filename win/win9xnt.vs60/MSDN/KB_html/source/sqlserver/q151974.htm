

<HTML>
<HEAD>
<TITLE>PRB: New Datasource Configuration Options in SQL Server 6.5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151974">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1996/05/31">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When you call the SQLConfigDataSource API with a NULL window handle to configure a SQL Server 6.5 ODBC datasource silently, and you try to set the new setup options introduced in the 6.5 driver, the information will not be written to the Odbc.ini o...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIZ,QABM,QA9E,QAA1,QDI2,QBV8,QAGI,QAX6,QAU9,QAUD,QBWC,QBSO,QDJ3,QDIT,QBG2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: New Datasource Configuration Options in SQL Server 6.5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151974</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you call the SQLConfigDataSource API with a NULL window handle to
configure a SQL Server 6.5 ODBC datasource silently, and you try to set the
new setup options introduced in the 6.5 driver, the information will not be
written to the Odbc.ini or the registry. However, SQLConfigDataSource
returns TRUE as the return code.
<P>
See the More Information section in this article for a list of the new
setup options.
<P>
<P><h2>CAUSE</h2>
 
<P>
In the current implementation, the new setup options can only be configured
interactively in the driver setup dialog box.
<P>
<P><h2>WORKAROUND</h2>
 

<UL><LI>Pass a valid hwnd to SQLConfigDataSource and have the users manually
   check or select the new options in the resulting datasource setup dialog
   box.

<LI>In case you absolutely have to do a silent datasource configuration,
   call the SQLWritePrivateProfileString API and modify the registry after
   silently calling SQLConfigDataSource. If you follow this approach, it is
   recommended that you use the ODBC administrator to configure a
   datasource, note the entries made in the registry and then use those
   entries in SQLWritePrivateProfileString. Note that, in the registry, the
   datasource entries will be written under the following keys:
<P>
<P><PRE>      &lt;Your machine&gt;\HKEY_LOCAL_USER\SOFTWARE\ODBC\ODBC.INI\&lt;your
      datasource&gt; (for a user datasource)
</PRE><P>
<P><PRE>      &lt;Your machine&gt;\HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBC.INI\&lt;system
      datasource&gt; (for a system datasource)
</PRE><P>
   For more information on using SQLWritePrivateProfileString, please refer
   to the README25.TXT (Windows\System32 or System) that comes with the
   ODBC 2.5 components.

<LI>You can also set these options at the connection level, if you are using
   the ODBC API in your application. For more information, refer to the
   "Driver-Specific Connection Options" in the SQL Server Books Online.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The SQL Server driver v2.65.0201 has three new options for the datasource
setup. In the ODBC administrator for a SQL Server 6.5 datasource, these are
listed as:
<P>
1) Use Trusted Connection
2) Save Long Running Queries
<PRE>    2.a) Query Logging Threshold (milliseconds)
    2.b) Query Log File
</PRE>3) Log Driver Statistics
<PRE>    3.a) Statistics Log File

</PRE>The keywords used in the registry for these options are:
<P>
1) Trusted_Connection
2) QueryLog_On
<PRE>    2.a) QueryLogFile
    2.b) QueryLogTime
</PRE>3) StatsLog_On
<PRE>    3.a) StatsLogFile
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MFC 'Database Classes' RDO Access DAO Visual<BR>
C++ Visual Basic<BR>
Version             : 2.65.0201<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
