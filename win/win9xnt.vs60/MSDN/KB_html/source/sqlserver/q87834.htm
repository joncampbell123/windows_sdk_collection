

<HTML>
<HEAD>
<TITLE>FIX: SQL Admin: Actual Startup Time for Scheduled Backups </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q87834 ">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1992/08/06">
<META NAME="Keywords" CONTENT="kbbug4.20 kbbug4.20a kbtool SSrvAdmin">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# 7256 (4.20)   When daily backup events are scheduled using SQL Administrator, the actual start time for the backup event shifts every day by approximately the amount of time taken for the backup and the SQL Monitor  backuptime  parameter value. ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QDIU,QA3W,QAUR,QAU3,QAMR,QALB,QACE,QAIJ,QAFH,QDIV,QAML,QANY,QAO4,QAR4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: SQL Admin: Actual Startup Time for Scheduled Backups</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q87834 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 4.2
<LI>Microsoft SQL Server, version 4.2 for OS/2
</UL> 
BUG# 7256 (4.20)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When daily backup events are scheduled using SQL Administrator,
the actual start time for the backup event shifts every day by
approximately the amount of time taken for the backup and the SQL
Monitor "backuptime" parameter value. For example, if two daily
backup events are scheduled to start at 6:00 P.M. and 6:40 P.M. and
the SQL Monitor "backuptime" parameter is set to fifteen minutes, if SQL
Monitor wakes up at 5:47 P.M. and every fifteen minutes thereafter, the
actual startup times may shift successively each day, according to the
following chart:
<P>
<PRE>   Event ID   Actual Start Time         End Time
   --------   ----------------------    ----------------------

   1          April 17 1992 6:02 P.M.   April 17 1992 6:02 P.M.
   2          April 17 1992 6:47 P.M.   April 17 1992 6:47 P.M.
   1          April 18 1992 6:17 P.M.   April 17 1992 6:17 P.M.
   2          April 18 1992 7:02 P.M.   April 17 1992 7:02 P.M.
   1          April 19 1992 6:32 P.M.   April 17 1992 6:32 P.M.
   2          April 19 1992 7:17 P.M.   April 17 1992 7:17 P.M.

</PRE>This case assumes that the actual backup time is less than a minute.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs because of calculation drift. When SQL Monitor
wakes up and finds that less than 24 hours have passed since the
last backup was finished, it does not do the backup at that time.
Accordingly, the backup is done when it wakes up next time. This
happens every time SQL Monitor is supposed to perform the backup;
hence, the successive backups are shifted each day.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To specify the exact or near-exact time to start a backup, you must
periodically update the Last_dump column of the table
MSScheduled_backups to match the date of the last dump but at the
specified start time. For example, if the last dump is on 4/18/92
at 6:17 P.M. and your start time is at 6:00 P.M. for the event_id
1, execute the following:
<P>
<PRE>   Update MSScheduled_backups
   set last_dump='4/18/92 6:00PM'
   where event_id= 1

</PRE>Therefore, on 4/19/92, the backup for event_id 1, the backup will
occur at 6:02 P.M.
<P>
Another way to reduce the drift is to set the SQL Monitor "backuptime"
parameter to a lower value, say from fifteen minutes to one or two minutes.
This reduces the drift over time.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Administrator version
4.2. This problem was corrected in SQL Administrator version 4.20.1 and SQL
Server 4.2a for OS/2. For more information, contact your primary support
provider.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SQL Admin<BR>
Keywords            : kbbug4.20 kbbug4.20a kbtool SSrvAdmin<BR>
Version             : 4.2  | 4.2<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
