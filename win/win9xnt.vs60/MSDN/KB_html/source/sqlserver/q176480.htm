

<HTML>
<HEAD>
<TITLE>INF: How to Restrict the Inner Table of an ANSI Outer Join </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176480">
<META NAME="KBModify" CONTENT="1997/11/10">
<META NAME="KBCreate" CONTENT="1997/11/07">
<META NAME="Keywords" CONTENT="SSrvISQL SSrvTran_SQL kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  SQL Server 6.5 supports the ANSI-style join syntax for cross, inner, and outer joins. Restricting the inner table of an ANSI-style outer join may appear to return results that differ from those returned using the Transact- SQL-style outer join synt...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBPJ,QDNB,QDMF,QAMB,QA4H,QAUD,QAK9,QAY2,QAJ9,QABM,QATQ,QAE6,QAA8,QAJQ,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Restrict the Inner Table of an ANSI Outer Join</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176480</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SQL Server 6.5 supports the ANSI-style join syntax for cross, inner, and
outer joins. Restricting the inner table of an ANSI-style outer join may
appear to return results that differ from those returned using the Transact-
SQL-style outer join syntax. This article discusses the situation in which
an ANSI-style outer join appears to return results different from the
Transact-SQL-style outer join syntax, and demonstrates the correct syntax
to use for an ANSI-style outer join.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
An outer join allows you to restrict the rows in one table, while not
restricting the rows in another table. Consider the following Transact-SQL-
style example, using the pubs database:
<P>
<PRE>   SELECT titles.title_id, title, qty
   FROM titles, sales
   WHERE titles.title_id *= sales.title_id

</PRE>This query would return at least one row for every title, and additional
rows if there are multiple sales for a single title. Titles with no sales
would display a NULL in the "qty" column.
<P>
Because future versions of SQL Server may discontinue support for the "*="
and "=*" outer join operators, it is recommended that you use the ANSI-
standard join clauses. The equivalent ANSI-style query for the query above
is:
<P>
<PRE>   SELECT titles.title_id, title, qty
   FROM titles LEFT OUTER JOIN sales
   ON titles.title_id = sales.title_id

</PRE>If you wanted to restrict the sales table to only return sales for a
particular store, you would qualify the inner table, as in the following
example:
<P>
<PRE>   SELECT titles.title_id, title, qty
   FROM titles, sales
   WHERE titles.title_id *= sales.title_id
   AND stor_id = '7066'

</PRE>This would return 18 rows. To apply the same restriction with the ANSI-
style syntax, you might use a query similar to the following:
<P>
<PRE>   SELECT titles.title_id, title, qty
   FROM titles LEFT OUTER JOIN sales
   ON titles.title_id = sales.title_id
   WHERE stor_id = '7066'

</PRE>However, in this case, only two rows are returned because the restriction
on stor_id is applied after the outer join has been performed. Therefore,
titles that do not have sales in the specified store will not appear in the
query. The outer join does not appear to have been performed.
<P>
The proper way to restrict the inner table of an outer join is to place the
inner table qualifier in the ON portion of the FROM clause, as in the
following example:
<P>
<PRE>   SELECT titles.title_id, title, qty
   FROM titles LEFT OUTER JOIN sales
   ON titles.title_id = sales.title_id
   AND stor_id = '7066'

</PRE>The restriction on the inner table will be applied in the formulation of
the outer join, and the result will be equivalent to the Transact-SQL-style
syntax example.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: outerjoin right outer join tsql t-sql tran-sql<BR>
transql transsql trans-sql<BR>
Keywords          : SSrvISQL SSrvTran_SQL kbusage<BR>
Version           : WINNT:6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
