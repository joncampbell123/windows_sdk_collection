

<HTML>
<HEAD>
<TITLE>INF: Rebuilding the MSDB Database in SQL Server 6.0 and 6.5 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141530">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1995/12/19">
<META NAME="Keywords" CONTENT="kbusage SSrvAdmin">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  In some cases it may be necessary to rebuild the MSDB database that maintains the task, alert, and operator information for SQL Executive.  After you discuss the situation with a SQL Server support engineer, if the MSDB database cannot be reloaded ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QDNQ,QAZV,QAA1,QAQ7,QAGB,QAB4,QDI2,QBWS,QBVV,QAEF,QAIJ,QBCT,QAUR,QANY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Rebuilding the MSDB Database in SQL Server 6.0 and 6.5</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141530</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In some cases it may be necessary to rebuild the MSDB database that
maintains the task, alert, and operator information for SQL Executive.
<P>
After you discuss the situation with a SQL Server support engineer, if the
MSDB database cannot be reloaded from a backup and does need to be rebuilt
from scratch, you should follow the steps below. Note that any existing
tasks, alerts, and operators will be lost and will have to be added to the
system. Also note that some of the tasks may be associated with
replication, and that publisher, distributor, and subscriber information is
not held in the MSDB database; you should NOT use this process to remove
replication or to terminate a subscription or publication.
<P>
In the case where it has been determined that any MSDB triggers or stored
procedures have been lost or damaged and must be recreated (but the MSDB
devices, database, and tables are all reliable), it is safe to re-run the
INSTMSDB.SQL script on an existing MSDB database because it will not
destroy any data. Be aware that if you re-run INSTMSDB.SQL, the default
alerts will be re-installed, and object permissions (which should not have
been altered) will be reset.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The steps to rebuild an MSDB database by replacing it are:

<UL><LI>Using SQL Enterprise Manager (SEM) -

</UL><OL><P><LI>Stop SQL Executive (use the right mouse button on SQL Executive;
   click Stop).

<P><LI>Delete the existing MSDB database (right mouse button on MSDB
   database; click Delete, but do not delete the database devices).

<P><LI>Run the script \SQL60\INSTALL\INSTMSDB.SQL use the Query Analyzer; this
   script will create the database and the necessary tables; if necessary,
   replace 'sql60' in the path with the installation directory where you
   have installed the SQL Server files.  (For SQL Server 6.5, this would be
<PRE>   'MSSQL').

</PRE><P><LI>If any errors occur, save the Query Analyzer output in a XX.RPT file.

<P><LI>For SQL Server 6.0, run the script \SQL60\INSTALL\SERVMSG.SQL. If this
   is SQL Server 6.5, run the script \MSSQL\INSTALL\SERVMSGS.SQL (This
   script will create the error messages for SQL Executive in
   msdb..sysservermessages).

<P><LI>Start SQL Executive (right mouse button on SQL Executive; click Start).

<P><LI>Add a task, an alert, and an operator to test the system.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 rebuild inst setup winnt<BR>
Keywords            : kbusage SSrvAdmin<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
