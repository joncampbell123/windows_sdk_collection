

<HTML>
<HEAD>
<TITLE>PRB: Connect to SQL on NT 3.5 from WFW 3.11 via Named Pipes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121258">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1994/09/30">
<META NAME="Keywords" CONTENT="kbinterop SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  A Microsoft Windows for Workgroups version 3.11 client (WFW 3.11) is designed to connect to SQL Server on Microsoft Windows NT version 3.5 via named pipes over the IPX/SPX-Compatible transport (NWLink). However, an enhancement in Windows NT 3.5 and...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWO,QABM,QBWP,QARL,QAXB,QAC1,QDL9,QBWQ,QBWN,QAVZ,QAI5,QBD2,QBB1,QAY2,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Connect to SQL on NT 3.5 from WFW 3.11 via Named Pipes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121258</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2
</PRE> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A Microsoft Windows for Workgroups version 3.11 client (WFW 3.11) is
designed to connect to SQL Server on Microsoft Windows NT version 3.5 via
named pipes over the IPX/SPX-Compatible transport (NWLink). However, an
enhancement in Windows NT 3.5 and WFW 3.11 called "direct hosting" can
prevent existing WFW 3.11 clients from reliably connecting using named
pipes over NWLink. Direct hosting is a feature that allows the virtual
redirector on the client side and the network server on the server side to
interface directly to the underlying NWLink transport, bypassing NetBIOS,
which provides faster performance.
<P>
This problem may happen following an upgrade of the operating system on
which SQL Server runs from Windows NT 3.1 to version 3.5. The typical
symptom of this problem is that WFW 3.11 SQL Server clients are unable to
connect to SQL Server on Windows NT 3.5 using named pipes over NWLink.
<P>
The errors received by the DB-Library (DB-Lib) clients are:
<P>
<PRE>   Network error on drive ?
   Possible network error, read from SQL server failed.

</PRE>The error received by ODBC clients is:
<P>
<PRE>   [Microsoft][ODBC SQL Server Driver]TDS buffer length too large(#0)

</PRE><h2>WORKAROUND</h2>
 
<P>
Currently, there are two solutions to this connection problem. However, due
to the improved performance introduced in the first solution below, it is
strongly recommended that you use the first solution.
<P>
<P><h3>Solution 1. Updating WFW 3.11 Files:</h3>
 
<P>
There are 6 updated WFW 3.11 system files that include a new version
of the Windows for Workgroups redirector and other network support
files that provide improved performance. These files are distributed
on the Windows NT Server version 3.5 CD, in the \CLIENTS\WFW\UPDATE
directory.
<P>
The updated files are:
<P>
<PRE>   NDIS.386
   NET.EXE
   NETAPI.DLL
   NWNBLINK.386
   VNETSUP.386
   VREDIR.386

</PRE>These files should be used only for Windows for Workgroups version
3.11. They will allow named pipe connections to work properly to
Microsoft SQL Server over direct host IPX.
<P>
To install these new files on a computer running Windows for Workgroups
3.11:

<OL><P><LI>Copy all the files from the \CLIENTS\WFW\UPDATE directory on
   the Windows NT Server CD into the local C:\WINDOWS\SYSTEM directory
   of the Windows for Workgroups 3.11-based client.
<P>
   Note: Remember to use the Windows NT Server CD. The Microsoft SQL
   Server CD does not contain these files.

<P><LI>On the Windows for Workgroups 3.11-based client, move the
   NET.EXE file from C:\WINDOWS\SYSTEM to C:\WINDOWS.

<P><LI>Reboot the WFW 3.11 workstation.
<P>
</OL><h3>Solution 2. Modifying the SYSTEM.INI Setting:</h3>
 
<P>
If, for whatever reasons, you prefer not to apply the updated WFW
3.11 files as described above, you can avoid the named pipes
connection problem by updating the SYSTEM.INI file on the WFW 3.11
clients.
<P>
Using any text editor, you can edit the SYSTEM.INI file to set
DirectHost=off in [network] section:
<P>
<PRE>   [network]
   DirectHost=off

</PRE></OL>You need to reboot your client workstation after the modification.
<P>
NOTE: Although either solution should work, the first solution is preferred
because these files provide a general maintenance upgrade along with a
number of fixes and improvements.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Direct Host Windows NT dblib<BR>
Keywords            : kbinterop SSrvWinNT<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
