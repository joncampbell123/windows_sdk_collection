

<HTML>
<HEAD>
<TITLE>BUG: DocErr: Unattended Setup INI File in Books Online </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136491">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1995/09/10">
<META NAME="Keywords" CONTENT="kbbug6.00 kbsetup SSrvDoc_Err SSrvInst">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# NT: 10176 (6.00)   If you attempt an unattended setup using the sample .INI file from the Microsoft SQL Server Books Online as a template, it causes a 'Noncritical Error' saying:     External library procedure GetPrivProfStr reported the followi...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAA1,QDI2,QDIZ,QA6E,QABI,QAB4,QA4B,QAUJ,QA0B,QA90,QAPF,QAAP,QAKP,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: DocErr: Unattended Setup INI File in Books Online</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136491</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
BUG# NT: 10176 (6.00)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you attempt an unattended setup using the sample .INI file from the
Microsoft SQL Server Books Online as a template, it causes a 'Noncritical
Error' saying:
<P>
<PRE>   External library procedure GetPrivProfStr reported the following
   error

</PRE>however, the missing string is not reported in the message.
<P>
<P><h2>CAUSE</h2>
 
<P>
This is a documentation error. The unattended installation will
work correctly using the .INI template below.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
The following .INI file can be used as a template for creating an
actual .INI file with these caveats:
<P>
- Use the following setup command (including any other necessary
<PRE>  switches) to use a file named MYPC.INI for initialization. The
  capitalization of 'IniFilePath' and the spaces before and after
  the equal sign (=) must match the example; the drive letter, path, and
  filename are customizable:

     setup /t IniFilePath = e:\setini\mypc.ini

</PRE>- There must be at least one file listed in the CustomScriptList.
<PRE>  A file containing the word 'go' is sufficient.

</PRE>- If the Mode is set to one for PerSeat Licensing, the PerServerUsers=x
<PRE>  line must still be present in the .INI file.

</PRE>- A semicolon at the beginning of a line can be used to have Setup
<PRE>  treat the line as a comment.

</PRE>- Setup will require a button click at the end of the installation to
<PRE>  issue a 'Reboot Now' or 'Reboot Later' command.

</PRE>- If there is an installation of SQL Server version 4.2x already on the
<PRE>  machine, dialog boxes will appear waiting for Registered Owner and
  Install/Upgrade confirmation before continuing with the installation. The
  unattended setup cannot be used for upgrading an existing server to
  version 6.0.

</PRE>- Be sure the machine name is a valid SQL identifier, otherwise Setup
<PRE>  will display a "Warning: Invalid Machine Name" dialog and wait for
  user input. As stated in SQL Server Books Online, "The server name used
  by SQL Server is taken from the computer's name. Before installing
  Microsoft SQL Server on a server computer, make sure that the server's
  computer name is a valid SQL identifier. The first character must be a
  letter or an underscore (_). Characters following the first character can
  include letters, numbers, or the symbols #, $, or _. No embedded spaces
  are allowed."

</PRE>- When the Username or UserPassword for SQL Executive are not valid,
<PRE>  the Service Control Manager issues a "#SCM3 - 1057" error. Verify
  the user has 'Log on as a service' user right, and that the domain
  (or machine name) with a backslash is used when specifying the user.

</PRE>- Unattended setup cannot be used when installing on a remote server.
<P>
[License]
<PRE>  FullName=Royce Aydel
  OrgName=CLXD5 Corporation
  ProductID=AB1234567
  Mode=0
  PerServerUsers=50
</PRE>[SQLPath]
<PRE>  SQLPath=\SQL60
  LogicalSQLDrive=D:
</PRE>[MasterPath]
<PRE>  MasterSize=30
  LogicalDBDrive=D:
  MasterDBPath=\SQL60\DATA
  MasterDBFileName=MASTER.DAT
</PRE>[NewOptions]
<PRE>  AutoServerService=CHECKED
  AutoExecutiveService=CHECKED
  BooksOnline=1
</PRE>[CharSet]
<PRE>  CharSet=cpISO
</PRE>[SortOrder]
<PRE>  SortFileName=nocase.iso
  SortConfigValue=52
</PRE>[Network]
;  NetLibList={"SSNMPN60","SSMSRP60","SSMSSP60","SSMSSO60","SSMSAD60",
;      "SSMSVI60","SSMSDE60"}
<PRE>  NetLibList={"SSNMPN60","SSMSRP60"}
  ServerNMPipe=\\.\pipe\sql\query
  MultiProtEncrypt=NOTCHECKED
</PRE>;  SPXServiceName=ROYCEA3
;  TCPIPSocketNumber=1433
;  ADSPObjectName=
;  VinesStreetName=
;  DecNetObjectID=
[LogonAccount]
<PRE>  LocalSystem=NOTCHECKED
  Username=ExecService
  UserPassword=ABC1234
</PRE>[Scripts]
<PRE>  CustScPath=C:\TEMP
  CustomScriptList={"script1.sql","script2.sql","script3.sql"}

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.0. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are three errors in the SQL Server Books Online, SQL Server Setup,
Appendix B, "A Sample Setup Initialization File" section. These were found
by comparing the GetPrivProfStr calls in Setup.INF with the sample file.
(NOTE: The August 1995 TechNet CD is more out of date than the Books
Online.)
<P>
<PRE>   Password=ABC1234        should be  UserPassword=ABC1234
   CustomScPath=C:\TEMP    should be   CustScPath=C:\TEMP
   CustScriptList={ ... }  should be  CustomScriptList={ ... }

</PRE>The only entries missing from the sample file are the following
optional ones (which are mentioned in the [Network] section in
BooksOnline): VinesStreetName, ADSPObjectName, and DecNetObjectID.
<P>
There are three additional errors in this Books Online section that might
cause problems:
<P>
- In the Books Online section [Charset] (which should be [CharSet]),
<PRE>  the entry 'cp 850' should be 'cp850' (no space).

</PRE>- In the Books Online section [License] the entry 'Orgname' should
<PRE>  be 'OrgName' (uppercase 'N').

</PRE>- In the Books Online section [Network], the NetLibList entry in
<PRE>  the table at the bottom of the page has 'SSMSS060' for TCPIPSockets;
  this should be 'SSMSSO60' (the first zero should be the letter 'O').

</PRE>Also, the new character sets (CP1250, CP1251, and CP1253 to CP1257)
are not listed, nor are their corresponding SortOrders.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 install manual docs<BR>
Keywords            : kbbug6.00 kbsetup SSrvDoc_Err SSrvInst<BR>
Version             : 6.00<BR>
Platform            : WINDOWS<BR>
Issue type          : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
