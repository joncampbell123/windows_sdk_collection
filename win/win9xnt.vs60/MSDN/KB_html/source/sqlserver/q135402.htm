

<HTML>
<HEAD>
<TITLE>FIX: Sp_droplogin Error 14248 if ANSI_NULL_DFLT_ON </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135402">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1995/08/21">
<META NAME="Keywords" CONTENT="kbbug6.00 kbprg SSrvISQL SSrvTran_SQL">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG#: 10986 (6.00)   When you try to execute the system stored procedure sp_droplogin on Microsoft SQL Server version 6.0 and enable SET ANSI_NULL_DFLT_ON, the following error message appears:     Error: 14248    Message:  This login is the owner of ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB4,QBXS,QAR4,QAAP,QA9E,QAU9,QAH5,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Sp_droplogin Error 14248 if ANSI_NULL_DFLT_ON</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135402</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft Open Data Base Connectivity, version 2.5
<LI>Microsoft SQL Server, version 6.0
</UL> 
BUG#: 10986 (6.00)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you try to execute the system stored procedure sp_droplogin on
Microsoft SQL Server version 6.0 and enable SET ANSI_NULL_DFLT_ON, the
following error message appears:
<P>
<PRE>   Error: 14248
   Message: "This login is the owner of 11 Task(s).  You must drop
             or re-assign these Tasks before the login can be dropped."

</PRE>The Microsoft SQL Server ODBC driver versions 2.50.0121 or later always
sets ANSI_NULL_DFLT_ON to ON when running against SQL Server 6.0.
Therefore, any attempt to execute sp_droplogin from an ODBC session using
the driver results in the following:
<P>
<PRE>   szSqlState = "37000"
   pfNativeError = 14248
   pcbErrorMsg = 159
   szErrorMsg="[Microsoft][ODBC SQL Server Driver][SQL Server] This
   login is the owner of 11 Task(s).  You must drop or re-assign these
   Tasks before the login can be dropped."

</PRE><h2>WORKAROUND</h2>
 
<P>
DB-Library clients such as ISQL/w or Enterprise Manager sets the following:
<P>
<PRE>   SET ANSI_NULL_DFLT_ON OFF
   EXEC sp_droplogin...
   SET ANSI_NULL_DFLT_ON ON

</PRE>It is recommended that sites do not use ODBC to issue sp_droplogin against
SQL Server 6.0.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server version 6.0.
This problem has been corrected in SQL Server version 6.5. Contact your
primary support provider for more information.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SQL Server ODBC 16-bit<BR>
Keywords            : kbbug6.00 kbprg SSrvISQL SSrvTran_SQL<BR>
Version             : 2.5.0121 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
