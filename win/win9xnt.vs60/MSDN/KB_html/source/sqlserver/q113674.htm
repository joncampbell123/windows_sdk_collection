

<HTML>
<HEAD>
<TITLE>INF: -T3640 Flag May Block Updates to an ODBC Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113674">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1994/04/11">
<META NAME="Keywords" CONTENT="kbinterop odbc SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  Microsoft SQL Server version 4.21 (and later versions) provides a -T3640 flag that provides stored procedure performance enhancements. The flag optimizes stored procedure execution time because it suppresses the sending of individual statement comp...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA9E,QAXB,QAHE,QAL3,QAC1,QBD2,QAJH,QBWE,QAH6,QA1S,QBVV,QA5V,QAUD,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: -T3640 Flag May Block Updates to an ODBC Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113674</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21, 6.0, 6.50
<LI>Microsoft ODBC SQL Server Driver, version 1.02.3731
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft SQL Server version 4.21 (and later versions) provides a -T3640
flag that provides stored procedure performance enhancements. The flag
optimizes stored procedure execution time because it suppresses the sending
of individual statement completion information, which reduces network
traffic and has a significant effect on stored procedure execution time,
especially in wide area network (WAN) environments.
<P>
This information is not required by SQL Server/DB-Library (DB-Lib)
applications but may affect some ODBC applications. When SQL Server is
running with this flag enabled, an ODBC-enabled application using Microsoft
ODBC SQL Server driver to attempt to process update queries against tables
in SQL Server may fail because SQL Server is no longer sending rows
affected information required by some ODBC applications, such as Microsoft
Access for Windows.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In an ODBC application using the Microsoft ODBC SQL Server Driver to
communicate with a SQL Server that is running with the -T3640 flag enabled,
the ODBC API call, SQLRowCount(), will not be able to provide the number of
rows affected after a statement is prepared as a procedure using
SQLPrepare() and then executed using SQLExecute.
<P>
The effect is that in some ODBC-enabled applications, such as Microsoft
Access, when updates are attempted on a SQL Server table that resides on a
SQL Server running the -T3640 flag, the update will fail with the error:
<P>
<PRE>   ODBC-call failed

</PRE>No other error message will be returned.
<P>
With the -T3640 flag enabled, SQL Server is unable to return the number of
rows updated in response to the ODBC API call SQLRowCount(). Other ODBC-
enabled applications, whose proper operation depend the number of rows
affected by an ODBC SQL query returning from SQLRowCount(), will encounter
similar problems. However, if the -T3640 flag is not used, this problem
will not occur.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 Windows NT<BR>
Keywords            : kbinterop odbc SSrvWinNT<BR>
Version             : 4.21 6.0 6.5 1.02.3731<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
