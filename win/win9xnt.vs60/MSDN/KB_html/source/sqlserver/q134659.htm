

<HTML>
<HEAD>
<TITLE>FIX: Unexpected Behavior During Object Resolution </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134659">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1995/08/08">
<META NAME="Keywords" CONTENT="kbbug6.00 kbfix6.00.sp1 kbusage SSrvProg SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="Bug#: 10252 (6.00)   During object resolution, Microsoft SQL Server version 6.0 may not successfully resolve the dependency, which can cause a thread access violation.  There are several variations of the behavior depending on whether you are using a...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QABM,QAI5,QAW6,QAPN,QBG2,QAXC,QADK,QA5E,QAVX,QAVW,QAUJ,QBW7,QAAP,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Unexpected Behavior During Object Resolution</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134659</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21a and 6.0
</UL> 
Bug#: 10252 (6.00)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
During object resolution, Microsoft SQL Server version 6.0 may not
successfully resolve the dependency, which can cause a thread access
violation.
<P>
There are several variations of the behavior depending on whether you
are using a view or a stored procedure, and, more specifically, user
created objects. User created objects induce errors with stored procedure
resolution.
<P>
There are two basic situations. First, the table is created, a view
or stored procedure is created to reference the table, and then the table
is dropped.
<P>
The second situation is the same as the first, only the table is re-
created. In general, you would expect the first scenario always to error
because the object no longer exists, and the second to resolve the table
change.
<P>
However, the following chart lists the different scenarios that lead
to unsuccessful outcomes. The first scenario is referred to as NOTBL and
the second outcome is referred to as WITHTBL.
<P>
Table created by:  dbo
<PRE>View create by:    dbo
</PRE><h2>Test run by user:  dbo</h2>
 
<P>
NOTBL:
<P>
<PRE>   Version: 6.0
   The first dbo connection that attempts to execute the view receives
   error message(208):

       Invalid object name '%s'.

   The second dbo connection receives a thread access violation and the
   SQL Server hangs, meaning no new connections are accepted by the SQL
   Server until it is stopped and restarted.

   Version: 4.21a
   Continues to receive error message (208):

      Invalid object name '%s'

   and 4413 error messages.

Table created by:   dbo
View create by:     dbo
Test run by user:   test_user
</PRE> 
<P>
NOTBL:
<P>
<PRE>   Version: 6.0
   The first dbo connection that attempts to execute the view receives
   error message (208):

       Invalid object name '%s'.

   The second dbo connection receives a thread access violation and the
   SQL Server hangs, meaning no new connections are accepted by the SQL
   Server until it is stopped and restarted.

   Version: 4.21a
   Continues to receive error message (208):

      Invalid object name '%s'

   and 4413 error messages.

Table created by:   test_user
View create by:     test_user
Test run by user:   test_user
</PRE> 
<P>
NOTBL:
<P>
<PRE>   Version: 6.0
   The first dbo connection that attempts to execute the view receives
   error message (208):

       Invalid object name '%s'.

   The second dbo connection receives a thread access violation and the
   SQL Server hangs, meaning no new connections are accepted by the SQL
   Server until it is stopped and restarted.

   Version: 4.21a
   Continues to receive error message (208):

      Invalid object name '%s'

   and 4413 error messages.

</PRE>Table created by:  test_user
<PRE>View create by:    test_user
</PRE>Test run by user:  dbo
 
<P>
NOTBL:
<P>
<PRE>   Version: 6.0
   The first dbo connection that attempts to execute the view receives
   error message (208):

       Invalid object name '%s'.

   The second dbo connection receives a thread access violation and the
   SQL Server hangs, meaning no new connections are accepted by the SQL
   Server until it is stopped and restarted.

   Version: 4.21a
   Continues to receive error message (208):

      Invalid object name '%s'

   and 4413 error messages.

</PRE>WITHTBL:
<PRE>   Version: 6.0
   The first dbo connection that attempts to execute the view receives
   error message (208):

      Invalid object name '%s'.

   The second dbo connection receives a thread access violation and the
   SQL Server hangs, meaning no new connections are accepted by the SQL
   Server until it is stopped and restarted.

   Version: 4.21a
   Successful resolution

Table created by:    test_user
</PRE>Procedure create by: test_user
<PRE>Test run by user:    dbo
</PRE> 
<P>
WITHTBL:
<PRE>   Version: 6.0
   Continues to generate error message (208):

      Invalid object name '%s'.

   and never resolves the dependency.

   Version: 4.21a
   Successful resolution


</PRE><h2>WORKAROUND</h2>
 
<P>
Drop and recreate the object(s) which rely on the missing or changed
dependency object.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
versions 4.21a and 6.0. This problem was corrected in Service Pack 1 for
SQL Server version 6.0. For more information, contact your primary support
provider.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 trigger res_view Windows NT<BR>
Keywords            : kbbug6.00 kbfix6.00.sp1 kbusage SSrvProg SSrvWinNT<BR>
Version             : 4.21a 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
