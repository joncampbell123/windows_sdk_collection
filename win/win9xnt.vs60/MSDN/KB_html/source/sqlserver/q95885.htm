

<HTML>
<HEAD>
<TITLE>BUG: Ownership Problem Across Databases When SA Is the DBO </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95885 ">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1993/03/01">
<META NAME="Keywords" CONTENT="kbbug4.20 kbbug4.20a kbother SSrvServer SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# OS/2: 1609 (4.2)        NT:   125 (4.2)   Assume database1 and database2 both have SA as DBO, and both have User1 as database users. In database2, the DBO creates a stored procedure, SP1, which depends on a table, TABLE1, in database1 and grants...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAZV,QABI,QBWG,QABH,QAKP,QAB9,QAJQ,QAMJ,QDO3,QAK7,QAGU,QAW6,QAPN,QALZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Ownership Problem Across Databases When SA Is the DBO</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95885 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 4.2a for OS/2
<LI>Microsoft SQL Server, version 4.2
</UL> 
BUG# OS/2: 1609 (4.2)
<PRE>       NT:   125 (4.2)

</PRE><h2>SYMPTOMS</h2>
 
<P>
Assume database1 and database2 both have SA as DBO, and both have
User1 as database users. In database2, the DBO creates a stored
procedure, SP1, which depends on a table, TABLE1, in database1 and
grants the execution permission of stored procedure SP1 to User1.
User1 can run the stored procedure SP1 until TABLE1 in database1
is dropped and recreated. After TABLE1 is dropped and recreated,
when executing SP1, User1 will receive the following error
message:
<P>
<PRE>   Permission denied on object TABLE1, database database1, owner
   dbo (Msg 229, Level 14, State 1).

</PRE>If the DBOs of the two databases are set to someone other than SA,
User1 will be denied permission to access the underlying object
the first time, or any time they try to run the stored procedure;
which is exactly as documented.
<P>
<P><h2>CAUSE</h2>
 
<P>
Page 130 of the "System Administrator's Guide" states: "If the
same user owns a stored procedure and all the views or tables it
references, and if the procedure and the objects it references are
all in the same database, SQL Server checks only the permissions
on the procedure."
<P>
Since there is only one SA server-wide, it is not unusual that SQL
server does not check the permission on the underlying table which
is in another database when SA are the DBOs in both databases.
However, the problem occurs when SQL Server begins to check the
permission on the underlying table when the table is dropped and
recreated although SA is still the DBO in both databases and
the table is still owned by the DBO.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Recreate the stored procedure SP1 and re-grant the permission to
the user in database2 when the table in database1 is dropped and
recreated.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 4.2 and SQL Server version 4.2a for OS/2. We are researching this
problem and will post new information here in the Microsoft Knowledge Base
as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: permission Windows NT<BR>
Keywords            : kbbug4.20 kbbug4.20a kbother SSrvServer SSrvWinNT<BR>
Version             : 4.2 | 4.2<BR>
Platform            : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
