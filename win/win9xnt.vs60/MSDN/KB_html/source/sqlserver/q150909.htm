

<HTML>
<HEAD>
<TITLE>INF: Number of Connections for SQL Server 6.5 Win16 Clients </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150909">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1996/05/13">
<META NAME="Keywords" CONTENT="kbinterop kbusage SSrvDB_Lib SSrvISQL SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When you use 16-bit Windows client tools, such as ISQL/W, with the DB- Library from SQL Server version 6.5 to connect to SQL Server 6.0 or SQL Server 6.5, you might not be able to make as many simultaneous connections to SQL Server as you would hav...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QARL,QAI5,QAJQ,QBG2,QAVZ,QAY2,QAKC,QBC6,QBBI,QDIZ,QAG8,QDL9,QBWQ,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Number of Connections for SQL Server 6.5 Win16 Clients</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150909</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use 16-bit Windows client tools, such as ISQL/W, with the DB-
Library from SQL Server version 6.5 to connect to SQL Server 6.0 or SQL
Server 6.5, you might not be able to make as many simultaneous connections
to SQL Server as you would have if you used the the SQL Server version 6.0
version of the DB-Library. The DB-Library involved is either W3DBLIB.DLL or
MSDBLIB3.DLL.
<P>
The network library used is irrelevant.
<P>
The number of connections is affected by the Network Packet Size
configuration value of SQL Server. The smaller the Network Packet Size
(minimum 512 bytes), the more simultaneous connections you can make from
the same DB-Library client, because the larger the network packet size, the
more system resources are used on the Windows 3.x client.
<P>
When the Windows 3.1x client runs out of system resources, you will get the
following message:
<P>
<PRE>   Msg. No.: 10000 Severity: 8 State: 0
   Error: Unable to allocate sufficient memory
   OS Error: 12 Unable to allocate sufficient memory

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Starting with version 6.5, the 16-bit Windows DB-Library will use the
network packet size configuration specified on the server side under the
following conditions:

<OL><P><LI>The client application using the DB-Library function DBSETLVERSION and
</OL>specified DBVER60 to take advantage of functionality of SQL Server version
6.0 or 6.5.

<OL><P><LI>The client application did not specify the packet size using the
</OL>DBSETLPACKET DB-Library function.
<P>
The ISQL/W client tool, starting from version 6.0, used dbsetlversion to
set the DB-Library client behavior to version 6.0. However, it does not
specify the network packet size to be used on the client. When the tool is
used with 16-bit DB-Library from SQL Server 6.0, the network packet size is
defaulted to 512 bytes, which allows you to make a fair number of
simultaneous connections from the same client. Depending on the particular
configuration of your particular computer, different number of connections
can be made. However, it is not uncommon to make 15 named pipe connections
from the same client.
<P>
Using the ISQL/W and the 16-bit DB-Library from version 6.5, if the Network
Packet Size on the server side is configured to be 512, you should be able
to make the same number of connections from the same client. However, if
the Network Packet Size is set to 4096 bytes (which is the default
configuration value) on the server side, if you were able to make 15 named
pipes connections before when the packet size was 512, you can probably
expect to make only 5 simultaneous named pipe connections with the packet
size set to 4096.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: limitation TDS<BR>
Keywords            : kbinterop kbusage SSrvDB_Lib SSrvISQL SSrvProg<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
