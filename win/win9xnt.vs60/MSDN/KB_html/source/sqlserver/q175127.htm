

<HTML>
<HEAD>
<TITLE>BUG: Character Translation Causes 105, Unclosed Quote Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q175127">
<META NAME="KBModify" CONTENT="1997/12/01">
<META NAME="KBCreate" CONTENT="1997/10/14">
<META NAME="Keywords" CONTENT="kbbug6.50 SSrvGen kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 17353 (sqlbug_65)   When you insert a character through an ODBC data source with either OEM-to- ANSI translation enabled or a code page translation set, some characters are translated to an apostrophe (ANSI 39). When the Generate Stored Proced...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA50,QABM,QAWP,QAHE,QAPN,QAB9,QAKP,QAD7,QBXS,QAOI,QAK6,QAH7,QAH6,QDKW,QAWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Character Translation Causes 105, Unclosed Quote Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q175127</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
BUG #: 17353 (sqlbug_65)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you insert a character through an ODBC data source with either OEM-to-
ANSI translation enabled or a code page translation set, some characters
are translated to an apostrophe (ANSI 39). When the Generate Stored
Procedures option is disabled and a parameter is passed containing these
translated characters, SQL Server returns an error 105:
<P>
<PRE>   Unclosed quote before the character string ')'.

</PRE>NOTE: The apostrophe is also referred to as a single quotation mark or
single quote character.
<P>
<P><h2>CAUSE</h2>
 
<P>
If a single quotation mark is passed in the parameter, this is replaced
by two single quotation marks and the insert executes correctly.
<P>
All of the following conditions must be met:

<UL><LI>The Generate Stored Procedure for Prepared Statement option must be
   disabled for the data source.
<P>
   -and-

<LI>OEM-to-ANSI conversion must be enabled or a code page translator
   selected for the data source.
<P>
   -and-

<LI>The client application prepares the statement with parameter markers.
<P>
   -and-

<LI>One of the parameters contains a string which includes an extended
   character which in the translation enabled for the data source is
   converted to the single quotation mark (ANSI 39).
<P>
</UL>When a Transact-SQL statement is sent to the server, the string type
parameters are delimited by single quotation marks, and the translated
single quotation mark character in the parameter makes the statement
ambiguous.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use any of the following methods to work around the problem:

<UL><LI>Enable Generate Stored Procedure for Prepared Statement. The stored
   procedure is created and the parameters to the stored procedure are
   passed delimited by double quotation marks so that the problem does
   not occur.
<P>
   -or-

<LI>Disable translation if you don't need this feature. The character is
   not translated and will be stored in the server code page as the
   relevant character.
<P>
   -or-

<LI>In the client application, parse the parameters before binding them to
   the prepared statement and make appropriate substitutions for characters
   which are causing the problem. Substituting the single quotation mark
   before binding the parameter works as this will be replaced by two
   single quotation marks before being passed to SQL Server.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.5. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: t-sql tran-sql trans-sql tsql transql transsql<BR>
Keywords          : kbbug6.50 SSrvGen kberrmsg kbusage<BR>
Version           : Windows:6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
