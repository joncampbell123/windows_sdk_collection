

<HTML>
<HEAD>
<TITLE>INF: Search Arguments That Determine Distribution Page Usage </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169642">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1997/06/05">
<META NAME="Keywords" CONTENT="kbusage SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  In determining the existence of useful indexes to resolve a query, SQL Server looks for the search arguments in the query. Search arguments are the arguments in the WHERE clause of a query that help to specify a condition to restrict the result set...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QATJ,QA28,QAPN,QAHE,QANY,QABM,QAKJ,QAH6,QAE1,QBVV,QAYL,QDMN,QADK,QAJQ,QBFM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Search Arguments That Determine Distribution Page Usage</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169642</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
In determining the existence of useful indexes to resolve a query, SQL
Server looks for the search arguments in the query. Search arguments are
the arguments in the WHERE clause of a query that help to specify a
condition to restrict the result set returned by the query. It is necessary
that the arguments in the WHERE clause are of the form "column operator
constant". If indexes exist on these columns, the SQL Server optimizer can
estimate the selectivity of the index and thereby decide whether or not to
use it.
<P>
It is desired that the optimizer estimate search argument selectivity based
on the distribution information available in the distribution page. Other
methods of determining index selectivity for a search argument include
using index densities and magic density. Magic density is an estimate of
the search argument selectivity that can be used when density or statistics
on the distribution page cannot be used. It estimates 10 percent of the
rows match for an equality comparison, 25 percent for a between comparison,
and 33 percent for greater than, less than, greater than or equal to, and
less than or equal to comparisons.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Scoring an index is the process of estimating the usefulness of the index
for the search argument in the WHERE clause. Distribution steps are
maintained only for the first column of the index specified. A valid search
argument is of the form "column operator constant". Any operator that is
valid on the column specified can be used. Invalid search arguments may
prevent the index from being used.
<P>
To allow the optimizer to do index scoring for a search argument based on
the distribution page, the following rules on search arguments may be
helpful:

<OL><P><LI>Avoid inequality operators (as in column != constant).
   This is not a valid search argument, and does not allow the optimizer to
   evaluate the usefulness of the index on this column, if any.

<P><LI>Reduce wherever possible the use of local variables (as in column =
   @local variable), unless the value of the @local variable can be
   determined before run time. This is because the value of the @local
   variable is not known at compile time. This may lead to the optimizer
   using magic densities or index density. When the value is not available,
   it cannot be checked against distribution steps. The local variable will
   be used as a valid search argument if it is passed as a parameter to a
   stored procedure.

<P><LI>Try to avoid performing any operations on the column (as in column*100 =
   constant). This is not treated as a valid search argument. Instead, try
   rewriting the same expression (as in the form column = constant/100).

<P><LI>For subqueries like "...where column operator (select column from
   table)" the optimizer may not be able to use the distribution steps
   because the value of the constant expression is not known until the
   query is executed.

<P><LI>For join clauses, a distribution page cannot be used (unlike for a
   search argument).
<P>
</OL>For more details on writing efficient queries, refer to the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q110352.htm">Q110352</A></B>
   TITLE     : INF: Optimizing Microsoft SQL Server Performance

   ARTICLE-ID: <B><A href="../sqlserver/q46434.htm">Q46434</A></B>
   TITLE     : INF: Writing Efficient Queries and Stored Procedures
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SARG SARGs<BR>
Keywords            : kbusage SSrvGen<BR>
Version             : 6.0 6.5<BR>
Platform            : WINDOWS<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
