

<HTML>
<HEAD>
<TITLE>INF: Extended Procedure Error: "Cannot find the DLL 'xxx.dll'" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q151596">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1996/05/28">
<META NAME="Keywords" CONTENT="kbprg SSrvStProc">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  SQL Server generically returns the error:  Cannot find the DLL 'xxx.dll'  when there is a problem loading the extended stored procedure.  MORE INFORMATION  There are several problems that could actually be encountered. Among these are: DLL not in t...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QAAP,QABI,QAB9,QAY5,QABM,QBVV,QAKP,QDNN,QBV8,QAR4,QAH4,QBHQ,QA4Q,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Extended Procedure Error: "Cannot find the DLL 'xxx.dll'"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q151596</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
SQL Server generically returns the error: "Cannot find the DLL 'xxx.dll'"
when there is a problem loading the extended stored procedure.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are several problems that could actually be encountered. Among these
are: DLL not in the correct path, subsidiary DLLs like MFC40.DLL is not in
the path, function not found, or any other error that would cause the
loading of the extended stored procedure DLL to fail.
<P>
There are a couple techniques that you can use to identify the errors.
First, you need to re-visit the path and make sure the DLL is in the path.
You should also double check the sp_helptext for the procedure to make sure
the name is correct.
<P>
If these efforts still do not identify the problem, you may be able to use
the following code snippet to identify the error. The code loads the
specified library and tries to access the function. If it fails to load, it
will print the associated OS error message.
<P>
<PRE>#include "windows.h"
#include "stdio.h"

//
//    Functions
//
</PRE>typedef int (*fnInternal)(void);
<PRE>void main(int iArgs, char *strArgs[], char *strEnvs[]);
void vUsage(void);


//
//    Main function
//
void main(int iArgs, char *strArgs[], char *strEnvs[])
</PRE>{
<PRE>   HINSTANCE   hLib        =  NULL;
   fnInternal  fCall       =  NULL;
   char     strMsg[1025]   =  "";

   if(iArgs == 3)
   {

      printf("\nAttempting to load %s - %s\n",
               strArgs[1], strArgs[2]);

      if( (hLib = LoadLibrary(strArgs[1])) != NULL)
      {
         fCall = (fnInternal)GetProcAddress(hLib, strArgs[2]);
         if(fCall)
         {
            printf("%s found and loaded successfully.\n",
</PRE>strArgs[2]);
<PRE>         }
         else
            printf("%s not found in %s.\n", strArgs[2],
</PRE>strArgs[1]);
<P>
<PRE>         FreeLibrary(hLib);
      }
      else
      {
         ::FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM,
                     NULL,
                     GetLastError(),
                     GetSystemDefaultLangID(),
                     strMsg,
                     sizeof(strMsg) -1,
                     NULL);

         printf("Error %ld %s\n", GetLastError(), strMsg);
      }

   }
   else
      vUsage();

   printf("\n");
</PRE>}
<P>
<PRE>//
//    vUsage
//
void vUsage(void)
</PRE>{
<P>
<PRE>   printf("\n"
         "Usage: Loadlib.exe libname function\n"
         "\n"
         "Where: libname  = 8.3 name of library\n"
         "       function = name of function in the library\n"
         "\n"
         "Example: loadlib xpstar.dll xp_servicecontrol\n");

}
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: tshoot<BR>
Keywords            : kbprg SSrvStProc<BR>
Version             : 6.0<BR>
Platform            : WINDOWS<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
