

<HTML>
<HEAD>
<TITLE>INF: Tips for Debugging Stored Procedures from Visual Basic 5.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170496">
<META NAME="KBModify" CONTENT="1997/10/30">
<META NAME="KBCreate" CONTENT="1997/06/23">
<META NAME="Keywords" CONTENT="SSrvStProc SSrvTran_SQL kbusage">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  With Visual Basic 5.0 Enterprise Edition, you can debug SQL Server stored procedures. This article contains a list of assorted tips that may help you configure the Visual Basic 5.0 Enterprise Edition Transact-SQL (T-SQL) Debugger.  MORE INFORMATION...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QABM,QBWP,QABI,QAB4,QAI5,QBWS,QAA1,QAGU,QA5F,QAPN,QANN,QAMA,QDI2,QA2K V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Tips for Debugging Stored Procedures from Visual Basic 5.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170496</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 6.5
<LI>Microsoft Open Database Connectivity versions 2.5 and 3.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With Visual Basic 5.0 Enterprise Edition, you can debug SQL Server stored
procedures. This article contains a list of assorted tips that may help you
configure the Visual Basic 5.0 Enterprise Edition Transact-SQL (T-SQL)
Debugger.
<P>
<P><h2>MORE INFORMATION</h2>
 

<UL><LI>You must have the Enterprise Edition of Visual Basic 5.0, not the
   Professional or Standard versions, to debug.

<LI>To have all the correct components, you must have applied Service Pack 1
   for SQL Server 6.5. SQL Server 6.5 Service Pack 2, which includes
   Service Pack 1 for SQL Server 6.5, comes with the Visual Basic 5.0
   Enterprise edition. It is located in the Tools\Tsql\Sql65.sp2
   directory. In the MSDN edition, it is under the Sqlsrvsp\I386 directory
   of the Microsoft Visual Studio 97, Disk Four of the March 1997
   subscription.

<LI>SQL Server must run under a user account. When run under the local
   account, the behavior of the SQL Server may become inconsistent.

<LI>Install the server side components needed for remote automation. These
   components are located in the CliSrv\Tsql\SrvSetup directory of your
   Visual Basic Enterprise Edition CD. On Windows NT 4.0, simply run the
   Sdi_nt4.exe setup program. For a Windows NT Server 3.51 computer, you
   must manually copy and register the necessary files. For complete
   instructions on how to do this, see the Readme.txt file located in the
   CliSrv\Tsql\SrvSetup directory. After this is complete, ensure that the
   Sdi.dll file is located in the same directory as Sqlservr.exe.

<LI>You cannot use the Visual Basic Enterprise edition T-SQL Debugger to
   debug a SQL Server that is using the Sdi50.dll debugging component; the
   correct Sdi.dll components must be installed as noted above. Each DLL
   has a separate interface; hence the unique identifier (UID) used to
   register this DLL is different than the one used by Sdi.dll.

<LI>Ensure that the remote procedure call (RPC) services are started on the
   server computer. You can do this by opening Control Panel, double-
   clicking Services, and checking to make sure the Remote Procedure Call
   (RPC) Service and Remote Procedure Call (RPC) Locator services are
   running and set to start automatically.

<LI>Make sure that Remote Automation is successfully installed on the client
   computers COM (DCOM) installed. This is achieved during installation by
   ensuring that the Remote Automation, Connection Designer, Remote Data
   Objects (RDO), Control, and SQL Debugging are all selected under the
   Enterprise Features.

<LI>If your client computer is running Windows NT 4.0 or later, run DCOMCNFG
   and make sure that everyone has execute and access permission for
   Vbsdicli.exe. If the client computer is running Windows 95, you can
   download this utility from <B><A href="http://www.microsoft.com/oledev/">http://www.microsoft.com/oledev/.</A></B>

<LI>Ensure that the computers can connect to one another and that you have
   permission to use the resources on that Windows NT computer. For
   example, if the network uses TCP/IP, use the PING utility to confirm
   that the client can communicate with the SQL Server. You can also test
   this communication by mapping a drive from the client computer (the one
   that has Visual Basic installed on it) to the SQL Server.

<LI>To enable the use of breakpoints during a debugging session with the
   T-SQL Debugger, use client-side cursors. You can set this option under
   the Miscellaneous tab on the properties of the UserConnection object.

<LI>If the SQL Server service is stopped and restarted while the Automation
   Manager continues running on the same computer, you will see an
   "unexpected error" message in the Windows NT event log on the SQL Server
   the next time the Automation Manager attempts to connect to SQL Server.
   This error message will have a source of MSDEVSDI. If this is the case,
   use Task Manager to stop the Automation Manager (Autmgr32.exe) on the
   SQL Server and let the Sdi.dll and Autprx32.dll load Autmgr32.exe on the
   server through DCOM.

<LI>Ensure that the remote Automation Manager (Autmgr32.exe) is not started
   from the command prompt on the client. Allow the Sdi.dll and
   Autoprx32.dll files to load Autmgr32.exe on the server through COM.

<LI>Extended error information may be contained in the Windows NT event log.
   Specifically, Event ID 7 relates directly to the third and eleventh
   items above.
<P>
<P><PRE>      Event ID #7: An unexpected error (xxxxxxxx) occurred.  Debugging will
      be turned off for connection %. Server execution failed.
</PRE><P>
   The event entries are made under MSDEVSDI.

<LI>It is not recommended that you debug on a production server. Due to the
   added overhead and break-in nature of the debugging product, you may
   adversely affect other users.

<LI>You can add global variables like @@ERROR to the watch window.

<LI>Image datatypes are not a datatype option to pass as a parameter. The
   Unassigned Parameters dialog box is never displayed. The text datatype
   cannot be edited or displayed in the watch window.

<LI>You can use the T-SQL Debugger to debug stored procedures without
   writing code. However, when using the T-SQL Debugger to perform
<PRE>   'run-time debugging' on Visual Basic code, it can be performed on an
   RDO connection only.

</PRE><LI>To configure for run-time debugging, do the following:
<P>
   1. In the Add-In Manager, under the Add-Ins menu, ensure that Visual
<P><PRE>      Basic T-SQL Debugger is available.
</PRE><P>
   2. On the Visual Basic Tools menu, click T-SQL Debugger Options.
<P>
   3. Ensure that the "Automatically step into Stored Procedures through
<P><PRE>      RDO connections" option is enabled.
</PRE>
<LI>To be able to use the T-SQL Debugger, you must use a SQL Server ODBC
   driver version later than 2.65.0203.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: trans-sql tran-sql eventlog<BR>
Keywords          : SSrvStProc SSrvTran_SQL kbusage<BR>
Version           : WINNT: 6.5 2.5 3.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
