

<HTML>
<HEAD>
<TITLE>FIX: AV Selecting from VIEW with DISTINCT and Join </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161726">
<META NAME="KBModify" CONTENT="1997/06/27">
<META NAME="KBCreate" CONTENT="1997/01/03">
<META NAME="Keywords" CONTENT="kbbug6.50.sp1 kbbug6.50.sp2 kbusage SSrvStProc SSrvTran_SQL">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG #: 16361 (Windows NT: 6.5)   You may receive a handled access violation (AV) when you attempt to select from a view that was created with a DISTINCT clause, and there is a natural JOIN between base tables inside a stored procedure.  When the acce...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA2Q,QADK,QDO3,QAY2,QAR4,QAG2,QAPN,QAKH,QDKW,QAB9,QBWS,QBWP,QA5E,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: AV Selecting from VIEW with DISTINCT and Join</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161726</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5 Service Pack 1 and 2
</UL> 
BUG #: 16361 (Windows NT: 6.5)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
You may receive a handled access violation (AV) when you attempt to select
from a view that was created with a DISTINCT clause, and there is a natural
JOIN between base tables inside a stored procedure.
<P>
When the access violation occurs, you may find the following error message
in the SQL Server errorlog:
<P>
<PRE>   spid10   EXCEPTION_ACCESS_VIOLATION raised, attempting to create symptom
   dump kernel   The current contents of process' input buffer are 'exec
   myproc'

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, place the SELECT statement of the stored
procedure inside an EXEC() statement.
<P>
For example, if the SELECT against the view was the following:
<P>
<PRE>   select * from view

</PRE>Change the statement to:
<P>
<PRE>   exec("select * from view")

</PRE>Otherwise, move the query outside of the stored procedure, or avoid using
the DISTINCT keyword in the view definition.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.5 Service Pack 1 and 2. This problem has been corrected in U.S.
Service Pack 3 for Microsoft SQL Server version 6.5. For more information,
contact your primary support provider.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: SP1 SP2<BR>
Keywords            : kbbug6.50.sp1 kbbug6.50.sp2 kbusage SSrvStProc SSrvTran_SQL<BR>
Version             : 6.5 SP1 SP2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
