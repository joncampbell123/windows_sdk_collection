

<HTML>
<HEAD>
<TITLE>INF: How to Debug "Service State Indeterminate" in SEM </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139475">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1995/11/12">
<META NAME="Keywords" CONTENT="kbsetup kbusage SSrvInst">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  After registering a SQL Server successfully to SQL Enterprise Manager (SEM), you may not be able to control the SQL Server service using the service control  stop light  under certain situations. If you click on the  stop light  button on the toolb...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABM,QACK,QA7O,QAOE,QAMN,QAB5,QBVV,QBWD,QDL9,QBWQ,QBWO,QBWN,QAJQ,QAF1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: How to Debug "Service State Indeterminate" in SEM</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139475</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
After registering a SQL Server successfully to SQL Enterprise Manager
(SEM), you may not be able to control the SQL Server service using the
service control "stop light" under certain situations. If you click on the
"stop light" button on the toolbar, the "stop light" dialog box will return
the message "service state indeterminate." In this case, the server status
icon "stop light" will not light, and the SQL Executive icon will not
change color to reflect the status either. Also, you will not be able to
control the services such as starting and pausing the SQL Server from
within the SEM. This article discusses when and why this situation may
occur.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When registering a SQL Server, you are actually performing two tasks:

<OL><P><LI>Connecting to the SQL Server using whatever IPC (Inter-Process
   Communication mechanism) that is configured as the default; and
</OL>2. Polling the status of the SQL Server service to which you are
<PRE>   connecting.

</PRE></OL>If number 1 succeeds, the registration is considered successful; if number
2 fails, the "service state indeterminate" message will appear, or the
"stop light" will not light.
<P>
Microsoft SQL Enterprise Manager (SEM) controls and monitors SQL Server and
SQL Executive status through the Windows NT service control APIs. When you
use the SEM "stop light" to start SQL Server, for example, the SEM will
call the Windows NT service control functions to control the SQL Server
service. If the SQL Server and SEM are on two separate computers, the
service control is carried out through Windows NT Remote Procedure Calls
(RPCs), which locate the SQL Server computer using the name you provide
when registering the SQL Server.
<P>
There are situations when this service control may not work:

<OL><P><LI>Running SEM under Windows 95. Although you can connect to SQL Server
   from SEM running under Windows 95, you can not control (for example,
   start, pause) the service remotely because Windows 95 does not support
   Windows NT service control APIs.

<P><LI>Registering SQL Server using a name different from the Windows NT
   server name. If you define an alias using the Advanced option in SQL
   Client Configuration Utility, you can connect to the SQL Server using
   this alias, but service control will be unavailable because the Windows
   NT service control will try to locate the server using the alias as
   the server name, which does not exist of course. This is true even if
   the SEM and SQL Server reside on the same computer.
<P>
   One common scenario is that you are running both SQL Server 4.21 and
   6.0 on the same machine. Because you can not use the same server name
   to connect to both SQL Servers, one of them must be connected using
   an alias which is different from the Windows NT server name. In this
   case, the SQL Server that is registered using an alias will have the
   service control disabled.

<P><LI>Windows NT service control or RPC not available. If the Windows NT
   service control is not available for some reason, such as permissions
   problems or RPC not available, the service control from SEM will be
   unavailable also. To verify whether you have any problems with the
   Windows NT service control, you can use the Windows NT Server Manager
   to connect to the SQL Server computer, and try to remotely start or stop
   some services such as the SQL Server service. If this attempt fails, it
   indicates you either do not have the permissions, or the Windows NT
   service control is not functioning properly and you should contact your
   primary Windows NT support provider for further help.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: traffic light green red inf icon<BR>
Keywords            : kbsetup kbusage SSrvInst<BR>
Version             : 4.21 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
