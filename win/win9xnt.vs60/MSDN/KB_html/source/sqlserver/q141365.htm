

<HTML>
<HEAD>
<TITLE>FIX: Example for EXEC to Change DB Context in TSQL Ref Invalid </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141365">
<META NAME="KBModify" CONTENT="1997/05/02">
<META NAME="KBCreate" CONTENT="1995/12/17">
<META NAME="Keywords" CONTENT="kbbug6.00 kbfix6.00.sp3 SSrvDoc_Err">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG#: 12488 (6.00 DocErr)   The SQL Server 6.0  Transact-SQL Reference  manual under the section  Using EXECUTE with a Character String  (page177) has an invalid example for using EXEC() to change the database context. This use of EXEC() should not b...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAR4,QAPF,QAZV,QBVV,QAPN,QAC1,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Example for EXEC to Change DB Context in TSQL Ref Invalid</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141365</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
BUG#: 12488 (6.00 DocErr)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SQL Server 6.0 "Transact-SQL Reference" manual under the section "Using
EXECUTE with a Character String" (page177) has an invalid example for using
EXEC() to change the database context. This use of EXEC() should not be
allowed and is considered a bug for SQL 6.0. Future versions of SQL Server
6.0 will revert the database context to its original state after completion
of the EXEC statement. Therefore, any scripts or applications that rely on
the current behavior will not work for future versions of SQL Server.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.0. This problem has been corrected in U.S. Service Pack 3 for
Microsoft SQL Server version 6.0. For more information, contact your
primary support provider.
<P>
MORE INFORMATION
 
<P>
The example as listed in the documentation:
<P>
<PRE>   EXEC('USE pubs')
   EXEC('SELECT * FROM authors')

</PRE>will fail with the following error:
<P>
<PRE>   Msg 208, Level 16, State 1 Invalid object name 'authors'

</PRE>in future versions of SQL Server (assuming a table called authors
does not exist in the current database).
<P>
Any change in database context for EXEC is only valid within that
EXEC statement. Therefore, the following example will work properly
on SQL 6.0 and future versions:
<P>
<PRE>   EXEC ('USE PUBS SELECT * FROM AUTHORS')
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 docs<BR>
Keywords            : kbbug6.00 kbfix6.00.sp3 SSrvDoc_Err<BR>
Version             : 6.0<BR>
Platform            : WINDOWS<BR>
Issue type          : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
