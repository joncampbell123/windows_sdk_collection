

<HTML>
<HEAD>
<TITLE>PRB: LRU List Empty Errors Can Make the Server Stop Responding </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177545">
<META NAME="KBModify" CONTENT="1997/12/03">
<META NAME="KBCreate" CONTENT="1997/12/03">
<META NAME="Keywords" CONTENT="SSrvGen">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="   Pinning  tables or high configuration values for  RA worker threads  can starve SQL Server of free buffers. This can lead to the following error in the errorlog file and eventually cause SQL Server to stop responding:     spid2 Lazywriter: WARNING...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB4,QABM,QAAP,QDIZ,QAIJ,QAGB,QAKD,QABA,QAKP,QBF0,QAML,QAEF,QDKW,QBV8,QBWC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: LRU List Empty Errors Can Make the Server Stop Responding</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177545</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
"Pinning" tables or high configuration values for "RA worker threads" can
starve SQL Server of free buffers. This can lead to the following error in
the errorlog file and eventually cause SQL Server to stop responding:
<P>
<PRE>   spid2 Lazywriter: WARNING, LRU list is empty (1 free bufs, 144 total
   bufs)

</PRE>If you encounter this error, you will have to restart SQL Server to
continue operation. It is very possible that if this error occurs, it will
be repeated in the errorlog every few minutes, and eventually cause the
following error:
<P>
<PRE>   spid2 Lazywriter: WARNING, No free buffers found within the last 5
   minutes.

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem, avoid using high configuration values for "RA
worker threads" and use extreme caution and testing when "pinning" tables.
If you need to use these features but encounter the error, you may be able
to increase the amount of memory reserved for SQL Server.
<P>
If using these options causes continual server problems, you should
consider changing these options to their default values.
<P>
For the "RA worker threads" configuration value, the default is set to 3
upon installation. Use sp_tableoption to "unpin" any tables that are
currently marked as "pinned." Note that when a table is marked as
"unpinned," the pages associated with the table are not immediately flushed
from the cache. They are simply flushed to disk and aged out of the cache
according to normal buffer manager algorithms.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
"Pinning" tables can be achieved by using the DBCC PINTABLE statement or
the "pintable" option of sp_tableoption. As documented, this provides a
method to force pages for a table to remain in cache. However, this also
prevents SQL Server from using the buffers associated with those pages.
Note that the following warning is displayed after using DBCC PINTABLE or
sp_tableoption with "pintable":
<P>
<PRE>   WARNING: Pinning tables should be carefully considered. If a pinned
   table is larger or grows larger than the available data cache, the
   server may need to be restarted and the table unpinned.

</PRE>The Read Ahead Manager in SQL Server grabs 16 free buffers for each Read-
Ahead worker thread as configured by the "RA worker threads configuration
option. If the server has a low amount of memory configured, this could
lead to starvation for free buffers, and the errors and conditions listed
in the SYMPTOMS section of this article. For most systems, the default
setting for "RA Worker Threads" is adequate.
<P>
If you cannot start SQL Server because of this problem, start the server
with the -f command line option and reduce the "RA worker threads"
configuration value.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hang hung freeze frozen lock locked up<BR>
Keywords          : SSrvGen<BR>
Version           : WINNT:6.0 6.5<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
