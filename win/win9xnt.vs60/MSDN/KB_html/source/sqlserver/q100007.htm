

<HTML>
<HEAD>
<TITLE>INF: Tips for Setting Up NIK on Novell NetWare Networks </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100007">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1993/06/14">
<META NAME="Keywords" CONTENT="kb3rdparty kbhw SSrvServer">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The Microsoft SQL Server Network Integration Kit (NIK) for Novell NetWare networks allows NetWare clients to communicate with Microsoft SQL Server and Microsoft Open Data Services using Novell IPX/SPX protocol. The NIK for NetWare provides an alter...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QABM,QBWD,QBVV,QBWO,QAVZ,QAB4,QAA1,QDI2,QAUJ,QAIJ,QAH5,QAY2,QARL,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Tips for Setting Up NIK on Novell NetWare Networks</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100007</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 4.2 for OS/2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft SQL Server Network Integration Kit (NIK) for Novell
NetWare networks allows NetWare clients to communicate with Microsoft
SQL Server and Microsoft Open Data Services using Novell IPX/SPX
protocol. The NIK for NetWare provides an alternative to using Novell
named pipes for communicating over a Novell Network with a SQL Server.
<P>
This article addresses common problems you may encounter when setting
up NIK on NetWare. Please also consult the SQL Server "Installation
Guide" and README.DOC for step-by-step setup instructions and other
known limitations.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you experience any problems when trying to connect to SQL Server
through the NIK from MS-DOS clients, check the following:

<OL><P><LI>If you are using the dedicated IPX, make sure the IPX.COM is
   version 3.10 or later. Use "IPX i" to find out the version.
<P>
   If you are using the ODI driver, make sure the IPXODI.COM is
   version 1.20 or later. Use "IPXODI /?" to find out the version.

<P><LI>Make sure NETX is version 3.26 or later. Use "NETX i" to find out
   the version.

<P><LI>After loading NETX, a message should appear that states this client
   is attached to a file server. If this message does not appear, this
   client is not configured properly or the file server is not available
   and you should contact your network support for assistance. If the
   file server is attached, you can use SQLSCANR.EXE to list the
   available SQL Server names on the network.

<P><LI>If the client is attached to a file server, but SQLSCANR.EXE does
   not list any SQL Server names, you should make sure the NIK (Net
   Manager) is started successfully on the SQL Server side. You may
   verify this by running SQLSCANP.EXE on the OS/2 server where SQL
   Server is running. If you don't see your SQL Server name, NIK is not
   started successfully.

<P><LI>DBMSSPX.EXE must be loaded to connect to SQL Server from any MS-DOS
   client. (DBNMPIPE.EXE is not needed here.)
<P>
</OL>If you can connect to NIK from MS-DOS, but not from Windows, please
check the following:

<OL><P><LI>As in steps 1 and 2 above, check the version numbers. Although the
    earlier versions of IPX and NETX may work from MS-DOS, they may not
    work from Windows.

<P><LI>Make sure you have run W3DBVER.EXE, and choose the Change button to
    change the default net library to SPX/IPX. You can verify this by
    checking the WIN.INI file as in the next step. Please note that you
    must use the W3DBVER.EXE that comes with the NIK because the earlier
    version does not allow you to change the net library.

<P><LI>Make sure the following entry is in the [SQLSERVER] section of the
    WIN.INI file:
<P>
       DSQUERY=DBMSSPX3

<P><LI>If you use SQL Administrator for Windows, make sure there is a file
    named NETAPI.DLL on the path; this file must have a size of 7168
    bytes. You can get this file from the WINDOWS.NP directory of the
    installation disk for version 1.3 of the Novell NetWare Requester.
    Please note this applies only to the Windows version 3.1 client,
    not Windows for Workgroups.

<P><LI>If your SQL Administrator for Windows is dated 2/26/92, make sure
    the server name you specify in SQL Administrator does NOT match any
    entries in the [SQLSERVER] section of the WIN.INI file. This is a known
    problem with this version of SQL Administrator; it is corrected in
    version 4.2a (dated 9-15-92). For example, if the server name you try
    to connect to is MYSQL, and the following entry exists in WIN.INI
<P>
       MYSQL=DBMSSPX3
<P>
       -or-
<P>
       MYSQL=DBNMP3, \\...
<P>
    and you must keep these entries for other applications, you can work
    around this problem by changing the alias (MYSQL in this example) so
    that it is different from the SQL Server name (the service name you
    specify when starting Net Manager). This way, you can connect to NIK
    from SQL Administrator using the SQL Server name as specified when
    starting Net Manager.

<P><LI>Search the hard disk for any older versions of DB-LIBRARY (db-lib)
    file W3DBLIB.DLL. Depending on the applications, you may get different
    error messages if 1.x version of db-lib is used. With Q+E, you may
    receive a "login incorrect" error message, but with SQL Administrator,
    you will receive the error message, "Login failed. Network Manager
    only supports 4.x clients." Please note certain W3DBLIB.DLL files may
    have a date later  than 2/26/92, but they are actually version 1.x.
    Pay special attention to the Excel directory if you are using Q+E.

<P><LI>If you can't connect from ODBC applications such as Access, run
    ODBC Admin again to reconfigure the data source for SQL Server. For
    example, if your SQL Server service name is "MYNIK" as specified when
    starting Net Manager, in the SQL Server Setup dialog box, you should
    have the following:
<P>
       network address: MYNIK
       network library: DBMSSPX3
<P>
    There should not be anything like "\\MYNIK\pipe\sql\query" for the
    network address.

<P><LI>If you can't use SQL Administrator for Windows to view error log,
    schedule backups, or view statistics, this is normal because the
    functions that use SQL Monitor require named pipes support on the
    clients as well.

<P><LI>When using SQL Administrator for Windows or other client
    applications, the server list box will not show the SQL Server names
    running the NIK.
<P>
    This feature is under review and will be considered for inclusion in
    a future release of Microsoft client tools.

<P><LI>Whenever you modify the WIN.INI file, you should restart your
    workstation, although it works without restarting in most cases.

<P><LI>Sometimes, third-party TSRs may cause certain conflicts. To
    isolate this, you may want to streamline the AUTOEXEC.BAT by removing
    all the third-party TSRs that are not needed for IPX/SPX support.

<P><LI>If you experience any EMM386 errors on a Windows for Workgroups
    client, make sure you use the version of EMM386 that comes with the
    Windows for Workgroups.
<P>
</OL>If you can't connect from an OS/2 workstation, please check the
following:

<OL><P><LI>Make sure you have run PDBVER.EXE to change the net library to
   SPX/IPX in OS2.INI file. You can verify this by using INIEDIT.EXE to
   look at the OS2.INI entries. Please note that you must use the
   PDBVER.EXE that comes with the NIK (or later version) as the older
   version does not allow you to change the net library.

<P><LI>Verify your OS/2 workstation is attached to a server when started,
   and SQLSCANP.EXE shows the SQL Server name. If the SQL Server name is
   not listed, either the NIK is not started properly, or this OS/2
   workstation is not setup correctly.
<P>
</OL>If you can't start NIK on the server side successfully, or errors show
up in the error log, please check the following:

<OL><P><LI>Make sure you are not trying to start more than one instances of
   NIK using the same service name. Doing so will cause "Unable to setup
   server side connection" error. Sometimes, it may take a few minutes to
   drop the service name from the bindery after you stop the NIK. If you
   receive the above error message, try a different service name.

<P><LI>Make sure the NetWare file server is available. Unlike named pipes,
   NIK requires the file server to be available in order to register
   service name in the bindery.

<P><LI>If you need to run more than one instances of NIK on the same
   computer, make sure you specify different socket numbers for different
   instances. The socket number must be prefixed with "0x" to designate
   hexadecimal format (for example, 0x843F). Please note socket number
   "0" (choosing a free socket number as documented) does not work.
<P>
   This feature is under review and will be considered for inclusion
   in a future release.

<P><LI>For NIK to listen on a pipe other than the default one, you need to
   specify the -p option in the following format:
<P>
<P><PRE>      -p mypipe\query
</PRE><P>
   instead of
<P>
<P><PRE>      -p mypipe or -p pipe\mypipe\query
</PRE><P>
</OL>The NIK is now supported on OS/2 2.0 platform. It is not supported,
however, on versions of OS/2 earlier than 1.3.
<P>
The NIK is not supported on NetWare 2.x networks. Although we do not
anticipate any problems on NetWare 4.0, it is not an officially
certified platform for the NIK.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dblib third party isv 3rdparty<BR>
Keywords            : kb3rdparty kbhw SSrvServer<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
