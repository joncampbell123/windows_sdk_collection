

<HTML>
<HEAD>
<TITLE>INF: Open Failed on Network Pipe on Connect to SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q41720 ">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1989/02/28">
<META NAME="Keywords" CONTENT="kbother SSrvServer">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The following is a detailed description of diagnostics to do when attempts to connect to SQL Server from an MS-DOS client fail with the message:     Open failed on network pipe.  MORE INFORMATION  If user-level security is active on the OS/2 server...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAVZ,QAI5,QAH4,QA7A,QA69,QAWK,QAAD,QBVV,QAAP,QA5E,QAK7,QAUJ,QANE,QAB4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Open Failed on Network Pipe on Connect to SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q41720 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The following is a detailed description of diagnostics to do when attempts
to connect to SQL Server from an MS-DOS client fail with the message:
<P>
<PRE>   Open failed on network pipe.

</PRE><h2>MORE INFORMATION</h2>
 
<P>
If user-level security is active on the OS/2 server, be sure that NET
LOGON with a valid username AND PASSWORD has been executed before
attempting to connect to SQL Server. Be sure the username has been
granted permission by the LANMAN administrator to use named pipes
(sharename \PIPE).
<P>
If you can connect to SQL Server after issuing NET USE but not before,
NET LOGON is not being executed correctly.
<P>
If NET USE prompts you for a password, you were logged on, but under
an incorrect password. If NET USE prompts for both username and
password, you were not logged on at all.
<P>
Check the NET ADMIN audit trail on the OS/2 server for attempted
security violations. You can use the full-screen NET command to see
what username you are currently logged in as. If the NET command
forces you through a logon sequence, you were not logged on correctly.
<P>
You can use MAKEPIPE and READPIPE to get the error code. For details
on how to use these diagnostic utilities, see the "Microsoft SQL
Server Language Reference Manual" for version 4.2.
<P>
READPIPE error code 53 is the symptom of an incorrect NET LOGON. You
need to be sure the MS-DOS workstation is completely logged on
before attempting to use a named pipe.
<P>
If the username you used in the NET LOGON command does not exist on
the server, or if that username does not have permission to use named
pipes on the server, READPIPE will fail with error code 65. If, on the
other hand, you do a NET LOGON specifying a username that does exist
on the server and that has permission to use named pipes, you will get
an error code 53 if that user has a password and you fail to include
it in the NET LOGON command. This only happens the first time, and
only with a missing password. Once a password is specified, it is
saved.
<P>
If none of this seems to help, you can temporarily disable user-level
security by changing the line "SECURITY=USER" to "SECURITY=SHARE" in
LANMAN.INI.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: LAN Manager LAN Server<BR>
Keywords            : kbother SSrvServer<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
