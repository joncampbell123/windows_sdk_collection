

<HTML>
<HEAD>
<TITLE>BUG: instdist.sql Script Fails From SEM on Alternate Pipe Name </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136800">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1995/09/14">
<META NAME="Keywords" CONTENT="kbbug6.00 kbsetup kbtool SSrvEntMan SSrvInst">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# NT: 11356 (6.00)   When you install the distribution database from the Server menu (choose Replication Configuration, then Install Publishing) in SQL Enterprise Manager (SEM), the INSTDIST.SQL script will fail if SQL Server version 6.0 is config...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QDNQ,QAA1,QDI2,QAUJ,QAH6,QBVV,QAAP,QAB4,QAKP,QABA,QABI,QBWS,QBWD,QAZV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: instdist.sql Script Fails From SEM on Alternate Pipe Name</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136800</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
BUG# NT: 11356 (6.00)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you install the distribution database from the Server menu (choose
Replication Configuration, then Install Publishing) in SQL Enterprise
Manager (SEM), the INSTDIST.SQL script will fail if SQL Server version 6.0
is configured to listen on an alternate named pipe. The following errors
can be found in the INSTDIST.OUT file located in the SQL60\INSTALL
directory.

<UL><LI>If SQL Server version 4.21a is running and installed on the default
   named pipe, the following error is displayed:
<P>
<P><PRE>      Error 911, Attempt to locate entry in Sysdatbases for database
      distribution by name failed- no entry found under that name. Make
      sure that name is entered properly.
</PRE>
<LI>If SQL Server version 4.21a is not running or not installed, the
   following error will be displayed:
<P>
<P><PRE>      DB-Library: Unable to Connect: SQL Server is unavailable or does not
      exist. Specified SQL server not found. Net-Library error 2:
      ConnectionOpen (Createfile()).
</PRE><P>
</UL><h2>CAUSE</h2>
 
<P>
The command used to execute the INSTDIST.SQL script is an xp_cmdshell. The
script is:
<P>
<PRE>   xp_cmdshell C:\sql60\binn\isql /S /Usa /P /ddistribution
   /iC:\sql60\install\instdist.sql /oC:\sql60\install\instdist.out

</PRE>The /S parameter will cause the isql session to try to connect over
the default local pipe. If version 4.21a is up and running on the default
pipe, the instdist script will fail because the distribution database
will not exist. If 4.21a is not running, then the isql script will
not be able to find the default pipe and will give the 'SQL server is
unavailable' error.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Run the xp_cmdshell command from a command line on the distribution
server.  Modify the /S parameter to give the correct server name.
For example:
<P>
<PRE>   isql /S&lt;servername&gt; /Usa /P /ddistribution
   /iC:\sql60\install\instdist.sql  /oC:\sql60\install\instdist.out

</PRE>Edit the following registry key and put the name of the distribution
database, usually 'distribution,' in the DistributionDB value:
<P>
HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Replication
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 6.0. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 prompt<BR>
Keywords            : kbbug6.00 kbsetup kbtool SSrvEntMan SSrvInst<BR>
Version             : 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
