

<HTML>
<HEAD>
<TITLE>INF: ODBC Messages on SQL Server Connections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q143339">
<META NAME="KBModify" CONTENT="1997/03/12">
<META NAME="KBCreate" CONTENT="1996/01/31">
<META NAME="Keywords" CONTENT="ssrvprog">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  A successful connection to Microsoft SQL Server using the Microsoft SQL Server ODBC drivers will always return SQL_SUCCESS_WITH_INFO. If the application then calls SQLError() until it returns SQL_NO_DATA_FOUND there will be at least one 5703 and on...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAEV,QAUD,QA9E,QAZV,QAI5,QAYC,QAU9,QAGI,QBG2,QAH4,QALW,QBBI,QABA,QBVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: ODBC Messages on SQL Server Connections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q143339</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.50.0121 6.00
WINDOWS
kbusage kberrmsg kkprg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
A successful connection to Microsoft SQL Server using the Microsoft SQL
Server ODBC drivers will always return SQL_SUCCESS_WITH_INFO. If the
application then calls SQLError() until it returns SQL_NO_DATA_FOUND there
will be at least one 5703 and one or two 5701 messages.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
SQL Server always issues at least two informational messages on a
successful connection from any ODBC or DB-library client: A 5701 message,
indicating which database on the server the user has been logged into, and
a 5703 message, indicating what language the server is using. SQL Server's
DB-library API and the Microsoft SQL Server ODBC driver always make these
messages available on successful connects in case the application needs to
use this information.
<P>
When an ODBC application calls SQLError() after getting
SQL_SUCCESS_WITH_INFO, it should expect the following messages:

<OL><P><LI>A 5701 message showing SQL Server initially putting the user's context
   into the default database defined at the server for the login ID used in
   the connection.

<P><LI>A 5703 message showing the language being used on the server.

<P><LI>If either the ODBC datasource has a default database specified,
   or the application specified the DATABASE= keyword on
   SQLDriverConnect() or SQLBrowseConnect(), then there will be a
   second 5701 message showing the user's context being switched to
   the database requested.
<P>
</OL>For example, the following shows the messages returned on a successful
connect by the SA login, which has its default database at the server
defined as the master database, to a server running US English using an
ODBC datasource which specifies pubs as the default database.
<P>
<PRE>   Full Connect:
      szSqlState = "01000", *pfNativeError = 5701,
      szErrorMsg="[Microsoft][ODBC SQL Server Driver][SQL Server]
             Changed database context to 'master'."
      szSqlState = "01000", *pfNativeError = 5703,
      szErrorMsg="[Microsoft][ODBC SQL Server Driver][SQL Server]
             Changed language setting to 'us_english'."
      szSqlState = "01000", *pfNativeError = 5701,
      szErrorMsg="[Microsoft][ODBC SQL Server Driver][SQL Server]
             Changed database context to 'pubs'."
   Successfully connected to DSN 'ab60def'.

</PRE></OL>Applications can simply ignore these 5701 and 5703 messages, they are
purely informational. Applications cannot, however, ignore a return of
SQL_SUCCESS_WITH_INFO return code on the SQLConnect(), SQLDriverConnect(),
or SQLBrowseConnect(). This is because messages other than 5701s and 5703s
may be returned that do require action. For example, if a driver connects
to a SQL Server with outdated system stored procedures, the following will
be one of the messages returned through SQLError():
<P>
<PRE>   SqlState:   01000
   pfNative:   0
   szErrorMsg: "[Microsoft][ODBC SQL Server Driver]The ODBC
               catalog stored procedures installed on server
               ab421def are version 02.00.4127; version 06.00.0115
               or later is required to ensure proper operation.
               Please contact your system administrator."

</PRE>Applications need to code their error handling routines for SQL Server
connections to call SQLError() until it returns SQL_NO_DATA_FOUND, and act
on any messages other than the ones that return a pfNative code of 5701 or
5703.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.50.0121 6.00<BR>
KBCategory: kbusage kberrmsg kkprg<BR>
KBSubcategory: ssrvprog<BR>
Keywords            : ssrvprog<BR>
Version             : 2.50.0121 6.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
