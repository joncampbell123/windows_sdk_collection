

<HTML>
<HEAD>
<TITLE>INF: Invoking Stored Procedures from Embedded SQL for COBOL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q66748 ">
<META NAME="KBModify" CONTENT="1997/05/05">
<META NAME="KBCreate" CONTENT="1990/11/07">
<META NAME="Keywords" CONTENT="kbprg SSrvCobol SSrvProg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  The code below demonstrates how you can invoke a stored procedure in Microsoft SQL Server from a Microsoft COBOL program using Embedded SQL for COBOL.  Please note that there are two distinct  execute  statements available in Embedded SQL for COBOL...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAH4,QAY2,QAYL,QAB9,QAY4,QAUD,QAPN,QA5V,QA5C,QA2Q,QAOE,QAML,QAMA,QAL3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Invoking Stored Procedures from Embedded SQL for COBOL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q66748 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft Embedded SQL version 4.2 for COBOL
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The code below demonstrates how you can invoke a stored procedure in
Microsoft SQL Server from a Microsoft COBOL program using Embedded SQL
for COBOL.
<P>
Please note that there are two distinct "execute" statements available
in Embedded SQL for COBOL. The execute statement used below is the
Transact-SQL execute (EXEC), which is used to execute stored
procedures. It is abbreviated to distinguish it from the Embedded SQL
EXECUTE, which is used to execute a prepared statement. See the
"Microsoft Embedded SQL for COBOL Programmer's Reference" for more
information about using prepared statements.
<P>
The DECLARE SECTION is used to declare program variables that the SQL
Server needs to know about. Each EXEC SQL section is a SQL batch that
in this program will be compiled into a stored procedure on the SQL
Server. When sqlcode = 0, this indicates that no errors or warnings
were returned. The SELECT INTO :&lt;program variable&gt; section returns the
results from the SELECT into the program variable. The colon (:) is
used to distinguish program variables from SQL Server variables.
Please note that if more than one row of results is returned, all but
the last row will be discarded. If the result set contains more than
one row of data, you should use a cursor.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Sample Code</h3>
 
<P>
<PRE>    WORKING-STORAGE SECTION.

    EXEC SQL INCLUDE SQLCA END-EXEC

    EXEC SQL BEGIN DECLARE SECTION END-EXEC
    01  added-type  pic x(8).
    EXEC SQL END DECLARE SECTION END-EXEC

    PROCEDURE DIVISION.

    EXEC SQL
      exec master..sp_addtype new_type, int
    END-EXEC
    if sqlcode = 0
      EXEC SQL
        select name
        into :added-type
        from master..systypes
        where name = "new_type"
      END-EXEC
      if sqlcode = 0
        display "'"added-type"' has been added."
        EXEC SQL
          exec master..sp_droptype new_type
        END-EXEC
        if sqlcode not = 0
          perform sql-error
        else
          display "It has now been deleted."
      else
        perform sql-error
      end-if
    else
      perform sql-error
    end-if
    stop run.

    sql-error.
    display "SQL error SQLCODE=" sqlcode.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbprg SSrvCobol SSrvProg<BR>
Version             : 4.2 | 4.2<BR>
Platform            : MS-DOS OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
