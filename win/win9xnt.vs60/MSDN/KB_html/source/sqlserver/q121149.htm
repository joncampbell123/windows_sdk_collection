

<HTML>
<HEAD>
<TITLE>BUG: Remote Setup Removes \sql\binn;\sql\dll From Path </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121149">
<META NAME="KBModify" CONTENT="1997/04/30">
<META NAME="KBCreate" CONTENT="1994/09/27">
<META NAME="Keywords" CONTENT="kbbug4.21 kbsetup SSrvInst SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT=" BUG# NT: 9834 (4.21)   SQL Server may fail to start with the following error displayed in a message box on the server:     SQLSERVR.EXE - Unable to Locate DLL    The dynamic link library opendsnt.dll could not be    found in the specified path c:\wi...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAIJ,QBTX,QAEF,QAA1,QBWP,QAYL,QDIZ,QDIV,QDH6,QANE,QDI2,QBFY,QAY2,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Remote Setup Removes \sql\binn;\sql\dll From Path</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121149</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.21
</PRE> 
<P>
BUG# NT: 9834 (4.21)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
SQL Server may fail to start with the following error displayed in a
message box on the server:
<P>
<PRE>   SQLSERVR.EXE - Unable to Locate DLL
   The dynamic link library opendsnt.dll could not be
   found in the specified path c:\winnt\system32;
   c:\winnt\system;c:\winnt.

</PRE>If you attempt to start SQL Server using the SQL Service Manager, in
addition to the above server-side message, the following message may be
seen on the client (which could be the same physical machine):
<P>
<PRE>   SQL Service Manager
   An error 1053 - (The service did not respond to the
   start or control request in a timely fashion) occurred
   while performing this service operation on the
   SQLServer service.

</PRE><h2>CAUSE</h2>
 
<P>
If using the remote option of SQL Server setup to change configuration
options such as,
<P>
<PRE>   Auto Start Server At Boot Time,

</PRE>setup will incorrectly remove the \sql\binn;\sql\dll path entries from the
server and add them to the path of the client. Following the next reboot of
the server machine (when the registry path entries are re-read), SQL Server
will fail to start.
<P>
You can verify whether SQL Server has failed to start because of missing
path entries by using the Control Panel System applet and inspecting the
System Environment Variables: listbox. You should see in your system path
environment variable something like this:
<P>
<PRE>   %SystemRoot%\system32;%SystemRoot%;C:\SQL\BINN;C:\SQL\DLL

</PRE>If the SQL portions of your path are missing, it could be caused by this
problem.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Below are three different techniques to restore the SQL entries to your
path system environment variable.
<P>
The first technique involves using the RegistryRebuild option of SQL Server
setup to rebuild the pathname entries, as follows:

<OL><P><LI>On the server machine, from an operating system prompt, type:
<P>
   cd \sql\binn
   setup /t RegistryRebuild = ON
<P>
   NOTE: The command must be typed exactly as entered, including spacing
   and capitalization.

<P><LI>Follow the on-screen directions.
<P>
   This procedure is also documented on page 144 of the SQL Server
   "Configuration Guide."
<P>
</OL>The second technique is possible on Microsoft Windows NT version 3.5. This
is not possible on Windows NT version 3.1.
<P>
<PRE>   Use the Control Panel System applet to append the SQL entries to
   the path system environment variable.

   See the printed or on-line documentation for the Control Panel System
   applet for more information.

   Since this problem also causes the path entries that are removed from
   the remote machine to be added to the local machine, a similar
   technique using the Windows NT version 3.5 Control Panel System
   applet can be used to remove these extra entries.

</PRE></OL>The third technique involves using the Registry Editor tool REGEDT32.EXE,
which is in the \winnt\system32 directory, to reenter the SQL pathname
entries manually.
<P>
WARNING: Do not use Regedt32 unless you are familiar with it; a mistake
could render your system inoperable.

<OL><P><LI>From an operating system prompt, type:
<P>
   start regedt32

<P><LI>Navigate to the following key:
<P>
   hkey_local_machine\system\CurrentControlSet\Control
   \Session Manager\Environment

<P><LI>Double-click the Path environment variable to edit it.
<P>
   The existing entry will be highlighted.

<P><LI>Press the "end" key to select the end of line, and type in a semicolon
   followed by the correct path including the drive letter on which SQL
   Server is installed.
<P>
   For example:
<P>
   ;c:\sql\binn;c:\sql\dll

<P><LI>Exit Registry Editor to save.

<P><LI>Reboot the machine.
<P>
</OL>Since this same problem also causes the path entries that are removed from
the remote machine to be added to the local machine, a similar technique
using Registry Editor may be used to delete these extra entries, if
desired.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server version 4.21. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Windows NT setup<BR>
Keywords            : kbbug4.21 kbsetup SSrvInst SSrvWinNT<BR>
Version             : 4.21<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
