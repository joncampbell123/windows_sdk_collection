

<HTML>
<HEAD>
<TITLE>INF: Tips for Debugging Stored Procedures from VC++ </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q156096">
<META NAME="KBModify" CONTENT="1997/04/10">
<META NAME="KBCreate" CONTENT="1996/09/17">
<META NAME="Keywords" CONTENT="kbinterop kbnetwork SSrvStProc">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  With Visual C/C++ 4.2 Enterprise Edition you can debug SQL Server stored procedures and triggers. This article contains a list of 16 assorted tips that may help you in debugging. At the end of the article, there is an excerpt from the Readme.txt fi...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWP,QAY2,QBFY,QBXS,QBG2,QATL,QATK,QAI5,QBVV,QANE,QBJZ,QAB9,QDO3,QBV8 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Tips for Debugging Stored Procedures from VC++</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 10, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q156096</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 6.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
With Visual C/C++ 4.2 Enterprise Edition you can debug SQL Server stored
procedures and triggers. This article contains a list of 16 assorted tips
that may help you in debugging. At the end of the article, there is an
excerpt from the Readme.txt file.
<P>
<P><h2>MORE INFORMATION</h2>
 

<OL><P><LI>Text, numeric, and float data types cannot be edited in a watch
    window.

<P><LI>You must have the Enterprise Edition of Visual C/C++ 4.2, not
    Professional or Standard, to debug.

<P><LI>You must apply Service Pack 4 for Windows NT 3.51 computers.

<P><LI>You must have applied Service Pack 1 for SQL Server 6.5, which shipped
    with the Visual C/C++ Enterprise edition.

<P><LI>SQL Server must run under a user account. When run under the local
    account, the breakpoints are ignored and the query is simply executed.

<P><LI>Extended error information may be contained in the Windows NT
</OL>Eventlog.
<PRE>    Specifically, Event ID 11 relates directly to item 5 above.

       Event ID #11: SQL Server when started as service must not log on as
       System Account. Reset to logon as user account using Control Panel.

    The event entries are made under MSDEVSDI.

</PRE><P><LI>Best performance when debugging is achieved if the SQL Server is
<P><PRE>    running under the same user account with which you are logged on to
</OL></PRE>the
<PRE>    Windows NT computer. A quick way to assure this is to start SQL Server
    in a Windows NT command prompt, as follows:

       ..\MSSQL\BINN\SQLSERVR -c

</PRE><P><LI>It is not recommended you debug on a production server. Due to the
    added overhead and break-in nature of the debugging product you could
    adversely effect other users.

<P><LI>Debugging is only supported on SQL Server version 6.50 or later.

<P><LI>String and text values longer than 255 bytes are shown as NULL in the
    watch window.

<P><LI>Use the right mouse, refresh option to obtain object changes in DDL
    from other clients.

<P><LI>Dump table does not perform the Transact-SQL dump command but performs
    a select * from the selected table. Be careful; many results can be
    written to the output window. For large tables you should use a
    standard SQL Server query window.

<P><LI>If you delete all characters from a string in the watch window, the
    value will show NULL. If the variable does not allow NULL the next
    step operation will reset the value to its previous value.

<P><LI>Only the first 64 bytes of a text column are displayed in the output
    window, even if more data is contained in the actual column.

<P><LI>You can add global variables like @@ERROR to the watch window.

<P><LI>You must use the DBLIBRARY version 6.50.212 or the SQL Server ODBC
    2.50.0212 or later version to be able to step from source code to
    stored procedure code and back.

<P><LI>If installing for VC 4.2 you must apply SQL Server Service Pack #1 to
    get the proper SDI debugging components.  If installing for VC 5.0 you
    should install the "VC++ Enterprise Edition Server Components" from
    install CD #2.
<P>
</OL>For more details be sure to read the Readme.txt file shipped with Visual
C/C++ The following is an important excerpt from the Readme file.

<UL><LI>SQL Server Debugging must be enabled. To enable SQL Server debugging,
   check the SQL Server Debugging check box on the SQL tab of the Options
   dialog box. The Options dialog box is available by choosing the Options
   command on the Tools menu. If using VC++ 5.0 the tab is Data View
   instead of SQL.

<LI>The Remote Connection must be set to Local, not to TCP/IP or to Serial.
   To set the Remote Connection, choose the Remote Connection command on
   the Tools menu.

<LI>The current project must be of type x86 (not Macintosh). To set the
   current project type, choose the Configurations command from the Build
   menu.

<LI>The stored procedure must be stored on SQL Server version 6.5 or
   later.
</UL>display
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: VCEntIss<BR>
Keywords            : kbinterop kbnetwork SSrvStProc<BR>
Version             : 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 10, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
