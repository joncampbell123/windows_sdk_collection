

<HTML>
<HEAD>
<TITLE>INF: Automatic Transaction Log Dumping via Performance Monitor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q110565">
<META NAME="KBModify" CONTENT="1997/04/03">
<META NAME="KBCreate" CONTENT="1994/01/24">
<META NAME="Keywords" CONTENT="kbother SSrvAdmin">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  One of the features of SQL Server for Windows NT is its integration with the Windows NT Performance Monitor. The SQL Server for Windows NT  Configuration Guide  indicates that you can use the  % Full  counter of the SQLServer-Log object to dump or ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QAKJ,QABM,QBWS,QDMH,QAU3,QAMR,QAIJ,QAB4,QBJQ,QAA1,QAY5,QAU5,QDI2,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Automatic Transaction Log Dumping via Performance Monitor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q110565</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2
</PRE> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
One of the features of SQL Server for Windows NT is its integration
with the Windows NT Performance Monitor. The SQL Server for Windows NT
"Configuration Guide" indicates that you can use the "% Full" counter of
the SQLServer-Log object to dump or truncate the transaction log.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Below is an example of how to set up the event.

<OL><P><LI>Set up a text file called DUMP.SQL. This file will contain the
    TRANSACT-SQL commands to dump or truncate the log. For instance:
<P>
       dump tran pubs with truncate_only
       go

<P><LI>Start Window NT's Performance Monitor and add an alert that will
    run the script through ISQL when the log is more than 75% full (or
    whatever threshold you think appropriate.)

<P><LI>Make sure that SQL Server is running.

<P><LI>Start Performance Monitor.

<P><LI>Choose Alert from the View menu.

<P><LI>Click on the + button to add an alert event.

<P><LI>Choose the object SQLServer-Log.

<P><LI>Choose the counter Log Space Used(%).

<P><LI>Choose the instance of the database you wish to monitor--pubs in this
    example.

<P><LI>Click on the Over button of the Alert if dialog, then enter the
    percentage at which you want the log to be truncated in the box to
    the right of this button.  For instance, entering "75" will issue the
    truncate command when the log becomes more than 75% full.

<P><LI>Enter the ISQL command under Run Program on Alert. The command should
    launch your DUMP.SQL file. For example:
<P>
       isql -Sserver -Usa -Ppassword -ic:\sql\dump.sql

<P><LI>Click on the Every Time button so that the log will be truncated
    every time the percentage full exceeds the specified threshold.

<P><LI>Click on OK.
<P>
</OL>NOTE: You can save these settings using the File, Save Alert Settings
dialog so that you do not have to recreate this alert every time you
start Windows NT.
<P>
NOTE: If you are using Integrated Security, Performance Monitor will need
to be started under an administrator account or one that maps to the
database's DBO.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.20 PERFMON Windows NT<BR>
Keywords            : kbother SSrvAdmin<BR>
Version             : 4.2<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
