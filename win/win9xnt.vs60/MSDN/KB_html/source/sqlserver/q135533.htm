

<HTML>
<HEAD>
<TITLE>INF: Differences in SQL Behavior Between ODBC and ISQL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135533">
<META NAME="KBModify" CONTENT="1997/04/08">
<META NAME="KBCreate" CONTENT="1995/08/23">
<META NAME="Keywords" CONTENT="kbinterop kbprg SSrvISQL SSrvPrg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When you use the ODBC drivers that ship with SQL Server version 6.0 or later, SQL commands sometimes may appear to work differently in ODBC clients from how they work in either DBLIB clients or the SQL Server client utilities, such as isql, ISQL/w,...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBXS,QA9E,QAU9,QABB,QAJQ,QBV8,QABA,QAY5,QAHH,QAYV,QAI5,QDIV,QARL,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Differences in SQL Behavior Between ODBC and ISQL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135533</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 6.0 &amp; 6.5
<LI>Microsoft Open Data Base Connectivity, version 2.5
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When you use the ODBC drivers that ship with SQL Server version 6.0 or
later, SQL commands sometimes may appear to work differently in ODBC
clients from how they work in either DBLIB clients or the SQL Server client
utilities, such as isql, ISQL/w, and the Enterprise Manager query analyzer
window. In most cases, these differences are simply due to options set by
the Microsoft ODBC SQL Server using the Transact-SQL SET command, and if
the same options are set in the DBLIB clients they exhibit the same
behavior as the ODBC client.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The ODBC standard is closely matched to the ANSI SQL standard, and ODBC
applications expect the behavior of an ODBC driver to match the standard
behavior. In order to make its behavior conform more closely with that
defined in the ODBC standard, the Microsoft ODBC SQL Server driver version
2.50.0121 always issues the following Transact-SQL SET commands:
<P>
When you connect to SQL Server version 4.21a:
<P>
<PRE>   SET TEXTSIZE 2147483647
   SET ARITHABORT ON

</PRE>When you connect to SQL Server version 6.0:
<P>
<PRE>   SET ANSI_NULL_DFLT_ON ON
   SET TEXTSIZE 2147483647
   SET QUOTED_IDENTIFIER ON
   SET ARITHABORT ON

</PRE>The 2.65.0201 driver which ships with SQL Server 6.5 will set the same
options when connecting to version 4.21a and 6.0 servers. When the
2.65.0201 driver connects to a SQL Server 6.5 server, it will set the
following options:
<P>
<PRE>   SET QUOTED_IDENTIFIER ON
   SET TEXTSIZE 2147483647
   SET ANSI_DEFAULTS ON
   SET CURSOR_CLOSE_ON_COMMIT OFF
   SET IMPLICIT_TRANSACTIONS OFF

</PRE>The Microsoft ODBC SQL Server driver issues these commands itself; the ODBC
application does nothing to request them. Setting these options allows ODBC
applications using the driver to be more portable, because the driver's
behavior then matches that defined by the standard. This is mentioned in
the "What's New" section for the Microsoft ODBC SQL Server driver in the
SQL Server version 6.0 Books Online,and also in the Microsoft SQL Server
driver help file for SQL Server 6.0, DRVSSRVR.HLP.
<P>
ODBC applications should not change these SET options. Not only does the
driver depend on these to comply with the ODBC standard behavior, it also
assumes that these options are set when it generates SQL commands it sends
to the server. For example, the driver may put double quotation marks
around object names in its generated SQL statements to handle objects
created using quoted identifiers, and whose names are only legal if
enclosed in quotation marks. If the application has turned off
QUOTED_IDENTIFIERS, then these generated SQL commands will get syntax
errors from the server.
<P>
Before assuming that there is a true difference in behavior between
the Microsoft ODBC SQL Server driver and DBLIB applications, you should run
the DBLIB test with the same SET options as you use with the ODBC driver.
<P>
The 2.65.0240 driver that ships with SQL Server 6.5 Service Pack 2 gives
users greater control over what specific ANSI options are set by the
driver. When a user defines a data source using the 2.65.0240 driver, there
is a check box for turning on or off the setting of QUOTED_IDENTIFIERS, and
another for turning on or off ANSI_NULLS, ANSI_PADDING, and ANSI_WARNINGS.
Users can also set these options on or off when creating a data source
through SQLConfigDataSource. In addition, the 2.65.0240 driver supports
driver specific connection options to control these at connect time. See
the SQL Server 6.5 Service Pack 2 Readme.txt for more details.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6<BR>
Keywords            : kbinterop kbprg SSrvISQL SSrvPrg<BR>
Version             : 2.50.0121 6.0 6.5<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
