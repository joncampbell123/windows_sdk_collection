

<HTML>
<HEAD>
<TITLE>BUG: sp_helprotect Output Incorrect for Some Columns </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88088 ">
<META NAME="KBModify" CONTENT="1997/04/28">
<META NAME="KBCreate" CONTENT="1992/08/17">
<META NAME="Keywords" CONTENT="kbbug4.20 kbprg SSrvTrans">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# OS/2: 1406 (4.2)   When  sp_helprotect          is issued on a table in Microsoft SQL Server version 4.2 for OS/2, the output contains duplicate rows for every column in the table.  CAUSE =====  When granting and/or revoking permissions on indiv...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAC1,QBD2,QAA5,QABM,QA0K,QDIX,QA4Q,QAVX,QAVW,QAS1,QAE1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: sp_helprotect Output Incorrect for Some Columns</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88088 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server version 4.2 for OS/2
</UL> 
BUG# OS/2: 1406 (4.2)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When "sp_helprotect &lt;table&gt;" is issued on a table in Microsoft
SQL Server version 4.2 for OS/2, the output contains duplicate
rows for every column in the table.
<P>
<P><h2>CAUSE</h2>
 
<P>
When granting and/or revoking permissions on individual columns of
a table, sp_helprotect might generate duplicate rows for every column
in the table which makes it hard to see which permissions you do or
do not have.
<P>
The following example illustrates this:
<P>
<PRE>   CREATE TABLE test (
   col1 int, col2 int, col3 int, col4 int, col5 int,
   col6 int, col7 int, col8 int, col9 int, col10 int)
   go

   GRANT SELECT ON test TO public
   go
   GRANT UPDATE ON test TO public
   go
   REVOKE UPDATE ON test (col5) FROM public
   go

   sp_helprotect test
   go

</PRE>Issuing the above script in SQL Server 4.2 gives the following
output from sp_helprotect:
<P>
<PRE>       Type    Action      User       Column
       ----    ------      ----       ------

       Grant   Select      public     All
       Grant   Update      public     col1
       Grant   Update      public     col1
       Grant   Update      public     col10
       Grant   Update      public     col10
       Grant   Update      public     col2
       Grant   Update      public     col2
       Grant   Update      public     col3
       Grant   Update      public     col3
       Grant   Update      public     col4
       Grant   Update      public     col4
       Grant   Update      public     col5
       Grant   Update      public     col6
       Grant   Update      public     col6
       Grant   Update      public     col7
       Grant   Update      public     col7
       Grant   Update      public     col8
       Grant   Update      public     col8
       Grant   Update      public     col9
       Grant   Update      public     col9
       Revoke  Update      public     col5

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server version 4.2 for
OS/2. We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords            : kbbug4.20 kbprg SSrvTrans<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
