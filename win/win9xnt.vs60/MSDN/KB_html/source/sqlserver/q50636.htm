

<HTML>
<HEAD>
<TITLE>INF: Using BCP &amp; .FMT File to Read in Only Specified Columns </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q50636 ">
<META NAME="KBModify" CONTENT="1997/03/12">
<META NAME="KBCreate" CONTENT="1989/11/03">
<META NAME="Keywords" CONTENT="SSrvBCP SSrvWinNT">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT=" You can read in only specified columns by using BCP and making modifications to the format file with some restrictions. You can modify the .FMT file to enable a bulk copy of data from only specific columns. The remaining columns will be filled with ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAE1,QBBI,QDMN,QALQ,QDNG,QBFN,QBSO,QAA1,QBXT,QA5V,QAPF,QAML,QAIB,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Using BCP &amp; .FMT File to Read in Only Specified Columns</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q50636 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server for OS/2 version 4.2
  - Microsoft SQL Server version 4.2
</PRE> 
<P>
You can read in only specified columns by using BCP and making
modifications to the format file with some restrictions. You can modify
the .FMT file to enable a bulk copy of data from only specific columns.
The remaining columns will be filled with NULLS and the column format
must be set up to allow NULLs when the table is created.
<P>
To do this, do the following:

<OL><P><LI>Use BCP to create the output data file and the format file.

<P><LI>Load the format file into a text editor.
<P>
</OL>For example, if your table consists of four tables of simple integer data
with column names of a, b, c, and d, you will see a format file that looks
similar to the following (if you are using SQL Server version 4.2,
substitute 4.2 for 4.0 in the first line of this example):
<P>
<PRE>    4.0
    4
    1          SYBINT4 0       4       ""     1      a
    2          SYBINT4 0       4       ""     2      b
    3          SYBINT4 0       4       ""     3      c
    4          SYBINT4 0       4       ""     4      d

</PRE></OL>To modify this file to read in only the first and last columns of data,
you need to change the file to the following (if you are using Microsoft
SQL Server version 4.2, substitute 4.2 for 4.0 in the first line of this
example):
<P>
<PRE>    4.0
    2
    1          SYBINT4 0       4       ""     1      a
    2          SYBINT4 0       4       ""     4      d

</PRE>The important changes are made on the second line, which specifies the
number of descriptors to follow, and the column specifiers, which are the
numbers 1 and 4 in the next-to-last column. The actual names of the
columns(a,d) are not important to the process.
<P>
Once the .FMT file has been modified and saved, perform a BCP call that
reads back into the database (or a different or newly created database),
specifying this format file with the -f option.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.20 Windows NT<BR>
Keywords            : SSrvBCP SSrvWinNT<BR>
Version             : 4.20<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
