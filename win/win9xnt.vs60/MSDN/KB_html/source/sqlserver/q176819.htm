

<HTML>
<HEAD>
<TITLE>PRB: SQL Directory Is Not in the Service Path Until a Restart </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q176819">
<META NAME="KBModify" CONTENT="1997/11/17">
<META NAME="KBCreate" CONTENT="1997/11/17">
<META NAME="Keywords" CONTENT="SSrvAdmin SSrvInst kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  After performing a new installation of SQL Server or an upgrade that moves files to a new directory, attempts to perform operations within SQL Server that depend on the SQL Server program directory being in the path will fail until Windows NT is re...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWP,QABM,QANE,QAFI,QBXB,QATJ,QAIJ,QBVV,QAH4,QACK,QAA1,QACF,QBWS,QDIR,QDL9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: SQL Directory Is Not in the Service Path Until a Restart</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q176819</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server versions 6.0 and 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
After performing a new installation of SQL Server or an upgrade that moves
files to a new directory, attempts to perform operations within SQL Server
that depend on the SQL Server program directory being in the path will fail
until Windows NT is restarted. After Windows NT is restarted, the SQL
Server directory will appear in the path.
<P>
The following is an example operation that may show this problem:
<P>
<PRE>   xp_cmdshell 'bcp pubs.dbo.authors out authors.dat -T -c'

</PRE>In this example, the bulk copy program (bcp) utility, Bcp.exe, would
normally be located in the Mssql\Binn directory, which is added to the path
during the setup process. However, because this change to the path does not
take effect until after Windows NT is restarted, the operation fails with
the following message:
<P>
<PRE>   The name specified is not recognized as an internal or external command,
   operable program or batch file.

</PRE><h2>WORKAROUND</h2>
 
<P>
To work around this problem until Windows NT is restarted, start SQL Server
outside of the Service Control Manager in a new command prompt window, by
using the "-c" parameter.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you include a directory in the path, you can run a utility, such as
Bcp.exe, without being located in that directory at the command prompt. The
operating system searches all directories in the path to find the program.
If the operating system cannot find the program, the operation fails and
you receive the error message.
<P>
During the setup process, the SQL Server program directory is added to the
PATH system environment variable, and a message is broadcast to all top-
level windows indicating that the path has changed. Because all SQL Server
program files are located in the SQL Server directory and do not depend on
the PATH environment variable, a user can connect to and run most queries
without any problem. However, extended stored procedures, which may perform
functions that depend on the path, may fail as described above.
<P>
Because the Windows NT Service Control Manager (Services.exe) does not have
a window, it does not receive the message broadcast by setup; it only
becomes aware of the path change when it is restarted by Windows NT. The
SQL Server service process inherits the environment of the spawning process
(Service Control Manager), and thus also does not reflect the inclusion of
the SQL Server directory in the path until that time.
<P>
Also note that any command prompt windows opened before setup starts will
also fail to reflect the path change, but any new command prompt windows
will.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: path environment message reboot rebooted<BR>
Keywords          : SSrvAdmin SSrvInst kbsetup<BR>
Version           : WINNT:6.0 6.5<BR>
Platform          : winnt<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
