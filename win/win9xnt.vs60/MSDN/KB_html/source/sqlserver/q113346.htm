

<HTML>
<HEAD>
<TITLE>BUG: Stored Procedure with SELECT INTO May Fail with Error 207 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113346">
<META NAME="KBModify" CONTENT="1997/04/29">
<META NAME="KBCreate" CONTENT="1994/03/31">
<META NAME="Keywords" CONTENT="kbbug4.20 kbprg SSrvGen SSrvServer">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="BUG# OS/2: 1829 (4.2)   Execution of a stored procedure which creates some temporary tables using SELECT INTO and references a column in one of the newly created temporary tables may fail with an error message 207:     Invalid column Name  NOTE: The ...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAY4,QA2Q,QAB4,QAG2,QAB9,QBWS,QAY2,QABM,QBF0,QAKP,QAAP,QAUJ,QAPF,QAE1,QBPM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Stored Procedure with SELECT INTO May Fail with Error 207</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113346</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:
<P>
<PRE>  - Microsoft SQL Server version 4.2 for OS/2
</PRE> 
BUG# OS/2: 1829 (4.2)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Execution of a stored procedure which creates some temporary tables using
SELECT INTO and references a column in one of the newly created temporary
tables may fail with an error message 207:
<P>
<PRE>   Invalid column Name

</PRE>NOTE: The conditions under which the above error occurs is described in the
More Information section at the end of this article.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Break the SELECT INTO statement into two statements: a
CREATE TABLE and a INSERT INTO:
<P>
Example:
<P>
<PRE>   select 'NEW_COLUMN'=COL1
       into #temp2
       from #temp1

</PRE>can be broken into
<P>
<PRE>   create table #temp2 (NEW_COLUMN float)
   insert into #temp2 select COL1 from #temp1

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server version 4.2 for
OS/2. We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following are the condition that will produce the error:
<P>
For example:
<P>
<PRE>   create procedure PROC1
       as
       select *
       into #temp1
       FROM MYTABLE
       select 'NEW_COLUMN' = COL1
       into #temp2
       from #temp1
       select NEW_COLUMN from #temp2

</PRE>The above stored procedure may sometimes fails with the error message:
<P>
<PRE>   Msg 207, Level 16, State 2:
   Invalid column name 'NEW_COLUMN'

</PRE>when the following conditions are satisfied:

<OL><P><LI>The stored procedure should select into a temporary table(#temp1)
   from a real table. From this temporary table (#temp1), it should select
   into another temporary table(#temp2) and in the process name a column
   ('NEW_COLUMN'=COL1). It should reference this named column (NEW_COLUMN).

<P><LI>The server must be case sensitive (For example: code page 850, binary
   sort order).

<P><LI>The sever must be restarted after the creation of the stored
   procedure and before the execution of this (PROC1) stored procedure.

<P><LI>A stored procedure which creates some temporary table(s)
   (for example: sp_MSbackup_now) should be executed before the
   execution of this (PROC1) stored procedure.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: temp<BR>
Keywords            : kbbug4.20 kbprg SSrvGen SSrvServer<BR>
Version             : 4.2<BR>
Platform            : OS/2<BR>
Issue type          : kberrmsg<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
