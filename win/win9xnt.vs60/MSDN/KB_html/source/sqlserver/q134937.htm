

<HTML>
<HEAD>
<TITLE>INF: Running SQL Versions 6.0 and 4.21 Side by Side </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134937">
<META NAME="KBModify" CONTENT="1997/04/15">
<META NAME="KBCreate" CONTENT="1995/08/14">
<META NAME="Keywords" CONTENT="kbenv kbusage SSrvInst SSrvISQL SSrvTran">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  This article describes several items and potential issues to consider when you run Microsoft SQL Server versions 6.0 and 4.21 simultaneously on the same server.  For additional information on this topic, please see the following article in the Micr...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QBWD,QBWP,QDIZ,QAUJ,QAI5,QAM4,QBG2,QARL,QAMN,QAAW,QABA,QAJQ,QBVX,QAMO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Running SQL Versions 6.0 and 4.21 Side by Side</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134937</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21a and 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes several items and potential issues to consider when
you run Microsoft SQL Server versions 6.0 and 4.21 simultaneously on the
same server.
<P>
For additional information on this topic, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../sqlserver/q137406.htm">Q137406</A></B>
   TITLE     : INF: How To Setup an Alternate Console Pipe

</PRE><h2>MORE INFORMATION</h2>
 

<OL><P><LI>One server version must use an alternate pipe name. Before you choose on
   which version to change the default pipe, you may want to consider if
   you will be using Windows NT Performance Monitor, because it only
   listens on the default pipe.
<P>
   The default pipe for both versions of SQL Server is
   \\.\PIPE\SQL\QUERY. Both versions of SQL Server cannot use the default
   pipe name to accept connections. In this pipe name configuration, one of
   the server versions must change the "\SQL\" portion to another name,
   such as \SQL421A\ or \SQL60\. This same concept applies to port numbers
   for TCP\IP socket connections and service names for NWLink connections.
   If both servers need to listen for TCP\IP socket connections, then
   they must be setup to use different port numbers.
<P>
   To change the named pipe for SQL Server version 4.2x, you need to edit
   the following key in the Windows NT registry using the NT Registry
   Editor (REGEDT32.EXE):
<P>
<P><PRE>      HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\SQLServer\Server
</PRE><P>
   Change the ListenOn value from the default to something like
   \\.\PIPE\SQL42\QUERY. You should always make a backup of the NT registry
   before making any direct modifications using the NT Registry Editor.
<P>
   To change the default pipe for SQL Server version 6.0, select the
   Change Network Support Option using the SQL Server Setup program. For
   TCP\IP and NWLink configurations, the SQL Server Setup program
   can be used for both versions 4.21a and 6.0. If you are running SQL
   Server using Windows NT integrated security mode, you cannot change
   the network support options. If you need to make changes, you must first
   reset security mode to standard or mixed.
<P>
   NOTE: Certain SQL tools such as SQL Enterprise Manager, SQL
   Executive, and SQL Monitor connect by default to SQL Server's
   default pipe and are changeable. Only SQL Performance Monitor is not
   changeable.

<P><LI>If the version 6.0 SQL\DLL directory appears before the 4.2x SQL\DLL
   directory in the path, client programs such as ISQL/w will use the
   6.0 version of DB-Library (NTWDBLIB.DLL).
<P>
   When you try to connect to SQL Server listening on an alternate pipe
   with the 6.0 version of DB-Library, the advanced configuration entry
   must have been made with the 6.0 version of Client Configuration
   Utility. If the 4.21 version of DB-Library is used, the advanced
   configuration entries must be made with the 4.21 version of the Client
   Configuration Utility.

<P><LI>You must add client configuration entries to register a server with SQL
   Enterprise Manager when the server is configured to listen on an
   alternate pipe.
<P>
   If version 6.0 is configured to listen on an alternate pipe, then an
   entry in the Advanced section of the Client Configuration Utility must
   be created.
<P>
   One method is to create an entry for the version 6.0 server using the
   NT computer name of the server as the registered SQL server name. In
   this situation, you need to create another entry for the 4.21a server
   using an alternate server name. This way, both servers can be registered
   with SQL Enterprise Manager.
<P>
   The following are example Advanced entries (using the NT computer name
   of the server as 'treasure'):
<P>
   6.0 :  SERVER : treasure; DLL : dbnmpntw; CONNECTION STRING :
   \.\PIPE\SQL60\QUERY
<P>
   4.21a: SERVER: treasure_421a;  DLL: dbnmpntw; CONNECTION STRING:
   \.\PIPE\SQL\QUERY
<P>
   NOTE: If a server is registered with SQL Enterprise Manager that is not
   a valid NT computer name, you will not be able to control the services
   of that server with SQL Enterprise Manager. Furthermore, if you use an
   alternate name for a local server that matches the NT computer name of
   another SQL server on your network, SQL Enterprise Manager will try to
   control the remote service while connecting to the local server.

<P><LI>If the alternate pipe is set for version 6.0, you need to configure SQL
   Executive to connect to SQL Server using a specific server name. First,
   create a specific server connection entry using the Advanced tab of the
   SQL Client Configuration Utility. Configure this server entry to connect
   to the local server using the appropriate Net-Library and connection
   string. Then set the ServerHost value in the SQL Executive section of
   the Windows NT Registry to the name the name used for the advanced
   connection above. Here is the location of the ServerHost value:
<P>
<P><PRE>     HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\MSSQLServer\SQLExecutive
</PRE>
<P><LI>If the alternate pipe is set for version 4.2x, you need to configure SQL
   Monitor to connect to SQL Server using a specific server name. First,
   create a specific server connection entry using the Advanced tab of the
   SQL Client Configuration Utility. Configure this server entry to connect
   to the local server using the appropriate Net-Library and connection
   string. Then set the Server value in the SQL Monitor section of the
   Windows NT Registry to the name the name used for the advanced
   connection above. Here is the location of the Server value:
<P>
<P><PRE>     HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\SQLServer\SQLMonitor
</PRE>
<P><LI>Client applications may require additional configuration. For DB-Library
   or ODBC clients using the named pipe network library, an additional
   advanced client configuration entry may be needed similar to step 2. If
   the client does not create an advanced entry and connects to a server
   name that matches the NT computer name, it will connect to the server
   version that is listening on the default named pipe.

<P><LI>Transfer Manager requires a change to the server name if you transfer
   databases between server versions on the same server. If you need to
   transfer data between the two SQL Server versions on the same server or
   perform remote stored procedure calls between them, you have to change
   the local SQL server name for one of the server versions. This can be
   done using the stored procedure sp_addserver.
<P>
   For example, to change the name of the SQL Server version 4.21a, run:
<P>
<P><PRE>      sp_addserver treasure_421a, local
</PRE><P>
   This changes the server name in the master.dbo.sysservers table and sets
   the @@servername global variable.
<P>
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 side by side concurrent<BR>
installations<BR>
Keywords            : kbenv kbusage SSrvInst SSrvISQL SSrvTran<BR>
Version             : 4.2 4.21a 6.0<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
