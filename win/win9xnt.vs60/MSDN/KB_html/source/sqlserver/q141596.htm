

<HTML>
<HEAD>
<TITLE>PRB: 16-bit Installer May Create Bad ODBCINST.INI &amp; ODBC.INI </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141596">
<META NAME="KBModify" CONTENT="1997/12/08">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="odbc kbprg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="  When a 16-bit Installer, that is, ODBCINST.DLL, is used to install 16-bit drivers on a Windows NT computer without any ODBC components, SQLInstallODBC will fail and a bad ODBCINST.INI file will be created.  If the ODBC.INF file contains data source...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QA0B,QAMB,QAK6,QBJZ,QA1S,QBWP,QBVV,QAY2,QAYY,QAU9,QAML,QAB4,QBXH,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: 16-bit Installer May Create Bad ODBCINST.INI &amp; ODBC.INI</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141596</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Open Data Base Connectivity, version 2.10
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a 16-bit Installer, that is, ODBCINST.DLL, is used to install 16-bit
drivers on a Windows NT computer without any ODBC components,
SQLInstallODBC will fail and a bad ODBCINST.INI file will be created.
<P>
If the ODBC.INF file contains data source information, SQLInstallODBC
fails with one more bad ODBC.INI file.
<P>
If SQLConfigDataSource is called after SQLInstallODBC, instead of
specifying data source information in the ODBC.INF,
SQLConfigDataSource will fail with the same result.
<P>
One symptom is that, after the installation, driver information will not
be available when you click "About," and no data source is listed in the
data source window in the 16-bit ODBC Administrator.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
1) Manually modify the ODBC.INI and ODBCINST.INI files after the
<PRE>   installation.

</PRE>-OR-
<P>
2) Use a resource editor to modify the comment lines in the ODBCINST.DLL
<PRE>   file directly.

</PRE>If you have Visual C++ version 1.5x, follow the instructions below for
modifying ODBCINST.DLL:

<OL><P><LI>Launch App Studio.
</OL>2. From the File menu, click Open ODBCINST.DLL.
3. Double-click "String Table" in the Type window.
4. Double-click "String Segment:144" in the Resource window.
5. Locate ";WARNING: Do not make changes to this file without using the
<PRE>   ODBC.." comment line;
</PRE></OL>6. Modify the last comment line from
<PRE>   ";--------------------------------------------"
   to:
   ";------------------------------------------\r\n"
</PRE>7. From the File menu, click Save.
<P>
You will now get a correct version of ODBCINST.DLL.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following are examples of bad ODBCINST.INI and ODBC.INI files. You can
see that newline characters are missing from the last comment line:
<P>
++++++++++++ Beginning of ODBCINST.INI +++++++++++++++++++++
;-------------------------------------------------------------------------
<P>
; WARNING:Do not make changes to this file without using the ODBC Control
<PRE>;         panel device or other utilities provided for maintaining data
;         sources.
;
;         Incorrect changes to this file could prevent ODBC from
;         operating or operating correctly.
</PRE>;-------------------------------------------------------------------------
[Microsoft Access Driver (*.mdb)]
<P>
Driver=C:\WINNT35\SYSTEM\odbcjt16.dll
Setup=C:\WINNT35\SYSTEM\odbcjt16.dll
SQLLevel=0
FileExtns=*.mdb
FileUsage=2
DriverODBCVer=02.01
ConnectFunctions=YYN
APILevel=1
.
.
.
++++++++++++ End of ODBCINST.INI +++++++++++++++++++++
<P>
<P>
++++++++++++ Beginning of ODBC.INI +++++++++++++++++++++
;-------------------------------------------------------------------------
; WARNING:Do not make changes to this file without using the ODBC Control
<PRE>;         panel device or other utilities provided for maintaining data
;         sources.
;
;         Incorrect changes to this file could prevent ODBC from
;         operating or operating correctly.
</PRE>;-------------------------------------------------------------------------
[ODBC Data Sources]
<P>
MyAccess=Microsoft Access Driver (*.mdb)
[MyAccess]
Driver=C:\WINNT35\SYSTEM\odbcjt16.dll
DriverId=25
FIL=MS Access;
JetIniPath=odbcddp.ini
UID=admin
++++++++++++ End of ODBC.INI +++++++++++++++++++++
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: odbc vc SQLInstallODBC<BR>
SQLConfigDataSource<BR>
Keywords          : odbc kbprg<BR>
Version           : 2.0  2.1<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
