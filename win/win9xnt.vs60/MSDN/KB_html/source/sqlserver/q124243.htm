

<HTML>
<HEAD>
<TITLE>INF: Emulating the iif() Function in Transact-SQL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124243">
<META NAME="KBModify" CONTENT="1997/10/09">
<META NAME="KBCreate" CONTENT="1994/12/22">
<META NAME="Keywords" CONTENT="SSrvProg SSrvTran_SQL kbprg">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT="   Microsoft SQL Server version 6.5 supports the powerful ANSI SQL-92 CASE expression which allows SQL expressions to be simplified for conditional values. For more information on how to use the CASE command, see the Microsoft Books OnLine for SQL Se...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAB9,QA2Q,QAH6,QAY2,QAPN,QAH7,QAGX,QAD7,QAJQ,QAG2,QAUJ,QAKD,QDMW,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Emulating the iif() Function in Transact-SQL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124243</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



<P><h3> </h3>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, version 4.2 and 6.0
<LI>Microsoft SQL Server, version 4.2 for OS/2
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft SQL Server version 6.5 supports the powerful ANSI SQL-92
CASE expression which allows SQL expressions to be simplified for
conditional values. For more information on how to use the CASE command,
see the Microsoft Books OnLine for SQL Server version 6.5.
<P>
Prior to SQL Server version 6.5, the Transact-SQL language did not have
an equivalent to CASE or the function iif() (sometimes called Immediate If
or Inline If) that is available in other programming languages, including
Microsoft Access and Microsoft FoxPro. This article provides information
on how to produce similar results using the Transact-SQL features
available in versions of SQL Server prior to version 6.5.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Some SQL implementations allow statements like the following:
<P>
<PRE>   select name, iif( score &gt; 80, "Pass", "Fail" ) from exams

</PRE>The iif() expression evaluates to its second argument if its first argument
is true, otherwise, to its third argument. Porting code like this to
Transact-SQL can be accomplished in several ways:

<OL><P><LI>In SQL Server version 6.0, a CASE expression can be used wherever
   an expression can be used. The statement above could be
   written in SQL Server version 6.0 as:
<P>
<P><PRE>      select name,
<PRE></PRE>        case
          when score &gt; 80 then "Pass"
          else "Fail"
        end
      from exams

   See the Microsoft SQL Server Books Online and the "Transact-SQL
   Reference" manual for more examples of using the new CASE expression of
   version 6.0.

</PRE><P><LI>Build the iif() logic into the front-end application using
   Transact-SQL queries to return only the raw column data.

<P><LI>Use a JOIN to a lookup table. This works best if the columns
   included in the first argument of the iif() take on only a few
   values. For the example above, you could construct a grading table:
<P>
<PRE>   score      grade
   -----      -----
   1          'Fail'
   2          'Fail'
   3          'Fail'
   ...
   99         'Pass'
   100        'Pass'

</PRE></OL>Then the following query would be equivalent to the example:
<P>
<PRE>   select exams.name, grading.grade from exams, grading

   where exams.score = grading.score

</PRE><P><LI>Use two SELECTs. Each returns as a constant one of the possible values
   of the iif() expression:
<P>
   select name, 'Fail' from exams where score &lt;= 80
   union all
   select name, 'Pass' from exams where score &gt; 80

<P><LI>Use the ABS, SIGN, and SUBSTRING functions. For example:
<P>
   select
<P><PRE>     name,
     SUBSTRING('FailPass', 1 + 4 * SIGN((score - 80) + ABS(score - 80)), 4)
     from exams
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sql6 Windows NT<BR>
Keywords          : SSrvProg SSrvTran_SQL kbprg<BR>
Version           : 4.2 | 4.2 6.0<BR>
Platform          : OS/2 WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
