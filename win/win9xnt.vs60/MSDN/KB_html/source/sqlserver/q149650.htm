

<HTML>
<HEAD>
<TITLE>BUG: Upgrade Fails if Not Enough Space on Master for Tempdb </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149650">
<META NAME="KBModify" CONTENT="1997/03/12">
<META NAME="KBCreate" CONTENT="1996/04/08">
<META NAME="Keywords" CONTENT="ssrvinst">
<META NAME="KBArea" CONTENT="Support; KB; sqlserver">
<META NAME="Description" CONTENT=" BUG#: 14671 (4.21a)   If there is not enough space available on the master device to create tempdb, any upgrade of SQL Server versions 4.2x or 6.0 to a newer version will fail with the message:     The SQL server upgrade could not be successfully co...">
<META NAME="Product" CONTENT="SQL Server">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC1,QABM,QAOE,QAMA,QAA1,QBW5,QAA5,QAPF,QAB5,QBVV,QAZV,QABA,QAKP,QA6Z,QA59 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Upgrade Fails if Not Enough Space on Master for Tempdb</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149650</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
4.21a 6.00
WINDOWS
kbsetup kbermsg kbbug4.21a kbbug6.00
<P>
 
The information in this article applies to:

<UL><LI>Microsoft SQL Server, versions 4.21a and 6.0
</UL> 
<P>
BUG#: 14671 (4.21a)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If there is not enough space available on the master device to create
tempdb, any upgrade of SQL Server versions 4.2x or 6.0 to a newer version
will fail with the message:
<P>
<PRE>   The SQL server upgrade could not be successfully completed. MSSQLserver
   The service could not be started. Please check the error/event log to
   determine the cause - 1060.

</PRE><h2>CAUSE</h2>
 
<P>
Tempdb is recreated based on the size of the model database during an
upgrade. If there is not enough disk space left on the master device for
the creation of tempdb, the upgrade will fail. For example, if model is 5
MB and there is only 2 MB of free disk space left on the master device, the
creation of tempdb will fail because it will try to be created at a size of
5 megabytes, but there is only 1 MB available to be used on the master
device. You need to keep in mind that there is 4K of space reserved on the
master device for the configuration block, which will not allow you to
allocate the last megabyte to a database.
<P>
The following is an example where the upgrade will succeed if model has
been altered to a larger size: If Master device has 5 MB of disk space left
and tempdb is currently 2 MB and model is 6 MB, the upgrade will succeed.
Tempdb will be recreated at 6 MB. First, it will reuse the original 2 MB,
then it will use the remaining 4 MB available on master.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Backup all databases and rebuild master to change the size of model back to
the default size. If you rebuild the master database, you must recreate the
user databases, reload each database from the most recent dump, and then
reapply any changes not included in the dump.

<UL><LI>OR -
<P>
</UL>For version 4.2x upgrades, create a new device, then alter tempdb to reside
on the new device. Tempdb should be altered to be at least the same size of
model before the upgrade. In addition, refer to Knowledge Base article
<B><A href="../sqlserver/q149566.htm">Q149566</A></B> ("BUG: Upgrade/Install Fails if Model DB is Larger Than Msdb"),
which will also cause an upgrade to fail due to an increase in the size of
the model database.
<P>
For version 6.0 upgrades, expand the master device to a size large enough
for tempdb to be created.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
version 4.21a and 6.0. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 6.00.121 install, SP1 SP2 SP3 SP4 service pak<BR>
KBCategory: kbsetup kbermsg kbbug4.21a kbbug6.00<BR>
KBSubcategory: ssrvinst<BR>
if the model database is<BR>
creation of tempdb.<BR>
Keywords            : ssrvinst<BR>
Version             : 4.21a 6.00<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
