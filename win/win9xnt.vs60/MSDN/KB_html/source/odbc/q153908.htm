

<HTML>
<HEAD>
<TITLE>FIX: 16-bit Driver Times Out on Async Calls to SQLTables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153908">
<META NAME="KBModify" CONTENT="1997/10/29">
<META NAME="KBCreate" CONTENT="1996/07/23">
<META NAME="Keywords" CONTENT="kbbug2.65 kbfix6.50.sp1 kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="BUG #: 15563 (2.65.0201)   When a 16-bit ODBC application calls SQLTables() using the Microsoft SQL Server ODBC Driver version 2.65.0201 set in asynchronous mode, a “Timeout expired” error message appears immediately after the second async retry.  CA...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QABM,QDKY,QA9E,QBS0,QAGI,QAB4,QAU9,QALH,QAR4,QAIF,QABA,QDN9,QBXS,QAKP V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: 16-bit Driver Times Out on Async Calls to SQLTables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153908</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.65.0201
WINDOWS
kbnetwork kbbug2.65 kbfix6.50.sp1
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.65
</UL> 
BUG #: 15563 (2.65.0201)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When a 16-bit ODBC application calls SQLTables() using the Microsoft SQL
Server ODBC Driver version 2.65.0201 set in asynchronous mode, a “Timeout
expired” error message appears immediately after the second async retry.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem occurs with any network library configuration and Windows NT
local pipes. The Timeout error message also appears regardless of other
login or query timeouts you configure on the client computer.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To correct this problem, upgrade to Microsoft SQL Server ODBC Driver
version 2.65.0212, included in Microsoft SQL Server version 6.5 Service
Pack 1.
<P>
To work around this problem, do not call the ODBC driver in asynchronous
mode. This can be done with different applications and they apply as
follows:

<UL><LI>For ODBC programs written directly to the ODBC API, call
   SQLSetStmtOption() with SQL_ASYNC_ENABLE (set to SQL_ASYNC_ENABLE_OFF).

<LI>For Visual Basic 3.0 and Access 2.0 applications, set DisableAsync to 1
   in the [ODBC] section of in the Vb.ini, App.ini or Msacc20.ini
   respectively.

<LI>For Visual Basic 4.0, set the INIPATH property of DBENGINE to point to
   Vb.ini or App.ini that has DisableAsync set to 1.
<P>
</UL>For MSACC20.INI entry settings applicable to Access 95, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q139044.htm">Q139044</A></B>
   TITLE     : INF: How to Add Former MSACC20.INI ODBC Section to Registry

</PRE>Jet 3.x (a base component of Access 95 and Visual Basic 4.0) registry
information is on Appendix C of the Microsoft Jet Database Engine
Programmer’s Guide. You can obtain Jet 2.x database engine information from
the Microsoft Developer Network Library Level 1 by querying the following:
<P>
<PRE>   jet database engine connectivity neil black

</PRE>You can also reference the Technical Backgrounder called “Jet Database
Engine ODBC Connectivity.”
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft client/server database applications, such as Access 2.0, Visual
Basic 3.0 and Visual Basic 4.0 (16-bit), are designed on top of the Jet
Database engine. Therefore, they attempt to make calls to SQLTables()
during several ODBC operations, which include attaching to a SQL Server 6.5
table. These applications utilize ODBC in asynchronous mode, by default.
Unless the default asynchronous behavior is turned off, the “Timeout
Expired” error message will occur with the driver version 2.65.0201.
<P>
NOTE: Microsoft Excel and Microsoft Query are not designed on top of the
Jet Database engine, thus the problem does not occur.
<P>
For more information about the Jet Database Engine, please refer to the
Microsoft Jet Database Engine Programmer's Guide published by Microsoft
Press. The ISBN number is 1-55615-877-7. You can order guide by
calling (800) MSP-RESS.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft SQL Server
ODBC Driver version 2.65.0201. This problem was corrected in Microsoft SQL
Server ODBC Driver version 2.65.0212. For more information, contact your
primary support provider.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.65.0212<BR>
KBCategory: kbnetwork kbbug2.65 kbfix6.50.sp1<BR>
KBSubcategory:<BR>
Keywords          : kbbug2.65 kbfix6.50.sp1 kbnetwork<BR>
Version           : 2.65.0201<BR>
Platform          : WINDOWS<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
