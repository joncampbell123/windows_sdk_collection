

<HTML>
<HEAD>
<TITLE>PRB: Error: "Failed to Get Expression Service" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172192">
<META NAME="KBModify" CONTENT="1997/07/30">
<META NAME="KBCreate" CONTENT="1997/07/30">
<META NAME="Keywords" CONTENT="kbenv kbinterop ODBCGen">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  Installation of ODBC 16-bit components with incompatible versions of OLE DLLs causes the error  Failed to get expression service.   The installation of ODBC 2.1x SDK on a fresh installation of Windows 95 also causes the error message described abov...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QBWP,QAA1,QDI2,QBE7,QBE6,QDL9,QBWQ,QBWO,QBWN,QAB4,QAFI,QAAP,QDKW,QABI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Error: "Failed to Get Expression Service"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172192</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
<P>
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, versions 2.1x
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Installation of ODBC 16-bit components with incompatible versions of OLE
DLLs causes the error "Failed to get expression service."
<P>
The installation of ODBC 2.1x SDK on a fresh installation of Windows 95
also causes the error message described above.
<P>
The following table shows the difference in version numbers of the OLE DLLs
that cause this problem.
<P>
<PRE>                               Version installed with
File name         Windows 95         Windows NT         ODBC 2.1x SDK
</PRE> 
<P>
<PRE>Compobj.dll          2.2               2.1                  2.02
Ole2.dll             2.2               2.1                  2.02
Ole2conv.dll         2.01              2.1                  2.01
Ole2disp.dll         2.1               N/A                  2.02
Ole2nls.dll          2.1               2.1                  2.02
Stdole.tlb           2.1               2.1                  4.2kb (has no
                                                         internal version)
Storage.dll          2.2               2.1                  2.02
Typelib.dll          2.1               2.1                  2.02

</PRE>Because the files that come with the ODBC 2.1x SDK are older(16-bit) than
the ones that come with Windows 95, these files are not overwritten.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem on a computer running Windows 95, delete the
existing files mentioned above in the &lt;Windows 95 root&gt;/System directory
and reinstall the ODBC 2.1x SDK. Make sure that the files have the correct
version numbers after the ODBC 2.1x SDK reinstallation.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
On computers running Windows NT 4.0, this does not cause a problem because
the versions of the above files later than 2.02 are the 16/32
interoperability OLE DLLs (32-bit), and are installed in the &lt;Windows NT
root&gt;/System32 directory. A fresh installation of the 16-bit ODBC
components from the ODBC 2.1x SDK are installed into the &lt;Windows NT
root&gt;/System directory.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: odbc2.1x<BR>
Keywords          : kbenv kbinterop ODBCGen<BR>
Version           : 2.1x<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
