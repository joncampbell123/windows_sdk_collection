

<HTML>
<HEAD>
<TITLE>INFO: Using SQLConfigDatasource with MS Oracle ODBC Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q179236">
<META NAME="KBModify" CONTENT="1998/01/14">
<META NAME="KBCreate" CONTENT="1998/01/13">
<META NAME="Keywords" CONTENT="odbcAPI kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  This article provides a list of valid SQLConfigDatasource settings for the Microsoft ODBC Driver for Oracle, version 1.0 (Msorcl10.dll) and the Microsoft ODBC Driver for Oracle, version 2.0 (Msorcl32.dll).  Note that the Msorcl10.dll ODBC driver (v...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAI4,QAU9,QA9E,QA94,QABA,QBAO,QAH4,QAWI,QBWD,QATX,QBXS,QAUJ,QAK6,QDNN,QAYY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INFO: Using SQLConfigDatasource with MS Oracle ODBC Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 14, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q179236</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft ODBC Driver for Oracle, version 1.0 (Build 2.06325)
<LI>Microsoft ODBC for Oracle, version 2.0 (Build 2.73.7269)
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides a list of valid SQLConfigDatasource settings for the
Microsoft ODBC Driver for Oracle, version 1.0 (Msorcl10.dll) and the
Microsoft ODBC Driver for Oracle, version 2.0 (Msorcl32.dll).
<P>
Note that the Msorcl10.dll ODBC driver (version 1.0) supports all of the
settings below except the Server setting.
<P>
The Msorcl32.dll ODBC driver (version 2.0) supports all of the settings
listed below.
<P>
Some of the settings are ignored by the driver but are accepted by
SQLConfigDatasource. These settings can only be provided at run time by
including them in the ODBC connection string. An ignored setting will not
be stored in the registry when SQLConfigDatasource creates the data source.
You can run the sample code provided below and examine the registry
settings created to determine which settings are ignored by the particular
driver you are using.
<P>
In the chart below, A/N means any valid alphanumeric string up to the
maximum allowable length. Max Len (maximum length) is the maximum allowable
string length accepted by the setting and includes the zero terminator
character when determining the length.
<P>
<P>
<PRE>   Setting            Max Default  Valid    Setting
   Name               Len Value    Values   Description
   ------------------------------------------------------------------

   BufferSize         7   65535    1000     Minimum fetch buffer size.
                                    to
                                   65535

   CatalogCap         2   1        0 or 1   1 means convert non-quoted
                                            identifiers to upper case in
                                            the catalog functions.

   ConnectString      128 ""       A/N      Connection string. Required
                                            method of specifying the server
                                            name with the Msorcl10.dll
                                            driver.

   Description        256 ""       A/N      Description.

   DSN                33  ""       A/N      Data source name.

   NumberFloat        2   ""       0 or 1   0 means FLOAT columns are
                                            treated as SQL_FLOAT. 1 means
                                            FLOAT columns are treated as
                                            SQL_DOUBLE.

   PWD                30  ""       A/N      Password.

   RDOSupport         2   ""       0 or 1   Allows RDO to call Oracle
                                            procedures.

   Remarks            2   0        0 or 1   Include REMARKS in Catalog
                                            functions.

   RowLimit           4   ""       0        Maximum number of rows returned
                                   to       by a select. A zero length
                                   999      string or 0 means there is no
                                            limit applied.

   Server             128 ""       A/N      Oracle server name.

   SynonymColumns     2   1        0 or 1   Include SYNONYMs in SQLColumns.

   SystemTable        2   ""       0 or 1   0 means do not display system
                                            tables. 1 means display system
                                            tables.

   TranslationDLL     33  ""       A/N      Translation DLL name.

   TranslationName    33  ""       A/N      Translation name.

   TranslationOption  33  ""       A/N      Translation option.

   TxnCap             2   ""       A/N      Transaction capable. 0 means
                                            the driver reports that it does
                                            not support transactions. 1
                                            means the driver reports it is
                                            capable of performing
                                            transactions.

   UID                30  ""       A/N      User name.


</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following code sample demonstrates how to create a data source using
the SQLConfigDataSource application program interface (API) functions with
the two available Microsoft Oracle ODBC drivers.
<P>
<PRE>   // START CODE SAMPLE

   #include &lt;windows.h&gt;
   #include &lt;odbcinst.h&gt;
   #include &lt;stdio.h&gt;
   #include &lt;conio.h&gt;

   void main()
   {
    BOOL fResult = FALSE;

    // Drop and re-create a Msorcl10.dll (version 1.0) data source.
    fResult = SQLConfigDataSource( NULL,
                                   ODBC_REMOVE_DSN,
                                   "Microsoft ODBC Driver for Oracle",
                                   "DSN=MSORCL10_DSN\0"
                                 );

    fResult = SQLConfigDataSource( NULL,
                                   ODBC_ADD_DSN, /* OR ODBC_ADD_SYS_DSN */
                                   "Microsoft ODBC Driver for Oracle",
                                   "BufferSize=40000\0"
                                   "CatalogCap=1\0"
                                   "ConnectString=MyConnectString\0"
                                   "Description=My Description Text\0"
                                   "DSN=MSORCL10_DSN\0"
                                   "NumberFloat=0\0"
                                   "PWD=MyPassword\0"
                                   "RDOSupport=0\0"
                                   "Remarks=0\0"
                                   "RowLimit=0\0"
                                   "SynonymColumns=1\0"
                                   "SystemTable=1\0"
                                   "TranslationDLL=\0"
                                   "TranslationName=\0"
                                   "TranslationOption=\0"
                                   "TxnCap=1\0"
                                   "UID=MyUserID\0"
                                 );

    // Display success/failure.
    printf( "MSORCL10.DLL SQLConfigDataSource returned %s\n",
            (fResult) ? "TRUE" : "FALSE" );

    // Drop and re-create a Msorcl32.dll (version 2.0) data source.
    fResult = SQLConfigDataSource( NULL,
                                   ODBC_REMOVE_DSN,
                                   "Microsoft ODBC for Oracle",
                                   "DSN=MSORCL32_DSN\0"
                                 );

    fResult = SQLConfigDataSource( NULL,
                                   ODBC_ADD_DSN, /* OR ODBC_ADD_SYS_DSN */
                                   "Microsoft ODBC for Oracle",
                                   "BufferSize=40000\0"
                                   "CatalogCap=1\0"
                                   "ConnectString=MyConnectString\0"
                                   "Description=My Description\0"
                                   "DSN=MSORCL32_DSN\0"
                                   "NumberFloat=0\0"
                                   "PWD=MyPassword\0"
                                   "RDOSupport=0\0"
                                   "Remarks=0\0"
                                   "RowLimit=0\0"
                                   "Server=MyOracleServer\0"
                                   "SynonymColumns=0\0"
                                   "SystemTable=0\0"
                                   "TranslationDLL=\0"
                                   "TranslationName=\0"
                                   "TranslationOption=\0"
                                   "TxnCap=0\0"
                                   "UID=MyUserID\0"
                                  );

    // Display success/failure.
    printf( "MSORCL32.DLL SQLConfigDataSource returned %s\n",
            (fResult) ? "TRUE" : "FALSE" );

    printf( "Press any key to exit.\n" );
    _getch();

   }

   // END CODE SAMPLE
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Msorcl32.dll<BR>
Keywords          : odbcAPI kb3rdparty<BR>
Technology        : odbc<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 14, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
