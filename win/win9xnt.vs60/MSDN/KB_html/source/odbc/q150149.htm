

<HTML>
<HEAD>
<TITLE>Contents of Visual FoxPro 1.0 ODBC Vfpodbc.txt File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150149">
<META NAME="KBModify" CONTENT="1997/10/14">
<META NAME="KBCreate" CONTENT="1996/04/22">
<META NAME="Keywords" CONTENT="FxinteropOdbc kbinterop kbreadme">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  Below is Microsoft Visual FoxPro Open Database Connectivity (ODBC) 1.0 Vfpodbc.txt file, located in the Windows System subdirectory.  MORE INFORMATION  ...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QA55,QA56,QAU9,QAA1,QDI2,QAY2,QAH4,QAGI,QAB9,QAYY,QBWS,QABA,QATJ,QART V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Contents of Visual FoxPro 1.0 ODBC Vfpodbc.txt File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150149</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS
kbinterop kbreadme
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro ODBC Driver version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Below is Microsoft Visual FoxPro Open Database Connectivity (ODBC) 1.0
Vfpodbc.txt file, located in the Windows System subdirectory.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
 
<P><h3>Microsoft Visual FoxPro ODBC Driver Version 1.0 ReadMe File</h3>
 
<P>
(c) Copyright Microsoft Corporation, 1996
<P>
This document provides late-breaking or other information that supplements
the Microsoft Visual FoxPro ODBC Driver Help file.
<P>
 
<P><h3>How to Use This Document</h3>
 
<P>
To view the ReadMe file in Windows Notepad, maximize the Notepad window and
click Word Wrap on the Edit menu. To print the ReadMe file, open it in
Notepad or another word processor, and then use the Print command on the
File menu.
<P>
 
<P><h3>CONTENTS</h3>
 

<OL><P><LI>  INSTALLATION NOTES
<P><PRE>     1.1  System Requirements
     1.2  Installing from Disk
     1.3  Adding a Data Source
     1.4  Information Resources
</PRE>
<P><LI>  DISK CONTENTS
<P><PRE>     2.1  Files on Disk
     2.2  Files Installed By SETUP.EXE
</PRE>
<P><LI>  TROUBLESHOOTING
<P><PRE>     3.1  Installation Problems
     3.2  Unsupported Commands in Existing Stored Procedures
     3.3  ODBC Troubleshooting Tools
     3.4  Contacting Product Support Services
</PRE>
<P><LI>  ADDITIONAL INFORMATION
<P><PRE>     4.1  Data Files That Can Be Accessed by the Driver
     4.2  Driver Capabilities
     4.3  Driver Limitations
     4.4  Default Environment Settings
     4.5  Default Column Names For Expressions
     4.6  Known Issues With SQL Server Replication and Office Applications
</PRE>
<P><LI>  ADDITIONAL EXAMPLES
<P><PRE>     5.1  Accessing Visual FoxPro Data from Microsoft Excel
     5.2  Accessing Visual FoxPro Data from Visual Basic
</PRE><P>
<P>
</OL> 
<P><h3>1.   INSTALLATION NOTES</h3>
 
<PRE>     1.1  System Requirements
     1.2  Installing from Disk
     1.3  Adding a Data Source
     1.4  Information Resources

</PRE></OL><h2>1.1  System Requirements</h2>
 
To install the Visual FoxPro ODBC Driver, you need:
<PRE> * Windows NT 3.50 (or later) or Windows 95
 * 2 MB disk space

</PRE>Important: Visual FoxPro ODBC Driver 1.0 is a 32-bit driver only.  Windows
3.1 and Windows for Workgroups platforms are not supported.
<P>
<P><h2>1.2  Installing from Disk</h2>
 
<P>
1 Place the Visual FoxPro ODBC Driver installation disk into the A: drive.
2 On Windows 95, choose Run from the Start button.
<PRE>  -or-
  On Windows NT, choose Run from the Program Manager File menu.
</PRE>3 Type "A:\SETUP.EXE" without quotes and press ENTER.
<P>
NOTE:  The Visual FoxPro ODBC Driver installation updates the ODBC
components to ODBC 2.5 compliance if necessary.  See the README25.TXT file
in your Windows system directory for additional information on enhancements
or features of the ODBC 2.5 components.
<P>
<P><h2>1.3 Adding a Data Source</h2>
 
In order to use any ODBC driver from an ODBC-aware application, you must
first set up a data source. For instructions on adding a data source,
search for "Adding a Visual FoxPro data source" in Help.
<P>
<P><h2>1.4  Information Resources</h2>
 
The following information is available to help you:
<PRE> * Help files
 * ReadMe files
 * Microsoft Press Books
 * MSDN

</PRE><h3>Help Files</h3>
 
The Visual FoxPro ODBC Driver comes with two help files, located in your
Windows system directory:
<PRE> * ODBCINST.HLP  General ODBC information
 * DRVVFP.HLP  The Visual FoxPro ODBC Driver Help file

</PRE><h3>ReadMe Files</h3>
 
The Visual FoxPro ODBC Driver comes with two readme files, located in your
Windows system directory:
<PRE> * VFPODBC.TXT  This file.
 * README25.TXT  Contains information specific to ODBC 2.5 components

</PRE><h3>Microsoft Press Books</h3>
 
Microsoft publishes two books on ODBC:
<P>
<PRE> * Microsoft ODBC 2.0 Programmer's Reference and SDK Guide
   (ISBN#: 1-55615-658-8).
 * Inside ODBC (ISBN#: 1-55615-815-7).

</PRE>Check your local book store for third party books on ODBC or newly released
MS Press books on ODBC.
<P>
<P><h3>MSDN</h3>
 
See MSDN for ODBC revision information on versions 2.1 through 2.5.
<P>
<P>
 
<P><h3>2.   DISK CONTENTS</h3>
 
<PRE>     2.1  Files on Disk
     2.2  Files Installed By SETUP.EXE

</PRE><h2>2.1  Files on Disk</h2>
 
EXTRACT.EXE
SETUP.EXE
SETUP.INI
SETUP.LST
SETUP.TDF
VFPODBC.INF
VFPODBC.TXT
VFPODBC1.CAB
<P>
<P><h2>2.2  Files Installed By SETUP.EXE</h2>
 
<PRE>CTL3D32.DLL             Dialog DLL.
DRVVFP.HLP              The Visual FoxPro ODBC Driver help file; the
</PRE>primary resource for information on the driver.
<PRE>FOXPRO.INT              Collation support for some Eastern European
</PRE>languages.
<PRE>VFPODBC.DLL             The Visual FoxPro ODBC Driver.
VFPODBC.TXT             This file, containing additional information on the
</PRE>Visual FoxPro ODBC Driver.
<PRE>README25.TXT            ReadMe file for the ODBC 2.5 component changes.


</PRE> 
<P><h3>3.   TROUBLESHOOTING</h3>
 
<PRE>     3.1  Installation Problems
     3.2  Unsupported Commands in Existing Stored Procedures
     3.3  ODBC Troubleshooting Tools
     3.4  Contacting Product Support Services

</PRE><h2>3.1  Installation Problems</h2>
 
&gt;&gt;&gt;To troubleshoot installation problems
1 Clean-boot the machine.  For example, under Windows 95, start in Safe
Mode.
2 Make sure that nothing else is running, including virus software,
Terminate and Stay Resident (TSR) applications, third party shells, or
toolbars such as Microsoft Office Manager.
3 If the computer has video or system ROM shadowing, clear these options
before reinstalling.
4 Scan the installation disks for damage and request new disks if they are
damaged.
5 Re-install the driver.
<P>
<P><h2>3.2  Unsupported Commands in Existing Stored Procedures</h2>
 
The Microsoft Visual FoxPro ODBC Driver supports only a subset of the
commands and functions available in the Visual FoxPro language.  If a
trigger contains an unsupported command or function, the Visual FoxPro ODBC
Driver will return a "Trigger Failed" error message and ignore the INSERT,
UPDATE, or DELETE command associated with the trigger.
<P>
Trigger code can be customized to execute code conditionally, depending on
<PRE>whether the code is being executed by the driver or by Visual FoxPro.   You
</PRE>can use the following template to create conditional code:
<P>
IF VERSION() = "Visual FoxPro ODBC Driver"
<PRE>   * [Insert trigger code that is supported by the Visual FoxPro ODBC
</PRE>Driver]
ELSE
<PRE>   * [Insert trigger code supported by Visual FoxPro]
</PRE>ENDIF
<P>
See the Help file, DRVVFP.HLP, for a list of supported and unsupported
commands and functions.
<P>
<P><h2>3.3  ODBC Troubleshooting Tools</h2>
 
You can troubleshoot ODBC problems with ODBC Test and ODBC Spy
applications, available in  the Microsoft ODBC SDK. You can use the 32-bit
version of ODBC Spy to determine the ODBC function and parameters that
caused the problem to occur.  You can then use the 32-bit version of ODBC
Test to verify the cause of the problem by submitting specific function
calls with the parameters you identified.  For additional information on
using these utilities, refer to the ODBC 2.0 Programmer's Reference and SDK
guide in Chapter 4: Using ODBC Test, and Chapter 5: Using ODBC Spy.
<P>
<PRE>Note:   Only the 32-bit version of ODBC Spy and ODBC Test can be used
</PRE>because the Visual FoxPro ODBC Driver is fully 32-bit.
<P>
An ODBC Trace Log can be generated by using the 32-bit version of ODBC Spy
or by using the ODBC 32-bit Administrator.
<P>
&gt;&gt;&gt;To generate an ODBC trace log:
1 In the Control Panel, double-click the 32bit ODBC icon.
2 In the Data Sources dialog box, click Options.
3 Select Trace ODBC Calls and Stop Tracing Automatically.
4 Click Select File and provide a log file name.
5 Click Save.
6 Click OK.
7 Click Close.
<P>
Now when you execute your code, all C ODBC API calls, their input
parameters, and their output will be written to the log file.  The ODBC log
file is ASCII text and may be viewed in any standard ASCII text editor such
as Microsoft Word, Notepad, or WordPad.
<P>
<P><h2>3.4  Contacting Product Support Services</h2>
 
If you have a question that requires technical support, prepare the
following information before you call:
<P>
* The version numbers of any Microsoft products you are using
* The type of hardware that you are using
* The exact wording of any messages that appeared on your screen
* A description of what happened and what you were doing when the problem
occurred
* A description of how you tried to solve the problem
* Any ODBC Trace logs
<P>
When you call, be at your machine and have the Visual FoxPro ODBC Help file
and any other related product documentation available, and then call one of
the following numbers:
<P>
* If you are a registered user of Visual FoxPro, call (425) 635-7191, and
have your product identification number available.
<P>
* If you have successfully installed the driver but are having trouble
using it with your ODBC-aware application, contact the support provider for
your application.
<P>
* If you do not own Visual FoxPro, you can call (900) 555-2300 or (800) 936-
5800 and use the Microsoft Technical Support "Pay As You Go" options.
<P>
* If you have issues with the ODBC API or other advanced issues, call the
Advanced Systems "Pay As You Go" support line at (800) 936-5900.
<P>
<P>
 
<P><h3>4.   ADDITIONAL INFORMATION</h3>
 
<PRE>     4.1  Data Files That Can Be Accessed by the Driver
     4.2  Driver Capabilities
     4.3  Driver Limitations
     4.4  Default Environment Settings
     4.5  Default Column Names For Expressions
     4.6  Known Issues With SQL Server Replication and Office Applications

</PRE><h2>4.1  Data Files That Can Be Accessed by the Driver</h2>
 
The driver supports FoxBase+ and FoxPro tables as well as dBASE IV tables.
<P>
<P><h3>FoxBase+ and FoxPro Tables</h3>
 
The Visual FoxPro ODBC Driver gives you access to FoxBase+, FoxPro 1.x,
FoxPro 2.x and Visual FoxPro 3.0 tables. The Visual FoxPro ODBC Driver also
provides access to tables that are associated with a Visual FoxPro database
container (DBC).
<P>
Note:  The Visual FoxPro ODBC Driver allows transactions only on tables
within a Visual FoxPro database. You cannot create transactions on free
tables.
<P>
<P><h3>dBASE IV Tables</h3>
 
The Visual FoxPro ODBC Driver gives you access to dBASE IV and earlier
tables. The dBASE files are supported in the following manner:
* dBASE  v2.x and 3.x: The files are read without conversion.
* dBASE  v4.x and 5.x: If the files do not have memo fields and the table
has fewer than 255 columns, the files are read.
* dBASE  v4.x and 5.x tables with memo fields or dBASE indexes: These files
require conversion in Visual FoxPro for Windows before they can be used
with the Visual FoxPro ODBC Driver. The driver will not read or convert
files. If you attempt to connect to a dBASE file that contains a memo field
or index, an error will occur.
<P>
<P><h2>4.2  Driver Capabilities</h2>
 
<P><h3>International Support</h3>
 
You can set the collating sequence for index ordering.  For a list of
supported collating sequences, search for SET COLLATE in Help.
<P>
<PRE>The default collating sequence is "MACHINE".   The collating sequence can
</PRE>be changed by:
* Selecting a different collating sequence from the driver options in the
Data Source Setup dialog box.
* Setting SET COLLATE TO cSequenceName with the ODBC function
SQLExecDirect().
* Calling SQLPrepare() and SQLExecute() (see the ODBC 2.0 Programmer's
Reference and SDK Guide).
<P>
Note: Support for the Eastern European code pages depends on the FOXPRO.INT
file, which is installed by the Visual FoxPro ODBC Driver in your Windows
system directory.  If it is removed, the collating sequences on Eastern
European code page machines will not work.
<P>
<P><h3>Remote Views and Parameterized Views</h3>
 
Any time the SQLTables() function is called, remote and parameterized views
are excluded from the list. Local views based on parameterized views are
not excluded, but will generate errors if you use them. If you call the
SQLTables() function with a unique table name, however, you will find views
if they are present, so that you can check for name conflicts.
<P>
<P><h2>4.3  Driver Limitations</h2>
 
You must use Visual FoxPro, not the Visual FoxPro ODBC Driver, to:
<P>
<PRE>   * Use remote views. Remote views are not supported in the driver.
   * Update local views. Changes to views from the driver affect only the
</PRE>view cursors, not the base tables.
<PRE>   * Update base tables.
   * Call stored procedures directly. Using the driver, stored procedures
</PRE>can only be called from a rule or trigger.
<PRE>   * Create some index types. The driver can create only Primary or Unique
</PRE>indexes, using the ALTER TABLE command.  The driver cannot create an index
on a free table.
<PRE>   * Create transactions on free tables.  The Visual FoxPro ODBC Driver
</PRE>allows transactions only on tables within a database, not on free tables.
<PRE>   * Remove records marked for deletion. The PACK command is not supported
</PRE>by the driver.
<PRE>   * Convert dBASE files that have indexes or memo fields.

</PRE>4.4  Default Environment Settings
 
The default settings for the following SET commands are different from
their default settings in Visual FoxPro.
<P>
<PRE>Environment/SET command    Driver's Default Value
-----------------------    ----------------------
EXCLUSIVE                  OFF
NULL                       ON
DELETED                    ON
ANSI                       ON

</PRE><h2>4.5  Default Column Names For Expressions</h2>
 
The Visual FoxPro ODBC Driver names columns based on expressions using a
combination of the expression operator and expression field. For example,
the driver returns min_customerid as the name of the expression field in
the result set for the following statement:
<P>
<PRE>   SELECT MIN (customer_id) FROM customers

</PRE>If you want to control the expression field name, use the AS clause.  The
following example returns  'minimum_custid' as the name of the expression
field:
<P>
<PRE>   SELECT MIN(customer_id) AS minimum_custid FROM customers

</PRE><h2>4.6  Known Issues With SQL Server Replication and Office Applications</h2>
 
<P><h3>SQL Server Replication</h3>
 
* When creating a character field, note that the Visual FoxPro maximum
character field length is 254 characters, while the SQL Server maximum
character field length is 255 characters.
<P>
* In order for replication to work properly, do not export indexes.
<P>
<P><h3>MSQuery Issues</h3>
 
To access a Visual FoxPro data source from a Microsoft Office application,
you must have the MSQuery add-in; however, MSQuery is not installed by
default with Microsoft Office applications. You can install MSQuery by
reinstalling Excel or another Office component, choosing the Custom
installation option, and then selecting the MSQuery add-in.
<P>
Using MSQuery To Create Visual FoxPro Tables
 
When creating a table with MSQuery, the Type box in the Table Definition
dialog box displays the following characters: B,C,D,F,G,I,L,M,M NOCPTRANS,
N,T, and Y.  For topics containing a definition of these data types, search
for "field data types" in Help. The table describing data types is
displayed when you click on the green 'data type' link.
<P>
Note:  It is not possible to create a table that includes a Visual FoxPro
Character Binary data type with MSQuery.
<P>
<P><h3>Invalid Field Names and MSQuery</h3>
 
MSQuery allows you to create invalid Visual FoxPro field names in tables.
For example,  "1995sales" is not a valid field name in Visual FoxPro, but
MSQuery allows you to create it.  When you open the table, you will get an
error.
<P>
<P>
 
<P><h3>5.   ADDITIONAL EXAMPLES</h3>
 
<PRE>     5.1  Accessing Visual FoxPro Data from Microsoft Excel
     5.2  Accessing Visual FoxPro Data from Visual Basic

</PRE><h2>5.1  Accessing Visual FoxPro Data from Microsoft Excel</h2>
 
&gt;&gt;&gt;To use Visual Basic for Applications in Excel to access Visual FoxPro
data:
1 Start Microsoft Excel.
2 From the Insert menu, choose Macro and then Module.
3 Type the following code into the blank Macro editing window:
<P>
<PRE>Sub MainRoutine()
    Dim Id As Variant
    Dim Constring As String   ' The connect string
    Dim Sql         ' The SQL Select command string
    Dim rc As Variant      ' The return code from a function
    Dim re As Variant      ' The returned error code from SQLError

    ' Initialize variables
    Constring =
</PRE>"DSN=testdata;DBQ=c:\vfp\samples\data\testdata.dbc;FIL=FoxPro 3.0"
<PRE>    Sql = "SELECT * from employee"

    ' Connect to the data source
    Id = SQLOpen(Constring)

    ' Execute the select command to return data
    rc = SQLExecQuery(Id, Sql)

    ' If there is an error, display it and exit
    If IsError(rc) Then
        re = SQLError()
        MsgBox "SQL Error. Error Message:" &amp; re(3)
        Exit Sub
    End If

    ' Retrieve the data and put it into worksheet Sheet1
    rc = SQLRetrieve(Id, Worksheets("Sheet1").Range("A1"))

    ' Close the connection
    SQLClose Id
End Sub

</PRE>4 From the Tools menu, choose References.
5 Select the XLODBC.XLA check box and click OK.
Note: If XLODBC.XLA does not exist in the list, select Browse and find
XLODBC.XLA in the Microsoft Excel Library\MsQuery directory.
6 From the Run menu, choose Start.
7 Click the Sheet1 tab to display the data.
<P>
<P>
<P><h2>5.2 Accessing Visual FoxPro Data from Visual Basic</h2>
 
&gt;&gt;&gt;To access Visual FoxPro data with a Visual Basic Remote Data Object
(RDO):
1 Define a data source named TasTradeDSN that connects to TASTRADE.DBC.
2 Start the Enterprise Edition of Visual Basic and create a form.
3 From the Tools menu, choose Custom Controls.
4 In the Available Tools list, select Microsoft Remote Data Control.
5 From the object toolbar, drop an RDO control on the form and set these
properties:
<PRE>   DataSourceName:   TastradeDSN (This example requires a data source named
</PRE>TastradeDSN that connects to TASTRADE.DBC.)
<PRE>   Connect:   ODBC=TastradeDSN
   CursorDriver:   0-ODBC Cursor if needed
   SQL:      select * from customer
   ResultType:   3-Static
   LockType:   1-ReadOnly

</PRE>6 Drop a text box on the form and set these properties:
<PRE>   DataSource:   MSRDC1 (the RDO control)
   DataField:   company_name

</PRE>7 Drop a command button on the form and set these properties:
<PRE>   Caption:   Skip 1

</PRE>8 Add the following code to the command button's Click event:
<PRE>   MSRDC1.Resultset.MoveNext

</PRE>9 Run the form and click the Skip 1 command button.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 VFoxWin 3.00 3.00b readme.txt<BR>
KBCategory: kbinterop kbreadme<BR>
KBSubcategory: FxinteropOdbc<BR>
Keywords          : FxinteropOdbc kbinterop kbreadme<BR>
Version           : 1.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
