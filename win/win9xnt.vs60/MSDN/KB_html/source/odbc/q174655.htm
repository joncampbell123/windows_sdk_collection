

<HTML>
<HEAD>
<TITLE>PRB: File DSN and DSN-Less Connections May Fail w/Localized ODBC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174655">
<META NAME="KBModify" CONTENT="1997/10/22">
<META NAME="KBCreate" CONTENT="1997/10/02">
<META NAME="Keywords" CONTENT="SSrvProg kbcode">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  When shareable file Data Source Name (DSN) or DSN-less connections are used on computers with localized Open Database Connectivity (ODBC) driver descriptions, the connection may fail with the following message:     IM002: [Microsoft][ODBC Driver Ma...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAU9,QA9E,QAWI,QAI5,QAA1,QBG2,QA1S,QDI2,QAHH,QAH4,QDN9,QAIY,QARL,QAGI,QDKW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: File DSN and DSN-Less Connections May Fail w/Localized ODBC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174655</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When shareable file Data Source Name (DSN) or DSN-less connections are used
on computers with localized Open Database Connectivity (ODBC) driver
descriptions, the connection may fail with the following message:
<P>
<PRE>   IM002: [Microsoft][ODBC Driver Manager] Data source name not found and
   no default driver specified

</PRE><h2>CAUSE</h2>
 
<P>
Shareable file DSN and DSN-less connections use the DRIVER keyword to
indicate which ODBC driver to use. The DRIVER keyword is set to a driver
description that must match the description of an installed driver on the
client computer. On computers with localized ODBC driver descriptions, the
description used in the file DSN or DSN-less connection may not match that
of the installed driver, thereby causing the error message described above.
<P>
For example, if the German version of Microsoft Office 97 installed the
ODBC Access 97 driver with a description of "Microsoft Access-Treiber
(*.mdb)," a file DSN or a DSN-less connection containing "DRIVER={Microsoft
Access Driver (*.mdb)}" will fail, even though the Access driver has been
installed properly.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
To work around this problem, do either of the following:

<UL><LI>Change the driver description used in the file DSN or DSN-less
   connection so that it matches the one on the client computer.
<P>
   -or-

<LI>Install the driver again on the client computer with the description
   used in the connect string. Note that using this option will result in
   more than one description for the same driver, which will allow any
   program using any one of the localized descriptions to connect through
   the driver on the client.
<P>
</UL>The following ODBC 3.0 sample code illustrates a minimal installation of
the ODBC SQL Server driver with an English driver description. You can
alter the code to install any ODBC driver with any driver description. For
more information concerning the files and function calls used in the code,
see the ODBC 3.0 SDK.
<P>
<PRE>   #include &lt;windows.h&gt;
   #include &lt;stdio.h&gt;
   #include &lt;odbcinst.h&gt;

   void ShowErrors ()
   {
      WORD     iError = 1;
      DWORD pfErrorCode;
      char     lpszErrorMsg[301];
      WORD     cbErrorMsgMax = 300;
      RETCODE  rc;

      while (SQL_NO_DATA != (rc = SQLInstallerError(
               iError ++,
               &amp; pfErrorCode,
               lpszErrorMsg,
               cbErrorMsgMax,
               NULL )))
         if (rc == SQL_SUCCESS || rc == SQL_SUCCESS_WITH_INFO)
            printf( "%s\n", lpszErrorMsg);

      printf ("\n");
   }


   void main ()
   {
      char *    szDriver = "SQL
   Server\0Driver=sqlsrv32.dll\0Setup=sqlsrv32.dll\0\0";
      char *    szPathIn = "c:\\winnt\\system32";
      char   szPathOut[301];
      WORD   cbPathOutMax = 300;
      WORD   cbPathOut;
      DWORD dwUsageCount;

      printf ("Calling SQLInstallDriverEx ...\n");
      if (!SQLInstallDriverEx(
            szDriver,
            szPathIn,
            szPathOut,
            cbPathOutMax,
            &amp; cbPathOut,
            ODBC_INSTALL_COMPLETE,
            &amp; dwUsageCount))
         ShowErrors ();

      printf ("Calling SQLConfigDriver ...\n");
      if (!SQLConfigDriver(
            NULL,
            ODBC_INSTALL_DRIVER,
            "Microsoft Access - test 4",
            "",
            szPathOut,
            cbPathOutMax,
            &amp; cbPathOut))
         ShowErrors ();
   }
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: jet desktop database<BR>
Keywords          : SSrvProg kbcode<BR>
Version           : 3.0<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
