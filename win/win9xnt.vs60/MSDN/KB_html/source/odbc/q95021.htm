

<HTML>
<HEAD>
<TITLE>INF: Connecting to Sybase SQL Server from ODBC Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95021 ">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1993/01/31">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  Older versions of the Microsoft SQL Server ODBC driver could be used to connect to older versions of Sybase SQL Servers. This article describes how to set up the ODBC data source for these old drivers to connect to Sybase SQL Servers. If clients ar...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA9E,QAJW,QAUJ,QAU9,QAK6,QAI5,QBWD,QAVZ,QAA1,QBWS,QBVX,QAY2,QAYY,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: Connecting to Sybase SQL Server from ODBC Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95021 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, versions 1.0, 2.0x
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Older versions of the Microsoft SQL Server ODBC driver could be used
to connect to older versions of Sybase SQL Servers. This article describes
how to set up the ODBC data source for these old drivers to connect
to Sybase SQL Servers. If clients are already connecting to the Sybase
server from Windows DB-Library applications, no extra components are
required.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Starting with version 2.00.1912 of the Microsoft SQL Server ODBC Driver
(which shipped with SQL Server version 4.21a), Microsoft SQL Server drivers
are no longer certified for use against any Sybase SQL Servers. Version
1.02.3231 or earlier drivers were certified to run against older versions
of Sybase SQL Servers, but none of the Microsoft SQL Server ODBC drivers
was certified to run against System/10 or later Sybase servers. Because all
of the Microsoft driver versions which were certified for use against
Sybase are now obsolete, it is recommended that sites wanting to connect
ODBC applications to Sybase servers contact Sybase or third party ODBC
driver vendors for drivers certified for use against Sybase.
<P>
The key to Microsoft and Sybase SQL Server connectivity is a module called
the Network Library (Net-Library). This module consists of two interfaces -
one with the network and one with the application. The network interface is
customized to support a particular network, but the application interface
remains the same. Because ODBC, DB-Library, APT-SQL, APT-Library, and so on
communicate with the Net-Library, they can be written in a network-
independent fashion. In particular, the ODBC SQL Server driver can be used
to connect either to Microsoft or Sybase SQL Server (on Unix and VMS),
regardless of the network you are using, as long as there is a Net-Library
for that network.
<P>
The following paragraphs discuss how to connect to a Sybase SQL Server from
an ODBC application. For the rest of this article, it is assumed that you
are connecting to a SQL Server called "Mysqlsvr." This server should be
setup as an ODBC Data Source using the ODBC Administrator utility. In the
ODBC Administrator, click SQL Server from the list of installed drivers,
then click Add New Name. In the ODBC SQL Server Setup dialog, type a data
source name (DSN). Note that a single server can function as multiple ODBC
Data Sources, because each database in the server can be a data source.
Thus, the data source name does not necessarily have to be the same as the
server name.
<P>
Click Add after you type the data source name. In the resulting dialog box,
the Network Address field will have a default entry of the form:
<P>
<PRE>   \\DATA-SOURCE-NAME\PIPE\SQL\QUERY

</PRE>This is actually a named pipe name. Because a Sybase SQL Server on
Unix uses sockets rather than named pipes, you must change this name
so that it contains the IP address and the port identification number.
This is a string of the form "ip_address,port". For example:
<P>
<PRE>   11.1.14.40,3180

</PRE>For a Sybase SQL Server on VAX, this should contain a string of the
form "node address,process_id" where "node address" is the DECNet node
address of the server and the "process_id" is the process identification
number to use for the connection. An example entry is "1.997,141". The
"Network Library" field has a default entry of dbnmp3. This is the net-
library if you are using named pipes. This field should contain the name of
the net-library that you will need to use, which is dependent on what
network you are using. For example, if you are using FTP PCTCP, then the
net-library name is wdbftptc. Note that if you are already connecting to a
Sybase SQL Server from an existing Windows db-lib application, then you
will have the correct net-libraries. Choose OK to get back to the initial
screen. The addition of the data source is now complete.
<P>
The next step is to have the Sybase Database Administrator run the
INSTCAT.SQL script file. This is a file containing SQL statements that will
create certain stored procedures needed to process ODBC calls. Without
these procedures, Access will not be able to attach to a SQL Server table
and Visual Basic 2.0 will not be able to function correctly. To run this
script file, you must use ISQL. At a Unix command line or at a DOS prompt,
type:
<P>
<PRE>   isql -S&lt;servername&gt; -Usa -P&lt;sa-password&gt; -i&lt;path&gt;\instcat.sql

</PRE>If you are running Sybase SQL Server 4.2, then use the INSTCAT.SQL that
ships with the application.
<P>
Finally, note that if the above procedure is followed correctly, then
the following changes will appear in the ODBC.INI and WIN.INI files. The
[Data Sources] section of ODBC.INI will have an entry of the form:
<P>
<PRE>   data-source-name=SQL Server

</PRE>where "data-source-name" is the name of the data source that you
added. There will be a new section called "[data-source-name]"
containing the location of the SQL Server driver and a description of
the data source. The [SQLSERVER} section of the WIN.INI file will contain
an entry of the form:
<P>
<PRE>   data-source-name=&lt;net-library-name&gt;,&lt;network address&gt;
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 2.00 dblib odbc connectivity sql<BR>
KBCategory: kbusage<BR>
KBSubcategory:
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
