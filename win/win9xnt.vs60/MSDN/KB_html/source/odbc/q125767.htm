

<HTML>
<HEAD>
<TITLE>PRB: Query Too Complex Error After Execution of SQL Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125767">
<META NAME="KBModify" CONTENT="1997/07/02">
<META NAME="KBCreate" CONTENT="1995/02/05">
<META NAME="Keywords" CONTENT="kberrmsg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  When you use the ODBC desktop drivers, the following message is displayed after SQExecDirect or SQLPrepare fails with a SQL_ERROR return code:     Query too complex  CAUSE =====  There are two possible causes for this:   - Application is running lo...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAB4,QA9E,QBJQ,QAXB,QAO2,QAAP,QAE1,QBHQ,QAU9,QABN,QABM,QAW6,QAC1,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>PRB: Query Too Complex Error After Execution of SQL Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125767</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
2.00.2317
WINDOWS
kbprg kberrmsg
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the ODBC desktop drivers, the following message is displayed
after SQExecDirect or SQLPrepare fails with a SQL_ERROR return code:
<P>
<PRE>   Query too complex

</PRE><h2>CAUSE</h2>
 
<P>
There are two possible causes for this:

<UL><LI>Application is running low on stack space.

<LI>The SQL query is hitting the defined SQL limits in the driver. For
   instance, the desktop database driver help files ODBCDRV.HLP and
   ODBCDRV32.HLP (16- and 32-bit versions, respectively) list the SQL
   limitations:
<P>
<P><PRE>    a. Maximum of 40 AND predicates in a WHERE clause.
</PRE><P>
<P><PRE>    b. Maximum of 16 tables in a FROM clause.
</PRE><P>
<P><PRE>    c. Maximum of 40 search conditions in a HAVING clause.
</PRE><P>
</UL>If a snapshot is created on a table with more than 40 columns, Microsoft
Foundation Classes (MFC) applications will get this error message on using
the CRecordSet::Update method. This is because the MFC database classes use
the Cursor Library for snapshots, and on a CRecordSet::Update, the Cursor
Library builds a WHERE clause listing all the columns in the table. This
WHERE clause has more than 40 AND predicates, therefore, an error is
reported by the driver.
<P>
Note: An MFC ODBC application that references long binary data using the
RFX_LongBinary function may encounter this error when the recordset is
opened. This is because the cursor library precedes calls to SQLGetData
with the execution of a SELECT statement with a WHERE clause as described
above.
<P>
The long binary column does not contribute toward exceeding the 40-column
limit because it is not referenced in the generated WHERE clause.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve the first cause above, you must set the stack size to 20K or
more.
<P>
To resolve the second cause, where the error occurs on the
CRecordSet::Update method, you must:

<UL><LI>Force MFC to use the native cursor functionality within the driver
   instead of using the Cursor Library. This is typically done by creating
   a dynaset instead of a snapshot, and be ensuring that the CDatabase
   object used by your CRecordset object does not load the cursor library.
   This is done by setting the fifth argument of CDatabase::Open to
   FALSE. (This also implies you will need to explicitly create and open a
   CDatabase object for your CRecordset object.)
<P>
 OR

<LI>Reduce the number of columns in the recordset.
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00.2317 Access dbase fox paradox 16bit<BR>
32bit MFC database classes Windows NT<BR>
KBCategory: kbprg kberrmsg<BR>
KBSubcategory:<BR>
Keywords            : kberrmsg kbprg<BR>
Technology          : kbMfc<BR>
Version             : 2.00.2317<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
