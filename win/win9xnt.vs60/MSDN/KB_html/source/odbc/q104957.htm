

<HTML>
<HEAD>
<TITLE>FIX: Cannot Make Server-Server RPCs in Non-trusted Mode </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104957">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1993/10/04">
<META NAME="Keywords" CONTENT="kbusage kbbug1.01.2920 kbfix1.01.2920 kbfix4.20">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT=" BUG# ODBCSS: 2774 (1.01.2920)   Using the ODBC SQL Server driver version 1.01.2920 or earlier, it is not possible to perform server to server RPC's in non-trusted mode. As a result, users of Microsoft Access or Microsoft Visual Basic version 3.0 for...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA9E,QA5W,QAU9,QAR4,QBVX,QAM1,QBS0,QBSO,QBWP,QATQ,QANN,QAGI,QAB4,QAC1 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Cannot Make Server-Server RPCs in Non-trusted Mode</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104957</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 1.0
</UL> 
<P>
BUG# ODBCSS: 2774 (1.01.2920)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Using the ODBC SQL Server driver version 1.01.2920 or earlier, it is not
possible to perform server to server RPC's in non-trusted mode. As a
result, users of Microsoft Access or Microsoft Visual Basic version 3.0
for Windows cannot perform server to server RPCs on SQL Servers.
<P>
Server to Server RPC refers to:
<P>
A client logs on to a server called server1. It then issues a
procedure call of the form:
<P>
<PRE>   exec server2.pubs.dbo.testproc

</PRE>This causes server1 to log onto server2 and execute the procedure
testproc owned by the dbo of the pubs database. Thus, testproc
is executed remotely on server2.
<P>
In SQL Server, server to server RPCs can be done in 2 modes: trusted
and non-trusted. In trusted mode, the remote server (server2 in the
example above) accepts remote logins from other servers without
verifying the login. Untrusted mode specifies that server2 should verify
passwords before accepting remote logins.
<P>
Using the ODBC SQL Server driver version 1.01.2820 or earlier, it is not
possible to execute server to server RPC's in non-trusted mode.
Attempting to do so will produce the error message:
<P>
[Microsoft][ODBC SQL Server Driver][SQL Server] Login to site &lt;remote-
servername&gt; failed.
szSqlState = "S0002", *pfNativeError = 7221
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Use trusted mode RPCs.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in SQL Server Driver
version 1.01.2820 or earlier. This problem has been fixed in SQL Server
Driver version 1.02.3231, which ships with SQL Server version 4.2 for
Windows NT. The driver may also be obtained from your primary support
provider.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 1.01.2920 VB
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
