

<HTML>
<HEAD>
<TITLE>How an MFC Application Can Use the Visual FoxPro ODBC Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150432">
<META NAME="KBModify" CONTENT="1996/09/18">
<META NAME="KBCreate" CONTENT="1996/04/30">
<META NAME="Keywords" CONTENT="kbinterop kbhowto">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  The Microsoft Foundation Classes can be used to create a application that allows access to data using ODBC drivers. The MFC AppWizard can create a basic framework that can be used to gain access to data with the Visual FoxPro ODBC driver.  This art...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QA2Q,QAG2,QBV4,QA56,QA55,QASR,QA9E,QAYL,QA5D,QBJZ,QABI,QAHP,QA7O,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How an MFC Application Can Use the Visual FoxPro ODBC Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150432</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro ODBC Driver version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Microsoft Foundation Classes can be used to create a application that
allows access to data using ODBC drivers. The MFC AppWizard can create a
basic framework that can be used to gain access to data with the Visual
FoxPro ODBC driver.
<P>
This article gives the basic instructions for creating a simple MFC
application by using the MFC AppWizard. For more specifics on MFC or the
MFC Appwizard, refer to the  Microsoft Visual C++ manuals and online books
that are included with MFC 4.0. This example was created using Visual C++
4.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the MFC AppWizard to create a basic framework:

<OL><P><LI>Create a data source for Tastrade.dbc (in the Visual FoxPro
   Samples\Mainsamp\Data directory) and call it tastrade. Then open the
   customer database in Visual FoxPro, and modify the structure to allow
   NULL in all the fields. The MFC classes do not seem to distinguish
   between NULL and a blank value. When the Next button is clicked, the
   MFC class libraries send an update back to the table. If the field
   is blank, then a NULL is sent instead of spaces. When a NULL value
   is sent instead of spaces, an error occurs because the field does
   not allow NULLs.

<P><LI>Start Microsoft Developer Studio.

<P><LI>Select New from the File menu. Then select Project Work Space, and
   click the OK button. For the Project Type, select MFC AppWizard (exe).
   For the name, type test. Also, you may want to change the directory in
   which you save the project by clicking the Browse button and selecting a
   directory. Click the Create button.

<P><LI>In MFC AppWizard Step 1, select the Single document option, and then
   select English [United States] (APPWZENU.DLL). Click the Next button.

<P><LI>In MFC AppWizard Step 2, select the "Database view without file support"
   option. Click the Data Source button. Select the ODBC option, and then
   select tastrade (the name of the ODBC data source created in Step 1).
   Select the Snapshot option for the Recordset type, and click OK. Select
   the customer table, and click OK. Click the Next button.

<P><LI>In MFC AppWizard Step 3, select the None option for the OLE compound
   document support. Click the Next button.

<P><LI>In MFC AppWizard Step 4, clear the "Printing and print preview" check
   box. The Docking toolbar, Initial status bar, and 3D controls should be
   checked. Click the Next button.

<P><LI>In MFC AppWizard Step 5, for generate source file comments, select the
   "Yes, please" option and the "As a shared DLL" option for the the MFC
   library to use. Click the Next button.

<P><LI>In MFC AppWizard Step 6, Click the Finish button. Click the OK button.
<P>
</OL>In Steps 10-13, use the ClassWizard to bind the variables to text boxes on
the form that is displayed.

<OL><P><LI>Select the ResourceView tab. In the Outline, expand the Dialog and
<P><PRE>    double-click IDD_TEST_FORM.
</PRE>
<P><LI>Click the Edit Box control, and draw an edit box on the form. From the
<P><PRE>    View menu, choose ClassWizard. Click the Member Variables tab. Make
    sure the IDC_EDIT1 is the highlighted control, and click the Add
    Variable button. In the Member variable name list, select an
    m_company_name and leave Category as Value and Variable type as
    Cstring. Click the OK button.
</PRE>
<P><LI>From the Build menu, choose Build test.exe.

<P><LI>From the Build menu, choose Execute test.exe
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Inside Visual C++, Chapter 28
Inside ODBC, Chapter 8
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 VFoxWin<BR>
KBCategory: kbinterop kbhowto<BR>
KBSubcategory: FxinteropDbase
<P>

<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
