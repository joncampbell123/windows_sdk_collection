

<HTML>
<HEAD>
<TITLE>How to Query FoxPro Data on the Web Using ODBC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150073">
<META NAME="KBModify" CONTENT="1998/01/09">
<META NAME="KBCreate" CONTENT="1996/04/19">
<META NAME="Keywords" CONTENT="FxinteropGeneral kbhowto kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  This article provides a step-by-step procedure that demonstrates how to use the Visual FoxPro ODBC Driver and the Microsoft Internet Information Server (IIS) to query FoxPro data and display it in an HTML page.  MORE INFORMATION  This example consi...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWA,QA9E,QAA1,QAYY,QBXB,QAVZ,QATJ,QBWS,QAPF,QAFI,QDI2,QAVX,QAVW,QA56,QA55 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Query FoxPro Data on the Web Using ODBC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150073</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
1.00
WINDOWS
kbinterop kbhowto
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Visual FoxPro ODBC Driver version 1.0
<LI>Microsoft Internet Information Server version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article provides a step-by-step procedure that demonstrates how to use
the Visual FoxPro ODBC Driver and the Microsoft Internet Information Server
(IIS) to query FoxPro data and display it in an HTML page.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This example consists of three parts:
<P>
<PRE>   - Setting up a Visual FoxPro ODBC Data Source Name (DSN)
   - Creating the HTML extension (.HTX) file and the Internet Database
     Connector (.IDC) files.
   - Modifying the HTML page to create a link.

</PRE>In this example, you create a data source to the Tastrade database, then
create a query that retrieves names from the customer table. The results of
the query are displayed in an HTML page. All of these operations are
accomplished from the server.
<P>
Before you follow this example, you need to install Windows NT Server
version 3.51 and apply Service Pack 3 or higher. You also need to install
the Microsoft Internet Information Server version 1.0, and the Visual
FoxPro ODBC Driver version 1.0. For more information about installation,
refer to the "Internet Database Connector and ODBC" topic in the Visual
Foxpro online help.
<P>
<P><h3>Setting up a Visual FoxPro System DSN</h3>
 

<OL><P><LI>In Control Panel, click the ODBC icon.

<P><LI>In the Data Sources dialog box, click the System DSN button. Note
   that this step is very important because the Internet Database
   Connector only works with System DSN.

<P><LI>In the System DSN dialog box, click the Add button to display the Add
   Data Source dialog box.

<P><LI>In the Add Data Source dialog box, select the Microsoft Visual
   FoxPro driver and click OK.

<P><LI>Enter the following information in the ODBC Visual FoxPro Setup
   dialog box:
<P>
<P><PRE>      - Data Source Name: Tastrade2
      - Click the Visual FoxPro Database (DBC) button
      - Path: path to the Tastrade.dbc file. By default, tastrade is
<PRE></PRE>              located in the Vfp\samples\mainsamp\data directory.

</PRE><P><LI>Click the OK button. Note that the System Data Sources dialog box is
   displayed and displays the name of the data source you created.
   Click the Close button.

<P><LI>The Data Sources dialog box is displayed. Click the Close button
   to close it.
<P>
</OL><h3>Creating the HTX and the IDC files</h3>
 
<P>
This example assumes that you want to place all of the files in the Myhome
directory, and that the server name is Test. You can, however, place your
HTML file in the server's root directory (wwwroot), and the HTX and IDC
files in the HTML server's script directory (scripts). If you chose not to
create a Myhome directory, you can skip steps 1 through 5.

<OL><P><LI>Start the Microsoft Internet Server.

<P><LI>Double-click the WWW service. Note that the Service Properties
   window is displayed.

<P><LI>In the WWW Service Properties window, click the Directories tab.

<P><LI>Select the c:\Myhome directory (your home directory), and click the
   Edit Properties button.

<P><LI>In the Properties window, select the Execute check box, which will
   allow users to execute the query.

<P><LI>In the c:\Myhome directory, or the scripts directory, create a
   text file called Mydbf.htx. This file is a template for the
   information returned from the query. Copy the following information
   into the file:
<P>
<P><PRE>      &lt;HTML&gt;
      &lt;HEAD&gt;&lt;TITLE&gt;HTTP ODBC Sample&lt;/TITLE&gt;&lt;/HEAD&gt;
      &lt;BODY BGCOLOR="FFFFFF"&gt;
      &lt;TABLE&gt;
      &lt;TR&gt;
      &lt;TD&gt;&lt;/TD&gt;
      &lt;TD&gt;
      &lt;HR&gt;
      &lt;FONT SIZE=2&gt;
      &lt;CENTER&gt;
      &lt;P&gt;
      &lt;!--In this example, the information is displayed in a table-- &gt;
       &lt;TABLE BORDER&gt;
</PRE><P>
<P><PRE>      &lt;TR&gt;
      &lt;TH&gt;&lt;B&gt;Contact Name:&lt;/B&gt;&lt;/TH&gt;&lt;TH&gt;&lt;B&gt;Address:&lt;/B&gt;&lt;/TH&gt;
      &lt;/TR&gt;
</PRE><P>
<P><PRE>      &lt;%begindetail%&gt;
      &lt;TR&gt;&lt;TD&gt;&lt;%contact_name%&gt;&lt;/TD&gt;&lt;TD&gt;&lt;%address%&gt;&lt;/TD&gt;&lt;/TR&gt;
      &lt;%enddetail%&gt;
      &lt;P&gt;
      &lt;/TABLE&gt;
      &lt;/CENTER&gt;
</PRE><P>
<P><PRE>      &lt;HR&gt;
</PRE><P>
<P><PRE>      &lt;/FONT&gt;
      &lt;/TD&gt;
      &lt;/TR&gt;
      &lt;/TABLE&gt;
      &lt;/BODY&gt;
      &lt;/HTML&gt;
</PRE>
<P><LI>Create a text file named Mydbf.idc in the C:\Myhome directory, or
   the scripts directory. This file contains information about the
   system DSN, the user, the HTX file used as a template, and the SQL
   SELECT statement. For example:
<P>
<P><PRE>      Datasource: tastrade2
      Username:
      Template: mydbf.htx
      SQLStatement:
      +SELECT contact_name,address FROM CUSTOMER
</PRE><P>
</OL><h3>Modifying the HTML page to create a link</h3>
 

<OL><P><LI>Add the following information to the HTML page you need to modify.
   This will create a link to the IDC file.
<P>
<P><PRE>      &lt;P&gt;
      &lt;LI&gt;&lt;A href="http://test/mydbf.idc?"&gt;http ODBC Example&lt;/A&gt;
      &lt;P&gt;
</PRE><P>
</OL>To test this setup, start your Web Browser and type the following URL,
which will load the home page on your Test server, or type the URL to the
HTML page you have modified.
<P>
<PRE>         <B>http://test</B>

</PRE></OL>Note that the page contains a hyperlink for the ODBC example. Click "HTTP
ODBC Example," and the information from the Customer table in the Tastrade
database is displayed.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.00 VFoxWin 3.00 3.00b IIS winnt nt internet<BR>
search<BR>
KBCategory: kbinterop kbhowto<BR>
KBSubcategory: FxinteropGeneral<BR>
Keywords          : FxinteropGeneral kbhowto kbinterop<BR>
Version           : 1.00<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
