

<HTML>
<HEAD>
<TITLE>BUG: Outer Join with Another Table in FROM May Cause SQL_ERROR </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q122648">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1994/11/09">
<META NAME="Keywords" CONTENT="kbbug1.02.3231 kbprg kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT=" BUG# Addon_Bugs: 10567 (1.02.3231)   A left outer join between two tables along with a third table in the FROM clause can cause SQL_ERROR to be returned. This happens only when the outer join escape syntax is used and the third table appears after t...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBPJ,QDNB,QA9E,QAY2,QA2Q,QAAP,QAPN,QAG2,QABM,QBWS,QAKP,QAU9,QALZ,QAGB,QAEB V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Outer Join with Another Table in FROM May Cause SQL_ERROR</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q122648</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 1.0
</UL> 
<P>
BUG# Addon_Bugs: 10567 (1.02.3231)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A left outer join between two tables along with a third table in the FROM
clause can cause SQL_ERROR to be returned. This happens only when the outer
join escape syntax is used and the third table appears after the escape
sequence in the FROM clause.
<P>
SQLExecDirect:
<P>
<PRE>   SELECT t1.col1, t1.col2, t2.col1, t2.col2
   FROM {oj testoj1 t1 left outer join testoj2 t2 on t1.col1 = t2.col1},
        testoj3 t3,
   WHERE t3.col1 = t1.col1

</PRE>This generates a syntax error:
<P>
<PRE>   SQLSTATE = 37000 NativeError = 102
   ErrorMsg = [Microsoft][ODBC SQL Server Driver][SQL Server] Incorrect
   syntax near ','

</PRE><h2>CAUSE</h2>
 
<P>
The SQL Server driver incorrectly translates the above SELECT statement to:
<P>
<PRE>   SELECT t1.col1, t1.col2, t2.col1, t2.col2
   FROM  testoj1 t1,  testoj2 t2
   WHERE  t1.col1 *=  t2.col1 ,  testoj3 t3
   WHERE t3.col1 = t1.col1

</PRE>This is incorrect syntax; hence, it causes the error.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
Rewrite the SELECT statement such that testoj3 appears before the outer
join escape clause:
<P>
<PRE>   SELECT t1.col1, t1.col2, t2.col1, t2.col2
   FROM   testoj3 t3,
          {oj testoj1 t1 left outer join testoj2 t2 on t1.col1 = t2.col1}
   WHERE t3.col1 = t1.col1

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in ODBC SQL Server Driver
versions 1.02.3231. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 1.02.3231<BR>
KBCategory: kbprg kberrmsg<BR>
KBSubcategory:
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
