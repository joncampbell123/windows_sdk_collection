

<HTML>
<HEAD>
<TITLE>INF: ODBC Stored Procedures odbc#userid######## on SQL Server </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115907">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1994/06/06">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT="  When an ODBC enabled application uses prepared execution to execute an SQL query on SQL Server and the user has permission to create stored procedures, the ODBC SQL Server driver creates a stored procedure with a name like  odbc#userid########  (fo...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QAB9,QA9N,QABM,QAEF,QDNQ,QAS1,QACI,QAGB,QAU9,QABI,QBVV,QAUJ,QARL,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>INF: ODBC Stored Procedures odbc#userid######## on SQL Server</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115907</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 1.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When an ODBC enabled application uses prepared execution to execute an SQL
query on SQL Server and the user has permission to create stored
procedures, the ODBC SQL Server driver creates a stored procedure with a
name like "odbc#userid########" (for example, odbc#sa2147024896) on SQL
Server and executes that stored procedure.
<P>
The stored procedure is created in response to a SQLPrepare ODBC call and
is executed when SQLExecute is called. Normally, when the connection is
closed, the driver drops these stored procedures. Also, if the user does
not have Create Proc permissions, the stored procedures are not created and
SQL statements are executed directly.
<P>
However, under certain situations when a connection might be terminated
without closing the connection, the driver is not able to delete the stored
procedures. This can happen if the client process terminates abnormally and
is a more common occurrence in a development environment.
<P>
This article describes how to remove these stored procedures from the
SQL Server.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To remove these stored procedures, follow these steps. Make sure no ODBC
client is connected to the server when the following steps are carried out.

<OL><P><LI>Run the following script, with actual database name in the USE
   command, using ISQL.EXE or any other SQL Server client tool and save
   the output so generated in a file called DROP.SQL:
<P>
<P>
<P><PRE>      USE  &lt;database_name&gt;
      go
      SELECT CHAR(13) + CHAR(10)+ "DROP PROCEDURE " + NAME +
<PRE></PRE>             CHAR(13) + CHAR(10) + "go" +
             CHAR(13) + CHAR(10)
      FROM sysobjects
      WHERE name LIKE "ODBC%"
      go

</PRE><P><LI>Modify the DROP.SQL script so generated to include a USE
   &lt;database_name&gt; followed by a go at the top of the file. Remove any
   "-------" lines generated by the tool to separate the header and the
   results. Delete any "(X row(s) affected)" line if generated in the
   output by the tool.
<P>
   Then, the DROP.SQL script file should look something like:
<P>
<P><PRE>      USE &lt;database_name&gt;
      go
</PRE><P>
<P><PRE>      drop procedure odbc#sa1855970
      go
</PRE><P>
<P><PRE>      drop procedure odbc#sa1232424
      go
</PRE><P>
<P><PRE>      ...
</PRE>
<P><LI>Run the DROP.SQL as the input script using a SQL client tool. For
   example, using ISQL.EXE:
<P>
<P><PRE>      isql -S&lt;server&gt; -Usa -P&lt;password&gt; -idrop.sql
</PRE><P>
   and verify that no errors were reported.
<P>
   NOTE: If permission to create stored procedures is revoked
   from the users, the SQL Server driver will not create these stored
   procedures. This can be used as a workaround if it is desired that no
   stored procedures be created by the driver.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbusage<BR>
KBSubcategory:
<P>

Additional reference words: 1.01.2807 VB Visual Basic Access Excel<BR>
Fox MSVC
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
