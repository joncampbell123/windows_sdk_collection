

<HTML>
<HEAD>
<TITLE>BUG: Syntax Error When Using Qualified Table Name with Quotes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124319">
<META NAME="KBModify" CONTENT="1996/09/09">
<META NAME="KBCreate" CONTENT="1994/12/28">
<META NAME="Keywords" CONTENT="kbbug2.00.2317 kbprg">
<META NAME="KBArea" CONTENT="Support; KB; odbc">
<META NAME="Description" CONTENT=" BUG# QJET: 1800 (2.00.2317)   When using table names qualified with the current qualifier and using identifier quote character to enclose the current qualifier and the table name, you receive a syntax error. This happens with dBASE, Paradox, Microso...">
<META NAME="Product" CONTENT="ODBC">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QAUD,QAUJ,QAAP,QAB4,QAU9,QAKP,QA1S,QBVV,QBFY,QBVP,QAY2,QALZ,QALW,QAIA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>BUG: Syntax Error When Using Qualified Table Name with Quotes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124319</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Open Database Connectivity, version 2.0
</UL> 
<P>
BUG# QJET: 1800 (2.00.2317)
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When using table names qualified with the current qualifier and using
identifier quote character to enclose the current qualifier and the table
name, you receive a syntax error. This happens with dBASE, Paradox,
Microsoft FoxPro, Btrieve, Microsoft Excel, and Text Open Database
Connectivity (ODBC) drivers. It does NOT happen with the Microsoft Access
driver.
<P>
For example, in case of dBase driver, if the values returned by
SQLGetConnectOption and SQLGetInfo are as shown:
<P>
<PRE> SQLGetConnectOption(hdbc,SQL_CURRENT_QUALIFIER,pvParam)
      Returns "C:\Database"
 SQLGetInfo(hdbc, SQL_IDENTIFIER_QUOTE_CHAR, rgbInfoValue,cbInfoValueMax)
      Returns "`"
 SQLGetInfo(hdbc, SQL_QUALIFIER_NAME_SEPARATOR,rgbInfoValue,cbInfoValueMax)
      Returns "\"

</PRE>Then you let a table called testtable exist in the data source. The queries
of the form below will receive syntax error SQLState=37000, szErrorMsg=,
<P>
<PRE>   Syntax error in FROM clause

</PRE>when executed using SQLExecDirect or SQLExecute calls.
<P>
<PRE>   Select * from 'C:\Database'\'testtable'
   delete from 'C:\Database'\'testtable'
   Update 'C:\Database'\'testtable' set &lt;colname&gt;=&lt;new value&gt;

</PRE>If you do not use the quote character around the qualifier and the table,
these queries work fine.
<P>
<P><h2>WORKAROUND</h2>
 
<P>
If you do not use the quote character around the qualifier and the table
name, the queries work correctly and do not return errors.
<P>
Alternately, instead of using the backward slash (\) as a separator, if you
use a period (.), which is the separator in the Microsoft Access ODBC
driver, the queries work fine with the qualifier and table name enclosed in
the quote character.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in ODBC DeskTop Database
Drivers Pack version 2.00.2317. We are researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 2.00.2317 ODBC MFC Access Windows NT<BR>
KBCategory: kbprg<BR>
KBSubcategory:
<P>


</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
