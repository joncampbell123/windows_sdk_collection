

<HTML>
<HEAD>
<TITLE>Cannot Start Computer After Running DriveSpace on IBM Computer </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160048">
<META NAME="KBModify" CONTENT="1997/01/09">
<META NAME="KBCreate" CONTENT="1996/11/27">
<META NAME="Keywords" CONTENT="kbtool kberrmsg kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you use DriveSpace to compress a drive on an IBM Aptiva or PS/1 computer, you may receive the following message when you start your computer after the compression process is finished or when DriveSpace restarts your computer during the compres...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QAIJ,QDL7,QBXT,QA5V,QAIB,QDL9,QBWO,QBWN,QBWS,QDIO,QBWQ,QA9N,QBQU,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cannot Start Computer After Running DriveSpace on IBM Computer</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160048</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Plus! for Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use DriveSpace to compress a drive on an IBM Aptiva or PS/1
computer, you may receive the following message when you start your
computer after the compression process is finished or when DriveSpace
restarts your computer during the compression process:
<P>
<PRE>   Windows has disabled direct disk access to protect your long file-
   names. To override this protection, see the LOCK /? command for more
   information.

   The system has been halted. Press CTRL+ALT+DEL to restart your
   computer.

</PRE><h2>CAUSE</h2>
 
<P>
This problem can occur when you are running Ps1pfile.exe from your
Autoexec.bat file. This program attempts to bypass the operating system
and system ROM BIOS and write to the hard disk directly. When programs
attempt to access the hard disk in this manner, Windows 95 prevents the
program from doing so and displays the message.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, use one of the following methods:

<UL><LI>If the message is displayed when you attempt to start your computer
   after the compression process is finished, configure your computer so
   that Ps1pfile.exe is allowed to write to all hard disks on your
   computer directly. To do so, follow these steps:
<P>
   1. Start Windows 95 in Safe mode and then use any text editor (such as
<P><PRE>      Notepad) to open the Autoexec.bat file.
</PRE><P>
   2. Before the line that contains Ps1pfile.exe, insert a line similar to
<P><PRE>      the following for each hard disk on your computer
</PRE><P>
<PRE>         echo y | lock &lt;drive&gt;:\ &gt; nul

      where &lt;drive&gt; is the hard disk letter. For example, if your computer
      contains drive C and drive H, insert the following lines before the
      line that contains Ps1pfile.exe:

         echo y | lock c:\ &gt; nul
         echo y | lock h:\ &gt; nul

      Note that lines for the hard disks on your computer may already
      exist in the file. To determine which hard disks currently exist on
      your computer, run DriveSpace and view the physical drives,
      compressed drives, and host drives that appear in the list of
      drives. To run DriveSpace, click the Start button, point to
      Programs, point to Accessories, point to System Tools, and then
      click DriveSpace.

   3. After the line that contains Ps1pfile.exe, insert a line similar to
      the following for each hard disk on your computer

         unlock &lt;drive&gt;: &gt; nul

      where &lt;drive&gt; is the hard disk letter. For example, if your computer
      contains drive C and drive H, insert the following lines after the
      line that contains Ps1pfile.exe:

         unlock c: &gt; nul
         unlock h: &gt; nul

      Note that lines for the hard disks on your computer may already
      exist in the file.

   4. Save and then close the Autoexec.bat file.

   5. Restart your computer.

</PRE><LI>If the message is displayed when DriveSpace restarts your computer
   during the compression process, remove or disable the line in the
   Autoexec.bat file that contains Ps1pfile.exe. To do so, follow these
   steps.
<P>
   NOTE: The Ps1pfile.exe file may be necessary to use some of the
   Advanced Power Management (APM) features of Windows 95 and your IBM
   computer. If you are unable to use APM features reliably after removing
   the line that contains Ps1pfile.exe, insert the line again. If the
   message is displayed again after you insert the line, perform the steps
   listed above to work around the problem.
<P>
   1. Start a Windows 95 Safe-mode command prompt and then use any text
<P><PRE>      editor (such Edit.com) to open the Autoexec.bat file.
</PRE><P>
   2. Remove or disable the line that contains Ps1pfile.exe. You should
<P><PRE>      also remove or disable any lines that contain the LOCK or UNLOCK
      command that precede or follow the line that contains Ps1pfile.exe.
      For example, you may need to remove or disable lines similar to:
</PRE><P>
<PRE>         echo y | lock c:\ nul
         c:\ps1tools\ps1pfile.exe
         unlock c: nul

      NOTE: To disable the first line above, you should modify the line
      so that it appears as follows (note that the second REM command is
      required):

         rem echo y | rem lock c:\ nul

   3. Save and then close the Autoexec.bat file.

   4. Restart your computer. When you restart your computer, DriveSpace
      should automatically continue the operation that it was performing
      when the message appeared.

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft is researching this problem and will post new information here
in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you install Windows 95 on a computer on which Ps1pfile.exe is running
from the Autoexec.bat file, the Windows 95 Setup program automatically
configures your computer so that Ps1pfile.exe is able to write directly to
the hard disk. Configuring your computer in this manner prevents the
message from appearing when you start your computer.
<P>
However, the Windows 95 Setup program is able to configure your computer
so that Ps1pfile.exe is able to write directly to only the hard disks that
currently exist. If a new drive is added, Ps1pfile.exe is unable to write
directly to the new drive until you reconfigure your computer.
<P>
When you use DriveSpace to compress a drive, an additional logical drive
is created. Because the new drive did not exist when you installed
Windows 95, your computer is not configured so that Ps1pfile.exe can
write directly to the drive. Therefore, if Ps1pfile.exe attempts to
write directly to the drive when you start your computer, Windows 95
prevents it from doing so and displays the message.
<P>
The third-party product discussed in this article is manufactured by a
vendor independent of Microsoft; we make no warranty, implied or other-
wise, regarding this product's performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool kberrmsg kb3rdparty<BR>
KBSubcategory: win95 winplus drvspace diskmem<BR>
Additional reference words: 95<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
