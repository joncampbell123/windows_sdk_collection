

<HTML>
<HEAD>
<TITLE>ODBC Error After Multiple Connections and Disconnections </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154496">
<META NAME="KBModify" CONTENT="1997/11/26">
<META NAME="KBCreate" CONTENT="1996/08/07">
<META NAME="Keywords" CONTENT="win95 kberrmsg kbfile kbnetwork kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you are running ODBC applications using Microsoft ODBC drivers, you may receive the following error message:     General error    Failed to get the expression service  CAUSE =====  This error can occur if ODBC applications connect to and disco...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QDL9,QBWO,QBWN,QA9E,QAB4,QAC1,QBD2,QAY2,QBVX,QAKP,QAAP,QAO0,QAI5,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODBC Error After Multiple Connections and Disconnections</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 26, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154496</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are running ODBC applications using Microsoft ODBC drivers, you
may receive the following error message:
<P>
<PRE>   General error
   Failed to get the expression service

</PRE><h2>CAUSE</h2>
 
<P>
This error can occur if ODBC applications connect to and disconnect from
the server repeatedly (over 50-60 times).
<P>
An example of such an application may be an Internet Web server applica-
tion that is publishing ODBC data. For each Web-page-based query, the Web
server may be opening a connection to the ODBC data source, processing the
query, and then disconnecting from the data source.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95. An
update to address this problem is now available, but is not fully
regression tested and should be applied only to computers experiencing this
specific problem. Unless you are severely impacted by this specific
problem, Microsoft does not recommend implementing this update at this
time. Contact Microsoft Technical Support for additional information about
the availability of this update.
<P>
This issue is resolved by the following updated file for Windows 95:
<P>
<PRE>   Rpcrt4.dll version 4.00.953 (dated 7/23/96) and later

</PRE>To install this update, follow these steps:

<OL><P><LI>Download the Rpcrtupd.exe file from the Microsoft Software Library to
   an empty folder.

<P><LI>In My Computer or Windows Explorer, double-click the Rpcrtupd.exe file
   you downloaded in step 1.

<P><LI>Follow the instructions on the screen.
<P>
</OL>The following file(s) are available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/rpcrtupd.exe">rpcrtupd.exe</A> <I>(size: 273472 bytes)</I> 

</PRE></OL>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE>The following files are installed by Rpcrtupd.exe:
<P>
<PRE>   File name     Version    Date/Time        Size     Destination folder
   ----------------------------------------------------------------------
   Rpcrt4.dll    4.00.953   7/23/96 9:53a    202,752  Windows\System

</PRE><h2>MORE INFORMATION</h2>
 
<P>
For additional information about issues resolved by updates to this
component, please see the following articles in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q149846.htm">Q149846</A></B>
   TITLE     : RPC Program Fails When Server Run Down Occurs
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : win95 kberrmsg kbfile kbnetwork kbfixlist<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 26, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
