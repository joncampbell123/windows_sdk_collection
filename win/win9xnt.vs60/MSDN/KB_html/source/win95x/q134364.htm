

<HTML>
<HEAD>
<TITLE>DriveSpace Real-Mode Driver May Not Be Removed from Memory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134364">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1995/08/06">
<META NAME="Keywords" CONTENT="win95 winplus wpp95 kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  The real-mode memory (conventional or upper) used by DriveSpace (Drvspace.bin or Dblspace.bin) may not be reclaimed when you start Windows 95. This may cause problems with MS-DOS-based programs that require more conventional memory than is availabl...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBW6,QBWQ,QANE,QDL7,QAU9,QAA1,QAIJ,QBWS,QDIV,QAEF,QBVV,QA3P V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DriveSpace Real-Mode Driver May Not Be Removed from Memory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134364</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Plus! for Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The real-mode memory (conventional or upper) used by DriveSpace
(Drvspace.bin or Dblspace.bin) may not be reclaimed when you start
Windows 95. This may cause problems with MS-DOS-based programs that
require more conventional memory than is available.
<P>
Normally, Drvspace.bin (or Dblspace.bin) is unloaded from memory when
the 32-bit DriveSpace driver (Drvspacx.vxd) is initialized at Windows
95 startup.
<P>
<P><h2>CAUSE</h2>
 
<P>
This problem can occur for any of the following reasons:

<UL><LI>You booted to a command prompt, then started Windows 95 by typing
   "win."
<P>
   The real-mode memory used by Drvspace.bin (or Dblspace.bin) cannot be
   reclaimed if you interrupt the normal Windows 95 boot process by
   pressing F8 at the "Starting Windows 95" message, selecting Command
   Prompt Only from the Windows 95 Startup menu, and then typing "win" to
   start Windows 95.

<LI>You loaded Drvspace.bin (or Dblspace.bin) in upper memory using the
   following line:
<P>
<P><PRE>      devicehigh=&lt;path&gt;\drvspace.sys /move
</PRE><P>
   The real-mode memory used by Drvspace.bin (or Dblspace.bin) cannot be
   reclaimed if it is loaded into an upper memory block (UMB).

<LI>LoadTop=0 appears in the Msdos.sys file.
<P>
   A setting of 0 does not let Windows 95 load Drvspace.bin (or
   Dblspace.bin) at the top of conventional memory (just below 640K). This
   prevents the unloading of Drvspace.bin (or Dblspace.bin) at Windows
   startup.

<LI>The 32-bit DriveSpace driver (Drvspacx.vxd) is not loaded.
<P>
   To determine if Drvspacx.vxd is loaded, run DriveSpace, then click
   About DriveSpace on the Help menu. The following table lists by product
   the compression driver filenames, sizes, and versions as reported in
   DriveSpace. "Dblspace.bin" can be substituted for "Drvspace.bin" in
   this table.
<P>
<PRE>      Filename       Product      File Size   About DriveSpace
      ------------------------------------------------------------------
      Drvspace.bin   Windows 95   71,287      Real-mode driver version 2
      Drvspace.bin   MS Plus!     64,135      Real-mode driver version 3
      Drvspacx.vxd   Windows 95   54,207      32-bit driver version 2
      Drvspacx.vxd   MS Plus!     61,719      32-bit driver version 3

</PRE><LI>Dblspace.bin remains in memory if you are using a configuration
   consisting of Drvspace.ini and Dblspace.bin. In this configuration,
   the Dblspace.bin file is loaded as an installable device driver and is
   not transitioned to Drvspacx.vxd. If you use both Dblspace.bin and
   Drvspace.bin with Drvspace.ini, Drvspace.bin is given priority and this
   behavior does not occur.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, use one or more of the following methods:

<UL><LI>Start Windows 95 normally (do not boot to a command prompt, then start
   Windows 95 by typing "win").

<LI>Change the command in the Config.sys file from
<P>
<P><PRE>      devicehigh=&lt;path&gt;\drvspace.sys /move
</PRE><P>
   to:
<P>
<P><PRE>      device=&lt;path&gt;\drvspace.sys /move
</PRE><P>
   NOTE: The syntax of this command is different if you use a third-party
   memory manager (such as Qualitas 386MAX or QuarterDeck QEMM).

<LI>Remove LoadTop=0 from the Msdos.sys file. For information about editing
   the Msdos.sys file, please see the following article in the Microsoft
   Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q118579.htm">Q118579</A></B>
<PRE></PRE>      TITLE     : Contents of the Windows Msdos.sys File

</PRE><LI>Rename the Drvspacx.vxd file in the Windows\System\Iosubsys folder and
   then use the procedure below that applies to your configuration:
<P>
   If Microsoft Plus! for Windows 95 Is Not Installed
   --------------------------------------------------
<P>
   1. Run Windows 95 Setup again.
<P>
   2. Choose "Restore Windows files that are changed or corrupted" when
<P><PRE>      you are prompted.
</PRE><P>
   If Microsoft Plus! for Windows 95 Is Installed
   ----------------------------------------------
<P>
   1. Click the Start button, point to Settings, and then click Control
<P><PRE>      Panel.
</PRE><P>
   2. Double-click the Add/Remove Programs icon.
<P>
   3. On the Install/Uninstall tab, click Microsoft Plus! For Windows 95,
<P><PRE>      and then click Add/Remove.
</PRE><P>
   4. When Setup begins, click Reinstall.
<P>
   Manually Extract Drvspacx.vxd from the Original Disks or CD-ROM
   ---------------------------------------------------------------
<P>
   Manually extract the Drvspacx.vxd file from the original Windows 95 or
   Plus! disks or CD-ROM. If Plus! is installed, be sure to extract the
   Drvspacx.vxd file from the Plus! disks or CD-ROM, not from the Windows
   95 disks or CD-ROM.
<P>
   For more information about the Extract tool, type "extract" (without
   quotation marks) at a command prompt, or see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q129605.htm">Q129605</A></B>
<PRE></PRE>      TITLE     : How to Extract Original Compressed Windows Files

   NOTE: The Drvspacx.vxd file for Windows 95 is located in the
   Win95_09.cab file on disk 9 of the original disks, or in the
   Win95_09.cab file on the CD-ROM.

   The Drvspacx.vxd file for Plus! is located in the Plus_1.cab file on
   disk 1 of the original disks, or in the Plus_1.cab file on the CD-ROM.

</PRE></UL><h2>MORE INFORMATION</h2>
 
<P>
The real-mode DriveSpace driver (Drvspace.bin or Dblspace.bin) is normally
unloaded from memory when the 32-bit DriveSpace driver (Drvspacx.vxd) is
initialized at Windows startup. This frees conventional memory for running
MS-DOS-based programs.
<P>
The real-mode DriveSpace driver is required for accessing compressed
drives when Windows 95 is not running. If you have an MS-DOS-based program
that requires MS-DOS mode, you may need to do one of the following:

<UL><LI>Optimize conventional memory.
<P>
   NOTE: As stated above, Windows 95 cannot unload the real-mode Drive-
   Space driver if it is loaded into upper memory.

<LI>Create a special startup floppy disk. You can then use that disk to
   start your computer without DriveSpace, and then run your program from
   your uncompressed drive.
<P>
   For more information about this procedure, see the "Freeing
   Conventional Memory for Running MS-DOS Programs" section of the
   Microsoft Plus! Readme file for DriveSpace and Compression Agent
   (Drvspace.txt).
<P></UL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 95 winboot.ini dynload VxD<BR>
Keywords          : win95 winplus wpp95 kbenv<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
