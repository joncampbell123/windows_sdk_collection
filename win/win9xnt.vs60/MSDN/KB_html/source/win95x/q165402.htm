

<HTML>
<HEAD>
<TITLE>Windows 95 Update to Encrypt Passwords in Memory </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165402">
<META NAME="KBModify" CONTENT="1997/09/09">
<META NAME="KBCreate" CONTENT="1997/03/19">
<META NAME="Keywords" CONTENT="win95 kbfile kbnetwork kbfixlist">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  If a computer running Windows 95 is left unattended while a user is logged on to a network, it may be possible to obtain that user's network password by a programmatic examination of the computer's memory. Typically,  accomplishing this would requi...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAMB,QAXB,QAC1,QAVZ,QDNE,QBD2,QAWK,QAFI,QAGQ,QDNF,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Windows 95 Update to Encrypt Passwords in Memory</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 9, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165402</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release versions 1, 2, 2.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If a computer running Windows 95 is left unattended while a user is logged
on to a network, it may be possible to obtain that user's network password
by a programmatic examination of the computer's memory. Typically, 
accomplishing this would require physical access to the computer. However,
the network password could also potentially be acquired if a program 
designed to search for passwords using the same examination of memory were
to be downloaded and run by a currently logged-on user.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Windows 95, passwords are encrypted before being sent over the network.
However, the network password for the user who is currently logged on to 
the Windows 95-based computer is stored temporarily in memory in an 
unencrypted format.
<P>
Using detailed knowledge of Windows 95 internal memory structures, it may 
be possible to write a program that runs in Windows 95 and reads the 
password for the currently logged-on user from memory.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Microsoft recommends the following precautions to prevent the current 
user's network password from being accessed by unauthorized means:

<UL><LI>Log off the computer when you leave it for long periods of time.

<LI>Run a password-protected screen saver when you leave the computer
   for short periods of time.

<LI>Do not run untrusted programs on the network, the Web, or that have
   been sent in e-mail.

<LI>Install the update described in this article.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95 and 
OEM Service Release 2 (OSR2). An update to address this problem is now 
available.
<P>
This issue is resolved by the following updated files:

<UL><LI>For Windows 95 (all releases):
<P>
<P><PRE>      Mprserv.dll version 4.00.955 (dated 6/12/97) and later
      Nwnet32.dll version 4.00.951 (dated 4/21/97) and later
      Nwredir.vxd version 4.00.960 (dated 4/21/97) and later
      Pppmac.vxd version 4.00.954 (dated 4/28/97) and later
      Vredir.vxd version 4.00.1114 (dated 6/2/97) and later
      Vnetsup.vxd version 4.00.1112 (dated 6/2/97) and later
</PRE>
<LI>For Windows 95 (retail release) and OEM Service Release 1 (OSR1) 
   only:
<P>
<P><PRE>      Rasapi32.dll version 4.00.954 (dated 4/25/97) and later
</PRE>
<LI>For Windows 95 OSR2 and OSR2.1 only:
<P>
<P><PRE>      Rasapi32.dll version 4.00.1113 (dated 4/25/97) and later
</PRE>
<LI>For the Microsoft Service for NetWare Directory Services [MSNDS] 
   (all Windows 95 releases):
<P>
<P><PRE>      Nwredir.vxd version 4.00.975 (dated 4/21/97) and later
</PRE><P>
</UL>To install this update, follow these steps:

<OL><P><LI>Download the appropriate update file(s) to an empty folder.
<P>
</OL>a. If you are running Windows 95 retail release (version 4.00.950)
<PRE>   or OSR1 (version 4.00.950 A), download the Secupd.exe file.

</PRE></OL>b. If you are running Windows 95 OEM Service Release 2 or 2.1
<PRE>   (version 4.00.950 B), download the Secupd2.exe file.

</PRE>c. If you are running the Microsoft Client for NetWare Networks
<PRE>   with the Microsoft Service for NetWare Directory Services (MSNDS)
   installed, also download the Nwredup4.exe file.

</PRE><P><LI>In My Computer or Windows Explorer, double-click the update file(s)
   you downloaded in step 1.

<P><LI>Follow the instructions on the screen.
<P>
</OL>The following file are available for download from the Microsoft
Software Library:
<P>
<PRE> ~ <A href="http://support.microsoft.com/download/support/mslfiles/secupd.exe">Secupd.exe</A> <I>(size: 496272 bytes)</I> 
 ~ <A href="http://support.microsoft.com/download/support/mslfiles/secupd2.exe">Secupd2.exe</A> <I>(size: 508560 bytes)</I> 
 ~ <A href="http://support.microsoft.com/download/support/mslfiles/nwredup4.exe">Nwredup4.exe</A> <I>(size: 226448 bytes)</I> 

</PRE></OL>For more information about downloading files from the Microsoft Software
Library, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online Services

</PRE><h2>MORE INFORMATION</h2>
 
<P>
These components have been updated to encrypt the current user's network
password even when it is stored in memory so that it cannot be read even
by a programmer with detailed knowledge of Windows 95 internal memory
structures.
<P>
For additional information about Windows 95 security, see Chapter 14
("Security") in the Windows 95 Resource Kit.
<P>
The following files are installed by Secupd.exe:
<P>
<PRE>   File name     Version    Date/Time        Size     Destination folder
   ---------------------------------------------------------------------
   Mprserv.dll   4.00.955   6/12/97  9:54a   127,488  Windows\System
   Nwnet32.dll   4.00.951   4/21/97  9:51a    22,016  Windows\System
   Nwredir.vxd   4.00.960   4/21/97 10:00a   123,987  Windows\System
   Pppmac.vxd    4.00.954   4/28/97  9:54a   135,288  Windows\System
   Vredir.vxd    4.00.1114  6/2/97 11:14a    156,773  Windows\System
   Vnetsup.vxd   4.00.1112  6/2/97 11:12a     17,595  Windows\System
   Rasapi32.dll  4.00.954   4/25/97  9:54a   151,552  Windows\System

</PRE>The following files are installed by Secupd2.exe:
<P>
<PRE>   File name     Version    Date/Time        Size     Destination folder
   ---------------------------------------------------------------------
   Mprserv.dll   4.00.955   6/12/97  9:54a   127,488  Windows\System
   Nwnet32.dll   4.00.951   4/21/97  9:51a    22,016  Windows\System
   Nwredir.vxd   4.00.960   4/21/97 10:00a   123,987  Windows\System
   Pppmac.vxd    4.00.954   4/28/97  9:54a   135,288  Windows\System
   Vredir.vxd    4.00.1114  6/2/97 11:14a    156,773  Windows\System
   Vnetsup.vxd   4.00.1112  6/2/97 11:12a     17,595  Windows\System
   Rasapi32.dll  4.00.1113  4/25/97 11:13a   175,104  Windows\System

</PRE>The following files are installed by Nwredup4.exe:
<P>
<PRE>   File name     Version    Date/Time        Size     Destination folder
   ---------------------------------------------------------------------
   Nwredir.vxd   4.00.975   4/21/97 10:15a   178,714  Windows\System

</PRE>For additional information about issues resolved by updates to these
components, please see the following articles in the Microsoft
Knowledge Base:
<P>
Vredir.vxd:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q165403.htm">Q165403</A></B>
   TITLE     : Windows 95 Update Prevents Sending Clear-Text Password
               Over Net

   ARTICLE-ID: <B><A href="../win95x/q161100.htm">Q161100</A></B>
   TITLE     : File May Be Truncated When Copied to a Full Network
               Drive

   ARTICLE-ID: <B><A href="../urjump.htm">Q157114</A></B>
   TITLE     : "Access Denied" Attempting to Run File on LM/X Server

   ARTICLE-ID: <B><A href="../urjump.htm">Q156497</A></B>
   TITLE     : Duplicate Print Output on PC-LAN Server from Windows 95
               Client

   ARTICLE-ID: <B><A href="../win95x/q140558.htm">Q140558</A></B>
   TITLE     : Deleting Files on Samba Servers May Delete Local Files
               Instead

   ARTICLE-ID: <B><A href="../urjump.htm">Q138249</A></B>
   TITLE     : Updated Vredir.vxd Corrects Errors Running Files on LMX

   ARTICLE-ID: <B><A href="../win95x/q160807.htm">Q160807</A></B>
   TITLE     : Cannot Connect to Windows NT Server with Many Shares

   ARTICLE-ID: <B><A href="../win95x/q150215.htm">Q150215</A></B>
   TITLE     : Disabling Automatic Network Shortcut Resolution

   ARTICLE-ID: <B><A href="../win95x/q138014.htm">Q138014</A></B>
   TITLE     : File May Be Truncated to Zero Bytes When Copied Onto
               Itself

   ARTICLE-ID: <B><A href="../win95x/q136834.htm">Q136834</A></B>
   TITLE     : Error Copying Read-Only Files to Core SMB Server

</PRE>Nwredir.vxd:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q163673.htm">Q163673</A></B>
   TITLE     : "Exception 0E" Using MSNDS Over Dial-Up Connection

   ARTICLE-ID: <B><A href="../win95x/q160824.htm">Q160824</A></B>
   TITLE     : MSNDS Drops Connections to More Than Eight Servers

   ARTICLE-ID: <B><A href="../urjump.htm">Q153470</A></B>
   TITLE     : Incorrect Error Code Returned for Locked Files

   ARTICLE-ID: <B><A href="../urjump.htm">Q149606</A></B>
   TITLE     : Fatal Exception 0E in VNETBIOS Using NetWare Login
               Script

   ARTICLE-ID: <B><A href="../win95x/q147838.htm">Q147838</A></B>
   TITLE     : Cannot Access Folders with Long File Names on NetWare
               Servers

   ARTICLE-ID: <B><A href="../win95x/q143282.htm">Q143282</A></B>
   TITLE     : No Documents Appear in the File Open Dialog Box

   ARTICLE-ID: <B><A href="../win95x/q139747.htm">Q139747</A></B>
   TITLE     : MS-DOS-Based Program Reports Not Enough NetWare
               Server Space

   ARTICLE-ID: <B><A href="../urjump.htm">Q136303</A></B>
   TITLE     : Connecting to Schedule+ 1.0 Calendar File Drops
               Connections

</PRE>Rasapi32.dll/Pppmac.vxd:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q164377.htm">Q164377</A></B>
   TITLE     : Cannot Connect to Remote Access Server with Dial-Up
               Networking

   ARTICLE-ID: <B><A href="../win95x/q149396.htm">Q149396</A></B>
   TITLE     : Cannot Change Expired Windows NT Password with DUN

   ARTICLE-ID: <B><A href="../crossnet/q154434.htm">Q154434</A></B>
   TITLE     : Err Msg: No Domain Controller Was Available to
               Validate...
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 security<BR>
Keywords          : win95 kbfile kbnetwork kbfixlist<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 9, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
