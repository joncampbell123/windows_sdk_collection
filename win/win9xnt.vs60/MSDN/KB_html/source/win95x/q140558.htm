

<HTML>
<HEAD>
<TITLE>Deleting Files on Samba Servers May Delete Local Files Instead </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140558">
<META NAME="KBModify" CONTENT="1997/05/01">
<META NAME="KBCreate" CONTENT="1995/12/03">
<META NAME="Keywords" CONTENT="3rdpartynet dun msnets win95 kb3rdparty kbfile kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you use the Microsoft Client for Microsoft Networks (Vredir.vxd) to connect to a Samba file server running on a UNIX-based computer and you try to delete files on the server, you may delete files on your Windows 95-based computer instead.  CAU...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAEF,QBWE,QAGB,QBJ4,QAJ4,QBCT,QAGC,QAVZ,QBIC,QAFI,QBWQ,QDKD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Deleting Files on Samba Servers May Delete Local Files Instead</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140558</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
95
WINDOWS
kbfile kbnetwork kb3rdparty
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use the Microsoft Client for Microsoft Networks (Vredir.vxd) to
connect to a Samba file server running on a UNIX-based computer and you
try to delete files on the server, you may delete files on your Windows
95-based computer instead.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior occurs because Samba file servers let you create file names
with characters that are invalid in Windows 95. These invalid characters
include the following characters:

<UL><LI>backslash (\)
<LI>asterisk (*)
<LI>question mark (?)
<P>
</UL>For example, Samba file servers let you create file names such as "c:\*.*"
or "\\server\share\*.*" (without the quotation marks). If a UNIX user
creates a file called "c:\*.*" and shares it, a Windows 95 user who
connects to the server and tries to delete the file with Windows Explorer
or My Computer may delete all the files in the root directory of local
drive C instead.
<P>
NOTE: You are not affected by this problem if any of the following
conditions are true:

<UL><LI>You are not connected to a local area network.

<LI>You do not use a dial-up application (such as Dial-Up Networking) to
   dial into a local area network.

<LI>You are connected to a local area network, but you do not connect to
   Samba file servers running on UNIX-based computers.

<LI>You connect to Samba file servers running on UNIX-based computers but
   you delete only files you created with Windows Explorer or My
   Computer.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Although this is not a problem with Windows 95, Microsoft has released a
new version of the Vredir.vxd file (version 4.00.955) that filters out
files that have file names with invalid characters. When you use the
updated version of the Vredir.vxd file, you cannot see these files and
cannot, therefore, try to delete them.
<P>
To install the updated Vredir.vxd file, follow these steps:

<OL><P><LI>Download the Vredrupd.exe file from one of the online services listed
   below to an empty folder.

<P><LI>In My Computer or Windows Explorer, double-click the Vredrupd.exe file.

<P><LI>Follow the instructions on your screen.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Instructions for Downloading</h3>
 
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/vredrupd.exe">VREDRUPD.EXE</A> <I>(size: 168936 bytes)</I> 
                         , a self-extracting file, on the following
</PRE></OL>services:

<UL><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/vredrupd.exe">VREDRUPD.EXE</A> <I>(size: 168936 bytes)</I> 
                               , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/vredrupd.exe">VREDRUPD.EXE</A> <I>(size: 168936 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/vredrupd.exe">VREDRUPD.EXE</A> <I>(size: 168936 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services

</PRE>Note that Microsoft has also released this update as part of Microsoft
Windows 95 Service Pack 1. For information about Microsoft Windows 95
Service Pack 1, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q142794.htm">Q142794</A></B>
   TITLE     : Availability of Microsoft Windows 95 Service Pack 1
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbfile kbnetwork kb3rdparty<BR>
KBSubcategory: win95 msnets 3rdpartynet dun<BR>
Additional reference words: 95 smbclient servicepack1<BR>
Keywords            : 3rdpartynet dun msnets win95 kb3rdparty kbfile kbnetwork<BR>
Version             : 95<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
