

<HTML>
<HEAD>
<TITLE>Duplicating Windows 95 Installation to a New Hard Disk </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q166172">
<META NAME="KBModify" CONTENT="1997/08/14">
<META NAME="KBCreate" CONTENT="1997/04/01">
<META NAME="Keywords" CONTENT="diskmem win95 kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article describes how to swap your current primary boot hard disk (usually drive C) with a different hard disk and retain your current files and system configuration in the process. This primarily involves installing Windows 95 on a new hard d...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAC9,QA3W,QAA1,QDL9,QBWO,QBWN,QBWQ,QDIU,QAUR,QDI2,QBWS,QASR,QDNF,QAIJ,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Duplicating Windows 95 Installation to a New Hard Disk</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q166172</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to swap your current primary boot hard disk
(usually drive C) with a different hard disk and retain your current
files and system configuration in the process. This primarily involves
installing Windows 95 on a new hard disk and ensuring proper
identification of the new hardware. This process uses Microsoft Backup to
back up and restore files and configuration and registry settings.
<P>
Note that the method described in this article cannot be used to copy 
Windows 95 installations to multiple computers. Microsoft only supports 
the use of the standard Setup procedure as described in the Windows 95 
product documentation for each computer on which Windows 95 is installed.
<P>
WARNING: Before proceeding, fully review this article. Because of the
many steps involved, use this article only if you feel you have
sufficient experience to correctly perform all required steps. If not,
the safest approach is to back up your data files, run Windows 95 Setup
on your new hard disk, reinstall all of your programs from original
program CD-ROMs or disks, and then restore your data from backup.
<P>
If after reviewing this article you choose to proceed, carefully execute
each set of steps as written.
<P>
IMPORTANT: This article applies only to the replacement of the hard disk.
Do not use this article if other hardware changes are being made.
Improper use of this article can result in the loss of all data on your
hard disk. Microsoft is responsible only for the information pertaining
to Microsoft software installation detailed in this article. For correct
procedures and safeguards when handling hardware, refer to the
documentation included with your hardware, or contact your hardware
vendor. Improper handling of hardware can be dangerous and can cause
permanent damage to your computer. If you are unsure how to handle
hardware, we recommend that you have a factory-qualified hardware
technician perform the upgrade.
<P>
<P><h3>Notes</h3>
 

<UL><LI>The WARNING designation is placed before procedures in which a mistake
   in following instructions can cause serious data loss. At these
   points, verify that you have properly followed the directions.

<LI>The information in this article applies only when Windows 95 is the
   primary operating system running on a standard MS-DOS partition.
   Windows 95 Backup cannot read files from non-MS-DOS partitions. A new
   installation of Windows 95 overwrites the Windows NT boot sector on
   computers configured to dual boot Windows NT, disabling the ability to
   start Windows NT.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Disks and Information Required</h3>
 

<UL><LI>Windows 95 Startup disk.
<P>
   To create a Startup Disk, follow these steps:
<P>
   1. In Control Panel, click Add/Remove Programs.
<P>
   2. On the Startup Disk tab, click Create Disk.

<LI>Proof of ownership of the previous operating system.
<P>
   You will need disk 1 of the disk set on which one of the previous
   operating systems was distributed:
<P>
<P><PRE>    - Microsoft Windows version 3.x
    - Microsoft Windows NT version 3.x or later
    - OS/2
</PRE><P>
   If you are reinstalling the full retail version of Windows 95 or
   Windows 95 OEM Service Release 2 (OSR2), proof of ownership of a
   previous operating system is not required.

<LI>CD-ROM driver installation disk.
<P>
   This disk must contain the MS-DOS-level drivers supplied by your
   hardware manufacturer. This applies only if you have the CD-ROM
   Upgrade version of Windows 95.

<LI>Complete set of Windows 95 Setup disks (if you are reinstalling
   Windows 95 from floppy disks).
<P>
   NOTE: If your computer came with Windows 95 preinstalled and you do
   not have a vendor-supplied Windows 95 CD-ROM or disks, refer to the
   literature that came with your computer for instructions on obtaining
   the software.

<LI>The name of the folder in which Windows 95 is currently installed
   (typically C:\Windows).
<P>
</UL><h3>Choosing a Backup Method</h3>
 
<P>
The procedures outlined in this article require Microsoft Backup, which
is supplied with Windows 95. If Backup is not currently installed, see
the instructions in the "Installing Windows 95 on Your New Hard Disk"
section below.
<P>
Each of the following methods uses different hardware. Choose one of the
following two methods:

<UL><LI>Windows 95 Backup with a compatible tape backup hardware device
   attached to your computer. See the instructions in the "Method 1"
   section below.

<LI>Windows 95 Backup using both the original and new hard disks attached
   to the computer at the same time. See the instructions in the "Method
   2" section below.
<P>
</UL><h3>Method 1: Using Backup with a Tape Drive</h3>
 
<P>
This method requires compatible tape drive hardware. For more
information, start Microsoft Backup from the System Tools menu, click
Help, and refer to the "Tape drives that are compatible with Backup"
topic.
<P>
WARNING: When you are using Backup as described below, manually selecting
drive C instead of using the Full System Backup set does not back up
vital parts of your system (such as registry files). If you do not see
the following message after Step 5 in the following procedure, you have
not performed these steps correctly and you will need to restart the
process:
<P>
<PRE>   Microsoft Backup is now making a copy of the settings in your system
   registry. This will take a few minutes.

</PRE>Before starting Backup, perform the following steps:

<OL><P><LI>In My Computer, click Options on the View menu.

<P><LI>On the View tab, make sure the Show All Files option is enabled.

<P><LI>Rename the following files:
<P>
<PRE>      File           New name
      ---------------------------
      System.1st     System.1sx
      Suhdlog.dat    Suhdlog.dax
      Setuplog.txt   Setuplog.txx
      Detlog.txt     Detlog.txx
      Bootlog.txt    Bootlog.txx

   NOTE: These files must be renamed, not copied.

</PRE></OL>After you follow steps 1-3 above, use the following steps to back up your
hard disk:

<OL><P><LI>Click the Start button, point to Programs, point to Accessories, point
   to System Tools, and then click Backup.

<P><LI>Click OK to close preliminary informational dialog boxes.

<P><LI>Click the Backup tab.

<P><LI>On the File menu, click Open File Set.

<P><LI>Click Full System Backup, and then click Open.

<P><LI>Click Next Step, select the destination tape drive, and then click
   Start Backup.
<P>
   NOTE: If Backup does not automatically detect your tape drive, see the
   following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q130946.htm">Q130946</A></B>
<PRE></PRE>      TITLE     : Troubleshooting Windows 95 Backup

</PRE><P><LI>Type a name for the backup set, and then click OK. Record the name for
   later use.
<P>
</OL>When Backup is finished backing up your files, click OK to close the
program, then perform the following steps:

<OL><P><LI>Shut down Windows 95 and turn off your computer.

<P><LI>Detach the original hard disk from your computer, then attach the new
   hard disk in its place.
<P>
   For hardware setup and configuration information, see the
   documentation included with your hardware or contact your hardware
   vendor.

<P><LI>When the new hard disk is set up correctly, go to the "Preparing Your
   New Hard Disk" section below.
<P>
</OL><h3>Method 2: Using Backup with Your New Hard Disk</h3>
 
<P>
WARNING: Do not use method 2 if your computer requires disk overlay
software to access your hard disks.
<P>
Before starting Backup, calculate the estimated minimum disk space
required on your new hard disk as follows:
<P>
<PRE>   (total space in use on current hard disk) + ((total space in use on
   current hard disk) * 0.66)

</PRE></OL>For example, if your current hard disk has 400 MB total used space, the
estimated minimum disk space required on the new disk would be:
<P>
<PRE>   400 MB + (400 MB * 0.66) = 664 MB

</PRE>The result equals the approximate size of a full system backup. The ratio
(in this case 3:2) is only an estimate and varies from drive to drive
depending on the file types being backed up.
<P>
The new hard disk must have at least the estimated minimum disk space
available.
<P>
If your current hard disk is compressed, substitute 1.0 for 0.66 in your
calculation. In the example above, the required space would become 800
MB.
<P>
If you have inadequate storage space on your new hard disk and you cannot
remove any files or data, use method 1 instead. Note that the Temporary
Internet Files folder may contain files that can be safely removed.
<P>
Install the New Hard Disk as a Secondary Drive:
<P>
Before running Backup, you need to install and configure your new hard
disk. For information about how to install and configure your hardware,
refer to the documentation that came with your hard disk or contact your
hardware vendor.
<P>
After your new hard disk is configured, follow these steps:

<OL><P><LI>Follow the instructions in the "Preparing Your New Hard Disk Using
   FDISK and FORMAT" section below.

<P><LI>When formatting is finished, follow the Backup instructions in the
   "Method 1" section above. Modify the instructions in step 6 to back up
   your files to the new hard disk (usually drive D).

<P><LI>When Backup is finished, shut down Windows 95, turn off your computer,
   and remove the original hard disk from the computer, leaving the new
   disk in place.

<P><LI>Boot with the Windows 95 Startup disk.

<P><LI>Run FDISK to set the primary partition on the new disk as the active
   partition. For information about using FDISK, see the following
   section.

<P><LI>Restart your computer to a command prompt.

<P><LI>Proceed to the "Installing Windows 95 on Your New Hard Disk" section
   below.
<P>
</OL><h3>Preparing Your New Hard Disk Using FDISK and FORMAT</h3>
 
<P>
WARNING: If your computer requires disk overlay software to access your
hard disks, apply FDISK and FORMAT as described below only if advised to
do so in the documentation provided by your overlay software manufacturer.
The installation of the overlay software may provide functionality equal
to that described in this section.
<P>
Most new hard disks have not been partitioned or formatted. If your new
hard disk requires this basic configuration, use the following tools to
prepare it for file installation.
<P>
Partition Your New Hard Disk with FDISK:
<P>
WARNING: Before proceeding, verify that the disk you are about to
partition is the new hard disk and contains no important data. If you
are unsure, stop immediately.
<P>
For information about using FDISK to partition your hard disk, see the
"Repartitioning Your Hard Disk" section in following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q106423.htm">Q106423</A></B>
   TITLE     : PD0771: Repartitioning Your Hard Disk to Upgrade to 6.0
               or 6.2

</PRE></OL>NOTE: You can use the Windows 95 Startup DISK in place of the MS-DOS 6.x
disks mentioned in the article.
<P>
Using FORMAT to Prepare the File System:
<P>
After the new drive is partitioned, run the FORMAT tool as follow:

<OL><P><LI>Insert the Windows 95 Startup disk in drive A and then restart your
   computer.

<P><LI>At the command prompt, type the following line.
<P>
   WARNING: Verify that the hard disk you are formatting is the new empty
   hard disk.
<P>
<P><PRE>      format c: /s
</PRE>
<P><LI>Press Y, and then press ENTER.

<P><LI>When formatting is finished, type a volume label or leave it blank,
   and then press ENTER.

<P><LI>Remove the disk from drive A and restart your computer to a command
   prompt.
<P>
</OL>Next, install Windows 95 on the new hard disk.
<P>
<P><h3>Installing Windows 95 on Your New Hard Disk</h3>
 
<P>
For Windows Setup information, refer to the "Setting Up Windows 95"
section of the booklet included with your Windows 95 CD-ROM or disks. If
Windows 95 came preinstalled on your computer, refer to your
manufacturer-supplied documentation.
<P>
When you are setting up Windows 95, verify that the folder in which you
are installing Windows 95 has the same name as the original folder
(typically C:\Windows).
<P>
NOTE: The Setup procedure requires access to your original Windows 95
disks or CD-ROM or to the server-based-Setup shared installation of
Windows 95. To install from a CD-ROM, the real-mode CD-ROM drivers must
be loaded in the Autoexec.bat and Config.sys files. Refer to the
documentation included with your CD-ROM drive for driver installation
instructions.
<P>
When you are prompted during Setup, choose a typical installation.
<P>
After Windows 95 Setup is finished, install the Microsoft Backup program
as follows:

<OL><P><LI>In Control Panel, double-click Add/Remove Programs.

<P><LI>On the Windows Setup tab, click Disk Tools, and then click Details.

<P><LI>Click the Backup check box to select it, and then click OK.
<P>
</OL>Next, restore the files from your backup file set.
<P>
<P><h3>Restoring Files and Folders from Backup</h3>
 
<P>
Before you restore your files and folders, verify that the following
options are enabled in Backup:

<UL><LI>Restore Backed Up Files To should be set to Original Location

<LI>Overwrite Older Files Only should be selected under Advanced
   Options
<P>
</UL>To access these options, start Backup, click Options on the Settings
menu, and then click the Restore tab.
<P>
To restore your files and folders, follow these steps:

<OL><P><LI>Start Backup.

<P><LI>Click OK in the initial informational dialog boxes.

<P><LI>Click the Restore tab.

<P><LI>For method 1, click your tape drive. For method 2, click drive C in
   the Restore From pane.

<P><LI>Click the correct backup set, and then click Next Step.

<P><LI>In the Select Files From Backup Set pane, use the appropriate method:
<P>
<P><PRE>    - For method 1, double-click the tape drive icon, then click the
      check box in front of the icon.
</PRE><P>
<P><PRE>    - For method 2, double-click the backup set name, then click the
      check box in front of the backup set name. Clear the check box for
      the secondary hard disk (usually drive D) in the Contents pane.
</PRE>
<P><LI>Click the Start Restore button.
<P>
</OL>WARNING: If you are restoring files that were compressed on the original
drive to an uncompressed drive, the new hard disk must have at least two
times the storage capacity of the original hard disk. The exact ratio may
vary depending on the file types being restored.
<P>
Backup restores the registry entries when the program is finishing. The
following text appears in a dialog box near the end of the process:
<P>
<PRE>   Microsoft Backup is now restoring the settings in your system
   registry. This may take a few minutes. Do not shut down your computer
   until the registry is fully restored, or your computer will not work
   properly.

</PRE></OL><h3>Restarting Windows 95 on Your New Hard Disk</h3>
 
<P>
When Backup has finished restoring your files, you will be notified that
you must restart the computer. Close all dialog boxes, quit Backup, and
restart your computer.
<P>
NOTE: If after rebooting you receive the message "Invalid System Disk.
Replace the disk, and then press any key," follow these steps:

<OL><P><LI>Insert your Windows 95 Startup disk in drive A and press any key.

<P><LI>At the command prompt, type:
<P>
<P><PRE>      a:\sys c:
</PRE>
<P><LI>Remove the disk from drive A and restart your computer.
<P>
</OL>Your computer is now ready to use with the same files and programs that
were on your previous hard disk.
<P>
<P><h3>Deleting the Backup File on the Hard Disk (Method 2 Only)</h3>
 
<P>
When you have verified that all files and programs have been properly
restored to their previous functionality, you can delete the file created
by Backup in the root folder. The file name is the name given in step 7
of the backup instructions in method 1 and is displayed with a .qic
extension if Windows Explorer is set to show file extensions.
<P>
<P><h3>Additional Information</h3>
 
<P>
Using the procedures in this article to back up and restore files to your
new hard disk protects your current configuration and long file names. If
you chose to back up your previous operating system during your initial
upgrade to Windows 95, you retain the ability to uninstall Windows 95.
<P>
The procedures listed in this article for swapping a hard disk containing
Windows 95 on drive C with a new hard disk are the only procedures
supported by Microsoft. Other methods may cause system instability or
data loss.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : diskmem win95 kbenv<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
