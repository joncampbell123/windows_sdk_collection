

<HTML>
<HEAD>
<TITLE>Disk Tools Run by System Agent Pause for User Input </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q135962">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1995/08/30">
<META NAME="Keywords" CONTENT="plusfest win95 winplus kbtool">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   When System Ag...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAL4,QBVV,QBW5,QAH4,QDI5,QABA,QBAO,QAKD,QAB5,QAC9,QAAP,QAUJ,QAB4,QDL9,QBWO V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Disk Tools Run by System Agent Pause for User Input</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q135962</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
95
WINDOWS
kbtool
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Plus! for Windows 95
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When System Agent runs one of the disk tools (Compression Agent, Disk
Defragmenter, or ScanDisk), the tool may pause for user input. Typically,
the tool is prompting for the drive on which it should run, or is waiting
for you to click the Start button.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior can occur if the System Agent-aware registry settings for the
disk tool are missing or damaged. If the disk tool does not have valid
registry settings, System Agent does not start the disk tool in unattended
operation mode.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use Registry Editor to verify that the correct registry settings exist for
the disk tool. The System Agent-aware registry settings are located in the
following registry branch:
<P>
<PRE>   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Plus!\System Agent\SAGE

</PRE>Each disk tool has a key beneath this branch. The keys for the disk tools
are:

<UL><LI>Compression Agent
<LI>Disk Defragmenter
<LI>Low disk space notification
<LI>ScanDisk for Windows
<P>
</UL>The following tables list the default values under these keys. These
settings are required to make the tools function in unattended operation
mode.
<P>
<P><h3>Compression Agent</h3>
 
<P>
<PRE>   Type            Name             Data
   --------------------------------------------------
   String Value    Friendly Name    Compression Agent
   String Value    Program          CMPAGENT.EXE
   Binary Value    Settings         01

</PRE><h3>Disk Defragmenter</h3>
 
<P>
<PRE>   Type            Name             Data
   --------------------------------------------------
   String Value    Friendly Name    Disk Defragmenter
   String Value    Program          DEFRAG.EXE
   Binary Value    Settings         01

</PRE><h3>Low Disk Space Notification</h3>
 
<P>
<PRE>   Type            Name             Data
   ------------------------------------------------------------
   String Value    Friendly Name    Low disk space notification
   String Value    Program          DISKALM.EXE
   Binary Value    Settings         01

</PRE><h3>ScanDisk for Windows</h3>
 
<P>
<PRE>   Type            Name             Data
   -----------------------------------------------------
   String Value    Friendly Name    ScanDisk for Windows
   String Value    Program          SCANDSKW.EXE
   Binary Value    Settings         01

</PRE>For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Windows 95. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved.
Use Registry Editor at your own risk.
<P>
NOTE: You can also restore these settings by reinstalling System Agent. For
information about reinstalling System Agent without losing your current
System Agent settings, please see the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q133191.htm">Q133191</A></B>
   TITLE     : Reinstalling System Agent Without Losing Scheduled Tasks

</PRE><h2>MORE INFORMATION</h2>
 
<P>
In addition to the settings listed above, each key contains a Result Codes
subkey. The Result Codes subkey is not required to make a tool System Agent-
aware, but without these settings the Last Result column in System Agent
and the System Agent log file contains only code numbers. The following
tables list the result code settings for each disk tool. All of these
settings are String Values.
<P>
<P><h3>Compression Agent\Result Codes</h3>
 
<P>
<PRE>   Name      Data
   ------------------------------------------------------------------
     0       Completed Successfully
     1       Some files could not be optimized, due to low disk space
     2       Unsuccessful; not enough free space
     3       The process was interrupted before completing
     4       Unsuccessful; drive contains errors
     5       Unsuccessful; error reading from drive
     6       Unsuccessful; error writing to drive
     9       Unsuccessful; not enough memory
    10       Unsuccessful; drive was invalid
    11       Unsuccessful; no DriveSpace 3 drives found
    15       Unsuccessful; disk was write-protected
    26       Unsuccessful; could not access drive
   105       Unsuccessful; drive was locked
   106       Unsuccessful; could not access drive
   108       Unsuccessful; could not access drive
   109       Unsuccessful; 32-bit compression driver not installed
   249       One or more drives could not be recompressed
   Success   1

</PRE><h3>Disk Defragmenter\Result Codes</h3>
 
<P>
<PRE>   Name      Data
   ---------------------------------------------------------------
     0       Completed Successfully
     2       Unsuccessful; not enough free space
     3       The process was interrupted before completing
     4       Unsuccessful; drive contains errors
     5       Unsuccessful; error reading from drive
     6       Unsuccessful; error writing to drive
     9       Unsuccessful; not enough memory
    10       Unsuccessful; the drive was invalid
    15       Unsuccessful; disk was write-protected
    26       Unsuccessful; could not access drive
   105       Unsuccessful; drive was locked
   106       Unsuccessful; could not access drive
   108       Unsuccessful; could not access drive
   109       Unsuccessful; 32-bit compression driver not installed
   249       One or more drives could not be defragmented
   Success   0

</PRE><h3>Low Disk Space Notification\Result Codes</h3>
 
<P>
<PRE>   Name      Data
   --------------------------------
   0         Completed Successfully
   Success   0

</PRE><h3>ScanDisk for Windows\Result Codes</h3>
 
<P>
<PRE>   Name      Data
   ----------------------------------------------------------
     0       No errors found
     1       Errors found and all were fixed
   249       One or more drives could not be checked
   250       Drive could not be checked - could not load
             or find DSKMAINT.DLL
   251       Drive could not be checked - insufficient memory
   252       Errors were found and some were not fixed
   254       Check was canceled
   255       Check was stopped because of an error
   Success   1
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtool<BR>
KBSubcategory: plusfest win95 winplus<BR>
Additional reference words: 95 sage sagelog.txt<BR>
Keywords          : plusfest win95 winplus kbtool<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
