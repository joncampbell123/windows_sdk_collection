

<HTML>
<HEAD>
<TITLE>Troubleshooting DriveSpace in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q133175">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1995/07/25">
<META NAME="Keywords" CONTENT="drvspace win95 kbtool kbtshoot">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT=" This article describes troubleshooting steps that may help you solve problems with DriveSpace in Windows 95. This information is also available in our Windows 95 DriveSpace Troubleshooting Wizard. We recommend using this wizard, but we have also cre...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDL7,QAC9,QAR4,QAB4,QDL9,QDIV,QBWO,QBWN,QABI,QBWQ,QBVV,QAFI,QDJ6,QAIJ,QABY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting DriveSpace in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q133175</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
95
WINDOWS
kbtool kbtshoot
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Plus! for Windows 95
<LI>Microsoft Windows 95 OEM Service Release version 2
</UL> 
<P>
This article describes troubleshooting steps that may help you solve
problems with DriveSpace in Windows 95. This information is also available
in our Windows 95 DriveSpace Troubleshooting Wizard. We recommend using
this wizard, but we have also created this text-based article for your
convenience. The Windows 95 DriveSpace Troubleshooting Wizard is located
on:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/tshoot/default.asp">http://support.microsoft.com/support/tshoot/default.asp</A></B>

</PRE><h2>SUMMARY</h2>
 
<P>
This article describes how to troubleshoot the following problems with
DriveSpace in Windows 95:

<UL><LI>DriveSpace displays an error message
<LI>Your computer stops responding (hangs) during compression
<LI>Your computer does not boot properly after compressing a drive
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>DriveSpace Displays an Error Message</h3>
 
<P>
If you receive an error message while running DriveSpace, check the
Microsoft Knowledge Base for existing articles about that error message.
Some of the most common errors are:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q124558.htm">Q124558</A></B>
   TITLE     : DriveSpace Err Msg: Mini.cab File Is Missing or Damaged...

   ARTICLE-ID: <B><A href="../win95x/q132883.htm">Q132883</A></B>
   TITLE     : Err Msg: Drive C Contains Errors That Must Be Corrected...

   ARTICLE-ID: <B><A href="../win95x/q123441.htm">Q123441</A></B>
   TITLE     : Windows 95 DriveSpace Err Msg: Windows Cannot Perform...

   ARTICLE-ID: <B><A href="../win95x/q154839.htm">Q154839</A></B>
   TITLE     : Err Msg: Windows Has Detected a Compressed Drive Access
               Error

   ARTICLE-ID: <B><A href="../win95x/q134859.htm">Q134859</A></B>
   TITLE     : DriveSpace VxD and Real-Mode Driver Are Mismatched

   ARTICLE-ID: <B><A href="../win95x/q142919.htm">Q142919</A></B>
   TITLE     : Error Message: ID Number DRVSPACE125

   ARTICLE-ID: <B><A href="../win95x/q155689.htm">Q155689</A></B>
   TITLE     : Error Message: Mini.cab Is Missing or Corrupt

</PRE><h3>Computer Hangs During Compression</h3>
 
<P>
If your computer hangs while DriveSpace is running, follow these steps:

<OL><P><LI>If DriveSpace stops when it is 25 percent finished, see the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q136830.htm">Q136830</A></B>
<PRE></PRE>      TITLE     : DriveSpace May Fail to Start in Mini-Windows Mode

</PRE><P><LI>If DriveSpace stops when it is between 25 and 100 percent finished, see
   the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID:<B><A href="../win95x/q136899.htm">Q136899</A></B>
<PRE></PRE>      TITLE     :  DriveSpace Restartability in Windows 95 and MS Plus!

</PRE><P><LI>If DriveSpace stops while you are uncompressing or resizing a
   compressed drive, follow these steps:
<P>
   a. Start your computer with your Windows 95 or Microsoft Plus! Startup
<P><PRE>      disk. When you see the "Starting Windows 95" message, press the F8
      key, and then choose Step-By-Step Confirmation from the Startup
      menu. Press N when you are prompted to load the DoubleSpace or
      DriveSpace driver.
</PRE><P>
<P><PRE>      NOTE: If you did not create a Startup disk during Windows 95 Setup,
      or you did not update your Startup disk during Microsoft Plus!
      Setup, you can create a Startup disk manually.
</PRE><P>
<P><PRE>      For information about creating or updating a Startup disk, please
      see the following articles in the Microsoft Knowledge Base:
</PRE><P>
<PRE>         ARTICLE-ID: <B><A href="../win95x/q138991.htm">Q138991</A></B>
         TITLE     : Problems Using Windows 95 or Microsoft Plus! Startup
                     Disk

         ARTICLE-ID: <B><A href="../win95x/q136900.htm">Q136900</A></B>
         TITLE     : Manually Updating the Startup Disk After Installing
                     Microsoft Plus!

      IMPORTANT: If your computer uses software that translates disk
      geometry (such as OnTrack Disk Manager or Micro House EZ-Drive),
      make sure to load the translation software when you start your
      computer with the Startup disk.

   b. Verify that you have the correct DriveSpace and ScanDisk files on
      drives A and C.

      Check the Startup disk for the correct Drvspace.bin and Scandisk.exe
      files with the following commands:

         dir /a a:\drvspace.bin
         dir a:\scandisk.exe

      NOTE: The Startup disk does not contain a Dblspace.bin file. The
      Drvspace.bin file should have the file size and date noted below,
      depending on whether or not Microsoft Plus! is installed. If you did
      not install Microsoft Plus!, the Scandisk.exe file should be 134,738
      bytes in size. If you installed Microsoft Plus!, the Scandisk.exe
      file should be 137,836 bytes in size.

      If you do not have the correct versions of these files, extract new
      copies from your original disks or CD-ROM to the root folder of
      drive A.

      For information about using the Extract tool, please see the
      following article in the Microsoft Knowledge Base:

         ARTICLE-ID: <B><A href="../zmiscellaneous/q129605.htm">Q129605</A></B>
         TITLE     : How to Extract Original Compressed Windows Files

      Make sure that both the Drvspace.bin and Dblspace.bin files exist in
      the root folder of drive C. To check for these files, type the
      following command:

         dir /a c:\d??space.bin

      If you did not install Microsoft Plus!, you should see the following
      files:

         File name      Date/Time            Size
         ------------------------------------------
         Drvspace.bin   07-11-95 9:50 A.M.   71,287
         Dblspace.bin   07-11-95 9:50 A.M.   71,287

      If you did install Microsoft Plus!, you should see the following
      files:

         File name      Date/Time             Size
         -------------------------------------------
         Drvspace.bin   07-14-95 12:00 A.M.   64,135
         Dblspace.bin   07-14-95 12:00 A.M.   64,135

      If you are using Windows 95 OEM Service Release 2, you should have
      the following files whether or not Microsoft Plus! is installed:

         File name      Date/Time             Size
         -------------------------------------------
         Drvspace.bin   08-24-96 11:11 A.M.   65,271
         Dblspace.bin   08-24-96 11:11 A.M.   65,271

      IMPORTANT: Drvspace.bin and Dblspace.bin are the same files with
      different names. Copy the Drvspace.bin file to Dblspace.bin on the
      Startup disk with the following commands before you proceed:

         attrib -s -h -r a:\drvspace.bin
         copy a:\drvspace.bin a:\dblspace.bin
         attrib +s +h +r a:\d??space.bin

   c. Make sure that either a Drvspace.ini or Dblspace.ini file exists in
      the root folder of drive C. To check, type the following command:

         dir /a c:\d??space.ini

   d. If neither a Drivespace.ini or Dblspace.ini file exists on the hard
      disk, create one using the EDIT command from the Startup disk. To do
      this, type "edit c:\drvspace.ini" (without quotation marks) and then
      press ENTER. Then, close the editor.

   e. Restart your computer and do not press the F8 key. The computer
      should boot into Windows 95 and the contents of the compressed drive
      should be available.

      Check for a Restart.drv file in the root folder of drive C or its
      host drive by typing the following command:

         dir /a &lt;drive&gt;:\restart.drv

      This file is required by DriveSpace to restart a failed operation.
      If the Restart.drv file exists, copy the Config.pss and Autoexec.pss
      files from the Failsafe.drv folder to the root folder of the
      physical boot drive by typing the following commands at a command
      prompt:

         copy &lt;drive&gt;:\failsafe.drv\config.pss &lt;drive&gt;:\config.sys
         copy &lt;drive&gt;:\failsafe.drv\autoexec.pss &lt;drive&gt;:\autoexec.bat

      Then, edit the Drvspace.ini or Dblspace.ini file and place a
      semicolon (;) before the "ActivateDrive" line for compressed drive C
      (if it is being mounted). For example,

         ;ActivateDrive=H,C0

      This causes the computer to boot to the physical boot drive
      containing the Failsafe.drv folder and the Restart.drv file.

      NOTE: If there are multiple "ActivateDrive" lines that reference
      drive C, place the semicolon before the line that ends with "C0."
      The Drvspace.ini file is a hidden, system, read-only file stored in
      the root folder of the physical boot drive. To edit the file you
      must first remove the Hidden, System, and Read-Only attributes. To
      do so, type the following line at a command prompt:

         attrib -s -h -r &lt;drive&gt;:\d??space.ini

      Restart your computer and DriveSpace should try to complete the
      failed operation in mini-Windows mode.

   f. If the Restart.drv file does not exist, DriveSpace cannot restart
      the failed operation automatically. Format the drive and restore
      data from a recent backup, or contact Microsoft Technical Support
      for additional assistance.

      NOTE: It may be impossible to recover data at this point. It may be
      necessary to format the drive and restore from a recent backup or
      to reinstall Windows 95.

</PRE><P><LI>If you are troubleshooting a problem with one of the following
   DriveSpace operations that was not completed successfully, these
   operations can be continued after the underlying problems are resolved
   (provided you have not made manual changes to the DriveSpace
   configuration, such as changing an .ini file setting or renaming a
   CVF):
<P>
<P><PRE>    - Compressing an existing drive
    - Uncompressing a DoubleSpace or DriveSpace drive
    - Creating a new, empty DriveSpace drive
    - Changing the size of a DoubleSpace or DriveSpace drive
    - Changing the estimated compression ratio (ECR) for a DoubleSpace
      or DriveSpace drive
    - Mounting a DoubleSpace or DriveSpace drive
    - Upgrading (converting) a DoubleSpace or DriveSpace drive to
      DriveSpace 3
</PRE>
<P><LI>If you are not troubleshooting a problem with one of the DriveSpace
   operations listed above, verify that the compressed drive is mounted by
   trying to access the drive letter that was created when you originally
   compressed the drive.
<P>
   For example, if you compressed drive C and DriveSpace created drive
   letter H for the host drive, type "h:" (without quotation marks) and
   press ENTER. If you receive an "Invalid drive specification" error
   message, the compressed drive is not mounted.

<P><LI>Use ScanDisk to repair or mount the unmounted CVF. To do so, type the
   following line:
<P>
<P><PRE>      scandisk &lt;drive&gt;:
</PRE><P>
   When you are prompted to check the host drive first, do so. Perform a
   surface scan on all drives, and fix any errors found.
<P>
   If you receive an error message stating that you cannot use compressed
   drive C because it is not mounted, restart your computer and then
   repeat step 5.
<P>
   NOTE: If there is insufficient memory available for ScanDisk to check
   the compressed drive, repeat the command after modifying your Startup
   disk to load the compression driver in upper memory. To do so, create
   a Config.sys file on the Startup disk that includes at least the
   following commands
<P>
<P><PRE>      dos=umb
      device=&lt;drive&gt;:\failsafe.drv\windows\himem.sys
      device=&lt;drive&gt;:\failsafe.drv\windows\emm386.exe noems
      devicehigh=&lt;drive&gt;:\failsafe.drv\command\drvspace.sys /move
</PRE><P>
   where &lt;drive&gt; is either drive C or its host drive. The Failsafe.drv
   folder is a hidden folder on the physical boot drive that is used by
   DriveSpace to restart interrupted disk compression operations. This
   folder should be available even if your compressed drive is not
   mounted.
<P>
   The Failsafe.drv folder may also contain a Config.emm file that can be
   used to optimize conventional memory. However, you must change the
   drive letter designation on the "device=" and "devicehigh=" lines to
   reference the host for drive C if drive C is a compressed drive that
   is mounted when you boot with the Startup disk.
<P>
   IMPORTANT: If your hardware configuration requires upper memory to be
   excluded when using Emm386.exe, include the appropriate "x=mmmm-nnnn"
   syntax on the Emm386.exe command line.

<P><LI>Scan your computer for viruses using the latest anti-virus software
   available to you. If you upgraded from Microsoft MS-DOS 6.0 or later
   and you have Microsoft Anti-Virus for MS-DOS installed, run Msav.exe
   to detect and clean all logical drives.
<P>
   WARNING: The presence of a computer virus may lead to partial or
   complete data loss when you perform the following troubleshooting
   steps. For additional information about computer viruses, please see
   the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q129972.htm">Q129972</A></B>
<PRE></PRE>      TITLE     : Description of Computer Viruses

</PRE><P><LI>Perform a thorough surface scan on your hard disk. To do so, follow
   these steps:
<P>
   a. Edit the Scandisk.ini file on the Startup disk to include the
<P><PRE>      following lines:
</PRE><P>
<PRE>         [Environment]
         ScanTimeOut=On
         NumPasses=5

   b. Save and close the Scandisk.ini file.

   c. Type the following line to scan the hard disk

         scandisk &lt;drive&gt;:

      where &lt;drive&gt; is the compressed drive, if it is mounted. If the
      compressed drive is not mounted, use the host drive letter instead.
      Note that the host drive letter is the same as the drive letter you
      normally use for the compressed drive (when you are not having a
      problem with the compressed drive).

      When you are prompted, instruct ScanDisk to perform the following
      actions:

       - check the host drive first
       - mount any unmounted CVFs
       - perform a surface scan on both drives
       - fix all errors found
       - view, and save, a log file

      NOTE: This procedure may take some time, particularly if you have a
      large hard disk or more than one hard disk. To automate this
      procedure so that ScanDisk does not prompt you for instructions,
      include the following lines in the Scandisk.ini file:

         [Environment]
         LfnCheck      = Off
         Mount         = Always

         [Custom]
         DriveSummary  = Off
         AllSummary    = Auto
         Surface       = Always
         CheckHost     = Always
         SaveLog       = Overwrite
         Undo          = Never

         DS_Header     = Fix
         FAT_Media     = Fix
         Okay_Entries  = Fix
         Bad_Chain     = Fix
         Crosslinks    = Fix

         Boot_Sector   = Fix
         Invalid_MDFAT = Fix
         DS_Crosslinks = Fix
         DS_LostClust  = Fix
         DS_Signatures = Fix
         Mismatch_FAT  = Fix
         Bad_Clusters  = Fix
         Bad_Entries   = Delete
         LostClust     = Save

      Then, run ScanDisk using the following command:

         scandisk &lt;drive&gt;: /custom

   ScanDisk creates a Scandisk.log file that you can examine to determine
   whether ScanDisk fixed any problems on the drive. The problem should
   now be resolved unless you are troubleshooting a failed DriveSpace
   operation that is restartable. If this is not the case, you may want
   to review the troubleshooting steps.

</PRE></OL><h3>Your Computer Does Not Boot Properly After Compressing a Drive</h3>
 
<P>
A compressed drive may not be mounting correctly. To troubleshoot this
problem, follow steps 5-8 above.
<P>
If the compressed drive is mounted correctly but Windows 95 still does not
load, see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q136337.htm">Q136337</A></B>
   TITLE     : Troubleshooting Windows 95 Startup Problems and Error
               Messages
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbtshoot kbtool<BR>
KBSubcategory: win95 drvspace<BR>
Additional reference words: 95<BR>
Keywords          : drvspace win95 kbtool kbtshoot<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
