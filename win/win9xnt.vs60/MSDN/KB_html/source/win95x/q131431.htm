

<HTML>
<HEAD>
<TITLE>How to Troubleshoot Registry Errors </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131431">
<META NAME="KBModify" CONTENT="1997/12/05">
<META NAME="KBCreate" CONTENT="1995/06/12">
<META NAME="Keywords" CONTENT="win95 kbenv kberrmsg kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   When you start...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAB4,QAIB,QBXT,QA5V,QAGU,QANE,QAIJ,QAFI,QBFY,QAGQ,QAP2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Troubleshoot Registry Errors</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 5, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131431</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you start Windows 95, you may receive one of the following error
messages:

<UL><LI>There is not enough memory to load the registry.

<LI>Windows has encountered an error accessing the system registry.
   You should restore the registry now and restart the computer.
<P>
   If you ignore this error and shut down your system, you may lose data.
<P>
   Restoring the registry replaces the faulty registry with a known
   good backup copy. However, this backup copy may not contain all the
   information recently added to your system.
<P>
   NOTE: If you click the Restore From Backup And Restart button, you
   receive the error message again as Windows 95 restarts.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These error messages may occur if the registry is damaged.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems 
that may require you to reinstall Windows 95. Microsoft cannot guarantee 
that problems resulting from the incorrect use of Registry Editor can be 
solved. Use Registry Editor at your own risk.
<P>
NOTE: For information about how to edit the registry, view the Changing 
Keys And Values online Help topic in Registry Editor (Regedit.exe). Note 
that you should make a backup copy of the registry files (System.dat and 
User.dat) before you edit the registry.
<P>
Perform the steps outlined in each method below (as needed) to restore a
damaged registry.
<P>
<P><h3>Using Real-Mode Registry Editor</h3>
 
<P>
Use Registry Editor in real mode to export, then import, the registry 
file. To do so, follow these steps:

<OL><P><LI>Restart the computer. When you see the "Starting Windows 95" message,
   press the F8 key, then choose "Safe mode command prompt only" from the
   Startup menu.

<P><LI>Type the following line to export the registry
<P>
<P><PRE>      regedit /l:&lt;path1&gt; /e &lt;path2&gt;system.txt
</PRE><P>
   where &lt;path1&gt; is the path to the System.dat file and &lt;path2&gt; is the
   path to the destination file. For example, if Windows 95 is installed
   in the Windows folder on drive C, type the following line:
<P>
<P><PRE>      regedit /l:c:\windows\system.dat /e c:\system.txt
</PRE>
<P><LI>Type the following lines, pressing ENTER after each line:
<P>
<P><PRE>      cd\windows
      attrib -s -h -r system.dat
</PRE>
<P><LI>Type the following line to rename the current registry file:
<P>
<P><PRE>      ren system.dat system.old
</PRE>
<P><LI>Type the following line to import the System.dat portion of the
   registry
<P>
<P><PRE>      regedit /l:&lt;path1&gt; /c &lt;path2&gt;system.txt
</PRE><P>
   where &lt;path1&gt; is the path to the System.dat file and &lt;path2&gt; is the
   path containing the file to import. For example, if Windows 95 is
   installed in the Windows folder on drive C and you want to
   import the System.txt file from the root folder of drive C,
   type:
<P>
<P><PRE>      regedit /l:c:\windows\system.dat /c c:\system.txt
</PRE><P>
   NOTE: If an "Unable to open registry" or "Error accessing the registry"
   error message is displayed when you attempt to import the System.dat
   portion of the registry, please see the following article in the
   Microsoft Knowledge Base for more information about the error
   message:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q132064.htm">Q132064</A></B>
<PRE></PRE>      TITLE     : Regedit May Not Be Able to Import Registry with Large
                  Keys

</PRE><P><LI>Restart Windows 95 normally.
<P>
</OL>If the error continues to occur, follow these steps:

<OL><P><LI>Restart the computer. When you see the "Starting Windows 95" message,
   press the F8 key, and then choose "Safe mode command prompt only"
   from the Startup menu.

<P><LI>Type the following line to export the User.dat portion of the
   registry
<P>
<P><PRE>      regedit /r:&lt;path1&gt; /e &lt;path2&gt;user.txt
</PRE><P>
<P><PRE>    where &lt;path1&gt; is the path to the User.dat file and &lt;path2&gt; is the 
    path to the destination file. For example, if Windows 95 is 
    installed in the Windows folder on drive C, type the following line:
</PRE><P>
<P><PRE>      regedit /r:c:\windows\user.dat /e c:\user.txt
</PRE>
<P><LI>Type the following lines, pressing ENTER after each line:
<P>
<P><PRE>      cd\windows
      attrib -s -h -r user.dat
</PRE>
<P><LI>Type the following line to rename the User.dat file:
<P>
<P><PRE>      ren user.dat user.old
</PRE>
<P><LI>Type the following line to import the User.dat portion of the
   registry
<P>
<P><PRE>      regedit /r:&lt;path1&gt; /c &lt;path2&gt;user.txt
</PRE><P>
   where &lt;path1&gt; is the path to the User.dat file and &lt;path2&gt; is the path
   containing the file to import. For example, if Windows 95 is installed 
   in the Windows folder on drive C and you want to import the User.txt 
   file from the root folder of drive C, type:
<P>
<P><PRE>      regedit /r:c:\windows\user.dat /c c:\user.txt
</PRE><P>
   NOTE: If an "Unable to open registry" or "Error accessing the
   registry"  error message is displayed when you attempt to import the
   User.dat  portion of the registry, please see the following article
   in the  Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q132064.htm">Q132064</A></B>
<PRE></PRE>      TITLE     : Regedit May Not Be Able to Import Registry with Large
                  Keys

</PRE><P><LI>Restart Windows 95 normally.
<P>
</OL>For additional information about using Registry Editor in real mode,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q131352.htm">Q131352</A></B>
   TITLE     : Using Registry Editor in Real Mode

</PRE></OL>If the error continues to occur after you follow the steps in this 
section, please see the next section.
<P>
<P><h3>Using System.da0</h3>
 
<P>
Restore the registry to its state when you last successfully started
Windows 95. To do so, follow these steps:

<OL><P><LI>Restart the computer. When you see the "Starting Windows 95" message,
   press the F8 key, then choose "Safe mode command prompt only" from the
   Startup menu.

<P><LI>Type the following command to move to the Windows folder
<P>
<P><PRE>      cd \&lt;windows&gt;
</PRE><P>
   where &lt;windows&gt; is the Windows 95 folder. For example, if Windows
   95 is installed in the Windows folder, type the following line:
<P>
<P><PRE>      cd \windows
</PRE>
<P><LI>Type the following line:
<P>
<P><PRE>      attrib -s -h -r system.dat
</PRE>
<P><LI>Type the following line:
<P>
<P><PRE>      ren system.dat system.bad
</PRE>
<P><LI>Restart your computer. Windows 95 uses the System.da0 file
   when it cannot find the System.dat file. If this file works,
   Windows 95 renames it to System.dat.
<P>
</OL>If the error continues to occur after you follow the steps in this 
section, please see the next section.
<P>
<P><h3>Using System.1st</h3>
 
<P>
Restore the registry to its state when you first started Windows 95
successfully. To do so, follow these steps:

<OL><P><LI>Restart the computer. When you see the "Starting Windows 95" message,
   press the F8 key, then choose "Safe mode command prompt only" from the
   Startup menu.

<P><LI>Type the following command to move to the Windows folder
<P>
<P><PRE>      cd \&lt;windows&gt;
</PRE><P>
   where &lt;windows&gt; is the Windows 95 folder. For example, if
   Windows 95 is installed in the Windows folder, type the following
   line:
<P>
<P><PRE>      cd \windows
</PRE>
<P><LI>Type the following line:
<P>
<P><PRE>      attrib -s -h -r system.dat
</PRE>
<P><LI>Type the following line:
<P>
<P><PRE>      ren system.dat system.xxx
</PRE>
<P><LI>Type the following line:
<P>
<P><PRE>      cd \
</PRE>
<P><LI>Type the following line:
<P>
<P><PRE>      attrib -s -h -r system.1st
</PRE>
<P><LI>Type the following line
<P>
<P><PRE>      copy system.1st c:\&lt;windows&gt;\system.dat
</PRE><P>
   where &lt;windows&gt; is your Windows 95 folder.

<P><LI>Type the following line:
<P>
<P><PRE>      attrib +s +h +r system.1st
</PRE>
<P><LI>Restart your computer.
<P>
</OL>If the error continues to occur after you follow the steps in this
section, please see the next section.
<P>
NOTE: You may find that your TrueType fonts are missing from the Fonts 
folder or in programs after you follow the above steps. If this is the 
case, use the resolution listed in the following article in the Microsoft
Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q133732.htm">Q133732</A></B>
   TITLE     : Missing TrueType Fonts in Fonts Folder or Programs

</PRE></OL><h3>Reinstalling Windows 95</h3>
 
<P>
Re-create the registry files by reinstalling Windows 95.
<P>
To do this, perform the following steps.
<P>
NOTE: If you cannot access the CD-ROM drive from the command prompt,
consult the CD-ROM drive's documentation or manufacturer for assistance
with loading the real-mode drivers for the CD-ROM drive.

<OL><P><LI>Restart the computer. When you see the "Starting Windows 95" message,
   press the F8 key, then choose Command Prompt Only from the Startup 
   menu.

<P><LI>Type the following line and then press ENTER to remove all user
   profiles:
<P>
<P><PRE>      deltree c:\windows\profiles
</PRE>
<P><LI>Rename the existing registry files by typing the following lines. 
   Press ENTER after each line:
<P>
<P><PRE>      cd \windows
      attrib -s -h -r system.dat
      ren system.dat system.xxx
      attrib -s -h -r user.dat
      ren user.dat user.xxx
      attrib -s -h -r system.da0
      ren system.da0 system.yyy
      attrib -s -h -r user.da0
      ren user.da0 user.yyy 
      cd \
      attrib -s -h -r system.1st
      ren system.1st system.zzz
</PRE>
<P><LI>Run Windows 95 Setup.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 corrupt tshoot repair<BR>
Keywords          : win95 kbenv kberrmsg kbfaq<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 5, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
