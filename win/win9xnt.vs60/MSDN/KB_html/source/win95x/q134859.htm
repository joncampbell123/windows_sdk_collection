

<HTML>
<HEAD>
<TITLE>DriveSpace VxD and Real-Mode Driver Are Mismatched </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q134859">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1995/08/13">
<META NAME="Keywords" CONTENT="dblspace drvspace win95 winplus kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  If you install, remove, and then reinstall Windows 95, you may receive the following error message when you start Windows 95:     DriveSpace Warning     The DriveSpace VxD and the DriveSpace real-mode driver are    mismatched. You may need to reins...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAFI,QAA1,QA3P,QAKM,QAB4,QAIJ,QDL7,QDI2,QBFY,QAR4,QANE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>DriveSpace VxD and Real-Mode Driver Are Mismatched</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q134859</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Plus! for Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
If you install, remove, and then reinstall Windows 95, you may receive the
following error message when you start Windows 95:
<P>
<PRE>   DriveSpace Warning

   The DriveSpace VxD and the DriveSpace real-mode driver are
   mismatched. You may need to reinstall them.

   Press any key to continue.

</PRE>When you press a key, Windows 95 starts, but it may be unstable. You may
see unusual characters on the screen and you may receive "fatal exception"
error messages.
<P>
<P><h2>CAUSE</h2>
 
<P>
DriveSpace 3 from Microsoft Plus! for Windows 95 places real-mode drivers
on the hard disk that are not removed when you delete the Windows folder.
When you reinstall Windows 95, Setup places a DriveSpace VxD in the
Iosubsys folder that is incompatible with the DriveSpace 3 drivers.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Replace the Drvspacx.vxd file in the Iosubsys folder with the correct
version from the original Microsoft Plus! disks or CD-ROM. To do so,
follow these steps:

<OL><P><LI>Restart your computer. When you see the "Starting Windows 95" message,
   press the F8 key, and then choose Command Prompt Only from the
   Startup menu.

<P><LI>Change to the Windows\System\Iosubsys folder.

<P><LI>Rename the Drvspacx.vxd file to Drvspacx.old.

<P><LI>Extract the Drvspacx.vxd file from the Microsoft Plus! CD-ROM or
   original disks to the Iosubsys folder. The Drvspacx.vxd file is
   located in the Plus_1.cab file on both the Microsoft Plus! disks
   and CD-ROM.
<P>
   Use the following command to extract the Drvspacx.vxd file
<P>
<P><PRE>      extract &lt;drive&gt;:\plus_1.cab drvspacx.vxd /L &lt;destination&gt;
</PRE><P>
   where &lt;destination&gt; is the Windows\System\Iosubsys folder and &lt;drive&gt;
   is the drive containing the Microsoft Plus! disk or CD-ROM.
<P>
   For information about the Extract tool, type "extract" (without
   quotation marks) at a command prompt, or see the following article
   in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q129605.htm">Q129605</A></B>
<PRE></PRE>      TITLE     : How to Extract Original Compressed Windows Files

</PRE><P><LI>Restart your computer normally.
<P>
</OL>If you still receive a "mismatch" error message when you restart your
computer and the Drvspace.bin file is the correct Microsoft Plus! version,
check for a Dblspace.bin file dated 7/11/95 or earlier. This file is a
hidden file in the root folder of the boot drive. If this file exists,
rename it to Dblspace.old and then restart your computer. DriveSpace 3
does not require the Dblspace.bin file to mount compressed volumes, but
Windows 95 processes Dblspace.bin before Drvspace.bin if both files exist.
<P>
This behavior can also occur if you reinstall Windows 95 to a different
folder than its original folder after you install Microsoft Plus!. If you
reinstalled Windows 95 in a different folder and you want to use the
original installation, edit the Msdos.sys file on both the host drive and
the compressed drive. Make sure that the PATH statement points to the
correct folder. After you edit the Msdos.sys files, save the files and
then restart your computer.
<P>
NOTE: If you are using a Microsoft Plus! CD-ROM and you are not using
real-mode CD-ROM drivers, this resolution does not work.
<P>
The following tables list the correct files.
<P>
Windows 95 without Microsoft Plus!:
<P>
<PRE>File name      Date/Time         Size    Location
</PRE></OL> 
<PRE>Drvspace.bin   07-11-95 9:50am   71,287  C:\ and root of compressed drive
Dblspace.bin   07-11-95 9:50am   71,287  C:\ and root of compressed drive
Drvspacx.vxd   07-11-95 9:50am   54,207  C:\windows\system\iosubsys


</PRE>Windows 95 with Microsoft Plus!:
<P>
<PRE>File name      Date/Time         Size    Location
</PRE> 
<PRE>Drvspace.bin   07-14-95 12:00am  64,135  C:\ and root of compressed drive
Dblspace.bin   07-14-95 12:00am  64,135  C:\ and root of compressed drive
Drvspacx.vxd   07-14-95 12:00am  61,719  C:\windows\system\iosubsys


</PRE>Windows 95 OEM Service Release 2:
<P>
<PRE>File name      Date/Time          Size    Location
</PRE> 
<PRE>Drvspace.bin   08-24-96 12:00am   65,271  C:\ and root of compressed drive
Dblspace.bin   08-24-96 12:00am   65,271  C:\ and root of compressed drive
Drvspacx.vxd   08-24-96 11:11am   57,466  C:\windows\system\iosubsys
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 mismatch<BR>
Keywords          : dblspace drvspace win95 winplus kberrmsg kbtool<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
