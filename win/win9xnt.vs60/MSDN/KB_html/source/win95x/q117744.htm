

<HTML>
<HEAD>
<TITLE>Explanation of System Resources in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q117744">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1994/07/06">
<META NAME="Keywords" CONTENT="diskmem kbother win95">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  The use of system resources in Windows 95 is improved over that in Windows 3.x and Windows for Workgroups 3.x. The 32-bit architecture of Windows 95 makes this improvement possible.  MORE INFORMATION  NOTE: In this article, the term  Windows  refer...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABN,QBWO,QDL9,QBWN,QBWQ,QAJB,QBWP,QAGQ,QDNF,QAHP,QAMV,QAIM,QBVR,QAB5,QA3A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Explanation of System Resources in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q117744</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The use of system resources in Windows 95 is improved over that in Windows
3.x and Windows for Workgroups 3.x. The 32-bit architecture of Windows 95
makes this improvement possible.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: In this article, the term "Windows" refers to Windows 3.x and 
Windows for Workgroups 3.x.
<P>
In Windows 95, large portions of the graphics device interface (GDI) and 
USER heaps reside in the shared 32-bit virtual flat-address space of the 
system. This address space is shared by all cached objects in Windows 95 
(for example, the disk I/O cache, the network cache, the GDI cache, and 
third-party shared application data). This region of memory is as large as
your physical memory plus your swap file.
<P>
Windows 95 incorporates the Windows 64-kilobyte (K) system-resource limit 
for better performance when it is providing backward compatibility. Items 
that remain in one or more 64K segment(s) are mostly for use in the GDI 
heap and include logical pens, logical brushes, logical fonts, bitmaps, 
and palettes. To improve the use of system resources, Windows 95 moves the
following items into the 32-bit shared address space: device contexts, 
physical pens, physical brushes, and so on. Another improvement in Windows
95 is that the limit for device contexts is now over 4,000 system wide. In
contrast, device contexts are limited to between 150 and 200 system wide 
in Windows.
<P>
The USER heap in Windows has a limit of 200 menu and window handles 
(combined) for the entire system. Some programs tend to allocate many of 
these handles when they are performing large tasks, which causes the 
system to run out of resources quickly. To avoid such problems, Windows 95
moves the data for these menu and window handles to the 32-bit shared 
address space, thereby raising the total limit to 32,767 each per process 
(compared to the system-wide limit of 200 in Windows). In addition, the 
USER heap data for list boxes now resides in the 32-bit shared address 
space. The USER heap in Windows 95 also provides a new 32-bit edit control
that imposes no limits on the size of the data that you can store in it.
<P>
The following table is only approximate because it is difficult to list 
exact limits for GDI objects in Windows 3.1 because all regions, physical 
objects, logical objects, DCs, and installed fonts have to fit in a single
64K segment. Moving these into the 32-bit heap in Windows 95 provides more
room for the remaining (small) items such as logical pens and brushes. The
remaining items in the Windows 95 local heap are all less than 10-20 bytes
each.
<P>
<PRE>   Resource                Windows              Windows 95    Windows NT
   ---------------------------------------------------------------------
   Window/Menu Handles     about 200            32K (each)    Unlimited
   Timers                  32                   Unlimited     Unlimited
   COM/LPT ports           4 each               Unlimited     Unlimited
   Listbox items           8K                   32K           Unlimited
    (per listbox)
   Listbox data            64K                  Unlimited     Unlimited
    (per listbox)
   Edit control data       64K                  Unlimited     Unlimited
    (per control)
   Regions                 All in 64K segment   Unlimited     Unlimited
   Physical pens, brushes  All in 64K segment   Unlimited     Unlimited
   Logical fonts           All in 64K segment   750-800       Unlimited
   Installed fonts         250-300 (best case)  1000          Unlimited
   Device Contexts         200 (best case)      16K           Unlimited
   Logical pens, brushes   All in 64K segment   64K segment   Unlimited

</PRE>NOTE: The limits in Windows NT are for Win32-based applications. In many
cases, there are 32K or 64K limits on most of these resources for 16-bit
Windows-based applications due to limits on the size of the 16-bit
Windows-based application handles. You can avoid these limits in Windows
NT 3.5 by running more than one copy of WOW.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 gdi.exe user.exe<BR>
Keywords            : diskmem kbother win95<BR>
Version             : 95<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
