

<HTML>
<HEAD>
<TITLE>Msbatch.inf Parameters: Installing MSNDS </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q157785">
<META NAME="KBModify" CONTENT="1996/12/12">
<META NAME="KBCreate" CONTENT="1996/10/18">
<META NAME="Keywords" CONTENT="kbsetup kbnetwork kbenv">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article describes how to install the Microsoft Service for NetWare Directory Services (MSNDS) using the Msbatch.inf file for batch installations of Windows 95.  MORE INFORMATION  Microsoft does not encourage or support changes to .inf files; t...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAA1,QBWQ,QDI2,QBVV,QAFI,QDNF,QAI5,QBXT,QA5V,QAVZ,QAIB,QBKX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Msbatch.inf Parameters: Installing MSNDS</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 12, 1996</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q157785</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to install the Microsoft Service for NetWare
Directory Services (MSNDS) using the Msbatch.inf file for batch
installations of Windows 95.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft does not encourage or support changes to .inf files; therefore,
Microsoft Technical Support does not support the procedure in this
article. Although we have tested the following procedure and it appears
to function as described, make a backup copy of your .inf file before you
proceed.
<P>
To install MSNDS using the Msbatch.inf file for batch installations of
Windows 95, follow these steps:

<OL><P><LI>Create a network installation of Windows 95.

<P><LI>Create a new folder on the same drive that contains the network
   installation of Windows 95 and then copy all the files for MSNDS to the
   new folder. The files for MSNDS are available as a downloadable file
   named Msnds.exe. For information about obtaining the Msnds.exe file,
   please see the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q138709.htm">Q138709</A></B>
<PRE></PRE>      TITLE     : Microsoft Service for NetWare Directory Services
                  Available

</PRE><P><LI>In the new folder, rename the Ndscli.inf file to Ndscli.old and then
   rename the Ndscli.sbs file to Ndscli.inf.

<P><LI>Use the Microsoft INF Installation Tool for Windows 95 (Infinst.exe) to
   integrate the contents of the Ndscli.inf file into the network
   installation of Windows 95.
<P>
   NOTE: The INF Installation Tool for Windows 95 is included in the
   CD-ROM version of Windows 95 and the Microsoft Windows 95 Resource Kit,
   but not in the floppy disk version of Windows 95. To use the INF
   Installation Tool for Windows 95, you must own the CD-ROM version of
   Windows 95 or the Microsoft Windows 95 Resource Kit.

<P><LI>Create an [Install] section in the Msbatch.inf file, if the section
   does not already exist, and then add the following line to the section:
<P>
<P><PRE>      AddReg=NDSPP.ADD
</PRE>
<P><LI>Create an [NDSPP.ADD] section in the Msbatch.inf file, if the section
   does not already exist, and then add the following lines to the
   section.
<P>
   NOTE: Some of the following lines have been wrapped in this article.
   These lines should be entered as one continuous line in the Msbatch.inf
   file.
<P>
<P><PRE>     HKLM,"System\CurrentControlSet\Control\Print\Providers\Microsoft
<PRE></PRE>        Print Provider for NetWare",Name,,"ndspp.dll"
     HKCR,CLSID\{E6EF27C0-7984-11CE-BA00-00AA001F3DC4},,,"Netware objects"
     HKCR,CLSID\{E6EF27C0-7984-11CE-BA00-00AA001F3DC4}\InProcServer32,,,
        "ndspp.dll"
     HKCR,CLSID\{E6EF27C0-7984-11CE-BA00-00AA001F3DC4}\InProcServer32,
        ThreadingModel,,"Apartment"
     HKCR,Printers\shellex\PropertySheetHandlers\CaptureConfig,,,
        "{971A71A0-449B-101B-A9B9-4AF3EEDDA3E3}"
     HKCR,CLSID\{971A71A0-449B-101B-A9B9-4AF3EEDDA3E3},,,"Capture
        Settings"
     HKCR,CLSID\{971A71A0-449B-101B-A9B9-4AF3EEDDA3E3}\InProcServer32,,,
        "ndspp.dll"
     HKCR,CLSID\{971A71A0-449B-101B-A9B9-4AF3EEDDA3E3}\InProcServer32,
        ThreadingModel,,"Apartment"

</PRE><P><LI>Create a [Network] section in the Msbatch.inf file, if the section does
   not already exist, and then add the following lines to the section:
<P>
<P><PRE>      Clients=NWREDIR
      Services=NWREDIR4
</PRE>
<P><LI>If you want to set the preferred tree and default context in the
   Msbatch.inf file, create an [NWRedir4] section in the file, if the
   section does not already exist, and then add the following lines to the
   section:
<P>
<P><PRE>      PreferredTree = &lt;tree&gt;
      NameContext = &lt;context&gt;
</PRE><P>
</OL>If you are attempting to create a shared installation of Windows 95 that
uses MSNDS from a network installation of Windows 95 located on a NetWare
server, the shared Windows folder should be located on a network server
that is part of the NDS tree you log on to. You must also set bindery
emulation for the container in which user accounts reside.
<P>
When you are using a shared installation of Windows 95 with a shared
Windows folder located on a NetWare server, Windows 95 uses a real-mode
NetWare client to connect to the NetWare server. If bindery emulation is
not properly set, the real-mode client is unable to connect to the NetWare
server. When you log on to the server using the real-mode client, you
should use the user name and password that you normally use to log on to
the NDS tree. If you have not specified a preferred tree and default
context, the following error message may be displayed when you attempt to
log on:
<P>
<PRE>   You are not logged into the NDS tree. Make sure your default context
   is set properly. To check the default context, click the network icon
   in Control Panel.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbnetwork kbenv<BR>
KBSubcategory: win95<BR>
Additional reference words: 95<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 12, 1996</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
