

<HTML>
<HEAD>
<TITLE>Implementing Windows 95 Updates </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161020">
<META NAME="KBModify" CONTENT="1997/12/15">
<META NAME="KBCreate" CONTENT="1996/12/15">
<META NAME="Keywords" CONTENT="osr2 win95">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  Microsoft stands behind its Windows 95 product, and develops updates for Windows 95 as needed to resolve critical customer situations. This article provides general information about Windows 95 updates. Topics in this article include:   - Windows 9...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAC1,QDL9,QBWO,QBWN,QBD2,QAA1,QBWQ,QDI2,QAA5,QDNF,QDIX,QAJG,QAGQ,QANE V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Implementing Windows 95 Updates</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161020</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows 95 OEM Service Release versions 2, 2.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft stands behind its Windows 95 product, and develops updates for
Windows 95 as needed to resolve critical customer situations. This
article provides general information about Windows 95 updates. Topics in
this article include:

<UL><LI>Windows 95 Update Version Information
<LI>Identifying Windows 95 Updates
<LI>The Windows 95 Update Information Tool (Qfecheck.exe)
<LI>Installing Windows 95 Updates on a Single Computer
<LI>Uninstalling Windows 95 Updates on a Single Computer
<LI>Installing Windows 95 Updates Using Server-Based Setup
<LI>Obtaining Windows 95 Updates
<LI>Knowledge Base Query Tips
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Windows 95 Update Version Information</h3>
 
<P>
The version numbers of the original retail and OEM release of Windows 95
and the OEM Service Releases are listed below. In general, files included
with the indicated release of Windows 95 have the indicated version stamp.
<P>
<PRE>   Release                   Version     File dates
   ------------------------------------------------
   Windows 95 retail &amp; OEM   4.00.950    7/11/95
   OEM Service Release 1     4.00.950    12/31/95
   OEM Service Release 2     4.00.1111   8/24/96

</PRE>You can view a file's version information by using the right mouse button
to click a file in Windows Explorer, clicking Properties on the menu that
appears, and clicking the Version tab. If the property sheet for the file
does not show a Version tab, there is no version information available for
that file.
<P>
With few exceptions, Windows 95 updates are stamped with a version number
of 4.00.951 or greater, indicating that the file is a newer version than
originally included with Windows 95. Updates to Windows 95 OEM Service
Release 2 (OSR2) generally have a version of 4.00.1112 or greater.
<P>
It is possible that multiple fixes would be applied to the same component.
With a few rare exceptions, these fixes are always cumulative. A change
implemented in a given version of a particular component is also included
in later versions of that component, along with any additional change
implemented in the later versions. (For example, version 4.00.952 would
contain the change implemented in version 4.00.951, as well as the new
change.)
<P>
The cumulative nature of these changes, combined with the incremented
version numbers, means that, with very few exceptions, there is always one
"current" version of a given component, containing all fixes made to that
component to date.
<P>
<P><h3>Identifying Windows 95 Updates</h3>
 
<P>
Nearly all Windows 95 update files can be positively identified by the
following two characteristics, which can be viewed on the Version tab of
the property sheet for the file:

<UL><LI>A version number greater than the product release version.
<LI>An additional string resource named "Special Build Description" that
   is set to the value "QFE."
<P>
</UL>Some Windows 95 files do not contain version information to identify the
file. In such cases, the modified date and size of the file can be
examined and compared to the original release version of the file. These
are not conclusive indicators, however, because the modified date can be
affected by various conditions, and changes in a file may not result in a
change in the file's size.
<P>
<P><h3>The Windows 95 Update Information Tool (Qfecheck.exe)</h3>
 
<P>
The Windows 95 Update Information tool (Qfecheck.exe) is installed with
each Windows 95 update. This tool uses information stored in the registry,
and version and special build information in the files themselves, to
identify installed Windows 95 updates. This tool can be used to identify
which Windows 95 updates have been installed on a given computer.
<P>
To run the Qfecheck tool, run the Qfecheck.exe file in the Windows folder
(or in some rare cases, the Windows\System folder). The tool contains
online help.
<P>
<P><h3>Installing Windows 95 Updates on a Single Computer</h3>
 
<P>
To install a Windows 95 Update on a single computer, run the self-
extracting installer. This performs the following actions:

<OL><P><LI>Unpack the files that are needed for installation into a temporary
   folder. These files typically include:
<P>
<P><PRE>    - The updated component file(s)
    - The QFECHECK tool (Qfecheck.exe and Qfecheck.hlp)
    - An .inf file used to uninstall the update
    - An .inf file used to run the installation (W95upd.inf)
    - In some cases, Advpack.dll, W95inf16.dll, and W95inf32.dll files
</PRE>
<P><LI>Use the Windows 95 built-in Setup library (Setupx.dll) to install the
   specified update according to the directives in the .inf file provided
   (W95upd.inf). This .inf file contains directives to copy files to
   their appropriate locations, and add registry settings as appropriate.
<P>
   If a newer version of the updated component has already been
   installed, you are prompted to keep or overwrite the existing
   component.

<P><LI>Inform you when the update is complete and prompt you to restart
   the computer. When you click OK, the temporary files from step 1 are
   removed and the installation program terminates.
<P>
</OL><h3>Uninstalling Windows 95 Updates on a Single Computer</h3>
 
<P>
In most cases, Windows 95 updates can be safely and easily uninstalled and
replaced with the original versions of the updated components. This is
typically facilitated by an .inf file copied to the Windows folder during
installation of the update. This file typically has a name of the form
&lt;xxxxx&gt;_un.inf. This .inf file can be used to uninstall the Windows 95
update by using the right mouse button to click the file in Windows
Explorer, and then clicking Install on the menu that appears.
<P>
When a Windows 95 update is uninstalled, you are prompted for the original
Windows 95 installation disks or CD-ROM. The original version of the files
are copied and overwrite the updated versions. An alternate file location
may also be specified at this time. When uninstallation is complete, you
typically need to restart the computer for the change to take effect.
<P>
<P><h3>Installing Windows 95 Updates Using Server-Based Setup</h3>
 
<P>
Referring to the steps above for installing onto a single computer, note
that the files used in the installation are located in a temporary folder
until you click OK in the final prompt window. During this time, the files
can be copied into a different folder and saved for further use. Depending
on the specific Windows 95 update being installed, this temporary folder
may be one of the following:

<UL><LI>Windows\Temp
<LI>The &lt;temp&gt; folder (as specified by the TEMP environment variable)
<LI>&lt;temp&gt;\Ixp000.tmp (as specified by the TEMP environment variable)
<P>
</UL>If Windows 95 workstations are being set up from a network share, the
updated component files can be copied into the appropriate folder(s) on the
network share before installing Windows 95 from this share. In this way,
new workstations can be configured with the updated components from the
very beginning.
<P>
The appropriate folder into which to copy the updated component files
depends upon the type of installation.

<UL><LI>If the network installation share contains only the Windows 95 .cab
   files, the updated component files should be copied into the same
   folder as the .cab files. When Windows 95 Setup copies the file from
   this source to the destination, it will copy standalone files from that
   folder, if they exist, instead of the same files from within the .cab
   files.

<LI>If the network installation share is a server-based-Setup share point
   created using the Netsetup tool (from the Windows 95 CD-ROM), the
   updated component files should be copied into the same folder as the
   components they replace, overwriting the original versions of those
   files. Note that a given file may appear in more than one folder, so be
   sure to update all instances of the original file.
<P>
</UL>The .inf file used to install Windows 95 updates (W95upd.inf) includes
registry information that is either necessary for the update to provide
the intended functionality, or is simply useful in tracking which updates
have been installed. We recommend that this file be examined by the
administrator, and the appropriate sections merged into the Msbatch.inf
file used during Setup, to ensure that this registry information is
incorporated when the update is installed.
<P>
To install Windows 95 updates on existing Windows 95 workstations that are
running a shared installation of Windows 95 from a server, it is normally
sufficient to update the component files in the shared folder. In very rare
cases, updates to real-mode components will require the files to be copied
to the individual computers, either on the server or on the workstation's
local hard disk or boot floppy disk.
<P>
To install Windows 95 updates on existing Windows 95 workstations that are
running local, standalone installations of Windows 95, one of the following
methods can be used:

<UL><LI>Network Systems-Management software. Products such as Microsoft's
   System Management Server can be used to automate software updates.
   Once the updated component files are extracted and registry updates
   identified, these can be distributed according to the functionality
   provided by such products.

<LI>Logon scripts. If Windows NT or NetWare logon scripts are in use, a
   command can be added to check whether a particular update has been
   installed, and launch the installer if needed. For example:
<P>
<P><PRE>      IF NOT EXIST %WINDIR%\xxxxx_UN.INF START xxxxxUPD.EXE
</PRE>
<LI>E-mail. The self-extracting installer can be distributed in an
   e-mail attachment. Upon receiving the e-mail, users would run the
   attached installer to install the update. The e-mail attachment could
   also consist of a shortcut to the installer in a shared folder on the
   network.

<LI>Intranet Web site. The self-extracting installer can be placed on an
   internal Web site, where users could go to install the update.
<P>
</UL>These methods are suggestions. There may be other methods not listed here
that can be used to distribute these software updates.
<P>
NOTE: When the self-extracting installer is used to install the Windows 95
update, a check is made to ensure that a newer version of the component is
not inadvertently overwritten with the version being installed. If an
alternate installation method is used, care must be taken to prevent
replacing a newer component with an older one. In some cases, replacing a
newer component with an older one could render the computer unable to boot.
<P>
Obtaining Windows 95 Updates
 
<P>
Categorized by availability and distribution methods, Windows 95 updates
fall into two primary categories: those available publicly from online
sources, and those not available publicly, but only available by
contacting Microsoft Technical Support.
<P>
Publicly-distributed Windows 95 updates are available from the following
services:

<UL><LI>Microsoft's World Wide Web site on the Internet
<P><PRE>      On the www.microsoft.com home page, click Support.
      Click Search the Knowledge Base.
</PRE>
<LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
</PRE><P>
</UL>To determine which file to download, query the Microsoft Knowledge Base to
find the article that references the issue. Specific instructions are
included in each article.
<P>
Windows 95 updates that are not publicly distributed can be obtained by
contacting Microsoft Technical Support, through any of our direct support
offerings, including telephone and Web response.
<P>
Note that server-based Setup (using Netsetup) of Windows 95 OEM Service
release 2 and 2.1 (OSR2) is not supported. OSR2 was designed to be
preinstalled on new computers by computer manufacturers. One of the main
components, the FAT32 file system, requires that the computer's hard disk
be repartitioned. For this reason, OSR2 is not distributed to resellers.
<P>
Attempts to distribute OSR2 using Netsetup result in users being prompted
for a Product ID number. This number is usually listed on the Microsoft
Certificate of Authenticity. Modifying the Msbatch.inf file does not
prevent this prompt.
<P>
<P><h3>Knowledge Base Query Tips</h3>
 
<P>
Information about specific Windows 95 updates and issues resolved by these
updates can be found in the Microsoft Knowledge Base by querying on the
issue's symptoms.
<P>
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : osr2 win95<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbpolicy<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
