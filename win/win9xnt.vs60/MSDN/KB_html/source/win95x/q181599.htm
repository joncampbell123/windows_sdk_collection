

<HTML>
<HEAD>
<TITLE>How to Remove and Reinstall Dial-Up Networking and TCP/IP Files </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q181599">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1998/02/23">
<META NAME="Keywords" CONTENT="dun win95">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article describes how to remove and reinstall Dial-Up Networking and Transport Control Protocol/Internet Protocol (TCP/IP). These steps may be necessary under the following conditions:   - You are unable to connect to a remote computer, remote...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QBSO,QAVZ,QAA1,QAEF,QDLU,QDJI,QDI2,QAIJ,QBTX,QBQU,QASR,QAXB,QAD7,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Remove and Reinstall Dial-Up Networking and TCP/IP Files</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q181599</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to remove and reinstall Dial-Up Networking and
Transport Control Protocol/Internet Protocol (TCP/IP). These steps may be
necessary under the following conditions:

<UL><LI>You are unable to connect to a remote computer, remote network or the
   Internet using TCP/IP bound to a dial-up adapter.

<LI>You have verified the accuracy of your TCP/IP settings.

<LI>You have verified your modem is functioning correctly.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
To remove and reinstall Dial-Up Networking and TCP/IP, use the following
steps:

<OL><P><LI>If the Dial-Up Networking 1.2 Update is installed, uninstall it. If it
   is not installed, skip to step 2. To uninstall the Dial-Up Networking
   1.2 Update, use the following steps:
<P>
   a. Click Start, point to Settings, click Control Panel, and then
<P><PRE>      double-click Add/Remove Programs.
</PRE><P>
   b. On the Install/Uninstall tab, click Dial-Up Networking Upgade 1.2,
<P><PRE>      and then click Add/Remove.
</PRE><P>
   c. When you are promted to remove the update, click Yes, and then click
<P><PRE>      OK.
</PRE>
<P><LI>Record the configuration information for each connection in the Dial-Up
   Networking folder. To do so, use the following steps:
<P>
   a. Double-click My Computer, and then double-click Dial-Up Networking.
<P>
   b. Right-click a connection, click Properties, and then record all of
<P><PRE>      the  settings including the TCP/IP information. Repeat this process
      with another connection until you have recorded all of your
      connection's configuration information.
</PRE>
<P><LI>Delete all of your the connections from the Dial-Up Networking folder.
   To do so, right-click a connection, and then click Delete. Repeat this
   process with another connection until you have deleted all of your
   connections, and then close the Dial-Up Networking folder.

<P><LI>Record the configuration information for each network component in
   Network properties. To do so, use the following steps:
<P>
   a. Click Start, point to Settings, click Control Panel, and then
<P><PRE>      double-click Network.
</PRE><P>
   b. Click a component on the Configuration tab, click Properties, and
<P><PRE>      then record all of the component's settings. Repeat this process
      with another component until you have recorded all of your
      component's configuration information.
</PRE>
<P><LI>Remove all of the network components from Network properties. To do so,
   click a component on the Configuration tab, and then click Remove.
   Repeat this process until you have deleted all of the network
   components from Network properties, click OK, and then click Yes when
   you are prompted to restart your computer.

<P><LI>Uninstall Dial-Up Networking. To do so, follow these steps:
<P>
   a. Click Start, point to Settings, click Control Panel, and then
<P><PRE>      double-click Add/Remove Programs.
</PRE><P>
   b. Click the Windows Setup tab, click Communications (the word
<P><PRE>      Communications, not the checkbox), click Details, and then click the
      Dial-Up Networking check box to clear it.
</PRE><P>
   d. Click OK, click OK, and then click Yes when you are prompted to
<P><PRE>      restart your computer.
</PRE>
<P><LI>Restart your computer in MS-DOS Mode. To do so, click Start, click Shut
   Down, click Restart In MS-DOS Mode, and then click OK.

<P><LI>At the command prompt, type the following commands, pressing ENTER
   after each command:
<P>
<P><PRE>      cd system
      ren pppmac.vxd pppmac.dxv
      ren rna.inf rna.old
      ren rnasetup.dll rnasetup.old
      ren rnaapp.exe rnaapp.eex
      ren rnaui.dll rnaui.lld
      ren rnanp.dll rnanp.lld
      ren rnathunk.dll rnathunk.lld
      ren rasapi16.dll rasapi16.lld
      ren rasapi32.dll rasapi32.lld
      ren rnaserv.dll rnaserv.lld
      ren slipmenu.scp slipmenu.old
      ren slip.scp slip.old
      ren smmscrpt.dll smmscrpt.lld
      ren smmsetup.dll smmsetup.lld
      ren splitter.vxd splitter.dxv
      ren spap.vxd spap.dxv
      ren vgateway.vxd vgateway.dxv
      ren wsock32.dll wsock32.lld
      ren winsock.dll winsock.lld
</PRE><P>
   NOTE: Some of these files may not be present.

<P><LI>Restart your computer, and then extract the Rasapi32.dll file. The
   Rasapi32.dll file is located in the Win95_10.cab file on disk 10 of the
   Windows 95 DMF floppy version, the Win95_10.cab file in the Win95
   folder on the Windows 95 CD-ROM, the Win95_16.cab file on disk 16 of
   the Windows 95 non-DMF floppy version, or the Win95_16.cab in the Win95
   folder on the Windows 95 Original Equipment Manufacturer's OEM Service
   Release 2 (OSR2) CD-ROM. For information about how to extract a file,
   see the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q129605.htm">Q129605</A></B>
<PRE></PRE>      TITLE     : How to Extract Original Compressed Windows Files

</PRE><P><LI>Reinstall Dial-Up Networking. To do so, use the following steps:
<P>
   a. Click Start, point to Settings, click Control Panel, and then
<P><PRE>      double-click Add/Remove Programs.
</PRE><P>
   b. Click the Windows Setup tab, click Communications (the word
<P><PRE>      Communications, not the checkbox), click Details, and then click the
      Dial-Up Networking check box to select it.
</PRE><P>
   d. Click OK, click OK, and then click Yes when you are prompted to
<P><PRE>      restart your computer.
</PRE><P>
<P><PRE>      NOTE: You may receive version conflict error messages during this
      process. If this happens, click No when you are prompted to keep a
      newer version of each file.
</PRE>
<P><LI>Reinstall the Network components. To do so, use the following steps:
<P>
   a. If you have a network adapter installed, install the software for
<P><PRE>      the adapter according to the manufacturer's instructions.
</PRE><P>
   b. Click Start, point to Settings, click Control Panel, and then
<P><PRE>      double-click Network.
</PRE><P>
   c. Click the Configuration tab, click Add, click Adapter, click Add,
<P><PRE>      click Microsoft in the Manufacturers box, click Dial-Up Adapter, and
      then click OK.
</PRE><P>
   d. Click Protocol, click Add, click Microsoft in the Manufacturers box,
<P><PRE>      click TCP/IP, and then click OK.
</PRE><P>
<P><PRE>      NOTE: You may receive version conflict error messages during this
      process. If this happens, click No when you are prompted to keep a
      newer version of each file.
</PRE><P>
   e. If needed, add a network client. To do so, click Client, click Add,
<P><PRE>      click the appropriate manufacturer, click the client you want to
      install, and then click OK.
</PRE><P>
<P><PRE>      NOTE: You may need to reconfigure the network components that have
      been reinstalled. To do so, click the network component, click
      Properties, add any appropriate settings, and then click OK. If
      needed, refer to the configuration information you recorded in step
      4.
</PRE>
<P><LI>Restart your computer.

<P><LI>Recreate your Dial-Up Networking connections. To do so, use the
   following steps:
<P>
   a. Double-click My Computer, double-click Dial-Up Networking, and then
<P><PRE>      follow the instructions on the screen in the the Make New Connection
      wizard.
</PRE><P>
   b. Right-click the connection that you created, click Properties, and
<P><PRE>      then verify that the settings are the same as the configuration
      information you recorded in step 2. Repeat steps a and b until you
      have recreated all of your Dial-Up Networking connections.
<P></BLOCKQUOTE>
</OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:<BR>
Keywords          : dun win95<BR>
Version           : WINDOWS:95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
