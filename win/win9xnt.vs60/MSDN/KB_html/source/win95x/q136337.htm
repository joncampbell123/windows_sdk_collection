

<HTML>
<HEAD>
<TITLE>Troubleshooting Windows 95 Startup Problems and Error Messages </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q136337">
<META NAME="KBModify" CONTENT="1998/02/18">
<META NAME="KBCreate" CONTENT="1995/09/06">
<META NAME="Keywords" CONTENT="win95 kbhw kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT=" This article describes troubleshooting steps that may help you solve problems starting Windows 95. This information is also available in our Windows 95 Startup and Shutdown Troubleshooting Wizard. We recommend using this wizard, but we have also cre...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIJ,QDIV,QDL9,QBWO,QBWN,QBWQ,QBWS,QAB5,QDNF,QAU9,QA5W,QABI,QAKP,QBVV,QABA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Troubleshooting Windows 95 Startup Problems and Error Messages</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 18, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q136337</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
This article describes troubleshooting steps that may help you solve
problems starting Windows 95. This information is also available in our
Windows 95 Startup and Shutdown Troubleshooting Wizard. We recommend using
this wizard, but we have also created this text-based article for your
convenience. The Windows 95 Startup and Shutdown Troubleshooting Wizard is
located on:
<P>
<PRE>   <B><A href="http://support.microsoft.com/support/tshoot/default.asp">http://support.microsoft.com/support/tshoot/default.asp</A></B>

</PRE><h2>SUMMARY</h2>
 
<P>
This article lists troubleshooting tips you can use if your computer stops
responding (hangs) or returns an error message (such as a fatal exception
error or an invalid VxD error).
<P>
This article is meant to provide you with a general strategy for isolating
the problem.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Safe Mode</h3>
 
<P>
If Windows 95 does not start, try to start it in Safe mode. To start
Windows 95 in Safe mode, press the F8 key when you see the "Starting
Windows 95" message, and then choose Safe Mode from the Startup menu.
<P>
If Windows 95 does not start in Safe mode, see the "Windows 95 Does Not
Start in Safe Mode" section below. If Windows 95 starts in Safe mode, see
the "Windows 95 Starts in Safe Mode" section below.
<P>
<P><h3>Windows 95 Does Not Start in Safe Mode</h3>
 
<P>
Any of the following conditions can cause Windows 95 not to start in Safe
mode:

<UL><LI>Your computer is infected with a virus. For additional information
   about computer viruses, please see the following article in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q129972.htm">Q129972</A></B>
<PRE></PRE>      TITLE     : Description of Computer Viruses

</PRE><LI>Your computer's CMOS settings are not correct. Check your computer's
   CMOS settings to make sure they are correct. (You may need to contact
   the computer manufacturer to verify these settings.)

<LI>There is a hardware conflict. These conflicts can include, but are not
   limited to, PCI BIOS settings, IRQ conflicts, redundant COM ports (for
   example, two COM1 ports, or an internal modem set to the same COM port
   as an existing serial port), and defective RAM chips.

<LI>A setting in the Msdos.sys file needs to be changed (for example,
   the Logo setting should be set to zero). For additional information
   on the Msdos.sys file, please see the following article(s) in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q118579.htm">Q118579</A></B>
<PRE></PRE>      TITLE     : Contents of the Windows Msdos.sys File

</PRE><LI>You need to use the Vga.drv or Vga.vxd video drivers from the Windows
   95 CD-ROM. These files are located in the Drivers\Display\Vga folder.
   For example, these drivers may be helpful if you have an Intel Triton
   PCI controller or a Cirrus Logic 5401 or 5402 VGA video adapter.
   For more information about these files, please see the Readme.txt file
   in the same folder.

<LI>You are using Windows 95 OEM Service Release 2 (OSR2) and your
   computer stops responding (hangs) after booting to a previous
   operating system. For information about this issue, see the following
   article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q155364.htm">Q155364</A></B>
<PRE></PRE>      TITLE     : OSR2 Hangs After Booting Previous Operating System

</PRE></UL>If you still cannot start your computer in Safe mode after checking these
items, reinstall Windows 95 in a new, empty folder. This step helps to
establish whether the problem is related to a remnant of the previous
operating system (such as a configuration setting) or a hardware problem.
<P>
<P><h3>Windows 95 Starts in Safe Mode</h3>
 
<P>
If Windows 95 starts in Safe mode, step through the startup process to see
if any devices fail to load. To do so, restart your computer, press F8 when
you see the "Starting Windows 95" message, and then choose Step-By-Step
Confirmation from the Startup menu.
<P>
The following table lists several startup options. The options are labeled
Boot A, Boot B, Boot C, and Boot D. Try each option and note your results.
To use a boot option, press Y or N as outlined in the option in the table
below each time you are prompted whether you want to load a particular
device.
<P>
<PRE>                                       Boot A   Boot B   Boot C   Boot D
   ---------------------------------------------------------------------
   Load DriveSpace Driver?             (Y)es    (Y)es    (Y)es    (Y)es
   Process the system registry?        (Y)es    (Y)es    (Y)es    (N)o
   Create a startup log file
      (Bootlog.txt)?                   (Y)es    (Y)es    (Y)es    (Y)es
   Process your startup device drivers
      (Config.sys)?                    (N)o     (N)o     (Y)es    (Y)es
   Device=&lt;path&gt;\Himem.sys?            (Y)es    (Y)es    (Y)es    (Y)es
   Device=&lt;path&gt;\Ifshlp.sys?           (Y)es    (Y)es    (Y)es    (Y)es
   Device=&lt;path&gt;\Dblbuff.sys?          (Y)es    (Y)es    (Y)es    (Y)es
   Device=&lt;path&gt;\Setver.exe?           (Y)es    (Y)es    (Y)es    (Y)es
   Process your startup command file
      (Autoexec.bat)?                  (N)o     (N)o     (Y)es    (Y)es
   Load the Windows graphical user
      interface?                       (Y)es    (Y)es    (Y)es    (Y)es
   Load all Windows Drivers?           (N)o     (Y)es    (N)o     (Y)es

</PRE>Boot A:
<P>
If Windows 95 does not start under these conditions, try the Boot D
option. If Windows 95 starts, there is a problem with a driver or
terminate-and-stay-resident program (TSR) loading in the Config.sys or
Autoexec.bat file, or there is a problem with a Windows 95 protected-mode
driver.
<P>
Boot B:
<P>
If Windows 95 does not start under these conditions, try the Boot C
option. If Windows 95 starts, there is a problem with a driver or TSR
loading in the Config.sys, or Autoexec.bat file. You can pinpoint the
problem by stepping through these files.
<P>
There may also be a problem with a TSR loading in the Winstart.bat file if
one is present on your computer. Rename the Winstart.bat file and try the
Boot B option again. The Winstart.bat file is usually located in the
Windows folder, and is used to load TSRs that are required for Windows-
based programs, but are not needed in MS-DOS sessions.
<P>
For information about how to rename a file, click Start, click Help,
click the Index tab, type "renaming" (without quotation marks), and
then double-click the "Renaming files" topic.
<P>
Boot C:
<P>
If Windows 95 does not start under these conditions, try the Boot D
option. If Windows 95 starts, there is a problem with a Windows 95
protected-mode driver. For more information about these problems, see
the "Troubleshooting Protected-Mode Driver Problems" section of this
article.
<P>
Boot D:
<P>
If Windows 95 does not start under these conditions, try the steps in the
"System.ini" section below. If Windows 95 starts, there is a problem with
the system registry. For information about restoring the registry, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q131431.htm">Q131431</A></B>
   TITLE     : How to Troubleshoot Registry Errors

</PRE>System.ini:
<P>
To determine whether the System.ini or Win.ini file is causing a problem,
try the following steps:

<OL><P><LI>Rename the System.ini file in the Windows folder to System.sav.

<P><LI>Copy (do not rename) the System.cb file in the Windows folder to
   System.ini.

<P><LI>Add the following line to the [boot] section of the System.ini
   file and then save the file:
<P>
<P><PRE>      drivers=mmsystem.dll
</PRE>
<P><LI>Rename the Win.ini file in the Windows folder to Win.sav.

<P><LI>Restart your computer.
<P>
</OL>If this works, there is a problem with an entry in the System.ini or
Win.ini file. Examine these files more closely to determine the exact cause
of the problem.
<P>
If Windows 95 does not start when you step through the boot process, start
your computer in Safe mode, and then change the video driver to the
standard VGA driver.
<P>
NOTE: When you copy the System.cb file to System.ini, your mouse may stop
working. If this occurs, add the following lines to the appropriate
sections of the new System.ini file:
<P>
<PRE>   [boot]
   mouse.drv=mouse.drv

   -and-

   [386Enh]
   mouse=*vmouse, msmouse.vxd

</PRE></OL>For additional information about troubleshooting startup problems using
Safe mode, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q156126.htm">Q156126</A></B>
   TITLE     : Troubleshooting Windows 95 Using Safe Mode

</PRE><h3>Troubleshooting Protected-Mode Driver Problems</h3>
 
<P>
If Windows 95 starts only when you press N at the Load All Windows Drivers?
prompt, try the following steps:

<OL><P><LI>Start Windows 95 in Safe mode.

<P><LI>Use the right mouse button to click My Computer, and then click
   Properties on the menu that appears.

<P><LI>On the Device Manager tab, disable any devices in the following
   categories:
<P>
<PRE>      Display adapters        Floppy disk controllers
      Hard disk controllers   Keyboard
      Mouse                   Network adapters
      PCMCIA socket           Ports
      SCSI controllers        Sound, video, and game controllers

   To disable a device, follow these steps:

   a. In Device Manager, double-click the category name, and then double-
      click the device.

   b. On the General tab, click the Original Configuration (Current)
      check box to clear it, and then click OK.

   c. Restart your computer.

   NOTE: If Windows 95 does not start, go to the "System.ini" section of
   this article.

</PRE><P><LI>Once Windows 95 restarts, enable the devices you disabled in step 3.
   Enable the devices in the following order:
<P>
<P><PRE>    - Com ports
    - Hard disk controllers
    - Floppy disk controllers
    - Other devices
</PRE><P>
   To enable a device, follow these steps:
<P>
   a. In Device Manager, double-click the category name, and then double-
<P><PRE>      click the device.
</PRE><P>
   b. On the General tab, click the Original Configuration (Current) check
<P><PRE>      box to select it, and then click OK.
</PRE><P>
   c. While the properties for each device are open, click the Resources
<P><PRE>      tab and make sure there are no conflicts listed in the Conflicting
      Devices list.
</PRE>
<P><LI>Restart your computer.
<P>
</OL><h3>Additional Notes</h3>
 
<P>
For information about known hardware issues, please see the Hardware.txt
file in the Windows folder on your hard disk.
<P>
For additional troubleshooting assistance, check the Bootlog.txt file in
the root directory on your hard disk. This file lists the loading status of
all real-mode and protected-mode drivers. If Windows 95 does not start, the
Bootlog.txt file lists the last driver that loaded successfully, and lists
a "LoadFail" entry for each driver that failed to load before the problem
occurred.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95 first boot fail setup noboot no-boot start up <BR>
start-up<BR>
Keywords          : win95 kbhw kbfaq<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 18, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
