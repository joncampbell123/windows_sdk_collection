

<HTML>
<HEAD>
<TITLE>Msbatch.inf Parameters: Installing PCMCIA Network Adapter Driver </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170844">
<META NAME="KBModify" CONTENT="1997/07/01">
<META NAME="KBCreate" CONTENT="1997/07/01">
<META NAME="Keywords" CONTENT="kbhw kbsetup win95 winbatch">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article describes how to perform a batch installation of Windows 95  using an Msbatch.inf file and a PCMCIA (PC Card) network adapter with  drivers supplied by the manufacturer (not included with Windows 95).  MORE INFORMATION  Microsoft does ...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QAVZ,QDJW,QDIZ,QAU9,QDL9,QBWO,QBWN,QBVV,QAB5,QAFI,QAIB,QBWS,QBXT V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Msbatch.inf Parameters: Installing PCMCIA Network Adapter Driver</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 1, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170844</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to perform a batch installation of Windows 95 
using an Msbatch.inf file and a PCMCIA (PC Card) network adapter with 
drivers supplied by the manufacturer (not included with Windows 95).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft does not encourage or support changes to .inf files; therefore, 
Microsoft Technical Support does not support the procedure in this 
article. Although we have tested the following procedure and it appears 
to function as described, make a backup copy of your .inf file before you 
proceed.
<P>
When you install Windows 95 over a network using a PCMCIA network adapter,
the network adapter is not recognized until after the PCMCIA wizard runs. 
By the time the PCMCIA wizard runs, the temporary folder containing the 
PCMCIA network adapter drivers created by Setup has already been deleted. 
Because of this, Setup stops and prompts you for the network adapter 
driver disk provided by the manufacturer of the adapter. To automate the 
process, follow these steps:

<OL><P><LI>Use the Inf Installer tool to integrate the manufacturer's .inf file. 
   The Inf Installer tool is located on the Windows 95 CD-ROM in the 
   Admin\Nettools\Netsetup folder. For information about how to use this 
   tool, see the Infinst.txt file in the same folder.
<P>
   NOTE: If the PCMCIA network adapter is a multifunction adapter, the 
   manufacturer's driver disk may contain more than one .inf file. If this
   is the case, use the Inf Installer tool with the .inf file containing 
   the following entry:
<P>
<P><PRE>      Class=MultiFunction
</PRE><P>
   IMPORTANT: If the Inf Installer tool does not integrate the .inf file 
   successfully, there may be a problem with the .inf file. If this 
   occurs, contact the manufacturer to inquire about obtaining an updated 
   .inf file. You cannot complete this procedure without an updated file 
   that works with the Inf Installer tool.

<P><LI>Copy the network adapter's driver and .inf file from the manufacturer's
   driver disk to the NetSetup folder on your server.

<P><LI>Run Batch 2.0 to create the Msbatch.inf file with the options you 
   want. The following settings are required:
<P>
<P><PRE>    - Set the installation type to Custom. This is required so that Dial-
      Up Networking can be added. Dial-Up Networking must be added because
      there is no detection of the network adapter when the PCMCIA wizard 
      is not run. If there is no detection of the network adapter, the 
      client and protocols are not downloaded to the computer during 
      Setup. Without these files, there is no network connectivity. Adding
      Dial-Up Networking allows the installation of the client and 
      protocols during Setup.
</PRE><P>
<P><PRE>    - Set Dial-Up Networking to be installed as an optional component.
</PRE>
<P><LI>Save the Msbatch.inf file.

<P><LI>Use any text editor (such as Notepad) to open the Msbatch.inf file. Add
   the following line to the [Network] section of the file:
<P>
<P><PRE>      IgnoreDetectedNetcards=1
</PRE><P>
   This entry prevents Setup from displaying any dialog boxes that prompt 
   for disks if a network adapter is detected because of real-mode drivers
   that are currently loaded in memory. It also prevents Setup from 
   attempting to install NDIS2 support for the network adapter instead of 
   32-bit protected-mode drivers.

<P><LI>In the [Network] section of the file, verify that this line is present:
<P>
<P><PRE>      WorkStationSetup=0
</PRE>
<P><LI>Create these sections and entries in the file:
<P>
<P><PRE>      [DestinationDirs]
      &lt;section_to_copy_inf&gt;=17
      &lt;section_to_copy_vxd&gt;=11
</PRE><P>
<P><PRE>      [&lt;section_to_copy_inf&gt;]
      &lt;filename&gt;.inf
      &lt;optional_file_name&gt;.inf
</PRE><P>
<P><PRE>      [&lt;section_to_copy_vxd&gt;]
      &lt;filename&gt;.vxd
</PRE><P>
   NOTE: &lt;optional_file_name&gt; is the name of the second .inf file if the
   device is a multifunction adapter. Generally, there is an .inf file for
   the network adapter driver, and one for the other device (usually a 
   modem). If the PCMCIA device is not a multifunction device, this line 
   is not necessary.
<P>
   During Setup, the temporary folder created by Setup is removed after 
   the first reboot, along with the files necessary to run the PCMCIA 
   adapter that were initially copied during setup. The entries listed 
   above ensure that the driver and .inf files are copied during the file-
   copy phase of Setup and placed in the correct folders as specified in 
   the [DestinationDirs] folder setting.
<P>
   For more information about the destination folder values, see appendix
   C, pages 1166-1167, of the Windows 95 Resource Kit.

<P><LI>Add the following section and line to the file. This line starts the 
   PCMCIA wizard to detect the PCMCIA sockets and provide support for the 
   PCMCIA adapter:
<P>
<P><PRE>      [EnablePCMCIA.addreg]
      HKLM,SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE\SETUP,"Enable
      PCMCIA",,"rundll sysdm.cpl,EnablePCMCIA_RunDLL"
</PRE><P>
   NOTE: This line should be typed as a single line. It has been wrapped 
   in this article for readability purposes.

<P><LI>In the [Install] section, create these entries:
<P>
<P><PRE>      AddReg=EnablePCMCIA.AddReg
      CopyFiles=&lt;section_to_copy_vxd&gt;, &lt;section_to_copy_inf&gt;
</PRE><P>
   NOTE: The first entry tells Setup to run the section added in step 8. 
   The second entry tells Setup to run the sections added in step 7.

<P><LI>Run Windows 95 Setup.
<P>
</OL>The PCMCIA adapter should be detected automatically as one of the final 
steps in Setup and the drivers loaded automatically from the hard disk as 
outlined in the .INF file's instructions.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: automate pccard oem nic<BR>
Keywords            : kbhw kbsetup win95 winbatch<BR>
Version             : WINDOWS:95<BR>
Platform            : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 1, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
