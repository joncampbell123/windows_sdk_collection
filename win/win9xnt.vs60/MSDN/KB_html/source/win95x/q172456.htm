

<HTML>
<HEAD>
<TITLE>How to Automatically Replace Files In Use by Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172456">
<META NAME="KBModify" CONTENT="1998/01/08">
<META NAME="KBCreate" CONTENT="1997/08/06">
<META NAME="Keywords" CONTENT="win95 winshell">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article describes how to automatically replace a file that is in use by Windows 95 without booting to MS-DOS mode.  MORE INFORMATION  You can replace files in use by Windows 95 by using an .inf file. The following sample .inf file demonstrates...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAUJ,QBWQ,QACI,QBF0,QBWS,QBBI,QDNF,QBKX,QAJP,QBFY,QA9N,QA6A V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>How to Automatically Replace Files In Use by Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 8, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172456</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to automatically replace a file that is in use
by Windows 95 without booting to MS-DOS mode.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You can replace files in use by Windows 95 by using an .inf file. The
following sample .inf file demonstrates this method:
<P>
<PRE>   ; Replace.inf
   ; This is a Setup information file to replace a driver or file that is
   ; in use by Windows 95.
   ; Copyright 1993-1997 Microsoft Corporation

   [DefaultInstall]
   CopyFiles=NewFile.copy.sys

   [version]
   signature="$CHICAGO$"
   AdvancedINF=2.0

   [DestinationDirs]
   NewFile.copy.sys=11

   [NewFile.copy.sys]
   Old.exe, New.exe, Tempfile.exe

   [SourceDisksNames]
   55="My Very Own File Update.","",1

   [SourceDisksFiles]
   New.exe=55

   ; End of this .inf file.

</PRE>This sample file assumes that a file named Old.exe is located in the
Windows folder and is currently running. When you run the .inf file, the
following actions occur:
<P>
The New.exe file is copied to the C:\Windows\System folder. This location
is specified in the [DestinationDirs] section of the .inf file. In
addition to being copied, the file is renamed to Tempfile.exe. This
temporary name is specified in the [NewFile.copy.sys] section of the .inf
file.
<P>
The computer must be rebooted for the changes to take effect. During the
boot process, the temporary file is renamed from the temporary name to the
appropriate name on the hard disk before the original file is loaded and
locked open. This functionality is defined in the [rename] section of the
Wininit.ini file.
<P>
Once the file rename has occurred, the Wininit.ini file is renamed to
Wininit.bak so you can see the last action that took place with the
Wininit.ini file.
<P>
To process an .inf file, you can either right-click the file and then
click Install, or use the following command:
<P>
<PRE>   c:\windows\rundll.exe setupx.dll,InstallHinfSection DefaultInstall 130
   &lt;path to file&gt;.inf

</PRE>This line should be typed as a single line. It has been wrapped in this
article for readability purposes. When you run this command, you are
prompted to restart the computer.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For additional information about .inf files and their parameters, see
Appendix C in the Microsoft Windows 95 Resource Kit.
<P>
For more information about the Wininit.ini file, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win32sdk/q140570.htm">Q140570</A></B>
   TITLE     : HOWTO: Moving Files That Are Currently in Use
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : win95 winshell<BR>
Version           : WINDOWS:95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 8, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
