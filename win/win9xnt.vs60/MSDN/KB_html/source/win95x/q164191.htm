

<HTML>
<HEAD>
<TITLE>Msbatch.inf Parameters: Bypassing Network Logon </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164191">
<META NAME="KBModify" CONTENT="1997/02/25">
<META NAME="KBCreate" CONTENT="1997/02/25">
<META NAME="Keywords" CONTENT="kbsetup kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  This article describes how to bypass the network logon during the first reboot after running Setup by using the Msbatch.inf file for batch installations of Windows 95.  MORE INFORMATION  Microsoft does not encourage or support changes to .inf files...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAI5,QAVZ,QAA1,QAW2,QAW1,QBW7,QBVV,QDNQ,QDI2,QA0N,QAEF,QBJQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Msbatch.inf Parameters: Bypassing Network Logon</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164191</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to bypass the network logon during the first
reboot after running Setup by using the Msbatch.inf file for batch
installations of Windows 95.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft does not encourage or support changes to .inf files; therefore,
Microsoft Technical Support does not support the procedure in this
article. Although we have tested the following procedure and it appears to
function as described, make a backup copy of your .inf file before you
proceed.
<P>
You can use the Autologon registry entry to prevent the display of a
network logon dialog box. This key is added as part of the installation.
However, simply adding the key is insufficient. Unless the key is removed,
the user is not prompted to log on to the network, and does not have more
than basic connectivity. To bypass the network logon dialog box, remove
theAutologon key from the registry after the first reboot.
<P>
There are two parts to accomplishing this. The first part is to modify the
existing script to add the appropriate key, copy a file, and add another
key to the registry that causes Windows 95 to implement a second file. The
existing script should be modified to include the following lines:
<P>
<PRE>   [Install]
   CopyFiles=@auto.inf
   Addreg=Add.Autologon

   [DestinationDirs]
   DefaultDestDir=10

   [SourceDisksFiles]
   auto.inf=22,,1234

   [SourceDisksNames]
   22="Source",,0

   [Add.Autologon]
   HKLM,"Software\Microsoft\Windows\CurrentVersion\Network\Real Mode
      Net",Autologon,1,0
   HKLM,"Software\Microsoft\Windows\CurrentVersion\RunOnce",Autooff,,
      "rundll setupx.dll,InstallHInfSection DefaultInstall 132 auto.inf"

</PRE>The second part is to create a file named Auto.inf in the root folder of
the distribution point. The file should contain the following lines:
<P>
<PRE>   [version]
   signature="$CHICAGO$"

   [DefaultInstall]
   delreg=auto.on.reg

   [auto.on.reg]
   HKLM,"Software\Microsoft\Windows\CurrentVersion\Network\Real Mode
      Net",Autologon
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbsetup kbnetwork<BR>
KBSubcategory: winbatch win95<BR>
Additional Reference Words: 95 automate<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
