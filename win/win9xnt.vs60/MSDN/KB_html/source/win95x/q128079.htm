

<HTML>
<HEAD>
<TITLE>Updated Drivers for File and Printer Sharing Security </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128079">
<META NAME="KBModify" CONTENT="1998/03/17">
<META NAME="KBCreate" CONTENT="1995/03/26">
<META NAME="Keywords" CONTENT="3rdpartynet msnets win95 kbenv kbnetwork">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you use  File and printer sharing for Microsoft Networks  or  File and printer sharing for NetWare Networks  on a Windows 95-based computer, remote users may be able to gain access to your entire hard disk.  When you share a folder on a Window...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVZ,QAJ4,QDL9,QBWO,QBWN,QA3A,QAA1,QDI2,QAXB,QAI5,QDIZ,QBWQ,QBWS,QABA,QDO3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Updated Drivers for File and Printer Sharing Security</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 17, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128079</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
95
WINDOWS
kbnetwork kbenv
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you use "File and printer sharing for Microsoft Networks" or "File
and printer sharing for NetWare Networks" on a Windows 95-based computer,
remote users may be able to gain access to your entire hard disk.
<P>
When you share a folder on a Windows 95-based computer, users on UNIX-
based computers running the SMBCLIENT Samba network client who connect to
the shared folder may be able to gain access to the entire drive on which
the shared folder is located.
<P>
<P><h2>CAUSE</h2>
 
<P>
You may experience this problem with "File and printer sharing for NetWare
Networks" or with "File and printer sharing for Microsoft Networks" when
the following conditions are met.
<P>
File and Printer Sharing for NetWare Networks (Nwserver.vxd):

<UL><LI>Your workstation is configured to share files and printers with "File
   and printer sharing for NetWare Networks."

<LI>Remote administration or the Microsoft Remote Registry service is
   enabled.
<P>
   NOTE: These options are not enabled by default.
<P>
</UL>File and Printer Sharing for Microsoft Networks (Vserver.vxd):

<UL><LI>Your workstation is configured to share files and printers with "File
   and printer sharing for Microsoft Networks."

<LI>Your workstation connects to a LAN, Internet (SLIP or PPP account),
   or Dial-Up Networking connection that can be accessed by UNIX-based
   computers running the SMBCLIENT Samba network client.

<LI>The network administrator does not disable peer services using System
   Policies.
<P>
</UL>The SMBCLIENT Samba network client allows users to send illegal networking
commands over the network. At this time, the Samba client is the only known
SMBCLIENT that does not filter out such illegal commands. SMBCLIENT users
do not automatically gain access to the Windows 95 drive; these users must
know the exact steps to send these illegal commands.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To prevent these illegal commands from being run on a Windows 95 computer,
Microsoft has released new versions of the Nwserver.vxd (4.00.951) and
Vserver.vxd (4.00.952) files. These files are available in the Microsoft
Windows 95 Service Pack 1 Update Setup.exe file.
<P>
For information about Microsoft Windows 95 Service Pack 1, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../win95x/q142794.htm">Q142794</A></B>
   TITLE     : Availability of Microsoft Windows 95 Service Pack 1

</PRE><h3>Installation</h3>
 
<P>
To install the updated files, follow these steps:

<OL><P><LI>Download the Setup.exe file from one of the online services listed
   below to an empty folder.

<P><LI>In My Computer or Windows Explorer, double-click the Setup.exe file.

<P><LI>Follow the instructions on the screen.

<P><LI>After the installation process is finished, shut down and then restart
   your computer.
<P>
</OL>Running Setup.exe installs the Windows 95 Service Pack 1 Update, which
automatically updates the Nwserver.vxd and Vserver.vxd files. After the
update, illegal commands from SMBCLIENT will not be run on a Windows 95-
based computer. The SMBCLIENT user will be able to gain access to only the
Windows 95 shared folders that you designate.
<P>
<PRE>You can find <A href="http://support.microsoft.com/download/support/mslfiles/setup.exe">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
                       on the following services:

</PRE><LI>Microsoft's World Wide Web Site on the Internet
<P><PRE>      On the www.microsoft.com home page, click the Support icon.
      Click Knowledge Base, and select the product.
<PRE></PRE>      Enter kbfile <A href="http://support.microsoft.com/download/support/mslfiles/setup.exe">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
                            , and click GO!
      Open the article, and click the button to download the file.

</PRE><LI>Internet (anonymous FTP)
<P><PRE>      ftp ftp.microsoft.com
      Change to the Softlib/Mslfiles folder.
      Get <A href="http://support.microsoft.com/download/support/mslfiles/setup.exe">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
</PRE>
<LI>Microsoft Download Service (MSDL)
<P><PRE>      Dial (425) 936-6735 to connect to MSDL
      Download <A href="http://support.microsoft.com/download/support/mslfiles/setup.exe">SETUP.EXE</A> <I>(size: 1264640 bytes)</I> 
</PRE><P>
</UL>For additional information about downloading, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../zmiscellaneous/q119591.htm">Q119591</A></B>
   TITLE     : How to Obtain Microsoft Support Files from Online
               Services
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
KBCategory: kbnetwork kbenv<BR>
KBSubcategory: win95 msnets 3rdpartynet<BR>
Additional reference words: 95 syspol msnWin95misc servicepack1<BR>
Keywords          : 3rdpartynet msnets win95 kbenv kbnetwork<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 17, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
