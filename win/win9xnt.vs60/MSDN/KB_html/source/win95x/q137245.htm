

<HTML>
<HEAD>
<TITLE>Cannot Open or Compose Message in Windows Messaging </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q137245">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1995/09/24">
<META NAME="Keywords" CONTENT="exchange win95 winnt kberrmsg kbtool kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.  NOTE: In this a...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAA1,QAFI,QBVV,QAH4,QAEF,QAV5,QA9N,QDH6,QABI,QAYC,QDI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Cannot Open or Compose Message in Windows Messaging</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q137245</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Windows NT Server version 4.0
<LI>Microsoft Windows NT Workstation version 4.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
NOTE: In this article, the term "Windows Messaging" refers to both
Microsoft Exchange and Windows Messaging.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you attempt to start Windows Messaging or compose or open a message
in Windows Messaging, you may receive one of the following error messages:

<UL><LI>EXCHNG32 caused an exception 05h in WMSFR32.DLL

<LI>EXCHNG32 caused an invalid page fault in module WMSFR32.DLL

<LI>EXCHNG32 caused an invalid page fault in module WMSUI32.DLL

<LI>Some information could not be read. Microsoft Exchange Client - 9992 -
   [81002708]

<LI>The item could not be displayed. The object could not be found.
   Microsoft Windows Messaging System Forms Registry - 13085 - [8004010F]

<LI>The item could not be displayed [80004005]

<LI>The item could not be displayed [81003355]

<LI>The command you specified could not be carried out. The object could
   not be found.
   Microsoft Windows Messaging System Forms Registry - 13085 - [8004010F]

<LI>The command you specified could not be carried out. The form cache file
   &lt;frmcache&gt; is not valid. Contact your administrator. Error code
   0x81003364.
   Microsoft Windows Messaging System Forms Registry - 13156 - [80040119]

<LI>The Mapi spooler has shut down unexpectedly.
<P>
</UL>In addition, you may find that the long folder name associated with the
Program Files\Microsoft Exchange folder is damaged or that the Program
Files folder has been renamed to $!$!$!$!.$!$.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior can occur if any of the following conditions exists:

<UL><LI>The Wmsfr32.dll, Wmsui32.dll, or Frmcache.dat file is missing or
   damaged.

<LI>The long folder name associated with the Program Files\Microsoft
   Exchange folder is damaged or the Program Files folder has been renamed
   to $!$!$!$!.$!$.

<LI>The Exchange or MlSet values under the Hkey_Local_Machine\Software\
   Microsoft registry key are missing or damaged.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To resolve this issue, perform the following steps. After performing each
step, check to see if the problem has been resolved.

<OL><P><LI>Verify that the Frmcache.dat file is not missing or damaged. To do so,
   perform the following steps. Before performing each step, rename the
   Frmcache.dat file in the Windows\Forms folder, if it exists. After
   performing each step, check to see if the problem has been resolved.
<P>
   a. Double-click the Mlset32.exe file in the Program Files\Microsoft
<P><PRE>      Exchange folder.
</PRE><P>
   b. Copy the Frmcache.bak file in the Windows\Forms folder to
<P><PRE>      Frmcache.dat.
</PRE><P>
   c. Obtain a copy of the Frmcache.dat file from a computer on which
<P><PRE>      Windows Messaging is functioning properly and then copy the file to
      the Windows\Forms folder on your computer.
</PRE>
<P><LI>Verify that the Program Files\Microsoft Exchange folder exists. To do
   so, attempt to locate the folder using Windows Explorer. If the folder
   name that appears in Windows Explorer is Program Files\Micros~1 or
   Progra~1\Microsoft Exchange, or if the Program Files folder has been
   renamed to $!$!$!$!.$!$, please see the following article in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../win95x/q143395.htm">Q143395</A></B>
<PRE></PRE>      TITLE     : Microsoft Exchange Folder Truncated to "Micros~1"

</PRE><P><LI>Rename all copies of the Wmsfr32.dll and Wmsui32.dll files on your hard
   disk, and then extract new copies of the Wmsfr32.dll and Wmsui32.dll
   files from your original Windows 95 disks or CD-ROM to the Windows\
   System folder. The Wmsfr32.dll and Wmsui32.dll files are located in the
   Win95_06.cab cabinet file on the Windows 95 CD-ROM or the Win95_07.cab
   cabinet file on disk 7 of your original Windows 95 disks.
<P>
   For information about using the Extract tool, type "extract" (without
   quotation marks) at a command prompt, or see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q129605.htm">Q129605</A></B>
<PRE></PRE>      TITLE     : How to Extract Original Compressed Windows Files

   NOTE: If you have installed the Microsoft Exchange Update for Windows
   95, you should not extract new copies of the Wmsfr32.dll and
   Wmsui32.dll files from your original Windows 95 disks or CD-ROM. After
   you rename all copies of the files on your hard disk, you should
   reinstall the Microsoft Exchange Update from the online source from
   which you originally installed it.

</PRE><P><LI>Verify that the Exchange and MlSet values under the following registry
   key are not missing or damaged:
<P>
<P><PRE>      Hkey_Local_Machine\Software\Microsoft
</PRE><P>
   WARNING: Using Registry Editor incorrectly can cause serious problems
   that may require you to reinstall Windows 95. Microsoft cannot
   guarantee that problems resulting from the incorrect use of Registry
   Editor can be solved. Use Registry Editor at your own risk.
<P>
   For information about how to edit the registry, view the Changing Keys
   And Values online Help topic in Registry Editor (Regedit.exe). Note
   that you should make a backup copy of the registry files (System.dat
   and User.dat) before you edit the registry.
<P>
   The Exchange value should have the following value:
<P>
<P><PRE>      C:\Progra~1\Micros~1\exchng32.exe
</PRE><P>
   The MlSet value should have the following value:
<P>
<P><PRE>      C:\Progra~1\Micros~1\mlset32.exe
</PRE><P>
   If either of these values is missing or incorrect, create or modify the
   value manually.

<P><LI>Remove and reinstall Microsoft Exchange. To do so, follow these steps:
<P>
   a. In Control Panel, double-click Add/Remove Programs.
<P>
   b. Click the Windows Setup tab and then click the Microsoft Exchange
<P><PRE>      check box to clear it. If you are prompted to remove Microsoft Fax
      also, do so.
</PRE><P>
   c. Click OK.
<P>
   d. After Microsoft Exchange is removed, remove all files in the
<P><PRE>      Windows\Forms folder and then restart Windows 95.
</PRE><P>
   e. In Control Panel, double-click Add/Remove Programs.
<P>
   f. Click the Windows Setup tab and then click the Microsoft Exchange
<P><PRE>      check box to select it. If you also removed Microsoft Fax, click
      that check box to select it also.
</PRE><P>
   g. Click OK.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The Frmcache.dat file is created during the initial configuration of
Windows Messaging, either by the Microsoft Exchange Setup Wizard or later
when you add the first service. The Frmcache.dat file contains standard
forms and other information that Windows Messaging uses to perform tasks
such as displaying and sending messages. If the information associated
with a particular task is missing or damaged, you receive an error message
when you attempt to perform that task. If all other information in the
file is not damaged, Windows Messaging appears to function properly when
performing all other tasks.
<P>
The size of a valid Frmcache.dat file is usually 16K or larger. Many
programs add information to the Frmcache.dat file when they are installed,
causing the file to increase in size. The Frmcache.bak file is created
when the Frmcache.dat file is first created and is typically not modified
when a program adds information to Frmcache.dat file. Therefore, if you
replace the Frmcache.dat file with the Frmcache.bak file, any information
added to the Frmcache.dat file is lost. This information must be replaced
manually by reinstalling the program that originally added it.
<P>
The following situations can cause the Frmcache.dat file to become damaged:

<UL><LI>You backed up and restored the files on your computer, but long file
   names were not recognized correctly. After the files were restored, the
   path for the Program Files\Microsoft Exchange folder did not match the
   associated registry entries.

<LI>Your computer contains a preinstalled copy of Windows 95. When an image
   of Windows 95 is placed on a hard disk, Windows Messaging may appear to
   be installed correctly, but the Frmcache.dat file may not have been
   created correctly.
<P>
</UL>The Microsoft Exchange Configuration Wizard (Mlset32.exe) is run for the
first time when Windows Messaging is first installed. It can be used as a
troubleshooting tool after Windows Messaging has been installed, but it is
not always successful in rebuilding the Frmcache.dat file.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 4.00 corrupt form msn msnetwork<BR>
Keywords          : exchange win95 winnt kberrmsg kbtool kbfaq<BR>
Version           : 4.0 95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbtshoot<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
