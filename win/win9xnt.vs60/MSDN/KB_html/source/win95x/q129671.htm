

<HTML>
<HEAD>
<TITLE>Problems Using Real-Mode Compression Driver in Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129671">
<META NAME="KBModify" CONTENT="1998/03/20">
<META NAME="KBCreate" CONTENT="1995/05/01">
<META NAME="Keywords" CONTENT="drvspace win95 winplus kberrmsg kbtool">
<META NAME="KBArea" CONTENT="Support; KB; win95x, crossnet, winprint">
<META NAME="Description" CONTENT="  When you are using DriveSpace or DriveSpace 3, you may experience any of the following symptoms:   - You cannot mount removable media from the DriveSpace tool. When you try    to mount compressed drives located on removable media, DriveSpace    res...">
<META NAME="Product" CONTENT="Windows 95">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QBWQ,QAIJ,QDL7,QA3P,QABI,QANE,QDK2,QAXB,QAC9,QAY2,QBWS,QAFI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Problems Using Real-Mode Compression Driver in Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 20, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129671</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Windows 95
<LI>Microsoft Plus! for Windows 95
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you are using DriveSpace or DriveSpace 3, you may experience any of
the following symptoms:

<UL><LI>You cannot mount removable media from the DriveSpace tool. When you try
   to mount compressed drives located on removable media, DriveSpace
   restarts your computer in mini-Windows mode and then mounts the drive.
   However, when your computer restarts normally, the removable drive is
   not mounted.

<LI>Automatic mounting does not work when you start Windows 95 normally
   (when you start the GUI). Even though you select the Automatically
   Mount New Compressed Drives option from the Advanced menu in Drive-
   Space, Windows 95 does not automatically mount a compressed drive if it
   is located on removable media (such as a floppy disk). However, the
   drive is mounted when you boot to a Windows 95 command prompt.

<LI>You are unable to compress a RAMDrive from the DriveSpace tool. When
   you try to compress a RAMDrive, your computer restarts several times,
   and you receive the following message:
<P>
<P><PRE>      To continue this task, Windows needs to restart your computer now.
</PRE><P>
<P><PRE>      If your computer is set up to run more than one operating system,
      make sure that it restarts Windows 95. Windows 95 will finish this
      task in an environment that looks similar to earlier versions of
      Windows.
</PRE><P>
<P><PRE>      Do you want to continue?
</PRE><P>
   If you click Yes, your computer restarts in Mini-windows mode, and
   the following error message is displayed
<P>
<P><PRE>      Cannot examine drive &lt;x&gt;:
</PRE><P>
   where &lt;x&gt; is the RAMDrive. The computer then restarts again in mini-
   Windows mode and DriveSpace compresses the RAMDrive. However, when
   your computer restarts normally, the RAMDrive is not compressed.

<LI>You cannot unmount a compressed drive from the DriveSpace tool. When
   you try to unmount a compressed drive, you receive the following
   message:
<P>
<P><PRE>      Windows will unmount drive &lt;x&gt; as soon as you restart your
      computer. Would you like to restart your computer now?
</PRE><P>
<P><PRE>      Caution: If you do not restart your computer now, you may lose your
      changes.
</PRE><P>
   If you click Yes, Windows 95 restarts, but the compressed drive is
   still mounted.

<LI>When you view the properties of a drive compressed with DriveSpace 3,
   the capacity of the drive may be overstated.
<P>
</UL><h2>CAUSE</h2>
 
<P>
These problems can occur if the real-mode DriveSpace compression driver
(Drvspace.bin or Dblspace.bin) is loaded instead of the protected-mode
DriveSpace compression driver (Drvspacx.vxd) for one of the following
reasons:

<UL><LI>The Drvspacx.vxd file is missing or damaged.

<LI>The real-mode DoubleSpace or DriveSpace compression driver from
   Microsoft MS-DOS version 6.0 or later was loaded when the computer was
   started. If either the Dblspace.bin or Drvspace.bin file from MS-DOS
   6.0 or later is present in memory when Windows 95 starts, Drvspacx.vxd
   is not loaded.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Make sure that the protected-mode Drivespace driver (Drvspacx.vxd) loads
when Windows 95 starts by following these steps:

<OL><P><LI>Make sure that the Drvspacx.vxd file is present in the Windows\
   System\Iosubsys folder. If the file is not present, extract a copy of
   the file from the Win95_09.cab cabinet file on your original Windows 95
   CD-ROM or disk 9 to the Windows\System\Iosubsys folder on the hard
   disk.
<P>
   NOTE: If you are using DriveSpace 3, extract the Drvspacx.vxd file from
   the Plus_1.cab cabinet file on your original Microsoft Plus! CD-ROM or
   disk 1 instead.
<P>
   For information about using the Extract tool, type "extract" (without
   quotation marks) at a command prompt, or see the following article in
   the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../zmiscellaneous/q129605.htm">Q129605</A></B>
<PRE></PRE>      TITLE     : How to Extract Original Compressed Windows Files

</PRE><P><LI>Copy the Drvspace.bin file from the Windows\Command folder to the root
   folder of the boot drive as both Drvspace.bin and Dblspace.bin. To do
   so, type the following lines at a command prompt, pressing ENTER after
   each command:
<P>
<P><PRE>      copy c:\windows\command\drvspace.bin &lt;drive&gt;:\drvspace.bin /y
      copy c:\windows\command\drvspace.bin &lt;drive&gt;:\dblspace.bin /y
</PRE><P>
   where &lt;drive&gt; is the physical boot drive. If drive C is compressed,
   copy the Drvspace.bin file to the root folder of the host drive for
   drive C instead of the root folder of drive C.
<P>
   NOTE: The /Y switch causes the COPY command to replace existing files
   without prompting you for confirmation.
<P>
</OL>After performing these steps, check to see if the problem has been
resolved. If it has not, perform the following additional step:

<OL><P><LI>If you did not extract the Drvspacx.vxd file in step 1 because it
   already exists in the Windows\System\Iosubsys folder, extract it now.
   In addition, extract the Drvspace.bin file from the Windows 95 CD-ROM
   or Disk 1 to the Windows\Command folder. After extracting this file,
   repeat step 2.
<P>
   NOTE: If you are using DriveSpace 3, extract the Drvspace.bin file
   from your original Microsoft Plus! CD-ROM or disk 1 instead.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Windows 95 and
Microsoft Plus! for Windows 95 version 1.0. We are researching this
problem and will post new information here in the Microsoft Knowledge
Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The DriveSpace compression driver (Drvspacx.vxd) included with Windows 95
and Microsoft Plus! provides protected-mode access to both DoubleSpace and
DriveSpace compressed drives.
<P>
When your computer starts, the real-mode DriveSpace driver (Drvspace.bin
or Dblspace.bin) is used to mount any compressed drives specified in the
Drvspace.ini or Dblspace.ini file. When Windows 95 starts, Drvspacx.vxd
replaces Drvspace.bin or Dblspace.bin and provides the functionality of
these real-mode compression drivers in protected mode.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 95<BR>
Keywords          : drvspace win95 winplus kberrmsg kbtool<BR>
Version           : 95<BR>
Platform          : WINDOWS<BR>
Issue type        : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 20, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
