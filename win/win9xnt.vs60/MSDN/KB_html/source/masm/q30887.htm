

<HTML>
<HEAD>
<TITLE>Accessing MASM Structure Fields in a Multimodule Program </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" href="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q30887 ">
<META NAME="KBModify" CONTENT="1995/01/23">
<META NAME="KBCreate" CONTENT="1988/05/26">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  To use a structure, defined in one module with the STRUC (STRUCT in MASM 6.0) operator, in another module with the Macro Assembler, you must take into account the fact that the structure definition must be available to both modules at assemble time...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA7O,QA7N,QAEG,QAIC,QBQU,QASA,QDKS,QAYA,QAYZ,QAK6,QAGI,QAEF,QAUJ,QANY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Accessing MASM Structure Fields in a Multimodule Program</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q30887 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 5.0, 5.1, and 6.0
<LI>Microsoft Macro Assembler for OS/2, version 6.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
To use a structure, defined in one module with the STRUC (STRUCT in
MASM 6.0) operator, in another module with the Macro Assembler, you
must take into account the fact that the structure definition must be
available to both modules at assemble time. The structure field operator
(.) can then be used to access the structure's contents.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following program demonstrates the use of a structure in a
two-module program:
<P>
; Source file 1:
<P>
<PRE>EXTRN changecow:NEAR                ; Near function call

animals    STRUC                    ; Structure definition
    cat    db    "catfield      "
    dog    db    "dogfield      "   ; Field widths of 15 characters
    cow    db    "cowfield      "
animals    ENDS

</PRE>.MODEL small
<P>
.DATA
<PRE>           PUBLIC zoo
zoo        animals   &lt;"felix","spot","Holstein"&gt;  ; Initialize fields

</PRE>.CODE
<PRE>main:      mov ax, @data            ; Make data addressable
           mov ds,ax
           mov es,ax                ; For string moves

           call changecow           ; Change "Holstein" to "Daisy"
           retf
           END main

</PRE>; Source file 2:
;    In source file 2, structure definition must be available for the
; field offsets. (Normally it would be placed in an include file,
; then the INCLUDE operator would be used; however, for sake of
; clarity, the structure definition has been placed in both files).
;    The structure information must be included here to correctly
; associate the fields with the offset. The structure name does not
; need to be "animals"; however, the structure fields should
; correspond.
<P>
<PRE>animals    STRUC                    ; Structure definition
    cat    db    "catfield      "
    dog    db    "dogfield      "   ; Field widths of 15 characters
    cow    db    "cowfield      "
animals    ENDS


</PRE>.MODEL small
<P>
.DATA
<PRE>EXTRN zoo:NEAR                       ; Let assembler know about zoo
newcow    db     "Daisy         "    ; Replace cow with new name
lenname   EQU    $ - newcow          ; Length of new name

</PRE>.CODE
<PRE>          PUBLIC changecow           ; Changes cow field to "Daisy"
</PRE>changecow PROC
<PRE>          mov     di, offset zoo.cow ; es:di should now point to
</PRE>destination
<PRE>          mov     si, offset newcow  ; ds:si should now point to the source
          mov     cx, lenname        ; Length of new string
          rep     movsb              ; Do replacement
          ret
</PRE>changecow ENDP
<PRE>          END
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 5.00 5.10 6.00<BR>
KBCategory: kbprg<BR>
KBSubCategory: MASMLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
