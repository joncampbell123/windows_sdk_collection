

<HTML>
<HEAD>
<TITLE>Using OFFSET with a Group of Data Segments </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" href="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q49246 ">
<META NAME="KBModify" CONTENT="1995/01/23">
<META NAME="KBCreate" CONTENT="1989/09/28">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  When using the OFFSET directive to refer to a variable defined in a SEGMENT that is part of a GROUP, the offset generated is from the beginning of the SEGMENT if full segment declarations are used. Normally when using the OFFSET directive, the offs...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QABO,QBDA,QAIJ,QAY2,QATO,QAYA,QDMW,QDIV,QAY5,QAYL,QAOE,QBV8,QABG,QA0K V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>Using OFFSET with a Group of Data Segments</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 23, 1995</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q49246 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 5.0, 5.1 and 5.1a
<LI>Microsoft Macro Assembler for OS/2, versions 5.1 and 5.1a
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
When using the OFFSET directive to refer to a variable defined in a
SEGMENT that is part of a GROUP, the offset generated is from the
beginning of the SEGMENT if full segment declarations are used.
Normally when using the OFFSET directive, the offset generated is
from the beginning of the GROUP when simplified segment declarations
are used.
<P>
This behavior occurs in Microsoft Macro Assembler (MASM) versions
5.0, 5.1, and 5.1a and in QuickAssembler versions 2.01 and 2.51.
Starting with MASM 6.0 you can use the OPTION OFFSET directive to
control whether the offset generated is from the beginning of the
SEGMENT or from the beginning of the GROUP.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The code below will demonstrate this behavior. The OFFSET directive
generates an offset relative to the beginning of the SEGMENT instead
of the beginning of the GROUP. When a segment override is used to
specify the segment to take the address relative to, the expected
offset is generated. Also, the LEA instruction generates the offset
relative to the segment the DS register is assumed to.
<P>
<P><h3>Sample Code</h3>
 
<P>
; Assemble options needed: none
<P>
dgroup GROUP data1,data2
<P>
data1 SEGMENT PARA PUBLIC 'DATA'
var1 DW 12 DUP (1)
data1 ENDS
<P>
data2 SEGMENT PARA PUBLIC 'DATA'
var2 DW 0
data2 ENDS
<P>
code SEGMENT PARA PUBLIC 'CODE'
ASSUME cs:code,ds:dgroup
start:
<PRE>    mov bx, OFFSET var2        ; &lt;--offset relative to segment
    mov bx, OFFSET dgroup:var2 ; &lt;--offset relative to dgroup
    lea bx, var2               ; &lt;--offset relative to ds
    mov ax, 4C00h
    int 21h
</PRE>code ENDS
<P>
END start
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: kbinf 5.00 5.10 5.10a<BR>
KBCategory: kbprg<BR>
KBSubCategory: MASMLngIss<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 23, 1995</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
