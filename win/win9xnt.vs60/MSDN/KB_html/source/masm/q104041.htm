

<HTML>
<HEAD>
<TITLE>FIX: Functions Exported Incorrectly in MASM 6.1 WINDLL Sample </TITLE>

<!--STYLE_BEGIN-->
<LINK REL="STYLESHEET" href="/support/kbstyle.css" TYPE="text/css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q104041">
<META NAME="KBModify" CONTENT="1997/09/16">
<META NAME="KBCreate" CONTENT="1993/09/05">
<META NAME="Keywords" CONTENT="">
<META NAME="KBArea" CONTENT="Support; KB; masm">
<META NAME="Description" CONTENT="  The SYSDATA.EXE sample program supplied with the Microsoft Macro Assembler (MASM) versions 6.1 and 6.1a displays incorrect data when run. (This assumes you have already successfully built SYSINFO.DLL using the provided makefile, SYSINFO.MAK.)  CAUS...">
<META NAME="Product" CONTENT="Macro Assembler">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT=" ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAR4,QAAP,QA3P,QAY5,QAH4,QDL9,QBWO,QBWN,QBVV,QBWS,QBV8,QAB9,QAPF,QAKP,QDNN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>FIX: Functions Exported Incorrectly in MASM 6.1 WINDLL Sample</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q104041</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
6.10 6.10a
MS-DOS
kbtool kbfixlist kbbuglist
<P>
 
The information in this article applies to:

<UL><LI>Microsoft Macro Assembler for MS-DOS, versions 6.1 and 6.1a
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The SYSDATA.EXE sample program supplied with the Microsoft Macro
Assembler (MASM) versions 6.1 and 6.1a displays incorrect data when
run. (This assumes you have already successfully built SYSINFO.DLL
using the provided makefile, SYSINFO.MAK.)
<P>
<P><h2>CAUSE</h2>
 
<P>
SYSDATA.EXE was built with a different import library than the one
created from the SYSINFO files shipped with MASM. Therefore,
SYSDATA.EXE does not correctly call the functions within SYSINFO.DLL,
which causes the program to display incorrect data.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two solutions (described below) to the problem. If you have
the Microsoft Windows Software Development Kit (SDK), you can choose
either solution. The SDK is relevant because RC.EXE is required to
build SYSDATA.EXE. RC.EXE is shipped with the SDK and is not included
with MASM.

<UL><LI>If you have the SDK, you can rebuild SYSDATA.EXE using SYSDATA.MAK.
   This uses the import library produced from building
   SYSINFO.DLL--SYSINFO.LIB. When you run the rebuilt SYSDATA.EXE, the
   correct data is displayed.

<LI>If you do not have the SDK, you need to first modify SYSINFO.DEF so
   that it resembles the following:
<P>
<P><PRE>      EXPORTS
<PRE></PRE>              GetSysTime   @1
              GetSysDate   @2
              GetSysInfo   @3
              WEP          @4   RESIDENTNAME

   After making the changes, rebuild SYSINFO.DLL using SYSINFO.MAK.
   When you then run SYSDATA.EXE, it will correctly reference the
   functions within the rebuilt SYSINFO.DLL and display the correct
   data.

</PRE></UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in MASM version 6.1, and
6.1a. This problem was corrected in MASM version 6.11.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: 6.10 6.10a<BR>
KBCategory: kbtool kbfixlist kbbuglist<BR>
KBSubcategory: CodeSam<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
