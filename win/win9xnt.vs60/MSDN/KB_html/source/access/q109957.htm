

<HTML>
<HEAD>
<TITLE>ACC: Introduction to .LDB Files (1.x/2.0) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109957">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="GnlMu kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  Q: What is an .LDB file and what is it used for?  A: The .LDB file maintains lock information about a database, and    each user who opens the database has an entry in it. ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAGU,QAZV,QDN9,QBWF,QAB4,QAYY,QBVV,QA5V,QBWS,QAM9,QARA,QBXB,QATJ,QAHC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Introduction to .LDB Files (1.x/2.0)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109957</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
Q: What is an .LDB file and what is it used for?
<P>
A: The .LDB file maintains lock information about a database, and
<PRE>   each user who opens the database has an entry in it. The .LDB file
   contains the computer and user names of all users currently
   accessing a database in a multiuser (network) environment. No
   other information is read from or written to the .LDB file.

   Microsoft Access uses this information to tell which records are
   locked in a database, and who has them locked, to prevent possible
   file contention errors and database corruption by multiple users.

   However, the .LDB file does not give Microsoft Access information
   about who has a database opened exclusively, because this is handled by
   SHARE.EXE (or VSHARE.386 in Windows 3.1). Those programs do not
   return information to Microsoft Access about who has the database
   open.

</PRE>Q: Can I find out the structure of the .LDB file?
<P>
A: The format of the .LDB file is not published and is subject to
<PRE>   change or elimination in future releases of Microsoft Access.
   Therefore, code written to manipulate it or to read its current
   format may not work correctly if the .LDB file is eliminated or its
   format is changed in a future release.

</PRE>Q: Can a user or programmer gain access to the information in the .LDB
<PRE>   file?

</PRE>A: No. The information in the .LDB file is only used internally by
<PRE>   Microsoft Access and is not designed to be used by users or programmers.

</PRE>Q: Where and when is an .LDB file created?
<P>
A: An .LDB file is created when you open a database. The .LDB file must
<PRE>   reside in the same directory as that database. If an .LDB file isn't
   present and Microsoft Access requires it, Microsoft Access attempts
   to create one in the same directory as the database.

   Normally, the .LDB file must be in a directory where the user has
   read-write privileges. However, it is possible to open a database
   in a directory or device where a user has read-only privileges.
   To do this, select both the Read Only and the Exclusive check boxes
   in the Open Database dialog box. The Open Database dialog box can
   be found by selecting Open Database from the File menu. The
   combination of read-only and exclusive means that users will not be
   updating any database information, so record-locking isn't
   required. Because record-locking isn't required, Microsoft Access
   does not attempt to open or create an .LDB file.

   This technique also works with directories where the user has read-
   write privileges and will improve performance if database updating
   isn't required.

</PRE>Q: If you move a database, do you also need to move its .LDB file?
<P>
A: It isn't necessary to move the .LDB file, because Microsoft Access
<PRE>   attempts to re-create the .LDB file if it is not present.

   A potential problem can occur if the database is placed in a
   directory where some users have directory read-only privileges and
   other users have directory read-write privileges.

   When read-only users open a database, no information is written
   to the .LDB file, because those users are not allowed to write any
   information to the database. When read-write users open a database,
   their names and computer information are written to the .LDB file.

   If both of these users (read-only and read-write) open a database
   and read the same record, a file conflict occurs if the read-write
   user attempts to update the record, because an update action would
   conflict with the read-only user. When a file conflict occurs,
   Microsoft Access pulls data from the .LDB file for what it thinks
   is the read-only user and uses this data in the file conflict error
   message given to the read-write user. However, because the read-only
   user's name and computer weren't written to the .LDB file, and because
   previously used .LDB files contain the names of previous read-write
   users, Microsoft Access reads old, outdated user information from
   the .LDB file and subsequently uses it in the error message instead
   of valid user information.

   To protect against this problem, the database should first be
   opened and then closed by one of the read-write users before any read-
   only users open the database. This creates the .LDB file for that
   database.

</PRE>Q: Can I erase the .LDB file?
<P>
A: You can erase the .LDB file if no one currently has it open.
<PRE>   However, unless the database is opened as read-only and exclusive,
   Microsoft Access will re-create the file the next time the database
   is opened.

   In fact, if you receive strange user names reported (such as old user
   names or garbage) when a lock conflict occurs, your .LDB file is
   most likely damaged. If you suspect this, it is best to erase your
   old .LDB file and let Microsoft Access automatically create a new
   one for you.

</PRE>Q: What is the maximum size the .LDB file can be?
<P>
A: The maximum size is 16K, with each active user taking 64 bytes.
<P>
Q: When is information written to the .LDB file?
<P>
A: Information is only written to the .LDB file once, when a user
<PRE>   opens a database and the .LDB file is created, and active user
   information is written to it. After that point, Microsoft Access
   only locks portions of the .LDB file and does not read from it or
   write to it.

</PRE>Q: How does Microsoft Access use the information in the .LDB files?
<P>
A: Microsoft Access uses .LDB file information to determine who has
<PRE>   which files (or records in a file) locked. If Access detects a lock
   conflict with another user, it reads the .LDB file to get the
   computer and user name of the user who has the file or record
   locked. However, the state of the information in the .LDB file has
   no bearing on the state of the database. If the .LDB file is
   completely corrupted, everything in the database will still work
   correctly (although user names reported in lock conflicts might
   look strange).

   In most lock conflict situations, you get a generic "Write conflict"
   error message that allows you to save the record, copy it to the
   Clipboard, or drop the changes you made. In some circumstances, however,
   you receive the following error message:

      Couldn't lock table &lt;table name&gt;; currently in use by user
      &lt;user name&gt; on computer &lt;computer name&gt;.

</PRE>Q: How can I find out which users are accessing my database?
<P>
A: Microsoft Access does not provide direct functionality to identify
<PRE>   users accessing a database. The level and type of functionality in
   this area differs and depends largely on the operating system and
   network software.

   For example, Microsoft Lan Manager provides an Audit API function
   set that can be used to create and manage real-time audit files.
   These audit files keep track of server operations and the users who
   perform them. These API functions can be manipulated through Access
   Basic to provide user information.

   Some operating systems (such as Windows for Workgroups, which comes
   with a tool called NetWatch) give you the ability to identify
   users logged onto a shared network directory. However, NetWatch
   cannot indentify users currently accessing a given file.

</PRE><h2>REFERENCES</h2>
 
<P>
Microsoft Lan Manager "A Programmer's Guide," version 2.0, Chapter 8,
"Information APIs," pages 234-236
<P>
For more information about .LDB files, search for "LDB files" then "Locking
Information Files" using the Microsoft Access version 2.0 Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: lockfile Q&amp;A<BR>
Keywords            : GnlMu kbusage<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
