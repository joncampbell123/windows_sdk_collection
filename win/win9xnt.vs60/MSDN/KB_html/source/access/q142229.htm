

<HTML>
<HEAD>
<TITLE>ACC: Yes/No Field Not Evaluating "-1" or "0" in Comparisons </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q142229">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1996/01/08">
<META NAME="Keywords" CONTENT="CnvGnrl kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Code written in Access Basic that uses  -1  or  0  (with the quotation marks) to compare a Yes/No field in a table or recordset does not work properly when you convert the Access...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBS0,QA5F,QAMA,QDN9,QAH4,QADK,QABH,QAKD,QA50,QBTV,QA01,QA5V,QAJH,QAG7 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Yes/No Field Not Evaluating "-1" or "0" in Comparisons</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q142229</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Code written in Access Basic that uses "-1" or "0" (with the quotation
marks) to compare a Yes/No field in a table or recordset does not work
properly when you convert the Access Basic code to Visual Basic for
Applications code. In Microsoft Access version 2.0, which uses Access
Basic, the numeric comparisons are evaluated as strings. In Microsoft
Access 7.0 and 97, which uses Visual Basic for Applications, the numeric
comparisons are evaluated as Boolean values.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Access Basic the condition
<P>
<PRE>   If rs![yesnofield] = "-1" Then

</PRE>is evaluated as True, and the condition:
<P>
<PRE>   If rs![yesnofield] = "0" Then

</PRE>is evaluated as False.
<P>
In Visual Basic for Applications, these conditions are no longer evaluated
in this manner.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
In an open Access Basic or Visual Basic for Application Module window, use
the Find command on the Edit menu (or press CTRL+F) to check for instances
of the strings "-1" or "0" (with the quotation marks).
<P>
Change all instances in Visual Basic for Applications where "-1" or "0" is
used to compare a Yes/No field in a table or recordset as described below.
<P>
If you are using the following expression in Access Basic
<P>
<PRE>   IF rs![yesnofield] = "-1" Then

</PRE>in Visual Basic for Applications change the code so that there are no
quotation marks around the number "-1" or use the word "True" as in the
following example:
<P>
<PRE>   IF rs![yesnofield] = -1 Then

   -or-

   IF rs![yesnofield] = True Then

</PRE>If you are using the following expression in Access Basic
<P>
<PRE>   IF rs![yesnofield] = "0" Then

</PRE>in Visual Basic for Applications, change the code so that there are no
quotation marks around the number "0" or use the word "False" as in the
following example:
<P>
<PRE>   IF rs![yesnofield] = 0 Then

   -or-

   IF rs![yesnofield] = False Then

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access 2.0 and open the sample database NWIND.MDB.

<P><LI>Open the Products form in Design view and set the form's OnCurrent
   property to the following event procedure:
<P>
<PRE>      Sub Form_Current()
      Dim rs As Recordset
         Set rs = Me.RecordsetClone
         rs.Bookmark = Me.Bookmark
         If rs![Discontinued] = "-1" Then
            MsgBox "This product is discontinued."
         End If
         Set rs = Nothing
      End Sub

</PRE><P><LI>Open the Products form in Form view and, using the record selectors,
   move through the records. Note that a message box appears for all
   discontinued products.

<P><LI>Start Microsoft Access 7.0 or 97, and repeat steps 1-3. In step 2,
   change the first line of code that reads
<P>
<PRE>      Sub Form_Current()

   to read as follows:

      Private Sub Form_Current()

</PRE><P><LI>Open the Products form in Form view and, using the record selectors,
   move through the records. Note that the message box for the discontinued
   products does not appear.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Boolean data type, search the Help Index
for "Boolean data type," or ask the Microsoft Access 97 Office Assistant
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : CnvGnrl kbusage<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
