

<HTML>
<HEAD>
<TITLE>ACC: Keeping Subreport or Text Box Data Together on a Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145780">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1996/06/12">
<META NAME="Keywords" CONTENT="RptProp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate:  Requires basic macro, coding, and interoperability skills.  Subreports and text box controls do not have a KeepTogether property to prevent the controls' data from printing across two or more pages. However, you can simulate the KeepToge...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QA7O,QAHP,QA1S,QA7N,QAPN,QAOE,QAMN,QAB5,QDN9,QABO,QAYV,QBWS,QAMA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Keeping Subreport or Text Box Data Together on a Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145780</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate:  Requires basic macro, coding, and interoperability skills.
<P>
Subreports and text box controls do not have a KeepTogether property to
prevent the controls' data from printing across two or more pages.
However, you can simulate the KeepTogether property behavior by creating
"artificial" group sections and placing the subreport and text box
controls in these sections. Then, you can set the group's KeepTogether
property to Yes, which causes Microsoft Access to test the layout of the
controls before printing them, and keep the text together on one page.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following steps use the sample database Northwind.mdb to demonstrate
how you can use report sections to simulate a KeepTogether property for
subreport and text box controls.
<P>
<P><h3>Creating a Subreport</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Run the Report Wizard to create a report based on the Products table.

<P><LI>In the "Which Fields do you want on your report?" box, add the following
   fields to the Selected Fields list:
<P>
<P><PRE>      ProductName
      QuantityPerUnit
      UnitPrice
</PRE>
<P><LI>Click Finish.

<P><LI>Close the report.

<P><LI>In the Database window, use the right mouse button to click the Products
   report, and then click Rename on the menu that appears. Type the
   following name for the report, and then press ENTER:
<P>
<P><PRE>      srptProducts
</PRE><P>
</OL><h3>Creating a Main Report</h3>
 

<OL><P><LI>Run the Report Wizard to create a report based on the Categories table.

<P><LI>In the "Which Fields do you want on your report?" box, add all of the
   fields to the Selected Fields list.

<P><LI>Click Finish.

<P><LI>Close the report.

<P><LI>In the Database window, use the right mouse button to click the
   Categories report, and then click Rename on the menu that appears. Type
   the following name for the report, and then press ENTER:
<P>
<P><PRE>      rptCategories
</PRE>
<P><LI>Open the rptCategories report in Design View.

<P><LI>On the View menu, click Sorting And Grouping.

<P><LI>In the Field/Expression dialog box, select CategoryID in the first row
   and type the following expression in the second row (below CategoryID):
<P>
<P><PRE>      =1
</PRE>
<P><LI>For the "=1" expression, select "Yes" in the GroupFooter property.
<P>
</OL><h3>Adding the Subreport to the Main Report</h3>
 

<OL><P><LI>Drag the srptProducts report from the Database window and drop it onto
   "=1" group footer to create the subreport container.

<P><LI>Change the following subreport control properties:
<P>
<P><PRE>      SubReport control:
<PRE></PRE>        Name: Products
        ControlSource: Report.srptProducts
        LinkChildFields: CategoryID
        LinkMasterFields: CategoryID
        CanGrow: Yes
        Left: 0
        Top: 0
        Width: 7
        Height: .25

</PRE><P><LI>Select the "=1" group footer and set its properties as follows:
<P>
<P><PRE>      ProductsGroup Footer:
<PRE></PRE>        KeepTogether: Yes
        CanGrow: Yes
        Height: .25

</PRE><P><LI>Preview the rptCategories report. Note that the subreport data is
   printed on one page, rather than across two or more pages.
<P>
</OL><h3>Additional Notes</h3>
 

<UL><LI>Creating an "artificial" group (as demonstrated in this article) works
   well for subreport controls, as well as for text box controls bound to
   Memo fields. When Memo fields are printing, there are no events
   triggered until the Memo field is finished. Therefore, you cannot tell
   if the Memo field will split data between two pages. By placing the Memo
   field in its own "artificial" group, the group's KeepTogether property
   will test the layout of the Memo field before printing and keep the text
   together on one page when printing.

<LI>If your subreport or text box does not grow, you can size the
   subreport control in the main report to be the same size as the
   subreport itself. Then, set the KeepTogether property of the
   subreport's section on the main report to No. When you print the
   report, Microsoft Access will not generate a page break in the middle
   of a control.

<LI>If your subreport or text box does grow, you should place the control
   into its own section and set the KeepTogether property for the
   subreport's section in the main report to Yes.
</UL> 
<PRE>Keywords          : RptProp kbusage
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbinfo</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
