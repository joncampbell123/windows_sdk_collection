

<HTML>
<HEAD>
<TITLE>ACC95: Exporting Query w/ Text Export Wizard Reorders Columns </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163765">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1997/02/17">
<META NAME="Keywords" CONTENT="IsmTxtd kbusage QryGnrl">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the Text Export Wizard to create a delimited text file from a query that contains an expression, the order of the columns in the text file is different than it is in...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QBRZ,QAPN,QBTI,QBWS,QAH4,QATX,QAMB,QAUR,QACF,QA1S,QBS0,QBJZ,QA2Q,QAIK V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Exporting Query w/ Text Export Wizard Reorders Columns</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163765</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the Text Export Wizard to create a delimited text file from a
query that contains an expression, the order of the columns in the text
file is different than it is in the query.
<P>
NOTE: This behavior also occurs when using the Text Import Wizard.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want to retain the same column order in the exported text file, you
can create a table from the query, and then export the table.
<P>
Or, you can use the TransferText action or method in a macro or Visual
Basic for Applications code.
<P>
<P><h3>Method 1: Exporting a Table Created from the Query</h3>
 

<OL><P><LI>Create the select query that you want to export to a text file.

<P><LI>On the Query menu, click Make Table.

<P><LI>In the Make Table dialog box, type the name of a new table to store the
   results of the query.

<P><LI>On the Query menu, click Run. Confirm that you want to paste the rows
   into a new table.

<P><LI>Close the query, and then select the new table in the Database window.

<P><LI>On the File menu, click Save As/Export to start the Text Export Wizard
   and save the table to a delimited text file.
<P>
</OL><h3>Method 2: Using the TransferText Action or Method</h3>
 
<P>
The following steps use the TransferText action in a macro; the same
results apply if you use the TransferText method of the DoCmd object in
Visual Basic code.

<OL><P><LI>Create the select query that you want to export to a text file.

<P><LI>Create a new macro that contains the TransferText action to export the
   query to a delimited text file.

<P><LI>Run the macro to export the query.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0. This
problem no longer occurs in Microsoft Access 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a new query in Design view based on the Customers table:
<P>
<P><PRE>      Query: qryExpCustomer
      ------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: CustomerID
<PRE></PRE>         Table: Customers
      Field: Expr1: "ABCDEFG"
      Field: CompanyName
         Table: Customers

</PRE><P><LI>Save the qryExpCustomer query, and then open it in Datasheet view. Note
   the order of the columns.

<P><LI>Close the query and select it in the Database window.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an external File or Database," and
   then click OK.

<P><LI>In the "Save Query 'qryExpCustomer' In" dialog box, select Text Files in
   the Save As Type box, and then click Export.

<P><LI>In the first screen of the Text Export Wizard, click Delimited, and note
   that the columns in the query are ordered correctly. Click Finish.

<P><LI>Use Notepad or another text editor to open the qryExpCustomer.txt file.
   Note that the column containing "ABCDEFG" is reordered.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the TransferText method or macro action, search
the Help Index for "TransferText action" or "TransferText method."
<P>
For more information about exporting text files, search the Help Index for
"exporting data."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: move switch transfer rearrange<BR>
Keywords            : IsmTxtd kbusage QryGnrl<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
