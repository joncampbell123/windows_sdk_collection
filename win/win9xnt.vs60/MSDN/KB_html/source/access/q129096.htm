

<HTML>
<HEAD>
<TITLE>ACC: How to Sum a Calculation in a Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129096">
<META NAME="KBModify" CONTENT="1998/02/04">
<META NAME="KBCreate" CONTENT="1995/04/18">
<META NAME="Keywords" CONTENT="RptTotal kbusage kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates three methods that you can use to sum a calculated control in a report. Because the Sum() function, as well as the other aggregate (totals) functions ca...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAE5,QAWH,QA7O,QAHP,QAMN,QAB5,QAPN,QAOE,QAGF,QA1S,QADP,QAY5,QAB9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Sum a Calculation in a Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 4, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129096</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates three methods that you can use to sum a
calculated control in a report. Because the Sum() function, as well as the
other aggregate (totals) functions can reference only a field and not a
control, you must use one of these methods if you want to sum a calculated
control.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If the expression in the calculated control does not include another
aggregate function, you can sum the expression by repeating it in the
report or group footer section and taking its sum. If the expression does
include another aggregate function, repeating the expression does not work
because Microsoft Access cannot sum a sum. Instead, use a running sum or a
function to hold the results.
<P>
To demonstrate the three methods, this article uses a report based on the
Order Details table in the sample database Northwind.mdb (or NWIND.MDB in
Microsoft Access 1.x and 2.0).
<P>
NOTE: For calculating totals in a page footer section, use only methods two
and three.
<P>
<P><h3>Creating the Report</h3>
 
<P>
To create the report, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in versions
   1.x and 2.0)

<P><LI>Create a report based on the Order Details table. Select Design View.
   (In Microsoft Access 1.x and 2.0, choose Blank Report).

<P><LI>Create an OrderID group by choosing Sorting And Grouping from the View
   menu and then entering the following information in the Sorting And
   Grouping window:
<P>
<P><PRE>      Field/Expression: OrderID
      Group Header: Yes
      Group Footer: Yes
</PRE><P>
   NOTE: In Microsoft Access 1.x and 2.0, there is a space in Order ID.

<P><LI>Add a report header and footer section to the report by clicking Report
   Header/Footer on the View menu. (In Microsoft Access 1.x and 2.0, Report
   Header/Footer is on the Format menu).
<P>
</OL><h3>Method 1: Summing Expressions That Do Not Contain Aggregate Functions</h3>
 
<P>
To sum a calculation that does not contain an aggregate function, repeat
the calculation with the Sum() function. To use this method, follow
these steps:

<OL><P><LI>Add a text box control to the report's detail section to calculate the
   product of two fields. Note that the Name property is the ControlName
   property in Microsoft Access 1.x. Set the control's properties as
   follows:
<P>
<P><PRE>      Name: Extended Price
      ControlSource: =[UnitPrice] * [Quantity]
</PRE><P>
   NOTE: In Microsoft Access 1.x and 2.0 there is a space in [Unit Price].

<P><LI>Add a text box control in the OrderID group footer section to calculate
   the total for the group. Set the following properties for the control:
<P>
<P><PRE>      Name: Order Total
      ControlSource: =Sum([UnitPrice] * [Quantity])
</PRE>
<P><LI>Add a text box control in the report's footer section to calculate the
   total for the report. Set the following properties for the control:
<P>
<P><PRE>      Name: Report Total
      ControlSource: =Sum([UnitPrice] * [Quantity])
</PRE>
<P><LI>Preview the report to see the sum of the calculation.
<P>
</OL><h3>Method 2: Summing Expressions That Contain Aggregate Functions</h3>
 
<P>
You can use a running sum to calculate totals for expressions that
contain aggregate functions or that reference other controls. To use
this method, follow these steps.
<P>
NOTE: The RunningSum property is not available in Microsoft Access 1.x.

<OL><P><LI>Add a text box control to the report's OrderID group footer section to
   calculate a control that charges freight only when the order is over
   $100. Set the following properties for the control.
<P>
   NOTE: In the following example, an underscore (_) at the end of a line
   is used as a line-continuation character. Remove the underscore from the
   end of the line when re-creating this example.
<P>
<P><PRE>      Name: Freight
      ControlSource: =IIf(Sum([UnitPrice]*[Quantity])&gt;100,0.05*Sum([Unit _
      Price]*[Quantity]),0)
</PRE><P>
<P><PRE>    NOTE: In Microsoft Access 1.x and 2.0, there is a space in
    [Unit Price].
</PRE>
<P><LI>Add a second text box control to the report's Order ID group footer
   section to calculate the running sum for this control. Set the
   following properties for the control.
<P>
   NOTE: In the following example, an underscore (_) at the end of a line
   is used as a line-continuation character. Remove the underscore from the
   end of the line when re-creating this example.
<P>
<P><PRE>      Name: FreightRunSum
      ControlSource: =IIf(Sum([UnitPrice]*[Quantity])&gt;100,0.05*Sum([Unit _
      Price]*[Quantity]),0)
      RunningSum: Over Group
      Visible: No
</PRE><P>
   NOTE: When you test a running sum, set the Visible property to Yes to
   verify that the control is accumulating. Once you verify that it does,
   hide the control by setting the Visible property to No.

<P><LI>Add a text box control to the report's footer section to display the
   total by referencing the RunningSum property. Set the following
   properties for the control:
<P>
<P><PRE>      Name: Freight Total
      ControlSource: =[FreightRunSum]
</PRE><P>
   NOTE: When you reference another control, use the Val() function to
   convert from a Variant to a number so that the running sum accumulates
   the value. For more information about running sums not accumulating,
   please see the following article in the Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../access/q115877.htm">Q115877</A></B>
<PRE></PRE>      TITLE     : ACC2: RunningSum Text Box in Report Not Accumulating
                  Values

</PRE><P><LI>Preview the report to see the sum of the calculation.
<P>
</OL><h3>Method 3: Summing Controls Calculated by Functions</h3>
 
<P>
If you use code to calculate a control, you must use a function to
calculate its sum. You need the function to hold the results of the
calculation across the records. To use this method, follow these steps:

<OL><P><LI>Create a new module and enter the following code in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
<PRE></PRE>      Dim OrderTotal As Double       ' Used for group total.
      Dim GrandTotal As Double       ' Used for report total.

</PRE><P><LI>Add the following procedure to calculate the product of two fields:
<P>
<P><PRE>      Function CalcProduct (R as Report)
<PRE></PRE>         Dim tmpAmount As Double
         tmpAmount = R![UnitPrice] * R![Quantity]
         ' Remember the total for the group.
         OrderTotal = OrderTotal + tmpAmount
         ' Remember the total for the report.
         GrandTotal = GrandTotal + tmpAmount
         CalcProduct = tmpAmount
      End Function

</PRE><P><LI>Add the following procedure to initialize the report's variables to 0:
<P>
<P><PRE>      Function InitVars ()
<PRE></PRE>         OrderTotal = 0
         GrandTotal = 0
      End Function

</PRE><P><LI>Add the following procedure to retrieve the total for the group:
<P>
<P><PRE>      Function GetGroupTotal ()
<PRE></PRE>         GetGroupTotal = OrderTotal
         ' Reset the variable to 0 for next group.
         OrderTotal = 0
      End Function

</PRE><P><LI>Add the following procedure to retrieve the total for the report:
<P>
<P><PRE>      Function GetReportTotal ()
<PRE></PRE>         GetReportTotal = GrandTotal
      End Function

</PRE><P><LI>To initialize the variables to 0, set the report's OnOpen property to
<P>
<P><PRE>      OnOpen: =InitVars()
</PRE><P>
   and then Add three text box controls to the report's detail section.
   Note that the Name property is the ControlName property in Microsoft
   Access 1.x. Set the following properties for the text boxes:
<P>
<P><PRE>      Text box 1:
<PRE></PRE>         Name: UnitPrice
         ControlSource: UnitPrice

   NOTE: In Microsoft Access 1.x and 2.0, there is a space in
   Unit Price.

      Text box 2:
         Name: Quantity
         ControlSource: Quantity

      Text box 3:
         Name: TheProduct
         ControlSource: =CalcProduct([Report])

</PRE><P><LI>Add a text box control to the group footer section to display the total
   for the group. Set the following properties for the control:
<P>
<P><PRE>      Name: GroupTotal
      ControlSource: =GetGroupTotal()
</PRE>
<P><LI>Add a text box control to the report's footer section to display the
   total for the report. Set the following properties for the control:
<P>
<P><PRE>      Name: ReportTotal
      ControlSource: =GetReportTotal()
</PRE>
<P><LI>Preview the report to see the sum of the calculation.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using sums in reports, search for "sums," and
then "reports" using the Microsoft Access 97 Help Index.
 
<PRE>Keywords          : RptTotal kbusage kbfaq
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 4, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
