

<HTML>
<HEAD>
<TITLE>ACC: How to Use SendKeys in a Macro to Change an OLE Link </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94040 ">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1992/12/22">
<META NAME="Keywords" CONTENT="IntpOle">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes two methods to automate the changing of a linked object's source. The first method is to use a macro, and the second method is to use OLE Automation, ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBPG,QAPN,QA1S,QA9Q,QAFI,QBS9,QA7O,QDN9,QAW6,QAVX,QAVW,QAH4,QAE2,QAXB,QAUJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use SendKeys in a Macro to Change an OLE Link</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94040 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes two methods to automate the changing of a linked
object's source. The first method is to use a macro, and the second method
is to use OLE Automation, which is available in Microsoft Access version
2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Macro Method</h3>
 
<P>
The following example demonstrates how to create and use a macro that
will automatically change the source of a linked OLE object based on a
file name stored in a table.

<OL><P><LI>Create a new table with the following fields, and then save it as
   Linked References:
<P>
<P><PRE>      Table: Linked References
      ------------------------
      Field Name: Key
<PRE></PRE>         Data Type: Counter
      Field Name: File Name
         Data Type: Text
      Field Name: Linked Object
         Data Type: OLE Object

</PRE><P><LI>In Datasheet view, add the following records to the table. Note
   that the bitmaps used in this example are stored in the Microsoft
   Windows directory (by default, C:\WINDOWS). To embed the objects,
   open each bitmap in Microsoft Windows Paintbrush, select the bitmap
   with the selection tool, and then choose Copy from the Edit menu.
   Switch to Microsoft Access, place the pointer in the Linked Object
   field, and choose Paste Link from the Edit menu.
<P>
<PRE>      Key           Filename      Linked Object
      --------------------------------------------------
      (counter)     ARCADE.BMP     Paste Link ARCADE.BMP
      (counter)     ARCHES.BMP     Paste Link ARCHES.BMP
      (counter)     ARGYLE.BMP     Paste Link ARGYLE.BMP

</PRE><P><LI>Create a new form based on the table Linked References, and add all
   three fields to the form.

<P><LI>Save the form as OLE Test.

<P><LI>Create a new macro with the following actions:
<P>
<P><PRE>      In Microsoft Access version 1.x:
</PRE><P>
<PRE>         Action           Arguments
         ----------------------------------------------------------
         GoToControl      Control Name: Linked Object
         SendKeys         Keystrokes: %eol
                          Wait: No
         SendKeys         Keystrokes: =Forms![OLE Test]![File Name]
                          Wait: No
         SendKeys         Keystrokes: {ENTER}
                          Wait: No

      In Microsoft Access version 2.0:

         Action           Arguments
         ----------------------------------------------------------
         GoToControl      Control Name: Linked Object
         SendKeys         Keystrokes: %ekl%c
                          Wait: No
         SendKeys         Keystrokes: =Forms![OLE Test]![File Name]
                          Wait: No
         SendKeys         Keystrokes: {ENTER}{ENTER}
                          Wait: No

</PRE><P><LI>Save the Macro as Update OLE Link.

<P><LI>Open the form OLE Test in Design view and select the control File
   Name.

<P><LI>Set the AfterUpdate property to the macro Update OLE Link.

<P><LI>To test the form, switch to Form view. Change the field File Name
   in the first record to LEAVES.BMP. The OLE object should update to
   display the bitmap LEAVES.BMP.
<P>
</OL><h3>OLE Automation</h3>
 
<P>
Microsoft Access version 2.0 supports OLE Automation, a feature of the OLE
2.0 standard. You can use OLE Automation to directly access and manipulate
another application's objects from outside that application.

<OL><P><LI>Create the following subprocedure in the File Name control's AfterUpdate
   event procedure. The procedure uses the SourceDoc and Action properties
   to change the source of the linked object.
<P>
<PRE>      Sub File_Name_AfterUpdate ()
        Const OLE_LINKED = 0
        Const OLE_CREATE_LINK = 1
        Const OLE_SIZE_ZOOM = 3
        [Linked Object].OLETypeAllowed = OLE_LINKED ' Object type allowed
        [Linked Object].SourceDoc = [File Name]     ' Specify source file
        [Linked Object].Action = OLE_CREATE_LINK    ' Create linked object
        [Linked Object].SizeMode = OLE_SIZE_ZOOM    ' Adjust control size
      End Sub

</PRE><P><LI>View the Linked References table in Form view.

<P><LI>Change the File Name control to REDBRICK.BMP. The OLE object should
   update to display the REDBRICK.BMP bitmap.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "User's Guide," versions 1.0 and 1.1, Chapter 13
<P>
Microsoft Access "User's Guide," version 2.0, Chapter 19
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 13
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpOle<BR>
Technology          : kbole<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
