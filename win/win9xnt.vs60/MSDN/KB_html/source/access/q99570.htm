

<HTML>
<HEAD>
<TITLE>ACC1x: Sending the Current Record to Word for Windows with DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99570 ">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1993/06/02">
<META NAME="Keywords" CONTENT="IntpDde kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  This article describes how to send the current record in Microsoft Access version 1.x to Microsoft Word version 2.0 or 6.0 for Windows to be merged into a prewritten letter and printed.  This article assumes that you are familiar with dynamic data ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIH,QA1S,QDN9,QBUG,QBUF,QAH4,QAY5,QBXS,QA5V,QBV8,QAB9,QDL9,QBWQ,QBWO,QBWN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Sending the Current Record to Word for Windows with DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99570 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article describes how to send the current record in Microsoft Access
version 1.x to Microsoft Word version 2.0 or 6.0 for Windows to be merged
into a prewritten letter and printed.
<P>
This article assumes that you are familiar with dynamic data exchange
(DDE), setting bookmarks in Word for Windows, and creating modules and
using Access Basic in Microsoft Access.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Step One: Create the Word for Windows Document</h3>
 

<OL><P><LI>Start Word for Windows and open a new document.

<P><LI>Enter the following in the blank document:
<P>
<P><PRE>      CompanyName
      Address
      City, Region, PostalCode
      Country
</PRE><P>
<P><PRE>      Dear ContactName,
</PRE><P>
<PRE>         Northwind Traders would like to thank you for
         your business during the past year. Enclosed
         you will find several samples of new products
         that we are excited to announce.

      Sincerely,
      Northwind Traders.

</PRE><P><LI>Save this document as C:\DDEMERGE.DOC.

<P><LI>To create the bookmarks, select CompanyName, and choose Bookmark from
   the Insert menu in Word 2.0, or from the Edit menu in Word 6.0. Name
   the bookmark CompanyName.

<P><LI>Repeat step 4 to create bookmarks for each of the fields (Address,
   City, Region, PostalCode, Country, and ContactName). Make sure to
   give each bookmark the appropriate name.
<P>
</OL><h3>Step Two: Create the Access Basic Module</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database NWIND.MDB.

<P><LI>Create a new module.

<P><LI>Enter the following in the module's Declarations section:
<P>
<P><PRE>      Option Explicit
      Global MergeChan As Integer
      Const ID_YES = 6
</PRE>
<P><LI>Enter the following functions in the module:
<P>
   NOTE: In the following sample code, an underscore (_) is used as a line-
   continuation character. Remove the underscore when re-creating this code
   in Access Basic.
<P>
<P><PRE>      Function Initiate_Word ()
<PRE></PRE>         Dim Chan As Variant
         Dim WordTopics As Variant
         Chan = StartApp("Winword", "System")
         'StartApp is already in the NWIND database. To find it,
         'Choose Modules, then Design in the Database Window.
         'Choose StartUp from the Procedure list box

         On Error GoTo AlertUser:
         WordTopics = DDERequest(Chan, "Topics")

         If InStr(1, WordTopics, "DDEMERGE.DOC") = 0 Then
           DDEExecute Chan, "[FILEOPEN ""C:\DDEMERGE.DOC""]"
         End If

         DDETerminate Chan
         Mergechan = DDEInitiate("Winword", "C:\DDEMERGE.DOC")

      Exit Function

      AlertUser:
         MsgBox "MS Access is unable to initiate a DDE _
              channel with the document DDEMERGE.DOC"
         Resume Next
      End Function

      Function Send_Record ()

         On Error GoTo CatchBlanks

         DDEPoke Mergechan, "CompanyName",_
            Forms![Customers]![Company Name]
         DDEPoke Mergechan, "ContactName", _
            Forms![Customers]![Contact Name]
         DDEPoke Mergechan, "Address", _
            Forms![Customers]![Address]
         DDEPoke Mergechan, "City", _
            Forms![Customers]![City]
         DDEPoke Mergechan, "Region", _
            Forms![Customers]![Region]
         DDEPoke Mergechan, "PostalCode", _
            Forms![Customers]![Postal Code]

         DDEExecute Mergechan, "[FilePrint]"

         Exit Function

      CatchBlanks:
         If MsgBox("Error sending one field, it may be blank._
               Would you like to continue?", 52) = ID_YES Then
           Resume Next
         Else
           Exit Function
         End If
      End Function

      Function Terminate_MergeChan ()

         DDETerminate MergeChan

      End Function

</PRE><P><LI>From the Run menu, choose Compile All.

<P><LI>Save the module as Print Merge, and then close it.
<P>
</OL><h3>Step Three: Create the Form</h3>
 

<OL><P><LI>Open the Customers form in Design view.

<P><LI>Set the form's OnOpen property to:
<P>
<P><PRE>      =Initiate_Word()
</PRE>
<P><LI>Add a command button with the following properties to the form:
<P>
<P><PRE>      Caption: Print Letter
      OnPush: =Send_Record()
</PRE>
<P><LI>Set the form's OnClose property to:
<P>
<P><PRE>      =Terminate_MergeChan()
</PRE>
<P><LI>Save the form, and then view it in Form view.

<P><LI>Choose the Print Letter button on the form. The current customer record
   will be sent to Word for Windows, merged into the DDEMERGE.DOC document,
   and printed.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Introduction to Programming," versions 1.0 and 1.1,
Chapter 9, "Dynamic Data Exchange"
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: merge printmerge browse<BR>
Keywords            : IntpDde kbinterop<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
