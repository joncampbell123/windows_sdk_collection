

<HTML>
<HEAD>
<TITLE>ACC2: "Type Conversion Failure" with Update or Append Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125259">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1995/01/23">
<META NAME="Keywords" CONTENT="kbusage QryUpdat">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run an append or update query, you receive a  type conversion failure  error message when a query parameter is not explicitly declared. For example, an update query fail...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAXB,QA1S,QAC1,QBD2,QACF,QDN9,QAB4,QBWS,QAP2,QAKP,QAPF,QBXS,QBT6,QAA5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: "Type Conversion Failure" with Update or Append Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125259</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run an append or update query, you receive a "type conversion
failure" error message when a query parameter is not explicitly declared.
For example, an update query fails if its Update To parameter is a
reference to a form control.
<P>
<P><h2>CAUSE</h2>
 
<P>
The query parameter is implicitly declared and, as a result, is
automatically treated as text. The conversion fails, resulting in the
error message. Note that the error message occurs only if you are using the
Microsoft Jet database engine version 2.5, which is installed when you
install the Microsoft Access version 2.0 Service Pack.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this problem, either wrap the parameter with a conversion
function such as CVDate(), CLng(), or CCur(), or explicitly declare the
parameter's data type in the Parameters dialog box. (To use the Parameters
dialog box, choose Parameters from the Query menu.)
<P>
If you want to automate the process of explicitly defining parameter data
types, you can install a utility application called Params.exe. For
information on how to obtain Params.exe, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q149357.htm">Q149357</A></B>
   TITLE     : ACC2: Parameter Typing Utility Available on MSL

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
2.0. This problem no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you use a parameter in a query without defining the parameter's data
type in the Parameters dialog box, the parameter is implicitly declared.
Parameters whose data type is declared in the Parameters dialog box are
explicitly declared. Parameters that return values from a conversion
function are also considered to be explicitly declared.
<P>
This problem affects some of the append and update queries in the Microsoft
Access Solutions Pack Asset Tracker application. For example, no reports
are listed in the Select Reports form, and no assets are listed in the
Reassign Assets form. The queries that fill the temporary tables on which
these forms are based are failing.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
The following example uses a default date value in a text box on a form as
a parameter for an update query:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create the following new query based on the Employees table:
<P>
<P><PRE>      Query: Updater
      --------------------------------
      Type: update query
      Field: Birth Date
<PRE></PRE>         Table: Employees
         Update To: Forms!Test1!Field0

</PRE><P><LI>Create a blank new form called Test1 and add the following controls
   to the form:
<P>
<P><PRE>      Text Box
      ------------------------
<PRE></PRE>         Name: Field0
         Format: Short Date
         Default Value: ="1/1/95"

      Command Button
      -----------------------------
         Name: Button0
         Caption: Run Updater Query

</PRE><P><LI>Set the command button's OnClick property to the following event
   procedure:
<P>
<PRE>      Sub Button0_Click ()
         DoCmd OpenQuery "Updater"
      End Sub

</PRE><P><LI>View the form in Form view and choose the command button. When you
   are prompted "Update query will modify data. Continue anyway?" choose
   OK.

<P><LI>When you are prompted "15 row(s) will be updated" choose OK.

<P><LI>When you are prompted
<P>
<P><PRE>      Errors were encountered: 15 fields were not updated due to type
      conversion failure, 0 record(s) were not updated due to key
      violations, and 0 record(s) were not updated due to lock
      violations. Continue anyway?
</PRE><P>
   Choose Cancel.
<P>
</OL><h3>Steps to Correct the Problem Using an Explicit Parameter</h3>
 
<P>
The following examples show how to correct the problem demonstrated by the
example in the "Steps to Reproduce Problem" section above.
<P>
CAUTION: Following the steps in these examples will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.
<P>
<P><h3>Method 1</h3>
 

<OL><P><LI>Open the Updater query in Design view. From the Query menu, choose
   Parameters.

<P><LI>In the Parameters dialog box, add the following entry:
<P>
<P><PRE>      Parameter: Forms!Test1!Field0
      Data Type: Date
</PRE>
<P><LI>Close the Parameters dialog box.

<P><LI>Save the query and then run it. The query should run correctly.
<P>
</OL><h3>Method 2</h3>
 

<OL><P><LI>Open the Updater query in Design view.

<P><LI>Change the query's Update To expression to be:
<P>
<P><PRE>      CVDate(Forms!Test1!Field0)
</PRE>
<P><LI>Save the query and then run it. The query should run correctly.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about parameters, search for "parameter query,"
and then "Creating a Parameter Query" using the Microsoft Access Help
menu.
<P>
For information about the Microsoft Access version 2.0 Service Pack,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q122927.htm">Q122927</A></B>
   TITLE     : WX1124: Microsoft Access Version 2.0 Service Pack
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: forms queries jet25 jet 2.5<BR>
Keywords            : kbusage QryUpdat<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
