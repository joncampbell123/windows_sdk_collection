

<HTML>
<HEAD>
<TITLE>ACC2: No Permission for Utility.mda When Starting MS Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174025">
<META NAME="KBModify" CONTENT="1997/09/18">
<META NAME="KBCreate" CONTENT="1997/09/17">
<META NAME="Keywords" CONTENT="ScrtOthr ScrtUsr kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you start Microsoft Access version 2.0, you may receive the following error message:     No permission for '      \UTILITY.MDA'  This article assumes that you are familiar w...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAGU,QAIJ,QAB4,QABO,QAGR,QBWS,QA5F,QAMA,QAH4,QAEF,QBXS,QBIC,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: No Permission for Utility.mda When Starting MS Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174025</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you start Microsoft Access version 2.0, you may receive the following
error message:
<P>
<PRE>   No permission for '&lt;path&gt;\UTILITY.MDA'

</PRE>This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
You have run an Access Basic procedure that removed the Admin user from
both the Admins and Users group. Note that if you try to do this through
the user interface instead of through code, you receive the following error
message:
<P>
<PRE>   Can't remove user from group 'Users.'

</PRE><h2>RESOLUTION</h2>
 
<P>
Quit Microsoft Access. In Windows Explorer or Windows File Manager, copy
the current System.mda file into System.old. Then run Wrkgadm.exe and
create a new System.mda file. You should now be able to start Microsoft
Access.
<P>
To prevent this problem from occurring, follow these steps:

<OL><P><LI>Start Microsoft Access and open any database.

<P><LI>On the Security menu, click Change Password. Assign a password to the
   Admin user account. The following procedure assumes that you have
   changed the Admin user's password to "password" (without the quotation
   marks).

<P><LI>Create a new module and type the following procedure:
<P>
<PRE>      Sub sectest ()

         Dim ws As WorkSpace
         Dim usr As User
         Dim grp As Group
         On Error GoTo Errorhandler
         Set ws = dbengine.CreateWorkspace("", "admin", "password")
         ' Create user NewAdmin and add to Admins group.
         Set usr = ws.CreateUser("NewAdmin", "xxx555", "identify")
         ws.users.Append usr
         usr.groups.Append ws.CreateGroup("admins")

         ' Remove Admin from Admins, Users group.
         ws.groups("users").users.Delete "admin"
         ws.groups("admins").users.Delete "admin"

         ' Log on again and add NewAdmin to Users group.
         ws.Close
         Set ws = dbengine.CreateWorkspace("", "NewAdmin", "identify")
         Set usr = ws.users("NewAdmin")
         usr.groups.Append ws.CreateGroup("users")

      Exit_sectest:
         Exit sub

      Errorhandler:
         Msgbox CStr(Err) &amp; " " &amp; Error(Err)
         Resume Exit_sectest

      End Sub

</PRE><P><LI>Run this procedure and quit Microsoft Access.

<P><LI>Restart Microsoft Access; enter "NewAdmin" as the log on name and
   "identify" as the log on password.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Windows Explorer or Windows File Manager, copy the current System.mda
   file into System.bak.

<P><LI>Start Microsoft Access and open a new database.

<P><LI>Open a new module and type the following code:
<P>
<PRE>      Sub sectest ()
         Dim ws As WorkSpace
         Dim usr As User
         Dim grp As Group
         On Error GoTo Errorhandler
         ' Create user NewAdmin and add to Admins group.
         Set ws = dbengine.CreateWorkspace("", "admin", "")
         Set usr = ws.CreateUser("NewAdmin", "xxx555", "identify")
         ws.users.Append usr
         usr.groups.Append ws.CreateGroup("admins")

         ' Remove Admin from Admins, Users group.
         ws.groups("users").users.Delete "admin"
         ws.groups("admins").users.Delete "admin"
         ws.Close

         Exit_sectest:
            Exit sub

         Errorhandler:
            Msgbox CStr(Err) &amp; " " &amp; Error(Err)
            Resume Exit_sectest
      End Sub

</PRE><P><LI>Close the database and quit Microsoft Access.
<P>
</OL>Note that when you attempt to restart Microsoft Access, you receive the
error described in the "Symptoms" section.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information, see Microsoft Access "Building Applications," version
2.0, Chapter 14, "Securing Your Applications," pages 340-344.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: can't cannot start<BR>
Keywords          : ScrtOthr ScrtUsr kberrmsg<BR>
Version           : WINDOWS:2.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
