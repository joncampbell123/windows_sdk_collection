

<HTML>
<HEAD>
<TITLE>ACC97: How to Disable or Enable Items on a Custom Command Bar </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177361">
<META NAME="KBModify" CONTENT="1997/12/16">
<META NAME="KBCreate" CONTENT="1997/11/25">
<META NAME="Keywords" CONTENT="UifCmdbar">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  This article describes methods that you can use to programmatically enable or disable all menu items or specific menu items on a custom command bar.  This article assumes t...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAVI,QBXS,QBV8,QAB9,QA4P,QAH4,QA1S,QAPF,QBJZ,QDN9,QAZV,QAY5,QAPN,QBWS,QDKX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: How to Disable or Enable Items on a Custom Command Bar</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177361</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
This article describes methods that you can use to programmatically enable
or disable all menu items or specific menu items on a custom command bar.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The examples in this article are based on the "NorthwindCustomMenuBar"
command bar found in the sample database Northwind.mdb. The examples
manipulate the CommandBar object, which is part of the Microsoft Office 8.0
Object Library. Therefore, the Microsoft Office 8.0 Object Library must be
available on your computer; you must also set a reference to this library
in the database in which you want to enable or disable menu items on your
custom command bars.
<P>
To set a reference to the Microsoft Office 8.0 Object Library, follow these
steps:

<OL><P><LI>Open your database in Microsoft Access.

<P><LI>In the Database window, click the Modules tab.

<P><LI>Select any module and click Design, or click New if no modules appear on
   the Modules tab in the Database window.

<P><LI>On the Tools menu, click References.

<P><LI>Locate the Microsoft Office 8.0 Object Library check box and click to
   select it; then click OK.

<P><LI>On the File menu, click Close. It is not necessary to save the module.
<P>
</OL><h3>Disabling All Menu Items on a Custom Command Bar Example</h3>
 
<P>
The following example disables all menu items on a custom command bar:

<OL><P><LI>Open your database in Microsoft Access.

<P><LI>In the Database Window, click the Modules tab, and then click New.

<P><LI>Type or paste the following code into the module:
<P>
<P><PRE>      Public Function AllowMenus(CmdBarName As String, CmdbarEnabled As _
<PRE></PRE>         Boolean)

         '============================================================='
         'This function has two arguments: CmdbarName is a string that '
         'passes the name of the command bar that the code enables or  '
         'disables. CmdBarEnabled is a Boolean value in which you pass '
         '"True" or "False" in order to enable or disable the command  '
         'bar being modified.                                          '
         '                                                             '
         'Example: To disable the command bar "NorthwindCustomMenuBar" '
         'in the Northwind sample database, use the following:         '
         '                                                             '
         'AllowMenus("NorthwindCustomMenuBar",False)                   '
         '============================================================='

         Dim Cmdbar As CommandBar, Cbct As CommandBarControl

         On Error GoTo Err_AllowMenus
         Set Cmdbar = CommandBars(CmdBarName)

         If Cmdbar.Visible = False Then Cmdbar.Visible = True

            For Each Cbct In Cmdbar.Controls
               Cbct.Enabled = CmdbarEnabled
            Next Cbct

         Exit_AllowMenus:
            Exit Function

         Err_AllowMenus:
         MsgBox "Error " &amp; CStr(Err) &amp; " " &amp; Err.Description &amp; _
            " has occurred in the AllowMenus Function", vbOKOnly, _
            "Error Detected"
         Resume Exit_AllowMenus

      End Function

</PRE><P><LI>Save the module.

<P><LI>Press CTRL+G to open the Debug window and test the function. For
   example, if you are using the Northwind sample database, type the
   following line, and then press ENTER:
<P>
<P><PRE>      ?AllowMenus("NorthwindCustomMenuBar", False)
</PRE><P>
</OL><h3>Enabling or Disabling Specific Menu Items on a Command Bar Example</h3>
 
<P>
The following sample function allows you to programmatically enable or
disable a specific menu item on a command bar, rather than the entire
command bar itself.

<OL><P><LI>Open your database in Microsoft Access.

<P><LI>In the Database window, click the Modules tab, and then click New.

<P><LI>Type or paste the following code into the module:
<P>
<P><PRE>      Public Function CommandbarEnable(Cmdbar As CommandBar, _
<PRE></PRE>         CmdbarEnabled As Boolean, TopLevel As Integer, _
         Optional Sublevel As Integer)

        '================================================================='
        'This function has four arguments:                                '
        '                                                                 '
        'Cmdbar is a CommmandBar object that represents the command       '
        'bar containing the menu item to be enabled or disabled.          '
        '                                                                 '
        'CmdBarEnabled is a Boolean value in which you pass "True"        '
        'or "False" in order to enable or disable the menu item being     '
        'manipulated.                                                     '
        '                                                                 '
        'TopLevel is an integer representing the index of the Top-level   '
        'menu item being manipulated.                                     '
        '                                                                 '
        'Sublevel is an optional integer representing the index of the    '
        'menu item being manipulated under the Top-level menu item.       '
        '                                                                 '
        'Example: To disable only the "File" menu item on the             '
        '"NorthwindCustomMenuBar" command bar, use the following:         '
        '                                                                 '
        'CommandbarEnable(Commandbars("NorthwindCustomMenuBar"),False,1)  '
        '                                                                 '
        'Example2: To disable the "Get external Data" Menu item under     '
        'the "File" menu item on the "NorthwindCustomMenuBar" command     '
        'bar, use the following:                                          '
        '                                                                 '
        'CommandbarEnable(Commandbars("NorthwindCustomMenuBar"),False,1,3)'
        '                                                                 '
        'To "re-enable" the same menu item, use the following:            '
        '                                                                 '
        'CommandbarEnable(Commandbars("NorthwindCustomMenuBar"),True,1,3) '
        '================================================================='

         Dim SubCommandbar

         On Error GoTo Err_CommandBarEnable

         'If the commmand bar is not visible, make it so.
         If Cmdbar.Visible = False Then Cmdbar.Visible = True

         'If no menu item on a submenu is selected for enabling\disabling,
         'enable\disable the top level menu choice only.
            If IsMissing(Sublevel) Or Sublevel = 0 Then
               Cmdbar.Controls(TopLevel).Enabled = CmdbarEnabled
               'If a menu item on a submenu is selected for
               'enabling\disabling, do so now.
            Else
               Set SubCommandbar = Cmdbar.Controls(TopLevel)
               SubCommandbar.Controls(Sublevel).Enabled = CmdbarEnabled
            End If

      Exit_CommandBarEnable:
            Exit Function

      Err_CommandBarEnable:
         MsgBox "Error " &amp; CStr(Err) &amp; " " &amp; Err.Description &amp; _
            " has occurred in the CommandBarEnable Function", vbOKOnly, _
            "Error Detected"
         Resume Exit_CommandBarEnable

      End Function

</PRE><P><LI>Save the module.

<P><LI>Press CTRL+G to open the Debug window and test the function. For
   example, if you are using the Northwind sample database, type the
   following line, and then press ENTER:
<P>
<P><PRE>      ?CommandbarEnable(Commandbars("NorthwindCustomMenuBar"),False,1,3)
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the CommandBar object, search the Help Index for
"CommandBar Object."
<P>
For more information about creating custom command bars, ask the Microsoft
Access 97 Office Assistant for help on how to "Create a custom toolbar for
the current database," or use the Command Bar Wizard.
<P>
For more information about obtaining the Command Bar Wizard, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q172300.htm">Q172300</A></B>
   TITLE     : ACC97: Command Bar Wizard Available on MSL
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: enabling disabling inf toolbar toolbars commandbar<BR>
Keywords          : UifCmdbar<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
