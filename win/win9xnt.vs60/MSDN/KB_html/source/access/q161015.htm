

<HTML>
<HEAD>
<TITLE>ACC97: ODBC Error Using IDC Files to Query SQL Server Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161015">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1996/12/13">
<META NAME="Keywords" CONTENT="GnlOthr kberrmsg kbusage OdbcSqlms">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use IDC files to query a table in a Microsoft Access 2.0, 7.0, or 97 database that is linked to Microsoft SQL Server, you may receive the following error message if...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA1S,QDKY,QAWK,QAUR,QBQU,QAE2,QAZV,QDN9,QAB4,QAU7,QBWS,QA9E,QAL2,QAI5 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: ODBC Error Using IDC Files to Query SQL Server Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161015</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use IDC files to query a table in a Microsoft Access 2.0, 7.0, or
97 database that is linked to Microsoft SQL Server, you may receive the
following error message if the SQL Server password is not saved with the
linked table when you create it:
<P>
<PRE>   ODBC -- connection to '&lt;Server Name&gt;' failed.

</PRE>This happens even if you specify a username and password in the IDC file.
<P>
<P><h2>CAUSE</h2>
 
<P>
The IDC file uses a System DSN to communicate with the Microsoft Access
database that contains the linked tables. The username and password in the
IDC file are used to log on to the Microsoft Access database. The Microsoft
Access database cannot use the same username and password to log on to
Microsoft SQL Server.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two methods to work around this behavior.
<P>
<P><h3>Method 1</h3>
 
<P>
Create a System DSN to query the Microsoft SQL Server database directly
instead of using the Microsoft Access database with linked tables. Rewrite
your IDC file so it uses the new System DSN. Then the username and
password in your IDC file are used to log on to SQL Server.
<P>
<P><h3>Method 2</h3>
 
<P>
Save the password with the linked table when you create it in the Microsoft
Access database.
<P>
The following example shows you how to save a password with a linked SQL
Server table. This example assumes that you have a valid System DSN on
your computer that points to the sample Pubs database on a Microsoft SQL
Server.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.

<P><LI>On the File menu, point to Get External Data, and then click Link
   Tables.

<P><LI>In the Link dialog box, select ODBC Databases() in the Files Of type
   box.

<P><LI>In the Data Source dialog box that appears, select the System DSN that
   points to the Pubs database on your SQL Server, and then click OK.

<P><LI>In the SQL Server Login dialog box, type a valid Login ID and Password,
   and then click OK.

<P><LI>In the Link Tables dialog box, click dbo.authors, click to select the
   Save password check box, and then click OK.

<P><LI>The linked table appears in the Northwind table list, and the SQL
   Server username and password is saved with it.
<P>
   Now you can query the linked table with an IDC file.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Use the work around described in Method 1 of the "Resolution" section when
the error message occurs under the following circumstances:

<UL><LI>If your IDC file queries a linked SQL Server table in a Microsoft
   Access 2.0 database, even if you save the password with the linked
   table.

<LI>If your IDC file queries a linked SQL Server table in a remote
   Microsoft Access database on a Microsoft Windows 95 computer (a
   different computer than the web server), even if you save the
   password with the linked table.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information about linking tables to ODBC data sources, search the
Help Index for "ODBC, importing and linking data," or ask the Microsoft
Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: internet intranet IIS<BR>
Keywords            : GnlOthr kberrmsg kbusage OdbcSqlms<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
