

<HTML>
<HEAD>
<TITLE>ACC95: Domain Aggregate Functions Return #Error When Interrupted </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148302">
<META NAME="KBModify" CONTENT="1997/05/21">
<META NAME="KBCreate" CONTENT="1996/03/08">
<META NAME="Keywords" CONTENT="kberrmsg kbusage SynFnc">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use Microsoft Access domain aggregate (totals) functions on a form, the functions may return the  #Error  message. Domain aggregate functions, such as DSum() and DCount(...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QAB9,QAY5,QA9A,QA7O,QAPN,QAOE,QAMN,QAB5,QBW3,QBV8,QAUD,QA1S V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Domain Aggregate Functions Return #Error When Interrupted</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148302</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use Microsoft Access domain aggregate (totals) functions on a
form, the functions may return the "#Error" message. Domain aggregate
functions, such as DSum() and DCount(), evaluate an entire column or set
of data (a domain).
<P>
<P><h2>CAUSE</h2>
 
<P>
This error occurs when focus is moved from the form's active control to any
other control before the domain aggregate function has finished
calculating. This behavior occurs with all domain aggregate functions.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use one of the two following methods to work around this problem.
<P>
<P><h3>Method 1</h3>
 

<OL><P><LI>Open the form containing the domain aggregate function in Design view
   and set the form's OnCurrent property to the following event procedure
<P>
<PRE>      Sub Form_Current()
      Me!&lt;text box control name&gt; = &lt;expression&gt;
      End Sub

   where &lt;text box control name&gt; refers to the name of the text box control
   on the form where you want to display the result of the expression and
   &lt;expression&gt; refers to the domain aggregate function expression used to
   complete your calculation.

</PRE><P><LI>Select the text box control containing the domain aggregate function.

<P><LI>Delete the formula currently in the ControlSource property.
<P>
</OL><h3>Method 2</h3>
 

<OL><P><LI>Create the following new macro
<P>
<PRE>      Macro Name       Macro Action
      -----------------------------
      DFunctionMacro   SetValue

      DFunctionMacro Actions
      -------------------------------
      SetValue
         Item: &lt;text box control name&gt;
         Expression: &lt;expression&gt;

      where &lt;text box control name&gt; refers to the name of the text box
      control on the form where you want to display the result of the
      expression and &lt;expression&gt; refers to the domain aggregate function
      expression used to complete your calculation.

</PRE><P><LI>Select the text box control containing the domain aggregate function.

<P><LI>Delete the formula currently in the ControlSource property.

<P><LI>Set the form's OnCurrent property to the DFunctionMacro macro.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0.
This problem no longer occurs in Microsoft Access 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file or
perform these steps on a copy of the Northwind database.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open Orders form in Design view.

<P><LI>Add the following unbound text box to the form:
<P>
   NOTE: In the following example, an underscore (_) at the end of a line
   is used as a line-continuation character. Remove the underscore from the
   end of the line when re-creating the ControlSource property.
<P>
<P><PRE>     Text box: MyDomain
     -------------------------------------------------------------
     ControlSource: (Choose one of the following Domain Aggregate
     functions)
</PRE><P>
<P><PRE>     =DSUM("UnitPrice","Order Details Extended")*DSUM("ProductID","Order _
<PRE></PRE>         Details  Extended")

     =DCOUNT("UnitPrice","Order Details Extended")*DCOUNT("ProductID", _
         "Order Details Extended")

</PRE><P><LI>Switch the Orders form to Form view to ensure that the formula returns a
   value.

<P><LI>Switch the Orders form back to Design view.

<P><LI>Switch the Orders form back to Form view, and using the mouse, quickly
   place the pointer in the Salesperson combo box. This must be done while
   the domain aggregate function is calculating.
<P>
   NOTE: In most cases #Error is returned in the text box when the
   calculation is interrupted and fails. Whether or not the #Error occurs
   depends on how quickly the focus is moved from the active control.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about domain aggregate functions, search the Help
Index for "domain aggregate functions."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dlookup davg dmax dmin dvar dstdev<BR>
Keywords            : kberrmsg kbusage SynFnc<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
