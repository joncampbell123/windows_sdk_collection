

<HTML>
<HEAD>
<TITLE>ACC: Exporting Tables to SQL Server Changes AutoNumber to Long </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161862">
<META NAME="KBModify" CONTENT="1997/07/16">
<META NAME="KBCreate" CONTENT="1997/01/07">
<META NAME="Keywords" CONTENT="kbinterop OdbcSqlms">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you export a Microsoft Access table to Microsoft SQL Server, any AutoNumber fields in the table become Long Integer fields in the SQL Server table.  RESOLUTION  The fol...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QA1S,QBWS,QAZV,QBC6,QA3P,QBTI,QA01,QDN9,QARR,QAYY,QAUR,QAKC,QAK6,QBJZ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Exporting Tables to SQL Server Changes AutoNumber to Long</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161862</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you export a Microsoft Access table to Microsoft SQL Server, any
AutoNumber fields in the table become Long Integer fields in the SQL
Server table.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following steps assume that your are familiar with creating tables in
a Microsoft SQL Server database:

<OL><P><LI>Create a table in Microsoft SQL Server to store the data from your
   Microsoft Access table. Use equivalent or compatible data types for the
   columns in the new SQL Server table and use an Identity column to store
   the AutoNumber field from the Microsoft Access table.

<P><LI>Link the new SQL Server table to your Microsoft Access database.

<P><LI>Create an Append query based on your Microsoft Access table that appends
   the data to the linked SQL Server table. Save the query, but do not
   run it.

<P><LI>Create an SQL pass-through query that sets Identity_Insert ON for the
   SQL Server table. This allows you to update the Identity column with
   data from your Microsoft Access table.
<P>
   NOTE: You must log on to SQL Server as the database owner (dbo) or the
   owner of the table in order to set Identity_Insert.
<P>
   A sample SQL statement to set Identity_Insert ON for the Jobs table in
   the Pubs sample database in Microsoft SQL Server is:
<P>
<P><PRE>      Set Identity_Insert dbo.Jobs ON
</PRE>
<P><LI>Run the SQL pass-through query, and then close it. You do not need
   to save the query.

<P><LI>Run the Append query to add data to the SQL Server table.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
The following steps assume that you have an ODBC data source that connects
to a Microsoft SQL Server database.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Select the Products table in the Database window. The Products table
    contains a ProductID field that is of data type AutoNumber.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an External File or Database," and
    then click OK.

<P><LI>In the "Save Table Products In" dialog box, select ODBC Databases in
    the Save as type box.

<P><LI>In the Export dialog box, type Products.
<P>
    NOTE: If your SQL Server database already contains a table named
    Products, the export will fail; if that happens, use a different
    table name.

<P><LI>In the Select Data Source dialog box (or SQL Data Sources dialog box in
    version 7.0), select the data source to connect to your SQL Server
    database, and then click OK. The table is exported to Microsoft SQL
    Server.

<P><LI>On the File menu, point to Get External Data, and then click Link
    Tables.

<P><LI>In the Link dialog box, click ODBC Databases in the Files Of Type box.

<P><LI>In the Select Data Source dialog box (or SQL Data Sources dialog box in
    version 7.0), click the data source to connect to your SQL Server
    database, and then click OK.

<P><LI>In the Link Tables dialog box, click the Products table, and then click
    OK.

<P><LI>In the Select Unique Record Identifier dialog box, click ProductID, and
    then click OK.

<P><LI>Open the linked Products table in Design view; click Yes to the prompt
    that you cannot modify all properties of a linked table. Note that the
    ProductID data type is Number, and its FieldSize is Long Integer.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about interaction between Microsoft Access and
Microsoft SQL Server, search the Help Index for "SQL Server."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: attach upsize<BR>
Keywords            : kbinterop OdbcSqlms<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
