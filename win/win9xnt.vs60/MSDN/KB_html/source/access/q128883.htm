

<HTML>
<HEAD>
<TITLE>ACC2: How to Get "X of Y" from Record Navigation Buttons </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128883">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1995/04/12">
<META NAME="Keywords" CONTENT="FmsHowto kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how to create and use a sample user-defined Access Basic function called GetXofY(). You can use this function to retrieve the record position number (X)...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QAKC,QBT6,QBV4,QDN9,QBE7,QBE6,QBC6,QAY5,QAWH,QACI,QDMH,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: How to Get "X of Y" from Record Navigation Buttons</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128883</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how to create and use a sample user-defined
Access Basic function called GetXofY(). You can use this function to
retrieve the record position number (X) and the total number of records (Y)
that are displayed in the navigation buttons at the bottom of a form.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
NOTE: This technique uses the undocumented recordset property
AbsolutePosition which is subject to change in future versions of
Microsoft Access. Use of this function is not supported by Microsoft.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The record position number (X) in the navigation buttons does not indicate
the actual record number. Rather, it indicates the record's position in the
current record set relative to the total number of records (Y). For
example, the fifth record in a table may not have record position number 5
if the records are sorted or filtered in a different order in the form.
<P>
You can use the GetXofY() function to return a string that contains the
current record position number (X) and the total number of records (Y).
<P>
<P><h3>How to Create the GetXofY() Function in a Form</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new module and then enter the following statement in the
   Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Create the following procedure:
<P>
<P><PRE>      Function GetXofY (F As Form)
</PRE><P>
<P><PRE>      '*******************************************************************
      ' FUNCTION: GetXofY()
      '
      ' PURPOSE:
<PRE></PRE>      '   Gets "X of Y" from the record navigation buttons on a form
      '   where X represents the position of the record in the recordset
      '   relative to Y, the total number of records.
      '
      ' INPUT:
      '   F - The form object whose "X of Y" you want to retrieve.
      '
      ' USES:
      '   In the header or footer section of a form, you can create a text
      '   box and set its ControlSource property to the following
      '   expression:
      '
      '      =GetXofY([Forms]![Form Name])
      '
      ' NOTE:
      '   If the form is a continuous form, you must recalculate the form
      '   in the Current event for the expression to update as you move
      '   from record to record. For example
      '
      '      Sub Form_Current()
      '         Me.Recalc
      '      End Sub
      '

      '*******************************************************************
         Dim RS As Recordset
         On Error Resume Next
         Set RS = F.RecordSetClone
         RS.MoveLast
         RS.BookMark = F.BookMark
         If (Err &lt;&gt; 0) Then
            GetXofY = RS.RecordCount + 1 &amp; " of " &amp; RS.RecordCount + 1
         Else
            GetXofY = RS.AbsolutePosition + 1 &amp; " of " &amp; RS.RecordCount
         End If
      End Function

</PRE></OL><h3>How to Use the GetXofY() Function in a Form</h3>
 
<P>
The following example demonstrates how to display "X of Y" in the Orders
form for the Orders form and the Order Details subform:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Orders form in Design view, and add a text box to the detail
   section with the following property settings:
<P>
<P><PRE>      ControlSource: =GetXofY([Forms]![Form Name])
      Left: 0.9 in
      Top: 2.75 in
</PRE>
<P><LI>Add a second text box to the detail section with the following property
   settings:
<P>
<P><PRE>      ControlSource: =GetXofY([Orders Subform].Form)
      Left: 0.85 in
      Top: 3.5 in
</PRE>
<P><LI> View the Orders form in Form view and navigate among order and order
<P><PRE>    detail records.
 </BLOCKQUOTE>


	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsHowto kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
