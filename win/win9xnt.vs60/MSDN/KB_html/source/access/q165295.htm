

<HTML>
<HEAD>
<TITLE>ACC97: Can't Create Valid Links in Hyperlink Field on ASP Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165295">
<META NAME="KBModify" CONTENT="1997/06/12">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="IntAsp IntLink kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  When you use Microsoft Access 97 to create an Active Server Pages (ASP) form, and you use that form to add or modify data in a Hyperlink field, the record in the table does...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE2,QA1S,QA5V,QDN9,QBWA,QDNQ,QBWS,QA7O,QA7N,QAVZ,QBVX,QBTI,QAYY,QACO,QDMF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Can't Create Valid Links in Hyperlink Field on ASP Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165295</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
When you use Microsoft Access 97 to create an Active Server Pages (ASP)
form, and you use that form to add or modify data in a Hyperlink field, the
record in the table does not contain a valid hyperlink.
<P>
<P><h2>CAUSE</h2>
 
<P>
ASP forms do not contain the built-in functionality to add Hyperlink
fields.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can edit the Hyperlink field in the Microsoft Access table to provide
the missing information, or you can enter the Hyperlink field on the ASP
form in a way that Microsoft Access understands and translates to hyperlink
data.
<P>
NOTE: Both of the following methods create a valid hyperlink in the
Microsoft Access table, but not on the ASP form itself. You cannot follow
hyperlinks displayed in a text box on an ASP form.
<P>
<P><h3>Editing the Record in the Table</h3>
 

<OL><P><LI>After you add a new record using the ASP form, start Microsoft Access
   and open the database in which the table resides.

<P><LI>Locate the newly added record.

<P><LI>Using the right mouse button (right-click), click the Hyperlink field in
   the record.

<P><LI>On the shortcut menu that appears, point to Hyperlink, and then click
   Edit Hyperlink.

<P><LI>In the Insert Hyperlink dialog box, fill in the missing information in
   the "Link to file or URL" box and the "Named location in file" box.
   Click OK.
<P>
</OL><h3>Entering the Record as a Hyperlink on the ASP Form</h3>
 
<P>
When you add or modify a record using the ASP form, you can type the
hyperlink information in a way that enables Microsoft Access to create a
valid Hyperlink field in the table.
<P>
All Hyperlink fields consist of three separate parts, separated by number
signs: DisplayText, Address, and Subaddress. The DisplayText is what you
see in the table or on the form; the address and subaddress information
tells Microsoft Access what you want to view when you click the hyperlink.
For example, the following hyperlink uses all three parts of the hyperlink
field:
<P>
<PRE>   1997 Sales Figures#C:\My Documents\Sales.ppt#24

</PRE></OL>In this example, 1997 Sales Figures is what a user sees in the hyperlink
field, C:\My Documents\Sales.ppt is the name of the Microsoft PowerPoint
slide that opens when you click the link, and 24 is the slide number that
is displayed.
<P>
The next examples use only two of the three parts in the Hyperlink field:
<P>
<PRE>   Microsoft Home Page#<B><A href="http://www.microsoft.com#">http://www.microsoft.com#</A></B>
   Quarterly Orders Form##Form Quarterly Orders

</PRE>The first hyperlink displays the text "Microsoft Home Page" and opens
<B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B> when you click the link. The second hyperlink
displays the text "Quarterly Orders Form" and opens the Quarterly Orders
form in the current database when you click it.
<P>
Finally, this example uses only one of the parts of the Hyperlink field:
<P>
<PRE>   #<B><A href="http://www.microsoft.com/accessdev#">http://www.microsoft.com/accessdev#</A></B>

</PRE>In this case, Microsoft Access displays <B><A href="http://www.microsoft.com/accessdev">http://www.microsoft.com/accessdev</A></B>
by default because there is no specific display text, and it also opens
<B><A href="http://www.microsoft.com/accessdev">http://www.microsoft.com/accessdev</A></B> when you click it.
<P>
If you enter hyperlink data in your ASP form using the correct syntax for
DisplayText, Address, and Subaddress, then Microsoft Access stores the data
as a valid hyperlink.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Select the Suppliers table in the Database window.

<P><LI>On the File menu, click Save As/Export.

<P><LI>In the Save As dialog box, click "To an External File or Database," and
    then click OK.

<P><LI>In the "Save Form 'Suppliers' In" dialog box, select Microsoft Active
    Server Pages (*.asp) in the Save As Type box, and save the
    Suppliers.asp file in a folder on your Web server where you have
    Execute permission. Click Export.

<P><LI>In the Microsoft Active Server Pages Output Options dialog box, type a
    valid System DSN on your Web server in the Data Source Name box, and
    type the uniform resource locator (URL) on your server where the ASP
    file will be located in the Server URL box. Click OK.

<P><LI>Start Microsoft Internet Explorer 3.0, or another Web browser program.

<P><LI>Type the URL in the address box of your Web browser to view
    Suppliers.asp, for example <B>http://MyServer/Aspsamp/Suppliers.asp.</B> Note
    that the URL depends upon where your files are located on the Web
    server computer.

<P><LI>The Suppliers form opens in your Web browser and displays the first
    record in the Suppliers table.

<P><LI>Click in the Home Page field of the first record and enter the
    following data:
<P>
      <B><A href="http://www.microsoft.com">http://www.microsoft.com</A></B>

<P><LI>Click the Commit button at the bottom of the form to save the record.

<P><LI>In Microsoft Access, open the Suppliers table in Datasheet view.

<P><LI>Locate the Supplier record you just changed (probably Exotic Liquids)
    and click in the Home Page Hyperlink field. Note that nothing happens.
<P>
    If you repeat steps 7-13, but you enter the following data in step 10,
    the hyperlink will work properly in Microsoft Access:
<P>
       Microsoft Home Page#<B><A href="http://www.microsoft.com#">http://www.microsoft.com#</A></B>
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the parts of a Hyperlink field, search the Help
Index for "hyperlinks, returning hyperlink information."
<P>
For more information about exporting ASP files, search the help Index for
"ASP files," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about creating and using System DSNs, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q159682.htm">Q159682</A></B>
   TITLE     : "Data Source Name Not Found" Err Msg Opening Web Page

</PRE></OL>For more information about the permission you need on your Web server
computer to view ASP files, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q162975.htm">Q162975</A></B>
   TITLE     : ACC97: Permissions Necessary to View HTML, IDC, and ASP
               Files
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: follow open data entry<BR>
Keywords            : IntAsp IntLink kbinterop<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
