

<HTML>
<HEAD>
<TITLE>ACC1x: How to Use DDE to Pass Information to MS Access 1.x </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q100167">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1993/06/16">
<META NAME="Keywords" CONTENT="IntpDde kbinterop PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  You cannot poke data into a table through a dynamic data exchange (DDE) channel in Microsoft Access. However, you can use a function with parameters in a DDE channel to the SQL topic to pass information to an Access Basic function. The data can the...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAMA,QA5F,QAH6,QAH7,QAD7,QAY5,QAH4,QA5V,QAPF,QBV8,QBVP,QAZ2,QAY2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Use DDE to Pass Information to MS Access 1.x</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q100167</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You cannot poke data into a table through a dynamic data exchange (DDE)
channel in Microsoft Access. However, you can use a function with
parameters in a DDE channel to the SQL topic to pass information to an
Access Basic function. The data can then be processed by the function and
added to a table.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools
provided with Microsoft Access. For more information on Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x, or the "Building Applications" manual, Chapter 3,
"Introducing Access Basic" in version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example explains how to add a new customer to the Customers
table in the sample database NWIND.MDB, using data from Microsoft Excel:

<OL><P><LI>Create a table called None, with one field of any data type.

<P><LI>Open a module and create the following sample function with the
   parameters that you want to pass:
<P>
<P><PRE>      Function AddNewCust$ (CustomerID$, CompanyName$)
<PRE></PRE>         Dim MyDB As Database, MyTable As Table
         Set MyDB = CurrentDB()

         Set MyTable = MyDB.OpenTable("Customers")  ' Open table.

         MyTable.AddNew                             ' Prepare new record.
         MyTable("Customer ID") = CustomerID$       ' Set record key.
         MyTable("Company Name") = CompanyName$     ' Set company name.
         MyTable.Update                             ' Save changes.
         MyTable.Close                              ' Close table.
      End Function

</PRE><P><LI>In the DDE client application, initiate a DDE link using MSACCESS as the
   application and use a SQL Select query as the topic. The topic will be
   of the form
<P>
<P><PRE>      DatabaseName;SQL Select FunctionName(args) From None;
</PRE><P>
   where None is the empty table and FunctionName(args) is the call to the
   Access Basic function that processes the arguments, args, passed to it.
<P>
   For example, the following Microsoft Excel macro inserts a new
   record into the Customer table.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      AddNewCustomer
      chan=INITIATE("MSACCESS","NWIND.MDB;SQL SELECT_
<PRE></PRE>           AddNewCust$(""JOHNJ"",""John's Place"") FROM None; ")
      =TERMINATE(chan)
      =RETURN()

   The following is the equivalent Microsoft Word for Windows Word Basic
   macro.

   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.

      Sub MAIN
      qt$ = Chr$(34)
      Funct$ = "AddNewCust$(" + qt$ + "JOHNJ" + qt$ + "," + qt$ + _
      "John's Place" + qt$ + ")"
      Chan = DDEInitiate("MSACCESS", "NWIND;SQL SELECT " + Funct$ + _
         " FROM None;")
      DDETerminate Chan
      End Sub

</PRE></OL>Note that this technique works only with functions that perform operations
that can run successfully in the Microsoft Access query by example (QBE)
grid. For example, a function that performs an OpenForm action will fail
with the error message "Can't run this action while in current code
context." The function fails because it tries to perform an OpenForm action
while a query is running, which is not allowed.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Language Reference," version 1.0, pages 118-124
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dde excel macro ddepoke<BR>
Keywords            : IntpDde kbinterop PgmHowTo<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
