

<HTML>
<HEAD>
<TITLE>ACC1x: Creating Result Equivalent to SQL UNION Operator Result </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94830 ">
<META NAME="KBModify" CONTENT="1997/08/06">
<META NAME="KBCreate" CONTENT="1993/01/19">
<META NAME="Keywords" CONTENT="QryUnion kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The SQL UNION operator is not supported in Microsoft Access. However, you can obtain an equivalent result (a UNION product) by using the following two-step process to create two queries: a make-table query and an append query.  MORE INFORMATION  Th...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA7O,QA7N,QAL3,QARR,QAY2,QA4F,QAJQ,QACF,QAHH,QBWS,QA1S,QBVV,QDMH,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Creating Result Equivalent to SQL UNION Operator Result</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94830 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The SQL UNION operator is not supported in Microsoft Access. However, you
can obtain an equivalent result (a UNION product) by using the following
two-step process to create two queries: a make-table query and an append
query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The product of a UNION includes all records from two related tables--those
that match on the related key field and those that do not match on the
related key field.
<P>
For example, say you have two tables, Table A and Table B. Table A contains
the following fields and records:
<P>
<PRE>   Key1    Field A
   ----------------
   1       Seattle
   2       Portland
   4       Chicago

</PRE>Table B contains the following fields and records:
<P>
<PRE>   Key2    Field B
   ------------------
   1       Washington
   3       Oregon
   5       Illinois

</PRE>The UNION product of the two tables would look like this:
<P>
<PRE>   Key     Field A     Field B
   -------------------------------
   1       Seattle      Washington
   2       Portland
   3                    Oregon
   4       Chicago
   5                    Illinois

</PRE>Use the following two-step process to obtain a UNION product in Microsoft
Access:
<P>
<P><h3>Step One: Collect the Records that Have a Matching Key Value</h3>
 

<OL><P><LI>Create a query, and add the two tables (Table A and Table B) to the
   query grid.

<P><LI>Join the two tables by using the mouse to connect Key1 in Table A to
   Key2 in Table B.

<P><LI>Double-click the join line between the two tables to bring up the Join
   Properties dialog box. Select the second option, "Include ALL records
   from 'Table A' and only those records from 'Table B' where the joined
   fields are equal."

<P><LI>Add three fields to the query grid: Key1 from Table A, Field A from
   Table A, and Field B from Table B. You can use the mouse to drag these
   fields onto the query grid.

<P><LI>Choose Make Table... from the Query menu. The Query Properties
   dialog box appears. The default selection is Current Database under
   Make New Table. Enter an appropriate table name (for example,
   UNION Result) for the result table, and choose the OK button.

<P><LI>Run the query to create the new table (UNION Result). It will contain
   the following fields and records:
<P>
<PRE>      Key1       Field A      Field B
      ----------------------------------
      1          Seattle      Washington
      2          Portland
      4          Chicago

</PRE></OL><h3>Step Two: Add the Rest of the Records to the Result</h3>
 
<P>
To complete the UNION, you need to add the records in Table B that do not
have a matching key field value in Table A.

<OL><P><LI>Create another new query. Add two tables (Table B and UNION Result) to
   the query grid.

<P><LI>Join the two tables by using the mouse to connect Key2 in Table B to
   Key1 in the UNION Result table.

<P><LI>Double-click the join line between the two tables to bring up the Join
   Properties dialog box. Select the second option, "Include ALL records
   from 'Table B' and only those records from 'UNION Result' where the
   joined fields are equal."

<P><LI>Add three fields to the query grid: Key2 from Table B, Field B from
   Table B, and Key1 from UNION Result. You can use the mouse to drag
   the fields onto the query grid. You do not need Field A from UNION
   Result because UNION Result already contains all the rows from Table A.

<P><LI>Choose Append... from the Query menu. The Query Properties dialog box
   appears. Ensure that UNION Result is in the Table Name field under
   Append To. Then choose the OK button.

<P><LI>Verify that the query grid how has a line labeled Append To. Choose
   Table Names from the View menu to show table names on the query grid.
   Now the query grid should look something like this:
<P>
<PRE>          Field:   Key2       Field B      Key1
          Table:   Table B    Table B      UNION Result
           Sort:
      Append To:   Key1       Field B
       Criteria:                           Is Null

   Note that the Key1 field from the UNION Result table is not appended
   to anything and it has an Is Null restriction on it. This ensures that
   no records from UNION Result are duplicated and appended to it when you
   run the append query.

</PRE><P><LI>Run the append query. The UNION Result table looks like this:
<P>
<PRE>      Key1    Field A         Field B
      ----------------------------------
      1       Seattle         Washington
      2       Portland
      3                       Oregon
      4       Chicago
      5                       Illinois

   As you can see, record 1 has a match on the joined fields, but all the
   other records are represented only once. This is the correct UNION
   product. If the Key1 values in UNION Result are not in ascending order,
   it is because there is no primary key on that column.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: action sql relational<BR>
Keywords          : QryUnion kbusage<BR>
Version           : 1.0 1.1<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
