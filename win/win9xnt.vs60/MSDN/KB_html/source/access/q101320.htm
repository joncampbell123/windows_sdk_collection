

<HTML>
<HEAD>
<TITLE>ACC1x: Cannot Auto Update an OLE-Linked Object in a Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101320">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1993/07/11">
<META NAME="Keywords" CONTENT="IntpOle kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The Auto Update check box is unavailable in the Edit Paste Special dialog box when you are attempting to paste link an OLE object.  CAUSE =====  You cannot paste link an object into an OLE-object field in a table in Microsoft Access and specify tha...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QAPN,QBS9,QBJZ,QA1S,QBD2,QA7O,QA7N,QAW6,QAY5,QAC1,QA9Q,QDN9,QBXS,QA9N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Cannot Auto Update an OLE-Linked Object in a Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101320</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The Auto Update check box is unavailable in the Edit Paste Special
dialog box when you are attempting to paste link an OLE object.
<P>
<P><h2>CAUSE</h2>
 
<P>
You cannot paste link an object into an OLE-object field in a table in
Microsoft Access and specify that the link be "hot," or automatically
updated.
<P>
You can place linked OLE objects on forms and reports when they are
in Design view. If you paste a link to an OLE object into a form or
report in Design view, the Auto Update check box will be available.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
One workaround is to force Microsoft Access to update the OLE-linked
field by selecting the object to update, choosing Object from the Edit
menu, and then selecting Update.
<P>
This process can be automated using the Access Basic UpdateOLE()
function listed below, which can be assigned to a button on the form
or to the OnCurrent property of the form. If it is assigned to the
OnCurrent property, Microsoft Access will automatically perform the
macro whenever you select a different record. This will ensure that
the data in the selected record will always be current, effectively
simulating auto updating.
<P>
Create a new module with the following declarations and UpdateOLE()
function:
<P>
<PRE>   '****************************************************************
   ' DECLARATIONS SECTION
   '****************************************************************
   Option Explicit

   '****************************************************************
   ' FUNCTION: UpdateOLE
   '
   ' PURPOSE: Automates updating an OLE-linked field.
   '
   ' ARGUMENTS:
   '    FieldName - A string with the name of the field to update.
   '
   ' EXAMPLE USAGE:
   '    The OnPush property for a button could be set to:
   '       =UpdateOLE("OLEField")
   '
   ' SIDE EFFECTS:
   '    Focus will be left on the OLE-object field.
   '    The record will be put in Edit Mode.
   '
   '****************************************************************
   Function UpdateOLE (ByVal FieldName As String)
      On Error GoTo ErrUpdateOLE
      DoCmd GoToControl FieldName
      DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, A_OBJECT, A_OBJECTUPDATE

   ByeUpdateOLE:
      Exit Function

   ErrUpdateOLE:
      Resume ByeUpdateOLE

   End Function

</PRE><h3>Using the UpdateOLE() Function</h3>
 
<P>
You can use the UpdateOLE() function by assigning it to a button on
the form or to the OnCurrent property of the form. If performance is a
problem when you are using the OnCurrent solution, the button approach
allows you to decide when the data should be refreshed.
<P>
For a linked OLE field named "OLEField" on your form, set the OnPush
property of the button or the OnCurrent property for the form to the
following:
<P>
<PRE>   =UpdateOLE("OLEField")

</PRE>If you have multiple OLE-linked fields you can create a macro to call
UpdateOLE() for each OLE field on the form.
<P>
For three linked OLE fields on a form named "OLEField1", "OLEField2", and
"OLEField3", create the following macro and save it with the name
"UpdateAllOLEFields"
<P>
<PRE>   Action           Argument
   -------------------------------------------------------
   RunCode          Function Name: =UpdateOLE("OLEField1")
   RunCode          Function Name: =UpdateOLE("OLEField2")
   RunCode          Function Name: =UpdateOLE("OLEField3")

</PRE>then set the OnPush property of the button or the OnCurrent property
of the form to the following:
<P>
<PRE>   UpdateALLOLEFields

</PRE><h2>STATUS</h2>
 
<P>
This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Hot linking, or automatically updating an OLE object, requires a
significant number of system resources. Large numbers of hot-linked
OLE linked objects can cause out of memory or other system errors.
<P>
However, Auto Update is available to unbound OLE objects inserted in a
form or report in Design view. This is because the number of objects
inserted in a form is generally minimal.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Excel.

<P><LI>In cell A1, type "123" (without the quotation marks), and press
   ENTER.

<P><LI>Select the cell and choose Copy from the Edit menu.

<P><LI>Switch to or start Microsoft Access and create a table that has a
   field with the datatype set to "OLE Object".

<P><LI>Create a new, blank form, based on the table created in step 4.

<P><LI>From the View menu, choose Field List.

<P><LI>Drag the OLE field from the Field List window to the middle of the
   blank form.

<P><LI>From the View menu, choose Form.

<P><LI>Select the OLE field, and then choose Paste Special from the Edit
   menu.
<P>
</OL>"Microsoft Excel Worksheet Object" will appear in the Data Type box,
and the Paste and Paste Link buttons will be available, but the Auto
Update check box will be unavailable.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: greyed grayed dimmed checkbox<BR>
Keywords            : IntpOle kbinterop<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
