

<HTML>
<HEAD>
<TITLE>ACC97: Error: "Can't open the table" in Data Source of ASP File </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172547">
<META NAME="KBModify" CONTENT="1997/08/11">
<META NAME="KBCreate" CONTENT="1997/08/08">
<META NAME="Keywords" CONTENT="IntAsp kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you try to open a Microsoft Access table in Design view, you may receive the following message:     You can't open the table             for modification.     A query or for...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWS,QDNQ,QA1S,QAK6,QAPN,QAZV,QDN9,QAYY,QAH8,QBWA,QA9E,QABI,QAG2,QAUR,QA3P P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Error: "Can't open the table" in Data Source of ASP File</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172547</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you try to open a Microsoft Access table in Design view, you may
receive the following message:
<P>
<PRE>   You can't open the table &lt;tablename&gt; for modification.

   A query or form bound to the table is open, you may not have permission
   to open this table in Design view, or another user has the table open.
   Do you want to open this table as read-only?

   If you have opened a query or form bound to this table, close it, and
   then try again to open the table in Design view.

</PRE>You may also receive errors if you try to move or copy a database in
Windows Explorer; for example you may receive the message:
<P>
<PRE>   Cannot move &lt;database&gt;: There has been a sharing violation.

   The source or destination file may be in use.

   -or-

   Cannot rename &lt;database name&gt;: Access is denied.

   Make sure the disk is not full or write-protected and that the file is
   not currently in use.

</PRE><h2>CAUSE</h2>
 
<P>
The database is an ODBC data source that is used by an ASP file. For
example, this behavior would occur if the table itself, or a query or form
based on that table, had been exported to ASP format. Although the ASP
file, itself, may not currently be open in a user's browser, the Session
object for a particular user session persists for the period of time
specified by its Timeout property. The ASP file contains code that creates
a connection object and stores that connection in the session variable.
Therefore, the connection to the Microsoft Access database that serves as
the ODBC data source persists until the session times out. The default
value of the Timeout property is 20 minutes.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can use one of the following methods to resolve this issue.
<P>
<P><h3>Method 1</h3>
 
<P>
Instead of editing the database that is the ODBC data source, edit a copy
of that database. When all sessions have expired, export the redesigned
table to the ODBC data source, or copy the database itself to the file that
serves as the data source. This is the recommended method to resolve this
issue.
<P>
<P><h3>Method 2</h3>
 
<P>
Export the database object to ASP format again, and use the "Publish to the
Web" Wizard to specify to Timeout property. To do so, follow these steps:

<OL><P><LI>On the File menu, click Save As HTML.

<P><LI>In the first screen of the "Publish to the Web" Wizard, click Next.

<P><LI>When asked what you want to publish, select the database object(s) that
   you want to export to ASP format, and then click Next.

<P><LI>Choose a template if you want, and then click Next.

<P><LI>Select Dynamic ASP (Microsoft Active Server Pages), and then click Next.

<P><LI>Supply the necessary Data Source Information and the URL of the server
   location to which you are saving the file. In the Session Timeout box,
   type the number of minutes for which the Session object should persist,
   and then click Next.

<P><LI>Specify the folder to which you want to publish, and then click Next.

<P><LI>Click to select the check box if you want to create a home page and
   click Next; then, click to select the check box if you want to save a
   publication profile.

<P><LI>Click Finish.
<P>
</OL><h3>Method 3</h3>
 
<P>
NOTE: This section contains information about editing ASP files, and
assumes that you are familiar with editing ASP files. Microsoft Access
Technical Support engineers do not support customization of any HTML, HTX,
IDC, or ASP files.
<P>
Edit your ASP file and specify the value of Session.Timeout. To do so,
follow these steps:

<OL><P><LI>Open the ASP file in a text editor, such as Notepad.

<P><LI>Locate the following text after the TITLE tags near the beginning of the
   file:
<P>
<P><PRE>      &lt;/HEAD&gt;
      &lt;BODY&gt;
      &lt;%
      If IsObject(Session("&lt;Your ODBC Data Source Name&gt;_conn")) Then
</PRE>
<P><LI>Edit the text so that it reads as follows
<P>
<P><PRE>      &lt;/HEAD&gt;
      &lt;BODY&gt;
      &lt;%
      Session.timeout = n
      If IsObject(Session("&lt;ODBC Data Source Name&gt;_conn")) Then
</PRE><P>
   where n is the number of minutes for which you want the session to last
   before it times out.

<P><LI>Save and close the file.
<P>
</OL><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
The following example assumes that you have created an ODBC data source
based on the sample database Northwind.mdb.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>On the File menu, click Save As HTML.

<P><LI>In the first screen of the "Publish to the Web" Wizard, click Next.

<P><LI>When asked what you want to publish, select the Products form, and
    then click Next.

<P><LI>In the screen that asks you to select a template, click Next.

<P><LI>Select Dynamic ASP (Microsoft Active Server Pages), and then click
    Next.

<P><LI>Supply the necessary Data Source Information and the URL of the server
    location to which you are saving the file; leave the Session Timeout
    box blank, and click Next.

<P><LI>Specify the folder to which you want to publish, and then click Next.

<P><LI>Click Finish, and then close the database.

<P><LI>Open a browser on a client computer and type the URL for Products_1.asp
    in the Address box. For example:
<P>
      <B>http://&lt;servername&gt;/scripts/Products_1.asp</B>

<P><LI>Close the browser.

<P><LI>On the server, open the sample database Northwind.mdb in Microsoft
    Access.

<P><LI>Try to open the Products table in Design view. Note that you receive
    the following error:
<P>
       You can't open the table 'Products' for modification.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating an ODBC data source, search the Help
Index for "ODBC, setting up data sources."
<P>
For more information about the Session object in ASP, open the Active
Server Pages Roadmap and under Contents, click Object Reference.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 7.00<BR>
Keywords          : IntAsp kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
