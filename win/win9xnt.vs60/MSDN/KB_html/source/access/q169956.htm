

<HTML>
<HEAD>
<TITLE>ACC: Cannot Trap Import Errors in Visual Basic for Applications </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q169956">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1997/06/11">
<META NAME="Keywords" CONTENT="IsmExl4 IsmExl5 IsmTxtd IsmTxtfx kbinterop kbprg PgmErr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  In Visual Basic for Applications, you cannot trap for import errors generated when you use the TransferText or TransferSpreadsheet methods to import or append data to a Microsoft...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBS0,QA1S,QDN9,QBRZ,QAWI,QBWS,QAAP,QAB4,QA5V,QAEQ,QA5F,QA3T,QAMA,QAIB,QAGB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Cannot Trap Import Errors in Visual Basic for Applications</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q169956</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
In Visual Basic for Applications, you cannot trap for import errors
generated when you use the TransferText or TransferSpreadsheet methods to
import or append data to a Microsoft Access table.
<P>
This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The same rules that apply to manual data entry also apply to methods for
importing data in Visual Basic for Applications. Therefore, any violations
of rules, such as referential integrity, validation rules, or the Required
property, will result in an incomplete import.
<P>
In Microsoft Access 1.x and 2.0, a violation of these rules generates a
trappable error, which makes it possible for developers to determine if the
import completed successfully. In Microsoft Access 7.0 and 97, this
behavior has changed so that no trappable error is generated. Furthermore,
if the procedure disables system messages by using the SetWarnings
statement, there is no indication that any problem occurred.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open any text editor, such as Notepad, and create the following new
    text file:
<P>
       OrderID,ProductID,UnitPrice,Quantity,Discount
       99999,54,7.45,20,0.000

<P><LI>Save the text file as C:\My Documents\OrdDetails.txt.

<P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>On the File menu, point to Get External Data, and then click Import.

<P><LI>In the Import dialog box, select Text Files in the Files Of Type box.

<P><LI>Locate the folder C:\My Documents, select OrdDetails.txt, and click
    Import.

<P><LI>On the first screen of the Import Text Wizard, select the Delimited
    option, and then click Next.

<P><LI>On the second screen of the Import Text Wizard, select the "First Row
    Contains Field Names" option.

<P><LI>Click the Advanced button.

<P><LI>In the OrdDetails Import Specification dialog box, click Save As.

<P><LI>In the Save Import/Export Specification box, type "Order Details
    Specification" (without the quotation marks) in the Specification Name
    box, and then click OK.

<P><LI>Click OK to close the Order Details Specification dialog box.

<P><LI>Click Cancel to exit the Text Import Wizard.

<P><LI>Create a module and type the following line in the Declarations
    section if it is not already there:
<P>
       Option Explicit

<P><LI>Type the following procedure:
<P>
<PRE>       Sub ImportOrderDetails()
          On Error GoTo ImportOrderDetails_Error
          DoCmd.TransferText acImportDelim, _
             "Order Details Specification", _
             "Order Details", "C:\My Documents\OrdDetails.txt"

       Exit_ImportOrderDetails:
          Exit Sub

       ImportOrderDetails_Error:
          MsgBox "Error Handler was invoked."
          MsgBox CStr(Err) &amp; " " &amp; Err.Description
          Resume Exit_ImportOrderDetails
        End Sub

</PRE><P><LI>To test this procedure, type the following line in the Debug window,
    and then press ENTER.
<P>
       ImportOrderDetails
<P>
    Note that you receive the following message:
<P>
       Microsoft Access was unable to append all the data to the table.
<P>
       The contents of fields in 0 records(s) were deleted, and 1 record(s)
       were lost due to key violations.
<P>
    Click Yes. Note that the error handler never executes. This indicates
    that the procedure did not encounter a trappable error.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IsmExl4 IsmExl5 IsmTxtd IsmTxtfx kbinterop kbprg PgmErr<BR>
Version             : 7.00 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
