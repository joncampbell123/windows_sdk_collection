

<HTML>
<HEAD>
<TITLE>ACC: Sent Keys Lost If Microsoft Access Yields Processor </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109958">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="kbprint PtrOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  If you use the SendKeys statement in Access Basic to fill a dialog box and Microsoft Access yields the computer's processor to another Windows process before the dialog box...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAA1,QAOX,QDI2,QDN9,QBJZ,QDL9,QBWO,QBWN,QDMF,QBWS,QBWQ,QACT,QAGU,QA2Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Sent Keys Lost If Microsoft Access Yields Processor</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109958</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
If you use the SendKeys statement in Access Basic to fill a dialog box and
Microsoft Access yields the computer's processor to another Windows process
before the dialog box appears, the sent characters will be lost.
<P>
One situation where this might occur would be filling a report name in the
Print dialog box when you are printing a report to a file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To minimize the chance of losing sent keys, make your queries as short as
possible. When a query takes a long time to run, Windows has more time to
interrupt the task to serve another Windows process. By shortening your
queries, you give Windows less time to interrupt.
<P>
If this problem occurs when you are printing to a file, try printing
directly to the file through your printer driver. If your printer driver
supports this, set it to print your report directly to a file instead of
using Microsoft Access to do this.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
1.0, 1.1, and 2.0. This problem no longer occurs in Microsoft Access
version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Set up a Windows printer to print to FILE. In Microsoft Windows 95
   open the Printer folder and click on New Printer. Follow the wizard
   instructions. In Windows 3.x, use the Windows Control Panel, double-
   click on printers, select or add your printer click Connect. Select
   FILE from the Ports list and click OK.

<P><LI>Start Microsoft Access and open the sample database Northwind.mdb
   (In Access 2.0 or earlier, NWIND.MDB.)

<P><LI>Copy the query "Employee Sales by Country" to "Employee Sales by
   Country Backup". (In Access 2.0 and earlier, this query will be
   called "Employee Sales by Country (Parameter)")

<P><LI>Open the "Employee Sales by Country" query and remove the
   parameters from the Shipped Date field in the query grid.

<P><LI>Drag the Employee ID field to the query grid and then type "1"
   (without the quotation marks) in its Criteria row. Close and
   save the query.

<P><LI>Create the following new macro and save it as "Print Employee Sales
   by Country":
<P>
<P><PRE>      SendKeys
<PRE></PRE>         Keystrokes: text.txt
         Wait: No
      SendKeys
         Keystrokes: {enter}
         Wait: No
      OpenReport
         Report: Employee Sales By Country
         Mode: Print

</PRE><P><LI>Set the report "Employee Sales by Country" to print to the printer
   on port FILE. To do this, in Microsoft Access for Windows, select
   Page Setup from the File menu. Select the Page tab. Select "Use
   Specific Printer" and select the printer you set up in step 1. Click
   OK. In Microsoft Access, version 2.0 or earlier, select Printer Setup
   from the File menu and select specific printer. Select the printer you
   set up in Step 1 above and click OK. Save the report.

<P><LI>Run the "Print Employee Sales by Country" macro. In Microsoft Access
   for Windows 95 or Microsoft Access, version 1.x, the sent keys work
   correctly. In version 2.0, the sent keys are lost.

<P><LI>Remove the Employee ID field from the query and run the macro again.
   Note that the sent keys are again lost in Microsoft Access, version 2.0
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For information on setting up a printer in Windows 95, search for "Printer,
setting up a printer" using the Windows 95 Help menu.
<P>
For more information about setting up a printer, search for "SendKeys
action" or "printing, Print dialog box options" using the Microsoft Access
2.0 Help menu.
<P>
For more information about setting up a printer, search for "Print Setup"
or "Sendkeys" using the Microsoft Access 2.0 Help menu.
<P>
For more information about setting up a printer in Microsoft Windows 3.x,
press F1 while in the Printer Setup window.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: programming  timeout<BR>
Keywords            : kbprint PtrOthr<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
