

<HTML>
<HEAD>
<TITLE>ACC1x: SQL Delete Triggers Function Incorrectly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99404 ">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1993/05/27">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Microsoft Access appears to delete a record in an attached SQL table, but the record is not actually deleted. The record will reappear when you requery the table.  CAUSE =====  The Microsoft SQL Server driver that comes with Microsoft Access versio...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QABM,QAEF,QAGB,QBCT,QAGC,QA1S,QATP,QDKD,QDN9,QBJZ,QAOX,QA39,QAB4,QDMH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: SQL Delete Triggers Function Incorrectly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99404 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 1.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Microsoft Access appears to delete a record in an attached SQL table, but
the record is not actually deleted. The record will reappear when you
requery the table.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Microsoft SQL Server driver that comes with Microsoft Access version
1.0 incorrectly indicates that the result of the SQL delete action is
successful.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To correct this problem, you must DROP the current trigger and CREATE a new
delete trigger on the SQL Server that uses the RAISERROR command instead of
the PRINT command. This method causes Microsoft Access version 1.0 to not
delete the record and display the following error messages:
<P>
<PRE>   ODBC - delete failed.

   [Microsoft][ODBC SQL Server Driver][SQL Server] &lt;MESSAGE&gt; (#-31073)

</PRE>where &lt;MESSAGE&gt; is the message you specified in the RAISERROR command.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
1.0. This problem was corrected in Microsoft Access version 1.1.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you try to delete a record from an attached SQL table that has a delete
trigger that performs a ROLLBACK and a PRINT action on the SQL Server,
Microsoft Access version 1.0 appears to delete the record and then displays
a message box asking you to verify your deletion. The record is actually
not deleted and reappears when you requery the table by pressing SHIFT+F9,
choosing Show All Records from the Records Menu, or closing and reopening
the table.
<P>
In Microsoft Access version 1.1, the RAISERROR method works the same way
that it does in version 1.0. The PRINT method works similarly to the way it
does in version 1.0.
<P>
In version 1.0, the PRINT method appears to let you delete the record
without a warning, then later the record reappears. In version 1.1, the
PRINT method still does not display the message specified by the PRINT
command; however, it does not remove the record, and it does display the
following error message:
<P>
<PRE>   ODBC - call failed.

</PRE><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Create a trigger on a SQL Server table that uses the SQL commands
   ROLLBACK and PRINT.

<P><LI>Attach the SQL table that the delete trigger was created for by
   choosing Attach from the File menu.

<P><LI>Once the table is attached, open it in Datasheet view.

<P><LI>Select a record by clicking the gray record selector to the left of
   the record or by choosing Select Record from the Edit menu.

<P><LI>Delete the record by pressing the DEL key or by choosing Delete
   from the Edit menu.

<P><LI>Choose Yes in the Confirmation dialog box that is displayed.
<P>
</OL>The record appears to be deleted from the table. Requery the table by
pressing SHIFT+F9. The record reappears.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Microsoft SQL Server Language Reference," version 4.2, pages 88-93,
137, 203-204, and 214-216
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ODBC<BR>
Keywords            : kbusage OdbcOthr<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
