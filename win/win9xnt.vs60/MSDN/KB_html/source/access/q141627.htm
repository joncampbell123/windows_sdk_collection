

<HTML>
<HEAD>
<TITLE>ACC: GotoRecord Macro Action Behaves Unexpectedly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141627">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="kbusage McrProb">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The GotoRecord macro action doesn't behave as you would expect when you use it in an AutoKeys macro. Instead of changing the record of the active form, it changes the record of a...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QAY5,QAH4,QDN9,QA5V,QAB9,QBS0,QBV8,QA63,QA5F,QAMA,QAAP,QAB4,QAUJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: GotoRecord Macro Action Behaves Unexpectedly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141627</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The GotoRecord macro action doesn't behave as you would expect when you use
it in an AutoKeys macro. Instead of changing the record of the active form,
it changes the record of a form in the background.
<P>
<P><h2>CAUSE</h2>
 
<P>
These symptoms appear when you use the GotoRecord action in an AutoKeys
macro while a form is opened with a Timer event running.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This resolution assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to your version of the
"Building Applications with Microsoft Access" manual.
<P>
NOTE: Visual Basic for Applications is called Access Basic in Microsoft
Access version 2.0. For more information about Access Basic, please refer
to the "Building Applications" manual.
<P>
To achieve the desired result of selecting the next or previous record on
the active form when you press a predefined key, follow these steps:

<OL><P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedures:
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>      Function GotoPreviousRecord()
<PRE></PRE>         On Error Goto GotoPreviousErrorHndlr
            ' Screen.ActiveForm.Name forces the GotoRecord action
            ' to be applied to the active form.
            DoCmd.GoToRecord acForm, Screen.ActiveForm.Name, acPrevious
         ExitGotoPreviousRecord:
            Exit Function
         GotoPreviousErrorHndlr:
            MsgBox Error$
            Resume ExitGotoPreviousRecord
      End Function

      Function GotoNextRecord()
         On Error Goto GotoNextErrorHndlr
            ' Screen.ActiveForm.Name forces the GotoRecord action
            ' to be applied to the active form.
            DoCmd.GoToRecord acForm, Screen.ActiveForm.Name, acNext
         ExitGotoNextRecord:
            Exit Function
         GotoNextErrorHndlr:
            MsgBox Error$
            Resume ExitGotoNextRecord
      End Function

   In Microsoft Access 2.0:

      Function GotoPreviousRecord()
         On Error Goto GotoPreviousErrorHndlr
            ' Screen.ActiveForm.Name forces the GotoRecord action
            ' to be applied to the active form.
            DoCmd GotoRecord A_FORM, Screen.ActiveForm.Name, A_PREVIOUS
         ExitGotoPreviousRecord:
            Exit Function
         GotoPreviousErrorHndlr:
            MsgBox Error$
            Resume ExitGotoPreviousRecord
      End Function

      Function GotoNextRecord()
         On Error Goto GotoNextErrorHndlr
            ' Screen.ActiveForm.Name forces the GotoRecord action
            ' to be applied to the active form.
            DoCmd GotoRecord A_FORM, Screen.ActiveForm.Name, A_NEXT
         ExitGotoNextRecord:
            Exit Function
         GotoNextErrorHndlr:
            MsgBox Error$
            Resume ExitGotoNextRecord
      End Function

</PRE><P><LI>Create an AutoKeys Macro and assign each key stroke to the macro action
   RunCode. The RunCode's Function Name argument is the appropriate custom
   function's name. If you used the examples above, it is either
   GotoPreviousRecord() or GotoNextRecord().
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0),
<P><PRE>    and then Open the Employees form in Design view.
</PRE>
<P><LI>Add a text box to the form header section, and set its Name property to
   CurrentTime.

<P><LI>Set the TimerInterval property of the Employees form to 1000 (one
   second).

<P><LI>Set the OnTimer property of the Employees form to [Event Procedure] and
   click the Build button.

<P><LI>Type the following procedure for the OnTimer property's event
   procedure:
<P>
   NOTE: In version 2.0, the word Private before Sub is omitted by
   default.
<P>
<P><PRE>      Private Sub Form_Timer()
<PRE></PRE>         Me![CurrentTime] = Now()
      End Sub

    This procedure updates the time in the CurrentTime control once every
    second.

</PRE><P><LI>Create a macro named AutoKeys with the following settings:
<P>
<P><PRE>      Macro Name  Action
      ----------------------
<PRE></PRE>      {F2}        GotoRecord
      {F3}        GotoRecord

      {F2} Actions
       -----------
       GotoRecord
           Record: Previous
      {F3} Actions
       -----------
       GotoRecord
           Record: Next

</PRE><P><LI>Close and save the macro.

<P><LI>Open the Employees, Categories, and Customers forms. Make sure that
   either the Categories or Customers form is active.

<P><LI>Press the F3 key. Note that the AutoKeys macro does run but it selects
   the next record on the Employees form instead of the active form, as
   you would expect.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about AutoKeys, search the Help Index for "AutoKeys,"
or ask the Microsoft Access 97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage McrProb<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
