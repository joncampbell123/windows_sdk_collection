

<HTML>
<HEAD>
<TITLE>ACC: "#Deleted" Errors with Attached ODBC Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128809">
<META NAME="KBModify" CONTENT="1998/01/06">
<META NAME="KBCreate" CONTENT="1995/04/11">
<META NAME="Keywords" CONTENT="OdbcOthr kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When you retrieve, insert, or update records in an attached ODBC table, each field in a record contains the  #Deleted  error message. When you retrieve, insert, or update records using code, you receive the error message  Record is deleted.   CAUSE...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QA39,QA28,QATJ,QAXB,QAB4,QAEF,QDN9,QAKD,QAGB,QA7O,QA7N,QBCT,QA9E P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "#Deleted" Errors with Attached ODBC Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128809</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When you retrieve, insert, or update records in an attached ODBC table,
each field in a record contains the "#Deleted" error message. When you
retrieve, insert, or update records using code, you receive the error
message "Record is deleted."
<P>
<P><h2>CAUSE</h2>
 
<P>
The Microsoft Jet database engine is designed around a keyset-driven model.
This means that data is retrieved, inserted, and updated based on key
values (in the case of an attached ODBC table, the unique index of a
table).
<P>
After Microsoft Access performs an insert or an update of an attached ODBC
table, it uses a Where criteria to select the record again to verify the
insert or update. The Where criteria is based on the unique index.
Although numerous factors can cause the select not to return any records,
most often the cause is that the key value Microsoft Access has cached is
not the same as the actual key value on the ODBC table. Other possible
causes are as follows:

<UL><LI>Having an update or insert trigger on the table, modifying the key
   value.

<LI>Basing the unique index on a float value.

<LI>Using a fixed-length text field that may be padded on the server with
   the correct amount of spaces.

<LI>Having an attached ODBC table containing Null values in any of the
   fields making up the unique index.
<P>
</UL>These factors do not directly cause the "#Deleted" error message. Instead,
they cause Microsoft Access to go to the next step in maintaining the key
values, which is to select the record again, this time with the criteria
based on all the other fields in the record. If this step returns more than
one record, Microsoft Access returns the "#Deleted" message because it does
not have a reliable key value to work with. If you close and re-open the
table or choose Show All Records from the Records menu, the "#Deleted"
errors are removed.
<P>
Microsoft Access uses a similar process to retrieve records from an
attached ODBC table. First, it retrieves the key values and then the rest
of the fields that match the key values. If Microsoft Access is not able to
find that value again when it tries to find the rest of the record, it
assumes that the record is deleted.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following are some strategies that you can use to avoid this behavior:

<UL><LI>Avoid entering records that are exactly the same except for the unique
   index.

<LI>Avoid an update that triggers updates of both the unique index and
   another field.

<LI>Do not use a Float field as a unique index or as part of a unique index
   because of the inherent rounding problems of this data type.

<LI>Do all the updates and inserts by using SQL pass-through queries so
   that you know exactly what is sent to the ODBC data source.

<LI>Retrieve records with an SQL pass-through query. An SQL pass-through
   query is not updateable, and therefore does not cause "#Delete" errors.

<LI>Avoid storing Null values within any field making up the unique index of
   your attached ODBC table.
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB. in Microsoft
   Access 2.0)

<P><LI>Use the Upsizing Tools to upsize the Shippers table.
<P>
   NOTE: This table contains an AutoNumber field (or Counter field in
   Microsoft Access 2.0) that is translated on SQL Server by the Upsizing
   Tools into a trigger that emulates a counter.

<P><LI>Open the attached Shippers table and enter a new record. Make sure
   that the record you enter has the same data in the Company Name field
   as the previous record.

<P><LI>Press TAB to move to a new record. Note that the "#Deleted" error fills
   the record you entered.

<P><LI>Close and re-open the table.  Note that the record is correct.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pounddeleted mcsys7 kbinterop kb3rdparty<BR>
Keywords          : OdbcOthr kberrmsg kbinterop<BR>
Version           : 2.0<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
