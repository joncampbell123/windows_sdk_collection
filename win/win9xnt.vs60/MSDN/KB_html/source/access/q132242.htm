

<HTML>
<HEAD>
<TITLE>ACC2: Sample Function Using Recursion to Display Data Tree </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132242">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1995/07/03">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmLoop PgmPrcs">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  This article demonstrates how you can create a sample user-defined Access Basic function that calls itself multiple times in order to loop through a linked list of items. You can use this technique to display data in a tree structure such as a dire...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA5V,QA5F,QAMA,QAY5,QAUJ,QAML,QAGU,QBV8,QAB9,QAPF,QBXT,QBXS,QAVX V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Sample Function Using Recursion to Display Data Tree</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132242</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates how you can create a sample user-defined Access
Basic function that calls itself multiple times in order to loop through a
linked list of items. You can use this technique to display data in a tree
structure such as a directory of managers and employees.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a sample user-defined Access Basic function that calls itself
multiple times, follow these steps:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Make a copy of the Employees table and name it Employees2.

<P><LI>Open the Employees2 table in Design view.

<P><LI>Change the name of the Employee ID field to EmpID.

<P><LI>Change the name of the Reports To field to MgrID and set the MgrID
   field's Indexed property to Yes(Duplicates OK).

<P><LI>Save and close the Employees2 table.

<P><LI>Create a module and type the following line in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following two procedures:
<P>
<P><PRE>      Function Start_List (EmpID As Long)
</PRE><P>
<PRE>         Dim db As Database, rs As Recordset
         Set db = CurrentDB()
         Set rs = db.OpenRecordset("Employees2", DB_OPEN_TABLE)
         rs.Index = "Primarykey"
         rs.Seek "=", EmpID
         If rs.NoMatch Then Exit Function
         Debug.Print EmpID &amp; " " &amp; rs![first name] &amp; " "; rs![last name]
         rs.Index = "MgrID"
         List_Employees rs, EmpID, 1
         rs.Close
         db.Close

      End Function

   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code.

         Sub List_Employees (rs As Recordset, ByVal MgrID As Long, ByVal _
         level As Integer)

         Dim bm As String
         rs.Seek "=", MgrID
         If rs.NoMatch Then Exit Sub
         Do While Not rs.EOF
           If rs!MgrID &lt;&gt; MgrID Then Exit Sub
           Debug.Print String$(level,9) &amp; rs!EmpID &amp; " " &amp; rs! _
                 [first name]&amp; " "; rs![last name]
           bm = rs.BookMark   ' Save place in the recordset.
           List_Employees rs, rs!EmpID, level + 1
           rs.BookMark = bm   ' Return to proper place for this level.
           rs.MoveNext
         Loop

      End Sub

</PRE><P><LI>To test this function, type the following line in the Immediate window,
   and then press ENTER:
<P>
<P><PRE>      ? Start_List(2)
</PRE><P>
   Note that the records from the Employees2 table are displayed in a tree
   format of managers and employees as follows:
<P>
<P><PRE>      2 Andrew Fuller
<PRE></PRE>            1 Nancy Davolio
            3 Janet Leverling
                    11 Tim Smith
                    12 Caroline Patterson
            4 Margaret Peacock
            5 Steven Buchanan
                    6 Michael Suyama
                    7 Robert King
                    9 Anne Dodsworth
            8 Laura Callahan
            10 Albert Hellstern
            13 Justin Brid
                    14 Xavier Martin

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 11, "Working
With Sets of Records," pages 242-267
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: recursive re-enterable re-entry bill of material<BR>
Keywords            : kbprg PgmHowTo PgmLoop PgmPrcs<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
