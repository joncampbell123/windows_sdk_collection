

<HTML>
<HEAD>
<TITLE>ACC: Connecting to SYBASE SQL Server from an ODBC Application </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q101073">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1993/07/04">
<META NAME="Keywords" CONTENT="kb3rdparty kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  You can connect to a SYBASE SQL Server computer from an ODBC application (such as Microsoft Access, Microsoft Visual Basic, or Microsoft FoxPro for Windows) using the ODBC S...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAA1,QDI2,QA9E,QA1S,QAJW,QAK6,QBTX,QBS0,QBWD,QAVZ,QDN9,QAUJ,QAU9,QAI5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Connecting to SYBASE SQL Server from an ODBC Application</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q101073</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.1, 2.0
<LI>Microsoft Visual Basic version 3.0 for Windows
<LI>Microsoft FoxPro version 2.5 for Windows
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
You can connect to a SYBASE SQL Server computer from an ODBC application
(such as Microsoft Access, Microsoft Visual Basic, or Microsoft FoxPro for
Windows) using the ODBC SQL Server driver. This article describes how to
set up the ODBC data sources.
<P>
If you are already connected to SYBASE SQL Server from Microsoft
Windows DB-Library applications, no other components are necessary.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The key to both Microsoft SQL Server and SYBASE SQL Server
connectivity is a module called the Net-Library. This module consists
of two interfaces: one with the network and one with the application.
The network interface is customized to support a particular network;
however, the application interface remains the same.
<P>
Because ODBC, DB-Library, APT-SQL, APT-Library, and so forth communicate
with the Net-Library, these utilities can be written independent of
the network. The ODBC SQL Server driver, in particular, can be used to
connect either to a Microsoft SQL Server computer or to a SYBASE SQL
Server computer (on a UNIX or VMS system), as long as there is a
Net-Library for whatever network you are using.
<P>
The following paragraphs discuss how to connect to a SYBASE SQL Server
from an ODBC application. The remainder of the article assumes that
you are connected to a SQL Server called "Mysqlsvr." This server
should be set up as an ODBC data source, using the ODBC Control Panel
utility, as follows:

<OL><P><LI>Open ODBC Control Panel and click Add.

<P><LI>Select SQL Server from the list of installed drivers and click OK.

<P><LI>In the ODBC SQL Server Setup dialog box, type a data source name
   and a description (optional).
<P>
   Note that a single server can function as multiple ODBC data
   sources, since each database in the server can be a data source.
   The data source name need not be the same as the server name.

<P><LI>Enter the true name of the server, then enter the network address.
<P>
   Because a SYBASE SQL Server on UNIX uses sockets and not
   named pipes, the network address must contains the IP address and
   the port identification number. This string is in the form
   "ip_address,port" (for example, "11.1.14.40,3180").
<P>
   For a SYBASE SQL Server on a VAX system, this string should be in
   the form "&lt;node address&gt;,&lt;process_id&gt;", where &lt;node address&gt; is the
   DECnet node address of the server and &lt;process_id&gt; is the process
   identification number to use for the connection (for example,
   "1.997,141").
<P>
   The Network Library field should contain the name of the
   Net-Library you need to use. This is dependent on what network you
   are using. For example, if you are using the FTP Software product
   PCTCP, the Net-Library name is "wdbftptc".

<P><LI>Click Options to specify a database name or a language name.

<P><LI>Click OK to go back to the first screen.

<P><LI>Run the INSTCAT.SQL script file.
<P>
   NOTE: This is a file containing SQL statements that will create
   certain stored procedures needed to process ODBC calls. Without
   these procedures, Microsoft Access cannot attach a SQL Server
   table and Visual Basic is not able to function correctly.
<P>
   At the UNIX command line or the MS-DOS prompt, type the following:
<P>
<P><PRE>      isql -S&lt;servername&gt; -Usa -P&lt;sa-password&gt; -i&lt;path&gt;\instcat.sql
</PRE><P>
</OL>Finally, note that if the above procedure is followed correctly, the
following changes appear in the ODBC.INI and WIN.INI files. The [Data
Sources] section of ODBC.INI will contain the following entry:
<P>
<PRE>   &lt;data-source-name&gt;=SQL Server

</PRE></OL>where &lt;data-source-name&gt; is the name of the data source that you
added. There will be a new section called [data-source-name]
containing the location of the SQL Server driver and a description of
the data source. The [SQLSERVER] section of the WIN.INI will contain
the following entry:
<P>
<PRE>   data-source-name=&lt;net-library-name&gt;,&lt;network address&gt;

</PRE>The following products are manufactured by vendors independent of
Microsoft: DECnet, VMS, and MicroVAX by Digital Equipment Corporation;
FTP Software by FTP Software, Inc.; DB-Library, Net-Library, and
SYBASE SQL Server by Sybase, Inc.; and UNIX by UNIX System
Laboratories. We make no warranty, implied or otherwise, regarding
these products' performance or reliability.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about setting up Microsoft Access to use SQL
databases, see Microsoft Access "User's Guide," version 2.0, Chapter 1,
"Setting Up Microsoft Access," page 8
<P>
For more information about installing stored procedures using the Microsoft
Access Help menu, make sure you have set up a SQL Server datasource using
the ODBC Administrator in the Windows Control Panel. Then, search for
"Sybase SQL Server," and then "Installing ODBC Drivers and setting up Data
Sources." In the Installing ODBC Drivers And Setting Up Data Sources Help
window click the "SQL Server Driver" hotlink. In the  SQL Server Driver
Help window click the "Installing the Catalog Stored Procedures" hotlink.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: third-party<BR>
Keywords            : kb3rdparty kbusage OdbcOthr<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
