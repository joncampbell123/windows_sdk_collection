

<HTML>
<HEAD>
<TITLE>ACC95: Error Using Identity Column with Data Outline Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q167854">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1997/04/30">
<META NAME="Keywords" CONTENT="IntpCstm kberrmsg kbinterop OdbcSqlms">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the Data Outline Control 1.1 to view data from a Microsoft SQL Server database, you receive the following error:     One of the specified RecordSources is invalid.  ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIB,QABM,QA7O,QAOE,QAMN,QAB5,QAPN,QA1S,QBWS,QAYY,QBJZ,QDN9,QA2Q,QAB4,QBQU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Error Using Identity Column with Data Outline Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q167854</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 7.0
<LI>Microsoft SQL Server 6.0, 6.5
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the Data Outline Control 1.1 to view data from a Microsoft SQL
Server database, you receive the following error:
<P>
<PRE>   One of the specified RecordSources is invalid.

</PRE><h2>CAUSE</h2>
 
<P>
The RecordSource property for one or more levels of the Data Outline
Control contains an Identity column from the SQL Server table. An Identity
column is similar to an AutoNumber field in Microsoft Access.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are two methods to work around this problem. You can change the
RecordSource property so it does not include the Identity column, or you
can base the RecordSource on a SQL pass-through query.
<P>
<P><h3>Method 1: Change the RecordSource</h3>
 
<P>
Change the RecordSource property in the Data Outline Control to eliminate
the Identity column; you must change the RecordSource property for any
level in the Data Outline control that contains an Identity column.
<P>
For example, if you only need to see the job_desc, min_lvl, and max_lvl
fields from the Jobs table in the Pubs sample database, set the
RecordSource property to:
<P>
<PRE>   SELECT job_desc, min_lvl, max_lvl FROM dbo_jobs

</PRE><h3>Method 2: Use a SQL Pass-Through Query</h3>
 
<P>
Change the RecordSource property so it uses a SQL pass-through query. This
allows you to use the Identity column in your Data Outline Control. Be sure
to include all the fields you need for your Data Outline Control level in
the SQL pass-through query.
<P>
For more information about creating and using SQL pass-through queries,
search the Help Index for "pass-through queries."
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: The error also occurs with the Data Outline Control 1.2 for Microsoft
Access 97. That version of the control is provided by Microsoft as-is, and
is not supported by Microsoft Technical Support. However, the resolution in
this article also works with the Data Outline Control 1.2. For more
information about obtaining the Data Outline Control 1.2, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q162359.htm">Q162359</A></B>
   TITLE     : ACC97: Access 97 Data Outline ActiveX Control Available on
               MSL

</PRE><h3>Steps to Reproduce Problem</h3>
 
<P>
NOTE: These steps assume you have access to the Pubs database included with
Microsoft SQL Server.

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>On the File menu, point to Get External Data, and then click Link
    Tables.

<P><LI>In the Link dialog box, select ODBC Databases() in "Files of type."

<P><LI>In "Select Data Source", select an SQL Server data source, and then
    click OK.

<P><LI>Type your Login ID and Password in "SQL Server Login", and
    then click Options.

<P><LI>Select (or type) Pubs in the Database box, and then click OK.

<P><LI>Select the dbo.jobs table in Link Tables, and then click OK.

<P><LI>Create a new, unbound form in Design view.

<P><LI>On the Insert menu, click Custom Control.

<P><LI>In "Insert OLE Custom Controls", select Data Outline Control 1.1,
    and then click OK.

<P><LI>On the Edit menu, point to Data Outline Control 1.1 Object, and then
    click Properties.

<P><LI>Click the Level One tab, and then type "SELECT * FROM dbo_jobs"
    (without the quotation marks) in the RecordSource property.

<P><LI>Type "job_desc;min_lvl;max_lvl" (without the quotation marks) in the
    DisplayFields property, and then click OK.

<P><LI>Switch the form to Form view, and note that you receive the error
    message.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words:ADT ODE OLE ActiveX<BR>
Keywords            : IntpCstm kberrmsg kbinterop OdbcSqlms<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
