

<HTML>
<HEAD>
<TITLE>ACC: Unexpected Stored Procedures Found in SysObjects Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96898 ">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1993/03/30">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Unexpected stored procedures with the general format ODBC#          nnnnnnn are found when you query the SysObjects table in SQL Server. For example, if you issue the follow...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA9E,QAB9,QA9N,QAS1,QAEF,QACI,QA1S,QAGB,QBCT,QAPN,QAGC,QDKD,QDN9,QDNQ,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Unexpected Stored Procedures Found in SysObjects Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96898 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Unexpected stored procedures with the general format ODBC#&lt;login ID&gt;nnnnnnn
are found when you query the SysObjects table in SQL Server. For example,
if you issue the following query from SQL Administrator Facility (SAF)
<P>
<PRE>   SELECT * FROM SysObjects WHERE Name LIKE "ODBC%"

</PRE>you see stored procedures such as:
<P>
<PRE>   ODBC#sa24518
   ODBC#sa2334
   ODBC#sa17854

</PRE>This article describes what these stored procedures are and how to delete
them.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When Microsoft Access runs a parameter query, it calls the ODBC function
SQLPrepare(), which creates and compiles stored procedures. These stored
procedures pass the proper parameter arguments to ensure proper execution
of the query.
<P>
These stored procedures are normally deleted once the ODBC connection is
closed. However, if any action, including the following, causes the ODBC
connection to be dropped abnormally, the stored procedures may not be
deleted:
<P>
<PRE>  - The client (Microsoft Access) system is restarted.

  - SQL Server is shutdown using the "with no wait" command.

  - The network connection breaks.

</PRE>You can use SAF to drop the stored procedures manually. The command syntax
is
<P>
<PRE>   DROP PROCedure [owner.]procedure_name[, [owner.]procedure_name...]

</PRE>where procedure_name is the procedure you are removing. For example
<P>
<PRE>   DROP PROC ODBC#sa24518, ODBC#sa2334

</PRE>removes two stored procedures, ODBC#sa24518 and ODBC#sa2334.
<P>
If there are a number of stored procedures to delete, you can automate the
process somewhat by using SQL Server to create a script to issue the DROP
PROC statements.
<P>
The example below assumes that you have a number of stored procedures
created by a user logged in as "Joe." To delete them:

<OL><P><LI>Create a file called DROP_GEN.SQL:
<P>
<P><PRE>      use &lt;dbname&gt;
      go
      select char(13) + char(10) + "go" +
<PRE></PRE>         char(13) + char(10)+ "drop procedure " + name +
         char(13) + char(10) + "go" +
         char(13) + char(10)
      from sysobjects
      where name like "ODBC%"
      go

     NOTE: By adding the GO statement before and after the drop
     statement, you eliminate the need to edit the output file of the
     column header information.

</PRE><P><LI>Run this script using ISQL:
<P>
<P><PRE>      ISQL -S&lt;server&gt; -Usa -P&lt;password&gt; -iDROP_GEN.SQL -oDROPPROC.SQL
</PRE>
<P><LI>This creates an output file containing:
<P>
<P><PRE>      1&gt; 2&gt; 1&gt; 2&gt; 3&gt; 4&gt; 5&gt; 6&gt; 7&gt;
      ----------------------------
      go
      drop procedure odbc#JOE61375
      go
</PRE><P>
<P><PRE>      go
      drop procedure odbc#JOE65224
      go
</PRE><P>
<P><PRE>      go
      drop procedure odbc#JOE67088
      go
</PRE><P>
<P><PRE>      go
      drop procedure odbc#JOE69907
      go
</PRE>
<P><LI>Finally, run the output file generated in step 3 through ISQL to drop
   the procedures:
<P>
<P><PRE>      ISQL -S&lt;server&gt; -Usa -P&lt;password&gt; -iDROPPROC.SQL
 </BLOCKQUOTE>


	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage OdbcOthr<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
