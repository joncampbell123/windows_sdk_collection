

<HTML>
<HEAD>
<TITLE>ACC: How to Create and Use Subqueries </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q114678">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1994/05/10">
<META NAME="Keywords" CONTENT="kbusage QryOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Microsoft Access supports the use of subqueries. A subquery is a select query inside another select or action query that acts as a criterion for a field. A subquery can refer to ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA2Q,QAPF,QAPN,QA7O,QA7N,QAG2,QA1S,QAY2,QBWS,QACF,QAEN,QDN9,QBBI,QAUD,QBLI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create and Use Subqueries</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q114678</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Microsoft Access supports the use of subqueries. A subquery is a select
query inside another select or action query that acts as a criterion for a
field. A subquery can refer to a table that is part of the current query,
or to a table that is not part of the current query. Union and crosstab
queries are not supported as subqueries.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a subquery, enter a valid SQL SELECT statement in the Criteria
cell of the field whose value will be compared with the value selected in
the subquery. The field that the criterion is specified for and the field
that is being selected in the subquery must be of the same data type. You
can also have a subquery in the Field row of the query grid, although it is
not recommended.
<P>
A correlated subquery is one in which a column from a table specified in
the FROM clause of the main query is used in the WHERE clause of the
subquery, as demonstrated in the following example:
<P>
<PRE>   SELECT * FROM Table1 WHERE FirstName IN (SELECT FirstName FROM Table2
   WHERE Table2.LastName=Table1.LastName);

</PRE>Another way to tell if a subquery is a correlated subquery is that if the
subquery statement couldn't be used by itself as a separate query. In the
example above it wouldn't know what Table1.LastName was.
<P>
The following example demonstrates how to create a subquery:

<OL><P><LI>Open the sample Northwind.mdb database (or NWIND.MDB in version 2.0).

<P><LI>Create a new query and add the Products table.

<P><LI>Add the ProductName and UnitPrice fields to the query grid.
<P>
   NOTE: In version 2.0, there is a space in Product Name and
   in Unit Price.

<P><LI>Create the subquery by entering the following SQL SELECT statement
   in the Criteria cell of the UnitPrice field.
<P>
   NOTE: In the following statement, an underscore (_) is used as a line-
   continuation character. Remove the underscore from the end of the line
   when re-creating this statement.
<P>
<P><PRE>      &lt;=(SELECT [UnitPrice] FROM [Products] WHERE [ProductName]= _
<PRE></PRE>         "Filo Mix")

</PRE><P><LI>Run the query. Note that the query returns the products whose unit
   prices are less than or equal to the unit price for Filo Mix.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating subqueries, search the Help Index for
"Subqueries," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sub-select<BR>
Keywords            : kbusage QryOthr<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
