

<HTML>
<HEAD>
<TITLE>ACC: How to Buffer SQL Strings Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q98668 ">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1993/05/11">
<META NAME="Keywords" CONTENT="IntpDde kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Access can handle SQL strings larger than 255 characters through dynamic data exchange (DDE). To do this, break the SQL string into portions with fewer than 255 ch...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVP,QA1S,QAH4,QBWS,QDN9,QATX,QABM,QBUG,QBUF,QBLX,QAZ2,QAUD,QBSO,QAG2,QDNZ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Buffer SQL Strings Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q98668 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access can handle SQL strings larger than 255 characters through
dynamic data exchange (DDE). To do this, break the SQL string into portions
with fewer than 255 characters, and then send these strings to Microsoft
Access using DDE. The separate portions are buffered until a semicolon is
sent; at that point, Microsoft Access runs the query.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following steps demonstrate how to create a DDE macro in Microsoft
Excel:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open a new macro sheet in Microsoft Excel. Enter the following
   macro:
<P>
<PRE>      Cell    Command
      --------------------------------------------------
      B1      SQLDDEExample
      B2
      B3      chan=INITIATE("MSACCESS","nwind.mdb;SQL")
      B4      =POKE(chan,"SQLText",C3)
      B5      =POKE(chan,"SQLText",C4:C5)
      B6      QueryResult=REQUEST(chan,"All")
      B7      =TERMINATE(chan)
      B8      =FOR("FldPos",1,COLUMNS(QueryResult))
      B9      =FOR("RecPos",1,ROWS(QueryResult))
      B10     =FORMULA(INDEX(QueryResult,RecPos,FldPos),
                  OFFSET(C7,RecPos,FldPos))
      B11      =NEXT()
      B12      =NEXT()
      B13      =RETURN()

</PRE><P><LI>Enter the following pieces of the SQL string on the macro sheet:
<P>
<PRE>      Cell     Command
      -------------------------------------------
      C3        SELECT * From categories
      C4         ORDER BY categories.[category id]
      C5         DESC;

   NOTE: Be sure to include one space in front of the words "ORDER"
   and "DESC" in the step above.

</PRE><P><LI>To run the macro, select cell B3, choose Run from the Macro menu,
   and choose OK. The query then runs.
<P>
</OL>The results of the query are placed in cells D8:G16 on the Microsoft
Excel macro sheet.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: queries sql dde<BR>
Keywords            : IntpDde kbinterop<BR>
Version             : 1.10 2.00<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
