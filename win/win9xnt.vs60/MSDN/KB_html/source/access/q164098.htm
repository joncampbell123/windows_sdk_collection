

<HTML>
<HEAD>
<TITLE>ACC: Lookup Wizard Fails with Certain Data Types in Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164098">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1997/02/21">
<META NAME="Keywords" CONTENT="kberrmsg kbusage TblFldp">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the Lookup Wizard in Design view of a table to look up a Currency, Date/Time, or Hyperlink field in another table, you may receive the following error messages:     ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QA7N,QAP2,QAKC,QBWS,QBC6,QAIK,QDMP,QAUM,QAE1,QAYY,QAB4,QDMN,QAPN,QAG8 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Lookup Wizard Fails with Certain Data Types in Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164098</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the Lookup Wizard in Design view of a table to look up a
Currency, Date/Time, or Hyperlink field in another table, you may receive
the following error messages:
<P>
<PRE>   You entered an expression that has an invalid reference to the
   property |.

</PRE>and then
<P>
<PRE>   Microsoft Access couldn't launch the LookUp Wizard.

</PRE><h2>CAUSE</h2>
 
<P>
The Currency, Date/Time, and Hyperlink data types do not contain a Display
Control property. When you use one of those data types as the bound column
in your lookup field, the Lookup Wizard sets your lookup field to the same
data type and tries to set the Display Control property for that field.
<P>
The error occurs with the Lookup Wizard under the following conditions:

<UL><LI>If the table you are looking up does not have a primary key field,
   and the bound field you select in the Lookup Wizard is of data type
   Currency, Date/Time, or Hyperlink.

<LI>If the table you are looking up has a multi-field primary key, and the
   bound field you select in the Lookup Wizard is of data type Currency,
   Date/Time, or Hyperlink.

<LI>If the primary key in the table you are looking up is of data type
   Currency or Date/Time; Microsoft Access does not allow you to create
   a primary key with a Hyperlink data type.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
You can work around this behavior in two ways:

<UL><LI>You must include a field of data type Text, Number, or Yes/No as the
   bound column for the lookup field in your table because those data
   types have a Display Control property.

<LI>If you are trying to look up a Currency field, you can manually create
   the lookup field using a Double Number field instead of Currency.
<P>
</UL><h3>Method 1: Include a Text, Number, or Yes/No Field as the Bound Column</h3>
 
<P>
The following example shows how you can use the Lookup Wizard to display a
Currency field by adding a second field of data type Text, Number, or
Yes/No as the bound column:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new table in Design view:
<P>
<P><PRE>      Table: LookupCurrency
      ---------------------------
      Field Name: ID
<PRE></PRE>         Data Type: AutoNumber
      Field Name: UnitPrice
         Data Type: Lookup Wizard

      Table Properties: LookupCurrency
      --------------------------------
      PrimaryKey: ID

</PRE><P><LI>In the Lookup Wizard dialog box, click "I want the lookup column to
   look up the values in a table or query," and then click Next.

<P><LI>In the "Which table or query should provide the values for your lookup
   column?" dialog box, click Order Details, and then click Next.

<P><LI>In the "Which fields contain the values you want included in your
   lookup column?" dialog box, add OrderID and UnitPrice to the Selected
   Fields box, and then click Next. OrderID is a Number field, and
   UnitPrice is a Currency field.

<P><LI>In the "How wide would you like the columns in your lookup column?"
   dialog box, point to the right border of the OrderID column heading
   until your pointer changes to a cross with arrows pointing left and
   right. Then drag the column border to the left until the column
   disappears. Click Next.

<P><LI>In the "Choose a field that uniquely identifies the row" dialog box,
   click OrderID, and then click Finish.

<P><LI>Click Yes when you see the message that the table must be saved before
   relationships can be created. Save the table as LookupCurrency.

<P><LI>Switch the table to Datasheet view. Note that the combo box in the
   UnitPrice field displays Currency values from the Order Details table.
   However, the data that is actually stored in that field is the OrderID
   because OrderID is the bound column.
<P>
</OL>If you repeat steps 1-9, but omit the OrderID field (a Number field) in
step 5, you receive the error message mentioned in the "Symptoms" section.
<P>
<P><h3>Method 2: Use a Double Number Field to Look Up Currency</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new table named Table1:
<P>
<P><PRE>      Table: Table1
      -------------------------------
      Field Name: Fields ID
<PRE></PRE>         Data Type: AutoNumber
         Indexed: Yes (No Duplicates)
      Field Name: Field1
         Data Type: Number
         Field Size: Double
         Format: $#,##0.00

</PRE><P><LI>Click the Lookup Tab for Field1 and change the Display Control property
   to Combo Box.

<P><LI>Click in the RowSource property builder.

<P><LI>Select the Order Details Table to Lookup data from.

<P><LI>Drag the Unit Price field to the query grid.

<P><LI>Close the query, and then close and save the table. Click No to the
   prompt "Do you want to create a primary key?"

<P><LI>Open the Table1 table in Datasheet view. Note that you are able to
   look up Currency data in the Field1 field.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 7.0
and 97. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb. You may want to back up the Northwind.mdb file
and perform these steps on a copy of the database.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new table named Table1.
<P>
<P><PRE>      Table: Table1
      -------------------------------
      Field Name: Fields ID
<PRE></PRE>         Data Type: AutoNumber
         Indexed: Yes (No Duplicates)
      Field Name: Field1
         Data Type: Lookup Wizard

</PRE><P><LI>Select the default option to look up values in a table.

<P><LI>Select the Order Details table in the "Which table or query should
   provide the values for your lookup column?" dialog box.

<P><LI>Select the UnitPrice field in the "Which fields contain the values you
   want included in your Lookup column?" dialog box.

<P><LI>Note that when you click Finish on the last screen of the wizard, you
   receive the error message mentioned in the "Symptoms" section.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage TblFldp<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
