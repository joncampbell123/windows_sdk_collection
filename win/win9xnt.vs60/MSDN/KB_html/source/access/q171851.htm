

<HTML>
<HEAD>
<TITLE>ACC97: Action Query Still Commits Changes to Data When Cancelled </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q171851">
<META NAME="KBModify" CONTENT="1997/07/29">
<META NAME="KBCreate" CONTENT="1997/07/23">
<META NAME="Keywords" CONTENT="GnlMu QryAppnd QryDel QryMktbl QryUpdat EvnNtw kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  An action query always commits changes to data in a table. This occurs even if you click No when Microsoft Access prompts you to commit the changes.  CAUSE =====  The actio...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAXB,QBWS,QBXS,QA5V,QACF,QAC1,QA1S,QAGC,QDN9,QBD2,QAZV,QAGB,QBWC,QADK P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Action Query Still Commits Changes to Data When Cancelled</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q171851</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
An action query always commits changes to data in a table. This occurs even
if you click No when Microsoft Access prompts you to commit the changes.
<P>
<P><h2>CAUSE</h2>
 
<P>
The action query's UseTransaction property is set to No.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Set the UseTransaction property to Yes before running the action query.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The UseTransaction property specifies whether an action query runs as a
single transaction. When the UseTransaction property is set to Yes, the
query results are stored in a cache or temporary database and are not
written into the current database until you confirm that you want to commit
the changes. When the UseTransaction property is set to No, the results are
written immediately to the current database; the query runs much faster
because it is not wrapped in a single transaction. However, you cannot
cancel the changes that the query has made, even if you click No when
prompted to commit the changes.
<P>
If you create a query in the Microsoft Access user interface by opening a
new query in Design view, the default value of the UseTransaction property
is Yes. However, when you use data access objects (DAO) to create a
QueryDef in Visual Basic for Applications code, the default value of the
UseTransaction property is No.
<P>
In the following example, the procedure CreateTransQuery creates an action
query whose UseTransaction property is set to Yes:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function CreateTransQuery()
</PRE><P>
<PRE>         Dim db As Database
         Dim qd As QueryDef
         Dim prpUseTrans As Property
         Dim strSQLString As String

         strSQLString = "UPDATE Categories SET Categories.CategoryName"
         strSQLString = strSQLString &amp; " = 'Drinks' WHERE"
         strSQLString = strSQLString &amp; " Categories.CategoryID = 1;"
         Set db = CurrentDb
         Set qd = db.CreateQueryDef("qryUseTransTest", strSQLString)
         Set prpUseTrans = qd.CreateProperty("UseTransaction", _
            dbBoolean, True)
         qd.Properties.Append prpUseTrans

      End Function

</PRE></OL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Customers table and view the first record. Note that it
   contains the following data:
<P>
<PRE>      CustomerID:    CompanyName:
      -----------    --------------------
      ALFKI          Alfred's Futterkiste

</PRE><P><LI>Close the table. Then, create a new update query based on the Customers
   table, and add the following fields:
<P>
<P><PRE>      Query: qryUpdateCustomers
      ----------------------------
      Type: Update Query
</PRE><P>
<P><PRE>      Field: CustomerID
<PRE></PRE>         Criteria: "ALFKI"
      Field: CompanyName
         Update To: "Alfred's Co."

</PRE><P><LI>Click anywhere in the upper portion of the QBE grid. Then, on the View
   menu, click Properties to view the query's property box.

<P><LI>Set the UseTransaction property to No.

<P><LI>On the Query menu, click Run. Note that you receive the message:
<P>
<P><PRE>      You are about to update 1 row(s).
</PRE><P>
<P><PRE>      Once you click Yes, you can't use the Undo command to reverse the
      changes. Are you sure you want to update these records?
</PRE>
<P><LI>Click No, indicating that you do not want to commit the changes.

<P><LI>Close the query and save it as qryUpdateCustomers.

<P><LI>Open the Customers table, and view the first record. Note that now the
   data in the CompanyName field contains "Alfred's Co."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the UseTransaction property, search the Help
Index for "UseTransaction property."
 
<PRE>Keywords          : GnlMu QryAppnd QryDel QryMktbl QryUpdat EvnNtw kbusage
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
