

<HTML>
<HEAD>
<TITLE>ACC97: Can't Update Recordset After Refreshing Linked Table </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165352">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="IntpOthr IsmProb kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  After you refresh the link to a linked table using the Linked Table Manager Wizard, you cannot update data in a form based on that table the first time you open it. You rec...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QBWS,QBD2,QAC1,QBS0,QAE2,QAAW,QAGB,QA1S,QDN9,QAA5,QBQU,QBJZ,QA2O,QABA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Can't Update Recordset After Refreshing Linked Table</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165352</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
After you refresh the link to a linked table using the Linked Table Manager
Wizard, you cannot update data in a form based on that table the first time
you open it. You receive a message that you cannot update the data.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This behavior only occurs if:

<UL><LI>You use the Linked Table Manager to refresh the link to a linked
   table.

<LI>You open a form based on the linked table that has its RecordsetType
   property set to Snapshot.

<LI>You open another recordset based on the same table using a form or
   Visual Basic code and try to add or update a record.
<P>
</UL>To resolve this problem, close all recordsets based on the table, and then
reopen them. For example, close the form with the snapshot-type recordset,
close the form with which you are trying to update the recordset, and then
reopen them both.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you try to update data using a form, you receive the message:
<P>
<PRE>   This Recordset is not updatable.

</PRE>If you try to update data using Visual Basic code, you receive the message:
<P>
<PRE>   Run-time error '3027':
   Can't update. Database or object is read-only.

</PRE>This problem occurs the first time you open the form with the snapshot-type
recordset and try to update the recordset while the form is open. This
includes updating the table directly or using a form or Visual Basic code.
Even if you have previously edited the data or if you quit and restart
Microsoft Access, the first time you open the snapshot-type form this
behavior is exhibited.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Access and create a new database named TestUpdate.mdb.

<P><LI>On the File menu, point to Get External Data, and then click Link
   Tables.

<P><LI>In the Link dialog box, locate and select the sample database
   Northwind.mdb, and then click Link.

<P><LI>In the Link Tables dialog box, select the Customers table, and then
   click OK.

<P><LI>Create a new form based on the linked Customers table using the
   AutoForm: Columnar Wizard.

<P><LI>Switch the form to Design view.

<P><LI>Set the form's RecordsetType property to Snapshot.

<P><LI>Save the form as frmReadOnly, and then close it.

<P><LI>Use the AutoForm: Columnar Wizard to create another new form based on
   the Customers table.

<P><LI>Save the form as frmUpdate, and then close it.

<P><LI>On the Tools menu, point to Add-Ins, and then click Linked Table
<P><PRE>    Manager.
</PRE>
<P><LI>In the Linked Table Manager dialog box, click to select the check box
<P><PRE>    next to the Customers table, and then click OK.
</PRE>
<P><LI>Click OK when you receive the message that the table was successfully
<P><PRE>    refreshed, and then click Close in the Linked Table Manager dialog box.
</PRE>
<P><LI>Open the frmUpdate form, change some data, and then close the form.

<P><LI>Open the frmReadOnly form, and then minimize it.

<P><LI>Open the frmUpdate form again and try to update a record. Note that you
<P><PRE>    receive the message "This Recordset is not updatable." If you close
    both forms and reopen them, you will be able to update data using the
    frmUpdate form.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about Snapshot-type recordsets, search the Help Index
for "snapshot-type Recordset objects."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional reference words: attach attached<BR>
Keywords            : IntpOthr IsmProb kberrmsg<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
