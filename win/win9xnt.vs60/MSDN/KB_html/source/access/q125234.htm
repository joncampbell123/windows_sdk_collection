

<HTML>
<HEAD>
<TITLE>ACC2: Group KeepTogether Does Not Apply to Multi-Column Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125234">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1995/01/23">
<META NAME="Keywords" CONTENT="kbusage RptLayou">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The group KeepTogether property does not apply to multiple-column reports as the  Creating Snaking Columns on a Report  online Help topic suggests. The Help topic states, in part...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAPN,QBXS,QAOX,QBVV,QAE1,QBJZ,QA1S,QDMN,QDIZ,QBWC,QAB9,QA4C,QAHP,QDN9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Group KeepTogether Does Not Apply to Multi-Column Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125234</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The group KeepTogether property does not apply to multiple-column reports
as the "Creating Snaking Columns on a Report" online Help topic suggests.
The Help topic states, in part:
<P>
<PRE>   To keep the first detail record with the group header, in the Sorting
   And Grouping box, set the KeepTogether Property--Groups for the group
   header to With First Detail.

</PRE>This statement is incorrect.
<P>
<P><h2>CAUSE</h2>
 
<P>
In a multiple-column report, the group KeepTogether property applies to the
entire page, not to the individual columns.
<P>
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To avoid an abandoned group header at the bottom of a column, or to prevent
a group header from being printed beyond a certain position on the page,
use the following sample procedure as the event procedure for the group
header's OnPrint property. Modify the expression "(5 * 1440)" in the
procedure with the value beyond which you do not want a group header to be
printed. Note that the expression "(5 * 1440)" equates to 5 inches, because
there are 1440 twips in an inch. The sample procedure tests the report's
Top property (the position where the report will be printed) and if the
condition is true, causes the report not to be printed at that position but
instead moves down the page until the condition is false, which occurs at
the top of the next page. By default, the report's NextRecord and
PrintSection properties are set to True after each attempt to print a
section.
<P>
<PRE>   Sub GroupHeader3_Print (Cancel As Integer, PrintCount As Integer)

   If Me.Top &gt; (5 * 1440) Then
      Me.NextRecord = False
      Me.PrintSection = False
   End If

   End Sub

</PRE>Note that this procedure works well if the Item Layout option in the Print
Setup dialog box for the columns is set to Vertical. If the Item Layout
option is set to Horizontal, you may want to set the NewRowOrCol property
for the group header section to Before &amp; After.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft Access version 7.0 includes a new report GrpKeepTogether
property that specifies whether groups that have their KeepTogether
property set to 'With First Detail' or 'Whole Group' will be kept together
by page or column.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB, and then open the Customer
   Mailing Labels report in Design view.

<P><LI>From the View menu, choose Sorting And Grouping. In the Sorting And
   Grouping dialog box, set the Country field's GroupHeader property
   to Yes. Close the Sorting And Grouping dialog box.

<P><LI>Add a text box with the following properties to the Country group
   header section:
<P>
<P><PRE>      ControlSource: Country
      FontSize: 12
      FontWeight: Bold
</PRE>
<P><LI>Preview the report. Choose OK in the Country Filter dialog box. Note
   that the group header for Canada is printed at the bottom of the first
   column.

<P><LI>From the File menu, choose Print Setup. Choose the More button and
   then in the Item Layout box choose the Vertical option button.
   Preview the report and note that the UK group header is printed
   at the bottom of the column on page 4.
<P>
</OL>To prevent abandoned group headers in this multiple-column report, use the
sample procedure described above in the Country group header's OnPrint
property.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the GrpKeepTogther Property, search for
"GrpKeepTogether Property" using the Microsoft Access for Windows 95 Help
Index.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: multiple column keep together<BR>
Keywords            : kbusage RptLayou<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbdocerr<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
