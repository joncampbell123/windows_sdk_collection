

<HTML>
<HEAD>
<TITLE>ACC2: Grouping Records into Sets of Records Using a Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132138">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1995/06/29">
<META NAME="Keywords" CONTENT="kbusage QryTotal">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  This article demonstrates a method that you can use to create a report that groups records into sets of records according to a user-supplied number. To demonstrate this method, this article uses the Orders Details table in the sample database NWIND...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QAY5,QAKD,QAKC,QABO,QDN9,QAB9,QBV8,QDMH,QBXS,QASR,QAMA,QBC6,QA5F V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Grouping Records into Sets of Records Using a Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132138</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
This article demonstrates a method that you can use to create a report that
groups records into sets of records according to a user-supplied number. To
demonstrate this method, this article uses the Orders Details table in the
sample database NWIND.MDB to create groupings of 100 records. In each set
of 100 records, the Quantity fields are summed into one value. In your own
reports, you can change the grouping value to any number you want.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To create a report that creates groupings of a specific number of records,
follow these steps.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Create a new module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
      Dim MyVal As Long, MyValSort As Long
</PRE>
<P><LI>Type the following two functions:
<P>
<P><PRE>      ' ******************************************************
      ' Function: SetGroupLevel
      '
      ' Purpose: This function creates groups of records
<PRE></PRE>      '          containing n records. The n is defined
      '          by the Const MyIncNum statement.
      ' ******************************************************

      Function SetGroupLevel (pId As Variant) As Integer

      ' Set the value for the number of records to group.
      Const MyIncNum = 100

      ' Compare the value of MyVal to the custom value
      ' and if true, increment the group value by one.
      If MyVal = MyIncNum Then
         MyValSort = MyValSort + 1
         MyVal = False
      End If

      ' Continue to increment counter.
      MyVal = MyVal + 1

      ' Pass back the custom group value to query.
      SetGroupLevel = MyValSort

      End Function

      ' ******************************************************
      ' Function: SetGroupLevelReset
      '
      ' Purpose: This function is called to reset the counter
      '          values used in the SetGroupLevel() function.
      ' ******************************************************
      Function SetGroupLevelReset () As Integer
         MyVal = False
         MyValSort = False
      End Function

</PRE><P><LI>Create a new query as follows, and add the Order Details table:
<P>
<P><PRE>      Query: TestGroupLevel
      ---------------------
      Type: Totals Query
<PRE></PRE>         Field: Quantity
         Table: Order Details
         Total: Sum
      Field: MyGroup: SetGroupLevel([Quantity])
         Total: Group By

</PRE><P><LI>Save and close the TestGroupLevel query.

<P><LI>Create the following macro to show the results:
<P>
<PRE>      Macro Name             Actions
      -------------------------------
      TestGroupLevelMacro    RunCode
                             OpenQuery

      TestGroupLevelMacro Actions
      --------------------------------------
      RunCode
         Function Name: SetGroupLevelReset()
      OpenQuery
         Query Name: TestGroupLevel
         Data Mode: Add

</PRE><P><LI>To test the results, run the TestGroupLevelMacro macro. Note that the
   following results are displayed after the TestGroupLevel query runs:
<P>
<P><PRE>      SumOfQuantity  MyGroup
      ----------------------
<PRE></PRE>      2187           0
      2248           1
      2175           2
      2262           3
      1799           4
      2307           5
      2363           6

</PRE></OL>The results display the sum of the values in the Quantity field in each set
of 100 records. To change the grouping value, change the value of the Const
MyIncNum statement in the SetGroupLevel() function.
<P>
NOTE: Keep in mind that the last row will be the remainder of available
records minus the number you specify for the MyIncNum variable. Note that
this example shows 2150 records producing 20 rows of 100 records and that
the final row consists of the remaining 50 records.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 5, "Access
Basic Fundamentals"
<P>
For more information about dynamic query numbering, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q94397.htm">Q94397</A></B>
   TITLE     : ACC: Adding a Dynamic Counter to a Query to Count Records
              (1.x, 2.0)
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QryTotal<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
