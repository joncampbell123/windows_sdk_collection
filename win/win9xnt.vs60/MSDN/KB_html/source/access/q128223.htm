

<HTML>
<HEAD>
<TITLE>ACC2: OnFormat Event Procedure Triggered Too Early </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128223">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1995/03/28">
<META NAME="Keywords" CONTENT="kbusage RptLayou">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The OnFormat event procedure is triggered on the page before a group header or a group footer section is printed. This problem happens when the ForceNewPage property is set ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAPN,QBTP,QA1S,QBXV,QBXS,QBJZ,QDN9,QAUJ,QAO4,QABH,QDKW,QBCI,QATP,QASR V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: OnFormat Event Procedure Triggered Too Early</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128223</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The OnFormat event procedure is triggered on the page before a group header
or a group footer section is printed. This problem happens when the
ForceNewPage property is set to Before Section to force the section to
print on the next page. For example, the event is triggered on page 1, but
the section prints on page 2.
<P>
<P><h2>CAUSE</h2>
 
<P>
If a group header or group footer section's Height property is set to 0
inches, the OnFormat event property is triggered before the section is
moved to the next page rather than after.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, set the group header or group footer
section's Height property to at least .007 inches.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
2.0. This problem no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The behavior described above can also reset the page number for a group
header or group footer incorrectly.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
CAUTION: Following the steps in the example will modify the sample database
NWIND.MDB. You may want to back up the NWIND.MDB file, or perform these
steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB, and create a new macro as follows:
<P>
<PRE>      Macro Name          Action
      --------------------------
      GroupHeaderFrmt     MsgBox

      GroupHeaderFrmt Actions
      -------------------------------------------
      MsgBox
         Message: =[Category Name] &amp; " " &amp; [Page]

</PRE><P><LI>Open the List Of Products By Category report in Design view.

<P><LI>Move the Category Name text box in the Category Name group header
   section to the detail section.

<P><LI>Set the properties for the Category Name group header section as
   follows:
<P>
<P><PRE>      ForceNewPage: Before Section
      OnFormat: GroupHeaderFrmt
      Height: 0
</PRE>
<P><LI>Preview the report. Note that the message box displays "Beverages1."
<P>
</OL><h3>Steps to Work Around Problem</h3>
 

<OL><P><LI>In step 4 above, increase the Category Name group header section's
   Height property to .007.

<P><LI>Preview the report. Note that no message is displayed until you
   preview page 2.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "User's Guide," version 2.0, Chapter 22, "Sorting and
Grouping Data," pages 547-580
<P>
For more information about sorting and grouping, search for "Sorting and
Grouping," and then "Sorting and Grouping Command (View Menu)" using the
Microsoft Access Help menu.
<P>
For more information about resetting the page number with group headers and
footers, please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q104760.htm">Q104760</A></B>
   TITLE     : ACC: How to Reset the Page Number on Group Level in a Report
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage RptLayou<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
