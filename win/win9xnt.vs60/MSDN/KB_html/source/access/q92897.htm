

<HTML>
<HEAD>
<TITLE>ACC1x: Changing RowSource of a List Box or Combo Box at Run Time </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92897 ">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1992/11/17">
<META NAME="Keywords" CONTENT="FmsCmbo kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The RowSource property for a combo box or list box cannot be modified while the form is active. However, there is a workaround for changing the recordset that the object is bound to. This article discusses that workaround.  MORE INFORMATION  The wo...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBVR,QABH,QABI,QBWS,QA4H,QA2Q,QAW6,QAG2,QAPF,QA1S,QA5V,QANX,QAGI,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Changing RowSource of a List Box or Combo Box at Run Time</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92897 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The RowSource property for a combo box or list box cannot be modified
while the form is active. However, there is a workaround for changing the
recordset that the object is bound to. This article discusses that
workaround.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The workaround for this problem is to bind the object to a query, then
manipulate the query's recordset underneath the object. For example, you
would bind the object to a query called Query1, then create a new query
called Query1 programmatically, while the object is active.
<P>
The following example illustrates this technique. In this example, there
is a combo box bound to data from the Products table in the sample
database NWIND.MDB. By selecting one of two check boxes, the order of
records in the combo box will be changed:

<OL><P><LI>Create a form with an option group control called MyOption, and a
   combo box called MyCombo.

<P><LI>Add two check box controls to MyOption and specify the following
   property:
<P>
<P><PRE>      AfterUpdate: =NewOrder([MyOption])
</PRE>
<P><LI>For MyCombo, specify the following properties:
<P>
<P><PRE>      RowSourceType: Table/Query
      RowSource: DeleteMe
      ColumnCount: 2
      Locked: True
      Enabled: False
</PRE>
<P><LI>Add the following function to a module in the database:
<P>
   NOTE: In the following sample code, an underscore (_) is used as a
   line-continuation character. Remove the underscore when re-creating
   this code in Access Basic.
<P>
<P><PRE>      Option Explicit
      Function NewOrder (WhichSort%)
<PRE></PRE>         DoCmd Hourglass True
         Dim D As Database, Q As QueryDef
         Set D = CurrentDB()

         Screen.ActiveForm!MyCombo.Enabled = True
         Screen.ActiveForm!MyCombo.Locked = False

         On Error Resume Next
         D.DeleteQueryDef ("DeleteMe")
         On Error GoTo 0

         If WhichSort = 1 Then
            Set Q = D.CreateQueryDef("DeleteMe",_
                   "SELECT [Product ID], [Category ID]_
                   FROM Products ORDER BY [Product ID];")
         Else
            Set Q = D.CreateQueryDef("DeleteMe",_
                   "SELECT [Product ID], [Category ID]_
                   FROM Products ORDER BY [Category ID];")
         End If

         Q.Close
         D.Close

         DoCmd Requery "MyCombo"
         DoCmd Hourglass False
      End Function

</PRE><P><LI>Open the form, select one of the check boxes, and open the combo box.
   Note the order of the records in the combo box.

<P><LI>Select the other check box and open the combo box again. Note that the
   records' order has changed.
<P>
</OL>The key to changing the recordset is in Step 4. By using different SELECT
statements for the CreateQueryDef() methods, you can create any kind of
query.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsCmbo kbusage<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
