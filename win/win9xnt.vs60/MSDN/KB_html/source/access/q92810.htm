

<HTML>
<HEAD>
<TITLE>ACC: BeforeUpdate Macro Appears to Be Running Twice </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q92810 ">
<META NAME="KBModify" CONTENT="1997/08/06">
<META NAME="KBCreate" CONTENT="1992/11/16">
<META NAME="Keywords" CONTENT="McrName kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  The BeforeUpdate macro appears to be running twice rather than only once.  CAUSE =====  The BeforeUpdate macro will run whenever an edited record is saved. And if you add r...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAPN,QA1S,QAH4,QA01,QAUR,QBWS,QDN9,QAU7,QBJZ,QAKE,QA33,QAO4,QAGB,QAAW P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: BeforeUpdate Macro Appears to Be Running Twice</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q92810 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
The BeforeUpdate macro appears to be running twice rather than only once.
<P>
<P><h2>CAUSE</h2>
 
<P>
The BeforeUpdate macro will run whenever an edited record is saved. And if
you add records using the Paste Append command, it will run when each of
those records is added. If you find that the BeforeUpdate macro is running
more than once, check to see exactly what actions you are taking.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a macro with a MsgBox action and a CancelEvent action.

<P><LI>Save this macro as Macro1.

<P><LI>Create a form based on any table and add a text box.

<P><LI>Set the form's BeforeUpdate property to the Macro1 macro.

<P><LI>View the form in Form view.

<P><LI>Enter data in a field, and then select the data in that field.

<P><LI>On the Edit menu, click Copy.

<P><LI>On the Edit menu, click Paste Append.

<P><LI>Click OK when the Message box (that you created in the Macro1 macro)
    appears.

<P><LI>Close the form.

<P><LI>Click OK when the Message box (that you created in the Macro1 macro)
    appears.

<P><LI>Click OK when the following error message appears.
<P>
    In Microsoft Access 7.0 and 97:
<P>
       You can't save this object at this time.
       Microsoft Access may have encountered an error while trying to
       save a record. If you close the object now, the changes you made
       will be lost. Do you want to close the database object anyway?
<P>
    In Microsoft Access versions 1.x and 2.0:
<P>
       The record being edited can't be saved. If you close the form,
       the changes you've made to the record will be lost. Close
       anyway?
<P>
</OL>Note that the message box you created in Macro1 reappeared in step 11.
The macro that you assigned to the BeforeUpdate property is running
twice: once when the record that you added using the Paste Append command
is saved, and twice when the edited record is saved.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about form event properties, search the Help Index
for "Events" and then select "Find out when events occur," or ask the
Microsoft Access 97 Office Assistant.
<P>
For more information about form event properties, search the Help Index
for "BeforeUpdate, AfterUpdate Properties," or ask the Microsoft Access 97
Office Assistant.
 
<PRE>Keywords          : McrName kbusage
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
