

<HTML>
<HEAD>
<TITLE>ACC: How to Filter a Report from a Pop-Up Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q147143">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1996/02/20">
<META NAME="Keywords" CONTENT="FmrHowto RptSort kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to filter a report dynamically in Print Preview by selecting filter criteria from a pop-up form.  NOTE: This article explains a technique demonstrated ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QBWS,QBXS,QA1S,QAEF,QAMB,QBRM,QDN9,QA2Q,QAY2,QAFF,QAB9,QA5V,QAUJ,QAO4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Filter a Report from a Pop-Up Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q147143</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to filter a report dynamically in Print Preview
by selecting filter criteria from a pop-up form.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The technique involves creating a pop-up form and a report in the sample
database Northwind. The form enables you to choose which fields and values
to use for filtering a report in Print Preview.
<P>
<P><h3>Creating the Report</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Start the Report Wizard and create a report based on the Customers
    table.

<P><LI>In the "Which fields do you want on your report" box, select the
    following fields, and then click Next:
<P>
       CompanyName
       ContactName
       City
       Region
       Country

<P><LI>In the "Do you want to add any grouping levels?" box, click Next.

<P><LI>In the "What sort order do you want for your records?" box, click Next.

<P><LI>In the "How would you like to layout your report?" box, click Tabular,
    and then click Next.

<P><LI>In the "What style would you like?" box, click Next.

<P><LI>In the "What title do you want?" box, enter "rptCustomers" (without
    the quotation marks). Click "Modify the report's design," and then
    click Finish.

<P><LI>In Design view, display the report's property sheet and set the
    FilterOn property to Yes.

<P><LI>Save and close the report.
<P>
</OL><h3>Creating the Pop-up Form</h3>
 

<OL><P><LI>Create a new form not based on any table or query in Design view with
   the following form properties:
<P>
<P><PRE>      Form: frmFilter
      ---------------------
      ScrollBars: Neither
      RecordSelectors: No
      NavigationButtons: No
      PopUp: Yes
      BorderStyle: Thin
      MinMaxButtons: None
      Width: 2.5"
</PRE>
<P><LI>Set the form's OnOpen property to the following event procedure:
<P>
<P><PRE>      Private Sub Form_Open(Cancel As Integer)
<PRE></PRE>         DoCmd.OpenReport "rptCustomers", A_PREVIEW 'Open Customers report.
         DoCmd.Maximize  'Maximize the report window.
      End Sub

</PRE><P><LI>Set the form's OnClose property to the following event procedure:
<P>
<P><PRE>      Private Sub Form_Close()
<PRE></PRE>         DoCmd.Close acReport, "rptCustomers" 'Close the Customers report.
         DoCmd.Restore  'Restore the window size
      End Sub

</PRE><P><LI>Add the following five combo boxes in the detail section. Place them on
   the form vertically, one below each other:
<P>
   NOTE: In the SQL expressions below, an underscore (_) at the end of
   a line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this expression.
<P>
<P><PRE>      Combo box:
      Name: Filter1
      Tag: CompanyName
      RowSource: Select Distinct [CompanyName] from Customers Order _
<PRE></PRE>                 By [CompanyName];
      Width: 1.5"

      Combo Box:
      Name: Filter2
      Tag: ContactName
      RowSource: Select Distinct [ContactName] from Customers Order _
                 By [ContactName];
      Width: 1.5"

      Combo Box:
      Name: Filter3
      Tag: City
      RowSource: Select Distinct [City] from Customers Order By [City];
      Width: 1.5"

      Combo Box:
      Name: Filter4
      Tag: Region
      RowSource: SELECT DISTINCT Customers.Region FROM Customers _
                     WHERE(((Customers.Region) Is Not Null)) ORDER BY _
                     Customers.Region;
      Width: 1.5"

      Combo Box:
      Name: Filter5
      Tag: Country
      RowSource: Select Distinct [Country] from Customers Order _
                     By [Country];
      Width: 1.5"

</PRE><P><LI>Add the following command button to your form, which will enable you to
   reset the values in the form's combo boxes and check boxes:
<P>
<P><PRE>      Command button:
      Name: Clear
      Caption: Clear
      OnClick: [Event procedure]
</PRE><P>
<P><PRE>      Set the OnClick [Event procedure] as follows:
</PRE><P>
<P><PRE>      Private Sub Clear_Click()
<PRE></PRE>         Dim  intCounter as Integer
         For intCounter = 1 To 5
         Me("Filter" &amp; intCounter) = ""
         Next
      End Sub

</PRE><P><LI>Add a second command button to your form:
<P>
<P><PRE>      Command Button:
      Name: Set Filter
      Caption: Set Filter
      OnClick: [Event procedure]
</PRE><P>
<P><PRE>      Set the OnClick [Event procedure] as follows:
</PRE><P>
<P><PRE>      Private Sub Set_Filter_Click()
<PRE></PRE>        Dim strSQL as String, intCounter as Integer
        ' Build SQL String.
        For intCounter = 1 To 5
          If Me("Filter" &amp; intCounter) &lt;&gt; "" Then

             strSQL = strSQL &amp; "[" &amp; Me("Filter" &amp; intCounter).Tag &amp; "] " _
             &amp; " = " &amp; Chr(34) &amp; Me("Filter" &amp; intCounter) &amp; Chr(34) &amp; " _
             And    "
          End If
        Next

        If strSQL &lt;&gt; "" Then
        ' Strip Last " And ".
          strSQL = Left(strSQL, (Len(strSQL) - 5))
          ' Set the Filter property.
          Reports![rptCustomers].Filter = strSQL
          Reports![rptCustomers].FilterOn = True
        End If
      End Sub

</PRE><P><LI>Add a third command button to your form:
<P>
<P><PRE>      Command Button:
      Name: Close
      Caption: Close
      OnClick: [Event procedure]
</PRE><P>
<P><PRE>      Set the OnClick [Event procedure] as follows:
</PRE><P>
<P><PRE>      Private Sub Close_Click()
<PRE></PRE>         DoCmd.Close acForm, Me.Form.Name
      End Sub

</PRE><P><LI>Close and save the form as frmFilter.
<P>
</OL><h3>Filtering the Report</h3>
 

<OL><P><LI>Open the frmFilter pop-up form in Form view. Note that the rptCustomers
   report opens in Print Preview behind the form and displays all records
   in the Customers table.

<P><LI>In the Region combo box, select "BC," and then click the Set Filter
   button. You should see only the records that contain "BC" in the Region
   field.

<P><LI>Click Clear to reset the report's Filter property.
<P>
</OL>NOTE: To experiment with various combinations of data, you can select an
item from one or more combo boxes and click the Set Filter button. When you
are ready to select different items, first click the Clear button to reset
the report's Filter property before making new choices in the combo boxes.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Filter property, search the Help Index for
"Filter Property," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about filter by form or filter by selection, search
the Help Index for "Filter By Form" or "Filter By Selection," or ask the
Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dynamic popup<BR>
Keywords          : FmrHowto RptSort kbusage<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
