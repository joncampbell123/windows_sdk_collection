

<HTML>
<HEAD>
<TITLE>ACC2: Sample Function to Retrieve File's Date and Time Stamp </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q124392">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1994/12/29">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates a sample user-defined Access Basic function called GetFileDateTime() that you can use to retrieve a file's date and time stamp.  This article assum...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA5F,QAMA,QAH4,QAY5,QATX,QBV8,QACE,QAPF,QAB9,QBXT,QA5V,QAU3,QAUD V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Sample Function to Retrieve File's Date and Time Stamp</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q124392</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates a sample user-defined Access Basic function
called GetFileDateTime() that you can use to retrieve a file's date and
time stamp.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools
provided with Microsoft Access. For more information about Access
Basic, please refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to create and use the
GetFileDateTime() function.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Create a new module and enter the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Type OFSTRUCT
<PRE></PRE>         cBytes As String * 1
         fFixedDisk As String * 1
         nErrCode As Integer
         szReserved As String * 4
         szPath As String * 128
      End Type

      Global Const OF_EXIST = &amp;H4000

      Declare Function WinOpenFile Lib "KERNEL.EXE" Alias _
      "OpenFile" (ByVal szFileName As String, _
      OpenBuff As OFSTRUCT, ByVal Flag As Integer) As Integer

</PRE><P><LI>Enter the following code in the module:
<P>
<P><PRE>      Function GetFileDateTime (ByVal FileName As String) As Variant
<PRE></PRE>         Dim ofs As OFSTRUCT
         Dim iDate As Long
         Dim iTime As Long

         Const DAY_MASK = &amp;H1F
         Const MONTH_MASK = &amp;H1E0
         Const YEAR_MASK = &amp;HFE00

         Const SECOND_MASK = &amp;H1F
         Const MINUTE_MASK = &amp;H7E0
         Const HOUR_MASK = &amp;HF800

         If WinOpenFile(FileName, ofs, OF_EXIST) &lt;&gt; -1 Then
            iDate = Asc(Mid$(ofs.szReserved, 2, 1)) * 256&amp; _
            + Asc(Mid$(ofs.szReserved, 1, 1))
            iTime = Asc(Mid$(ofs.szReserved, 4, 1)) * 256&amp; _
            + Asc(Mid$(ofs.szReserved, 3, 1))
            GetFileDateTime = DateSerial(((iDate And YEAR_MASK) \ _
            &amp;H200) + 1980, (iDate And MONTH_MASK) \ &amp;H20, (iDate And _
            DAY_MASK)) + TimeSerial((iTime And HOUR_MASK) \ &amp;H800, _
            (iTime And MINUTE_MASK) \ &amp;H20, (iTime And SECOND_MASK) * 2)
         Else
            GetFileDateTime = Null
         End If
      End Function

</PRE><P><LI>From the View menu, choose Immediate Window.

<P><LI>Type the following line in the Immediate window, and then press ENTER:
<P>
<P><PRE>      ?GetFileDateTime("c:\autoexec.bat")
</PRE><P>
   The date and time stamp of the AUTOEXEC.BAT file is returned in the
   Immediate window.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: api return<BR>
Keywords            : kbprg PgmApi<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
