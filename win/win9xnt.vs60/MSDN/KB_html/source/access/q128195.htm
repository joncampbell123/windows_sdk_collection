

<HTML>
<HEAD>
<TITLE>ACC: Commands Not Available During BeforeUpdate Event </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128195">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1995/03/27">
<META NAME="Keywords" CONTENT="FmsEvnt kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you perform an action in the BeforeUpdate event, you receive the following error messages, even if you have canceled the event.     In Microsoft Access 7.0 and 97:     ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA5V,QDN9,QAPN,QAGC,QAGB,QAB4,QAB9,QAO4,QATA,QBBI,QBXS,QDMH,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Commands Not Available During BeforeUpdate Event</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128195</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you perform an action in the BeforeUpdate event, you receive the
following error messages, even if you have canceled the event.
<P>
<PRE>   In Microsoft Access 7.0 and 97:

    - Runtime error '2105'
      You can't go to the specified record

    - Runtime error '2115'
      The macro or function set to the BeforeUpdate or ValidationRule
      property for this field is preventing Microsoft Access from saving
      the data in the field.

   In Microsoft Access 2.0:

    - Field or record can't be saved while it's being validated.

    - Command not available: UndoCurrentRecord.

    - Can't go to specified record.

</PRE><h2>CAUSE</h2>
 
<P>
Microsoft Access cannot perform the specified command because the
BeforeUpdate event procedure is still running. This is true even if the
Cancel parameter is set to True or if a CancelEvent macro attempts to
cancel the action.
<P>
These error messages are generated by the following statements in the
BeforeUpdate event procedure:
<P>
<PRE>  ' Undo the current record.  (Microsoft Access 2.0 only)

  ' NOTE: This behavior no longer occurs in Microsoft Access 7.0 and 97)

  DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, 1

  ' Goto a new record.
  DoCmd.GoToRecord , , acNewRec '(Microsoft Access 7.0 and 97)
  DoCmd GoToRecord , , A_NEWREC '(Microsoft Access 2.0 )

  ' Find a record
  DoCmd.FindRecord "Smith", , True, acAll, True '(Microsoft Access 7.0 and
                                                  97)
  DoCmd FindRecord "Smith", , True, A_ALL, True '(Microsoft Access 2.0)

</PRE><h2>RESOLUTION</h2>
 
<P>
Instead of setting the Cancel parameter to True, or using the CancelEvent
action, use a SendKeys statement if that is an option with the command you
are trying to use. The SendKeys statement sends keystrokes to the Microsoft
Access buffer, where they wait until the BeforeUpdate event procedure is
finished.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To go to a new record before the BeforeUpdate event procedure is finished,
use the following code for the BeforeUpdate property's event procedure:
<P>
<PRE>   Sub Form_BeforeUpdate (Cancel As Integer)
     Dim Msg As String

     Msg = "Would you like to go to a new record?"
     If MsgBox(Msg, 32 + 4) = 6 Then
       ' SendKeys "%egw" '(for Microsoft Access 7.0 and 97)
       ' SendKeys "%rgw" '(for Microsoft Access 2.0)
     End If
   End Sub

</PRE>NOTE: In some cases, you will need to include the CancelEvent action along
with the SendKeys statement as in the following:
<P>
To undo the current record (in Microsoft Access 2.0 only), in place of the
following line to undo the current record
<P>
<PRE>   DoCmd DoMenuItem A_FORMBAR, A_EDITMENU, 1

</PRE>use the SendKeys statement along with the CancelEvent action:
<P>
<PRE>   Docmd CancelEvent
   SendKeys "{ESC}{ESC}"

</PRE>To navigate to a new record, instead of the following code
<P>
<PRE>   DoCmd.GoToRecord , , acNewRec  '(for Microsoft Access 7.0 and 97)
   DoCmd GoToRecord , , A_NEWREC  '(for Microsoft Access 2.0)

</PRE>use the following SendKeys statement:
<P>
<PRE>   SendKeys "%egw" '(for Microsoft Access 7.0 and 97)
   SendKeys "%rgw" '(for Microsoft Access 2.0)

</PRE>For an additional example of how to use this technique, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q115189.htm">Q115189</A></B>
   TITLE     : ACC2: How to Find a Record Using a Bound Control

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in Microsoft
   Access 2.0).

<P><LI>Open the Customers form in Design view.

<P><LI>Set the form's BeforeUpdate property to the following event procedure:
<P>
<PRE>      Sub Form_BeforeUpdate (Cancel As Integer)
      Dim Msg As String
          Msg = "Would you like to go to a new record?"
          If MsgBox(Msg, 32 + 4) = 6 Then
             ' User chose Yes so undo the current record.
              DoCmd.GoToRecord , , acNewRec '(for Microsoft Access 97 only)
             ' In Microsoft Access 2.0 use the following line instead:
             ' DoCmd GoToRecord , , A_NEWREC
          End If
      End Sub

</PRE><P><LI>View the form in Form view.

<P><LI>Change the data in any field, and then click Save Record on the
   Records menu.

<P><LI>When you are prompted "Would you like to go to a new record?" click Yes.
   Note that you receive the following error message.
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>      Runtime error '2105'
      You can't go to the specified record
</PRE><P>
   In Microsoft Access 2.0:
<P>
<P><PRE>      Can't go to specified record
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about SendKeys, search for "SendKeys Statement" using
the Microsoft Access Help Index.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsEvnt kberrmsg kbusage<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
