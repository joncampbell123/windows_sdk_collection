

<HTML>
<HEAD>
<TITLE>ACC: Using Find Command in a Query Causes Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q158926">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1996/11/07">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryGnrl">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the Find dialog box to search for a value in a query, you may receive the following error message.  In Microsoft Access 97     MSACCESS caused a stack fault in modul...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDOG,QBQX,QAH4,QDN9,QA1S,QAB4,QA5V,QAPN,QBWS,QBT6,QBTQ,QBJZ,QBV4,QADK,QA7O P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using Find Command in a Query Causes Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q158926</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the Find dialog box to search for a value in a query, you may
receive the following error message.
<P>
<P><h3>In Microsoft Access 97</h3>
 
<P>
<PRE>   MSACCESS caused a stack fault in module MSJET35.DLL

</PRE><h3>In Microsoft Access 7.0</h3>
 
<P>
<PRE>   MSACCESS caused a stack fault in module MSJT3032.DLL

</PRE><h3>In Microsoft Access 2.0</h3>
 
<P>
<PRE>   MSACCESS caused a General Protection Fault in module MSACCESS.EXE

</PRE>Note that this error only occurs when you display unique values in your
query result, and the field you are searching with Find is sorted in
Ascending order.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around the problem, create a form based on the query and use other
methods to search for specific records on your form.
<P>
The following example uses the sample database Northwind.mdb (or NWIND.MDB
in version 2.0) to demonstrate a method to find a record using a combo box
on a form:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).

<P><LI>Create the following new query called EmployeeZip based on the
   Employees table:
<P>
<P><PRE>      Query: EmployeeZip
      -------------------------------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: Region
<PRE></PRE>         Table: Employees
      Field: PostalCode (or Postal Code in version 2.0)
         Table: Employees
         Sort: Ascending

</PRE><P><LI>On the View menu, click Properties. If the Field List Properties
   dialog box appears, click in an empty space in the upper half of the
   query design window to view the Query Properties dialog box.

<P><LI>Set the Unique Values property of the query to Yes.

<P><LI>Save the query and close it.

<P><LI>Create the following new macro called FindZip:
<P>
<PRE>      Macro Name        Action
      -----------------------------
      FindZip           GoToControl
                        FindRecord

      Locate Product Actions
      -------------------------------
      GoToControl
         Control Name: PostalCode
      FindRecord
         Find What: =[FindPostalCode]
         Find First: Yes

</PRE><P><LI>Create the following new form in Design view called FindEmployeeZip:
<P>
<P><PRE>      Form: FindEmployeeZip
      -----------------------------------
      RecordSource: EmployeeZip
      Caption: Find Employee Postal Codes
      DefaultView: Single Form
</PRE><P>
<P><PRE>      Text Box
<PRE></PRE>         Name: Region
         ControlSource: Region
      Text Box
         Name: PostalCode
         ControlSource: PostalCode (or Postal Code in version 2.0)
      Combo Box
         Name: FindPostalCode
         RowSource: EmployeeZip
         ColumnCount: 2
         ColumnWidths: 0";1"
         BoundColumn: 2
         AfterUpdate: FindZip

</PRE><P><LI>View the FindEmployeeZip form in Form view. Note that when you select a
   zip code in the combo box, the record with that zip code becomes the
   current record on the form.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 2.0, 7.0
and 97. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
WARNING: Following these steps will cause a general protection fault on
your computer. Make sure you save and close any open work on your computer
before following these steps.

<OL><P><LI>Perform steps 1-4 in the "Resolution" section of this article.

<P><LI>View the query in Datasheet view.

<P><LI>Click in the Postal Code column.

<P><LI>On the Edit menu, click Find.

<P><LI>In the Find In Field dialog box, type 98033 in the Find What box, and
   then click Find First.

<P><LI>Type 98052 in the Find What box, and then click Find Next.

<P><LI>Type 98033 in the Find What box, and then click Find Next.

<P><LI>Click Find Next again. Note that the error occurs.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage QryGnrl<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
