

<HTML>
<HEAD>
<TITLE>ACC97:How to Install Wizards Locally [OFF97 SR1 Network Setup] </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178331">
<META NAME="KBModify" CONTENT="1998/01/13">
<META NAME="KBCreate" CONTENT="1997/12/18">
<META NAME="Keywords" CONTENT="StpNet WzProb">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article discusses how to modify the Setup Table File (STF) of Microsoft Office 97 Service Release 1 so that Setup installs Microsoft Access 97 wizard files on users' ha...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QA1S,QDKX,QAVZ,QDN9,QBVP,QBWS,QAE1,QAFI,QAIK,QAGU,QDH3,QDMN,QBC9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97:How to Install Wizards Locally [OFF97 SR1 Network Setup]</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 13, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178331</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article discusses how to modify the Setup Table File (STF) of
Microsoft Office 97 Service Release 1 so that Setup installs Microsoft
Access 97 wizard files on users' hard drives during Run From Network Server
installations. The information in this article is based on Acwizard.doc,
but the STF changes apply specifically to Microsoft Office 97 Service
Release 1.
<P>
Acwizard.doc is one of nine advanced Office documents contained in
Document.exe, a downloadable file on the "Microsoft Office 97 Resource Kit
Tools and Utilities" page on the World Wide Web. To view a description of
the other Office documents or to download Document.exe, please see the
following Microsoft World Wide Web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/ork/appa/appa.htm#orkappac3">http://www.microsoft.com/office/ork/appa/appa.htm#ORKappaC3</A></B>

</PRE>After you have modified the Setup Table File (STF), you may want to use the
Network Installation Wizard, which allows you to modify Setup information
files to create a customized network installation of Office. To obtain the
Network Installation Wizard, please see the following Microsoft Word Wide
Web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/ork/appa/appa.htm#orkappac1">http://www.microsoft.com/office/ork/appa/appa.htm#ORKappaC1</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE>You can then search the Micorosoft Web site for the file Setupniw.exe.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
WARNING: ANY USE BY YOU OF THE INFORMATION PROVIDED IN THIS ARTICLE IS AT
YOUR OWN RISK. Microsoft provides this information "as is" without warranty
of any kind, either express or implied, including but not limited to the
implied warranties of merchantability and/or fitness for a particular
purpose.  Modification of the Setup Table File (STF) is not supported by
Microsoft Access Technical Support Engineers.
<P>
If you open, edit, and save the STF file improperly in Microsoft Excel,
you may receive a "Setup Error 932" error message. To resolve this error,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q162796.htm">Q162796</A></B>
   TITLE     : OFF97: Setup Error 932 After Modifying STF File

</PRE>NOTE: To see references mentioned in the following text, please connect to
the "Microsoft Office 97 Resource Kit" Web site at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/ork/">http://www.microsoft.com/office/ork/</A></B>

</PRE><h3>Modifying the STF File to Run Microsoft Access from the Network</h3>
 
<P>
To make a Run from Network Server installation from an administrative
installation point work more smoothly, administrators can modify the
Microsoft Office 97 Professional Edition or Microsoft Access 97 Setup
Table File (STF). These modifications are described in the following
sections.
<P>
<PRE> --------------------------------------------------------------------------
 WARNING: The modifications that are described in this paper should only be
 used with Run from Network Server installations. Do not use an STF file
 with these modifications for Typical or Custom installations.

 To use a modified STF file to change a Run From Network Server
 installation, make a backup copy of the Setup.lst file (typically this
 file is located in the Msoffice folder of your administrative installation
 point); then open the file in Notepad and search and replace all
 occurrences of the names of STF and INF files with the names of the files
 you create using the procedures in this paper. Save the modified LST file
 to a name of your choosing.

 You can use the following example command line when you run Setup:

    Pathtosetup\Setup /l filename.lst /b3 /q1

 These command-line options perform the following functions: /l points to
 the LST file that you modified to point to the correct STF and INF files
 for this installation, /b3 performs a Run from Network Server
 installation, and/q1 runs Setup in quiet mode.

 If you use Network Installation Wizard version 2.1 or later, you can use
 the following command line when you run Setup:

    Pathtosetup\Setup /l Netinst/Netinst.lst /b3 /q1

 In this example, /l points to the location of the .lst file created by
 Network Installation Wizard. The first instance of Netinst is a
 subdirectory of Pathtosetup; you specify the name of this subdirectory in
 the Choose Setup Files Subfolder screen of the Network Installation
 Wizard. The Network Installation Wizard then creates the subdirectory and
 also creates a custom .lst file with the same name in this subdirectory.
 In this example, the file is named Netinst.lst. If an .lst file with the
 same name as the subdirectory already exists in that subdirectory, the
 wizard appends a number to the directory name in order to create a unique
 name for the custom .lst file.

 Network Installation Wizard version 2.1 or later also suggests a command
 line based on the preferences you supply, such the installation type
 (Typical, Custom, or Run from Network Server) and the Quiet Level that
 you specify in the Select Quiet Mode screen.

 For more information about command line parameters used with
 Microsoft Office 97 setup, please see the following article in the
 Microsoft Knowledge Base:

   ARTICLE-ID: <B><A href="../office/q158503.htm">Q158503</A></B>
   TITLE     : OFF97: Setup Switches for Microsoft Office 97

 --------------------------------------------------------------------------

</PRE><h3>Installing Microsoft Access Wizards Locally</h3>
 
<P>
After performing a Run from Network Server installation, Microsoft Access
runs wizards directly from the Workdir folder on the network server. This
works properly as long as users are given Change permissions (the set of
Read, Write, Execute, and Delete permissions) in the Workdir folder, as
described in "Creating the Administrative Installation Point" in Chapter 4,
"Installing Microsoft Office," in the Microsoft Office 97 Resource Kit.
<P>
However, a user cannot run certain wizards, such as the Table Wizard, from
the network if another user is running the same wizard at the same time.
Instead, an error message is displayed. To avoid sharing conflicts when
running wizards, or if you don't want to give users Change permissions in
the Workdir folder, you can modify the STF file so that Setup installs
Microsoft Access 97 wizard files on users' hard drives during Run from
Network Server installations.
<P>
NOTE: The following instructions are recommended only for administrators
who are familiar with administrative installations and editing of the STF
file. All of the procedures in this paper assume that you have already
created an administrative installation point. For more information, see
"Creating the Administrative Installation Point" in Chapter 4, "Installing
Microsoft Office," in the Microsoft Office 97 Resource Kit.
<P>
WARNING: Off97Pro.stf and Acc97.stf are tab-delimited files that rely
heavily on positional parameters, and they can easily be damaged by
modifying them using a method other than the one described here.
<P>
The best way to make complex edits to an STF file is by using Microsoft
Excel. Microsoft Excel opens the tab-delimited data in an STF file as
separate columns so that you can easily view and modify the data. However,
if you do not follow the correct procedures when opening an STF file, you
can damage the format of the STF file. Some of the tab characters used to
delimit data in the STF files for Microsoft Office 97 and Microsoft Access
97 are followed by a single space. Before editing the STF file the first
time in Microsoft Excel, you must remove these trailing spaces as described
in the following procedure.
<P>
<P><h3>To remove trailing spaces from an STF file</h3>
 

<OL><P><LI>Make a backup copy of the STF file (Off97pro.stf or Acc97.stf) in the
   MSOffice folder of the administrative installation point.

<P><LI>Open the STF file in Microsoft Word (version 6.0 or later).

<P><LI>On the Edit menu, click Replace.

<P><LI>In the Find What box, type ^t followed by a single space.

<P><LI>In the Replace With box, type ^t with no space following.

<P><LI>Click Replace All.

<P><LI>On the File menu, click Save As, and save the file as Text Only.
   Microsoft Word saves the file with a .txt extension.

<P><LI>In My Computer or Windows Explorer, rename the file to remove the .txt
   extension and restore its original name (Off97pro.stf or Acc97.stf).
<P>
</OL>After you remove any trailing spaces from the STF file, you can safely open
it in Microsoft Excel and there is no need to repeat this procedure.
<P>
When you open an STF file in Microsoft Excel, it starts the Text Import
Wizard to specify how data is formatted. You must make the correct
selections in the Text Import Wizard to make sure that all columns of data
in the file are opened using a Text format.
<P>
<P><h3>To open an STF file using Microsoft Excel</h3>
 

<OL><P><LI>Before opening an STF file the first time, remove trailing spaces as
   described in the preceding procedure.

<P><LI>Start Microsoft Excel and open the STF file. The Text Import Wizard
   starts automatically.

<P><LI>Click Next twice to proceed to Step 3 of 3 in the wizard.

<P><LI>In the Data Preview window, scroll down until ObjID is displayed at the
   top of the first column.

<P><LI>Click the first column to select it.

<P><LI>Scroll all the way to the right until the last column is displayed. The
   data at the top of the last column should be Install Directory.

<P><LI>Hold down shift and click the last column. All of the columns in the
   Data Preview list should be selected.

<P><LI>In Column Data Format, click Text, and then click Finish.
<P>
</OL>Microsoft Excel opens the STF file. An STF file starts with about 30 rows
of header information. Scroll down until you see ObjID in column A. This is
the beginning of the STF table information that you will modify using the
procedures that follow. You can adjust the widths of each column to view
the data in each column better.
<P>
<P><h3>To modify the administrative installation point for Office 97 to install</h3>
 
<P><h3>Microsoft Access wizards on users' hard drives</h3>
 

<OL><P><LI>Open Off97pro.stf in Microsoft Excel as described earlier in this paper
   in the procedure "To open an STF file using Microsoft Excel."

<P><LI>Scroll down to the row that contains 133 in column A (ObjID ). In column
   F (Object Data ), change the value 160 to 161. The values in column F
   for this row should now read:
<P>
<P><PRE>      137 134 161 163
</PRE>
<P><LI>Scroll down to the row that contains 134 in column A and delete the
   value 140 in column F. The value in column F should now read:
<P>
<P><PRE>      139 607 136 154 144
</PRE>
<P><LI>Find the rows with the following values in column A and change the
   values in column K (Destination Directory) as specified in the following
   table.
<P>
<PRE>    Column A  In column K, change this value     To this value
    ----------------------------------------------------------

    822       %d,%d\Office                      %161,%d\Office
    831       %d,%d\Office                      %161,%d\Office
    2116      %d,%d\Office                      %161,%d\Office
    2120      %d,%d\Office                      %161,%d\Office

</PRE><P><LI>Find the rows that contain 832 and 2117 in column A. For both rows,
   locate the string %s within the value in column F and change it to %161.
   The values in column F for each row should now read:
<P>
<P><PRE>    Column A  Column F
</PRE><P>
<PRE>    832       "LOCAL","Software\Microsoft\Office\8.0\Access\Wizards
              \Data Files", "Wizard Data File", "%161\wzdat80.mdt", ""
    2117      "LOCAL",
              "Software\Microsoft\Office\8.0\Access\Wizards\Replication
              Conflicts", "Path", "%161\Wzcnf80.mda", ""

</PRE></OL>If you make no other changes, Setup installs the wizard files on users'
hard drives in the Program Files\Microsoft Office\Office folder. If you
want to change the destination for the wizard files to some other shared
Windows NT Server folder, such as a user's home directory, find the row
that begins with 161 in column A and change the value in column K using the
following format:
<P>
<PRE>   driveletter:\foldername\

</PRE>For example, to create a Workdir folder in the shared network folder mapped
to the user's H drive, enter H:\Workdir\. For this to work, every user who
runs Setup using the modified STF file must have drive H mapped to a shared
folder on the network and must have Change permissions for that folder.
<P>
Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
<P><h3>Sharing the Same Workgroup Information File</h3>
 
<P>
The changes described in the previous section copy only Microsoft Access
wizard files to users' hard drives. The workgroup information file,
System.mdw, remains in the Workdir folder on the network server and is
shared by all users who run Microsoft Access from the network. This
arrangement works as long as all users running Microsoft Access from the
network have at least read permissions and have the same level of security
permissions for the Workdir folder.
<P>
If a user needs to add or modify Microsoft Access user-level security
account information (which is stored in the System.mdw file), that user
must log on with at least Change permissions. However, if a user logs on
with Change permissions or higher while other users have only Read or Add &amp;
Read permissions, problems can occur. For example, if a user with Change
permissions starts Microsoft Access when no other users are running
Microsoft Access, the System.mdw file is opened for exclusive access, and
no other users can open the file or start Microsoft Access. You can avoid
this problem any of four ways:

<UL><LI>If no users need to make changes to user-level security account
   information, make sure all users who run Microsoft Access from the
   network have the same level of permissions in the Workdir folder.

<LI>If one user needs to change user-level security account information,
   have that user log on using an account that has Change permissions in
   the Workdir folder and then exit Microsoft Access as soon as the changes
   are finished.

<LI>Alternatively, if a user needs to change user-level security account
   information, have that user use the Workgroup Administrator or the
   /wrkgrp command-line option to specify a copy of the System.mdw in a
   different folder. After making changes to that System.mdw, the user can
   copy the modified file back into the Workdir folder after all other
   users have exited Microsoft Access.

<LI>You can modify the STF and INF files before users install Office 97 or
   Microsoft Access 97 so that Setup installs a copy of System.mdw in the
   Program Files\Microsoft Office\Office folder on users' hard drives
   during Run from Network Server installations, as described in the
   following procedures. In this scenario, if a user needs to change user-
   level security account information after Office 97 or Microsoft Access
   97 has been installed, that user must distribute copies of the updated
   System.mdw file for other users to copy to their hard drives.
<P>
</UL>NOTE: The following instructions assume that you have already modified the
STF file to copy wizard files locally, as described earlier in this paper.
<P>
<P><h3>To modify the administrative installation point for Office 97 to Install</h3>
 
<P><h3>System.mdw on users' hard drives</h3>
 

<OL><P><LI>Open Off97pro.stf in Microsoft Excel as described earlier in this paper
   in the procedure "To open an STF file using Microsoft Excel."

<P><LI>Scroll down to the row that contains 133 in column A (ObjID ). In column
   F (Object Data ), change the value 163 to 165. The values in column F
   for this row should now read:
<P>
<P><PRE>      137 134 161 165
</PRE>
<P><LI>Scroll down to the row that contains 161 in column A. Add 574 to the end
   of the value in column F. The value in column F should now read:
<P>
<P><PRE>      829 2115 2119 818 183 574
</PRE>
<P><LI>Scroll down to row that contains 574 in column A. In column E (Object
   Type), change the value from CustomAction to CopyFile. In column F,
   change the value from "msacccah.dll, SyncEXECalloutCAH,
   %s\OS\System\wrkgadm.exe /sil %s\Workdir\system.mdw" to User Files,
   system_mdw. The beginning of this row should now read:
<P>
<PRE>      574        CopyFile User Files, system_mdw

</PRE><P><LI>Also, in the row that contains 574 in column A, add %161 in column K.

<P><LI>In the row that contains 2163 in column A, locate the string %s within
   the value in column F and change it to %161. The value in column F
   should now read:
<P>
<P><PRE>      "LOCAL", "Software\Microsoft\Office\8.0\Access\Jet\3.5\Engines",
      "SystemDB", "%161\system.mdw", ""
</PRE><P>
</OL>Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
The Off97pro.inf file also needs to be modified.
<P>
<P><h3>To modify the Off97pro.inf file</h3>
 

<OL><P><LI>Make a backup of the Off97pro.inf file.

<P><LI>Open the file in WordPad or another text editor that does not alter tabs
   and spaces.

<P><LI>Search for system.mdw and insert Workdir\ in front of system.mdw. The
   line should now read:
<P>
<P><PRE>       "system_mdw"= 1,Workdir\System.mdw,,,,,,,,,,,,,,,,,,,
</PRE><P>
</OL>Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
For more information about copying the wizards locally, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q174742.htm">Q174742</A></B>
   TITLE     : ACC97: How to Install Wizards Locally Rather Than on Server

   ARTICLE-ID: <B><A href="../access/q178330.htm">Q178330</A></B>
   TITLE     : ACC97: How to Install Wizards Locally [Standalone Network Setup]
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: inf<BR>
Keywords          : StpNet WzProb<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 13, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
