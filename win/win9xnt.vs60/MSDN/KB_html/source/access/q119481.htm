

<HTML>
<HEAD>
<TITLE>ACC2: Cannot Delete Attached Table with Relationship </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119481">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1994/08/17">
<META NAME="Keywords" CONTENT="IsmXbase kb3rdparty kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  If you try to delete an attached dBASE, FoxPro, Paradox, or Btrieve table, you may receive the following error message even if no relationship appears to exist between the a...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA39,QAEF,QA1S,QAGB,QABT,QBCT,QAGC,QDKD,QDN9,QA5F,QAMA,QARR,QA9N,QAZV,QANJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Cannot Delete Attached Table with Relationship</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119481</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
If you try to delete an attached dBASE, FoxPro, Paradox, or Btrieve table,
you may receive the following error message even if no relationship appears
to exist between the attached table and any other tables in your database:
<P>
<PRE>   Can't delete table &lt;tablename&gt;. It is participating in one or more
   relationships.

</PRE><h2>CAUSE</h2>
 
<P>
At one time, a non-enforceable relationship was established between the
attached table and another table in your database. This attachment is no
longer valid (for example, the file containing the attached table has been
moved or deleted).
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If the file containing the attached table was moved, use the Attachment
Manager to refresh the relationship. After you refresh the relationship,
remove the relationship in the Relationships window, and then delete the
attached table.
<P>
If the file containing the attached table was deleted, you cannot refresh
and then remove the relationship. Instead, you can create an Access Basic
procedure to remove any relationship in which the attached table is
participating, and then delete the attachment. The advantage of this
approach is that you can delete the relationship even though no
relationship appears in the Relationships window.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Building Applications" manual.
<P>
The following example demonstrates how to create and use an Access Basic
procedure to delete an attached table.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Create a new module and enter the following line in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Create the following procedure in the module:
<P>
<P><PRE>      Function DeleteAttachment()
</PRE><P>
<P><PRE>      Dim MyDB As Database, TableName As String, I As Integer
      On Error GoTo DeleteErr
      Set MyDB = DBEngine.WorkSpaces(0).Databases(0)
</PRE><P>
<P><PRE>      ' Prompt for the name of the attached table.
      TableName = InputBox$("Enter the name of the attached_
<PRE></PRE>           table you want to delete.")

      ' First, determine if the table is an attached table. If so,
      ' examine all relationships in the database.
      If Not ((MyDB.TableDefs(TableName).Attributes And_
           DB_ATTACHEDTABLE) = 0) Then

            For I = 0 To MyDB.Relations.Count - 1
                ' If the attached table is part of the current
                ' relationship, delete the relationship.
                If (MyDB.Relations(I).Table = TableName) Or_
                   (MyDB.Relations(I).ForeignTable = TableName) Then
                    MyDB.Relations.Delete MyDB.Relations(I).Name
                End If
            Next I

          ' After all relationships involving this table have been
          ' deleted, delete the attached table.
          MyDB.TableDefs.Delete TableName
      End If

      DeleteExit:
          Exit Function

      DeleteErr:
           If Err = 3265 Then
               MsgBox "There is no table named " &amp; TableName
           Else
               MsgBox "An unexpected error (" &amp; Err &amp; ") occurred: "_
                   &amp; Error(Err)
           End If
           Resume DeleteExit

       End Function

</PRE><P><LI>From the View menu, choose Immediate Window.

<P><LI>In the Immediate window, type the following line, and then press ENTER:
<P>
<P><PRE>      ? DeleteAttachment()
</PRE><P>
</OL>NOTE: After you delete a table using this method, you may need to refresh
the Database window. To do so, choose the Query button in the Database
window, and then choose the Table button.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IsmXbase kb3rdparty kberrmsg<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
