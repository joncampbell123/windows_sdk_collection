

<HTML>
<HEAD>
<TITLE>ACC1x: How to Print Total Number of Pages on Each Page of Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q97517 ">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1993/04/13">
<META NAME="Keywords" CONTENT="kbusage RptLayou">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  You can print the page number on each page of a report by using the Page property in a text box control in the page footer. The example below also shows you how to print the total number of pages in the report on each page (for example, 1/   , wher...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QBT6,QBV4,QADP,QA1S,QAPN,QBWA,QAKC,QAY5,QBXV,QAHP,QAOX,QAGF,QBC6,QDN9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Print Total Number of Pages on Each Page of Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q97517 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can print the page number on each page of a report by using the
Page property in a text box control in the page footer. The example
below also shows you how to print the total number of pages in the
report on each page (for example, 1/&lt;n&gt;, where &lt;n&gt; is the total number of
pages).
<P>
The sample program below uses the SendKeys statement to go to the end of
the report, stores the total number of pages in a global variable, then
returns to the beginning of the report to print or preview the report.
<P>
NOTE: This method may not work with all reports. Below are four known
problems with this method:

<UL><LI>If the report window is zoomed (maximized), the END key in the
   SendKeys statement will not work correctly.
<P>
   By default, reports open with the report window zoomed. Pressing Z
   unzooms the screen and pressing the END key moves you to the end of
   the report so that the code below can calculate the total number of
   pages. However, if the report window is zoomed, the END key moves
   the cursor to the right corner of the screen instead of going to
   the last page of the report. The SendKeys statement in the
   GotoEnd() function contains the key combination ALT+Z  (or %Z) to
   toggle the zoomed mode off. If your report displays a 0 for total
   pages, try omitting the %Z from the SendKeys statement.

<LI>If a query takes a long time to process, Microsoft Access can yield
   processor control to Windows, which empties the keyboard buffer.
   When  this happens, the GotoEnd() function (which uses SendKeys)
   fails, the  SendKeys data is lost, and the total number of pages
   listed may be wrong. (This problem most often occurs when a report
   contains subreports.)

<LI>If your report contains subreports, this method does not calculate
   the total number of report pages correctly. Currently, there is no
   workaround for this behavior. A change to this behavior is being
   reviewed for inclusion in a future version of Microsoft Access.

<LI>If you use an OpenReport macro action where the report is sent
   directly to the printer, this will fail because the functions are not
   allowed to go to the end of the report and back again to create the
   total page number variable.
<P>
</UL>This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools
provided with Microsoft Access. For more information on Access Basic,
please refer to the "Introduction to Programming" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To print the total number of pages in a report at the bottom of each
page, do the following:

<OL><P><LI>Open a new module or a previously created module and enter the
   following sample code:
<P>
   NOTE: In the following sample code, an underscore (_) is used as a
   line-continuation character. Remove the underscore when re-creating
   this code in Access Basic.
<P>
<P><PRE>      '*************************************************************
      'Declarations section of the module
      '*************************************************************
      Option Explicit
      Global TotalPages as Integer
</PRE><P>
<P><PRE>      '*************************************************************
      'Create the following functions in the module.
      '*************************************************************
      Function GetTotalPages()
<PRE></PRE>         GetTotalPages = TotalPages
      End Function

      Function GotoEnd()
         TotalPages = 0
         SendKeys "%z{END}", False
         ' SendKeys does not work if report is maximized
      End Function

      Function SaveTotalPages(TotPgNum As Integer)
         If TotalPages = 0 Then
            TotalPages = TotPgNum
            SendKeys "{HOME}", False
         End If
      End Function

</PRE><P><LI>Open your report in Design view.

<P><LI>From the View menu, choose Properties to display the property
   sheet. Add the following function to the report's OnOpen property:
<P>
<P><PRE>      OnOpen: =GotoEnd()
</PRE>
<P><LI>Place a text box control called MyPage in the page footer:
<P>
<P><PRE>      Object: Text Box
      ----------------
      ControlName: MyPage
<PRE></PRE>         ControlSource: =Page
         Visible: No

</PRE><P><LI>Change the report footer's OnFormat property to:
<P>
<P><PRE>      OnFormat: =SaveTotalPages([MyPage])
</PRE>
<P><LI>Place a text box control in the page footer as follows:
<P>
<P><PRE>      Object: Text Box
      ----------------
      ControlName: PageNum
<PRE></PRE>         ControlSource: =Page &amp; "/" &amp; GetTotalPages()

</PRE></OL>When you print the report, the text box control prints the page number
as 1/&lt;n&gt;, where &lt;n&gt; is the total number of pages in the report.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage RptLayou<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
