

<HTML>
<HEAD>
<TITLE>ACC: How to Display Immediate Window Without Module Window </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q89594 ">
<META NAME="KBModify" CONTENT="1997/11/12">
<META NAME="KBCreate" CONTENT="1992/09/27">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Access does not display the Immediate window unless the Module window is visible. This can be a problem if the user wants to print to the Immediate window while in...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA1S,QDN9,QAY5,QAGQ,QBV8,QAB9,QAGI,QAFX,QAFR,QA5F,QAMA,QDL9,QDIT,QBWS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Display Immediate Window Without Module Window</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q89594 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access does not display the Immediate window unless the Module
window is visible. This can be a problem if the user wants to print to the
Immediate window while in Datasheet view of a form. By calling two Windows
application programming interface (API) functions from Access Basic, the
Immediate window can be displayed at any time, even without the Module
window visible.
<P>
NOTE: In Microsoft Access for Windows 95 version 7.0 you no longer have to
have a module open to display the Debug window. The Debug window can be
brought up anytime in an active database by pressing CTRL+G.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To display the Immediate window at any time, you need to call the
FindWindow() API function to get the handle to the Immediate window,
and then call the ShowWindow() API function to make the actual window
visible. You can attach the Access Basic function that includes these
API functions to a command button or a RunCode action in the Autokeys
macro, or you can add it to your toolbar.
<P>
To display the Immediate window, follow these steps:

<OL><P><LI>Create a new module, or open an existing module.

<P><LI>Add the following declarations to the Global section of the module.
<P>
   NOTE: In the following sample code, an underscore (_) is used as a
   line continuation character. Remove the underscore from the end of the
   line when re-creating this code in Access Basic.
<P>
<P><PRE>      Option Explicit
      Declare Function ShowWindow% Lib "user" (ByVal hWnd%, ByVal nCmd%)
      Declare Function FindWindow% Lib "user" (ByVal lpClassName As Any, _
      ByVal lpWindowName As Any)
</PRE>
<P><LI>Add the following ShowImmediateWindow() function:
<P>
<P><PRE>      Function ShowImmediateWindow ()
<PRE></PRE>         Dim IhWnd%                ' Handle to the Immediate Window.
         Dim ApiResults%           ' Returns the previous state of IW.
         Const MyNull = 0&amp;
         Const SW_SHOW = 5         ' Internal constant to show window.
         Const ClassName = "OImmediate"    ' Internal ClassName of IW.

         IhWnd% = FindWindow(ClassName, MyNull)

         If IhWnd% = 0 Then
            MsgBox ("You need to open the IW once for this to work.")
         End If

         ApiResults% = ShowWindow(IhWnd%, SW_SHOW)
      End Function

</PRE><P><LI>Attach the code to a command button of a form.

<P><LI>When you first start Microsoft Access, the Immediate window is not
   displayed. When you open a module and display the Immediate window,
   and then close it, Microsoft Access sets the window's Visible property
   to False. Calling ShowWindow() resets the Visible property to True. If
   you call this function without first displaying the Immediate window at
   least once, you receive an error message because Microsoft Access has
   not created the Immediate window yet and therefore cannot return a
   window handle.
<P>
   For information about displaying the Immediate window without
   displaying the Module window, see the following article the Microsoft
   Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../access/q89594.htm">Q89594</A></B>
<PRE></PRE>      TITLE:      ACC: How to Display Immediate Window Without Module
                       Window

   With the information in the article referenced above, you can open
   the Immediate window with macros once, and then use the code from this
   article to display the Immediate window at any time.

</PRE><P><LI>If you have registered the Immediate window with Windows by opening
   it at least once, pressing the command button of the form while in
   Datasheet view displays the Immediate window. Any Debug.Print
   statements should then be visible.
<P>
</OL>NOTE: This is unsupported code, and there may be instances when this
example does not work.
 
<PRE>Keywords          : kbprg
Version           : 1.0 1.1 2.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
