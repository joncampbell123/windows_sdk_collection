

<HTML>
<HEAD>
<TITLE>ACC: How to Sort a Report from a Pop-Up Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q146310">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1996/02/15">
<META NAME="Keywords" CONTENT="FmrCdbeh kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate:  Requires basic macro, coding, and interoperability skills.  This article describes how to create a pop-up form for setting the sort order of data in a report.  NOTE: This article explains a technique demonstrated in the sample files, Rpt...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABH,QABI,QA1S,QAUJ,QAB6,QBWS,QAPN,QDN9,QA2Q,QA7O,QA7N,QBXS,QAY2,QAFF,QAG2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Sort a Report from a Pop-Up Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q146310</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate:  Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to create a pop-up form for setting the sort
order of data in a report.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This technique involves creating a pop-up form and a report in the sample
database Northwind. The form enables you to choose which report fields to
sort on and in which order: ascending or descending.
<P>
<P><h3>Creating the Report</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Start the Report Wizard and create a report based on the Customers
   table.

<P><LI>In the "Which fields do you want on your report" box, select the
   following fields:
<P>
<P><PRE>      CompanyName
      ContactName
      City
      Region
      Country
</PRE>
<P><LI>Click Finish to display the new report in Print Preview.

<P><LI>On the File menu, click Save As/Export. Enter "Sort Report" (without
   the quotation marks) as the report name and click OK.

<P><LI>Close the report.
<P>
</OL><h3>Creating the Pop-up Form</h3>
 

<OL><P><LI>Create a new form not based on any table or query in Design view with
   the following form properties:
<P>
<P><PRE>      Form: Sort Form
      ---------------------
      ScrollBars: Neither
      RecordSelectors: No
      NavigationButtons: No
      PopUp: Yes
      BorderStyle: Thin
      MinMaxButtons: None
</PRE>
<P><LI>Set the form's OnOpen property to the following event procedure:
<P>
<P><PRE>      Private Sub Form_Open(Cancel As Integer)
<PRE></PRE>         ' Opens the report in Design view when the form opens.
         DoCmd.OpenReport "Sort Report", acviewDesign
         ' ("acDesign" in Microsoft Access version 7.0)
         DoCmd.Maximize
      End Sub

</PRE><P><LI>Set the form's OnClose property to the following event procedure.
<P>
<P><PRE>      Private Sub Form_Close()
<PRE></PRE>         ' Closes the report when the form closes.
         DoCmd.Close acReport, "Sort Report"
         DoCmd.Restore
      End Sub

</PRE><P><LI>Add the following five combo boxes:
<P>
   NOTE: In the SQL expressions below, an underscore (_) at the end of
   a line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this expression.
<P>
<P><PRE>      Combo box:
<PRE></PRE>         Name: Sort1
         RowSourceType: Field List
         RowSource: Select [CompanyName], [ContactName], [City], _
                    [Region],[Country] from Customers

      Combo box:
         Name: Sort2
         RowSourceType: Field List
         RowSource: Select [CompanyName], [ContactName], [City], _
                    [Region],[Country] from Customers

      Combo box:
         Name: Sort3
         RowSourceType: Field List
         RowSource: Select [CompanyName], [ContactName], [City], _
                    [Region], [Country] from Customers

      Combo box:
         Name: Sort4
         RowSourceType: Field List
         RowSource: Select [CompanyName], [ContactName], [City], _
                    [Region], [Country] from Customers

      Combo box:
         Name: Sort5
         RowSourceType: Field List
         RowSource: Select [CompanyName], [ContactName], [City], _
                    [Region], [Country] from Customers

</PRE><P><LI>Add the following five check boxes next to the combo boxes on the
   form, which you can use later for selecting ascending or descending
   order for your report:
<P>
<P><PRE>      Check box:
<PRE></PRE>         Name: Check1

      Check box:
         Name: Check2

      Check box:
         Name: Check3

      Check box:
         Name: Check4

      Check box:
         Name: Check5

</PRE><P><LI>Add the following command button to the form, which enables you to
   reset the values in the form's combo boxes and check boxes:
<P>
<P><PRE>      Command button:
<PRE></PRE>         Name:Clear
         Caption:Clear
         OnClick: [Event procedure]

      Set the OnClick [Event procedure] to the following:

         Private Sub Clear_Click()
           Dim intCounter as Integer
             For intCounter= 1 To 5
               Me("Sort" &amp;intCounter) = ""
               Me("Check" &amp;intCounter) = ""
             Next
         End Sub

</PRE><P><LI>Add the following command button to the form:
<P>
<P><PRE>      Command button:
<PRE></PRE>         Name SetOrderBy
         Caption SetOrderBy
         OnClick: [Event procedure]

      Set the OnClick [Event procedure] to the following:

         Private Sub SetOrderBy_Click()
            Dim strSQL as String, intCounter as Integer
            ' Build strSQL String.
            For intCounter= 1 To 5
               If Me("Sort" &amp;intCounter) &lt;&gt; "" Then
                  strSQL = strSQL &amp; "[" &amp; Me("Sort" &amp;intCounter) &amp; "]"
                  If Me("Check" &amp;intCounter) = True Then
                     strSQL = strSQL &amp; " DESC"
                  End IF
                strSQL = strSQL &amp; ", "
               End If
            Next

            If strSQL &lt;&gt; "" Then
               ' Strip Last Comma &amp; Space.
               strSQL = Left(strSQL, (Len(strSQL) - 2))
               ' Set the OrderBy property.
               Reports![Sort Report].OrderBy = strSQL
               Reports![Sort Report].OrderByOn = True
            End If
         End Sub

</PRE><P><LI>Close and save the form as XXXXX.
<P>
</OL><h3>Sorting the Report</h3>
 

<OL><P><LI>Open XXXXX in Form view. Note that the report opens in Design view
   behind the form.

<P><LI>Select a value in the first combo box, and then click the SetOrderBy
   button. The report should appear sorted by the field you selected in
   the combo box.

<P><LI>Click to select the first check box, and then click the SetOrderby
   button. You should see the report sorted in descending order by the
   field you selected in the combo box.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the filter property, search the Help Index for
"Filter Property," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about filter by form or filter by selection, search
the Help Index for "Filter By Form" or "Filter By Selection," or ask the
Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: dynamically<BR>
Keywords          : FmrCdbeh kbusage<BR>
Version           : 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
