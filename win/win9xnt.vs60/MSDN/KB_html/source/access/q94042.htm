

<HTML>
<HEAD>
<TITLE>ACC1x: Function to Delete Table Without Using DoMenuItem </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94042 ">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1992/12/22">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  You can create and use the DeleteTable() function to delete a table without using the DoMenuItem() or SendKeys() functions.  MORE INFORMATION  Microsoft Access stores all references to objects (tables, queries, forms, reports, macros, and modules) ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAGB,QAEF,QBCT,QAGC,QAY5,QDKD,QAY2,QAB9,QAPN,QBMW,QA1S,QBV8,QAB4,QDNC V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Function to Delete Table Without Using DoMenuItem</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94042 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
You can create and use the DeleteTable() function to delete a table without
using the DoMenuItem() or SendKeys() functions.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access stores all references to objects (tables, queries, forms,
reports, macros, and modules) in a system table called MSysObjects. You can
delete an object from the MSysObjects table if you have permission to do
so.
<P>
To view the system objects in your database,

<OL><P><LI>From the View menu, choose Options.

<P><LI>Under the General category, change the Show System Objects item to
   Yes.

<P><LI>Choose OK.
<P>
</OL>All the system tables should now be visible in the Database window.
<P>
Next, use the following steps to assign yourself permission to delete
objects from the MSysObjects table:

<OL><P><LI>From the Security menu, choose Permissions.

<P><LI>Choose modify rights for the table by selecting or clearing the
   appropriate check boxes.
<P>
</OL>The DeleteTable() function accepts the name of a table as its parameter. It
finds the record in MSysObjects that corresponds to that table name and
deletes that record. The function also deletes records from other system
tables, including MSysACEs, MSysIndexes, and MSysColumns, that relate to
the deleted table. The function returns a value of True if it successfully
deletes the table you specified; it returns a value of False if it cannot
find a table with the name you specified.
<P>
NOTE: Modifying data in any system table can have serious ramifications. Do
not attempt to do this unless you are thoroughly familiar with the database
and know exactly where, when, and how the table you want to delete is used
elsewhere in the database. It is best to use the DeleteTable() function on
temporary tables only.
<P>
The Access Basic code for the DeleteTable() function is as follows:
<P>
NOTE: In the following sample code, an underscore (_) is used as a line-
continuation character. Remove the underscore when re-creating this code in
Access Basic.
<P>
<PRE>   Option Explicit
   Function DeleteTable (TableName as String)

      Dim SQL As String, Msg As String

      If DCount("[Name]", "MSysObjects", "[Name] = '" _
            &amp; TableName &amp; "'") = 0 Then
         DeleteTable = FALSE
         Exit Function
      End If

      On Error GoTo DeleteErrorProc

   ' Suppress the "Do you want to delete these records?" message.

      DoCmd SetWarnings False

   ' SQL statement to delete appropriate entries from the MSysColumns
   ' table follows:

      SQL = "DELETE DISTINCTROW MSysObjects.Name, MSysColumns.*"
      SQL = SQL &amp; " FROM MsysObjects, MSysColumns,"
      SQL = SQL &amp; " MSysColumns INNER JOIN MSysObjects ON"
      SQL = SQL &amp; " MSysColumns.ObjectId = MSysObjects.Id"
      SQL = SQL &amp; " WHERE ((MSysObjects.Name = '" &amp; TableName &amp; "'));"

      DoCmd RunSQL SQL

   ' SQL Statement to delete appropriate entries from MSysACEs table
   ' follows:

      SQL = "DELETE DISTINCTROW MSysObjects.Name, MSysACEs.*"
      SQL = SQL &amp; " FROM MSysObjects, MSysACEs,"
      SQL = SQL &amp; " MSysObjects INNER JOIN MSysACEs ON"
      SQL = SQL &amp; " MSysObjects.Id = MSysACEs.ObjectID"
      SQL = SQL &amp; " WHERE ((MSysObjects.Name= '" &amp; TableName &amp; "'));"

      DoCmd RunSQL SQL

   ' SQL statement to delete references to indexes in MSysIndexes follows:

      SQL = "DELETE DISTINCTROW MSysObjects.Name, MSysIndexes.*"
      SQL = SQL &amp; " FROM MSysObjects, MSysIndexes,"
      SQL = SQL &amp; " MSysObjects INNER JOIN MSysIndexes ON"
      SQL = SQL &amp; " MSysObjects.Id = MSysIndexes.ObjectId"
      SQL = SQL &amp; " WHERE ((MSysObjects.Name= '" &amp; TableName &amp; "'));"

      DoCmd RunSQL SQL

   ' SQL statement to delete references to table object from MSysObjects
   ' follows:

      SQL = "DELETE DISTINCTROW MSysObjects.Name "
      SQL = SQL &amp; " FROM MSysObjects"
      SQL = SQL &amp; " WHERE ((MSysObjects.Name = '" &amp; TableName &amp; "'));"

      DoCmd RunSQL SQL

   ' If you decide to update the Database window, include the following
   ' command:

      SendKeys "{F11} %VQ%VT"'

   ' Test to make sure the object was deleted, then exit.

      If DCount("[Name], "MSysObjects", "[Name] = '" _
            &amp; TableName &amp; "'") = 0 Then
         DeleteTable = True
         Exit Function
      EndIf

   ' If error occurs, display the error message and terminate with error.
   DeleteErrorProc:
      Msg = "An unexpected error has occurred." &amp; Chr(13) &amp; Chr(10)
      Msg = Msg &amp; "Error: " &amp; Error$
         MsgBox Msg
      DeleteTable = False
      Exit Function
   End Function

</PRE></OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "User's Guide," version 1.0, chapter 25
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: functions sysfiles<BR>
Keywords            : kbprg PgmHowTo PgmObj<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
