

<HTML>
<HEAD>
<TITLE>ACC95: ShowToolbar May Not Show Library Database Custom Toolbars </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q153673">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1996/07/12">
<META NAME="Keywords" CONTENT="GnlApp kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The ShowToolbar action does not show custom toolbars that are stored in library databases, unless the library database is loaded as an add-in.  CAUSE =====  Microsoft Access...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBOG,QBJZ,QAF0,QA1S,QANS,QBWS,QAZV,QBHQ,QDN9,QAH4,QA7O,QA7N,QAY5,QBVV,QA5V V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: ShowToolbar May Not Show Library Database Custom Toolbars</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q153673</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The ShowToolbar action does not show custom toolbars that are stored in
library databases, unless the library database is loaded as an add-in.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft Access version 2.0 and Microsoft Access version 7.0 differ in the
way they load library databases. For performance reasons, Microsoft Access
7.0 does not load a library database into memory until code in an active
application calls that library. Code in the library database can open
objects, such as forms and reports, but the ShowToolbar action will not
show or hide a toolbar unless the library database was loaded as an add-in.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
The following example creates a database that can be loaded with the Add-in
Manager:

<OL><P><LI>Create a new database called Toolbars. Save it as type Add-ins (*.mda).

<P><LI>If the system tables are not displayed, on the Tools menu, click
    Options. On the View tab, click to select System Objects, and then
    click OK.

<P><LI>On the File menu, click Database Properties. In the Properties dialog
    box, click the Summary tab, and then type "Custom Toolbars" (without
    the quotation marks) in the Title box. Click OK.

<P><LI>Create a new table called UsysRegInfo with the following structure:
<P>
       Table: UsysRegInfo
       ----------------------------
       Field Name: Subkey
<PRE>          Data Type: Text
          Field Size: 255
       Field Name: Type
          Data Type: Number
          Field Size: Long Integer
       Field Name: ValName
          Data Type:  Text
          Field Size: 255
       Field Name: Value
          Data Type: Text
          Field Size: 255

</PRE><P><LI>Enter three records into the UsysRegInfo table. The Subkey for all
    three records should be:
<P>
       HKEY_CURRENT_ACCESS_PROFILE\Menu Add-Ins\Custom Toolbars
<P>
    The values in the other fields for each record should be as follows:
<P>
<PRE>       Subkey         Type           ValName          Value
       -----------    ----           -------          -----
       (see above)    0
       (see above)    1              Expression       =LoadToolbars()
       (see above)    1              Library |ACCDIR\Toolbars.mda

</PRE><P><LI>On the View menu, click Toolbars. In the Toolbars dialog box, click
    New. In the New Toolbar dialog box, type "NewBar" (without the
    quotation marks), and then click OK. Note that a new, blank Toolbar
    appears. Click Customize, and drag a few buttons to the new, blank
    Toolbar. Close the Customize Toolbars dialog box.

<P><LI>Create a new module with the following function:
<P>
       Function LoadToolbars()
<PRE>          DoCmd.ShowToolbar "NewBar"
       End Function

</PRE><P><LI>Compile and save this module.

<P><LI>Close Toolbars.mda.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>On the Tools menu, point to Add-ins, and then click Add-in Manager. A
    list of available Add-ins will appear. "Custom Toolbars" will be in the
    list if Toolbars.mda was saved in the Access directory. If it is not in
    the list, click Add New, find and select Toolbars.mda, and then click
    OK. Select "Custom Toolbars," and click OK. An X should appear to the
    left of the library database in the Add-in Manager dialog box,
    indicating that it has been installed.

<P><LI>Close the Add-in Manager.

<P><LI>On the Tools menu, point to Add-ins. Custom Toolbars should now appear
    in the list of add-ins. Click Custom Toolbars. The new toolbar, NewBar,
    should appear.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new database called Toolbars.mda.

<P><LI>On the View menu, click Toolbars. Click New. Create a new toolbar and
   call it NewBar. Click Customize. Drag a few buttons to the new toolbar.
   Close the Customize Toolbars window.

<P><LI>Create a new module with the following function:
<P>
<P><PRE>      Function LoadToolbars()
<PRE></PRE>         docmd.ShowToolBar "NewBar"
      End Function

</PRE><P><LI>Close Toolbars.mda.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Click the Modules tab and open the Utility Functions module in Design
   view. On the Tools menu, click References. In the References dialog box,
   click the Browse button, find, and click to select Toolbars.mda. Once it
   is added to the available references list, click OK.

<P><LI>Press CTRL+G to open up the Debug window.

<P><LI>In the Debug window, type the following line,  and then press ENTER:
<P>
<P><PRE>      ?LoadToolbars()
</PRE><P>
   Note that you receive the following error message:
<P>
<P><PRE>      Run-time error '2094':
      Microsoft Access can't find the toolbar 'NewBar.'
</PRE><P>
</OL>NOTE: An easy way to make custom toolbars available to all databases is to
use the built-in Utility1 and Utility2 toolbars. In addition, custom
toolbars in other Microsoft Access databases can be imported into the
current database.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"Building Applications with Microsoft Access for Windows 95", Chapter 12,
"Using Library Databases and Dynamic-Link Libraries", page 295, and Chapter
16, "Creating Wizards, Builders, and Add-ins", pages 359-375
<P>
For more information about creating and testing Add-ins, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q143270.htm">Q143270</A></B>
   TITLE     : ACC95: Creating and Testing Add-ins Paper Available on MSL

</PRE></OL>For more information about the UsysRegInfo table, search on "USysRegInfo"
using the Microsoft Access for Windows 95 Help Index.
<P>
For more information about using Utility Toolbars, search on "Utility
Toolbars," using the Microsoft Access for Windows 95 Help Index.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Run-time add-in<BR>
Keywords            : GnlApp kberrmsg kbusage<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
