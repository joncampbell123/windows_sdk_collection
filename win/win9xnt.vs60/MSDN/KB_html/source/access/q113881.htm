

<HTML>
<HEAD>
<TITLE>ACC: How to Retrieve the MS Access Window Handle (1.x/2.0) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113881">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes a sample user-defined Access Basic function that you can use to get the handle to the Microsoft Access window. This article also describes how to use ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAY5,QDN9,QAB9,QBV8,QA4Q,QAH4,QDL9,QBWO,QBWN,QAGQ,QBW1,QA5F,QAUD,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Retrieve the MS Access Window Handle (1.x/2.0)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113881</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes a sample user-defined Access Basic function that you
can use to get the handle to the Microsoft Access window. This article also
describes how to use the sample function to:

<UL><LI>Minimize, maximize, and restore the Microsoft Access window

<LI>Determine if the Microsoft Access window is minimized, maximized or
   restored

<LI>Move and size the Microsoft Access window
<P>
</UL>This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x, or the "Building Applications" manual in version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Every window in the Microsoft Windows environment has a unique number, or
window handle, assigned to it that is used to identify the window. The
window handle is a required argument for many Microsoft Windows application
programming interface (API) functions.
<P>
The following steps describe how to create the sample function
GetAccesshWnd() that you can use to get the Microsoft Access window handle:
<P>
NOTE: You may have some Microsoft Windows API functions defined in an
existing  Microsoft Access library; therefore, your declarations may be
duplicates. If you receive a duplicate procedure name error message,
remove or comment out the declarations statement in your code.
<P>
NOTE: In the following sample code, an underscore (_) is used as a line-
continuation character. Remove the underscore when re-creating this code
in Access Basic.

<OL><P><LI>Create a new module.

<P><LI>Add the following lines to the module's Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Declare Function GetActiveWindow Lib "User" () As Integer
      Declare Function GetParent Lib "User" (ByVal hWnd As Integer) _
<PRE></PRE>         As Integer

</PRE><P><LI>Enter the following function in the module:
<P>
<P><PRE>      Function GetAccesshWnd ()
<PRE></PRE>         Dim hWnd As Integer
         Dim hWndAccess As Integer

         ' Get the handle to the currently active window.
         hWnd = GetActiveWindow()
         hWndAccess = hWnd

         ' Find the top window without a parent window.
         While hWnd &lt;&gt; 0
            hWndAccess = hWnd
            hWnd = GetParent(hWnd)
         Wend

         GetAccesshWnd = hWndAccess

      End Function

</PRE></OL><h3>How to Use the GetAccesshWnd() Function</h3>
 
<P>
General Use:

<OL><P><LI>Choose Immediate Window from the View menu in the module's Design view.

<P><LI>Type the following and then press ENTER:
<P>
<P><PRE>      ? GetAccesshWnd()
</PRE><P>
   The window handle for the Immediate window will be returned.
<P>
</OL>How to Minimize, Maximize, or Restore the Microsoft Access Window:

<OL><P><LI>Add the following to the module's Declarations section:
<P>
<P><PRE>      Declare Function ShowWindow% Lib "User" (ByVal hWnd%, _
<PRE></PRE>         ByVal nCmdShow%)

      Global Const SW_MAXIMIZE = 3
      Global Const SW_SHOWNORMAL = 1
      Global Const SW_SHOWMINIMIZED = 2

</PRE><P><LI>Enter the following functions in the module:
<P>
<P><PRE>      Function AccessMinimize()
<PRE></PRE>         AccessMinimize = ShowWindow(GetAccesshWnd(), SW_SHOWMINIMIZED)
      End Function

      Function AccessMaximize()
         AccessMaximize = ShowWindow(GetAccesshWnd(), SW_MAXIMIZE)
      End Function

      Function AccessRestore()
         AccessRestore = ShowWindow(GetAccesshWnd(), SW_SHOWNORMAL)
      End Function

</PRE><P><LI>To run these functions, type "? &lt;function name&gt;()" (without quotation
   marks) in the module's Immediate window.
<P>
</OL>How to Determine If the Microsoft Access Window Is Minimized, Maximized, or
Restored:

<OL><P><LI>Add the following to the module's Declarations section:
<P>
<P><PRE>      Declare Function IsIconic Lib "User" (ByVal hWnd As Integer) _
<PRE></PRE>         As Integer
      Declare Function IsZoomed Lib "User" (ByVal hWnd As Integer) _
         As Integer

</PRE><P><LI>Enter the following functions in the module:
<P>
<P><PRE>      Function IsAccessMaximized ()
<PRE></PRE>         If IsZoomed(GetAccesshWnd()) = 0 Then
            IsAccessMaximized = False
         Else
            IsAccessMaximized = True
         End If
      End Function

      Function IsAccessMinimized ()
         If IsIconic(GetAccesshWnd()) = 0 Then
            IsAccessMinimized = False
         Else
            IsAccessMinimized = True
         End If
      End Function

      Function IsAccessRestored ()
         If IsAccessMaximized() = False And _
               IsAccessMinimized() = False Then
            IsAccessRestored = True
         Else
            IsAccessRestored = False
         End If
      End Function

</PRE><P><LI>To run these functions, type "? &lt;function name&gt;()" (without the
   quotation marks) in the module's Immediate window. For example, type
<P>
<P><PRE>      ? IsAccessMaximized()
</PRE><P>
   to return a -1 if the Microsoft Access window is maximized, or a 0 if it
   is not.
<P>
</OL>How to Move and Size the Microsoft Access Window:

<OL><P><LI>Add the following to the module's Declarations section:
<P>
<P><PRE>      Declare Sub MoveWindow Lib "User" (ByVal hWnd As Integer, _
<PRE></PRE>         ByVal X As Integer, ByVal Y As Integer, _
         ByVal nWidth As Integer, ByVal nHeight As Integer, _
         ByVal bRepaint As Integer)

</PRE><P><LI>Enter the following function in the module:
<P>
<P><PRE>      Function AccessMoveSize (iX As Integer, iY As Integer, _
<PRE></PRE>         iWidth As Integer, iHeight As Integer)
         MoveWindow GetAccesshWnd(), iX, iY, iWidth, iHeight, True
      End Function

</PRE></OL>To move the Microsoft Access window to the upper left corner of the screen
and size it to the standard VGA display size of 640 x 480 pixels, type the
following in the module's Immediate window:
<P>
<PRE>   ? AccessMoveSize(0, 0, 640, 480)

</PRE>On a computer configured with the standard VGA video driver, this will give
the Microsoft Access window the appearance of being maximized, although it
is really restored and sized to fill the screen. Note that the dimensions
you supply to this function are in pixels.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Window handles in Microsoft Access version 7.0,
please see the following article here in the Microsoft Knowledge Base.
<P>
<PRE>    ARTICLE-ID: <B><A href="../vbapps/q147214.htm">Q147214</A></B>
    TITLE:      ACC95: How to Retrieve and Use the MS Access Window
                Handle
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: hWnd hWindow hWin<BR>
Keywords            : kbprg PgmApi<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
