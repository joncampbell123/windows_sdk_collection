

<HTML>
<HEAD>
<TITLE>ODE97: OutputTo Action Was Canceled Error in Run-time App </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q173334">
<META NAME="KBModify" CONTENT="1997/09/02">
<META NAME="KBCreate" CONTENT="1997/08/29">
<META NAME="Keywords" CONTENT="OtpGnrl OtpProb">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the OutputTo method or RunCommand method in a Microsoft Access 97 run-time application, you may receive the following error message:     The OutputTo action was canc...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QANE,QAPN,QDN9,QBWS,QAFI,QAGB,QAA1,QACF,QA2Q,QAB5,QBJZ,QDIV,QAUR,QAJH P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ODE97: OutputTo Action Was Canceled Error in Run-time App</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q173334</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
<LI>Microsoft Office Developer Edition 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the OutputTo method or RunCommand method in a Microsoft Access
97 run-time application, you may receive the following error message:
<P>
<PRE>   The OutputTo action was canceled.

   -or-

   The RunCommand action was canceled.

</PRE>This article assumes that you are familiar with Visual Basic for
Applications and with creating Microsoft Access applications using the
programming tools provided with Microsoft Access. For more information
about Visual Basic for Applications, please refer to the "Building
Applications with Microsoft Access 97" manual.
<P>
<P><h2>CAUSE</h2>
 
<P>
Your computer has only a run-time version of Microsoft Access 97 installed,
and you are using an action or method that prompts the user for an input or
output file name. For example, if you use the OutputTo method and leave the
Outputfile argument blank, Microsoft Access prompts you for an output file
name.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Explicitly supply the file name so that Microsoft Access does not have to
prompt the user for one. If you want to prompt the user for a file name,
you can use the ShowOpen or ShowSave methods of the Common Dialog ActiveX
control.
<P>
The following steps demonstrate how to use the Common Dialog ActiveX
control to prompt the user for an output file name and type, and then how
to supply it to the OutputTo method.

<OL><P><LI>Start Microsoft Access 97.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Open a new, blank form in Design view.

<P><LI>On the Insert menu, click ActiveX Control.

<P><LI>In the Insert ActiveX Control dialog box, select Microsoft Common
    Dialog Control, version 5.0, and then click OK.

<P><LI>Set the Name property of the Common Dialog control to "cmndlg" (without
    the quotation marks).

<P><LI>Add a command button to the form, and set the Name property to
    Command0.

<P><LI>Set the command button's OnClick property to the following event
    procedure:
<P>
       Private Sub Command0_Click()
<PRE>          Dim oCmnDlg As CommonDialog
          Dim strFormat As String
          Dim strFileName As String
          Set oCmnDlg = Me!cmndlg.Object
          On Error GoTo Export_Err
          With oCmnDlg
             ' Clear the file name before prompting.
             .FileName = ""
             ' Prompt the user if the file already exists.
             .flags = cdlOFNOverwritePrompt + cdlOFNHideReadOnly
             ' Determine if the cancel button was pressed.
             .CancelError = True

             .Filter = _
             "MS-DOS Text (*.txt)|*.txt|Rich Text Format (*.rtf)|*.rtf" _
             &amp; "|Microsoft Excel (*.xls)|*.xls"

             .FilterIndex = 1

             ' Default the initial directory to "C:\My Documents".
             .InitDir = "C:\My Documents"
             .ShowSave

             ' Determine what file type was selected; then save the
             ' file in that format.
             Select Case .FilterIndex
                Case 1 ' MS-DOS Text Format.
                   strFormat = acFormatTXT

                Case 2 ' Rich Text Format.
                   strFormat = acFormatRTF

                Case 3 ' Microsoft Excel Format.
                   strFormat = acFormatXLS
             End Select
             strFileName = .FileName
          End With
          DoCmd.OutputTo acOutputTable, "Customers", _
             strFormat, strFileName
          Exit Sub

       Export_Exit:
          Exit Sub

       Export_Err:
          ' Check to see if the cancel button was pressed.
          If Err.Number = 32755 Then
             Resume Export_Exit
          Else
             MsgBox Err.Number &amp; ",    " &amp; Err.Description
          End If
          Resume Export_Exit
       End Sub

</PRE><P><LI>Close and save the form as Form1.

<P><LI>On the Tools menu, click Startup.

<P><LI>In the Startup dialog box, select the Form1 form from the Display Form
    combo box, and then click OK.

<P><LI>Close the database.

<P><LI>Use the ODE Setup Wizard to create a new set of disk images for the
    application. Add Northwind.mdb and Comdlg32.ocx to the list of files
    to distribute with the application. Select Northwind.mdb as the
    application's main file, and create a shortcut that uses the Run-time
    option to open Northwind.mdb.

<P><LI>Install the application on a computer that has never had the retail
    version of Microsoft Access 97 installed.

<P><LI>Start the application. When the startup form appears, click the
    command button.

<P><LI>Select an output file name, and a file type from the Save As Type
    list, and then click Save.
<P>
    Note that the Customers table is saved to the file name and type that
    you selected in the Common Dialog ActiveX control.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
Using the following arguments of the RunCommand method result in a prompt
for an input or output file name:
<P>
<PRE>   acCmdCreateReplica
   acCmdEncryptDecryptDatabase
   acCmdImport
   acCmdLinkTables

</PRE></OL><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access 97.

<P><LI>Open the sample database Northwind.mdb.

<P><LI>Open a new, blank form in Design view.

<P><LI>Create a command button, and set the OnClick property to the following
    event procedure:
<P>
<PRE>       Sub Command0_Click()
          DoCmd.OutputTo acOutputTable, "Customers", acFormatTXT
       End Sub

</PRE><P><LI>Open the form in Form view.

<P><LI>Click the command button.
<P>
    Note that Microsoft Access prompts you for the location of the output
    file name.

<P><LI>Choose a destination output file, and then click OK. This should
    successfully output the Customers table to the file you selected.

<P><LI>Close and save the form as Form1.

<P><LI>On the Tools menu, click Startup.

<P><LI>In the Startup dialog box, select the Form1 form from the Display Form
    combo box, and then click OK.

<P><LI>Close the database.

<P><LI>Use the Setup Wizard to create disk images for the Northwind database.
    Be sure to select Northwind.mdb as the application's main file, and
    create a shortcut that uses the Run-time option to open Northwind.mdb.

<P><LI>Install the application on a computer that has never had the retail
    version of Microsoft Access 97 installed.

<P><LI>Start the application. When the startup form is displayed, click the
    command button.
<P>
    Note that you receive the message "The OutputTo action was canceled,"
    and then the application terminates.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the OutputTo method, search the Help Index for
"OutputTo method," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the RunCommand method, search the Help Index for
"RunCommand method," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the Common Dialog ActiveX control, search the
Help Index for "CommonDialog control," or ask the Microsoft Access 97
Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: prb ode<BR>
Keywords          : OtpGnrl OtpProb<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
