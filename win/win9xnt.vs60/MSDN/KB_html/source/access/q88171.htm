

<HTML>
<HEAD>
<TITLE>ACC: Using SetSysModalWindow() API Call in Access Basic </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88171 ">
<META NAME="KBModify" CONTENT="1997/11/12">
<META NAME="KBCreate" CONTENT="1992/08/19">
<META NAME="Keywords" CONTENT="kbprg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  In Microsoft Access Basic, you can make an application modal so that users cannot switch to other Windows-based programs while the Microsoft Access application is active. Th...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QDL9,QBWO,QBWN,QAY5,QBV8,QA5F,QAB9,QAMA,QBWQ,QAJH,QAH4,QDIT,QAGU V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Using SetSysModalWindow() API Call in Access Basic</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88171 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
In Microsoft Access Basic, you can make an application modal so that users
cannot switch to other Windows-based programs while the Microsoft Access
application is active. This functionality is achieved with the following
Windows application program interface (API) functions:
<P>
<PRE>   SetSysModalWindow()

    -and-

   FindWindow()

</PRE>This article discusses the use of the SetSysModalWindow() API function
and provides an example of its use in Access Basic.
<P>
NOTE: The SetSysModalWindow() API function is not supported under Win32.
As a result, you cannot use this function with Microsoft Access for
Windows 95 version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Windows is designed so that the user can switch between
applications without terminating one program to run another. There may be
times, however, when a Microsoft Access application needs to restrict the
user from switching to another application. Examples of this are a
security system or time-critical application that needs to run
uninterruptedly.
<P>
<P><h3>SetSysModalWindow() Function Usage Notes</h3>
 
<P>
Consider all of the following usage notes before making a window
system-modal:

<OL><P><LI>If an application passes the handle of the window as an argument
   to the SetSysModalWindow() function, the user is limited to that
   window. This prevents the user from moving to other applications or
   bringing up the Task List (either with the mouse or by pressing
   CTRL+ESC).

<P><LI>If an application uses the SetSysModalWindow function in
   conjunction with the GetSystemMenu() function, the Control (system)
   menu is disabled and the user is prevented from quitting Windows
   by pressing ALT+F4.

<P><LI>A window that is system-modal cannot be minimized, maximized, moved,
   or sized. Microsoft Access Help is created with a separate Windows
   Help file; therefore, help windows created with the Windows Help
   Compiler are not available to the user.

<P><LI>When an application uses the SetSysModalWindow() API function, the
   system-modal window must be closed before other applications or
   windows can be accessed. Therefore, when using this function, be
   sure that the application has a means to exit Microsoft Access.

<P><LI>Any child window that is created by a system-modal window becomes
   a system-modal window. For example, if Microsoft Access is system-
   modal and a form is opened, that form becomes system-modal until
   it is closed.
<P>
</OL><h3>How to Use the SetSysModalWindow() Function</h3>
 
<P>
To use the SetSysModalWindow() API function within Access Basic, create
the sample code below.
<P>
NOTE: In this sample code, an underscore (_) is used as a line
continuation character. Remove the underscore from the end of the line
when re-creating this code in Access Basic.

<OL><P><LI>Type the following lines in the Declarations section:
<P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>       Declare Function SetSysModalWindow% Lib "User" ( _
<PRE></PRE>                      ByVal hwnd%)

       Declare Function FindWindow% Lib "User" (_
                      ByVal lpszClassName As Any, _
                      ByVal lpszWindow As Any)

</PRE><P><LI>Type the following procedure:
<P>
<P><PRE>      Function System_Modal_Test ()
</PRE><P>
<PRE>        Const lpClassName = "OMain"
        ' Declares the class name constant used in
        ' the FindWindow() API function.

        Dim AccessHandle
        Dim Success As Integer

        ' The FindWindow() functions returns the handle for Microsoft
        ' Access.
        AccessHandle = FindWindow(lpClassName, 0&amp;) 'Note this is a zero

        ' The handle for Microsoft Access is sent; then, Microsoft Access
        ' becomes modal.
        Success = SetSysModalWindow(AccessHandle)

      End Function

</PRE><P><LI>Save the module as Modal Access, and then choose the OK button.

<P><LI>From the Run menu, choose Compile All.

<P><LI>Type the following line in the Immediate window, and then press ENTER:
<P>
<P><PRE>      ?System_Modal_Test()
</PRE><P>
</OL>After running the program, test the modal functionality by trying to
select other windows or resize or move the system-modal window.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about the Modal property, search for "Modal," and
then "Modal Property" using the Microsoft Access Help menu.
<P>
For more information about API functions, refer to:

<UL><LI>"Microsoft Windows Software Development Kit," Microsoft Press, 1992

<LI>"Programming Windows: The Microsoft Guide to Writing Applications
   for Windows 3," Charles Petzold, Microsoft Press, 1990

<LI>"Programmer's Reference Library: Microsoft Windows 3.1 Guide to
   Programming Reference," Volumes 1-6, Microsoft Press, 1992
</UL> 
<PRE>Keywords          : kbprg
Version           : 1.0 1.1 2.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
