

<HTML>
<HEAD>
<TITLE>ACC2: How to Create Running Totals in a Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132134">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1995/06/29">
<META NAME="Keywords" CONTENT="kbusage QryTotal">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates two methods you can use to create a running totals query; that is, the total for each record is a summation of that record and any previous records. Thi...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QADP,QA7O,QA7N,QAGF,QA5V,QAE5,QBWS,QAB9,QAB6,QANX,QBJZ,QAPF,QACE,QACF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: How to Create Running Totals in a Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132134</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates two methods you can use to create a running
totals query; that is, the total for each record is a summation of that
record and any previous records. This type of query is useful for
displaying cumulative totals over a group of records (or over a period of
time) in a graph or report.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1</h3>
 
<P>
The first method uses a DSum() function and criteria in a query to create a
running sum over time. The DSum() function sums the current record and any
previous records. When the query moves to the next record, the DSum()
function runs again and updates the cumulative total.
<P>
The following sample query uses the Orders table from the sample
database NWIND.MDB to create a running sum of the freight costs for
each month in 1991. The sample data is limited to one year for performance
reasons. Because the DSum() function runs once for every record in the
query, it may take several seconds (depending on the speed of your
computer) for the query to finish processing. To create and run this query,
follow these steps:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new Select query and add the Orders table.

<P><LI>On the View menu, click Totals.

<P><LI>In first column of the QBE grid, type the following expression in the
   Field box, and make the following selections for the Total, Sort, and
   Show boxes:
<P>
<P><PRE>      Field: AYear: DatePart("yyyy",[Order Date])
<PRE></PRE>         Total: Group By
         Sort: Ascending
         Show: Yes

   The expression in the Field box displays and sorts the year portion of
   the Order Date field.

</PRE><P><LI>In the second column of the QBE grid, type the following expression in
   the Field box, and make the following selections for the Total, Sort,
   and Show boxes:
<P>
<P><PRE>      Field: AMonth: DatePart("m",[Order Date])
<PRE></PRE>         Total: Group By
         Sort: Ascending
         Show: Yes

   The expression in the Field box sorts and displays the month portion
   of the Order Date field as an integer value from 1 to 12.

</PRE><P><LI>In the third column of the QBE grid, type the following expression in
   the Field box, and make the following selections for the Total and Show
   boxes.
<P>
   NOTE: In the following expression, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this expression.
<P>
<P><PRE>     Field: RunTot: DSum("Freight","Orders","DatePart('m', _
<PRE></PRE>        [Order Date])&lt;=" &amp; [AMonth] &amp; " And  DatePart('yyyy', _
        [Order Date])&lt;=" &amp; [AYear] &amp; "")
        Total: Expression
        Show: Yes

   The expression in the Field box uses the DSum() function to sum the
   Freight field when the values in both the AMonth and the AYear fields
   are less than or equal to the current record that the query is
   processing.

</PRE><P><LI>In the fourth column of the QBE grid, type the following expression in
   the Field box, and make the following selections for the Total, Sort,
   and Show boxes:
<P>
<P><PRE>      Field: FDate: Format([Order Date],"mmm")
<PRE></PRE>         Total: Group By
         Sort: Ascending
         Show: Yes

   The expression in the Field box displays each month in a textual format,
   such a Jan, Feb, Mar, and so on.

</PRE><P><LI>In the fifth column of the QBE grid, type the following expression in
   the Field box, and make the following selections for the Total,
   Criteria, and Show boxes:
<P>
<P><PRE>      Field: DatePart("yyyy",[Order Date])
<PRE></PRE>         Total: Where
         Criteria: 1991
         Show: No

   The expression in the Field box filters the query's recordset to include
   only data from 1991.

</PRE><P><LI>Run the query. Note that the RunTot field displays the following records
   with a running sum:
<P>
<PRE>      AYear   AMonth   RunTot    FDate
      --------------------------------

      1991    5        514.17    May
      1991    6        1225.75   Jun
      1991    7        2133.33   Jul
      1991    8        3041.5    Aug
      1991    9        4052.12   Sep
      1991    10       7345.04   Oct
      1991    11       8140.26   Nov
      1991    12       8933.32   Dec

</PRE></OL><h2>Method 2</h2>
 
<P>
The second method uses a totals query with a DSum() function to create a
running total over a group.
<P>
The following sample query uses the Orders table to sum freight costs per
employee as well as to calculate a running sum of the freight. To create
and run the query, follow these steps:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new select query and add the Orders table.

<P><LI>On the View menu, click Totals.

<P><LI>In the first column of the QBE grid, add the following field to the
   Field box, and make the following selections for the Total and Show
   boxes:
<P>
<P><PRE>      Field: EmpAlias: Employee ID
<PRE></PRE>         Total: Group By
         Show: Yes

   This field groups data by Employee ID.

</PRE><P><LI>In the second column of the QBE grid, add the following field to the
   Field box, and make the following selections for the Total and Show
   boxes:
<P>
<P><PRE>      Field: Freight
<PRE></PRE>         Total: Sum
         Show: Yes

   This field sums the freight data.

</PRE><P><LI>In the third column of the QBE grid, type the following expression in
   the Field box, and make the following selections for the Total and Show
   boxes.
<P>
   NOTE: In the following expression, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this expression.
<P>
<P><PRE>      Field: RunTot: Format(DSum("Freight","Orders","[Employee ID]&lt;=" _
<PRE></PRE>         &amp; [EmpAlias] &amp; ""),"$0,000.00")
         Total: Expression
         Show: Yes

   The expression in the Field box uses a DSum() function to sum the
   Freight field when the Employee ID is less than or equal to the current
   EmpAlias, and then formats the field in dollars.

</PRE><P><LI>Run the query. Note that the RunTot field displays the following records
   with a running sum:
<P>
<PRE>      EmpAlias   SumOfFreight   RunTot
      ------------------------------------

      1          $10,450.91     $10,450.91
      2          $10,694.25     $21,145.16
      3          $13,347.13     $34,492.29
      4          $14,046.90     $48,539.19
      5          $4,352.02      $52,891.21
      6          $4,344.71      $57,235.92
      7          $7,967.62      $65,203.54
      8          $10,084.86     $75,288.40
      9          $3,918.26      $79,206.66

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about a totals query, search for "queries:
calculations," and then "Calculating Totals in a Query" using the Microsoft
Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QryTotal<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
