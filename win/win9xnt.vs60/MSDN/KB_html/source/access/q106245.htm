

<HTML>
<HEAD>
<TITLE>ACC1x: How To Compute Moving Averages in Access Basic (1.x) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q106245">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1993/11/03">
<META NAME="Keywords" CONTENT="kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The following sample Access Basic function computes a moving average for a set of values in a table based on a given period of time. For example, if you have data that has b...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAE5,QA1S,QANJ,QAMA,QAKD,QDN9,QA7O,QA7N,QA5F,QA9N,QAY5,QAEF,QBE7,QBE6,QACI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How To Compute Moving Averages in Access Basic (1.x)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q106245</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The following sample Access Basic function computes a moving average for a
set of values in a table based on a given period of time. For example, if
you have data that has been collected weekly for the past year, and you
want to compute a historical average for a three-week time period on each
value, you can use this function to return an average for each value in the
table based on the current value and the values from the two previous
weeks.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x.
<P>
The sample function below computes moving averages based on a table with a
multiple-field primary key. The weekly values of foreign currencies are
used for this example.

<OL><P><LI>Create the following table. Save the table as Table 1.
<P>
<P><PRE>      Table: Table 1
      -----------------------------------------
      Field Name: CurrencyType [Primary Key]
      Data Type: Text
      Field Size: 25
</PRE><P>
<P><PRE>      Field Name: TransactionDate [Primary Key]
      Data Type: Date/Time
      Format: Short Date
</PRE><P>
<P><PRE>      Field Name: Rate
      Data Type: Currency
      Decimal Places: 4
</PRE>
<P><LI>View the table in Datasheet view, and type the following values:
<P>
<PRE>      CurrencyType     TransactionDate     Rate
      --------------------------------------------
      Yen              8/6/93              $0.0079
      Yen              8/13/93             $0.0082
      Yen              8/20/93             $0.0085
      Yen              8/27/93             $0.0088
      Yen              9/3/93              $0.0091
      Mark             8/6/93              $0.5600
      Mark             8/13/93             $0.5700
      Mark             8/20/93             $0.5800
      Mark             8/27/93             $0.5900
      Mark             9/3/93              $0.6000

</PRE><P><LI>Open a new module and type the following functions:
<P>
<P><PRE>      '*************************************************************
      'Declarations section of the module.
      '*************************************************************
</PRE><P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      '===============================================================
      ' The following function MAvgs computes moving averages based on
      ' a table with a multiple field primary key.
      '===============================================================
</PRE><P>
<P><PRE>      Function MAvgs(Periods As Integer, StartDate, TypeName)
<PRE></PRE>         Dim MyDB As DATABASE, MyTable As TABLE, MySum As Double
         Dim i, x
         Set MyDB = CurrentDb()
         Set MyTable = MyDB.OpenTable("Table 1")
         On Error Resume Next
         MyTable.Index = "PrimaryKey"
         x = Periods - 1
         ReDim Store(x)
         MySum = 0
         For i = 0 To x
           MyTable.MoveFirst
           MyTable.Seek "=", TypeName, StartDate
                ' These two variables should be in the same order as the
                ' primary key fields in your table.
            Store(i) = MyTable![Rate]
            If i &lt;&gt; x Then StartDate = StartDate - 7
                '7 here assumes weekly data; you would use 1 for daily
                '  data.
            If StartDate &lt; #8/6/93# Then MAvgs = Null: Exit Function
                '#8/6/93# is replaced with the earliest date of the data
                '  in your table.
            MySum = Store(i) + MySum
            Next i
         MAvgs = MySum / Periods
         MyTable.Close
      End Function

</PRE><P><LI>Create the following query based on Table 1:
<P>
<P><PRE>      Query: Query1
      ------------------------------------------------------
      Field: CurrencyType
      Field: TransactionDate
      Field: Rate
      Field: Expr1: MAvgs(3,[TransactionDate],[CurrencyType])
</PRE><P>
   NOTE: This query will generate a 3-week moving average of the Rate data.
   To compute a longer or shorter moving average, change the "3" in the
   query's Expr1 column to the value you want to compute.

<P><LI>Run the query.
<P>
</OL>You will see a 3-week moving average for each currency. A null indicates
that there were not enough prior values to compute that week's average.
<P>
NOTE: If you want to compute a moving average for a table with a single
primary key, use the primary key both as an argument to be passed to the
function and as the key value for the Seek method.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: rolling<BR>
Keywords            : kbprg PgmHowTo<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
