

<HTML>
<HEAD>
<TITLE>ACC2: Reference to Field's Caption Property Can Cause an Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132019">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1995/06/26">
<META NAME="Keywords" CONTENT="kberrmsg kbprg MdlDao TblFldp">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  You may receive an error message if you reference a field's Caption property when the following two conditions are true for the Caption property:   - The Caption property of...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QAPN,QA1S,QAVX,QAVW,QDN9,QA39,QAB4,QBXS,QADK,QAZV,QARR,QDKY,QA7O,QA7N V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Reference to Field's Caption Property Can Cause an Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132019</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
You may receive an error message if you reference a field's Caption
property when the following two conditions are true for the Caption
property:

<UL><LI>The Caption property of a local table is null.

<LI>The Caption property is not null, but belongs to an attached table.
<P>
</UL>The error message occurs because, to Microsoft Access, the Caption property
does not exist if it has not been assigned a value. Therefore, you must
ensure that your code traps the error that results when a Caption property
contains a Null value. If the Caption property belongs to an attached
table, the error trapping routine must also use the OpenDatabase method.
<P>
NOTE: Although this article focuses on the Caption property, this
information also applies to other Microsoft Access application-defined
properties of the Field object.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Local Table</h3>
 
<P>
To determine if the Caption property from a local table contains a Null
value, follow these steps.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Create new database and save it as CAPTION1.MDB.

<P><LI>Import the Products table from the sample database NWIND.MDB.

<P><LI>Rename the table LocalProducts.

<P><LI>Attach the Products table from the sample database NWIND.MDB.

<P><LI>Rename the table AttachedProducts.

<P><LI>Create the following form:
<P>
      Form: Test1
      ------------------
      Caption: TestForm1
<P>
      Command button:
<PRE>         Name: ButtonTest
         Caption: Test
         OnClick: [Event Procedure]

</PRE><P><LI>Set the command button's OnClick property to the following event
    procedure.
<P>
    NOTE: In the following sample code, an underscore (_) at the end of a
    line is used as a line-continuation character. Remove the underscore
    from the end of the line when re-creating this code.
<P>
<PRE>      Sub ButtonTest_Click ()
         On Local Error Resume Next
         Dim i As Integer, UserMessage As String
         Dim db As Database, tdef As TableDef
         Dim fld As Field, prp As Property
         Dim TestCaption As String
         Set db = dbEngine.Workspaces(0).Databases(0)

         ' Test the local table.
         Set tdef = db.Tabledefs("LocalProducts")
         Set fld = tdef.Fields("Product ID")
         TestCaption = fld.Properties("Caption")
         If Err = 3270 Then ' Caption does not exist.
         UserMessage = "The LocalProducts Tables Caption Property_
         is Null!"
      Else
         UserMessage = "The LocalProducts Table's Caption is [" &amp;_
         TestCaption &amp; "]"
      End If
      MsgBox UserMessage

      ' Test the attached table.
      Set tdef = db.Tabledefs("AttachedProducts")
      Set fld = tdef.Fields("Product ID")
      TestCaption = fld.Properties("Caption")
      If Err = 3270 Then ' Caption does not exist
         UserMessage = "The AttachedProducts Table's Caption Property_
         is Null!"
      Else
         UserMessage = "The AttachedProducts Table's Caption is [" &amp;_
         TestCaption &amp; "]"
      End If
      MsgBox UserMessage
      ButtonTest_Click_End:
         Exit Sub
      ButtonTest_Click_Err:
         MsgBox Error$
         Resume ButtonTest_Click_End
      End Sub

</PRE><P><LI>View the Test1 form in Form view and click the Test button. Note that
    the following messages appear:
<P>
       The LocalProducts Table's Caption Property is Null!
       The AttachedProducts Table's Caption Property is Null!

<P><LI>Press the F11 key to switch to the Database window.

<P><LI>Open the LocalProducts table in Design view.

<P><LI>Change the table's Caption property to LocalProducts Caption, and then
    save the table.

<P><LI>View the Test1 form in Form view and click the Test button. Note that
    the following messages appear:
<P>
       The LocalProducts Table's Caption is [LocalProducts Caption]
       The AttachedProducts Table's Caption Property is Null!

<P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Products table in Design view.

<P><LI>Change the table's Caption property to AttachedProducts Caption, and
    then save the table.

<P><LI>Open the CAPTION1.MDB database.

<P><LI>View the Test form in Form view and click the Test button. Note that
    the following messages appear:
<P>
       The LocalProducts Table's Caption is [LocalProducts Caption]
       The AttachedProducts Table's Caption Property is Null!
<P>
</OL><h3>Attached Table</h3>
 
<P>
To determine if the Caption property from an attached table contains a Null
value, you must use the OpenDatabase method in Access Basic. This opens the
database and provides you with the visibility to an external database's
properties.
<P>
To determine if the Caption property from an attached table contains a Null
value, follow these steps.
<P>
NOTE: The code in the following example assumes that the sample database
NWIND.MDB is located in the C:\ACCESS\SAMPAPPS" directory. If NWIND.MDB is
located in a different directory, modify the code accordingly.

<OL><P><LI>Follow steps 1-5 in the "Local Table" section.

<P><LI>Create the following form:
<P>
<P><PRE>      Form: Test2
      ------------------
      Caption: TestForm2
</PRE><P>
<P><PRE>      Command button:
<PRE></PRE>         Name: ButtonTest
         Caption: Test
         OnClick: [Event Procedure]

</PRE><P><LI>Set the command button's OnClick property to the following event
   procedure:
<P>
<PRE>      Sub ButtonTest_Click ()
         On Local Error Resume Next
         Dim i As Integer, UserMessage As String
         Dim db As Database, tdef As TableDef
         Dim fld As Field, prp As Property
         Dim TestCaption As String
         Set db = dbEngine.Workspaces(0).Databases(0)

         ' Test the local table.
         Set tdef = db.Tabledefs("LocalProducts")
         Set fld = tdef.Fields("Product ID")
         TestCaption = fld.Properties("Caption")
         If Err = 3270 Then ' Caption does not exist
            UserMessage = "The LocalProducts Tables Caption Property_
            is Null!"
         Else
            UserMessage = "The LocalProducts Table's Caption is [" &amp;_
            TestCaption &amp; "]"
         End If
         MsgBox UserMessage

         ' Test the attached table using the OpenDatabase method.
         Set db = OpenDatabase("C:\ACCESS\SAMPAPPS\NWIND.MDB")
         Set tdef = db.Tabledefs("Products")
         Set fld = tdef.Fields("Product ID")
         TestCaption = fld.Properties("Caption")
         If Err = 3270 Then ' Caption does not exist.
            UserMessage = "The AttachedProducts Table's Caption Property_
            is Null!"
         Else
            UserMessage = "The AttachedProducts Table's Caption is [" &amp;_
            TestCaption &amp; "]"
         End If
         MsgBox UserMessage
      ButtonTest_Click_End:
         Exit Sub
      ButtonTest_Click_Err:
         MsgBox Error$
         Resume ButtonTest_Click_End
      End Sub

</PRE><P><LI>View the Test2 form in Form view and click the Test button. Note that
   the following message appears:
<P>
<P><PRE>      The LocalProducts Table's Caption is [LocalProducts Caption]
      The AttachedProducts Table's Caption is [AttachedProducts Caption]
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 5, "Access
Basic Fundamentals" pages 113-132
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 7, "Object
and Collections" pages 155-181
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 10,
"Handling Run-Time Errors" pages 221-238
<P>
For more information about the Field object, search for "Field," and then
"Field Object, Fields Collection" using the Microsoft Access Help menu.
<P>
For more information about the Caption Property, search for "Caption," and
then "Caption Property" using the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbprg MdlDao TblFldp<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
