

<HTML>
<HEAD>
<TITLE>ACC97: Dynamic Data Exchange DDE Example Contains Invalid Syntax </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174498">
<META NAME="KBModify" CONTENT="1997/09/30">
<META NAME="KBCreate" CONTENT="1997/09/30">
<META NAME="Keywords" CONTENT="kbother">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  The Microsoft Access 97 Help Topic Example  Dynamic Data Exchange (DDE) Example,  which can be displayed by clicking Example on the following topics,     - DDEEXecute Statement  ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBUF,QBUG,QA1S,QBVP,QAH4,QDN9,QA4Q,QAAP,QAZ2,QAPN,QAPF,QAB4,QAKC,QAB9,QA5F P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Dynamic Data Exchange DDE Example Contains Invalid Syntax</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174498</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
The Microsoft Access 97 Help Topic Example "Dynamic Data Exchange (DDE)
Example," which can be displayed by clicking Example on the following
topics,
<P>
<PRE>   - DDEEXecute Statement
   - DDEInitiate Function
   - DDEPoke Statement
   - DDERequest Function
   - DDETerminate Statement
   - DDETerminateAll Statement

</PRE>contains the following code:
<P>
<PRE>   Sub ExcelDDE()
   Dim intI As Integer, intChan1 As Integer
   Dim strTopics As String, strResp As String, strSheetName As String

   On Error Resume Next      ' Set up error handling.

   intChan1 = DDEInitiate("Excel", "System")   ' Establish link.
   If Err Then                           ' If error occurs, Excel
      Err = 0                     ' may not be running.
                                                ' Reset error
      Shell "C:\Excel\Excel.exe", 1      ' and start spreadsheet.

      If Err Then Exit Sub             ' If another error, exit.

       ' Establish Spreadsheet link.
      intChan1 = DDEInitiate("Excel", "System")
   End If

   ' Create new worksheet.

   DDEExecute intChan1, "[New(1)]"

   ' Get topic list, worksheet name.

   strTopics = DDERequest(intChan1, "Selection")
   strSheetName = Left(strTopics, InStr(1, strTopics, "!") - 1)

   ' Terminate DDE link.
   DDETerminate intChan1

   ' Establish link with new worksheet.
   intChan1 = DDEInitiate("Excel", strSheetName)
   For intI = 1 To 10

      ' Put some values into
      DDEPoke intChan1, "R1C" &amp; intI, intI

   ' first row.
   Next intI

   ' Make chart.
   DDEExecute intChan1, "[Select(""R1C1:R1C10"")][New(2,2)]"

   ' Terminate all links.
   DDETerminateAll
      End Sub

</PRE>The first line of the code, which reads as follows, is incorrect:
<P>
<PRE>    Dim intI As Integer, intChan1 As Integer

</PRE>Change this line to read as follows:
<P>
<PRE>    Dim intI As Long, intChan1 As Long.

</PRE>This change is necessary when working with 32-bit applications.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The Microsoft Access 97 Help Topic "Convert Access Basic Code to Visual
Basic" states the following:
<P>
<PRE>   If you use the DDEInitiate function to open a DDE channel, you can
   declare the variable that stores the channel number, which is a Long
   value, as either a Variant or Long value. In versions 1.x and 2.0 of
   Microsoft Access, the channel number is an Integer value, so you must
   modify any Declaration statements in your code that create variables
   of type Integer to store the channel number.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: ACC97 inf<BR>
Keywords          : kbother<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbdocerr<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
