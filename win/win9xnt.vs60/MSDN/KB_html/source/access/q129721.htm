

<HTML>
<HEAD>
<TITLE>ACC: How to Display and Total Subtotals from Subreports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129721">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1995/05/02">
<META NAME="Keywords" CONTENT="kbusage RptSub">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates how you can use a total from a subreport on a main report and how you can display a total for all the subreports.  MORE INFORMATION  If you use an expre...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QADP,QDMF,QBT6,QAGF,QBV4,QAE5,QBJZ,QAHP,QAPN,QABO,QBCI,QA7O,QDMW,QAMA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Display and Total Subtotals from Subreports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129721</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates how you can use a total from a subreport
on a main report and how you can display a total for all the subreports.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If you use an expression similar to
<P>
<PRE>   =Sum([MySubReport].Report![Product Sales])

</PRE>on a main report to sum a reference to a subreport control that contains a
subtotal, you receive a "#Name?" error message. This error message occurs
because the Sum() function (and the other aggregate functions) can
reference only fields, not controls. To avoid this error, place the sum
expression in the subreport's report footer, and then reference that
expression in the main report.
<P>
CAUTION: Following the steps in the examples below will modify the sample
database Northwind.mdb (or the NWIND.MDB in version 2.0). You may want to
back up the Northwind.mdb or NWIND.MDB file or perform these steps on a
copy of these databases.
<P>
<P><h3>Displaying the Total from a Subreport on a Main Report</h3>
 
<P>
To display the total from a subreport on a main report, follow these steps.

<OL><P><LI>Open the sample database Northwind.mdb, and open the Sales By Category
<P><PRE>    Subreport report in Design view.
</PRE>
<P><LI>Add a report footer section by clicking Report Header/Footer on the
   View menu.
<P>
   NOTE: In version 2.0, click Report Header/Footer on the Format menu.

<P><LI>Set the report header section's Height property to 0.

<P><LI>Add a text box to the report footer section and set the following
   properties:
<P>
<P><PRE>      Name: Total
      ControlSource: =Sum([ProductSales])
      Format: Currency
</PRE><P>
<P><PRE>      NOTE: In version 2.0, there is a space in Product Sales.
</PRE>
<P><LI>Set the report footer section's Visible property to No.

<P><LI>Save and then close the report.

<P><LI>Open the Sales By Category report in Design view.

<P><LI>Add a text box to the Category Name header section below the subreport
   and set the following properties for the text box:
<P>
<P><PRE>      Name: Category Total
      ControlSource: =[Sales by Category Subreport].[Report]![Total]
      Format: Currency
</PRE>
<P><LI>Preview the Sales By Category report. Note that the total product sales
   for each category are displayed below the listing of sales per product.
<P>
</OL><h3>Displaying a Total for All Subreports</h3>
 
<P>
To display a grand total for all subreports, you can use either a second
subreport or a control's RunningSum property.
<P>
Using a Second Subreport:
<P>
You can use a second subreport to display a grand total. When you add a
second subreport to a group footer section, make sure to link the subreport
to the grouped field so that the subreport displays the total for that
group. If you place the subreport in the report footer section, do not link
the subreport to the grouped field so that the subreport displays a total
for all the records.
<P>
The following example demonstrates how to use a second subreport to display
a grand total on a main report:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Sales By Category Subreport report in Design view.

<P><LI>Create a copy of the Sales By Category Subreport report clicking
   Save As/Export on the File menu. Save the report as Sales By Category
   Subreport Summary.
<P>
   NOTE: In version 2.0, click Save As on the File menu.

<P><LI>Set the detail section's Visible property to No.

<P><LI>Set the report footer section's Visible property to Yes.

<P><LI>Save and then close the Sales By Category Subreport Summary report.

<P><LI>Open the Sales By Category report in Design view.

<P><LI>Add a Subform/Subreport control to the report footer section and set the
   following properties for the control:
<P>
<P><PRE>      Name: Sales by Category Subreport Summary
      SourceObject: Report.Sales by Category Subreport Summary
</PRE>
<P><LI>Preview the report. Note that the total sales per category and a grand
   total appear on the last page.
<P>
</OL>Using the RunningSum property:
<P>
To use the RunningSum property to display a grand total on a main report,
follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Open the Sales By Category report in Design view.

<P><LI>Add a text box that references the text box you created in step 9 of
   the "Displaying the Total from a Subreport on a Main Report" section
   above. Set the following properties for the text box:
<P>
<P><PRE>      Name: Sales RunningSum
      ControlSource: =Val([Category Total])
      RunningSum: Over All
      Visible: No
</PRE><P>
   NOTE: You use the Val() function to convert the Variant returned by the
   referenced control to a number so that the RunningSum property
   accumulates the total.

<P><LI>Add a text box control to the report footer section to display the grand
   total. Set the following properties for the control:
<P>
<P><PRE>      Name: Grand Total
      ControlSource: =[Sales RunningSum]
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating totals in reports, search the Help
Index for "totals," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about the RunningSum property in Microsoft Access 2.0,
search for "RunningSum," and then "RunningSum Property" using the Microsoft
Access Help menu. Or see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q115877.htm">Q115877</A></B>
   TITLE     : ACC2: RunningSum Text Box in Report Not Accumulating Values

</PRE></OL>For more information about summing calculations, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q129096.htm">Q129096</A></B>
   TITLE     : ACC: How to Sum a Calculation in a Report
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: running<BR>
Keywords            : kbusage RptSub<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
