

<HTML>
<HEAD>
<TITLE>ACC: How to Filter a Report Using a Form's Filter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q145591">
<META NAME="KBModify" CONTENT="1998/02/23">
<META NAME="KBCreate" CONTENT="1996/06/06">
<META NAME="Keywords" CONTENT="FmrCdbeh kbusage kbfaq">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to create a button on a filtered form that opens a report and applies the same filter to the report that is on the form.  NOTE: This article explains a...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA1S,QAO4,QDN9,QBXS,QAFF,QAB9,QAI2,QAJQ,QAPF,QAKE,QBWS,QAMB,QAGB,QBCI P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Filter a Report Using a Form's Filter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 23, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q145591</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to create a button on a filtered form that opens
a report and applies the same filter to the report that is on the form.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
This technique involves creating a new form and report in the sample
database Northwind.mdb. The form uses event procedures to apply a filter
and to open the new report. The report uses the Filter property to apply
the same filter used in the form.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Use the AutoReport: Tabular Wizard to create a new report based on
    the Customers table. Close and save the report as rptCustomers.

<P><LI>Use the AutoForm: Tabular Wizard to create a new form based on the
    Customers table. Close and save the form as frmFilterForm.

<P><LI>Open frmFilterForm in Design view. Increase the size of the form
    footer section to accommodate three command buttons.

<P><LI>Create a command button in the form footer and set its properties as
    follows:
<P>
<PRE>       Name:     cmdOpenReport
       Caption:  Open Report
       OnClick:  [Event Procedure]

    Set the OnClick [Event Procedure] as follows:

       Private Sub cmdOpenReport_Click()
         If Me.Filter = "" Then
           MsgBox "Apply a filter to the form first"
         Else
           DoCmd.OpenReport "rptCustomers", A_PREVIEW, , Me.Filter
         End If
       End Sub

</PRE><P><LI>Create a second button in the form footer and set its properties as
    follows:
<P>
<PRE>       Name:     cmdClearFilter
       Caption:  Clear Filter
       OnClick:  [Event Procedure]

    Set the OnClick [Event Procedure] as follows:

       Private Sub cmdClearFilter_Click()
         Me.Filter = ""
       End Sub

</PRE><P><LI>Create a third button in the form footer and set its properties as
    follows:
<P>
<PRE>       Name:     cmdClose
       Caption:  Close
       OnClick:  [Event Procedure]

    Set the OnClick [Event Procedure] as follows:

       Private Sub cmdClose_Click()
         DoCmd.Close acForm, Me.Form.Name
       End Sub

</PRE><P><LI>Set the following properties for the frmFilterForm form:
<P>
       OnOpen:  [Event Procedure]
       OnClose: [Event Procedure]
<P>
    Set the form's OnOpen [Event Procedure] as follows:
<P>
       Private Sub Form_Open(Cancel as Integer)
<PRE>         Me.Filter = ""
       End Sub

    Set the form's OnClose [Event Procedure] as follows:

       Private Sub Form_Close()
         DoCmd.Close acReport, "rptCustomers"
       End Sub

</PRE><P><LI>Switch the form to Form view.

<P><LI>On the toolbar, click the Filter By Form button to set a filter, and
    then click the Apply Filter button to apply the filter.

<P><LI>Click the Open Report button on the form. A report should appear with
    the same filter that was applied to the form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Filter property, search the Help Index for
"Filter Property," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about Filter By Form or Filter By Selection, search
the Help Index for "Filter By Form" or "Filter By Selection," or ask the
Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : FmrCdbeh kbusage kbfaq
Version           : 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 23, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
