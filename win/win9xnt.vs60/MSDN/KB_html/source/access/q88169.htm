

<HTML>
<HEAD>
<TITLE>ACC: How to Increment the Numeric Portion of a String </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q88169 ">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1992/08/19">
<META NAME="Keywords" CONTENT="kbusage TblPriky">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  This article describes a formula that you can use to set the default value of a bound Text field in a form to the next higher numeric value (default value = default value +...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QASR,QA5V,QAKD,QA6E,QA4H,QA7O,QBJZ,QATX,QA7N,QAMB,QAKC,QADK,QA1S,QABA,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Increment the Numeric Portion of a String</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q88169 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
This article describes a formula that you can use to set the default value
of a bound Text field in a form to the next higher numeric value (default
value = default value + 1).
<P>
The sample formula does the following:

<UL><LI>It finds the highest numeric value used in a table.

<LI>It strips any leading text characters.

<LI>It adds 1 to the value found in step 1.

<LI>It reconnects the leading text characters.
<P>
</UL>NOTE: This example assumes that the number of leading text characters is
known at the time the form is designed.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Use the following sample procedure to increase the default value of a
bound Text field on a form:

<OL><P><LI>Open an existing database or create a new database.

<P><LI>Create a new table in Design view.

<P><LI>Add a field called Book ID with a Text data type. On the Edit
    menu, click Primary Key.
<P>
    NOTE: In versions 1.x and 2.0, click Set Primary Key on the Edit Menu.

<P><LI>Add a second field of any data type to the table.

<P><LI>Save the table as Increment.

<P><LI>Switch to Datasheet view and enter the following records:
<P>
<PRE>       Book ID       Second Field
       --------------------------
       BO-110
       BO-111
       BO-112

</PRE><P><LI>Close the table.

<P><LI>Create a new form in Design view based on the Increment table.

<P><LI>If it is not displayed, click Field List on the View menu.

<P><LI>Drag the Book ID field and the second field from the field list
    to the form.

<P><LI>Verify that the form's DefaultView property is set to Single Form.

<P><LI>Select the Book ID control.

<P><LI>Set the DefaultValue property of the Book ID text box to the
    following code:
<P>
    NOTE: In the following sample code, an underscore (_) at the end of a
    line is used as a line-continuation character. Remove the underscore
    from the end of the line when re-creating this expression.
<P>
       ="BO-" &amp; Right(DMax("[Book ID]","Increment"),Len(DMax_
<PRE>          ("[Book ID]","Increment"))-3)+1

</PRE><P><LI>View the form in Form view and enter a new record, the Book ID field
    increments to the next available number automatically.
<P>
</OL>The components of the formula for the DefaultView property are as follows:

<UL><LI>DMax("[Book ID]","Increment") locates the highest value in the table.

<LI>Len(DMax(...)) finds the length of the value returned by the DMax()
   function.

<LI>Right(DMax(...),Len(...)-3) strips the three leading text characters.

<LI>+1 increments the result of the Right() function.

<LI>"BO-" concatenates the text "BO-" to the incremented number.
<P>
</UL>Note that this example works correctly when the form's DefaultView
property is Single View; it may not work correctly in Continuous View.
When you move to a new record and begin to enter data, Microsoft Access
displays the next empty record. The default values for this record are
calculated before the record you are currently editing is committed.
Because the DMax() function calculates the maximum value from those
records stored in the table, the Book ID of the record you are currently
editing is repeated.
<P>
If you are working in a multiuser environment, it is possible that more
than one user may receive the same calculated Book ID value. Although you
can manually change the Book ID, you can also maintain the highest numeric
value in a separate table, using a macro or Visual Basic code (or Access
Basic in versions 1.x and 2.0).
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: custom counter<BR>
Keywords            : kbusage TblPriky<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
