

<HTML>
<HEAD>
<TITLE>ACC: Error Previewing Subreports That Call Filter Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103131">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/08/18">
<META NAME="Keywords" CONTENT="kberrmsg kbusage RptSub">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you print a form or report which contains a subform/subreport that calls an ApplyFilter macro action in its OnOpen event, you receive the following error message:     The ac...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAB4,QAPN,QDN9,QAH4,QAMA,QAGI,QABH,QAAP,QBVV,QBQU,QAKP,QBDM,QAY2,QAML P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Error Previewing Subreports That Call Filter Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103131</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you print a form or report which contains a subform/subreport that
calls an ApplyFilter macro action in its OnOpen event, you receive the
following error message:
<P>
<PRE>   The action or method is invalid because the form or report isn't bound
   to a table or query.

</PRE>Even if you do not receive this error message, note that the ApplyFilter
action has not been executed.
<P>
<P><h2>CAUSE</h2>
 
<P>
When printing, Microsoft Access erroneously attempts to apply the
filter that is run from the macro to the outermost (main) report/form,
rather than to the subreport/subform.
<P>
The error occurs because the main report/form does not contain a
RecordSource property setting to perform the ApplyFilter action against.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 1.0, 1.1,
2.0, 7.0, and 97. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb (or
   NWIND.MDB in Microsoft Access 2.0 or earlier).

<P><LI>Create a new macro that executes an ApplyFilter action. Type a criteria
   such as the following for the Where Condition:
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>      [LastName]="Fuller"
</PRE><P>
   In Microsoft Access 1.x and 2.0:
<P>
<P><PRE>      [Last Name]="Fuller"
</PRE>
<P><LI>Create a new report not based on any table or query.

<P><LI>Drag the Employee Sales By Country report from the Database window to
   create a subreport on the new report.

<P><LI>Double-click the subreport to edit it. Set the OnOpen property of
   the subreport to the macro that you created in step 2 from the
   combo box.

<P><LI>Preview the report. Note that you receive the following error message.
<P>
   In Microsoft Access 7.0 and 97:
<P>
<P><PRE>      The action or method is invalid because the form or report isn't
      bound to a table or query.
</PRE><P>
   In Microsoft Access 1.x and 2.0:
<P>
<P><PRE>      Action isn't valid because the form or report isn't bound
      to a table or query.
</PRE>
<P><LI>Change the RecordSource property of the main report to point to the
   Employees table.

<P><LI>Preview the report. Note that the error message no longer appears;
   however, neither the subreport nor the main report have been filtered.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: subreports reports subforms<BR>
Keywords            : kberrmsg kbusage RptSub<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
