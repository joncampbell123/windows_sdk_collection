

<HTML>
<HEAD>
<TITLE>ACC: How to Print a Conditional Page Header in a Report 1.x/2.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105516">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1993/10/20">
<META NAME="Keywords" CONTENT="kbusage McrHowto RptEvent RptLayou">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  This article describes how to print a conditional page header using an example that forces the page header (which contains the column header labels), to print on consecutiv...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABO,QAPN,QAVX,QAVW,QAOX,QBWA,QBXS,QAMB,QA1S,QAUJ,QAHE,QAF8,QAMW,QAC2,QA7O V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Print a Conditional Page Header in a Report 1.x/2.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105516</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
This article describes how to print a conditional page header using an
example that forces the page header (which contains the column header
labels), to print on consecutive pages of the report if a data group spans
more than one page.
<P>
The technique described in this article works for Microsoft Access versions
1.x and 2.0. However, an alternative method for version 2.0 is described in
the Solutions sample application. See the "References" section of this
article for a complete reference to this method.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Reports print group header information once per group, even if the group
of data spans more than one page. In reports, a common layout is to place
the grouping value in the group header along with the column labels.
However, because this data is not repeated when a group spans more than
one page, the column header labels are not repeated on the subsequent
page(s).
<P>
To create conditional headers, you must create a new page before each
group of data and set a flag from the group header to determine when the
page header should print. Then, from the group footer, set the flag back
so that the page header does not print at the beginning of the next group.
<P>
To create the conditional headers, follow these steps:

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new form called FlagForm. This form is used to store a
   global variable.

<P><LI>Create one unbound control and set the following property:
<P>
<P><PRE>      Name: Flag
</PRE><P>
   NOTE: In Microsoft Access version 1.x, the Name property is called
   the ControlName property.

<P><LI>Create the following new macro, and name it Test:
<P>
<PRE>      Macro Name        Condition                       Action
      -------------------------------------------------------------
      SetFlag                                           SetValue
      ShrinkPageH        Forms![FlagForm]![Flag]=1      CancelEvent
      FlagOn                                            SetValue
      FlagOff                                           SetValue

      Test actions
      ---------------------------------
      SetFlag
         Item:  Forms![FlagForm]![Flag]
         Expression: 1
      CancelEvent: no arguments
      FlagOn
         Item:  Forms![FlagForm]![Flag]
         Expression: 0
      FlagOff
         Item:  Forms![FlagForm]![Flag]
         Expression: 1

</PRE><P><LI>Create a new blank report called PrintHeaders based on the Products
   table:
<P>
<P><PRE>    a. Set the following report header properties:
</PRE><P>
<PRE>         OnFormat: Test.SetFlag
         Height: 0

    b. Set the following page header property:

         OnFormat: Test.ShrinkPageH

    c. Create a label in the page header section and set the following
       property:

         Caption: Continued from Previous Page...

    d. Create a grouping for the Category ID and set following properties:

         Group Header: Yes
         Group Footer: Yes

    e. Set the following group header properties:

         OnFormat: Test.FlagOn
         ForceNewPage: Before Section

    f. Create a control in the group header section bound to the Category
       ID field.

    g. Create a text box control bound to the Product Name field in the
       detail section.

    h. Set the height property for the detail section to 2 inches.
       (This is to create groups of data that span more than one page.)

    i. Set the following group footer property:

         OnFormat: Test.FlagOff

</PRE><P><LI>View the FlagForm form in Datasheet view.

<P><LI>Preview the PrintHeaders report.

<P><LI>Scroll through the report. Note the page headers for the groups.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
You can find information, instructions, and examples in the Solutions
sample application (SOLUTION.MDB) included with Microsoft Access version
2.0. For more information about printing a conditional page header, open
the SOLUTION.MDB database usually located in the ACCESS\SAMPAPPS directory.
Select "Control what you print on reports" in the Select A Category Of
Examples box, then "Repeat a group name at the top of a column or page" in
the Select An Example box.
<P>
For more information about repeating group names, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q93927.htm">Q93927</A></B>
   TITLE     : ACC: Repeating Group Name at Top of New Column or Page
               (2.0)
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage McrHowto RptEvent RptLayou<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
