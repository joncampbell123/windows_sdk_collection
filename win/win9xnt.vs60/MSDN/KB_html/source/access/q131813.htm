

<HTML>
<HEAD>
<TITLE>ACC: Edits Not Processed w/ Close Action on Form (2.0, 7.0, 97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131813">
<META NAME="KBModify" CONTENT="1997/07/21">
<META NAME="KBCreate" CONTENT="1995/06/20">
<META NAME="Keywords" CONTENT="kbusage McrProb">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you edit a record in a form, the editing changes are not processed when the form is closed with a macro's Close action. However, you are not prompted with any error messages...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QA5V,QAGB,QDN9,QAB4,QAPN,QAAW,QAUR,QBWS,QBJZ,QAU7,QAAP,QABI,QBVV,QA7O P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Edits Not Processed w/ Close Action on Form (2.0, 7.0, 97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131813</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you edit a record in a form, the editing changes are not processed
when the form is closed with a macro's Close action. However, you are not
prompted with any error messages as to why the changes are not saved.
<P>
<P><h2>CAUSE</h2>
 
<P>
The Close action is invoked with the DoCmd method in Visual Basic for
Applications (or the DoCmd statement in Access Basic in Microsoft Access
2.0) and the current record is not processed because a validation error has
occurred. The following validation errors can prevent editing changes from
being processed when the form closes:

<UL><LI>A validation rule violation.

<LI>A primary key or index violation.

<LI>A referential integrity violation.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
To work around this problem, force the record to be saved before the Close
action is run by using the following RunCommand method (or DoMenuItem
method in Microsoft Access 2.0 and 7.0) to select Save Record on the
Records menu (or File menu in Microsoft Access 2.0).
<P>
<P><h3>In Microsoft Access 97</h3>
 
<P>
<PRE>   DoCmd.RunCommand acCmdSaveRecord

   NOTE: In Microsoft Access 97, the DoMenuItem method has been replaced by
   the RunCommand method. The DoMenuItem method is included in Microsoft
   Access 97 only for compatibility with earlier versions.

</PRE><h3>In Microsoft Access 7.0</h3>
 
<P>
<PRE>   DoCmd.DoMenuItem acFormBar, acRecordsMenu, acSaveRecord,, acMenuVer70

</PRE><h3>In Microsoft Access 2.0</h3>
 
<P>
<PRE>   DoCmd DoMenuItem A_FormBar, A_File, A_SaveRecord, , A_Menu_Ver20

</PRE>For example, if you choose the Command Button Wizard to create a Close
button on a form, the following Visual Basic (or Access Basic in Microsoft
Access 2.0) Sub procedure is generated.
<P>
<P><h3>In Microsoft Access 7.0 and 97</h3>
 
<P>
<PRE>   Private Sub CloseForm_Click()
   On Error GoTo Err_CloseForm_Click

     DoCmd.Close

   Exit_CloseForm_Click:
   Exit Sub

   Err_CloseForm_Click:
     MsgBox Err.Description
     Resume Exit_CloseForm_Click

   End Sub

</PRE><h3>In Microsoft Access 2.0</h3>
 
<P>
<PRE>   Sub CloseForm_Click ()
   On Error GoTo Err_CloseForm_Click

      DoCmd Close

   Exit_CloseForm_Click:
      Exit Sub

   Err_CloseForm_Click:
      MsgBox Error$
      Resume Exit_CloseForm_Click

   End Sub

</PRE>To force a record to be saved before the Close action is run, insert the
RunCommand method (or DoMenuItem method) immediately before the DoCmd Close
line in the Sub procedure. This will cause Microsoft Access to prompt you
with a message as to why the record cannot be saved.
<P>
Also, use the On Error GoTo statement to trap any error that may occur.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
2.0, 7.0, and 97. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<P><h3>In Microsoft Access 7.0 and 97</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb, and open the Customers form in
   Design view.

<P><LI>Make sure that the Control Wizards button is selected in the Toolbox
   before creating the command button.

<P><LI>Add a command button to the form.

<P><LI>In the Command Button Wizard dialog box, click Form Operations in the
   Categories box, click Close Form in the Actions box, and then click
   Finish.

<P><LI>Save the Customers form, and then view the form in Form view.

<P><LI>On the Edit menu, click Go To, and then click New Record on the Go To
   submenu.

<P><LI>Type "ABCDE" (without the quotation marks) in the CustomerID field, and
   then close the form. Note that the following error message appears:
<P>
<P><PRE>      The field 'Customers.CompanyName' can't contain a Null value because
      The Required property for this field is set to True. Enter a value
      in this field.
</PRE>
<P><LI>If you then click OK, you will receive the following additional
   message:
<P>
<P><PRE>      Microsoft Access
      You can't save this record at this time. Microsoft Access may have
      encountered an error while trying to save a record. If you close
      this object now, the data changes may be lost.
</PRE><P>
<P><PRE>      Do you want to close the Database object anyway?
</PRE>
<P><LI>Click No, and then click the Close button that you created. Note that
   the form closes without an error message. However, the new record with
   CustomerID "ABCDE" is not processed.
<P>
</OL><h3>In Microsoft Access 2.0</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB, and open the Customers form in
   Design view.

<P><LI>Make sure that the Control Wizards is selected (has a check mark) on
   the View menu.

<P><LI>Add a command button to the form. Note that the Command Button Wizard
   dialog box appears.

<P><LI>In the Command Button Wizard dialog box, select Form Operations in the
   Categories box, select Close Form in the When Button Is Pressed box,
   and then choose the Finish button.

<P><LI>Save the Customers form, and then view the form in Form view.

<P><LI>From the Records menu, choose Go To, and then choose New from the menu
   that appears.

<P><LI>Type "ABCDE" (without the quotation marks) in the Customer ID field,
   and then close the form. Note that the following error message appears:
<P>
<P><PRE>      Field 'Customers.Company Name' can't contain a null value.
</PRE><P>
   This is expected because the Company Name field must contain a value.

<P><LI>Choose the OK button. Note that the following error message appears as
   expected:
<P>
<P><PRE>      The record being edited can't be saved. If you close the form, the
      changes you've made to the record will be lost. Close anyway?
</PRE>
<P><LI>Choose the Cancel button, and then choose the Close button that you
   created with the Command Button Wizard. Note that the form closes
   without an error message. However, the new record with Customer ID
   "ABCDE" is not processed.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Close action, search the Help Index for
"Close action," or ask the Microsoft Access 97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage McrProb<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
