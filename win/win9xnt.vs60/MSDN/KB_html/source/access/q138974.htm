

<HTML>
<HEAD>
<TITLE>ACC95: Cannot Create Relationship with Local &amp; Replicated Tables </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138974">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/10/31">
<META NAME="Keywords" CONTENT="kberrmsg kbusage RplGen">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you try to create a relationship between two tables in a replicated database, you may receive the following error message:     You can't establish or maintain a relatio...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAYV,QAFO,QBJZ,QBWS,QARR,QDN9,QA4F,QAVX,QAVW,QAAW,QAZV,QAPN,QDIV,QDKY V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: Cannot Create Relationship with Local &amp; Replicated Tables</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138974</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you try to create a relationship between two tables in a replicated
database, you may receive the following error message:
<P>
<PRE>   You can't establish or maintain a relationship between a replicated
   table and local table.

</PRE><h2>CAUSE</h2>
 
<P>
Microsoft Jet Replication does not allow you to create a relationship
between two tables if the following conditions are true:

<UL><LI>One table is replicated and the second is local. (That is, the second
   table is not replicated; therefore, it is not dispersed throughout the
   replica set.)

<LI>The two tables are local and related (through referential integrity)
   when you try to turn on the Replicable property for one of the tables.

<LI>The two tables have different KeepLocal property settings.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
If one table is replicated and the second is local, turn off the
Replicable property of the replicated table. Then, you can try to create
the relationship between the two local tables.
<P>
If two tables are local and related, when you try setting the Replicable
property, delete the relationship first. Then, try to turn on the
Replicable property for the two local tables.
<P>
If the two tables have different KeepLocal property settings, modify one
table's KeepLocal property so that it is the same as the setting in other
table. Then, try to create the relationship.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>In Windows Explorer, make a copy of the sample database Northwind.mdb
    and name it Test.mdb.

<P><LI>Start Microsoft Access and open the Test.mdb.

<P><LI>On the Tools menu, point to Replication, and then click Create
    Replica.

<P><LI>In the "This database must be closed before you can create a
    replica" box, click Yes.

<P><LI>In the "Microsoft Access can make a backup of your database before
    converting it to a Design Master" box, click Yes.

<P><LI>In the Location of New Replica box, select the same folder location as
    the Test.mdb database. In the File Name box, type "TestReplica.mdb"
    (without the quotation marks).

<P><LI>Click OK to create the replica.

<P><LI>In the Design Master database (Test.mdb) make a copy of the Customers
    table and name it Cust1.

<P><LI>On the Tools menu, click Relationships.

<P><LI>On the Relationships menu, click Show Table.

<P><LI>In the Show Table box, select Cust1. Click Add, and then click Close.

<P><LI>Drag the CustomerID field from the Cust1 table to the CustomerID field
    in Customers table.

<P><LI>In the Relationships box, select Enforce Referential Integrity, and
    then click Create. Note that you receive the following error message:
<P>
       You can't establish or maintain a relationship between a
       replicated table and local table.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating relationships, search on the phrase
"relationship," and then view "Define relationships between tables"
using the Answer Wizard from the Microsoft Access for Windows 95 Help
menu.
<P>
Microsoft Access "Building Applications with Microsoft Access for Windows
95," version 7.0, Chapter 19, "Using Database Replication," pages 417-433
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage RplGen<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
