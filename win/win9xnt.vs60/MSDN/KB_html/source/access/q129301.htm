

<HTML>
<HEAD>
<TITLE>ACC2: No "Can't Add Records" Data Mode Arg. for OpenForm </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129301">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1995/04/24">
<META NAME="Keywords" CONTENT="FmsProp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you set the OpenForm macro action's Data Mode argument, you can select Add, Edit, or Read Only, but the Can't Add Records option that you can select for the form's DefaultEd...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA5V,QAH4,QBXS,QAHE,QAH7,QAH6,QAD7,QBWS,QAGU,QBJZ,QA1S,QAEF,QADZ,QA5W V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: No "Can't Add Records" Data Mode Arg. for OpenForm</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129301</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you set the OpenForm macro action's Data Mode argument, you can
select Add, Edit, or Read Only, but the Can't Add Records option that you
can select for the form's DefaultEditing property is not available.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, use Access Basic code to pass the specified
DefaultEditing property setting in the OpenArgs argument and set the
property in the form's Load event. See the "More Information" section for
an example of how to use the OpenArgs argument.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how you can use the OpenForm macro
action's OpenArgs argument to pass the specified data mode for use in
a form. By using this argument, you can open a form with the Can't Add
Records data mode.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or
perform these steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Employees form in Design view.

<P><LI>Enter the following code for the form's OnLoad event procedure:
<P>
<PRE>      Sub Form_Load (Cancel As Integer)
         ' Set the DefaultEditing property to the value passed in the
         ' OpenArgs argument.
         Me.DefaultEditing = Me.OpenArgs
      End Sub

</PRE><P><LI>Save and then close the form.

<P><LI>Open the Utility Functions module in Design view and choose
   Immediate Window from the View menu.

<P><LI>Type the following statement in the Immediate window and press ENTER:
<P>
<P><PRE>      DoCmd OpenForm "Employees",,,,,,"4"
</PRE><P>
   Note that the Employees form opens. You cannot add new records, but all
   the employee records are available.
<P>
</OL>You can set the OpenArgs argument to any one of the following values:
<P>
<PRE>   1 = Data Entry
   2 = Allow Edits
   3 = Read Only
   4 = Can't Add Records

</PRE></OL><h3>Opening the Form with a Filter</h3>
 
<P>
If you set the form's DefaultEditing property to Can't Add Records, you
remove any filter that you applied to the form. To open the form so that it
retains the filter, use the OpenForm macro action's Filter Name or Where
Condition arguments to set the form's DefaultEditing property to Can't Add
Records. To pass the filter, use the OpenArgs argument.
<P>
For more information about how setting the DefaultEditing property to Can't
Add Records removes any filter, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q129302.htm">Q129302</A></B>
   TITLE     : ACC2: DefaultEditing Set to Can't Add Records Removes
               Filter

</PRE>To open the form with a filter, follow these steps:

<OL><P><LI>Change the Employees form's OnLoad event procedure to the following
   code:
<P>
<PRE>      Sub Form_Load ()
         Dim iSemicolon As Integer
         Dim iDefaultEditing As Integer
         Dim sWhereCondition As String

         ' Find the semicolon.
         iSemicolon = InStr(Me.OpenArgs, ";")

         ' If the semicolon is found...
         If iSemicolon &gt; 0 Then
            '...parse the DefaultEditing and Where Condition arguments...
            iDefaultEditing = Left(Me.OpenArgs, iSemicolon - 1)
            sWhereCondition = Mid(Me.OpenArgs, iSemicolon + 1)

            '...and set the arguments.
            Me.DefaultEditing = iDefaultEditing
            If sWhereCondition &lt;&gt; "" Then
               DoCmd ApplyFilter , sWhereCondition
            End If
         End If
      End Sub

</PRE><P><LI>Type the following statement in the Immediate window and press ENTER:
<P>
<P><PRE>      DoCmd OpenForm "Employees", ,,,,,"4;[Employee ID]=9"
</PRE><P>
   Note that the form opens with a filter, and you cannot add new records.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the DefaultEditing property, search for
"DefaultEditing," and then "AllowEditing, DefaultEditing Properties" using
the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsProp kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
