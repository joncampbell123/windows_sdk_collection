

<HTML>
<HEAD>
<TITLE>ACC97: DB Contains Incorrect Objects After Upgrade to Access 97 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q150099">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1996/04/22">
<META NAME="Keywords" CONTENT="CnvOthr StpOthr kbsetup">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  After you convert a database in Microsoft Access 97 from Microsoft Access 7.0, you see incorrect objects in the database when you open it, such as Wizard tables or objects ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAZV,QAA1,QBWS,QBWR,QBQU,QDI2,QAEF,QDL9,QBWO,QBWN,QDNJ,QABA,QDKX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: DB Contains Incorrect Objects After Upgrade to Access 97</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q150099</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
After you convert a database in Microsoft Access 97 from Microsoft Access
7.0, you see incorrect objects in the database when you open it, such as
Wizard tables or objects from the Northwind sample database.
<P>
<P><h2>CAUSE</h2>
 
<P>
A shortcut to your database was modified by the operating system and may
be pointing to a different file on your hard drive.
<P>
If you create a shortcut on your computer that includes the Microsoft
Access 7.0 executable file (Msaccess.exe), and then you elect to remove
earlier versions when you run Setup for Microsoft Access 97, then the
shortcut becomes invalid because the earlier version Msaccess.exe file was
removed. This occurs whether the shortcut's target is just Msaccess.exe,
or Msaccess.exe plus a database file. For example, both of these shortcuts
become invalid after Microsoft Access 97 Setup removes the earlier
version:
<P>
<PRE>   C:\Msoffice\Access\Msaccess.exe
   C:\Msoffice\Access\Msaccess.exe C:\Msoffice\Access\Samples\Northwind.mdb

</PRE>Microsoft Windows 95 and Microsoft Windows NT version 4.0 automatically
modify the invalid shortcut to point to another registered file in the
same folder as the shortcut's original target: perhaps a Wizard database,
Northwind.mdb, or another file associated with Microsoft Access 7.0.
<P>
When you double-click the shortcut, the first thing you see is the
Convert/Open Database dialog box as the earlier version database file in
the modified shortcut opens in Microsoft Access 97. If you choose to
convert the database, and you convert the database into the same file name
as an existing database file, the original file is overwritten. When
Microsoft Access prompts if you want to replace the existing file, you may
think you are replacing the earlier version database file with its
converted Microsoft Access 97 equivalent; however, you may be overwriting
the original database with the converted Wizard or sample database that
your shortcut now refers to.
<P>
NOTE: This only happens in operating systems that use shortcuts: Microsoft
Windows 95 and Microsoft Windows NT version 4.0. Microsoft Windows NT
version 3.51 does not exhibit this behavior.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you replace your earlier version database with a converted version of
the wrong database file, you must restore the original database from a
backup.
<P>
Also, be sure you remove, update, or recreate any old shortcuts that
include the Micr0soft Access 7.0 executable file, Msaccess.exe.
<P>
NOTE: This also applies to shortcuts for run-time applications created
with the Microsoft Access Developer's Toolkit version 7.0.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior does not occur in Microsoft Access 97 Service Release 1.
<P>
NOTE: Stand-alone Microsoft Access 97 Service Release 1 is not currently
available, but you can update your copy of Microsoft Access 97 to Service
Release 1 by downloading Microsoft Office Service Release 1 from
Microsoft's Web site at:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/office97/servicerelease">http://www.microsoft.com/office/office97/servicerelease</A></B>

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
WARNING: The following steps will replace your Microsoft Access 7.0
Northwind sample database. Create a backup of Northwind.mdb before
continuing.

<OL><P><LI>Run Setup for Microsoft Access 7.0. Select a Custom installation, and
    install all components.

<P><LI>Create a shortcut on your desktop that points to the Microsoft Access
    7.0 Msaccess.exe file.

<P><LI>Run Setup for Microsoft Access 97. Select a Custom installation, and
    install all components.

<P><LI>When Setup prompts you that previous Microsoft Access components were
    detected, click Yes to remove the old components.

<P><LI>After Setup is finished, double-click the Microsoft Access 7.0 shortcut
    you created on your desktop.

<P><LI>The Convert/Open Database dialog box in Microsoft Access 97 appears.
    Click Convert Database, and then click OK.

<P><LI>In the Convert Database Into dialog box, browse for the Microsoft
    Access 7.0 Northwind sample database and use that file name. By
    default it is located in \MSOffice\Access\Samples.

<P><LI>When prompted to replace the existing file, click Yes.

<P><LI>During conversion, you may receive the error "Requested type library
    or wizard is not a VBA project." Click OK, and use Windows Explorer to
    note that the Northwind.mdb file no longer exists. This happens
    because you chose to overwrite the file, but an error during conversion
    stopped Microsoft Access 97 from creating a new file.
<P>
    NOTE: You may not receive an error message during conversion if your
    shortcut defaults to a path and file other than a wizard database;
    however, when you open Northwind.mdb after conversion, the database no
    longer contains its original objects.

<P><LI>Using the right mouse button, click the shortcut to Microsoft Access
    7.0 on your desktop. Click Properties on the menu that appears.

<P><LI>Click the Shortcut tab in the Properties dialog box. Note that the
    Target box reads C:\MSOffice\Access\WZMAIN70.MDA or some file other
    than the original target of Msaccess.exe.
</OL> 
<PRE>Keywords          : CnvOthr StpOthr kbsetup
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
