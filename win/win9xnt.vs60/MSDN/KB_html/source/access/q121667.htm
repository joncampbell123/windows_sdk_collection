

<HTML>
<HEAD>
<TITLE>ACC: CreateControl() Function Always Creates Label with Colon </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121667">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1994/10/13">
<META NAME="Keywords" CONTENT="FmrProp kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the CreateControl() function to create a text box on a form, the text box's attached label always contains a colon (:), even if you have created your own form templa...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QA1S,QAHP,QDN9,QAMB,QBXS,QAC2,QBJZ,QBXT,QA5V,QAIB,QA5F,QAMA,QAH4 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: CreateControl() Function Always Creates Label with Colon</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121667</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the CreateControl() function to create a text box on a form,
the text box's attached label always contains a colon (:), even if you have
created your own form template and set the AddColon property for the
default text box to No.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Introduction to Programming" manual in Microsoft Access
version 1.1, or the "Building Applications" manual in version 2.0.
<P>
Add the following line to the sample code in step 5 of the "Steps to
Reproduce Problem" section later in this article. Insert this line before
the line that reads "DoCmd Restore" to change the label's Caption property
to remove the colon:
<P>
<PRE>   MyLabel.Caption=Left$(MyLabel.Caption,Len(MyLabel.Caption)-1).

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
1.1 and 2.0. This problem no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new table called Table1. Add one field to the table.

<P><LI>Create a blank, new form, and then set the default text box's
   AddColon property to No. (To set the default text box's properties,
   view the property sheet and then click the Text Box button in the
   toolbox.) Save the form as Test.

<P><LI>From the View menu, choose Options. In the Category box, select Form
   &amp; Report Design, then set the Form Template item to Test. Choose OK.

<P><LI>Create a new module, and then enter the following sample code in the
   module.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<P><PRE>      Option Explicit
<PRE></PRE>      Sub NormalForm ()
        Dim MyRecordSource As String
        Dim DataX As Integer, DataY As Integer, LabelX As Integer, _
           LabelY As Integer
        Dim MyForm As String, MyFormCreate As Form, MyLabel As _
            Control, MyControl As Control
        MyRecordSource = "Table1"
        Set MyFormCreate = CreateForm("", "")
        MyForm = MyFormCreate.Formname   'Use this line in version 1.1.
        MyForm = MyFormCreate.Name       'Use this line in version 2.0.
        MyFormCreate.RecordSource = MyRecordSource
        LabelX = 100
        LabelY = 100
        DataX = 1000
        DataY = 100
        ' Create unbound default-size text box in the detail section.
        Set MyControl = CreateControl(MyForm, 109, 0, "", "", DataX, _
          DataY)
        ' Create child label control for the text box.
        Set MyLabel = CreateControl (MyForm, 100, 0, MyControl.Control_
           name, "hello", LabelX, LabelY)  'Use this line in version 1.1.
        Set MyLabel = CreateControl(MyForm, 100, 0, MyControl.Name, _
          "hello", LabelX, LabelY)   'Use this line in version 2.0.
        DoCmd Restore
      End Sub

</PRE><P><LI>From the View menu, choose Immediate Window.

<P><LI>In the Immediate window, type the following line, and then press ENTER:
<P>
<P><PRE>      NormalForm
</PRE><P>
   Note that the label that is created contains a colon.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the CreateControl() function, search for
"CreateControl," and then "CreateControl, CreateReportControl Functions"
using the Microsoft Access version 2.0 Help menu.
<P>
Microsoft Access "The Secrets of AccessWizards," version 1.1, Chapter 2,
"Incantations: AccessWizard Functions and Properties," pages 12-15
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmrProp kbusage<BR>
Version             : 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
