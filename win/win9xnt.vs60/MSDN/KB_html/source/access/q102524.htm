

<HTML>
<HEAD>
<TITLE>ACC1x: How to Disable the Menu Bar When Previewing a Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102524">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="kbusage RptOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Although you can display a custom menu bar in a form in Microsoft Access version 1.x, there is no way to display a custom menu bar when previewing a report. However, you can completely remove the menu bar when previewing a report using Microsoft Wi...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAF0,QA1S,QANS,QAEF,QDN9,QAH4,QBRM,QDL9,QDH6,QBWO,QBWN,QA9N,QANJ,QAY5,QAGI V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Disable the Menu Bar When Previewing a Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102524</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Although you can display a custom menu bar in a form in Microsoft Access
version 1.x, there is no way to display a custom menu bar when previewing a
report. However, you can completely remove the menu bar when previewing a
report using Microsoft Windows API calls. This article demonstrates a
sample Access Basic function that you can use to remove the menu bar when
previewing a report.
<P>
Microsoft Access version 2.0 has built-in functionality to create a custom
menu for a report. For more information about creating custom menus, search
for "custom menus" using the Microsoft Access 2.0 Help menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The technique presented in this article removes the menu bar when in
Print Preview. To also remove the toolbar, choose Options from the
View menu and set Show Toolbar to No.
<P>
The Access Basic code below needs to be called for each report every time
you switch to Print Preview. If you display another report after calling
this code, Microsoft Access will re-establish the Print Preview menu.
<P>
NOTE: The menu for the report is also re-established if switching from
the report to a form and then back to the report. If the window from
which the report is called is maximized, then the display may become
erratic. Symptoms of an erratic display include duplications of the
Control menu icon and the Min/Max icons before the report appears.
<P>
To remove the menu bar that appears when you are printing a report,
use the following steps:

<OL><P><LI>Create the new module below.
<P>
   NOTE: In the following sample code, an underscore (_) is used as a line-
   continuation character. Remove the underscore when re-creating this code
   in Access Basic.
<P>
   NOTE: You may have some Microsoft Windows API functions defined in an
   existing Microsoft Access library; therefore, your declarations may be
   duplicates. If you receive a duplicate procedure name error message,
   remove or comment out the declarations statement in your code.
<P>
<P><PRE>    '******************************************************************
    'Declarations section of the module
    '******************************************************************
    Option Explicit
    Declare Function FindWindow% Lib "user" (ByVal lpClassName As Any, _
<PRE></PRE>                       ByVal lpCaption As Any)
    Declare Function SetMenu% Lib "User" (ByVal hWnd%, ByVal hMenu%)

    '==================================================================
    'The following function removes the Microsoft Access menu bar by:
    ' - Retrieving the Microsoft Access window handle with FindWindow.
    ' - Removing the Microsoft Access menu bar with SetMenu.
    '==================================================================
    Function RemoveAccessMenu ()
      Dim hWnd%, dummy%
      hWnd% = FindWindow("OMain", 0&amp;)
      dummy% = SetMenu(hWnd%, 0)
    End Function

</PRE><P><LI>In the report in which you want to disable the menu bar, set the
   OnFormat or OnPrint property of the first section that prints (such
   as the Report Header section) to call the RemoveAccessMenu()
   function:
<P>
<P><PRE>      OnFormat: =RemoveAccessMenu()
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
"Programmer's Reference Library: Microsoft Windows 3.1 Guide to
Programming Reference," Volumes 1-6, Microsoft Press, 1992
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: menubar security<BR>
Keywords            : kbusage RptOthr<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
