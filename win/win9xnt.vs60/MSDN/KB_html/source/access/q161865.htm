

<HTML>
<HEAD>
<TITLE>ACC: Installing Access 95 or 97 Breaks 2.0 Calendar Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161865">
<META NAME="KBModify" CONTENT="1997/06/04">
<META NAME="KBCreate" CONTENT="1997/01/07">
<META NAME="Keywords" CONTENT="IntpCstm kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat). Both are hidden files in the Windows folder.   Advanced: Requ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAB4,QAA1,QA7O,QAOE,QAMN,QAB5,QDI2,QAHI,QDL9,QBWO,QBWN,QAZV,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Installing Access 95 or 97 Breaks 2.0 Calendar Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 4, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161865</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
<LI>Microsoft Access Developer's Toolkit version 2.0
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
If you install Microsoft Access 7.0 or 97 on a computer that contains
Microsoft Access 2.0 and Microsoft Access Developer's Toolkit version 2.0,
you may receive the following error message when you try to add a Calendar
Control object to a form or report:
<P>
<PRE>   There is a problem with the registration database.

</PRE><h2>CAUSE</h2>
 
<P>
When you install Microsoft Access 7.0 or 97, the Setup program creates the
following key under HKEY_CLASSES_ROOT in your Windows Registry:
<P>
<PRE>   CLSID\{399A11C0-CFAC-101A-B8A0-00608CB87234}\AutoConvertTo

</PRE>The key contains the CLSID for the 32-bit Calendar control included with
Microsoft Access 7.0 and 97. It tells Microsoft Access to convert calls to
the 16-bit Calendar control automatically to the 32-bit Calendar control so
your Microsoft Access 2.0 database will convert to a newer version more
easily. However, when you try to insert the Calendar control in version
2.0, Microsoft Access tries instead to insert the 32-bit equivalent, which
is incompatible with 16-bit Microsoft Access 2.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If you want to continue to use the Calendar control in version 2.0, you can
edit the Windows Registry and rename the AutoConvertTo key. The following
steps show you how.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems that
may require you to reinstall Microsoft Windows 95 or Microsoft Windows NT.
Microsoft cannot guarantee that problems resulting from the incorrect use
of Registry Editor can be solved. Use Registry Editor at your own risk.
<P>
For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you
should make a backup copy of the registry files (System.dat and User.dat)
before you edit the registry.

<OL><P><LI>Start the Registry Editor program, Regedit.exe.

<P><LI>Locate the following key under HKEY_CLASSES_ROOT:
<P>
<P><PRE>      CLSID\{399A11C0-CFAC-101A-B8A0-00608CB87234}\AutoConvertTo
</PRE>
<P><LI>Using the right mouse button, click the AutoConvertTo key, and then
   click Rename on the shortcut menu.

<P><LI>Rename the key to AutoConvertToX.

<P><LI>Start Microsoft Access 2.0 and add the Calendar control to a form. Note
   that the error no longer occurs.
<P>
</OL><h2>MORE INFORMATION</h2>
 
<P>
This problem only occurs when you have Microsoft Access 2.0 and Microsoft
Access Developer's Toolkit version 2.0 on your computer, and then you set
up Microsoft Access 7.0 or 97 in a separate folder on the same computer.
<P>
If you follow the steps in the "Resolution" section to change the Windows
Registry key, you will encounter error messages if you try to convert a
version 2.0 database with a Calendar control in Microsoft Access 7.0 or 97.
You can follow the steps again to rename the AutoConvertToX Registry key
back to AutoConvertTo before you convert your database.
<P>
If the Registry key is missing when you convert your version 2.0 database,
you may receive the following error messages.
<P>
<P><h3>Using Microsoft Access 7.0</h3>
 
<P>
<PRE>   The following warning occurs during conversion of your Microsoft Access
   2.0 database:

      One or more functions or reports contains a 16-bit OLE custom control
      with no 32-bit equivalent. These controls will not function properly
      under Microsoft Windows 95 or Microsoft Windows NT.

   After the database is converted, you receive the following error when
   you open an object that contains the Calendar control:

      The object application isn't registered.

</PRE></OL><h3>Using Microsoft Access 97</h3>
 
<P>
<PRE>   The Microsoft Access 2.0 database converts without any warnings, but
   you receive the following error message when you open an object that
   contains the Calendar control:

      There is no object in this control.

</PRE><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>If it isn't already installed, run Setup to install Microsoft Access 2.0
   on your computer.

<P><LI>If it isn't already installed, run Setup to install Microsoft Access
   Developer's Toolkit version 2.0.

<P><LI>Run Setup to install Microsoft Access 7.0 or 97 on your computer. Do not
   remove version 2.0.

<P><LI>Start Microsoft Access 2.0 and open the sample database NWIND.MDB.

<P><LI>Create a new form not based on any table or query in Design view.

<P><LI>On the Edit menu, click Insert Object.

<P><LI>In the Insert Object dialog box, click Insert Control.

<P><LI>Click Calendar Control in the Control Type box, and then click OK. Note
   that you receive the error message:
<P>
<P><PRE>      There is a problem with the registration database.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the Calendar control in Microsoft Access
2.0, search the OLE Calendar Control Help file, Msacal20.hlp.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: MSACAL70.OCX MSCAL.OCX MSACAL20.OCX setup setup.exe<BR>
Keywords            : IntpCstm kberrmsg kbinterop<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 4, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
