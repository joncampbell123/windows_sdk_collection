

<HTML>
<HEAD>
<TITLE>ACC: How to Get Field Data Types from a Table Using DDE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102520">
<META NAME="KBModify" CONTENT="1998/02/06">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="TblFldp kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The DDE FieldNames item has been enhanced in Microsoft Access 1.1 and later by adding the ability to get the field type for the field. In Microsoft Access 1.0, the FieldName...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QAIH,QA1S,QA7O,QDN9,QDKY,QBWS,QBVP,QBJZ,QBBI,QAZ2,QAPF,QALG,QAUJ,QAIJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Get Field Data Types from a Table Using DDE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 6, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102520</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The DDE FieldNames item has been enhanced in Microsoft Access 1.1 and
later by adding the ability to get the field type for the field. In
Microsoft Access 1.0, the FieldNames item could get the field name, but
not the field type. The new item is called FieldNames;T, and can be
requested on any open Microsoft Access database.
<P>
Examples showing how to use this DDE feature from Microsoft Excel and
Microsoft Word for Windows are listed below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following sample Microsoft Excel macro demonstrates how to use the
FieldNames;T item to get the field name and field type from the
Categories table in the sample database ORDERS.MDB

<OL><P><LI>Start Microsoft Access and open Orders.mdb.

<P><LI>Start Microsoft Excel and open a new worksheet.

<P><LI>Select cells A1-D2.

<P><LI>Type the formula:
<P>
<P><PRE>      =MSAccess|'ORDERS.MDB;Table Categories'!'Fieldnames;T'
</PRE><P>
   Note: If you want Microsoft Excel to open Microsoft Access and
   get the information from the specified database, the complete
   path to the database file should be specified. For example:
<P>
   C:\Progra~1\Micros~1\office\samples\orders.mdb
<P>
   It is required to use the DOS alias name when specifying the
   path as DDE does not support long file names.

<P><LI>Press CTRL+SHIFT+ENTER. This enters the formula as an array
   formula. The results are propagated through the selected range.
<P>
</OL>The following information is returned:
<P>
<PRE>   Category ID    Category Name    Description    Picture
       10             10               12           11

</PRE></OL>The numeric values returned describe the data type for the field. The
data types are:
<P>
<PRE>    0    Invalid
    1    True/False (non-Null)
    2    Unsigned byte (Byte)
    3    2-byte signed integer (Integer)
    4    4-byte signed integer (Long)
    5    8-byte signed integer (Currency)
    6    4-byte single-precision floating-point (Single)
    7    8-byte double-precision floating-point (Double)
    8    Date/Time (integral date, fractional time)
    9    Binary data, 255 bytes maximum
   10    ANSI text, not case sensitive, 255 bytes maximum (Text)
   11    Long binary (OLE Object)
   12    Long text (Memo)

</PRE>The following example for Microsoft Word for Windows demonstrates how
to use the FieldNames;T item to get the field name and field type from
the Categories table in the sample database Orders.mdb:

<OL><P><LI>Start Microsoft Access and open Orders.mdb.

<P><LI>Start Microsoft Word for Windows and open a new document.

<P><LI>On the Insert menu, click Field.

<P><LI>Type the following formula in the Field Codes box, and then click OK:
<P>
   =DDE MSAccess "ORDERS.MDB;Table Categories" FieldNames;T
<P>
   Note: If you want Microsoft Word to open Microsoft Access and
   get the information from the specified database, the complete
   path to the database file should be specified. For example:
<P>
   C:\\Progra~1\\Micros~1\\office\\samples\\orders.mdb
<P>
   You are required to use the DOS alias name when specifying the
   path as DDE does not support long file names.
<P>
</OL>The following information is displayed:
<P>
<PRE>   Category ID    Category Name    Description    Picture
       10              10              12           11

</PRE></OL>Some formatting of the text may be necessary to align the field type
descriptor numerals under the table names.
<P>
NOTE: If you see the formula you typed instead of this data, and you
are using Microsoft Word 6.0, 7.0, or 97 you need to clear the Field Codes
check box on the View tab by clicking Options on the Tools menu. If you
are using Microsoft Word 2.0, click Field Codes on the View menu.
<P>
If you are running Microsoft Word 7.0 or 97, you may see the error
"!Syntax Error, MSACCESS" after clicking OK. If so, then follow these
steps to correct the error:

<OL><P><LI>Select the field you inserted and click the right mouse button.

<P><LI>Click Toggle Field Codes. You should see the formula:
<P>
   {= DDE MSAccess "C:\\ACCESS\\ORDERS.MDB;Table Categories" FieldNames;T
   MERGEFORMAT }

<P><LI>Modify the formula so that it does not contain the "=" sign as follows:
<P>
   {DDE MSAccess "C:\\ACCESS\\ORDERS.MDB;Table Categories" FieldNames;T
   MERGEFORMAT }

<P><LI>Select the field again and click the right mouse button.

<P><LI>Click Update Field.
</OL> 
<PRE>Keywords          : TblFldp kbinterop
Version           : 1.0 1.1 2.0 7.00 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 6, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
