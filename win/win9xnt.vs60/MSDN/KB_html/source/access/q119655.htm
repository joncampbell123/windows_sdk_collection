

<HTML>
<HEAD>
<TITLE>ACC: How to Print Group Footer at Specific Location </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119655">
<META NAME="KBModify" CONTENT="1998/01/29">
<META NAME="KBCreate" CONTENT="1994/08/20">
<META NAME="Keywords" CONTENT="RptSort kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to print a report's group footer information at a specific place on the page. This can be useful when you are printing reports to preprinted forms. Whi...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBCI,QAPN,QABO,QAOX,QAF8,QA1S,QACI,QANO,QBXS,QBWA,QAY5,QAWI,QAML,QDN9,QAP3 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Print Group Footer at Specific Location</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 29, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119655</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to print a report's group footer information at
a specific place on the page. This can be useful when you are printing
reports to preprinted forms. While you cannot do this using the group
footer's property settings, you can use any of the following three
methods described in this article:

<UL><LI>Place the information in the report's page footer, which is always
   printed at a fixed location

<LI>Set the report properties for the footer section

<LI>Set the report properties for the detail section
<P>
</UL>This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools
provided with Microsoft Access. For more information on Access Basic,
please refer to the "Introduction to Programming" manual in Microsoft
Access version 1.x, or the "Building Applications" manual in version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1: Using the Page Footer</h3>
 
<P>
The page footer is always printed at a fixed location on the report's
page, just above the bottom margin. For example, if your form has a
bottom margin of 1 inch and the height of the page footer is 1 inch, the
page footer begins 2 inches from the bottom of the page, or 9 inches from
the top of the page (for an 11 inch long page). Placing the group footer
controls in the page footer causes them to be printed at the page footer's
fixed location on the page.
<P>
NOTE: You cannot use aggregate functions in a control in a page footer. If
you need to use aggregate controls in your footer, you may want to use the
next method in this article, or refer to the "Using Macros to Print
Reports or Transfer Data" chapter of the Microsoft Access "User's Guide"
for an example of calculating totals in a page footer.
<P>
<P><h3>Method 2: Setting Report Properties for the Footer Section</h3>
 
<P>
This method involves using the MoveLayout, PrintSection, and NextRecord
report properties to move the group footer to a specific printing location
on the page. With this method, you are not actually specifying the group
footer's coordinates on the page, but moving the group footer to various
existing printing locations on the report page.
<P>
To ensure that the group footer is printed where you want it to be, you
must consider the height of each section of the report. Since you cannot
specify the location of the group footer section (or any other section)
with a property setting, you must use the MoveLayout property to move the
section to the next available printing location. For example, if the group
footer section's height is 0.5 inches and the Top property (which specifies
how far from the top of the report the section is printed) is set to 3.75
inches, then the MoveLayout property moves the group footer section to be
printed in the area from 3.75 inches to 4.25 inches from the top of the
report (a total of 0.5 inches).
<P>
The following example demonstrates how to print the group footer at a
specific place on the page by adjusting the section heights, and by using a
sample user-defined function called SetGrpFtrLoc() that tests to see if the
Top property is set to less than the GrpFtrLoc setting (the location where
the group footer will be printed). If it is, the function moves the group
footer section to the next printing location. If not, it does not move the
group footer.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or
perform these steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new module and enter the following line in the Declarations
   section of the module:
<P>
<P><PRE>      Option Explicit
</PRE><P>
   Enter the following function in the module:
<P>
<P><PRE>      Function SetGrpFtrLoc(Rpt as Report, GrpFtrLoc as Double)
<PRE></PRE>      GrpFtrLoc=GrpFtrLoc*1440        'Convert from inches to twips.

      If Rpt.top &lt; GrpFtrLoc Then     'Not at location yet, so
         Rpt.movelayout = True        'move to next print location.
         Rpt.nextrecord = False       'Do not go to next record.
         Rpt.printsection = False     'Do not print the section.
      End If

      End Function

</PRE><P><LI>Save and then close the module.

<P><LI>Open the Catalog report in Design view.

<P><LI>Change the Category Name header section's Height property to:
<P>
<P><PRE>      1.7 inches
</PRE>
<P><LI>Change the detail section's Height property to:
<P>
<P><PRE>      0.3 inches
</PRE>
<P><LI>Set the Category Name footer section's properties as follows:
<P>
<P><PRE>      Height: 0.3 inches
      ForceNewPage: After Section
      OnFormat: =SetGrpFtrLoc([Report],7)
</PRE><P>
   Note that the 7 in the SetGrpFtrLoc() function in the footer section's
   OnFormat property indicates that you want the group footer to begin
   7 inches from the top of the page.

<P><LI>Create a new text box control with the following properties in
   the report's Category Name footer section:
<P>
<P><PRE>      Name: Number of Products
      ControlSource: =Count([Product ID])
</PRE><P>
   NOTE: In Microsoft Access version 1.x, the Name property is called
   the ControlName property.

<P><LI>Preview the report.
<P>
</OL>NOTE: If you do not adjust the section heights as specified, the location
of the group footer will vary from page to page.
<P>
<P><h3>Method 3: Setting Report Properties for the Detail Section</h3>
 
<P>
A similar approach is to use the MoveLayout, PrintSection, and NextRecord
properties to print a blank detail section until the location for printing
the group footer section is reached. This method is preferable to moving
the group footer section if the detail section is smaller than the group
footer section.
<P>
The following example demonstrates how to print the group footer at a
specific place on the page by using a sample, user-defined function called
SetDetailLoc() that tests to see if this is the last detail section. For
the last detail section, it then tests to see if the Top property is set
to less than the GrpFtrLoc setting (the location where the group footer
will be printed). If it is, the function moves the detail section to the
next print location. If not, it does not move the detail section.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new module and enter the following statements in the
    Declarations section:
<P>
       Option Explicit
       Dim RecCntr as Long

<P><LI>Enter the following functions:
<P>
       Function ResetCounter()
<PRE>          RecCntr = 0
       End Function

       Function SetDetailLoc(Rpt as Report, GrpFtrLoc as Double)
          RecCntr = RecCntr + 1
          If Rpt.top &lt; GrpFtrLoc * 1440 Then
             If reccntr = Rpt![Number Of Products] Then
                'This is the last real record of the detail section.
                Rpt.nextrecord = False
                ElseIf reccntr &gt; Rpt![Number Of Products] Then
                   'after last detail but not at location yet so move
                   Rpt.movelayout = True      'Move to next print location
                   Rpt.nextrecord = False     'Do not go to next record
                   Rpt.printsection = False   'Don't print the section
                End If
             ElseIf Rpt.top &gt;= GrpFtrLoc * 1440 Then
                'Last record before the group footer section prints.
                Rpt.printsection = False
          End If
       End Function

</PRE><P><LI>Save the module.

<P><LI>Open the Catalog report in Design view.

<P><LI>Set the following property for the Category Name header section:
<P>
       OnFormat: =ResetCounter()

<P><LI>Set the following property for the Category Name footer section:
<P>
       ForceNewPage: After Section

<P><LI>Set the following property for the detail section:
<P>
       OnFormat: =SetDetailLoc([Report],7-0.2)
<P>
       Note that the 7 in the SetDetailLoc() function in the footer
       section's OnFormat property indicates that the group footer
       begins 7 inches from the top of the page, and the 0.2 is the
       height of the detail section. (You need to subtract the detail
       section's height because the footer section prints after the
       detail section.)

<P><LI>In the report's Category Name footer section, create a new text box
    and set the following properties:
<P>
       Name: Number of Products
       ControlSource: =Count([Product ID])
<P>
       NOTE: In Microsoft Access version 1.x, the Name property is called
       the ControlName property.

<P><LI>Preview the Catelog report.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
<P>
Microsoft Access "User's Guide," version 2.0, Chapter 26, "Using Macros to
Print Reports or Transfer Data," pages 693-696
<P>
For more information about the MoveLayout, NextRecord, and PrintSection
report properties, search for "MoveLayout" then "MoveLayout, NextRecord,
and PrintSection Properties" using the Microsoft Access version 2.0 Help
menu.
 
<PRE>Keywords          : RptSort kbusage
Version           : 1.0 1.1 2.0
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 29, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
