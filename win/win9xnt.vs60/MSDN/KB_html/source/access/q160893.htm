

<HTML>
<HEAD>
<TITLE>ACC97: Querying Linked SQL Server Tables May Cause Error </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q160893">
<META NAME="KBModify" CONTENT="1997/08/29">
<META NAME="KBCreate" CONTENT="1996/12/11">
<META NAME="Keywords" CONTENT="EvnGpf kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run a query based on two or more SQL Server tables, the query results are returned, and then you receive the following error message:     MSACCESS caused an invalid page...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QABM,QAZV,QAB4,QDKY,QDN9,QACF,QBWS,QAAP,QA7O,QA7N,QAPN,QAPF,QARR,QAY2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Querying Linked SQL Server Tables May Cause Error</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 29, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q160893</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run a query based on two or more SQL Server tables, the query
results are returned, and then you receive the following error message:
<P>
<PRE>   MSACCESS caused an invalid page fault in module MSJET35.DLL

</PRE><h2>CAUSE</h2>
 
<P>
There are five requirements that your database must meet in order to
produce the error:

<UL><LI>Your database must contain local tables.

<LI>You must have a relationship that enforces referential integrity
   between two or more of the local tables in your database.

<LI>Your database must contain linked SQL Server tables.

<LI>Your database must contain a query based on two or more linked SQL
   Server tables.

<LI>The primary key field from the one-side table in the query must be the
   first field in the QBE grid.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
There are three ways to work around this error:

<UL><LI>Upgrade to version 3.51 of the Microsoft Jet Database Engine.

<LI>You can modify your query so the primary key from the one-side table is
   not the first field in the QBE grid.

<LI>You can use an SQL pass-through query for your linked SQL Server tables.
<P>
</UL>The following example illustrates how to create an SQL pass-through query:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new query in Design view.

<P><LI>Close the Show Table dialog box without adding any tables to the query.

<P><LI>On the Query menu, point to SQL Specific, and then click Pass-Through.

<P><LI>In the SQL Pass-Through Query window, type the following SQL statement.
<P>
   NOTE: In the following SQL statement, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this statement.
<P>
<P><PRE>      SELECT dbo.authors.au_id, dbo.authors.au_lname, dbo.authors. _
      au_fname, dbo.titleauthor.royaltyper
      FROM dbo.authors INNER JOIN dbo.titleauthor ON dbo.authors.au_id = _
      dbo.titleauthor.au_id;
</PRE>
<P><LI>On the View menu, click Properties to display the query's property
   sheet.

<P><LI>Set the ReturnsRecords property to Yes.

<P><LI>Set the ODBCConnectStr property to the following:
<P>
<P><PRE>      ODBC;DSN=&lt;DSNName&gt;;SERVER=&lt;ServerName&gt;;UID=&lt;UserName&gt;;PWD=&lt;Password&gt;
</PRE><P>
   Replace &lt;DSNName&gt; with the name of your ODBC Data Source for the SQL
   Server database, replace &lt;ServerName&gt; with the name of your SQL Server,
   replace &lt;UserName&gt; with the logon name of a valid SQL Server user, and
   replace &lt;Password&gt; with a valid logon password.

<P><LI>On the Query menu, click Run. Note that the query's results are
   displayed and no error is generated.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97. This
problem no longer occurs in the Microsoft Jet Database Engine version 3.51,
which is available from the Microsoft Software Library.
<P>
For information on how to obtain Microsoft Jet Database 3.51, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q172733.htm">Q172733</A></B>
   TITLE     : ACC97: Updated Version of Microsoft Jet 3.5 Available on MSL




</PRE></OL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
The following example uses the sample database Northwind.mdb because it
contains local tables with enforced relationships, which satisfies two of
the four requirements to produce the error.
<P>
This example assumes that you have linked the dbo.authors and
dbo.titleauthor tables to your database from the SQL Server sample
database called Pubs.
<P>
WARNING: Following these steps will cause an invalid page fault on your
computer. Make sure you save and close any open work on your computer
before following these steps.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new query based on the dbo_authors and
   dbo_titleauthor tables:
<P>
<P><PRE>      Query: TestError
      --------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: au_id
<PRE></PRE>         Table: dbo_authors
      Field: au_lname
         Table: dbo_authors
      Field: au_fname
         Table: dbo_authors
      Field: royaltyper
         Table: dbo_titleauthor

</PRE><P><LI>On the Query menu, click Run. Note that the query results appear in
   Datasheet view, and then the error occurs.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating SQL pass-through queries, search the
Help Index for "pass-through queries, overview," or ask the Microsoft
Access 97 Office Assistant.
<P>
For more information about customizing the system menu bar and database
toolbars, search the Help Index for "customizing menus," or ask the
Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: GPF IPF SPT<BR>
Keywords          : EvnGpf kberrmsg kbusage<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 29, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
