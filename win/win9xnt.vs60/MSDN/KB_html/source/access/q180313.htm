

<HTML>
<HEAD>
<TITLE>ACC: Error 2753 Using BeforeInsert to Populate Bound OLE Control </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q180313">
<META NAME="KBModify" CONTENT="1998/02/03">
<META NAME="KBCreate" CONTENT="1998/02/02">
<META NAME="Keywords" CONTENT="IntpOlea IntpCstm">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multi-user skills.  When you try to use the BeforeInsert event to populate a bound OLE control on a form, you may receive the following error.  In Microsoft Access 97     Run-time Error '2753'...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAPN,QDN9,QA7O,QAW6,QAB5,QAOE,QAMN,QAKR,QAHE,QBXS,QA9Q,QAO4,QAGB,QA5V P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Error 2753 Using BeforeInsert to Populate Bound OLE Control</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q180313</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multi-user skills.
<P>
When you try to use the BeforeInsert event to populate a bound OLE control
on a form, you may receive the following error.
<P>
<P><h3>In Microsoft Access 97</h3>
 
<P>
<PRE>   Run-time Error '2753':
   A problem occurred while Microsoft Access was communicating with
   the OLE server.

   Close the OLE server and restart it outside of Microsoft Access. Then
   try the original operation again in Microsoft Access.

</PRE><h3>In Microsoft Access 7.0</h3>
 
<P>
<PRE>   Run-time Error '2753':
   A problem occurred while Microsoft Access was communicating with
   the object application.

   Solution
   Close the object application, and then restart it outside of Microsoft
   Access. Then try the original operation again in Microsoft Access.

</PRE><h2>RESOLUTION</h2>
 
<P>
The following example uses the Current event to populate a bound OLE
control every time you create a new record. It creates the object only if
the control is empty.

<OL><P><LI>Follow steps 1 - 4 in the "Steps to Reproduce Behavior" section.

<P><LI>Switch the form to Design view and set the OnCurrent property of the
   form to the following event procedure:
<P>
<P><PRE>      Private Sub Form_Current()
<PRE></PRE>         ' If the control is empty.
         If Me![OLETest].OLEType = acOLENone Then
            With Me![OLETest]
               ' Set the object type to Embedded.
               .OLETypeAllowed = acOLEEmbedded
               ' Set the class.
               .Class = "Excel.Sheet"
               ' Create the embedded object.
               .Action = acOLECreateEmbed
               ' Fit the object to the size of the control.
               .SizeMode = acOLESizeStretch
            End With
            ' Set the focus back to the ID field.
            Me!ID.SetFocus
         End If
      End Sub

</PRE><P><LI>Switch the form to Form view and move to a new record. Note that OLETest
   is populated when you move to a new record.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
7.0 and 97. We are researching this problem and will post new information
here in the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open any database.

<P><LI>Create the following table:
<P>
<P><PRE>      Table: tblOLETable
      ------------------------
      Field Name: ID
<PRE></PRE>         Data Type: Text
      Field Name: OLETest
         Data Type: OLE Object

</PRE><P><LI>Close the table and save it as tblOLETable. When prompted to create a
   primary key, click No.

<P><LI>Use the AutoForm: Columnar Wizard to create a new form based on
   the tblOLETable table.

<P><LI>Switch the form to Design view and set the BeforeInsert property of the
   form to the following event procedure:
<P>
<P><PRE>      Private Sub Form_BeforeInsert(Cancel As Integer)
</PRE><P>
<PRE>         With Me![OLETest]
            ' Set the object type to embedded.
            .OLETypeAllowed = acOLEEmbedded
            ' Set the class.
            .Class = "Excel.Sheet"
            ' Create the embedded object.
            .Action = acOLECreateEmbed
            ' Size the object to fit the control.
            .SizeMode = acOLESizeStretch
         End With

      End Sub

</PRE><P><LI>Switch the form to Form view.

<P><LI>Type the letter "a" in the ID text box to trigger the BeforeInsert
   event. Note that you receive one of the errors described in the
   "Symptoms" section.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: custom activex active x<BR>
Keywords          : IntpOlea IntpCstm<BR>
Version           : WINDOWS:7.0,97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbpending<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
