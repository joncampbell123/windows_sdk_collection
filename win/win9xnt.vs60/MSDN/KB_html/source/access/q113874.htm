

<HTML>
<HEAD>
<TITLE>ACC: Field and Record Validation Rule Enforced at Engine Level </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113874">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="kberrmsg kbusage TblFldp">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  All versions of Microsoft Access (except Microsoft Access 1.x) enforce field and record validation rules defined at the table level, regardless of the data input or editing metho...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAKR,QA1S,QAPF,QAIB,QDN9,QA7O,QA7N,QA5V,QAY5,QAB9,QBV8,QAA3,QAUJ,QAD7,QADB P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Field and Record Validation Rule Enforced at Engine Level</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113874</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
All versions of Microsoft Access (except Microsoft Access 1.x) enforce
field and record validation rules defined at the table level, regardless
of the data input or editing method.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
In Microsoft Access version 1.x, field validation defined at the table
level is not enforced by the database engine. The validation rule and
validation text defined in table design are used as the defaults for the
ValidationRule and ValidationText properties in forms. There is no record
validation in Microsoft Access 1.x.
<P>
In all other versions of Microsoft Access, the validation rule for both the
field and table record are enforced at the engine level. The validation
rules are enforced whenever you add or edit data, whether through a table's
datasheet, a form based on the table, an append query, an update query,
Visual Basic or Access Basic code, or by importing data from another table.
<P>
If you have converted a database from Microsoft Access 1.x to a later
version of Microsoft Access, you can test to see if the data in the table
meets the validation rules with the Test Validation Rules command,
available by clicking the right mouse button on the title bar of the Table
Design window.
<P>
The expression for a field validation rule cannot refer to fields or
controls in a field validation rule, user-defined functions, Microsoft
Access domain functions, aggregate functions, or the CurrentUser() or
Eval() functions. The expression for a record validation rule cannot
contain user-defined functions, Microsoft Access domain functions,
aggregate functions, or references to forms, queries, or tables.
Expressions can include only references to fields in the table. If you
try to do field level validation on a table including any of the above
options you will encounter the following error message:
<P>
<PRE>   In Microsoft Access 97:

   The database engine does not recognize either the field '&lt;Field Name&gt;'
   in a validation expression, or the default value in the table
   '&lt;Table Name&gt;'.

   In Microsoft Access 2.0 and 7.0:

   Unknown or invalid reference '&lt;Field Name&gt;' in validation expression or
   default value in table '&lt;Table Name&gt;'.

</PRE>If you use a function in your validation rule you will receive this error
message:
<P>
<PRE>   Unknown function '&lt;Function Name&gt;' in validation expression or default
   value on '&lt;[Table Name]&gt;.[&lt;Field Name&gt;]'

</PRE>The table below identifies the interactions between the field and form
validation rules:
<P>
<PRE>   Field Validation
   Rule Defined       Form Validation
   (Table Level)      Rule Defined      Behavior
   ----------------------------------------------------------------------
   No                 No                No validation is performed
                                        at any level.

   Yes                No                Validation will be enforced
                                        regardless of method used
                                        to insert data.

   No                 Yes               Validation enforced at form level
                                        only. User can bypass the form
                                        validation rule when editing data
                                        outside the form.
                                        This is the same as Microsoft
                                        Access 1.x behavior.

   Yes                Yes               When editing data in a form, form
                                        validation rules will be enforced
                                        first. If the value passes form
                                        validation, then the field
                                        validation rule is enforced. In
                                        order for data to be accepted, it
                                        must pass both rules.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about validation rules, search the Help Index for
"validating data."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage TblFldp<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
