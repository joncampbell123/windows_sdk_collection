

<HTML>
<HEAD>
<TITLE>ACC1x: How to Make the Analyzer Include Field Descriptions </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109404">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1994/01/02">
<META NAME="Keywords" CONTENT="kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The Object Analyzer utility that comes with Microsoft Access does not include field descriptions in its output. However, you can make the Analyzer include field descriptions by making some modifications to the utility.  MORE INFORMATION  To make th...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA1S,QDN9,QAUR,QBXS,QA7O,QA5V,QAWI,QA7N,QBXT,QAIB,QAGB,QAU7,QATX,QAAW V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Make the Analyzer Include Field Descriptions</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109404</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The Object Analyzer utility that comes with Microsoft Access does not
include field descriptions in its output. However, you can make the
Analyzer include field descriptions by making some modifications to the
utility.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To make the Analyzer include field descriptions in its output you need to
modify the table RLTables and the function DumpTableInfo() in the
ANALYZER.MDA library.
<P>
The following steps describe how to make the necessary modifications:

<OL><P><LI>Use Windows Notepad (or any other text editor) to open the MSACCESS.INI
   file that is in your Windows directory. If the line
<P>
<P><PRE>      analyzer.mda=
</PRE><P>
   exists in the [Libraries] section of the MSACCESS.INI file, put a
   semicolon at the beginning of the line. The modified line will be:
<P>
<P><PRE>      ;analyzer.mda=
</PRE>
<P><LI>Save and then close the MSACCESS.INI file. Start Microsoft Access and
   open the database ANALYZER.MDA.

<P><LI>Open the RLTables table in Design view, and add a field called
   Description to the table. The field should have a data type of Text,
   with a length of 255 characters.

<P><LI>Save and then close the table, and then open the module Object Analyzer.

<P><LI>Find the function DumpTableInfo().

<P><LI>Add the lines of code listed below to the function. Note that the
   lines to be added begin with the characters $$.
<P>
   NOTE: In the following sample code, an underscore (_) is used as a
   line-continuation character. Remove the underscore from the end of the
   line when re-creating this code in Access Basic.
<P>
<P><PRE>     Sub DumpTableInfo (TargetDB As String, SQLTarget1 As String, _
       ObjOption As String, IsAttached As Integer)
       CurrentProc = "DumpTableInfo"
</PRE><P>
<P><PRE>       '$$ New code begins - declare new variables
       Dim F As Form, C As Control
       '$$ New code ends
</PRE><P>
<P><PRE>       If Not TableExists(TargetDB, SQLTarget1) Then
</PRE><P>
<PRE>          '$$ New code begins - change the SQL to include Description
          SQLSTRING$ = "Select TableName,Name,Type,Length,IndexName,_
                 Description Into [" &amp; SQLTarget1 &amp; "] in """ &amp; TargetDB _
                 &amp; """ From RLTables;"
          '$$ New code ends

          PerformSQLAction SQLSTRING$
       End If

       Set RT_Target = OpenDatabase(TargetDB)
       Set RT_Database = CurrentDB()
       Set RT_SysDB = CodeDB()
       Set RT_Table2 = RT_Target.OpenTable(SQLTarget1)
       Set RT_Dynaset1 = RT_Database.CreateDynaset(ObjOption)
       Set RT_Snapshot1 = RT_Dynaset1.ListFields()
       If Not IsAttached Then
          Set RT_Table1 = RT_Database.OpenTable(ObjOption)
          Set RT_Snapshot2 = RT_Table1.ListIndexes()
       End If

       '$$ New code begins - create a form in Design view
       Set F = CreateForm()
       'set the record source to the source table
       F.RecordSource = ObjOption
        '$$ New code ends

       Do Until RT_Snapshot1.EOF
          RT_Table2.AddNew
          RT_Table2!TableName = ObjOption
          RT_Table2!Name = RT_Snapshot1!Name
          RT_Table2!Type = LookUpFieldType(RT_Snapshot1!Type)
          RT_Table2!Length = RT_Snapshot1!Size

          '$$ New code begins - create a control for this field
          Set C = CreateControl(F.FormName, 109, 0, "", RT_Snapshot1!Name)
          'save the description from the field
          RT_Table2!Description = C.StatusBarText
          '$$ New code ends

          If Not IsAttached Then
             ' Cannot use FindFirst method on List Snapshots
             If RT_Snapshot2.RecordCount &gt; 0 Then
                RT_Snapshot2.MoveFirst
                Do Until RT_Snapshot2.EOF
                   If RT_Snapshot2!FieldName = RT_Snapshot1!Name Then _
                       Exit Do
                   RT_Snapshot2.MoveNext
                Loop
                If Not RT_Snapshot2.EOF Then
                   RT_Table2!IndexName = RT_Snapshot2!IndexName
                End If
             End If
          End If

          RT_Table2.Update
          RT_Snapshot1.MoveNext
       Loop

       '$$ New code begins - close the form, say "No" to save changes
       DoCmd SetWarnings True
       SendKeys "n"
       DoCmd Close A_FORM, F.FormName
       '$$ New code ends

       RT_CloseAllObjects
     End Sub

</PRE><P><LI>Save and close the module, and then quit Microsoft Access.

<P><LI>Use Windows Notepad (or any other text editor) to open the MSACCESS.INI
   file that is in your Windows directory. Remove the semicolon from the
   beginning of the
<P>
<P><PRE>      ;analyzer.mda=
</PRE><P>
   line in the [Libraries] section of the file. The modified line will
   be:
<P>
<P><PRE>      analyzer.mda=
</PRE>
<P><LI>Save and then close the file.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Object Analyzer, see the ANALYZER.TXT file
that comes with Microsoft Access version 1.1 or the README.TXT file that
comes with Microsoft Access version 1.0.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
