

<HTML>
<HEAD>
<TITLE>ACC2: Subform's DefaultEditing Can't Be Changed to Allow Edits </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132103">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/06/28">
<META NAME="Keywords" CONTENT="FmsSubf kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you have a main form that includes a subform, and you set the main form's DefaultEditing property to Read Only, the subform remains read-only and ignores any attempts to chang...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAMA,QAH4,QA1S,QDN9,QA5F,QAI2,QAUR,QDN7,QBT6,QBWS,QBV4,QBFN,QBDM,QALQ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Subform's DefaultEditing Can't Be Changed to Allow Edits</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132103</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you have a main form that includes a subform, and you set the main
form's DefaultEditing property to Read Only, the subform remains read-only
and ignores any attempts to change it to Allow Edits as long as the main
form is in Form view.
<P>
When you want to protect a form record's information, you can set the
form's DefaultEditing property to Read Only. If you need to be able to
change this property while the form is in Form view, you can add a command
button to your form that resets the DefaultEditing property to Allow Edits.
<P>
However, if your form contains a subform, the subform will not allow any
user input even when you explicitly change the DefaultEditing property of
the subform to Allow Edits.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Set the main form's DefaultEditing property to Allow Edits, and add a
macro or Access Basic code to the Open or Load event so that it changes
the DefaultEditing property to Read Only.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new form with the Main/Subform Wizard. Base the main form on
    the Suppliers table and the subform on the Products table.

<P><LI>Add text box controls for the Supplier ID, Company Name, Contact
    Name, and City fields to the Main Form.

<P><LI>Add text box controls for the Product ID, Product Name, and Unit Price
    fields to the subform.

<P><LI>Save the subform as myProductsSubform. Save the main form as
    MySuppliersMainForm.

<P><LI>Open the MySuppliersMainForm form in Design view

<P><LI>Change the DefaultEditing property to Read Only.

<P><LI>Without using the wizard, add a command button to the form.

<P><LI>Open the Properties window. Select the OnClick property for the command
    button, and then click the Build button. In the Choose Builder dialog
    box, select Macro Builder, create the following macro, and then save it
    as mcrAllowEdits:
<P>
<PRE>       Macro Name      Macro Actions
       -----------------------------
       mcrAllowEdits   SetValue
                       SetValue

       mcrAllowEdits Actions
       ----------------------------------------------
       SetValue
         Item: DefaultEditing
         Expression: 2
       SetValue
         Item: MyProductsSubform.Form.DefaultEditing
         Expression: 2

    NOTE: The mcrAllowEdits macro will change the DefaultEditing property
    to Allow Edits (2 in Access Basic).

</PRE><P><LI>Save the MySuppliersMainForm form, and then open the form in Form
    view.

<P><LI>Try changing one of the entries. Note that you cannot do so because
    the main form is read-only. Try to change entries in the subform. Note
    that you cannot do so because the subform has inherited the read-only
    property from the main form.

<P><LI>Click the command button, and try changing some entries on the main
    form. Note that now you can change them because the DefaultEditing
    property was changed to Allow Edits. Try to change some entries on the
    subform. Note that you cannot do so because the subform remained Read
    Only.
<P>
</OL><h3>Steps to Work Around Behavior</h3>
 

<OL><P><LI>Open the main form in Design view.

<P><LI>Change the DefaultEditing property to Allow Edits.

<P><LI>In the OnLoad property of the main form, create the following macro,
   and call it mcrReadOnly. This macro will change the DefaultEditing
   property to Read Only (3 in Access Basic).
<P>
<PRE>      Macro Name     Macro Actions
      ----------------------------
      mcrReadOnly    SetValue
                     SetValue

      mcrReadOnly Actions
      ----------------------------------------------
      SetValue
         Item: DefaultEditing
         Expression: 3
      SetValue
         Item: MyProductsSubform.Form.DefaultEditing
         Expression: 3

</PRE><P><LI>Try changing the entries by repeating steps 11 and 12. Note that this
   time the form allows edits.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the DefaultEditing property, search for
"AllowEditing," and then "AllowEditing, DefaultEditing Properties" using
the Microsoft Access Help menu.
<P>
For more information about macros see the Microsoft Access "User's Guide",
version 2, Chapter 24 and 25, "Macro Basics" and "Using Macros with Forms,"
pages 605-664.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsSubf kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
