

<HTML>
<HEAD>
<TITLE>ACC: Exporting Right-Aligned Fields to a Text File (1.x/2.0) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q148444">
<META NAME="KBModify" CONTENT="1997/07/18">
<META NAME="KBCreate" CONTENT="1996/03/13">
<META NAME="Keywords" CONTENT="IsmTxtd IsmTxtfx kbinterop kbprg PgmHowTo">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates two methods you can use to create a fixed-width text file that enables fields to be either left- or right-aligned.  This article assumes that you are fa...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA7N,QA7O,QA1S,QA5V,QAEB,QAMB,QDN9,QADF,QATX,QAUJ,QAMA,QA5F,QA3P,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Exporting Right-Aligned Fields to a Text File (1.x/2.0)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 18, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q148444</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates two methods you can use to create a fixed-width
text file that enables fields to be either left- or right-aligned.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual in Microsoft Access version
1.x, or the "Building Applications" manual, Chapter 3, "Introducing Access
Basic" in version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1</h3>
 
<P>
The following steps demonstrate how to use a query and a macro to create a
fixed-width text file using the Orders table in the sample database
NWIND.MDB. The Customer ID field will be left-aligned and the Order Date
and Freight fields will be right-aligned in the text file:

<OL><P><LI>Open the sample database NWIND.MDB, and create the following new query
   based on the Orders Table.
<P>
   NOTE: In the following sample expressions, an underscore (_) at the end
   of a line is used as a line-continuation character. Remove the
   underscore from the end of the line when re-creating these expressions.
<P>
<P><PRE>      Query: Right Justify Orders
      ------------------------------------------------------------------
</PRE><P>
<P><PRE>      Field: Customer ID
      Field: Expr1: Space(12-Len(Format([Order Date],"Short Date"))) &amp; _
<PRE></PRE>                    Format([Order Date],"Short Date")

      Field: Expr2: Space(15-Len(Format([Freight],"Currency"))) &amp; _
                    Format([Freight],"Currency")

      NOTE: The Space() function is used to pad spaces at the beginning of
      the field. The numbers 12 and 15 at the start of the Space()
      function indicate the desired total width of that field in the text
      file. These numbers are used again in step 5 below.

</PRE><P><LI>Save the query as "Right Justify Orders" (without the quotation marks),
   and then run the query.
<P>
   Note that the fields may not appear to be right-aligned unless you are
   using a fixed-width font such as Courier. This can be ignored because
   it does not affect the text file.

<P><LI>Close the query to return to the Database window.

<P><LI>On the File menu, click Imp/Exp Setup.

<P><LI>In the Field Information table of the Import/Export Specification
   dialog box, type the Field Name, Data Type , Start, and Width for each
   field as follows:
<P>
<PRE>      Field Name   Data Type  Start   Width
      ----------   ---------  -----   -----
      Customer ID   Text        1       10
      Expr1         Text        11      12
      Expr2         Text        23      15

</PRE><P><LI>Click the Save As button and save the specification as "Orders Spec"
   (without the quotation marks). Click OK to close the Import/Export
   Specification dialog box.

<P><LI>Create a new macro as follows:
<P>
<P><PRE>      Macro Action
      ------------
      TransferText
</PRE><P>
<P><PRE>      TransferText Actions
      --------------------
<PRE></PRE>         Transfer Type: Export Fixed Width
         Specification Name: Orders Spec
         Table Name: Right Justify Orders
         File Name: C:\Orders.txt
         Has Field Names: No

      NOTE: You can specify the name of a query in the Table Name
      argument.

</PRE><P><LI>Run the macro.

<P><LI>Open the C:\Orders.txt file using NotePad. Note that the Customer ID
   field is left-aligned and the Order Date and Freight fields are
   right-aligned. The field names will not be included in the first row of
   the text file. If you set the "Has Field Names" argument in the macro
   to Yes, the field names will be delimited instead of fixed-width. Use
   Method 2 if you want to include field names in the first row of a
   fixed-width text file.
<P>
</OL><h3>Method 2</h3>
 
<P>
The following steps demonstrate how to use Access Basic to create a
fixed-width text file using the Orders table in the sample database
NWIND.MDB. The Customer ID field will be left-aligned and the Order Date
and Freight fields will be right-aligned.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Create a new module.

<P><LI>In the Declarations section of the module, add the following line:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Create the following function:
<P>
<P><PRE>      Function CreateTextFile()
<PRE></PRE>        'This function creates a fixed-width text file using the
        'Orders table in NWIND.MDB. The Customer ID field will
        'be left-aligned and the Order Date and Freight fields
        'will be right-aligned.

        'Create a Dim statement for each field to export to the text
        'file. For the data type of each field, use "String *" followed
        'by the width of the field.
        Dim strCustomerId As String * 10 'Specifies width of 10 characters.
        Dim strOrderDate As String * 12  'Specifies width of 12 characters.
        Dim strFreight As String * 15    'Specifies width of 15 characters.

        'Create a recordset based on the Orders table.
        Dim mydb As Database
        Dim mytable As Table
        Set mydb = CurrentDB()
        Set mytable = mydb.OpenTable("Orders")

        'Determine the index to sort the table by.
        mytable.Index = "PrimaryKey" 'A primary key must exist in the
                                     'Orders table.

        'Create the text file. Note the use of the RSet statement
        'to right-align a field. You can use the LSet statement if you
        'want to left-align a field (or simply assign the variable
        'without using RSet or LSet.)

        Dim intFile As Integer
        intFile = FreeFile
        Open "C:\Orders.txt" For Output As intFile

        'The following section is optional. It puts the field names in the
        'first row of the text file. Remove the comment mark (') from these
        'lines if you want to put field names in the first row of the text
        'file.
        'LSet strCustomerId = "CustomerID"
        'RSet strOrderDate = "OrderDate"
        'RSet strFreight = "Freight"
        'Print #intFile, strCustomerId &amp; strOrderDate &amp; strFreight

        'This section puts the records from the Orders table in the text
        'file.
        mytable.MoveFirst
        Do Until mytable.EOF
            LSet strCustomerId = mytable![Customer ID]
            RSet strOrderDate = Format(mytable![Order Date], "Short Date")
            RSet strFreight = Format(mytable![Freight], "Currency")
            'Concatenate all of the variables together as in the following:
            Print #intFile, strCustomerId &amp; strOrderDate &amp; strFreight
            'The following optional line can be used to create a blank row
            'after each record. Remove the comment mark (') from the
            'following line if you want to create a blank row after each
            'line.
            'Print #intFile,
            mytable.MoveNext
        Loop

        Close intFile
        mytable.Close
        mydb.Close
        MsgBox "Text file has been created!"

      End Function

</PRE><P><LI>Click Immediate Window on the View menu, type the following line, and
   then press ENTER to run the function:
<P>
<P><PRE>      ? CreateTextFile()
</PRE>
<P><LI>Open the C:\Orders.txt file using NotePad. Note that the Customer ID
   field is left-aligned and the Order Date and Freight fields are
   right-justified.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For an example of this information in Microsoft Access for Windows 95
version 7.0, please see the following article in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q150401.htm">Q150401</A></B>
   TITLE:      ACC95: Exporting Right-Aligned Fields to a Text File

</PRE></OL>For more information about using Access Basic to create text files, search
for "Print #," and then "Print # Statement" using the Microsoft Access Help
menu.
<P>
For more information about aligning fields in a fixed-width text file,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q98663.htm">Q98663</A></B>
   TITLE     : ACC: Exporting to Fixed-Width Text File Left-Aligns
               Numbers
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: justify<BR>
Keywords            : IsmTxtd IsmTxtfx kbinterop kbprg PgmHowTo<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 18, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
