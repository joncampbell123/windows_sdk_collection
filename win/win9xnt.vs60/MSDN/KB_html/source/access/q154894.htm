

<HTML>
<HEAD>
<TITLE>ACC: How to Maintain a Print Log for Reports </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q154894">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1996/08/16">
<META NAME="Keywords" CONTENT="kbusage RptEvent">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to add a record to a table each time you print a report. This technique is useful for maintaining a print log that tracks the print history of a report...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAOX,QA5V,QAPN,QBRM,QAO4,QA1S,QAHE,QBXS,QAH4,QDN9,QDMH,QDKY,QA2X,QAUR,QAPF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Maintain a Print Log for Reports</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q154894</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to add a record to a table each time you print a
report. This technique is useful for maintaining a print log that tracks
the print history of a report.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example uses the Print event of a Microsoft Access report to
add a record to a table. The record contains the report's name and print
date. The example uses the report's Activate and Deactivate events to set a
global variable that is evaluated during the Print event. This prevents
Print Preview from adding a new record to the history table.
<P>
NOTE: In Microsoft Access 7.0 and 97, there is one sequence of events
that will create a new record in the history table when you Print Preview
the report. If you open the report in Design view to view or change any of
its code and then switch to Print Preview, the Activate event does not
occur, and the global variable is not set. To work around this problem,
after viewing or changing the report's code, close the report before you
open it in Print Preview.
<P>
CAUTION: Following the steps in this example will modify the sample
database Northwind.mdb (or NWIND.MDB in version 2.0 or earlier). You may
want to back up the Northwind.mdb (or NWIND.MDB) file and perform these
steps on a copy of the database.
<P>
<P><h3>Creating a History Table and a Report</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).

<P><LI>Create a table with the following structure:
<P>
<P><PRE>      Table: tblPrintedReports
      --------------------------------------------------
      Field Name: ID
<PRE></PRE>         DataType: AutoNumber (or Counter in version 2.0)
         Indexed: Yes (No Duplicates)
      Field Name: ReportName
         DataType: Text
         FieldSize: 75
      Field Name: PrintDate
         DataType: Date/Time
         Format:  General Date

      Table Properties: tblPrintedReports
      -----------------------------------
      PrimaryKey: ID

</PRE><P><LI>Create a new module and type the following lines in the Declarations
   section:
<P>
<P><PRE>      Option Explicit
      Global Flag
</PRE>
<P><LI>Save the module as basPrintedReports, and then close it.

<P><LI>Create an AutoReport based on the Customers table. Save the report as
   rptCustomers.

<P><LI>Open the rptCustomers report in Design view. Set the report's OnActivate
   property to the following event procedure:
<P>
<P><PRE>      Private Sub Report_Activate()
      Flag = 0
      End Sub
</PRE>
<P><LI>Set the report's OnDeactivate property to the following event procedure:
<P>
<P><PRE>      Private Sub Report_Deactivate()
      Flag = -1
      End Sub
</PRE>
<P><LI>Set the report header's OnPrint property to the following event
   procedure.
<P>
   NOTE: You must include the report header section on the report, and its
   Height property must be greater than zero. However, you do not have to
   place any controls in the header section.
<P>
<PRE>      Sub ReportHeader3_Print (Cancel As Integer, PrintCount As Integer)
      Dim dbs As Database, rst As Recordset
         Set dbs = CurrentDB()
         Set rst = dbs.OpenRecordset("tblPrintedReports")
      Flag = Flag + 1
      ' If the current value of Flag = 1, then a hard copy of the
      ' report is printing, so add a new record to the history table.
      If Flag = 1 Then
         rst.AddNew
         rst!ReportName = "rptCustomers"
         rst!PrintDate = Now
         rst.Update
         Flag = 0
      End If
      End Sub

</PRE><P><LI>Save the rptCustomers report, and then close it.
<P>
</OL><h3>Generating a History Record</h3>
 

<OL><P><LI>Select the rptCustomers report in the Database window.

<P><LI>On the File menu, click Print to print the report.

<P><LI>Open the tblPrintedReports table. Note that a new record shows the
   report name, and the date and time it was printed. For example:
<P>
<PRE>      ID   ReportName     PrintDate
      --------------------------------------
       1   rptCustomers   8/13/96 3:25:11 PM

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about Activate and Deactivate events, search the Help
Index for "Activate," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about Print events, search the Help Index for "Print
Event," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: evaluate diary<BR>
Keywords            : kbusage RptEvent<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
