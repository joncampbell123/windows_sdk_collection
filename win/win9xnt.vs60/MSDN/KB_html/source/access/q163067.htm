

<HTML>
<HEAD>
<TITLE>ACC97: Exchange/Outlook Driver Example Incorrect in Acread80.wri </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163067">
<META NAME="KBModify" CONTENT="1997/10/13">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="DcmOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  In the Microsoft Access 97 Readme file, Acread80.wri, the following code sample in the Microsoft Exchange/Outlook Driver section is incomplete:     To open a Microsoft Exchange/O...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVO,QAYC,QAPN,QA1S,QDKY,QAZV,QAPF,QBUP,QAH4,QAFI,QBRU,QBXS,QDJ2,QANF,QAFF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Exchange/Outlook Driver Example Incorrect in Acread80.wri</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163067</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
In the Microsoft Access 97 Readme file, Acread80.wri, the following code
sample in the Microsoft Exchange/Outlook Driver section is incomplete:
<P>
<PRE>   To open a Microsoft Exchange/Outlook folder directly, use the
   OpenDatabase method and specify values for the following parts:
   database, options = True, read-only = True, and a dbname data source.
   The following code example uses the OpenDatabase method to open a
   Microsoft Exchange/Outlook folder named Barbara and count the number of
   messages received from a user named Jim Harris:

      Public Sub OpenExchangeFolder()
         Dim dbsExchange As Database, intCount As Integer
         Dim rst As Recordset, str As String
         str = "Exchange 4.0;MAPILEVEL=" _
            &amp; "Dave Jones (Exchange)|People\Important;TABLETYPE=0;"
         Set dbsExchange = OpenDatabase _
            ("C:\Data\Temp.mdb", 0, 0, str)
         Set rst = dbsExchange.OpenRecordset("Barbara")
         rst.MoveFirst
         While Not rst.EOF
            If rst!From = "Jim Harris" Then
               intCount = intCount + 1
            End If
            rst.MoveNext
         Wend
         rst.Close
         dbsExchange.Close
      End Sub

</PRE><h2>RESOLUTION</h2>
 
<P>
The Database and Profile arguments are missing from the str variable in
the code example, which is used as the connect parameter for the
OpenDatabase method. The Database argument indicates the Microsoft Access
database in which to open the Microsoft Outlook/Exchange recordset; the
Profile argument indicates the Microsoft Outlook/Exchange profile to use
when you open the recordset. You can view the profiles you have set up on
your computer by double-clicking the Mail icon in Control Panel. When the
Microsoft Outlook Properties dialog box appears, click Show Profiles.
<P>
NOTE: You can download the Exchange/Outlook Wizards from Microsoft’s Web
site on the Internet. The wizard enables you to import or link to
Microsoft Exchange/Outlook data without writing Visual Basic code. The
wizards are available at <B><A href="http://www.microsoft.com/accessdev/a-free.htm">http://www.microsoft.com/accessdev/a-free.htm.</A></B>
<P>
Modify the example to include the Database and Profile arguments:
<P>
<PRE>   Public Sub OpenExchangeFolder()
      Dim dbsExchange As Database, intCount As Integer
      Dim rst As Recordset, str As String
      str = "Exchange 4.0;MAPILEVEL=" _
         &amp; "Dave Jones (Exchange)|People\Important;TABLETYPE=0;" _
         &amp; "DATABASE = C:\Data\Temp.mdb;PROFILE = Microsoft Outlook"
      Set dbsExchange = OpenDatabase _
         ("C:\Data\Temp.mdb", 0, 0, str)
      Set rst = dbsExchange.OpenRecordset("Barbara")
      rst.MoveFirst
      While Not rst.EOF
         If rst!From = "Jim Harris" Then
            intCount = intCount + 1
         End If
         rst.MoveNext
      Wend
      rst.Close
      dbsExchange.Close
   End Sub

</PRE><h2>MORE INFORMATION</h2>
 
<P>
If you want to link the Microsoft Outlook/Exchange folder as a table in
your database and not just open it in code, the following sample code
shows you how.
<P>
<P><h3>Linking to a Personal Folder</h3>
 
<P>
<PRE>   ' This procedure links a personal address book.
     Sub LinkPersonalFolder()
     Dim dbsCurrent As Database
     Dim tdfAddress As Tabledef

   ' Open the Jet database.
     Set dbsCurrent = DBEngine.Workspaces(0).OpenDatabase _
     ("C:\My Documents\Example.mdb")

   ' Create a table definition for the Exchange table.
     Set tdfAddress = dbsCurrent.CreateTableDef("Personal Addresses")

   ' Provide the name of the Exchange file with the Connect property.
     tdfAddress.Connect = "Exchange 4.0;MAPILEVEL=Personal Folders|;" _
     &amp; "TABLETYPE=1;DATABASE=C:\My _
        Documents\Example.mdb;PROFILE=MyProfile"

   ' Provide the name of the table with the SourceTableName property.
     tdfAddress.SourceTableName = "Personal Address Book"

   ' Append the TableDef to the TableDefs collection to create the link.
     dbsCurrent.TableDefs.Append tdfAddress

     End Sub

</PRE><h3>Linking to a Folder in Your Mailbox</h3>
 
<P>
<PRE>   ' This procedure links to a mailbox folder called Student Info.
     Sub LinkStudentFolder
     Dim dbsCurrent As Database
     Dim tdfStudent As Tabledef

   ' Open the Jet database.
     Set dbsCurrent = DBEngine.Workspaces(0).OpenDatabase _
     ("C:\My Documents\Example.mdb")

   ' Create a table definition for the Exchange table.
     Set tdfStudent = dbsCurrent.CreateTableDef("Student Folder")

   ' Provide the name of the Exchange file with the Connect property.
     tdfStudent.Connect = "Exchange 4.0;MAPILEVEL=Mailbox - Nancy _
        Davolio|;" _
        &amp; "TABLETYPE=0;DATABASE=C:\My _
        Documents\Example.mdb;PROFILE=MyProfile"

   ' Provide the name of the table with the SourceTableName property.
     tdfStudent.SourceTableName = "Student Info"

   ' Append the TableDef to the TableDefs collection to create the link
     dbsCurrent.TableDefs.Append tdfStudent.

     End Sub

</PRE><h3>Linking to a Public Folder</h3>
 
<P>
<PRE>   ' This procedure links to a public folder called School Info.
     Sub LinkStudentInfo
     Dim dbsCurrent As Database
     Dim tdfSchoolInfo As Tabledef

   ' Open the Jet database.
     Set dbsCurrent = DBEngine.Workspaces(0).OpenDatabase _
     ("C:\My Documents\Example.mdb")

   ' Create a table definition for the Exchange table.
     Set tdfSchoolInfo = dbsCurrent.CreateTableDef("School Information")

   ' Provide the name of the Exchange file with the Connect property.
     tdfSchoolInfo.Connect = "Exchange 4.0;MAPILEVEL=Public Folders|;" _
     &amp; "TABLETYPE=0;DATABASE=C:\My _
        Documents\Example.mdb;PROFILE=MyProfile"

   ' Provide the name of the table with the SourceTableName property.
     tdfSchoolInfo.SourceTableName = "School Info"

   ' Append the TableDef to the TableDefs collection to create the link.
     dbsCurrent.TableDefs.Append tdfSchoolInfo

     End Sub

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using the OpenDatabase method to connect to a
Microsoft Outlook/Exchange folder, search the Help Index for "OpenDatabase
Method."
<P>
For more information about the Microsoft Outlook/Exchange connect
argument, search the Help Index for "Connect property."
<P>
For more examples of linking a Microsoft Outlook/Exchange folder as a
Microsoft Access 97 table, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q161174.htm">Q161174</A></B>
   TITLE     : ACC97: Sample Procedure to Attach a Microsoft Outlook Folder
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: attach mail mapi<BR>
Keywords          : DcmOthr<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbdocerr<BR>
Solution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
