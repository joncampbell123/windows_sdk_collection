

<HTML>
<HEAD>
<TITLE>ACC97: No Match Results in FileSearch When Adding FileType </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177091">
<META NAME="KBModify" CONTENT="1997/11/24">
<META NAME="KBCreate" CONTENT="1997/11/20">
<META NAME="Keywords" CONTENT="GnlFnd">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you search for file extensions using the FileType property of the FileSearch object, certain file extensions may return a  files found = 0  message even though the info...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA01,QBWP,QAPN,QBLX,QDN9,QA1S,QBXT,QA5V,QAY5,QABA,QAOG,QAIB,QAH4,QAHH,QABN P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: No Match Results in FileSearch When Adding FileType</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177091</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you search for file extensions using the FileType property of the
FileSearch object, certain file extensions may return a "files found = 0"
message even though the information does exist.
<P>
For example, this behavior occurs if you search for information on any of
the following file extensions:

<UL><LI>SYS
<LI>DLL
<LI>VXD
<LI>386
<LI>DRV
<P>
</UL><h2>CAUSE</h2>
 
<P>
When you search for files that are hidden by default by Windows, they are
excluded from indexing and content searching if the FileType property is
included.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Do not include the FileType property if the file extension is not normally
found in the Files Of Type box in the File Open dialog box.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a module and type the following line in the Declarations
   section if it is not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<PRE>      Sub TestSearch()
         Dim objFS As Object

         Set objFS = Application.FileSearch

         With objFS

            '  Resets all the search criteria settings to their default
            '  settings.
            .NewSearch

            '  Where to search in Windows 95. For Windows NT 4.0, change
            '  the path to "C:\Winnt\System32\".
            .LookIn = "C:\"

            '  This will limit the search.
            .FileType = msoFileTypeAllFiles

            .FileName = "*.SYS"

            '  Search for "WinDir" within a file. This string is present
            '  in the file, MSDOS.SYS, in Windows 95. For Windows NT 4.0,
            '  change to "Invalid."
            .TextOrProperty = "WinDir"

            '  Limit the search to the root.
            .SearchSubFolders = False

            '  Begin the search.
            .Execute
        End With

         ' Show the number of files found.
         MsgBox "Files found = " &amp; objFS.FoundFiles.Count

      End Sub

</PRE><P><LI>To test this function, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>      TestSearch
</PRE><P>
   Note that the message box opens and displays the following message:
<P>
<P><PRE>      Files found = 0
</PRE>
<P><LI>Comment out the following line of code by placing an apostrophe (') in
   front of the line:
<P>
<P><PRE>      .FileType = msoFileTypeAllFiles
</PRE>
<P><LI>Rerun the procedure.
<P>
   Note that the message box displays the correct count for the files
   that contain the search string.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about "FileSearch," search the Help Index for
"FileSearch object," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: 97<BR>
Keywords          : GnlFnd<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
