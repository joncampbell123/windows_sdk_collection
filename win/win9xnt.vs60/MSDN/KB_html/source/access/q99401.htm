

<HTML>
<HEAD>
<TITLE>ACC: How First Line of Data Is Used to Import Delimited Text </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99401 ">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1993/05/27">
<META NAME="Keywords" CONTENT="IsmTxtd kb3rdparty">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  The first line of data is extremely important when you are importing delimited text files. Microsoft Access 2.0 and earlier uses the first line of data to determine the fol...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBRZ,QA5V,QA7O,QA7N,QA1S,QDN9,QAMB,QATX,QBXT,QAIB,QAKC,QBC6,QAYY,QAB4,QAP2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How First Line of Data Is Used to Import Delimited Text</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99401 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
The first line of data is extremely important when you are importing
delimited text files. Microsoft Access 2.0 and earlier uses the first
line of data to determine the following:

<UL><LI>The number of fields
<LI>The data type for each field
<P>
</UL>For this reason, it is important to verify that the first line of data
correctly reflects the rest of the data in the table. This article
discusses some of the common problems you may encounter when the first
line of data is incorrect and how to work around these problems.
<P>
In Microsoft Access 97, the Import Text Wizard (Text Import Wizard in
version 7.0) offers greater flexibility. The wizard uses more than just
the first line when determining the number of fields to create in a new
table and it allows you to change the data type of the fields before they
are actually imported. However, if lines far down in the text file contain
more fields than the first few lines, the Import Text Wizard will not see
them and the additional fields will be ignored. In this situation, use the
technique described in the "Other Workarounds" section below.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To specify the structure that Microsoft Access should use, you can use
the following steps instead of relying on the first line of data:

<OL><P><LI>Create a table in Microsoft Access that has the correct number of
   fields and the correct data type for each field.

<P><LI>On the File menu, click Import.

<P><LI>Select Text (Delimited) from the Data Source list and click OK.

<P><LI>Select the text file and click OK.

<P><LI>In the Import Text Options dialog box, click Append To Existing
   Table and specify the table you created in step 1.

<P><LI>Click OK to import the file.
<P>
</OL><h3>Determining the Number of Fields</h3>
 
<P>
Microsoft Access scans the first line of data to determine the number
of fields in the text file. If successive records contain more fields,
these are ignored and no error message is given. For example, suppose
you have a text file that looks like the following:
<P>
<PRE>   5959,"John Doe","123 Main Street"
   5960, "George Brown","55 Orange Avenue","MainTown","WA","USA"

</PRE></OL>Because the first line only contains three fields, Microsoft Access
creates the following table:
<P>
<PRE>   Column 1     Column 2          Column 3
   -----------------------------------------------
   5959         John Doe          123 Main Street
   5960         George Brown      55 Orange Avenue

</PRE>Note that the additional fields are ignored and no error message is
generated.
<P>
<P><h3>Determining the Data Types</h3>
 
<P>
Microsoft Access scans the first line to determine the data type for
each field. If the data type in the field is invalid, a "Type Conversion
Failure" error message is generated in the Import Errors table. For
example, if the following text file is imported
<P>
<PRE>   5959,"John Doe","123 Main Street",8/12/90
   5960,"George Brown","55 Orange Avenue",81290
   ABCD,"Jane Bell","78 West Street",8/12/90

</PRE>Microsoft Access detects four fields with the following data types:
<P>
<PRE>   Field      Data Type
   --------------------
   1          Number
   2          Text
   3          Text
   4          Date/Time

</PRE>The second record fails to convert because the number 81290 in the
fourth field is not a Date/Time data type, as determined by the first
record value (8/12/90). The third record fails because "ABCD" in the
first field is not a number. As a result, Microsoft Access reports
type conversion errors in each case.
<P>
<P><h3>Other Workarounds</h3>
 
<P>
In addition to import appending the text file to an existing table, it
is also possible to use a text editor to edit the first line of data
to correctly reflect the number of fields and data types in the file.
<P>
If a field in the first row contains a number that is supposed to
belong in a text field, type double quotation marks (" ") around the number
in the first row. Microsoft Access will then correctly interpret the
field as a text field.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: import<BR>
Keywords            : IsmTxtd kb3rdparty<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
