

<HTML>
<HEAD>
<TITLE>ACC: "Communication Link Failure" Err Msg Using RAS and ODBC </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q128884">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1995/04/12">
<META NAME="Keywords" CONTENT="kberrmsg kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT=" IMPORTANT: This article contains information about editing the registry. Before you edit the registry, you should first make a backup copy of the registry files (System.dat and User.dat).   Advanced: Requires expert coding, interoperability, and mul...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA9E,QAI5,QBG2,QDIU,QAB4,QAL0,QAKD,QABA,QAAP,QAKP,QBAO,QAGB,QDL9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "Communication Link Failure" Err Msg Using RAS and ODBC</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q128884</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat).
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you connect to a SQL Server database using Open Database Connectivity
(ODBC) and Remote Access Service (RAS), you receive the following ODBC
error message:
<P>
<PRE>   Communication Link Failure

</PRE><h2>CAUSE</h2>
 
<P>
This error can occur if the following conditions are met:

<UL><LI>You successfully connected to the SQL Server; for example, you
   opened an attached table.

<LI>You dropped the RAS connection and restarted it.

<LI>You tried to use the SQL Server, perhaps by opening the attached table
   again.
<P>
</UL>When you shut down a RAS connection, RAS closes the connection to the SQL
Server. Microsoft Access, however, believes the connection is still open
because it did not close the connection. So, Microsoft Access tries to
reuse the same connection without reconnecting. This causes the error.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this behavior, avoid closing the RAS connection. Also, fix
any hardware problems that may be causing the RAS connection to close.
<P>
You can also set the ConnectionTimeout value in the Windows 95 registry
(for Microsoft Access 7.0 and 97) or in the [ODBC] section of the
MSACC20.INI (for version 2.0) to a smaller value. By default, Microsoft
Access assumes it to be 600 seconds. To have Microsoft Access close the
ODBC connection after 10 seconds if it is not being used, follow the
steps appropriate for your version of Microsoft Access.
<P>
NOTE: By default, the ConnectionTimeout setting is not included in the
MSACC20.INI file for version 2.0 or the Windows 95 registry for version
7.0.
<P>
<P><h3>In Microsoft Access 97</h3>
 
<P>
For information about how to edit the registry, view the "Changing Keys
And Values" online Help topic in Registry Editor (Regedit.exe). Note that
you should make a backup copy of the registry files (System.dat and
User.dat) before you edit the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems
that may require you to reinstall Windows 95. Microsoft cannot guarantee
that problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.

<OL><P><LI>The ODBC settings are all written to the registary during setup. Locate
   the ConnectionTimeout value in HKEY_LOCAL_MACHIN\SOFTWARE\Microsoft\
   Jet\3.5\Engines\ODBC.

<P><LI>Double-Click on ConnectionTimeout, type 10 in Value data, and then
   click OK.
<P>
</OL><h3>In Microsoft Access 7.0</h3>
 
<P>
For information about how to edit the registry, view the "Changing Keys
And Values" online Help topic in Registry Editor (Regedit.exe). Note that
you should make a backup copy of the registry files (System.dat and
User.dat) before you edit the registry.
<P>
WARNING: Using Registry Editor incorrectly can cause serious problems
that may require you to reinstall Windows 95. Microsoft cannot guarantee
that problems resulting from the incorrect use of Registry Editor can be
solved. Use Registry Editor at your own risk.

<OL><P><LI>Add a new key named "ODBC" (without the quotation marks) under the
<P>
   HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/Access/7.0/Jet/3.0/Engines key

<P><LI>Add the following new value to the ODBC key:
<P>
<P><PRE>      Name: ConnectionTimeout
      Type: DWORD
      Value: 10
</PRE><P>
</OL><h3>In Microsoft Access version 2.0</h3>
 
<P>
Add the following line to the [ODBC] section of the MSACC20.INI file:
<P>
<PRE>   ConnectionTimeout=10

</PRE></OL>Because Microsoft Access initiates the disconnection with this setting,
it knows to reconnect before using the connection again.
<P>
NOTE: This change to the ConnectionTimeout setting may reduce performance
because Microsoft Access must create an ODBC connection more frequently
over the RAS connection.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about creating ODBC registry settings in Microsoft
Access 7.0, please see the following articles in the Microsoft Knowledge
Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q139044.htm">Q139044</A></B>
   TITLE     : ACC95: How to Add Former MSACC20.INI ODBC Section to
               Registry
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage OdbcOthr<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
