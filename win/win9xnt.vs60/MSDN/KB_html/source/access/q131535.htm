

<HTML>
<HEAD>
<TITLE>ACC: Unable to Undo or Rollback Main Form and Subform Changes </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131535">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1995/06/13">
<META NAME="Keywords" CONTENT="FmsSubf kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you make editing changes to a main form record and one or more subform records, and then choose Undo Saved Record from the Edit menu, Microsoft Access does not undo changes ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QA1S,QDN9,QBXS,QAMA,QAGC,QBJZ,QDMH,QDN7,QAPF,QAI2,QBVV,QAY2,QAU7,QAUR P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Unable to Undo or Rollback Main Form and Subform Changes</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131535</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you make editing changes to a main form record and one or more subform
records, and then choose Undo Saved Record from the Edit menu, Microsoft
Access does not undo changes made to the main form and the subform
together.
<P>
If focus is in the main form, Undo Saved Record will undo changes to the
main form record only. If focus is in the subform, Undo Saved Record will
undo the changes made to the last record you made changes to and not to
other records you may have edited in the subform.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, FrmSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and FrmSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q150895.htm">Q150895</A></B>
   TITLE     : ACC95: Microsoft Access Sample Forms Available on MSL

   ARTICLE-ID: <B><A href="../access/q175066.htm">Q175066</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Forms Available on MSL

</PRE><h2>CAUSE</h2>
 
<P>
Because Microsoft Access does not group edits made to the main form record
and edits made to one or more subform record in a single transaction,
Microsoft Access cannot roll back the changes as a single unit.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around to this behavior, you may find the method described in
the sample Microsoft Access 2.0 database, UNDOFM.MDB useful. For
information on how to obtain UNDOFM.MDB, please see the following article
in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q149358.htm">Q149358</A></B>
   TITLE     : ACC2: Sample to Undo Changes in Forms Available on MSL

</PRE><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access maintains editing changes you make to a single record in a
form in a transaction independent of changes you make to other records in
the same form or in other forms, including subforms. When you choose to
undo a record, Microsoft Access rolls back the transaction only for that
singular record in the form.
<P>
This behavior extends to subforms. Microsoft Access maintains editing
changes for a subform record in one transaction independent of record
edits you make to other subform records in the same form or in another
form, including the main form.
<P>
Because of the way that Microsoft Access maintains editing changes, it is
not possible to group editing changes you make to a main form and subform
records in a single transaction. You cannot use the BeginTrans, CommitTrans
and Rollback statements or methods for this purpose. Microsoft Access
controls all transaction processing for a form in a separate workspace
independent of the workspace that these actions and methods could be
invoked in, and Microsoft Access does not expose this separate workspace.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in versions
   1.x or 2.0).

<P><LI>Open the Categories form in Form view.

<P><LI>In the CategoryName field, change the category from "Beverages" to
   "Super Beverages."
<P>
   NOTE: In versions 1.x and 2.0, there is a space in Category Name.

<P><LI>Under Product Name in the subform, change the first record's name
   from "Chai" to "Tasty Chai."

<P><LI>Click the CategoryName field on the main form, and from the Edit
   menu, choose Undo Saved Record. Note that in the main form "Super
   Beverages" returns to "Beverages," but that in the subform "Tasty
   Chai" remains "Tasty Chai."

<P><LI>Click the first record in the subform, and from the Edit menu, choose
   Undo Saved Record. Note that "Tasty Chai" returns to "Chai."
</OL> 
<PRE>Keywords          : FmsSubf kbusage
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbprb
Solution Type     : Info_Provided</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
