

<HTML>
<HEAD>
<TITLE>ACC1x: Microsoft Access Closes Abnormally from a Macro </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109366">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1994/01/02">
<META NAME="Keywords" CONTENT="kbusage McrActn">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  When Microsoft Access is unexpectedly closed by a macro, system resources are not released, and Microsoft Access remains in the Microsoft Windows Task List even though the application is no longer available.  CAUSE =====  The abnormal closing of Mi...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAH4,QAGB,QBWS,QAPN,QAAW,QBJZ,QA01,QAY2,QAGU,QBXS,QBVV,QAO4,QAIM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Microsoft Access Closes Abnormally from a Macro</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109366</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
When Microsoft Access is unexpectedly closed by a macro, system resources
are not released, and Microsoft Access remains in the Microsoft Windows
Task List even though the application is no longer available.
<P>
<P><h2>CAUSE</h2>
 
<P>
The abnormal closing of Microsoft Access is due to event timing in
the macro. The macro opens the Categories table, calls the Replace In
Field dialog box, and then closes the Categories table. However, the
Replace In Field dialog box, by design, functions differently than other
dialog boxes do by allowing macros to continue running while the dialog box
is displayed. Because the macro continues running the Categories table
is closed before the replace action is completed. There is no macro
action to pause the macro's execution; macro events occur sequentially
unless a modal dialog box requests input from the user. The fact
that the table is closed before the replace action is completed causes
Microsoft Access to close abnormally.
<P>
When Microsoft Access closes abnormally in this way, it does not
relinquish memory or system resources as it should.
<P>
<P><h2>STATUS</h2>
 
<P>
This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 
<P>
WARNING: Make sure to save any open work on your computer before
following these steps. Following these steps will cause Microsoft
Access to quit; any open work will not be saved.

<OL><P><LI>In Program Manager, choose About Program Manager from the Help menu.
   Note the amount of free system resources. Choose OK.

<P><LI>Start Microsoft Access.

<P><LI>Open the sample database NWIND.MDB.

<P><LI>Create the following new macro:
<P>
<P><PRE>      Action
      -------------------------------
      OpenTable
<PRE></PRE>         Table Name : Categories
         View       : Datasheet
         Data Mode  : Edit
      DoMenuItem
         Menu Bar   : Table Datasheet
         Menu Name  : Edit
         Command    : Replace
      Close
         Object Type: Table
         Object Name: Categories

</PRE><P><LI>Run the macro.

<P><LI>In the Replace In Field dialog box, choose Close. Microsoft Access
   will close abnormally.

<P><LI>Press CTRL-ESC to open the Task List. Double-click Microsoft Access.
   Note that you cannot switch to Microsoft Access because it is no
   longer available.

<P><LI>Double-click Program Manager.

<P><LI>From the Help menu, choose About Program Manager. Note that the system
   resources used by Microsoft Access have not been released.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: abnormal termination close<BR>
Keywords            : kbusage McrActn<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
