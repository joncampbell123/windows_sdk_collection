

<HTML>
<HEAD>
<TITLE>ACC: How to Change a Report's Printer Using Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q129397">
<META NAME="KBModify" CONTENT="1997/10/13">
<META NAME="KBCreate" CONTENT="1995/04/25">
<META NAME="Keywords" CONTENT="PtrSetup kbprint">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  You can change the printer for a report or form in two ways:   - You can change the Microsoft Windows Default Printer.   - You can set the PrtDevNames and PrtDevMode propert...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBWN,QDL9,QBWO,QAPN,QAOX,QABA,QAGI,QACT,QAH4,QA1S,QBXS,QAU9,QDN9,QBWQ,QADF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Change a Report's Printer Using Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 13, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q129397</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
You can change the printer for a report or form in two ways:

<UL><LI>You can change the Microsoft Windows Default Printer.

<LI>You can set the PrtDevNames and PrtDevMode properties.
<P>
</UL>This information supplements the Microsoft Access Help Topic about the
PrtDevNames property.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1: Changing the Microsoft Windows Default Printer</h3>
 
<P>
In the Page Setup (or Print Setup in version 2.0) dialog box, you can
choose whether forms or reports are printed by either a default printer or
a specific printer. If you choose a default printer, the form or report
is printed to the Microsoft Windows default printer. If you want to
change to another default printer, you must change the Microsoft Windows
default printer.
<P>
To change the Microsoft Windows default printer using Visual Basic code
(or Access Basic code in version 2.0 or earlier), use WriteProfileString to
change the Device= entry of the Microsoft Windows section of the Win.ini
file.
<P>
<P><h3>Method 2: Setting the PrtDevNames and PrtDevMode properties</h3>
 
<P>
The PrtDevNames property stores the name of the printer, and the PrtDevMode
property stores the driver information. Both of these properties need to be
changed in order to change the printer driver. If the PrtDevMode property
does not match the PrtDevNames property (that is, the PrtDevMode property
describes a different driver than the PrtDevNames property) a General
Protection (GP) Fault may occur.
<P>
To change the printer driver, you must do the following:

<UL><LI>Open a form or report in Design view.

<LI>Set the PrtDevNames property.

<LI>Retrieve and set the PrtDevMode property.
<P>
</UL>In order to set the PrtDevMode property to the appropriate structure, the
driver information must be obtained. There are several ways to obtain this
information:

<UL><LI>Retrieve the information from a previously saved form or report that
   uses the desired printer.

<LI>Call the driver and retrieve the structure. In order to call the driver,
   a separate DLL is needed. This is because calls to functions in outside
   files must be declared ahead of time and the driver name will not be
   known. Instead, call a DLL that determines the correct printer driver
   to call and retrieves the DevMode structure.

<LI>Use the Windows Print Common Dialog.
<P>
</UL><h2>REFERENCES</h2>
 
<P>
For more information about PrtDevMode and PrtDevNames, search for
"PrtDevMode property" or "PrtDevNames property," using the Microsoft Access
97 Help Index or please see the following web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/accessdev/articles/getzch10.htm">http://www.microsoft.com/AccessDev/Articles/GetzCh10.HTM</A></B>

</PRE>For more information about WriteProfileString, the Win.ini, and the Default
Printer in Windows 95, consult the Microsoft Developers Network CD-ROM
(MSDN).
 
<PRE>Keywords          : PtrSetup kbprint
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 13, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
