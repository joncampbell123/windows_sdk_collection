

<HTML>
<HEAD>
<TITLE>ACC97: InputBox Error: "Function Isn't Available in Expressions" </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q164239">
<META NAME="KBModify" CONTENT="1997/07/15">
<META NAME="KBCreate" CONTENT="1997/02/26">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryCrit">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the InputBox() function in a query, you may receive the following error message:     Function isn't available in expressions  When you click More Help in the error m...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAB9,QAY5,QAB4,QA1S,QBV8,QAUD,QAHE,QDN9,QAMB,QA01,QAX6,QAPF,QACF,QA28,QATJ P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: InputBox Error: "Function Isn't Available in Expressions"</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 15, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q164239</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the InputBox() function in a query, you may receive the
following error message:
<P>
<PRE>   Function isn't available in expressions

</PRE>When you click More Help in the error message box, you also receive the
following error
<P>
<PRE>   The topic does not exist. Contact your application vendor for an
   updated Help file. (129)

</PRE><h2>RESOLUTION</h2>
 
<P>
The following four methods enable you to work around this behavior.
<P>
<P><h3>Method 1: Use a Parameter</h3>
 
<P>
You can use a parameter in the query in place of the InputBox() function.
For example, instead of the expression
<P>
<PRE>   InputBox("Enter a Date")

</PRE>use the parameter:
<P>
<PRE>   [Enter a Date]

</PRE>Then on the Query menu, click Parameters and type the parameter again,
along with its associated data type, in the Query Parameters dialog box.
<P>
For more information about parameter queries, search the Help Index for
"parameter queries."
<P>
<P><h3>Method 2: Use the Eval() Function</h3>
 
<P>
You can wrap the InputBox() function inside the Eval() function. Use two
sets of quotation marks (") or one set of apostrophes (') around each of
the text arguments for the InputBox() function. For example, instead of the
expression
<P>
<PRE>   InputBox("Enter a Date","Title",#1/1/95#)

</PRE>use the expression:
<P>
<PRE>   Eval("InputBox(""Enter a Date"",""Title line"",#1/1/95#)")

   -or-

   Eval("InputBox('Enter a Date','Title line',#1/1/95#)")

</PRE><h3>Method 3: Use the Query by Form Technique</h3>
 
<P>
If the information you want to type in the input box can be obtained from a
form, you can use the query by form technique to supply the criteria. For
example, instead of the expression
<P>
<PRE>   InputBox("Enter a Date")

</PRE>use the expression:
<P>
<PRE>   Forms![Form Name]![Control Name]

</PRE>For more information about using the query by form technique, search the
Help Index for "query by form," and see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q95931.htm">Q95931</A></B>
   TITLE     : ACC: How to Use the Query-by-Form (QBF) Technique

</PRE><h3>Method 4: Use the InputBox() Function in a Custom Procedure</h3>
 
<P>
Create a custom procedure that contains the InputBox() function, and
then use the custom procedure in your query. For example, instead of
the expression
<P>
<PRE>   InputBox("Enter a Date","Title",#1/1/95#)

</PRE>use the expression:
<P>
<PRE>   GetDate()

</PRE>where GetDate() is the following custom procedure in a module:
<P>
<PRE>   Function GetDate()
      GetDate = InputBox("Enter a Date","Title",#1/1/95#)
   End Function

</PRE>For more information about creating a custom procedure, please see the
Microsoft Access manual, "Building Applications with Microsoft Access 97,"
Chapter 2, "Introducing Visual Basic," pages 57-81.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database Northwind.mdb.

<P><LI>Create a new query in Design view based on the Orders table:
<P>
<P><PRE>      Query: ListOrders
      -----------------------------------------------------
      Type: Select Query
</PRE><P>
<P><PRE>      Field: OrderID
<PRE></PRE>         Table: Orders
      Field: CustomerID
         Table: Orders
      Field: OrderDate
         Table: Orders
         Criteria: InputBox("Enter a Date","Title",#1/1/95#)

</PRE><P><LI>On the Query menu, click Run. Note that you receive the error message.
   Click More Help in the error message box and note that you receive the
   second error message.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the InputBox() function, search the Help Index
for "InputBox function," or ask the Microsoft Access 97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage QryCrit<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 15, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
