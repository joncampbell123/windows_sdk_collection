

<HTML>
<HEAD>
<TITLE>ACC2: Btrieve File Owner Names, Passwords, and Security </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115917">
<META NAME="KBModify" CONTENT="1997/05/07">
<META NAME="KBCreate" CONTENT="1994/06/07">
<META NAME="Keywords" CONTENT="IsmBtrv kb3rdparty kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Btrieve files have owner names embedded in them. These owner names can be used as passwords, but many applications that use Btrieve use other passwords to control user access.  O...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAN0,QAH5,QAUJ,QBFS,QDN9,QAWK,QAZV,QA5E,QANE,QARM,QAI5,QAB4,QBW7,QAJH V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Btrieve File Owner Names, Passwords, and Security</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 7, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115917</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Btrieve files have owner names embedded in them. These owner names can be
used as passwords, but many applications that use Btrieve use other
passwords to control user access.
<P>
Owner names are frequently set to read-only access. As a result, you can
get the error message "Drive or network error" when you attempt to update
the database file. If the owner name allows read-only access, Microsoft
Access does not prompt you for a password until you attempt to update the
file.
<P>
The DDFPassword line in the [Btrieve ISAM] section of the MSACC20.INI file
can be used to set the owner name of .DDF files, but cannot be used to set
the owner names of other Btrieve files. The owner names of other Btrieve
files can be set programmatically when they are attached to Microsoft
Access.
<P>
Only the user who created the Btrieve files and originally set the owner
name can provide the owner name to you. It may be necessary for you to
contact the original file creator to obtain the owner name, or have the
files' creator provide files that do not have owner names embedded in them.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Btrieve database files contain only data. They do not contain other
database information (unlike Microsoft Access database files, which do
contain other information or objects). Each Btrieve file contains only one
table. You must use a separate application to access the data contained in
a Btrieve database file, and this application must also provide all
security control. When attached to a Microsoft Access database, each
Btrieve file is considered a separate table.
<P>
Applications that use Btrieve files can either use a password to control
entry to the application (possibly including multiple levels of user
privilege), or use file owner names.
<P>
File owner names are both embedded in the database file and hard-coded in
the application using that file. Since an application may draw information
from numerous Btrieve files, and each file can have a unique owner name,
the owner name for each file is generally hard-coded in the application.
When the application opens a Btrieve database file, the Btrieve database
engine compares the database file's embedded owner name with the owner name
sent by the application to determine user privileges.
<P>
There is no connection between an application's password and the embedded
file owner name. You may have an application password that allows you full
file-access privileges. This does not mean that you can directly access the
files without the application, since the owner name hard-coded in the
application is different than your application password.
<P>
Owner names assigned to Btrieve files can have one of four security
options:

<UL><LI>Require an owner name for any access--no data encryption.

<LI>Permit read-only access without an owner name--no data
   encryption.

<LI>Require an owner name for any access--with data encryption.

<LI>Permit read-only access without an owner name--with data
   encryption.
<P>
</UL>If a read-only option is set on the Btrieve database file (with or without
an owner name), Microsoft Access can open the file and display its
contents. However, if you attempt to update the file, you will receive the
error message "Drive or network error."
<P>
<P><h3>Microsoft Access Prompts for Password</h3>
 
<P>
When you are using any of the installable ISAMs (such as Btrieve, Paradox,
or dBASE), if you attempt to open an attached table that is password
protected, Microsoft Access will prompt you for a password after the open
attempt fails.
<P>
In Btrieve, if you set the owner name option to read-only access, the open
does not fail and Microsoft Access does not prompt you for a password. No
error or warning occurs until you attempt to update the file.
<P>
<P><h3>How to Specify an Owner Name</h3>
 
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Building Applications" manual.
<P>
You can specify an owner name for the .DDF files using the DDFPassword line
in the [Btrieve ISAM] section of the MSACC20.INI file. However, this is of
little benefit since it only sets the password for the .DDF files, not for
the Btrieve database file.
<P>
You can use Access Basic to attach the Btrieve database file and specify
the owner name so that full read-write privileges are available. Once you
attach the table, it is not necessary to specify the owner name again.
<P>
The following sample Access Basic code demonstrates how to attach a Btrieve
file called MYFILE and specify the file owner name as a Microsoft Access
password:
<P>
<PRE>   Sub TablePwd ()
      Dim MyDB As Database, MyTD As TableDef
      Set MyDB = DBEngine.Workspaces(0).Databases(0)
      Set MyTD = MyDB.CreateTableDef("MYFILE")
      MyTD.connect = "btrieve;PWD=OwnrNm;Database=C:\MYDIR\FILE.DDF"
      MyTD.sourcetablename = "MYFILE"
      MyDB.tabledefs.Append MyTD
   End Sub

</PRE>Note that this example uses the FILE.DDF file located in the C:\MYDIR
directory to search for a Btrieve table named MYFILE, and then attempts to
attach the file to the current database using the password "OwnrNm."
<P>
The products discussed here are manufactured by vendors independent of
Microsoft; we make no warranty, implied or otherwise, regarding these
products' performance or reliability.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: attaching odbc vbwin<BR>
Keywords            : IsmBtrv kb3rdparty kberrmsg<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 7, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
