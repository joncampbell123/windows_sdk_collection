

<HTML>
<HEAD>
<TITLE>ACC: Create and Drop Tables and Relationships Using SQL DDL </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q116145">
<META NAME="KBModify" CONTENT="1997/04/02">
<META NAME="KBCreate" CONTENT="1994/06/13">
<META NAME="Keywords" CONTENT="kbusage QrySqldd">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  Microsoft Access includes a Data Definition Language (DDL) that you can use to create and delete (drop) tables and relationships. These same operations can also be performed with...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBWS,QA9N,QAPN,QACF,QDKS,QAYY,QDN9,QAMA,QAEF,QATX,QACI,QAB9,QA5F,QAP2 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Create and Drop Tables and Relationships Using SQL DDL</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 2, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q116145</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
Microsoft Access includes a Data Definition Language (DDL) that you can
use to create and delete (drop) tables and relationships. These same
operations can also be performed with Visual Basic for Applications (or
Access Basic in 2.0) using data access objects (DAO). This article
describes some of the operations available in DDL.
<P>
NOTE: All the examples in this article assume that the statements are
added to a Microsoft Access query and are run by clicking Run on the
Query menu.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use data definition statements, create a new query. Then click SQL
Specific, and then Data Definition on the Query menu. Enter your data
definition statement in the Data Definition Query window, then run the
query by clicking Run on the Query menu.
<P>
To create a table with a PrimaryKey field with an AutoNumber data type (or
Counter data type in version 2.0), and a field called MyText with a Text
data type and a length of 10, enter the following statement in the Data
Definition Query window and then run the query.
<P>
NOTE: In the following sample queries, an underscore (_) at the end of a
line is used as a line-continuation character. Remove the underscore from
the end of the line when re-creating these queries.
<P>
<PRE>   CREATE TABLE Table1 (Id COUNTER CONSTRAINT PrimaryKey PRIMARY KEY, _
   MyText TEXT (10))

</PRE>The Foreign Key side of a relationship does not require a PrimaryKey and
can be created by running the following query. This query creates a table
with one field with a Long data type and another field with a Text data
type with a default size of 255:
<P>
<PRE>   CREATE TABLE Table2 (Id LONG, MyText TEXT)

</PRE>After creating both tables, running the following query creates a one-
to-many relationship between Table1 and Table2, with Table1 as the primary
side of the relationship:
<P>
<PRE>   ALTER TABLE Table2 ADD CONSTRAINT Relation1 FOREIGN KEY ([Id]) _
   REFERENCES Table1 ([Id])

</PRE>To delete the relationship between the tables, run the following query:
<P>
<PRE>   ALTER TABLE Table2 DROP CONSTRAINT Relation1

</PRE>To delete Table1, run the following query:
<P>
<PRE>   DROP TABLE Table1

</PRE>To delete Table2, run the following query:
<P>
<PRE>   DROP TABLE Table2

</PRE>You can also run DDL statements using the RunSQL action. To run a DDL
statement in code, use a procedure similar to the following example:
<P>
<PRE>   Sub ExecuteSQLDDL (SQLString As String)
      Dim db As Database, qd As QueryDef
      Set db = DBEngine.Workspaces(0).Databases(0)
      Set qd = db.CreateQueryDef("")
      qd.SQL = SQLString
      qd.Execute
      db.Close
   End Sub

</PRE>To call this Sub procedure, use the following syntax:
<P>
<PRE>   ExecuteSQLDDL "DROP TABLE Table1"

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about DDL queries, search the Help Index for "data-
definition queries," or ask the Microsoft Access 97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QrySqldd<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 2, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
