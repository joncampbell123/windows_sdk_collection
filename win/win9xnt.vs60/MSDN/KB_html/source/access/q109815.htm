

<HTML>
<HEAD>
<TITLE>ACC1x: Queries Sent to Remote SQL Server Run Slowly </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q109815">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1994/01/10">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  A query sent to a remote SQL Server from Microsoft Access seems to run very slowly compared to other methods of querying SQL data.  CAUSE =====  This behavior can be due to either of the following causes:   - A parameter used in the query is not ex...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAY5,QABM,QACF,QAHE,QBV8,QAB9,QABI,QBVV,QA5F,QAPF,QANN,QAMA,QAH6 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Queries Sent to Remote SQL Server Run Slowly</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q109815</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
A query sent to a remote SQL Server from Microsoft Access seems to run very
slowly compared to other methods of querying SQL data.
<P>
<P><h2>CAUSE</h2>
 
<P>
This behavior can be due to either of the following causes:

<UL><LI>A parameter used in the query is not explicitly defined, causing
   Microsoft Access to send the entire query to SQL Server.
<P>
   Microsoft Access automatically takes care of all implicit data type
   conversions internally, whether you are running a query against native
   Microsoft Access tables or attached tables. However, you will find that
   your remote queries run much slower than you expect when you force
   Microsoft Access to interpret query parameter data types, because it
   cannot be certain what implicit type conversions the remote server
   provides. As a result, Microsoft Access will not send the entire query
   to the remote server, but instead will locally process the parts of the
   query having parameters, resulting in slower than expected query
   performance.

<LI>You are referencing a function or command that is unknown to SQL in your
   query criteria.
<P>
   Because SQL Server does not know how to process user-defined Access
   Basic functions and some built-in Access Basic commands and functions,
   it cannot evaluate them. As a result, Microsoft Access must locally
   evaluate them, which can hinder query speed. This applies to all
   functions not known by SQL, such as the Access Basic IIf() function.
<P>
   Note that this behavior applies only when a function unknown to SQL is
   used in your query criteria. It does not apply when such a function is
   used in the query's output, except for aggregates such as StDev() that
   have no SQL equivalent.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
Make sure to explicitly define all the query parameters before running the
query, so that Microsoft Access can send the entire query to the server.
<P>
To explicitly define parameters, choose Parameters from the Query menu, and
then enter the names and data types of all the parameters used in the
query. The "Employee Sales by Country (Parameter)" query in the sample
database NWIND.MDB demonstrates this method.
<P>
Also make sure to use only functions and commands known to SQL in your
query criteria or, if possible, provide additional query restrictions to
send to the server. This limits the amount of data returned to Microsoft
Access for local user-defined function evaluation. For example, the
following query will return all records that are not null:
<P>
<PRE>   Like MyFunction(Forms]![Formname]![Fieldname],*)

</PRE>Since the sample query above contains MyFunction(), a function unknown to
SQL, the query has to be performed locally. Instead, you can get the same
results by using the following query, which uses only functions known to
SQL:
<P>
<PRE>   Like [Fieldname] or [Fieldname] Is Null

</PRE>Note that "Forms!Formname!Fieldname" is effectively a query parameter, and
should be explicitly declared. It can be declared as:
<P>
<PRE>   Name=Forms!Formname!Fieldname, Type=&lt;yourtype&gt;

</PRE><h2>STATUS</h2>
 
<P>
This behavior no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Access "User's Guide," pages 182-185
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: Queries<BR>
Keywords            : kbusage OdbcOthr<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
