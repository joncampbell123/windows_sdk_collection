

<HTML>
<HEAD>
<TITLE>ACC: How to Check for Duplicate Values in Primary Key Fields </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q102527">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1993/08/03">
<META NAME="Keywords" CONTENT="FmsOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you are adding records, Microsoft Access does not normally check the values in primary key fields for duplicates until you move to the next record. If you enter an invalid o...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABI,QAFO,QA1S,QABH,QAKD,QDN9,QA7O,QA7N,QAH4,QA5V,QAMA,QAPN,QAPF,QA63,QBT6 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Check for Duplicate Values in Primary Key Fields</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q102527</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you are adding records, Microsoft Access does not normally check the
values in primary key fields for duplicates until you move to the next
record. If you enter an invalid or duplicate value in a control and move
to the next record, you may invalidate all previous entries. However,
there is a method to force an immediate check for duplicate values. This
article describes how to check for duplicate values immediately.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example uses the Customers form in the sample database
Northwind.mdb in Microsoft Access 7.0 and 97 (NWIND.MDB in Microsoft
Access 2.0 or earlier). The Customers form is based on the Customers
table; CustomerID is the primary key in the table.
<P>
NOTE: Microsoft Access 97 has an example of the following in the sample
database Northwind.mdb. On the Customers form there is a macro on the
BeforeUpdate event of the CustomerId field that verifies that the
CustomerId is unique.
<P>
To force an immediate check for duplicate values, follow these steps:
<P>
NOTE: CustomerID is called Customer ID in Microsoft Access 2.0 or
earlier.

<OL><P><LI>Create the following new macro. Make sure to select Conditions
   on the View menu before you begin entering this macro.
<P>
   NOTE: In the following sample macro, an underscore (_) is used as a
   line-continuation character. Remove the underscore when re-creating
   this macro.
<P>
<PRE>      MacroName   Condition                                Action
      ----------------------------------------------------------------
      IsItDup     DCount("[CustomerId]","Customers", _     MsgBox
                  "[CustomerId]=Forms![Customers]! _
                   [CustomerId]")&lt;&gt;0
                  ...                                      CancelEvent

      IsItDup Actions
      ---------------------------------
      MsgBox
         Message: Duplicate Customer ID
      CancelEvent


</PRE><P><LI>Open the Customers form in Design view. Change the BeforeUpdate
   property of the CustomerID field as follows:
<P>
<P><PRE>      Text Box: CustomerID
<PRE></PRE>         BeforeUpdate: IsItDup

</PRE></OL>After you make this change, adding a duplicate value in the CustomerID
field results in an error message. The insertion point remains in the
field so that you can change the value.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: count before update fasttips<BR>
Keywords            : FmsOthr kbusage<BR>
Version             : 1.0 1.1 2.0 7.00 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
