

<HTML>
<HEAD>
<TITLE>ACC: How to Create Running Totals in a Query (95/97) </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138911">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1995/10/30">
<META NAME="Keywords" CONTENT="kbusage QryTotal">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article demonstrates two methods that you can use to create a running totals query; that is, the total for each record is a summation of that record and any previous re...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAWH,QADP,QA7O,QA7N,QA5V,QAGF,QAE5,QBWS,QAPF,QACF,QAB9,QANX,QAB6,QABO,QA1S P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create Running Totals in a Query (95/97)</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138911</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article demonstrates two methods that you can use to create a running
totals query; that is, the total for each record is a summation of that
record and any previous records. This type of query is useful for
displaying cumulative totals over a group of records (or over a period of
time) in a graph or report.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Method 1</h3>
 
<P>
The first method uses a DSum() function and criteria in a query to create a
running sum over time. The DSum() function sums the current record and any
previous records. When the query moves to the next record, the DSum()
function runs again and updates the cumulative total.
<P>
The following sample query uses the Orders table from the sample database
Northwind.mdb to create a running sum of the freight costs for each month
in 1994. The sample data is limited to one year for performance reasons.
Because the DSum() function runs once for every record in the query, it may
take several seconds (depending on the speed of your computer) for the
query to finish processing. To create and run this query, follow these
steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new select query and add the Orders table.

<P><LI>On the View menu, click Totals.

<P><LI>In first column of the query design grid, type the following expression
   in the Field box, and make the following selections for the Total, Sort,
   and Show boxes:
<P>
<P><PRE>      Field: AYear: DatePart("yyyy",[OrderDate])
<PRE></PRE>         Total: Group By
         Sort: Ascending
         Show: Yes

   The expression in the Field box displays and sorts the year portion of
   the OrderDate field.

</PRE><P><LI>In the second column of the query design grid, type the following
   expression in the Field box, and make the following selections for the
   Total, Sort, and Show boxes:
<P>
<P><PRE>      Field: AMonth: DatePart("m",[OrderDate])
<PRE></PRE>         Total: Group By
         Sort: Ascending
         Show: Yes

   The expression in the Field box sorts and displays the month portion
   of the Order Date field as an integer value from 1 to 12.

</PRE><P><LI>In the third column of the query design grid, type the following
   expression in the Field box, and make the following selections for the
   Total and Show boxes.
<P>
   NOTE: In the following example, an underscore (_) at the end of a line
   is used as a line-continuation character. Remove the underscore from the
   end of the line when re-creating this example.
<P>
<P><PRE>     Field: RunTot: DSum("Freight","Orders","DatePart('m', _
<PRE></PRE>        [OrderDate])&lt;=" &amp; [AMonth] &amp; " And  DatePart('yyyy', _
        [OrderDate])&lt;=" &amp; [AYear] &amp; "")
        Total: Expression
        Show: Yes

   The expression in the Field box uses the DSum() function to sum the
   Freight field when the values in both the AMonth and the AYear fields
   are less than or equal to the current record that the query is
   processing.

</PRE><P><LI>In the fourth column of the query design grid, type the following
   expression in the Field box, and make the following selections for the
   Total, Sort, and Show boxes:
<P>
<P><PRE>      Field: FDate: Format([OrderDate],"mmm")
<PRE></PRE>         Total: Group By
         Sort: Ascending
         Show: Yes

   The expression in the Field box displays each month in a textual format,
   such a Jan, Feb, Mar, and so on.

</PRE><P><LI>In the fifth column of the query design grid, type the following
   expression in the Field box, and make the following selections for the
   Total, Criteria, and Show boxes:
<P>
<P><PRE>      Field: DatePart("yyyy",[OrderDate])
<PRE></PRE>         Total: Where
         Criteria: 1994
         Show: No

   The expression in the Field box filters the query's recordset to include
   only data from 1994.

</PRE><P><LI>Run the query.
<P>
</OL>In Microsoft Access 97, note that the RunTot field displays the following
records with a running sum:
<P>
<PRE>     Ayear     Amonth     RunTot     Fdate
     -------------------------------------
     1994      8           1288.18   Aug
     1994      9           2685.35   Sep
     1994      10          3808.83   Oct
     1994      11          5219.05   Nov
     1994      12          7481.28   Dec

</PRE></OL>In Microsoft Access version 7.0, note that the RunTot field displays the
following records with a running sum:
<P>
<PRE>     Ayear     Amonth     RunTot     Fdate
     -------------------------------------
     1994      1          1936.65    Jan
     1994      2          3452.52    Feb
     1994      3          5479.33    Mar
     1994      4          8607.74    Apr
     1994      5          12094.67   May
     1994      6          13859.39   Jun
     1994      7          17729      Jul
     1994      8          21992.58   Aug
     1994      9          27477.79   Sep
     1994      10         31767.05   Oct
     1994      11         36681.15   Nov
     1994      12         42894.37   Dec

</PRE><h3>Method 2</h3>
 
<P>
The second method uses a totals query with a DSum() function to create a
running total over a group.
<P>
The following sample query uses the Orders table to sum freight costs per
employee as well as to calculate a running sum of the freight. To create
and run the query, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a new select query and add the Orders table.

<P><LI>On the View menu, click Totals.

<P><LI>In the first column of the query design grid, add the following field to
   the Field box, and make the following selections for the Total and Show
   boxes:
<P>
<P><PRE>      Field: EmpAlias: EmployeeID
<PRE></PRE>         Total: Group By
         Show: Yes

   This field groups data by EmployeeID.

</PRE><P><LI>In the second column of the query design grid, add the following field
   to the Field box, and make the following selections for the Total and
   Show boxes:
<P>
<P><PRE>      Field: Freight
<PRE></PRE>         Total: Sum
         Show: Yes

   This field sums the freight data.

</PRE><P><LI>In the third column of the query design grid, type the following
   expression in the Field box, and make the following selections for the
   Total and Show boxes.
<P>
   NOTE: In the following example, an underscore (_) at the end of a line
   is used as a line-continuation character. Remove the underscore from the
   end of the line when re-creating this example.
<P>
<P><PRE>      Field: RunTot: Format(DSum("Freight","Orders","[EmployeeID]&lt;=" _
<PRE></PRE>         &amp; [EmpAlias] &amp; ""),"$0,000.00")
         Total: Expression
         Show: Yes

   The expression in the Field box uses a DSum() function to sum the
   Freight field when the EmployeeID is less than or equal to the current
   EmpAlias, and then formats the field in dollars.

</PRE><P><LI>Run the query. Note that the RunTot field displays the following records
   with a running sum:
<P>
<PRE>     Employee            SumOfFreight   RunTot
     ---------------------------------------------
     Davolio, Nancy      $8,836.64      $8,836.64
     Fuller, Andrew      $8,696.41      $17,533.05
     Leverling,Janet     $10,884.74     $28,417.79
     Peacock, Margaret   $11,346.14     $39,763.93
     Buchanan, Steven    $3,918.71      $43,682.64
     Suyama, Michael     $3,780.47      $47,463.11
     King, Robert        $6,665.44      $54,128.55
     Callahan, Laura     $7,487.88      $61,616.43
     Dodsworth, Anne     $3,326.26      $64,942.69

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about totals queries, search the Help Index for
"queries, calculations," and then "Perform Calculations in a Query" or ask
the Microsoft Access 97 Office Assistant.
<P>
For more information about creating a running totals query, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q132134.htm">Q132134</A></B>
   TITLE     : ACC2: How to Create Running Totals in a Query
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage QryTotal<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
