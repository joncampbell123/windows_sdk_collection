

<HTML>
<HEAD>
<TITLE>ACC1x: Opening Objects in Transactions Can Cause Rollback </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q96906 ">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1993/03/30">
<META NAME="Keywords" CONTENT="JetTrans kberrmsg kbprg MdlTran PgmObj">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The following error message is displayed while attempting to open a second occurrence of a database object (such as a table, dynaset, or form) in a transaction:     Invalid database object  CAUSE =====  This error message results from a new occurre...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAW6,QA1S,QAZV,QAB4,QAGB,QDN9,QAO4,QAAW,QBWS,QAKP,QDLB,QAL3,QAFF,QBXJ V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Opening Objects in Transactions Can Cause Rollback</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q96906 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The following error message is displayed while attempting to open a
second occurrence of a database object (such as a table, dynaset, or
form) in a transaction:
<P>
<PRE>   Invalid database object

</PRE><h2>CAUSE</h2>
 
<P>
This error message results from a new occurrence of a database object
overwriting a previous occurrence of a database object, which
"orphans" the first object (that is, the first object's pointer to the
database is destroyed).
<P>
When Microsoft Access detects that an object is orphaned, it attempts
to close it. Because the object is in a transaction, however, the
close fails, and therefore Microsoft Access rolls back all levels of
nested transactions so that the close succeeds.
<P>
This implicit rollback causes all objects opened in transactions to be
closed. As a result, any reference to an object closed by this process
results in the "Invalid database object" error message.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
This problem occurs only when objects are implicitly closed (by the
process mentioned above), and does not occur when the object is
explicitly closed in a transaction.
<P>
Thus, the keys to avoiding this problem are:

<UL><LI>Always open objects outside of transactions.

<LI>Always explicitly close objects.
<P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
1.0 and 1.1. This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
Create and run the following procedures:
<P>
<PRE>   Sub Sub1()
     Dim db As Database, tb As Table

     Set db = CurrentDB()
     BeginTrans
        Set tb = db.OpenTable("table1") 'Table opened in transaction
        Call Sub2
        Debug.Print tb.recordcount   'Result: "! Invalid database
                                     'object."
        tb.Close
     CommitTrans
     db.Close
   End Sub

   Sub Sub2()
     Dim d as Database
     Set d = CurrentDB()
   End Sub  'd loses scope, does implicit rollback and close of db.
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: AB ABC Engine<BR>
Keywords            : JetTrans kberrmsg kbprg MdlTran PgmObj<BR>
Version             : 1.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
