

<HTML>
<HEAD>
<TITLE>ACC97: "Can't Represent the Join Expression" in Query Design </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161861">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1997/01/07">
<META NAME="Keywords" CONTENT="kberrmsg kbusage QryJoin WzOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  After you create a query with the Simple Query Wizard in Microsoft Access 97, you may receive the following error message if you try to open the query in Design view:     Microso...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QBWS,QBJZ,QA1S,QACF,QADK,QDN9,QAUJ,QDIZ,QA2Q,QAMN,QAHT,QAYY,QAX3 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: "Can't Represent the Join Expression" in Query Design</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161861</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
After you create a query with the Simple Query Wizard in Microsoft Access
97, you may receive the following error message if you try to open the
query in Design view:
<P>
<PRE>   Microsoft Access can't represent the join expression
   ([&lt;TableName&gt;].[&lt;FieldName&gt;] = [&lt;TableName&gt;].[&lt;FieldName&gt;])AND
   ([&lt;TableName&gt;].[&lt;FieldName&gt;] = [&lt;TableName&gt;].[&lt;FieldName&gt;]) in Design
   view.

</PRE><h2>CAUSE</h2>
 
<P>
The Simple Query Wizard adds an extra set of parentheses in the join
expression of the SQL Statement that it creates for the query.
<P>
The error occurs if your query meets both of the following conditions:

<UL><LI>If your query is based on two or more tables.

<LI>If two of the tables contain a relationship or join based on a
   three-field primary key.
<P>
</UL><h2>RESOLUTION</h2>
 
<P>
There are two methods you can use to work around this problem:

<UL><LI>You can create the query in Design view without using the Simple Query
   Wizard.

<LI>You can modify the query's SQL Statement to remove the extra
   parentheses. Open the query in Datasheet view, and then click SQL View
   on the View menu to see the SQL statement. This is an example of a
   portion of the join expression with the extra parentheses:
<P>
<P><PRE>      ON ([tblOne].[Key3] =[tblTwo].[Key3]) AND (([tblOne].[Key1]
      =[tblTwo].[Key1]) AND ([tblOne].[Key2] =[tblTwo].[Key2]));
</PRE><P>
   This is how the expression looks with the extra parentheses removed:
<P>
<P><PRE>      ON ([tblOne].[Key3] =[tblTwo].[Key3]) AND ([tblOne].[Key1]
      =[tblTwo].[Key1]) AND ([tblOne].[Key2] =[tblTwo].[Key2]);
</PRE><P>
</UL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
<P><h3>Creating the Tables</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create the following new table in Design view:
<P>
<P><PRE>      Table: tblOne
      --------------------
      Field Name: Key1
<PRE></PRE>         Data Type: Text
      Field Name: Key2
         Data Type: Text
      Field Name: Key3
         Data Type: Text
      Field Name: Field1
         Data Type: Number

</PRE><P><LI>With the table open in Design view, select fields Key1, Key2, and Key3
   by holding down the SHIFT key while you click the row selector button to
   the left of each field name, and then release the SHIFT key.

<P><LI>On the Edit menu, click Primary Key.

<P><LI>Save the tblOne table and close it.

<P><LI>Create a second new table in Design view:
<P>
<P><PRE>      Table: tblTwo
      ------------------------
      Field Name: ID
<PRE></PRE>         Data Type: AutoNumber
      Field Name: Key1
         Data Type: Text
      Field Name: Key2
         Data Type: Text
      Field Name: Key3
         Data Type: Text
      Field Name: Field2
         Data Type Text

</PRE><P><LI>Save the tblTwo table and close it. You do not need to create a primary
   key.
<P>
</OL><h3>Creating the Relationships</h3>
 

<OL><P><LI>On the Tools menu, click Relationships.

<P><LI>When the Relationships window opens, click Show Table on the
   Relationships menu.

<P><LI>In the Show Table dialog box, double-click tblOne and then tblTwo. Click
   Close.

<P><LI>In the Relationships window, select fields Key1, Key2, and Key3 in
   tblOne by holding down the SHIFT key while you click all three fields,
   and then release the SHIFT key.

<P><LI>Drag the selected fields Key1, Key2, and Key3 from the tblOne table,
   which invokes the Relationships dialog box.

<P><LI>Add fields Key1, Key2, and Key3 from the tblTwo table in the Related
   Table/Query column, so the Relationships dialog box looks like this:
<P>
<PRE>      Table/Query: tblOne   Related Table/Query: tblTwo
      -------------------------------------------------
      Key1                  Key1
      Key2                  Key2
      Key3                  Key3

</PRE><P><LI>Click Create.

<P><LI>Close the Relationships window and save the changes.
<P>
</OL><h3>Creating the Query</h3>
 

<OL><P><LI>Click the Query tab in the Database window, and then click New.

<P><LI>In the New Query dialog box, select Simple Query Wizard, and then click
   OK.

<P><LI>In the "Which fields do you want in your query?" dialog box, select
   tblOne in the Tables/Queries box. Then, add Field1 to the Selected
   Fields box.

<P><LI>Still in the "Which fields do you want in your query?" dialog box,
   select tblTwo in the Tables/Queries box. Then, add all of the fields
   from that table to the Selected Fields box.

<P><LI>Click Finish. The Simple Query Wizard constructs the query, and displays
   the results in Datasheet view. No records are displayed because there is
   no data in the tables.

<P><LI>On the View menu, click Design View. Note that the error message
   appears.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the Simple Query Wizard, search the Help Index
for "Simple Query Wizard," or ask the Microsoft Access 97 Office Assistant.
<P>
For more information about creating relationships between tables, search
the Help Index for "relationships, overview," or ask the Microsoft Access
97 Office Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kberrmsg kbusage QryJoin WzOthr<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
