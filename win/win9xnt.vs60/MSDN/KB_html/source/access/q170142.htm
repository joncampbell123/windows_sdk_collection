

<HTML>
<HEAD>
<TITLE>ACC: Issues When Using the BuildCriteria Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q170142">
<META NAME="KBModify" CONTENT="1997/06/16">
<META NAME="KBCreate" CONTENT="1997/06/16">
<META NAME="Keywords" CONTENT="ExrStrg kbprg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills  In certain situations, the BuildCriteria method does not work as expected or returns values that cannot be used by other methods or SQL statements.  This article addresses the fol...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QATX,QA50,QAHE,QAPF,QAB4,QAB9,QA1S,QBE7,QBE6,QALY,QBVV,QA7O,QAUD,QAAP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Issues When Using the BuildCriteria Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 16, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q170142</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 70, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills
<P>
In certain situations, the BuildCriteria method does not work as expected
or returns values that cannot be used by other methods or SQL statements.
<P>
This article addresses the following topics:

<UL><LI>Searching for a string containing a quotation mark (")
<LI>Searching for a string containing a dot (.)
<LI>Using spaces in the Field argument
<P>
</UL><h2>MORE INFORMATION</h2>
 
<P>
The BuildCriteria method returns a parsed criteria string as it would
appear in the query design grid or in Filter By Form mode. For example, you
may want to set a form's Filter property based on varying criteria from the
user. You can use the BuildCriteria method to construct the string
expression argument for the Filter property. For example,
<P>
<PRE>   strCriteria = BuildCriteria("OrderDate", dbText, "abc")

</PRE>will set strCriteria to
<P>
<PRE>   OrderDate = "abc"

</PRE><h3>Searching for a String Containing a Quotation Mark</h3>
 
<P>
Searching for a text string containing a quotation mark (") requires
special syntax. If you are parsing an expression that contains a quotation
mark, you must use Chr(34) twice to represent that quotation mark.  For
example, if you want to search for the string
<P>
<PRE>   a"bc

</PRE>using the Find method, parse the expression using the BuildCriteria method
as follows:
<P>
<PRE>   strCriteria = BuildCriteria("MyText", dbText, "a" &amp; Chr(34) &amp; Chr(34) &amp;
   "bc")

</PRE>The value of strCriteria becomes:
<P>
<PRE>   MyText = "a""bc"

</PRE>You can also use four quotation marks to search for a string containing a
single quotation mark. For example,
<P>
<PRE>   strCriteria = BuildCriteria("MyText", dbText, "a""""bc")

</PRE>will also set strCriteria to:
<P>
<PRE>   MyText = "a""bc"

</PRE>NOTE: You can refer to a form control in the expression argument (the third
argument) of the BuildCriteria method. For example:
<P>
<PRE>   strCriteria = BuildCriteria("MyText", dbText, Forms!Form1!Text0)

</PRE>However, when you enter the string into the control on the form, you may
want to enclose that string in apostrophes. If this is not possible,
consider searching for quotation marks in the string and then make the
appropriate modifications to the string before passing it to the
BuildCriteria method.
<P>
<P><h3>Searching for Strings Containing Dots (.)</h3>
 
<P>
When setting the expression argument (the third argument) of the
BuildCriteria method in code, use the following syntax to delimit the
string:
<P>
<PRE>   strCriteria = BuildCriteria("x", dbText, """Access 2.0""")

</PRE>The value of strCriteria becomes:
<P>
<PRE>   x = "Access 2.0"

</PRE>If the string is not properly delimited and the character to the right of
the period is numeric, you receive the following error message:
<P>
<PRE>   Run-time error '2423':
   The expression you entered has an invalid .(dot) or ! operator or
   invalid parentheses.

</PRE>If the character to the right of the dot is a letter, the expression
argument of the BuildCriteria function will not be interpreted correctly.
For example,
<P>
<PRE>   strCriteria = BuildCriteria("x", dbText, "a.a")

</PRE>will set strCriteria to
<P>
<PRE>   x = [a].[a]

</PRE>An error will not be generated if the dot is either the first or the last
character in the string; however enclosing the expression argument in three
pairs of quotation marks will work, regardless of the position of the dot
in the string.
<P>
NOTE: You can refer to a form control in the expression argument of the
BuildCriteria method. For example:
<P>
<PRE>   strCriteria = BuildCriteria("MyText", dbText, Forms!Form1!Text0)

</PRE>However, when you enter the string into the control on the form, you may
want to enclose that string in apostrophes. If this is not possible,
consider searching for the dot in the string and then make the appropriate
modifications to the string before passing it to the BuildCriteria method.
<P>
<P><h3>Using Spaces in the Field Argument</h3>
 
<P>
If the field argument (the first argument) of the BuildCriteria method
contains one or more spaces, enclose the argument in square brackets.  For
example:
<P>
<PRE>   strCriteria = BuildCriteria("[a b]", dbText, "x")

</PRE>The value of strCriteria becomes:
<P>
<PRE>   [a b] = "x"

</PRE>If you do not use square brackets, a trappable error occurs when you use
the result with other methods or with Access SQL. For example,
<P>
<PRE>   strCriteria = BuildCriteria("a b", dbText, "x")

</PRE>will set strCriteria to
<P>
<PRE>   a b = "x"

</PRE>If you attempt to use strCriteria with another method or property, you may
receive the following error:
<P>
<PRE>   Run-time error '3075':
   Syntax error (missing operator) in query expression &lt;expression&gt;.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using quotation marks in strings, search the
Help Index for "quotation marks in expressions," and then select "Quotation
Marks in Strings."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: period periods<BR>
Keywords            : ExrStrg kbprg<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 16, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
