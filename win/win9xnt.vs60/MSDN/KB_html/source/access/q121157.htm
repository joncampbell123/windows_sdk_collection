

<HTML>
<HEAD>
<TITLE>ACC: How to Start Doc with Windows API ShellExecute() Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q121157">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1994/09/27">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  You can use the Windows application programming interface (API) ShellExecute() function to start the application associated with a given document extension without knowing t...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAIJ,QAY5,QDL9,QBWO,QBWN,QBV8,QAB9,QBWQ,QDIV,QAJH,QAH4,QA1S,QAH7,QAH6,QAD7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Start Doc with Windows API ShellExecute() Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q121157</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
You can use the Windows application programming interface (API)
ShellExecute() function to start the application associated with a given
document extension without knowing the name of the associated application.
For example, you can start the Microsoft Paintbrush program by passing the
file name ARCADE.BMP to the ShellExecute() function.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to start an application or load a
document into its associated application. The Windows API ShellExecute()
function is different from the Access Basic Shell() function in that you
can pass the ShellExecute() function the name of a document and it will
start the associated application and then pass the filename to the
application. You can also specify the working directory for the
application.
<P>
NOTE: In the following sample code, an underscore (_) at the end of a line
is used as a line-continuation character. Remove the underscore from the
end of the line when re-creating this code in Access Basic.

<OL><P><LI>Create a new module, and then enter the following lines in the
   module's Declarations section:
<P>
<P><PRE>      Option Explicit
      Declare Function ShellExecute Lib "SHELL" (ByVal hwnd%, ByVal _
      lpszOp$, ByVal lpszFile$, ByVal lpszParams$, ByVal lpszDir$, _
      ByVal fsShowCmd%) As Integer
      Declare Function GetDesktopWindow Lib "USER" () As Integer
</PRE>
<P><LI>Create the following procedure in the module:
<P>
<P><PRE>      Function StartDoc (DocName As String)
<PRE></PRE>         StartDoc = ShellExecute(GetDesktopWindow(), "Open", DocName, _
          "", "C:\", 1)
      End Function

</PRE><P><LI>From the View menu, choose Immediate Window.

<P><LI>In the Immediate window, type the following line and then press ENTER:
<P>
<P><PRE>      ? StartDoc("ARCADE.BMP")
</PRE><P>
   Note that the function starts the Paintbrush program, which will then
   load the ARCADE.BMP file.
<P>
</OL><h3>NOTES</h3>
 

<UL><LI>The return value for the StartDoc() function is the same as for the
   Shell() function. It is the Windows instance value of the application
   that was started.

<LI>The ShellExecute() function returns the value 31 if there is no
   association for the specified file type or if there is no association
   for the specified action within the file type. Other error values are:
<P>
<PRE>      Error Value   Meaning
      ----------------------------------------------------------------
           2        The file was not found.
           3        The path was not found.
           8        There was insufficient memory to start the
                    application.
          10        The Windows version was incorrect.
          11        The executable file was invalid. Either it was not
                    a Windows application or there was an error in the
                    .EXE image.

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For an example of how to use the Windows application programming interface
(API) ShellExecute() function to start the application associated with a
given document extension without knowing the name of the associated
application in Microsoft Access for Windows 95 version 7.0, please see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q148632.htm">Q148632</A></B>
   TITLE:      ACC: Start Files or Hyperlinks with Windows API
               ShellExecute()

</PRE></UL>Microsoft Windows SDK "Programmer's Reference, Volume 2: Functions,"
pages 901-904
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg PgmApi<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
