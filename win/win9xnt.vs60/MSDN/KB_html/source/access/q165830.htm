

<HTML>
<HEAD>
<TITLE>ACC97: Problems Adding Records to Replicated Database Using ASP </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165830">
<META NAME="KBModify" CONTENT="1997/05/23">
<META NAME="KBCreate" CONTENT="1997/03/25">
<META NAME="Keywords" CONTENT="GnlOthr IntAsp RplGen">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  If you export to ASP format a form based on a table in a replicated database, you cannot add new records using the ASP form.  If you look at an ODBC trace file, you see the error...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QDNQ,QA7O,QA7N,QA5V,QAPN,QAFO,QBM2,QA2O,QABA,QA9E,QA3P,QABM,QAE1 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Problems Adding Records to Replicated Database Using ASP</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165830</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
If you export to ASP format a form based on a table in a replicated
database, you cannot add new records using the ASP form.
<P>
If you look at an ODBC trace file, you see the error message:
<P>
<PRE>   [Microsoft][ODBC Microsoft Access 97 Driver]
   You cannot modify the replication system object 's_Lineage'

</PRE><h2>CAUSE</h2>
 
<P>
The Microsoft Access 97 ODBC driver attempts to set values for the
replication system columns, s_Generation, s_GUID and s_Lineage; Microsoft
Access also adds one replication system column for each OLE Object field in
your table. Microsoft Access does not allow you to set the values in those
fields, so inserting the record fails.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Instead of using a table name in the RecordSource property of the form you
are exporting to ASP format, set the RecordSource to the name of a Select
query that contains all the fields in your table except the replication
system columns.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97. We
are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
When you export a form to ASP format, the ASP file contains a SQL select
statement that selects all the fields in the table. For example, if you
base a form on the Shippers table, the SQL statement in the ASP file is:
<P>
<PRE>   SELECT * from Shippers

</PRE>This SQL statement selects all fields in the table, including the
replication system columns.
<P>
When you base your form on a query that contains only the fields you want
to update, the SQL statement in the ASP file names each field individually.
For example:
<P>
<PRE>   SELECT Shippers.ShipperID, Shippers.CompanyName, Shippers.Phone FROM
   Shippers

</PRE>This SQL statement avoids the replication system columns in the table.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about ODBC trace files, start the ODBC Data Source
Administrator, click the Tracing tab, and then click the Help button in the
dialog box.
<P>
For more information about the replication system columns that are added to
a table in a replicated database, search the Help Index for "replication
fields."
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: insert update fail silent design master<BR>
Keywords            : GnlOthr IntAsp RplGen<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbbug<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
