

<HTML>
<HEAD>
<TITLE>ACC97: Dynamic Combo Box to Filter Access Data in IDC Format </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165359">
<META NAME="KBModify" CONTENT="1997/08/28">
<META NAME="KBCreate" CONTENT="1997/03/18">
<META NAME="Keywords" CONTENT="IntpWeb kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  You can filter Microsoft Access data in HTX/IDC format by specifying criteria from a Web browser. One way to accomplish this is to export a parameter query from Microsoft Access ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBVX,QA1S,QBWS,QDN9,QA2Q,QDNQ,QAUR,QAG2,QAPF,QAVZ,QA5V,QAY2,QAUJ,QAYY,QAU7 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Dynamic Combo Box to Filter Access Data in IDC Format</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165359</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI> Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
You can filter Microsoft Access data in HTX/IDC format by specifying
criteria from a Web browser. One way to accomplish this is to export a
parameter query from Microsoft Access to HTX/IDC format. An HTML file is
created, which enables you to type criteria into a text box in order to
filter the records returned to the browser. However, you may prefer to
select criteria from a combo box based on a table or query in the database.
To implement a combo box that you can use from a browser, you must create
an additional IDC file and a corresponding HTX file.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example uses the Northwind sample database. It assumes that
you have Microsoft Personal Web Server or Microsoft Internet Information
Server installed on your Web server computer.
<P>
NOTE: This article contains information about writing and editing IDC and
HTX files. This information is provided as is. Microsoft Access Technical
Support Engineers do not support customizing your IDC or HTX files.
<P>
<PRE>  1. On your Web server, create a System DSN based on the Northwind sample
     database, Northwind.mdb, and name the data source Nwind97.

  2. Start Microsoft Access and open the Northwind sample database.

  3. On the File menu, click Save As HTML. When the "Publish to the Web
     Wizard" appears, click Next on the opening screen.

  4. On the "What do you want to publish?" screen, click the Orders table,
     and then click Next.

  5. Click Next on the screen that prompts you to select a default
     template.

  6. On the "What default format type do you want to create?" screen, click
     Dynamic HTX/IDC, and then click Next.

  7. On the "What are, or will be, the settings for the Internet database?"
     screen, enter Nwind97 in the Data Source Name box, and then click
     Next.

  8. On the "Where do you want to publish to?" screen, select a folder on
     your Web server where you have Execute permission, for example
     InetPub\Scripts or Webshare\Scripts, and then click Finish. The
     Publish to the Web Wizard creates two files, Orders_1.htx and
     Orders_1.idc.

  9. Start a text editor, such as Notepad, and type the following lines:

        datasource: Nwind97
        template: Custlist.htx
        SQLStatement:
        +SELECT customers.customerid, customers.companyname
        +FROM customers

     Save this file in the same folder on your Web server where you saved
     Orders_1.idc, and name this new file Custlist.idc.

 10. Open a new file in your text editor and type the following lines.

     NOTE: Substitute the relative path to the location on your Web server
     where you saved Orders_1.idc in the line &lt;FORM METHOD = "POST" ACTION
     = "/scripts/Orders_1.idc"&gt;

      &lt;HTML&gt;
      &lt;TITLE&gt;Customers&lt;/TITLE&gt;
      &lt;BODY&gt;
      &lt;FORM METHOD = "POST" ACTION = "/scripts/Orders_1.idc"&gt;
      Select the customer whose orders you'd like to see:&lt;BR&gt;

      &lt;SELECT NAME = "customerid"&gt;
      &lt;%BeginDetail%&gt;
      &lt;OPTION VALUE = &lt;%customerid%&gt;&gt; &lt;%companyname%&gt;
      &lt;%EndDetail%&gt;
      &lt;/SELECT&gt;
      &lt;P&gt;
      &lt;INPUT TYPE = "Submit" VALUE = "Submit"&gt;
      &lt;/BODY&gt;
      &lt;/HTML&gt;

     Note that the &lt;%BeginDetail%&gt; and &lt;%EndDetail%&gt; tags determine where
     the records returned from the database will appear; column names are
     enclosed in &lt;%%&gt; to indicate where IDC will insert the dynamic data.

     Save this file in the same folder on your Web server where you saved
     Orders_1.htx, and name this new file Custlist.htx.

 11. Open Orders_1.idc in your text editor, and change the following line:

        SELECT * FROM [Orders]

      to

        SELECT * FROM [Orders] WHERE customerid = '%customerid%'

     Save the file and close it.

 12. Start Microsoft Internet Explorer 3.0 or another Web browser program
     and type the Universal Resource Locator (URL) for Custlist.idc in the
     address box. For example:

       <B>http://&lt;servername&gt;/scripts/custlist.idc</B>

 13. Select a customer name in the combo box and click the Submit button.
     The only orders that display will be those for the customer you
     selected.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about creating a System DSN, search the Help Index for
"ODBC, Help files," and click the "Display the ODBC Help file" link. Then
search the ODBC Help Index for "system DSNs."
<P>
For more information about exporting a table to HTX/IDC, search the Help
Index for "IDC files," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : IntpWeb kbinterop
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
