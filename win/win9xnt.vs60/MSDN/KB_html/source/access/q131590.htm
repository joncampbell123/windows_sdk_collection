

<HTML>
<HEAD>
<TITLE>ACC: Ver. 1.x SQL Pass-Through Query Code Doesn't Run in 2.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131590">
<META NAME="KBModify" CONTENT="1997/05/30">
<META NAME="KBCreate" CONTENT="1995/06/14">
<META NAME="Keywords" CONTENT="kbusage QryPass">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use the Access Basic code that you used for SQL pass-through queries in Microsoft Access version 1.x for applications in Microsoft Access version 2.0, the code does...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAH4,QAGI,QA5F,QAMA,QAPN,QAI5,QBJZ,QACF,QBE7,QBE6,QAIF,QAY5,QABM V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Ver. 1.x SQL Pass-Through Query Code Doesn't Run in 2.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 30, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131590</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use the Access Basic code that you used for SQL pass-through
queries in Microsoft Access version 1.x for applications in Microsoft
Access version 2.0, the code does not work.
<P>
<P><h2>CAUSE</h2>
 
<P>
In Microsoft Access 1.x, to use pass-through queries, you use Access Basic
code to make calls to the MSASP110.DDL file. The SQL-specific query
functionality in the Microsoft Access 2.0 user interface eliminates the
need for such calls. As a result, Access Basic code that makes calls to the
MSASP110.DDL file does not work in Microsoft Access 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
To use SQL pass-through queries in Microsoft Access 1.x, you call three
functions from the MSASP110.DLL file: CreateRMTQueryDEF() (to open a query
session), CloseRMTQueryDEF() (to close a query session), and
RMTQueryExecute() (to run the pass-through query).
<P>
In Microsoft Access 2.0, however, the CreateRMTQueryDEF() and
CloseRMTQueryDEF() functions are not necessary. Also, the RMTQueryExecute()
function call is replaced by the new SQL-specific pass-through query.
Therefore, calls to the MSASP110.DLL file cannot be used with Microsoft
Access 2.0. Error handling (using the error messages log table) has also
changed. Errors can be trapped in Access Basic in Microsoft Access 2.0.
<P>
To convert a Microsoft Access 1.x application that uses a pass-through
query so that it works in Microsoft Access 2.0, follow these steps:

<OL><P><LI>Remove all references in your Access Basic code to the MSASP110.DLL file
   and its related structures and functions.

<P><LI>Remove all CreateRMTQueryDEF() and CloseRMTQueryDEF() function calls.

<P><LI>Reformat any connect string so that it is compatible with the Microsoft
   Access 2.0 Connect property syntax.

<P><LI>Modify your error-handling code accordingly.

<P><LI>Convert each transaction to a standard Microsoft Access pass-through
   query with a Connect property setting, and make sure that the following
   assignments are true:
<P>
<P><PRE>    - The Connect property is the first property assigned after the
      CreateQueryDef object.
</PRE><P>
<P><PRE>    - The SQL property is the last property assigned before running
      the query.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about pass-through queries, search for "pass-through
query," and then "Creating a Pass-Through Query" using the Microsoft Access
Help menu.
<P>
For more information about the Connect property, search for "Connect," and
then "Connect Property (Data Access)" using the Microsoft Access Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: attaching<BR>
Keywords            : kbusage QryPass<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 30, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
