

<HTML>
<HEAD>
<TITLE>ACC: Synch with Replicas Before Changing Design Master Schema </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q165271">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1997/03/14">
<META NAME="Keywords" CONTENT="kbusage RplConf RplDmr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article explains the importance of synchronizing all the databases in a replica set before you make schema changes in the Design Master database.  MORE INFORMATION  The sche...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDIZ,QA5V,QAMA,QAFO,QAOE,QA1S,QAYV,QAG4,QDN9,QDNW,QAZV,QAPF,QDMC,QBVV,QAEF P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Synch with Replicas Before Changing Design Master Schema</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q165271</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article explains the importance of synchronizing all the databases in
a replica set before you make schema changes in the Design Master database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The schema changes that this article discusses are limited to any changes
you make to the design of your tables or their relationships. When you make
schema changes in the Design Master database of a replica set, carefully
consider the impact that those changes may have on other replicas in the
set. For example, if you create a one-to-many relationship that enforces
referential integrity between two tables, one of the replica databases may
contain orphan records in the child table that do not have a corresponding
parent record. Or if you change a table validation rule, there may be
records in a replica table that do not comply with the new validation
rules.
<P>
Whenever you change the schema at the Design Master, the potential exists
for problems to occur when you synchronize with other replicas. Those
problems may range from simple synchronization errors to more complex
design errors. It is possible to create a situation where you can no longer
synchronize with another replica, and you must delete and recreate it.
<P>
For these reasons, it is strongly recommended that you synchronize with all
members of the replica set before changing the database schema in the
Design Master, and then suspend data entry at each of the replicas until
those schema changes have been synchronized throughout the replica set.
<P>
To understand the impact your changes can have on the replica set, it helps
to know how Microsoft Access synchronizes data and design changes between
replicas:

<UL><LI>When you make design changes to the Design Master database, each change
   is stored as a separate record in a Microsoft Access system table named
   MSysSchChange.

<LI>When you synchronize with a replica, all changes are applied at the
   replica in the same order that you made them in the Design Master.
   Microsoft Access does not examine all records in the MSysSchChange table
   to see if a design change you made was undone or modified at a later
   time. For example, if you create a new form in the Design Master and
   make it replicable, and then you turn around and delete the form, when
   you synchronize with a replica the form is first created and then
   deleted there as well.

<LI>When you synchronize with a replica, all design changes are applied
   first before any data is exchanged. If a design change cannot be
   applied, an error occurs and synchronization stops until the conflict
   can be resolved.
<P>
</UL>This method of synchronizing ensures that all replicas become identical to
the Design Master before any data is exchanged. It also can be the source
of problems or frustration if you do not plan your changes carefully. Each
of the sample scenarios that follow help to illustrate the types of
situations you may encounter if you do not synchronize all replicas before
you implement schema design changes. For simplicity, each example assumes
that your replica set consists of a Design Master and one replica database.
<P>
<P><h3>Example 1 - Table Validation Rules</h3>
 
<P>
Suppose you change a table's ValidationRule property for a numeric field in
the Design Master database, requiring that the field value must be greater
than 50. When you synchronize with a replica that contains a record with
the number 48 in that field, synchronization completes successfully but a
data error occurs. This is because the table in the Design Master could not
be updated with the data from the replica table that does not fit the new
validation rule. To resolve this error, you must change the data in the
replica so that it complies with the validation rule, and then synchronize
again.
<P>
<P><h3>Example 2 - Creating a Relationship</h3>
 
<P>
Imagine you have a Customers and an Orders table that have no enforced
relationship. In a replica database, someone adds some records to the
Orders table for which there are no records in the Customers table.
Meanwhile, in the Design Master database, you create an enforced
relationship between Customers and Orders. When you synchronize, you
receive an error message that synchronization failed because a design
change could not be applied. This is because there are orphan child records
in the replica database's Orders table that have no matching customer in
the Customers table, which means that the relationship between Customers
and Orders cannot be applied. You must either create records in the
replica's Customers table that correspond with each orphaned record in the
Orders table, or you must delete the orphaned Orders records until after
you synchronize with the Design Master, and then recreate the orders.
<P>
NOTE: In Microsoft Access 97, you can remove the relationship from the
Design Master, and then synchronize again. This will add the orphaned
records to the table in the Design Master, where you will have to resolve
the problem of the orphaned Orders records before Microsoft Access will
allow you to reapply the enforced relationship between Customers and
Orders.
<P>
<P><h3>Example 3 - Making a Table Unreplicable, Then Replicable Again</h3>
 
<P>
This example illustrates a more serious schema change scenario. Assume you
have two tables called Customers and Orders with a one-to-many relationship
that enforces referential integrity. In the Design Master database you
remove the relationship between the two tables, and you make the Customers
table unreplicable. Then you change your mind and you make it replicable
again, and recreate the enforced relationship between Customers and Orders.
When you synchronize with a replica, the synchronization will fail because
the design changes cannot be applied. Here is what happens in the replica
database:

<UL><LI>The relationship between Customers and Orders is deleted.

<LI>Because the Customers table was made unreplicable in the Design Master,
   it is deleted from the replica database.

<LI>Because the Customers table was made replicable again, Microsoft Access
   recreates the structure of the table in the replica, but does not add
   any data because data exchange always happens after design changes have
   been applied.

<LI>The relationships between Customers and Orders is recreated. This is
   when synchronization fails because there is no data in the Customers
   table yet, and Microsoft Access cannot create an enforced relationship
   with the Orders table that contains orphaned child records.
<P>
</UL>In this scenario, you must recreate the replica from the Design Master. No
amount of data manipulation will allow you to synchronize successfully. In
this case, the problem could be prevented by synchronizing the Design
Master with the replica after you make the Customers table replicable
again, but before you re-apply the relationship. Then, recreate the
relationship in the Design Master and synchronize again.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using replication in Microsoft Access, refer to
the replication white papers. You will find download instructions for the
white papers in the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q138828.htm">Q138828</A></B>
   TITLE     : ACC95: Microsoft Jet Replication White Paper Available on
               MSL

   ARTICLE-ID: <B><A href="../access/q164553.htm">Q164553</A></B>
   TITLE     : ACC97: Jet 3.5 Replication White Paper Available on MSL
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage RplConf RplDmr<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : x86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
