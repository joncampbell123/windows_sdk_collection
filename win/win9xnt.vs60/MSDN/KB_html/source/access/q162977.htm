

<HTML>
<HEAD>
<TITLE>ACC97: ASP Query Cannot Be Used with the LIKE Predicate </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q162977">
<META NAME="KBModify" CONTENT="1998/01/26">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="IntAsp kberrmsg kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you browse to an Active Server Pages (ASP) file that was exported from Microsoft Access 97, the Web browser either returns no records or you receive the following error...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QDNQ,QA1S,QDN9,QBWS,QBVX,QBWA,QBTI,QA3P,QABM,QAPN,QBD7,QAUR,QAVZ,QAHE,QBQU P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: ASP Query Cannot Be Used with the LIKE Predicate</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  January 26, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q162977</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI> Microsoft Access 97
<LI> Microsoft Internet Information Server version 3.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you browse to an Active Server Pages (ASP) file that was exported from
Microsoft Access 97, the Web browser either returns no records or you
receive the following error message:
<P>
<PRE>  Expression cannot be used with the LIKE predicate in query expression.

</PRE><h2>CAUSE</h2>
 
<P>
Because ASP files use ActiveX Data Objects (ADO) to communicate with ODBC
drivers in order to query the back-end data, the SQL statements they
contain have different character requirements than typical Microsoft Access
SQL statements. ASP files use the percent sign (%) as a wildcard character
in SQL statements whereas Microsoft Access uses the asterisk (*).
<P>
In addition, when Microsoft Access exports a query that contains a
parameter concatenated with a wildcard, the SQL statement that is generated
does not contain the correct sequence and number of delimiters around the
wildcard.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Edit the SQL statements in the ASP files so that they use the percent sign
(%) for wildcards.
<P>
If parameter queries with wildcards are exported, edit the SQL statements
in the ASP file so that they use the percent sign (%) as the wildcard along
with the correct sequence and number of delimiters around the wildcard.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
NOTE: This section contains information about editing ASP files, and
assumes that you are familiar with editing ASP files. Microsoft Access
Technical Support engineers do not support customization of any HTML, HTX,
IDC, or ASP files.
<P>
The following example demonstrates how to change the SQL Statement in an
ASP file so that it contains the appropriate wildcard character and the
correct sequence and number of delimiters around the wildcard.
<P>
<PRE>  1. In Microsoft Access 97, open the sample database Northwind.mdb.

  2. Create the following new query called FindName based on the Customers
     table:

       Query: FindName
       ---------------
       Type: Select Query

       Field: CompanyName
       Table: Customers
       Criteria: Like [EnterName] &amp; "*"

  3. On the Query menu, click Parameters.

  4. Type the following in the Query Parameters dialog box, and then click
     OK:

       Parameter          Data Type
       ----------------------------
       [EnterName]        Text

  5. Save the FindName query and close it.

  6. Select the FindName query in the Database window, and then click
     Save As/Export on the File menu.

  7. In the Save As dialog box, click "To an External File or Database,"
     and then click OK.

  8. In the "Save Query 'FindName' In" dialog box, select Microsoft Active
     Server Pages (*.asp) in the Save As Type box, and type FindName.asp in
     the File Name box. Note the folder where the files will be exported
     to. Click Export. The Microsoft Active Server Pages Output Options
     dialog box appears.

  9. In the Data Source Name box, enter the name of a System DSN that
     points to the sample database Northwind.mdb.

     For more information on how to define a system DSN, search the Help
     index for "ODBC, setting up data sources," and see the following
     article in the Microsoft Knowledge Base:

       ARTICLE-ID: <B><A href="../access/q159682.htm">Q159682</A></B>
       TITLE:      "Data Source Name Not Found" Err Msg Opening Web Page

 10. In the Server URL box, enter the URL that points to the Web Server
     location where your ASP files will be stored. For example, if you
     store the ASP files in the \ASPsamp folder on the \\PubTest server,
     type <B>http://pubtest/aspsamp/</B> as your Server URL. Click OK.

 11. Click OK in the Enter Parameter Value dialog box that appears. Note
     that the ASP output creates two files: FindName.HTML and FindName.ASP.

 12. Copy FindName.HTML and FindName.ASP to a folder on your Web Server
     computer where you have both Read and Execute permission. Read
     permission is necessary to browse the HTML file, and execute
     permission is necessary to run the ASP file.

     For more information about configuring Microsoft Internet Information
     Server (IIS) permissions, please refer to the IIS Help Index, and see
     the following article in the Microsoft Knowledge Base:

       ARTICLE-ID: <B><A href="../access/q160754.htm">Q160754</A></B>
       TITLE:      Error "HTTP/1.0 403 Access Forbidden" Browsing IDC Page

 13. Use Notepad or another text editor to open the FindName.ASP file. You
     need to change the SQL Statement so that it will use the appropriate
     sequence of parameter and wildcard characters. Change the SQL
     Statement so that it looks as follows:

     sql = "SELECT Customers.CompanyName From Customers WHERE
     (((Customers.CompanyName) Like '" &amp; Request.QueryString("[EnterName]")
     &amp; "%'))"

     Note that the wildcard is a percent sign (%) sign and the sequence in
     which the delimiters were concatenated has changed.

 14. Save the FindName.ASP file and close it.

 15. Start Microsoft Internet Explorer 3.0 or another Web browser program.

 16. Type the Uniform Resource Locator (URL) in the address box of your Web
     browser to view FindName.ASP. For example, if you saved your ASP file 
     and your HTML file in a folder called Test in the wwwroot folder of 
     your Web Server, type:

        <B>http://&lt;servername&gt;/test/FindName.html</B>

     Note that the URL depends upon where your files are located on the Web
     Server.

 17. The FindName.HTML form opens in your Web browser with an [EnterName]
     box and a Run Query button. Type the letter "M" (without the quotation
     marks) in the box, and then click the Run Query button. Note that all
     records with names that begin with "M" are returned.

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about exporting ASP files, search the Help Index for
"ASP files," or ask the Microsoft Access 97 Office Assistant. In addition,
please refer to your ASP online documentation.
 
<PRE>Keywords          : IntAsp kberrmsg kbinterop
Version           : 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbworkaround</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  January 26, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
