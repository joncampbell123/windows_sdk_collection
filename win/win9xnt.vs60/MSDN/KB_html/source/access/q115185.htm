

<HTML>
<HEAD>
<TITLE>ACC1x: RunSQL Action SQL Statement Limited to 255 Characters </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q115185">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1994/05/19">
<META NAME="Keywords" CONTENT="kbprg PgmOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The SQL statement in a RunSQL action is limited to 255 characters. This article describes a sample user-defined function called RunSQL2() that you can use in place of the RunSQL action to run large SQL statements.  MORE INFORMATION  The RunSQL2() f...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAPN,QA1S,QAY5,QAB9,QBV8,QDN9,QA5F,QAMA,QANF,QAH6,QBWS,QBQX,QATX,QAPF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: RunSQL Action SQL Statement Limited to 255 Characters</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q115185</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
The SQL statement in a RunSQL action is limited to 255 characters. This
article describes a sample user-defined function called RunSQL2() that you
can use in place of the RunSQL action to run large SQL statements.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The RunSQL2() function creates a new query programmatically using the
CreateQueryDef method with the SQL statement you pass to it as an argument.
Once the query is created, it is run using the Execute method, and then
deleted using the DeleteQueryDef method.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Introduction to Programming" manual.
<P>
<P><h3>The RunSQL2() Function</h3>
 
<P>
<PRE>   '************************************************************
   'Declarations section of the module.
   '************************************************************
   Option Explicit

   '=============================================================
   ' Create the following function in the module.
   '=============================================================
   Function RunSQL2(ByVal SQL As String)
      Dim db As Database
      Dim Q As QueryDef
      Dim SQL As String

      Set db = CurrentDB()
      Set Q = db.CreateQueryDef("TempQuery", SQL)
      Q.Execute
      Q.Close
      db.DeleteQueryDef("TempQuery")

   End Function

</PRE><h3>How to Use the RunSQL2() Function</h3>
 
<P>
The following sample user-defined Access Basic function uses the RunSQL2()
function to run an SQL statement that is longer than 255 characters. This
function, when run in the sample database NWIND.MDB, will create a table
called New Customers Table with data from the Customers table. The query is
a make-table query.
<P>
<PRE>   Function CreateNewCustomersTable()
      Dim SQL As String

      SQL = "SELECT  DISTINCTROW Customers.[Customer ID], "
      SQL = SQL &amp; "Customers.[Company Name], Customers.[Contact Name], "
      SQL = SQL &amp; "Customers.[Contact Title], Customers.Address, "
      SQL = SQL &amp; "Customers.City, Customers.Region, Customers.[Postal
         Code], "
      SQL = SQL &amp; "Customers.Country, Customers.Phone, Customers.Fax "
      SQL = SQL &amp; "INTO [New Customers Table] FROM Customers "
      SQL = SQL &amp; "WITH OWNERACCESS OPTION;"

      RetVal = RunSQL2(SQL)

   End Function
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprg PgmOthr<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
