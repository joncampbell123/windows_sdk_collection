

<HTML>
<HEAD>
<TITLE>ACC1x: Invalid Reference: Previewing Graph Based on Parameter </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q105657">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1993/10/22">
<META NAME="Keywords" CONTENT="IntpGrph kbtool">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  The message     Invalid reference to field 'Field Name' in query  occurs when you are printing or previewing a graph from Form view, or when you are printing a graph on a report from print preview.  CAUSE =====  The data source for the graph is a p...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QBWS,QBRM,QBXS,QAI2,QBJZ,QAY2,QAKD,QACE,QAAW,QA50,QAG2,QA7O,QA59,QAPN V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: Invalid Reference: Previewing Graph Based on Parameter</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q105657</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
The message
<P>
<PRE>   Invalid reference to field 'Field Name' in query

</PRE>occurs when you are printing or previewing a graph from Form view, or when
you are printing a graph on a report from print preview.
<P>
<P><h2>CAUSE</h2>
 
<P>
The data source for the graph is a parameter query. The parameter query is
run one time to collect the values required to display the graph in Form
view or print preview. Once the parameters are collected through the Enter
Parameter Value box, they no longer exist. When you try to print the graph,
the graph must be regenerated from the underlying data. Since the
parameters are no longer available and are not prompted for again, the
error message stated above is generated.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Rather than enter the parameters using the Enter Parameter Value box, the
parameters for the query should come from a source that is available while
the form is active. Modify the query so that the parameters are referenced
directly from a second form.
<P>
The following example demonstrates how to use a second form to collect the
values:

<OL><P><LI>Open the sample database NWIND.MDB. Create a blank, unbound form called
   Parameter Form with the following controls and properties:
<P>
<P><PRE>      Form: Parameter Form
      Text box
<PRE></PRE>         ControlName: Beginning Date
      Text box
         ControlName: Ending Date
      Command button
         Caption: Open Graph Form
         OnPush: Graph Form.Open

</PRE><P><LI>Create a new macro called Graph Form with the following actions:
<P>
<PRE>      MacroName      Action         Defined Below
      -------------------------------------------
      Open           SetValue             1
                     OpenForm             2
      Close          Close                3

      Graph Form Actions
      ------------------------------------------
      1. SetValue
            Item: Forms![Parameter Form].Visible
            Expression: False
      2. OpenForm
            Form Name: Graph Form
            View: Form
            Filter Name: &lt;leave empty&gt;
            Where Condition: &lt;leave empty&gt;
            Data Mode: Edit
            Window Mode: Normal
      3. Close
            Object Type: Form
            Object Name: Parameter Form

</PRE><P><LI>Open the Employee Sales By Country (Parameter) query in Design view.

<P><LI>Change the criteria row for the Shipping Date column from
<P>
<P><PRE>      Between [Beginning Date] And [Ending Date]
</PRE><P>
   to:
<P>
<P><PRE>      NOTE: In the following example, an underscore (_) is used as a line-
      continuation character. Remove the underscore when re-creating this
      example.
</PRE><P>
<P><PRE>      Between Forms![Parameter Form]![Beginning Date] And _
      Forms![Parameter Form]![Ending Date]
</PRE>
<P><LI>From the Query menu, choose Parameters. Change the parameters to be:
<P>
<PRE>      Parameter                                    Data type
      ------------------------------------------------------
      Forms![Parameter Form]![Beginning Date]      Date/Time
      Forms![Parameter Form]![Ending Date]         Date/Time

   NOTE: Your query may not have parameters explicitly defined in the
   Parameters dialog box; however, it is good practice to do so.

</PRE><P><LI>Open the Graph Form and alter the OnClose property to be:
<P>
<P><PRE>      OnClose: Graph Form.Close
</PRE>
<P><LI>Open the Parameter Form form and type "1/1/92" (without the quotation
   marks) in the first box, and type "12/31/92" (without the quotation
   marks) in the second box. Choose the Open Graph Form button.
<P>
   Note that when you choose the Open Graph Form button, a macro hides the
   parameter form and then opens the graph form. Although the parameter
   form is hidden, it is still open, and the values on it are still
   available for the query that the graph is based on.

<P><LI>From the File menu, choose Print Preview.
<P>
</OL>Because the parameter form remains open, and the values on it are still
available, the graph can be regenerated for printing. In contrast, the
Enter Parameter Value box values are available only at the time the
parameter is entered.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access versions
1.0 and 1.1. This problem no longer occurs in Microsoft Access version 2.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB. Create a blank, unbound form and
    save it with the name Graph Form.

<P><LI>Click the graphing tool in the toolbox, and then click in the blank
    form to start the GraphWizard.

<P><LI>In the "Also, Select a Data Source for Your Graph" box, select
    Employee Sales By Country (Parameter).

<P><LI>Choose Next to advance to the next screen.

<P><LI>In the Available Fields box, select Sale Amount. Choose the "&gt;" button
    to add it to the Fields For Graph box.

<P><LI>In the Available Fields box, select Salesperson, and then choose "&gt;".

<P><LI>Choose Next to advance to the next screen.

<P><LI>Choose the Design button.

<P><LI>From the View menu, choose Form.

<P><LI>Type "1/1/92" (without the quotation marks) in the Beginning Date
    parameter value box, and then choose OK.

<P><LI>Type "12/31/92" (without the quotation marks) in the Ending Date
    parameter value box, and then choose OK. A bar graph will be displayed.

<P><LI>From the File menu, choose Print Preview.
<P>
    The error message: "Invalid reference to field 'Beginning Date' in
    query" will be displayed.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpGrph kbtool<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
