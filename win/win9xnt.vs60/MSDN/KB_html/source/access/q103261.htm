

<HTML>
<HEAD>
<TITLE>ACC1x: How to Remove the Caption Bar from a Form </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103261">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1993/08/19">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  There is no built-in mechanism in Microsoft Access version 1.x for removing the caption bar from a form. The caption bar runs across the top of the window and includes the Control menu and the minimize and maximize buttons.  Microsoft Access versio...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAEF,QAMB,QDN9,QA9N,QANJ,QDH6,QAY5,QDKD,QAB9,QA5F,QAY2,QAPN,QAMA,QAI2 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Remove the Caption Bar from a Form</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103261</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
There is no built-in mechanism in Microsoft Access version 1.x for removing
the caption bar from a form. The caption bar runs across the top of the
window and includes the Control menu and the minimize and maximize buttons.
<P>
Microsoft Access version 2.0 has properties you can use to remove the
minimize and maximize buttons and the Control menu. For more information,
search for "MinButton, MaxButton, and ControlBox" using the Help menu in
Microsoft Access 2.0. Or you can set the BorderStyle property to None to
remove the caption bar from the form.
<P>
This article demonstrates a sample user-defined Access Basic function
called RemoveCaptionBar() that you can use to remove the caption bar from a
form. Procedures for creating a form with no caption bar are also listed.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools
provided with Microsoft Access. For more information on Access Basic,
please refer to the "Introduction to Programming" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Creating a New Module to Delete Caption Bar</h3>
 
<P>
NOTE: In the following sample code, an underscore (_) is used as a
line-continuation character. Remove the underscore when re-creating
this code in Access Basic.
<P>
NOTE: You may have some Windows API functions defined in an existing
Microsoft Access library; therefore, your declarations may be
duplicates. If you receive the duplicate procedure name error message
when you compile or run your code, remove or comment out the
appropriate declarations statement.
<P>
<PRE>   '**************************************************************
   ' MODULE DECLARATION SECTION
   '**************************************************************

   Option Explicit

   ' Windows API Rect structure
   Type RECT
       x1 As Integer
       y1 As Integer
       x2 As Integer
       y2 As Integer
   End Type

   ' Windows API Declarations
   Declare Function SetWindowLong&amp; Lib "User" (ByVal hwnd%, _
                    ByVal iindex%, ByVal style&amp;)
   Declare Function GetWindowLong&amp; Lib "User" (ByVal hwnd%, _
                    ByVal iindex%)
   Declare Function GetSystemMetrics% Lib "User" (ByVal iIndex%)
   Declare Function GetWindowRect% Lib "User" Alias "GetWindowRect" _
                    (ByVal hwin%, rectangle As RECT)
   Declare Function MoveWindow% Lib "User" Alias "MoveWindow" _
                    (ByVal hwin%, ByVal x%, ByVal y%, ByVal dx%, _
                    ByVal dy%, ByVal fRepaint%)

   ' GetWindowLong Constants
   Const GWL_STYLE = -16

   ' Window Styles Constants
   Global Const WS_CAPTION = &amp;HC00000

   ' System Metrics Constants
   Global Const SM_CYCAPTION = 4

   '**************************************************************
   ' FUNCTION: RemoveCaptionBar
   '
   ' PURPOSE:
   '   Removes the caption bar, which includes the system menu
   '   and minimize and maximize buttons, from a form.
   '
   ' ARGUMENTS:
   '   F - The form object from which to remove the caption bar.
   '
   ' USAGE:
   '   Enter the following for the OnOpen property of a form called
   '   MyForm:
   '
   '       =RemoveCaptionBar(Forms![MyForm])
   '
   ' SIDE AFFECTS:
   '   With a normal form, the form opens slightly lower than
   '   expected. With a dialog form (PopUp=Yes, Modal=Yes), the form
   '   opens slightly higher than expected. Also, you cannot close the
   '   form using the Microsoft Access menu; you must close it
   '   programmatically.
   '
   '   If the form property Popup=No, a form is created that has a
   '   sizable border. Since Captions are required for sizable windows,
   '   screen painting problems may occur. For instance, if the frame
   '   of the Window is a light color, the division lines for the frame
   '   will display, creating an undesirable effect.
   '
   '***************************************************************
   Function RemoveCaptionBar (F As Form)
       Dim OldStyle As Long, NewStyle As Long
       Dim R As RECT
       Dim RetVal As Integer
       Dim dx As Integer, dy As Integer

       ' Get the current window style of the form.
       OldStyle = GetWindowLong(F.hwnd, GWL_STYLE)

       ' Set the window style to be the same, minus the caption bar.
       NewStyle = OldStyle And Not WS_CAPTION

       'Change the window style of the form.
       OldStyle = SetWindowLong(F.hwnd, GWL_STYLE, NewStyle)

       ' The caption is removed, but the border has not snapped down
       ' .. onto the smaller window. We will call the Windows API to
       ' .. move and size the window to the same location and size,
       ' .. with the window shortened by the length of the caption bar.
       RetVal = GetWindowRect(F.hwnd, R)
       dx = R.x2 - R.x1
       dy = R.y2 - R.y1 - GetSystemMetrics(SM_CYCAPTION)
       RetVal = MoveWindow(F.hwnd, R.x1, R.y1, dx%, dy%, True)
   End Function

</PRE><h3>Creating a Form with No Caption Bar</h3>
 
<P>
The following instructions show how to create a form that does not
have a caption bar:

<OL><P><LI>Create or open a database in Microsoft Access.

<P><LI>Create a new, blank, unbound form and save it with the name
   NoCaption.

<P><LI>Change the OnOpen property of the form to read:
<P>
<P><PRE>      =RemoveCaptionBar(Forms![NoCaption])
</PRE>
<P><LI>From the View menu, choose Form.
<P></OL>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: menu bar<BR>
Keywords            : kbprg PgmApi<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
