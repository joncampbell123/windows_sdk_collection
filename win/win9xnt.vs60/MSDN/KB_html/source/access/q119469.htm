

<HTML>
<HEAD>
<TITLE>ACC2: How to Use OLE Automation to Modify MS Graph Object </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119469">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1994/08/17">
<META NAME="Keywords" CONTENT="IntpGrph kbtool">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to use OLE Automation to modify a Microsoft Graph version 5.0 graph's title and hide or show the graph's legend.  This article assumes that you are fam...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAMB,QBT6,QA1S,QBV4,QDN9,QAHP,QAPN,QAPF,QDMF,QA5F,QAMA,QA3W,QAH4,QDKY,QA9Q V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: How to Use OLE Automation to Modify MS Graph Object</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119469</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to use OLE Automation to modify a Microsoft
Graph version 5.0 graph's title and hide or show the graph's legend.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information on Access Basic, please refer
to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Changing a Graph's Title</h3>
 
<P>
The following example demonstrates how to use OLE Automation to modify a
Graph 5.0 graph's title.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Sales By Product form in Design view.

<P><LI>Set the form's DefaultEditing property to Allow Edits.

<P><LI>Add the following controls to the form:
<P>
<P><PRE>      Text Box
      -------------
      Name: MyTitle
</PRE><P>
<P><PRE>      Command Button
      ---------------------
      Name: Title
      Caption: Show Caption
</PRE>
<P><LI>Set the Show Caption command button's OnClick property to the
   following event procedure.
<P>
   NOTE: In the following sample code, an underscore (_) at the end of a
   line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating this code in Access Basic.
<P>
<PRE>      Sub Title_Click ()
      Dim The_title As String

      '--------------------------------------------------------------
      ' This function reads the text box. If it is null or blank, it
      ' supplies a generic title, otherwise it adds a title and sets
      ' the caption to the text box's contents.
      '--------------------------------------------------------------

      If IsNull(Me![MyTitle]) Or Me![MyTitle] = "" Then
          The_title = "No Title"
      Else
          The_title = Me![MyTitle]
      End If

      If Me![Title].Caption = "Show Title" Then
          Me![Embedded13].Object.Application.Chart.Hastitle = -1

      Me![Embedded13].Object.Application.Chart.Charttitle.Caption = _
          The_title
          Me![Title].Caption = "Hide Title"
      Else
          Me![Embedded13].Object.Application.Chart.Hastitle = 0
          Me![Title].Caption = "Show Title"
      End If

      End Sub

</PRE><P><LI>Add the following line to the Declarations section of the Sales By
   Product form's form module:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>View the form in Form view. Type any text in the text box you created
   in step 4, and then click the Show Caption button. The graph's title
   will change to the text box's text.
<P>
</OL><h3>Hiding or Showing a Graph's Legend</h3>
 
<P>
The following example demonstrates how to hide or show a Graph 5.0 graph's
legend.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Sales By Product form in Design view.

<P><LI>Add a command button with the following properties to the form:
<P>
<P><PRE>      Name: Legend
      Caption: Show Legend
</PRE>
<P><LI>Set the Show Legend command button's OnClick property to the
   following event procedure:
<P>
<PRE>      Sub Legend_Click ()

      '----------------------------------------------------------
      ' If the legend is not present, show it, otherwise hide it.
      '----------------------------------------------------------

      If Me![Legend].Caption = "Show Legend" Then
         Me![Embedded13].Object.Application.Chart.Haslegend = -1
         Me![Legend].Caption = "Hide Legend "
      Else
         Me![Embedded13].Object.Application.Chart.Haslegend = 0
         Me![Legend].Caption = "Show Legend"
      End If
      End Sub

</PRE><P><LI>Add the following line to the Declarations section of the Sales By
   Product form's form module:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>View the form in Form view. Click the Show Legend button to toggle
   between hiding and showing the form's legend.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 8, "Events,"
pages 183-201, and Chapter 13, "Communicating with Other Applications,"
pages 281-311
<P>
For more information about OLE Automation, search for "OLE Automation," and
then "Interoperability with Microsoft Word and Microsoft Excel (Common
Questions" using the Microsoft Access Help menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: link embed<BR>
Keywords            : IntpGrph kbtool<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
