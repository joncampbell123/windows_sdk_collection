

<HTML>
<HEAD>
<TITLE>ACC: How to Play .WAV Sounds on Events in Microsoft Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95647 ">
<META NAME="KBModify" CONTENT="1997/06/08">
<META NAME="KBCreate" CONTENT="1993/02/18">
<META NAME="Keywords" CONTENT="kbprg PgmApi">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  Microsoft Access does not have a built-in function to play sound files on events, such as when a form is opened or closed. However, you can use the Microsoft Windows 3.1 app...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHR,QAYS,QA1S,QDL9,QBWO,QBWN,QDN9,QAPN,QAH4,QAY5,QBV8,QAB9,QBWQ,QA5F,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Play .WAV Sounds on Events in Microsoft Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95647 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
Microsoft Access does not have a built-in function to play sound files on
events, such as when a form is opened or closed. However, you can use the
Microsoft Windows 3.1 application program interface (API) through Access
Basic code to create a user-defined function to play sound files.
<P>
This article assumes you are familiar with Access Basic and Windows APIs.
In this article, the use of error trapping has been omitted to keep the
information as clear and concise as possible.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Follow these steps to create a user-defined function to play sound files:

<OL><P><LI>Create a new module with a single function named PlaySound().
<P>
   NOTE: In the following sample code, an underscore (_) is used as
   a line-continuation character. Remove the underscore from the end
   of the line when re-creating this code in Access Basic.
<P>
<P>
<P><PRE>    '*****************************************************************
    'Declarations section of the module.
    '*****************************************************************
</PRE><P>
<P><PRE>      Option Explicit
</PRE><P>
<P><PRE>      Declare Function sndplaysound% Lib "mmsystem" (ByVal filename$, _
<PRE></PRE>                                                     ByVal snd_async%)

    '================================================================
    ' The following function PlaySound calls the Windows API function
    '================================================================

      Function PlaySound (msound)
         Dim XX%
         XX% = sndplaysound(msound, 1)' play mmwave sound
         If XX% = 0 Then MsgBox "The Sound Did Not Play!"
      End Function

</PRE><P><LI>Save the module as Play It Sam.
<P>
   The following steps use a command button to trigger the sound, but
   you can use other events to trigger the sound.

<P><LI>Add a command button to a form that you want to play the sound from:
<P>
<P><PRE>      Object: Command Button
      -------------------------------------------
      Name: Push_Button_1
      Caption: Play Chimes
      On Click: =PlaySound("C:\WINDOWS\CHIMES.WAV")
</PRE><P>
<P><PRE>      (Where C:\WINDOWS\ is the location of the sound file and CHIMES.WAV
      is the sound file.)
</PRE><P>
</OL>NOTE: The Name property is called the ControlName property and the OnClick
property is called the OnPush property in Microsoft Access 1.x.
<P>
When the form is open in Form view, you can play the sound by clicking the
command button. You can assign this function to the form's OnOpen property
if you want chimes to play when you open a form.
<P>
NOTE: This example does not have error trapping. Unexpected results may
occur if the sound file is not in the location specified or does not exist.
<P>
If the sound (.WAV file) is in the table as an OLE field, the sound can be
added to the form out of the field list. You can then use a macro that does
a GoToControl [olefield], DoMenuItem form-edit-object- &lt;verb&gt;. You can run
this from a button on the form. It will go to the OLE field and edit the
object (the default edit is play for a sound).
<P>
<P><h2>REFERENCES</h2>
 
<P>
Microsoft Access "Introduction to Programming," Chapters 1-5
<P>
"Microsoft Windows Software Development Kit," Microsoft Press, 1992
<P>
"Programming Windows: the Microsoft Guide to Writing Applications for
Windows 3", Charles Petzold. Microsoft Press, 1990
<P>
"Programmer's Reference Library: Microsoft Windows 3.1 Guide to Programming
Reference," Volumes 1 - 6, Microsoft Press, 1992
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: sound api how to<BR>
Keywords            : kbprg PgmApi<BR>
Version             : 1.0 1.1 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
