

<HTML>
<HEAD>
<TITLE>ACC97: How to Install Wizards Locally [OFF97] </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q174742">
<META NAME="KBModify" CONTENT="1998/02/16">
<META NAME="KBCreate" CONTENT="1997/10/06">
<META NAME="Keywords" CONTENT="StpNet">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article reproduces the text of Acwizard.doc, a Word document that discusses how to modify the Setup Table File (STF) so that Setup installs Microsoft Access 97 wizard f...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAA1,QDI2,QA1S,QAE1,QBVP,QDKX,QDN9,QDMN,QAKD,QBWS,QA5V,QAGU,QAFI,QAYZ,QBC9 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: How to Install Wizards Locally [OFF97]</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  February 16, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q174742</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article reproduces the text of Acwizard.doc, a Word document that
discusses how to modify the Setup Table File (STF) so that Setup installs
Microsoft Access 97 wizard files on users' hard drives during Run From
Network Server installations.
<P>
Acwizard.doc is one of nine advanced Office documents contained in
Document.exe, a downloadable file on the "Microsoft Office 97 Resource Kit
Tools and Utilities" page on the World Wide Web. To see a description of
the other Office documents or to download Document.exe, please see the
following Microsoft World Wide Web site:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/ork/appa/appa.htm#orkappac3">http://www.microsoft.com/office/ork/appa/appa.htm#ORKappaC3</A></B>

</PRE>NOTE: Because the Microsoft Web site is constantly updated, the site
address may change without notice. If this occurs, link to the Microsoft
home page at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/">http://www.microsoft.com/</A></B>

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The following is the text of Acwizard.doc.
<P>
WARNING: ANY USE BY YOU OF THE INFORMATION IN THIS ARTICLE IS AT YOUR OWN
RISK. Microsoft provides this information "as is" without warranty of any
kind, either express or implied, including but not limited to the implied
warranties of merchantability and/or fitness for a particular purpose.
Modification of the Setup Table File (STF) is not supported by Microsoft
Access Technical Support Engineers.
<P>
If you open, edit, and save the STF file improperly in Microsoft Excel,
you may receive a "Setup Error 932" error message. To resolve this error,
please see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../office/q162796.htm">Q162796</A></B>
   TITLE     : OFF97: Setup Error 932 After Modifying STF File

</PRE>NOTE: To see references mentioned in the following text, please connect to
the "Microsoft Office 97 Resource Kit" Web site at the following address:
<P>
<PRE>   <B><A href="http://www.microsoft.com/office/ork/">http://www.microsoft.com/office/ork/</A></B>

</PRE><h3>Modifying the STF File to Run Microsoft Access from the Network</h3>
 
<P>
To make a Run from Network Server installation from an administrative
installation point work more smoothly, administrators can modify the
Microsoft Office 97 Professional Edition or Microsoft Access 97 Setup
Table File (STF). These modifications are described in the following
sections.
<P>
<PRE> --------------------------------------------------------------------------
 WARNING: The modifications that are described in this paper should only be
 used with Run from Network Server installations. Do not use an STF file
 with these modifications for Typical or Custom installations.

 To use a modified STF file to change a Run From Network Server
 installation, make a backup copy of the Setup.lst file (typically this
 file is located in the Msoffice folder of your administrative installation
 point), then open the file in Notepad and search and replace all
 occurrences of the names of STF and INF files with the names of the files
 you create using the procedures in this paper. Save the modified LST file
 to a name of your choosing. Then create a BAT file that uses a command-
 line in the following format to run Setup:

    pathtosetup\Setup /l filename.lst /b3 /q1

 These command-line options perform the following functions: /l points to
 the LST file that you modified to point to the correct STF and INF files
 for this installation, /b3 runs a Run from Network Server installation,
 and /q1 runs Setup in quiet mode.
 --------------------------------------------------------------------------

</PRE><h3>Installing Microsoft Access Wizards Locally</h3>
 
<P>
After performing a Run from Network Server installation, Microsoft Access
runs wizards directly from the Workdir folder on the network server. This
works properly as long as users are given Change permissions (the set of
Read, Write, Execute, and Delete permissions) in the Workdir folder, as
described in "Creating the Administrative Installation Point" in Chapter 4,
"Installing Microsoft Office," in the Microsoft Office 97 Resource Kit.
<P>
However, a user cannot run certain wizards, such as the Table Wizard, from
the network if another user is running the same wizard at the same time.
Instead, an error message is displayed. To avoid sharing conflicts when
running wizards, or if you don't want to give users Change permissions in
the Workdir folder, you can modify the STF file so that Setup installs
Microsoft Access 97 wizard files on users' hard drives during Run from
Network Server installations.
<P>
NOTE: The following instructions are recommended only for administrators
who are familiar with administrative installations and editing of the STF
file. All of the procedures in this paper assume that you have already
created an administrative installation point. For more information, see
"Creating the Administrative Installation Point" in Chapter 4, "Installing
Microsoft Office," in the Microsoft Office 97 Resource Kit.
<P>
WARNING: Off97Pro.stf and Acc97.stf are tab-delimited files that rely
heavily on positional parameters, and they can easily be damaged by
modifying them using a method other than the one described here.
<P>
The best way to make complex edits to an STF file is by using Microsoft
Excel. Microsoft Excel opens the tab-delimited data in an STF file as
separate columns so that you can easily view and modify the data. However,
if you do not follow the correct procedures when opening an STF file, you
can damage the format of the STF file. Some of the tab characters used to
delimit data in the STF files for Microsoft Office 97 and Microsoft Access
97 are followed by a single space. Before editing the STF file the first
time in Microsoft Excel, you must remove these trailing spaces as described
in the following procedure.
<P>
<P><h3>To remove trailing spaces from an STF file</h3>
 

<OL><P><LI>Make a backup copy of the STF file (Off97pro.stf or Acc97.stf) in the
   MSOffice folder of the administrative installation point.

<P><LI>Open the STF file in Microsoft Word (version 6.0 or later).

<P><LI>On the Edit menu, click Replace.

<P><LI>In the Find What box, type ^t followed by a single space.

<P><LI>In the Replace With box, type ^t with no space following.

<P><LI>Click Replace All.

<P><LI>On the File menu, click Save As, and save the file as Text Only.
   Microsoft Word saves the file with a .txt extension.

<P><LI>In My Computer or Windows Explorer, rename the file to remove the .txt
   extension and restore its original name (Off97pro.stf or Acc97.stf).
<P>
</OL>After you remove any trailing spaces from the STF file, you can safely open
it in Microsoft Excel and there is no need to repeat this procedure.
<P>
When you open an STF file in Microsoft Excel, it starts the Text Import
Wizard to specify how data is formatted. You must make the correct
selections in the Text Import Wizard to make sure that all columns of data
in the file are opened using a Text format.
<P>
<P><h3>To open an STF file using Microsoft Excel</h3>
 

<OL><P><LI>Before opening an STF file the first time, remove trailing spaces as
   described in the preceding procedure.

<P><LI>Start Microsoft Excel and open the STF file. The Text Import Wizard
   starts automatically.

<P><LI>Click Next twice to proceed to Step 3 of 3 in the wizard.

<P><LI>In the Data Preview window, scroll down until ObjID is displayed at the
   top of the first column.

<P><LI>Click the first column to select it.

<P><LI>Scroll all the way to the right until the last column is displayed. The
   data at the top of the last column should be Install Directory.

<P><LI>Hold down shift and click the last column. All of the columns in the
   Data Preview list should be selected.

<P><LI>In Column Data Format, click Text, and then click Finish.
<P>
</OL>Microsoft Excel opens the STF file. An STF file starts with about 30 rows
of header information. Scroll down until you see ObjID in column A. This is
the beginning of the STF table information that you will modify using the
procedures that follow. You can adjust the widths of each column to view
the data in each column better.
<P>
<P><h3>To modify the administrative installation point for Office 97 to install</h3>
 
<P><h3>Microsoft Access wizards on users' hard drives</h3>
 

<OL><P><LI>Open Off97pro.stf in Microsoft Excel as described earlier in this paper
   in the procedure "To open an STF file using Microsoft Excel."

<P><LI>Scroll down to the row that contains 120 in column A (ObjID ). In column
   F (Object Data ), change the value 147 to 148. The values in column F
   for this row should now read:
<P>
<P><PRE>      124 121 148 150
</PRE>
<P><LI>Scroll down to the row that contains 121 in column A and delete the
   value 127 in column F. The value in column F should now read:
<P>
<P><PRE>      126 592 123 141 131
</PRE>
<P><LI>Find the rows with the following values in column A and change the
   values in column K (Destination Directory) as specified in the following
   table.
<P>
<PRE>    Column A  In column K, change this value     To this value
    ----------------------------------------------------------

    168       %d                                %148
    801       %d,%d\Office                      %148,%d\Office
    806       %s\Workdir,%d\Office              %148,%d\Office
    810       %d,%d\Office                      %148,%d\Office
    2098      %d,%d\Office                      %148,%d\Office
    2102      %d,%d\Office                      %148,%d\Office

</PRE><P><LI>Find the rows that contain 811 and 2099 in column A. For both rows,
   locate the string %s within the value in column F and change it to %148.
   The values in column F for each row should now read:
<P>
<P><PRE>    Column A  Column F
</PRE><P>
<PRE>    811       "LOCAL","Software\Microsoft\Office\8.0\Access\Wizards
              \Data Files", "Wizard Data File", "%148\wzdat80.mdt", ""
    2099      "LOCAL",
              "Software\Microsoft\Office\8.0\Access\Wizards\Replication
              Conflicts", "Path", "%148\Wzcnf80.mda", ""

</PRE></OL>If you make no other changes, Setup installs the wizard files on users'
hard drives in the Program Files\Microsoft Office\Office folder. If you
want to change the destination for the wizard files to some other shared
Windows NT Server folder, such as a user's home directory, find the row
that begins with 148 in column A and change the value in column K using the
following format:
<P>
<PRE>   driveletter:\foldername\

</PRE>For example, to create a Workdir folder in the shared network folder mapped
to the user's H drive, enter H:\Workdir\. For this to work, every user who
runs Setup using the modified STF file must have drive H mapped to a shared
folder on the network and must have Change permissions for that folder.
<P>
Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
<P><h3>To modify the administrative installation point for Microsoft Access 97</h3>
 
<P><h3>to install Microsoft Access wizards on users' hard drives</h3>
 

<OL><P><LI>Open Acc97pro.stf in Microsoft Excel as described earlier in this paper
   in the procedure "To open an STF file using Microsoft Excel."

<P><LI>Scroll down to the rows that contain 25 and 29 in column A. In column F
   (Object Data ), change the value 75 to 76 for both rows. The value in
   column F of both rows should now read:
<P>
<P><PRE>      31 130 51 48 76 78
</PRE>
<P><LI>Scroll down to the row that contain 48 in column A. In column F, delete
   the value 54. The value in column F should now read:
<P>
<P><PRE>      53 57 3411 333 50 59
</PRE>
<P><LI>Find the rows with the following values in column A and change the
   values in column K (Destination Directory) as specified in the following
   table.
<P>
<PRE>    Column A  In column K, change this value      To this value
    -----------------------------------------------------------

    96        %d                                  %76
    397       %d,%d\Office                        %76,%d\Office
    406       %d,%d\Office                        %76,%d\Office
    407       %406                                %76
    595       %d,%d\Office                        %76,%d\Office
    599       %d,%d\Office                        %76,%d\Office

</PRE><P><LI>Find the row that contains 407 in column A. Locate the string %s within
   the value in column F and change it to %76. The value in column should
   now read:
<P>
<P><PRE>      "LOCAL", "Software\Microsoft\Office\8.0\Access\Wizards\Data Files",
      "Wizard Data File", "%76\wzdat80.mdt", ""
</PRE><P>
</OL>If you make no other changes, Setup installs the wizard files on users'
hard drives in the Program Files\Microsoft Office\Office folder. If you
want to change the destination for the wizard files to some other shared
Windows NT Server folder, such as a user's home directory, find the row
that contains 76 in column A and change the value in column K using the
following format:
<P>
<PRE>   driveletter:\foldername\

</PRE></OL>For example, to create a Workdir folder in the shared network folder mapped
to the user's H drive, enter H:\Workdir\. For this to work, every user who
runs Setup using the modified STF file must have drive H mapped to a shared
folder on the network and must have Change permissions for that folder.
<P>
Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
<P><h3>Sharing the Same Workgroup Information File</h3>
 
<P>
The changes described in the previous section copy only Microsoft Access
wizard files to users' hard drives. The workgroup information file,
System.mdw, remains in the Workdir folder on the network server and is
shared by all users who run Microsoft Access from network. This arrangement
works as long as all users running Microsoft Access from the network have
at least read permissions and have the same level of security permissions
for the Workdir folder.
<P>
If a user needs to add or modify Microsoft Access user-level security
account information (which is stored in the System.mdw file), that user
must log on with at least Change permissions. However, if a user logs on
with Change permissions or higher while other users have only Read or Add &amp;
Read permissions, problems can occur. For example, if a user with Change
permissions starts Microsoft Access when no other users are running
Microsoft Access, the System.mdw file is opened for exclusive access, and
no other users can open the file or start Microsoft Access. You can avoid
this problem any of four ways:

<UL><LI>If no users need to make changes to user-level security account
   information, make sure all users who run Microsoft Access from the
   network have the same level of permissions in the Workdir folder.

<LI>If one user needs to change user-level security account information,
   have that user log on using an account that has Change permissions in
   the Workdir folder and then exit Microsoft Access as soon as the changes
   are finished.

<LI>Alternatively, if a user needs to change user-level security account
   information, have that user use the Workgroup Administrator or the
   /wrkgrp command-line option to specify a copy of the System.mdw in a
   different folder. After making changes to that System.mdw, the user can
   copy the modified file back into the Workdir folder after all other
   users have exited Microsoft Access.

<LI>You can modify the STF and INF files before users install Office 97 or
   Microsoft Access 97 so that Setup installs a copy of System.mdw in the
   Program Files\Microsoft Office\Office folder on users' hard drives
   during Run from Network Server installations, as described in the
   following procedures. In this scenario, if a user needs to change user-
   level security account information after Office 97 or Microsoft Access
   97 has been installed, that user must distribute copies of the updated
   System.mdw file for other users to copy to their hard drives.
<P>
</UL>NOTE: The following instructions assume that you have already modified the
STF file to copy wizard files locally, as described earlier in this paper.
<P>
<P><h3>To modify the administrative installation point for Office 97 to Install</h3>
 
<P><h3>System.mdw on users' hard drives</h3>
 

<OL><P><LI>Open Off97pro.stf in Microsoft Excel as described earlier in this paper
   in the procedure "To open an STF file using Microsoft Excel."

<P><LI>Scroll down to the row that contains 148 in column A. Add 561 to the end
   of the value in column F. The value in column F should now read:
<P>
<P><PRE>      808 2097 2101 797 170 561
</PRE>
<P><LI>Scroll down to row that contains 561 in column A. In column E (Object
   Type), change the value from CustomAction to CopyFile. In column F,
   change the value from "msacccah.dll, SyncEXECalloutCAH,
   %s\OS\System\wrkgadm.exe /sil %s\Workdir\system.mdw" to User Files,
   system_mdw. The beginning of this row should now read:
<P>
<PRE>      561        CopyFile User Files, system_mdw

</PRE><P><LI>Also, in the row that contains 561 in column A, add %148 in column K.

<P><LI>Scroll down to the rows that contain the values 2124 and 2143 in column
   A; change the value in column K for both rows to %148. The value in
   column K for both rows should now read:
<P>
<P><PRE>      %148
</PRE>
<P><LI>Also, in the row that contains 2143 in column A; delete workdir\ from
   the value in column F. The value in column F should now read:
<P>
<P><PRE>      "LOCAL", "Software\Microsoft\Office\8.0\Access\Jet\3.5\Engines",
      "SystemDB", "%s\system.mdw", ""
</PRE><P>
</OL>Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
The Off97pro.inf file also needs to be modified.
<P>
<P><h3>To modify the Off97pro.inf file</h3>
 

<OL><P><LI>Make a backup of the Off97pro.inf file.

<P><LI>Open the file in WordPad or another text editor that does not alter tabs
   and spaces.

<P><LI>Search for system.mdw and insert Workdir\ in front of system.mdw. The
   line should now read:
<P>
<P><PRE>       "system_mdw"= 1,Workdir\System.mdw,,,,,,,,,,,,,,,,,,,
</PRE><P>
</OL>Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
<P><h3>To modify the administrative installation point for Microsoft Access 97</h3>
 
<P><h3>to install System.mdw on users' hard drives</h3>
 

<OL><P><LI>Open Acc97.stf in Microsoft Excel as described earlier in this paper in
   the procedure "To open an STF file using Microsoft Excel."

<P><LI>Scroll down to the rows that contain the values 25 and 29 in column A.
   In column F, change the value 78 to 80 for both rows. The values in
   column F for both rows should now read:
<P>
<P><PRE>       31 130 51 48 76 80
</PRE>
<P><LI>Scroll down to the row that contains 76 in column A. Add 302 to the end
   of the value in column F. The value in column F should now read:
<P>
<P><PRE>      404 594 598 393 98 302
</PRE>
<P><LI>Scroll down to the row that contains 302 in column A. In column E
   (Object Type), change the value from CustomAction to CopyFile. In column
   F, change the value from "msacccah.dll, SyncEXECalloutCAH,
   %s\OS\System\wrkgadm.exe /sil %s\Workdir\system.mdw" to User Files,
   system_mdw. The beginning of this row should now read:
<P>
<PRE>       302        CopyFile User Files, system_mdw

</PRE><P><LI>Also, in the row that contains 302 in column A, add %76 in column K.
<P>

<P><LI>Scroll down to the rows that contain the values 2705 and 2726 in column
   A. Change the value in column K for both rows to %76. The value in
   column K for both rows should now read:
<P>
<P><PRE>       %76
</PRE>
<P><LI>Also, in the rows that contain 2705 and 2726 in column A, locate the
   string %s within the value in column F and change it to %76. The value
   in column F for both rows should now read:
<P>
<P><PRE>      "LOCAL", "Software\Microsoft\Office\8.0\Access\Wizards\Data Files",
      "Wizard Data File", "%76\wzdat80.mdt", ""
</PRE><P>
</OL>Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
The Acc97.inf file also needs to be modified.
<P>
<P><h3>To modify the Acc97.inf file</h3>
 

<OL><P><LI>Make a backup of the Acc97.inf file.

<P><LI>Open the file in WordPad or another text editor that does not alter tabs
   and spaces.

<P><LI>Search for system.mdw and insert Workdir\ in front of system.mdw. The
   line should now read:
<P>
<P><PRE>       "system_mdw"= 1,Workdir\System.mdw,,,,,,,,,,,,,,,,,,,
</PRE><P>
</OL>Do not change anything else in the file. Save the file with the changes you
made back to the MSOffice folder of the administrative installation point.
<P>
For more information about installing the wizards locally, please see the
following articles in the Microsoft Knowledge Base:
<P>
<PRE>          ARTICLE-ID: <B><A href="../access/q178331.htm">Q178331</A></B>
    TITLE     : How to Install Wizards Locally [OFF97 SR1 Network Install]

    ARTICLE-ID: <B><A href="../access/q178330.htm">Q178330</A></B>
    TITLE     : ACC97: How to Install Wizards Locally [Standalone Network
</PRE></OL>Setup]
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: inf<BR>
Keywords          : StpNet<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  February 16, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
