

<HTML>
<HEAD>
<TITLE>ACC97: Run-time error '2448' with BuildCriteria Method </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q178198">
<META NAME="KBModify" CONTENT="1997/12/17">
<META NAME="KBCreate" CONTENT="1997/12/16">
<META NAME="Keywords" CONTENT="kberrmsg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use the BuildCriteria method in Microsoft Access 97 to programmatically set the Filter property on a form, and the Field argument of the BuildCriteria method references ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAB4,QA7O,QA7N,QAUJ,QAPF,QBJZ,QBWS,QA1S,QDN9,QAUD,QAI2,QAH4,QATX,QAAP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Run-time error '2448' with BuildCriteria Method</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  December 17, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q178198</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use the BuildCriteria method in Microsoft Access 97 to
programmatically set the Filter property on a form, and the Field argument
of the BuildCriteria method references a field name that contains a space,
you may receive the following error message:
<P>
<PRE>   Run-time error '2448':
   You can't assign a value to this object.

</PRE><h2>CAUSE</h2>
 
<P>
The BuildCriteria method is used to generate a parsed criteria string as it
would appear in the Query by Example (QBE) grid or in Filter By Form mode.
Unlike the QBE grid or Filter By Form, however, the BuildCriteria method
does not automatically enclose the field name within brackets.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To resolve this behavior, enclose the Field argument of the BuildCriteria
method within brackets. For example, using the example from the "More
Information Section" below, the following expression
<P>
<PRE>   strFilter = BuildCriteria("Product Name", dbText, strInput)

</PRE>should be entered as follows:
<P>
<PRE>   strFilter = BuildCriteria("[Product Name]", dbText, strInput)

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open a new blank database.

<P><LI>From the sample database Northwind.mdb, import the Products table.

<P><LI>Open the Products table in Design view and change the field name
   "ProductName" to "Product Name" (without the quotation marks).

<P><LI>Close the table.
<P>
</OL><h3>Creating the Form</h3>
 

<OL><P><LI>On the Insert menu, click Form.

<P><LI>In the New Form dialog box, click Form Wizard, and then click OK.

<P><LI>In the Form Wizard, select Products in the Tables/Queries box, and
   then add all the fields from the Available Fields box to the Selected
   Fields box.

<P><LI>Click Finish to build the form.

<P><LI>Close the Form.
<P>
</OL><h3>Creating the Module</h3>
 

<OL><P><LI>On the Insert menu, click Module.

<P><LI>Add the following function to the module:
<P>
<P><PRE>    NOTE: In the following sample code, an underscore (_) is used as a
    line-continuation character.
</PRE><P>
<P><PRE>    '******************************************************************
    ' This procedure opens a form and applies a filter.
    '******************************************************************
</PRE><P>
<P><PRE>    Sub SetFilter()
      Dim frm As Form, strMsg As String
      Dim strInput As String, strFilter As String
</PRE><P>
<P><PRE>      ' Open Products form in Form view.
      DoCmd.OpenForm "Products"
</PRE><P>
<P><PRE>      ' Return Form object variable pointing to Products form.
      Set frm = Forms!Products
      strMsg = "Enter one or more letters of product name " &amp; _
      "followed by an asterisk."
</PRE><P>
<P><PRE>      ' Prompt user for input.
      strInput = InputBox(strMsg)
</PRE><P>
<P><PRE>      ' Build criteria string.
      strFilter = BuildCriteria("Product Name", dbText, strInput)
</PRE><P>
<P><PRE>      ' Set Filter property to apply filter.
      frm.Filter = strFilter
</PRE><P>
<P><PRE>      ' Set FilterOn property; form now shows filtered records.
      frm.FilterOn = True
</PRE><P>
<P><PRE>    End Sub
</PRE>
<P><LI>To test this procedure, type the following line in the Debug window,
   and then press ENTER:
<P>
<P><PRE>       SetFilter
</PRE><P>
   Note that the Products form is displayed, followed by an Input box
   requesting the search criteria.

<P><LI>Enter "A*" (without the quotation marks) and click OK.
<P>
   Note that you receive the error message:
<P>
<P><PRE>      Run-time error '2448':
      You can't assign a value to this object.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about using the BuildCriteria method, search the Help
index for "BuildCriteria" or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: error searching filtering<BR>
Keywords          : kberrmsg<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbprb<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  December 17, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
