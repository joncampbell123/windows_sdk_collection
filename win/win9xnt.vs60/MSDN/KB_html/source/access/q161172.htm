

<HTML>
<HEAD>
<TITLE>ACC97: How to Use IDC Files to Query a Secure MS Access Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q161172">
<META NAME="KBModify" CONTENT="1997/09/08">
<META NAME="KBCreate" CONTENT="1996/12/17">
<META NAME="Keywords" CONTENT="IntpOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  WARNING: Although this article discusses Microsoft Access security features, any information you send over the Internet with the techniques described in this article is sent...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QAAD,QBWS,QDN9,QBWA,QDKY,QAK7,QBVX,QABG,QAD7,QAWK,QA01,QANX,QAYY,QA9A P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: How to Use IDC Files to Query a Secure MS Access Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  September 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q161172</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
WARNING: Although this article discusses Microsoft Access security
features, any information you send over the Internet with the techniques
described in this article is sent unencrypted. To send encrypted
information over the Internet, you must use a protocol that sends client
certificates, such as Secure Sockets Layer (SSL). Note that client
certificates cannot be used on Personal Web Server for Windows 95. ANY USE
BY YOU OF THE METHODS PROVIDED IN THIS ARTICLE IS AT YOUR OWN RISK.
Microsoft provides this sample "as is" without warranty of any kind, either
express or implied, including but not limited to the implied warranties of
merchantability and/or fitness for a particular purpose.
<P>
This article describes a technique you can use to create Internet Database
Connector (IDC) files that allow you to type a username and password in an
HTML form in order to query a secure Microsoft Access database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
There are three main steps to use IDC files to query a secure Microsoft
Access database:

<UL><LI>Use ODBC Administrator to create a System DSN that points to the
   workgroup information file (System.mdw) you use with your secured
   database.

<LI>Create an HTML form that requests a username and password. The HTML form
   passes the values to parameters in your IDC file.

<LI>Modify the IDC file to use the username and password parameters to
   authenticate user access to your database.
<P>
</UL>You must use an HTML form to enter the username and password, and then pass
that information to the IDC files. You cannot configure Microsoft Internet
Information Server (IIS) Basic Authentication or NT Challenge/Response to
achieve this functionality because those IIS options authenticate users
against Microsoft Windows NT permissions, not Microsoft Access security
accounts. It is possible to use Basic Authentication and NT
Challenge/Response with Microsoft SQL Server databases because SQL Server
can be integrated with NT Security. Microsoft Access security does not
provide that capability.
<P>
This example contains the following sections:

<UL><LI>Creating a Secure Copy of Northwind.mdb
<LI>Creating a System DSN for a Secure Microsoft Access Database
<LI>Creating the HTX/IDC Files and the HTML Logon Form
<LI>Customizing the IDC Files
<LI>Testing the Query
<P>
</UL><h3>Creating a Secure Copy of Northwind.mdb</h3>
 
<P>
<PRE>  1. Copy the sample database Northwind.mdb to C:\My
     Documents\Northwind2.mdb.

  2. Start the Workgroup Administrator by executing the Wrkgadm.exe file.
     The file is installed to your Windows\System folder by default. You
     can find a shortcut to this file in the C:\Program Files\Microsoft
     Office folder.

  3. In the Workgroup Administrator dialog box, click Create.

  4. In the Workgroup Owner Information dialog box type the following
     information, and then click OK:

        Name:  &lt;Your name&gt;
        Organization: Northwind Traders
        Workgroup ID: 1234

  5. In the Workgroup Information File dialog box, make a note of the path
     and file name that appears in the Database box so you can rejoin that
     workgroup file when you are finished. Then type C:\My
     Documents\Northwind2.mdw, and click OK.

  6. In the Confirm Workgroup Information dialog box, verify that the
     information is correct, and then click OK.

  7. Click OK when you see the message that you have successfully created
     the workgroup file, and then click Exit in the Workgroup Administrator
     dialog box.

  8. Start Microsoft Access and open C:\My Documents\Northwind2.mdb.

  9. On the Tools menu, point to Security, and then click User And Group
     Accounts.

 10. Click the Change Logon Password tab, and type Admin in the New
     Password and Verify boxes. Click OK.

 11. Quit Microsoft Access.

 12. Copy the Northwind2.mdb and Northwind2.mdw files to a folder on your
     Web Server computer, or to a network location that you can access from
     your Web Server computer. Be sure to retain a copy of Northwind2.mdb
     on your local drive for use later in this example.

     At this point, you can rejoin your original workgroup information
     file.

 13. Start the Workgroup Administrator program following the procedure in
     step 2 of this section.

 14. Click the Join button.

 15. In the Workgroup Information File dialog box, type the path and file
     name of the system database that you noted in step 5, and then click
     OK.

 16. Click OK when you receive the message that you have successfully
     joined the workgroup, and then click Exit in the Workgroup
     Administrator dialog box.

</PRE><h3>Creating a System DSN for a Secure Microsoft Access Database</h3>
 

<OL><P><LI>Double-click the ODBC icon in Control Panel on your Web Server.

<P><LI>In the ODBC Data Source Administrator dialog box, click the System DSN
    tab.

<P><LI>Click the Add button.

<P><LI>Select Microsoft Access Driver, and then click Finish.
<P>
    NOTE: If the Microsoft Access Driver does not appear, it is not
    installed on your Web server. For information about installing the
    driver on your Web server, search the Help Index for "Microsoft Access
    Desktop driver," or ask the Microsoft Access 97 Office Assistant.

<P><LI>In the ODBC Microsoft Access 97 Setup dialog box, type NorthwindIDC in
    the Data Source Name box.

<P><LI>Click the Select button and browse to select Northwind2.mdb. Click OK.

<P><LI>In the System Database box, click Database, and then click the System
    Database button. Browse to select Northwind2.mdw, and then click OK.

<P><LI>Note that you have the option to click the Advanced button in the ODBC
    Microsoft Access 97 Setup dialog box, and set a default Login name and
    Password for the System DSN. Any of your IDC files that do not provide
    a username and password will use the default settings.

<P><LI>Click OK to close the ODBC Microsoft Access 97 Setup dialog box.

<P><LI>Click OK to close the ODBC Data Source Administrator dialog box.
<P>
</OL><h3>Creating the HTX/IDC Files and the HTML Logon Form</h3>
 
<P>
In this section, you create a query with username and password parameters,
and then export the query to HTX/IDC format. When you create IDC files from
a parameter query, Microsoft Access automatically creates an HTML form for
entering the parameters. This is an easy way to create the HTML form you
need to collect the username and password information. However, you do not
have to use this technique to create the HTML form; you can use Notepad or
another tool, such as Microsoft Front Page 97, to create your own HTML
Logon form.
<P>
<PRE>  1. Start Microsoft Access.

  2. Open Northwind2.mdb.

  3. Create a new query called SecureIDC based on the Customers table:

        Query: SecureIDC
        ----------------
        Type: Select Query

        Field: CustomerID
        Table: Customers

  4. On the Query menu, click Parameters.

  5. Type the following in the Query Parameters dialog box, and then click
     OK.

        Parameter          Data Type
        ----------------------------
        [UserParam]        Text
        [PassParam]        Text

  6. Save the SecureIDC query and close it.

  7. Select the SecureIDC query in the Database window, and then click Save
     As/Export on the File menu.

  8. In the Save As dialog box, click "To an External File or Database,"
     and then click OK.

  9. In the "Save Query 'SecureIDC' In" dialog box, select Microsoft IIS
     1-2 (*.htx;*.idc) in the Save As Type box, and type SecureIDC.htx in
     the File Name box. Click Export.

 10. In the HTX/IDC Output Options dialog box, type NorthwindIDC in the
     Data Source Name box, and then click OK.

 11. Click OK in each of the two Enter Parameter Value dialog boxes that
     appear.

 12. The HTX/IDC output creates three files: SecureIDC.HTML, SecureIDC.htx
     and SecureIDC.IDC

</PRE></OL><h3>Customizing the IDC Files</h3>
 
<P>
NOTE: This section contains information about editing IDC and HTML files,
and assumes that you are familiar with editing HTML files. Microsoft
Technical Support engineers do not support customization of any HTML, HTX,
IDC, or ASP files.

<OL><P><LI>Use Notepad or another text editor to open the SecureIDC.IDC file. The
   Password and Username fields show nothing entered next to them by
   default. You must add the parameters that will hold the values from the
   HTML Logon form. Change the SecureIDC.IDC file so it looks as follows:
<P>
<P><PRE>      Datasource: NorthwindIDC
      Template:SecureIDC.htx
      Username:%[UserParam]%
      Password:%[PassParam]%
      SQLStatement:SELECT Customers.CustomerID
      +FROM Customers;
</PRE>
<P><LI>Save the SecureIDC.IDC file and close it.

<P><LI>Use Notepad or another text editor to open the SecureIDC.HTML file. By
   default, the HTML form uses the GET method to submit its data. GET
   variables appear in the address box of Web browsers. Therefore, you
   must change the GET method to the POST method if you do not want your
   password to be visible in the address box of your Web browser. Locate
   the following line in the SecureIDC.HTML file
<P>
<P><PRE>      &lt;FORM METHOD="GET" ACTION="SecureIDC.IDC"&gt;
</PRE><P>
   and change it to:
<P>
<P><PRE>      &lt;FORM METHOD="POST" ACTION="SecureIDC.IDC"&gt;
</PRE>
<P><LI>Text boxes use an Input Type setting of Text by default. In order to
   prevent your password from being visible in the text box on your form,
   you must change the Input Type to Password. Locate the following line
   in the SecureIDC.HTML file
<P>
<P><PRE>      [PassParam] &lt;INPUT TYPE="Text" NAME="[PassParam]"&gt;&lt;P&gt;
</PRE><P>
   and change it to:
<P>
<P><PRE>      [PassParam] &lt;INPUT TYPE="Password" NAME="[PassParam]"&gt;&lt;P&gt;
</PRE>
<P><LI>Save the SecureIDC.HTML file and close it.

<P><LI>Copy SecureIDC.HTML, SecureIDC.htx and SecureIDC.IDC to a folder on
   your Web Server computer where you have both Read and Execute
   permission.
<P>
</OL>For more information about configuring Microsoft Internet Information
Server (IIS) permissions, please refer to the IIS Help Index, and see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q160754.htm">Q160754</A></B>
   TITLE     : ACC97: Error "HTTP/1.0 403 Access Forbidden" Browsing IDC
               Page

</PRE></OL><h3>Testing the Query</h3>
 

<OL><P><LI>Start Microsoft Internet Explorer 3.0, or another Web browser program.

<P><LI>Type the Uniform Resource Locator (URL) in the address box of your Web
   browser to view SecureIDC.HTML. For example, if you saved your IDC
   files in a folder called Test in the wwwroot folder of your Web Server,
   type:
<P>
<P><PRE>      <B>http://&lt;servername&gt;/test/SecureIDC.HTML</B>
</PRE><P>
   Note that the URL depends upon where your files are located on the Web
   Server.

<P><LI>The SecureIDC.HTML form opens in your Web browser with a [UserParam]
   box, a [PassParam] box, and a Run Query button. Type Admin in both
   boxes, and then click the Run Query button. The SecureIDC.IDC file
   opens and displays a list of CustomerIDs.
<P>
   NOTE: If you type an incorrect username or password, you receive the
   following error:
<P>
<P><PRE>      Error Performing Query
      Not a valid account name or password.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about how to create and modify the optional fields in
IDC files, please refer to your Microsoft IIS online documentation.
<P>
For more information about IIS authentication, security, and Secure Sockets
Layer (SSL), please refer to your IIS online documentation, or see the
following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../iis/q142868.htm">Q142868</A></B>
   TITLE     : IIS: Authentication &amp; Security Features

</PRE></OL>For more information about Microsoft Access security, search the Help Index
for "security, overview," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: internet intranet<BR>
Keywords          : IntpOthr kbusage<BR>
Version           : 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  September 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
