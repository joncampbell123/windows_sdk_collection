

<HTML>
<HEAD>
<TITLE>ACC2: Use NotInList Event to Add a Record to a Combo Box </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q125648">
<META NAME="KBModify" CONTENT="1997/05/08">
<META NAME="KBCreate" CONTENT="1995/02/01">
<META NAME="Keywords" CONTENT="FmsCmbo kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article demonstrates two methods of using the NotInList event to add a new record to a combo box.  This article assumes that you are familiar with Access Basic and with crea...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QA5V,QA1S,QDN9,QAO4,QA5F,QAMA,QAPF,QBXS,QAFF,QAGU,QBWS,QAUJ,QDKY,QAZV V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Use NotInList Event to Add a Record to a Combo Box</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 8, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q125648</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article demonstrates two methods of using the NotInList event to add
a new record to a combo box.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following examples use the Orders form in the sample database NWIND.MDB
to demonstrate two methods of using the NotInList event to add a record to
a combo box. The first method uses Access Basic code to add a new record
directly to the Customers table when you enter a unique value in the Bill
To combo box on the Orders form. The second method opens the Customers form
when you enter a unique value in the Bill To combo box so that you can add
the new customer information yourself before continuing.
<P>
CAUTION: Following the steps in these examples will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.
<P>
<P><h3>Method 1: Using Access Basic Code to Add a Record Directly to a Table</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB, and then open the Orders form
   in Design view.

<P><LI>Note that the Bill To combo box's LimitToList property is set to Yes.
   Set the Bill To combo box's OnNotInList property to the following
   event procedure:
<P>
<PRE>      Sub Customer_ID_NotInList (NewData As String, Response As Integer)
         Dim DB As Database
         Dim RS As Recordset
         Dim Msg As String
         Dim CR As String: CR = Chr$(13)

         ' Exit Sub if the user cleared the selection.
         If NewData = "" Then Exit Sub

         ' Ask if the user wants to add the new customer.
         Msg = "'" &amp; NewData &amp; "' is not in the list." &amp; CR &amp; CR
         Msg = Msg &amp; "Do you want to add it?"
         If MsgBox(Msg, 32 + 4) = 7 Then
            ' If the user chooses No, instruct the user to try again.
            Response = DATA_ERRCONTINUE
            MsgBox "Please try again."
         Else
            ' If the user does not choose No, create a new record in the
            ' Customer table.
            On Error Resume Next

            ' Open the Customer table.
            Set DB = DBEngine.Workspaces(0).Databases(0)
            Set RS = DB.OpenRecordset("Customers", DB_OPEN_DYNASET)

            RS.AddNew
               Msg = "Please enter a unique 5-character Customer ID."
               RS![Customer ID] = InputBox(Msg)
               RS![Company Name] = NewData
            RS.Update

            ' If an error occurred while adding the record...
            If Err Then
               ' ...instruct the user to try again.
               Response = DATA_ERRCONTINUE
               Beep: MsgBox Error$, 48
               MsgBox "Please try again."
            Else
               ' If no error occurred, add the element to the combo box
               ' list.
               Response = DATA_ERRADDED
            End If

         End If
      End Sub

</PRE></OL><h3>Method 2: Using a Form to Add a New Combo Box Record</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB, and then open the Orders form
   in Design view.

<P><LI>Note that the Bill To combo box's LimitToList property is set to Yes.
   Set the Bill To combo box's OnNotInList property to the following
   event procedure:
<P>
<PRE>      Sub Customer_ID_NotInList (NewData As String, Response As Integer)
         Dim Result
         Dim Msg As String
         Dim CR As String: CR = Chr$(13)

         ' If the user cleared the selection, exit now.
         If NewData = "" Then Exit Sub

         ' Ask if the new customer should be added.
         Msg = "'" &amp; NewData &amp; "' is not in the list." &amp; CR &amp; CR
         Msg = Msg &amp; "Do you want to add it?"
         If MsgBox(Msg, 32 + 4) = 6 Then
            ' If Yes, launch the Customers form in data entry
            ' .. mode as a DIALOG form, passing the unique company name
            ' .. in the NewData variable as an argument to be used as
            ' .. the default company name in the new Customer record.
            DoCmd OpenForm "Customers", , , , A_ADD, A_DIALOG, NewData
         End If

         ' See if the user created the customer...
         Result = DLookup("[Company Name]", "Customers", _
                  "[Company Name]=""" &amp; NewData &amp; """")
         If IsNull(Result) Then
            ' ... if not then instruct the user to try again...
            Response = DATA_ERRCONTINUE
            MsgBox "Please try again!"
         Else
            ' ... otherwise, add the element to the combo list.
            Response = DATA_ERRADDED
         End If
      End Sub

</PRE><P><LI>Save and then close the Orders form.

<P><LI>Open the Customers form in Design view.

<P><LI>Set the form's OnLoad property to the following event procedure:
<P>
<PRE>      Sub Form_Load ()
         ' If OpenArgs is not null (contains a new company name)...
         If IsNull(Me.OpenArgs) = False Then
            ' ...use the contents as the Company Name field.
            Me![Company Name] = Me.OpenArgs
         End If
      End Sub

</PRE><P><LI>Save and then close the Customers form.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the NotInList event, search for "NotInList,"
and then "NotInList Event" using the Microsoft Access Help menu.
<P>
For more information about the LimitToList property, search for
"LimitToList," and then "LimitToList Property" using the Microsoft Access
Help menu.
<P>
You can find information, instructions, and examples in the Solutions
sample application (SOLUTION.MDB) included with Microsoft Access version
2.0. For more information about using the NotInList event, open the
SOLUTION.MDB database usually located in the ACCESS\SAMPAPPS directory. In
the Select A Category Of Examples box, select "Get more mileage from combo
boxes, list boxes, subforms, and subreports." In the Select An Example box,
select "Add a new record to a list."
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsCmbo kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 8, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
