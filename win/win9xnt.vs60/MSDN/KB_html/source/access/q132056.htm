

<HTML>
<HEAD>
<TITLE>ACC: How to Create a Top Values Per Group Report </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q132056">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1995/06/27">
<META NAME="Keywords" CONTENT="RptOthr kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  This article demonstrates how you can create a report that ranks a specific number of records for each group in order according to a top value, for example, the top five se...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QA1S,QABO,QDN9,QBDM,QA5V,QAPF,QAPN,QBJZ,QAWH,QAWI,QAUR,QAKD,QBWS P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Create a Top Values Per Group Report</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q132056</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
This article demonstrates how you can create a report that ranks a specific
number of records for each group in order according to a top value, for
example, the top five selling products per category.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Access has a TopValues property that you can use in a query to
return a specific number (N) or a specified percentage (N%) of records.
Using a main/sub report with a query that has a value set for its TopValues
property, you can create a report listing the top N records for each group.
<P>
To create a top values per group report, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in version 2.0).

<P><LI>Create a new, blank report based on the Categories table, and open it
    in Design view.

<P><LI>If the field list is not displayed, on the View menu, click Field List,
    and drag the CategoryId and CategoryName fields from the field list to
    the report's detail section. Close and save report as Top_N_Per_Group.
<P>
    NOTE: In version 2.0, there is a space in the Category ID and Category
    Name fields.

<P><LI>Create a new query based on the Order Details and Products tables as
    follows:
<P>
       Query: Top_N_Products
       ----------------------------------------------------------
<P>
<PRE>          Type: Select Query
          Join: Order Details.[ProductID] &lt;-&gt; Products.[ProductID]
          TopValues: 5

          NOTE: In version 2.0, type a space in the Product ID field.

          Field: CategoryID
          Table: Products
          Total: Group By
          Criteria: [Reports]![Top_N_Per_Group]![CategoryID]

          NOTE: In version 2.0, type a space in the Category ID field.

          Field: ProductName
          Table: Products
          Total: Group By

          NOTE: In version 2.0, there is a space in the Product Name field.

          Field: SaleAmount: Sum([Order Details].[UnitPrice]*[Quantity])
          Total: Expression
          Sort: Descending

          NOTE: In version 2.0, type a space in the Unit Price field.

          NOTE: Referencing the CategoryID from the Top_N_Per_Group report
          as criteria ensures that this query filters records by CategoryID
          before it applies the TopValues property to the recordset.

</PRE><P><LI>Close and save the query as Top_N_Products.

<P><LI>Create a new, blank report based on the Top_N_Products query.

<P><LI>If it is not displayed, on the View menu, click Field List and drag
    the ProductName and SaleAmount fields from the field list to the
    report's detail section. Close and save the report as Top_N_Sub.
<P>
    NOTE: In version 2.0, there is a space in the Product Name and Sale
    Amount fields.

<P><LI>Open the Top_N_Per_Group report in Design view.

<P><LI>With the report open in Design view, press the F11 key to switch to
    the Database window.

<P><LI>From the Database window, drag the Top_N_Sub report to the detail
    section of the Top_N_Per_Group report.

<P><LI>Click the Top_N_Sub report and open its property sheet.

<P><LI>Delete CategoryID from the LinkChild and LinkMaster properties.

<P><LI>Preview the report. Note that the Top_N_Sub subreport displays
    the top five selling products for each category.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the TopValues property, search the Help Index
for "TopValues Property," or ask the Microsoft Access 97 Office Assistant.
 
<PRE>Keywords          : RptOthr kbusage
Version           : 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
