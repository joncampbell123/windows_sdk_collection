

<HTML>
<HEAD>
<TITLE>ACC: Query By Form Returns No Rows When All Rows Expected </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q94027 ">
<META NAME="KBModify" CONTENT="1997/04/23">
<META NAME="KBCreate" CONTENT="1992/12/22">
<META NAME="Keywords" CONTENT="kbusage QryOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you specify criteria for a query in a previously designed form, you leave one of the fields on the form blank because you want to view all the records, not just the ones tha...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAUD,QAY5,QA5V,QA7O,QAPF,QA1S,QBV8,QAB9,QA7N,QAPN,QALW,QDN9,QAI2,QAJQ,QAI4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Query By Form Returns No Rows When All Rows Expected</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q94027 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you specify criteria for a query in a previously designed form, you
leave one of the fields on the form blank because you want to view all the
records, not just the ones that match a certain value. But instead of
getting all the records, as you expected, you get none at all.
<P>
<P><h2>CAUSE</h2>
 
<P>
Queries that contain empty criteria fields may return unexpected results
because an empty criteria field results in the following condition in the
WHERE clause:
<P>
<PRE>   Like Null

</PRE>This condition is always false because any operation that includes a null
value returns a null result.
<P>
Queries can reference form fields through implicit parameters--making a
query by form. For example, an application developer might put the
following criteria on the CustomerName field in a query:
<P>
<PRE>   Like Forms!CriteriaDialog!CustomerName

</PRE>CriteriaDialog is a form that holds the criteria fields. Someone using the
application might omit a customer name entry in the CriteriaDialog form in
the hopes of seeing all the rows. However, the query actually returns no
rows because of the null reference in the resulting WHERE clause.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Application developers can work around this potential problem by adding the
following function to a module:
<P>
<PRE>   Function CNulls (v As Variant, subs As Variant) As Variant
      If (IsNull(v)) Then
         CNulls = subs
      Else
         CNulls = v
      End If
   End Function

</PRE>The CNulls() function converts null values to a given value. Essentially,
if the first argument to the function is null, the second argument is
returned. Otherwise, the first argument is returned unchanged.
<P>
After you add the function to a module, change the criteria to read
as follows:
<P>
<PRE>   Like CNulls( Forms!CriteriaDialog!CustomerName, "*"  )

</PRE>Now, if the user does not supply a customer name, the CNulls() function
will return the asterisk, and the condition will return all rows that
contain data.
<P>
<P><h3>Alternative Solutions for Microsoft Access 7.0 and 97</h3>
 
<P>
In Microsoft Access 7.0 and 97, you can replace the CNulls() function
described above with the NZ() built-in function. The NZ() function accepts
the same arguments as the CNulls() function. For more information about the
NZ()function, search the Help Index for "Nz function."
<P>
-or-
<P>
Microsoft Access 7.0 and 97 include a feature called Filter by Form. You
can use this feature to filter the current form based on criteria entered
by the user. When Filter by Form is invoked, a blank copy of the form is
displayed for entering criteria. You just leave the fields blank that you
do not wish to put criteria on and those fields are ignored when the filter
is applied. For more information about Filter by Form, search the Help
Index for "Filter by Form."
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about using the Query By Form technique, please see
the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q95931.htm">Q95931</A></B>
   TITLE     : ACC: How to Use the Query by Form (QBF) Technique
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: handling nulls as param<BR>
Keywords            : kbusage QryOthr<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
