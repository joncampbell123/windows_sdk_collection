

<HTML>
<HEAD>
<TITLE>ACC97: One Linked Table Opened Read-Only Makes All Read-Only </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q172160">
<META NAME="KBModify" CONTENT="1997/11/11">
<META NAME="KBCreate" CONTENT="1997/07/30">
<META NAME="Keywords" CONTENT="MdlDao kbprg">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you open a linked table as read-only with the OpenRecordset method in code, all linked tables in that database are read-only until the recordset is closed.  RESOLUTION  You ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA1S,QBWS,QAZV,QDKY,QAE2,QDN9,QARA,QAY2,QARR,QAY5,QBXS,QANF,QAIB,QBDM P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: One Linked Table Opened Read-Only Makes All Read-Only</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  November 11, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q172160</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you open a linked table as read-only with the OpenRecordset method in
code, all linked tables in that database are read-only until the recordset
is closed.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can either open linked tables read-write instead of read-only, or
you can create a global recordset variable and run the following code when
the database opens:
<P>
<PRE>   Dim rsGlobal As Recordset

   Function InitializeLinkTables()

      Dim mydb As Database
      Set mydb = CurrentDb
      Set rsGlobal = mydb.OpenRecordset("select * from Shippers")

   End Function

</PRE><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
<P>
This problem no longer occurs in Microsoft Jet Database Engine version
3.51, which is available from the Microsoft Software Library.
<P>
For information on how to obtain Microsoft Jet Database Engine 3.51, please
see the following article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q172733.htm">Q172733</A></B>
   TITLE     : ACC97: Updated Version of Microsoft Jet 3.5 Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
When you open a recordset against a linked table, Microsoft Access caches a
Table object with the properties of the first linked table you specify.
When you open additional linked tables, they are opened with the cached
information. If the first linked table is opened as read-only, all
additional linked tables opened are opened as read-only.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 
<P>
NOTE: There may be other steps that exhibit this behavior. The following
steps outline just one known way of duplicating this problem.

<OL><P><LI>Create a new database.

<P><LI>Create a linked table to the Suppliers table in the sample database
   Northwind.mdb.

<P><LI>Create a linked table to the Shippers table in the sample database
   Northwind.mdb.

<P><LI>Add the following code to a new module:
<P>
<P><PRE>      Function TestReadOnly()
</PRE><P>
<PRE>         Dim dbTest As Database
         Dim rsTest As Recordset
         Set dbTest = CurrentDb
         Set rsTest = dbTest.OpenRecordset("Select * From Shippers", _
                      dbOpenDynaset, dbReadOnly)
         Stop
         rsTest.Close

      End Function

</PRE><P><LI>Open the Debug window, type the following line, and then press ENTER:
<P>
<P><PRE>      ?TestReadOnly
</PRE><P>
   NOTE: The code will pause on the Stop line in the code.

<P><LI>From the Database window, open the Shippers table and note that you
   cannot modify any data as expected.

<P><LI>From the Database window, open the Suppliers table and try to change the
   Company Name of any supplier.
<P>
   RESULT: The Suppliers table is read-only as described in the "Symptoms"
   section.

<P><LI>Return to the Module window and press F5 to resume running the code.

<P><LI>From the Database window, open the Suppliers table and try to change the
   Company Name of any supplier.
<P>
   RESULT: You can now modify data appropriately.
</OL> 
<PRE>Keywords          : MdlDao kbprg
Version           : WINDOWS:97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbbug kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  November 11, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
