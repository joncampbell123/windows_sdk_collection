

<HTML>
<HEAD>
<TITLE>ACC97: Error Running Update Query in Converted Database </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q163054">
<META NAME="KBModify" CONTENT="1997/05/21">
<META NAME="KBCreate" CONTENT="1997/01/31">
<META NAME="Keywords" CONTENT="CnvProb kbusage QryUpdat">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you run an update query in a database which has been converted to Microsoft Access 97, you may receive the following error message:     Operation must use an updatable query...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QA1S,QAC1,QBD2,QBWS,QACF,QDN9,QAB4,QA5V,QAZV,QAA5,QAGB,QAAP,QADK,QDIX P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Error Running Update Query in Converted Database</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 21, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q163054</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you run an update query in a database which has been converted to
Microsoft Access 97, you may receive the following error message:
<P>
<PRE>   Operation must use an updatable query.

</PRE>This occurs even if the update query ran without the error in Microsoft
Access 7.0 or earlier.
<P>
<P><h2>CAUSE</h2>
 
<P>
The update query is based on a select query. In Microsoft Access 7.0 or
earlier, a select query returns only unique records by default; the SQL
statement that defines the query contains the predicate DISTINCTROW.
However, a select query in Microsoft Access 97 does not contain
DISTINCTROW by default, and all records are returned, even if an entire
record is a duplicate of another record in the query results.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Open the update query in SQL view and remove the word "DISTINCTROW" from
the SQL statement. Then run the update query again.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a new database called TstUpdt.mdb in Microsoft Access 7.0 or
   earlier.

<P><LI>Import the Customers table, the Orders table, and the Order Details
   table from the sample database Northwind.mdb (or NWIND.MDB in version
   2.0) into the new database.

<P><LI>Create a new query in Design view based on the Customers, Orders, and
   Order Details tables.
<P>
   NOTE: In the following query, [CustomerID], [OrderID], [ContactName],
   and [EmployeeID] each contain a space in version 2.0.
<P>
<P><PRE>       Query: qryOrderInfo
       ----------------------------------------------------
       Type: Select Query
       Join: Customers.[CustomerID] &lt;-&gt; Orders.[CustomerID]
       Join: Orders.[OrderID] &lt;-&gt; [Order Details].[OrderID]
</PRE><P>
<P><PRE>       Field: ContactName
<PRE></PRE>          Table: Customers
       Field: EmployeeID
          Table: Orders
          Criteria: 2
       Field: Quantity
          Table: Order Details

</PRE><P><LI>Save the qryOrderInfo query and close it.

<P><LI>Create a new update query in Design view based on the qryOrderInfo
   query.
<P>
   NOTE: In the following query, [ContactName] contains a space in
   version 2.0.
<P>
<P><PRE>       Query: qryUpdateOrder
       ----------------------
       Type: Update Query
</PRE><P>
<P><PRE>       Field: ContactName
<PRE></PRE>          Table: qryOrderInfo
          Update To: "XXX"
       Field: Quantity
          Table: qryOrderInfo
          Update To: 33

</PRE><P><LI>Run the query. You will see a message indicating the number of rows
   that will be updated; click No (or Cancel in version 2.0) to cancel
   the update.

<P><LI>Save the qryUpdateOrder query and close the database.

<P><LI>Start Microsoft Access 97 and open TstUpdt.mdb. Convert the database
   when prompted.

<P><LI>Run the qryUpdateOrder query. When you receive the alert that you are
   about to run an Update query that will modify data in your table,
   click Yes. Note that you receive the error message:
<P>
<P><PRE>       Operation must use an updatable query.
</PRE><P>
<P><PRE>    To resolve the error, continue with the following steps.
</PRE>
<P><LI>Open the qryUpdateOrder query in Design view.

<P><LI>On the View menu, click SQL View.

<P><LI>Delete the word DISTINCTROW from the query's SQL statement.

<P><LI>On the Query menu, click Run. You will see a message indicating the
<P><PRE>    number of rows that will be updated; click Yes. Note that the query
    runs without errors.
</PRE><P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the DISTINCTROW predicate, search the Help
Index for "UniqueRecords property," or ask the Microsoft Access 97 Office
Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: conversion action 3073 select delete Distinct row<BR>
append<BR>
Keywords            : CnvProb kbusage QryUpdat<BR>
Version             : 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 21, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
