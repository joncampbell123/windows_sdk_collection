

<HTML>
<HEAD>
<TITLE>ACC: Pass-Through Update Query - ODBC Error (#207) to SQL 6.0 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q149065">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1996/03/27">
<META NAME="Keywords" CONTENT="kbinterop ODBCSPT QryPass">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use double quotation marks ( ) around the values in a pass-through update query or you send a string containing a single quote as in (like ''O Brien') to Microsoft SQL 6...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QABM,QAN0,QA50,QA9E,QAHH,QAXB,QBWS,QDOR,QAB4,QBTX,QAC1,QA1S,QACF,QBXS,QAY5 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Pass-Through Update Query - ODBC Error (#207) to SQL 6.0</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q149065</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use double quotation marks (") around the values in a pass-through
update query or you send a string containing a single quote as in (like ''O
Brien') to Microsoft SQL 6.0, you may receive an ODBC call Failed error
message with the error "(#207) 'the value' is not a valid column name."
This error does not occur when you use the ISQL/w tool with the Microsoft
SQL 6.0 client utilities.
<P>
<P><h2>CAUSE</h2>
 
<P>
Microsoft SQL Server version 6.0 introduced support for ANSI SQL quoted
identifiers. Clients can set a connection option asking the server to
enforce the ANSI quoted identifier rules for SQL commands sent to it over
that connection.  ANSI SQL expects double quotation marks (") to enclose
identifier and single quotation marks (') to enclose character string data
values. Double quotation marks are the identifier delimiter in ANSI SQL,
not the string delimiter. In order for this to be a valid pass-through
query, you need to use single quotation marks.
<P>
The reason for the different behavior between ISQL/W and the pass-through
query is that ISQL/W uses DB-LIB, which has a different default behavior
than the Microsoft SQL 6.0 ODBC driver which is used by the pass-through
query. The ODBC driver sets QUOTED_IDENTIFIERS ON when it runs against a
Microsoft SQL Server version 6.0 server so that the driver's behavior more
closely matches the ANSI and ODBC standards. ODBC applications that use
double quotation marks for parameter values may see this behavior after you
upgrade to Microsoft SQL Server version 6.0 and the ODBC 2.50.0121 driver.
DB-Library clients such as ISQL/W can also exhibit this behavior if they
issue a SET QUOTED_IDENTIFIER ON command.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Use single quotation marks for your values instead of double quotation
marks. And, if the string you are sending contains a single quote, use two
single quotes instead of one, as in the example:
<P>
<PRE>   UPDATE authors SET authors.au_lname = '''O Brien', authors.au_fname =
   'John', authors.phone = '999-999-0000'
   WHERE (((authors.au_id)='527-72-3246'));

</PRE><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create a data source to a Microsoft SQL 6.0 server using the 32-bit
    ODBC utility in Control Panel for Windows 95 or Windows NT. For Windows
    3.x, run the ODBC utility in Control Panel and click the Add button on
    the Data Sources screen.

<P><LI>Select the Microsoft SQL server driver from the Add Data Source dialog
    box and click OK.

<P><LI>Pick your data source name and server name, click Options, and then
    specify Pubs as the database name.

<P><LI>Click OK and quit the ODBC utility.

<P><LI>Start Microsoft Access 2.0, 7.0 or 97 and create a new query in Design
    view. Do not select any tables.

<P><LI>On the Query menu, point to SQL Specific, and then click Pass-Through
    on the menu that appears. You should see a blank window with the
    title "Query1-SQL Pass-Through Query."

<P><LI>On the View menu, click Properties.

<P><LI>In the Query Properties dialog box, click the ODBC Connect Str
    Property, click the Build button, select your data source, and then log
    onto SQL 6.0.

<P><LI>Set the Returns Records Property to No.

<P><LI>Close the property windows and type the following in the Query1-SQL
    Pass-Through Query window:
<P>
    UPDATE authors SET authors.au_lname = "Doe", authors.au_fname = "John",
    authors.phone = "999-999-0000"
    WHERE (((authors.au_id)="527-72-3246"));

<P><LI>Run the query. Note that you receive the error mentioned in the
    "Symptoms" section.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about creating pass-through queries, search the Help
Index for "Pass-Through queries," or ask the Microsoft Access 97 Office
Assistant.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbinterop ODBCSPT QryPass<BR>
Version             : 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
