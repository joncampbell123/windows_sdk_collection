

<HTML>
<HEAD>
<TITLE>ACC: "Too few parameters" Using AddAllToList() Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q141620">
<META NAME="KBModify" CONTENT="1997/07/22">
<META NAME="KBCreate" CONTENT="1995/12/20">
<META NAME="Keywords" CONTENT="DcmSltn kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you attempt to open a parameter query from code, such as is done in the AddAllToList() function provided in the Developer Solutions sample application (Solutions.mdb), ...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAHE,QAY5,QAPN,QBCF,QBXS,QAH4,QBWS,QAB9,QA1S,QAB4,QBXN,QBB1,QBV8,QDN9,QA5E P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: "Too few parameters" Using AddAllToList() Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  July 22, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q141620</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you attempt to open a parameter query from code, such as is done in
the AddAllToList() function provided in the Developer Solutions sample
application (Solutions.mdb), you may receive the following error message:
<P>
<PRE>   Too few parameters. Expected 1.

</PRE><h2>CAUSE</h2>
 
<P>
The combo box or list box's RowSource property is set to an SQL statement
or query object name that is a parameter query. The parameter query may be
used to limit the selection of items in the list based on a selection in a
different list or control on the form. When opening a recordset on a query
in Visual Basic, which the AddAllToList() function attempts to do, the
parameters must be filled in explicitly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Modify the AddAllToList() function to explicitly fill in the parameters for
the recordset being used.
<P>
The steps to reproduce the behavior are provided below using the
SelectProduct combo box on the EditProducts form in the Developer Solutions
sample application. Further information is provided demonstrating how you
can work around this behavior by creating a copy of the AddAllToList()
function and modifying it to explicitly fill the parameters to the
LimitProductList query used to populate the SelectProduct combo box.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Open the Developer Solutions sample application (Solutions.mdb), and
   open the EditProducts form in Design view.

<P><LI>Change the RowSourceType property for the SelectProduct combo box in
   the header section from Table/Query to AddAllToList by typing
   "AddAllToList" (without the quotation marks) in the RowSourceType
   property box.

<P><LI>View the form in Form view. Note that you receive the following error
   message:
<P>
<P><PRE>      Too few parameters. Expected 1.
</PRE><P>
   Close all forms. Open the module modSolutionsUtilities
   (AddAllToListModule in Microsoft Access 7.0) in Design view, and
   select the AddAllToList procedure.

<P><LI>Highlight the entire function and press CTRL+C to copy the contents to
   the Clipboard.

<P><LI>Press CTRL+END to go to the bottom of the module and press CTRL+V to
   paste the Clipboard contents into the module to create a duplicate of
   the function.

<P><LI>On the Edit menu, click Replace and type the following information
   in the Replace dialog box
<P>
<P><PRE>      Find What: AddAllToList
      Replace With: FillSelectProduct
      Search: Current Procedure
</PRE><P>
   and then Click the Replace All button.

<P><LI>Click OK to the message "The specified region has been searched. 17
   replacements were made," and then close the Replace dialog box.

<P><LI>Modify the section of code that reads
<P>
<P><PRE>      ' Open the recordset defined in the RowSource property.
      Set dbs = CurrentDb()
      Set rst = dbs.OpenRecordset(ctl.RowSource, dbOpenSnapshot)
</PRE><P>
   to read:
<P>
<P><PRE>      ' Open the recordset defined in the RowSource property.
      Set dbs = CurrentDb()
      Dim qdf As QueryDef
      Set qdf = dbs.QueryDefs(ctl.RowSource)
      qdf.Parameters("Forms!EditProducts!SelectCategory") = _
<PRE></PRE>                      Forms!EditProducts!SelectCategory
      Set rst = qdf.OpenRecordset(dbOpenSnapshot)

      NOTE: If your RowSource property uses an SQL statement instead of a
      saved query object, you can replace the line above that reads

         Set qdf = dbs.QueryDefs(ctl.RowSource)

      to read:

         Set qdf = dbs.CreateQueryDef("", ctl.RowSource)

</PRE><P><LI>Open the EditProducts form and change the RowSourceType property of
   the SelectProduct combo box to "FillSelectProduct."
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about parameters, search for "parameter queries" using
the Microsoft Access 97 Help Index.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : DcmSltn kberrmsg kbusage<BR>
Version             : 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  July 22, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
