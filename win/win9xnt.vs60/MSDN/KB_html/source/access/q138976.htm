

<HTML>
<HEAD>
<TITLE>ACC95: "No current record" Using AddAllToList() Function </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q138976">
<META NAME="KBModify" CONTENT="1997/05/27">
<META NAME="KBCreate" CONTENT="1995/10/31">
<META NAME="Keywords" CONTENT="DcmSltn kberrmsg kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you use the AddAllToList() function provided in the sample database Solutions.mdb to add (All) items to a combo box or list box list, you may receive the following erro...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA5V,QAH4,QBVR,QAUD,QAB4,QA1S,QAZV,QBWS,QDN9,QBB1,QAUR,QBSO,QAKP,QDKY,QAY5 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: "No current record" Using AddAllToList() Function</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 27, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q138976</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you use the AddAllToList() function provided in the sample database
Solutions.mdb to add (All) items to a combo box or list box list, you may
receive the following error message:
<P>
<PRE>   No current record.


</PRE><h2>CAUSE</h2>
 
<P>
The combo box or list box RowSource property is set to a table, a query,
or an SQL statement that returns no records.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
To work around this problem, follow these steps:

<OL><P><LI>Open the Solutions.mdb database without running its AutoExec macro. To
   do so, press SHIFT while you open the database.

<P><LI>Open the AddAllToListModule module.

<P><LI>In the Procedure list box on the toolbar, select AddAllToList.

<P><LI>Modify the section of code that reads
<P>
<P><PRE>      Case acLBGetRowCount
<PRE></PRE>            ' Return number of rows in recordset.
            rst.MoveLast
            AddAllToList = rst.RecordCount

   to read:

      Case acLBGetRowCount
            ' Return number of rows in recordset.
            On Error Resume Next
            rst.MoveLast
            AddAllToList = rst.RecordCount + 1

</PRE><P><LI>Modify the section of code that reads
<P>
<PRE>            Else
               rst.MoveFirst
               rst.Move lngRow

   to read:

            Else
               rst.MoveFirst
               rst.Move lngRow - 1

</PRE><P><LI>Save the module and close the database.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
7.0. This problem no longer occurs in the AddAllToList code provided in the
Solutions database that comes with Microsoft Access 97.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the CustomerList query in the Solutions.mdb database in Design
   view and add the following criteria to the CustomerID field in the query
   grid:
<P>
<P><PRE>      "Return No Records"
</PRE>
<P><LI>Save and close the query.

<P><LI>Open the AddAllToList form. Note that you receive the error message:
<P>
<P><PRE>      No current record.
 </BLOCKQUOTE>


	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : DcmSltn kberrmsg kbusage<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 27, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
