

<HTML>
<HEAD>
<TITLE>ACC2: Event Procedure Sets Incorrect Subform Field </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q131882">
<META NAME="KBModify" CONTENT="1997/05/14">
<META NAME="KBCreate" CONTENT="1995/06/22">
<META NAME="Keywords" CONTENT="FmsSubf kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  When you use an event procedure to set a value in a subform's recordset, Microsoft Access writes the value to the incorrect field. That is, it writes the value to a control bound...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7O,QAPN,QA7N,QBXS,QA1S,QAO4,QAB5,QAMN,QDN7,QBJZ,QDN9,QAOE,QAKD,QAE1,QAB9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Event Procedure Sets Incorrect Subform Field</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 14, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q131882</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
When you use an event procedure to set a value in a subform's recordset,
Microsoft Access writes the value to the incorrect field. That is, it
writes the value to a control bound to the field specified in the subform's
LinkChildFields property rather than to the recordset field specified in
the event procedure.
<P>
<P><h2>CAUSE</h2>
 
<P>
The subform does not have a control that is bound to the field that the
event procedure sets.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access
version 2.0. This problem no longer occurs in Microsoft Access
version 7.0.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
Add a control that is bound to the field that the event procedure sets to
the subform.
<P>
If you do not want the control to be displayed, you can hide it using one
of the following methods:

<UL><LI>If the subform's DefaultView property setting is Single Form, set the
   control's Visible property to No.

<LI>If the subform's DefaultView property setting is Datasheet, open the
   subform in Datasheet view independently of the main form and reduce the
   column width of the control to 0 (zero). To reduce the column width to
   0, choose Column Width from the Format menu, and then type "0" (without
   the quotation marks) in the Column Width dialog box.

<LI>Add an event procedure to the subform's OnLoad property that sets the
   control's ColumnHidden property to True (-1). For example, set the
   subform's OnLoad property to the following event procedure:
<P>
<PRE>      Sub Form_Load ()
        Me![My bound control].ColumnHidden = -1
      End Sub

</PRE></UL><h2>MORE INFORMATION</h2>
 
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Open the sample database NWIND.MDB.

<P><LI>Open the Orders Subform form in Design view.

<P><LI>If the field list is not displayed, from the View menu, choose Field
   List. Drag the Order ID field from the field list to the subform's
   detail section.

<P><LI>Delete the Product ID field from the Orders Subform form.

<P><LI>Add an unbound combo box and set the control's properties as follows:
<P>
<P><PRE>      Name: Product_Combo_Box
      RowSource: Products
      ColumnCount: 4
      ColumnWidths: 0 in; 0 in; 0 in; 1 in
      BoundColumn: 1
</PRE>
<P><LI>Set the combo box's AfterUpdate property to the following event
   procedure:
<P>
<PRE>      Sub Product_Combo_Box_AfterUpdate ()
         Me![Product ID] = CLng(Me![Product_Combo_Box])
      End Sub

</PRE><P><LI>Save and close the Orders Subform form.

<P><LI>Open the Orders form in Form view.

<P><LI>Add a new record to the Orders Subform form by selecting a value from
   the Product_Combo_Box combo box. Note that Microsoft Access writes
   the value you select in the incorrect field. That is, the value appears
   in the Order ID field rather than in the Product ID field.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsSubf kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbfix<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 14, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
