

<HTML>
<HEAD>
<TITLE>ACC1x: How to Export the Results of a Query </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103130">
<META NAME="KBModify" CONTENT="1997/06/03">
<META NAME="KBCreate" CONTENT="1993/08/18">
<META NAME="Keywords" CONTENT="IntpOthr kbinterop kbusage QryHowto">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Microsoft Access does not provide a direct way to export the results of a query directly to a file using the Export command from the File menu. After the user selects Export from the File menu and selects an output format, the Select Microsoft Acce...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA3P,QBJZ,QAPN,QA1S,QAUJ,QBCF,QAY2,QAH4,QDMF,QBXS,QAZV,QDN9,QAL3,QAH6,QACF V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC1x: How to Export the Results of a Query</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 3, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103130</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0 and 1.1
<LI>Microsoft Access Distribution Kit version 1.1
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Microsoft Access does not provide a direct way to export the results
of a query directly to a file using the Export command from the File
menu. After the user selects Export from the File menu and selects an
output format, the Select Microsoft Access Object dialog is
presented which lists only tables, not queries, from the current
database.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following information discusses two ways to export the results of
a query to a file.

<OL><P><LI>Method 1: Uses the Transfer macro actions (TransferText,
   TransferDatabase, TransferSpreadsheet) to export query results
   directly to a file.

<P><LI>Method 2: Uses a Make Table query to save the results to a new
   table. Once this table exists, it can be exported by choosing Export
   from the File menu.
<P>
</OL><h3>Method 1: Transfer Macro Action</h3>
 
<P>
The three Transfer macro actions: TransferText, TransferSpreadsheet,
and TransferDatabase were designed to help automate the process of
exporting (and importing) data from the file menu. These commands can
also be used to facilitate exporting data from a query directly to a
file.
<P>
The following examples use the Employee Sales for 1991 query included
with the sample database NWIND.MDB supplied with Microsoft Access.
<P>
<P><h3>Example A</h3>
 
<P>
To export a query to a comma delimited text file using TransferText:

<OL><P><LI>Open NWIND.MDB.

<P><LI>Choose the Macro button, then the New button, from the Database
   window. This will present you with a new macro grid containing
   Action and Comments columns.

<P><LI>In the Action column choose TransferText.

<P><LI>Below the macro grid you will see the arguments that need to be
   filled in for the TransferText action. Fill them in with the
   following settings:
<P>
<P><PRE>      Action: TransferText
      --------------------
<PRE></PRE>         Transfer Type: Export Delimited
         Specification Name: &lt;leave empty&gt;
         Table Name: Employee Sales for 1991
         File Name: C:\EMPSALES.TXT
         Has Field Names: Yes

   NOTE: You can specify the name of a query in the Table Name
   argument.

</PRE><P><LI>Choose Save from the File menu, type a unique macro name, and press
   ENTER.

<P><LI>Choose Run from the Macro menu to execute the macro. Microsoft
   Access will run the query and save the results to the specified
   destination file name (EMPSALES.TXT).
<P>
</OL><h3>Example B</h3>
 
<P>
To export a query as a DBase IV file using TransferDatabase:

<OL><P><LI>Follow steps 1-3 for TransferText, but choose TransferDatabase as
   the macro action.

<P><LI>Fill in the macro arguments with the following settings:
<P>
<P><PRE>      Action: TransferDatabase
      ------------------------
<PRE></PRE>         Transfer Type: Export
         Database Type: dBASE IV
         Database Name: c:\
         Object Type: Query
         Source: Employee Sales for 1991
         Destination: EMPSALES
         Structure Only: No

</PRE><P><LI>Follow steps 5-6 for TransferText.
<P>
</OL><h3>Example C</h3>
 
<P>
To export a query as an Excel spreadsheet using TransferSpreadsheet:

<OL><P><LI>Follow steps 1-3 for TransferText, but choose TransferSpreadsheet
   as the macro action.

<P><LI>Fill in the macro arguments with the following settings:
<P>
<P><PRE>      Action: TransferSpreadSheet
      ---------------------------
<PRE></PRE>         Transfer Type: Export
         Database Type: Microsoft Excel
         Table Name: Employee Sales for 1991
         File Name: c:\empsales.xls
         Has Field Names: No
         Range: &lt;leave empty&gt;

   NOTE: You can specify the name of a query in the Table Name
   argument.

</PRE><P><LI>Follow steps 5-6 for TransferText.
<P>
</OL><h3>Method 2: Make Table Query</h3>
 
<P>
Use a Make Table query to export the query results to a table. Once
the data is in a new table, the Export command from the File menu can
be used to export the data to a file.
<P>
The disadvantage of this approach is that a new table increases the
size of your database. After you export the data, the table is no
longer needed. If you delete the table, Microsoft Access will not
reclaim the once occupied space until you compact the database file.
<P>
The following examples use the "Employee Sales for 1991" query
included with the sample database NWIND.MDB.

<OL><P><LI>Open NWIND.MDB.

<P><LI>Choose the Query button in the Database window, select Employee
   Sales for 1991, and choose the Design button.

<P><LI>Choose Make Table from the Query menu.

<P><LI>In the Table Name box, type a unique table name where the data will
   be exported to. Choose OK.

<P><LI>Choose Run from the Query menu. The query stores the results in the
   new table.
<P>
   You may want to save this query and give it a new name via the Save
   As command on the File menu if you need to export the results
   regularly.

<P><LI>Use the Export command from the File menu to export the new table's
   contents to a file.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information on compacting a database see the "Microsoft
Access User's Guide," version 1.0, Chapter 25, "Administering a
Database System," pages 627 - 628
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpOthr kbinterop kbusage QryHowto<BR>
Version             : 1.0 1.1<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 3, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
