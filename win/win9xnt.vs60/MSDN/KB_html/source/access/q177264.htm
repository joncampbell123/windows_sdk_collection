

<HTML>
<HEAD>
<TITLE>ACC97: Invalid DAO Reference Causes an IPF in MSACCESS.EXE </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q177264">
<META NAME="KBModify" CONTENT="1998/03/03">
<META NAME="KBCreate" CONTENT="1997/11/24">
<META NAME="Keywords" CONTENT="WzProb EvnGpf">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  In Microsoft Access 97, when you try to do any of the following   - open a database with a startup form  - view, create, or execute Visual Basic code in a form's class modu...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Security" CONTENT="PUBLIC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QAEF,QAA1,QDKX,QDI2,QA9N,QBWS,QAB4,QDH6,QANJ,QA5B,QDNE,QDH3,QAH4 P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC97: Invalid DAO Reference Causes an IPF in MSACCESS.EXE</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  March 3, 1998</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q177264</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
In Microsoft Access 97, when you try to do any of the following

<UL><LI>open a database with a startup form
<LI>view, create, or execute Visual Basic code in a form's class module
<LI>start a Microsoft Access 97 Wizard
<P>
</UL>you may receive one of the following error messages.
<P>
<P><h3>In Windows 95</h3>
 
<P>
<PRE>   ActiveX component can't create object.

   -or-

   This application has performed an illegal operation and will be shut
   down.

</PRE>If you click the Details button, you see the following additional
information:
<P>
<PRE>    Invalid Page Fault in MSACCESS.EXE



</PRE><h3>In Windows NT</h3>
 
<P>
<PRE>   An application error has occurred and an application error log is
   being generated. MSACCESS.EXE

   -or-

   MSACCESS.EXE caused an exception: Access Violation in MSACCOPT.DBG

</PRE><h2>CAUSE</h2>
 
<P>
The Dao350.dll file was not properly registered when Microsoft Access 97
was installed. This behavior occurs when you run setup for Microsoft Access
97 or Microsoft Office 97 Professional Edition, and the Dao350.dll file
already exists on your hard drive. If the file already exists, the setup
program does not reregister the file correctly.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
There are three methods that you can use to resolve this issue. Each method
is more extensive than the one before it, so you may want to try each
method in the order listed until the error message goes away.
<P>
<P><h3>Method 1: Use Regsvr32.exe to Register the DAO Files</h3>
 
<P>
Regsvr32.exe is a program that you can use to register dynamic link library
(.dll) files or ActiveX Controls in Microsoft Windows 95 or Microsoft
Windows NT.
<P>
If Regsvr32.exe is not already on your hard drive, please see the following
article in the Microsoft Knowledge Base for information about obtaining a
copy of the file:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q161983.htm">Q161983</A></B>
   TITLE     : ACC: Regsvr32.exe Available on MSL

</PRE>Follow these steps to register the Data Access Objects (DAO) DLL on your
computer using Regsvr32.exe:

<OL><P><LI>Quit Microsoft Access if it is running.

<P><LI>Verify that Regsvr32.exe is in your Windows\System folder, for example
<P>
<P><PRE>       \Windows\System or \Winnt\System32.
</PRE>
<P><LI>Depending on the operating system you are using, do one of the
   following:
<P>
<P><PRE>    a. In Microsoft Windows 95 or Microsoft Windows NT version 4.0, on
       the taskbar, click Start, and then click Run.
</PRE><P>
<P><PRE>    b. In Microsoft Windows NT version 3.51, in Program Manager or File
       Manager, on the File menu, click Run.
</PRE>
<P><LI>In the Run dialog box, in the Open text box (or the Command Line box in
   Microsoft Windows NT version 3.51), type the following command:
<P>
<P><PRE>      Regsvr32.exe C:\progra~1\common~1\micros~1\dao\dao350.dll
</PRE><P>
   NOTE: The path to Dao350.dll may be different on your computer.

<P><LI>Start Microsoft Access and attempt to perform the process that caused
   the error.
<P>
   NOTE: An alternative method of registering DLLs is to use Windows
   Explorer to find the DLL, double-click it, in the Open With
   Box, select Regsvr32.exe, and then click OK. This creates a permanent
   association of all DLLs with Regsvr32.exe. You can easily register
   other unregistered DLLs by double-clicking them.
<P>
</OL><h3>Method 2: Remove the DAO Folder and Reinstall</h3>
 

<OL><P><LI>Depending on which program you installed, remove Microsoft Office
   97 Professional Edition or Microsoft Access 97 from your computer as
   follows.
<P>
<P><PRE>    For Microsoft Windows 95 or Microsoft Windows NT version 4.0
    ------------------------------------------------------------
</PRE><P>
<P><PRE>     a. On the taskbar, click Start, point to Settings, and then click
<PRE></PRE>        Control Panel.

     b. Double-click the Add/Remove Programs icon.

     c. In the Add/Remove Programs Properties dialog box, select Microsoft
        Office 97 Professional Edition or Microsoft Access 97, and then
        click Add/Remove.

     d. In the Installation Maintenance dialog box, click Remove All.
        Confirm that you want to remove the program.

    For Microsoft Windows NT version 3.51
    -------------------------------------

     a. In Program Manager, double-click the Microsoft Office 97
        Professional Edition or Microsoft Access 97 program group.

     b. Double-click the Microsoft Office Setup or Microsoft Access Setup
        icon.

     c. In the Installation Maintenance dialog box, click Remove All.
        Confirm that you want to remove the program.

</PRE><P><LI>Remove the following folder and any files it contains from your hard
   drive. Depending on your operating system, and whether you installed the
   operating system as a stand-alone version or an upgrade from an earlier
   version, the folder should be in one of the following paths:
<P>
<P><PRE>      \Program Files\Common Files\Microsoft Shared\Dao
</PRE><P>
<P><PRE>      -or-
</PRE><P>
<P><PRE>      \Winnt\Msapps\Dao
</PRE>
<P><LI>Run Setup to reinstall Microsoft Office 97 Professional Edition or
   Microsoft Access 97. Do not choose a Compact installation.

<P><LI>Start Microsoft Access 97 and try to perform the process that
   caused the error.
<P>
</OL><h3>Method 3: Remove the Program, Delete Leftover Files, and Reinstall</h3>
 

<OL><P><LI>Complete step 1 from Method 2 to remove all of Microsoft Office 97
   Professional Edition or Microsoft Access 97 from your hard drive.

<P><LI>Manually delete all Microsoft Office 97 Professional Edition or
   Microsoft Access 97 files left on your hard drive after Setup removes
   the program.
<P>
   For a list of files to remove, please see the following articles in the
   Microsoft Knowledge Base:
<P>
<P><PRE>      ARTICLE-ID: <B><A href="../access/q163997.htm">Q163997</A></B>
<PRE></PRE>      TITLE     : ACC97: How to Completely Uninstall Microsoft Access 97

      ARTICLE-ID: <B><A href="../office/q160044.htm">Q160044</A></B>
      TITLE     : OFF97: Clicking "Remove All" in Setup Leaves Some Files

   If you are removing Microsoft Office 97 Professional Edition, remove
   the files listed in both articles. If you are removing a stand-alone
   version of Microsoft Access 97, remove the files listed in <B><A href="../access/q163997.htm">Q163997</A></B>.

</PRE><P><LI>Start Microsoft Access and try to perform the process that caused
   the error.
<P>
</OL><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access 97.
We are researching this problem and will post new information here in the
Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Microsoft Excel 97 and Microsoft Visual Basic 5.0 both include copies of
the file Dao350.dll. The version numbers of these files are as follows:
<P>
<PRE>   Product                                            Version of Dao350.dll
   ------------------------------------------------------------------------
   Microsoft Excel 97 or Microsoft Office 97 Standard  3.50.3428.0
   Visual Basic 5.0                                    3.50.3602.0

</PRE></OL>When you install Microsoft Excel 97, Visual Basic 5.0, or Microsoft Office
97 Standard, before installing Microsoft Access 97, you can receive the
error mentioned in the "Symptoms" section. The Dao350.dll file already
exists on the system and does not get replaced. This is why you cannot
correct the problem described in this article by simply reinstalling
Microsoft Access 97 or Microsoft Office 97 Professional Edition.
<P>
NOTE: The user may not receive the Invalid Page Fault errors, but may
receive errors when trying to run any Microsoft Access 97 Wizards.
<P>
For information about troubleshooting a similar issue involving the
Microsoft Access Wizards in Microsoft Access 97, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q167591.htm">Q167591</A></B>
   TITLE     : ACC97: Microsoft Access Can't Find the Wizard Error Message

</PRE><h2>REFERENCES</h2>
 
<P>
For information about troubleshooting a similar issue in Microsoft Access
95, please see the following articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q162357.htm">Q162357</A></B>
   TITLE     : ACC95: Err "Access Can't Find the Wizard" (Local Setup)

   ARTICLE-ID: <B><A href="../access/q162358.htm">Q162358</A></B>
   TITLE     : ACC95: Err "Access Can't Find the Wizard" (Workstation

   ARTICLE-ID: <B><A href="../access/q162746.htm">Q162746</A></B>
   TITLE     : ACC95: Visual C++ 4.1/4.2 Cause Error Message in MS Access
               95
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: pra problems with wizards<BR>
Keywords          : WzProb EvnGpf<BR>
Version           : WINDOWS:97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbbug<BR>
Solution Type     : kbworkaround<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  March 3, 1998</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
