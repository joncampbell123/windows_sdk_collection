

<HTML>
<HEAD>
<TITLE>ACC2: PrtDevMode Settings Do Not Work Under Windows 95 </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q140286">
<META NAME="KBModify" CONTENT="1997/05/12">
<META NAME="KBCreate" CONTENT="1995/11/28">
<META NAME="Keywords" CONTENT="kbprint PtrSetup">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  When you run Microsoft Access version 2.0 under Windows 95, a database that uses an Access Basic procedure to set a form or report's PrtDevMode property doesn't change the P...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAH4,QA1S,QATX,QDN9,QAP2,QDL9,QBWQ,QBWO,QBWN,QAPN,QAJH,QAIC,QBVV,QADX,QAG9 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: PrtDevMode Settings Do Not Work Under Windows 95</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 12, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q140286</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
When you run Microsoft Access version 2.0 under Windows 95, a database that
uses an Access Basic procedure to set a form or report's PrtDevMode
property doesn't change the Print Setup settings correctly. The same
procedure works correctly when you run Microsoft Access 2.0 under Windows
3.x.
<P>
<P><h2>CAUSE</h2>
 
<P>
The PrtDevMode property mirrors the Windows DEVMODE structure. This
structure has changed in Windows 95.
<P>
Part of the process of changing a form or report's PrtDevMode property is
to store the current PrtDevMode structure in a string variable. An
application can use the zwtDevModeStr type defined in the WZFRMRPT wizard
library if this library is being loaded. If the library is not being
loaded, as is the case with a run-time application, a common alternative is
to copy this type declaration from the Wizard module to the Declarations
section of one of the application's modules.
<P>
The string element RGB in this structure is defined as 64 bytes. The new
DEVMODE structure requires this string to be larger.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
If your application does not contain this type declaration, include a new
type declaration and change the references to the old structure. If your
application already has this type declaration, change the size of the
string element.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If your application does not define this structure in the Declarations
section of a module (you are using the wizard declaration), you need
to add the type declaration to one of your application's modules. To do
so, add the following lines to the Declarations section of one of your
application's modules. This must be a stand-alone module.
<P>
<PRE>   Type str_DEVMODE
       RGB As String * 512
   End Type

</PRE>Replace all references to the old type structure zwtDevModeStr in your
application code to the new type structure, str_DEVMODE.
<P>
If the Declarations section of one of the modules in your application
already contains this type declaration, change the line that reads
<P>
<PRE>   RGB As String * 64

</PRE>to read:
<P>
<PRE>   RGB As String * 512

</PRE><h2>REFERENCES</h2>
 
<P>
For more information about using PrtDevMode, please see the following
articles in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q129397.htm">Q129397</A></B>
   TITLE     : ACC: How to Change a Report's Printer Using Code

   ARTICLE-ID: <B><A href="../vbapps/q129748.htm">Q129748</A></B>
   TITLE     : ACC: Using the PrtDevMode Property to Verify Custom Page
               Size

   ARTICLE-ID: <B><A href="../access/q129722.htm">Q129722</A></B>
   TITLE     : ACC2: Using the PrtDevMode Property to Change Page
               Orientation

</PRE>For more information about the PrtDevMode Property, search for
"PrtDevMode," and then "PrtDevMode" topic using the Microsoft Access Help
menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbprint PtrSetup<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 12, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
