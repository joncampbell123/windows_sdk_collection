

<HTML>
<HEAD>
<TITLE>ACC: Update Query on More Than One Table Gives Unexpected Data </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q103990">
<META NAME="KBModify" CONTENT="1997/05/28">
<META NAME="KBCreate" CONTENT="1993/09/02">
<META NAME="Keywords" CONTENT="kbusage QryMktbl">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Novice: Requires knowledge of the user interface on single-user computers.  An update query that attempts to update more than one table may yield unexpected results.  RESOLUTION  You should not update more than one table in an update query.  STATUS...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAXB,QBD2,QAC1,QA5V,QAUJ,QA7O,QA7N,QAZQ,QAA5,QARR,QAEN,QAGT,QAKE,QA1S,QDMP P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Update Query on More Than One Table Gives Unexpected Data</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 28, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q103990</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Novice: Requires knowledge of the user interface on single-user computers.
<P>
An update query that attempts to update more than one table may yield
unexpected results.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You should not update more than one table in an update query.
<P>
<P><h2>STATUS</h2>
 
<P>
This behavior is by design.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
If an update query in Microsoft Access is used to update two (or more)
tables on the "many" side of a relationship, the resulting updated
fields will be multiples of the updated value. Each value will be
updated one time for each updated record in the corresponding table.
<P>
<P><h3>Steps to Reproduce Behavior</h3>
 

<OL><P><LI>Create the following three tables:
<P>
<P><PRE>      Table: Vendors
      -----------------
      Field Name: Name
<PRE></PRE>         Data Type: Text

      Table: New Parts
      --------------------
      Field Name: Item
         Data Type: Text
      Field Name: Vendor
         Data Type: Text
      Field Name: Cost
         Data Type: Number

      Table: Rebuilt Parts
      --------------------
      Field Name: Item
         Data Type: Text
      Field Name: Vendor
         Data Type: Text
      Field Name: Cost
         Data Type: Number

</PRE><P><LI>Add the following two records to the Vendors table:
<P>
<P><PRE>      Name
      ----
      Bob
      Jill
</PRE>
<P><LI>Enter the following three records to the New Parts table:
<P>
<PRE>     Item       Vendor       Cost
     -----------------------------
     fender      Bob        100.00
     hood        Jill        50.00
     trunk       Bob        100.00

</PRE><P><LI>Enter the following four records in the Rebuilt Parts table:
<P>
<PRE>     Item       Vendor      Cost
     ----------------------------
     Pump        Bob        10.00
     Fan         Jill       45.00
     Pulley      Bob        20.00
     Piston      Bob        30.00

</PRE><P><LI>Create the following query based on the three tables that you
   created above:
<P>
<P><PRE>      Query:  Example Query
      ---------------------------------------------------
      Type: Update Query
      Join: [New Parts].[Vendor] &lt;-&gt; [Vendors].[Name]
      Join: [Rebuilt Parts].[Vendor] &lt;-&gt; [Vendors].[Name]
      Field: Name
<PRE></PRE>         Table: Vendors
         Criteria: "Bob"
      Field: Cost
         Table: New Parts
         Update To: [New Parts].[Cost] * 2.0
      Field: Cost
         Table: Rebuilt Parts
         Update To: [Rebuilt Parts].[Cost] * 2.0

</PRE><P><LI>Run the query, and then save and close it.

<P><LI>Open the Rebuilt Parts table.
<P>
   Note that the costs for items listing Bob as the vendor have been
   updated to four times their original values, rather than to two
   times as specified in the update query. Each updated record in the
   Rebuilt Parts table has been updated once for each updated record
   in the New Parts table.

<P><LI>Open the New Parts table.
<P>
   Note that the costs for items listing Bob as the vendor have been
   updated to eight times their original values, rather than to two
   times as specified in the update query. Each updated record in the
   New Parts table has been updated once for each updated record in
   the Rebuilt Parts table.
<P>
</OL>This effect is called a cross product (or Cartesian product), in which the
values in Table B are updated one time for each item meeting the same
criteria in Table A.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about update queries, search the Help Index for
"update queries," or ask the Microsoft Access 97 Office Assistant.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: action<BR>
Keywords            : kbusage QryMktbl<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbprb<BR>
Resolution Type     : Info_Provided<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 28, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
