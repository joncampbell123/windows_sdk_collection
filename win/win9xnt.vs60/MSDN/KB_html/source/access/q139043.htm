

<HTML>
<HEAD>
<TITLE>ACC95: User-Defined Database Properties Are Replicated </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q139043">
<META NAME="KBModify" CONTENT="1997/05/23">
<META NAME="KBCreate" CONTENT="1995/11/01">
<META NAME="Keywords" CONTENT="kbusage RplGen">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The Properties collection of an object is replicated on all databases making up the replication set. This includes any user-defined properties that you add to an object or c...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPN,QAZV,QBJZ,QAVX,QAVW,QA1S,QBWS,QAFO,QDNJ,QDKY,QAW6,QAH4,QDN9,QBS0,QAMA V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC95: User-Defined Database Properties Are Replicated</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 23, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q139043</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 7.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The Properties collection of an object is replicated on all databases
making up the replication set. This includes any user-defined properties
that you add to an object or collection in Microsoft Access version 7.0.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
Every data access object contains a Properties collection, which has
certain built-in Property objects. These Property objects (which are often
just called properties) uniquely characterize that instance of the object.
In addition to the built-in properties, some objects allow you to create
and add your own user-defined properties.
<P>
You can use database replication to maintain synchronized copies of a
database (or replica) either on the same computer or on different computers
with different users over a network. When you replicate a database, you
create a replica set consisting of the original database and at least one
replica that is identical to the original. Each replica and Design Master
is capable of creating and manipulating user-defined properties that will
be properly synchronized with all databases in the replica set.
<P>
There are two methods for adding user-defined properties to a database: you
can use the Microsoft Access user interface; or you can use Visual Basic
for Applications code.
<P>
<P><h3>Using the Microsoft Access User Interface</h3>
 
<P>
To add custom properties to a database by using the Microsoft Access user
interface follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>On the File menu, click Database Properties.

<P><LI>Click the Custom tab.

<P><LI>In the Name box type "Test" (without the quotation marks).

<P><LI>Click the arrow next to the Type box, and then click Text.

<P><LI>In the Value box type "This is a Test" (without the quotation marks).

<P><LI>Click the Add button.
<P>
   NOTE: The custom property Test is now included in the list with
   the value of "This is a Test."
<P>
</OL><h3>Using Visual Basic for Applications Code</h3>
 

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>Create a module and type the following line in the Declarations section
   if it's not already there:
<P>
<P><PRE>      Option Explicit
</PRE>
<P><LI>Type the following procedure:
<P>
<P><PRE>      Function TestCustomProperty() As Boolean
<PRE></PRE>         On Local Error GoTo TestCustomPropertyErr
         Dim dbs As Database, cnt As Container
         Dim doc As Document, prp As Property
         ' Define Database object, Container and Document.
         Set dbs = CurrentDb()
         Set cnt = dbs.Containers!Databases
         Set doc = cnt.Documents!UserDefined
         ' Refresh the Document object.
         doc.Properties.Refresh
         Set prp = dbs.CreateProperty("MyProp", dbText, "Test")
         doc.Properties.Append prp
         TestCustomProperty = True
         MsgBox "Created Custom Property [MyProp=Test]"
      TestCustomPropertyEnd:
         Exit Function
      TestCustomPropertyErr:
         MsgBox Error$
         Resume TestCustomPropertyEnd
      End Function

</PRE></OL>To test the behavior of the custom properties using replication, use the
following steps to create a replicated database for the sample database
Northwind.mdb.

<OL><P><LI>Open the sample database Northwind.mdb.

<P><LI>On the Tools menu, point to Replication, and then click Create Replica.

<P><LI>Allow Microsoft Access to close and reopen the database.

<P><LI>Click No when prompted if you want to create a backup of the
    Northwind.mdb.

<P><LI>Accept the default folder for the location of the replica database
    and click OK to close the dialog box.
<P>
    You have now created a Design Master and replication database for the
    sample Northwind.mdb.

<P><LI>Close and re-open the Northwind.mdb Design Master.

<P><LI>Reopen the module you created in steps 1 - 3 of the "Using Visual Basic
    for Applications Code" section. Open the Debug window, type the
    following line, and then press ENTER:
<P>
       ? TestCustomProperty()
<P>
    Note that the message box opens and indicates that the custom property
    was added.

<P><LI>On the File menu, click Database Properties.

<P><LI>Click the Custom tab. Note that the custom property MyProp is included
    in the list with the value of "Test."

<P><LI>Close the Northwind.mdb Design Master and open the replica of
    Northwind database.

<P><LI>On the File menu, click Database Properties.

<P><LI>Click the Custom tab. Note that the custom property MyProp is NOT
    included in the list.

<P><LI>Close the Replica of the Northwind database and open the Northwind.mdb
    Design Master.

<P><LI>On the Tools menu, point to Replication, and then click Synchronize
    Now.

<P><LI>Confirm the synchronization process and allow it to complete.

<P><LI>Close the Northwind.mdb Design Master and open the replica of
    Northwind.mdb.

<P><LI>On the File menu, click Database Properties.

<P><LI>Click the Custom tab. Note that the custom property MyProp is now
    included in the list with the value of "Test."
<P>
</OL>The replicated database(s) will contain all custom properties you have
defined through the user interface or through code when you synchronize the
databases with the Design Master database.
<P>
<P><h2>REFERENCES</h2>
 
<P>
For more information about Properties, search on the phrase "Property
Collection," and then view any relevant topics using the Answer Wizard
from the Microsoft Access 7.0 Help menu.
<P>
For more information about Replication, search on the phrase "Briefcase
Replication," and then view any relevant topics using the Answer Wizard
from the Microsoft Access 7.0 Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : kbusage RplGen<BR>
Version             : 7.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 23, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
