

<HTML>
<HEAD>
<TITLE>ACC2: ODBCTimeout Ignores MSACC20.INI ODBC Setting </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q113883">
<META NAME="KBModify" CONTENT="1997/05/20">
<META NAME="KBCreate" CONTENT="1994/04/19">
<META NAME="Keywords" CONTENT="kbusage OdbcOthr">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  The ODBCTimeout property in new queries defaults to 60 seconds, regardless of the value set in the [ODBC] section of your MSACC20.INI file.  In databases converted from Micr...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QBXS,QDN9,QABA,QA9E,QAPN,QAKD,QBAO,QBWC,QBWS,QAZV,QACF,QAPF,QAIJ,QA0B V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: ODBCTimeout Ignores MSACC20.INI ODBC Setting</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  May 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q113883</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SYMPTOMS</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
The ODBCTimeout property in new queries defaults to 60 seconds, regardless
of the value set in the [ODBC] section of your MSACC20.INI file.
<P>
In databases converted from Microsoft Access version 1.x, the ODBCTimeout
property defaults to 0, regardless of the value set in the [ODBC] section
of your MSACC20.INI file.
<P>
<P><h2>RESOLUTION</h2>
 
<P>
You can use the sample subprocedure listed below to set the ODBCTimeout
property for all the queries in your database. Note that the ODBCTimeout
property is ignored in queries that do not use attached tables.
<P>
<P><h3>Sample Subprocedure</h3>
 
<P>
<PRE>   Sub ChangeAllQueryTimeOuts (timeinterval As Integer)
      Dim db As Database, qd As QueryDef, i As Integer
      Set db = dbengine.workspaces(0).databases(0) 'Use current database.
      BeginTrans            'Start a transaction.
                            'Loop through Querydefs and change the
                            'ODBC timeout.
         For i = 0 To db.querydefs.count - 1
            Set qd = db.querydefs(i)
            qd.odbctimeout.value = timeinterval 'Set ODBC timeout.
         Next i
      CommitTrans           'Finished: commit the transaction.
      db.querydefs.Refresh  'Update the Querydefs collection.
   End Sub

</PRE><h3>How to Run the Subprocedure</h3>
 
<P>
To run the ChangeAllQueryTimeOuts subprocedure, type the following
in the module's Immediate window, and then press ENTER:
<P>
<PRE>   ChangeAllQueryTimeOuts &lt;time value&gt;

</PRE>Substitute a value, in seconds, for &lt;time value&gt; in the sample line above.
<P>
<P><h2>STATUS</h2>
 
<P>
Microsoft has confirmed this to be a problem in Microsoft Access version
2.0. We are researching this problem and will post new information here in
the Microsoft Knowledge Base as it becomes available.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The QueryTimeout setting in the [ODBC] section of the MSACC20.INI file
applies only to queries that do not have a setting for the ODBCTimeout
property. If a query's ODBCTimeout property is blank, then the QueryTimeout
setting is used.
<P>
An ODBCTimeout value of 0 means that there is no timeout. If the ODBC
server does not respond, the query will never timeout and return control.
<P>
In Microsoft Access version 1.x, The QueryTimeout and ODBCTimeout values
are set by the QueryTimeout setting in the [ODBC] section of the
MSACCESS.INI file. This value applies to all the ODBC queries run in the
current Microsoft Access session.
<P>
In Microsoft Access version 2.0, these values can differ. Each query can
have its own ODBCTimeout setting.
<P>
<P><h3>Steps to Reproduce Problem</h3>
 

<OL><P><LI>Start Microsoft Access and open the sample database NWIND.MDB.

<P><LI>Open any query in Design view.

<P><LI>Set the query's ODBCTimeout property to null (that is, delete any
   existing value for the property).

<P><LI>Save and then close the query.

<P><LI>Reopen the query in Design view. Note that the ODBCTimeout property
   is set to 0.
<P>
</OL><h2>REFERENCES</h2>
 
<P>
For more information about the ODBCTimeout and QueryTimeout settings,
search for "ODBCTimeout" and "QueryTimeout" using the Microsoft Access Help
menu.
<P>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: odbc attaching<BR>
Keywords            : kbusage OdbcOthr<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbbug<BR>
Resolution Type     : kbcode<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  May 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
