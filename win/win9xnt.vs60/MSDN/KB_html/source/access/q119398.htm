

<HTML>
<HEAD>
<TITLE>ACC2: Dynamically Synchronizing Two Forms Using Code </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q119398">
<META NAME="KBModify" CONTENT="1997/04/25">
<META NAME="KBCreate" CONTENT="1994/08/15">
<META NAME="Keywords" CONTENT="FmsHowto kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Advanced: Requires expert coding, interoperability, and multiuser skills.  This article describes how to synchronize a form to the current record in a subform using Access Basic. The method described in this article searches a recordset returned by...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA1S,QDN9,QA5V,QAH4,QAPN,QAI2,QBJZ,QBWS,QA5F,QAPF,QAMA,QABI,QAJH,QDNW,QBXS V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC2: Dynamically Synchronizing Two Forms Using Code</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  April 25, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q119398</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access version 2.0
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Advanced: Requires expert coding, interoperability, and multiuser skills.
<P>
This article describes how to synchronize a form to the current record in a
subform using Access Basic. The method described in this article searches a
recordset returned by the form's RecordsetClone property and synchronizes
the form's bookmarks with the Recordset.
<P>
This article assumes that you are familiar with Access Basic and with
creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Access Basic, please
refer to the "Building Applications" manual.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
The following example demonstrates how to synchronize the Products form to
the current record in the Categories Subform form in the sample database
NWIND.MDB.
<P>
CAUTION: Following the steps in this example will modify the sample
database NWIND.MDB. You may want to back up the NWIND.MDB file, or perform
these steps on a copy of the NWIND database.

<OL><P><LI>Open the NWIND database.

<P><LI>Open the Categories Subform form in Design view.

<P><LI>Set the form's OnCurrent property to the following event
   procedure:
<P>
<P><PRE>      '**********************************************************
      'Sub Form_Current()
      '**********************************************************
</PRE><P>
<PRE>          'If the Product ID is blank, then exit the Sub.
          If IsNull(Me![Product Id]) Then
              Exit Sub
          End If

          'Dimension variables.
          Dim formname As String, SyncCriteria As String
          Dim f As Form, rs As Recordset

          'Set the formname to "Products," the form that will be
          'synchronized.
          formname = "Products"

          'Check to see if the Products form is open. If it
          'is not open, open it.
          If Not SysCmd(SYSCMD_GETOBJECTSTATE, A_FORM, formname) Then
              DoCmd OpenForm formname
          End If

          'Define the form object and Recordset object for
          'the Products form.
          Set f = Forms(formname)
          Set rs = f.RecordsetClone

          'Define the criteria used for the synchronization.
          SyncCriteria = "[Product Id]=" &amp; Me![Product Id]

          'Find the corresponding record in the Products form to
          'the current record in the subform.
          rs.FindFirst SyncCriteria

          'If a record exists in the Products form, find the
          'matching record.
          If rs.nomatch Then
              MsgBox "No match exists!", 64, formname
          Else
              f.bookmark = rs.bookmark
          End If

      '**********************************************************
      'End Sub
      '**********************************************************

</PRE><P><LI>Save and then close the Categories Subform form.

<P><LI>Open the Categories form in Form view. When you open the Categories
   form, the subform's OnCurrent event procedure will be triggered, causing
   the Products form to be opened if it is not already open.
<P>
</OL>You can adapt this method to occur when a command button is clicked by
moving the code specified in the subform's OnCurrent property event
procedure to a command button on the Categories form. If you do
move the code to a command button, make sure to change the references to
"Me" in the code to full form reference, using the syntax:
<P>
<PRE>   Forms!Categories![Categories Subform].Form

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For an example of how to dynamically synchronize two forms in Microsoft
Access for Windows 95 version 7.0, please see the following article in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q149940.htm">Q149940</A></B>
   TITLE:      ACC: Dynamically Synchronizing Two Forms Using Code (95/97)

</PRE>Microsoft Access "User's Guide," version 2.0, Chapter 25, "Using the
OnCurrent Property to Keep Two Open Forms Synchronized," pages 639-641
<P>
Microsoft Access "Building Applications," version 2.0, Chapter 4, "Using
Forms to Collect, Display, and Filter Information," page 84, and Chapter
11, "Working with Sets of Records," pages 255-259
<P>
For more information about the SysCmd() function, search for "SysCmd," and
then "SysCmd Function" using the Microsoft Access Help menu.
<P>
For more information about the Me property, search for "Me" then "Me
Property" using the Microsoft Access Help menu.
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : FmsHowto kbusage<BR>
Version             : 2.0<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  April 25, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
