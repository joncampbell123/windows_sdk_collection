

<HTML>
<HEAD>
<TITLE>ACC: How to Repeat Subreport Header at Top of Page </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q120907">
<META NAME="KBModify" CONTENT="1997/10/24">
<META NAME="KBCreate" CONTENT="1994/09/21">
<META NAME="Keywords" CONTENT="RptSub kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to repeat a subreport's header when the subreport spans multiple pages.  NOTE: This method works best for one subreport. Attempting to repeat the subre...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QBT6,QBV4,QAHP,QAMA,QAMB,QAPN,QAH4,QAHE,QA1S,QAF8,QAWF,QAKJ,QBXS,QAMW,QBWA P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Repeat Subreport Header at Top of Page</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  October 24, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q120907</B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to repeat a subreport's header when the
subreport spans multiple pages.
<P>
NOTE: This method works best for one subreport. Attempting to repeat
the subreport header for multiple subreports requires a set of controls
in the page header and a flag for each subreport. Then the code must
check each flag and hide or show the appropriate sets of controls.
This code is not easy to maintain.
<P>
NOTE: This article explains a technique demonstrated in the sample
files, RptSampl.exe (for Microsoft Access for Windows 95 version 7.0)
and RptSmp97.exe (for Microsoft Access 97). For information about how
to obtain these sample files, please see the following articles in the
Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../access/q145777.htm">Q145777</A></B>
   TITLE     : ACC95: Microsoft Access Sample Reports Available on MSL

   ARTICLE-ID: <B><A href="../access/q175072.htm">Q175072</A></B>
   TITLE     : ACC97: Microsoft Access 97 Sample Reports Available on MSL

</PRE><h2>MORE INFORMATION</h2>
 
<P>
The method demonstrated in the following example uses a flag in the page
header to indicate whether the subreport spans multiple pages. When the
subreport's report header is printed the flag is set to 1. When the
subreport's report footer is printed, the flag is set to 0. When the page
header is printed, if the flag is set to 1 then the subreport spans
multiple pages and the subreport's header should be repeated.
<P>
The following example demonstrates how to cause a subreport's header to be
repeated if the subreport spans multiple pages:

<OL><P><LI>Open the sample database Northwind.mdb (or NWIND.MDB in versions
    1.x and 2.0).

<P><LI>Create the following macro, and then save it as RepeatSubHeader:
<P>
<PRE>       Macro Name   Condition   Action
       ------------------------------------
       MainRH                   SetValue
       MainPH       [Flag]=0    CancelEvent
       SubRH                    SetValue
       SubRF                    SetValue

       MainRH Actions
       ------------------------------------------------
       SetValue
          Item: Reports![Categories Main Report]![Flag]
          Expression: 0

       SubRH Actions
       ------------------------------------------------
       SetValue
          Item: Reports![Categories Main Report]![Flag]
          Expression: 1

       SubRF Actions
       ------------------------------------------------
       SetValue
          Item: Reports![Categories Main Report]![Flag]
          Expression: 0

</PRE><P><LI>Create a new report called Products Sub Report based on the Products
    table.

<P><LI>Place the following three text box controls in the new report's
    detail section:
<P>
       Text Box:
<PRE>          ControlName: ProductID
          ControlSource: ProductID
       Text Box:
          ControlName: CategoryID
          ControlSource: CategoryID
       Text Box:
          ControlName: ProductName
          ControlSource: ProductName

       NOTE: In versions 1.x and 2.0, there is a space in Product ID,
       in Category ID, and in Product Name.

</PRE><P><LI>On the View menu, click Report Header/Footer.

<P><LI>Place the following three labels in the report's report header
    section:
<P>
       Label:
<PRE>          ControlName: Text1
          Caption: ProductID
       Label:
          ControlName: Text2
          Caption: CategoryID
       Label:
          ControlName: Text3
          Caption: ProductName

</PRE><P><LI>Set the report header section's OnPrint property to the following
    macro:
<P>
       RepeatSubHeader.SubRH

<P><LI>Set the report footer section's OnFormat property to the following
    macro:
<P>
       RepeatSubHeader.SubRF

<P><LI>Create a new report called Categories Main Report based on the
    Categories table.

<P><LI>Copy the controls from the Product Sub Report report's report header
    section and paste them into the page header section of the Categories
    Main Report report.

<P><LI>Place the following text box in the Categories Main Report report's
    page header section:
<P>
       Text Box:
<PRE>          ControlName: Flag
          Visible: No

</PRE><P><LI>Place the following three text boxes in the Categories Main Report
    report's detail section:
<P>
       Text Box:
<PRE>          ControlName: CategoryID
          ControlSource: CategoryID
       Text Box:
          ControlName: CategoryName
          ControlSource: CategoryName
       Text Box:
          ControlName: Description
          ControlSource: Description

</PRE><P><LI>Embed the Products Sub Report report in the Categories Main Report
    report by dragging the Products Sub Report report from the Database
    window to the detail section of the Categories Main Report report.

<P><LI>On the View menu, click Report Header/Footer to add a report
    header and footer to the main report. If you do not want a main
    report header or footer, set the header or footer section's height
    to 0.

<P><LI>Set the OnFormat property of the report header section of the
    Categories Main Report report to the following macro:
<P>
       RepeatSubHeader.MainRH

<P><LI>Set the OnPrint property of the page header section of the Categories
    Main Report report to the following macro:
<P>
       RepeatSubHeader.MainPH.

<P><LI>Preview or print the report. Note that the subreport's header
    information is repeated when the subreport spans multiple pages.
<P>
</OL><h3>Displaying Main Report Information on Every Page</h3>
 
<P>
The example above assumes that you do not want anything except the
subreport header to be printed in the main report's page header. If you do
want to print other information, you will need to hide and unhide each
subreport header control in the page header. Change the MainPH macro in
step 2 above to:
<P>
<PRE>   Macro Name   Condition   Action
   -------------------------------------------------
   MainPH       [Flag]=0    SetValue
                               Item: [Text1].visible
                               Expression: False
                ...         SetValue
                               Item: [Text2].visible
                               Expression: False
                ...         SetValue
                               Item: [Text3].visible
                               Expression: False
                [Flag]=1    SetValue
                               Item: [Text1].visible
                               Expression: True
                ...         SetValue
                               Item: [Text2].visible
                               Expression: True
                ...         SetValue
                               Item: [Text3].visible
                               Expression: True

</PRE></OL><h2>REFERENCES</h2>
 
<P>
For more information about events during printing, type "Print Events" in
the Office Assistant, click Search, and then click to view "Print Event."
<P>
For more information about report OnFormat and OnPrint properties, search
<P><h2>on "OnFormat," and "OnPrint," using the Microsoft Access 97 Help Index</h2>
 
<PRE>Keywords          : RptSub kbusage
Version           : 1.0 1.1 2.0 7.0 97
Platform          : WINDOWS
Hardware          : x86
Issue type        : kbhowto</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
================================================================================<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  October 24, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
