

<HTML>
<HEAD>
<TITLE>ACC: Exporting WordPerfect Secondary Files to Microsoft Access </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q99317 ">
<META NAME="KBModify" CONTENT="1997/06/06">
<META NAME="KBCreate" CONTENT="1993/05/26">
<META NAME="Keywords" CONTENT="IntpPrtm kb3rdparty kbinterop">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to export data from a WordPerfect (WP) print merge secondary file (or data file) to Microsoft Access.  MORE INFORMATION  A WordPerfect secondary file (...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QA7N,QA7O,QA5V,QAUJ,QBEQ,QAUD,QDIU,QBDZ,QBRZ,QAUR,QAMA,QAKS,QARM,QBXS,QBBL P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: Exporting WordPerfect Secondary Files to Microsoft Access</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  June 6, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q99317 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to export data from a WordPerfect (WP) print
merge secondary file (or data file) to Microsoft Access.
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
A WordPerfect secondary file (or data file) contains records, typically
names and addresses, used in a print merge with a primary file (or form
file), such as a form letter or mailing label document. To use data from a
secondary file, the information must be saved in a comma or tab delimited
(separated), unformatted text file. WordPerfect secondary files are neither
comma nor tab delimited.
<P>
A typical comma delimited text file resembles the following:
<P>
<PRE>   "Joe","Smith","123 Main Street","Seattle, WA 98033"
   "Martha","Jones","4523 Williams Ave","","Redmond, WA 98052"

</PRE>The equivalent WordPerfect secondary file resembles the following:
<P>
<PRE>   Joe{END FIELD}
   Smith{END FIELD}
   123 Main Street{END FIELD}
   Seattle, WA 98033{END FIELD}
   {END RECORD}
   &lt;CRLF&gt;
   Martha{END FIELD}
   Jones{END FIELD}
   4523 Williams Ave{END FIELD}
   {END FIELD}
   Redmond, WA 98052{END FIELD}
   {END RECORD}
   &lt;CRLF&gt;

</PRE>where &lt;CRLF&gt; represents a hard page break. Note also that in Wordperfect
versions later than 5.1, {END FIELD} and {END RECORD} will be shown as
boldface without braces.
<P>
<P><h3>Problems: Secondary Files With Multiple-Line Field Entries</h3>
 
<P>
WordPerfect allows you to merge multiple lines of data in a single
field. The following record has only two fields:
<P>
<PRE>   Joe Smith{END FIELD}
   123 Main Street
   Suite 101
   Seattle, WA 98033{END FIELD}
   {END RECORD}
   &lt;CRLF&gt;

</PRE>Delimited text files use carriage returns to mark the end of a record;
these cannot be included in the field information. Each line in the
secondary file must be made a unique field before it can be prepared
as a delimited file. When you add the {END FIELD} code to a record,
the new field is represented in every record in your file. Each record
must contain the same number of fields and each field should either
contain the same type of data or remain empty.
<P>
<P><h3>Using the {FIELD NAMES} Section in a Secondary File</h3>
 
<P>
Fields in a secondary file can be referenced from a primary file by
number. These fields are numbered from top to bottom, or by a name
that is assigned in the optional {FIELD NAMES} section, which appears
at the top of the secondary file. The {FIELD NAMES} section in WP 5.1 may
look like this
<P>
<PRE>   {FIELD NAMES}
   Name~
   Address~
   ~{END RECORD}

</PRE>or like this:
<P>
<PRE>   {FIELD NAMES}Name~Address~~{END RECORD}

</PRE>The {FIELD NAMES} section in WP versions later than 5.1 may look like this:
<P>
<PRE>   FIELDNAMES(Name;Address)ENDRECORD

</PRE>If referenced by number, the Name field is 1 and the Address field is
2. A hard page break falls between this section and the first record.
<P>
<P><h3>Preparing the Comma Delimited Secondary File</h3>
 
<P>
WordPerfect for Windows:
<P>
WordPerfect for Windows can save secondary files directly in a comma
delimited format. However, if you have a {FIELD NAMES} section in the
file and want to preserve these names in Microsoft Access, you must
reformat the file so that each name is separated by a comma and not by
a tilde (~) character. Also, the fields should not appear on separate
lines, nor be followed by carriage returns. The following {FIELD
NAMES} section
<P>
<PRE>   {FIELD NAMES}
   Name~
   Address~
   Phone~
   ~{END RECORD}

</PRE>should be edited as follows:
<P>
<PRE>   {FIELD NAMES}Name,Address,Phone{END RECORD}

</PRE>Creating the Comma Delimited File:

<OL><P><LI>From the File menu, choose Save As.

<P><LI>In the Save As box, type a unique file name, preferably with a .TXT
   extension.

<P><LI>In the Format box, select ASCII Delimited Text (DOS), then choose
   Save.
<P>
</OL>WordPerfect for MS-DOS:
<P>
WordPerfect for MS-DOS cannot save secondary files directly in a delimited
format. To create the comma delimited file, you need to create a primary
file (or form file) and merge the secondary information into it. The
primary document will contain fields already in comma delimited format.
Once the data is merged, remove the hard page breaks separating each
record. The resulting document can be saved as a text file that Microsoft
Access can import.
<P>
Creating the Primary File (or form file) in WP 5.1:

<OL><P><LI>Press F7, choose No, then choose No again to create a new
   WordPerfect document.

<P><LI>Type an opening quotation mark. Press SHIFT+F9, then 1 (Field).

<P><LI>In the Enter Field box, type the name of the first field if a
   {FIELD NAMES} section appears in the secondary file, or type "1" if
   there is no {FIELD NAMES} section.

<P><LI>Press ENTER. Type a closing quotation mark, followed by a comma.

<P><LI>Repeat steps 2-4 for each field in the secondary file, changing
   only the field name or field position number as appropriate. Do not
   type a comma after the last field.

<P><LI>Press ENTER to place a hard carriage return at the end of the
   record.

<P><LI>Press F10, type a unique filename in the Document To Be Saved
   box, and press ENTER. The primary document in WP 5.1 will resemble the
   following:
<P>
<P><PRE>      "{FIELD}name~","{FIELD}address~","{FIELD}phone~"
</PRE><P>
</OL>Creating the Primary File (or form file) in WP 6.0:

<OL><P><LI>Press F7, choose No, then choose No again to create a new
   WordPerfect document.

<P><LI>Type an opening quotation mark. Press SHIFT+F9, then 1 (Form).

<P><LI>Choose 1 (Field). Type the name of the first field and choose OK; or
   choose List Field Names to select fields from an existing data file.

<P><LI>Type a closing quotation mark, followed by a comma.

<P><LI>Repeat steps 2-4 for each field in the secondary file, changing
   only the field name or field position number as appropriate. Do not
   type a comma after the last field.

<P><LI>Press ENTER to place a hard carriage return at the end of the
   record.

<P><LI>Press F10, type a unique filename in the Document To Be Saved
   box, and press ENTER.  The form document in WP 6.0 will resemble the
   following:
<P>
<P><PRE>     "FIELD(name)","FIELD(address)"
</PRE><P>
   NOTE: It is acceptable for the lines to wrap on the screen.
<P>
</OL>Merging the Primary and Secondary Files:

<OL><P><LI>Press F7, choose No, then choose No again to create a new
   WordPerfect document.

<P><LI>Press CTRL+F9, then 1 (Merge).

<P><LI>In the Primary File or Form File box, type the name of the primary file
   and press ENTER.

<P><LI>In the Secondary File or Data File box, type name of the secondary file
   and press ENTER.

<P><LI>For WP 6.0 only, choose Merge.
<P>
</OL>Removing the Residual Hard Page Breaks:

<OL><P><LI>In WP 5.1, press ALT+F2, then N to disallow replacements.  In WP 6.0,
   press ALT+F2.

<P><LI>At the -&gt; Srch prompt, press CTRL+ENTER to enter a [HPg] code.

<P><LI>Press ALT+F2 twice to pass the Replace With message.
<P>
</OL>Saving As an Unformatted Text File in WP 5.1:

<OL><P><LI>Press CTRL+F5, then 1 (DOS Text), then 1 (Save).

<P><LI>Type a valid document name, preferably with a .TXT extension, and
   press ENTER.
<P>
</OL>Saving As an Unformatted Text File in WP 6.0:

<OL><P><LI>Press F10, type a valid document name, preferably with a .TXT extension.

<P><LI>Press TAB, choose DOS Delimited Text, then press ENTER.
<P>
</OL>WordPerfect is manufactured by WordPerfect Corporation, a vendor
independent of Microsoft; we make no warranty, implied or otherwise,
regarding this product's performance or reliability.
<P>
<P><h2>REFERENCES</h2>
 
<P>
"WordPerfect for DOS Reference," version 5.1, pages 420-431
<P>
"WordPerfect for DOS Workbook," version 5.1, pages 237-246
<P>
"WordPerfect for Windows Reference," version 5.1, pages 300-308
<P>
"WordPerfect for Windows Workbook," version 5.1, pages 203-210
<P>
"WordPerfect for Windows Reference," version 5.2, pages 321-328
<P>
"WordPerfect for Windows Workbook," version 5.2, pages 227-236
<P>
"WordPerfect for DOS Reference," version 6.0, pages 412-422
<P>
"WordPerfect for DOS Learning WordPerfect," version 6.0, pages 195-204
<P>
"WordPerfect for Windows Reference," version 6.0, pages 453-473
<P>
"WordPerfect for Windows Learning WordPerfect," version 6.0, pages 201-210
 

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Keywords            : IntpPrtm kb3rdparty kbinterop<BR>
Version             : 1.0 1.1 2.0 7.0 97<BR>
Platform            : WINDOWS<BR>
Hardware            : X86<BR>
Issue type          : kbinfo<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  June 6, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
