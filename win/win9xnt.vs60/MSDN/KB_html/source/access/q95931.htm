

<HTML>
<HEAD>
<TITLE>ACC: How to Use the Query-by-Form (QBF) Technique </TITLE>

<!--STYLE_BEGIN-->
<style>@import url(../../msdn_ie4.css);</style>
	<link disabled rel="stylesheet" href="../../msdn_ie3.css">
<!--STYLE_END-->

<META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html; charset=us-ascii">
<META NAME="ms.locale" CONTENT="EN-US">
<META NAME="Category" CONTENT="Support; KB Article">
<META NAME="KBID" CONTENT="Q95931 ">
<META NAME="KBModify" CONTENT="1997/08/20">
<META NAME="KBCreate" CONTENT="1993/03/01">
<META NAME="Keywords" CONTENT="QryParm kbusage">
<META NAME="KBArea" CONTENT="Support; KB; access, convert, crossnet, dbweb, odbc, winprint, setup, vbapp, office, officevba">
<META NAME="Description" CONTENT="  Moderate: Requires basic macro, coding, and interoperability skills.  This article describes how to use a form to specify the criteria for a query in Microsoft Access. This technique is called query by form (QBF).  MORE INFORMATION  You use the QBF...">
<META NAME="Product" CONTENT="Access">
<META NAME="Platform" CONTENT="Windows">
<META NAME="Technology" CONTENT="ODBC ">
<META NAME="Premium" CONTENT="support">

<META NAME="nyms" CONTENT="QAPF,QA5V,QAUD,QBT6,QBV4,QBBI,QA7O,QACF,QAI2,QA7N,QAHP,QA1S,QAJQ,QAHH,QALW P1 P2 P3 P4 P5 P6 T2 P7 V02180118">
</HEAD>

<BODY BGCOLOR="#FFFFFF" LEFTMARGIN="0" RIGHTMARGIN="0" TOPMARGIN="0">


<!--DOCBODY_START-->
<BR>
<CENTER>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" VALIGN="top" WIDTH="90%">
	<TR>
		<TD VALIGN="top">
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<H1>ACC: How to Use the Query-by-Form (QBF) Technique</H1>
			</FONT>
			<FONT FACE="verdana,arial,helvetica" SIZE="1">
			Last reviewed:  August 20, 1997</FONT><BR>
			<FONT FACE="verdana,arial,helvetica" SIZE="2">
			<B>Article ID: Q95931 </B>
			</FONT>
		</TD>
	</TR>
	<TR>
	<TD>
	<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>



 
 
The information in this article applies to:

<UL><LI>Microsoft Access versions 1.0, 1.1, 2.0, 7.0, 97
</UL> 
<P>
<P><h2>SUMMARY</h2>
 
<P>
Moderate: Requires basic macro, coding, and interoperability skills.
<P>
This article describes how to use a form to specify the criteria for a
query in Microsoft Access. This technique is called query by form (QBF).
<P>
<P><h2>MORE INFORMATION</h2>
 
<P>
You use the QBF technique to create a query form in which you enter query
criteria. The query form contains blank text boxes, each representing a
field in a table that you want to query. You make entries in only the text
boxes for which you want to specify search criteria.
<P>
The query form is usually similar to a data entry form, as in the
following sample query form:
<P>
<PRE>   First Name: __________
   Last Name:  __________
   City:       __________
   State:      __________
   Zip Code:   __________

</PRE>You can enter any combination of search criteria in the form. You can
specify a City only, or a City and a State, or a Zip Code only, or any
other combination of values. Fields that you leave blank on the form are
ignored (no search criteria are applied to those fields). When you click
a Search button on the form, it runs a query that uses the search criteria
from your form.
<P>
To create a query form, follow these steps:

<OL><P><LI>Open the sample database Northwind.mdb (or Nwind.mdb in version 1.x
   or 2.0).

<P><LI>Create the following new form not based on any table or query and save
   it as QBF_Form:
<P>
<P><PRE>      Form: QBF_Form
      ---------------------------------
      Text box:
<PRE></PRE>         Control Name: What Customer ID?
      Text box:
         Control Name: What Employee ID?
      Command button:
         Caption: Search
         OnClick (or OnPush in version 1.x): QBF_Macro

</PRE><P><LI>Create the following new macro, and then save it as QBF_Macro:
<P>
<P><PRE>      Macro: QBF_Macro
      ------------------------
      OpenQuery
<PRE></PRE>         Query Name: QBF_Query
         View: Datasheet
         Data Mode: Edit

</PRE><P><LI>Create the following new query based on the Orders table, and then save
   it as QBF_Query:
<P>
   NOTE: In the following sample criteria, an underscore (_) at the end of
   a line is used as a line-continuation character. Remove the underscore
   from the end of the line when re-creating these criteria.
<P>
<P><PRE>      Query: QBF_Query
      ---------------------------------------------------------
      Field: CustomerID
<PRE></PRE>         Sort: Ascending
         Criteria: Forms![QBF_Form]![What Customer ID?] Or _
                   Forms![QBF_Form]![What Customer ID?] Is Null
      Field: EmployeeID
         Sort: Ascending
         Criteria: Forms![QBF_Form]![What Employee ID?] Or _
                   Forms![QBF_Form]![What Employee ID?] Is Null
      Field: OrderID
      Field: OrderDate

</PRE><P><LI>View the QBF_Form in Form view. Enter the following combinations of
   criteria, clicking the Search button after each combination:
<P>
<PRE>      Customer ID   Employee ID  Result
      -----------------------------------------------------------------
      &lt;blank&gt;       &lt;blank&gt;      All 830 orders in Microsoft Access 97
                                 and 7.0; 1078 orders in earlier versions.

      AROUT         &lt;blank&gt;      13 orders for AROUT in Microsoft Access 97
                                 and 7.0; 14 orders in earlier versions.

      AROUT         4            4 AROUT orders for employee 4.

      &lt;blank&gt;       4            156 orders for employee 4 in Microsoft
                                 Access 97 and 7.0; 209 in earlier
                                 versions.

</PRE></OL>After you view the result set for each query, close the Datasheet window
before beginning your next search. Each time you click the Search button,
the parameters in the QBF query filter the data according to the search
criteria specified on the QBF query form.
<P>
<P><h3>Notes on the QBF Parameter Criteria</h3>
 
<P>
The sample QBF query above implements a criteria in the query as
<P>
<PRE>   Forms!FormName!ControlName Or Forms!FormName!ControlName Is Null

</PRE>to filter the data. This criteria returns all matching records. If a
criteria is null, all the records are returned for the specified field.
<P>
You can specify any of the following alternative criteria to return
slightly different results:
<P>
NOTE: In the following sample criteria, an underscore (_) is used as a
line-continuation character. Remove the underscore from the end of the line
when re-creating these criteria.

<UL><LI>Like Forms!FormName!ControlName &amp; "*" Or _
   Forms!FormName!ControlName Is Null
<P>
   This criteria is the same as the QBF sample above, except that you
   can query using a wildcard. For example, if you enter "Jo" in a field
   using this criteria, the query returns every record in the field
   that begins with "Jo," including Johnson, Jones, Johanna, and so on,
   instead of returning only those records with an exact match to "Jo."

<LI>Between Forms!FormName!StartDate And Forms!FormName!EndDate Or _
   Forms!FormName!StartDate Is Null
<P>
   You can use this criteria to query a date field, using Start Date
   and End Date text boxes on the query form. Records whose start and
   end dates fall between the values you specify on the query form are
   returned. If you omit a Start Date value on the form, however, the
   query returns all records regardless of the End Date value.

<LI>Like Forms!FormName!ControlName &amp; "*" Or Is Null
<P>
   This criteria returns both records that match the criteria and
   records that are null. If the criteria are null, all the records
   are returned. Note that the asterisk (*) is considered a parameter,
   as it is part of a larger Like expression. Because the asterisk is a
   hard-coded criteria value (for example, Like "*") records with null
   values are returned.

<LI>Like IIf(IsNull(Forms!FormName![ControlName]), _
   "*",[Forms]![FormName]![ControlName])
<P>
   This criteria returns all the records that match the criteria. If
   no criteria are specified in the query form, all records that are NOT
   null are returned.

<LI>IIf(IsNull(Forms!FormName![ControlName]), _
   [FieldName],[Forms]![FormName]![ControlName])
<P>
   This returns all the records that match the criteria. If no criteria
   are specified in the query form, all records that are NOT null are
   returned (the same result as in the example above).
<P>
</UL>For more information about parameter queries, please see the following
article in the Microsoft Knowledge Base:
<P>
<PRE>   ARTICLE-ID: <B><A href="../vbapps/q100131.htm">Q100131</A></B>
   TITLE     : ACC: How to Create a Parameter In() Statement
</PRE>

	</FONT>
	</TD>
	</TR>
</TABLE>
<P>


<!--DOCBODY_END-->

<!--FOOTER_START-->
<table cellpadding=5 border=0 width="90%">
<tr>
<td>
	<HR WIDTH="90%">

<BLOCKQUOTE>
<FONT FACE="Verdana, Arial, Helvetica" SIZE="1">
<SPAN STYLE="font-family:verdana,arial,helvetica; font-size:8pt">
Additional query words: qbe query by example<BR>
Keywords          : QryParm kbusage<BR>
Version           : 1.0 1.1 2.0 7.0 97<BR>
Platform          : WINDOWS<BR>
Hardware          : x86<BR>
Issue type        : kbhowto<BR>

</SPAN>
</FONT>
<BR>
<BR>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>
<P>
<center>
	<FONT FACE="Verdana,Arial,Helvetica" SIZE="1">
	Last reviewed:  August 20, 1997</FONT>
	<BR>
	<A href="../cpyright.htm" STYLE="font: bold 7pt Verdana,Arial,Helvetica">&copy; 1998 Microsoft Corporation. All rights reserved. Terms of Use.</A><BR>
	
</center>
</td>
</tr>
</table>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
